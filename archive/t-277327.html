<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with macro parameters (bug?), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with macro parameters (bug?) NSIS Discussion" />
	
	<title> Problem with macro parameters (bug?) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with macro parameters (bug?)</div>
<hr />
<div class="pda"><a href="t-277327.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277327">Problem with macro parameters (bug?)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">14th September 2007, 13:58</div></div><div class="posttext">Hello!<br />
<br />
I've found one thing. If we have macro, that accepts some parameter and then try to call it:<br />
<br />
!insertmacro foo 'bar' ; blah<br />
<br />
then compiler exits with error. Isn't it bug in expanding macro? I think that it is, because comments should be removed from the line before expansion. I am using 2.28.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th September 2007, 17:40</div></div><div class="posttext">What is the exact error?<br />
Comments works fine on my machine with makensis 2.29.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">14th September 2007, 17:53</div></div><div class="posttext">Sorry guys, I must have made a make mistake elsewhere. When I was in an office, the compilator produced this error. I thought about it on the train on my way home and I simply couldn't believe that such a great installer could contain such a stupid bug. I came home and tried to write that macro and produce the error again. And nothing happened (either in 2.28 nor 2.30)! My aim was a macro, that executes command and checks for errors, something like this:<br />
<br />
!macro MyExec command<br />
  ClearErrors<br />
  ExecWait command<br />
  ${If} ${Errors}<br />
    MessageBox MB_OK|MB_ICONSTOP &quot;Error! (${command})&quot;<br />
  ${EndIf}<br />
!macroend<br />
<br />
And then I replaced all occurencies of &quot;ExecWait&quot; to &quot;!insertmacro MyExec&quot;, that should be OK.<br />
<br />
So I am very sorry for starting this thread, delete it if you want. Have a nice weekend guys!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">14th September 2007, 17:58</div></div><div class="posttext">Stu, the compilator said that I had 3 arguments to macro instead of 1 or 2. So I thought that it was a parser problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">14th September 2007, 18:44</div></div><div class="posttext">I know where was problem - the ';' character was placed immediately after last character of macro. No whitespaces.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gustavo-serra</div><div class="date">1st November 2007, 13:40</div></div><div class="posttext">I am having this problem, I have searched the forum for 'ExecWait macro' and found this thread. The compiler says that I am passing 8 arguments to ExecWait. This is my macro:<br />
!macro MyExecWait comando<br />
	ExecWait ${comando}<br />
	IfErrors +1 +3<br />
		${MSG_ERROR} 'NÃ£o foi possÃ_vel executar comando. InstalaÃ§Ã£o serÃ¡ abortada'<br />
		Abort<br />
!macroend<br />
!define MyExecWait '!insertmacro MyExecWait'<br />
<br />
And I call it this way:<br />
<br />
${MyExecWait} 'mysqldump -uroot -p123456 -a -c -r $INSTDIR\backup\controle.sql controle'<br />
<br />
pospec I noticed that your ExecWait call does not use ${} around the command. I have tryed this, but then the ExecWait will execute 'command', literally.<br />
<br />
Any help, please?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrDan</div><div class="date">1st November 2007, 13:56</div></div><div class="posttext">gustavo-serra, you need to do something like this to solve the problem:<br />
<br />
<br />
!macro MyExecWait comando<br />
ExecWait &quot;${comando}&quot;<br />
IfErrors +1 +3<br />
${MSG_ERROR} 'NÃ£o foi possï¿½_vel executar comando. InstalaÃ§Ã£o serÃ¡ abortada'<br />
.<br />
.<br />
.<br />
<br />
<br />
Note the additional two &quot; on the ExecWait line.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gustavo-serra</div><div class="date">1st November 2007, 14:42</div></div><div class="posttext">I have just done this. However, I had to change my old commands, for example:<br />
ExecWait 'mysql -e&quot;commands to mysql&quot;'<br />
to<br />
${MyExecWait} 'mysql -e$\&quot;commands to mysql$\&quot;'<br />
<br />
Is this the normal behavior? If so, then everything is solved.<br />
Thanks for the help!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st November 2007, 15:30</div></div><div class="posttext">If you think about it, if you pass 'my name is &quot;stu&quot;' into your macro as argument which in turn places it in Command &quot;${argument}&quot;, then Command &quot;${argument}&quot; will become Command &quot;my name is &quot;stu&quot;&quot; which is of course an invalid string. Best thing to do is to use ``: Command `${argument}`.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gustavo-serra</div><div class="date">1st November 2007, 16:47</div></div><div class="posttext">Oh! Thanks! I didn't know that I could use ` to group arguments. :-)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>