<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Best Practices, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Best Practices NSIS Discussion" />
	
	<title> Best Practices [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Best Practices</div>
<hr />
<div class="pda"><a href="t-221898.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221898">Best Practices</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ddod</div><div class="date">19th July 2005, 20:30</div></div><div class="posttext">I have been reading the forum and the wiki for about a week now and still have a few questions about the best way to implement a few things as well as a few questions.<br />
<br />
First off here is what I am doing.  I am creating a custom dialog that gets some user input (select one of two options via radio button in a group box).  Based on this I either delete a file or don't and then start an external MSI (wrapped in an exe).<br />
<br />
I am having very sporadic and inconsistant results when reading the state of the the radio buttons.  I think that this may be because I am saving the state in the post callback function of the custom page (is this too soon?).  Here is the order of the pages.<br />
<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_INSTFILES<br />
Page custom SelectInstall runMSI<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
my SelectInstall looks like this.<br />
<br />
Function SelectInstall<br />
         !insertmacro MUI_HEADER_TEXT &quot;$(INSTALLOPS_TITLE)&quot; &quot;$(INSTALLOPS_SUBTITLE)&quot;<br />
         !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;InstallOps&quot;<br />
         !insertmacro MUI_INSTALLOPTIONS_READ $InstTypes &quot;InstallOps&quot; &quot;Field 3&quot; &quot;State&quot;<br />
FunctionEnd<br />
<br />
my runMSI looks like this<br />
<br />
Function runMSI<br />
         StrCmp $InstTypes &quot;1&quot; 0 InstallUn<br />
                MessageBox MB_ICONINFORMATION|MB_OK &quot;Running managed $InstTypes&quot;<br />
                ExecWait '&quot;$INSTDIR\setup.exe&quot; '<br />
                Goto DoneInstall<br />
                InstallUn:<br />
                MessageBox MB_ICONINFORMATION|MB_OK &quot;Running UnManaged $InstTypes&quot;<br />
                Delete &quot;$INSTDIR\GRC.DAT&quot;<br />
                ExecWait '&quot;$INSTDIR\setup.exe&quot; '<br />
<br />
                DoneInstall:<br />
        Exec '&quot;$INSTDIR\uninst.exe&quot; /S'<br />
FunctionEnd<br />
<br />
This is where I am currently at.  I am really excited about NSIS.  I think it will be very useful if I can become proficient in it.  <br />
<br />
Ultimately I would like to know when it is most appropriate to run an external setup (and can the NSIS installer be minimized until the second installer finishes?)<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ddod</div><div class="date">19th July 2005, 20:43</div></div><div class="posttext">Well I solved the sporadic results of the radio button by moving the line<br />
<br />
!insertmacro MUI_INSTALLOPTIONS_READ $InstTypes &quot;InstallOps&quot; &quot;Field 3&quot; &quot;State&quot;<br />
<br />
to my runMSI function right before my StrCmp.  (I am still what functions can be called from where). <br />
<br />
However I am still curious to know anyone's opinion on the best practives for organization.  Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">20th July 2005, 04:52</div></div><div class="posttext">As far as I know, the installoptions INI file does not actually get changed until an event happens to allow the DLL to write the info back to the INI file.  Therefore, you always want to check for the state of the controls on the page's leave function (as you've probably figured out.)<br />
<br />
You can also call an ABORT command in the page's leave function to prevent the next page from loading.  <br />
<br />
For more hints on proper organization, check out the example scripts contained in ${NSISDIR}\Examples\InstallOptions. Or, if using MUI, check out ${NSISDIR}\Examples\Modern UI.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ddod</div><div class="date">20th July 2005, 16:12</div></div><div class="posttext">Thanks</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>