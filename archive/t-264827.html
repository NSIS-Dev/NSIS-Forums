<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" language settings on custom page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  language settings on custom page NSIS Discussion" />
	
	<title> language settings on custom page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  language settings on custom page</div>
<hr />
<div class="pda"><a href="t-264827.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=264827">language settings on custom page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Marcus1807</div><div class="date">1st February 2007, 11:19</div></div><div class="posttext">Hi, <br />
<br />
how can I change the language on a customPage? <br />
I've coded the texts hard into the installer script.<br />
But ho can I change the language with the language dialog?<br />
Any ideas?<br />
<br />
Thanks...<br />
here is my code:<br />
<br />
<br />
; Script generated by the HM NIS Edit Script Wizard.<br />
!include WinMessages.nsh<br />
!include LogicLib.nsh<br />
<br />
; MUI 1.67 compatible ------<br />
!include &quot;MUI.nsh&quot;<br />
<br />
; Language Selection Dialog Settings<br />
!define MUI_LANGDLL_REGISTRY_ROOT &quot;${PRODUCT_UNINST_ROOT_KEY}&quot;<br />
!define MUI_LANGDLL_REGISTRY_KEY &quot;${PRODUCT_UNINST_KEY}&quot;<br />
!define MUI_LANGDLL_REGISTRY_VALUENAME &quot;NSIS:Language&quot;<br />
<br />
; Welcome page<br />
 !insertmacro MUI_PAGE_WELCOME<br />
;Custum Function<br />
  Page custom showCheckSummary leaveCheckSummary<br />
; License page<br />
 !define MUI_LICENSEPAGE_CHECKBOX<br />
 !insertmacro MUI_PAGE_LICENSE &quot;Prototype.txt&quot;<br />
; Directory page<br />
 !insertmacro MUI_PAGE_DIRECTORY<br />
; Instfiles page<br />
 !insertmacro MUI_PAGE_INSTFILES<br />
; Finish page<br />
 !insertmacro MUI_PAGE_FINISH<br />
; Uninstaller pages<br />
 !insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
; Language files<br />
 !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
 !insertmacro MUI_LANGUAGE &quot;German&quot;<br />
<br />
; MUI end ------<br />
<br />
Name &quot;${PRODUCT_NAME}&quot;<br />
OutFile &quot;Setup_ADEPAut.exe&quot;<br />
<br />
;VAR INI_VALUE<br />
VAR ERROR_MESSAGE<br />
<br />
<br />
Function showCheckSummary<br />
 !insertmacro MUI_HEADER_TEXT &quot;Environment errors&quot; &quot;The following environment checks failed.&quot;<br />
 <br />
 ;if no errors were found go to done else goto notEqual<br />
 strcmp $9 &quot;false&quot; done notEqual<br />
 notEqual:<br />
  ;writeinistr &quot;$PLUGINSDIR\checkSummary.ini&quot; &quot;FIELD 3&quot; &quot;State&quot; &quot;0&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;checkSummary.ini&quot; &quot;FIELD 3&quot; &quot;State&quot; &quot;0&quot;<br />
  ;disable next button<br />
  GetDlgItem $R0 $HWNDPARENT 1<br />
  EnableWindow $R0 0<br />
<br />
  ;writeinistr &quot;$PLUGINSDIR\checkSummary.ini&quot; &quot;FIELD 2&quot; &quot;State&quot; &quot;$ERROR_MESSAGE&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;checkSummary.ini&quot; &quot;FIELD 2&quot; &quot;State&quot; &quot;$ERROR_MESSAGE&quot;<br />
<br />
  InstallOptions::InitDialog /NOUNLOAD &quot;$PLUGINSDIR\checkSummary.ini&quot;<br />
  <br />
  ;ReadINIStr &quot;$0&quot; &quot;$PLUGINSDIR\checkSummary.ini&quot; &quot;FIELD 2&quot; &quot;HWND&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $0 &quot;checkSummary.ini&quot; 'Field 2' 'HWND'<br />
  SetCtlColors $0 0x000000 0xFFFFFF<br />
<br />
  InstallOptions::Show '$PLUGINSDIR\checkSummary.ini'<br />
<br />
 done:<br />
FunctionEnd<br />
<br />
<br />
Function leaveCheckSummary<br />
 ;readinistr $0 '$PLUGINSDIR\checkSummary.ini' 'Settings' 'State'<br />
 !insertmacro MUI_INSTALLOPTIONS_READ $0 &quot;checkSummary.ini&quot; &quot;Settings&quot; &quot;State&quot;<br />
 ${if} $0 == 1<br />
<br />
 ${elseif} $0 == 3<br />
   ;readinistr $3 '$PLUGINSDIR\checkSummary.ini' 'Field 3' 'State'<br />
   !insertmacro MUI_INSTALLOPTIONS_READ $3 &quot;checkSummary.ini&quot; &quot;FIELD 3&quot; &quot;State&quot;<br />
   ${if} $3 == 1<br />
    GetDlgItem $R0 $HWNDPARENT 1<br />
    EnableWindow $R0 1<br />
   ${else}<br />
    GetDlgItem $R0 $HWNDPARENT 1<br />
    EnableWindow $R0 0<br />
   ${endif}<br />
  abort<br />
 ${endif}<br />
FunctionEnd<br />
    <br />
<br />
Function .onInit<br />
<br />
 initpluginsdir<br />
 gettempfilename $0<br />
 rename $0 '$PLUGINSDIR\checksummary.ini'<br />
 call WriteIni<br />
<br />
  ;initialise $9 for error handling<br />
  strcpy $9 &quot;false&quot;<br />
<br />
 !insertmacro MUI_LANGDLL_DISPLAY<br />
<br />
 ;Check Version-Number<br />
 call CheckADVersion<br />
 <br />
 ;Read InstallDir<br />
 call GetInstallDir<br />
 StrCpy $INSTDIR &quot;$R0&quot;<br />
 StrCpy $INSTDIR &quot;...&quot;<br />
 <br />
 ;Check Simatic Version-Number<br />
 call CheckSimaticVersion<br />
<br />
 ;CheckWindow<br />
FunctionEnd<br />
<br />
<br />
InstallDirRegKey HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot;<br />
ShowInstDetails show<br />
ShowUnInstDetails show<br />
<br />
<br />
<br />
Section -Post<br />
  WriteUninstaller &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot; &quot;$INSTDIR\cmdhwconfig.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayName&quot; &quot;$(^Name)&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayIcon&quot; &quot;$INSTDIR\cmdhwconfig.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayVersion&quot; &quot;${PRODUCT_VERSION}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;URLInfoAbout&quot; &quot;${PRODUCT_WEB_SITE}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;Publisher&quot; &quot;${PRODUCT_PUBLISHER}&quot;<br />
SectionEnd<br />
<br />
<br />
Function GetInstallDir<br />
 ClearErrors<br />
 ReadRegStr $R0 HKLM &quot;&quot; &quot;PATH&quot;<br />
 IfErrors error done<br />
 error:<br />
  strcpy $9 &quot;true&quot;<br />
  strcpy $ERROR_MESSAGE &quot;$ERROR_MESSAGEError while reading Install Directory from Registry.\r\n\r\n&quot;<br />
  goto done<br />
 done:<br />
FunctionEnd<br />
<br />
Function CheckADVersion<br />
 ClearErrors<br />
 ReadRegStr $R1 HKLM &quot;&quot; &quot;RELEASE&quot;<br />
 IfErrors error noError<br />
 error:<br />
  strcpy $9 &quot;true&quot;<br />
  strcpy $ERROR_MESSAGE &quot;$ERROR_MESSAGEError while reading Releasenumber of AD_Core_2006 from Registry.\r\n\r\n&quot;<br />
  goto goOn<br />
 noError:<br />
  strLen $2 ${PRODUCT_VERSION}<br />
  strcpy $1 $R1 $2<br />
  strCmp ${PRODUCT_VERSION} $1 goOn<br />
    strcpy $9 &quot;true&quot;<br />
    strcpy $ERROR_MESSAGE &quot;$ERROR_MESSAGEWrong Releasenumber of AD_Core_2006 (Installed: $R1; Requested: ${PRODUCT_VERSION})\r\n\r\n&quot;<br />
    goto goOn<br />
 goOn:<br />
   goto done<br />
 done:<br />
FunctionEnd<br />
<br />
<br />
Function CheckSimaticVersion<br />
 ClearErrors<br />
 ReadRegStr $R2 HKLM &quot;&quot; &quot;RELEASE&quot;<br />
 IfErrors error noError<br />
 error:<br />
  strcpy $9 &quot;true&quot;<br />
  strcpy $ERROR_MESSAGE &quot;$ERROR_MESSAGEError while reading Releasenumber of  from Registry.\r\n\r\n&quot;<br />
  goto goOn<br />
 noError:<br />
  strLen $3 ${SIMATIC_VERSION}<br />
  strcpy $4 $R2 $3<br />
  strCmp ${SIMATIC_VERSION} $4 goOn<br />
   strcpy $9 &quot;true&quot;<br />
   strcpy $ERROR_MESSAGE &quot;$ERROR_MESSAGEWrong Releasenumber of STEP7 (Installed: $R2; Requested: ${SIMATIC_VERSION})\r\n\r\n&quot;<br />
   goto goOn<br />
 goOn:<br />
   goto done<br />
 done:<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Marcus1807</div><div class="date">1st February 2007, 11:22</div></div><div class="posttext">perhaps there is a registry key?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">1st February 2007, 12:11</div></div><div class="posttext">There is no need to post your entire script here.<br />
All you need is read the manual at 4.9.15.2 LangString<br />
and examine the included examples languages.nsi and MultiLanguage.nsi.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Marcus1807</div><div class="date">1st February 2007, 12:35</div></div><div class="posttext">ok I still found the examples and looked at it.<br />
<br />
so this has to work, or? :<br />
<br />
<br />
...<br />
; Language Selection Dialog Settings<br />
!define MUI_LANGDLL_REGISTRY_ROOT &quot;${PRODUCT_UNINST_ROOT_KEY}&quot;<br />
!define MUI_LANGDLL_REGISTRY_KEY &quot;${PRODUCT_UNINST_KEY}&quot;<br />
!define MUI_LANGDLL_REGISTRY_VALUENAME &quot;NSIS:Language&quot;<br />
<br />
; Language files<br />
 !insertmacro MUI_LANGUAGE &quot;German&quot;<br />
 !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
Function .onInit<br />
<br />
 ; Select Language<br />
 !insertmacro MUI_LANGDLL_DISPLAY<br />
<br />
!if ${LANG_GERMAN}<br />
   MessageBox MB_OK &quot;DEUTSCH&quot;<br />
 !else if ${LANG_ENGLISH}<br />
   MessageBox MB_OK &quot;ENGLISCH&quot;<br />
 !Endif<br />
FunctionEnd<br />
<br />
<br />
<br />
but it does not...why?<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">1st February 2007, 12:54</div></div><div class="posttext">The !if statements you're using are suitable for the compiler not for installer, use LogicLib instead.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Marcus1807</div><div class="date">1st February 2007, 14:06</div></div><div class="posttext">ok, now I tried this:<br />
<br />
LangString Message ${LANG_ENGLISH} &quot;Englisch&quot;<br />
LangString Message ${LANG_GERMAN} &quot;Deutsch&quot;<br />
...<br />
MessageBox MB_OK $(Message)<br />
<br />
this does not work.<br />
Then I tried it so:<br />
<br />
${if} ${LANG_GERMAN} <br />
   MessageBox MB_OK &quot;DEUTSCH&quot; <br />
${else} ${LANG_ENGLISH} <br />
   MessageBox MB_OK &quot;ENGLISCH&quot; <br />
${endif} <br />
<br />
what on hell is going wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Marcus1807</div><div class="date">1st February 2007, 14:57</div></div><div class="posttext">ok, now I have the mistake:<br />
<br />
I had to move the instruction <br />
call writeini<br />
from .onInit to showChecksummary.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">1st February 2007, 16:35</div></div><div class="posttext">Once you have defined all the desired multilingual text, (custom page's header and subheader text must be added into the page's create function) you have to replace all hard coded static text (labels, groupboxes, radios etc) with the corresponding multilingual message.<br />
<br />
<br />
Be aware when you write to ini e.g.<br />
type=groupbox<br />
text=$(GroupBox_Txt)<br />
<br />
The definition must already exist, so this can't be done into .onInit function.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>