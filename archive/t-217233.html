<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installer log, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installer log NSIS Discussion" />
	
	<title> Installer log [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installer log</div>
<hr />
<div class="pda"><a href="t-217233.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=217233">Installer log</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MichaelFlya</div><div class="date">27th May 2005, 21:34</div></div><div class="posttext">I am looking for ways to make a log and<br />
uninstall from it. So far I have found a<br />
way based on this Script (http://nsis.sourceforge.net/archive/viewpage.php?pageid=556) by Afrow Uk.<br />
<br />
I need to understand how to get a few<br />
things to work by log automatically.<br />
<br />
1. Uninstall folders that were created.<br />
<br />
It doesn't seem to do it. Altho I can do<br />
it by writting it in the Uninstaller section.<br />
<br />
Attached is the Script I have put together.<br />
<br />
If you know of better ways to do log<br />
installations please let me know !!!<br />
<br />
-MichaelFlya-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th May 2005, 22:45</div></div><div class="posttext">You probably missed this bit at the top:<br />
<br />
Note: ${SetOutPath} must be used in reverse order of the directory tree, for example:<br />
${SetOutPath} &quot;$INSTDIR\dir\subdir\anotherdir&quot;<br />
...<br />
${SetOutPath} &quot;$INSTDIR\dir\subdir&quot;<br />
...<br />
${SetOutPath} &quot;$INSTDIR\dir&quot;<br />
...<br />
...else directories will not be removed on uninstall. <br />
<br />
It won't delete the folders if they aren't empty.<br />
If you're really lazy then just change<br />
RMDir $R0  #is dir<br />
to<br />
RMDir /r $R0  #is dir<br />
<br />
Edit: I changed it to use RMDir /r now. I think that otherwise people will just get annoyed.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MichaelFlya</div><div class="date">27th May 2005, 23:05</div></div><div class="posttext">Well I understand that, but the Log puts<br />
directories before the file deletions.<br />
<br />
In that Script it only installs for example<br />
INSTALLERDIR1 with files in it. There is no<br />
Subfolders. I can't move SetOutPath there<br />
is no point in it. So it just doesn't write the<br />
log right. It should write The log to where<br />
the directories are after the files not before.<br />
<br />
-MichaelFlya-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th May 2005, 11:09</div></div><div class="posttext">Could you show me the code?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MichaelFlya</div><div class="date">28th May 2005, 14:23</div></div><div class="posttext">Well I have no idea why you couldn't<br />
see the attachment on the first post,<br />
but here you go I will attach it again.<br />
<br />
And since I am posting again I will just<br />
explain a few more questions I had on<br />
the to do list. If you can help me out.<br />
<br />
2.<br />
How could I make a log for a zip ? I have <br />
installations from sites that use zips and<br />
sometimes the contents may change and<br />
in order for me to uninstall them properly<br />
I would need a log of what was unzipped.<br />
<br />
3.<br />
How would I use it with *.* so all contents<br />
in the folder would be on log ?<br />
<br />
4.<br />
How could shortcuts also be logged ?<br />
<br />
5.<br />
How can Registry Keys be logged ?<br />
<br />
6.<br />
How can anything else besides folders and<br />
files be logged ? .. lol.<br />
<br />
<br />
-MichaelFlya-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MichaelFlya</div><div class="date">31st May 2005, 23:51</div></div><div class="posttext">The thing I need to log the most at the moment<br />
is a compressed zip folder. Is there a way to log<br />
a Zip while you extract it? That way I can remove<br />
only what was unzipped.<br />
<br />
-MichaelFlya-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MichaelFlya</div><div class="date">5th June 2005, 19:36</div></div><div class="posttext">I found a DLL that allows me to do some things.<br />
I am wondering if it's uses can be expanding on.<br />
<br />
(NsisLog.dll)<br />
Here is two links where you can find out about it:<br />
1.Nsislog About DLL (http://nsis.sourceforge.net/archive/nsisweb.php?page=526&amp;instances=0) <br />
2.Nsislog Download DLL (http://nsis.sourceforge.net/archive/download.php) <br />
<br />
<br />
<br />
Using this code with Afrow UK's code.<br />
(Not that it is needed to use together):<br />
<br />
<br />
Section -closelogfile<br />
 FileClose $UninstLog<br />
  nsislog::log &quot;$INSTDIR\uninstall.log&quot; &quot;$INSTDIR\INSTALLERDIR1&quot;<br />
  nsislog::log &quot;$INSTDIR\uninstall.log&quot; &quot;$INSTDIR\INSTALLERDIR2&quot;<br />
  SetFileAttributes &quot;$INSTDIR\${UninstLog}&quot; READONLY|SYSTEM<br />
SectionEnd<br />
<br />
<br />
Only place it can go because the NsisLog.dll can't write to the<br />
file until the file is closed from Afrow UK's process and it has<br />
to go right before the SetFileAttributes are set to read only.<br />
<br />
Also on another note I can get that same effect to work right <br />
with Afrow Uk's code and properly too if I do, for Example<br />
change the code for &quot;INSTALLERDIR1&quot; like this:<br />
<br />
<br />
(From the script I attached on a post above)<br />
<br />
<br />
Section &quot;Install Main&quot;<br />
 ${SetOutPath} &quot;$INSTDIR\INSTALLERDIR1&quot;<br />
 ${File} &quot;.\dir1\&quot; &quot;Doc1.txt&quot;<br />
 ${File} &quot;.\dir1\&quot; &quot;Doc2.txt&quot;<br />
 ${File} &quot;.\dir1\&quot; &quot;Doc3.txt&quot;<br />
SectionEnd<br />
<br />
Change to:<br />
<br />
<br />
<br />
Section &quot;Install Main&quot;<br />
SetOutPath &quot;$INSTDIR\INSTALLERDIR1&quot;<br />
 ${File} &quot;.\dir1\&quot; &quot;Doc1.txt&quot;<br />
 ${File} &quot;.\dir1\&quot; &quot;Doc2.txt&quot;<br />
 ${File} &quot;.\dir1\&quot; &quot;Doc3.txt&quot;<br />
${SetOutPath} &quot;$INSTDIR\INSTALLERDIR1&quot;<br />
SectionEnd<br />
<br />
<br />
That will write the log right, but it shouldn't have to be<br />
done that way. Back to the NsisLog.dll it looks like it would<br />
do more than just files &amp; folders. I have some more testing<br />
to do on it and more searching to do. I haven't yet found<br />
good or I should say &quot;Complete&quot; ways to make a log to<br />
uninstall from.<br />
<br />
<br />
-MichaelFlya-</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>