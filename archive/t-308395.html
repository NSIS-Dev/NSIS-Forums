<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Vista -  Check Box to Run File As Administrator, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Vista -  Check Box to Run File As Administrator NSIS Discussion" />
	
	<title> Vista -  Check Box to Run File As Administrator [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Vista -  Check Box to Run File As Administrator</div>
<hr />
<div class="pda"><a href="t-308395.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=308395">Vista -  Check Box to Run File As Administrator</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jacare30</div><div class="date">16th July 2009, 00:41</div></div><div class="posttext">This pertains to NSIS and Vista<br />
<br />
I can use NSIS to make an .exe run with Admin privileges when I install and then launch.<br />
<br />
However, if you right click the .exe (or file), the checkbox for &quot;Run As Administrator&quot; is not checked.<br />
<br />
Thus, when you reboot, you cannot launch the .exe as a user, you need to be an administrator.  This breaks my app.<br />
<br />
Does anyone here have any ideas on how to make this work?  Much thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th July 2009, 01:34</div></div><div class="posttext">http://stackoverflow.com/questions/258728/request-admin-privileges-for-java-app-on-windows-vista<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sullivrp</div><div class="date">24th July 2009, 16:20</div></div><div class="posttext">Thanks, Stu...this is part of the answer that I was looking for! I tested the suggested fix last night and it worked.<br />
<br />
In case anyone else needs set the Compatibility mode as well, you can set it in the same registry subkey!<br />
<br />
For those that write data to HKLM, I have verified that there does not need to be an entry in HKLM as this does not appear to do anything, it has to be in HKCU! I also do not see any problems with creating the subkey on non-Vista machines as everything appears to be working just fine on my XP machine with the registry subkey.<br />
<br />
; Sets the Compatibility mode to &quot;Windows XP (Service Pack 2)&quot; and the Privilege level to &quot;Run this program as an administrator&quot; <br />
<br />
WriteRegStr? HKCU &quot;Software\Microsoft\Windows NT\CurrentVersion?\AppCompatFlags?\Layers&quot; &quot;$INSTDIR\HelloWorld.exe&quot; &quot;WINXPSP2 RUNASADMIN&quot; <br />
<br />
The following is for your uninstaller so that the registry subkeys are removed: <br />
<br />
; Removes the subkey that sets the Compatibility mode to &quot;Windows XP (Service Pack 2)&quot; and the Privilege level to &quot;Run this program as an administrator&quot; <br />
<br />
DeleteRegValue? HKCU &quot;Software\Microsoft\Windows NT\CurrentVersion?\AppCompatFlags?\Layers&quot; &quot;$INSTDIR\HelloWorld.exe&quot; <br />
<br />
If you need to change the compatibility mode to something other than &quot;Windows XP (Service Pack 2)&quot;, follow the steps below to find out what is being written to the registry and use that instead of &quot;WINXPSP2&quot;!<br />
<br />
For the non-believers, before adding this code to your installer, you can test this by running regedit and verifying if the Software\Microsoft\Windows NT\CurrentVersion?\AppCompatFlags?\Layers key already exists in both the HKLM and HKCU. You will probably see the key under HKLM and no key under HKCU or at least that was what I experienced on my work and home laptops. <br />
<br />
On a Vista machine, once you verify that the key \ subkeys are not there right click an executable and manually set the Compatibility mode and the Privilege level. Refresh the Registry Editor window and you will see that a subkey has been added for that application in HKCU! Delete the subkey in the Registry Editor window or manually uncheck the Compatibility mode and the Privilege level to remove the subkey. Add the code to your installer, compile and run the new installer. Once your program has finished installing you should notice that the Compatibility mode and the Privilege level are already set.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>