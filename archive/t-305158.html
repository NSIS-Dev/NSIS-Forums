<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" WriteIniStr to insert values on a custom page?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  WriteIniStr to insert values on a custom page? NSIS Discussion" />
	
	<title> WriteIniStr to insert values on a custom page? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  WriteIniStr to insert values on a custom page?</div>
<hr />
<div class="pda"><a href="t-305158.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305158">WriteIniStr to insert values on a custom page?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">odyssey5</div><div class="date">9th April 2009, 15:09</div></div><div class="posttext">I have created a custom page in MUI including a field that should (if it exists) read a value from registry and pre-fill out the field with this value. So far this is somewhat working:<br />
<br />
ReadRegStr $1  HKLM &quot;regpath...&quot; ''<br />
WriteIniStr 'custom.ini' 'Field 3' 'State' '$0'<br />
<br />
However this does not just fill out the value in the custom page, but also alters my custom page ini-file.<br />
<br />
I want this file to be unaltered since I use it for the setup - How do I avoid this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th April 2009, 15:19</div></div><div class="posttext">Not quite sure what you mean when you say that you want the ini unaltered while you feed the ini field with the value however did you try SendMessage to feed the specific field when the custom page is initialized?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">odyssey5</div><div class="date">9th April 2009, 15:37</div></div><div class="posttext">Well, I created the ini just to create the custom dialog, but I want to feed the text-fields with some values. It's not my intention to write any ini-files as the final values are supposed to be written in registry.<br />
<br />
SendMessage may seem to do the job, but I don't understand the usage of it. Tried googling, with no help :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th April 2009, 15:47</div></div><div class="posttext">Why googling when you have the NSIS manual, the included examples and firstly this forum?<br />
SendMessage is built-in NSIS instruction and should be what you're looking for.<br />
You'll probably find dozens examples here in forum.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">odyssey5</div><div class="date">9th April 2009, 16:35</div></div><div class="posttext">I think this is the best example (http://forums.winamp.com/showthread.php?s=&amp;threadid=303378&amp;highlight=SendMessage) I can find, but I'm totally lost at all the addresses :(<br />
<br />
I'm new to this...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">odyssey5</div><div class="date">9th April 2009, 16:37</div></div><div class="posttext">So I can't post links? Great...<br />
<br />
h t t p://forums.winamp.com/showthread.php?s=&amp;threadid=303378&amp;highlight=SendMessage</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th April 2009, 20:33</div></div><div class="posttext">Okay, quick and dirty but you can get an idea:<br />
outfile test.exe<br />
<br />
!define my_custom_page '$PLUGINSDIR\custom.ini'<br />
<br />
!include mui.nsh<br />
!include winmessages.nsh<br />
<br />
page custom cCreate<br />
!insertmacro mui_page_instfiles<br />
<br />
!insertmacro mui_language english<br />
<br />
section -boo<br />
;<br />
sectionend<br />
<br />
Function .onInit<br />
InitPluginsDir<br />
writeinistr '${my_custom_page}' 'settings' 'numfields' '1'<br />
writeinistr '${my_custom_page}' &quot;Field 1&quot; &quot;Type&quot; &quot;Text&quot;<br />
writeinistr '${my_custom_page}' &quot;Field 1&quot; &quot;Flags&quot; &quot;&quot;<br />
writeinistr '${my_custom_page}' &quot;Field 1&quot; &quot;State&quot; &quot;The Quick Brown Fox Jumps Over The Lazy Mad Dog&quot;<br />
writeinistr '${my_custom_page}' &quot;Field 1&quot; &quot;Left&quot; &quot;10&quot;<br />
writeinistr '${my_custom_page}' &quot;Field 1&quot; &quot;Right&quot; &quot;-10&quot;<br />
writeinistr '${my_custom_page}' &quot;Field 1&quot; &quot;Top&quot; &quot;30&quot;<br />
writeinistr '${my_custom_page}' &quot;Field 1&quot; &quot;Bottom&quot; &quot;42&quot;<br />
Functionend<br />
<br />
function cCreate<br />
!insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;custom.ini&quot;<br />
<br />
ReadINIStr $1 &quot;${my_custom_page}&quot; &quot;Field 1&quot; &quot;hwnd&quot;<br />
SendMessage $1 ${EM_SETREADONLY} 1 0<br />
SetCtlColors $1 0x000000 0xFFFFFF<br />
ReadRegStr $R0 HKLM &quot;Software\NSIS&quot; &quot;&quot;<br />
SendMessage $1 ${WM_SETTEXT} 0 'STR:$R0'<br />
<br />
!insertmacro MUI_INSTALLOPTIONS_SHOW<br />
functionend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sprinleo</div><div class="date">17th September 2009, 07:54</div></div><div class="posttext">does anybody know what's the difference between WriteINIStr and INSTALLOPTIONS_WRITE, how are they different from each other ?<br />
<br />
thanks...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">17th September 2009, 11:05</div></div><div class="posttext">No difference, MUI_INSTALLOPTIONS_WRITE is just a macro using WriteINIStr:<br />
http://forums.winamp.com/showthread.php?postid=1610834</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sprinleo</div><div class="date">17th September 2009, 11:46</div></div><div class="posttext">ok, thanks for your quick reply, i am using this code display a custom page, but for some reason, this page is not being displayed at all, instead shows the subsequent page, thoughts ?<br />
<br />
WriteINIStr &quot;winst\DatabaseServer.ini&quot; &quot;Field 4&quot; &quot;State&quot; &quot;0&quot;<br />
				!insertmacro INSTALLOPTIONS_DISPLAY &quot;winst\DatabaseServer.ini&quot;</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>