<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Killing a Process, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Killing a Process NSIS Discussion" />
	
	<title> Killing a Process [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Killing a Process</div>
<hr />
<div class="pda"><a href="t-178356.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=178356">Killing a Process</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">b_avery@yahoo.c</div><div class="date">29th April 2004, 08:49</div></div><div class="posttext">I have a process on my machine which I need to kill off, I've tried:<br />
<br />
    System::Call 'user32::PostMessageA(i,i,i,i) i($0,${WM_CLOSE},0,0)'<br />
    SendMessage $0 &quot;000E&quot; 0 0  ; WM_GETTEXTLENGTH  ????<br />
    SendMessage $0 &quot;0002&quot; 0 0  ; WM_DESTROY<br />
    SendMessage $0 &quot;0082&quot; 0 0  ; WM_NCDESTROY<br />
    SendMessage $0 &quot;0111&quot; &quot;E141&quot; 0  ; WM_AppExit<br />
    SendMessage $0 &quot;16&quot; 0 0  ; WM_CLOSE<br />
<br />
But it does not working.<br />
<br />
Speaking to the developer he says you need to kill the process, like if you use Task manager and End Task.<br />
<br />
He has suggested using:<br />
<br />
getwindowthreadprocessid<br />
<br />
Anyone know how I can do this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">b_avery@yahoo.c</div><div class="date">29th April 2004, 09:17</div></div><div class="posttext">I think the calls you need to make are (in order)<br />
		1) FindWindow<br />
		2) GetWindowThreadProcessID<br />
		3) OpenProcess with PROCESS_TERMINATE<br />
		4) TerminateProcess, try a big exit code<br />
<br />
I can do the FindWindow okay.<br />
<br />
But how do I implement them into NSIS?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">29th April 2004, 12:33</div></div><div class="posttext">Not Tested:<br />
<br />
!define PROCESS_TERMINATE 0x0001<br />
<br />
FindWindow $0 &quot;WindowClass&quot;<br />
System::Call &quot;User32::GetWindowThreadProcessId(i,*i)i(r0,.r0)&quot;<br />
System::Call &quot;Kernel32::OpenProcess(i,i,i)i (${PROCESS_TERMINATE}, 1, r0) .r0&quot;<br />
System::Call &quot;Kernel32::GetExitCodeProcess(i,*i)i (r0,.r1)&quot;<br />
System::Call &quot;Kernel32::TerminateProcess(i,i)i (r0,r1)&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evilO</div><div class="date">29th April 2004, 15:07</div></div><div class="posttext">Hi :)<br />
<br />
There is a nice plugin that just does everything for you : KillProcDll<br />
<br />
It can be found here :<br />
http://nsis.sourceforge.net/archive/download.php<br />
<br />
evilO/Olive</div></div><hr />


<div class="post"><div class="posttop"><div class="username">b_avery@yahoo.c</div><div class="date">30th April 2004, 00:07</div></div><div class="posttext">Many thanks, tested and working on 98, ME, 2000 and XP.<br />
<br />
But the Kill Process fails on NT Workstation  :-(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evilO</div><div class="date">30th April 2004, 08:17</div></div><div class="posttext">Doh !! I didn't know that :eek: ! <br />
Well, sorry :( ...<br />
<br />
evilO/Olive</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">4th May 2004, 17:08</div></div><div class="posttext">You can also try nopey.  Which is available in the archive here at the bottom.  <br />
<br />
http://nsis.sourceforge.net/archive/download.php<br />
<br />
Killing processes is one of it's features.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">4th May 2004, 22:23</div></div><div class="posttext">I'm impressed with my code posted above, I didn't test at that time (I was going to school) and it worked when I tested it now. It's rare to work when I don't test.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">10th June 2004, 19:58</div></div><div class="posttext">deguix<br />
<br />
GetExitCodeProcess() in your script will always return STILL_RUNNING, <br />
and next TerminateProcess() sets STILL_RUNNING as process exit code. Another words, after process was terminated and while process handle is not closed (CloseHandle()), any following GetExitCodeProcess() call will return STILL_RUNNING â€“ little confusing situation :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>