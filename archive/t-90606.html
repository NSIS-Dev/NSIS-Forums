<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" more nt/2k permissions, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  more nt/2k permissions NSIS Discussion" />
	
	<title> more nt/2k permissions [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  more nt/2k permissions</div>
<hr />
<div class="pda"><a href="t-90606.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=90606">more nt/2k permissions</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">VortX21</div><div class="date">10th June 2002, 20:09</div></div><div class="posttext">anyone have a way to grant full permissions to a win2k/nt registry key? ie I want everybody to be able to use a key in HKLM/Software.<br />
I hate to do something like shell regini, though I'm already having to shell CACLS to grant permissions on my DLLs.<br />
Somebody must have made this work already.<br />
Thanks<br />
-Carl</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">10th June 2002, 21:00</div></div><div class="posttext">What you want is easy at a C code level, just the application of a  null security descriptor to the registry key. If you don't have get a satisfactory answer to this I can knock up a minature extension dll with a single function in it to do the job for you (I assume you are looking for a simpler more immediate solution than this but I thought I'd offer anyway).<br />
<br />
---<br />
<br />
Ximon Eighteen<br />
Programmer @ Advent Publishing Systems<br />
email: ximon_eighteen@3b2.com<br />
&amp; msn: ximon_eighteen@hotmail.com</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">11th June 2002, 00:45</div></div><div class="posttext">Right since there was no answer given to your problem I created a small (4k) extension dll to answer your woes.<br />
<br />
Get it here: http://www.clantpa.co.uk/nsis/x18regkeyV0.0.zip [ ~8k ]<br />
<br />
It contains a single function callable from an NSIS script. The function is called RemoveRegKeySecurity and expects a registry key name on the stack. The zip file contains more explicit documentation about how to specify the key name and what success or error codes you can expect in return.<br />
<br />
This was written specifically for your problem so it doesn't contain any other functionality. If you want anything else or anyone else has a request then if its related I'll add it to that file in a new version, or else I'll just make another one. This is so I can bundle related functionality together.<br />
<br />
I hope it works. I've made sure that the link and the uploaded zip file work perfectly (I had trouble with another one earlier today as you might have seen) and I think that the code works correctly. However since you have a real use for this code you will be the best judge. <br />
<br />
I know how to create a null security descriptor and apply it to an object (in this case a registry key) and as far as I understand it this clears all security on the key (ie makes it fully accessible to everyone). However, I haven't got a means of testing this at the mo (I'm tired, maybe there is an obvious way, prolly just create a dummy user a log off and back on ;-)) so I've got my fingers crossed.<br />
<br />
Feel free to get back to me about suggestions/criticisms/etc and definitely get back to me either by email or in here if you have a problem with the dll.<br />
<br />
---<br />
<br />
Ximon Eighteen<br />
Programmer @ Advent Publishing Systems<br />
email: ximon_eighteen@3b2.com<br />
&amp; msn: ximon_eighteen@hotmail.com</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VortX21</div><div class="date">11th June 2002, 21:20</div></div><div class="posttext">Wow, thanks SJ :D<br />
That dll works great - my win2k installs run nice and smoothly now. Very nice to be able to do this from NSIS instead of creating a separate app.<br />
Thanks again!<br />
-Carl</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">11th June 2002, 23:18</div></div><div class="posttext">Glad I could help. Did you say you were using a separate program to grant permissions on DLLs? If you don't want to be using other programs I could do something about that too if you like. If so just drop me a line to say what you'd need it to do and I'll tell you if I can do it or not.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VortX21</div><div class="date">12th June 2002, 15:02</div></div><div class="posttext">That would be really cool - if you could have your dll do both registry key security permissions and file security permissions, it'd be what a lot of people (like me) need to make installs that work well in nt/2k. Right now I shell cacls on each dll which pops up a little black dos box momentarily each time. kinda messy<br />
-Carl</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">12th June 2002, 15:16</div></div><div class="posttext">Sorry for the specific nature of this post, I'm just trying to find out exactly what to implement for you (and anyone else).<br />
<br />
<br />
 How much of the CACLS functionality do you want/require? <br />
 Is there anything not provided that you would like?<br />
 Is there anything done by CACLS that you would like to see done differently?<br />
 Specifically, of the /t /e /c /g /r /p /d options which do you want to see supported?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VortX21</div><div class="date">12th June 2002, 18:55</div></div><div class="posttext">Well, all I'm using right now is<br />
<br />
CACLS bob.dll /e /g Users:R<br />
<br />
by doing<br />
<br />
ExecShell &quot;&quot;  &quot;CACLS&quot; &quot;$0 /e /g Users:R&quot;<br />
<br />
All I need to do functionally is make each file readable by anyone who uses the computer. Anything else is bonus :)<br />
-Carl</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">14th June 2002, 03:54</div></div><div class="posttext">Okay I'll do this soon (turns out I need it too for something else so it really will be sooner rather than later)...<br />
<br />
Instead of me keep posting in here you can keep an eye on this project on my new forum here (http://www.clantpa.co.uk/nsis/forum) (there's a note about this specifically here (http://www.clantpa.co.uk/nsis/forum/viewtopic.php?p=7#7))</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Piotr Strycharz</div><div class="date">17th June 2002, 14:49</div></div><div class="posttext">&gt; Okay I'll do this soon<br />
<br />
This would be the feature I will love, too.<br />
However, please note, that Windows group names are different in different languages (the &quot;Everyone&quot; group in my language is &quot;Wszyscy&quot;), so support for SIDs (or LookupAccountSid function) would be very nice feature.<br />
Actually what I need is to remove ACE &quot;Everyone&quot; from file to secure it after installation.<br />
<br />
-- Piotr.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">17th June 2002, 15:44</div></div><div class="posttext">Thanks for pointing that out. The &quot;Well Known&quot; sids of which Everyone is one are a special case anyway that are accessed at a code level using bit masks rather than names so the exact spelling will not be an issue. If you hadn't mentioned it though I would possibly have introduced a language dependency without meaning to, I'll try and keep this in mind now when I do it.<br />
<br />
If you want to follow any development that occurs on this (I'm quite busy but I will need it v. soon) then keep an eye on this : http://www.clantpa.co.uk/nsis/forum/viewtopic.php?t=7<br />
<br />
Please post in that thread the exact details of any functionality you would like and I will do it as soon as I can.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>