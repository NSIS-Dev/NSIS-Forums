<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" System path, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  System path NSIS Discussion" />
	
	<title> System path [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  System path</div>
<hr />
<div class="pda"><a href="t-181030.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181030">System path</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">SprinklerHead</div><div class="date">24th May 2004, 13:13</div></div><div class="posttext">My installer modifies the system path. It adds two directories to the system path. For Windows 9x machines it updates autoexec.bat. For Windows NT based machines it modifies HKLM\System\CurrentControlSet\Control\Session Manager\Environment\. After the system path has been updated, then I register an ocx file.<br />
<br />
My ocx file has dependencies in the two directories I just added to the system path. The problem I am having is that I need the path updated before the installer exits because I need to register that ocx file. After adding these two directories to the system path, I do this:<br />
<br />
SendMessage ${HWND_BROADCAST} ${WM_WININICHANGE} 0 &quot;STR:Environment&quot; /TIMEOUT=5000<br />
<br />
I figured that this would refresh the system path for all running processes. This doesn't seem to be the case however. When I test my installer, I see that the path gets updated before the installer quits but the ocx file still fails to register. When the installer exits, I relaunch it and try installing again. The second time always works because I think the system path info is updated.<br />
<br />
Is there any truth to this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SprinklerHead</div><div class="date">24th May 2004, 13:14</div></div><div class="posttext">Oh, and I am testing on a Windows 2000 machine. I know on Windows 9x I will need a reboot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Davion</div><div class="date">24th May 2004, 14:48</div></div><div class="posttext">why not creating a dir in $WINDIR<br />
<br />
so you would have $WINDIR\Folder1 and $WINDIR\Folder2<br />
<br />
with which you can work<br />
<br />
registering the Dlls and ocx would look like this:<br />
<br />
 RegDLL &quot;$WINDIR\Folder1\FirstOne.DLL&quot;<br />
<br />
this would be a much better way than changing the system path<br />
I don't think you are able to do this, too</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th May 2004, 11:30</div></div><div class="posttext">Use the second method from the archive for temporary path changes or simply set the output path to the directory you need, assuming it's not more than one.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>