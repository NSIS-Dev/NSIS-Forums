<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" close windows Explorer, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  close windows Explorer NSIS Discussion" />
	
	<title> close windows Explorer [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  close windows Explorer</div>
<hr />
<div class="pda"><a href="t-177246.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=177246">close windows Explorer</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">tommy916</div><div class="date">19th April 2004, 17:57</div></div><div class="posttext">How do I close all the Windows Explorer on init?<br />
<br />
I looked at this link but it's for IE browser. http://nsis.sourceforge.net/archive/nsisweb.php?page=111&amp;instances=0,11</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">19th April 2004, 18:08</div></div><div class="posttext">The whole Windows desktop is based on explorer, that isn't something you should close.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tommy916</div><div class="date">19th April 2004, 19:15</div></div><div class="posttext">ok i guess i have to find other way.<br />
<br />
How do you ignore the error and then go to the next line. This is to put the file blah.dll into the folder but the dll is currently used which is in the Windows Explorer. since i can't close the explorer.<br />
<br />
Error opening file for writing: &quot;C:\blah\blah.dll&quot;<br />
Hit abore to abort installation, retry, ignore...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">19th April 2004, 19:24</div></div><div class="posttext">You'll have to use /REBOOTOK and let the user reboot the computer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">keitsi</div><div class="date">21st April 2004, 05:17</div></div><div class="posttext">I would write a VB6 .exe, and use the FindFindow and SendMessage APIs.<br />
(first, find a explorer window based on name with findwindow. then send the window a WM_CLOSE integer)<br />
I've used this with VB6, but those APIs are available to other languages as well.<br />
<br />
Hmm, after a second thought you can't find the windows based on window titles since it may be the folder name as well :)<br />
Well you could look into some windows APIs and write an exe to be included in the installer to do the job.<br />
<br />
EDIT: VB6 code that could work. You could find the open windows based on classname, instead of title.<br />
<br />
<br />
Private Declare Function FindWindow Lib &quot;user32&quot; Alias &quot;FindWindowA&quot; (ByVal lpClassName As String, ByVal lpWindowName As String) As Long<br />
Private Declare Function PostMessage Lib &quot;user32&quot; Alias &quot;PostMessageA&quot; (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long<br />
Private Declare Function GetClassName Lib &quot;user32&quot; Alias &quot;GetClassNameA&quot; (ByVal hwnd As Long, ByVal lpClassName As String, ByVal nMaxCount As Long) As Long<br />
Private Declare Function ShowWindow Lib &quot;user32&quot; (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long<br />
Const SW_SHOWNORMAL = 1<br />
Const WM_CLOSE = &amp;H10<br />
Const gcClassnameMSWord = &quot;OpusApp&quot;<br />
Const gcClassnameMSExcel = &quot;XLMAIN&quot;<br />
Const gcClassnameMSIExplorer = &quot;IEFrame&quot;<br />
Const gcClassnameMSVBasic = &quot;wndclass_desked_gsk&quot;<br />
Const gcClassnameNotePad = &quot;Notepad&quot;<br />
Const gcClassnameMyVBApp = &quot;ThunderForm&quot;<br />
Private Sub Form_Load()<br />
    'KPD-Team 1998<br />
    'URL: http://www.allapi.net/<br />
    'E-Mail: KPDTeam@Allapi.net<br />
    Dim WinWnd As Long, Ret As String, RetVal As Long, lpClassName As String<br />
    'Ask for a Window title<br />
    Ret = InputBox(&quot;Enter the exact window title:&quot; + Chr$(13) + Chr$(10) + &quot;Note: must be an exact match&quot;)<br />
    'Search the window<br />
    WinWnd = FindWindow(vbNullString, Ret)<br />
    If WinWnd = 0 Then MsgBox &quot;Couldn't find the window ...&quot;: Exit Sub<br />
    'Show the window<br />
    ShowWindow WinWnd, SW_SHOWNORMAL<br />
    'Create a buffer<br />
    lpClassName = Space(256)<br />
    'retrieve the class name<br />
    RetVal = GetClassName(WinWnd, lpClassName, 256)<br />
    'Show the classname<br />
    MsgBox &quot;Classname: &quot; + Left$(lpClassName, RetVal)<br />
    'Post a message to the window to close itself<br />
    PostMessage WinWnd, WM_CLOSE, 0&amp;, 0&amp;<br />
End Sub</div></div><hr />


<div class="post"><div class="posttop"><div class="username">keitsi</div><div class="date">21st April 2004, 06:19</div></div><div class="posttext">Here, it just seemed too easy :P<br />
<br />
You may use it from command line, i.e. run:<br />
wcloser.exe ExploreWClass<br />
.. to close all explorer windows. Also has a GUI to test it.<br />
<br />
http://lappi.skai.fi/~mikkoko/vbmodules/prjWindowCloser.zip</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">21st April 2004, 09:35</div></div><div class="posttext">First of all explorer.exe should not be closed because it is the whole Windows desktop. It also doesn't have a window title.<br />
<br />
The same thing can also be done using NSIS script code without VB6. When using a VB6 executable your installer will have to include the VB6 runtimes, which is a bit overkill for such a simple thing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">keitsi</div><div class="date">22nd April 2004, 03:16</div></div><div class="posttext">First of all explorer.exe should not be closed because it is the whole Windows desktop.<br />
true dat, it's annoying when you lose all the systray icons. <br />
<br />
The same thing can also be done using NSIS script code without VB6. When using a VB6 executable your installer will have to include the VB6 runtimes, which is a bit overkill for such a simple thing.<br />
I have no idea how I should do with nsis, and with vb it took like 5 minutes.<br />
<br />
I'm using nsis mostly for vb6 installers so the runtimes for wcloser aren't a big problem since the runtimes are already installed when I run it :P</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">22nd April 2004, 10:25</div></div><div class="posttext">NSIS has a FindWindow and SendMessage command.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>