<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Need to get URL from all open Browser Windows, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Need to get URL from all open Browser Windows NSIS Discussion" />
	
	<title> Need to get URL from all open Browser Windows [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Need to get URL from all open Browser Windows</div>
<hr />
<div class="pda"><a href="t-169240.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=169240">Need to get URL from all open Browser Windows</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">delmardale</div><div class="date">13th February 2004, 18:12</div></div><div class="posttext">I am trying to configure a setup that will figured out where it was downloaded from, so it can then go out and download files based on your setup selections.  This will be installed at various servers around the world, so URL's can't be hardcoded.  The webpage automatically downloads and launches the setup when you go to the page.  So I plan to look at URL's of open browser windows to get the server.   Anyway I've got the code so far using the System plugin to get the URL from an IE window.  However I need a way to loop through all open IE windows.  It appears there is a windows API function called EnumWindows which should then callback to the application function.  However I can't figure out how to do this in NSIS.  Below is code go get the URL from an IE window.<br />
<br />
Could someone show me or point me to some examples of how to perform this callback.  Or tell me another way I can get the window handles of open IE windows.<br />
<br />
Once I tackle IE, then I'll work on Mozilla/Netscape.<br />
<br />
     FindWindow $hWndIE &quot;IEFrame&quot;<br />
     IntCmp $hWndIE 0 done<br />
     MessageBox MB_OK &quot;found IE window&quot;<br />
     FindWindow $hWndIEChild &quot;WorkerW&quot; &quot;&quot; $hWndIE<br />
     FindWindow $hWndIEChild &quot;ReBarWindow32&quot; &quot;&quot; $hWndIEChild<br />
     FindWindow $hWndIEChild &quot;ComboBoxEx32&quot; &quot;&quot; $hWndIEChild<br />
     System::Call 'user32::SendMessage(i,i,i,t) i($hWndIEChild, ${WM_GETTEXT},255,.r0)'<br />
     StrCpy $URLString &quot;$0&quot;<br />
     MessageBox MB_OK &quot;$URLString&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th February 2004, 18:23</div></div><div class="posttext">This is really an unreliable method. I recommend you to let it send a command line parameter.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">delmardale</div><div class="date">13th February 2004, 18:44</div></div><div class="posttext">Can not do command line, because somehow the URL to download from must be passed.  End user can not be expected to know it.  Also this setup launches automatically when downloaded from the site.  So it's a pretty safe bet that the browser window is still open to the URL.  My plan is if it can't find it, it will then prompt the end user for URL</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th February 2004, 18:47</div></div><div class="posttext">You can never be sure what is open and what is not open. You can also not be sure Internet Explorer will be used. I sugggest you append the URL to the installer on the server side, read it from the end of the file on the client side and use it or prompt if not found.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">delmardale</div><div class="date">13th February 2004, 18:55</div></div><div class="posttext">Not a bad idea.  That will just require appending the server name to the end of the file at each of our 130 sites, annoying but doable.  Won't the exe get corrupted though.  also have any sample code?<br />
<br />
Regarding the browser issue.  As of right now we only support IE.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th February 2004, 18:58</div></div><div class="posttext">You don't have to manually append the URL. Use a PHP script which will output the EXE and then the server's address. It won't corrupt the installer as long as you don't use NSIS_CONFIG_CRC_ANAL.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">14th February 2004, 04:03</div></div><div class="posttext">If you want the open browser windows in Internet Explorer you will have to use DDE.  If you don't know what DDE is, then I wouldn't even try it.  Its not too bad, but would probably require a plugin.  It works on any browsers that support the DDE calls.  Probably IE and Opera and maybe a few others.<br />
<br />
You would make these DDE requests:<br />
WWW_ListWindows (to get the window)<br />
WWW_GetWindowInfo (to get the window url)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">delmardale</div><div class="date">18th February 2004, 21:04</div></div><div class="posttext">I've decided to go with kichik's approach of appending server information to the end of the setup dynamically with some sort of CGI script.  Anybody got a code sample of how to get my NSIS setup to read this data off the end of the file?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>