<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Windows 7 and File Association, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Windows 7 and File Association NSIS Discussion" />
	
	<title> Windows 7 and File Association [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Windows 7 and File Association</div>
<hr />
<div class="pda"><a href="t-344997.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=344997">Windows 7 and File Association</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">20th May 2012, 01:32</div></div><div class="posttext">Hello everyone!<br />
<br />
It happened so that I start my posts from the question &quot;Is it possible or not?&quot; to solve my problem. As well as now actually.<br />
<br />
I have a simple media player and I want to associate media file types with it. I found VLC player installer script here and without further ado have placed some parts to my one. Unfortunately, my player becomes default for those file types only for which previously there wasn't defined any player or application. This means that if e.g. avi file was previously player with WMP by default after installing my player and associating avi with it WMP remains default program for this file type. <br />
<br />
But if I try to open avi file via context menu and &quot;Open with ...&quot; there my player is first in the list. Unfortunately, this doesn't help much.<br />
<br />
As I noticed during the installation of VLC the same problems occurs. <br />
<br />
So main question here: is it possible at all to associate application and file types via installer?<br />
<br />
P.S. To prevent possible suggestions of &quot;try to ... &quot; need to say that I'm known and already tried &quot;RequestExecutionLevel admin&quot;, &quot;UserInfo plug-in&quot;, &quot;UAC plug-in&quot; &quot;run as administrator&quot; with no luck or without confidence that problem is in admin privileges. <br />
<br />
Thank you for attention, reading and possible help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">21st May 2012, 19:31</div></div><div class="posttext">Ok, I hope absence of answers doesn't mean my problem is unsolvable, but those who know salvation haven't seen this post yet :) <br />
<br />
Probably anybody knows how to change:<br />
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.avi\UserChoice]<br />
&quot;Progid&quot;=&quot;WMP11.AssocFile.AVI&quot;<br />
<br />
with, e.g. <br />
&quot;Progid1&quot;=&quot;WMP11.AssocFile.AVI&quot;<br />
<br />
i.e. simply change &quot;Progid&quot; with &quot;Progid1&quot;<br />
<br />
I was unable to do this under administrator account.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">21st May 2012, 19:59</div></div><div class="posttext">You are not really supposed to mess with UserChoice, just follow the docs (http://msdn.microsoft.com/en-us/library/windows/desktop/cc144101%28v=vs.85%29.aspx)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">21st May 2012, 21:08</div></div><div class="posttext">You are not really supposed to mess with UserChoice, just follow the docs (http://msdn.microsoft.com/en-us/library/windows/desktop/cc144101%28v=vs.85%29.aspx)<br />
<br />
Thank you, but I don't have problems with Shortcuts.<br />
<br />
Any other ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">21st May 2012, 21:38</div></div><div class="posttext">AFAIR you need to go back to user level if you want to set at user level - see:<br />
<br />
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion<br />
<br />
I was unable to do this under administrator account.<br />
as admin it will go admins user settings.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">21st May 2012, 23:26</div></div><div class="posttext">AFAIR you need to go back to user level if you want to set at user level - see:<br />
<br />
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion<br />
<br />
<br />
I was unable to do this under administrator account.<br />
<br />
as admin it will go admins user settings.<br />
<br />
Well, probably it was a wrong way of salving my main problem. Anyway any thoughts about file association?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">21st May 2012, 23:39</div></div><div class="posttext">do it like vlc did<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.avi]<br />
&quot;VLC.backup&quot;=&quot;WMP11.AssocFile.AVI&quot;<br />
@=&quot;VLC.avi&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">22nd May 2012, 00:22</div></div><div class="posttext">do it like vlc did<br />
<br />
Once again need to that after installing VLC player files previously associated with WMP are still opened with WMP even if you associate them with VLC.<br />
<br />
That's why I'm here.<br />
<br />
Please don't reply if you haven't faced with such problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">22nd May 2012, 00:50</div></div><div class="posttext">Thank you, but I don't have problems with Shortcuts.<br />
<br />
Any other ideas?<br />
<br />
Actually read the page I linked to? That page also links to this  (http://msdn.microsoft.com/en-us/library/windows/desktop/cc144148%28v=vs.85%29.aspx). Those two pages link to all the information about registering file types...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">22nd May 2012, 02:27</div></div><div class="posttext">na, dont bother me with your dullness, i tried to help<br />
<br />
first - did you install vlc with your script or with the official setup?<br />
i guess your script is outdated and buggy wether i've seen it or not.<br />
<br />
second - you cant fix it your way - not possible<br />
<br />
third - you need to reconnect WMP to all its files<br />
then you need to clear up that vlc crap connections<br />
<br />
fourth - delete this tree<br />
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts<br />
you will loose some connections - just reconnect later<br />
<br />
reinstall vlc with official setup<br />
you can do that in sandboxie to grab the knowledge behind how it works.<br />
sandboxie forum offers tools for that<br />
otherwise install it normally<br />
<br />
much faster to repair something you dont get ATM<br />
<br />
HTH</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">22nd May 2012, 20:54</div></div><div class="posttext">Thank you, Anders. Will read more carefully.<br />
<br />
<br />
na, dont bother me with your dullness, i tried to help<br />
Brummelchen, words &quot;don't reply&quot; were not directed personally to you, so please don't be rude.<br />
<br />
first - did you install vlc with your script or with the official setup?<br />
<br />
Yes installer was taken from http://www.videolan.org/vlc/download-windows.html and after redirecting to http://sourceforge.net/ was downloaded, so it is official. Ans it's installer DOESN'T ASSOCIATE files with VLC player which were previously associated with WMP. To complete association you need to do this via VLC player later. It is confirmed! On clean system. Not by me only.<br />
<br />
i guess your script is outdated and buggy wether i've seen it or not.<br />
as you wish<br />
<br />
<br />
second - you cant fix it your way - not possible<br />
I'm beginning to think so to, too sad<br />
<br />
third - you need to reconnect WMP to all its files<br />
then you need to clear up that vlc crap connections<br />
VLC is not my goal. I just used it's installer's patrs with the only success with non-associated files and in this case it works fine.<br />
<br />
fourth - delete this tree<br />
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts<br />
you will loose some connections - just reconnect later<br />
<br />
I can't do this neither with installer nor with my admin rights ander admin account. And not only me.<br />
<br />
reinstall vlc with official setup<br />
you can do that in sandboxie to grab the knowledge behind how it works.<br />
sandboxie forum offers tools for that<br />
otherwise install it normally<br />
as I sad i don't need VLC<br />
<br />
much faster to repair something you dont get ATM<br />
No comments :) <br />
<br />
HTH<br />
Not really, since unfortunately your post is not connected with my NSIS problem. Anyway, thank you Brummelchen for your time and attention.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">23rd May 2012, 18:52</div></div><div class="posttext">Anders, thank you very much for the link which helped me to understand more deep file association in the Windows 7 (and Vista)<br />
<br />
Brummelchen, you were right regarding the<br />
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts<br />
my problem was exactly in the registry key, so thank you for pointing me there. <br />
<br />
At the moment I'm writing and testing clear version if installer, so when I finish I'll explain were I was wrong.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>