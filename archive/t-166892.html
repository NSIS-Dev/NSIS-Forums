<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" RegDLL and .OLB, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  RegDLL and .OLB NSIS Discussion" />
	
	<title> RegDLL and .OLB [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  RegDLL and .OLB</div>
<hr />
<div class="pda"><a href="t-166892.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=166892">RegDLL and .OLB</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">LazyBear</div><div class="date">27th January 2004, 14:39</div></div><div class="posttext">Thx guys! :D  my Setup is running fine, the only thing I have to do now is to get NSIS to register 3 .OLB Files (MSACC9.OLB, MSWORD8.OLB and MSWORD9.OLB) and I don't know how to - anyway I don't know how to register them without NSIS :rolleyes: I hope anybody knows how to realize that<br />
<br />
so long -L-B-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">opher</div><div class="date">27th January 2004, 17:37</div></div><div class="posttext">Hi,<br />
You have two options:<br />
  1. Use Regtlib.exe EXCEL9.OLB <br />
  2. Use a system call msdn (http://msdn.microsoft.com/library/default.asp?url=/library/en-us/automat/htm/chap9_0uk8.asp) <br />
<br />
For the former option see attached file,<br />
for the latter, perhaps someone more experianced with system.dll plugin can help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">27th January 2004, 18:16</div></div><div class="posttext">Regtlib is not include with all Windows versions. Using API calls is a better idea.<br />
<br />
I'm also looking for a good way to register type libaries for VB run-time installation etc.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LazyBear</div><div class="date">28th January 2004, 07:29</div></div><div class="posttext">I'll try it with the regtlib, I'll just install it into the $WINDIR with my setup and then call it. One more question:<br />
<br />
Can anyone give me a more detailed sample of using Exec and ExecShell? The only Examples I found where bigtest.nsi and viewhtml.nsi, and there is no example of using parameters<br />
<br />
thanks in advance<br />
<br />
-L-B-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">opher</div><div class="date">28th January 2004, 07:43</div></div><div class="posttext">Joost hello,<br />
Regtlib is not included with ANY version of windows.<br />
It is included in Visual Studio service pack 3 +.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LazyBear</div><div class="date">28th January 2004, 07:50</div></div><div class="posttext">No matter, 'cause you can include it in all of your setups - you just have to know how you use it with NSIS, thats what my problem is :D<br />
<br />
Well - if it's as easy as I think, I have just to call it like this:<br />
<br />
  SearchPath $6 REGTLIB.EXE<br />
	Exec '&quot;$6&quot;'<br />
    ExecShell &quot;&quot; '&quot;$INSTDIR&quot;' &quot;$SYSDIR\MSACC9.OLB&quot;<br />
<br />
Is this right?<br />
<br />
Unfortunately I don't know how to check if they have been registered, any idea?<br />
<br />
so long -L-B-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">opher</div><div class="date">28th January 2004, 09:49</div></div><div class="posttext">Not quite :D <br />
You use ExecWait '$SYSDIR\regtlib.exe &quot;D:\path to file\file to register&quot;'<br />
 - or -<br />
ExecWait '&quot;$PLUGINSDIR\regtlib.exe&quot; &quot;D:\path to file\file to register&quot;'<br />
Use Regtlib.exe -? for command line parameters.<br />
Ofcourse :D you have to preceed it with a File command for Regtlib.exe .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LazyBear</div><div class="date">28th January 2004, 12:42</div></div><div class="posttext">Ok, this works...but...<br />
If regtlib fails, I dont receive an error...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">opher</div><div class="date">28th January 2004, 13:54</div></div><div class="posttext">Look it up in the docs: :confused: ExecWait '&quot;$PLUGINSDIR\regtlib.exe&quot; &quot;D:\path to file\file to register&quot;' $R0Now $R0 has exit code!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LazyBear</div><div class="date">29th January 2004, 09:29</div></div><div class="posttext">Unfortunately it doesn't work<br />
but I solved it with<br />
<br />
ExecWait '$SYSDIR\USregOLB.BAT'<br />
<br />
So the User can see if there is an error.<br />
<br />
I know it's not the best way...but it works and for now it's an acceptable solution I think<br />
<br />
nevertheless thanks you all!<br />
<br />
-L-B-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">opher</div><div class="date">29th January 2004, 10:20</div></div><div class="posttext">Attached is a BAT file. As you can see it reports the error, so $R0 whould hold an error code!!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>