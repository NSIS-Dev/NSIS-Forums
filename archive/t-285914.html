<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Error Code 87 with CABSetup plugin, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Error Code 87 with CABSetup plugin NSIS Discussion" />
	
	<title> Error Code 87 with CABSetup plugin [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Error Code 87 with CABSetup plugin</div>
<hr />
<div class="pda"><a href="t-285914.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=285914">Error Code 87 with CABSetup plugin</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Vercoln</div><div class="date">29th January 2008, 22:08</div></div><div class="posttext">I am attempting to make a small NSIS script that will help me in the creation/extraction of cab files.  Currently, I am playing around with the CABSetup sample files to learn more about how to use the plugin.<br />
<br />
I was successful in creating the cab file.  Now, I wish to extract from the cab file.  However, I get an error code 87 before anything happens.  I'm wondering if anyone is able to help me figure out what's going on?<br />
<br />
A lot of the code is just copied from the sample, but here it is anyhow:<br />
<br />
Section ExtractCab<br />
    CABSetup::Extract &quot;C:\Installer\Test\MasterCab\Disk1\MASTER1.CAB&quot; &quot;/TARGET=C:\Installer\Test2&quot; \<br />
        /ALL &quot;/reportfile=C:\Installer\Test\MasterCab\MASTER.RPT&quot; \<br />
        &quot;/showrate&quot; &quot;/resume&quot;<br />
    Pop $R0<br />
<br />
    ; Quit if the extraction completed without error.<br />
    ${IfThen} $R0 = 0 ${|} Goto Done ${|}<br />
<br />
    ; Handle case where extraction was cancelled.<br />
    ${If} $R0 = 995<br />
        DetailPrint &quot;Extract process was cancelled&quot;<br />
        SetDetailsPrint None<br />
        Goto Done<br />
    ${EndIf}<br />
<br />
    DetailPrint &quot;Extract failed with error code $R0&quot;<br />
    Done:<br />
	<br />
	DetailPrint 'Dumping install details log...'<br />
	DumpLog::DumpLog 'test.log' .r0<br />
SectionEnd<br />
<br />
<br />
And here is the log output:<br />
Extract failed with error code 87<br />
Dumping install details log...<br />
<br />
<br />
If anyone has any ideas, let me know!  I could use the help.  I have never worked with cab files before.<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vercoln</div><div class="date">30th January 2008, 13:39</div></div><div class="posttext">Awww, dang.  I just figured out why it didn't work...<br />
<br />
CABSetup::Extract &quot;C:\Installer\Test\MasterCab\Disk1\MASTER1.CAB&quot; &quot;/TARGET=C:\Installer\Test2&quot; \<br />
        /ALL &quot;/reportfile=C:\Installer\Test\MasterCab\MASTER.RPT&quot; \<br />
        &quot;/showrate&quot; &quot;/resume&quot;<br />
<br />
is wrong and it SHOULD be<br />
<br />
CABSetup::Extract &quot;/SOURCE=C:\Installer\Test\MasterCab\Disk1\MASTER1.CAB&quot; &quot;/TARGET=C:\Installer\Test2&quot; \<br />
        /ALL &quot;/reportfile=C:\Installer\Test\MasterCab\MASTER.RPT&quot; \<br />
        &quot;/showrate&quot; &quot;/resume&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mr Inches</div><div class="date">31st January 2008, 14:12</div></div><div class="posttext">Any positive non-zero return code from the CABSetup functions will be a value that could be returned from the GetLastError Windows API function. The value -1 is returned if the normal error code could not be returned and should only happen if the system is extremely low on memory i.e. there is less than the length of an NSIS string free.<br />
<br />
Error 87 is as follows (from MSDN):<br />
<br />
ERROR_INVALID_PARAMETER<br />
87<br />
0x57<br />
	<br />
The parameter is incorrect.<br />
<br />
As you correctly noticed, one of the parameters passed to the function was incorrect - trying to extract files without a valid source cabinet or target path currently counts as specifying invalid parameters for Extract.<br />
<br />
Sounds like it might be an idea to add 87 and its meaning to the commonly returned error codes for each function in CABSetup.txt; I will do this for the next update.<br />
<br />
Duncan</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>