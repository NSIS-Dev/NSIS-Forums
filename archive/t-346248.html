<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Win2008R2, UAC, IIS and cross domain access..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Win2008R2, UAC, IIS and cross domain access... NSIS Discussion" />
	
	<title> Win2008R2, UAC, IIS and cross domain access... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Win2008R2, UAC, IIS and cross domain access...</div>
<hr />
<div class="pda"><a href="t-346248.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=346248">Win2008R2, UAC, IIS and cross domain access...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">LogicallyRogue</div><div class="date">10th July 2012, 05:26</div></div><div class="posttext">I have an NSIS installer for a web application.  The application process does the following:<br />
     - query IIS for all virtual websites<br />
     - create local/AD users<br />
     - create IIS application pools<br />
     - create IIS application directories<br />
     - create IIS virtual directories<br />
     - apply NTFS file permissions<br />
     - create SQL Database<br />
<br />
In my NSIS installer, I have &quot;RequestExecutionLevel admin&quot;<br />
<br />
If I am installing on a single Windows 2008+ computer, all is well.<br />
If I am installing on a single Windows 2003 computer, all is well.<br />
If I am installing on a Windows 2003 webserver and remote (on the same domain) SQL server of any Windows version, and am logged in as a domain administrator, all is well.<br />
<br />
When I am installing on a Windows 2008+ webserver and remote SQL server, I run into issues.<br />
<br />
It appears that I can do anything I want locally, but am unable to create AD level users or create the remote SQL Database.<br />
<br />
In researching UAC, I came across http://codefromthe70s.org/vistatutorial.aspx which explains that even though I am logged in as a Domain Administrator, I'm in an &quot;elevated account&quot; but does not retain access to remote computers as a Domain Admin.<br />
<br />
I've tried changing &quot;RequestExecutionLevel user&quot; and find that while I may still have access to domain computers, I no longer have any access to IIS as an administrator.<br />
<br />
Is there a happy medium?<br />
<br />
As I said, this installer works perfectly on a Windows 2003 server - it's just UAC causing me headaches.  Is there a specific NSIS UAC which someone would recommend to solve this issue?<br />
<br />
I'm at the head banging stage - so any advice would be extremely welcome.  Thank you in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th July 2012, 10:56</div></div><div class="posttext">If you right-click and Run as administrator - does that make any difference?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LogicallyRogue</div><div class="date">10th July 2012, 14:14</div></div><div class="posttext">If &quot;RequestExecutionLevel admin&quot; in the installer - Run As Administrator shows no change.  I have access to local resources but no network resources.<br />
<br />
If &quot;RequestExecutionLevel user&quot; in the installer - Run As Administrator acts as above.  Access to the local system, but not to the network resources.<br />
<br />
Thanks!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>