<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" DLL dependencies, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  DLL dependencies NSIS Discussion" />
	
	<title> DLL dependencies [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  DLL dependencies</div>
<hr />
<div class="pda"><a href="t-110919.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=110919">DLL dependencies</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">aj0000009</div><div class="date">22nd October 2002, 09:40</div></div><div class="posttext">Hi,<br />
Is there a way in NSIS to findout the dependencies for<br />
the installing DLL files?<br />
When I install the package on my machine(development),<br />
the binary works fine. But, when I install the same product<br />
on a new machine, I get an error &quot;ActiveX component<br />
can't create object&quot;.<br />
<br />
I collected the dependencies of all the DLL for my product using<br />
MS VB Package and Deployment Wizard... dependencies option. Is<br />
there a better way to figuring out the dependency DLL files?<br />
<br />
<br />
<br />
:cry:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kypec</div><div class="date">22nd October 2002, 16:48</div></div><div class="posttext">try to use Process viewer which you can download from here:<br />
http://www.prcview.com<br />
<br />
hope it will help you :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">22nd October 2002, 20:45</div></div><div class="posttext">This 'error' appears frequently for users of my program too, for me it's related to several OCX/DLL files which are not correctly registered.<br />
You may have gotten the right dependencies, but not correctly installed all the files.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ilya31</div><div class="date">2nd August 2005, 01:40</div></div><div class="posttext">I get the same error: &quot;ActiveX component<br />
can't create object&quot;. Can somebody give me more info which OCX/DLL is causing it? I am using several tools to find the DLL/OCX that is giving me problem, but so far I was unable to find it. I am creating an installer for VB 6 application.  I have used Library.nsh to install VB6 runtime.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">2nd August 2005, 03:41</div></div><div class="posttext">I agree that it sounds like some DLL or OCX didn't get properly registered.  But, it could also mean that a call is being made to another OCX/DLL that is expected to be there but isn't.  (For example, Internet Explorer, DirectX, etc.)<br />
<br />
In order to get to the bottom of this, you'll need to try to find out is exactly what DLL/OCX you are missing and then try to manually register it.  (use REGSVR32 at a Windows RUN box to register files manually.  For help, run 'REGSVR32 /?')  I'd probably start with the files included in the VB6 runtime.<br />
<br />
As far viewing dependencies, I'd use Dependency Walker (http://www.dependencywalker.com/) to analzyer individual DLLS.  However, keep in mind that most of these tools will not detect dynamically loaded DLLs.<br />
<br />
There's another tool from SysInternals called 'filemon' that might help you analyze the program in question to see what files it's trying to access. (URL: www.sysinternal.com) Then you can compare this list to the list on your developer machine to see what may be missing on the test machine.  (filemon allows you to filter  a process using wildcards so that you get a list of just the files used by a particular process.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ilya31</div><div class="date">3rd August 2005, 01:41</div></div><div class="posttext">Thank you Comperio for your advise. I am still trying to figure out the problem. I have used Dependency Walker and Filemon like you suggested. <br />
<br />
I think I figured out what the problem is. <br />
<br />
Here is the output of the Dependency Walker where my program crashes:<br />
<br />
LoadLibraryW(&quot;OLE32.DLL&quot;) called from &quot;OLE32.DLL&quot; at address 0x774FD899.<br />
LoadLibraryW(&quot;OLE32.DLL&quot;) returned 0x774E0000.<br />
<br />
I checked the search path on the computer where my application runs using VB installer.<br />
<br />
Search Path: C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\Program Files\Common Files\GTK\2.0\bin<br />
<br />
The search path on the test machine is the following:<br />
<br />
Search Path: C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem<br />
<br />
It is missing C:\Program Files\Common Files\GTK\2.0\bin, so I guess that's why it cannot find some DLL which are located in Program Files\Common Files folder.<br />
<br />
How do I add the missing directory to the Search path of my application using NSIS? Which registry contains an entry to the path variable?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">3rd August 2005, 04:27</div></div><div class="posttext">This should help:<br />
http://nsis.sourceforge.net/wiki/Setting_Environment_Variables</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ilya31</div><div class="date">4th August 2005, 01:55</div></div><div class="posttext">I am still trying to figure out the problem to this error.<br />
The path stuff is fine and it was not the problem. I hate DLL errors, they are very hard to track down.<br />
 <br />
Using Regmon, which is a tool for monitoring accesses to registry I figured out that my program blows up when <br />
it is trying to access the HKCR\CLSID\9289FAC-xxxx registry. This registry does not exist. Using VB installer, when I installed my application I checked that this registry contains AccuObjects.clsCompany which is inside AccuObjects.dll (dll that contains compiled code for my company's application). When I checked on the test PC AccuObjects.dll with all the classes is there in the registry but under different CLSID. How can I fix this problem? All the application's DLLs are there but under different CLSID then what the system looks for when I run my application. <br />
<br />
In my NSIS code I registered all DLLs for my application using Library.nsh. This is very time consuming to track and fix this DLL errors.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ilya31</div><div class="date">4th August 2005, 19:36</div></div><div class="posttext">Using another tool ListDlls, I figured out that 2 Dlls for my applications are not hetting loaded. I registered them manually using regsvr32 command. Why are they not getting loaded eventhough they are registered? Any ideas would be great.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>