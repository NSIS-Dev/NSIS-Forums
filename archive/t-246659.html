<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ip addres script question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ip addres script question NSIS Discussion" />
	
	<title> ip addres script question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ip addres script question</div>
<hr />
<div class="pda"><a href="t-246659.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246659">ip addres script question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">sixcode</div><div class="date">21st May 2006, 11:42</div></div><div class="posttext">hi all<br />
I'm trying to make a script based upon the script of Hendri Adriaens fouded here: http://nsis.sourceforge.net/wiki/IPTest<br />
<br />
what im trying to do is after 4 times checking the Network IP-address the script must end but for some reason i cant get this to work, if not connected the script loops.<br />
<br />
any help<br />
<br />
Section<br />
  ; Code to use actual ExtensionDLL<br />
  ; Current script provides an example<br />
 <br />
;Pop $0<br />
---&gt;  again:<br />
  ip::get_ip<br />
  Pop $0<br />
 <br />
   ;test entry<br />
  ;StrCpy $0 '192.168.0.100;127.0.0.1;152.168.0.101;169.254.0.1;'<br />
  <br />
  Loop:<br />
  Push $0<br />
  Call GetNextIp<br />
  Call CheckIp<br />
  Pop $2 ; Type of current IP-address<br />
  Pop $1 ; Current IP-address<br />
  Pop $0 ; Remaining addresses<br />
  ;StrCmp $2 '1' '' NoLoopBackIp<br />
  ;  MessageBox MB_OK &quot;LoopBack IP-address: $1&quot;<br />
  ;  Goto Continue<br />
  ;NoLoopBackIp:<br />
  ;StrCmp $2 '2' '' NoAPA<br />
  ;  MessageBox MB_OK &quot;Automatic Private IP-address: $1&quot;<br />
  ;  Goto Continue<br />
  ;NoAPA:<br />
  StrCmp $2 '3' '' NoLanIp<br />
    MessageBox MB_OK &quot;$2 Network IP-address: $1&quot;<br />
    Goto Continue<br />
    ---&gt; noLanIp:<br />
	    	ClearErrors<br />
    ---&gt;   	IntOp $4 $4 + 1<br />
    ---&gt; 			StrCmp $R2 4 kill<br />
			  MessageBox MB_OK|MB_ICONEXCLAMATION &quot;$\r$\n$R2 Netwerk Internet verbindings fout :$\r$\n$\r$\nKan geen verbinding maken met server, bezig met opnieuw proberen...     &quot;<br />
---&gt;	  Goto again<br />
---&gt;	  kill:<br />
	     MessageBox MB_OK|MB_ICONEXCLAMATION &quot;$\r$\nR2 Kan geen Internet Vebinding maken, setup sluit nu af...     &quot;<br />
   quit<br />
	  ;MessageBox MB_OK|MB_ICONEXCLAMATION &quot;$\r$\nKan geen Internet Vebinding maken, setup sluit nu af...     &quot;<br />
	  ; quit<br />
  ;MessageBox MB_OK &quot;Internet IP-address: $1&quot;<br />
  Continue:<br />
  StrCmp $0 '' ExitLoop ExitLoop2<br />
  ExitLoop:<br />
  ExitLoop2: <br />
quit<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st May 2006, 16:54</div></div><div class="posttext">Am I dumb in saying that you're incrementing $4 but checking $R2?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sixcode</div><div class="date">21st May 2006, 17:41</div></div><div class="posttext">Hi Stu<br />
this isn't working to :<br />
<br />
IntOp $2 $2 + 1<br />
StrCmp $2 4 kill<br />
what variable must i use to get it to work?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st May 2006, 19:52</div></div><div class="posttext">Logically, a variable that isn't being used in the rest of the script; otherwise its value will get overwrited elsewhere.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galil</div><div class="date">21st May 2006, 21:26</div></div><div class="posttext">Also it would be logical to set that variable to &quot;0&quot; before the loop.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sixcode</div><div class="date">23rd May 2006, 21:09</div></div><div class="posttext">answer:<br />
<br />
IntOp $4 $4 + 1<br />
StrCmp $4 4 kill<br />
<br />
<br />
    Push $R0<br />
    <br />
    again:<br />
	  <br />
	  ip::get_ip<br />
	  Pop $0<br />
	  <br />
	  Push $0<br />
	  Call GetNextIp<br />
	  Call CheckIp<br />
	  Pop $2 ; Type of current IP-address<br />
	  Pop $1 ; Current IP-address<br />
	  Pop $0 ; Remaining addresses<br />
	  StrCmp $2 '3' '' NoLanIp<br />
	  ;MessageBox MB_OK &quot;Network IP-address: $1&quot;<br />
	  Goto Continue5<br />
	  noLanIp:<br />
		ClearErrors<br />
		IntOp $4 $4 + 1<br />
	  StrCmp $4 4 kill<br />
		MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION &quot;$\r$\nPoging $4 van 3 $\r$\nNetwerk Internet verbindings fout :$\r$\n$\r$\nKan geen verbinding maken met server, druk op OK om het opnieuw te proberen...     &quot; IDCANCEL EXIT<br />
		Goto again<br />
		kill:<br />
		MessageBox MB_OK|MB_ICONEXCLAMATION &quot;$\r$\nKan geen Netwerk Internet Vebinding maken, setup sluit nu af...     &quot;<br />
	  quit<br />
	  Continue5:<br />
	  EXIT:<br />
    QUIT</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>