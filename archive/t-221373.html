<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait doesn't work, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait doesn't work NSIS Discussion" />
	
	<title> ExecWait doesn't work [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait doesn't work</div>
<hr />
<div class="pda"><a href="t-221373.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221373">ExecWait doesn't work</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">stefano7625</div><div class="date">13th July 2005, 18:11</div></div><div class="posttext">Hi People!<br />
<br />
I have a problem with more instance of ExecWait.<br />
I have tried to execute this code:<br />
-------------------------------------<br />
!define APP_NAME &quot;Pippo&quot;<br />
Name &quot;${APP_NAME} Test&quot;<br />
OutFile &quot;${APP_NAME}.exe&quot;<br />
InstallDir $PROGRAMFILES\${APP_NAME}<br />
!include &quot;MUI.nsh&quot;<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
Section &quot;Dummy Section &quot; SecDummy<br />
<br />
SetOutPath &quot;$EXEDIR\Pluto&quot;<br />
File Prova.bat<br />
ExecWait '&quot;mysql\setup.exe&quot;'<br />
<br />
SetOutPath &quot;$EXEDIR&quot;<br />
ExecWait '&quot;Prova.bat&quot;'<br />
MessageBox MB_OK &quot;Error&quot; <br />
<br />
SectionEnd<br />
-------------------------------------<br />
<br />
The problem is this:<br />
<br />
The second execution of ExecWait starts before that first execution of ExecWait ends.<br />
<br />
I'd be very pleased if somebody could help me!<br />
<br />
Best regards, <br />
<br />
-- Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DennisFeiock</div><div class="date">13th July 2005, 21:41</div></div><div class="posttext">I have seen this before myself.  Most of the NSIS installers I make are just wrappers for other installs...<br />
<br />
What that setup.exe probably does is extract itself out somewhere to an msi, some ini files, instmsia.exe, and instmsiw.exe.<br />
<br />
So as soon as the setup.exe has completed extracting those out, it runs the msi for the install your trying to run and closes the setup.exe.<br />
<br />
So NSIS sees that setup.exe has ended, and goes on to the next step.<br />
<br />
What you need to do is hunt around for any files that the setup.exe extracts, and call your ExecWait on those.  You might have to figure out what switches are needed.  (/qn, /qr, any transforms and such for msi's)<br />
<br />
Hope this helps you<br />
 - DF</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th July 2005, 23:19</div></div><div class="posttext">Sounds like you're trying to execute an InstallShield installer?<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=125550&amp;highlight=execwait+installshield<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stefano7625</div><div class="date">14th July 2005, 08:00</div></div><div class="posttext">Thanks for your responses.<br />
<br />
I have tried to do this instruction<br />
<br />
  C:\Test\setup.exe /r /f&quot;C:\Test\Setup.iss&quot;<br />
<br />
that install program and produce Setup.iss file:<br />
<br />
[InstallShield Silent]<br />
Version=v4.90.000<br />
File=Response File<br />
[DlgOrder]<br />
Dlg0=SdWelcome-0<br />
Count=5<br />
Dlg1=SdShowInfoList-0<br />
Dlg2=SdAskDestPath-0<br />
Dlg3=SetupType-0<br />
Dlg4=SdFinish-0<br />
[SdWelcome-0]<br />
Result=1<br />
[SdShowInfoList-0]<br />
Result=1<br />
[SdAskDestPath-0]<br />
szDir=C:\mysql<br />
Result=1<br />
[SetupType-0]<br />
Result=301<br />
szDir=<br />
[Application]<br />
Name=MySQL Servers and Clients 5.0.0a-alpha<br />
Version=MySQL Servers and Clients 5.0.0a-alpha<br />
Company=MySQL AB<br />
[SdFinish-0]<br />
Result=1<br />
bOpt1=0<br />
bOpt2=0<br />
<br />
When I try to execute silent installation in this way<br />
<br />
  C:\Test\setup.exe /s<br />
<br />
it doesn't work. It produce a file Setup.log that contains:<br />
<br />
[InstallShield Silent]<br />
Version=v4.90.000<br />
File=Log File<br />
[ResponseResult]<br />
ResultCode=-3<br />
<br />
<br />
ResultCode=-3 means <br />
 &quot;Required data not found in the Setup.iss file&quot;<br />
<br />
Anyone knows where I mistake?<br />
<br />
<br />
-- Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DennisFeiock</div><div class="date">14th July 2005, 13:10</div></div><div class="posttext">When you run the install like so:<br />
setup.exe -r<br />
<br />
It will create an answer file called setup.iss in your Windows directory.<br />
<br />
You will need to copy the iss file out of there, and package it with your NSIS installer.<br />
<br />
Then, you will need to do something like this:<br />
<br />
 ExecWait '&quot;$INSTDIR\setup.exe&quot; -s -f1 &quot;$INSTDIR\setup.iss&quot;'<br />
<br />
 - DF</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th July 2005, 17:31</div></div><div class="posttext">Did you read my post?<br />
Try executing the setup with the /sms switch.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stefano7625</div><div class="date">15th July 2005, 07:49</div></div><div class="posttext">I have tried both solutions but they didn't work.<br />
<br />
1.  ExecWait '&quot;$INSTDIR\setup.exe&quot; -s -f1 &quot;$INSTDIR\setup.iss&quot;'<br />
   <br />
   Are you sure that is $INSTDIR and not $EXEDIR?<br />
<br />
2. setup /sms (from command line)<br />
<br />
   It launch install program but doesn't wait.<br />
<br />
<br />
-- Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th July 2005, 08:06</div></div><div class="posttext">1. It depends where the installer is. If it's in the same folder as the current installer or in a subfolder, then you should use $EXEDIR.<br />
<br />
So this<br />
ExecWait '&quot;mysql\setup.exe&quot;'<br />
should really be<br />
ExecWait '&quot;$EXEDIR\mysql\setup.exe&quot;'<br />
just to be safe.<br />
<br />
You could also check this out:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=221310<br />
<br />
He used &quot;start /WAIT&quot; (in command-prompt) which you could try using with nsExec::Exec.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stefano7625</div><div class="date">15th July 2005, 08:40</div></div><div class="posttext">Here's the command that I tried:<br />
<br />
C:\Test\mysql&gt;start /WAIT /D&quot;C:\Test&quot; setup.exe /S &quot;_?=C:\mysql&quot;<br />
<br />
It produce setup.log with this contents:<br />
<br />
[InstallShield Silent]<br />
Version=v4.90.000<br />
File=Log File<br />
[ResponseResult]<br />
ResultCode=-3<br />
<br />
<br />
-- Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th July 2005, 09:03</div></div><div class="posttext">You don't want to use &quot;_?=C:\mysql&quot; as that is for NSIS uninstallers only. /S will make the InstallShield installer run silently, so obviously if you do not want it to run in silent, don't use /S.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stefano7625</div><div class="date">15th July 2005, 09:38</div></div><div class="posttext">I tried with:<br />
<br />
1. C:\Test\mysql&gt;start /WAIT /D&quot;C:\Test&quot; setup.exe<br />
<br />
2. C:\Test\mysql&gt;start /WAIT /D&quot;C:\Test&quot; setup.exe &quot;_?=C:\mysql&quot;<br />
<br />
3. C:\Test\mysql&gt;start /WAIT setup.exe<br />
<br />
It doesn't work.<br />
If I want to run silently installation, is this<br />
<br />
C:\Test\mysql&gt;start /WAIT /D&quot;C:\Test&quot; setup.exe /S<br />
<br />
the correct command? Why it doesn't work?<br />
<br />
-- Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th July 2005, 10:16</div></div><div class="posttext">I just found this page:<br />
http://documentation.installshield.com/robo/projects/helplib/IHelpSetup_EXECmdLine.htm<br />
<br />
Try &quot;/s /w&quot; (with ExecWait too if you like).<br />
<br />
If you use start, multiple parameters must be surrounded by quotes.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DennisFeiock</div><div class="date">15th July 2005, 13:11</div></div><div class="posttext">The error log that it is creating is because you arent specifing the answer file for the silent install.  Or that would be my best guess at least...<br />
<br />
What does this do for you?<br />
<br />
C:\Test\mysql&gt;start /WAIT /D&quot;C:\Test&quot; setup.exe -s -f1 &quot;C:\Test\setup.iss&quot;<br />
<br />
Also, according to the documentation that Afrow UK linked to:<br />
&quot;For an InstallScript MSI project, the command Setup.exe /s runs the installation in silent mode, by default based on the responses contained in a response file called Setup.iss in the same directory (response files are created by running Setup.exe with the /r option).&quot;<br />
<br />
The -f1 argument just lets you specify a different location for the ISS file.<br />
<br />
 - DF</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stefano7625</div><div class="date">15th July 2005, 13:40</div></div><div class="posttext">I have tried to execute command with &quot;/s /w&quot; but it doesn't work.<br />
<br />
Furthermore, this command:<br />
<br />
C:\Test\mysql&gt;start /WAIT /D&quot;C:\Test&quot; setup.exe -s -f1 &quot;C:\Test\setup.iss&quot;<br />
<br />
produce setup.log that has the same content already specified.<br />
<br />
<br />
-- Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th July 2005, 17:40</div></div><div class="posttext">START /? will tell you that [parameters] are one parameter for START seperated by quotes.<br />
<br />
And so,<br />
C:\Test\mysql&gt;start /WAIT /D&quot;C:\Test&quot; setup.exe &quot;-s -f1 C:\Test\setup.iss&quot;<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>