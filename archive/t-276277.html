<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MSSQL_OLEDB can't pass Chinese word, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MSSQL_OLEDB can't pass Chinese word NSIS Discussion" />
	
	<title> MSSQL_OLEDB can't pass Chinese word [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MSSQL_OLEDB can't pass Chinese word</div>
<hr />
<div class="pda"><a href="t-276277.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=276277">MSSQL_OLEDB can't pass Chinese word</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">baby_moon</div><div class="date">22nd August 2007, 03:46</div></div><div class="posttext">The problem should be in file MSSQL_OLEDB.cpp, line 338, function sprintf_s, this function should be changed to sprintf_w, in order to process Chinses word.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">25th August 2007, 23:08</div></div><div class="posttext">I will try to convert that function to support widechar, or I will create a new function (Executew or similar)<br />
stay tuned</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th August 2007, 01:12</div></div><div class="posttext">It would probably be wise to have Execute being wide as you cannot always know whether your query string will contain wide characters or not.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baby_moon</div><div class="date">31st August 2007, 16:36</div></div><div class="posttext">There is no fprintf_s definition. Can you please tell me what environment you used for compile the dll? Thank you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">31st August 2007, 20:37</div></div><div class="posttext">Visual Studio 2005 SP1. I'm working on wide version. I'll post during the week end.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baby_moon</div><div class="date">1st September 2007, 02:11</div></div><div class="posttext">:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">4th September 2007, 23:21</div></div><div class="posttext">I managed to make MSSQL_OLEDB::SQL_ExecuteScript be aware of Unicode sql scripts.<br />
I attach the plugin dll. try it. I will produce a new version of plugin and documentation in the next few days.<br />
Keep in mind that NSIS is full ANSI, so you cannot use Unicode strings in any NSIS script. <br />
In other words you cannot call MSSQL_OLEDB::SQL_Execute passing Unicode strings<br />
regards<br />
  stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baby_moon</div><div class="date">10th September 2007, 09:08</div></div><div class="posttext">It's worked, thank you very much!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">11th September 2007, 08:05</div></div><div class="posttext">Glad to know that,<br />
I'll soon release a new official version of the plugin supporting unicode scripts</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xbarns</div><div class="date">14th August 2008, 11:10</div></div><div class="posttext">Any way this (very nice) plugin will work with the unicode version of NSIS? <br />
<br />
I already tried and when trying to logon i get some strange text back and login fails. (Logon works fine with the &quot;normal&quot; NSIS)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">15th August 2008, 11:02</div></div><div class="posttext">off for summer holidays.<br />
will take a look at NSIS unicode when back in early september<br />
stay tuned<br />
  Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xbarns</div><div class="date">15th August 2008, 13:08</div></div><div class="posttext">off for summer holidays. <br />
<br />
enjoy!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xbarns</div><div class="date">11th September 2008, 17:20</div></div><div class="posttext">:) did you have time to look at the NSIS Unicode yet?<br />
<br />
Will MSSQL_OLEDB be able to handle scripts larger than the reported 60000 bytes anytime in the future?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xbarns</div><div class="date">4th December 2008, 12:39</div></div><div class="posttext">*bump*<br />
<br />
Any news on this?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>