<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" .NET framework install, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  .NET framework install NSIS Discussion" />
	
	<title> .NET framework install [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  .NET framework install</div>
<hr />
<div class="pda"><a href="t-109877.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=109877">.NET framework install</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">BradWaite</div><div class="date">15th October 2002, 02:18</div></div><div class="posttext">Hey all,<br />
<br />
I've got a .NET app I want to have available for download.  Problem is, users can't run my app without the .NET framework installed.  Since Mickey$oft hasn't come up with an elegant solution, I decided to come up with my own, with the help of NSIS.  Incindentally, their solution was to package the 20MB .NET framework redist with my 200KB program!<br />
<br />
I believe I understand enough of the scripting language to have my installer check for the presence of the framework (via reg. query or mscorlib.dll version) and download the redistributable .NET exe from MS with nsisdl.<br />
<br />
My question is, how can I have my installer run again after the .NET Framework install reboots the machine?<br />
<br />
And while I'm at it, what's the best way to exit my installer and run the framework installer?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">padgettrowell</div><div class="date">15th October 2002, 08:07</div></div><div class="posttext">Hi,<br />
<br />
I share your pain.<br />
<br />
I'm trying to deploy a 700k app, small until I add the 20MB runtime.  What a gyp.<br />
<br />
Have you had anyluck in solving this problem?<br />
<br />
Cheers,<br />
<br />
Padgett</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th October 2002, 16:14</div></div><div class="posttext">Write to the RunOnce registry key. You can find more info at: http://support.microsoft.com/default.aspx?scid=KB;EN-US;Q137367&amp;<br />
<br />
To execute the installer use Exec and then Quit or Abort. You might want to use ExecWait and wait for the return value to know if it succeeded or failed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BradWaite</div><div class="date">15th October 2002, 16:39</div></div><div class="posttext">kichik,<br />
<br />
Thanks.  I was thinking of RunOnce, but I've not had the opportunity to use it before.  I'm pretty sure the .NET framework will have something in there too, but now that I think of it, it really shouldn't be a problem for my setup to run while it's tidying up.<br />
<br />
And how could I use ExecWait since the .NET install will ask for a reboot?  If the user hits reboot from there, my installer will never get a return value.  Plus, in that case, all my installer's files will be left laying around.  Is there any way to tell where the current working directory is?<br />
<br />
I'm thinking I could write a small file or reg key the first time through that saves the current working directory and whether the .NET install was attempted.  If on the second time through, the file exists and .NET still isn't on the machine, throw an error.  Does that sound like the way to go?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th October 2002, 18:37</div></div><div class="posttext">I am sure there is some way telling the installer not to reboot and let you do the reboot. You just need to find this way :)<br />
<br />
I'm thinking I could write a small file or reg key the first time through that saves the current working directory and whether the .NET install was attempted. If on the second time through, the file exists and .NET still isn't on the machine, throw an error. Does that sound like the way to go?<br />
<br />
Does the installer delete itself? If it does, then it should work, but I think it will be better if you make it not reboot.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>