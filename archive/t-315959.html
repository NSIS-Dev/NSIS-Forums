<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Silent install for .NET framework 2.0, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Silent install for .NET framework 2.0 NSIS Discussion" />
	
	<title> Silent install for .NET framework 2.0 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Silent install for .NET framework 2.0</div>
<hr />
<div class="pda"><a href="t-315959.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=315959">Silent install for .NET framework 2.0</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jdt2oo7</div><div class="date">2nd January 2010, 21:51</div></div><div class="posttext">Hi all,<br />
<br />
I am having trouble install .NET framework 2.0 silently. <br />
<br />
I have verified using command prompt and successfully install .NET framework 2.0 using:<br />
dotnetfx.exe /q:a /c:â€install.exe /qâ€<br />
<br />
But when I use it in script, it doesn't run the installation:<br />
ExecWait '&quot;$EXEDIR\Products\Microsoft Redistribute\dotnetfx.exe&quot; /q:a /c:â€install.exe /qâ€' $ExitCode5<br />
<br />
&quot;Products\Microsoft Redistribute&quot; is where I run dotnetfx.exe from.<br />
<br />
I also add quotation mark as suggested in another thread:<br />
ExecWait '&quot;Products\Microsoft Redistribute\dotnetfx.exe&quot; /q:a /c:$\â€install.exe /q$\â€' $ExitCode5<br />
<br />
I have tried this also:<br />
ExecWait '&quot;$EXEDIR\Products\Microsoft Redistribute\dotnetfx.exe&quot; /q' $ExitCode5<br />
<br />
If you have any idea what is wrong, please let me know. This is so time consuming :(<br />
<br />
I previously had posted question about Silent install for VS C++ 2008 SP1 Redistributable Package (x86), and that is working.<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=315810</div></div><hr />


<div class="post"><div class="posttop"><div class="username">meaningoflights</div><div class="date">6th January 2010, 02:20</div></div><div class="posttext">!macro NET_INSTALL installer_path<br />
;Check for framework 2.0â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“<br />
StrCpy $1 â€œ0?<br />
ReadRegDword $1 HKLM â€œSOFTWARE\Microsoft\NET Framework Setup\NDP\v2.0.50727? â€œInstallâ€<br />
${If} $1 != â€œ1?<br />
${If} ${RunningX64}<br />
StrCpy $9 â€˜â€${installer_path}\netfx64.exeâ€ /q /c:â€install.exe /qb /noaspupgradeâ€â€˜<br />
${Else}<br />
StrCpy $9 â€˜â€${installer_path}\dotnetfx2.0.exeâ€ /q /c:â€install.exe /qb /noaspupgradeâ€â€˜<br />
${EndIf}<br />
SetDetailsPrint both<br />
DetailPrint â€œInstalling .Net Frameworkâ€<br />
SetDetailsPrint none<br />
!insertmacro EXEC_SUBINSTALLER â€œMicrosoft .Net Framework 2.0? $9<br />
${EndIf}<br />
!macroend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jdt2oo7</div><div class="date">6th January 2010, 02:50</div></div><div class="posttext">Thanks for your reply , meaningoflights.<br />
<br />
I tried:<br />
ExecWait '&quot;$EXEDIR\Products\Microsoft Redistribute\dotnetfx.exe&quot; /q /c:â€install.exe /qb /noaspupgradeâ€'<br />
<br />
but it gave me &quot;syntax error&quot;.<br />
<br />
I wonder how you use it in:<br />
!insertmacro EXEC_SUBINSTALLER â€œMicrosoft .Net Framework 2.0? $9<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">meaningoflights</div><div class="date">6th January 2010, 03:26</div></div><div class="posttext">ok use this, I attached it as a ZIP so the characters dont get affected by html encoding:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jdt2oo7</div><div class="date">6th January 2010, 04:45</div></div><div class="posttext">Cool, seem to work when I use your Macro.<br />
<br />
I am still seeing the extracting window and &quot;Microsoft .NET Framework 2.0&quot; window. Is there anyway we can hide those?<br />
<br />
Thanks a lot!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">meaningoflights</div><div class="date">6th January 2010, 05:02</div></div><div class="posttext">Looking at the command line parameters for the dotnetfx.exe there isn't a option to hide the extraction window:<br />
<br />
---------------------------<br />
Microsoft .NET Framework 2.0<br />
---------------------------<br />
Command line options:<br />
<br />
/Q -- Quiet modes for package,<br />
<br />
/T:&lt;full path&gt; -- Specifies temporary working folder,<br />
<br />
/C -- Extract files only to the folder when used also with /T.<br />
<br />
/C:&lt;Cmd&gt; -- Override Install Command defined by author.<br />
<br />
---------------------------<br />
OK   <br />
---------------------------<br />
<br />
In my installer I download dotnetfx.exe from the Microsoft site (either x86 or the x64 installer), but if you really want to hide the extraction window and can package your app with dotnetfx.exe then here's a method:<br />
<br />
1. Use Winzip or winrar to extract the dotnetfx.exe to a folder and include that folder in your install package.<br />
<br />
2. Inside the folder you'll see install.msi which you can run with command parameters, eg:<br />
<br />
<br />
---------------------------<br />
Usage<br />
---------------------------<br />
Usage:<br />
<br />
/l &lt;logname.txt&gt; :Name of verbose msi log<br />
<br />
/lang &lt;xxxx&gt;     :4-digit language code<br />
<br />
/q               :Quiet install mode<br />
<br />
/qu              :Quiet uninstall mode<br />
<br />
/?               :Show the Usage dialog<br />
---------------------------<br />
OK   <br />
---------------------------</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jdt2oo7</div><div class="date">6th January 2010, 05:04</div></div><div class="posttext">I guess I can live with the extract window, because we don't want to include .NET in our installer. Again, thanks for your help... I've been struggle with this the last few days.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">meaningoflights</div><div class="date">6th January 2010, 05:35</div></div><div class="posttext">your welcome, let us know if you need anymore help :)<br />
<br />
<br />
ps As per the dotnexfx 2.0 system requirements:<br />
http://www.microsoft.com/downloads/details.aspx?FamilyID=0856EACB-4362-4B0D-8EDD-AAB15C5E04F5&amp;displaylang=en<br />
<br />
You should check that Windows Installer 3.1 or above is installed before installing .net 2.0..., I think its upto WindowsInstaller v4.5 these days... <br />
<br />
<br />
===============================================<br />
<br />
;THIS IS THE SWITCH TO COMPILE FOR INTERNET OR FULL SETUP - comment out the !define and change the Output file name<br />
<br />
!define IS_INTERNET_RELEASE<br />
OutFile &quot;XXX Setup using Internet.exe&quot;<br />
<br />
---------------------------------------------<br />
<br />
;The call to the function to check if MSI 3.1 or above is installed, if not to download and install it:<br />
<br />
Call UpdateMSIVersion<br />
<br />
---------------------------------------------<br />
<br />
;The function<br />
Function UpdateMSIVersion<br />
  GetDllVersion &quot;$SYSDIR\MSI.dll&quot; $R0 $R1<br />
  IntOp $R2 $R0 / 0x00010000<br />
  IntOp $R3 $R0 &amp; 0x0000FFFF<br />
<br />
  IntCmp $R2 3 0 InstallMSI RightMSI<br />
  IntCmp $R3 1 RightMSI InstallMSI RightMSI<br />
<br />
  RightMSI:<br />
    Push 0<br />
    Goto ExitFunction<br />
<br />
  InstallMSI:<br />
<br />
!ifdef IS_INTERNET_RELEASE<br />
      DetailPrint &quot;Downloading MSI Installer&quot;<br />
      DetailPrint &quot;Pausing installation while downloading MSI Installer&quot;<br />
      ;NSISDL::download &quot;http://download.microsoft.com/download/1/4/7/147ded26-931c-4daf-9095-ec7baf996f46/WindowsInstaller-KB893803-v2-x86.exe&quot; &quot;$INSTDIR\WindowsInstaller-KB893803-v2-x86.exe&quot;<br />
<br />
      InetLoad::load /POPUP &quot;MSI Installer&quot;  /RESUME &quot;Internet Connection Error. Please make sure you are connected to the Internet. You must be connected to the Internet to install XXX. Please make sure your firewall or anti virus software is not preventing the XXX installation from connecting to the Internet. Retry?&quot; &quot;http://download.microsoft.com/download/1/4/7/147ded26-931c-4daf-9095-ec7baf996f46/WindowsInstaller-KB893803-v2-x86.exe&quot; &quot;$$INSTDIR\WindowsInstaller-KB893803-v2-x86.exe&quot;<br />
      Pop $0 # return value = exit code, &quot;OK&quot; if OK<br />
<br />
      ${If} $0 != &quot;OK&quot;<br />
      nsislog::log &quot;$INSTDIR\install.log&quot; &quot;Failed to download Windows Installer 3.1: $0&quot;<br />
      MessageBox MB_YESNO &quot;MSI Installer - Download Status: $0. Do you wish to continue?&quot; IDYES go1<br />
      Abort<br />
      go1:<br />
      ${EndIf}<br />
      DetailPrint &quot;Completed download&quot;<br />
!endif<br />
DetailPrint &quot;Updating Windows Installer...&quot;<br />
nsislog::log &quot;$INSTDIR\install.log&quot; &quot;Installing Windows Installer 3.1&quot;<br />
ExecWait &quot;$INSTDIR\WindowsInstaller-KB893803-v2-x86.exe /quiet /norestart&quot;<br />
    Push 1<br />
    Goto ExitFunction<br />
  ExitFunction:<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">amselon</div><div class="date">13th January 2010, 12:06</div></div><div class="posttext">ExecWait '$INSTDIR\dotnetfx.exe /q:a /c:&quot;install /q&quot;'<br />
or<br />
ExecWait '$INSTDIR\dotnetfx.exe /q /c:&quot;install /l c:\log_.txt /q&quot;'<br />
or<br />
ExecWait '$INSTDIR\dotnetfx.exe /q /c:&quot;install /q&quot;'</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>