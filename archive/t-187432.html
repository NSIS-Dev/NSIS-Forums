<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" UpgradeDLL could not load ?!?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  UpgradeDLL could not load ?!? NSIS Discussion" />
	
	<title> UpgradeDLL could not load ?!? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  UpgradeDLL could not load ?!?</div>
<hr />
<div class="pda"><a href="t-187432.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=187432">UpgradeDLL could not load ?!?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Greybird</div><div class="date">22nd July 2004, 14:29</div></div><div class="posttext">I try to use the UpgradeDll macro to install a DLL.<br />
<br />
I use the following syntax :<br />
!insertmacro UpgradeDLL &quot;OUTLOOK2000\outlookclientaddin.dll&quot; &quot;$INSTDIR\outlookclientaddin.dll&quot; &quot;$INSTDIR&quot; <br />
<br />
But the registration is not done. The log tells me : &quot;Could not load C:\Program Files\Outlook Synchronization Addin\outlookclientaddin.dll&quot;<br />
<br />
I checked that the DLL was at its place when the call to RegDll occurs, and it is.<br />
<br />
The same problem occurs with short file names too.<br />
<br />
Has someone had the same problem ?<br />
<br />
Arnaud</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Greybird</div><div class="date">22nd July 2004, 15:31</div></div><div class="posttext">Here is the script I use.<br />
<br />
outlookclientaddin.dll is dependant of dll2000.dll.<br />
<br />
<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  SectionIn 1 RO<br />
<br />
  File /oname=&quot;AddinToolbarRemover.exe&quot; &quot;OUTLOOK2000\addintoolbarremover.exe&quot;<br />
  File /oname=&quot;README.TXT&quot; &quot;Common\README.TXT&quot;<br />
  File /oname=&quot;COPYING&quot; &quot;Common\COPYING&quot;<br />
  <br />
  !define UPGRADEDLL_NOREGISTER<br />
    !insertmacro UpgradeDLL &quot;OUTLOOK2000\dll2000.dll&quot; &quot;$INSTDIR\dll2000.dll&quot; &quot;$INSTDIR&quot;<br />
  !undef UPGRADEDLL_NOREGISTER<br />
  !insertmacro UpgradeDLL &quot;OUTLOOK2000\outlookclientaddin.dll&quot; &quot;$INSTDIR\outlookclientaddin.dll&quot; &quot;$INSTDIR&quot;<br />
<br />
Hope this helps...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scully13</div><div class="date">22nd July 2004, 16:06</div></div><div class="posttext">I had that problem once because the DLL I was trying to load was dependent on another DLL. I ended up having to include both DLLs in the folder I was calling the first one from and then SetOutPath to that folder. I've never used the upgrade DLL but maybe it calls the DLL to determine it's version and that causes it's dependency to be needed. You could also use Dependency Walker to determine if that DLL has other dependencies. I made a post several weeks ago with the problem I discussed above if you think the problems are related and want more info.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Greybird</div><div class="date">23rd July 2004, 10:45</div></div><div class="posttext">Thanks for your response.<br />
<br />
The Dll on which the Dll I try to register is dependant is in the same directory, INSTDIR, and SetOutPath is set to this directory.<br />
<br />
Some tests I've done :<br />
UnRegDll works on the same dll.<br />
regserv32 works after the installer is closed, but not if I call it with ExecWait.<br />
<br />
Any ideas ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scully13</div><div class="date">23rd July 2004, 19:46</div></div><div class="posttext">Sorry, I have no more ideas. I used your code with 2 DLLs I have here and it worked fine. Both files were copied in and it registered the second one. However, neither of my files were dependent on one another.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>