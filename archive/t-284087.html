<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait + InstallShield v11 and v12 question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait + InstallShield v11 and v12 question NSIS Discussion" />
	
	<title> ExecWait + InstallShield v11 and v12 question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait + InstallShield v11 and v12 question</div>
<hr />
<div class="pda"><a href="t-284087.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=284087">ExecWait + InstallShield v11 and v12 question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">31st December 2007, 10:57</div></div><div class="posttext">Hello,<br />
<br />
I have a problem with my installer. Actually the problem is not ExecWait. Let me explain.<br />
<br />
I have my installer (NSIS) that must wait for a InstallShield setup and an update for that InstallShield setup. The update is InstallShield. I have three installers like this. Two of them must wait for v11 InstallShield and the third for a v12 InstallShield.<br />
When I run my installer from the HDD everything works as it should. ExecWait works.<br />
If I try the same thing from a CD/DVD it does not work.<br />
Probably InstallShield launches a new process because it cannot write anything on the CD/DVD.?! Anyway, this is my logic.<br />
As I said, I do not believe it is a ExecWait problem.<br />
<br />
What can I do ? I searched in TEMP folder after I started the InstallShield setup and I cannot find any .msi file.<br />
<br />
Sorry for the long post and sorry for my english.<br />
Thanks in advance,<br />
OJi.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">31st December 2007, 11:24</div></div><div class="posttext">What about command line switches?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">31st December 2007, 11:36</div></div><div class="posttext">What command line switches ?<br />
<br />
I do not want to make a unattended install. The user must select options/configs from the IS setup.<br />
<br />
I found in NSIS wiki &quot;Check whether your application is running during uninstallation&quot;. This can help me. I can check  if IS is running or not. But the part where IS is starting and I have only a progressbar - &quot;IS is loading bla bla bla...&quot;. This part does not have Name/Class.<br />
<br />
Thanks,<br />
OJi.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">31st December 2007, 12:05</div></div><div class="posttext">You need to find out if there is a command line switch to stop it running as another process.<br />
<br />
If there are none, the next option is to keep checking for a running process using FindProcDLL or Processes (both of which however do not work on Vista apparently).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st December 2007, 17:58</div></div><div class="posttext">More in the FAQ about installers fails with ExecWait:<br />
<br />
http://nsis.sourceforge.net/When_I_use_ExecWait,_it_doesn't_wait</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">1st January 2008, 17:04</div></div><div class="posttext">Hello,<br />
<br />
I already checked that page. It does not help me.<br />
<br />
Thanks anyway,<br />
OJi.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st January 2008, 17:40</div></div><div class="posttext">Did you try /SMS?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">1st January 2008, 18:23</div></div><div class="posttext">Yes, I did. Nothing happened. The new process was launched.<br />
<br />
Thanks,<br />
OJi</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st January 2008, 18:29</div></div><div class="posttext">If it's only from CD, copy to $TEMP prior to execution.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">1st January 2008, 18:32</div></div><div class="posttext">I cannot. I need to do this three times. First installer has 1.4 GB, second 500 MB and the third 1.3 GB. I will search more about InstallShield functionality. If I find something usefull I will post it here.<br />
<br />
Thanks again,<br />
OJi.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RaggieSoft</div><div class="date">6th January 2008, 05:52</div></div><div class="posttext">I am familiar with InstallShield 12 and InstallShield 14 (IS 2008).  If the installers are one big EXE, it's extracting the installer to the hard drive.  Usually, it is Windows\Downloaded Installations (note that the author of the IS based installers can customize which folder the MSI is &quot;cached&quot; (using IS terminology) to).  /SMS is an older InstallShield 5.x switch and wouldn't help out.  If the installer launches an MSI, use the /A switch to create an admin image then use the regular MSIEXEC /i (path to MSI).  If the IS setup is an EXE that launches an MSI in the same folder, simply directly run the MSI.<br />
<br />
Edit: some clarification<br />
<br />
If it is an EXE that extracts and launches an MSI, use the /A switch to create the Admin image.  Burn that folder (along with everything - there will be a load of files) to your DVD.  About the /SMS switch: This was used in InstallShield 5.5 and previous versions to tell IS to not exit the &quot;Preparing InstallShield Wizard&quot; screen until Setup is fully done, thus allowing functions like ExecWait to work properly.  Starting with Version 6.0 (this came out back in 2000 or so), the feature provided with /SMS is now the default operation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">6th January 2008, 09:38</div></div><div class="posttext">Thanks for your reply.<br />
<br />
The IS installers are not one big EXE file and I could not find any MSI file. The problem is I cannot/(am not allowed to) modify them. I must use them as they are.<br />
I am still searching...<br />
<br />
Thanks again,<br />
OJi.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RaggieSoft</div><div class="date">6th January 2008, 16:13</div></div><div class="posttext">Oh joy, InstallScript based installations.  Here's some command line switches from the InstallShield KB: http://helpnet.macrovision.com/Robo/BIN/Robo.dll?mgr=agm&amp;tpc=%2Frobo%2Fprojects%2Finstallshield14helplib%2FIHelpSetup_EXECmdLine.htm&amp;wnd=InstallShieldLivingHelp|Main&amp;agt=wsm&amp;ctxid=search%2Fgsearch.asp (it's a long and confusing URL)<br />
<br />
Try /runfromtemp /clone_wait<br />
<br />
If I'm reading the instructions correctly, /clone_wait will only run with /runfromtemp<br />
<br />
These instructions are for InstallShield 2008 (AKA InstallShield 14) so hopefully they'll work on IS 11 and IS 12<br />
<br />
When you are looking at the Macrovision help site, only the &quot;InstallScript&quot; information applies to you.  Ignore &quot;Basic MSI&quot; ans &quot;InstallScript MSI&quot;</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>