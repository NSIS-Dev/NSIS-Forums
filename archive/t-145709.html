<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" GetDllVersionLocal and others outside of functions, sections and macros, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  GetDllVersionLocal and others outside of functions, sections and macros NSIS Discussion" />
	
	<title> GetDllVersionLocal and others outside of functions, sections and macros [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  GetDllVersionLocal and others outside of functions, sections and macros</div>
<hr />
<div class="pda"><a href="t-145709.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=145709">GetDllVersionLocal and others outside of functions, sections and macros</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">VirGin</div><div class="date">14th August 2003, 00:02</div></div><div class="posttext">Hola People,<br />
<br />
I am using v2.0b3 on WinXP Pro.<br />
<br />
I would like to get the version of executables and libraries at compile time. I can use GetDllVersionLocal to get the version information. I would like to store this in a global variable at compile time so the installer will have the correct information at run time.<br />
<br />
For example:<br />
I want to populate the following with the correct data at compile time<br />
!define VER_MAJOR 0<br />
!define VER_MINOR 00<br />
!define VER_REVISION 0000<br />
<br />
Since GetDllVersionLocal can not be used outside of a function, macro or other block, I would like to know what the best method of updating the above variables with the correct version information of the appropriate executable.<br />
<br />
<br />
Thanx<br />
<br />
-V-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">14th August 2003, 00:10</div></div><div class="posttext">How about using a second installer which calls GetDllVersionLocal (or whatever it needs to do to extract the version information) and then this installer invokes the installer that wants the data, defining inside it the variables using the /D (I think it's /D) makensis command line argument.<br />
<br />
If this sounds weird try thinking of the second installer (the one that extracts the version info) as a little tool program you just happen to have created using NSIS. NSIS is good for stuff like that, e.g. it's a compiled NSIS script that backs up the NSIS Archive, a task that has nothing to do with installing anything.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VirGin</div><div class="date">26th August 2003, 22:34</div></div><div class="posttext">Hmm.   Thanx for the idea. I think I would be better off (as would the community) if I tackled this problem in the NSIS source. <br />
<br />
I was hoping there was a quick, reliable, easy way of doing this first.<br />
<br />
<br />
<br />
-V-</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>