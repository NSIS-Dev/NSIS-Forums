<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" A question regarding how to call a function, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  A question regarding how to call a function NSIS Discussion" />
	
	<title> A question regarding how to call a function [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  A question regarding how to call a function</div>
<hr />
<div class="pda"><a href="t-329930.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=329930">A question regarding how to call a function</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">JohnChen</div><div class="date">22nd April 2011, 20:28</div></div><div class="posttext">Suppose a function is defined in C++ as void foo(int&amp; x). Assume foo is defined in fooLib.dll. I tried to call System::call &quot;fooLib::foo(i.r0) in nsis. But I couldn't get value of x assigned within the function foo. How to call foo correctly in nsis? Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">22nd April 2011, 22:56</div></div><div class="posttext">By adding a period before r0 you're telling the system plugin that it's an output variable (so the return value gets put there). Try System::call &quot;fooLib::foo(i r0)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JohnChen</div><div class="date">25th April 2011, 19:00</div></div><div class="posttext">By adding a period before r0 you're telling the system plugin that it's an output variable (so the return value gets put there). Try System::call &quot;fooLib::foo(i r0)<br />
Thanks for your reply. The following is how I call a function defined in myLib.dll from NSIS script.<br />
<br />
// C++ code<br />
BOOL __stdcall test(BOOL&amp; btest)<br />
{<br />
	TCHAR s[12];<br />
	_tcscpy(s, _T(&quot;1&quot;));<br />
	_stscanf(s, _T(&quot;%d&quot;), &amp;bTest);<br />
	<br />
	return TRUE;<br />
}<br />
<br />
// NSIS script<br />
System::call &quot;myLib::test(i r0) i.r1&quot;<br />
<br />
But it looks like test never returns. Is there anything wrong? Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">25th April 2011, 19:11</div></div><div class="posttext">I'm not a programmer. But... did you fix your system::call syntax?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JohnChen</div><div class="date">25th April 2011, 19:22</div></div><div class="posttext">I'm not a programmer. But... did you fix your system::call syntax?<br />
This is how I did, System::call &quot;myLib::test(i r0) i.r1&quot;. Basically, r0 is a output parameter I expect to get the result in NSIS script from dll. It did call function test but somehow the function test never returns. I am not sure what went wrong. Do you have any idea? Thanks a lot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">25th April 2011, 20:41</div></div><div class="posttext">Errr oops, missed that line in your post. Dunno, let's hear an actual programmer. Someone take over plz?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JohnChen</div><div class="date">25th April 2011, 22:27</div></div><div class="posttext">I figured out. It should be System::call &quot;myLib::test(*i.r0) i.r1&quot;. Thanks.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>