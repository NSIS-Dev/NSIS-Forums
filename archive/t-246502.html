<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Any way to detect IIS6 physical web root directory?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Any way to detect IIS6 physical web root directory? NSIS Discussion" />
	
	<title> Any way to detect IIS6 physical web root directory? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Any way to detect IIS6 physical web root directory?</div>
<hr />
<div class="pda"><a href="t-246502.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246502">Any way to detect IIS6 physical web root directory?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">shaunb</div><div class="date">19th May 2006, 10:28</div></div><div class="posttext">I need to be able to detect and suggest a suitable webroot to install a content management system into. I was previously using &quot;c:\inetpub\wwwroot\&quot; but I was told by my superiors that it should be detected, (even if it would still default to c:\inetpub\webroot), sounds a bit silly in my opinion. <br />
<br />
anyway, the web root could be on D: or E: or it could be a multiple webserver configuration running on all 3, I have no idea how to get the 'right' one, and would probably just default to 'c:\inetpub\wwwroot' anyway, hence the pointlessness.<br />
<br />
but I have managed to detect if ColdFusion is installed from the registry entries, and quit or continue on that, but due to IIS6 using the 'metabase' and not the registry as such, its a bit harder to access the properties. I have tried a couple of VBS cscripts to try and retrieve the information from the metabase, but it returns different info for each server (obviously), I still think that defaulting to c:\inetpub\wwwroot is more sensible, without any detection code behind, but I've been told its better to try detect the actual working webroot as I might end up causing the user to install the CMS in the wrong directory etc.<br />
<br />
thanks for anyone who tried to decipher this and help. hehe!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mr Inches</div><div class="date">19th May 2006, 11:55</div></div><div class="posttext">Try these links I found for scripts that list all folders for all virtual folders.<br />
<br />
http://www.iisfaq.com/Default.aspx?tabid=3039<br />
http://www.iisfaq.com/Default.aspx?tabid=2745<br />
<br />
If you are only interested in the default web site (first one), then just get the path for W3SVC1.<br />
<br />
Alternatively, you could be brave and parse the Metabase directly.<br />
Under IIS 6 it is in XML and stored in &quot;%SYSTEMROOT%\System32\inetsrv\Metabase.xml&quot; and you are looking for something like:<br />
<br />
&lt;IIsWebVirtualDir Location =&quot;/LM/W3SVC/1/ROOT&quot;<br />
		  AccessFlags=&quot;AccessRead | AccessScript&quot;<br />
		  AppFriendlyName=&quot;Default Application&quot;<br />
		  AppIsolated=&quot;2&quot;<br />
		  AppPoolId=&quot;DefaultAppPool&quot;<br />
		  AppRoot=&quot;/LM/W3SVC/1/ROOT&quot;<br />
		  Path=&quot;c:\inetpub\wwwroot&quot;<br />
	&gt;<br />
&lt;/IIsWebVirtualDir&gt;<br />
<br />
Duncan (Mr Inches)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shaunb</div><div class="date">19th May 2006, 12:20</div></div><div class="posttext">Thanks for your reply, I am currently reading how about the XML metabase, but I need to detect IIS5 and IIS6 webroot I believe, as as with IIS5 the metabase is a binary file, I think I'll have to go some other route or just 'dumb provide' the default string &quot;c:\inetpub\wwwroot&quot;<br />
<br />
I could just get the default webroot I guess, but its likely to be the wrong one, it would make good for a suggestion as a default though, but thats what I'm using already, it would be the same default even if I put code behind it to detect it!<br />
<br />
man, I love trying to explain this to people who dont code.<br />
<br />
anyway thanks again, I've got more reading to do at least<br />
<br />
:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shaunb</div><div class="date">19th May 2006, 12:28</div></div><div class="posttext">hmm it seems one of the example links you gave, I have already been playing with, and the other one is more compact and nearly does what I want, but it borks with a null error if there is no IIS running on that system at all.<br />
<br />
I'd love to be able to just default to the inetpub on c: but I know some people might say otherwise, I'd love to see them attempt it though.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shaunb</div><div class="date">19th May 2006, 16:16</div></div><div class="posttext">thanks for the help, I've convinced my superiors that manual selection of the IIS webroot is the best method though.<br />
<br />
:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TypoBound</div><div class="date">20th May 2006, 19:05</div></div><div class="posttext">I had a similar need for a project I'm working on. I decided to use my program's installation path as an install point for the web pages and then create virtual directories on the default web site using adsutil.vbs provided with the IIS install. <br />
<br />
In anyu case, the vbs routines provide a lot of ways to work with and query the web services so you will most likely find useful script in them.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>