<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Remove Header for Custom Final Page with NSDialogs?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Remove Header for Custom Final Page with NSDialogs? NSIS Discussion" />
	
	<title> Remove Header for Custom Final Page with NSDialogs? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Remove Header for Custom Final Page with NSDialogs?</div>
<hr />
<div class="pda"><a href="t-302983.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=302983">Remove Header for Custom Final Page with NSDialogs?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Spilly</div><div class="date">10th February 2009, 21:55</div></div><div class="posttext">hey guys,<br />
I'm trying to convert my installer to use nsdialog. The current problem I'm having is with the custom final page. It carries the mui header from the last page shown, when I don't want any header at all. Obviously I can replace the text and image with blanks, but there's still a white banner across the top.<br />
<br />
When I used InstallOptions to create this page it was not a problem. <br />
<br />
Is it possible to remove this through mui or nsdialogs, or am I stuck with InstallOptions?<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">10th February 2009, 22:48</div></div><div class="posttext">its not supposed to be like that, you must be doing something wrong.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">10th February 2009, 23:35</div></div><div class="posttext">keep in mind that, at least according to the nsDialogs docs, you're supposed to use a different dialog ID;<br />
http://nsis.sourceforge.net/Docs/nsDialogs/Readme.html<br />
<br />
<br />
nsDialogs::Create rect<br />
<br />
Creates a new dialog. rect specific the identifier of the control whose location will be mimiced. This should usually be 1018, which is control mimiced for creation of built-in pages. The Modern UI also has control 1040 for the welcome and the finish page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Spilly</div><div class="date">11th February 2009, 17:34</div></div><div class="posttext">Yes, i tried 1040, but that didn't work at all. Here is my current code, does anything stick out?<br />
<br />
------------------<br />
<br />
Push $0<br />
Push $1<br />
Push $2<br />
Push $3<br />
Push $4<br />
<br />
nsDialogs::Create 1018<br />
Pop $0<br />
<br />
${If} $0 == error<br />
    Abort<br />
${EndIf}<br />
<br />
${NSD_CreateBitmap} 0 0 100% 100% &quot;&quot;<br />
Pop $1<br />
${NSD_SetImage} $1 &quot;$PLUGINSDIR\${SIDE_BANNER}&quot; $2<br />
<br />
${NSD_CreateLabel} 120u 0u 100% 100% &quot;$(INSTALLATION_COMPLETE)&quot;<br />
${NSD_CreateLabel} 120u 17u 100% 100% &quot;$(INSTALL_SUCCESS_DESC)&quot;<br />
<br />
StrCpy $1 $(^FontSize)<br />
IntOp $1 $1 + 4<br />
CreateFont $1 &quot;$(^Font)&quot; &quot;$4&quot; 700<br />
GetDlgItem $3 $0 1201<br />
SendMessage $3 ${WM_SETFONT} $1 0<br />
<br />
nsDialogs::Show<br />
<br />
${NSD_FreeImage} $2<br />
Pop $4<br />
Pop $3<br />
Pop $2<br />
Pop $1<br />
Pop $0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">11th February 2009, 18:55</div></div><div class="posttext">IntOp $1 $1 + 4<br />
CreateFont $1 &quot;$(^Font)&quot; &quot;$4&quot; 700<br />
<br />
$4 should be the font height, but $4 is not given a value in this routine. Perhaps you meant to do that with the IntOp instruction like this IntOp $4 $1 + 4<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">11th February 2009, 19:32</div></div><div class="posttext">when using MUI, you need to use !insertmacro MUI_HEADER_TEXT &quot;aaaa&quot; &quot;bbb&quot; to set the header text. If you don't want a header at all, don't use the modern ui ;) If you want MUI but no header on that page, you must do some trickery with the system plugin.<br />
<br />
You could hide the top header, but then your page would look funny with a big gray spot on the top. Your best bet is to GetDlgItem $0 $hwndparent 0x414, then call GetClientRect on that window with the system plugin and CreateWindowEx another static control that is slightly smaller than 0x414 and use that as the parent for nsDialogs</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Spilly</div><div class="date">11th February 2009, 19:47</div></div><div class="posttext">Thanks Anders, I'll give it a try and let you know how it goes</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">11th February 2009, 20:17</div></div><div class="posttext">ah, odd - might be a typo in the nsDialogs doc?  Or maybe I'm just doing something funky.<br />
<br />
Quick check with WinSpy++ told me it should be 1044, not 1040 (though note that in some earlier threads there were some other ID mismatches).<br />
<br />
Regardless.. the below code should show a standard MUI custom page with the header, and a customized Finish page-style custom page which, with MUI, doesn't have the header.<br />
I've stuck a button control in both so you can check the size of the nsDialogs-created dialog area.<br />
<br />
<br />
!include &quot;MUI2.NSH&quot;<br />
!include &quot;nsDialogs.nsh&quot;<br />
outfile 'test.exe'<br />
<br />
Section<br />
	MessageBox MB_OK &quot;test&quot;<br />
SectionEnd<br />
<br />
Page custom custom_pre<br />
Page custom customfinish_pre<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
Function custom_pre<br />
	nsDialogs::Create 1018<br />
	Pop $0<br />
	${NSD_CreateButton} 0 0 100% 100% &quot;button!&quot;<br />
	Pop $1<br />
	nsDialogs::Show<br />
FunctionEnd<br />
<br />
Function customfinish_pre<br />
	nsDialogs::Create 1044<br />
	Pop $0<br />
	${NSD_CreateButton} 0 0 100% 100% &quot;button!&quot;<br />
	Pop $1<br />
	nsDialogs::Show<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">regodon</div><div class="date">12th September 2012, 15:26</div></div><div class="posttext">Hi, I'm new here. I just registered to say thanks Animaether!!<br />
<br />
1044 was the answer to all my problems! :D<br />
<br />
BTW, Can someone please update nsDialogs documentation??<br />
<br />
http://nsis.sourceforge.net/Docs/nsDialogs/Readme.html#ref-create  still states 1040 is the identifier of the control for the welcome and finish pages.<br />
<br />
Regards</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>