<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Deleting a previously installed version of my software?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Deleting a previously installed version of my software? NSIS Discussion" />
	
	<title> Deleting a previously installed version of my software? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Deleting a previously installed version of my software?</div>
<hr />
<div class="pda"><a href="t-289862.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289862">Deleting a previously installed version of my software?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kook04</div><div class="date">8th April 2008, 15:08</div></div><div class="posttext">My install script currently writes a value to the registry which points the uninstall.exe file that get created during the install process.  The line looks like this:<br />
<br />
<br />
WriteRegStr ${UNINSTALL_ROOT_KEY} &quot;${UNINSTALL_KEY}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\uninstall.exe&quot;<br />
<br />
<br />
I would like to add logic to the beginning of my script that would check for the existence of this registry value, and if it exists, remove the previous version of my software by calling that uninstall.exe file.<br />
<br />
Does anyone currently do this?  The pseudo-logic would look like this:<br />
<br />
if (registry_key.exists)<br />
{<br />
  Variable x = registry_value;<br />
  Execute(x);<br />
}<br />
<br />
I'm not exactly sure how to check for the existance of a specific registry key, and then get the value for that key.  Also, I then need execute the .exe file that is pointed to by that value.<br />
<br />
<br />
Thank You,<br />
<br />
Kennedy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">8th April 2008, 16:22</div></div><div class="posttext">ReadRegStr (returns &quot;&quot; and sets the error flag if not found)<br />
also remember to use the _? trick if you need the uninstaller to wait (ExecWait '&quot;$INSTDIR\uninstall.exe&quot; _?=$INSTDIR')</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kook04</div><div class="date">8th April 2008, 16:40</div></div><div class="posttext">Anders,<br />
<br />
That is very helpful.  ReadRegStr is just what I needed.<br />
<br />
Thanks.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>