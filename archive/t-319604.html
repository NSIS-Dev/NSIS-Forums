<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" how to read registry entries from 64 bit systems, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  how to read registry entries from 64 bit systems NSIS Discussion" />
	
	<title> how to read registry entries from 64 bit systems [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  how to read registry entries from 64 bit systems</div>
<hr />
<div class="pda"><a href="t-319604.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=319604">how to read registry entries from 64 bit systems</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dhiraj3301</div><div class="date">2nd June 2010, 04:34</div></div><div class="posttext">Hello,<br />
<br />
i have use folllowing commang to read the installed instances of sqlserver 2008<br />
${registry::Read}  &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server&quot; &quot;InstalledInstances&quot; $R0 $R1<br />
<br />
this works fine for sqlserver for x86 machine,but for x64 machine it will find the Installedinstances from SOFTWARE\Wow6432Node\Microsoft\Microsoft SQL Server&quot; &quot;InstalledInstances&quot; <br />
<br />
but i want registry entries from SOFTWARE\Microsoft\Microsoft SQL Server&quot; &quot;InstalledInstances&quot;  so i have used following code<br />
<br />
SetRegView 64<br />
${registry::Read}  &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\$4&quot; &quot;InstalledInstances&quot; $R0 $R1<br />
<br />
but it still shows me data in  SOFTWARE\Wow6432Node\Microsoft\Microsoft SQL Server&quot; &quot;InstalledInstances&quot; <br />
<br />
please suggest what i have to do to read entries from  &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server&quot; &quot;InstalledInstances&quot;<br />
<br />
Thanks,<br />
Dhiraj</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">2nd June 2010, 08:32</div></div><div class="posttext">In the registry plugin thread I see a post stating that REG_MULTI_SZ values aren't properly read from x64 registry. Perhaps that is your problem?<br />
<br />
If you want to read a registry value into a string, you can always just use the normal command:  http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2.12</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dhiraj3301</div><div class="date">2nd June 2010, 09:38</div></div><div class="posttext">I can not use normal command (Readregstr)because it is not reading multiple values.<br />
I want to read value from &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server&quot; &quot;InstalledInstances&quot;<br />
which are <br />
e.g.<br />
 SQLEXPRESS<br />
 Sqltest<br />
<br />
for reading this value i require ${registry::Read}  command,can anyone tell me why SetRegView 64 is not working<br />
<br />
Thanks,<br />
Dhiraj</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd June 2010, 09:57</div></div><div class="posttext">SetRegView ensures NSIS opens/creates/deletes keys using KEY_WOW64_64KEY. The registry plug-in does not seem to have a switch to enable the use of KEY_WOW64_64KEY. You need to contact the author.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dhiraj3301</div><div class="date">2nd June 2010, 12:56</div></div><div class="posttext">can anyone please tell what to do to read registry entry in native section(64 bit section)on 64 bit machine.i have read the blogs but i didn't find exact solution for it<br />
<br />
Thanks,<br />
Dhiraj</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd June 2010, 13:02</div></div><div class="posttext">http://nsis.sourceforge.net/REG_MULTI_SZ_Reader<br />
http://msdn.microsoft.com/en-us/library/aa384129%28v=VS.85%29.aspx<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">2nd June 2010, 14:01</div></div><div class="posttext">I can not use normal command (Readregstr)because it is not reading multiple values.<br />
Have you considered using EnumRegValue?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd June 2010, 10:15</div></div><div class="posttext">EnumRegValue is for enumerating values in a key not REG_MULTI_SZ.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>