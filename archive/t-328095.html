<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" DeleteRegValue problems..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  DeleteRegValue problems... NSIS Discussion" />
	
	<title> DeleteRegValue problems... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  DeleteRegValue problems...</div>
<hr />
<div class="pda"><a href="t-328095.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=328095">DeleteRegValue problems...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Greenvicted</div><div class="date">4th March 2011, 20:47</div></div><div class="posttext">I have a big problem, in Microsoft SQL Server, subkey i can delete subkeys no problem but i cannot delete a subkey value, with or with out the registry plugin. And yes i do have the permissions!<br />
<br />
<br />
<br />
<br />
DeleteRegKey  HKLM &quot;Software\Microsoft\Microsoft SQL Server\$SqlFolder&quot; ; works<br />
<br />
DeleteRegValue HKLM &quot;Software\Microsoft\Micrososft SQL Server\test&quot; &quot;r0&quot; ;Does not work<br />
<br />
<br />
${registry::DeleteValue}  &quot;HKEY_LOCAL_MACHINE\Software\Microsoft\Micrososft SQL Server\test&quot; &quot;r0&quot; $Main_dir ;Does not work<br />
<br />
<br />
<br />
<br />
<br />
<br />
Anybody has an idea?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zinthose</div><div class="date">4th March 2011, 21:37</div></div><div class="posttext">Assuming you stored the name of the key in $0 you use this:DeleteRegValue HKLM &quot;Software\Microsoft\Micrososft SQL Server\test&quot; &quot;$0&quot;The use of r0 is typically a System plugin syntax.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Greenvicted</div><div class="date">7th March 2011, 16:24</div></div><div class="posttext">I tried it and and it still does not want to delete the $%$%&amp; value... Any other solutions?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">7th March 2011, 17:05</div></div><div class="posttext">Most probably the regvalue name is wrong. Do a MessageBox MB_OK &quot;$0&quot; before the delete command to verify what value $0 contains.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Greenvicted</div><div class="date">8th March 2011, 15:38</div></div><div class="posttext">Ok, i have checked the value, i did that before i posted the last post. The main problem is in Microsoft SQL  Server folder you can delete keys but can't delete values...Outside the folder everything works fine. So maybe somebody knows how to move a RegKey, so ican put it outside the folder delete the value and then get it back where it was. Or maybe somebody that has experience with this kind of problems ? By the way i did check the permissions! The funny part is, i can delete RegKeys !?!<br />
<br />
<br />
<br />
thanks for your answers!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th March 2011, 15:42</div></div><div class="posttext">That's odd. Do you have RequestExecutionLevel admin?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">8th March 2011, 16:30</div></div><div class="posttext">Well he did say he had sufficient permission. But though I don't know much about registry permissions, I wouldn't be surprised if one could make it require more than just admin access. For files/directories for example, you can block even admins from accessing/deleting something. But as far as I know you can never prevent them from giving themselves access again. So perhaps you should grant yourself full access to the regkey before trying to delete the regvalue?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Greenvicted</div><div class="date">15th March 2011, 17:43</div></div><div class="posttext">I tried the Full control for every User (might as well...), as for RequestExecution Level, i did not use it i'm on XP,but i tried it anyway....same $%^&amp; different bucket! I was wondering how can i move a key, or copy a key ? Because i would copy it where i want it, delete it and then delete the specified value and move it or recopy it (the key) where it is suppose to be. That's the only thing i can see!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">15th March 2011, 18:06</div></div><div class="posttext">You can view registry key permissions in regedit...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Greenvicted</div><div class="date">16th March 2011, 21:05</div></div><div class="posttext">I think i found out why in the Micrososft SQL Server (folder/Key) i found the same value, since i kind of messed up SQL server i deleted the value and the subkey deseapeared, they seem to be linked somehow..? (i'm not a big registry expert).So i just need to delete that value in the &quot;main key&quot; but it's a REG_MULTI_SZ value, and if there is more then one instance of SQL server they will show up in there, i just want to delete one of them. Do you know if the next line of code will do the trick?<br />
<br />
<br />
DeleteRegValue HKLM &quot;Software\Microsoft\Micrososft SQL Server&quot; &quot;$Thevalue&quot;<br />
<br />
<br />
<br />
P.S. If anyone can tell me how to link a value to a subkey value, that would be nice!<br />
<br />
Thanks for the replies</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Greenvicted</div><div class="date">18th March 2011, 15:28</div></div><div class="posttext">Hi, if anybody has an issue like this, there may be an easy way out. Go check that other thread.<br />
<br />
<br />
http://forums.winamp.com/showthread.php?t=328541<br />
<br />
<br />
<br />
Thanks for your responses!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>