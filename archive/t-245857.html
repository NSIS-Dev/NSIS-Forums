<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" FileOpen - Help, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  FileOpen - Help NSIS Discussion" />
	
	<title> FileOpen - Help [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  FileOpen - Help</div>
<hr />
<div class="pda"><a href="t-245857.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=245857">FileOpen - Help</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">lievencardoen</div><div class="date">10th May 2006, 09:34</div></div><div class="posttext">I have this piece of code : <br />
<br />
FileOpen $3 $0\login.xml w<br />
      IfErrors 0 +3<br />
         MessageBox MB_OK &quot;Could not write to network destination. See if you have proper rights.&quot;<br />
         Abort<br />
      StrCpy $4 &quot;&lt;users&gt;&lt;/users&gt;&quot;<br />
      FileWrite $3 $4<br />
      FileClose $3<br />
<br />
No, when I choose a network destination (mapped network drive), I get the message &quot;Could not write to network destination...&quot;. So, normally, you should think that login.xml is not created. But it is. A login.xml file is created, but &lt;users&gt;&lt;/users&gt; is not written into it...<br />
<br />
Why is this?<br />
<br />
thx, Lieven Cardoen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">10th May 2006, 09:40</div></div><div class="posttext">Where is this code placed? Abort only works inside a function, I think. If it's just in a section, you probably need to do this:<br />
<br />
FileOpen $3 $0\login.xml w<br />
IfErrors writeerror<br />
StrCpy $4 &quot;&lt;users&gt;&lt;/users&gt;&quot;<br />
FileWrite $3 $4<br />
FileClose $3<br />
Goto writeend<br />
writeerror:<br />
MessageBox MB_OK &quot;Could not write to network destination. See if you have proper rights.&quot;<br />
writeend:<br />
<br />
Or something...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">10th May 2006, 09:42</div></div><div class="posttext">Actually, this is slightly neater:<br />
<br />
FileOpen $3 $0\login.xml w<br />
IfErrors 0 +3<br />
MessageBox MB_OK &quot;Could not write to network destination. See if you have proper rights.&quot;<br />
Goto writeend<br />
StrCpy $4 &quot;&lt;users&gt;&lt;/users&gt;&quot;<br />
FileWrite $3 $4<br />
FileClose $3<br />
writeend:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">10th May 2006, 09:43</div></div><div class="posttext">And while I'm bumping up massive amounts of posts just on this one thread, make sure you call ClearErrors at the start, otherwise IfErrors could just be picking up an old error.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lievencardoen</div><div class="date">10th May 2006, 09:43</div></div><div class="posttext">Well, it's inside a function so I don't think it has something to do with that...<br />
<br />
thx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lievencardoen</div><div class="date">10th May 2006, 09:52</div></div><div class="posttext">Anyway, I need to abort so that nsis doesn't move on to next dialog...<br />
<br />
I changed my code to <br />
<br />
IfFileExists $0\login.xml +8 0<br />
      FileOpen $3 $0\login.xml w<br />
      StrCpy $4 &quot;&lt;users&gt;&lt;/users&gt;&quot;<br />
      FileWrite $3 $4<br />
      FileClose $3<br />
      IfErrors 0 +3<br />
         MessageBox MB_OK &quot;Could not write to network destination. See if you have proper rights.&quot;<br />
         Abort<br />
<br />
It doesn't make a lot of sense but what happens is this. The file login.xml is created, the xml is written to it and then the MessageBox is shown... but why, there doesn't seem to be any problem...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lievencardoen</div><div class="date">10th May 2006, 09:55</div></div><div class="posttext">I guess ClearErrors is a usefull command. Apparently this was the problem...<br />
<br />
Thx, guys, for the feedback!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>