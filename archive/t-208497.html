<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Q: Does NSIS support RunAs credentials and Silent installs?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Q: Does NSIS support RunAs credentials and Silent installs? NSIS Discussion" />
	
	<title> Q: Does NSIS support RunAs credentials and Silent installs? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Q: Does NSIS support RunAs credentials and Silent installs?</div>
<hr />
<div class="pda"><a href="t-208497.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=208497">Q: Does NSIS support RunAs credentials and Silent installs?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">masken</div><div class="date">22nd February 2005, 09:22</div></div><div class="posttext">Network admins (as me) working in MS domain environments almost always have users that aren't local administrators (for obvious reasons).<br />
<br />
We normally handle installations and patch management through Active Directory or some other solution (SMS for example), with MSI/MSP packages.<br />
<br />
Sometimes though, it is desired to have standalone installers that can be distributed with CD's etc. Since the users doesn't have local admin rights, does the NSIS support RunAs? Ie, can a designated user account be coded into the NSIS package so that it runs with a different accounts? And if so, how well is the provided credentials encrypted?<br />
<br />
Also, can the installer be made totally silent, so it only displays a progress bar after a double-click?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd February 2005, 18:25</div></div><div class="posttext">There is no built-in support for such credentials. Personally, I think the risks of giving administrator access with one breakpoint by far exceed the gain of not having to type the password yourself. The only way I see of avoiding this problem is having a service ran by the system user which will verify the installer. I guess that's what MSIs with credentials do.<br />
<br />
To run an installer silently, use the /S command line switch or the SilentInstall command in the script. To make it just show the progress bar, simply remove the unrequired pages from the script. You can also add a command line control switch that will cause every page pre function to call Abort to skip the page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">masken</div><div class="date">22nd February 2005, 22:04</div></div><div class="posttext">Agreed, providing credentials with a file isn't the safest way, even if encrypted.<br />
<br />
But there are options to minimize the effects of this, for example, you can specify a domain account that times out after the installation, or a local account with administrative purposes (which you could centrally script the creation of for example). You can then have your own code within the script to delete that accout once done with the installation.<br />
<br />
Most important is to have the option there ;) Almost every company - small as well as large - has come to terms with the fact that you shouldn't run your Windows-based PC with administrative rights unless you're installing software that requires elevated permissions (and not even then - use RunAs). Even many talented home-users have realized this fact. This realizes the need for installers that supports running under specified credentials :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th February 2005, 18:51</div></div><div class="posttext">The effect of giving a user administrative access, even if temporarily, is too destructive. You are not only giving the user the option to control a fully granted process, you are also giving away the user name and the password. Even if you encrypt the user and the password, the key will have to be contained in the installer along with the encrypted data. It doesn't matter if the installer might be set to delete that user when it's done as the user doesn't even need to run the installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">masken</div><div class="date">25th February 2005, 23:40</div></div><div class="posttext">yes yes, I've already answered that. There's ways to control this fairly good, wtih time-limited, logon-count limited accounts for example. Main point is to have the option there. This is something wanted by thousands of network admins, and something only available in expensive packagers as WISE etc...<br />
<br />
In other words, a really useful and wanted feature.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th February 2005, 23:43</div></div><div class="posttext">I have no intention of implementing such a flawed method. If you have a better idea, I'll consider it. But saving the user name and the password in the installer is unaccepted.<br />
<br />
If you're willing to put up with the flaws, you can create a batch file that will execute runas.exe.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fredhof</div><div class="date">12th October 2005, 15:57</div></div><div class="posttext">There is always the application TQCrunas from the Quimeras Company (http://www.quimeras.com)...<br />
<br />
However, we're having some challenges in getting it to work in a multi-installer package...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>