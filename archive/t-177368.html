<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Dependent DLL Question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Dependent DLL Question NSIS Discussion" />
	
	<title> Dependent DLL Question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Dependent DLL Question</div>
<hr />
<div class="pda"><a href="t-177368.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=177368">Dependent DLL Question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">scully13</div><div class="date">20th April 2004, 16:17</div></div><div class="posttext">I had a big problem which I seem to have a work around for. Now I'm wondering if I've been doing something wrong. I have 2 DLLs. DLL A is dependent on DLL B. I wrote DLL A but I only downloaded and compiled DLL B. The problem is that if I call a SetOutPath anywhere in my NSI script before I use DLL A it won't work. I get this error in the install.log file: &quot;Error registering DLL: Could not load C:\yada\yada\DLLA.dll&quot;. If I remove the SetOutPath or add a SetOutPath $PLUGINSDIR before my Call to DLL A I'm ok. Is there something else I can do so that I don't have to add the extra SetOutPath before every call to my DLL A?<br />
<br />
Both files are always in the plugins directory like they should be. I also did some testing with other DLLS like advsplash.dll and it's fine. If I strip my DLL down so that it doesn't need the dependency it's ok. So, It must be that my DLL has a dependent.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">20th April 2004, 18:45</div></div><div class="posttext">Advsplash is an NSIS plug-in which does not have to be registered.<br />
<br />
I assume you need the DLL only temporary, so why don't you create a NSIS plug-in or a DLL that doesn't have to registered?<br />
<br />
RegDLL uses the path set by SetOutPath. If DLL B is in $PLUGINSDIR, the directory should be set to $PLUGINSDIR. You only have to add SetOutPath before registering the DLL.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scully13</div><div class="date">20th April 2004, 19:20</div></div><div class="posttext">I don't think either DLL needs to be registered. I've been using them for over a year and we never regsitered them before so I think that's ok. However, if there is something I can check to see if it needs to be registered I'll check it out.<br />
<br />
DLL A is an NSIS plug-in but DLL B is not. DLL B is some of the boost library functions from boost.org.<br />
<br />
I guess for now I'll just make sure I use &quot;SetOutPath $PLUGINSDIR&quot; before I call DLL A. Maybe later I'll try and merge the boost stuff in. Thanks,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scully13</div><div class="date">20th April 2004, 19:23</div></div><div class="posttext">Here is my test code if anybody sees anything stupid I'm doing wrong.<br />
<br />
  Name &quot;Example1&quot;<br />
  OutFile &quot;setup.exe&quot;<br />
<br />
  InstallDir &quot;$PROGRAMFILES\Example1&quot;<br />
<br />
  ReserveFile &quot;${NSISDIR}\Plugins\boost.dll&quot;<br />
<br />
Function .onInit<br />
<br />
  InitPluginsDir<br />
  SetOutPath $PLUGINSDIR<br />
  File &quot;${NSISDIR}\Plugins\boost.dll&quot;<br />
  <br />
FunctionEnd<br />
<br />
Section &quot;Section&quot; sec<br />
<br />
  SetOutPath &quot;$INSTDIR&quot; ; this breaks it.<br />
  ;SetOutPath $PLUGINSDIR ; putting this in makes it work.<br />
  <br />
  File &quot;${NSISDIR}\makensis.exe&quot;<br />
  <br />
  util::test<br />
  ;exdll::myFunction<br />
  <br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">20th April 2004, 20:44</div></div><div class="posttext">Right, I thought it was not a NSIS plug-in because you are registering it. This DLL does not have to be registered.<br />
<br />
It is indeed true that you should set the current folder to $PLUGINSDIR if the DLL is linked to another DLL.<br />
<br />
You can create a macro or load the the second DLL dynamically.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>