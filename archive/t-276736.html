<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" UAC plugin problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  UAC plugin problem NSIS Discussion" />
	
	<title> UAC plugin problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  UAC plugin problem</div>
<hr />
<div class="pda"><a href="t-276736.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=276736">UAC plugin problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">frayed</div><div class="date">31st August 2007, 13:32</div></div><div class="posttext">Hi<br />
<br />
I am using the UAC plugin in my installer. The documentation says thay you should use RequestExecutionLevel user. My problem is, that the installer runs perfectly for all cases except when a standard user installs and chooses to install for the current user only. Then no shortcuts are made on the desktop, for quicklaunch or in the all programs menu because the installer cannot write to the registry.<br />
<br />
How can i avoid this problem?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">31st August 2007, 15:53</div></div><div class="posttext">How is the registry related to shortcuts?<br />
<br />
Could you provide a sample script with this problem?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">frayed</div><div class="date">3rd September 2007, 12:24</div></div><div class="posttext">Shortcuts don't have anything to do with the registry as such. What i meant to say was that I could see that some of the writes to the registry were not performed when installing for the current user as a standard user, which indicated that i was being restricted in some way. I assumed that the restriction was also the reason why the shortcuts were not generated. SetShellVarContext is set to current in this case. The sample looks like this:<br />
<br />
WriteRegStr SHCTX &quot;Software\&lt;Product Name&gt;&quot; &quot;&quot; $INSTDIR<br />
WriteRegStr SHCTX &quot;Software\&lt;Product Name&gt;&quot; &quot;major&quot; $Current_major<br />
WriteRegStr SHCTX &quot;Software\&lt;Product Name&gt;&quot; &quot;minor&quot; $Current_minor<br />
WriteRegStr SHCTX &quot;Software\&lt;Product Name&gt;&quot; &quot;build&quot; $Current_build<br />
WriteRegStr SHCTX &quot;Software\&lt;Product Name&gt;&quot; &quot;InstallType&quot; $InstallType<br />
WriteRegStr SHCTX &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\&lt;Product Name&gt;&quot; &quot;DisplayName&quot; &quot;&lt;Product Name&gt;&quot;<br />
WriteRegStr SHCTX &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\&lt;Product Name&gt;&quot; &quot;UninstallString&quot; &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
<br />
CreateDirectory &quot;$SMPROGRAMS\&lt;Product Directory&gt;&quot;<br />
CreateShortCut &quot;$SMPROGRAMS\&lt;Product Directory&gt;\&lt;Product Name&gt;.lnk&quot; &quot;$INSTDIR\Foo.exe&quot; &quot;&quot; &quot;&quot; &quot;&quot; SW_SHOWNORMAL<br />
CreateShortCut &quot;$SMPROGRAMS\&lt;Product Directory&gt;\Uninstall &lt;Product Name&gt;.lnk&quot; &quot;$INSTDIR\Uninstall.exe&quot; &quot;&quot; &quot;&quot; &quot;&quot; SW_SHOWNORMAL<br />
CreateShortCut &quot;$SMPROGRAMS\&lt;Product Directory&gt;\&lt;Product Name&gt; Manual.lnk&quot; &quot;$INSTDIR\Help\en-manual\en-manual.html&quot; &quot;&quot; &quot;&quot; &quot;&quot; SW_SHOWNORMAL<br />
CreateShortCut &quot;$SMPROGRAMS\&lt;Product Directory&gt;\&lt;Product Name&gt; Read Me.lnk&quot; &quot;$INSTDIR\Help\en-manual\engReadMe.html&quot; &quot;&quot; &quot;&quot; &quot;&quot; SW_SHOWNORMAL<br />
<br />
Is the problem that when using the UAC plugin, RequestExecutionLevel must be set to user and consequently this restricts me when being a standard user?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">3rd September 2007, 14:46</div></div><div class="posttext">&quot;RequestExecutionLevel user&quot; should not restrict a non admin user in any way (other than the restrictions this user already has)<br />
<br />
So what you are saying is that a non admin user performing the install (without elevation) is the problem?<br />
<br />
If you don't use the UAC plugin at all (Still using RequestExecutionLevel user), does the problem still exist?<br />
<br />
I have not seen this problem before and I will try to look into it</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>