<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" CreateShortCut for All Users, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  CreateShortCut for All Users NSIS Discussion" />
	
	<title> CreateShortCut for All Users [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  CreateShortCut for All Users</div>
<hr />
<div class="pda"><a href="t-50066.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=50066">CreateShortCut for All Users</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Aarif</div><div class="date">17th May 2001, 23:46</div></div><div class="posttext">Hey there,<br />
<br />
Does anyone know an easy way to create a shortcut under the &quot;All Users&quot; folder in WinNT/2K instead of the users' own start menu?  The builtin $STARTMENU replacable parameters point to the users' own start menu.<br />
<br />
Thanks,<br />
Aarif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbareis</div><div class="date">18th May 2001, 00:50</div></div><div class="posttext">As far as I can see NSIS needs to add variables for these items as I have suggested in the past...<br />
<br />
This is what the VB script &quot;SpecialFolders&quot; returns:<br />
<br />
The following special folders are provided with the Windows 95 and Microsoft Windows NT 4.0 operating systems: <br />
<br />
AllUsersDesktop <br />
AllUsersStartMenu <br />
AllUsersPrograms <br />
AllUsersStartup <br />
Desktop <br />
Favorites <br />
Fonts <br />
MyDocuments <br />
NetHood <br />
PrintHood <br />
Programs <br />
Recent <br />
SendTo <br />
StartMenu<br />
Startup <br />
Templates <br />
<br />
These should probably be the minimum available and probably with these names as Microsoft selected them.<br />
<br />
As I already have a site of my own with over 100 of my own free downloads I don't have time myself to do these things...  But if someone does PLEASE ADD &quot;COMSPEC&quot; and preferably generic access to environment variables...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yazno</div><div class="date">18th May 2001, 07:16</div></div><div class="posttext">hi,<br />
dbareis,<br />
<br />
don't panic ;)<br />
<br />
use this function until it is implemented in nsis<br />
(will it ?)<br />
<br />
;==============================<br />
Function GetShellFolderPath<br />
;==============================<br />
<br />
 ;possible values for 'folder_name':<br />
 ;Desktop, Personal, NetHood, PrintHood, Programs,<br />
 ;'Start Menu', AppData,SendTo, Cache, Cookies, History,<br />
 ;Favorites, Startup, Recent, Templates,'Local AppData',<br />
 ;Fonts, 'My Music', 'My Video', 'My Pictures'<br />
 ;(if the list is incomplete please post back)<br />
<br />
 StrCpy $0 &quot;folder_name&quot;<br />
<br />
 ClearErrors<br />
 ReadRegStr $1 HKCU \<br />
&quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders&quot; &quot;$0&quot;<br />
<br />
  IfErrors lbl_na lbl_ok <br />
<br />
   lbl_na:<br />
     MessageBox MB_OK &quot;ShellFolder-Path is not available!&quot;<br />
     GoTo lbl_end<br />
 <br />
   lbl_ok:  <br />
     StrCmp $1 &quot;&quot; lbl_na<br />
     MessageBox MB_OK &quot;$1&quot;<br />
<br />
   lbl_end:<br />
;------------------------------<br />
FunctionEnd<br />
;------------------------------<br />
<br />
cu yzo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbareis</div><div class="date">18th May 2001, 11:09</div></div><div class="posttext">Good workaround, it would be nice if all the handy little snippets were collected somewhere!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">18th May 2001, 18:47</div></div><div class="posttext">Isn't TheMIKE working on collecting all these snippets?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yazno</div><div class="date">18th May 2001, 20:17</div></div><div class="posttext">hi,<br />
<br />
i have set up a functions archive (currently 7 functions of myself which are included with PowerPiMPiT) on my page (click on Functions Included), feel free to visit/contribute to it.<br />
<br />
cu yzo</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>