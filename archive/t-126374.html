<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS DLL Registration problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS DLL Registration problem NSIS Discussion" />
	
	<title> NSIS DLL Registration problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS DLL Registration problem</div>
<hr />
<div class="pda"><a href="t-126374.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=126374">NSIS DLL Registration problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">rmilican</div><div class="date">25th February 2003, 18:17</div></div><div class="posttext">Greetings,<br />
<br />
We use NSIS to install the anonymizer toolbar.  The toolbar basically consists of some images and 2 DLLs.  <br />
<br />
Most of the time when the toolbar is installed all works as planed.  But on some peoples computers the toolbar dlls are registered improperly.  This causes the toolbar not to show up.  If one registers them manually after the case it works.<br />
<br />
So my question is what would be the reasons NSIS might have a problem registering a DLL and is there any kinda logging I can turn on to figure this out?<br />
<br />
I am using version NSIS 1.98.  We have seen this issue a lot on XP are there any known issues with 1.98 on XP?<br />
<br />
Thanks in Advance!<br />
<br />
Roy Milican<br />
rmilican@anonymizer.com<br />
http://www.anonymizer.com</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">25th February 2003, 20:26</div></div><div class="posttext">then I changed:<br />
<br />
<br />
RegDLL &quot;$SYSDIR\my.dll&quot;<br />
<br />
<br />
:p</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">25th February 2003, 20:28</div></div><div class="posttext">The UpgradeDLL macro upgrades a DLL file, registering is something else.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th February 2003, 10:19</div></div><div class="posttext">RegDLL just calls DllRegisterServer, there shouldn't be any problem with XP. Just to be sure, try the latest version of NSIS (2.0b1 or CVS version), and see if it still happens.<br />
<br />
The only problem I can think of is if the DLL you are regstring is looking for another DLL that it depends on in the same directory. I can't see why this would cause it to mailfunction on just a part of the systems, but it's worth checking. To fix this you'll have to upgrade to 2.0b1 and use SetOutPath &quot;C:\path\to\dll&quot;. It will set the current directory of the installer so the DllRegisterServer will look there too.<br />
<br />
To turn on file logging you'll have to uncomment #define NSIS_CONFIG_LOG in Source\exehead and recompile NSIS. It won't help you much in this case. You'll get the exact same messages as you get in the normal log.<br />
<br />
If non of the above helps please clarify &quot;registered improperly&quot;. Is DllRegisterServer called? Does NSIS set the error flag?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rmilican</div><div class="date">26th February 2003, 18:05</div></div><div class="posttext">Greetings,<br />
<br />
Sorry when I said &quot;registered improperly&quot; I really ment not at all :)  Because if it does not get registered the toolbar does not show up in IE.  <br />
<br />
The error flag is being set when the DLL registration fails.  The problem we are seeing is that we have see it fail and the toolbar still show up and fail and it doesn't show and some times work fine. All this from the same machine and installer.  If there a way to get the reason the error flag was set?  <br />
 <br />
Yes we are dependent on several of the windows dll's but they seem to be standard<br />
accross all windows installs.  We dont think they have anything to do with the problem because it works most of the time, and as stated above even on the same machine will fail some times and not others.<br />
<br />
We are going to convert to the NSIS 2.0 and try using it to see if we still have these problems.<br />
<br />
If you have any further ideas or insight we are willing to hear them.<br />
<br />
Thanks in advance<br />
<br />
Roy Milican<br />
rmilican@anonymizer.com<br />
http://www.anonymizer.com</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th February 2003, 22:37</div></div><div class="posttext">If the error flag is set then there must be an error text in the installer log (details) too. What is the error your users get?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rmilican</div><div class="date">27th February 2003, 18:21</div></div><div class="posttext">Greetings,<br />
<br />
We rebuilt NSIS 2.0 with logging enabled as you suggest in a previous post.  We then used the command stated in the readme &quot;Logset On&quot; to dump the log file in the install directory when its done. We made sure  It is not creating the log file. What could be the reason? <br />
<br />
Thanks,<br />
<br />
Roy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th February 2003, 18:23</div></div><div class="posttext">Please upgrade to NSIS 2.0b2 and then use NSIS Update to get the latest CVS veresion. I have fixed a bug with LogSet on in the latest CVS version, it should be the cause.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>