<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Auto-Uninstall/NT 4, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Auto-Uninstall/NT 4 NSIS Discussion" />
	
	<title> Auto-Uninstall/NT 4 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Auto-Uninstall/NT 4</div>
<hr />
<div class="pda"><a href="t-57768.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=57768">Auto-Uninstall/NT 4</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Pomflain</div><div class="date">21st August 2001, 19:59</div></div><div class="posttext">I've been using NSIS for all the windows side installers at my job.  What I've being doing recently is having the installers check for a previous installation and then prompting the user if a previous version is found.  The problem is that on NT 4.0,  this doesn't work for some reason.  I'm doing this check in .OnInit,  and I've tried using ExecShell,  Exec,  ExecWait,  and even !system,  but none of them will work.  If I move this code out of .OnInit and into the main section,  then the Exec's will work,  but then you have to loop to prevent the installer from continuing the run - it's a mess.  So it would be great if this kind of thing could be integrated into the scripts as an option.<br />
<br />
Other things that would be nice would be if the uninstaller could close by default.  I tried manipulating autoclose a bunch of different ways,  but I couldn't get it to work.  Maybe I'm doing something wrong,  but I tried all the ways I could see.<br />
<br />
Having variables so you can increment and decrement.  I've been working in the registry and absolutely have to loop,  so I basically have a large if x == 3,  x = 4 type of deal.  So that would be a nice addition.<br />
<br />
I love this installer,  saved a lot of $$$ since it's free,  and have been able to do all kinds of great and crazy stuff with the scripts.  I've just spent the majority of today trying to come up with a good solution for this apparently NT 4 problem,  but I haven't seen it on any of the other versions of windows 95 up.  It could potentially be a memory problem as the machine has 32 mb of ram total,  which is pretty bad for NT 4.<br />
<br />
Here's my code I've been using to do the uninstall,  any ideas would be greatly appreciated.  Thanks:<br />
<br />
Function .onInit<br />
<br />
strcpy $4 &quot;FlingIt!&quot;<br />
<br />
ReadRegStr $9 HKEY_LOCAL_MACHINE &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$4&quot; &quot;UninstallString&quot;<br />
strcmp $9 &quot;&quot; Clean PrevInst<br />
<br />
Clean:<br />
goto InitDone<br />
<br />
PrevInst:<br />
<br />
ReadRegStr $8 HKEY_LOCAL_MACHINE &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$4&quot; &quot;DisplayName&quot;<br />
	<br />
MessageBox MB_YESNO &quot;$8 found$\nUninstall this version?&quot; IDNO InitDone<br />
	ExecShell &quot;&quot; &quot;$9&quot; SW_SHOWNORMAL<br />
		<br />
InitDone:<br />
FunctionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>