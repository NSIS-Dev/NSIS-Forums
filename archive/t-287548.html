<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" labels on the finish page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  labels on the finish page NSIS Discussion" />
	
	<title> labels on the finish page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  labels on the finish page</div>
<hr />
<div class="pda"><a href="t-287548.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=287548">labels on the finish page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bubu</div><div class="date">25th February 2008, 11:58</div></div><div class="posttext">i am trying to put labels on my finish page depending on what is installed during my process. so far i could make message boxes to show what was installed. but those appear only at the end after i press the finish button. they were veeery useful  but it was for testing only.<br />
this is my code for one program..the rest are almost the same:<br />
<br />
Function OnLeaveFinish<br />
;jre part<br />
<br />
 ;Call InstallJRE<br />
 StrCpy $CorrectJRE $0 <br />
 StrCmp $InstallJRE &quot;no&quot; 0<br />
 <br />
  ${If} $InstallJRE == &quot;no&quot;<br />
   MessageBox MB_OK &quot;JRE e instalat&quot;<br />
  ${Else}<br />
   MessageBox MB_OK &quot;JRE s-a instalat ACUM&quot;<br />
  ${EndIf}<br />
;other programs<br />
<br />
 FunctionEnd<br />
<br />
this is what i have put in my function.<br />
<br />
so...my big problem now is that i cannot do the same but with labels. on the finish page.<br />
<br />
this is how i called the function at the begining:<br />
;------------------------------<br />
  ; Finish Page<br />
;------------------------------<br />
    <br />
    !define MUI_FINISHPAGE_RUN<br />
    !define MUI_FINISHPAGE_RUN_FUNCTION &quot;OnLeaveFinish&quot;<br />
    !define MUI_FINISHPAGE_TEXT &quot;The following programs were installed on your computer:&quot; <br />
<br />
do you have any idea how to do this? how to put labels on the directly on the finish page...it has to look the same..but instead of message boxes ,,there has to be labels.<br />
thank you!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th February 2008, 13:25</div></div><div class="posttext">Why not use a ListBox control? You need to modify ioSpecial.ini at run time before the finish page is displayed. Search the forum for ioSpecial.ini<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bubu</div><div class="date">26th February 2008, 06:45</div></div><div class="posttext">why do i have to use a listbox? i was thinking that if i could do the  if-else thing with message boxes it should be pretty much the same with labels...but it does not work yet..:(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th February 2008, 13:10</div></div><div class="posttext">Yeh fine you can use a label control, but you have limited space and an item per line may not fit. Either way it doesn't really matter what control you use; the principle is the same. Concatenate your text to a global variable using StrCpy:<br />
<br />
StrCpy $MyVar `new text$\r$\n$MyVar`<br />
<br />
Then you can display this text on the finish page by writing it to ioSpecial.ini before showing the finish page (PRE function). Like I said, search for ioSpecial.ini and you will find plenty of examples for adding your own controls to the finish page (assuming you can find room to fit it in).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bubu</div><div class="date">26th February 2008, 18:20</div></div><div class="posttext">i have solved the problem...i used iospecial.ini. i made a function to create those labels. thx:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bubu</div><div class="date">26th February 2008, 18:58</div></div><div class="posttext">now it's true that xp has a problem with setting the background ? i found loads of topics with text and backgrounds etc... but nothing can change my grey background... it's silly<br />
<br />
this is what i have written in my function to set the colors:<br />
<br />
ReadINIStr $0 &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;HWND&quot;<br />
SetCtlColors $0 0x000000 transparent<br />
<br />
ReadINIStr $0 &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;HWND&quot;<br />
SetCtlColors $0 0x000000 transparent<br />
<br />
ReadINIStr $0 &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 8&quot; &quot;HWND&quot;<br />
SetCtlColors $0 0x000000 transparent<br />
<br />
ReadINIStr $0 &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 8&quot; &quot;HWND&quot;<br />
SetCtlColors $0 0x000000 transparent<br />
 InstallOptions::show</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bubu</div><div class="date">27th February 2008, 00:26</div></div><div class="posttext">this is what i declared first:<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE CreateControls<br />
    !define MUI_PAGE_CUSTOMFUNCTION_SHOW SetControlColours <br />
    !define MUI_INSTALLCOLORS &quot;0xFFFFFF 0x000000&quot;<br />
<br />
then..the functions:<br />
<br />
Function CreateControls<br />
 ;pcvisit label<br />
    WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Settings&quot; &quot;NumFields&quot; &quot;8&quot;<br />
    WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 8&quot; &quot;Type&quot; &quot;Label&quot;  <br />
     IfFileExists &quot;$PROGRAMFILES\PCVisit\PC_Visit.exe&quot; 0<br />
    WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 8&quot; &quot;Text&quot; &quot;$(DESC_Section5)&quot;<br />
    WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 8&quot; &quot;Left&quot; &quot;120&quot;<br />
    WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 8&quot; &quot;Right&quot; &quot;270&quot;<br />
    WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 8&quot; &quot;Top&quot; &quot;142&quot;<br />
    WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 8&quot; &quot;Bottom&quot; &quot;154&quot;<br />
    WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 8&quot; &quot;State&quot; &quot;3&quot;<br />
FunctionEnd<br />
<br />
Function SetControlColours<br />
<br />
InstallOptions::InitDialog /NOUNLOAD &quot;iospecial.ini&quot;<br />
ReadINIStr $0 &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 8&quot; &quot;HWND&quot;<br />
SetCtlColors $0 0x000000 transparent<br />
; Reload window<br />
  GetDlgItem $0 $HWNDPARENT 1<br />
  ShowWindow $0 ${SW_HIDE}<br />
  ShowWindow $0 ${SW_SHOW}<br />
; Now show the dialog and wait for it to finish<br />
  InstallOptions::show<br />
FunctionEnd<br />
 <br />
<br />
but i STILL have the gray background where the labels are... like in the attached photo above. :-&lt;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">27th February 2008, 01:33</div></div><div class="posttext">You are getting the handle of the Next (Finish) button with &quot;GetDlgItem 1&quot;. Try using the id of the static control where the text is written: 1202.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bubu</div><div class="date">27th February 2008, 07:28</div></div><div class="posttext">well..didn't worked.:( and by the way with that &quot;field 8&quot; i have field6, field 7, field 9.<br />
...and i am so sure this is a very simple thing...annoying<br />
my code:<br />
<br />
Function SetControlColours<br />
<br />
ReadINIStr &quot;$0&quot; &quot;$PLUGINSDIR\ioSpecial.ini&quot; &quot;Field 6&quot; &quot;HWND&quot;<br />
GetDlgItem $0 $HWNDPARENT 1205<br />
;SetCtlColors &quot;$0&quot; &quot;000000&quot; Transparent<br />
<br />
ReadINIStr &quot;$0&quot; &quot;$PLUGINSDIR\ioSpecial.ini&quot; &quot;Field 7&quot; &quot;HWND&quot;<br />
GetDlgItem $0 $HWNDPARENT 1206<br />
;SetCtlColors &quot;$0&quot; &quot;000000&quot; Transparent<br />
<br />
ReadINIStr &quot;$0&quot; &quot;$PLUGINSDIR\ioSpecial.ini&quot; &quot;Field 8&quot; &quot;HWND&quot;<br />
GetDlgItem $0 $HWNDPARENT 1207<br />
;SetCtlColors &quot;$0&quot; &quot;000000&quot; Transparent<br />
<br />
ReadINIStr &quot;$0&quot; &quot;$PLUGINSDIR\ioSpecial.ini&quot; &quot;Field 9&quot; &quot;HWND&quot;<br />
GetDlgItem $0 $HWNDPARENT 1208<br />
;SetCtlColors &quot;$0&quot; &quot;000000&quot; Transparent<br />
<br />
; Reload window<br />
    !insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;ioSpecial.ini&quot;<br />
    Pop $0 ;HWND<br />
    GetDlgItem $0 $HWNDPARENT 1         <br />
    SetCtlColors $0 &quot;FFFFFF&quot; Transparent <br />
   <br />
    ShowWindow $0 ${SW_HIDE}<br />
    ShowWindow $0 ${SW_SHOW}<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bubu</div><div class="date">27th February 2008, 08:29</div></div><div class="posttext">here is a print screen of what i was talking above.<br />
and now instead of:<br />
GetDlgItem $0 $HWNDPARENT 1 i put 1202 and it appears an install button, instead of a close one. geesh<br />
how can i make it to be the finish button, not the install one?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>