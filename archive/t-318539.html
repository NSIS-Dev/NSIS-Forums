<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" execwait doesn't with .msi/.exe combo, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  execwait doesn't with .msi/.exe combo NSIS Discussion" />
	
	<title> execwait doesn't with .msi/.exe combo [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  execwait doesn't with .msi/.exe combo</div>
<hr />
<div class="pda"><a href="t-318539.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318539">execwait doesn't with .msi/.exe combo</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dandan78</div><div class="date">20th April 2010, 14:24</div></div><div class="posttext">; Install App<br />
  ExecWait &quot;$INSTDIR\setup.exe&quot;<br />
  ; Install Sql Server Express Edition 2005<br />
  ExecWait &quot;$INSTDIR\install_sql_server.cmd&quot;<br />
  ; Setup and restore database<br />
  ExecWait &quot;$INSTDIR\import_db.cmd&quot;<br />
  ; setup database user<br />
  ExecWait &quot;$INSTDIR\adduser.cmd&quot;<br />
  ; Create ODBC DSN<br />
<br />
<br />
Hi, setup.exe is part of a .msi/.exe combination created by a Visual Studio setup project. <br />
<br />
If you run the .msi, it works fine UNLESS the prerequisites are missing. Hence it's better to go with the .exe. The .exe checks for the prerequisites, in this case version 3.5SP1 of the .NET Framework and Crystal Reports Basic, and downloads and installs them if needed.<br />
<br />
One would expect that running setup.exe with ExecWait would do the checks, get and install anything that's missing, and then install the application (.msi). However, what happens is that the .msi part of the package and the following ExecWait which installs SQL Sever 2005 Express launch at the same time. <br />
<br />
Does anybody know a way to prevent that from happening?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">20th April 2010, 14:52</div></div><div class="posttext">This sounds a lot like some problems I've seen mentioned in here before. Have you tried searching the forums?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dandan78</div><div class="date">20th April 2010, 15:15</div></div><div class="posttext">Yes, but unforutnately I didn't find anything, which is not to say that I have given up searching.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">20th April 2010, 15:50</div></div><div class="posttext">This might be a thread on it...<br />
http://forums.winamp.com/showthread.php?t=254184<br />
<br />
The explanation is at least likely.. the installer probably launches another process itself, then exits - so your ExecWait waits just fine.. but the thing it's waiting for exits rapidly :)<br />
<br />
If the potential solution in that thread doesn't help (and I'm guessing it wouldn't.. start /wait probably suffers from the same issue), you'll have to check how you can stop the initial installer from exiting immediately.<br />
<br />
Alternatively - but only if you're desperate, look for the actual installing process and halt execution of your code until that process is gone.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dandan78</div><div class="date">20th April 2010, 16:09</div></div><div class="posttext">Yes, that it exactly what it does. Setup.exe eventually launches msiexec and exits. As you said, start /wait doesn't help. :( <br />
<br />
For the last hour and a half I've been trying to dig up a way to prevent setup from exiting immediately but so far without luck. InstallShield would be doable, but this isn't InstallShield. Oh well...<br />
<br />
I'm getting to the point where no other option remaisn other than doing some low-level Win API stuff, possible wrapping the whole thing in an extra application to make it easier.<br />
<br />
Thanks, all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">20th April 2010, 17:51</div></div><div class="posttext">http://unattended.sourceforge.net/installers.php if you can identify the installer, or if all else fails: http://nsis.sourceforge.net/ExecWait_and_waiting_for_child_processes_with_Job_Objects</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dandan78</div><div class="date">21st April 2010, 09:43</div></div><div class="posttext">@Anders<br />
<br />
Oddly, the Visual Studio setup.exe + .msi combination is not listed on the web page you gave me. The InstallShield variant is, tho, but the solution is not applicable. <br />
<br />
So all else did fail, but lucky for me the macro works like a charm. :) <br />
<br />
Thanks again.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>