<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Use section index in .nsh header file?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Use section index in .nsh header file? NSIS Discussion" />
	
	<title> Use section index in .nsh header file? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Use section index in .nsh header file?</div>
<hr />
<div class="pda"><a href="t-333992.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=333992">Use section index in .nsh header file?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Harner</div><div class="date">24th August 2011, 13:34</div></div><div class="posttext">As the question says: I´m trying to use the section index in a .nsh file which configures pages and includes custom pages. I´m trying to do so with the function SectionSetInstTypes.<br />
<br />
When I try to get the INST Type with SectionGetInstTypes it´s not working the output is always 7.<br />
<br />
This is my code in the header file for the inst type:<br />
<br />
SectionSetInstTypes ${Section2} 1 <br />
SectionGetInstTypes ${Section2} $R4 <br />
messagebox mb_ok &quot;$R4&quot;<br />
<br />
Is there no or any possibility to get the index in the .nsh files?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Harner</div><div class="date">25th August 2011, 10:10</div></div><div class="posttext">So far it seems i can´t use the index because the include is called before the section is declared. But what now? how can I change the InstType while runtime. I´ve got a checkbox on a custom page and depending on this box this section will or will not be installed. (Additonal to the InstType)<br />
<br />
Any suggestions?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">25th August 2011, 13:26</div></div><div class="posttext">Include the nsh later, or put the section manipulation into a function that is defined after the sections.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Harner</div><div class="date">25th August 2011, 15:33</div></div><div class="posttext">I´m totally stuck!<br />
If I include the header, function whatever after the section where I wanna change the selection that means the installation already happens and it has no effect!?<br />
<br />
If I wanna change the InstType of a section while runtime then I need to do that in the leave function of the custom page...circle of death :mad:<br />
<br />
I don´t know how to solve this problem I tried to define a variable which represents the InstType in my header...works so far but only with one InstType because the defines are called even if they are in a normal if. So the first if will overwrite the second one. And I can´t figure out how to set !ifdef and !ifndef in the code. :igor:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">25th August 2011, 16:37</div></div><div class="posttext">I'm not seeing what it is you're trying to do, what nsh you are including. <br />
<br />
I think you want to create custom pages, and with checkboxes or radio buttons or whatever, let the user choose some options. Those options would then control (enable / disable) Sections that do the actual installation and configuration to meet the user needs.<br />
<br />
Here's an outline of the order your nsi should have:<br />
use !define to create strings for registry keys, program name, etc so future updates are easier<br />
include the nsh headers at the top of the file.<br />
define the installer attributes (name, compressor, execution level, etc)<br />
reserve files (if using solid compression)<br />
define the pages (standard and custom)<br />
define/code the sections<br />
define the language strings (if you use MUI2) for section titles and subtitles<br />
code callback functions .onInit, etc<br />
code page functions (pre/show/leave)<br />
code functions called from the sections<br />
<br />
The nsis compiler is just one pass. Except for functions you call, nearly everything must have been compiled before you can write code that references it. Putting functions after all the sections allows the section ids to be defined, and should allow you to set or reset them even though at runtime the page leave code that has called the function was higher in the script than the sections.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Harner</div><div class="date">26th August 2011, 09:11</div></div><div class="posttext">Solved...<br />
<br />
My problem was that my function in my nsh file could not find the section index. This nsh includes every configuration for the pages and custom pages.<br />
<br />
I solved the problem with a not very nice solution as I think. I included the leave function from my nsh file after the sections in my main file. Problem solved because the function recognized the section index. But it´s not very good for any maintenance!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>