<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS for VS.Net 05 and 03, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS for VS.Net 05 and 03 NSIS Discussion" />
	
	<title> NSIS for VS.Net 05 and 03 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS for VS.Net 05 and 03</div>
<hr />
<div class="pda"><a href="t-291420.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291420">NSIS for VS.Net 05 and 03</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">DocNard</div><div class="date">7th May 2008, 16:38</div></div><div class="posttext">I am currently using .nsi files to build an executable, which contains an .exe and some dlls. (header)<br />
<br />
; NULLsoft Scriptable Install System<br />
; make a single file to run <br />
; software.  Goal is to copy files to<br />
; the temp directory, run them, then<br />
; clean up completely afterward.<br />
<br />
When i us the script for vs03, the .exe created executes perfectly. However, with vs05, the .exe created SUCKS!! The files are unpacked, but immediatley removed from the $Temp.<br />
<br />
How do i use this with vs05.<br />
<br />
Script in .nsi----<br />
<br />
; NULLsoft Scriptable Install System<br />
; make a single file to run <br />
; software.  Goal is to copy files to<br />
; the temp directory, run them, then<br />
; clean up completely afterward.<br />
<br />
; use LZMA Solid compression<br />
SetCompressor /solid lzma<br />
<br />
; name of the installer (doesn't matter/never seen)<br />
Name &quot;AQS&quot;<br />
<br />
; hide nsis windows<br />
SilentInstall silent<br />
<br />
; set icon file<br />
Icon &quot;P:\AQS Projects\@QS Packages\AQS_auto.ico&quot;<br />
<br />
; set a name for the resulting executable<br />
OutFile &quot;WinFrameTest.exe&quot;<br />
<br />
; the installation directory<br />
InstallDir &quot;$TEMP\WinFrameTest&quot;<br />
<br />
; copy, run, delete<br />
Section &quot;&quot;<br />
<br />
  ; set output path to the installation directory.<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
<br />
  ; files to unpack<br />
  File &quot;winTestbasic.exe&quot; ; executable<br />
  File &quot;IsummonYou.dll&quot; ; required dll<br />
  File &quot;IsummonMe.dll&quot; ; required dll<br />
<br />
  ; execute and wait for program to be closed<br />
  ExecWait '&quot;$INSTDIR\WinFrameTest.exe&quot;'<br />
<br />
  ; change output path so we can delete folder and not just contents<br />
  SetOutPath &quot;$TEMP&quot;<br />
<br />
  ; Delete unpacked files from hard drive<br />
  RMDir /r &quot;$INSTDIR&quot;<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">7th May 2008, 21:42</div></div><div class="posttext">What do you mean by &quot;Use the script for vs03&quot;.  Do you mean the exe's and dll's were recompiled with VS05?  If so, there may be additional dependencies such as DLLs or .NET 2.0 that are not on the machine your are installing on.<br />
<br />
To troubleshoot and find the cause I would first comment out the RMDir command so that the installer will leave the files, and then after you install the files will be left where they are and you can then manually execute the *.exe from it's location in the temp dir to see why it might be failing.  (I would add a DetailPrint statement in the section that prints out the OUTDIR so you know which temp file location to look in.<br />
<br />
I suspect that this is happening:<br />
1) ExecWait runs your exe<br />
2) your EXE is throwing an exception or failing in some way<br />
3) NSI script execution then continues to the RMDir command and deletes the files.<br />
<br />
This would cause it to appear that your EXE is not running and the files being deleted immediately.<br />
<br />
You could also clear errors before ExecWait and then check for errors afterwards.<br />
<br />
Good luck.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>