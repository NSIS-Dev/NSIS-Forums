<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Detect/Modify Regional Settings Date format, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Detect/Modify Regional Settings Date format NSIS Discussion" />
	
	<title> Detect/Modify Regional Settings Date format [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Detect/Modify Regional Settings Date format</div>
<hr />
<div class="pda"><a href="t-261051.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=261051">Detect/Modify Regional Settings Date format</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">4th December 2006, 11:21</div></div><div class="posttext">Hello Friends,<br />
<br />
I want to detect and modify Regional Settings Date format through my NSIS Installer.<br />
<br />
Currently I'm doing it manually:<br />
Control Panel &gt; Regional and Language Options &gt; Customize Regional Options &gt;Short date format: M/d/yyyy<br />
<br />
I hope there must be some function/routine to do it through NSIS?<br />
<br />
With regards,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">4th December 2006, 17:44</div></div><div class="posttext">There is an option ofcourse with NSIS always ;)<br />
<br />
But be aware what you want to set, <br />
<br />
e.g. current logged in user, all users, also default settings of new users created after installer has run etc. etc.<br />
<br />
Define it clearly for yourself first, then look at what is possible with NSIS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">5th December 2006, 05:19</div></div><div class="posttext">Dear Onad,<br />
<br />
Thanks for the response. I think I've mentioned my issue clearly. Well here it is once again:<br />
<br />
As you know we can change the date format of the system from Control Panel &gt; Regional and Language Options &gt; Customize Regional Options &gt;Short date format: M/d/yyyy<br />
<br />
I want to detect &amp; change this format from my NSIS installer, and avoid asking the user or the the person who is installing the software to first check the regional setting's date format and if it is something different then set it to 'M/d/yyyy' and then only proceed with the installation of MSDE and my application.<br />
<br />
With regards,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">5th December 2006, 09:35</div></div><div class="posttext">Hi Swapan!<br />
<br />
Have a look at the Technet. I think you'll find these information there:<br />
<br />
http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/regentry/34667.mspx<br />
http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/regentry/34650.mspx<br />
<br />
Cheers<br />
<br />
Bruno</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">18th December 2006, 07:51</div></div><div class="posttext">Hi Everybody,<br />
Thanks a lot Bruno for your those links. I'm sorry that I couldn't revert back with the solution in time to this thread. Well its better to be late then never.<br />
<br />
With the help from Bruno, I've solved my issue. The following code may be helpful for those who are still green horns. The tested code:<br />
<br />
; reading &amp; modifying Regional Setting for Date format:<br />
   ReadRegStr $R0 HKCU \<br />
   &quot;Control Panel\International&quot; sShortDate<br />
<br />
   MessageBox MB_ICONEXCLAMATION|MB_OK &quot;Your Current Date format in Regional Setting: $R0&quot;<br />
   ${If} $R0 == &quot;M/d/yyyy&quot;<br />
     MessageBox MB_ICONEXCLAMATION|MB_OK &quot;Regional Setting's Date format OK&quot;<br />
   ${Else}<br />
     MessageBox MB_ICONEXCLAMATION|MB_OK &quot;Regional Setting's Date format NOT OK&quot;<br />
     WriteRegStr HKCU \<br />
     &quot;Control Panel\International&quot; &quot;sShortDate&quot; &quot;M/d/yyyy&quot;<br />
   ${EndIf}</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>