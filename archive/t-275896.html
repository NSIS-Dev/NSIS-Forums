<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Annoying popup dialogs, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Annoying popup dialogs NSIS Discussion" />
	
	<title> Annoying popup dialogs [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Annoying popup dialogs</div>
<hr />
<div class="pda"><a href="t-275896.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=275896">Annoying popup dialogs</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pgg1</div><div class="date">14th August 2007, 15:43</div></div><div class="posttext">Hi<br />
<br />
I need to install the following:<br />
<br />
Microsoft Visual C++ 2005 SP1 Redistributable Package (x86)<br />
<br />
Microsoft's brief description is:<br />
<br />
The Microsoft Visual C++ 2005 SP1 Redistributable Package (x86) installs runtime components of Visual C++ Libraries required to run applications developed with Visual C++ on a computer that does not have Visual C++ 2005 installed.<br />
<br />
I have no problems installing the executable but get annoying dialogs popping up whilst it's doing it's stuff despite executing it with /Q for quiet.<br />
<br />
Is there a way to prevent these dialogs from appearing.<br />
<br />
Cheers, <br />
<br />
Paul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">14th August 2007, 15:52</div></div><div class="posttext">http://blogs.msdn.com/astebner/archive/2007/02/07/update-regarding-silent-install-of-the-vc-8-0-runtime-vcredist-packages.aspx and http://unattended.sourceforge.net/installers.php might be able to help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">14th August 2007, 18:59</div></div><div class="posttext">The visual c redistributable package is like an onion, the installer have several layers wrapped around the core installer. The layers don't pass along the quiet switch that you want, so I solved it by extracting the central installer (msi and cab file) before building my installer and calling that from my installer:DetailPrint &quot;Extract: VCRedist_x86.exe&quot;<br />
SetDetailsPrint none<br />
SetOutPath $PLUGINSDIR<br />
File &quot;WindowsInstaller-KB893803-v2-x86.exe&quot;<br />
File &quot;VCRedist.msi&quot;<br />
File &quot;VCRedis1.cab&quot;<br />
<br />
SetDetailsPrint both<br />
DetailPrint &quot;Execute: WindowsInstaller-KB893803-v2-x86.exe&quot;<br />
SetDetailsPrint none<br />
ExecWait '&quot;$PLUGINSDIR\WindowsInstaller-KB893803-v2-x86.exe&quot;  /quiet /norestart'<br />
<br />
SetDetailsPrint both<br />
DetailPrint &quot;Execute: VCRedist_x86.exe&quot;<br />
SetDetailsPrint none<br />
ExecWait '&quot;$SYSDIR\msiexec.exe&quot; /i $PLUGINSDIR\VCRedist.msi /qn /norestart'<br />
<br />
I also include the Windows Installer (3.0) because our systems are using Windows 2000 Professional and Windows Installer was only at version 2. The VCRedistributable package requires Windows Installer 3.0<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pgg1</div><div class="date">14th August 2007, 21:08</div></div><div class="posttext">Hi<br />
<br />
Thanks for your quick reply. <br />
<br />
I have extracted vcredist_x86.exe to get VCREDI~3.EXE and then extracted that to get vcredist.msi &amp; vcredis1.cab.<br />
<br />
I downloaded WindowsInstaller-KB893803-v2-x86.exe<br />
<br />
So now we have the following files:<br />
<br />
(1) vcredist_x86.exe<br />
(2) VCREDI~3.EXE (I suppose it's OK to delete this?)<br />
(3) vcredist.msi<br />
(4) vcredis1.cab<br />
(5) WindowsInstaller-KB893803-v2-x86.exe<br />
<br />
<br />
I've followed everything you have said but do not understand where the msiexec.exe comes from in your code.<br />
<br />
Cheers,<br />
<br />
Paul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">14th August 2007, 22:05</div></div><div class="posttext">msiexec.exe is in the Windows system32 folder (the $SYSDIR variable will point there). It is the exe that knows how to process msi files.<br />
<br />
Yes, you can get rid of the VCREDI~3 file. The vcredist_x86.exe is not needed either. I display to the user that it is being installed when we really install only the msi and cab files.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pgg1</div><div class="date">15th August 2007, 10:05</div></div><div class="posttext">Hi<br />
<br />
Thanks for the explanation. <br />
<br />
I've got it working now, the only problem is towards the end of the install I get the Windows Installer Window appear. I've attached it so you know what I'm talking about.<br />
<br />
Any ideas how to get rid of that as well?<br />
<br />
Cheers,<br />
<br />
Paul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pgg1</div><div class="date">15th August 2007, 10:20</div></div><div class="posttext">I just found out that executing the vcredist_x86.exe with the following parameters from the command line replicates my problem. <br />
 <br />
<br />
vcredist_x86.exe /q:a /c:&quot;msiexec /i vcredist.msi /qn /l*v %temp%\vcredist_x86.log&quot;<br />
<br />
That is, the Windows Installer window appears.<br />
<br />
Cheers,<br />
<br />
Paul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">15th August 2007, 16:46</div></div><div class="posttext">Your screen shot is missing so I don't know exactly what the message about Windows Installer said. If it says &quot;Error 1723. There is a problem with this Windows Installer package...&quot; then Windows Installer needs the upgrade (to 3.0) which is why I install it before running the msi to install the VC redistributables. My installs run without any popup messages at all.<br />
<br />
Are you still running the vcredist_x86.exe and also running the msiexec to install the msi file? that would be attempting to install the same files twice (which shouldn't hurt, but is a waste of time and space in the installer).<br />
<br />
I executed the command you showed in your post on a fresh Win2k SP4 system and don't get any popups, but the files are not installed. Which OS are you installing on?<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pgg1</div><div class="date">15th August 2007, 17:22</div></div><div class="posttext">Sorry I definitely attached it, I think that maybe it was too big, so I've made it smaller this time.<br />
<br />
There is no error, the Windows Installer installs correctly and can be seen in Control Panel -&gt; Add/Remove Programs. In addition, the VCRedist_x86.exe (AKA msi file)  is installed correctly because  it can also be seen there.<br />
<br />
<br />
  DetailPrint &quot;Executing: WindowsInstaller-KB893803-v2-x86.exe&quot;<br />
  SetDetailsPrint none<br />
  ExecWait '&quot;$INSTDIR\bin\VC_Redist\WindowsInstaller-KB893803-v2-x86.exe&quot;  /quiet /norestart'<br />
  <br />
  DetailPrint &quot;Execute: VCRedist_x86.exe&quot;<br />
  SetDetailsPrint none<br />
  ExecWait '&quot;$SYSDIR\msiexec.exe&quot; /i $INSTDIR\bin\VC_Redist\vcredist.msi /qn /norestart'<br />
 <br />
<br />
You can see from my code that I'm not running vcredist_x86.exe twice. The OS is XP. I also tested my installer on a clean Windows XP virtual machine and I have the same problem.<br />
<br />
Cheers,<br />
<br />
Paul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">15th August 2007, 17:40</div></div><div class="posttext">That looks like the help screen that appears because Windows Installer got an unknown switch. I don't see any errors in your command line though.<br />
<br />
Run it again and when that window appears, look at it with Process Explorer (http://www.microsoft.com/technet/sysinternals/ProcessesAndThreads/ProcessExplorer.mspx) to verify the command line passed to it. That should show you what switch it doesn't like.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pgg1</div><div class="date">15th August 2007, 17:57</div></div><div class="posttext">OK, I'll download that and give it a go. What do you mean by a  &quot;unknown switch&quot;.<br />
<br />
Cheers,<br />
<br />
Paul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">15th August 2007, 19:07</div></div><div class="posttext">The help window is showing the parameters (switches) that it understands. If you give it something that's not on the list, it pops up that help info.<br />
<br />
ExecWait &quot;$SYSDIR\msiexec.exe /i vcredist.msi /foo&quot;<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pgg1</div><div class="date">15th August 2007, 20:52</div></div><div class="posttext">That's a nice program man, thanks for that.<br />
<br />
I have taken the following from Process Explorer.<br />
<br />
----------------------------<br />
WindowsInstaller-KB893803-v2-x86.exe<br />
----------------------------<br />
tab selected= Image<br />
<br />
Command line=&quot;C:\Documents and Settings\Paul\Desktop\ApplicationName\bin\VC_Redist\WindowsInstaller-KB893803-v2-x86.exe&quot;  /quiet /norestart<br />
Path=C:\Documents and Settings\Paul\Desktop\ApplicationName\bin\VC_Redist\WindowsInstaller-KB893803-v2-x86.exe<br />
Current directory=C:\Documents and Settings\Paul\Desktop\ApplicationName\<br />
Version=3.01.0000.0000<br />
Parent=ApplicationName_v1.0.exe(3592)<br />
<br />
----------------------------<br />
msiexec.exe<br />
----------------------------<br />
tab selected=Image<br />
<br />
Command line=&quot;C:\WINDOWS\system32\msiexec.exe&quot; /i C:\Documents and Settings\Paul\Desktop\ApplicationName\bin\VC_Redist\vcredist.msi /qn /norestart<br />
Path=C:\WINDOWS\system32\msiexec.exe<br />
Current directory=C:\Documents and Settings\Paul\Desktop\ApplicationName\<br />
Version=3.01.4000.1823<br />
Parent=AplicationName_v1.0.exe(1280)<br />
<br />
Looks good to me, Any ideas?<br />
<br />
Cheers,<br />
<br />
Paul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">15th August 2007, 21:01</div></div><div class="posttext">The argument to the /i switch in the msiexec.exe command line needs quotes because &quot;Documents and Settings&quot; contains spaces.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pgg1</div><div class="date">16th August 2007, 09:18</div></div><div class="posttext">I can't believe after all that it was a quotes issue.<br />
Thanks for your help on this matter, it works as expected.<br />
<br />
Cheers,<br />
<br />
Paul</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>