<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" update/uninstall if already installed, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  update/uninstall if already installed NSIS Discussion" />
	
	<title> update/uninstall if already installed [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  update/uninstall if already installed</div>
<hr />
<div class="pda"><a href="t-334524.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=334524">update/uninstall if already installed</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">stopasking</div><div class="date">8th September 2011, 13:20</div></div><div class="posttext">Hello, <br />
<br />
Sandboxie has an NSIS installation, and if it is already installed, it suggests to update or unintsall the program:<br />
http://i.imgur.com/R1bqa.png<br />
<br />
How do I do that in my installer?<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">8th September 2011, 13:53</div></div><div class="posttext">Nothing in NSIS is automatic, so you'll have to create this functionality yourself. Use nsDialogs to create a custom page containing a dirrequest element. Set an onChange function for it, use that to check whether the app already exists in the supplied path and change the page's contents accordingly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stopasking</div><div class="date">8th September 2011, 16:21</div></div><div class="posttext">Is there maybe some simpler solution for an update option?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stopasking</div><div class="date">8th September 2011, 20:07</div></div><div class="posttext">OK, I found PageReinstall in makensis.nsi...<br />
I think it should be integrated</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sr164w</div><div class="date">15th November 2011, 05:50</div></div><div class="posttext">Hi,<br />
<br />
I have NSIS generated installer.<br />
<br />
Now i need to modify this as update intsaller.<br />
what i am following is uninstall the old version and reinstall the new version.<br />
<br />
uninstall :<br />
uninstaller has few Delete RebookOK files even though those files got deleted by the uninstaller still it asks for the roboot ( i want overcome this unnecessary reboot.)<br />
ExecWait '&quot;$UnInstallString&quot; /S _?=$INSTDIR'   ; calling uninstaller<br />
<br />
INSTDIR is different in each releases like CompanyName/ProductName/2.0 is the first installation and CompanyName/ProductName/2.1 is the second installation.<br />
<br />
While installing new version INSTDIR will be different. <br />
<br />
If I install 2.0.1.1  and When I call ExecWait '&quot;$UnInstallString&quot; /S _?=$INSTDIR' it delets the complete 2.0 directory and reinstall 2.0.1.1 <br />
<br />
but when I install 2.1 (already installed is 2.0....) and When I call ExecWait '&quot;$UnInstallString&quot; /S _?=$INSTDIR' it is not deleting the complete 2.0 directory instead it installs 2.1... in the separate folder CompanyName/ProductName/2.1.<br />
But if i go to the installed directory and click on uninstall.exe of corresponding versions like 2.0 or 2.1 it uninstalls properly by deleting all its files and folders.<br />
<br />
Help is highly appreciated :)<br />
<br />
Please advice me on this !!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">15th November 2011, 10:31</div></div><div class="posttext">_?= tells the uninstaller what $instdir should be INSIDE the uninstaller, so normally you pass the same path as the location of uninstaller.exe. Example: ExecWait '&quot;c:\myapp v1.2\uninstaller.exe&quot; /S _?=c:\myapp v1.2'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sr164w</div><div class="date">5th December 2011, 07:00</div></div><div class="posttext">my problem is uninstaller path and installation path are different.<br />
how to tackle this situation? In this case ExecWait installation is not waiting for the uninstallation .<br />
<br />
my case : <br />
ExecWait '&quot;c:\myapp\v1.2\uninstaller.exe&quot; /S _?=c:\myapp\v1.3'</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>