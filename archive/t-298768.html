<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Create an ODBC Entry for Oracle DB, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Create an ODBC Entry for Oracle DB NSIS Discussion" />
	
	<title> Create an ODBC Entry for Oracle DB [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Create an ODBC Entry for Oracle DB</div>
<hr />
<div class="pda"><a href="t-298768.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=298768">Create an ODBC Entry for Oracle DB</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">friny</div><div class="date">16th October 2008, 12:18</div></div><div class="posttext">Hi everyone, I'm newest using the Nsis, and I have a trouble when I try to compile my Nsis source. I'm using the publicated script that could Create an ODBC Entry using Oracle Database.<br />
<br />
This is the Script:<br />
<br />
Function CreateOracleODBCEntry<br />
  Exch $R2          ; Server Name<br />
  Exch<br />
  Exch $R3          ; Name of the ODBC Entry<br />
<br />
  ; Save Registers R0,R1<br />
  Push $R0<br />
  Push $R1<br />
  Push $R4<br />
<br />
  ; Try to find an Oracle home directory<br />
  Call OracleDefaultHome<br />
  Pop $R0<br />
  StrCmp $R0 &quot;&quot; FindAnyValidOracleHome CheckForODBCDriverExistence<br />
<br />
  ; Find any valid home, if there is no valid default home<br />
  FindAnyValidOracleHome:<br />
    Call ValidOracleHome<br />
    Pop $R0<br />
    StrCmp $R0 &quot;&quot; NoOracleHomeFound CheckForODBCDriverExistence<br />
<br />
  ; Check whether the ODBC entry already exists<br />
  CheckForODBCDriverExistence:<br />
    Push $R3<br />
    Call ODBCEntryExists<br />
    Pop $R1<br />
    StrCmp $R1 &quot;TRUE&quot; YaExiste<br />
<br />
    Goto Continuar<br />
<br />
    YaExiste:<br />
    MessageBox MB_YESNO &quot;El origen de datos $R3 ya existe Â¿Desea sobrescribir la configuraciÃ³n?&quot; IDNO NoSobrescribe<br />
    DeleteRegKey HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot;<br />
    Goto Continuar<br />
<br />
    Continuar:<br />
<br />
    ; Get the path of the Oracle home<br />
    Push $R0<br />
    Call OracleHomePath<br />
    Pop $R4<br />
<br />
    ; Create the registry keys<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;Driver&quot; &quot;$R4\bin\sqora32.dll&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;Translation DLL&quot; &quot;&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;Translation Option&quot; &quot;0&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;Attributes&quot; &quot;W&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;FetchBufferSize&quot; &quot;64000&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;NumericSetting&quot; &quot;NLS&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;ForceWCHAR&quot; &quot;F&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;FailoverDelay&quot; &quot;10&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;FailoverRetryCount&quot; &quot;10&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;MetadataIdDefault&quot; &quot;F&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;Longs&quot; &quot;F&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;CloseCursor&quot; &quot;F&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;EXECSchemaOpt&quot; &quot;&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;EXECSyntax&quot; &quot;F&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;Application Attributes&quot; &quot;T&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;SQLGetData extensions&quot; &quot;F&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;ResultSets&quot; &quot;T&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;QueryTimeout&quot; &quot;T&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;Failover&quot; &quot;T&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;Lobs&quot; &quot;T&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;DisableMTS&quot; &quot;F&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;BatchAutocommitMode&quot; &quot;IfAllSuccessful&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;Description&quot; &quot;$R7&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;ServerName&quot; &quot;$R2&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;Password&quot; &quot;&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;UserID&quot; &quot;$R6&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;DSN&quot; &quot;$R3&quot;<br />
    WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\ODBC Data Sources&quot; &quot;$R3&quot; &quot;$R5 $R0&quot;<br />
    StrCpy $R2 &quot;TRUE&quot;<br />
    Goto Done<br />
<br />
  ODBCEntryAlreadyExists:<br />
    StrCpy $R2 &quot;FALSE&quot;<br />
    Goto Done<br />
<br />
  NoOracleHomeFound:<br />
    StrCpy $R2 &quot;FALSE&quot;<br />
<br />
  Done:<br />
<br />
  ; Restore R0-R4<br />
  Pop $R4<br />
  Pop $R1<br />
  Pop $R0<br />
  Pop $R3<br />
  Exch $R2<br />
<br />
FunctionEnd<br />
<br />
<br />
<br />
The point is when I try to compile this source the system shows me the next error:<br />
<br />
!include: error in script Line 301<br />
<br />
the line 301 contains:<br />
WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\ODBC\ODBC.INI\$R3&quot; &quot;FailoverDelay&quot; &quot;10&quot;<br />
<br />
Please Help me I don't know how to solve it<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">friny</div><div class="date">17th October 2008, 03:07</div></div><div class="posttext">Hi, This plugin solve the trouble: http://nsis.sourceforge.net/Registry_plug-in<br />
<br />
Regards</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>