<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Bad Net Start Return Code?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Bad Net Start Return Code? NSIS Discussion" />
	
	<title> Bad Net Start Return Code? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Bad Net Start Return Code?</div>
<hr />
<div class="pda"><a href="t-297078.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=297078">Bad Net Start Return Code?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Andrew Wallo</div><div class="date">8th September 2008, 18:33</div></div><div class="posttext">nsExec::Exec /TIMEOUT=700 &quot;NET START sdfweflwiejflsdkfjsliefj&quot; SH_HIDE<br />
        pop $0<br />
        MessageBox MB_OK &quot;Trying to start :sdfweflwiejflsdkfjsliefj RESULT:$0&quot;<br />
<br />
<br />
Returning 2.. no matter what the test is a valid service or not..... Clearly this is not right.  Any ideas?<br />
<br />
<br />
This exists in my code...<br />
<br />
        ${Switch} $0<br />
            ${Case} &quot;0&quot;  <br />
                DetailPrint &quot; Service was started.&quot;<br />
                Goto EndServiceTest<br />
            ${Case} &quot;1&quot;<br />
                DetailPrint &quot; Service was not supported.&quot;<br />
                Goto EndServiceTest<br />
             ${Case} &quot;2&quot;<br />
                DetailPrint &quot; Service is running.&quot;<br />
                Goto EndServiceTest<br />
             ${Case} &quot;8&quot;<br />
                DetailPrint &quot; Unknown failure starting Service.&quot;<br />
                Goto EndServiceTest<br />
             ${Case} &quot;10&quot;<br />
                DetailPrint &quot; Installer has verified that Service is running.&quot;<br />
                Goto EndServiceTest<br />
          ${EndSwitch}<br />
        EndServiceTest:<br />
        <br />
; These are the NET START return codes.<br />
;        gs_service_status( 0) = &quot;Success&quot;<br />
;        gs_service_status( 1) = &quot;Not Supported&quot;<br />
;        gs_service_status( 2) = &quot;Access Denied&quot;<br />
;        gs_service_status( 3) = &quot;Dependent Services Running&quot;<br />
;        gs_service_status( 4) = &quot;Invalid Service Control&quot;<br />
;        gs_service_status( 5) = &quot;Service Cannot Accept Control&quot;<br />
;        gs_service_status( 6) = &quot;Service Not Active&quot;<br />
;        gs_service_status( 7) = &quot;Service Request Timeout&quot;<br />
;        gs_service_status( 8) = &quot;Unknown Failure&quot;<br />
;        gs_service_status( 9) = &quot;Path Not Found&quot;<br />
;        gs_service_status(10) = &quot;Service Already Running&quot;<br />
;        gs_service_status(11) = &quot;Service Database Locked&quot;<br />
;        gs_service_status(12) = &quot;Service Dependency Deleted&quot;<br />
;        gs_service_status(13) = &quot;Service Dependency Failure&quot;<br />
;        gs_service_status(14) = &quot;Service Disabled&quot;<br />
;        gs_service_status(15) = &quot;Service Logon Failure&quot;<br />
;        gs_service_status(16) = &quot;Service Marked For Deletion&quot;<br />
;        gs_service_status(17) = &quot;Service No Thread&quot;<br />
;        gs_service_status(18) = &quot;Status Circular Dependency&quot;<br />
;        gs_service_status(19) = &quot;Status Duplicate Name&quot;<br />
;        gs_service_status(20) = &quot;Status Invalid Name&quot;<br />
;        gs_service_status(21) = &quot;Status Invalid Parameter&quot;<br />
;        gs_service_status(22) = &quot;Status Invalid Service Account&quot;<br />
;        gs_service_status(23) = &quot;Status Service Exists&quot;<br />
;        gs_service_status(24) = &quot;Service Already Paused&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th September 2008, 21:45</div></div><div class="posttext">What's SH_HIDE doing there? nsExec doesn't parse that parameter. Shouldn't cause it to always return 2, but something else might and you should therefore include the offending code itself and not a paraphrase of it.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>