<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Execwait doesnt working in Windows 7, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Execwait doesnt working in Windows 7 NSIS Discussion" />
	
	<title> Execwait doesnt working in Windows 7 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Execwait doesnt working in Windows 7</div>
<hr />
<div class="pda"><a href="t-343089.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=343089">Execwait doesnt working in Windows 7</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">udaymahajan</div><div class="date">12th March 2012, 14:35</div></div><div class="posttext">Hi,<br />
I want to call an exe to execute using nsis.<br />
To execute the exe i have used code as follow<br />
<br />
SetOutPath $INSTDIR\SoundBite<br />
File Files\DotNetInstall.bat<br />
File Files\dotNetFx40_Full_x86_x64.exe<br />
Execwait '&quot;$INSTDIR\SoundBite\dotNetFx40_Full_x86_x64.exe&quot; /norestart'<br />
<br />
after compiling .nsi file it creates an exe file.<br />
But executing that .exe file it doesnt start the dotNetFx40_Full_x86_x64.exe (setup file)<br />
same its working in Windows XP but doesnt working in Windows 7.<br />
<br />
So please suggest me how can I execute the same in windows 7.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">12th March 2012, 14:51</div></div><div class="posttext">Your syntax looks correct. But does your installer use &quot;RequestExecutionLevel admin&quot; ???<br />
<br />
If not, then it's probably UAC which is causing the problem here! ExecWait is implemented via CreateProcess(), which will simply fail if the calling application is not elevated and tries to run an executable that needs elevation (which the .NET installer probably does!). Alternatively you may want to try ExecShell, which will not fail but trigger an UAC Dialog in that case. ExecShell doesn't support waiting though. Therefore I have implemented an ExecShell function with Wait-capability in my StdUtils plug-in. This will allow you to run an elevated process (e.g. the .NET installer) from a non-elevated NSIS installer and still wait for it. I use that in my Auto Updater tool, for example...<br />
<br />
See here:<br />
http://nsis.sourceforge.net/StdUtils_plug-in#ExecShellWait</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">12th March 2012, 15:21</div></div><div class="posttext">(Keep in mind that 'requestexecutionlevel admin' is NOT sufficient to get administrator access in your installer. You need to manually confirm admin access in .onInit using UserInfo plugin.)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>