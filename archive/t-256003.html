<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Desktop Icon with NSIS Zip2Exe, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Desktop Icon with NSIS Zip2Exe NSIS Discussion" />
	
	<title> Desktop Icon with NSIS Zip2Exe [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Desktop Icon with NSIS Zip2Exe</div>
<hr />
<div class="pda"><a href="t-256003.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=256003">Desktop Icon with NSIS Zip2Exe</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">SCB</div><div class="date">22nd September 2006, 21:48</div></div><div class="posttext">Please excuse my stupidity, but I can't seem to figure out how to create an Installer using the NSIS Zip2Exe option.<br />
<br />
I last used NSIS Verion 2.07 and don't recall that it was a problem, since I creted four 'Setup' files for four different free downloads from my web site.<br />
<br />
I downloaded and installed the latest version of NSIS and expected to do that for my latest free download package by just selecting the Zip2Exe option and filling in the blanks.<br />
<br />
I got a 'Installer' that works fine except for the placing an Icon shortcut on the deskstop. <br />
<br />
In my previous ones (using 2.07) that is an option for the user to check.<br />
<br />
I'm sure I've forgotten something (it's been over a year since I created those first four) and I'm 68, not a programmer and have a poor memory.<br />
<br />
Can some one help me out with this situation?<br />
<br />
Thanks,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd September 2006, 21:51</div></div><div class="posttext">zip2exe's purpose is not building installers, it's only converting zip files into semi-installers. SFX builder, if you wish. It doesn't create shortcuts. It's meant to extract the files in the zip and nothing more.<br />
<br />
If you had shortcuts, you must have used a real script and compiled that with makensis or makensisw. If you can't find the .nsi script, write a new one according to the documentation and the examples in the Examples folder.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SCB</div><div class="date">23rd September 2006, 01:47</div></div><div class="posttext">Thanks for taking the time to reply. <br />
<br />
I must have used a script someone (a programmer) sent to me since I do not know how to write one. It would have been a 'cut &amp; paste' operation, which I don't recall. I've already mentioned my memory. <br />
<br />
Prior to posting my 'problem' I tried looking at the files in the Examples folder (and previous posts) and didn't see anything that I recognized as one that would work, but then I really didn't know what one would look like even if I found it. :)<br />
<br />
Unlike Confucious, I remember more of what I've heard and seen and not very much of what I've done.<br />
<br />
Rock on,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd September 2006, 08:31</div></div><div class="posttext">You could try using one of the script wizards available (http://nsis.sourceforge.net/mediawiki/index.php?title=Special:Search&amp;ns0=1&amp;ns9=1&amp;ns11=1&amp;redirs=0&amp;searchx=1&amp;search=wizard&amp;limit=50&amp;offset=0). They'll create a script for you in no time using GUI alone.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SCB</div><div class="date">23rd September 2006, 17:48</div></div><div class="posttext">Thanks but that didn't work (for a number of reasons).<br />
<br />
Anyway, I 'found' a script that I could modify and use.<br />
<br />
It worked fine except for the section where one indicates the 'put icon on desktop' &lt;Section: &quot;Desktop Shortcut&quot;&gt;, which of course is the reason for this exercise. :)<br />
<br />
I have tried four or five different file names for the shortcut (pif) file and I always get this error message.<br />
<br />
Error in script &quot;C:\Program Files\SCBSteganography\SteganoScriptFile.nsi&quot; on line 46 -- aborting creation process<br />
<br />
Of course line 46 is -- File: &quot;Steganography.pif&quot; <br />
<br />
The &quot;Steganography.pif&quot; file is the Windows created shortcut for the program. It's in the folder with all the other files and it works as a shortcut.<br />
<br />
Suggestions?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd September 2006, 22:52</div></div><div class="posttext">The error itself is stated right above the line stating the error line. According to your post, the problem is that colon after File.<br />
<br />
But you shouldn't use File anyway for that. Use CreateShortcut.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SCB</div><div class="date">24th September 2006, 02:30</div></div><div class="posttext">The good news - I changed it to<br />
<br />
================================================<br />
; Optional section (can be disabled by the user)<br />
Section &quot;Desktop Shortcut&quot;<br />
<br />
  SetOutPath $DESKTOP<br />
<br />
  CreateShortcut &quot;Shortcut to Steganography.exe&quot; &quot;Steganography.exe&quot;<br />
===================================================<br />
<br />
and it compiled without an error.<br />
<br />
Bad news - it doesn't put the Icon on the desktop when it performs the install (set-up). It puts the shortcut file (Shortcut to Steganography.exe) into the directory with all the other files.<br />
<br />
The good news - that shortcut works when you click on it from inside the directory (using Explore).<br />
<br />
I think I'm getting close. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th September 2006, 08:42</div></div><div class="posttext">Use:CreateShortcut &quot;$DESKTOP\Shortcut to Steganography.lnk&quot; &quot;Steganography.exe&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SCB</div><div class="date">24th September 2006, 18:45</div></div><div class="posttext">Hate to be a pain, but I pasted that line into my script file, compiled it (sucessfully) and it not only does not put a shortcut on the desktop, now it is not even creating a shortcut.<br />
<br />
It does create a Setup, that when executed offers two options, the second of which is Desktop Shortcut, with a block on the left that is checked. That was the case with my previous script.<br />
<br />
Any other suggestions?<br />
<br />
Here is my entire script -<br />
<br />
=======================================================<br />
; The name of the installer<br />
Name &quot;SecretCodeBreaker&quot;<br />
<br />
; The file to write<br />
OutFile &quot;Setup.exe&quot;<br />
<br />
; The default installation directory<br />
InstallDir C:\SCBSteganography<br />
<br />
;--------------------------------<br />
<br />
; Pages<br />
<br />
Page components<br />
Page directory<br />
Page instfiles<br />
<br />
;--------------------------------<br />
<br />
; The stuff to install<br />
Section &quot;SecretCodeBreaker Files (required)&quot;<br />
<br />
  SectionIn RO<br />
  <br />
  ; Set output path to the installation directory.<br />
  SetOutPath $INSTDIR<br />
  <br />
  ; Put file there<br />
  File &quot;Steganography.exe&quot;<br />
  File &quot;Instructions.txt&quot;<br />
  File &quot;Theory_of_Operation.txt&quot;<br />
  File &quot;Example.txt&quot;<br />
  File &quot;Example.bmp&quot;<br />
  File &quot;Exampleb.bmp&quot;<br />
  File &quot;Bitmap1.bmp&quot;<br />
  File &quot;SecretCodeBreaker.bmp&quot;<br />
  File &quot;Steganography.ico&quot;<br />
  File &quot;readme.txt&quot;<br />
<br />
SectionEnd<br />
<br />
; Optional section (can be disabled by the user)<br />
Section &quot;Desktop Shortcut&quot;<br />
<br />
  SetOutPath $DESKTOP<br />
<br />
CreateShortcut &quot;$DESKTOP\Shortcut to Steganography.lnk&quot; &quot;Steganography.exe&quot;<br />
<br />
SectionEnd<br />
======================================================</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">24th September 2006, 18:57</div></div><div class="posttext">If exe file exists<br />
SetOutPath &quot;$DESKTOP&quot;<br />
CreateShortcut &quot;$DESKTOP\Shortcut to Steganography.lnk&quot; &quot;$INSTDIR\Steganography.exe&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SCB</div><div class="date">24th September 2006, 20:26</div></div><div class="posttext">Thank you very, very much for fixing my script so that it works!<br />
<br />
Works perfectly.<br />
<br />
If you are interested, as a token of my appreciation, I'll send you a URL that will give you a copy of the my first book in the Secret Code Breaker series (96 page PDF, plus a small zip of the program files).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>