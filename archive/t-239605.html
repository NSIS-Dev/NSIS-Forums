<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Remove Program Files ShortCut, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Remove Program Files ShortCut NSIS Discussion" />
	
	<title> Remove Program Files ShortCut [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Remove Program Files ShortCut</div>
<hr />
<div class="pda"><a href="t-239605.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=239605">Remove Program Files ShortCut</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">1st March 2006, 17:33</div></div><div class="posttext">I'm having problems removing my Program Files shortcut.  Here's the add, and then the remove (add in the install section and remove in the uninstall section):<br />
<br />
&lt;!--Add Routine--&gt;<br />
  ; put the app in the program files menu<br />
  CreateDirectory &quot;$SMPROGRAMS\myApp&quot;			;Put a folder in the program files menu<br />
  CreateShortCut &quot;$SMPROGRAMS\myApp\myApp.lnk&quot; &quot;$INSTDIR\myApp.exe&quot; &quot;$INSTDIR\myApp.ICO&quot;<br />
<br />
<br />
&lt;!--Remove Routine--&gt;<br />
  ;Delete from program files menu<br />
  Delete &quot;$SMPROGRAMS\myApp\myApp.lnk&quot;	;Remove shortcut<br />
  RMDIR &quot;$SMPROGRAMS\myApp&quot;			;Remove folder in the program files menu<br />
<br />
&lt;!--End Code Snippets--&gt;<br />
<br />
Also, my icon doesn't show up.  Is there a icon size restriction (mine is 48x48px)?<br />
<br />
Thanks Much!<br />
Eric</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">1st March 2006, 18:01</div></div><div class="posttext">During remove, are you using the right shell variable context?  <br />
<br />
Try using SetShellVarContext just before you delete.  (I'm not sure if you need to be in the user's start menu or the 'all users' start menu.  Whichever it is, you can set appropriately for what you need.)<br />
<br />
As far as the icon, are you talking about the install icon, uninstall icon, or both?  from the help files:<br />
<br />
...Note that if you use an uninstaller, each icon in the icon file must have the same size and color depth as its matching icon in the uninstaller icon file...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">1st March 2006, 18:07</div></div><div class="posttext">Thanks Comperio, I'll give that a shot.<br />
<br />
The icon I'm talking about is the icon for the shortcut.  If I use the icon for the shortcut on the desktop, it works fine, but not in the program files group.  It just ends up being an empty box looking thing.  I'm guessing the big icon (48x48) is too big for the menu.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">1st March 2006, 18:18</div></div><div class="posttext">hmm... Could be right.  That or you just need to refresh explorer.<br />
<br />
See if you can assign the same icon manually in explorer.  If that works, then it's probably the latter.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">1st March 2006, 18:19</div></div><div class="posttext">That seems to have been the trick Comperio, thanks!!!  One last question.<br />
<br />
In the doc for CreateShortcut, it just says &quot;some command line parameters&quot;.  I'm looking to set the &quot;Comment&quot; for the shortcut (this is displayed when the mouse is over the icon).  Any help?<br />
<br />
Thanks,<br />
Eric</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">1st March 2006, 18:35</div></div><div class="posttext">command line parameters are for command line switches on the EXE.  (not what you're looking for.)<br />
<br />
What you need is the 'description' parameter (last parameter).<br />
<br />
example:<br />
CreateShortCut &quot;shortcut.lnk&quot; &quot;C:\windows\notepad&quot; &quot;&quot; &quot;&quot; &quot;&quot; SW_SHOWNORMAL &quot;&quot; &quot;Comment here&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">1st March 2006, 19:02</div></div><div class="posttext">Thanks Comperio, All Good!!!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>