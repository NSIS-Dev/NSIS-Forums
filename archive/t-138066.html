<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Getting errors &quot;Can't open DLL for writing&quot;, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Getting errors &quot;Can't open DLL for writing&quot; NSIS Discussion" />
	
	<title> Getting errors &quot;Can't open DLL for writing&quot; [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Getting errors &quot;Can't open DLL for writing&quot;</div>
<hr />
<div class="pda"><a href="t-138066.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=138066">Getting errors &quot;Can't open DLL for writing&quot;</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">matthias_k</div><div class="date">6th June 2003, 11:00</div></div><div class="posttext">It seems that my installer tries to overwrite DLL's which are currently used by windows. I'm getting this error message during installation (at least from time to time):<br />
<br />
Error opening file for writing:<br />
             &quot;C:\WINDOWS\System32\xxx.DLL&quot;<br />
Hit abort to abort installation,<br />
retry to retry writing the file, or<br />
ignore to skip this file<br />
<br />
<br />
Well, my installer HAS TO overwrite these files, at least if they're out of date. Is there a way to get instant access to these files or unload them from memory if currently loaded? Otherwise my installer will continue doing error messages if the files are in use.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th June 2003, 11:10</div></div><div class="posttext">You should use the UpgradeDLL macro (http://nsis.sourceforge.net/Docs/AppendixB.html#B.11). It will make sure the DLL will only be copied over if the version on the user's system is older than what you're trying to install and, if the file in use, will replace the file after reboot.<br />
<br />
Unless this DLL is only used by one program (rare if it's in the System directory), this is your only way. If it is used by only one program you can ask the user to close it or close it down yourself.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">matthias_k</div><div class="date">6th June 2003, 12:05</div></div><div class="posttext">Cool, that is everything I need in one single instruction.<br />
<br />
Thanks.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>