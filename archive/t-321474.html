<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Custiomised Installer - please help, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Custiomised Installer - please help NSIS Discussion" />
	
	<title> Custiomised Installer - please help [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Custiomised Installer - please help</div>
<hr />
<div class="pda"><a href="t-321474.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=321474">Custiomised Installer - please help</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">captedgar</div><div class="date">7th August 2010, 15:33</div></div><div class="posttext">Hi <br />
I'm new to NSIS Installer scripts. I have about 100 odd servers on which i have to manually uninstall the older version of a software and install a new one.<br />
i have managed to write up the following code. Can u please guide me how i can achieve the steps underlined in red<br />
<br />
;Define Application name<br />
name 'New Software Install'<br />
<br />
;Define Installer name<br />
outFile &quot;\\&lt;Server 1&gt;\c$\Documents and Settings\VikasNarasimha\Desktop\Software-Install\Software-1.0.1.5-install.exe&quot;<br />
<br />
set environmental path like in DOS command, the following is the path<br />
set PATH=%SystemRoot%\Microsoft.NET\Framework\v2.0.50727;%PATH%<br />
<br />
Change Directory<br />
cd &quot;c:\PROGRAM FILES\Software-Install\Software1.0.1.4\&quot;<br />
<br />
Unregister a .dll associated to the older version in the above directory<br />
regasm /u /tlb Software4.dll<br />
<br />
; Uninstall section <br />
Section &quot;Uninstall&quot;<br />
Delete $INSTDIR\Software-1.0.1.4-install.exe ; should delete older version<br />
RMDir $INSTDIR<br />
SectionEnd <br />
<br />
; Install section <br />
Section &quot;Install&quot;<br />
InstallDir &quot;\\&lt;Server 2&gt;\c$\PROGRAM FILES\Software-Install\Software1.0.1.5\&quot;<br />
setOutPath $INSTDIR<br />
sectionEnd<br />
<br />
set environmental path like in DOS command, the following is the path<br />
set PATH=%SystemRoot%\Microsoft.NET\Framework\v2.0.50727;%PATH%<br />
<br />
Change Directory<br />
cd &quot;c:\PROGRAM FILES\Software-Install\Software1.0.1.5\&quot;<br />
<br />
Register a .dll associated to the newer version in the above directory<br />
regasm /u /tlb Software5.dll</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">7th August 2010, 21:23</div></div><div class="posttext">You can use the nsExec plugin, or some other exec plugins, to execute regasm. I'm not familiar with regasm specifically, but I'd expect you don't really need to set the working directory. Just add the path before the filename.<br />
<br />
As for setting an environment variable, that's been asked before. You can find the solution using the Search function.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>