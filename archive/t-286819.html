<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait &amp; rundll32, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait &amp; rundll32 NSIS Discussion" />
	
	<title> ExecWait &amp; rundll32 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait &amp; rundll32</div>
<hr />
<div class="pda"><a href="t-286819.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=286819">ExecWait &amp; rundll32</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">13th February 2008, 17:12</div></div><div class="posttext">i use ExecWait to launch a dll using rundll32.exe and the dialog that appears requires input from the user. however the installer will continue its work without waiting for the dialog to close. i know that rundll32.exe has finished its job and closed so is there any way to make the installer wait till the dialog box has closed?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">13th February 2008, 18:03</div></div><div class="posttext">Or rebuild to dll the close the dialog until the user &quot;ends it&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">13th February 2008, 18:43</div></div><div class="posttext">i cannot do that as i am only incharge of the installer........my code is something like this<br />
<br />
ExecWait &quot;rundll32.exe dll_name.dll,FunctionName&quot;<br />
<br />
now i need to make the installer wait for the relevant details from the dialog box....... rebuilding the dll is not an option and even if it was it would take some time</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">13th February 2008, 18:52</div></div><div class="posttext">I don't know much, is logic that if rundll.exe exits from the process before the dialog close, must be something wrong with the dll.<br />
A temp solution that I can give you, is to use sleep function.<br />
ExecWait finishes when rundll32 finishes, keep that in mind.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th February 2008, 11:08</div></div><div class="posttext">You can use the System plug-in to call that function instead of rundll32.exe. It should always wait for the function to return.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">14th February 2008, 17:21</div></div><div class="posttext">the problem is that the dll will return an inistalisation success message and cause the system plug in to close.... it is similar to the rundll32 problem i think. the guy who made the dll says it is vital to the program and that to help out he said that it resembles the following function call::<br />
<br />
rundll32.exe user32.dll,LockWorkStation<br />
<br />
i transalated it into the system plugin so i could get some idea of how it works but no luck. suggestions???<br />
<br />
System::Call 'user32.dll::LockWorkStation(i, *i, t) i(.r0, r1, .r2) .r3'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">14th February 2008, 17:25</div></div><div class="posttext">Originally posted by Joel <br />
must be something wrong with the dll. <br />
<br />
ah if only it were that simple........:(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th February 2008, 17:33</div></div><div class="posttext">In that case, there's nothing you can do. The DLL must change or you must find something else to wait for. Maybe you can wait for the window it opens to close.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">14th February 2008, 17:56</div></div><div class="posttext">maybe i can use ::<br />
FindWindow $0 '' 'Program Title'<br />
<br />
but what will be the windows class???</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th February 2008, 18:09</div></div><div class="posttext">You some sort of spy, like win32spy (http://www.gena01.com/win32spy/), to find that out. But be aware any solution like this could fail due to timing issues. The best solution would be to modify the DLL.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>