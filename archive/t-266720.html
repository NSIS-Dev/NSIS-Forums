<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" weird group/section behaviour + fixed bug, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  weird group/section behaviour + fixed bug NSIS Discussion" />
	
	<title> weird group/section behaviour + fixed bug [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  weird group/section behaviour + fixed bug</div>
<hr />
<div class="pda"><a href="t-266720.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=266720">weird group/section behaviour + fixed bug</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">alx5962</div><div class="date">27th February 2007, 14:18</div></div><div class="posttext">Hi,<br />
I'm creating an installer on NSIS (not my first one!) and I have a very strange problem: on the componement pageI select a group, then I push the back button and then I go back to the components page. And there all the sections under the group have moved to the group !<br />
Of course I checked if there was no mistakes or typos in the sections and groups but nothing... Is it a known bug ?<br />
I'm using the latest NSIS release BTW.<br />
Thanks<br />
<br />
Alex<br />
<br />
PS: another bug found but fixed : after I disabled a section in an .onMouseOverSection function, the post section is never executed... but no errors during install time... I fixed this by updating the section to read-only and everything is back to normal.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">27th February 2007, 16:40</div></div><div class="posttext">It would be good if you post a minimal example for both issues you're referring as for the 1st part of your post would be clear what you mean and for the 2nd what exactly you're doing in .onMouseOverSection (probably you confuse this callback with .onSelChange)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alx5962</div><div class="date">1st March 2007, 13:29</div></div><div class="posttext">ok I try to explain in a better way the problem:<br />
User chooses a directory in a custom page, if no path is selected one section of the component page is disabled. <br />
As the define of a section is created after the component page I cannot disable the section before the component page. So I chosen to test if I have to disable the section each time something happen on the component page. but section_off makes nsis buggy as I said earlier and only changing the section to read only works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">1st March 2007, 17:28</div></div><div class="posttext">Still you're not giving a minimal example that would help...<br />
Anyway, is it something like the following that you're trying to achieve?<br />
showinstdetails show<br />
outfile 'test.exe'<br />
Installdir &quot;$PROGRAMFILES\My Application&quot;<br />
<br />
var user_def<br />
<br />
!include sections.nsh<br />
<br />
page custom customcreate customleave<br />
page components<br />
page directory<br />
page instfiles<br />
<br />
<br />
sectiongroup /e &quot;Main Installation&quot; grp1<br />
<br />
section &quot;Application&quot; sec1<br />
sectionin ro<br />
setoutpath &quot;$INSTDIR&quot;<br />
detailprint &quot;installing application&quot;<br />
sleep 300<br />
sectionend<br />
<br />
section /o &quot;Documents&quot; sec2<br />
setoutpath &quot;$INSTDIR\Documents&quot;<br />
detailprint &quot;installing documents&quot;<br />
sleep 300<br />
sectionend<br />
<br />
section /o &quot;Examples&quot; sec3<br />
setoutpath &quot;$INSTDIR\Examples&quot;<br />
detailprint &quot;installing examples&quot;<br />
sleep 300<br />
sectionend<br />
<br />
sectiongroupend<br />
<br />
<br />
section &quot;User Defined&quot; usr1<br />
;SectionIn ro<br />
setoutpath &quot;$user_def&quot;<br />
detailprint &quot;installing user defined&quot;<br />
sleep 300<br />
sectionend<br />
<br />
function customleave<br />
ReadINIStr $user_def &quot;$PLUGINSDIR\custom.ini&quot; &quot;field 2&quot; &quot;state&quot;<br />
strcmp &quot;$user_def&quot; &quot;&quot; 0 end<br />
!insertmacro unselectsection ${usr1}<br />
SectionSetText ${usr1} &quot;&quot;<br />
end:<br />
functionend<br />
<br />
function customcreate<br />
InstallOptions::Dialog &quot;$PLUGINSDIR\custom.ini&quot;<br />
pop $0<br />
functionend<br />
<br />
function .onInit<br />
InitPluginsDir<br />
WriteIniStr &quot;$PLUGINSDIR\custom.ini&quot; &quot;settings&quot; &quot;numfields&quot; &quot;2&quot;<br />
<br />
WriteIniStr &quot;$PLUGINSDIR\custom.ini&quot; &quot;field 1&quot; &quot;type&quot; &quot;groupbox&quot;<br />
WriteIniStr &quot;$PLUGINSDIR\custom.ini&quot; &quot;field 1&quot; &quot;left&quot; &quot;0&quot;<br />
WriteIniStr &quot;$PLUGINSDIR\custom.ini&quot; &quot;field 1&quot; &quot;right&quot; &quot;-1&quot;<br />
WriteIniStr &quot;$PLUGINSDIR\custom.ini&quot; &quot;field 1&quot; &quot;top&quot; &quot;10&quot;<br />
WriteIniStr &quot;$PLUGINSDIR\custom.ini&quot; &quot;field 1&quot; &quot;bottom&quot; &quot;-11&quot;<br />
WriteIniStr &quot;$PLUGINSDIR\custom.ini&quot; &quot;field 1&quot; &quot;text&quot; &quot;Select User Defined Directory&quot;<br />
<br />
WriteIniStr &quot;$PLUGINSDIR\custom.ini&quot; &quot;field 2&quot; &quot;type&quot; &quot;dirrequest&quot;<br />
WriteIniStr &quot;$PLUGINSDIR\custom.ini&quot; &quot;field 2&quot; &quot;left&quot; &quot;10&quot;<br />
WriteIniStr &quot;$PLUGINSDIR\custom.ini&quot; &quot;field 2&quot; &quot;right&quot; &quot;-10&quot;<br />
WriteIniStr &quot;$PLUGINSDIR\custom.ini&quot; &quot;field 2&quot; &quot;top&quot; &quot;30&quot;<br />
WriteIniStr &quot;$PLUGINSDIR\custom.ini&quot; &quot;field 2&quot; &quot;bottom&quot; &quot;44&quot;<br />
functionend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alx5962</div><div class="date">2nd March 2007, 09:54</div></div><div class="posttext">ok here is some code (only a small part as the full source is 300+ lines). when i use SECTION_OFF instead of SF_RO the nsis installer doesn't execute the post section but no errors given<br />
<br />
* the ini:<br />
[Field 4]<br />
Type=DirRequest<br />
Left=30<br />
Top=111<br />
Right=220<br />
Bottom=124<br />
Text=MySQL dir<br />
Root=C:\Program Files<br />
Flags=PATH_MUST_EXIST<br />
<br />
* the nsi :<br />
<br />
Section /o &quot;Import SQL&quot; sect14<br />
    SectionIn 3<br />
    Call ImportSql<br />
SectionEnd<br />
<br />
... <br />
<br />
Function .onMouseOverSection<br />
    StrCmp $mySqlPath &quot;&quot; 0 +2 &lt;- $mySqlPath read from the ini previously<br />
    SectionSetFlags ${sect14} ${SECTION_OFF}<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">2nd March 2007, 12:45</div></div><div class="posttext">I feel I'm a bit confused here...<br />
StrCmp $mySqlPath should be done in custom page leave callback and according to that select/unselect the Import SQL section, even better hide it.<br />
.onMouseOverSection callback is for setting up sections description as far I know.<br />
The way I understand your installer is more/less like the sample I've posted above, and has no bugs.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alx5962</div><div class="date">2nd March 2007, 13:07</div></div><div class="posttext">Red Wine thank you for the explaination !<br />
My problem was I never saw the command &quot;!insertmacro unselectsection&quot; in the documentation so i tried to create something similar to this.<br />
It doesn't explain why the .post section is buggy with my code , but thanks to you my code is nicer!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">2nd March 2007, 18:44</div></div><div class="posttext">Allow me to add a few comments further,<br />
hard coding is not good idea, so Root=C:\Program Files might works as expected on your machine but you don't know if exists on others machines, therefore the accurate way should be Root=$PROGRAMFILES which you may write it to ini at runtime before the call to the InstallOptions plugin.<br />
Also, Flags=PATH_MUST_EXIST affects FileRequest controls, you don't need it in a DirRequest control.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alx5962</div><div class="date">5th March 2007, 09:20</div></div><div class="posttext">Red Wine thank you again for all your precious infos.<br />
The program files line in my code was just to debug in my case :) As I get the path value from the registry (using the code I posted in another topic).<br />
Anyway, your comments could be useful later.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>