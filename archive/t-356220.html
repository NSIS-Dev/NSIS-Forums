<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to tell if a Dll is Registered?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to tell if a Dll is Registered? NSIS Discussion" />
	
	<title> How to tell if a Dll is Registered? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to tell if a Dll is Registered?</div>
<hr />
<div class="pda"><a href="t-356220.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=356220">How to tell if a Dll is Registered?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">RossW</div><div class="date">23rd February 2013, 17:51</div></div><div class="posttext">I searched the forum but everything I found related to knowing about an installable Dll, and of course the &quot;!insertmacro InstallLib REGDLL&quot; handles that for you. In my case, the Dll in question is not part of my installer but I want to alert the user running my installer if the MS Windows Image Acquisition Library (wiaaut.dll) isn't registered on their system (seems like it's there ootb for Windows 7 but not for XP. For Windows Server 2008, the dll can be found in a subfolder but it's not registered).<br />
<br />
Is there an easy way to tell if a Dll is registered on a box? I know the GUID for the Dll's TypeLib entry in the registry (HKEY_CLASSES_ROOT\TypeLib\{94A0E92D-43C0-494E-AC29-FD45948A5221}) but is checking for that sufficient? I'd also like to know the install path which really depends on the OS (for XP, it's c:\windows\system32\wiaaut.dll) which might be under different subkeys depending on the OS (again, on XP it's there under 1.0 &gt; 0 &gt; win32).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">24th February 2013, 02:39</div></div><div class="posttext">Well, if we talk about &quot;registering&quot; a DLL, we actually talk about COM DLL's. Registering a COM &quot;in process&quot; server (COM DLL) does nothing but calling the DllRegisterServer entry point of the DLL. It's up to the developer of the COM DLL to create and export that function. It may do pretty much anything! It usually creates the registry entries needed to make the COM class provided by the DLL available to other applications, but it may do arbitrary other things.<br />
<br />
I guess the best way to check whether a &quot;COM DLL&quot; is &quot;registered&quot; would be checking whether the COM class provided by that DLL - and after all that's what you want to use, right? - is available or not. Just try to create an instance of that class via CoCreateInstance(), using the right CLSID. If that function fails with REGDB_E_CLASSNOTREG it means the class is not registered. And thus the COM DLL that is supposed to provide that class obviously has not been registered yet...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RossW</div><div class="date">27th February 2013, 16:26</div></div><div class="posttext">That sounds ideal, LoRd_MuldeR. I have the TypeLib GUID for the dll - how do I find the CLSID?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">27th February 2013, 20:37</div></div><div class="posttext">OleView?<br />
<br />
http://www.microsoft.com/en-us/download/details.aspx?id=17657</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>