<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Launching PRC after install? And Delete dll?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Launching PRC after install? And Delete dll? NSIS Discussion" />
	
	<title> Launching PRC after install? And Delete dll? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Launching PRC after install? And Delete dll?</div>
<hr />
<div class="pda"><a href="t-155390.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=155390">Launching PRC after install? And Delete dll?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">j27lee</div><div class="date">7th November 2003, 01:19</div></div><div class="posttext">After installation, I have the following:<br />
<br />
Function .onInstSuccess<br />
<br />
   SetPluginUnload manual<br />
   #free dll<br />
   System::Free 0<br />
<br />
   #remove dll<br />
   Delete &quot;$INSTDIR\dll\Verify.dll&quot;<br />
   RMDir /r &quot;$INSTDIR\dll&quot;<br />
   <br />
   MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 &quot;Would you like to install '$PRODUCT' to your palm device?&quot; IDYES run_prc<br />
   Abort<br />
  <br />
   run_prc:<br />
   Exec &quot;$INSTDIR\myapp.prc&quot;<br />
FunctionEnd<br />
<br />
2 questions:<br />
1)  The dll never gets deleted.  Am I using the SetPlugingUnload function properly?  <br />
<br />
2)  The Exec line doesn't do anything.  I would like it to bring up the palm quickinstall application with the prc in it.  Can the Exec function take parameters?<br />
<br />
Thanks,<br />
<br />
James</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">7th November 2003, 01:31</div></div><div class="posttext">To use parameters with a exec call use this layout:exec '&quot;$INSTDIR\command.exe&quot; parameters' <br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">j27lee</div><div class="date">7th November 2003, 01:57</div></div><div class="posttext">Thanks Vytautas, I had my quotes messed up and I was trying to escape them.<br />
<br />
Here's the code to get a Palm PRC to load in the quickinstall if anyone is interested:<br />
<br />
Function GetQuickInstallPath<br />
  SetOutPath &quot;$INSTDIR\dll&quot;<br />
  File bin\CondMgr.dll                  ; copy dll there<br />
  StrCpy $3 ${NSIS_MAX_STRLEN}          ; assign memory to $0<br />
  System::Call 'CondMgr::CmGetHotSyncExecPath(t .r2, *i r3) i .r1'<br />
  DetailPrint 'Path: &quot;$2&quot;'<br />
<br />
  ;fancy string dancing<br />
  StrCpy $3 &quot;$2&quot; -11<br />
  StrCpy $2 &quot;$3QuickInstall.exe&quot;<br />
FunctionEnd<br />
<br />
Function .onInstSuccess<br />
   Call GetQuickInstallPath<br />
  <br />
   SetPluginUnload manual<br />
   #free dll<br />
   System::Free 0<br />
<br />
   #remove dll<br />
   Delete &quot;$INSTDIR\dll\CondMgr.dll&quot;<br />
   RMDir /r &quot;$INSTDIR\dll&quot;<br />
   <br />
   MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 &quot;Would you like to install '$PRODUCT' to your palm device?&quot; IDYES run_prc<br />
   Abort<br />
  <br />
   run_prc:<br />
   Exec '&quot;$2&quot; &quot;$INSTDIR\myapp.prc&quot;'<br />
FunctionEnd<br />
<br />
Now how come my dll doesn't get deleted?<br />
<br />
james</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th November 2003, 07:45</div></div><div class="posttext">To be able to delete CondMgr.dll you should make System.dll unload it first. This can only be done in the latest CVS version using the 'u' option. For example:<br />
<br />
System::Call &quot;some::thing(i 2) i .r2 ?u&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">j27lee</div><div class="date">7th November 2003, 17:34</div></div><div class="posttext">Thanks kichik!  Is there some documentation on that yet?  I'd like to learn how it works a little better.  Does the '?u' make the commands:  'SetPluginUnload manual' and 'System::Free 0' obsolete?<br />
<br />
Thanks again</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th November 2003, 17:40</div></div><div class="posttext">There is System.txt and that's it for now.<br />
<br />
'?u' does not make 'SetPluginUnload manual' and 'System::Free 0' obselete because it relates to another DLL. '?u' unloads CondMgr.dll while the other two make sure System.dll is unloaded.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>