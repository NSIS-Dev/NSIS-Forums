<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" pathname of file without the filename itself, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  pathname of file without the filename itself NSIS Discussion" />
	
	<title> pathname of file without the filename itself [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  pathname of file without the filename itself</div>
<hr />
<div class="pda"><a href="t-95084.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=95084">pathname of file without the filename itself</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Richard Hureau</div><div class="date">19th July 2002, 20:36</div></div><div class="posttext">I am trying to determine if a file exists on a system, get the path of that file if it does exist, and then present that path as the installation directory (for user to change if they wish). I cannot find a way to get just the pathname of a file, without the filename itself.<br />
<br />
So far, I have this:<br />
Function .onInit<br />
; The default installation directory<br />
GetFullPathName $1 rcdigits.exe<br />
IfErrors 0 exists<br />
    StrCpy $INSTDIR $PROGRAMFILES\rcdigits<br />
    Goto dorest <br />
exists:<br />
StrCpy $INSTDIR $1<br />
dorest:<br />
FunctionEnd<br />
<br />
This works, but $1 contains say c:\ItIsHere\rcdigits.exe . I want to just get c:\ItIsHere<br />
<br />
Can someone help me? I have just started using NSIS, think it's dynamite!<br />
Rich</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">19th July 2002, 20:45</div></div><div class="posttext">Try using $EXEDIR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th July 2002, 21:48</div></div><div class="posttext">First of all, welcome to our community :D<br />
<br />
To get the directory in which a file is, use GetParent from your functions.html file in your NSIS directory.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Richard Hureau</div><div class="date">20th July 2002, 01:14</div></div><div class="posttext">Thanks for the tip! I'll give it a shot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Richard Hureau</div><div class="date">20th July 2002, 01:42</div></div><div class="posttext">I'm sorry, I was mistaken that the code in my question was working. It only works if the file I'm looking for is in the directory that I am running the install from.<br />
<br />
So, I guess I need to rephrase my question. How can I get the install program to search the system for a particular file (e.g. myprogram.exe) and return to me the full path of where it was found? <br />
<br />
The function you  mentioned will be great for isolating just the path, but I cannot now figure out how to do the search itself. I tried GetFullPathName and also SearchPath, but they do not seem to search outside the dir of the install program. FindFirst sounds perfect, but it does not return the path.<br />
<br />
I'm hoping that there is some function to do it, instead of having to code some recursive directory stepping thing myself (assuming such a thing is possible in NSIS).<br />
<br />
I used to distribute a freeware program via just a zip file, with no install routine. Users would just unzip it into any dir they wanted. Now I want to use NSIS to build an installation routine, but I would like it to find wherever the program was installed earlier, so i can present it to the user as the default for the new install using the install program. <br />
<br />
Sorry about the long-winded question. :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th July 2002, 09:48</div></div><div class="posttext">Sorry, the only way that I know of is by using a recursive function... SearchPath only searches the directories in the path.<br />
<br />
The best way to do this is get some value from the registry, but I doubt you have it if you used a zip file before.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Richard Hureau</div><div class="date">20th July 2002, 12:51</div></div><div class="posttext">Thanks for your help. It's probably not worth trying to code some search function. After the first running of the new install routine, I'll have the info stored in the registry, so everything will be cool after that.<br />
<br />
In truth, another reason I wanted to know if this were possible was that it seemed like a way to write an install that did not ever use the registry. Some people object to shareware/freeware making registry entries, and I thought I might be able to avoid it and still make it look more or less professional. It seems that even an uninstall might be possible, except that its name wouldn't show up on the Add/Remove list (you'd just have a shortcut to the uninstall on the Start submenu). But, I guess it's not doable without more trouble than it's worth.<br />
<br />
Thanks again!<br />
Rich</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">20th July 2002, 19:48</div></div><div class="posttext">How about writing an installer that creates an ini file in the user's windows directory or other location NSIS can find? You can later read this file for the installation location. During the first installation, you can let users browse to their existing program directory or just let them accept your default location.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Richard Hureau</div><div class="date">20th July 2002, 20:42</div></div><div class="posttext">Yes, that would work. But I also wanted to avoid writing anything in the user's system directory. I am already using a &quot;local&quot; ini file so the program remembers stuff each time, but it's in the installation dir. I guess I'm trying to be too &quot;benign.&quot; You hear a lot of screaming about shareware modifying the registry and placing stuff all over the system, but you also hear people complain if there isn't an Uninstall routine. So, you can't please everyone, I guess. Thanks for the suggestions :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Richard Hureau</div><div class="date">21st July 2002, 15:23</div></div><div class="posttext">Just thought I'd mention that I took your advice, Cchian, and set up an ini file in the Windows directory. It contains just the instdir info. I read this at startup of the install. This workes great and is pretty unintrusive. I even was able to set up an Uninstall, by setting up a shortcut to the uninstall on a subdir for my program under the Start-&gt;Programs menu. The only thing I lose by doing this is that my product does not show up on the Add/Remove list, since I made no registry entry for it. I like this OK, and it's nice that NSIS is flexible enough to allow such fine tuning!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>