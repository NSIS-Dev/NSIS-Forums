<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Is it possible to wrap 'that' in a function?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Is it possible to wrap 'that' in a function? NSIS Discussion" />
	
	<title> Is it possible to wrap 'that' in a function? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Is it possible to wrap 'that' in a function?</div>
<hr />
<div class="pda"><a href="t-344894.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=344894">Is it possible to wrap 'that' in a function?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">BreezeUADN</div><div class="date">15th May 2012, 13:27</div></div><div class="posttext">Good %time_of_day% to you gurus<br />
I've decided to made an UI part of our installer more configurable (thus a bit more visually appealing) today and as part of that effort did some crazy experiments with sections to achieve an effect of flexibility.In short - the product is updated frequently and is complex so  the sections part of a script is generated by an external program, besides there is a lot of variations of an installer so instead of making, say, 15 setup variations for each version released we decided to make sort of a &quot;license&quot; to exclude unnecessary &quot;modules&quot; from an installer.<br />
It works in a way: installer opens, usual stuff happens, then user prompted for a license file, which looks like<br />
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;<br />
&lt;license&gt;<br />
  &lt;module&gt;ModuleOne&lt;/module&gt;<br />
  &lt;module&gt;AnotherModule&lt;/module&gt;<br />
&lt;/license&gt;<br />
it is read and put in a list, then user sees a section tree (which is being configured by license now) and so on.<br />
<br />
The machine-generated sections part looks like (simplified example):<br />
<br />
var licSearchListInd ;index for iteration<br />
var licSearchModule ;module name from a license file<br />
Var licSectionIsFound ;indicates that the module was found in a section name<br />
Var currModule ;the module in question<br />
<br />
Section &quot;manyAsOne&quot; SECX<br />
    SetOutPath &quot;$INSTDIR\bin\&quot;<br />
<br />
    StrCpy $currModule &quot;ModuleOne&quot; ;one of the modules in question<br />
    ${For} $licSearchListInd 0 $licenseListCount ;traverse license list<br />
        ${List.Get} $licSearchModule licenseList $licSearchListInd<br />
        ;look if module name is contained inside of a section name<br />
        ${StrLoc} $licSectionIsFound $currModule $licSearchModule &quot;&lt;&quot; <br />
        ;returns position, can be 0 or more, empty string if not found<br />
        ${If} $licSectionIsFound != &quot;&quot;<br />
            File &quot;$%SOME_ROOT%\release\bin\SomeFile.dll&quot;<br />
        ${EndIf}<br />
    ${Next}<br />
<br />
    StrCpy $currModule &quot;AnotherModule&quot;<br />
    ${For} $licSearchListInd 0 $licenseListCount<br />
        ${List.Get} $licSearchModule licenseList $licSearchListInd<br />
        ${StrLoc} $licSectionIsFound $currModule $licSearchModule &quot;&lt;&quot;<br />
        ${If} $licSectionIsFound != &quot;&quot;<br />
            File &quot;$%SOME_ROOT%\release\bin\SomeClient.dll&quot;<br />
            File &quot;$%SOME_ROOT%\release\bin\SomeServer.dll&quot;<br />
        ${EndIf}<br />
    ${Next}<br />
<br />
    ;another 300 modules<br />
SectionEnd<br />
<br />
(I had an alternative earlier that made unnecessary modules unchecked, uncheckable and invisible but that produced a bad looking gray checkbox on a section group container, and irremovable &quot;+&quot; sign if all sections/modules of a section group were hidden. The solution above solves that)<br />
<br />
Uh, now, the question - is there a way to put that repeating part in a function somehow? The problem is with variable amount of instructions like File... I know it won't make any performance difference but I just want to make script look a bit less... messy :confused:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th May 2012, 22:55</div></div><div class="posttext">Look into macros to reduce repeated code.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>