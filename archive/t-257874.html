<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Use SearchPath for Environment Variable???, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Use SearchPath for Environment Variable??? NSIS Discussion" />
	
	<title> Use SearchPath for Environment Variable??? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Use SearchPath for Environment Variable???</div>
<hr />
<div class="pda"><a href="t-257874.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257874">Use SearchPath for Environment Variable???</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">19th October 2006, 11:29</div></div><div class="posttext">I use SearchPath to find path for environment variable. However, I have some problems<br />
My path in OS is C:\avalon-merlin-3.0-dist\merlin. I am worry because user may change this path during installing.<br />
My code here:<br />
<br />
Section &quot;AddEnvMERLIN_HOME&quot;<br />
  Push &quot;MERLIN_HOME&quot;<br />
  StrCmp $5 merlin.bat 0 +2<br />
      SearchPath $5 merlin.bat<br />
  StrCmp $5 &quot;&quot; 0 +2<br />
      MessageBox MB_OK &quot;Avalon Merlin is not installed in your computer&quot;    <br />
  Push &quot;C:\avalon-merlin-3.0-dist\merlin&quot;<br />
  Call WriteEnvStr<br />
SectionEnd<br />
<br />
I am afraid that if the path of software is this:<br />
&quot;C:\avalon-merlin-3.0-dist\merlin\bin&quot;<br />
but I need to set environment variable is <br />
&quot;C:\avalon-merlin-3.0-dist\merlin&quot;<br />
I still look for help file but I can find a command which can trim a string.<br />
And this code does not work,someone know why can help me!!<br />
Thank you,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th October 2006, 10:39</div></div><div class="posttext">Use GetParent (http://nsis.sourceforge.net/Docs/AppendixC.html#C.1).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">20th October 2006, 11:11</div></div><div class="posttext">Thank Kichik,<br />
When I do the way which you say, it inform &quot;Avalon Merlin is not installed&quot; although I install it in my computer,Can you tell me why???May I have some mistakes?<br />
<br />
Section &quot;AddEnvMERLIN_HOME&quot;<br />
Push &quot;MERLIN_HOME&quot;<br />
StrCmp $5 &quot;merlin.bat&quot; 0 +2<br />
SearchPath $5 &quot;merlin.bat&quot;<br />
StrCmp $5 &quot;&quot; 0 +2<br />
MessageBox MB_OK &quot;Avalon Merlin is not installed in your computer&quot;<br />
Push $5<br />
Call GetParent<br />
Pop $5<br />
Push $5<br />
Call WriteEnvStr<br />
SectionEnd<br />
<br />
I still have one question, if you can would you give me some advice.<br />
When I use GetParent I am worry about user can change default during installing<br />
They install in C or D,eg:<br />
C:\avalon merlin or D:\avalonmerlin<br />
Not in C:\Program files\avalonmerlin\....<br />
Can you help me!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th October 2006, 12:05</div></div><div class="posttext">I don't know why it wouldn't find merlin.bat after the change. Maybe the PATH isn't set right any more... Try reseting it.<br />
<br />
As for the user changing the path, there's nothing you can do about the user changing things. You can only hope that kind of user would know what he's doing.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>