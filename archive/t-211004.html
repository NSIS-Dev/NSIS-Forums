<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" $WINDIR in Windows 2003 Server, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  $WINDIR in Windows 2003 Server NSIS Discussion" />
	
	<title> $WINDIR in Windows 2003 Server [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  $WINDIR in Windows 2003 Server</div>
<hr />
<div class="pda"><a href="t-211004.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=211004">$WINDIR in Windows 2003 Server</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mnavarro</div><div class="date">21st March 2005, 10:15</div></div><div class="posttext">I am trying my installer in a Windows 2003 Server and I have noticed that the installer resolves $WINDIR to c:\documents and settings\myUser\WINDOWS instead of c:\WINDOWS. The windir environment variable is set to c:\WINDOWS.<br />
<br />
Have anybody else noticed this problem?<br />
<br />
I am using NSIS 2.06<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd March 2005, 20:31</div></div><div class="posttext">That's normal Windows 2003 and terminal services behavior. I don't remember the exact reason, but that's the way it works. There is probably some information about this in MSDN. If you want to get the system Windows directory, you can call GetSystemWindowsDirectory using the System plug-in:System::Call 'kernel32::GetSystemWindowsDirectory(t .r0, i ${NSIS_MAX_STRLEN})'<br />
DetailPrint &quot;Windows Directory: $0&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrtech</div><div class="date">23rd March 2005, 18:57</div></div><div class="posttext">&quot;On a system that is running Terminal Server, each user has a unique Windows directory. The system Windows directory is shared by all users, so it is the directory where an application should store initialization and help files that apply to all users.<br />
<br />
With Terminal Services, the GetSystemWindowsDirectory function retrieves the path of the system Windows directory, while the GetWindowsDirectory function retrieves the path of a Windows directory that is private for each user. On a single-user system, GetSystemWindowsDirectory is the same as GetWindowsDirectory.&quot;<br />
<br />
http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sysinfo/base/getsystemwindowsdirectory.asp</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">1st April 2005, 04:04</div></div><div class="posttext">thx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">a8os6i</div><div class="date">20th May 2005, 10:48</div></div><div class="posttext">Why doesn't the installer use the envionment variable %WINDIR% instead of GetWindowsDirectory()?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>