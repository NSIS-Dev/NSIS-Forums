<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" RegDLL &amp; Win 98, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  RegDLL &amp; Win 98 NSIS Discussion" />
	
	<title> RegDLL &amp; Win 98 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  RegDLL &amp; Win 98</div>
<hr />
<div class="pda"><a href="t-142525.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=142525">RegDLL &amp; Win 98</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">sandrakim90</div><div class="date">17th July 2003, 14:52</div></div><div class="posttext">I've created an install package to registrer an OCX file.  Works great on NT, 2000, XP but on Windows 98 (IE 5) when the function below is called, Windows pops-up the following message:<br />
<br />
MYAPPLICATION caused an invalid page fault in<br />
module MYAPPLICATION .OCX at 0177:00a5602d.<br />
Registers:<br />
EAX=00000000 CS=0177 EIP=00a5602d EFLGS=00010246<br />
EBX=00000104 SS=017f ESP=0099e390 EBP=0099e9b8<br />
ECX=00000000 DS=017f ESI=00aa32d8 FS=5acf<br />
EDX=0099e5a4 ES=017f EDI=00445b78 GS=0000<br />
Bytes at CS:EIP:<br />
66 83 20 00 59 59 89 45 fc 8d 85 f4 fd ff ff 53<br />
Stack dump:<br />
0099e5a4 0000002e 00000000 009b0000 00000000 00000000 00000000 00000000<br />
00000100 000004e4 00000000 0099e414 00a350ff 00000000 00000200 0099e87c<br />
<br />
<br />
This is the function I use to register the OCX:<br />
<br />
Function &quot;InstallOCX&quot;<br />
  start:<br />
  SetOverwrite try<br />
  ClearErrors<br />
<br />
  SetOutPath &quot;$INSTDIR\Bin&quot;<br />
  File &quot;C:\MyApplication.ocx&quot;<br />
  IfErrors inuse<br />
<br />
  RegDLL &quot;$INSTDIR\Bin\MyApplication.ocx&quot;<br />
  Return<br />
<br />
  inuse:<br />
    MessageBox MB_RETRYCANCEL|MB_ICONSTOP &quot;Unable to copy MyApplication.ocx.  This file might be in use.  Please close all applications using MyApplication and try again.&quot; IDRETRY start<br />
<br />
    MessageBox MB_OK|MB_ICONEXCLAMATION &quot;Sorry, there was a problem installing MyApplication.  Please reboot your computer and try again.&quot;<br />
    Quit<br />
FunctionEnd<br />
<br />
I have not had the opportunity to test on ME, 95 or other OS.  Has anyone had similar problems with RegDLL and non-NT based Windows.  Is there a way for me to trap errors like this.  Thanks, Sandy.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">17th July 2003, 14:55</div></div><div class="posttext">What kind of message do you get when you register the file using regsvr32?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sandrakim90</div><div class="date">23rd July 2003, 20:11</div></div><div class="posttext">I get the same error when using regsvr32.  I tried it on several computer and the same thing happens.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd July 2003, 20:16</div></div><div class="posttext">Maybe it doesn't built to work on Windows 98 or without a certain version of Internet Explorer. Once you find out what makes it crash you can use scripts in the Archive to find out what version of Window and Internet Explorer are used and abort if they don't match.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>