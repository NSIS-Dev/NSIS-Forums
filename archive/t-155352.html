<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" looping and installoptions, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  looping and installoptions NSIS Discussion" />
	
	<title> looping and installoptions [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  looping and installoptions</div>
<hr />
<div class="pda"><a href="t-155352.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=155352">looping and installoptions</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">frankiebonez</div><div class="date">6th November 2003, 17:10</div></div><div class="posttext">http://forums.winamp.com/showthread.php?postid=1034685#post1034685<br />
<br />
This thread details some looping using installoptions.  Unfortunately this person does not appear to be using the Modern UI, or at least is calling the InstallOptions DLL.<br />
<br />
I am using MUI and custom pages, and I'm having a problem looping.<br />
<br />
I have a text field which takes an email address in a custom page:<br />
<br />
<br />
Function SetCustomEnterEmail<br />
  !insertmacro MUI_HEADER_TEXT &quot;Email Validation&quot; \<br />
    &quot;Email validation is required to complete the installation.&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;emailpage.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $${EMAIL} &quot;emailpage.ini&quot; &quot;Field 1&quot; &quot;State&quot;<br />
<br />
<br />
However I then process the email address and use it to access a webpage (as you might have seen before in some of my posts).<br />
<br />
The processing part is working fine, however I'm not sure how to loop back when I process that the email is invalid.  I've tried doing it all inside the main section, but using &quot;Call SetCustomEmailPage&quot; results in very strange behavior.<br />
<br />
I've tried moving everything into the custom page function, and using calls to check the internet connection and the email, but then i run into a problem.<br />
<br />
Everything seems to work OK, but when you try to use the cancel button from the custom page I get the MUI_ABORTWARNING but then it goes and processes another function call and never exits.<br />
<br />
Has anyone had experience using MUI and InstallOptions and looping around conditionally?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">6th November 2003, 21:41</div></div><div class="posttext">If you update NSIS to the latest version you should use the new leave function of the custom pages to do the processing and then if the email address is invalid simply call abort to prevent the installer from displaying the next page.  It also removes the need to check for the return values from IO dll.<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">frankiebonez</div><div class="date">6th November 2003, 22:46</div></div><div class="posttext">I am using the latest version of NSIS (2.0b3?) but I didn't see anything in the docs about the custom page leave function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">6th November 2003, 23:18</div></div><div class="posttext">By latest version I meant NSIS 2.0b4 CVS.  It is actually more stable than 2.0b3, its only waiting for a few more translations before becoming a non CVS version.<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">frankiebonez</div><div class="date">6th November 2003, 23:33</div></div><div class="posttext">hm... is there a compiled version of it somewhere? :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th November 2003, 00:03</div></div><div class="posttext">Yes, in CVS...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">7th November 2003, 00:59</div></div><div class="posttext">You can also use the NSIS Update program with the third option to download the newest version.<br />
<br />
Vytautas</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>