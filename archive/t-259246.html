<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" CreateShortCut Compile Error when using User Variables, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  CreateShortCut Compile Error when using User Variables NSIS Discussion" />
	
	<title> CreateShortCut Compile Error when using User Variables [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  CreateShortCut Compile Error when using User Variables</div>
<hr />
<div class="pda"><a href="t-259246.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=259246">CreateShortCut Compile Error when using User Variables</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">nowvox</div><div class="date">10th November 2006, 01:42</div></div><div class="posttext">I'm having an issue when trying to create a short cut. I'm using this function (http://nsis.sourceforge.net/Get_first_part_and_rest_of_string) to split the contents of HKCR &quot;HTTP\DefaultIcon&quot;. The output is then being used in the CreateShortCut function. My code is below:<br />
<br />
<br />
ReadRegStr $0 HKCR &quot;HTTP\DefaultIcon&quot; &quot;&quot;<br />
Push &quot;,&quot;<br />
Push $0<br />
Call SplitFirstStrPart<br />
Pop $R0  ; Contains path to default browser<br />
Pop $R1  ; Contains icon index<br />
<br />
CreateShortCut &quot;$SMPROGRAMS\MyApp\My Link.lnk&quot; &quot;http://localhost/&quot; &quot;&quot; $R0 $R1<br />
<br />
<br />
Used in this way, NSIS throws an error when it gets to this line. However, if I take out $R1 and replace it with a number then the compile is successful. Ex.<br />
<br />
This works:<br />
<br />
CreateShortCut &quot;$SMPROGRAMS\MyApp\My Link.lnk&quot; &quot;http://localhost/&quot; &quot;&quot; $R0 1<br />
<br />
<br />
Just to check that $R1 does in fact contain the icon index I put the output in a message box and it was correct. I'm stumped on this one. I've tried everything I can think of. I'd just leave it hardcoded to 1 if I could but the icon index for IE is 0 and for FireFox it is 1. I don't know what it is for Opera, etc. and that's why I chose to use the DefaultIcon string from the registry.<br />
<br />
Any help with this would be extremely appreciated.<br />
<br />
Thanks,<br />
-Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">10th November 2006, 06:44</div></div><div class="posttext">Hi Chris!<br />
<br />
Due to the fact that you're about to create an internet shortcut I suggest creating an url-file. As far as I know the result of the shortcut-creation-process in the Windows Explorer is an url-file as well.<br />
<br />
Have a look:<br />
<br />
http://nsis.sourceforge.net/CreateInternetShortcut_macro_%26_function<br />
<br />
Have a nice day!<br />
<br />
Cheers<br />
<br />
Bruno</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nowvox</div><div class="date">13th November 2006, 19:20</div></div><div class="posttext">Thanks Bruno!<br />
<br />
Your suggestion worked. I still think this may be a bug in the compiler and I'll put some data together and post it in the bugs db on sourceforge.<br />
<br />
Thanks again,<br />
-Chris</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>