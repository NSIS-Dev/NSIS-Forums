<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Capture Folder Path from Browse Dialog, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Capture Folder Path from Browse Dialog NSIS Discussion" />
	
	<title> Capture Folder Path from Browse Dialog [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Capture Folder Path from Browse Dialog</div>
<hr />
<div class="pda"><a href="t-226475.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=226475">Capture Folder Path from Browse Dialog</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">rjb2005</div><div class="date">20th September 2005, 11:10</div></div><div class="posttext">Hi all,<br />
<br />
Hope you can help.<br />
<br />
I've created an NSIS script that (when compiled and executed) successfully installs and uninstalls application files and registry settings.<br />
<br />
The software I am packaging interfaces with a number of supporting files which may be stored in any location (local or network). Supporting files are manually extracted from a ZIP archive and DO NOT need to be installed as part of this package. I do however need to get the user to specify the location of these files (via directory browse) and append the path to the registry. <br />
<br />
At present, I am using code below to capture the folder location but this method has an undesireable quirk...When the user clicks next, the application title is appended to the selected location (e.g. user selects 'c:\required_files', which becomes 'c:\required_files\myapp').<br />
<br />
<br />
$MY_LOCATION<br />
PageEx directory<br />
  DirText &quot;Specify location of required files...&quot; &quot;Source&quot; &quot;Please spcefiy location of required files&quot; <br />
  DirVar $MY_LOCATION<br />
PageExEnd<br />
<br />
<br />
I have looked at creating a custom form with folder browser control but have struggled to get it working.<br />
<br />
If anyone has any suggestions or examples, I'd be grateful.<br />
<br />
<br />
Rob.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">20th September 2005, 12:54</div></div><div class="posttext">have a look at the installoptionsreadme:<br />
A &quot;DirRequest&quot; control displays a textbox and a browse button. Clicking the browse button will display a directory requester where the user can browse for a directory.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">20th September 2005, 13:04</div></div><div class="posttext">When the user clicks next, the application title is appended to the selected location (e.g. user selects 'c:\required_files', which becomes 'c:\required_files\myapp').The manual explains how to stop this from happening:<br />
<br />
http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.21</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rjb2005</div><div class="date">20th September 2005, 13:28</div></div><div class="posttext">I resolved this issue as pengyou suggested:<br />
<br />
By replacing... <br />
<br />
InstallDir &quot;$PROGRAMFILES\My Folder\MyApp&quot;<br />
<br />
...with...<br />
<br />
InstallDir &quot;$PROGRAMFILES\My Folder\MyApp\&quot;<br />
<br />
<br />
All that was needed was a trailing backslash.<br />
<br />
Many thanks for your help.<br />
<br />
Rob.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>