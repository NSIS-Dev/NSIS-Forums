<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" launch on start up, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  launch on start up NSIS Discussion" />
	
	<title> launch on start up [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  launch on start up</div>
<hr />
<div class="pda"><a href="t-143474.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=143474">launch on start up</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mikemanczur</div><div class="date">24th July 2003, 23:01</div></div><div class="posttext">I amusing the modern UI.  How do I add the application to launch at start up.  I can not find any examples with the modern UI.  Please help.  Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th July 2003, 23:23</div></div><div class="posttext">You mean Windows start up?<br />
Just place a shortcut to your EXE in the Startup folder in the Windows Start menu &gt; Programs &gt; Startup like so.<br />
<br />
Path to it would be:<br />
&quot;$SMPROGRAMS\Startup&quot;<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mikemanczur</div><div class="date">24th July 2003, 23:34</div></div><div class="posttext">What I want is (on Windows) when the user shuts down or restarts their machine, for the apoplication to start as well.  Can you give me the code and place I put it in?  I assume I have to put it in the unistaller as well. Here is my code.  Thank you.<br />
<br />
; -------------------------------<br />
; Start<br />
<br />
<br />
  !define MUI_PRODUCT &quot;Alarm Clock&quot;<br />
  !define MUI_FILE &quot;clock&quot;<br />
  !define MUI_VERSION &quot;1.0&quot;<br />
  !define MUI_BRANDINGTEXT &quot;Alarm Clock&quot;<br />
  CRCCheck On<br />
<br />
<br />
  !include &quot;${NSISDIR}\Contrib\Modern UI\System.nsh&quot;<br />
  <br />
  ;!define TEMP $R0<br />
<br />
<br />
;--------------------------------<br />
;General<br />
<br />
  OutFile &quot;Alarm.exe&quot;<br />
  ShowInstDetails &quot;nevershow&quot;<br />
  ShowUninstDetails &quot;nevershow&quot;<br />
  SetCompressor &quot;bzip2&quot;<br />
 <br />
  !define MUI_ICON &quot;pepper.ico&quot;<br />
  !define MUI_UNICON &quot;noPepper3.ico&quot;<br />
  !define MUI_SPECIALBITMAP &quot;alarm.bmp&quot;<br />
<br />
<br />
;--------------------------------<br />
;Folder selection page<br />
<br />
  InstallDir &quot;$PROGRAMFILES\${MUI_PRODUCT}&quot;<br />
<br />
<br />
;--------------------------------<br />
;Modern UI Configuration<br />
<br />
  ;!define MUI_CUSTOMPAGECOMMANDS<br />
  !define MUI_WELCOMEPAGE  <br />
  !define MUI_LICENSEPAGE<br />
  !define MUI_DIRECTORYPAGE<br />
  !define MUI_ABORTWARNING<br />
  !define MUI_UNINSTALLER<br />
  !define MUI_UNCONFIRMPAGE<br />
  !define MUI_FINISHPAGE<br />
  <br />
;--------------------------------<br />
;Pages<br />
  <br />
  ;!insertmacro MUI_PAGECOMMAND_WELCOME<br />
  ;Page custom IsFlashInstalled<br />
  ;!insertmacro MUI_PAGECOMMAND_LICENSE<br />
  ;!insertmacro MUI_PAGECOMMAND_DIRECTORY<br />
  ;!insertmacro MUI_PAGECOMMAND_INSTFILES<br />
<br />
;--------------------------------<br />
;Language<br />
<br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
;--------------------------------<br />
;Language Strings<br />
  <br />
  ;Header<br />
  ;LangString TEXT_IO_TITLE ${LANG_ENGLISH} &quot;InstallOptions Page&quot;<br />
  ;LangString TEXT_IO_SUBTITLE ${LANG_ENGLISH} &quot;Create your own dialog!&quot;<br />
<br />
  <br />
;--------------------------------<br />
;Data<br />
<br />
  LicenseData &quot;Readme.txt&quot;<br />
  <br />
;--------------------------------<br />
;Reserve Files<br />
  <br />
  ;Things that need to be extracted on first (keep these lines before any File command!)<br />
  ;Only useful for BZIP2 compression<br />
  <br />
  ;ReserveFile &quot;checkFlash.ini&quot;<br />
  ;!insertmacro MUI_RESERVEFILE_INSTALLOPTIONS<br />
<br />
;-------------------------------- <br />
;Installer Sections     <br />
Section &quot;install&quot; Installation info<br />
<br />
;Add files<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  <br />
  File &quot;${MUI_FILE}.exe&quot;<br />
  File &quot;Readme.txt&quot;<br />
<br />
;create desktop shortcut<br />
  CreateShortCut &quot;$DESKTOP\${MUI_PRODUCT}.lnk&quot; &quot;$INSTDIR\${MUI_FILE}.exe&quot; &quot;&quot;<br />
 <br />
;create start-menu items<br />
  CreateDirectory &quot;$SMPROGRAMS\${MUI_PRODUCT}&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\${MUI_PRODUCT}\Uninstall.lnk&quot; &quot;$INSTDIR\Uninstall.exe&quot; &quot;&quot; &quot;$INSTDIR\Uninstall.exe&quot; 0<br />
  CreateShortCut &quot;$SMPROGRAMS\${MUI_PRODUCT}\${MUI_PRODUCT}.lnk&quot; &quot;$INSTDIR\${MUI_FILE}.exe&quot; &quot;&quot; &quot;$INSTDIR\${MUI_FILE}.exe&quot; 0<br />
 <br />
;write uninstall information to the registry<br />
  WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${MUI_PRODUCT}&quot; &quot;DisplayName&quot; &quot;${MUI_PRODUCT} (remove only)&quot;<br />
  WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${MUI_PRODUCT}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\Uninstall.exe&quot;<br />
 <br />
  WriteUninstaller &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
SectionEnd<br />
<br />
<br />
;--------------------------------    <br />
;Uninstaller Section  <br />
Section &quot;Uninstall&quot;<br />
   <br />
;Delete Files <br />
  RMDir /r &quot;$INSTDIR\*.*&quot;    <br />
 <br />
;Remove the installation directory<br />
  RMDir &quot;$INSTDIR&quot;<br />
  <br />
;Delete Start Menu Shortcuts<br />
  Delete &quot;$DESKTOP\${MUI_PRODUCT}.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\${MUI_PRODUCT}\*.*&quot;<br />
  RmDir  &quot;$SMPROGRAMS\${MUI_PRODUCT}&quot;<br />
  <br />
;Delete Uninstaller And Unistall Registry Entries<br />
  DeleteRegKey HKEY_LOCAL_MACHINE &quot;SOFTWARE\${MUI_PRODUCT}&quot;<br />
  DeleteRegKey HKEY_LOCAL_MACHINE &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\${MUI_PRODUCT}&quot;  <br />
  <br />
SectionEnd<br />
<br />
<br />
;--------------------------------    <br />
;MessageBox Section<br />
<br />
<br />
;Function that calls a messagebox when installation finished correctly<br />
<br />
Function .onInstSuccess<br />
  MessageBox MB_OK &quot;You have successfully installed ${MUI_PRODUCT}. Use the desktop icon to start the program.&quot;<br />
FunctionEnd<br />
<br />
<br />
Function un.onUninstSuccess<br />
  MessageBox MB_OK &quot;You have successfully uninstalled ${MUI_PRODUCT}.&quot;<br />
FunctionEnd<br />
<br />
Function .onInstSuccess <br />
MessageBox MB_YESNO|MB_ICONQUESTION &quot;Installation has completed. Launch ${MUI_PRODUCT} now?&quot; IDNO NoLaunch <br />
ExecShell open &quot;$INSTDIR\${MUI_FILE}.exe&quot; <br />
NoLaunch: <br />
FunctionEnd<br />
<br />
<br />
<br />
;--------------------------------------<br />
;Other function section<br />
<br />
Function IsFlashInstalled<br />
  Push $R0<br />
  ClearErrors<br />
  ReadRegStr $R0 HKCR &quot;CLSID\{D27CDB6E-AE6D-11cf-96B8-444553540000}&quot; &quot;&quot;<br />
  IfErrors lbl_na<br />
    StrCpy $R0 1<br />
    MessageBox MB_OK &quot;Flash is installed.  Whoopie!&quot;<br />
  Goto lbl_end<br />
  lbl_na:<br />
    StrCpy $R0 0<br />
    MessageBox MB_OK &quot;Flash is not Installed.  Please visit macromedia.com and download the latest Flash plugin.&quot;<br />
    ;Quit<br />
  lbl_end:<br />
  Exch $R0<br />
FunctionEnd<br />
<br />
;eof</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">25th July 2003, 00:39</div></div><div class="posttext">Add this line after the desktop shortcut creationCreateShortCut &quot;$SMPROGRAMS\Startup\${MUI_PRODUCT}.lnk&quot; &quot;$INSTDIR\${MUI_FILE}.exe&quot; &quot;&quot;  And this line in the delete shortcuts area of the uninstaller Delete &quot;$SMPROGRAMS\Startup\${MUI_PRODUCT}.lnk&quot;  <br />
<br />
BTW In future could you attach long scripts rather than posting them.<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">25th July 2003, 00:53</div></div><div class="posttext">Please attach big script, please :) <br />
Second Startup folder is different in each Windows OS language.<br />
First find the folder in the registry:<br />
<br />
Function &quot;.onInit&quot;<br />
ReadRegStr $0 HKCU &quot;Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders&quot; &quot;Startup&quot;<br />
StrCmp $0 &quot;&quot; +1 +2<br />
ReadRegStr $0 HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders&quot; &quot;Startup&quot;<br />
Messagebox MB_OK $0<br />
Quit<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ramon18</div><div class="date">25th July 2003, 01:00</div></div><div class="posttext">Don't forget:<br />
<br />
<br />
SetShellVarContext current|all<br />
<br />
Sets the context of $SMPROGRAMS and other shell folders. If set to 'current' (the default), the current user's shell folders are used. If set to 'all', the 'all users' shell folder is used. The all users folder may not be supported on all OSes. If the all users folder is not found, the current user folder will be used. Please take into consideration that a &quot;normal user&quot; has no rights to write in the all users area. Only admins have full access rights to the all users area. You can check this by using the UserInfo Plugin. See Contrib\UserInfo\UserInfo.nsi for an example.<br />
<br />
<br />
Because permissions problems, you shouldn't allow non admins to install your software, btw, other installers like MS installer don't permit. :P<br />
<br />
good luck<br />
Ramon</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th July 2003, 11:01</div></div><div class="posttext">$SMSTARTUP is easier than reading the registry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">25th July 2003, 16:01</div></div><div class="posttext">Originally posted by kichik <br />
$SMSTARTUP is easier than reading the registry. <br />
<br />
You right :p. Forgot that :D</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>