<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Network distribution?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Network distribution? NSIS Discussion" />
	
	<title> Network distribution? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Network distribution?</div>
<hr />
<div class="pda"><a href="t-236902.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=236902">Network distribution?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">5of0</div><div class="date">1st February 2006, 06:18</div></div><div class="posttext">Is it possible to get NSIS to do a network installation - I've got an install working now, but I want it to install as it is, but on several computers in a network.  I've found a script that finds comptuers on a network, but that's only halfway.  Is there a way that I could dynamically create sections, or have a page that would allow the user to select the computers to distribute to?  Or is there a better (i.e. different app) that would do this easily?  I could try psuedo-hard-coding it (check if the computer name has the right prefix, then install the files if it does), but I would like it to be more flexible.  All the computers have the desired installation directory shared.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mr Inches</div><div class="date">1st February 2006, 12:54</div></div><div class="posttext">Yes, some network installs can be done, but how complex it is and whether it can actually be done, depends on what components you need to install.<br />
<br />
Here are some ideas:<br />
<br />
For selecting a computer to install, try building a list of the computer names separated by '|' characters and write this list as the value for a LISTBOX control on a custom InstallOptions page. Read the State value for that Field using a Leave function for the custom page and it will have the computer name in it.<br />
<br />
Installing files can be done using UNC paths for the destination directories. For example:<br />
<br />
StrCpy $INSTDIR &quot;\\$TargetComputer\C$\$ProgramFiles\App&quot;<br />
SetOutPath $INSTDIR<br />
File &quot;App.exe&quot;<br />
<br />
(Since you say you already have a share to the install path, just substitute it for the &quot;C$\$ProgramFiles\App&quot; bit and you get the same result).<br />
<br />
If you need to do registry changes, you can use one of the (ns)Exec commands to do REG commands on the remote computers, but they need to be running the Remote Registry Service for this to work properly (Windows 2000 and above have this on by default and previous versions don't have or need it - I think). For example:<br />
Exec &quot;REG ADD \\$TargetComputer\HKLM\Software\App /v InstallPath /t REG_SZ /d $INSTDIR&quot;<br />
<br />
Un-Installs across the network might be trickier but I imagine the same techniques could be applied e.g. select a computer to uninstall the application from, checking that it is installed before adding it in the list.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">5of0</div><div class="date">2nd February 2006, 00:41</div></div><div class="posttext">OK, looking around, that seems to suit my needs just fine.  I don't need a network uninstaller, I'll be just fine with an installer.  I'm working with Win2000 machines, so it sounds like the registry stuff should work.  Thanks for the help, I'll let you know how it turns out.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>