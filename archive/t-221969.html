<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Custom Page Help, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Custom Page Help NSIS Discussion" />
	
	<title> Custom Page Help [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Custom Page Help</div>
<hr />
<div class="pda"><a href="t-221969.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221969">Custom Page Help</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Venu</div><div class="date">20th July 2005, 13:11</div></div><div class="posttext">Hi all,<br />
<br />
I have one custom page to display the list of installed driver with version number. <br />
<br />
How can I define macro for this custom page, so that whenever I execute the setup.exe then depending on the availability of driver in the system I can display the proper message.<br />
<br />
As custom page has &quot;MUI_HEADER_TEXT&quot; macro, with this macro I am able to change the header text in runtime.<br />
<br />
How can I define same type of macro for displaying the message on the body of the custom page.<br />
<br />
Please suggest me.<br />
<br />
Venu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">20th July 2005, 14:06</div></div><div class="posttext">1. Read the InstallOptions documentation about how to create a custome page and add a Text or Static control on it.<br />
<br />
2. Read about IfFileExists and GetDllVersion to detect the driver and get its proper version.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Venu</div><div class="date">21st July 2005, 06:50</div></div><div class="posttext">Thanks for ur reply.<br />
<br />
I am able to create custom page and able to display it also and even able to get the installed driver version using GetDLLVersion. but my problem goes like this..<br />
<br />
As I have to first check for installed driver, if the prior installation of driver found, then on the Custom Page Header I want to disply the message as &quot;Prior Installation of driver 'A' found&quot; otherwise &quot;Prior Installation of driver 'B' found&quot;, and if there is no driver installed doesnot display the page.  All these things I am able to do because there is a MACRO &quot;MUI_HEADER_TEXT&quot; for custom page so<br />
<br />
code<br />
-----<br />
Function CustomPage<br />
 InstallOptions::initDialog /NOUNLOAD &quot;$PLUGINSDIR\test.ini&quot;<br />
 Pop $hwnd<br />
 IfFileExists &quot;$WINDIR\System32\Driver\driver1.sys&quot; 0 next<br />
  !insertmacro MUI_HEADER_TEXT &quot;Already Installed&quot; &quot;Prior Installation of Driver 1 Found&quot;<br />
   Goto Done<br />
  next:<br />
 IfFileExists &quot;$WINDIR\System32\Driver\driver2.sys&quot; 0 next<br />
  !insertmacro MUI_HEADER_TEXT &quot;Already Installed&quot; &quot;Prior Installation of Driver 2 Found&quot;<br />
 Done:<br />
   InstallOptions::show<br />
   Pop $0<br />
FunctionEnd<br />
---------<br />
<br />
Now on the same page, if prior installation exists, I want to display the version of the driver on the body of the custom page.  as there is no macro available for this I am writing into the .ini file as:<br />
<br />
----------------<br />
Function .onInit<br />
   Call GetDrvVersion ;this initializes the &quot;$VersionNumber&quot;<br />
   WriteINIStr &quot;$EXEDIR\CustomPage.ini&quot; 'Field 2' State '$VersionNumber'<br />
  <br />
   InitPluginsDir<br />
   File /oname=$PLUGINSDIR\test.ini &quot;CustomPage.ini&quot;<br />
FunctionEnd<br />
-----------------<br />
<br />
But the version number of the driver on the custom page only gets changed when I compile the script two times.  because in first compilation it updates the CustomPage.ini and in second Compilation and execution its updates the page.  <br />
<br />
So my question is can we have some macro like &quot;MUI_HEADER_TEXT&quot; to display text on the body of custome page, which actually doesnot need any compilation.<br />
<br />
Thanks &amp; Regards<br />
Venu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Venu</div><div class="date">21st July 2005, 10:39</div></div><div class="posttext">I want to represent my problem in another way.<br />
<br />
As I have custom page, and there is &quot;Label&quot; I have defined on the custom page.  My installer supports 6 different languages, I am able to change the Header of the custom Page according to languages choosen by user with &quot;MUI_HEADER_TEXT&quot; macro.<br />
<br />
But how to change the text of &quot;Label&quot; field.  I tried by modifying the .ini[custom page] file but it doesn't work out.  <br />
<br />
Can I define some macros for custom pages to display text on the body of the page, not as a header.<br />
<br />
Please help me, its badly needed for the project.<br />
<br />
Thanks and Regards<br />
Venu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st July 2005, 12:11</div></div><div class="posttext">Logically, this code will not work:<br />
<br />
Function .onInit<br />
Call GetDrvVersion ;this initializes the &quot;$VersionNumber&quot;<br />
WriteINIStr &quot;$EXEDIR\CustomPage.ini&quot; 'Field 2' State '$VersionNumber'<br />
<br />
InitPluginsDir<br />
File /oname=$PLUGINSDIR\test.ini &quot;CustomPage.ini&quot;<br />
FunctionEnd<br />
<br />
You are writing to &quot;$EXEDIR\CustomPage.ini&quot; before it exists and then overwriting it with another file being extracted!<br />
<br />
Should be:<br />
<br />
Function .onInit<br />
 InitPluginsDir<br />
  File /oname=$PLUGINSDIR\test.ini &quot;CustomPage.ini&quot;<br />
 Call GetDrvVersion ;this initializes the &quot;$VersionNumber&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\test.ini&quot; &quot;Field 2&quot; &quot;State&quot; &quot;$VersionNumber&quot;<br />
FunctionEnd<br />
<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>