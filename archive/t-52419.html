<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Exec Bug, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Exec Bug NSIS Discussion" />
	
	<title> Exec Bug [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Exec Bug</div>
<hr />
<div class="pda"><a href="t-52419.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=52419">Exec Bug</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">13th June 2001, 10:17</div></div><div class="posttext">Sorry if this is a bit hard to understand...<br />
<br />
SetOutPath $TEMP<br />
File SPLASH.EXE<br />
Exec SPLASH.EXE<br />
<br />
If SPLASH.EXE also exists in the same folder as the installer, that copy is run. If I change the line to:<br />
<br />
  Exec $TEMP\SPLASH.EXE<br />
<br />
The right copy runs, but it doesn't work the way it should.<br />
<br />
SPLASH.EXE waits for a file that NSIS will extract to the directory, but it's looking in the directory of the installer, because NSIS apparently hasn't set the working dir to $TEMP.<br />
<br />
The documentation says that $OUTDIR is the working directory for Exec and ExecWait, but for me it isn't. Am I doing something wrong?<br />
<br />
I know I can change SPLASH.EXE to look in the actual directory, but this looks like a bug. So I thought I'd point it out.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Edgewize</div><div class="date">13th June 2001, 12:05</div></div><div class="posttext">SetOutPath only seems to affect file extraction, not the actual working directory.<br />
<br />
I'll have to check if changing the working directory breaks anything before I fix this, so it might not make 1.44e.  But I'll try to include it...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">justin</div><div class="date">13th June 2001, 19:18</div></div><div class="posttext">the output path doesn't actually change the currenet directory of the installer .. but when you go to execute, it uses that path to set the current directory of the process that you execute.<br />
hence, you still need to do:<br />
<br />
Exec $TEMP\whatever.exe<br />
<br />
-Justin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Edgewize</div><div class="date">13th June 2001, 21:28</div></div><div class="posttext">Gotcha.  I forgot CreateProcess could even do that.  I use this in my headers :)<br />
#define ExecApp(path)  CreateProcess(0,path,0,0,0,0,0,0,0,0)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">14th June 2001, 12:08</div></div><div class="posttext">Okay...<br />
<br />
...so if I did<br />
<br />
SetOutPath $TEMP<br />
Exec C:\WINDOWS\NOTEPAD.EXE<br />
<br />
would the working dir for Notepad be $TEMP or C:\WINDOWS?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Edgewize</div><div class="date">14th June 2001, 18:10</div></div><div class="posttext">According to the source code for NSIS, the current dir should be $TEMP.<br />
<br />
If that doesn't seem to be the case, NOTEPAD could either be overriding the default output directory, or else the CreateProcess API call isn't working as documented or something.<br />
<br />
I'll do some experimentation with this one.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>