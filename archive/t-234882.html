<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" HKCU &amp; RunAs, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  HKCU &amp; RunAs NSIS Discussion" />
	
	<title> HKCU &amp; RunAs [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  HKCU &amp; RunAs</div>
<hr />
<div class="pda"><a href="t-234882.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=234882">HKCU &amp; RunAs</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">c567591</div><div class="date">6th January 2006, 17:55</div></div><div class="posttext">In my installer I am using HKCU to store user settings, however when installed with RunAs (Administrator) the HKCU settings go to Admin instead of the actual user logged in.<br />
Is there any way to push the registry settings to the logged in user?<br />
How do I determine the logged in user's name?<br />
<br />
In some corporate settings which are very restrictive the app must be installed this way to function, but all the HKCU entries end up in the wrong user's sub-tree.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">c567591</div><div class="date">9th January 2006, 14:27</div></div><div class="posttext">Anyone have any thoughts?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nicolas Cuny</div><div class="date">9th January 2006, 15:53</div></div><div class="posttext">Hi,<br />
<br />
HKEY_CURRENT_USER is actually a shortcut to HKEY_USERS\{id-of-the-current-user} so you should search a way to get the id of the user logged in.<br />
<br />
Hope this helps :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">c567591</div><div class="date">9th January 2006, 16:05</div></div><div class="posttext">I guess this is really a slightly different question: <br />
If using run-as as admin, how do I find out the user logged in is actually bob?  (or how to let NSIS know this)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">9th January 2006, 16:06</div></div><div class="posttext">Retrieving the users sid won't help you at all.<br />
<br />
You should make 2 scripts. The first installs the app. The second script is the starter script for the users. it checks if the neccessary reg key exists and create them if necceassary.<br />
<br />
This way the app will work for users who never worked with the machine and thus have no profile yet.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">c567591</div><div class="date">9th January 2006, 16:10</div></div><div class="posttext">Hmm...<br />
That seems to be a better idea.  :)<br />
Much simpler too.<br />
Thanks flizebogen!<br />
<br />
Why do I always seek the spoon when digging tunnels...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">c567591</div><div class="date">17th January 2006, 20:59</div></div><div class="posttext">We are going to have the installer make a .reg file and then the user can run the reg script once and then have all the settings.<br />
The paths need to have double backslashes \\ in order to import.<br />
I tried the INI writing functions in NSIS but none worked for this.<br />
What's the easiest way to get a string with double \\ from $INSTDIR ?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>