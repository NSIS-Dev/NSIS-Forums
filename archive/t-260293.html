<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Close current explorer if current folder is deleted, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Close current explorer if current folder is deleted NSIS Discussion" />
	
	<title> Close current explorer if current folder is deleted [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Close current explorer if current folder is deleted</div>
<hr />
<div class="pda"><a href="t-260293.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=260293">Close current explorer if current folder is deleted</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">zjckwht</div><div class="date">24th November 2006, 16:14</div></div><div class="posttext">How to achieve?<br />
<br />
When a folder is deleted by the installer, if meanwhile user is explorering the folder, he will receive something like &quot;xxx is missed..&quot;, how to automatically close the specified explorer window when installer deletes a folder to avoid getting such error?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">{_trueparuex^}</div><div class="date">24th November 2006, 16:34</div></div><div class="posttext">That's pretty trivial... :) You could try using the FindWindow  function to find the folder window and then close it with SendMessage.<br />
<br />
!include WinMessages.nsh<br />
FindWindow $0 &quot;CabinetWClass&quot; &quot;My folder name&quot;<br />
SendMessage $0 ${WM_SYSCOMMAND} 0xF060 0<br />
<br />
It's not berfect, but should do the trick and if my memory serves me well, the &quot;CabinetWClass&quot; class name doesn't apply to all windows versions...<br />
<br />
Edit: Yes my memory does great job. :) In some cases the class name is ExploreWClass. Also the SendMessage in my example didn't work.<br />
http://forums.winamp.com/showthread.php?postid=1993053</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vitoco</div><div class="date">24th November 2006, 17:30</div></div><div class="posttext">I don't know why, but most of the time, if I'm browsing the dir that will be removed (the uninstall.exe file is run by double-clicking it), the browser jumps automagically to the next dir in the tree. There is no explicit SendMessage in my script. May be because the directory tree is being displayed in the explorer window?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>