<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Issues related to Start menu shortcuts orders during installation, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Issues related to Start menu shortcuts orders during installation NSIS Discussion" />
	
	<title> Issues related to Start menu shortcuts orders during installation [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Issues related to Start menu shortcuts orders during installation</div>
<hr />
<div class="pda"><a href="t-231400.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=231400">Issues related to Start menu shortcuts orders during installation</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">19th November 2005, 10:09</div></div><div class="posttext">Purpose of my Installer is:<br />
 1) Create a folder by name PosPlus (default c:\PosPlus)<br />
 2) Create a sub-folder by name 'samples' in c:\posPlus<br />
    This 'samples' sub-folder contains a few application related text files.<br />
    These text files are also copied in this sub-folder.<br />
 3) Copy/extract pos.exe to c:\PosPlus<br />
 4) Copy/extract databack.exe to c:\PosPlus<br />
 5) Copy/extract uninst.exe to c:\PosPlus<br />
 6) Copy/extract PosPlus.chm to c:\PosPlus<br />
 7) Create desktop shortcut for main application:pos.exe<br />
 8) Create shortcut in Windows Start Menu-&gt;Program-&gt;<br />
    in following order:<br />
    Start Menu--&gt;Program--&gt;Pos Plus--&gt;Pos Plus<br />
                                   --&gt;Backup Manager<br />
                                   --&gt;Pos Manual<br />
				   --&gt;Samples<br />
				   --&gt;Uninstall	<br />
<br />
   My problem is that the installer is smoothly installing all the steps mentioned-above,<br />
   but the shortcuts in the start menu for Pos Plus are not comming as per my above order.<br />
   The 'Uninstall' shortcut is comming as the first option and the others are also not in<br />
   the same order as shown above.<br />
<br />
   One more thing I want to do is that I want to show my sub-folder Samples and its contents in<br />
   this start menu. For this I added this line my script :<br />
<br />
   CreateDirectory &quot;$SMPROGRAMS\PosPlus\Samples&quot;<br />
<br />
   This helped me in showing the folder &quot;Samples&quot;(empty). Yes it is showing 'empty' although<br />
   it contains many text files inside it.<br />
<br />
   What I want :<br />
      <br />
    Start Menu--&gt;Program--&gt;Pos Plus--&gt;Pos Plus<br />
                                   --&gt;Backup Manager<br />
                                   --&gt;Pos Manual<br />
				   --&gt;Samples----&gt;t1.txt(shortcut)<br />
					     ----&gt;t2.txt(shortcut)<br />
                                              ---&gt;....... and so on when the user clicks samples   <br />
                                                  and when he clicks t1.txt then that file opens<br />
                                                  up in notepad.<br />
				   --&gt;Uninstall	<br />
<br />
A fraction of script is given below to understand my issue:<br />
<br />
Section &quot;Complete&quot; SEC01<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  SetOverwrite ifnewer<br />
  File &quot;AppFolder\pos.exe&quot;<br />
  CreateDirectory &quot;$SMPROGRAMS\PosPlus&quot;<br />
  CreateDirectory &quot;$SMPROGRAMS\PosPlus\Samples&quot;<br />
 ;CreateShortCut &quot;$SMPROGRAMS\PosPlus\Samples&quot; &quot;$INSTDIR\Samples&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\PosPlus\Pos Plus .lnk&quot; &quot;$INSTDIR\pos.exe&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\PosPlus\Backup Manager.lnk&quot; &quot;$INSTDIR\databack.exe&quot;<br />
  CreateShortCut &quot;$DESKTOP\Pos Plus.lnk&quot; &quot;$INSTDIR\pos.exe&quot;<br />
  File &quot;AppFolder\databack.exe&quot;<br />
  File &quot;AppFolder\Format.txt&quot;<br />
  File &quot;AppFolder\PosPlus.chm&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\PosPlus\Pos Manual.lnk&quot; &quot;$INSTDIR\PosPlus.chm&quot;<br />
  SetOutPath &quot;$INSTDIR\Samples&quot;<br />
  SetOverwrite try<br />
  File &quot;AppFolder\Samples\T1.TXT&quot;<br />
  File &quot;AppFolder\Samples\T2.TXT&quot;<br />
  File &quot;AppFolder\Samples\T5.TXT&quot;<br />
  File &quot;AppFolder\Samples\T7.TXT&quot;<br />
  File &quot;AppFolder\Samples\T8.TXT&quot;<br />
  File &quot;AppFolder\Samples\T9.TXT&quot;<br />
  File &quot;AppFolder\Samples\T10.TXT&quot;<br />
  File &quot;AppFolder\Samples\T11.TXT&quot;<br />
  File &quot;AppFolder\Samples\T12.TXT&quot;<br />
  File &quot;AppFolder\Samples\T13.TXT&quot;<br />
  File &quot;AppFolder\Samples\T17.TXT&quot;<br />
  File &quot;AppFolder\Samples\T18.TXT&quot;<br />
  File &quot;AppFolder\Samples\T19.TXT&quot;<br />
  File &quot;AppFolder\Samples\T20.TXT&quot;<br />
  File &quot;AppFolder\Samples\Format.TXT&quot;<br />
SectionEnd<br />
<br />
Section -AdditionalIcons<br />
  ;WriteIniStr &quot;$INSTDIR\${PRODUCT_NAME}.url&quot; &quot;InternetShortcut&quot; &quot;URL&quot; &quot;${PRODUCT_WEB_SITE}&quot;<br />
  ;CreateShortCut &quot;$SMPROGRAMS\PosPlus\Website.lnk&quot; &quot;$INSTDIR\${PRODUCT_NAME}.url&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\PosPlus\Uninstall.lnk&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
SectionEnd<br />
<br />
Section -Post<br />
  WriteUninstaller &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot; &quot;$INSTDIR\PosPlus.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayName&quot; &quot;$(^Name)&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayIcon&quot; &quot;$INSTDIR\PosPlus.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayVersion&quot; &quot;${PRODUCT_VERSION}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;URLInfoAbout&quot; &quot;${PRODUCT_WEB_SITE}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;Publisher&quot; &quot;${PRODUCT_PUBLISHER}&quot;<br />
SectionEnd<br />
<br />
<br />
Thanks in advance,<br />
With regards,<br />
Swapan Das</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th November 2005, 10:23</div></div><div class="posttext">As iceman_k has already mentioned in your previous thread, Windows manages the order of the shortcuts in the Start menu sorting them by name. You cannot sort it through the installer. The only thing you can do is place a + in front of the main shortcut name to make sure that it's always at the top.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">21st November 2005, 05:17</div></div><div class="posttext">Dear Stu,<br />
Thanks for the reply.<br />
You said windows manages the shortcuts in the Start menu by sorting them name-wise. Then why my Uninstall shortcut will appear at the top:<br />
Start Menu--&gt;Program--&gt;Pos Plus--&gt;Pos Plus<br />
                                          --&gt;Backup Manager<br />
                                          --&gt;Pos Manual<br />
                                          --&gt;Samples<br />
                                          --&gt;Uninstall <br />
And Please note the shortcuts of NSIS<br />
                 ---&gt;Contrib --&gt;AdvSplash Readme<br />
                             --&gt;...and all the files<br />
                                shortcuts.<br />
Similarly I want to show my subfolder &quot;samples&quot; (which is<br />
under my main folder PosPlus) and shortcuts for all the<br />
text files inside the &quot;samples&quot; folder in the same fashion as startmenu-&gt;Programs-&gt;NSIS-&gt;Contrib-&gt;AdvSplash Readme.<br />
<br />
Please help me. Its very urgent for me.<br />
<br />
With regards,<br />
Swapan das</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">21st November 2005, 15:21</div></div><div class="posttext">Windows does not sort alphabetically by default.<br />
The user has to manually specify alphabetical sorting.<br />
Windows uses some internal logic to sort the menu items.<br />
<br />
Edit<br />
Windows uses the following registry value to store the order of the menu items.<br />
Key: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder\Start Menu\Programs\XYZ <br />
Value: Order<br />
<br />
where XYZ is your program group.<br />
<br />
The Order registry value is REG_BINARY, so if you can decode it then you can manually rearrange the order of the items.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rutsche</div><div class="date">20th September 2007, 09:53</div></div><div class="posttext">i solved the problem by first installing my application, then changing the order manualy. Next I copied the &quot;Order&quot; value, which windows created and used it in my nsi file. e.g.: <br />
WriteRegBin HKCU &quot;Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder\Start Menu\Programs\XYZ&quot; &quot;Order&quot; 00890888003.....<br />
<br />
it works :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th September 2007, 13:36</div></div><div class="posttext">That's a good solution.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">21st September 2007, 05:49</div></div><div class="posttext">Thanks rutsche for replying to my this old thread. You did a brilliant 'trick'. Since I'm pre-occupied with many other things now, hope to test it in near future.<br />
<br />
Regards,<br />
Swapan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">4th November 2007, 03:38</div></div><div class="posttext">check out my new nsisStartMenu Plugin (http://wiz0u.free.fr/prog/nsisStartMenu)<br />
(no registry trick, the work is done by Windows Shell)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">4th November 2007, 20:56</div></div><div class="posttext">My plugin works by forcing the Shell to do a premature update of your startmenu folder's menu, so that you can be sure that the shortcuts you created before the call will show up before the shortcuts you create after the call.<br />
<br />
Note: the nsisStartMenu.dll (http://wiz0u.free.fr/prog/nsisStartMenu) exports a function that can be used outside NSIS installers</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">5th November 2007, 06:02</div></div><div class="posttext">Thanks Wizou for coming to my this old thread and giving your solution for it.<br />
<br />
Anybody who has applied above solutions to resolve this issue do let me know if its working fine and the windows version he/she is using while testing for this issue. Be specific you applied which solution, rutsche's or Wizou's.<br />
<br />
Currently I'm into different things, so unable to test these solutions for this issue which troubled me a lot during my initial days of installer creation.<br />
<br />
Regards,<br />
Swapan<br />
[ps.:how's everybody there, esp. RedWine?!]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Spilly</div><div class="date">21st August 2008, 22:30</div></div><div class="posttext">If you only want your shortcuts in the start menu to display in alphabetical order, then you can just delete the key referring to your products entry. <br />
<br />
The next time the start menu shortcuts are accessed, they will be displayed alphabetically.<br />
<br />
Example.<br />
<br />
DeleteRegKey &quot;Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder\Start Menu\Programs\XYZ&quot;</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>