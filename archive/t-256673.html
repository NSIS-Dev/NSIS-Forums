<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstall header images not showing, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstall header images not showing NSIS Discussion" />
	
	<title> Uninstall header images not showing [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstall header images not showing</div>
<hr />
<div class="pda"><a href="t-256673.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=256673">Uninstall header images not showing</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Wabiloo</div><div class="date">2nd October 2006, 11:15</div></div><div class="posttext">My installer works great, with all images showing. The uninstaller on the other hand is showing no header or side image whatsoever. I don't quite understand it as the syntax seems correct, the graphics are in the directory quoted and the uninstaller icon is correct.<br />
<br />
Extracted from my code:<br />
<br />
; -----------------------------<br />
; Includes &amp; Defines<br />
<br />
!include &quot;..\common\src\GlobalDefines.nsh&quot;<br />
!include &quot;MUI.nsh&quot;<br />
<br />
 (...)<br />
<br />
; -----------------------------<br />
; Modern Interface<br />
<br />
; MUI Settings<br />
!define MUI_ABORTWARNING<br />
<br />
; MUI Settings / Icons<br />
!define MUI_ICON &quot;${NSISDIR}\Contrib\Graphics\Icons\orange-install.ico&quot;<br />
!define MUI_UNICON &quot;${NSISDIR}\Contrib\Graphics\Icons\orange-uninstall.ico&quot;<br />
 <br />
; MUI Settings / Header<br />
!define MUI_HEADERIMAGE<br />
!define MUI_HEADERIMAGE_RIGHT<br />
!define MUI_HEADERIMAGE_BITMAP &quot;${GRAPHICS_DIR}\installtop.bmp&quot;<br />
!define MUI_HEADERIMAGE_UNBITMAP &quot;${GRAPHICS_DIR}\uninstalltop.bmp&quot;<br />
 <br />
; MUI Settings / Wizard<br />
!define MUI_WELCOMEFINISHPAGE_BITMAP &quot;${GRAPHICS_DIR}\installside.bmp&quot;<br />
!define MUI_UNWELCOMEFINISHPAGE_BITMAP &quot;${GRAPHICS_DIR}\uninstallside.bmp&quot;<br />
<br />
(... including section writing the uninstaller ...)<br />
<br />
; ========================<br />
; Uninstaller<br />
<br />
!insertmacro MUI_UNPAGE_CONFIRM<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
!insertmacro MUI_UNPAGE_FINISH<br />
<br />
Function un.onGUIInit<br />
    ; get instance from the uninstall.ini file<br />
    ReadIniStr $INSTANCE &quot;$INSTDIR\Uninstall.ini&quot; &quot;Uninstall&quot; &quot;Instance&quot;<br />
<br />
    ; TODO - close application if it is running<br />
<br />
FunctionEnd<br />
<br />
Section &quot;un.Uninstall all&quot;<br />
<br />
    ; Media<br />
    ReadIniStr $0 &quot;$INSTDIR\Uninstall.ini&quot; &quot;Uninstall&quot; &quot;MediaDir&quot;<br />
    ${If} $0 != &quot;&quot;<br />
        Delete &quot;$0\*.*&quot;<br />
        RMDir &quot;$0&quot;<br />
    ${EndIf}<br />
<br />
    ; Database    <br />
    ReadIniStr $0 &quot;$INSTDIR\Uninstall.ini&quot; &quot;Uninstall&quot; &quot;DatabaseDir&quot;<br />
    ${If} $0 != &quot;&quot;<br />
        Delete &quot;$0\*.*&quot;<br />
        RMDir &quot;$0&quot;<br />
    ${EndIf}<br />
        <br />
    ; Settings<br />
    ReadIniStr $0 &quot;$INSTDIR\Uninstall.ini&quot; &quot;Uninstall&quot; &quot;InstanceType&quot;<br />
    ${If} $0 == &quot;/reg&quot;<br />
        DeleteRegKey HKLM &quot;${IS_REGKEY}\${APP_NAME}\$INSTANCE&quot;<br />
    ${ElseIf} $0 == &quot;/xml&quot;<br />
        ReadRegStr $1 HKLM &quot;${IS_REGKEY}\Paths&quot; &quot;AppConfigRoot&quot;<br />
        Delete &quot;$1\${APP_NAME}\Config-$INSTANCE.xml&quot;<br />
    ${EndIf}<br />
<br />
    ; Launcher <br />
    ; TODO - remove registration with launcher via LauncherManager<br />
<br />
    ; Program Files<br />
    Delete &quot;$INSTDIR\*.*&quot;<br />
    RMDir &quot;$INSTDIR&quot;<br />
    <br />
    ; remove uninstaller entry from registry<br />
    DeleteRegKey HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${APP_NAME}-$INSTANCE&quot;    <br />
<br />
    ; TODO - offer to remove Firebird as well...<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschagottfried</div><div class="date">2nd October 2006, 12:13</div></div><div class="posttext">see help for uninstall 4.6.2<br />
<br />
The first Delete instruction works (deleting the uninstaller), because the uninstaller is transparently copied to the system temporary directory for the uninstall.<br />
<br />
Check if your paths, especially ${GRAPHICS_DIR} are absolut. If not uninstaller will not find your background image. uninstall icon works with ${NSISDIR}. That will build an absolut path.<br />
<br />
Try to put your images into $NSISDIR. If that works, you know its a common path error.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wabiloo</div><div class="date">21st May 2007, 12:05</div></div><div class="posttext">My ${GRAPHICS_DIR} is an absolute path, and is the same as the one used in the installer part, which works.<br />
I also tried copying the images in ${NSISDIR} and change the code accordingly, to no avail.<br />
<br />
Does anyone have another idea why my uninstaller wouldn't show the images?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschagottfried</div><div class="date">21st May 2007, 12:34</div></div><div class="posttext">Please attach your code from your installer that works and of uninstaller that does not work. My first intention is that you have to tell to MUI that you want to extract the file to a path during un.onInit of Uninstaller. You have to use that path for dialogs. Your installer approach works, because you have NSIS installed and and those MUI macros insert and extract the graphic files during installation. During installtion on customer system there is (most probably) no NSIS installtion. That's why you have to care for extraction to proper/known path on customer system. MUI_INSTALLOPTIONS_EXTRACT and $PLUGINSDIR are two good keywords for your readings. I know my example is for custom dialogs, but it explains the idea as well.<br />
<br />
Function un.onInit<br />
;bitmap as background image<br />
!insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;wizard.bmp&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;uninstallpage.ini&quot;<br />
<br />
define a custom page for uninstaller:<br />
UninstPage custom un.ChooseUninstallationType un.CheckUninstallationType<br />
<br />
When you do this you can refer to this picture in a custom function for custom dialogs:<br />
<br />
Function un.ChooseUninstallationType<br />
<br />
;needs to be done before initialising dialog - otherwise bitmap is missing<br />
!insertmacro MUI_INSTALLOPTIONS_WRITE &quot;uninstallpage.ini&quot; &quot;Field 1&quot; &quot;Text&quot; &quot;$PLUGINSDIR\wizard.bmp&quot; <br />
<br />
sorry for bad insertion of code snippets, but its just from my code. read 'Using InstallOptions for custom pages' in NSIS-MUI help for explanation of ressource file handling in installers/uninstallers!<br />
<br />
Good luck!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">akshay.sharma</div><div class="date">30th April 2008, 05:42</div></div><div class="posttext">This is not resolving my problem. the unistaller still doesn't show the image.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>