<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Using System plugin with Arrays, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Using System plugin with Arrays NSIS Discussion" />
	
	<title> Using System plugin with Arrays [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Using System plugin with Arrays</div>
<hr />
<div class="pda"><a href="t-189043.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=189043">Using System plugin with Arrays</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">5th August 2004, 22:13</div></div><div class="posttext">I have this code below (if you see, it's converted from KillProcDLL from DITMan, but what I'm trying to do is only to detect if the program is running, I don't want to kill it):<br />
<br />
    # Get Processes List<br />
    System::Alloc 1024<br />
    Pop $R2<br />
    System::Call &quot;Psapi::EnumProcesses(i .R2, i 1024, i .R4)i .R5&quot;<br />
    StrCmp $R5 0 0 ListOfProcessesTestEnd<br />
      System::Call `Kernel32::FreeLibraryA(t &quot;PSAPI.DLL&quot;)i`<br />
      StrCpy $1 701 ;Unable to get process list, EnumProcesses failed<br />
    ListOfProcessesTestEnd:<br />
    # $R2 = List of Processes<br />
<br />
    # Detect Number of Processes<br />
    <br />
    IntOp $R3 $R4 / 4 ; Remember that DWORD size is ever 4<br />
    # $R3 = Number of Processes<br />
    <br />
    StrCpy $R4 0<br />
    # $R4 = Counter of Processes<br />
<br />
    # Match the Name of Each Process<br />
    IntCmp $R4 $R3 MatchNameTestEnd 0 MatchNameTestEnd<br />
<br />
      #Get the module name for this process<br />
      StrCpy $R5 &quot;Unknown&quot;<br />
      <br />
      #Get Process Handle<br />
      System::Call &quot;Kernel32::OpenProcess(i 0x0400|0x0010, i 0, i ?)i .R6<br />
<br />
The &quot;?&quot; I put in the code above is to indicate the process handle to open. As the handle (= DWORD) has to be received from an array, and this array is 1024 bytes long in this case, I can't use a code like this below:<br />
<br />
StrCmp $R4 1 0 Second<br />
  System::Call &quot;*$R2(i.r2)&quot;<br />
Second:<br />
StrCmp $R4 2 0 Third<br />
  System::Call &quot;*$R2(,i.r2)&quot;<br />
Third:<br />
...<br />
<br />
Because 1024/4 is 256, Am I crazy to use this code 256 times?<br />
<br />
Is there a way get an item data from an array using only the array handle and the item index, like in C and C++?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">6th August 2004, 00:15</div></div><div class="posttext">If you want to check if a process is running you could try FindProcDLL from the Archive (it is based upon KillProcDLL):<br />
<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=483</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">6th August 2004, 01:57</div></div><div class="posttext">I knew that before but I wanted a System plugin version of it, because I now have a lot of stuff on my program using System plugin.<br />
<br />
If I change my mind about the code, I just wanted to know the answer to that question.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eccles</div><div class="date">7th August 2004, 00:00</div></div><div class="posttext">If $R4 is 0, 4, 8, 12, etc.:<br />
IntOp $x $R2 + $R4<br />
System::Call &quot;*$x(i.r2)&quot;<br />
...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>