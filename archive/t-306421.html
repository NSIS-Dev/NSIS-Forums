<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Find and uninstall old version, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Find and uninstall old version NSIS Discussion" />
	
	<title> Find and uninstall old version [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Find and uninstall old version</div>
<hr />
<div class="pda"><a href="t-306421.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=306421">Find and uninstall old version</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">morphaeus</div><div class="date">16th May 2009, 01:34</div></div><div class="posttext">I'm trying to find an old version of a program and uninstall that version before continuing with the installation. This is what I have so far<br />
<br />
<br />
Function OldVer<br />
IfFileExists $INSTDIR\uninst.exe 0 0              <br />
MessageBox MB_OK|MB_ICONINFORMATION &quot;Setup will now uninstall an old version of Batch Terminate&quot;              <br />
ExecWait &quot;$INSTDIR\uninst.exe&quot;              <br />
Return<br />
FunctionEnd<br />
<br />
It shows the dialog message everytime. It can find and run the uninstall program, however, it doesn't wait for the uninstall to complete and terminate.<br />
<br />
Any ideas?<br />
thank you in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">16th May 2009, 12:27</div></div><div class="posttext">http://www.google.com/search?q=nsis+uninstall+wait<br />
http://nsis.sourceforge.net/When_I_use_ExecWait_uninstaller.exe_it_doesn%27t_wait_for_the_uninstaller<br />
<br />
3.2.2 Uninstaller Specific Options<br />
_?= sets $INSTDIR. It also stops the uninstaller from copying itself to the temporary directory and running from there. It can be used along with ExecWait to wait for the uninstaller to finish. It must be the last parameter used in the command line and must not contain any quotes, even if the path contains spaces.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">morphaeus</div><div class="date">16th May 2009, 16:51</div></div><div class="posttext">Thank you for your reply, worked like a charm :)<br />
<br />
However, I still have the problem of it triggering the Message Box regardless of whether or not the file is found.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">16th May 2009, 18:26</div></div><div class="posttext">Should beIfFileExists $INSTDIR\uninst.exe 0 +3</div></div><hr />


<div class="post"><div class="posttop"><div class="username">morphaeus</div><div class="date">16th May 2009, 21:04</div></div><div class="posttext">Thank you very much both of you. Both problems now resolved</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>