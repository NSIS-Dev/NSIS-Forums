<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Windows Service, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Windows Service NSIS Discussion" />
	
	<title> Windows Service [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Windows Service</div>
<hr />
<div class="pda"><a href="t-120486.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=120486">Windows Service</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">treaz</div><div class="date">7th January 2003, 16:17</div></div><div class="posttext">Hi,<br />
I wish to find out if there is any way I could start a windows service through the installer?<br />
Basically, I am looking at getting my program (after installation) to start up by itself whenever Windows startup.<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th January 2003, 17:19</div></div><div class="posttext">You don't need a service for that... Either put a shortcut in $SMSTARTUP or write to the registry in the appropriate place as explained at this MSDN page: http://msdn.microsoft.com/library/default.asp?url=/library/en-us/setupapi/setup/run_and_runonce_registry_keys.asp</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">7th January 2003, 18:15</div></div><div class="posttext">If the service is installed you can also start a service using the net command (Windows NT and later only maybe).<br />
<br />
net start &lt;servicename&gt;<br />
net stop &lt;servicename&gt;<br />
<br />
Without the angle brackets.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">treaz</div><div class="date">16th January 2003, 16:19</div></div><div class="posttext">Hi,<br />
<br />
As you mentioned the use of net start, may I know how should I create or what command should I include in my .nsi file such that I could use this net start command to start my program?<br />
<br />
Thanks.:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">16th January 2003, 19:02</div></div><div class="posttext">net is a command present on 2K systems and above and maybe some NT systems too (NT4?) so you just run it like any other system command. net does many things other than manipulate services, net start and net stop are two commands for services that you will want to use.<br />
<br />
Here are some examples :<br />
Exec &quot;net stop servicename&quot;<br />
ExecWait &quot;net stop servicename&quot;<br />
nsExec::Exec &quot;net stop servicename&quot;<br />
nsExec::ExecToLog &quot;net stop servicename&quot;<br />
nsExec::ExecToStack &quot;net stop servicename&quot;<br />
<br />
I'm not sure if this will work:<br />
<br />
ExecShell &quot;net stop servicename&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">treaz</div><div class="date">16th January 2003, 20:14</div></div><div class="posttext">Hi,<br />
<br />
Thanks for your respond but I guess I didnt make myself clear.<br />
<br />
I need to know how to register my program to a windows service such that I could use those Exec &quot;net start test&quot; and so on...<br />
<br />
I need to know how to register my program in my .nsi file. Not how to use the net command in my script.<br />
<br />
Apologise for that confusion. Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">16th January 2003, 22:12</div></div><div class="posttext">I'm not sure I or anyone can answer that. Is this a program you have written yourself? If so you should have coded a way for the service to register itself. Is it written by someone else? If so they should have provided a means to register it. Is this program actually not designed as a service program but you want to run it as a service anyway? That's a different problem entirely.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jthompson</div><div class="date">16th January 2003, 22:29</div></div><div class="posttext">Assuming what you want to &quot;register&quot; as a service is actually designed that way...<br />
<br />
Included in the .NET Framework SDK there is a utility named &quot;InstallUtil.exe&quot;. This utility is used to execute installers on a given assembly. In part 1 step 2, we discussed how to use the ServiceInstaller and ServiceProcessInstaller to install our service on the desired machine. Executing &quot;InstallUtil.exe&quot; on our Windows Service assembly will (hopefully) install the Windows Service. <br />
<br />
To install our service from the command line type: <br />
<br />
<br />
installutil scheduler_net.exe<br />
<br />
<br />
and to uninstall it, add the &quot;/u&quot; parameter: <br />
<br />
installutil scheduler_net.exe  /u<br />
<br />
<br />
Finally, launch the services plug-in in the Microsoft Management Console and start the service. <br />
 <br />
Taken from http://www.15seconds.com/issue/021015.htm</div></div><hr />


<div class="post"><div class="posttop"><div class="username">treaz</div><div class="date">17th January 2003, 18:47</div></div><div class="posttext">Apparently this is the scenerio:<br />
<br />
&quot;this program actually not designed as a service program but I want to run it as a service anyway.....&quot;<br />
<br />
Would be nice to know if it is possible...Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">18th January 2003, 02:01</div></div><div class="posttext">Try looking into FireDaemon or SrvAny (the latter is an NT Resource Kit tool I think). Both of these programs allow any executable to run as a service, FireDaemon is more user friendly and more capable in my experience.<br />
<br />
You must remember however that since the program wasn't designed to work as a service it may not run entirely as expected when using these tools.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SchmoobeeDrew</div><div class="date">27th January 2003, 07:57</div></div><div class="posttext">How is it possible to reboot a computer and have a Shoutcast relay server auto start?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">27th January 2003, 08:41</div></div><div class="posttext">You could add a value to the Run or RunOnce keys in the registry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SchmoobeeDrew</div><div class="date">27th January 2003, 08:48</div></div><div class="posttext">OK, Sunjammer<br />
how would I do that<br />
<br />
thanx for your reply</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">27th January 2003, 09:05</div></div><div class="posttext">The Run and RunOnce keys exist in two places, in the per user configurations in the registry, and in the local machine configuration... I'd suggest you want it in the latter, that is :-<br />
<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce<br />
<br />
If you want the Shoutcast Relay Server to run *every* time the computer reboots then you'll want to add a value to the Run key, otherwise if it's just the once you want it to happen use the RunOnce key instead :-<br />
<br />
WriteRegStr HKLM \<br />
&quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Run&quot; \<br />
&quot;ShoutCastRelayServer&quot; &quot;c:\path\to\relay\server\binary.exe&quot;<br />
<br />
The ShoutCastRelayServer bit is just a name, you can put anything there.<br />
<br />
If you need to specify arguments to the shoutcast server you'll need to do it like this:-<br />
<br />
WriteRegStr HKLM \<br />
&quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Run&quot; \<br />
&quot;ShoutCastRelayServer&quot; \<br />
'&quot;c:\path\to\relay\server\binary.exe&quot; /arg /arg /arg'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SchmoobeeDrew</div><div class="date">27th January 2003, 16:16</div></div><div class="posttext">Thnx very much SunJammer<br />
<br />
Now I have never edited a registry... obviously a backup prior to edit is in order.... any suggestions on tools.... like I use phpmyadmin for database editing, phpedit for script editing.... is there an application to use or just notepad..?<br />
<br />
I really want to have all the knowledge possible before jumping into such a fragile area.<br />
<br />
many thanx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th January 2003, 16:28</div></div><div class="posttext">Have a look at the NSIS related software section in the archive:<br />
http://nsis.sourceforge.net/archive/nsisweb.php?page=8&amp;instances=0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">27th January 2003, 17:15</div></div><div class="posttext">Adding a value under the Run or RunOnce keys *should* be safe, unless you are specifying a program that for some reason really causes a problem when starting Windows... but I've never encountered that problem myself.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>