<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Spaces in path when using upgradedll macro, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Spaces in path when using upgradedll macro NSIS Discussion" />
	
	<title> Spaces in path when using upgradedll macro [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Spaces in path when using upgradedll macro</div>
<hr />
<div class="pda"><a href="t-116588.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=116588">Spaces in path when using upgradedll macro</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Bugge T. Jensen</div><div class="date">4th December 2002, 11:16</div></div><div class="posttext">Hi<br />
<br />
I want to use the upgrade macro like<br />
<br />
Push &quot;$PROGRAMFILES\common files\designer\Mscdrun.dll&quot;<br />
!define DLL_NAME ${SOURCE}\c_program_files\common files\designer\Mscdrun.dll<br />
!insertmacro UpgradeDLL<br />
<br />
But due to the space in the path this fails<br />
<br />
Any ideas <br />
<br />
:confused:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">4th December 2002, 11:26</div></div><div class="posttext">You should use my new UpgradeDLL macro, which works better and supports spaces.<br />
<br />
You can find it in the NSIS 2 documentation:<br />
http://nsis.sourceforge.net/Docs/AppendixB.html#B.10</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bugge T. Jensen</div><div class="date">4th December 2002, 11:30</div></div><div class="posttext">Hi<br />
<br />
I dont use NSIS 2.0 yet so i think thats the problem.<br />
<br />
The exact error is<br />
<br />
Push: &quot;$PROGRAMFILES\common files\designer\Mscdrun.dll&quot;<br />
!define expects 1-1 parameters, got 3.<br />
Usage: !define symbol [value]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">4th December 2002, 11:39</div></div><div class="posttext">That UpgradeDLL macro is very old and does not fully handle reboot flags etc.<br />
<br />
My new macro should also be compatible with NSIS 1.98. Get it from the link I gave you above.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bugge T. Jensen</div><div class="date">4th December 2002, 12:24</div></div><div class="posttext">I use nsis 1.98 so my guess is that the 2.0 macro will work<br />
<br />
the exact error is<br />
<br />
Push: &quot;$PROGRAMFILES\common files\designer\Mscdrun.dll&quot;<br />
!define expects 1-1 parameters, got 3.<br />
Usage: !define symbol [value]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bugge T. Jensen</div><div class="date">4th December 2002, 12:28</div></div><div class="posttext">Sorry posted a message twice. I will try your macro<br />
<br />
THANX</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bugge T. Jensen</div><div class="date">4th December 2002, 12:56</div></div><div class="posttext">Hi<br />
OK. Did try your macro<br />
<br />
with the command<br />
<br />
!insertmacro UpgradeDLL  &quot;${SOURCE}\c_system32\Mschrt20.ocx&quot; &quot;$WINDIR\Mschrt20.ocx&quot;<br />
<br />
But get an error er don't understand<br />
<br />
<br />
Section: &quot;System32&quot;<br />
SetOutPath: &quot;$WINDIR\Fonts&quot;<br />
File: &quot;WINGDNG2.TTF&quot; 59696 bytes<br />
!insertmacro: UpgradeDLL<br />
Push: $R0<br />
Push: $R1<br />
Push: $R2<br />
Push: $R3<br />
IfFileExists: &quot;$WINDIR\Mschrt20.ocx&quot; ?  : copy_c:\TEMP\sn\CBT\install\c_system32\Mschrt20.ocx<br />
ClearErrors<br />
GetDLLVersionLocal: c:\TEMP\sn\CBT\install\c_system32\Mschrt20.ocx (393216,5767172)-&gt;($R0,$R1)<br />
GetDLLVersion: $WINDIR\Mschrt20.ocx-&gt;$R2,$R3<br />
IfErrors ?upgrade_c:\TEMP\sn\CBT\install\c_system32\Mschrt20.ocx:<br />
IntCmpU $R0:$R2 equal=, &lt; done_c:\TEMP\sn\CBT\install\c_system32\Mschrt20.ocx, &gt; upgrade_c:\TEMP\sn\CBT\install\c_system32\Mschrt20.ocx<br />
IntCmpU $R1:$R3 equal=done_c:\TEMP\sn\CBT\install\c_system32\Mschrt20.ocx, &lt; done_c:\TEMP\sn\CBT\install\c_system32\Mschrt20.ocx, &gt; upgrade_c:\TEMP\sn\CBT\install\c_system32\Mschrt20.ocx<br />
Error: !if/!else/!ifdef can only be specified in file mode, not in command/macro mode<br />
Error in macro UpgradeDLL on macroline 26<br />
Error in script &quot;C:\temp\SN\install_cbt\SN_CBT.nsi&quot; on line 76 -- aborting creation process</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">4th December 2002, 13:56</div></div><div class="posttext">Forgot about that, NSIS 1.98 doesn't support !if and friends in macro's.<br />
<br />
So you have to upgrade to NSIS 2 to use this macro. Download the latest snapshot at http://nsis.sf.net. It's really stable now, so upgrading won't result in any problems.<br />
<br />
You can also remove the<br />
<br />
  !ifndef UPGRADEDLL_NOREGISTER<br />
  !endif<br />
<br />
lines from the macro, if you are not using UPGRADEDLL_NOREGISTER.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bugge T. Jensen</div><div class="date">4th December 2002, 14:42</div></div><div class="posttext">Hi again<br />
<br />
I have now installed the nsis20a7 and is using your macro<br />
but still have the<br />
<br />
Error: !if/!else/!ifdef can only be specified in file mode, not in command/macro<br />
 mode<br />
Error in macro UpgradeDLL on macroline 26<br />
<br />
problem ??<br />
<br />
anyway thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">4th December 2002, 14:52</div></div><div class="posttext">Alpha 7 is a very old version which also doesn't support this feature.<br />
<br />
Download the latest snapshot at http://nsis.sourceforge.net/nightly/nsis.zip</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th December 2002, 15:46</div></div><div class="posttext">If you still want to use NSIS 1.98 your problem was you didn't quote. Your !define should have looked like this:<br />
<br />
!define DLL_NAME &quot;${SOURCE}\c_program_files\common files\designer\Mscdrun.dll&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">4th December 2002, 22:11</div></div><div class="posttext">The old UpgradeDLL macro doesn't support spaces, so that's not the only problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bugge T. Jensen</div><div class="date">5th December 2002, 09:40</div></div><div class="posttext">Hi <br />
<br />
NSIS2.0b0 rock's<br />
<br />
Everything works now.<br />
I Like the new look of the manual<br />
Thanks</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>