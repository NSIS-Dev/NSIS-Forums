<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" WordFunc.nsh + TextFunc.nsh + FileFunc.nsh, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  WordFunc.nsh + TextFunc.nsh + FileFunc.nsh NSIS Discussion" />
	
	<title> WordFunc.nsh + TextFunc.nsh + FileFunc.nsh [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  WordFunc.nsh + TextFunc.nsh + FileFunc.nsh</div>
<hr />
<div class="pda"><a href="t-203228.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=203228">WordFunc.nsh + TextFunc.nsh + FileFunc.nsh</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">28th December 2004, 11:23</div></div><div class="posttext">I have thought :) more convenient to update one topic than three topics<br />
<br />
Word Functions Header v2.52<br />
Text Functions Header v1.4<br />
File Functions Header v1.21<br />
<br />
1. Function GetParameters moved from WordFunc.nsh to FileFunc.nsh<br />
2. Text Functions LineFind and LineRead<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-now last line &quot;-1&quot; instead of &quot;0&quot;<br />
<br />
These headers are included with NSIS. See: http://nsis.sourceforge.net/Docs/AppendixE.html#E</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">18th January 2005, 00:53</div></div><div class="posttext">Word Functions Header v2.6<br />
Text Functions Header v1.4<br />
File Functions Header v1.3<br />
<br />
1. &quot;GetDrives&quot; v1.1<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Fixed: depended on drives order<br />
<br />
2. &quot;WordFind2X&quot; v2.1<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Loops sorted<br />
<br />
3. New: &quot;WordFind3X&quot; v1.0<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Find word, that contain string, between two delimiters.<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;(Based on Afrow UK idea of Function &quot;StrSortLR&quot; 2003-06-18)<br />
<br />
4. &quot;WordFuncExample.nsi&quot; updated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">1st February 2005, 08:05</div></div><div class="posttext">Word Functions Header v2.6<br />
Text Functions Header v1.5<br />
File Functions Header v1.3<br />
<br />
&quot;LineFind&quot; v1.3<br />
&amp;nbsp;&amp;nbsp;-Added &quot;/NUL&quot; option: No output text file (only read InputFile).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">13th February 2005, 02:50</div></div><div class="posttext">Word Functions Header v2.6<br />
Text Functions Header v1.5<br />
File Functions Header v1.4<br />
<br />
1. New: &quot;GetBaseName&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Get file name without extension.<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;(Based on comperio idea of Function &quot;GetBaseName&quot; 2005-01-28)<br />
<br />
2. New: &quot;GetFileVersion&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Gets the version information from executable file.<br />
<br />
3. New: &quot;VersionCompare&quot; v1.0<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Compare version numbers.<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;(Based on Afrow UK Function &quot;VersionCheckNew2&quot; 2005-01-24)<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;His original function isn't included because of wrong results:<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;${VersionCheckNew2} &quot;2.5.9&quot; &quot;2.5.01&quot; $R0&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Ver2 newer<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;${VersionCheckNew2} &quot;2.5.09&quot; &quot;2.5&quot; $R0&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-equal</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th February 2005, 04:33</div></div><div class="posttext">Why is 2.5.09 equal to 2.5? Just a typo or does the function behave that way?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">13th February 2005, 09:29</div></div><div class="posttext">No. It isn't a typo.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">13th February 2005, 14:12</div></div><div class="posttext">@kichik:<br />
       His original function isn't included because of wrong results:<br />
       ${VersionCheckNew2} &quot;2.5.9&quot; &quot;2.5.01&quot; $R0     -Ver2 newer<br />
       ${VersionCheckNew2} &quot;2.5.09&quot; &quot;2.5&quot; $R0       -equal<br />
read it another time :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th February 2005, 18:16</div></div><div class="posttext">Thanks for letting me know :hang: <br />
Fixed my function.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">21st March 2005, 08:24</div></div><div class="posttext">Word Functions Header v2.6<br />
Text Functions Header v1.6<br />
File Functions Header v1.4<br />
<br />
1. &quot;LineFind&quot; v1.4<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Output file will not be updated if no changes made<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Error flag if output file path isn't exists<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Added: &quot;{No}&quot; callback this line and don't write others<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Variables in callback function changed<br />
<br />
2. Added script to simple install WordFunc.nsh, TextFunc.nsh, FileFunc.nsh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">26th March 2005, 20:53</div></div><div class="posttext">Word Functions Header v2.7<br />
Text Functions Header v1.7<br />
File Functions Header v1.5<br />
<br />
1. &quot;ClbSet&quot;, &quot;ClbGet&quot; removed from WordFunc.nsh<br />
<br />
2. &quot;LineRead&quot; v1.2, &quot;LineSum&quot;, &quot;FileJoin&quot; v1.4, &quot;TextCompare&quot; v1.2<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Added IfErrors after FileOpen<br />
<br />
3. &quot;GetDrives&quot; v1.2<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Added &quot;ALL&quot; along with &quot;&quot;<br />
<br />
4. New: &quot;FileReadFromEnd&quot; v1.0<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Read text file from end line by line.<br />
<br />
5. New: &quot;DriveSpace&quot; v1.0<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Get total, occupied or free space of the drive.<br />
<br />
6. Added: &quot;GetRoot&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;(Based on KiCHiK Function &quot;GetRoot&quot;)<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Get the root directory.<br />
<br />
7. Added: &quot;GetParent&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;(Based on sunjammer Function &quot;GetParent&quot;)<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Get parent directory.<br />
<br />
8. Added: &quot;GetFileName&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;(Based on KiCHiK Function &quot;GetFileName&quot;)<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Get last part from directory path.<br />
<br />
9. Many minor code and documentation improvements</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">27th March 2005, 09:49</div></div><div class="posttext">Word Functions Header v2.7<br />
Text Functions Header v1.7<br />
File Functions Header v1.6<br />
<br />
&amp;nbsp;&amp;nbsp;&quot;DriveSpace&quot;, &quot;DirState&quot;, &quot;GetFileVersion&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Missing ClearErrors at the beginning.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">28th March 2005, 11:56</div></div><div class="posttext">Word Functions Header v2.7<br />
Text Functions Header v1.8<br />
File Functions Header v1.7<br />
<br />
 In order to avoid exiting from connected functions,<br />
changed exit value in callback function to &quot;Stop&lt;FunctionName&gt;&quot;:<br />
<br />
-&quot;LineFind&quot;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Stop -&gt; StopLineFind<br />
-&quot;FileReadFromEnd&quot;&amp;nbsp;&amp;nbsp;Stop -&gt; StopFileReadFromEnd<br />
-&quot;TextCompare&quot;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;StopCompare -&gt; StopTextCompare<br />
-&quot;GetDrives&quot;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Stop -&gt; StopGetDrives</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">1st April 2005, 18:45</div></div><div class="posttext">Word Functions Header v2.8<br />
Text Functions Header v1.8<br />
File Functions Header v1.8<br />
<br />
1. &quot;Locate&quot; v1.5<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Added &quot;/B=&quot; parameter (when used banner with function)<br />
<br />
2. &quot;StrFilter&quot; v1.2<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Missing ClearErrors at the beginning.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">11th April 2005, 12:31</div></div><div class="posttext">Word Functions Header v2.8<br />
Text Functions Header v1.8<br />
File Functions Header v1.9<br />
<br />
<br />
Changes:<br />
<br />
&amp;nbsp;&quot;Locate&quot; v1.6<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Fixed: if error appeared in the callback, function don't restore stack after exit.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">14th April 2005, 11:01</div></div><div class="posttext">Word Functions Header v2.8<br />
Text Functions Header v1.8<br />
File Functions Header v2.0<br />
<br />
<br />
Changes:<br />
<br />
&amp;nbsp;New: &quot;GetOptions&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Get options from command line parameters.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">20th April 2005, 12:53</div></div><div class="posttext">Word Functions Header v2.9<br />
Text Functions Header v2.0<br />
File Functions Header v2.3<br />
<br />
<br />
Changes:<br />
<br />
1. Verbosity added (faster compilation time)<br />
<br />
2. &quot;Locate&quot; v1.7<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Fixed: Banner support<br />
<br />
3. &quot;GetOptions&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Now required only 2 arguments:<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;${GetOptions} &quot;[Parameters]&quot; &quot;[Option]&quot; $var<br />
<br />
4. &quot;GetTime&quot; v1.2<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Now convert day and month in DD and MM format<br />
<br />
5. &quot;TextCompare&quot; v1.4<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Rewrited all code<br />
<br />
6. &quot;FileReadFromEnd&quot; v1.2<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Now if the text file cannot be opened, the error flag is set</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">24th May 2005, 19:05</div></div><div class="posttext">Word Functions Header v3.0<br />
Text Functions Header v2.1<br />
File Functions Header v2.4<br />
<br />
<br />
Changes:<br />
<br />
1. &quot;VersionCompare&quot; moved from FileFunc.nsh to WordFunc.nsh<br />
<br />
2. New: &quot;VersionConvert&quot; v1.0<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Convert version in the numerical format which can be compared.<br />
<br />
3. New: &quot;ConfigRead&quot; v1.0<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Read value from entry name in config file.<br />
<br />
4. New: &quot;ConfigWrite&quot; v1.1<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Write value from entry name in config file.<br />
<br />
5. New: &quot;FileRecode&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Recode text file from DOS to Windows format and vice-versa.<br />
<br />
6. New: &quot;GetFileAttributes&quot; v1.1<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Get attributes of file or directory.<br />
<br />
7. New: &quot;BannerTrimPath&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Trim string path for banner.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">12th July 2005, 12:35</div></div><div class="posttext">Word Functions Header v3.0<br />
Text Functions Header v2.1<br />
File Functions Header v2.5<br />
<br />
<br />
Changes:<br />
<br />
1. &quot;GetDrives&quot; v1.4<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Fixed: Alloc/Free (Thanks nechai)<br />
<br />
2. &quot;GetOptions&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Better option search (complite ignoration in quotes)<br />
<br />
3. Renamed example scripts (like in CVS):<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;...FuncTest.nsi -&gt; ...Func.nsi<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;...FuncTest.ini -&gt; ...Func.ini</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">21st July 2005, 00:49</div></div><div class="posttext">Word Functions Header v3.0<br />
Text Functions Header v2.1<br />
File Functions Header v2.6<br />
<br />
<br />
Changes:<br />
<br />
1. &quot;GetTime&quot; v1.3<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Fixed: Free structures<br />
<br />
2. &quot;GetExeName&quot; and &quot;GetExePath&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Simplification with &quot;GetLongPathNameA&quot;<br />
<br />
3. &quot;BannerTrimPath&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Added D mode</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">23rd August 2005, 13:20</div></div><div class="posttext">Word Functions Header v3.1<br />
Text Functions Header v2.1<br />
File Functions Header v2.7<br />
<br />
Changes:<br />
<br />
1. &quot;WordReplace&quot; v2.1<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Fixed: Incorrect rule for return errorlevel 1 in situation when string beginning with word to replace and its only one word in string and when uses option - deletes all founded words  (thanks hemancuso)<br />
<br />
2. &quot;GetExeName&quot; and &quot;GetExePath&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Fixed: Return empty string in Windows 95 (thanks kichik)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">21st October 2005, 19:22</div></div><div class="posttext">Word Functions Header v3.1<br />
Text Functions Header v2.1<br />
File Functions Header v2.8<br />
<br />
Changes:<br />
<br />
1. Now &quot;GetRoot&quot; returns not only root drive or UNC:<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;${GetRoot} &quot;Program Files\NSIS&quot; $R0 &amp;nbsp;&amp;nbsp;&amp;nbsp;# $R0=&quot;Program Files&quot; instead of &quot;&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;${GetRoot} &quot;\Program Files\NSIS&quot; $R0 &amp;nbsp;&amp;nbsp;# $R0=&quot;\Program Files&quot; instead of &quot;&quot;<br />
<br />
2. Some typos corrected (thanks Jamyn)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MikeSchinkel</div><div class="date">23rd December 2005, 08:47</div></div><div class="posttext">I need to use UTC (Coordinated Universal Time) instead of Local Time which can be gotten from kernel32::GetSystemTime (http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sysinfo/base/getsystemtime.asp).  Any chance of updating the &quot;official&quot; version of Text Functions Header to incorporate that functionality?<br />
<br />
My other option is to hack GetTime() and include it directly in my code. Yuck.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">24th December 2005, 14:16</div></div><div class="posttext">Word Functions Header v3.1<br />
Text Functions Header v2.1<br />
File Functions Header v2.9<br />
<br />
Changes:<br />
<br />
&quot;GetTime&quot; v1.4<br />
-Added support for system time (UTC)<br />
-Added example how to convert time to 12-hour format AM/PM</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">3rd February 2006, 14:01</div></div><div class="posttext">Has the getdrives function been tested on windows 98,<br />
<br />
If so does it work?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">3rd February 2006, 14:30</div></div><div class="posttext">Has the getdrives function been tested on windows 98YesIf so does it work?:) Yes</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">3rd February 2006, 14:37</div></div><div class="posttext">Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">5th February 2006, 18:37</div></div><div class="posttext">Word Functions Header v3.2<br />
Text Functions Header v2.2<br />
File Functions Header v3.0<br />
<br />
Changes:<br />
<br />
1. &quot;WordReplace&quot; v2.2<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Added options &quot;{&quot;, &quot;}&quot;, &quot;{*&quot;, &quot;}*&quot;<br />
<br />
2. &quot;GetOptions&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Now sets error flag if option does not found<br />
<br />
3. &quot;ConfigRead&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Now sets error flag if entry does not found<br />
<br />
4. New case sensitive functions (NSIS 2.14 required):<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;WordFindS&quot;, &quot;WordFind2XS&quot;, &quot;WordFind3XS&quot;, &quot;WordReplaceS&quot;,<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;WordAddS&quot;, &quot;WordInsertS&quot;, &quot;StrFilterS&quot;, &quot;TextCompareS&quot;,<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;ConfigReadS&quot;, &quot;ConfigWriteS&quot;, &quot;GetOptionsS&quot;<br />
<br />
5. Added program for simple headers install</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">6th February 2006, 09:19</div></div><div class="posttext">Word Functions Header v3.2<br />
Text Functions Header v2.3<br />
File Functions Header v3.1<br />
<br />
Changes:<br />
<br />
-Added /NOUNLOAD flag for the system plugin. Functions that uses system plugin calls several times, now 25-75% faster (&quot;GetSize&quot;, &quot;DriveSpace&quot;, &quot;GetDrives&quot;, &quot;GetTime&quot;, &quot;ConfigWrite&quot;, &quot;FileRecode&quot;).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">6th February 2006, 19:48</div></div><div class="posttext">kichik, plz update the CVS :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">9th March 2006, 01:46</div></div><div class="posttext">Hey Instructor,<br />
I have to say that your functions are very cool.  I find that I use them almost every chance I get!<br />
<br />
Here's an enhancement suggestion for the Locate function:<br />
Currently, there is an option /M=[mask] to add options of what to search for.  A cool option might be something like /!M=[mask] to specify what to EXCLUDE.  <br />
<br />
For example /!M=*.EXE would mean to exclude all dat files from the search.  <br />
<br />
Using both together, one might use<br />
/M=*.DAT /!M=doofus.dat<br />
<br />
which would translate to:<br />
&quot;Include all *.DAT files except the file named 'doofus.dat'&quot;<br />
<br />
That's all I have for now.  Keep up the great work!:up:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">9th March 2006, 03:17</div></div><div class="posttext">Many filters implemented in Locate plugin (http://nsis.sourceforge.net/Locate_plugin)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">9th March 2006, 03:53</div></div><div class="posttext">Thanks for the link, Instructor.  Looks exactly what I was looking for!<br />
<br />
So tell me, why is this not included with NSIS itself like you've your other functions?  (Just curious)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">9th March 2006, 05:34</div></div><div class="posttext">So tell me, why is this not included with NSIS itself like you've your other functions? (Just curious)I think this is not my question :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">9th March 2006, 15:26</div></div><div class="posttext">OK, I found an odd problem:<br />
I'm using the Locate function from NSIS ver 2.15.<br />
<br />
I'm using it to search for all files/directies.  I found that if I push two items to the stack, then locate will stop.  But, if I just push one item to the stack, it works as expected.  <br />
<br />
I also noticed that when i push the text &quot;blah&quot; to the stack the 2nd time (instead of &quot;continue&quot;), I get a Windows error.<br />
<br />
Here's a short sample showing the error:<br />
<br />
name &quot;test&quot;<br />
outfile &quot;test.exe&quot;<br />
!define ROOT &quot;C:\TEMP&quot;<br />
!include FileFunc.nsh<br />
!insertmacro Locate<br />
<br />
Page instfiles<br />
<br />
Section<br />
    ${Locate} &quot;${ROOT}&quot; &quot;/L=FD /M=*.* /G=1 /B=0&quot; &quot;AddToList&quot;<br />
SectionEnd<br />
<br />
Function AddToList<br />
    MessageBox MB_OK &quot;$$R7=$R7&quot;<br />
    Push &quot;$R7&quot;<br />
    Push &quot;continue&quot; ### if I remove this line, it works fine<br />
FunctionEnd<br />
<br />
<br />
Is this an NSIS error or a problem with ${locate}?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">9th March 2006, 16:27</div></div><div class="posttext">You can not use NSIS stack in the callback function, because it is used by function. Only one push requered in the callback.<br />
<br />
P.S.<br />
You can call another function from the callback, on condition that this function don't change the stack after completion.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">9th March 2006, 19:42</div></div><div class="posttext">hmmm... I see.  I'll have to keep that in mind.  <br />
<br />
I didn't see this this info in the NSIS manuals.  Are you the one that manages those, or do I need to post a separate request on the NSIS sourceforge site?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">9th March 2006, 23:24</div></div><div class="posttext">*sigh* :( <br />
I may have opened a big can of worms with this.  In my example script above, I changed the sample script above to write the file names to a text file instead of pushing to the stack using the command FileWrite $myHandle &quot;$R7$\r$\n&quot;.  (my hope was to bypass the stack completely and then retrieve the values one at a time later.)  Unfortunately, I find that it didn't work, either. :cry: <br />
<br />
However, using a WriteIniStr command WriteIniStr &quot;$myFileName&quot; &quot;General&quot; &quot;$R7&quot; &quot;&quot; did work, so I guess I have a workaround.<br />
<br />
But, I'd still like to understand why the FileWrite did not work.  My only guess is that some NSIS functions (like FileWrite) must also use the NSIS stack.  Is this correct?  (If so, would perhaps using regular variables work better?)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">10th March 2006, 04:00</div></div><div class="posttext">See example in manual &quot;Write results to a text file&quot;<br />
<br />
My only guess is that some NSIS functions (like FileWrite) must also use the NSIS stack. Is this correct?FileOpen-FileWrite-FileClose don't use NSIS stack.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">10th March 2006, 14:37</div></div><div class="posttext">Thanks, Instructor.  As always, your suggestion worked perfectly!  <br />
(I guess I can just chalk this up as a bad day.) :weird:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ary Manzana</div><div class="date">22nd March 2006, 13:25</div></div><div class="posttext">Hi. I test this:<br />
<br />
${VersionCompare} &quot;2.3&quot; &quot;2.29&quot; $0<br />
<br />
And it tells me that $0 is 2. That means that 2.29 is a higher version than 2.3, which is wrong. Same goes with:<br />
<br />
${VersionCompare} &quot;2.29&quot; &quot;2.3&quot; $0<br />
<br />
it tells me that $0 is 1.<br />
<br />
I'll try to fix it, but I'm a newbie in NSIS...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ary Manzana</div><div class="date">22nd March 2006, 13:27</div></div><div class="posttext">Sorry, I had a lapsus there. Just ignore my last post. :-P</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">1st April 2006, 00:29</div></div><div class="posttext">GetOptions doesn't work correctly when it finds a URL because of the &quot;/&quot; in the URL value (example: /url=http://nsis.sf.net)<br />
<br />
Maybe a check can be added for &quot;//&quot; ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">1st April 2006, 04:40</div></div><div class="posttext">Use quotes /url=&quot;http://nsis.sf.net&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">1st April 2006, 05:19</div></div><div class="posttext">I have a situation where I don't have control over what is passed in, so I can't have quotes put around the value itself. I got everything working by using a different routine to get the value. It's no problem, probably a very uncommon situation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">22nd May 2006, 17:29</div></div><div class="posttext">Word Functions Header v3.3<br />
Text Functions Header v2.4<br />
File Functions Header v3.2<br />
<br />
Changes:<br />
<br />
1. &quot;GetFileAttributes&quot; v1.2<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Some corrections<br />
<br />
2. Prevent error in case of including headers several times.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">23rd September 2006, 07:20</div></div><div class="posttext">Word Functions Header v3.3<br />
Text Functions Header v2.4<br />
File Functions Header v3.3<br />
<br />
Changes:<br />
<br />
1. &quot;Locate&quot; v1.8<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Handles were not getting closed properly.<br />
<br />
2. &quot;GetSize&quot; v2.0<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Handles were not getting closed properly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">23rd September 2006, 08:23</div></div><div class="posttext">*zap* I was on an old page when I commented - d'oh!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbyron</div><div class="date">16th November 2008, 23:51</div></div><div class="posttext">Any chance to get the day and number of seconds returned from GetTime as a 0-padded string if it's less than 10?  In other words &quot;08&quot; instead of &quot;8&quot; for seconds and day-of-month?<br />
<br />
Thanks much.<br />
<br />
-DB</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Johnm312</div><div class="date">8th April 2009, 17:47</div></div><div class="posttext">Edit. nevermind. I found the readme and i overlooked something.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>