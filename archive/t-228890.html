<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Remove all files and directories except one, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Remove all files and directories except one NSIS Discussion" />
	
	<title> Remove all files and directories except one [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Remove all files and directories except one</div>
<hr />
<div class="pda"><a href="t-228890.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228890">Remove all files and directories except one</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ffletch2</div><div class="date">20th October 2005, 14:58</div></div><div class="posttext">In our installer, we install several files and several subdirectories with files in them.  I have been asked to make the uninstaller remove all directories and files except one specific subdirectory (let's call it dirA).  When a user then re-installs (either by uninstalling then installing OR by installing over), the desired behavior is, check the files in dirA and if a file that is being extracted from the installer already exists, it should not overwrite it.  If a file does not exist, it should be extracted into that directory.<br />
<br />
I have seen solutions elsewhere in this forum for recursively removing all files and for writing a file only if it doesn't already exist.  However, I haven't seen one that does both.  Anyone have a good way of doing this?<br />
<br />
I should also mention that the files that are in the installer could change regularly between builds.  In other words, I need a method that does not hardcode the file names in the installer source file.<br />
<br />
TIA for any ideas.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">20th October 2005, 16:48</div></div><div class="posttext">1. To uninstall all files except one subdir: use FindFirst, FindNext and FindClose (NSIS User Manual 4.9.5.9) for top dir and remove all files and folders except dirA (StrCmp). You can use both RMDir and Delete to every found name.<br />
2. SetOverwrite mode (Manual 4.8.2.8), example included.<br />
3. Use folder names or file name templates with * to install &quot;not hardcoded file names&quot; (see manual for File command).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th October 2005, 17:50</div></div><div class="posttext">http://nsis.sourceforge.net/wiki/Delete_dirs_/_files_in_a_directory_except_one_dir_/_file<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">20th October 2005, 19:10</div></div><div class="posttext">To Afrow UK: BTW 'find' function works fine with * instead of *.* :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>