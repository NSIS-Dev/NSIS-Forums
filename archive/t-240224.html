<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" User dialog / input from ini file, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  User dialog / input from ini file NSIS Discussion" />
	
	<title> User dialog / input from ini file [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  User dialog / input from ini file</div>
<hr />
<div class="pda"><a href="t-240224.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=240224">User dialog / input from ini file</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Karavirs</div><div class="date">8th March 2006, 01:41</div></div><div class="posttext">I've run into writers block and can't for the life of me figure out how to do this.<br />
<br />
All I want to do is:<br />
1)Show the user the various versions available in the attached ini file.<br />
2)Get their selection<br />
3)Download their selection (I know how to do this)<br />
4)Execute the new installer (I know how to do this)<br />
<br />
ini looks like this<br />
[Auctioneer]<br />
ver=3.2.0.555<br />
[Unstable]<br />
ver=3.2.0.0734<br />
url=http://auctioneeraddon.com/dl/AuctioneerComplete/auctioneerpack-3.2.0.0734.exe<br />
[Alpha]<br />
ver=3.2.0.0729<br />
url=http://auctioneeraddon.com/dl/AuctioneerComplete/auctioneerpack-3.2.0.0729.exe<br />
[Beta]<br />
ver=3.2.0.671<br />
url=http://auctioneeraddon.com/dl/AuctioneerComplete/auctioneerpack-3.2.0.0671.exe<br />
[Release]<br />
ver=3.2.0.0620<br />
url=http://auctioneeraddon.com/dl/AuctioneerComplete/auctioneerpack-3.2.0.0620.exe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dandaman32</div><div class="date">8th March 2006, 02:11</div></div><div class="posttext">Page custom UpgradeMe GetReturn<br />
<br />
Function UpgadeMe<br />
  ;save the current ini file in case download fails<br />
  Rename $INSTDIR\Interface\AddOns\Auctioneer\Auctioneer.ini $INSTDIR\Interface\AddOns\Auctioneer\Auctioneer.ini.old<br />
  ;get the latest auctioneer.ini file<br />
  inetc::get /SILENT &quot;&quot; &quot;http://auctioneeraddon.com/dl/AuctioneerComplete/Auctineer.ini&quot; &quot;$INSTDIR\Interface\AddOns\Auctioneer\Auctioneer.ini&quot; /END<br />
  pop $R0<br />
<br />
  StrCmp $R0 &quot;OK&quot; gotnewver<br />
  ;download failed so retreive old file<br />
  Rename $INSTDIR\Interface\AddOns\Auctioneer\Auctioneer.ini.old $INSTDIR\Interface\AddOns\Auctioneer\Auctioneer.ini<br />
gotnewver:<br />
  ; At this point, we have a file containing version info.<br />
  WriteINIStr &quot;$PLUGINSDIR\upgrade.ini&quot; &quot;Settings&quot; &quot;NumFields&quot; 6 ; Change this to the number of fields<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 1&quot; Type Label<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 1&quot; Top 0<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 1&quot; Left 0<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 1&quot; Right -1<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 1&quot; Bottom 10<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 1&quot; Text &quot;Which version of $(^Name) do you want to use?&quot;<br />
  ReadINIStr $0 $INSTDIR\Interface\AddOns\Auctioneer\Auctioneer.ini &quot;Auctioneer&quot; ver<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 2&quot; Type RadioButton<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 2&quot; Top 12<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 2&quot; Left 6<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 2&quot; Right -1<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 2&quot; Bottom 22<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 2&quot; Text &quot;The current version ($0)&quot;<br />
  ReadINIStr $0 $INSTDIR\Interface\AddOns\Auctioneer\Auctioneer.ini &quot;Unstable&quot; ver<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 3&quot; Type RadioButton<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 3&quot; Top 24<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 3&quot; Left 6<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 3&quot; Right -1<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 3&quot; Bottom 34<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 3&quot; Text &quot;Unstable release ($0)&quot;<br />
  ReadINIStr $0 $INSTDIR\Interface\AddOns\Auctioneer\Auctioneer.ini &quot;Alpha&quot; ver<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 4&quot; Type RadioButton<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 4&quot; Top 36<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 4&quot; Left 6<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 4&quot; Right -1<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 4&quot; Bottom 46<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 4&quot; Text &quot;Alpha release ($0)&quot;<br />
  ReadINIStr $0 $INSTDIR\Interface\AddOns\Auctioneer\Auctioneer.ini &quot;Beta&quot; ver<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 5&quot; Type RadioButton<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 5&quot; Top 48<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 5&quot; Left 6<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 5&quot; Right -1<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 5&quot; Bottom 58<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 5&quot; Text &quot;Beta release ($0)&quot;<br />
  ReadINIStr $0 $INSTDIR\Interface\AddOns\Auctioneer\Auctioneer.ini &quot;Release&quot; ver<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 6&quot; Type RadioButton<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 6&quot; Top 60<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 6&quot; Left 6<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 6&quot; Right -1<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 6&quot; Bottom 70<br />
  WriteINIStr $PLUGINSDIR\upgrade.ini &quot;Field 6&quot; Text &quot;Stable release ($0)&quot;<br />
  InstallOptions::initDialog /NOUNLOAD &quot;$PLUGINSDIR\upgrade.ini&quot;<br />
  Pop $1<br />
  GetDlgItem $0 $1 1200<br />
  CreateFont $2 &quot;Tahoma&quot; 8 700<br />
  SendMessage $0 0x30 $2 0 ; just for a visual tweak ;)<br />
  InstallOptions::show<br />
FunctionEnd<br />
<br />
Function GetReturn ; called right after the user clicks &quot;next&quot; on the custom page<br />
  ReadINIStr $0 $PLUGINSDIR\Upgrade.ini &quot;Field 2&quot; State<br />
    StrCmp $0 1 Current<br />
  ReadINIStr $0 $PLUGINSDIR\Upgrade.ini &quot;Field 3&quot; State<br />
    StrCmp $0 1 Unstable<br />
  ReadINIStr $0 $PLUGINSDIR\Upgrade.ini &quot;Field 4&quot; State<br />
    StrCmp $0 1 Alpha<br />
  ReadINIStr $0 $PLUGINSDIR\Upgrade.ini &quot;Field 5&quot; State<br />
    StrCmp $0 1 Beta<br />
  ReadINIStr $0 $PLUGINSDIR\Upgrade.ini &quot;Field 6&quot; State<br />
    StrCmp $0 1 Latest<br />
  ; User did not select an option<br />
  MessageBox MB_OK|MB_ICONEXCLAMATION &quot;Please select an option.&quot;<br />
    Abort ; Returns to the page<br />
  Unstable:<br />
    ReadINIStr $0 $INSTDIR\Interface\AddOns\Auctioneer\Auctioneer.ini Unstable url<br />
    Goto get<br />
  Alpha:<br />
    ReadINIStr $0 $INSTDIR\Interface\AddOns\Auctioneer\Auctioneer.ini Alpha url<br />
    Goto get<br />
    Beta:<br />
    ReadINIStr $0 $INSTDIR\Interface\AddOns\Auctioneer\Auctioneer.ini Beta url<br />
    Goto get<br />
    Release:<br />
    ReadINIStr $0 $INSTDIR\Interface\AddOns\Auctioneer\Auctioneer.ini Release url<br />
  get:<br />
    ; At this point, $0 contains the URL of the file to download.<br />
    ; You can use your downloader plugin to get the file<br />
  Current:<br />
FunctionEnd<br />
<br />
<br />
:D<br />
<br />
NOTE: You may have meant:<br />
  inetc::get /SILENT &quot;&quot; &quot;http://auctioneeraddon.com/dl/AuctioneerComplete/Auctioneer.ini&quot; &quot;$INSTDIR\Interface\AddOns\Auctioneer\Auctioneer.ini&quot; /END in the line at the top?<br />
<br />
-dandaman32</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>