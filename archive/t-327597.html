<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Running a hidden app on finish, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Running a hidden app on finish NSIS Discussion" />
	
	<title> Running a hidden app on finish [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Running a hidden app on finish</div>
<hr />
<div class="pda"><a href="t-327597.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=327597">Running a hidden app on finish</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Collector9999</div><div class="date">20th February 2011, 01:01</div></div><div class="posttext">I have a hidden app that does nothing more than call DOSBox with the &quot;-conf&quot; parameter. This launcher works fine when executing on its own but will not even start when called from the run of the MUI2 finish page. Its process never shows in the task manager. It also works from the run of the finish page with no changes to the script if I compile the launcher to run unhidden. <br />
<br />
Obviously, there are a number of workarounds, but I would like to know how to use a hidden for the finish run or at least why it does not work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jiake</div><div class="date">20th February 2011, 13:41</div></div><div class="posttext">If you want to run an application with arguments, you must define like this:<br />
!define MUI_FINISHPAGE_RUN &quot;$INSTDIR\YourApp.exe&quot;<br />
!define MUI_FINISHPAGE_RUN_PARAMETERS &quot;-conf&quot;<br />
But not:<br />
!define MUI_FINISHPAGE_RUN &quot;$INSTDIR\YourApp.exe -conf&quot;<br />
<br />
If the process is always running, maybe it is a service. You may try the Services (http://nsis.sourceforge.net/Services_plug-in), SimpleSC (http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin) or NsSCM (http://nsis.sourceforge.net/NsSCM_plug-in) plugin.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Collector9999</div><div class="date">21st February 2011, 04:47</div></div><div class="posttext">No, the NSIS script is right. I have been writing NSIS installers for years now. The parameter is passed by the EXE to be run after the installer finishes, and not from the NSIS script. It is the EXE itself that is set to run hidden, not by NSIS. As I said, If I recompile the application (not the installer) to run not hidden it works. If I compile it to run as a hidden EXE, the process does not even start. It does work independent of the installer as well as from OnInstSuccess.<br />
<br />
The question remains, why does the exe executed by the finish page run start if it compiled to run not hidden, but does not start when compiled to run hidden. As I had first posted, there are a number workarounds that will do what I want, but I just want to know why a hidden app will not start from the finish page run.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jiake</div><div class="date">21st February 2011, 12:54</div></div><div class="posttext">Run it in a Section, use IfSilent to determine wether to install.<br />
Section -Hidden<br />
  IfSilent 0 +2<br />
  Exec '&quot;$PATH\YouApp.exe&quot; -args'<br />
SectionEnd<br />
Define a function to replace running default application.<br />
!define MUI_FINISHPAGE_RUN<br />
!define MUI_FINISHPAGE_RUN_TEXT &quot;Run ApplicationName&quot;<br />
!define MUI_FINISHPAGE_RUN_FUNCTION FuncName<br />
Function FuncName<br />
  IfSilent +2<br />
  Exec '&quot;$PATH\YouApp.exe&quot; -args'<br />
FunctionEnd<br />
Now you installer would run it on both mormal and silent mode.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">21st February 2011, 15:08</div></div><div class="posttext">Your explanation is making it sound too mysterious. NSIS doesn't know if you compiled your program to appear or remain hidden, so why (how) would it do something different for the two versions of the program? The finish page Run functions work fine for the programs I run that don't have a UI. There must be something failing in the hidden version of your program.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Highcoder</div><div class="date">21st February 2011, 15:18</div></div><div class="posttext">oO<br />
<br />
if you run your installer silent you have no Finish-page. So you can´t execute something on finishpage in silent mode because it doesn´t appear.<br />
<br />
So as jiake wrote you have to modify your script. For GUI install you can leave the execution on the finishpage. But for silent mode you have to put it in a section or in .OnInstSuccess with &quot;IfSilent&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Collector9999</div><div class="date">21st February 2011, 19:57</div></div><div class="posttext">There is nothing hidden in the installer and it is not set to run silent. The only thing that is hidden is completely independent of NSIS. It is a file that gets installed by the installer that has been compiled completely separate from NSIS to run silent. <br />
<br />
As I said, if that file is compiled to run not hidden the NSIS/MUI2 run on finish works. When it compiled to run hidden the NSIS/MUI2 run on finish does not work with no changes to the NSIS script. The process never starts. Additionally, the file works as expected outside of the installer.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>