<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Registry reading problems..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Registry reading problems... NSIS Discussion" />
	
	<title> Registry reading problems... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Registry reading problems...</div>
<hr />
<div class="pda"><a href="t-51125.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=51125">Registry reading problems...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Aarif</div><div class="date">29th May 2001, 21:28</div></div><div class="posttext">Hi,<br />
<br />
Does anyone know why this doesn't work:<br />
<br />
ClearErrors<br />
ReadRegStr $1 HKLM &quot;SECURITY&quot; &quot;&quot;<br />
IfErrors lbl_err lbl_ok<br />
<br />
lbl_err:<br />
  MessageBox MB_ICONEXCLAMATION &quot;ERROR: [$1]&quot;<br />
  GoTo lbl_end<br />
<br />
lbl_ok:<br />
  MessageBox MB_ICONEXCLAMATION &quot;NO ERROR: [$1]&quot;<br />
  GoTo lbl_end<br />
<br />
lbl_end:<br />
<br />
All I want to do is to check if the &quot;SECURITY&quot; key (in this case) exists.  The result I get is &quot;ERROR: []&quot;.  I know that there are no keys below &quot;SECURITY&quot;.<br />
<br />
Thanks,<br />
Aarif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yazno</div><div class="date">29th May 2001, 22:35</div></div><div class="posttext">hi,<br />
<br />
when an error occurs, the string in the variable will always return an empty string, that's why you get &quot;ERROR[]&quot;.<br />
<br />
try it like that:<br />
<br />
ClearErrors <br />
ReadRegStr $1 HKLM &quot;SECURITY&quot; &quot;&quot; <br />
IfErrors lbl_err lbl_ok <br />
<br />
lbl_err: <br />
MessageBox MB_ICONEXCLAMATION &quot;ERROR!&quot; <br />
GoTo lbl_end <br />
<br />
lbl_ok: <br />
StrCmp $1 '' lbl_error<br />
MessageBox MB_ICONEXCLAMATION &quot;NO ERROR: [$1]&quot; <br />
<br />
lbl_end: <br />
<br />
cu yzo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Aarif</div><div class="date">30th May 2001, 00:59</div></div><div class="posttext">I understand that.  My problem is that the key should be there, so I shouldn't get an error.  It should say &quot;NO ERROR []&quot;.<br />
<br />
Aarif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Edgewize</div><div class="date">30th May 2001, 01:35</div></div><div class="posttext">The problem is that ReadRegStr expects a data entry name, and returns the value.  A registry key (&quot;SECURITY&quot; in this case) does not have any data associated directly with it; it is like trying to open a directory as if it were a file.  An error will always be returned.<br />
<br />
There is currently no way for NSIS to find if a registry key exists, short of trying to read a name/value pair from inside that key.  Since there is no data stored in the SECURITY key, there is no way to detect it currently in NSIS.<br />
<br />
You can suggest such a function to justin (email him, I think its justin@winamp.com but check before you send), and he may implement it in the next release.  Or else install the source code and make the changes yourself :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Aarif</div><div class="date">30th May 2001, 03:32</div></div><div class="posttext">The 4th parameter I passed to the ReadRegStr command was a &quot;&quot;, because I wanted to get the value of the &quot;(Default)&quot; entry.  The default entry exists for all registry keys and may sometimes have a value.  If you look at the registry using regedit, you will see a default entry for all keys.  If passing an empty string as the 4th parameter is not the way to get this value, then how do I do it?<br />
<br />
Aarif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yazno</div><div class="date">30th May 2001, 06:21</div></div><div class="posttext">hi,<br />
<br />
Aarif: the way you did it is correct!<br />
<br />
it reads the default value of the registry key<br />
(,and also checks the existense of the key .. sure, if an error occurs the key doesn't exist)<br />
<br />
and here is your problem!<br />
<br />
the key HKLM SECURITY doesn't exist, as it is case-sensitive and should read &quot;Security&quot;<br />
<br />
try it like that and it will work!<br />
<br />
cu yzo</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>