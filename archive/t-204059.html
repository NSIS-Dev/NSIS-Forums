<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to clear temp  folder?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to clear temp  folder? NSIS Discussion" />
	
	<title> How to clear temp  folder? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to clear temp  folder?</div>
<hr />
<div class="pda"><a href="t-204059.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=204059">How to clear temp  folder?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">thico_</div><div class="date">6th January 2005, 12:37</div></div><div class="posttext">My installer extracts silence.mp3 to the $TEMP and I have one problem with it. If any user will click Install, temp folder is cleared, cause there's following code in Section/SectionEnd:<br />
[...]<br />
Delete &quot;$TEMP\silence.mp3&quot;<br />
[...]<br />
But what if user will abort the installation? silence.mp3 won't be erased from the temp dir :/ Any idea how to delete it? :/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">6th January 2005, 12:39</div></div><div class="posttext">You could use the $PLUGINSDIR instead, far as I know that's deleted on cancel as well.<br />
<br />
Otherwise, just add Delete &quot;$TEMP\silence.mp3&quot; into your .onUserAbort function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thico_</div><div class="date">6th January 2005, 12:43</div></div><div class="posttext">Thank you very much! I'll check both options :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thico_</div><div class="date">6th January 2005, 12:45</div></div><div class="posttext">Oh! One more question! Where $PLUGINSDIR stores temporary files?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saivert</div><div class="date">6th January 2005, 13:31</div></div><div class="posttext">$PLUGINSDIR is a variable that is assigned on runtime. It will point to a directory under $TEMP, &quot;$TEMP\nst023.tmp\&quot; is a good example. The installer will delete all files in this directory and then remove the directory when the installer quits. To set this up, simply call InitPluginsDir in the installer's .onInit callback function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">6th January 2005, 13:52</div></div><div class="posttext">You can just MessageBox MB_OK &quot;$PLUGINSDIR&quot; to see it, it'll change each time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thico_</div><div class="date">6th January 2005, 14:06</div></div><div class="posttext">Thanks!!!<br />
<br />
I have a new problem :(<br />
When I'm using $PLUGINSDIR silent.mp3 is removed but nsis temp folders containing files such as nsis logo, etc (which are created in temp dir) are not erased! And when I want to use...<br />
<br />
Function .onUserAbort<br />
Delete &quot;$TEMP\silence.mp3&quot;<br />
FunctionEnd<br />
<br />
...I got an error:<br />
Function: &quot;.onUserAbort&quot;<br />
Error: Function named &quot;.onUserAbort&quot; already exists.<br />
<br />
But there *isnt* already existing function with such name! What's wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">6th January 2005, 14:12</div></div><div class="posttext">You're using the MUI. You need to err do something clever.<br />
<br />
*Looks it up*<br />
<br />
Yes, use a custom function. MUI (annoyingly :)) defines its own .onUserAbort, so you have to define your own function which MUI somehow mashes into the original. You do this:<br />
<br />
!define MUI_CUSTOMFUNCTION_ABORT &quot;customAbortFunction&quot;<br />
<br />
Function &quot;customAbortFunction&quot;<br />
  Delete &quot;$TEMP\silence.mp3&quot;<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thico_</div><div class="date">6th January 2005, 14:23</div></div><div class="posttext">:D<br />
I really appreciate it, thanks!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>