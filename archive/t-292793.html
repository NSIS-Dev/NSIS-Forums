<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" filling passwords needed in a silent installation, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  filling passwords needed in a silent installation NSIS Discussion" />
	
	<title> filling passwords needed in a silent installation [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  filling passwords needed in a silent installation</div>
<hr />
<div class="pda"><a href="t-292793.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=292793">filling passwords needed in a silent installation</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ebr3dd</div><div class="date">6th June 2008, 05:15</div></div><div class="posttext">Hi all, I have read all of the other posts and could not find any information regarding this subject. <br />
<br />
Will I be able to pass information to a silent installation... Lets say I am trying to do a &quot;silent&quot; install of a database that requires information such as username and password, etc. How can automaticly fill in this information?<br />
<br />
Any help would be greatly appreciated. I am really interested in getting this figured out, so any links to documentation or ideas on how to accomplish this, please. Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">6th June 2008, 13:48</div></div><div class="posttext">Include a default password and username. If the installer is silent then install it using that</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ebr3dd</div><div class="date">6th June 2008, 15:51</div></div><div class="posttext">hi, thanks for such a fast response. I am not to sure what you mean by this , where do I provide this default password , is it some variable made in the script and then passed as a parameter? If you could explain a little I would seriosly appreciate. Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">6th June 2008, 16:15</div></div><div class="posttext">!define password &quot;1234&quot;<br />
!define username &quot;abc&quot;<br />
<br />
That will define the default username &amp; password<br />
<br />
<br />
IfSilent silent not<br />
<br />
not:<br />
;all normal stuff<br />
goto done<br />
<br />
silent:<br />
;all silent stuff<br />
<br />
done:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glenncarr</div><div class="date">6th June 2008, 17:04</div></div><div class="posttext">Take a look at the GetOptions macro defined in FileFunc.nsh.  It allows command line options like /RESPONSE=responsefile.ini.  If you format it as an .ini file, you can use the ReadINIStr commands to pull information out of it, such as usernames and passwords.<br />
<br />
In our case we simply supply a sample response.ini file, so that our user can create their own to do silent installs like this:<br />
<br />
OurSetup.exe /S /RESPONSE=responses.ini<br />
<br />
...where responses.ini might contain:<br />
<br />
; Global installation options<br />
[Options]<br />
InstallDir=C:\Program Files\MyApp<br />
Password=password<br />
<br />
Here's some sample script for getting the values:<br />
<br />
!include FileFunc.nsh<br />
<br />
...<br />
<br />
!insertmacro GetOptions<br />
<br />
...<br />
<br />
StrCpy $1 &quot;&quot;<br />
${GetOptions} $0 &quot;/RESPONSE=&quot; $1<br />
<br />
IfErrors 0 RespExists<br />
  DetailsLogSet on<br />
  DetailPrint &quot;*** No response file was specified for silent installation, setup will abort.&quot;<br />
  Abort<br />
<br />
RespExists:<br />
  IfFileExists $1 RespFile<br />
    DetailsLogSet on<br />
    DetailPrint &quot;*** Response file specified was not found for silent installation, setup will abort.&quot;<br />
    Abort<br />
<br />
RespFile:<br />
  StrCpy $RespFile $1<br />
<br />
  ReadINIStr $0 $RespFile &quot;Options&quot; &quot;InstallDir&quot;<br />
  StrCmp $0 &quot;&quot; NoDir<br />
  StrCpy $INSTDIR $0<br />
<br />
NoDir:<br />
  DetailsLogSet on<br />
  DetailPrint &quot;Using response file $RespFile&quot;<br />
<br />
<br />
(You'll need to remove or replace the DetailsLogSet unless you use the build I posted about earlier, or replace it with LogSet and use LogText instead of DetailPrint.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lucalla2</div><div class="date">6th June 2008, 21:10</div></div><div class="posttext">I am very new to this and have done a fare bit of reading just to get where I am.<br />
I have a similar type of question as the OP.<br />
I want to prompt for a password and then use the password later on. In my code below $Password has a value but not what was entered. What am I missing?<br />
<br />
Additionally, the second last line (ExecDos::exec &quot;%WINDIR%\system32\odbcad32.exe&quot;) simply does not execute.<br />
<br />
TIA.<br />
<br />
!include nsDialogs.nsh<br />
!include LogicLib.nsh<br />
Var Label<br />
Var Dialog<br />
Var Username<br />
Var Password<br />
<br />
Function pw<br />
System::Call &quot;advapi32::GetUserName(t .r0, *i ${NSIS_MAX_STRLEN} r1) i.r2&quot;<br />
Pop $0<br />
Strcpy $Username $0<br />
<br />
	nsDialogs::Create /NOUNLOAD 1018<br />
	Pop $Dialog<br />
	<br />
	${NSD_CreateLabel} 0 0 100% 36u &quot;Enter login password for user: $Username. This will be used to schedule eTruancy Data Collector V3 to match your production schedule&quot;<br />
	Pop $Label<br />
<br />
	${NSD_CreatePassword} 0 40u 100% 12u &quot;&quot;<br />
	Pop $Password<br />
<br />
	<br />
nsDialogs::Show<br />
<br />
;The following line simply does not pop up the ODBC dialog box. Why?<br />
ExecDos::exec &quot;%WINDIR%\system32\odbcad32.exe&quot;<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lucalla2</div><div class="date">9th June 2008, 15:10</div></div><div class="posttext">Anyone?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lucalla2</div><div class="date">9th June 2008, 17:03</div></div><div class="posttext">In case any other newbie needs help...it may not be elegant but it works.<br />
<br />
!include nsDialogs.nsh<br />
!include LogicLib.nsh<br />
Var Label<br />
Var Dialog<br />
Var Username<br />
Var Pw<br />
Var Password<br />
<br />
Function pw<br />
System::Call &quot;advapi32::GetUserName(t .r0, *i ${NSIS_MAX_STRLEN} r1) i.r2&quot;<br />
Pop $0<br />
Strcpy $Username $0<br />
<br />
	nsDialogs::Create /NOUNLOAD 1018<br />
	Pop $Dialog<br />
	<br />
	${NSD_CreateLabel} 0 0 100% 36u &quot;Enter login password for user: $Username. This will be used to schedule Data Collector V3 to match your production schedule&quot;<br />
	Pop $Label<br />
<br />
	${NSD_CreatePassword} 0 40u 100% 12u &quot;&quot;<br />
       Pop $PW<br />
       <br />
GetFunctionAddress $0 EnterPassword<br />
nsDialogs::OnChange /NOUNLOAD  $PW $0<br />
Call EnterPassword<br />
<br />
nsDialogs::Show<br />
strCpy $Password $R0<br />
<br />
;Still can't get the following line to run<br />
ExecDos::exec &quot;%WINDIR%\system32\odbcad32.exe&quot;<br />
FunctionEnd<br />
<br />
Function EnterPassword<br />
Pop $0 # HWND<br />
${NSD_GetText} $PW $R0<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">9th June 2008, 20:18</div></div><div class="posttext">hmmm...<br />
In your onChange callback, there should be no need to use the CALL command.  Try this instead:<br />
<br />
${NSD_CreatePassword} 0 40u 100% 12u &quot;&quot;<br />
Pop $PW<br />
<br />
${NSD_OnChange} $PW EnterPassword<br />
<br />
<br />
(An alternative to this would be to just add the EnterPassword code as a page leave function instead of an onChange function.  The advantage is that the function would only be called once after the entire password is entered instead of being called with every change.)<br />
 <br />
Also:<br />
<br />
;The following line simply does not pop up the ODBC dialog box. Why?<br />
ExecDos::exec &quot;%WINDIR%\system32\odbcad32.exe&quot;<br />
<br />
The page show function is basically done once you call nsDialog::Show.  So it would probably work better if add this code to the page's leave function or in a section depending on what your needs are.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>