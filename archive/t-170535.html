<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with CreateMutexA and detecting an application running, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with CreateMutexA and detecting an application running NSIS Discussion" />
	
	<title> Problem with CreateMutexA and detecting an application running [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with CreateMutexA and detecting an application running</div>
<hr />
<div class="pda"><a href="t-170535.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=170535">Problem with CreateMutexA and detecting an application running</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">lyonmsu</div><div class="date">22nd February 2004, 23:00</div></div><div class="posttext">I have searched most of the messages that I could find referencing the createmutexa function for detecting if an application is running (as well as the FindWindow versions) but I could not seem to resolve this issue.<br />
<br />
What I want is to detect 2 instances:<br />
<br />
1. Whether the installer is running<br />
2. Whther the application I am installing is actually running.<br />
<br />
I can use the one instance already supplied on the FAQ for detecting the installer without issue.  When attempting to use the CreateMutexA again It detects the application is running and posts the Retry Cancel options but the Retry always believes the actual application is still running even when it has been killed?!?  It is in a loop somehow with the again: label before the CreatMutexA command is executed again apparently and I do not know why?<br />
<br />
Here is my Code Script:<br />
<br />
<br />
Function .onInit<br />
<br />
System::Call 'kernel32::CreateMutexA(i 0, i 0, t &quot;${PRODUCT_NAME} Installer&quot;) i .r1 ?e'<br />
<br />
  Pop $R0<br />
<br />
  StrCmp $R0 0 +3<br />
    MessageBox MB_OK &quot;${PRODUCT_NAME} installer is already running&quot;<br />
    Abort<br />
<br />
again:<br />
System::Call 'kernel32::CreateMutexA(i 0, i 0, t &quot;${PRODUCT_NAME}&quot;) i .r1 ?e'<br />
<br />
<br />
  Pop $R1<br />
<br />
  StrCmp $R1 0 +3<br />
    MessageBox MB_RETRYCANCEL|MB_ICONSTOP &quot;${PRODUCT_NAME} must not be running in order to proceeed with installation&quot; IDRETRY again IDCANCEL <br />
        Abort<br />
<br />
FunctionEnd<br />
 <br />
<br />
If someone can point out what I am doing wrong or how I can do it differently (other than FindWindow since window name has not been officially established as yet&quot;) I would appreciate the help.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">23rd February 2004, 03:38</div></div><div class="posttext">Maybe I'm wrong but the problem with your code is that plugins doesn't allow goto statments, in your case again: for example.<br />
And, see this:<br />
<br />
System::Call 'kernel32::CreateMutexA(i 0, i 0, t &quot;${PRODUCT_NAME} Installer&quot;) i .r1' <br />
Pop $R0<br />
<br />
you are returning number, so you might use IntCmp instead.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">23rd February 2004, 11:12</div></div><div class="posttext">Lobo Lunar, that is not true. You can use Goto everywhere.<br />
<br />
All variables are strings. For a simple comparation you can use StrCmp, that makes no difference.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">23rd February 2004, 15:33</div></div><div class="posttext">I guess I keep the old fashion way :)<br />
Thanks! for the update :D</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>