<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" HTTPHelper plugin (or, how to send an HTTP Request?), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  HTTPHelper plugin (or, how to send an HTTP Request?) NSIS Discussion" />
	
	<title> HTTPHelper plugin (or, how to send an HTTP Request?) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  HTTPHelper plugin (or, how to send an HTTP Request?)</div>
<hr />
<div class="pda"><a href="t-356584.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=356584">HTTPHelper plugin (or, how to send an HTTP Request?)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">BubbaBubbs</div><div class="date">1st March 2013, 21:21</div></div><div class="posttext">Does anyone know the status of the HTTPHelper plugin for NSIS?<br />
<br />
Several months ago, I downloaded HTTPHelper.dll. Unfortunately, I forgot where I downloaded it from. I am now trying to Google it, but cannot find any mention of it. I would like to know the following:<br />
<br />
1.	Has HTTPHelper been maintained? Who's the author?<br />
2.	Where can I download it from?<br />
3.	Documentation<br />
4.	Is the source code available?<br />
<br />
I ran 'strings' on HTTPHelper.dll, and found &quot;Copyright (C) 1999-2012 Mark Russinovich&quot;, but am not sure if he is, indeed, the author. I pinged Mark at http://blogs.technet.com/b/markrussinovich/contact.aspx, but have not heard back.<br />
<br />
Here's what I am struggling with:<br />
In my NSIS installer, I am using<br />
<br />
HTTPHelper::SendHttpRequest &lt;URL&gt;<br />
<br />
to send simple InstallerStart and InstallerFinished status logs to my server. I do not need to process the HTTP response. The important thing, however, is that the User-Agent header of the HTTP request be the same as that of IE that's installed on the machine (for technical and business reasons.)<br />
This works fine on Windows XP, Vista, 7, and IE 7-through-9.<br />
On Win8/IE 10, however, the User-Agent for the above HTTPHelper::SendHttpRequest is:<br />
<br />
Mozilla/5.0 (compatible; MSIE 9.0)<br />
<br />
even though if I'm browsing using IE it correctly sets<br />
<br />
Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)<br />
<br />
This is probably because the various User-Agent string seem to be hardcoded â€“ &quot;strings HTTPHelper.dll&quot; shows:<br />
<br />
Mozilla/4.0 (compatible; MSIE 6.0)<br />
Mozilla/4.0 (compatible; MSIE 7.0)<br />
Mozilla/4.0 (compatible; MSIE 8.0)<br />
Mozilla/5.0 (compatible; MSIE 9.0)<br />
<br />
I am hoping that the up-to-date version of HTTPHelper would correctly set User-Agent to MSIE 10.0. Or, if I could get a hold of the source code maybe I could fix it and recompile it.<br />
<br />
Also, I doubt there is a way to programmatically set/force the User-Agent header because the only three exported functions of HTTPHelper.dll are SendHttpRequest, OpenFirefox, OpenInternetExplorer. I have tried calling OpenInternetExplorer [&lt;URL&gt;] hoping that User-Agent would be correctly set if I sent by HTTP request by launching IE. But I can't get OpenInternetExplorer (or OpenFirefox) to work. I probably got the syntax wrong but, again, I don't have the documentation.<br />
<br />
Does anyone know if there is another NSIS plugin that would allow me to accomplish the goal?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd March 2013, 07:29</div></div><div class="posttext">I have never before heard of this plug-in. I had no idea Mark Russinovich even uses NSIS. It seems like you're out of luck though, as Microsoft hired him to hide most of his work on the Windows internals. I'm not sure why that would include HTTPRequest though...<br />
<br />
You can do this manually with InetC and the /USERAGENT flag.<br />
<br />
http://nsis.sourceforge.net/Inetc_plug-in</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>