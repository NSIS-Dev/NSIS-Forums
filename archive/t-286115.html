<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Unregistering library, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Unregistering library NSIS Discussion" />
	
	<title> Unregistering library [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Unregistering library</div>
<hr />
<div class="pda"><a href="t-286115.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=286115">Unregistering library</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Pawel</div><div class="date">1st February 2008, 18:37</div></div><div class="posttext">Hello,<br />
I use this command in my script:<br />
<br />
;Register a DLL	 <br />
  RegDLL &quot;$INSTDIR\\PLUGINS\\Library\\library.dll&quot;<br />
<br />
This command registers a dll file in Windows system. In uninstaller I have to unregister this library, so I use:<br />
UnregDLL &quot;$INSTDIR\\PLUGINS\\Library\\library.dll&quot;<br />
<br />
Library is unregistering, but I don't know why, NSIS uninstaller can't delete this library and folder where it is stored. What I have to do else, to delete all files and folders after unregistering library?<br />
<br />
Regards,<br />
Pawel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st February 2008, 18:47</div></div><div class="posttext">Is it COM? If so, use CoFreeUnusedLibraries before trying to delete it:System::Call 'Ole32::CoFreeUnusedLibraries()'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pawel</div><div class="date">18th February 2008, 14:45</div></div><div class="posttext">Originally posted by kichik <br />
Is it COM? If so, use CoFreeUnusedLibraries before trying to delete it:System::Call 'Ole32::CoFreeUnusedLibraries()'  <br />
<br />
Hello again,<br />
I have tested this many times, but unfortunately it doeasn't work. My dll almost always<br />
stay in the folder and NSIS can't remove it. I want to remove it without restarting system.<br />
<br />
My dll is a simple dll that adds to windows context menu a few entries, like this<br />
(after clik right mouse button on folder or file):<br />
<br />
Name of my program --&gt; Edit<br />
		       Open<br />
<br />
This dll is unregistering correctly, but it can't be removed!<br />
Is it possible to do it without restarting system?<br />
Thanks for any help,<br />
-Pawel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">18th February 2008, 16:56</div></div><div class="posttext">Because you added it to the context menu, Windows Explorer is using the dll. Most other applications that do that tell you you have to reboot the system to remove it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">29th February 2008, 10:30</div></div><div class="posttext">The shell is just a process that can be stopped and restarted. (e.g. kill explorer.exe) then restart after the DLL is successfully deleted. I do not state you Should do it this way, only you COULD do it this way. You know we all hate reboots...<br />
<br />
TIP:<br />
Try to use &quot;!insertmacro InstallLib ...&quot; not REGDLL anymore, it is obsolete</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">29th February 2008, 10:50</div></div><div class="posttext">or if you feel like getting dirty (but not killing explorer.exe), enum all processes and for every process that has your module loaded, inject a special dll (well, you would have to create it) into that process (it should just call CoFreeUnusedLibraries and unload)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>