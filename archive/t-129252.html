<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Help on CustomPage(s) in general, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Help on CustomPage(s) in general NSIS Discussion" />
	
	<title> Help on CustomPage(s) in general [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Help on CustomPage(s) in general</div>
<hr />
<div class="pda"><a href="t-129252.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=129252">Help on CustomPage(s) in general</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Mosestycoon</div><div class="date">21st March 2003, 16:14</div></div><div class="posttext">Moin, moin<br />
<br />
I have a simple request:<br />
<br />
would it be possible to integrate somemore CustomPage examples within on of the next releases?<br />
<br />
I tried the one packed in examples-dir, but really I am a '@ยง%6$#*'-user and I can't get it together to fit my needs.<br />
<br />
What I want is a CustomPage which takes the input from a defined field. The input should than be taken to search and replace in a text file. Also to start the application as service or not (e.g. a listbox) is one of the features I need.<br />
<br />
Would be very, very &quot;geil&quot; if sombody could screw some more examples.<br />
<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">21st March 2003, 19:18</div></div><div class="posttext">Are you using the Modern UI?<br />
<br />
The Modern UI InstallOptions example (InstallOptions is the plugin for custom pages) shows how to get the input, it displays a messagebox when a checkbox has been checked.<br />
<br />
The test.nsi script in Contrib\InstallOptions is an example of InstallOptions and the Classic UI, it also gets input from the page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mosestycoon</div><div class="date">22nd March 2003, 14:06</div></div><div class="posttext">Thx for reply Joost.<br />
<br />
I am using MUI. I already compiled the InstallOptions.nsi, but it's not really that big example. I thought it might be useful, if a more representative example would be integrated. (Really I could need it ;-) )<br />
<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">23rd March 2003, 11:17</div></div><div class="posttext">Can you please tell exactly what your problem is? The example reads a value from the file, you only have to change the field number and you can use the value.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mosestycoon</div><div class="date">23rd March 2003, 12:03</div></div><div class="posttext">Ok Joost,<br />
<br />
here we go. In the attached PNG you can see a custompage as it should be displayed . I integrated three radioButtons and everyting works fine (if one is checked, the other goes unchecked)<br />
<br />
The (wanted) mechanism:<br />
+ Possibility number 1:<br />
By checking the RadioButton, a different file is installed and this file is dynamically modified with 'search and replace function' later on. So the user decides which service to be installed. This value needs to be passed to some FILE option.<br />
(think I am bad in explaining :-))<br />
e.g.: <br />
mysqld-opt.exe is checked my.1.cfg is installed and modified later on<br />
<br />
mysqld-nt-max.exe is checked my.2.cfg is installed and modified later on.<br />
<br />
(blablabla)<br />
<br />
+ Possibility number 2:<br />
There is only one my.cfg-file. There is a directive in it: <br />
Server=Path/to/MySQL4/bin/mysqld-***.exe<br />
<br />
This mysql-***.exe is replaced by the value checked with that RadioButton<br />
<br />
e.g.:<br />
if 'mysqld-opt.exe' is checked, than mysqld-***.exe is replaced with the string mysqld-opt.exe<br />
<br />
if mysqld-nt-max.exe is checked, mysqld-***.exe is replaced with the string mysqld-nt-max.exe<br />
<br />
(blablabla)<br />
<br />
OK, and in this case I'm down and out. I am not a programmer as you can suppose :cry:<br />
<br />
Please be patient<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">23rd March 2003, 13:35</div></div><div class="posttext">Use the MUI_INSTALLOPTIONS_READ macro to get the state of an option button.<br />
<br />
Example:!insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;io.ini&quot; &quot;Field #&quot; &quot;State&quot;<br />
<br />
StrCmp $R0 1 &quot;&quot; noOption1 ;check whether the option is selected<br />
<br />
  ...copy the files for option 1...<br />
<br />
noOption1:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mosestycoon</div><div class="date">23rd March 2003, 14:51</div></div><div class="posttext">Originally posted by Joost Verburg <br />
Example:!insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;io.ini&quot; &quot;Field #&quot; &quot;State&quot;<br />
StrCmp $R0 1 &quot;&quot; noOption1 ;check whether the option is selected<br />
<br />
  ...copy the files for option 1...<br />
<br />
noOption1: <br />
<br />
--------------&gt;<br />
<br />
So correct me, to get the different states of different RadioButtons, I need  some more lines:<br />
&quot;StrCmp $R0 1 &quot;&quot; noOption2 ;check whether the option is selected<br />
  ...copy the files for option 2...<br />
noOption2:<br />
<br />
What is the meaning of the 1 after $R0 and the empty quote?<br />
<br />
Again, please be patient<br />
Thx<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">23rd March 2003, 15:19</div></div><div class="posttext">To disable the RadioButtons use the &quot;Flag=Disable&quot;<br />
For example, like Joost Verburg wrote:<br />
<br />
Function &quot;XXX&quot;<br />
;read the first RadioButton<br />
!insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;io.ini&quot; &quot;Field #&quot; &quot;State&quot;<br />
StrCmp $R0 &quot;1&quot; +1 NoCheck ;What's the state of the Radio 1=Check 0=NoCheck<br />
;Put the code that you need to run with this<br />
...<br />
;Disable the others RadioButtons<br />
!insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioFile.ini&quot; &quot;Field #&quot; &quot;Flags&quot; &quot;DISABLED&quot; <br />
!insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioFile.ini&quot; &quot;Field #&quot; &quot;Flags&quot; &quot;DISABLED&quot;<br />
Goto End<br />
<br />
NoCheck:<br />
;We repeat the above the code for the others RadioButtons<br />
<br />
End:<br />
FunctionEnd<br />
<br />
<br />
I didn't try the code ... :( But I think that use it with &quot;Sections&quot;<br />
will get your task very well, <br />
did you read the $NSISDIR\NSIS\Examples\one-section.nsi</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mosestycoon</div><div class="date">23rd March 2003, 15:29</div></div><div class="posttext">No, I haven't tried the one-section.nsi example, but I have the following solution now, and it seems to work...<br />
<br />
Section &quot;mysql&quot; SecMySQL<br />
<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  File &quot;Path\to\mysqld.exe&quot;<br />
<br />
  ;; if mysqld-nt.exe is installed, than copy my.nt.ini to WINDIR<br />
  ;; -----------------<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;ioA.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
  StrCmp $R0 1 &quot;&quot; noOption1    ;check whether the option is selected<br />
  SetOutPath &quot;$WINDIR&quot;<br />
  File &quot;Path\to\my.nt.ini&quot;<br />
<br />
  ...function to search and replace...<br />
<br />
  noOption1:<br />
  <br />
  ;; if mysqld-opt.exe is installed, than install my.opt.ini<br />
  ;; -----------------<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;ioA.ini&quot; &quot;Field 4&quot; &quot;State&quot;<br />
  StrCmp $R0 1 &quot;&quot; noOption2    ;check whether the option is selected<br />
  SetOutPath &quot;$WINDIR&quot;<br />
  File &quot;Path\to\my.opt.ini&quot;<br />
<br />
  ...function to search and replace...<br />
<br />
  <br />
  noOption2:<br />
<br />
  ;; if mysqld-max-nt.exe is installed, than install my.max-nt.ini<br />
  ;; -----------------<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;ioA.ini&quot; &quot;Field 5&quot; &quot;State&quot;<br />
  StrCmp $R0 1 &quot;&quot; noOption3    ;check whether the option is selected<br />
  SetOutPath &quot;$WINDIR&quot;<br />
  File &quot;Path\to\my.max-nt.ini&quot;<br />
<br />
  ...function to search and replace...<br />
<br />
  <br />
  noOption3:<br />
<br />
SectionEnd<br />
<br />
Could you please verify that?<br />
Thx in advance UR GR8 !<br />
Chris aka MosesTycoon<br />
<br />
<br />
if mosestycoon is '*ยง$%#&amp;'<br />
    then ask @ FORUM<br />
fi<br />
<br />
;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">23rd March 2003, 15:39</div></div><div class="posttext">Seems to be :up:<br />
If it worked than :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mosestycoon</div><div class="date">23rd March 2003, 15:43</div></div><div class="posttext">Dark Boy -<br />
<br />
<br />
;Disable the others RadioButtons<br />
!insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioFile.ini&quot; &quot;Field #&quot; &quot;Flags&quot; &quot;DISABLED&quot; <br />
!insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioFile.ini&quot; &quot;Field #&quot; &quot;Flags&quot; &quot;DISABLED&quot;<br />
Goto End<br />
 <br />
<br />
Why do I need that part?<br />
<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">23rd March 2003, 15:48</div></div><div class="posttext">Didn't you want to disable the other radio buttons if<br />
one is check? :p<br />
Well is for that, why? I doesn't work?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd March 2003, 16:00</div></div><div class="posttext">StrCmp $R0 1 &quot;&quot; noOption2<br />
means compare $R0 to 1, if equal jump to &quot;&quot; (which is the same as 0 or +1, which just means next line), if not jump to the noOption2 label.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mosestycoon</div><div class="date">23rd March 2003, 16:17</div></div><div class="posttext">Welcome on discussion KichiK,<br />
<br />
as you joined, perhaps you can answer a corresponding question?<br />
<br />
As you already read the thread I have posted this &quot;Section&quot; which works double-:-)<br />
<br />
So as far as that is not enough, I work on a more complicated version of this, here a snippet:<br />
 SetOutPath &quot;$INSTDIR&quot;<br />
  File &quot;\Path\to\bin\mysqld-nt.exe&quot;<br />
<br />
  ;; if mysqld-nt.exe is installed, than...<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;ioA.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
<br />
  StrCmp $R0 1 &quot;&quot; noOption1    ;check whether the option is selected<br />
<br />
  SetOutPath &quot;$WINDIR&quot;<br />
  File &quot;\Path\to\my.nt.ini&quot;<br />
  <br />
  ;;--------------------------------<br />
  ;; here we try to edit some lines in that copied file with search and replace<br />
<br />
    ClearErrors<br />
    FileOpen $0 &quot;$WINDIR\my.nt.ini&quot; &quot;r&quot;<br />
    GetTempFileName $R0<br />
    FileOpen $1 $R0 &quot;w&quot;<br />
     loop:<br />
       FileRead $0 $2<br />
       IfErrors done<br />
        StrCmp $2 &quot;++basedir++$\r$\n&quot; 0 +3<br />
           FileWrite $1 &quot;basedir=$INSTDIR$\r$\n&quot;<br />
           Goto loop<br />
        StrCmp $2 &quot;++datadir++$\r$\n&quot; 0 +3<br />
           FileWrite $1 &quot;datadir=$INSTDIR\data$\r$\n&quot;<br />
           Goto loop<br />
        StrCmp $2 &quot;++language++$\r$\n&quot; 0 +3<br />
           FileWrite $1 &quot;language=$INSTDIR/share/german$\r$\n&quot;<br />
           Goto loop<br />
        StrCmp $2 &quot;++Server++$\r$\n&quot; 0 +3<br />
           FileWrite $1 &quot;Server=$INSTDIR/bin/mysqld-nt.exe$\r$\n&quot;<br />
           Goto loop<br />
        FileWrite $1 $2<br />
           Goto loop<br />
    done:<br />
        FileClose $0<br />
        FileClose $1<br />
        Delete &quot;$WINDIR\my.nt.ini&quot;<br />
        Rename $R0 &quot;$WINDIR\my.ini&quot;<br />
  <br />
  <br />
  ;Disable the others RadioButtons<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioA.ini&quot; &quot;Field 4&quot; &quot;Flags&quot; &quot;DISABLED&quot; <br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioA.ini&quot; &quot;Field 5&quot; &quot;Flags&quot; &quot;DISABLED&quot;<br />
  <br />
  noOption1:<br />
<br />
...<br />
<br />
; code for Option2 (if RadioButton2 is checked)<br />
<br />
...<br />
<br />
; code for Option3 (if RadioButton3 is checked)<br />
<br />
So this works fine, but when I use the same again (for the other two RadioButtons) the compiler quits with:<br />
<br />
Error: label &quot;loop:&quot; already declared in section/function<br />
Error in script &quot;C:\NSIS\INSTALL_OPTIONS\InstallOptions.nsi&quot; on line 205 -- aborting creation process<br />
<br />
I think I understand this, but what can I do against.<br />
<br />
The way it should work:<br />
Section:<br />
RadioButton 1 checked: copy FileA to $WINDIR and modify it...<br />
RadioButton 2 checked: copy FileB to $WINDIR and modify it...<br />
<br />
FileA and FileB are almost the same, except in one line:<br />
mysqld-opt.exe (e.g. FileA) and mysqld-nt.exe (FileB)<br />
<br />
(And there will be a third one...)<br />
<br />
Thx Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mosestycoon</div><div class="date">23rd March 2003, 16:20</div></div><div class="posttext">Originally posted by Dark Boy <br />
Didn't you want to disable the other radio buttons if<br />
one is check? :p<br />
Well is for that, why? I doesn't work?  <br />
<br />
I think this is done by default if the io.ini contains the several &quot;State&quot; values and FLAGS=Group ?<br />
<br />
Chris<br />
<br />
---[Added]---<br />
Ahhh, sorry! I haven't answered your question: it works :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd March 2003, 16:23</div></div><div class="posttext">Three things before we get to the real problem:<br />
1) Please attach large scripts next time.<br />
2) If you disable the radio buttons the user won't be able to change his selection when he returns to the page.<br />
3) I suggest you move all of the extraction and file changing code into a section so the user will get a chance to change his selection.<br />
<br />
Now for the problem, you have two options:<br />
1) Change loop to something else in each block.<br />
2) Create a function out of this code that takes the file name to change off the top of the stack or just out a variable.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mosestycoon</div><div class="date">23rd March 2003, 16:27</div></div><div class="posttext">Originally posted by kichik <br />
Three things before we get to the real problem:<br />
1) Please attach large scripts next  <br />
<br />
I will, sorry<br />
;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mosestycoon</div><div class="date">23rd March 2003, 16:39</div></div><div class="posttext">OK<br />
I attached the snippet. I just renamed loop to loop1 or loop2 (the same for done)<br />
<br />
and it works<br />
<br />
Really cool support, guys<br />
Again and again and again<br />
<br />
I love NSIS and all of you supporters (not for real :D)  <br />
<br />
Chris<br />
<br />
P.S.:<br />
By the way, when everything is finished with that CustomPage-bla, I try to write some comments on the snippet and post it at archive. I think this could help many non-programmers like me <br />
<br />
But be sure I need some more help, because this was the smaller part of the script...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>