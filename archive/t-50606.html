<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" DeleteRegKey?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  DeleteRegKey? NSIS Discussion" />
	
	<title> DeleteRegKey? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  DeleteRegKey?</div>
<hr />
<div class="pda"><a href="t-50606.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=50606">DeleteRegKey?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">24th May 2001, 10:05</div></div><div class="posttext">Is there a way to remove a certain registry key on the condition that it's completely empty?<br />
<br />
Say I have this layout:<br />
<br />
HKCU\Software\Alex\Program<br />
<br />
which is createed on install.<br />
<br />
On uninstall, I will DeleteRegKey that key, but I can't delete Alex just in case other programs by this particular author are installed.<br />
<br />
And I'd prefer not to leave it there. I personally hate empty keys under Software.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">24th May 2001, 17:00</div></div><div class="posttext">Don't think so, because DeleteRegKey is recursive nowadays... Don't really like that, there should be an option /r or something which controls this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">snowbird</div><div class="date">24th May 2001, 17:52</div></div><div class="posttext">Hi guys,<br />
<br />
I actually suggest such modifications for a few times but never got a response. What is really needed are methods to 1. check if a key contains<br />
  a) any values<br />
  b) any subkeys<br />
2. retrieve the names of<br />
  a) the values<br />
  b) the subkeys<br />
<br />
Snowbird</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yazno</div><div class="date">24th May 2001, 19:51</div></div><div class="posttext">hi,<br />
<br />
why don't you just read the keys (ReadRegKey), compare them (StrCmp)and if they aren't empty remove them (DeleteRegKey).<br />
<br />
what has that to do with recursive?<br />
if you don't want do delete a special key you don't have to, do you?<br />
<br />
cu yzo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">25th May 2001, 08:58</div></div><div class="posttext">Thanks, yzo, but is there a way to just check if any stuff exists under the key? I couldn't see if something specific is there, because if that specific something isn't there and other stuff is, boom.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yazno</div><div class="date">25th May 2001, 14:02</div></div><div class="posttext">hi,<br />
<br />
when i remove a key i know what i delete, because i wrote it there, so i know which value i have to read and compare before deleting.<br />
<br />
if you aren't sure, why would you want to delete a regkey <br />
which you don't know if it is empty or usefull with your installer?<br />
<br />
why don't you use DeleteRegValue instead?<br />
<br />
cu yzo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">25th May 2001, 14:10</div></div><div class="posttext">Okay, well, I install to<br />
<br />
HKCU\Software\Alex\ProgramA<br />
<br />
and on uninstall, I delete<br />
<br />
HKCU\Software\Alex\ProgramA<br />
<br />
I would like to be able to also delete<br />
<br />
HKCU\Software\Alex<br />
<br />
but I can't just in case this user has installed another program:<br />
<br />
HKCU\Software\Alex\ProgramB<br />
<br />
And I don't particularly wish to leave an empty Alex key behind. I'd prefer a completely clean install.<br />
<br />
Snowbird, I agree with you on 1. a) b). But I believe 2. a) b) can be done now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yazno</div><div class="date">25th May 2001, 14:18</div></div><div class="posttext">hi,<br />
<br />
if you write a key to HKCU\Software\Alex\ProgramA<br />
<br />
you should know other possible keys under HKCU\Software\Alex\ ( 'cause it seems like you were Alex ;) )<br />
<br />
HKCU\Software\Alex\ProgramB <br />
HKCU\Software\Alex\ProgramC<br />
HKCU\Software\Alex\ProgramD<br />
<br />
so you could check for them, couldn't you?<br />
<br />
cu yzo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">25th May 2001, 14:29</div></div><div class="posttext">But you don't know right now which programs you are going to write in the future, so you don't know the names of ProgramC and ProgramD :)<br />
<br />
Just my idea.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yazno</div><div class="date">25th May 2001, 14:41</div></div><div class="posttext">hi,<br />
<br />
LOL .. sure.<br />
yeah koen you are right, i didn't think of that .. uhh ..<br />
<br />
so ReadRegValues would be quite useful!<br />
<br />
cu yzo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">snowbird</div><div class="date">26th May 2001, 08:38</div></div><div class="posttext">How do you think it is possible now to discover the names of the values? I don't think this is possible. Maybe I have to be more precise: I want to obtain a list containing all the names of the values/subkeys.<br />
<br />
A problem I see here with respect to the implementation is that NSIS doesn't know any list data type. However, the following should be possible to implement:<br />
1. FirstRegValueName HKEY SUBKEY $x<br />
   Will retrieve the name of the first value in SUBKEY and write it to $x or throw an error if there is none.<br />
2. NextRegValueName HKEY SUBKEY $x<br />
   Will retrieve the next name and write it to $x or throw an error if there is none.<br />
<br />
I implemented some C functions to do this, however I never had a look at the NSIS source code, so I don't feel fit to hack this into NSIS. Anyone feeling fit to do so who wants the code, please let me know.<br />
<br />
Snowbird</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>