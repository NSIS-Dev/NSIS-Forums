<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" CD-ROM drive readiness, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  CD-ROM drive readiness NSIS Discussion" />
	
	<title> CD-ROM drive readiness [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  CD-ROM drive readiness</div>
<hr />
<div class="pda"><a href="t-246931.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246931">CD-ROM drive readiness</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ewallig</div><div class="date">24th May 2006, 19:00</div></div><div class="posttext">Hi all,<br />
<br />
Not trying to dig up older threads on multi-disk installations - think i've got that figured out. My question: is there a way to check the readiness of a drive (CD-ROM, for example)?<br />
<br />
My problem is that if the user installing my multi-disk set has a slow CD-ROM and clicks &quot;OK&quot; for the next CD before the disk has spun up, errors are occurring. I'd like to write into the installer a check to see if the drive is ready to be read.<br />
<br />
Any ideas? Thanks...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th May 2006, 19:07</div></div><div class="posttext">Try this plugin http://nsis.sourceforge.net/CDRom_plug-in</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ewallig</div><div class="date">24th May 2006, 20:42</div></div><div class="posttext">That will probably do it...uh...hmm...guess I'm still a bit of an amateur :(<br />
<br />
 - How would you write a conditional that would loop until the value of cdrom::status was 1?<br />
<br />
Thanks..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th May 2006, 20:48</div></div><div class="posttext">@example<br />
_loop:<br />
StrCmp $0 '1' 0 _loop</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ewallig</div><div class="date">24th May 2006, 21:17</div></div><div class="posttext">Thanks - still having some issues - tried this:<br />
<br />
#spin until the CD is ready<br />
    _loop:<br />
    cdrom::status &quot;&quot; .R0<br />
    StrCmp $R0 '1' 0 _loop<br />
<br />
It still jumps ahead sometimes - the next line of code invokes 7zip which fails because it can't find the archive on the CD-ROM.<br />
<br />
Any ideas?<br />
<br />
<br />
Thanks again..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th May 2006, 21:24</div></div><div class="posttext">Your code looks OK, though .R0?<br />
I have not ever used the plugin, I guess Instructor should provide the correct use. Probably an issue because of the relative jump? Try to replace 0 with a label or better use LogicLib :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">24th May 2006, 22:59</div></div><div class="posttext">_loop:<br />
cdrom::status &quot;&quot; .R0<br />
StrCmp $R0 '1' _ready<br />
MessageBox MB_OKCANCEL 'Insert CD-ROM disk and press OK' IDOK _loop IDCANCEL _exit<br />
<br />
_ready:<br />
<br />
_exit:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ewallig</div><div class="date">25th May 2006, 14:20</div></div><div class="posttext">Thanks - that fixed the code problem but ultimately did not fix the problem that I was having. The CD-ROM is now reporting that it is ready but (intermittantly) 7zip can't find the archive on the disk so it pops an error code.<br />
<br />
Any thoughts on how I could capture that error message and use it to retry the command?<br />
<br />
Thanks again...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shaunb</div><div class="date">25th May 2006, 14:23</div></div><div class="posttext">can't you copy the archive off the disc into $TEMP ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ewallig</div><div class="date">25th May 2006, 14:29</div></div><div class="posttext">Yeah, I did that at first but it takes twice as long for the installation - the archive is 400+MB of compressed pdf data; if i first copy it to TEMP it takes about 4 minutes to do the copy. Extraction takes another 4-6 mintures, depending on computer so now I've got 10 minutes install time per disk; I've got 3 disks to complete the installation.<br />
<br />
Thanks anyway though :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shaunb</div><div class="date">25th May 2006, 14:36</div></div><div class="posttext">maybe plain pdf files in no compressed archive would be faster, and just manually copying them using &quot;File&quot; or something.<br />
<br />
at least its lots of smaller files then *shrug*</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ewallig</div><div class="date">25th May 2006, 15:02</div></div><div class="posttext">Yeah, tried that too - not the results that I wanted. However, I think that I've resolved the current problem that I'm having by adding a 5 second pause after the CD-ROM reports that it's ready - we'll see....<br />
<br />
<br />
Thanks again..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th May 2006, 15:26</div></div><div class="posttext">Put an empty file on your disk and use this code to check if it is readable:<br />
<br />
StrCpy $R0 0<br />
TryAgain:<br />
 Sleep 1000<br />
 ClearErrors<br />
  FileOpen $R1 &quot;$EXEDIR\setup.tmp&quot; r<br />
 IfErrors 0 Done<br />
  IntOp $R0 $R0 + 1<br />
  StrCmp $R0 10 0 TryAgain<br />
   MessageBox MB_OK|MB_ICONSTOP \<br />
    &quot;No CD detected etc...&quot;<br />
  Abort<br />
Done:<br />
FileClose $R1<br />
<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ewallig</div><div class="date">25th May 2006, 15:42</div></div><div class="posttext">Thanks Stu, I'll give that a try as soon as I can :)<br />
<br />
<br />
 - Ed</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>