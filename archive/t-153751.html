<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Sysinfo Problems with Win98SE, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Sysinfo Problems with Win98SE NSIS Discussion" />
	
	<title> Sysinfo Problems with Win98SE [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Sysinfo Problems with Win98SE</div>
<hr />
<div class="pda"><a href="t-153751.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=153751">Sysinfo Problems with Win98SE</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">23rd October 2003, 21:46</div></div><div class="posttext">Hi there I'm having a problem with the Sysinfo plugin for Win 98<br />
<br />
It works fine with WinXP Pro but it just doesn't work with Win 98<br />
<br />
<br />
Function .onInit<br />
sysinfo::GetFileVersion &quot;$INSTDIR\XwingAlliance.exe&quot;<br />
Pop $0<br />
Push $0<br />
Push &quot;.&quot;<br />
Push &quot;&quot;<br />
Call StrReplace<br />
Pop $0<br />
IntCmp $0 2002 +3 0 +3<br />
MessageBox MB_ICONSTOP|MB_OK &quot;WARNING:   Incorrect game \<br />
version$\r$\n$\nX-Wing: Alliance has not yet been updated to version \<br />
2.02.$\r$\n$\nPlease install the xwaupd202.exe, available at \<br />
http://www.lucasarts.com/      $\r$\n$\nbefore attempting to install \<br />
$(^Name).&quot;<br />
Abort<br />
FunctionEnd<br />
<br />
Function StrReplace<br />
<br />
blah blah<br />
FunctionEnd<br />
<br />
<br />
The Install Dir is taken from the Reg<br />
<br />
<br />
InstallDirRegKey HKLM &quot;Software\LucasArts Entertainment Company LLC\X-Wing Alliance\v1.0&quot; &quot;Install Path&quot;<br />
<br />
Its just not picking up the FileVersion from the exe using Win98 where as using WinXP it work fine<br />
<br />
Does anyone know how to fix this?<br />
<br />
If so could you show me please as its really starting to frustrate me now :igor:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">24th October 2003, 08:51</div></div><div class="posttext">Anyone?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">24th October 2003, 12:37</div></div><div class="posttext">You'd better contact the author of this plug-in.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th October 2003, 14:36</div></div><div class="posttext">Why aren't you using GetDLLVersion for this? It does the same thing (reads dwFileVersionMS and dwFileVersionLS) only it doesn't format it for you in a string. Use the following function to format the string:<br />
<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=5</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">24th October 2003, 19:29</div></div><div class="posttext">Thanks so much Kichik it now works with Win98<br />
<br />
Just one last thing, this works fine but I would just like you or someone to check to see if I have done it right<br />
<br />
<br />
GetDLLVersion &quot;$INSTDIR\XwingAlliance.exe&quot; $R0 $R1<br />
IntOp $R2 $R0 / 0x00010000<br />
IntOp $R3 $R0 &amp; 0x0000FFFF<br />
IntOp $R4 $R1 / 0x00010000<br />
IntOp $R5 $R1 &amp; 0x0000FFFF<br />
StrCpy $0 &quot;$R2$R3$R4$R5&quot;<br />
IntCmp $0 2002 +3 0 +3<br />
MessageBox MB_ICONSTOP|MB_OK &quot;message blah blah&quot;<br />
Abort<br />
<br />
<br />
Again thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th October 2003, 19:37</div></div><div class="posttext">Seems right.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">24th October 2003, 20:20</div></div><div class="posttext">ok thanks :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>