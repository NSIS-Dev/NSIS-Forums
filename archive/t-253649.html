<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" install on other user dialog, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  install on other user dialog NSIS Discussion" />
	
	<title> install on other user dialog [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  install on other user dialog</div>
<hr />
<div class="pda"><a href="t-253649.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=253649">install on other user dialog</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ronyh</div><div class="date">20th August 2006, 15:09</div></div><div class="posttext">Hello<br />
<br />
when i run the install program not with <br />
administrator rights i get a dialog &quot;oher user install..&quot;<br />
i want to avoid this dialog , ands put a MessagfeBox<br />
if not Admin rights end exit install .<br />
<br />
<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">20th August 2006, 17:53</div></div><div class="posttext">The XTInfo Plugin (http://nsis.sourceforge.net/XtInfoPlugin_plug-in) has a function to determine if the user is admin or not.  You could add this to .OnInit like this:<br />
<br />
Function .OnInit<br />
   xtInfoPlugin::IsAdministrator<br />
   Pop $0<br />
   StrCmp $0 &quot;true&quot; continue 0<br />
   SetSilent silent<br />
   MessageBox MB_OK &quot;You must have Admin rights to run this&quot;<br />
   abort<br />
 <br />
   continue:<br />
   ; *** continue your code here ***<br />
FunctionEnd<br />
<br />
<br />
There's also a RunAs Plugin (http://nsis.sourceforge.net/NSIS-RunAs) that would allow you to ask for the Admin login during the install and then would be able to run as the administrator.  It would save the user having to log off and back on, but may not work in your case.  (I thought I'd at least mention it.)  If you decided to go this way, I'd recommend also using the PassDialog (http://nsis.sourceforge.net/PassDialog_plug-in)  plugin just to keep the password secure.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ronyh</div><div class="date">20th August 2006, 18:14</div></div><div class="posttext">Hi<br />
i tried your code .<br />
still get the install program as other user if<br />
running not administrator rights .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">20th August 2006, 18:39</div></div><div class="posttext">OK, let's take a step back:<br />
Do you need to know if the user is Administrator or do you just need the proper permissions to something?  (A user can still be admin, but have limited permissions to certain folders, registry keys, etc. depending on how the PC is configured.)<br />
<br />
Can you answer these questions:<br />
<br />
1) Can you be more specific as to what rights the user is missing?  (What exactly fails or what specifically does the user not have rights to do?)<br />
<br />
2)  I assume that when using my example code that you are NOT getting the messagebox, correct or no?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ronyh</div><div class="date">20th August 2006, 18:51</div></div><div class="posttext">Hi<br />
<br />
1. my app must have admin rights for running<br />
   so i dont want to install without admin rights.<br />
2. i got your message after the &quot;install program as other<br />
   user&quot; .if you run the install not as admin<br />
   the dialog gives you the permission to install <br />
   not as admin .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ronyh</div><div class="date">20th August 2006, 19:02</div></div><div class="posttext">Hi<br />
attach the &quot;install program as other user&quot; dialog</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">20th August 2006, 19:42</div></div><div class="posttext">hmm... I guess I misunderstood your question.  The message box is coming from Windows itself (not NSIS).<br />
<br />
I did some quick searches, but haven't been able to find out exactly what triggers this dialog.<br />
<br />
But based on how Windows handles installations in a terminal server environment, I can make some guesses: (I know that you probably aren't using Terminal Services, but my guess is that the same logic applies here.  Others feel free to chime in here if I'm mistaken):<br />
<br />
1. Windows looks at the name of the program you are running.  If it's named &quot;setup.exe&quot; or &quot;install.exe&quot;, then it assumes it must be an installation and therefore prompts the user.  (You can test this theory by compiling your install under a differnet name such as &quot;test.exe&quot;.)<br />
<br />
2.  If running the install via add/remove programs, then my guess is that it will ALWAYS prompt the message since it would know at this point that you are running an install.<br />
<br />
I found this article (http://support.microsoft.com/?id=310360) from MS which explains how the system admin can change the windows policies in such a way to suppress the dialog.  (But you'd need admin priveldges to do this.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ronyh</div><div class="date">21st August 2006, 07:42</div></div><div class="posttext">Hi<br />
stupid but working <br />
<br />
Thanks!!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>