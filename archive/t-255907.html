<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" nsExec::Exec still flashes screen, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  nsExec::Exec still flashes screen NSIS Discussion" />
	
	<title> nsExec::Exec still flashes screen [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  nsExec::Exec still flashes screen</div>
<hr />
<div class="pda"><a href="t-255907.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=255907">nsExec::Exec still flashes screen</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">saschagottfried</div><div class="date">21st September 2006, 09:55</div></div><div class="posttext">Hi,<br />
<br />
I have to invoke an executable during my install procedure. First I used ExecWait but, that started a DOS console. After searching I here I found that using nsExec::Exec should be more convenient. But the installer window is still losing/gaining focus and my taskbar does something like flashing. This is annoying to the user.<br />
<br />
How to make it run in the background AND not noticable to the user in front of the machine? Any recommendations??? Thanks!<br />
<br />
[CODE]<br />
;function call to updata data<br />
;ExecWait '&quot;$TEMP\datcmp.exe&quot; /M=$TEMP\datcmp.ini' $6<br />
nsExec::Exec /TIMEOUT=1000 '&quot;$TEMP\datcmp.exe&quot; /M=$TEMP\datcmp.ini'<br />
[CODE]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st September 2006, 11:01</div></div><div class="posttext">You could try the ExecDos plugin which is on the Wiki.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschagottfried</div><div class="date">9th October 2006, 16:42</div></div><div class="posttext">Hi Stu,<br />
<br />
after replacing ExecWait with nsExec and now replacing it with ExecDos as you proposed, I can reply that there is still some kind of flashing in the screen. NSIS installer window is still loosing focus while calling this. You can see the evolution of my calls to different plugins...<br />
<br />
    ;function call to compare indexfiles<br />
    ;ExecWait '&quot;$TEMP\datcmp.exe&quot; /M=$TEMP\datcmp.ini' $6<br />
    ;nsExec::Exec /TIMEOUT=1000 '&quot;$TEMP\datcmp.exe&quot; /M=$TEMP\datcmp.ini'<br />
    ExecDos::exec /NOUNLOAD /ASYNC '&quot;$TEMP\datcmp.exe&quot; /M=$TEMP\datcmp.ini' &quot;$TEMP\execdos.log&quot;<br />
    Pop $0 # thread handle for wait<br />
    ;BringToFront ;using this did not changed anything :-(<br />
    # you can add some installation code here to execute while application is running.<br />
    ExecDos::wait $0<br />
<br />
<br />
I am using BGImage plugin to make the installation use the full screen, showing a backround image and a color gradient. With this enabled I can see the taskbar flashing &quot;through&quot;. <br />
<br />
Please give some more advise. Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">9th October 2006, 19:50</div></div><div class="posttext">This might happen if datcmp.exe starts third process that gains focus.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschagottfried</div><div class="date">10th October 2006, 09:48</div></div><div class="posttext">Updates:<br />
<br />
I noticed that some installers like NVIDIA, MSI tools and the old installer I am replacing right now (done with WISE Installmanager 1.5) work with fullscreen background image or gradient BUT the taskbar stays in foreground during the installation. My new NSIS installer and some others completely cover it. Does anybody know how this option is called? <br />
<br />
I looked throught the docs of plugin BGImage, but couldn't find anything about such an option. Help !!!<br />
<br />
My Code:<br />
<br />
Function CustomGUIInit<br />
    Push $R1<br />
    Push $R2<br />
    BgImage::SetReturn /NOUNLOAD on<br />
<br />
    BgImage::SetBg /NOUNLOAD /GRADIENT 255 255 255 0 30 100<br />
    Pop $R1<br />
    Strcmp $R1 success 0 error<br />
    File /oname=$PLUGINSDIR\bgimage.bmp vde71-splash.bmp<br />
    System::call &quot;user32::GetSystemMetrics(i 0)i.R1&quot;<br />
    System::call &quot;user32::GetSystemMetrics(i 1)i.R2&quot;<br />
    IntOp $R1 $R1 - 480<br />
    IntOp $R1 $R1 / 2<br />
    IntOp $R2 $R2 - 320<br />
    IntOp $R2 $R2 / 2<br />
    BGImage::AddImage /NOUNLOAD $PLUGINSDIR\bgimage.bmp $R1 $R2<br />
    CreateFont $R1 &quot;Arial&quot; 18 700<br />
    ;BGImage::AddText /NOUNLOAD &quot;$(^SetupCaption)&quot; $R1 0 64 128 16 8 500 100<br />
    BGImage::AddText /NOUNLOAD &quot;VDE-Vorschriftenwerk auf DVD - Version 7.1$\r$\nSetup&quot; $R1 0 64 128 30 30 550 100<br />
    Pop $R1<br />
    Strcmp $R1 success 0 error<br />
    BGImage::Redraw /NOUNLOAD<br />
    Goto done<br />
error:<br />
    MessageBox MB_OK|MB_ICONSTOP $R1<br />
done:<br />
    Pop $R2<br />
    Pop $R1<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">11th October 2006, 00:00</div></div><div class="posttext">I might have to add an option to the BGImage plugin to show the taskbar (not that hard). It will probably be in the next few days.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>