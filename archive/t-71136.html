<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Feature request: compare DLLs version, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Feature request: compare DLLs version NSIS Discussion" />
	
	<title> Feature request: compare DLLs version [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Feature request: compare DLLs version</div>
<hr />
<div class="pda"><a href="t-71136.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=71136">Feature request: compare DLLs version</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">futuris</div><div class="date">7th January 2002, 16:00</div></div><div class="posttext">The only thing I miss in NSIS is DLL version checking. Currently I have to use following code:<br />
<br />
  IfFileExists &quot;$SYSDIR\futuris.bpl&quot; CheckVersion CopyDLL<br />
    CheckVersion:<br />
    GetDLLVersion &quot;$SYSDIR\futuris.bpl&quot; $5 $6 <br />
    GetDLLVersionLocal &quot;..\runtime\futuris.bpl&quot; $7 $8<br />
    IntCmp $5 $7 CheckBuild CopyDLL NoAbort<br />
      CheckBuild:<br />
      IntCmp $6 $8 NoAbort CopyDLL NoAbort  <br />
  ; copying required DLL<br />
  CopyDLL:<br />
<br />
But it all can be changed to:<br />
<br />
CompareDLLver &quot;$SYSDIR\futuris.bpl&quot; &quot;..\runtime\futuris.bpl&quot; /<br />
                  CopyDLL SkipCopying</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Schultz</div><div class="date">7th January 2002, 16:32</div></div><div class="posttext">I belive at one time this function was in nsis but i belive justin removed it cause he could get the same functionality out of small functions in the exehead and doing more work in the script. The same reason why the Netscape plugin and some otehr commands where removed cause they could be done by the script.. here is a nice macro that might make it easier for you to update files.. this is gotten out of the functions.htm file in your NSIS Program Dir.<br />
<br />
;------------------------------------------------------------------------------<br />
; UpgradeDLL (macro)<br />
;<br />
; Updates a DLL (or executable) based on version resource information.<br />
;<br />
; Input: ${DLL_NAME} = input source file.<br />
;        top of stack = full path on system to install file to.<br />
;<br />
; Output: none (removes full path from stack)<br />
;<br />
; Usage:<br />
;<br />
;  Push &quot;$SYSDIR\atl.dll&quot;<br />
;  !define DLL_NAME atl.dll<br />
;  !insertmacro UpgradeDLL<br />
;<br />
<br />
!macro UpgradeDLL<br />
  Exch $0<br />
  Push $1<br />
  Push $2<br />
  Push $3<br />
  Push $4<br />
  ClearErrors<br />
  GetDLLVersionLocal ${DLL_NAME} $1 $2<br />
  GetDLLVersion $0 $3 $4<br />
  IfErrors upgrade_${DLL_NAME}<br />
    IntCmpU $1 $3 noupgrade_${DLL_NAME} noupgrade_${DLL_NAME} upgrade_${DLL_NAME}<br />
    IntCmpU $2 $4 noupgrade_${DLL_NAME} noupgrade_${DLL_NAME}<br />
  upgrade_${DLL_NAME}:<br />
    UnRegDLL $0<br />
    File /oname=$0 ${DLL_NAME}<br />
    RegDLL $0<br />
  noupgrade_${DLL_NAME}:<br />
  Pop $4<br />
  Pop $3<br />
  Pop $2<br />
  Pop $1<br />
  Pop $0<br />
  !undef DLL_NAME<br />
!macroend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">8th January 2002, 20:25</div></div><div class="posttext">Is it really required to Unreg a DLL first before registering it again?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>