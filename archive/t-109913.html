<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Multilanguage MessageBox $(STRING) in function .onInit and un.onInit, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Multilanguage MessageBox $(STRING) in function .onInit and un.onInit NSIS Discussion" />
	
	<title> Multilanguage MessageBox $(STRING) in function .onInit and un.onInit [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Multilanguage MessageBox $(STRING) in function .onInit and un.onInit</div>
<hr />
<div class="pda"><a href="t-109913.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=109913">Multilanguage MessageBox $(STRING) in function .onInit and un.onInit</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">neomaniakov</div><div class="date">15th October 2002, 09:05</div></div><div class="posttext">Multilanguage MessageBox $(STRING) in function .onInit and un.onInit<br />
<br />
I enjoy NSIS and it is really great!!! ;-) <br />
I use ModernUI, InstallOptions and and Multilanguages<br />
In my installs I need to interact with user when install or uninstall inits, but <br />
LangString doesnt work for me in this cases. I use latest snapshot vrom sourceForge(15 October), OS Xp and Win98, for example:<br />
<br />
Code:----------------------------------------<br />
  LoadLanguageFile &quot;${DISTF}\Contrib\Language files\English.nlf&quot;<br />
    !include &quot;${DISTF}\Contrib\Modern UI\Language files\English.nsh&quot;<br />
<br />
  LoadLanguageFile &quot;${DISTF}\Contrib\Language files\Dutch.nlf&quot;<br />
    !include &quot;${DISTF}\Contrib\Modern UI\Language files\Dutch.nsh&quot;<br />
<br />
LangString INSTALL_CHEKC_EXIST_INSTALLATION ${LANG_ENGLISH} &quot;Installer will check for existing ${PROGNAME} <br />
<br />
instalation.$\nContinue with check?&quot; <br />
LangString INSTALL_CHEKC_EXIST_INSTALLATION ${LANG_DUTCH} &quot;NIDERL: Installer will check for existing ${PROGNAME} <br />
<br />
instalation.$\nContinue with check?&quot; <br />
<br />
LangString un.UN_MSG_TEST1 ${LANG_ENGLISH} &quot;Test MSG mixed with variable ${PROGNAME}&quot; <br />
LangString un.UN_MSG_TEST1 ${LANG_DUTCH} &quot;NIDERL: Test MSG mixed with variable ${PROGNAME}&quot; <br />
<br />
LangString un.UN_MSG_TEST2 ${LANG_ENGLISH} &quot;Test MSG no variable&quot; <br />
LangString un.UN_MSG_TEST2 ${LANG_DUTCH} &quot;NIDERL: Test MSG no variable&quot; <br />
<br />
Function .onInit <br />
<br />
	Push Tahoma<br />
	Push 8<br />
<br />
	  Push ${LANG_ENGLISH}<br />
	  Push ${MUI_ENGLISH_LANGNAME}<br />
	  <br />
	  Push ${LANG_DUTCH}<br />
	  Push ${MUI_DUTCH_LANGNAME}<br />
	  <br />
	  Push 2F ; 8 is the number of languages, F = change font<br />
	<br />
<br />
	LangDLL::LangDialog &quot;Installer Language&quot; &quot;Please select a language.&quot;<br />
<br />
    Pop $LANGUAGE<br />
    StrCmp $LANGUAGE &quot;cancel&quot; 0 +2<br />
      Abort<br />
<br />
...<br />
MessageBox MB_YESNO|MB_ICONQUESTION|MB_TOPMOST|MB_DEFBUTTON1  &quot;$(INSTALL_CHEKC_EXIST_INSTALLATION)&quot; IDYES NoAbort<br />
...<br />
Function<br />
<br />
Function un.onInit <br />
...<br />
Push ${MUI_TEMP1}<br />
<br />
    ;Get the language from the registry (save by uninstaller)<br />
    ReadRegStr ${MUI_TEMP1} HKCU &quot;Software\MyCompany\${PROGNAME}&quot; &quot;Installer Language&quot;<br />
    StrCmp ${MUI_TEMP1} &quot;&quot; +2<br />
      StrCpy $LANGUAGE ${MUI_TEMP1}      <br />
<br />
	Pop ${MUI_TEMP1}<br />
...<br />
MessageBox MB_YESNO|MB_ICONQUESTION|MB_TOPMOST|MB_DEFBUTTON1  &quot;$(UN_MSG_TEST1)&quot; IDYES NoAbort<br />
MessageBox MB_YESNO|MB_ICONQUESTION|MB_TOPMOST|MB_DEFBUTTON1  &quot;$(UN_MSG_TEST2)&quot; IDYES NoAbort<br />
...<br />
Function<br />
<br />
Code:END ----------------------------------------<br />
<br />
Multilaguage MessageBox $(MSG) works fine in Sections and other cases, but in &quot;.onInit&quot; and &quot;un.onInit&quot;<br />
it does not recognise diferent languages and variable &quot;$(INSTALL_CHEKC_EXIST_INSTALLATION)&quot; init with first value in <br />
<br />
&quot;.onInit&quot; and &quot;$(un.UN_MSG_TEST1)&quot; with last value in &quot;un.onInit&quot;, doesn't matter of language chosen.<br />
Am i doing something wrong ..? What is the general solution for multilanguage MessageBoxes in Multilang installs..?<br />
I have my solution for onInit functions, same as &quot;MUI_ABORTWARNING&quot; before, see attachment, but i think LangString idea is better.:up:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th October 2002, 16:07</div></div><div class="posttext">In .onInit and un.onInit the language table selected is the language table of that most closely matches the system language. If non match, it is the first language defined in the script.<br />
<br />
After .onInit has been executed NSIS checks $LANGUAGE again and selects the desired language table.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">neomaniakov</div><div class="date">16th October 2002, 08:52</div></div><div class="posttext">Thanks kichik,<br />
<br />
Is it possible this language table selection to be done in &quot;.onInit&quot; or &quot;un.onInit&quot; runtime to match LangDll user choise? This will make NSIS more customizable and installs more UserFriendly. <br />
Or some kind of function &quot;before.onInit&quot; only for language selection, my locale settings are far-away of languages used in install.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>