<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" File Association Problem ?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  File Association Problem ? NSIS Discussion" />
	
	<title> File Association Problem ? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  File Association Problem ?</div>
<hr />
<div class="pda"><a href="t-305937.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305937">File Association Problem ?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">anandharaja</div><div class="date">2nd May 2009, 09:09</div></div><div class="posttext">hi<br />
<br />
I have lots of file like &quot;.mkv .avi .wmv .mov .rm etc&quot; iam not like to install more player to watch this type of file.<br />
my question is using NSIS I want to associate the file types to  media player classic, and i double click on the above mentioned file i should open in media player classic as my default player.<br />
<br />
Thanks in advance :up:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd May 2009, 12:38</div></div><div class="posttext">How about this?<br />
http://nsis.sourceforge.net/File_Association<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anandharaja</div><div class="date">2nd May 2009, 15:29</div></div><div class="posttext">I tried that FileAssociation.nsh  but the files are not associated with media player classic. whenever i double click the file it launches openwith window, if i right click that file means it shows &quot; Edit C:\Media Player classic\mplayerc.exe&quot; <br />
<br />
please any one attach a script &amp; .nsh for me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anandharaja</div><div class="date">6th May 2009, 07:30</div></div><div class="posttext">hai i attached the nsis script for file association can any one check and correct the errors in that script.<br />
<br />
my problem is after installing the package if i double click the avi file means it opens openwith window, if i right click the file means it shows &quot; Edit $INSTDIR&quot; &quot;. how to i associate my files with mediaplayer classic.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">7th May 2009, 01:12</div></div><div class="posttext">I see a couple things:<br />
[list=1]<br />
 You have RequestExecutionLevel set to 'user', but you are modifying the HKCR registry hive which requires admin privileges. <br />
<br />
 After you change the extension, you should call SHChangeNotify.  (See http://forums.winamp.com/showthread.php?s=&amp;threadid=140254, which is referenced on the main File Association wiki article.)  One way you can do this is by adding !include &quot;FileFunc.nsh&quot; to the top of your script, and then adding this just after you register the extension: ${RefreshShellIcons}<br />
[/list=1]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anandharaja</div><div class="date">7th May 2009, 03:57</div></div><div class="posttext">Thank for your suggestion, i tried it but still my problem not solved. if anyone modifiy my script and attach it again. past 3 months i searching solution for file association. please any one write a simple script and attach it.<br />
<br />
Thankyou</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anandharaja</div><div class="date">8th May 2009, 15:18</div></div><div class="posttext">Finally i found solution<br />
<br />
; Avi file Association <br />
WriteRegStr HKCR &quot;.avi&quot; &quot;&quot; &quot;MPC.avi&quot; <br />
WriteRegStr HKCR &quot;MPC.avi&quot; &quot;&quot; &quot;AVI File&quot; <br />
WriteRegStr HKCR &quot;MPC.avi\shell&quot; &quot;&quot; &quot;Play&quot; <br />
WriteRegStr HKCR &quot;MPC.avi\shell\Play\command&quot; &quot;&quot; '&quot;$PROGRAMFILES\Media Player Classic\mplayerc.exe&quot; &quot;%1&quot;'   WriteRegStr HKCR &quot;MPC.avi\DefaultIcon&quot; &quot;&quot; &quot;$PROGRAMFILES\Media Player Classic\Icons\movie.ico&quot; <br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">8th May 2009, 17:42</div></div><div class="posttext">I think that's basically what ${registerExtension} is supposed to do.  The only advantage I see is that the ${registerExtension} also tries to create a backup so that you can put the system back the way you found it during an uninstall.<br />
<br />
I've been super-swamped with work and personal issues that I have not had a chance to look at the RegisterExtension header.  Aside from the 2 things I pointed out earlier, it seems like it should have worked.  <br />
<br />
But if your method works, then that's probably better for you anyway.  (And the plus side is that you have better control over what you're doing rather than relying on the &quot;man behind the curtain&quot; so to speak.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anandharaja</div><div class="date">9th May 2009, 04:29</div></div><div class="posttext">i tried FileAssociation.nsh but that is not working. may be the problem in script but no one try to correct my script. comperio my script is right or wrong, any suggestion about my script. its working fine for me. what about you?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>