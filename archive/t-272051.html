<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with additional Game Explorer tasks, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with additional Game Explorer tasks NSIS Discussion" />
	
	<title> Problem with additional Game Explorer tasks [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with additional Game Explorer tasks</div>
<hr />
<div class="pda"><a href="t-272051.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=272051">Problem with additional Game Explorer tasks</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">necrophilissimo</div><div class="date">31st May 2007, 06:44</div></div><div class="posttext">I have a problem with additional Game Explorer tasks; I can't get them to work. Only the obligatory &quot;Play&quot; task appears no matter what I do. I've tried both Games plug-in and Game Explorer script example, both following the examples to the letter, but neither shows results. Any suggestions?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st May 2007, 18:42</div></div><div class="posttext">Try validating the paths where the shortcuts are created to make sure they are written where they should. Also make sure you have a unique identifier for each task. When all else fails, attach a minimal example of a script that doesn't work and we'll see what we can do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">necrophilissimo</div><div class="date">10th June 2007, 15:17</div></div><div class="posttext">I located the problem, which is all my fault - in a way. Before swapping to near-perfect NSIS I tried to code my own MSI thing and with zippo experience on the subject, and believe it or not, I managed to remove the entire ProgramData\Microsoft\Windows\GameExplorer during a buggy uninstall test! I had backups of the folder, but copying it back didn't help, as I no longer can't get any subfolders created there. The games do show up in Game Explorer, but I guess that's through Windows registery, not from Game Explorer folder - it can't be, cause NSIS nowdays doesn't create folders there.<br />
<br />
Since I have hundreds of gigabytes of on-going production content on my harddrive I can't exactly re-install the system and thanks to the fact I'm using HP machine, I don't have Windows Vista DVD for OS-only re-install, just the horrible 2-DVD system recovery monster that will wipe everything. So; Any suggestions? Or do I just wave Game Explorer goodbye for time being?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th June 2007, 18:25</div></div><div class="posttext">Try re-registering gameux.dll.Start-&gt;Run-&gt;regsvr32.exe gameux.dll</div></div><hr />


<div class="post"><div class="posttop"><div class="username">necrophilissimo</div><div class="date">11th June 2007, 15:03</div></div><div class="posttext">Thanks, that brought GameExplorer from the dead, but I still don't get things working. I stripped the entire installer into very basics, but no. Nothing is installed to GameExplorer folder, no folders, no tasks, nothing.<br />
<br />
I hate to ask anyone to do the dirty work for me, but it seems I have no choice - I'm simply out of ideas. Attached is the NSI stripped to bare bones and to just one exe (example thingy I've been used for testing, not the real deal). The core points where I guess I'm messing things up are:<br />
<br />
	WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Game&quot; &quot;DisplayName&quot; &quot;Game&quot;<br />
	WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Game&quot; &quot;UninstallString&quot; '&quot;$INSTDIR\uninstall.exe&quot;'<br />
	WriteRegDWORD HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Game&quot; &quot;NoModify&quot; 1<br />
	WriteRegDWORD HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Game&quot; &quot;NoRepair&quot; 1<br />
	WriteUninstaller &quot;uninstall.exe&quot;<br />
<br />
	${GameExplorer_GenerateGUID}<br />
	Pop $0 <br />
	${GameExplorer_AddGame} all $INSTDIR\Game.exe $INSTDIR $INSTDIR\Game.exe $0<br />
<br />
and:<br />
<br />
  	SetShellVarContext all<br />
<br />
; Remove from game explorer<br />
${If} ${AtLeastWinVista}<br />
	File GameuxInstallHelper.dll<br />
  	System::Call &quot;GameuxInstallHelper::RetrieveGUIDForApplication(t '$INSTDIR\Game.exe', *g .r0)&quot;<br />
	Pop $0 <br />
	${GameExplorer_RemoveGame} $0<br />
${EndIf}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th June 2007, 11:27</div></div><div class="posttext">The code seems fine. Are you sure the GDF is valid?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>