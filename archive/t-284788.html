<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" using variable/define set at installation in unistaller?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  using variable/define set at installation in unistaller? NSIS Discussion" />
	
	<title> using variable/define set at installation in unistaller? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  using variable/define set at installation in unistaller?</div>
<hr />
<div class="pda"><a href="t-284788.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=284788">using variable/define set at installation in unistaller?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">hasibuzi</div><div class="date">11th January 2008, 11:24</div></div><div class="posttext">Hi there,<br />
<br />
after experimenting a while and searching the forum I give up and just ask... ;)<br />
<br />
I have an installer which will install a plugin for a 3rd party app. The installer contains multiple plugin versions for multiple base app versions, so I'd love to be able to uninstall those seperatly. I already set a variable in the installer, and, depending on which plugin version is choosen, i set this variable with a string.<br />
<br />
In the uninstaller I'd like to use this string to delete this particular version with start menu shortcuts and everything, but without harming the other installations. But it seems dydamically set variables don't make it through to the installer - is there a way to do this?<br />
<br />
<br />
To make things clear - here is what i try to do:<br />
<br />
Install Version 1 of the Plugin:<br />
<br />
Copy Files, make SM Entry - &quot;Plugin 1.0\for program 1&quot;<br />
<br />
Install Version 2 of the Pluging:<br />
Copy Files, make SM Entry - &quot;Plugin 1.0\for program 2&quot;<br />
<br />
now when I start the uninstaller beeing placed in <br />
<br />
&quot;Plugin 1.0\for program 1\uninstall&quot; - i don't want to kill the files in &quot;Plugin 1.0\for program 2&quot;. But I haven't found a way to tell that to the uninstaller.<br />
<br />
I also tried with a define and used a variable (set in the installer) as the value for the define - but no luck. Using a static string works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">11th January 2008, 11:35</div></div><div class="posttext">save the string in the registry, or in a .ini file in the same location as the uninstaller, then read it back in the uninstaller</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hasibuzi</div><div class="date">11th January 2008, 12:02</div></div><div class="posttext">Hm, could slap myself for not thinking of that easy solution... :)<br />
<br />
Well, but I still run into trouble. <br />
<br />
<br />
FileOpen  $0 &quot;$INSTDIR\plugins\${ProductName}\fileVersion&quot; &quot;r&quot;<br />
FileRead $0 $2<br />
FileClose $0<br />
<br />
MessageBox MB_ICONEXCLAMATION|MB_OK $2<br />
<br />
<br />
This is the part that is supposed to read the file and give out the text in it - while this works perfectly in the install part of the script - it refuses to work in the uninstall section, the msgbox stays empty. The $INSTDIR and ${ProductName} values are known to the uninstaller, I checked that.<br />
<br />
<br />
It works when the &quot;fileVersion&quot; file is in the same location as the uninstaller. Does the file really HAS to be in the same location as the uninstall.exe? I would like ot put it somewhere else, not to clutter the base app (and preventing the user to delete that file accidently).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">11th January 2008, 12:22</div></div><div class="posttext">$instdir=location of uninstaller exe (in the uninstaller)<br />
for stuff like this I usually just name the file uninstaller.dat (or you can store it in the registry if you are already storing &quot;add/remove programs&quot; entries)<br />
<br />
and you could use Write/ReadINIStr functions instead of File*, they are simple one liners</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hasibuzi</div><div class="date">11th January 2008, 12:38</div></div><div class="posttext">I'd prefer to put it in a file - I managed to read from the &quot;fileVersion&quot; file when I put it in<br />
&quot;$INSTDIR\plugins\&quot;<br />
<br />
but not when it is in<br />
&quot;$INSTDIR\plugins\${ProductName}\&quot;<br />
<br />
although the uninstaller knows the value of &quot;${ProductName}&quot; and gives that out correctly. Even if I give the full path for the file manually - no way, it won't read the file beyond &quot;$INSTDIR\plugins\&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">11th January 2008, 12:50</div></div><div class="posttext">Unless the full path is longer than 255 chars, there should be no problem. Make sure the path is correct by &quot;debugging&quot; with messagebox or http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hasibuzi</div><div class="date">11th January 2008, 13:00</div></div><div class="posttext">uh... okay.<br />
<br />
That was some stupid mistake... sorry, for wasting your time. But usually when trying to read from a file, one shouln't delete it beforehand... :igor:<br />
<br />
Okay, its friday, maybe that will count as an apology...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>