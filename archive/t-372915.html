<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Trouble with Java Runtime Environment Dynamic Installer - the JRE install fails, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Trouble with Java Runtime Environment Dynamic Installer - the JRE install fails NSIS Discussion" />
	
	<title> Trouble with Java Runtime Environment Dynamic Installer - the JRE install fails [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Trouble with Java Runtime Environment Dynamic Installer - the JRE install fails</div>
<hr />
<div class="pda"><a href="t-372915.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=372915">Trouble with Java Runtime Environment Dynamic Installer - the JRE install fails</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">IanLes</div><div class="date">10th October 2013, 14:15</div></div><div class="posttext">I have added Java Runtime Environment Dynamic Installer to my install and it seems to be working as expected except that the JRE dose not actually get installed.  The Dynamic Installer page is displayed and it says it is downloading the JRE all the progress bars move along but at the end I get a message box that says:<br />
<br />
&quot;Unable to install Java - Setup will be aborted<br />
The JRE setup has been abnormally interrupted - return code OK&quot;<br />
<br />
The detail error contains: <br />
Detecting JRE Version<br />
JRE Version detection complete - result = No JRE Found<br />
About to download JRE from http://javadl.sun.com/webapps/download/AutoDL?BundleId=80814<br />
Download result = OK<br />
Launching JRE setup<br />
Execute: &quot;C:\Users\ileslie\AppData\Local\Temp\jre_setup.exe&quot; /passive REBOOT=Suppress JAVAUPDATE=0 WEBSTARTICON=0 /L \&quot;C:\Users\ileslie\AppData\Local\Temp\jre_setup.log\&quot;<br />
JRE Setup finished<br />
Delete file: C:\Users\ileslie\AppData\Local\Temp\jre_Setup.exe<br />
<br />
This is running in a Vista VM on my Windows 7 machine since I do not have a real computer that does not have Java installed already. I have admin privleges for the VM this happens if I run the install normally or with admin access.<br />
<br />
Any help or advice would be appreciated,<br />
<br />
Ian</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th October 2013, 16:56</div></div><div class="posttext">What's with the backslashes on the log path in your command line? Please post your actual ExecWait code.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">IanLes</div><div class="date">10th October 2013, 17:20</div></div><div class="posttext">That is the log as reported by the Java Runtime Environment Dynamic Installer plug in (http://nsis.sourceforge.net/Java_Runtime_Environment_Dynamic_Installer#Add_page_notifying_user_that_JRE_installation_is_required_.28Optional.29)<br />
<br />
There is no ExecWait code in my part of the script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th October 2013, 18:06</div></div><div class="posttext">There's an error in that header file. Remove those backslashes on the double quotes on lines 109 and 112. They don't need escaping, and besides, that is not the way to escape double quotes in NSIS script (you use $\&quot;).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">IanLes</div><div class="date">10th October 2013, 19:28</div></div><div class="posttext">Thanks for that<br />
<br />
I tweaked the script but that changed nothing about the behaviour.  I checked the specified log file but it did not exist so clearly the jre installer never got very far.  I'm going to comment out the delete line and then manually try to run the JRE installer...<br />
<br />
Detecting JRE Version<br />
JRE Version detection complete - result = No JRE Found<br />
About to download JRE from http://javadl.sun.com/webapps/download/AutoDL?BundleId=80814<br />
Download result = OK<br />
Launching JRE setup<br />
Execute: &quot;C:\Users\ileslie\AppData\Local\Temp\jre_setup.exe&quot; /passive REBOOT=Suppress JAVAUPDATE=0 WEBSTARTICON=0 /L &quot;C:\Users\ileslie\AppData\Local\Temp\jre_setup.log&quot;<br />
JRE Setup finished<br />
Delete file: C:\Users\ileslie\AppData\Local\Temp\jre_Setup.exe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">IanLes</div><div class="date">10th October 2013, 19:33</div></div><div class="posttext">OK that worked - after the standard windows do you want to allow this program to run prompt.  There is a plug in for that I believe.  So, I guess that means I have to tweak this jre script some more.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th October 2013, 20:04</div></div><div class="posttext">If you are getting an elevation prompt then that means your own setup needs elevating first. To do that you need to add RequestExecutionLevel admin and then check in .onInit that the user is running as an administrator using the UserInfo plug-in.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">IanLes</div><div class="date">10th October 2013, 20:09</div></div><div class="posttext">OK thanks.  Is there a way to only request elevation if the JRE needs to be installed?  If the customer already has a valid JRE then nothing else about my install needs elevation for anything else.  Is it possible to tweak the JRE dynamic installer script to request elevation for the setup it tries to run?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">10th October 2013, 22:01</div></div><div class="posttext">OK thanks.  Is there a way to only request elevation if the JRE needs to be installed?  If the customer already has a valid JRE then nothing else about my install needs elevation for anything else.  Is it possible to tweak the JRE dynamic installer script to request elevation for the setup it tries to run?<br />
<br />
So you never write to HKLM/$programfiles/$windir? If so you could use &quot;requestexecutionlevel highest&quot; and if JRE is not installed and the UserInfo plugin tells you that you are not admin you bail out with an error message telling the user to restart the installer elevated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">IanLes</div><div class="date">11th October 2013, 16:24</div></div><div class="posttext">So you never write to HKLM/$programfiles/$windir? If so you could use &quot;requestexecutionlevel highest&quot; and if JRE is not installed and the UserInfo plugin tells you that you are not admin you bail out with an error message telling the user to restart the installer elevated.<br />
<br />
No need to write to the registry - this is a simple java app.<br />
<br />
So that was a fix.  I just elevated the execution level to test it and with admin it works.  I'll fine tune things a bit, as you suggested.  Thank you for your advice.  Very helpful.<br />
<br />
Ian</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>