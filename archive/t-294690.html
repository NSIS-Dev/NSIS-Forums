<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Did I reinvent the wheel?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Did I reinvent the wheel? NSIS Discussion" />
	
	<title> Did I reinvent the wheel? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Did I reinvent the wheel?</div>
<hr />
<div class="pda"><a href="t-294690.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=294690">Did I reinvent the wheel?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">17th July 2008, 18:58</div></div><div class="posttext">So I currently use the getparameters function to get the command line arguments.  That's fine and dandy if I only have one argument, but if I have more I didn't know how to deal with it.  Is there an easy way to split out the parameters?  I didn't think there was, so I wrote the following function and then thought maybe that functionality already existed.  Does it?<br />
<br />
<br />
 ; GetNextParameter<br />
 ; input, $parameters<br />
 ; output, puts first parameter on stack and replaces $parameters with the beginning of the next param to the end of params<br />
 ; modifies no other variables.<br />
<br />
 Function GetNextParameter<br />
<br />
   Push $R0					;Push all var's we're using onto the stack so we can get them back later<br />
   Push $R1<br />
   Push $R2<br />
   Push $R3<br />
<br />
   StrCpy $R2 1					;Put 1 in $R2 because we'll start at Char 1<br />
   StrLen $R3 $parameters			;Put the length of parameters in $R3 for use<br />
   StrCmp $R3 &quot;0&quot; noParams			;If parameters was passed empty, we don't have any parameters left<br />
<br />
   killLeadingSpaces:<br />
     ;Check for space at beginning - if so, remove it<br />
     StrCpy $R0 $parameters $R2			;Put the first character of the parameters into $R0<br />
     StrCmp $R0 ' ' 0 loop			;If it starts with a space, remove it, if not, continue<br />
     StrCpy $parameters $parameters &quot;&quot; 1	;Remove the space from the beginning<br />
     StrLen $R3 $parameters			;New length  <br />
     StrCmp $R3 &quot;0&quot; 0 killLeadingSpaces		;If it's down to length 0, there aren't any params<br />
   noParams:<br />
     StrCpy $R0 &quot;NoParams&quot;			;Let 'em know<br />
     Goto finished<br />
<br />
   loop:<br />
     IntOp $R2 $R2 + 1				;Add one to where we're searching<br />
     StrCpy $R0 $parameters 1  $R2  		;Get that character so we can check it out<br />
     StrCmp $R2 $R3 gotit			;If it's the last param, the length and where we're at will match up<br />
     StrCmp $R0 ' ' gotit loop			;If we're on a space, we've got this one - finish up<br />
<br />
   gotit:<br />
     StrCpy $R0 $parameters $R2			;Put this parameter in $R0<br />
     StrCpy $parameters $parameters &quot;&quot; $R2	;reset parameters var to what's left<br />
     Goto finished<br />
<br />
   finished:<br />
     Pop $R3<br />
     Pop $R2<br />
     Pop $R1<br />
     Exch $R0<br />
<br />
 FunctionEnd<br />
<br />
<br />
Thanks,<br />
Eric</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">17th July 2008, 19:03</div></div><div class="posttext">See http://nsis.sourceforge.net/Get_command_line_parameter_by_name<br />
<br />
This can be used to get parameters in the &quot;/PARAM=VALUE&quot; format.<br />
You specify which parameter you want to get and you set the default.<br />
If the parameter is not set, the default is returned...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">17th July 2008, 21:11</div></div><div class="posttext">Nice thanks!  A little less error prone than mine...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">17th July 2008, 22:11</div></div><div class="posttext">What is wrong with GetOptions?<br />
<br />
myfile.exe /arg=hello<br />
<br />
${GetParameters} $0<br />
${GetOptions} $0 `/arg=` $R0<br />
<br />
$R0 = hello<br />
<br />
It's in the NSIS doc under File functions header along with GetParameters. It also sets the error flag if the parameter is missing. For example you could use /arg without a value, in which case your code may be:<br />
<br />
${GetParameters} $0<br />
ClearErrors<br />
${GetOptions} $0 `/arg` $R0<br />
${Unless} ${Errors}<br />
  ...<br />
${EndUnless}<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">18th July 2008, 21:51</div></div><div class="posttext">Looks even better.  Guess the answer to the subject of this post is a resounding YES.  I reinvented the wheel but didn't put enough spokes in it to support maintaining the original spherical shape...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">19th July 2008, 13:52</div></div><div class="posttext">I think there is a little syntax difference:<br />
<br />
With ${GetOptions} you must pass it like this:<br />
setup.exe /ARG1=C:\Program Files\My App /ARG2=C:\Program Files\My App 2<br />
<br />
But with &quot;GetParameterValue&quot; you must pass it like this:<br />
setup.exe /ARG1=&quot;C:\Program Files\My App&quot; /ARG2=&quot;C:\Program Files\My App 2&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th July 2008, 14:29</div></div><div class="posttext">You have to use quotes no matter what method you use when the value contains spaces. Otherwise your /ARG1 would have a value of &quot;C:\Program&quot;<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">19th July 2008, 15:10</div></div><div class="posttext">From the NSIS User Manual:<br />
<br />
Example2:<br />
<br />
Section<br />
  ${GetOptions} &quot;-INSTDIR=C:\Program Files\Common Files -SILENT=yes&quot; &quot;-INSTDIR=&quot;  $R0<br />
  ;$R0=C:\Program Files\Common Files<br />
SectionEnd<br />
<br />
Either the example is wrong or you are mistaken, Afrow :confused:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th July 2008, 15:24</div></div><div class="posttext">My bad. GetOptions works with or without quotes.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">19th July 2008, 15:26</div></div><div class="posttext">Here is an example:<br />
http://img411.imageshack.us/img411/6120/getoptionsph0.png<br />
<br />
So there is the difference between GetOptions and GetParameterValue.<br />
<br />
The behavior of GetOptions is very unusual though :igor:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">14th August 2008, 23:24</div></div><div class="posttext">Say you have the following:<br />
<br />
setup.exe doggie1 /ARG1=&quot;Jojo Likes Boxing&quot;<br />
<br />
Is there a way to grab doggie1 separate from Jojo Likes Boxing easily.  In other words, I'm already grabbing one parameter with the getParameters function.  It seems that if I continue to use the getParameters function with for doggie1, it will actually end up being 'doggie1 /ARG1=&quot;JojoLikesBoxing&quot;' and I'll have to, instead, customize getParameters to only go to the first space.  Am I making this harder than it really is?<br />
<br />
Thanks,<br />
Eric</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>