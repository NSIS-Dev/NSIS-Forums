<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" InstallDirRegKey bug?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  InstallDirRegKey bug? NSIS Discussion" />
	
	<title> InstallDirRegKey bug? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  InstallDirRegKey bug?</div>
<hr />
<div class="pda"><a href="t-132113.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=132113">InstallDirRegKey bug?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">IGx89</div><div class="date">17th April 2003, 16:54</div></div><div class="posttext">I'm trying to get NSIS 2.0b3 to save and recall the directory where my program was installed. I'm using the following line:<br />
InstallDirRegKey HKLM SOFTWARE\FLMM &quot;Install_Dir&quot;<br />
But for some reason, it doesn't work at all! In previous installers I've made it has worked, though that was when I was using v1.98.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th April 2003, 17:07</div></div><div class="posttext">Works for me with the NSIS package installer. Are you sure the key is really there? Are you sure the string inside it is valid? Are you sure you are not overriding $INSTDIR somewhere?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psyke</div><div class="date">17th April 2003, 17:12</div></div><div class="posttext">Hey there IGx89,<br />
<br />
I have experienced the same thing. I don't know whether this is a bug or this is how it's supposed to work now, but I got around it by manually setting the $OUTDIR var like so:<br />
SetOutPath &quot;$INSTDIR&quot;<br />
It seems as if somethng like this: InstallDirRegKey HKLM SOFTWARE\FLMM &quot;Install_Dir&quot;<br />
will initialize $INSTDIR (of course you may be using .onVerifyInstDir, etc. too)<br />
<br />
But it seems to me as if those things (InstallDirRegKey, .onVerifyInstDir) set the $INSTDIR variable but not $OUTDIR which gets used by the File command.<br />
<br />
So I just set $OUTDIR manually now, at some point when I'm sure that the $INSTDIR variable is valid.<br />
<br />
Makes sense in a funny sorta way. ;) At least I hope it does.<br />
<br />
edit: kichik is too fast. :o<br />
kichik, I'll sit down and see for sure whether or not I need to set the $OUTDIR before I can start using File<br />
<br />
edit again: I'm sorry. After re-reading IGx89's post, I think I may have understood his problem...<br />
<br />
Salaam/Peace.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">IGx89</div><div class="date">17th April 2003, 17:14</div></div><div class="posttext">I'm sure the key isn't there, because that isn't working :)<br />
String inside it? You mean &quot;Install_Dir&quot;?<br />
<br />
I'm also already calling &quot;SetOutPath $INSTDIR&quot; in my main section.<br />
<br />
Here's my complete header code:<br />
<br />
Name &quot;Freelancer Mod Manager&quot;<br />
Caption &quot;Freelancer Mod Manager&quot;<br />
OutFile FLMMInstaller.exe<br />
InstallDir `$PROGRAMFILES\Freelancer Mod Manager`<br />
InstallDirRegKey HKLM SOFTWARE\FLMM &quot;Install_Dir&quot;<br />
DirText 'Directory selection'<br />
XPStyle on<br />
AutoCloseWindow false<br />
SubCaption 0 &quot; - Release Notes&quot;<br />
LicenseText &quot;Freelancer Mod Manager release notes:&quot; &quot;Next &gt;&quot;<br />
LicenseData &quot;D:\My Documents\Visual Studio Projects\FLInstaller\Release\Readme.txt&quot;<br />
ShowInstDetails show<br />
SetDateSave on<br />
InstProgressFlags smooth</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th April 2003, 17:21</div></div><div class="posttext">psyke, you always have to set $OUTDIR, with or without SetOutPath (that only adds creation of the directory and a nice output to the user) before File unless you specify a full output path using /oname=.<br />
<br />
IGx89, what exactly do you mean by isn't working?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psyke</div><div class="date">17th April 2003, 17:22</div></div><div class="posttext">kichik: thanks for the clarification. :)<br />
while you were writing that post I looked through the NSIS examples and saw that they all do the 'SetOutPath $INSTDIR' thing - silly me. ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">IGx89</div><div class="date">17th April 2003, 23:03</div></div><div class="posttext">I mean that after a successful installation, the key &quot;FLMM&quot; doesn't exist under &quot;HKLM\Software&quot;, thus signifying it didn't work. No matter how many times I refresh or reload regedit, it still doesn't show up. But, I noticed another key under HKLM\Software that a previous installer I made had made, that had Install_Dir in it! So, for some reason my old script works (I tested it with both b0 and b3; it worked both times) but the new one I've made doesn't. :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th April 2003, 01:13</div></div><div class="posttext">It's not automatically created, you have to create it yourself :)<br />
Otherwise it can override important information such as the uninstaller path for example which can be used as the source for InstallDirRegKey. It's not a bug, it's a feature :p</div></div><hr />


<div class="post"><div class="posttop"><div class="username">IGx89</div><div class="date">18th April 2003, 02:22</div></div><div class="posttext">DOH! I've been away from NSIS scripting too long; thanks :)<br />
<br />
Btw, would anyone be interested in a NSIS script I made that retrieves component information from a text file on a web server? It's an auto-installer I made for Wulfram II (http://www.wulfram.com) that checks for new versions of components and downloads and installs them automatically. I haven't touched the script for a few months, so I figure that I might as well share it if anyone's interested :).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th April 2003, 10:09</div></div><div class="posttext">You can create a page at the Archive (http://nsis.sf.net/archive) where everybody can find it - in the Real World Installers section. I'm sure anybody looking for a good example will find it useful.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>