<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" File Read &amp; Write, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  File Read &amp; Write NSIS Discussion" />
	
	<title> File Read &amp; Write [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  File Read &amp; Write</div>
<hr />
<div class="pda"><a href="t-210401.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=210401">File Read &amp; Write</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">PeterDev</div><div class="date">14th March 2005, 21:24</div></div><div class="posttext">Hello,<br />
<br />
I have development an installer with custom files. users responses are stored in the $PLUGINSDIR\FileName.ini.<br />
<br />
As one of the requirements, I need to write out a general user respone file (ie:\ for silent installs, for configurator components, etc ... ).<br />
<br />
I do this, and it works fine until the temporary file of $PLUGINSDIR\FileName.ini has been modified with WriteINIStr.<br />
<br />
So, I can open the response<br />
<br />
FileOpen $FileHandle &quot;$INSTDIR\ResponseFile.xml&quot; w<br />
FileWrite $FileHandle &quot;Response Value&quot;<br />
...<br />
FileClose $FileHandle<br />
<br />
but as soon as I try to read the value from the updated '$PLUGINSDIR\FileName.ini' with <br />
 ReadINIStr $TEMP_VAR $PLUGINSDIR\FileName.ini &quot;Field 4&quot; ListItems<br />
<br />
The installer throws a file create error for $INSTDIR\ResponseFile.xml. If I do not update the screen references by '$ScreenFile', then no problem..<br />
<br />
Any idea how I can do this ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PeterDev</div><div class="date">14th March 2005, 21:41</div></div><div class="posttext">I found that the WriteINIStr is the culprit. I suppose of leaves the file open (marked dirty) ?<br />
<br />
How can I close the file ? or what do I need to do ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">15th March 2005, 00:44</div></div><div class="posttext">I found that the WriteINIStr is the culprit. I suppose of leaves the file open (marked dirty) ?Maybe attaching your script used would be better to clarify this. Maybe the .xml file has been opened first with another FileOpen, or you're running it somewhere? Maybe you're using FileOpen with WriteINIStr, and thus the error? Or maybe you didn't use FlushINI (Win9x) to update the INI file and thus, you read it without success? I don't know.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PeterDev</div><div class="date">15th March 2005, 13:28</div></div><div class="posttext">I though about including the script, but it is getting rather lengthy. I did use FlushINI command... same error. <br />
<br />
The workaround is to store it in a variable...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>