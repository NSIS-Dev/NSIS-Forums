<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Easy way to remove a folder and its files and subfolders using wildcards, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Easy way to remove a folder and its files and subfolders using wildcards NSIS Discussion" />
	
	<title> Easy way to remove a folder and its files and subfolders using wildcards [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Easy way to remove a folder and its files and subfolders using wildcards</div>
<hr />
<div class="pda"><a href="t-255782.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=255782">Easy way to remove a folder and its files and subfolders using wildcards</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bambou51</div><div class="date">19th September 2006, 14:50</div></div><div class="posttext">Is there an easy way to remove a folder and its files and subfolders using wildcards like this:<br />
<br />
RMDir /r &quot;c:\folder*&quot;<br />
<br />
I know that it can't work with RMDir but I was not able to find any simple solution (otherwise I will have to get the list of all the matching folders and remove them one by one)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th September 2006, 17:33</div></div><div class="posttext">Doesn't this work?<br />
RMDir /r &quot;c:\folder&quot;<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bambou51</div><div class="date">20th September 2006, 07:27</div></div><div class="posttext">No it is not working, because I have a bunch of folders called <br />
folder1, folder6, folderXXX, and I want to remove all of them without having the complete list, that's why I need to use wildcards.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CancerFace</div><div class="date">20th September 2006, 07:52</div></div><div class="posttext">How about this:<br />
Use FindFirst/FindNext to get everything in your folder (files and subfolders), then check with DirState (http://nsis.sourceforge.net/Docs/AppendixE.html#E.1.20) that what you have is not a file (the function returns -1 in case you have a file), match some pattern with WordFind (http://nsis.sourceforge.net/Docs/AppendixE.html#E.3.2) (from your post it sounds that all the folders are named FolderXXX, so look for 'Folder') then use RMDir to remove only those folders that match your criteria<br />
Hope this helps<br />
CF</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th September 2006, 12:23</div></div><div class="posttext">You don't need to use DirState. Just check that it's a folder by doing:<br />
IfFileExists $R0\*.* folder notfolder<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bambou51</div><div class="date">20th September 2006, 13:03</div></div><div class="posttext">ok Thanks<br />
One strange thing is that sometimes when I call <br />
RMDir /r my_folder<br />
the content of the folder is deleted (even subfolders), but the folder itself still exists.<br />
It 's not a right problem because I am able to delete the folder from Windows explorer.<br />
But most of the time it is working fine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">21st September 2006, 03:12</div></div><div class="posttext">were you 'in' the folder with Explorer or anything else at the time?  If so, that's why it wouldn't be deleted. Typically this is when an application sets that folder as its' 'working folder', but there can be many causes.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bambou51</div><div class="date">21st September 2006, 09:55</div></div><div class="posttext">None of these folders were displayed (or opened) during my RMDir call.<br />
I even try to kill my explorer before the call but it doesn't change anything.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st September 2006, 10:56</div></div><div class="posttext">How about SetOutPath?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">21st September 2006, 12:54</div></div><div class="posttext">And if you're still stuck, check out:<br />
http://ccollomb.free.fr/unlocker/<br />
<br />
It should list whatever processes are touching that folder and preventing you from deleting it.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>