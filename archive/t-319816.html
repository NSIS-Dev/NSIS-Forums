<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problems writing to registry, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problems writing to registry NSIS Discussion" />
	
	<title> Problems writing to registry [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problems writing to registry</div>
<hr />
<div class="pda"><a href="t-319816.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=319816">Problems writing to registry</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">davidhal</div><div class="date">10th June 2010, 02:41</div></div><div class="posttext">I'm seeing some really odd behavior from NSIS on trying to write/delete to the registry.<br />
<br />
I have a number of calls to WriteRegStr that work fine in my script. However, I also have a large number that are silently failing. Coincidentally, the ones that fail all seem to be in HKLM. I'm verifying by simply going into the registry on my development machine and observing which changes have or have not been made.<br />
<br />
I am executing this before any of the sections in my installer:<br />
; Request application privileges for Windows Vista<br />
RequestExecutionLevel admin<br />
<br />
I included a function like this to test for errors write after the registry writes and it returns Ok:<br />
Function Test<br />
ifErrors errorlabel<br />
MessageBox MB_OK &quot;OK&quot; <br />
quit<br />
errorlabel:<br />
MessageBox MB_OK &quot;Error&quot; <br />
FunctionEnd<br />
<br />
Incredibly, I've now tried to simply compile example2.nsi that comes with NSIS and none of the writes in that seem to be making it to the registry. The relevant writes there are:<br />
  ; Write the installation path into the registry<br />
  WriteRegStr HKLM SOFTWARE\NSIS_Example2 &quot;Install_Dir&quot; &quot;$INSTDIR&quot;<br />
  <br />
  ; Write the uninstall keys for Windows<br />
  WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Example2&quot; &quot;DisplayName&quot; &quot;NSIS Example2&quot;<br />
  WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Example2&quot; &quot;UninstallString&quot; '&quot;$INSTDIR\uninstall.exe&quot;'<br />
  WriteRegDWORD HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Example2&quot; &quot;NoModify&quot; 1<br />
  WriteRegDWORD HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Example2&quot; &quot;NoRepair&quot; 1<br />
<br />
Does anyone have any idea what is going on and what I can do to make example2 work?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">redxii</div><div class="date">10th June 2010, 05:11</div></div><div class="posttext">Are you running 64-bit Windows? By default since NSIS makes 32-bit setups, they actually write to &quot;HKEY_LOCAL_MACHINE\Software\Wow6432Node\&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">davidhal</div><div class="date">10th June 2010, 06:10</div></div><div class="posttext">Thanks, you're right!<br />
<br />
I didn't know there were a separate set of reg keys there on 64-bit systems.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>