<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Scheduling a tastk, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Scheduling a tastk NSIS Discussion" />
	
	<title> Scheduling a tastk [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Scheduling a tastk</div>
<hr />
<div class="pda"><a href="t-280347.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=280347">Scheduling a tastk</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bulgin</div><div class="date">30th October 2007, 16:39</div></div><div class="posttext">I've read the post regarding scheduling a task found here:<br />
<br />
<br />
http://forums.winamp.com/showthread.php?threadid=147686&amp;highlight=Task<br />
<br />
I am a little new to .dlls and such and have a few questions regarding this script.  If I post here could someone possibly offer assistance.  I've tried using the AT command which works if the user has permissions to do that, but in many cases the user cannot use the AT command to schedule events so the thread referencing the system dlls and such piqued my interest but I'm a little fuzzy on how to use it.  The attached script in the above reference thread URL returns an error when I run it (it compiles, but returns an error when I execute the executable).<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th October 2007, 18:58</div></div><div class="posttext">The complete example is available at:<br />
<br />
http://nsis.sourceforge.net/Scheduled_Tasks<br />
<br />
If you're unable to make it work, attach what you've got so far, explain what you've tried and how it fails and someone will surely be able to help you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bulgin</div><div class="date">30th October 2007, 23:30</div></div><div class="posttext">Okay, I figured out how to change the times, etc.  My only question now is what would one do to make this a silent operation without the MB.  Can you simply delete <br />
<br />
MessageBox MB_OK &quot;Backup job Scheduled task creation result: $0&quot;<br />
<br />
and put silentinstall at the top of the script?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bulgin</div><div class="date">31st October 2007, 02:33</div></div><div class="posttext">Actually, now I'm confused.  I can get the task to be scheduled, but not run.  I believe I'm having difficulty understanding the following section.  The program I want to execute resides in $TEMP and it is called backup.exe.... so what would the parameters be to run that?  I've changed them as follows but although the task gets scheduled, it doesn't run.  backup.exe does not need any additional parameters to run.  I have set this to run silently.<br />
<br />
Section &quot;SiteSecureBackup&quot;<br />
  SetOutPath $TEMP<br />
  push &quot;My Task&quot;<br />
  push &quot;My Task Comment&quot;<br />
  push &quot;c:\$TEMP\My Task backup.exe&quot;<br />
  push &quot;c:\$TEMP:&quot;<br />
  push &quot;My Program Args&quot;<br />
  push \<br />
    &quot;*(&amp;l2, &amp;i2 0, \<br />
	  &amp;i2 2006, &amp;i2 1, &amp;i2 1, \<br />
    &amp;i2 0, &amp;i2 0, &amp;i2 0, \<br />
    &amp;i2 0, &amp;i2 0, \<br />
    i 0, i 0, \<br />
    i 0, \<br />
    i 1, \<br />
    &amp;i2 1, &amp;i2 00, &amp;i2 0, i 0, &amp;i2 0) i.s&quot;<br />
  Call CreateTask<br />
  Pop $0<br />
  result: $0&quot;<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">31st October 2007, 04:49</div></div><div class="posttext">You've scheduled it to run on Jan 1, 2006. I think you've missed that date already.<br />
<br />
$TEMP already has a drive letter. Don't put another drive letter in front of it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bulgin</div><div class="date">31st October 2007, 05:10</div></div><div class="posttext">Yes, I noticed that mistake and corrected both the drive letter and date shortly after posting, however, with the new settings I still receive an error.  The schtasks command shows a task is scheduled but it fails to run.  I am entering the correct credentials for the user and password.  I am still confused over some of the values for the settings, i.e., :  What is supposed to be put into the area where the original coder has placed &quot;My Program Args&quot;?  Can this only run with the credentials of the logged in user? It compiles without a problem, shows that a task is scheduled, but fails to run.  I have the &quot;program_to_run.exe&quot; in the Temp directory.  I'm perplexed.  Any assistance would be greatly appreciated. <br />
<br />
Section &quot;SiteSecureBackup&quot;<br />
  SetOutPath $TEMP<br />
  push &quot;MyTask&quot;<br />
  push &quot;My Task Comment&quot;<br />
  push &quot;C:\Documents and Settings\user\Local<br />
Settings\Temp\MyTask program_to_run.exe&quot;<br />
  push &quot;C:\Documents and Settings\user\Local<br />
Settings\Temp&quot;<br />
  push &quot;My Program Args&quot;<br />
  push &quot;*(&amp;l2, &amp;i2 0, &amp;i2 2007, &amp;i2 9, &amp;i2 2, &amp;i2 0,<br />
&amp;i2 0, &amp;i2 0, &amp;i2 23, &amp;i2 45, i 0, i 0, i 0, i 1, &amp;i2<br />
1, &amp;i2 0x2, &amp;i2 0, i 0, &amp;i2 0) i.s&quot;<br />
  push &quot;Username&quot;<br />
  push &quot;Userpassword&quot;<br />
  Call CreateTask<br />
  Pop $0<br />
  MessageBox MB_OK &quot;Backup job Scheduled task creation<br />
result: $0&quot;<br />
SectionEnd<br />
 <br />
; eof<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">31st October 2007, 06:29</div></div><div class="posttext">&quot;My Program Args&quot; is a string that you use for any command line switches you need, or &quot;&quot; if you don't need any.<br />
<br />
Your latest code sample shows the schedule is for Sep 2, 2007. Is that what you wanted to schedule?<br />
<br />
Is your program called &quot;program_to_run.exe&quot; (what you said you want to run) or &quot;MyTask program_to_run.exe&quot; (as you have in the code sample)?<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bulgin</div><div class="date">31st October 2007, 16:38</div></div><div class="posttext">Okay, thank you for your help and clarifying those settings.  I can now get it to run using the credentials of the logged in user.  But if I replace those credentials with &quot;&quot;, it fails to run.  Is that how it's supposed to be?  Must it always run with the credentials of the logged in user? <br />
<br />
Thank you</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>