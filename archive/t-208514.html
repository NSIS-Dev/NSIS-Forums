<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" exclude?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  exclude? NSIS Discussion" />
	
	<title> exclude? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  exclude?</div>
<hr />
<div class="pda"><a href="t-208514.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=208514">exclude?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">22nd February 2005, 15:52</div></div><div class="posttext">Can serve anybody on exclusion of process paint.exe? Best if it discovered him instalator, but when it is including it ask if it wants to exclude?<br />
<br />
Equipment and it thanks from mountain ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd February 2005, 18:02</div></div><div class="posttext">What do you want to exclude paint.exe from?<br />
<br />
If you want to give the user an option to not install paint.exe, you can put paint.exe in a section and add the components page. You can also create a custom page using InstallOptions. See Contrib\InstallOptions and Examples\Modern UI for examples.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">22nd February 2005, 18:43</div></div><div class="posttext">There was example paint.exe. I want to exclude given program during installation, that install additions for it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd February 2005, 20:11</div></div><div class="posttext">There is no such example include with NSIS. Which example are you talking about? What do you mean by excluding a program during installation? Isn't the solution offered in my previous post what you were looking for?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">22nd February 2005, 20:43</div></div><div class="posttext">When I want to install it not give for given program additions sometimes, as given program is included and it is possible to change nothing. It walks about it me, in order to it discovered instalator if program is included, but when there is ask if exclude him. It needs for this exemplary script employ on paint.exe.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th February 2005, 11:28</div></div><div class="posttext">I am sorry, I can't understand what you're trying to say. I still think what you're looking for is a section. If it's not what you need, post some code examples explaining what you want.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">25th February 2005, 12:38</div></div><div class="posttext">Anybody has installed given program. It pulls off him new version and it wants to install. But that (in order to) install it must exclude this program correctly, but I want , that (in order to) it asked about exclusion(switch off)  this program  NSIS and it was possible to exclude (to switch off) it program by NSIS. It needs for this script. It thanks from mountain.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th February 2005, 12:47</div></div><div class="posttext">OK, I still understand you want to let the user an option to not extract a certain program. The suggestions in the first reply are what you need. Take a look at the mentioned examples.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">25th February 2005, 13:00</div></div><div class="posttext">Could serve you but? I searched on this theme a lot and unfortunately, I have found nothing (.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th February 2005, 13:02</div></div><div class="posttext">You don't need to search the forums, there are examples in Contrib\InstallOptions and Examples\Modern UI\InstallOptions.nsi.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">25th February 2005, 13:21</div></div><div class="posttext">There I has not found example on exclusion of (switching off of) given program during installation NSIS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th February 2005, 13:31</div></div><div class="posttext">Each of the InstallOptions examples show how to perform a certain action according to the selection the user made in the custom page. Simply change that action to the extraction of your program.<br />
<br />
If you go with the section option, there is nothing more to do. The section will not be executed if the user doesn't select it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">25th February 2005, 13:37</div></div><div class="posttext">I do not know english on so many well. Please, about exemplary script very :(.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th February 2005, 14:01</div></div><div class="posttext">For an InstsallOptions example, make a copy of Examples\Modern UI\InstallOptions.nsi and change line 84 to:File paint.exeFor a secon example, open Examples\example2.nsi and add the same code at line 65.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">25th February 2005, 14:32</div></div><div class="posttext">For an InstsallOptions example, make a copy of Examples\Modern UI\InstallOptions.nsi and change line 84 to:<br />
in 83-85 line have:<br />
  StrCmp $INI_VALUE &quot;1&quot; &quot;&quot; +2<br />
    MessageBox MB_OK &quot;You checked the check box, here is the MessageBox...&quot;<br />
<br />
SectionEnd<br />
<br />
<br />
Examples\example2.nsi<br />
line 62-66 have:<br />
  CreateDirectory &quot;$SMPROGRAMS\Example2&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\Example2\Uninstall.lnk&quot; &quot;$INSTDIR\uninstall.exe&quot; &quot;&quot; &quot;$INSTDIR\uninstall.exe&quot; 0<br />
  CreateShortCut &quot;$SMPROGRAMS\Example2\Example2 (MakeNSISW).lnk&quot; &quot;$INSTDIR\makensisw.exe&quot; &quot;&quot; &quot;$INSTDIR\makensisw.exe&quot; 0<br />
  <br />
SectionEnd<br />
<br />
I want to check if previous instance of application is active (in memory) and if it is active, <br />
then I want to popup a message : &quot;Installer will now close older version of this application&quot;. After <br />
that, I want to shutdown older version automatically.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th February 2005, 14:46</div></div><div class="posttext">Ah, so you want to close the old program, not to exclude from extracting it... That depends on your application. If it has a window, you can find that window using FindWindow and close it using a message such as WM_CLOSE. If it doesn't have a window, or won't respond to WM_CLOSE, then you'd have to figure out on your own how to close it. If you know how to close it, but don't know how to do it with a NSIS script, post the details and I'll help you to convert the method into a NSIS script.<br />
<br />
Some examples for using WM_CLOSE are:<br />
<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=86<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=462<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=455<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=322<br />
<br />
There are also some plug-ins that allow you to terminate process by name, but that's not a good idea. To quote MSDN:Use it only in extreme circumstances.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">25th February 2005, 14:54</div></div><div class="posttext">So, it walks about it me :). Only how employ for now for example, paint.exe?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th February 2005, 15:06</div></div><div class="posttext">As I said, it depends on the application you're trying to quit. If sending it a WM_CLOSE doesn't work, provide more details about this &quot;paint.exe&quot; and then I might be able to help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">25th February 2005, 15:34</div></div><div class="posttext">Is not possible it to establish program walk from mountain  about what or ? But that is wanted it, make in order to? Give what?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th February 2005, 15:42</div></div><div class="posttext">It's possible to find a process using on of the following:<br />
<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=483<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=542<br />
<br />
The second one even allows you to kill a process. But as I've said in the previous reply, it's not a good idea.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">25th February 2005, 15:49</div></div><div class="posttext">It thanks very. At last we have been apprehended :). It will try :).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">26th February 2005, 18:36</div></div><div class="posttext">I tested (try) different manners and it does not leave (does not go out) me. Could serve you on paint.exe? If program would be including it with question message (knowledge) wyskakiwaÂ³aby if (or) I want to exclude (to switch off). If it ask program give OK exclude (switch off). I ask very :).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">26th February 2005, 21:52</div></div><div class="posttext">If necessary as make, found it for given folder in order to &lt; self-service store &gt; NSIS? For example, anybody &lt; somebody &gt; has in (to) C:\Program Files\PROGRAM, but in (to) other &lt; somebody &gt; D:\Program Files\PROGRAM either (or) C:\Program Files\xxx\PROGRAM? <br />
Should search out path for &lt; self-service store &gt; *\*\PROGRAM NSIS. It thanks from mountain (top) ).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arfinator853</div><div class="date">26th February 2005, 22:49</div></div><div class="posttext">oh...so what u mean is like some people have their program files in C:\ and others have it in D:\...if u want to locate the users program files use the $PROGRAMFILES variable.  At least I think thats what is is...<br />
<br />
Arfy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">26th February 2005, 23:04</div></div><div class="posttext">But so, I have forgotten about it, but make mum (beguile, have) so P. But as for example, there is in (to) C:\PROGRAM is necessary it to inscribe it in (to) what either (or) D:\PROGRAM?<br />
<br />
Please, about answer on question with this exclusion of (switching off of) process too ;).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">27th February 2005, 18:37</div></div><div class="posttext">As increase place where go components to hold-down? Best when it place give widen, or change width (latitude) :).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">28th February 2005, 15:18</div></div><div class="posttext">How change in (to) instalatorze? For example, it at greeting. Some is in file * .nlf, but not all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th March 2005, 11:20</div></div><div class="posttext">To kill paint.exe with this one (http://nsis.sourceforge.net/archive/viewpage.php?pageid=542), use:Processes::FindProcess &quot;paint&quot;<br />
Pop $R0<br />
<br />
StrCmp $R0 &quot;0&quot; skip<br />
<br />
MessageBox MB_YESNO &quot;paint.exe is still running, kill?&quot; IDNO skip<br />
<br />
Processes::KillProcess &quot;paint&quot;<br />
Pop $R0<br />
<br />
skip:To get more space for the components in a MUI components page with description, use MUI_COMPONENTSPAGE_SMALLDESC. See the MUI readme for more information about this define.<br />
<br />
To find out how to change MUI strings, take a look under Page Settings in the MUI readme.html (Contrib\Modern UI\Readme.html (http://nsis.sourceforge.net/Contrib/Modern%20UI/Readme.html)).<br />
<br />
I couldn't understand what you need with C:\Program Files and D:\Program Files. $PROGRAMFILES will contain the right folder. If the user changed his program files folder to D:\Program Files, that's what $PROGRAMFILES will contain.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">5th March 2005, 21:37</div></div><div class="posttext">Unfortunately, it are not wanted to compile. Probably, I will not make it, because I do not know (do not be able) :P. <br />
<br />
You could serve example on it me how increase with choice of (election of) component on this example? Either (or) how give on bottom? <br />
; Script generated by the HM NIS Edit Script Wizard.<br />
<br />
; HM NIS Edit Wizard helper defines<br />
!define PRODUCT_NAME &quot;aaa&quot;<br />
!define PRODUCT_VERSION &quot;1.0&quot;<br />
!define PRODUCT_PUBLISHER &quot;a&quot;<br />
!define PRODUCT_WEB_SITE &quot;http://www.aaa&quot;<br />
<br />
; MUI 1.67 compatible ------<br />
!include &quot;MUI.nsh&quot;<br />
<br />
; MUI Settings<br />
!define MUI_ABORTWARNING<br />
!define MUI_ICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico&quot;<br />
<br />
; Welcome page<br />
!insertmacro MUI_PAGE_WELCOME<br />
; License page<br />
!insertmacro MUI_PAGE_LICENSE &quot;ins\test.txt&quot;<br />
; Components page<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
; Directory page<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
; Instfiles page<br />
!insertmacro MUI_PAGE_INSTFILES<br />
; Finish page<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
; Language files<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
; MUI end ------<br />
<br />
Name &quot;${PRODUCT_NAME} ${PRODUCT_VERSION}&quot;<br />
OutFile &quot;Setup.exe&quot;<br />
InstallDir &quot;$PROGRAMFILES\test&quot;<br />
ShowInstDetails show<br />
<br />
Section &quot;GrupaGlowna&quot; SEC01<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  SetOverwrite ifnewer<br />
  File &quot;ins\test&quot;<br />
SectionEnd<br />
<br />
Section -AdditionalIcons<br />
  WriteIniStr &quot;$INSTDIR\${PRODUCT_NAME}.url&quot; &quot;InternetShortcut&quot; &quot;URL&quot; &quot;${PRODUCT_WEB_SITE}&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\Website.lnk&quot; &quot;$INSTDIR\${PRODUCT_NAME}.url&quot;<br />
SectionEnd<br />
<br />
Section -Post<br />
SectionEnd<br />
<br />
; Section descriptions<br />
!insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />
  !insertmacro MUI_DESCRIPTION_TEXT ${SEC01} &quot;test&quot;<br />
!insertmacro MUI_FUNCTION_DESCRIPTION_END<br />
<br />
<br />
<br />
As change these texts, is checked off (noted) what on redly? <br />
http://img203.exs.cx/my.php?loc=img203&amp;image=a7rm.png<br />
http://img207.exs.cx/my.php?loc=img207&amp;image=as7yp.png<br />
http://img220.exs.cx/my.php?loc=img220&amp;image=ds2zr.png<br />
?<br />
<br />
I couldn't understand what you need with C:\Program Files and D:\Program Files. $PROGRAMFILES will contain the right folder. If the user changed his program files folder to D:\Program Files, that's what $PROGRAMFILES will contain.<br />
But how will be there make in (to) mums C:\PROGRAM? <br />
<br />
<br />
But how give at start logo instalator?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th March 2005, 22:11</div></div><div class="posttext">I can't help you solve the error unless I know what it is. What error does the compiler give you?<br />
<br />
You can change all of the texts in the images. The Modern UI readme (http://nsis.sourceforge.net/Contrib/Modern%20UI/Readme.html) contains all the information you need for this.<br />
<br />
If by start logo you mean a splash screen, take a look at Contrib\Splash and Contrib\AdvSplash. If you mean the image on the left in the welcome and finish page, take a look at the MUI readme, it tells you how to do that.<br />
<br />
But how will be there make in (to) mums C:\PROGRAM? What's mums?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">5th March 2005, 22:41</div></div><div class="posttext">1. Invalid command: Processes::FindProcess<br />
Error in script &quot;C:\Documents and Settings\xxx\wtykpak.nsi&quot; on line 35 -- aborting creation process<br />
2. Something from it try (taste) extract, but damage, that you do not want to give example :P. <br />
3. Ok, due to :). Then it will try. <br />
4. Never it isn't known where anybody has installed given program :P.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th March 2005, 19:26</div></div><div class="posttext">You probably forgot to copy Processes.dll into the Plugins directory. It's all in the MUI readme.  Finding out where a program is installed depends on your program. If your program writes the installation directory to the registry, read it from there. If it writes into some INI in the Windows directory, read it from there. If it doesn't write anything, give the user an option to locate it using the directory page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">8th March 2005, 19:57</div></div><div class="posttext">1. That and where copy mums? <br />
2. I do not know english on so many well :(. Anybody  could say me as change it:<br />
a) http://img203.exs.cx/my.php?loc=img203&amp;image=a7rm.png<br />
b) http://img207.exs.cx/my.php?loc=img207&amp;image=as7yp.png<br />
c) http://img220.exs.cx/my.php?loc=img220&amp;image=ds2zr.png<br />
d) http://img232.exs.cx/img232/1526/a5tj.png<br />
<br />
Very please :).<br />
<br />
3. Sound does not act at me it :(. And this original and personal. <br />
<br />
4. OK.<br />
<br />
Please, about assistance very :).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th March 2005, 20:13</div></div><div class="posttext">I still don't understand what mums is. Simply put the DLL in the Plugins directory. For example: C:\Program Files\NSIS\Plugins Sorry, not me. Post a code example showing the problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">exclude?</div><div class="date">8th March 2005, 20:38</div></div><div class="posttext">1. Now have:<br />
Error: Can't add entry, no section or function is open!<br />
Error in script &quot;C:\Documents and Settings\AMD 64 3400\Pulpit\ins\Wtyczki\wtykpak.nsi&quot; on line 45 -- aborting creation process<br />
<br />
<br />
2. Ok, but I would ask other somebody it :). <br />
3. Sound does not act in this example: <br />
Name &quot;Splash.dll test&quot;<br />
<br />
OutFile &quot;Splash Test.exe&quot;<br />
<br />
XPStyle on<br />
<br />
Function .onInit<br />
	# the plugins dir is automatically deleted when the installer exits<br />
	InitPluginsDir<br />
	File /oname=$PLUGINSDIR\splash.bmp &quot;${NSISDIR}\Contrib\Makensisw\logo.bmp&quot;<br />
	#optional<br />
	#File /oname=$PLUGINSDIR\splash.wav &quot;C:\myprog\sound.wav&quot;<br />
<br />
	splash::show 1000 $PLUGINSDIR\splash<br />
<br />
	Pop $0 ; $0 has '1' if the user closed the splash screen early,<br />
			; '0' if everything closed normal, and '-1' if some error occured.<br />
FunctionEnd<br />
<br />
Section<br />
SectionEnd<br />
Certainly it serves paths good.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th March 2005, 20:41</div></div><div class="posttext">You must put that code in a section or a function. You can't execute anything out of a section or a function.  You didn't remove the comment from the extracting of the wave file. Remove the comments and put a valid path and it should work.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>