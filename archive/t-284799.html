<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Need a simple Macro, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Need a simple Macro NSIS Discussion" />
	
	<title> Need a simple Macro [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Need a simple Macro</div>
<hr />
<div class="pda"><a href="t-284799.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=284799">Need a simple Macro</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">aemik</div><div class="date">11th January 2008, 15:52</div></div><div class="posttext">I dont know how to write a macro. So I need your help:<br />
<br />
I have this code:<br />
<br />
  ClearErrors<br />
  ReadRegStr $0 HKLM &quot;Software\Test\Test&quot; &quot;X&quot;<br />
  IfErrors 0 +2<br />
  WriteRegStr HKLM &quot;Software\Test\Test&quot; &quot;X&quot; myValue<br />
<br />
<br />
<br />
I have a lot of Regkeys. And I only want to write them if they not exist. So I want to give the RegKey and his Value to a macro (or function?). <br />
Like this: ${myRegistry::Key::Keyname::Value}<br />
<br />
Is it possible???<br />
<br />
Thank you very much for your help<br />
aemik</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aemik</div><div class="date">11th January 2008, 16:06</div></div><div class="posttext">Just use a macro:<br />
<br />
    code:!macro _CreateRegInstruction Type Root Key Name Value<br />
      Push $R0<br />
      ClearErrors<br />
      ReadReg${Type} $R0 `${Root}` `${Key}` `${Name}`<br />
      Pop $R0<br />
      IfErrors 0 +2<br />
        WriteReg${Type} `${Root}` `${Key}` `${Name}` `${Value}`<br />
    !macroend<br />
<br />
    !macro _WriteRegDWORD Root Key Name Value<br />
      !insertmacro _CreateRegInstruction DWORD `${Root}` `${Key}` `${Name}` `${Value}`<br />
    !macroend<br />
    !define WriteRegDWORD `!insertmacro _WriteRegDWORD`<br />
<br />
    !macro _WriteRegStr Root Key Name Value<br />
      !insertmacro _CreateRegInstruction Str `${Root}` `${Key}` `${Name}` `${Value}`<br />
    !macroend<br />
    !define WriteRegStr `!insertmacro _WriteRegStr`<br />
<br />
    !macro _WriteRegBin Root Key Name Value<br />
      !insertmacro _CreateRegInstruction Bin `${Root}` `${Key}` `${Name}` `${Value}`<br />
    !macroend<br />
    !define WriteRegBin `!insertmacro _WriteRegBin`<br />
<br />
<br />
<br />
${WriteRegDWORD} HKLM `Software\MyApp` `Blah1` 1<br />
${WriteRegBin} HKLM `Software\MyApp` `Blah2` ABCD<br />
${WriteRegStr} HKLM `Software\MyApp` `Blah3` Hello<br />
<br />
Stu<br />
<br />
<br />
-----------------<br />
<br />
<br />
<br />
this is what i meant. Thank you very very much.<br />
aemik</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th January 2008, 17:19</div></div><div class="posttext">Code shortened:<br />
<br />
!macro _WriteReg Type Root Key Name Value<br />
  Push $R0<br />
  ClearErrors<br />
  ReadReg${Type} $R0 `${Root}` `${Key}` `${Name}`<br />
  Pop $R0<br />
  IfErrors 0 +2<br />
    WriteReg${Type} `${Root}` `${Key}` `${Name}` `${Value}`<br />
!macroend<br />
<br />
!define WriteRegDWORD `!insertmacro _WriteReg DWORD`<br />
!define WriteRegBin `!insertmacro _WriteReg Bin`<br />
!define WriteRegStr `!insertmacro _WriteReg Str`<br />
<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>