<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" using rollback with &quot;CABsetup.dll&quot;, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  using rollback with &quot;CABsetup.dll&quot; NSIS Discussion" />
	
	<title> using rollback with &quot;CABsetup.dll&quot; [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  using rollback with &quot;CABsetup.dll&quot;</div>
<hr />
<div class="pda"><a href="t-322363.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322363">using rollback with &quot;CABsetup.dll&quot;</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">thanatos83</div><div class="date">12th September 2010, 01:11</div></div><div class="posttext">HI all.<br />
<br />
I need a little help with this plugin, because this work for me fine but i need to set a nice script with rollback issue.<br />
<br />
I wish to delete the rest of files installed and remove some registry as entries in Add/remove programs, etc...<br />
<br />
well i get to delete files but the entry in &quot;add/remove programs&quot; it isn't removed.<br />
<br />
this is my part of script with that:<br />
<br />
# Rollback<br />
# ===============================<br />
Function Abortar            <br />
    DeleteRegKey HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$(^Name)&quot;<br />
    Delete /REBOOTOK &quot;$SMPROGRAMS\$StartMenuGroup\$(^UninstallLink).lnk&quot;<br />
    Delete &quot;$DESKTOP\STR.lnk&quot;<br />
    Delete &quot;$QUICKLAUNCH\STR.lnk&quot;<br />
    Delete /REBOOTOK $INSTDIR\uninstall.exe<br />
    DeleteRegValue HKLM &quot;${REGKEY}&quot; StartMenuGroup<br />
    DeleteRegValue HKLM &quot;${REGKEY}&quot; Path<br />
    DeleteRegKey /IfEmpty HKLM &quot;${REGKEY}\Components&quot;<br />
    DeleteRegKey /IfEmpty HKLM &quot;${REGKEY}&quot;<br />
    RmDir /r /REBOOTOK $SMPROGRAMS\$StartMenuGroup<br />
    RmDir /r /REBOOTOK $INSTDIR<br />
    DeleteRegValue HKLM &quot;${REGKEY}\Components&quot; BaseFiles<br />
    Push $R0<br />
    StrCpy $R0 $StartMenuGroup 1<br />
    StrCmp $R0 &quot;&gt;&quot; no_smgroup<br />
no_smgroup:<br />
    Pop $R0  <br />
FunctionEnd<br />
<br />
Well this script is copied from uninstaller section, i think this is correct if i wish to delete files and install a new clean installation again. :confused:<br />
thx.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">12th September 2010, 08:28</div></div><div class="posttext">Are you sure you don't just need to refresh ARP?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thanatos83</div><div class="date">12th September 2010, 11:08</div></div><div class="posttext">Are you sure you don't just need to refresh ARP?<br />
<br />
How can i do this?, so i forgive mention that the shortcut not removed :S</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">12th September 2010, 13:42</div></div><div class="posttext">Just press F5 in ARP. If an uninstaller is called from ARP, it automatically refreshes afterwards. If you're looking at ARP while some other application removes the registry entry, you may have to do a manual refresh.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thanatos83</div><div class="date">12th September 2010, 14:21</div></div><div class="posttext">HI MSG.<br />
<br />
OK i press it, but not working :( and i see the shortcut in desktop. So i need to do manually but how can i do manually?<br />
<br />
thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thanatos83</div><div class="date">12th September 2010, 14:28</div></div><div class="posttext">HI MSG.<br />
<br />
OK i press it, but not working :( and i see the shortcut in desktop. So i need to do manually but how can i do manually?<br />
<br />
Note: this is the part of the script that i can handle the cancel button.<br />
<br />
; Handle case where extraction was cancelled.<br />
    ${If} $R0 = 995        <br />
        Call Abortar<br />
        DetailPrint &quot;Extract process was cancelled&quot;<br />
        SetDetailsPrint None        <br />
        Goto Done<br />
    ${EndIf}<br />
<br />
    DetailPrint &quot;Extract failed with error code $R0&quot;<br />
    Done:   <br />
<br />
thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thanatos83</div><div class="date">13th September 2010, 15:41</div></div><div class="posttext">Hi.<br />
<br />
Not working by pressing F5 or exit and going after to ARP. :S <br />
<br />
So other files are removed but other files as &quot;uninstall.exe, shortcuts, that entry in ARP&quot; not removed. If i set abort this does work but i need to press cancel button twice to exit.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>