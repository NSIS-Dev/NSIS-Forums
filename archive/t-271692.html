<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Multiple Setup question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Multiple Setup question NSIS Discussion" />
	
	<title> Multiple Setup question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Multiple Setup question</div>
<hr />
<div class="pda"><a href="t-271692.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=271692">Multiple Setup question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Guardian9978</div><div class="date">24th May 2007, 03:00</div></div><div class="posttext">Is there a way to run a second setup wizard after the first one has finished and the user has press Finished from a DVD?<br />
<br />
for Example:<br />
Setup1 installs<br />
Setup2 is called after the user clicks finish in Setup1.<br />
Both Setup1 and Setup2 are on a DVD.<br />
<br />
How can I do this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th May 2007, 15:01</div></div><div class="posttext">Function .onInstSuccess<br />
Exec &quot;$EXEDIR\setup2.exe&quot;<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guardian9978</div><div class="date">24th May 2007, 20:28</div></div><div class="posttext">how would I go about calling that function?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">24th May 2007, 20:52</div></div><div class="posttext">It will be called automatically when the setup program finishes unless the install is cancelled or aborted.<br />
see onInstSuccess (http://nsis.sourceforge.net/Docs/Chapter4.html#4.7.2)<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guardian9978</div><div class="date">25th May 2007, 10:04</div></div><div class="posttext">Since my next questions are on the same topic... <br />
<br />
1. How can I make it so that if the user doesnt install Setup1 first and runs Setup2 Manually that the Installer will tell the user to run Setup1 first?<br />
<br />
2. How can I make it so that if Setup1 was ran and they try to run it again it gives them the uninstall?<br />
<br />
Likewise if when the user trys to run setup2 again after it has already been installed make it so that it give them the uninstall?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">25th May 2007, 11:23</div></div><div class="posttext">1. write a key in the registry when setup1 complete successfully. check this registry key in setup2<br />
2. check the standard registry key where unistaller names are kept and run the uninstaller<br />
I use this defines at top of my install scripts:<br />
!define PRODUCT_UNINST_KEY &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}&quot;<br />
!define PRODUCT_UNINST_ROOT_KEY &quot;HKLM&quot;<br />
<br />
then define PRODUCT_NAME to what you want<br />
and in the uninstaller code add something like:<br />
<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayName&quot; &quot;$(^Name)&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayVersion&quot; &quot;${PRODUCT_VERSION}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;URLInfoAbout&quot; &quot;${PRODUCT_WEB_SITE}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;Publisher&quot; &quot;${PRODUCT_PUBLISHER}&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guardian9978</div><div class="date">25th May 2007, 12:00</div></div><div class="posttext">I should have mentioned im new at this... im learning slowly but im still figuring everything out. After I get these last 2 things in my installer is done.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">25th May 2007, 19:10</div></div><div class="posttext">Originally posted by Guardian9978 <br />
Since my next questions are on the same topic... <br />
<br />
1. How can I make it so that if the user doesnt install Setup1 first and runs Setup2 Manually that the Installer will tell the user to run Setup1 first?<br />
<br />
2. How can I make it so that if Setup1 was ran and they try to run it again it gives them the uninstall?<br />
<br />
Likewise if when the user trys to run setup2 again after it has already been installed make it so that it give them the uninstall? <br />
You may use  GetParameters (http://nsis.sourceforge.net/Docs/AppendixE.html#E.1)  to check if setup2 called from setup1 or a simpler way, FindWindow from setup2 to check if setup1 is running.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jackkoho</div><div class="date">25th May 2007, 19:50</div></div><div class="posttext">I would just do something like<br />
<br />
File setup2.exe<br />
<br />
.onInstSuccess<br />
<br />
Execwait setup2.exe<br />
<br />
delete setup2.exe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">25th May 2007, 20:11</div></div><div class="posttext">Originally posted by jackkoho <br />
I would just do something like<br />
<br />
File setup2.exe<br />
<br />
.onInstSuccess<br />
<br />
Execwait setup2.exe<br />
<br />
delete setup2.exe <br />
Originally posted by Guardian9978 <br />
Is there a way to run a second setup wizard after the first one has finished and the user has press Finished from a DVD?<br />
<br />
for Example:<br />
Setup1 installs<br />
Setup2 is called after the user clicks finish in Setup1.<br />
Both Setup1 and Setup2 are on a DVD.<br />
<br />
How can I do this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jackkoho</div><div class="date">25th May 2007, 20:52</div></div><div class="posttext">excuse me, im a newbie</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guardian9978</div><div class="date">26th May 2007, 07:36</div></div><div class="posttext">well the first response about having setup2 run after setup1 is done worked for me i just need to get the last 2 questions explained more since i really dont understand how to do any of it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">26th May 2007, 08:21</div></div><div class="posttext">FindWindow is pretty easy, for instance,<br />
# setup2 checking if setup1 is running<br />
function .onInit<br />
 FindWindow $0 &quot;&quot; &quot;Setup1_Window_Title&quot;<br />
  strcmp &quot;$0&quot; &quot;0&quot; _noexec _doexec<br />
<br />
_noexec:<br />
  MessageBox MB_OK &quot;My_Message&quot;<br />
  Quit<br />
<br />
_doexec:<br />
  # continue installation<br />
functionend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guardian9978</div><div class="date">26th May 2007, 10:14</div></div><div class="posttext">Not what I was meaning... Sorry if I wasn't more clear<br />
<br />
What I wanted is to have:<br />
<br />
Setup1 check to see if the game is installed on run and if it is then show uninstall Dialog<br />
<br />
Setup2 same as setup1 but only after it is finished with its installation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th May 2007, 14:03</div></div><div class="posttext">Think about how you will check if the game is installed. Registry? Existence of files?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guardian9978</div><div class="date">26th May 2007, 23:53</div></div><div class="posttext">existence of files would be good. That way if the user tries to run setup2 before setup1 I would be able to tell them to run setup1 first.<br />
<br />
for example:<br />
setup1 installs:<br />
1.file<br />
2.file<br />
<br />
and setup2 installs:<br />
3.file<br />
4.file<br />
<br />
Setup1 installs its files and then if the user tries to run setup1 again it will find the files setup1 already installed and gives the user to uninstall.<br />
<br />
Setup2 on run will check for setup1's files and if it finds them then installs its files.<br />
<br />
if Setup2 doesn't find setup1's files it tells the user to run setup1.<br />
<br />
After setup2 is done and they try to run setup2 again it checks for the existence of the files and if they exist then it shows them the uninstall.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th May 2007, 20:52</div></div><div class="posttext">But at the end of the day, you would probably have to use a registry entry for this. If the first installer writes the install path to the registry, then you can read that path in the second installer.<br />
<br />
Edit: Perhaps a good solution for this first and second installer installation order dependency would be to use InstallDirRegKey. If the first installer writes the path after a successful install, the second installer can check if that registry entry exists to determine if the first install has been completed.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guardian9978</div><div class="date">28th May 2007, 07:09</div></div><div class="posttext">The second installer already looks in the registry to know where to install its files.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>