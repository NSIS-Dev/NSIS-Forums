<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Win Xp $SYSDIR fails but full path OK, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Win Xp $SYSDIR fails but full path OK NSIS Discussion" />
	
	<title> Win Xp $SYSDIR fails but full path OK [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Win Xp $SYSDIR fails but full path OK</div>
<hr />
<div class="pda"><a href="t-339324.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=339324">Win Xp $SYSDIR fails but full path OK</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mshsrfc</div><div class="date">13th December 2011, 15:06</div></div><div class="posttext">Hi<br />
<br />
I have just started usiing NSIS and all going well with main files until I tried to use <br />
$SYSDIR for 2 files in the System32 folder. <br />
<br />
<br />
  SetOutPath &quot;$SYSDIR&quot;<br />
  StrCpy $INSTDIR $SYSDIR<br />
  File &quot;$INSTDIR\CNTRL32.dll&quot;<br />
<br />
Got compile error below :-<br />
<br />
File: &quot;$INSTDIR\CNTRL32.dll&quot; -&gt; no files found.<br />
Usage: File [/nonfatal] [/a] ([/r] [/x filespec [...]] filespec [...] |<br />
   /oname=outfile one_file_only)<br />
Error in script &quot;C:\Program Files\ITP\DevaMC2008.nsi&quot; on line 77 -- aborting creation process<br />
<br />
<br />
Used a message box to output $SYSDIR and got :-<br />
<br />
c:\windows\system32<br />
<br />
Replaced $INSTDIR with full path as below and got no complie errors and <br />
the file is installed correctly.<br />
<br />
  SetOutPath &quot;$SYSDIR&quot;<br />
  StrCpy $INSTDIR $SYSDIR<br />
  File &quot;c:\windows\system32\CNTRL32.dll&quot;<br />
  <br />
I have searched the net and this forum but no solution, has anyone got any ideas?<br />
<br />
Full nsi file below<br />
<br />
Mike<br />
<br />
Command line: <br />
&quot;C:\Program Files\NSIS\makensis.exe&quot;  /NOTIFYHWND 132394  &quot;C:\Program Files\ITP\DevaMC2008.nsi&quot;<br />
<br />
MakeNSIS v2.46 - Copyright 1995-2009 Contributors<br />
See the file COPYING for license details.<br />
Credits can be found in the Users Manual.<br />
<br />
Processing config: <br />
Processing plugin dlls: &quot;C:\Program Files\NSIS\Plugins\*.dll&quot;<br />
 - AdvSplash::show<br />
 - Banner::destroy<br />
 - Banner::getWindow<br />
 - Banner::show<br />
 - BgImage::AddImage<br />
 - BgImage::AddText<br />
 - BgImage::Clear<br />
 - BgImage::Destroy<br />
 - BgImage::Redraw<br />
 - BgImage::SetBg<br />
 - BgImage::SetReturn<br />
 - BgImage::Sound<br />
 - Dialer::AttemptConnect<br />
 - Dialer::AutodialHangup<br />
 - Dialer::AutodialOnline<br />
 - Dialer::AutodialUnattended<br />
 - Dialer::GetConnectedState<br />
 - InstallOptions::dialog<br />
 - InstallOptions::initDialog<br />
 - InstallOptions::show<br />
 - LangDLL::LangDialog<br />
 - Math::Script<br />
 - NSISdl::download<br />
 - NSISdl::download_quiet<br />
 - Splash::show<br />
 - StartMenu::Init<br />
 - StartMenu::Select<br />
 - StartMenu::Show<br />
 - System::Alloc<br />
 - System::Call<br />
 - System::Copy<br />
 - System::Free<br />
 - System::Get<br />
 - System::Int64Op<br />
 - System::Store<br />
 - TypeLib::GetLibVersion<br />
 - TypeLib::Register<br />
 - TypeLib::UnRegister<br />
 - UserInfo::GetAccountType<br />
 - UserInfo::GetName<br />
 - UserInfo::GetOriginalAccountType<br />
 - VPatch::GetFileCRC32<br />
 - VPatch::GetFileMD5<br />
 - VPatch::vpatchfile<br />
 - nsDialogs::Create<br />
 - nsDialogs::CreateControl<br />
 - nsDialogs::CreateItem<br />
 - nsDialogs::CreateTimer<br />
 - nsDialogs::GetUserData<br />
 - nsDialogs::KillTimer<br />
 - nsDialogs::OnBack<br />
 - nsDialogs::OnChange<br />
 - nsDialogs::OnClick<br />
 - nsDialogs::OnNotify<br />
 - nsDialogs::SelectFileDialog<br />
 - nsDialogs::SelectFolderDialog<br />
 - nsDialogs::SetRTL<br />
 - nsDialogs::SetUserData<br />
 - nsDialogs::Show<br />
 - nsExec::Exec<br />
 - nsExec::ExecToLog<br />
 - nsExec::ExecToStack<br />
<br />
!define: &quot;MUI_INSERT_NSISCONF&quot;=&quot;&quot;<br />
<br />
Changing directory to: &quot;C:\Program Files\ITP&quot;<br />
<br />
Processing script file: &quot;C:\Program Files\ITP\DevaMC2008.nsi&quot;<br />
!define: &quot;PRODUCT_NAME&quot;=&quot;DevaMC2008&quot;<br />
!define: &quot;PRODUCT_VERSION&quot;=&quot;11.12.8&quot;<br />
!define: &quot;PRODUCT_PUBLISHER&quot;=&quot;ITP Group&quot;<br />
!define: &quot;PRODUCT_WEB_SITE&quot;=&quot;http://www.itpgroup.co.uk&quot;<br />
!define: &quot;PRODUCT_DIR_REGKEY&quot;=&quot;Software\Microsoft\Windows\CurrentVersion\App Paths\DevaMC2008.exe&quot;<br />
!include: &quot;C:\Program Files\NSIS\Include\Library.nsh&quot;<br />
!include: closed: &quot;C:\Program Files\NSIS\Include\Library.nsh&quot;<br />
!include: &quot;C:\Program Files\NSIS\Include\UpgradeDLL.nsh&quot;<br />
!define: &quot;UPGRADEDLL_INCLUDED&quot;=&quot;&quot;<br />
!include: closed: &quot;C:\Program Files\NSIS\Include\UpgradeDLL.nsh&quot;<br />
!include: &quot;C:\Program Files\NSIS\Include\MUI2.nsh&quot;<br />
!include: &quot;C:\Program Files\NSIS\Contrib\Modern UI 2\MUI2.nsh&quot;<br />
NSIS Modern User Interface version 2.0 - Copyright 2002-2009 Joost Verburg (C:\Program Files\NSIS\Contrib\Modern UI 2\MUI2.nsh:8)<br />
!define: &quot;MUI_INCLUDED&quot;=&quot;&quot;<br />
!define: &quot;MUI_SYSVERSION&quot;=&quot;2.0&quot;<br />
!define: &quot;MUI_VERBOSE&quot;=&quot;3&quot;<br />
!include: closed: &quot;C:\Program Files\NSIS\Contrib\Modern UI 2\MUI2.nsh&quot;<br />
!include: closed: &quot;C:\Program Files\NSIS\Include\MUI2.nsh&quot;<br />
!define: &quot;MUI_ABORTWARNING&quot;=&quot;&quot;<br />
!define: &quot;MUI_ICON&quot;=&quot;..\..\AxelRelease\icon00.ico&quot;<br />
!insertmacro: MUI_PAGE_WELCOME<br />
!insertmacro: end of MUI_PAGE_WELCOME<br />
!insertmacro: MUI_PAGE_LICENSE<br />
!insertmacro: end of MUI_PAGEDECLARATION_LICENSE<br />
!insertmacro: end of MUI_PAGE_LICENSE<br />
!insertmacro: MUI_PAGE_COMPONENTS<br />
!insertmacro: end of MUI_PAGE_COMPONENTS<br />
!insertmacro: MUI_PAGE_INSTFILES<br />
!insertmacro: end of MUI_PAGE_INSTFILES<br />
!define: &quot;MUI_FINISHPAGE_RUN&quot;=&quot;$INSTDIR\DevaMC2008.exe&quot;<br />
!insertmacro: MUI_PAGE_FINISH<br />
!insertmacro: end of MUI_PAGE_FINISH<br />
!insertmacro: MUI_LANGUAGE<br />
!insertmacro: end of MUI_LANGUAGE<br />
Name: &quot;DevaMC2008 11.12.8&quot;<br />
OutFile: &quot;C:\AxelRelease\extra32\interface\ITPDEVAMC2008\SetupDevaMC.exe&quot;<br />
InstallDir: &quot;$PROGRAMFILES\itp&quot;<br />
InstallRegKey: &quot;HKLM\Software\Microsoft\Windows\CurrentVersion\App Paths\DevaMC2008.exe\&quot;<br />
ShowInstDetails: show<br />
Section: &quot;MainSection&quot; -&gt;(SEC01)<br />
SetShellVarContext: all<br />
Var: &quot;HKLM_ITP&quot;<br />
Var: &quot;SERIAL_NUMBER&quot;<br />
Var: &quot;INI_PATH&quot;<br />
StrCpy $HKLM_ITP &quot;Software\ITP Group&quot; () ()<br />
ReadRegStr $SERIAL_NUMBER HKLM\$HKLM_ITP\Serial Number<br />
StrCpy $INI_PATH &quot;$INSTDIR\$SERIAL_NUMBER&quot; () ()<br />
SetOutPath: &quot;$INSTDIR&quot;<br />
SetOverwrite: ifnewer<br />
File: &quot;DevaMC2008.exe&quot; [compress] 922556/3139584 bytes<br />
CreateDirectory: &quot;$SMPROGRAMS\ITP Group&quot;<br />
CreateShortCut: &quot;$SMPROGRAMS\ITP Group\DevaMC2008.lnk&quot;-&gt;&quot;$INSTDIR\DevaMC2008.exe&quot;  icon:,0, showmode=0x0, hotkey=0x0, comment=<br />
CreateShortCut: &quot;$DESKTOP\DevaMC2008.lnk&quot;-&gt;&quot;$INSTDIR\DevaMC2008.exe&quot;  icon:,0, showmode=0x0, hotkey=0x0, comment=<br />
SetOutPath: &quot;$INSTDIR\Help\DevaMC2008&quot;<br />
File: &quot;DevaMC2008-CN.chm&quot; [compress] 688402/694995 bytes<br />
File: &quot;DevaMC2008-EN.chm&quot; [compress] 1197352/1203204 bytes<br />
SetOutPath: &quot;$INSTDIR\Lang\DevaMC&quot;<br />
File: &quot;DevaMC2008_English.txt&quot; [compress] 5403/25820 bytes<br />
File: &quot;DevaMC2008_Chinese.txt&quot; [compress] 5429/19546 bytes<br />
SetOutPath: &quot;$INSTDIR&quot;<br />
File: &quot;XpiEditor.exe&quot; [compress] 69996/168960 bytes<br />
CreateShortCut: &quot;$SMPROGRAMS\ITP Group\XpiEditor.lnk&quot;-&gt;&quot;$INSTDIR\XpiEditor.exe&quot;  icon:,0, showmode=0x0, hotkey=0x0, comment=<br />
File: &quot;FifoPlot.exe&quot; [compress] 31141/94208 bytes<br />
File: &quot;PMD-1208-FS.EXE&quot; [compress] 263063/819200 bytes<br />
File: &quot;PMD_1208_FS.chm&quot; [compress] 189887/197675 bytes<br />
CreateShortCut: &quot;$SMPROGRAMS\ITP Group\PMD-1208-FS.lnk&quot;-&gt;&quot;$INSTDIR\PMD-1208-FS.exe&quot;  icon:,0, showmode=0x0, hotkey=0x0, comment=<br />
File: &quot;PMDZERO.exe&quot; [compress] 8029/24576 bytes<br />
CreateShortCut: &quot;$SMPROGRAMS\Startup\PMDZERO.lnk&quot;-&gt;&quot;$INSTDIR\PMDZERO.exe&quot;  icon:,0, showmode=0x0, hotkey=0x0, comment=<br />
SetOutPath: &quot;$SYSDIR&quot;<br />
StrCpy $INSTDIR &quot;$SYSDIR&quot; () ()<br />
File: &quot;$INSTDIR\CNTRL32.dll&quot; -&gt; no files found.<br />
Usage: File [/nonfatal] [/a] ([/r] [/x filespec [...]] filespec [...] |<br />
   /oname=outfile one_file_only)<br />
Error in script &quot;C:\Program Files\ITP\DevaMC2008.nsi&quot; on line 77 -- aborting creation process</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">13th December 2011, 17:44</div></div><div class="posttext">Please either use pastebin or an attachment to share huge amounts of code.<br />
<br />
Your mistake is simple: $SYSDIR and $INSTDIR are runtime variables. The File command is a compiletime command, so $SYSDIR and $INSTDIR do not have any value yet. The path parameter of File should point at where the file is on your development computer, not on the computer of whoever will be running your installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">13th December 2011, 20:37</div></div><div class="posttext">Use $%windir%</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mshsrfc</div><div class="date">15th December 2011, 11:23</div></div><div class="posttext">Thanks Anders <br />
<br />
Sorted now</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>