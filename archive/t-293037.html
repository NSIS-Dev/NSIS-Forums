<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Return to a custom page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Return to a custom page NSIS Discussion" />
	
	<title> Return to a custom page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Return to a custom page</div>
<hr />
<div class="pda"><a href="t-293037.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=293037">Return to a custom page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">LordDaimos</div><div class="date">12th June 2008, 07:41</div></div><div class="posttext">I have an installer project with two custom pages using InstallOptions. I've gotten it to work pretty well and as satisfied with it but I'm still having one last problem with it. When I go from the first custom page to the next and then press the back button it skips to the page before my first custom page. ie it goes from page three to page one in a single click where I would want it to go to page two.<br />
<br />
This is the code for page two<br />
Function ServicePage<br />
  ; Check if SEC01 is selected, if not then abort<br />
  SectionGetFlags ${SEC01} $R0<br />
  IntOp $R0 $R0 &amp; ${SF_SELECTED}<br />
  IntCmp $R0 ${SF_SELECTED} ShowServicePage<br />
  Abort<br />
<br />
  ShowServicePage:<br />
  !insertmacro MUI_HEADER_TEXT &quot;Service account setup&quot; &quot;Specify the username and password for the account that the service should run as&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;ServiceDialog.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;ServiceDialog.ini&quot;<br />
FunctionEnd<br />
<br />
!macro EnableField IniFilename SectionName Enable<br />
  Push $R0<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;${IniFilename}&quot; &quot;${SectionName}&quot; &quot;HWND&quot;<br />
  EnableWindow $R0 ${Enable}<br />
  Pop $R0<br />
!macroend<br />
<br />
Function ServicePageLeave<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $0 &quot;ServiceDialog.ini&quot; &quot;Settings&quot; &quot;State&quot;<br />
  IntCmp $0 1 0 NextCheck NextCheck<br />
  !insertmacro EnableField &quot;ServiceDialog.ini&quot; &quot;Field 3&quot; 0<br />
  !insertmacro EnableField &quot;ServiceDialog.ini&quot; &quot;Field 4&quot; 0<br />
  !insertmacro EnableField &quot;ServiceDialog.ini&quot; &quot;Field 5&quot; 0<br />
  Abort<br />
<br />
  NextCheck:<br />
  IntCmp $0 2 0 FinishServicePage FinishServicePage<br />
  !insertmacro EnableField &quot;ServiceDialog.ini&quot; &quot;Field 3&quot; 1<br />
  !insertmacro EnableField &quot;ServiceDialog.ini&quot; &quot;Field 4&quot; 1<br />
  !insertmacro EnableField &quot;ServiceDialog.ini&quot; &quot;Field 5&quot; 1<br />
  Abort<br />
  <br />
  FinishServicePage:<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $0 &quot;ServiceDialog.ini&quot; &quot;Field 1&quot; &quot;State&quot;<br />
  IntCmp $0 1 SystemAccount<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $SERVICEUSER &quot;ServiceDialog.ini&quot; &quot;Field 2&quot; &quot;State&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $SERVICEPASSWORD &quot;ServiceDialog.ini&quot; &quot;Field 4&quot; &quot;State&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $0 &quot;ServiceDialog.ini&quot; &quot;Field 4&quot; &quot;State&quot;<br />
  StrCmp $SERVICEPASSWORD $0 0 FinishServicePageEnd<br />
  Messagebox MB_ICONEXCLAMATION|MB_OK &quot;The input password doesn't match&quot;<br />
  Abort<br />
<br />
  SystemAccount:<br />
  StrCpy $SERVICEUSER &quot;&quot;<br />
  StrCpy $SERVICEPASSWORD &quot;&quot;<br />
  <br />
  FinishServicePageEnd:<br />
  Delete &quot;$Pluginsdir\ServiceDialog.ini&quot;<br />
FunctionEnd <br />
<br />
This is the code for page three<br />
<br />
Function DatabasePage<br />
  ; Check if SEC02 is selected, if not then abort<br />
  SectionGetFlags ${SEC02} $R0<br />
  IntOp $R0 $R0 &amp; ${SF_SELECTED}<br />
  IntCmp $R0 ${SF_SELECTED} ShowDatabasePage<br />
  Abort<br />
<br />
  ShowDatabasePage:<br />
  ReserveFile &quot;SQLDialog.ini&quot;<br />
  !insertmacro MUI_HEADER_TEXT &quot;Database setup&quot; &quot;Specify the necessary parameters to connect to the database&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;SQLDialog.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;SQLDialog.ini&quot;<br />
FunctionEnd<br />
<br />
Function DatabasePageLeave<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $SQLSERVER &quot;SQLDialog.ini&quot; &quot;Field 2&quot; &quot;State&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $SQLUSER &quot;SQLDialog.ini&quot; &quot;Field 4&quot; &quot;State&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $SQLPASSWORD &quot;SQLDialog.ini&quot; &quot;Field 7&quot; &quot;State&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $SQLDATABASE &quot;SQLDialog.ini&quot; &quot;Field 8&quot; &quot;State&quot;<br />
  Delete &quot;$TEMP\SQLDialog.ini&quot;<br />
FunctionEnd<br />
<br />
Anyone having any ideas why this happens?<br />
<br />
/ Karl</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th June 2008, 11:11</div></div><div class="posttext">Put a MessageBox before the Abort in Function ServicePage and see if you get the message when you click back. If so then it must be calling Abort and jumping over the page.<br />
<br />
Also you may want to move your MUI_INSTALLOPTIONS_EXTRACT insertmacros to .onInit as when you do click back and then forward again to the same page you will lose what you had entered/selected previously because the INI file will have been overwritten.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LordDaimos</div><div class="date">13th June 2008, 08:11</div></div><div class="posttext">Problem solved, I moved the deleting of the .ini-files to -Post and the extraction to .onInit and it started to work as expected! Thanks!<br />
<br />
/ Karl</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>