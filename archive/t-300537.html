<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Restart Manager / Uninstaller, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Restart Manager / Uninstaller NSIS Discussion" />
	
	<title> Restart Manager / Uninstaller [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Restart Manager / Uninstaller</div>
<hr />
<div class="pda"><a href="t-300537.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=300537">Restart Manager / Uninstaller</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">winflight</div><div class="date">2nd December 2008, 07:15</div></div><div class="posttext">My software must pass &quot;OEM Ready Program&quot; (like Windows logo Program). <br />
<br />
http://msdn.microsoft.com/en-us/windowsvista/cc315067.aspx <br />
<br />
However, the uninstaller of my softwareã€€which I made in NSIS fails on a test of Restart Manager.<br />
<br />
---------------<br />
3.1.1 : Verify the application is Restart Manager Aware<br />
TEST STEPS:<br />
For each Qualifying Applicationâ€™s main executable:<br />
1. Launch the application or start the service if your application is a service.<br />
2. Open the Windows Task Manager.<br />
 a. Click on the Processes tab or click on the Services tab if your application is a service. <br />
 b. From the View menu, select Select Columns.<br />
 c. Select the PID (Process Identifier) check box and click OK.<br />
 d. Click on Image Name to list all the current processes by name.<br />
 e. Find the application image name and make a note of its PID.<br />
<br />
3. Open an elevated command window (click Start / All Programs / Accessories, then right-click on Command Prompt and select Run as administrator).<br />
4. Change directory to the directory that contains the Restart Manager Test tool.<br />
5. In the command window type:<br />
 rmlogotest.exe dwPID<br />
 Where dwPID is the application's Process ID, obtained via Task Manager.<br />
<br />
<br />
NOTES:<br />
<br />
1. The application must be idle and must not be running or performing any operations while performing this test case.<br />
2. All applications must listen and respond to shutdown messages using the Restart Manager API quietly, without user interaction while idle in order to pass this test case.<br />
3. The application or service must not cause an Access Violation and it must shutdown/restart safely.<br />
4. Some applications require that a parameter be passed when the application is launched.  If the application being testing requires that such a parameter be passed, then the application will need to be launched manually prior to starting this automated test.<br />
5. Restart Manager shutdown messages are:<br />
<br />
WM_QUERYENDSESSION with LPARAM = ENDSESSION_CLOSEAPP(0x1)<br />
 GUI applications must respond (TRUE) immediately to prepare for a restart.<br />
 <br />
WM_ENDSESSION with LPARAM = ENDSESSION_CLOSEAPP(0x1)<br />
 The application must shutdown within 5 seconds (20 seconds for services).<br />
 <br />
CTRL_SHUTDOWN_EVENT<br />
 Console applications must shutdown immediately.<br />
<br />
---------------<br />
<br />
My software has a short cut of the uninstallation in program menu. <br />
<br />
When the uninstaller is executed first, it displays message box. <br />
And it starts uninstallation when I choose Yes. <br />
What should the uninstaller of the software that I made in NSIS have done to pass an above test?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd December 2008, 07:42</div></div><div class="posttext">does this really apply to the installer/uninstaller? IIRC you must use .MSI to even apply to these programs. Anyway, you could probably register for the restart thing if you know the name of the api and call it with the system plugin. NSIS also tries to prevent a shutdown, look on the nsis wiki for a solution for that</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>