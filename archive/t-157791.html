<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" .NET Assemblys RegAsm, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  .NET Assemblys RegAsm NSIS Discussion" />
	
	<title> .NET Assemblys RegAsm [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  .NET Assemblys RegAsm</div>
<hr />
<div class="pda"><a href="t-157791.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=157791">.NET Assemblys RegAsm</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Haggy</div><div class="date">27th November 2003, 15:01</div></div><div class="posttext">Hi!<br />
<br />
I'm using the NSIS for the first time.<br />
<br />
<br />
I want to make an Installer which installs severals .NET Assemblys. I've found here how to make it that i can use the gacutil.<br />
<br />
But how can I implement that the Nsis register my class by RegASM?<br />
<br />
Thank you all for your help<br />
<br />
Haggy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st December 2003, 14:02</div></div><div class="posttext">Is RegASM an executable too? If so, just execute it using ExecWait, Exec or the nsExec plug-in.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Haggy</div><div class="date">2nd December 2003, 08:38</div></div><div class="posttext">Hi<br />
Yes it is, but I don't know the path of it.<br />
<br />
Because it is in the .NET Directory and there in the Directory of the Current version e.g. 1.1.387 and i don' know how to get the current installed version auf .NET Framework, the user has :-/<br />
<br />
I don't know too if the regasm and the gacutil were only in the SDK or in the standard framework included.<br />
<br />
thank you<br />
<br />
Haggy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd December 2003, 11:54</div></div><div class="posttext">Well, if it's not big, I think you can save yourself the hassle and just include it in the installer. If it is big, you might be able to get the directory of the latest .NET framework using a varient of the following function:<br />
<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=24<br />
<br />
Please post your result on the Archive, if you can get that function to give you the directory of the latest version.<br />
<br />
BTW, I think gacutil and regasm come only with the SDK, but MSDN will probably know better.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">phallguy</div><div class="date">3rd January 2004, 11:00</div></div><div class="posttext">Since COM registration is a registry only based operation you can use the regasm tool on your local machine to generate the registry script that can be used to install your component. You can then use the standard registry manipulation tools in NSIS to update the registry. Simply add the /regfile:output parameter to the command line of the regasm tool to create the script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd January 2004, 12:13</div></div><div class="posttext">And to convert from .reg to .nsi you can use this tool:<br />
<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=296</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mattwilkinson</div><div class="date">19th December 2005, 10:27</div></div><div class="posttext">Can I just make the point that if you are using regasm to register your assembly, you should also unregister it in your uninstall section. Therefore if you are using a .reg file, you need to create one for registering and one for unregistering your assembly and package both of them.<br />
<br />
Because of this problem I have decided to register my assemblies on the machine using regasm (this gives a double check that the .NET framework is install btw because if regasm is no-where to be found - it needs to be installed)<br />
<br />
I have a problem however with the following lines:<br />
<br />
ClearErrors<br />
<br />
;find the location of RegAsm  <br />
  ReadRegStr $R1 HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft .NET Framework 2.0&quot; &quot;InstallLocation&quot;<br />
<br />
;execute regasm passing the path to my assembly  <br />
  Exec '&quot;$R1RegAsm&quot; &quot;${sInst}${sApp}.exe&quot; /silent /tlb:&quot;$SYSDIR\${sApp}.tlb&quot; /codebase'<br />
  IfErrors 0 +2<br />
  	MessageBox MB_OK &quot;Error Registering ${sInst}${sApp}&quot;<br />
<br />
The assembly registers ok but even though I am specifying the /silent option, I still get a empty dos style box appearing at this point.<br />
This will be a particular problem for me because I have around fifty of the these assemblies to register!<br />
<br />
Has anyone come across this problem?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th December 2005, 18:10</div></div><div class="posttext">You can use the nsExec plug-in which is bundled with NSIS, or the ExecDos plug-in (http://nsis.sourceforge.net/ExecDos).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>