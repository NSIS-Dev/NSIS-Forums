<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Different 'InstallDir's, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Different 'InstallDir's NSIS Discussion" />
	
	<title> Different 'InstallDir's [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Different 'InstallDir's</div>
<hr />
<div class="pda"><a href="t-112788.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=112788">Different 'InstallDir's</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">uweb</div><div class="date">4th November 2002, 15:26</div></div><div class="posttext">Hi everybody<br />
<br />
From my component select dialogue the user can select all items<br />
he wants to install. Than, he clicks on &quot;next&quot; and chooses the<br />
destination folder.<br />
So far, so good.<br />
<br />
What I am looking for is the following:<br />
If the user selects &quot;ABC&quot; he than choose the destination folder.<br />
But &quot;ABC&quot; should go into a complete different folder and only in<br />
the case he has selected &quot;ABC&quot; I want to have a *second* dialogue<br />
where he can choose the destination for &quot;ABC&quot;.<br />
<br />
Is this possible ?<br />
I have version 2.00b (or something very close to this)<br />
<br />
<br />
Cheers<br />
Uwe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jacob Metro</div><div class="date">4th November 2002, 15:49</div></div><div class="posttext">I'm not sure about how to code the logic to do exactly what you want, but a method which will help you is SetOutPath's.  Different INSTDIR's will be ignored by the compiler.  The first one listed will be the only one to work.  SetOutPath's though can be put inside seperate functions.<br />
So, build one function that installs &quot;ABC&quot; one way, and another function to install &quot;BCD&quot; another way.  I personally love SetOutPath.<br />
<br />
For example,<br />
<br />
InstallDir 'C:\WINNT'<br />
<br />
Section &quot;-FSIWIN&quot;<br />
SetOutPath $INSTDIR<br />
File /r 'C:\Documents and Settings\Administrator\Desktop\FSIWIN'<br />
SectionEnd<br />
<br />
Section &quot;-WHITNEYAPP&quot;<br />
SetOutPath '$INSTDIR\FSIWIN\WHITNEY.APP\'<br />
File 'C:\DOCUMENTS AND SETTINGS\ADMINISTRATOR\DESKTOP\WHITNEYAPP\*.*'<br />
CreateShortCut '$DESKTOP\MultiBank.lnk' '$INSTDIR\FSIWIN\WHITNEY.APP\MultiBank.exe' <br />
SectionEnd<br />
<br />
This code pulls files from $DESKTOP\FSIWIN and dumps it (recursively) into the WINNT directory.  It next pulls data from $DESKTOP\WHITNEYAPP and dumps it into the WINNT\FSIWIN\WHITNEY.APP folder.<br />
<br />
You could take out the dashes in front of the Section names and make check boxes from them.  Your user then could choose which data he wants to install.  And you could choose where you want that data to go.<br />
Again, I'm not really sure how to build the logic necessary to do everything you want, but I think this'll help.<br />
Thanks,<br />
Jacob</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th November 2002, 15:58</div></div><div class="posttext">He wants a second directory selection dialog, not just to output to a specific directory.<br />
<br />
What you need is InstallOptions. It allows you to create custom dialog pages. You can make a custom dialog with a directory selection box.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">4th November 2002, 16:10</div></div><div class="posttext">Can you fool NSIS, maybe use .onNextPage and .onPrevPage (yes I know the paging system has changed recently, but in versions which have .onBlah...) to reshow the choose folder dialog (I spose this relies on being able to store the previously chosen instdir into a variable, can that be done?) *or* can the new page system show the folder choice dialog twice?<br />
<br />
Sunjammer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">uweb</div><div class="date">4th November 2002, 16:10</div></div><div class="posttext">Hi,<br />
thanks for your replies<br />
<br />
Maybe I was not precise enough, yes, I need a *second* directory<br />
selection dialog. <br />
<br />
Thanks for the hint, i will try to figure out how<br />
InstallOptions work -:)<br />
<br />
<br />
Uwe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th November 2002, 16:19</div></div><div class="posttext">You can go back to the directory selection page, and you can show the same dialog twice. To change the text of the directory selection dialog you will have to use GetDlgItem and SendMessage. The only problem is it will save the new directory to the same $INSTDIR so you will have to save it in another variable. So, yes, it's another possible solution for this problem :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nils2000</div><div class="date">27th March 2003, 16:28</div></div><div class="posttext">HI<br />
<br />
these few lines solved the problem for me (NSIS 2 Beta 3, modern UI):<br />
<br />
;--------------------------------<br />
!define MUI_CUSTOMPAGECOMMANDS ; i think you need this one<br />
!define MUI_DIRECTORYPAGE<br />
!define MUI_CUSTOMFUNCTION_DIRECTORY_SHOW DirectoryShow<br />
!define MUI_CUSTOMFUNCTION_DIRECTORY_LEAVE DirectoryLeave<br />
;--------------------------------<br />
!insertmacro MUI_PAGECOMMAND_DIRECTORY ; due to MUI_CUSTOMPAGECOMMANDS<br />
!insertmacro MUI_PAGECOMMAND_DIRECTORY ; you can call this one twice, but you need to !insertmacro your other pages too. Since I've got custom pages, it makes no difference for me.<br />
;--------------------------------<br />
; Tweak directory page<br />
Function DirectoryShow<br />
  StrCmp $9 &quot;1&quot; ChangeDirectoryPage<br />
  StrCpy $9 &quot;1&quot; ; set state for next function entry<br />
  Goto EndDirectoryShow<br />
<br />
  ChangeDirectoryPage:<br />
    ; change Directory page here for your second directory to query<br />
    StrCpy $9 &quot;2&quot; ; last state<br />
<br />
  EndDirectoryShow:<br />
FunctionEnd<br />
;--------------------------------<br />
Function DirectoryLeave<br />
  StrCmp $9 &quot;1&quot; SaveInstallDir<br />
  StrCmp $9 &quot;2&quot; RestoreInstallDirAndSaveDatabaseDir<br />
  Goto EndDirectoryLeave<br />
<br />
  SaveInstallDir:<br />
    StrCpy $2 $INSTDIR ; store programm directory<br />
    Goto EndDirectoryLeave<br />
<br />
  RestoreInstallDirAndSaveDatabaseDir:<br />
    StrCpy $3 $INSTDIR ; store database directory<br />
    StrCpy $INSTDIR $2 ; restore programm directory<br />
<br />
  EndDirectoryLeave:<br />
FunctionEnd<br />
;--------------------------------<br />
<br />
In the end you've got your directory in $3 and $INSTALLDIR contains the choosen programm directory.<br />
<br />
Any suggestions to optimize this code are appreciated, since I don't really dig this script language.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>