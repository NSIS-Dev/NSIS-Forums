<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Finish page runs the executable multiple times, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Finish page runs the executable multiple times NSIS Discussion" />
	
	<title> Finish page runs the executable multiple times [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Finish page runs the executable multiple times</div>
<hr />
<div class="pda"><a href="t-262178.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=262178">Finish page runs the executable multiple times</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">soundken</div><div class="date">21st December 2006, 00:46</div></div><div class="posttext">I have the following code for the finish page:<br />
<br />
; Finish page<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE checkForAbort<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW postStage<br />
!define MUI_FINISHPAGE_RUN &quot;$INSTDIR\MyApp.exe&quot;<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
If by accident you click twice on the next button on the components page, when you get to the Finish page, it executes MyApp.exe but still shows the Finish page. When you click on Finish it runs MyApp.exe a second time. <br />
<br />
I've been able to get 3 MyApp.exe's running at the same time while still seeing the Finish page.<br />
<br />
This seems like a bug in NSIS, is there a way to prevent this? <br />
<br />
And MyApp already detects that another copy is running and shuts down, but I have to show a dialog box to the user that says another copy is running. So I get multiple dialog boxes open.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">21st December 2006, 09:29</div></div><div class="posttext">What is the purpose of that &quot;!define MUI_PAGE_CUSTOMFUNCTION_SHOW postStage&quot; ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">soundken</div><div class="date">21st December 2006, 17:57</div></div><div class="posttext">It does an InetLoad::load /SILENT /POST of a message to log that the user got to the finish page. Just because you mentioned it, I got rid of the define and I didn't get the duplicate run problem. So I changed to the LEAVE function and it seems to be working OK now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">21st December 2006, 18:34</div></div><div class="posttext">Well done! <br />
That's why I've asked about. The custom function show halts the dialog thus should have strange behaviour if it's not used for a few specific reasons.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>