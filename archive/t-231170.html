<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Dynamic NSIS variables?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Dynamic NSIS variables? NSIS Discussion" />
	
	<title> Dynamic NSIS variables? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Dynamic NSIS variables?</div>
<hr />
<div class="pda"><a href="t-231170.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=231170">Dynamic NSIS variables?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">LaneinBC</div><div class="date">16th November 2005, 16:20</div></div><div class="posttext">I tried this and it did not work. I thought I would ask here to see if there was a way to do this..<br />
<br />
Lets say we have some variables:<br />
Var vr1<br />
Var vr2<br />
Var vr3<br />
<br />
Now I wish to access variable &quot;$vr1&quot; like this:<br />
StrCpy $0 &quot;1&quot;<br />
IntOp $vr$1 $vr$1 + 1<br />
<br />
(should be the same as &quot;IntOp $vr1 $vr1 + 1&quot; )<br />
<br />
Is there a way to achieve this?<br />
<br />
Thanks<br />
Lane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">16th November 2005, 17:07</div></div><div class="posttext">I don't think what you want is possible the way you have shown it. <br />
If you want to do this during compiletime, use macros.<br />
e.g.,<br />
<br />
!macro INCREMENT VAR<br />
IntOp ${VAR} ${VAR} + 1<br />
!macroend<br />
<br />
Section<br />
!insertmacro INCREMENT $vr1<br />
SectionEnd<br />
<br />
<br />
At runtime, you can probably use a Function<br />
<br />
<br />
Function increment<br />
Exch $0<br />
IntOp $0 $0 + 1<br />
Exch $0<br />
FunctionEnd<br />
<br />
Section<br />
Push $vr1<br />
Call increment<br />
Pop $vr1<br />
SectionEnd<br />
<br />
<br />
However, I am not sure if this is what you are looking for.<br />
What exactly are you trying to do with these &quot;dynamic&quot; variables?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th November 2005, 17:16</div></div><div class="posttext">If you're trying to do an array of data, you can try my NSISArray plugin.<br />
<br />
http://nsis.sf.net/File:NSISArray.zip<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LaneinBC</div><div class="date">16th November 2005, 17:25</div></div><div class="posttext">I should have explained better.<br />
What I am trying to do, is to read 16 different values from an INI file (State and Text) and place each one into a matching named NSIS variable. I have this working, but it would be really nice if I could just put it into a &quot;loop&quot;. Would make the scipt easier to read and more maintainable.<br />
:D <br />
<br />
To put this into a program loop, I need to be able to use what I was calling &quot;dynamic&quot; NSIS variables.<br />
<br />
Can you suggest a method to do this?<br />
<br />
Thanks<br />
<br />
Lane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flyakite</div><div class="date">16th November 2005, 17:45</div></div><div class="posttext">StrCpy $0 &quot;1&quot;<br />
IntOp $vr$1 $vr$1 + 1<br />
<br />
Shouldn't $0 actually be $1?  You're setting the integer 1 to the variable $0.<br />
<br />
But in the next line, when you're trying to run an integer operation on it, you're trying to run it on $vr$1, and you never set anything to $1.<br />
<br />
Maybe I'm missing something here, but I don't see where else $0 comes into play.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LaneinBC</div><div class="date">16th November 2005, 17:47</div></div><div class="posttext">Yes, that was a &quot;typo&quot; on my part..<br />
It should have been $vr$0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flyakite</div><div class="date">16th November 2005, 17:52</div></div><div class="posttext">Okay, well in that case, I think you are using the IntOp operation on the wrong variable.  You are using it on $vr$1, expecting it to increment the variable vr1 to become vr2.  That won't happen, because it can not add an integer &quot;1&quot; to a string &quot;vr1&quot;.<br />
<br />
You should run IntOp on $0.<br />
IntOp $0 $0 + 1<br />
<br />
This way, the initial value &quot;1&quot;, on the next loop becomes 2, and therefore the new variable that $vr$0 would access is &quot;vr2&quot;.<br />
<br />
At least I think that's what should be happening.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">16th November 2005, 17:55</div></div><div class="posttext">The best suggestion is probably Afrow UK's NSISArray plugin.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LaneinBC</div><div class="date">16th November 2005, 17:57</div></div><div class="posttext">Yes, that is what I initially thought too.<br />
But it seems the substituting &quot;$vr$0&quot; for &quot;$vr1&quot;, does not work. (where $0 was set to &quot;1&quot;).<br />
<br />
It works in normal string substitution, but not when you need it to refer to an NSIS variable.<br />
<br />
That is what I have been trying to get going...<br />
<br />
Lane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">16th November 2005, 18:04</div></div><div class="posttext">That's because the substitution is being done at compiletime, not runtime.<br />
At compile time, the compiler extracts a token named $vr$0 from the command.<br />
It then tries to resolve the token and sees that it consists of two variables: $vr and $0.<br />
When it tries to resolve $vr it fails.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LaneinBC</div><div class="date">16th November 2005, 18:09</div></div><div class="posttext">Yes, I understand what is happenig now.<br />
Perhaps a future NSIS release could support something like this, or could have native array support!<br />
<br />
Thanks<br />
<br />
Lane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th November 2005, 19:11</div></div><div class="posttext">I think that that would just add to the installer overhead.<br />
<br />
Edit: If you want to clean up your code, use a macro and insert it multiple times.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dandaman32</div><div class="date">24th November 2005, 18:21</div></div><div class="posttext">Upgrade to NSIS 2.11 and use the !tempfile, !appendfile, and !delfile commands to dynamically generate script files.<br />
<br />
-dandaman32</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>