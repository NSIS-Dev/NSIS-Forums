<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Aero plug-in, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Aero plug-in NSIS Discussion" />
	
	<title> Aero plug-in [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Aero plug-in</div>
<hr />
<div class="pda"><a href="t-329990.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=329990">Aero plug-in</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th April 2011, 00:24</div></div><div class="posttext">http://nsis.sourceforge.net/mediawiki/images/a/ad/Aero.png<br />
<br />
Enables Windows Aero glass effect on NSIS (outer) UI.<br />
<br />
http://nsis.sf.net/File:Aero.zip<br />
<br />
Edit: Worth noting this plug-in does nothing on &lt; Vista or when DWM composition (glass) is disabled on installer init. The plug-in handles theme changes once it has been loaded (i.e. reverts to original UI if glass is disabled).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">25th April 2011, 06:44</div></div><div class="posttext">Looks very nice indeed, thanks for sharing!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">26th April 2011, 06:57</div></div><div class="posttext">hah, funny I will try it!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smurge</div><div class="date">28th April 2011, 12:52</div></div><div class="posttext">nice plug-in, thank you very much!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">28th April 2011, 13:14</div></div><div class="posttext">I made a plugin similar to this a while back but I never got around to posting it since I could not find a documented value to use for the text glow size. Did you just make one up or what?<br />
<br />
I guess I don't have to complete my version now, thanks Afrow =)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th April 2011, 14:05</div></div><div class="posttext">Just used 10. You can actually get the glow size from the current theme using another API so I may change it.<br />
<br />
I've had a report of the button text being transparent on one or two machines which doesn't seem to happen on any of mine so I might need to fix that soon. When you use the branding text with glow, it has to paint a black brush where the aero is but that results in the button text being transparent too (looks awful) and therefore I've had to do some simple button drawing myself (using WM_PAINTCLIENT). To fix the button text at the moment I'm just using WM_PAINTCLIENT onto the current DC's HBRUSH (this seems to work fine for me - but I don't really know why lol). However, I may have to use double buffering (BeginBufferedPaint) with a portion with full opacity (BufferedPaintSetAlpha) to fix properly. Will post new version today probably. Other option is owner draw the buttons but I want to avoid that. I'd rather let Windows do it for me (WM_PAINTCLIENT).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th April 2011, 22:17</div></div><div class="posttext">New version uploaded which uses the glow size for the current theme and fixes the button text transparency bug on some systems.<br />
<br />
FYI to get the glow size (12 by default) you use GetThemeInt with TMT_TEXTGLOWSIZE. The theme I used is &quot;CompositedWindow::Window&quot;.<br />
<br />
Probably worth mentioning also that if you use /nobranding then because the plug-in does not need to draw any glow text, it doesn't need to use a black brush for the aero (I use magic pink instead with SetLayeredWindowAttributes/LWA_COLORKEY). As a result, the buttons are untouched and therefore you get the proper button glow fade in/out on mouse in/out. Owner-drawn or WM_PAINT handled buttons lose this fade in/out unfortunately and there's nothing one can do about it. Even .NET apps loses this effect if you set UseCompatibleTextRendering=true for buttons. The missing effect is not noticeable though (unless you're me lol) so branding text is on by default :).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">3rd May 2011, 00:53</div></div><div class="posttext">Is SetLayeredWindowAttributes + DwmExtendFrameIntoClientArea a valid thing to do? IIRC SetLayeredWindowAttributes had problems with the DWM in the early Vista days.<br />
<br />
<br />
You are using &quot;CompositedWindow::Window&quot; when loading and &quot;Window&quot; in WM_THEMECHANGED, this can't be correct can it?<br />
<br />
<br />
Also, you are hard-coding a 2px change in what I assume is some sort of button border hack? What about alternative Visual Styles?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd May 2011, 12:58</div></div><div class="posttext">Is SetLayeredWindowAttributes + DwmExtendFrameIntoClientArea a valid thing to do? IIRC SetLayeredWindowAttributes had problems with the DWM in the early Vista days.<br />
<br />
<br />
You are using &quot;CompositedWindow::Window&quot; when loading and &quot;Window&quot; in WM_THEMECHANGED, this can't be correct can it?<br />
<br />
<br />
Also, you are hard-coding a 2px change in what I assume is some sort of button border hack? What about alternative Visual Styles?<br />
<br />
1. I've tested on Vista and it seems to work OK. Maybe I shouldn't bother though and just go with the black brush method. Both methods are written about by Microsoft developers though IIRC.<br />
<br />
2. Well spotted. Will fix.<br />
<br />
3. Yes. I'm having to set the inner part of the button to opaque to fix the black-&gt;transparent button text. I originally used 4px but 2px seems to be the minimum. I never thought of other themes. Not sure if there is a better way to do this without having to draw the button myself. Any ideas?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">3rd May 2011, 13:11</div></div><div class="posttext">In my plugin I use one of the theme api's to calculate the size of the button IIRC<br />
<br />
Also, you are destroying windows you don't own, this is not OK IMHO (In my Aero plugin I hide them and if aero is turned off, I display them again, 100% original layout in classic theme...)<br />
<br />
As a final note; I don't really think &quot;_WndProc_&quot; is the best prop name to use, it is a bit generic, I'm using &quot;NSIS:P:Aero&quot;, feel free to using something similar (or the same, both plugins should not be used at the same time anyway)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd May 2011, 13:33</div></div><div class="posttext">So is that how your plug-in does the buttons too or does it owner-draw them?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">3rd May 2011, 14:03</div></div><div class="posttext">So is that how your plug-in does the buttons too or does it owner-draw them?<br />
<br />
<br />
I use subclassing and WM_PRINT?CLIENT? like you do, but I use one of the GetThemeBackgroundSomething functions to calculate the area to mask off for the round corners.<br />
<br />
I was going to look into adding the animation back but got bored and stopped working on the plugin...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd May 2011, 14:38</div></div><div class="posttext">Is it GetThemeBackgroundRegion? How would that be used with BufferedPaintSetAlpha which requires a RECT?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">3rd May 2011, 14:42</div></div><div class="posttext">I'm thinking it was GetThemeBackgroundContentRect<br />
<br />
But you should be able to get a RECT from HRGN also...<br />
<br />
Or you can use the HRGN to mask off the HDC...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd May 2011, 20:36</div></div><div class="posttext">So far so good although I've just remembered why I had to destroy those controls instead of hiding them (at least for MUI). MUI hides/shows them itself when you enter/leave the welcome/finish pages. How did you overcome this or did you not notice this problem?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">3rd May 2011, 22:42</div></div><div class="posttext">I probably re-hide them on every page change...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd May 2011, 23:19</div></div><div class="posttext">In response to WM_NOTIFY_OUTER_NEXT? It seems that the show function gets called after that notification and so my attempts fail. Calling the old window procedure first also doesn't seem to work. I guess one option, which would also avoid any potential flickering of the controls being shown/hidden, would be to move them off the UI on plug-in load while saving their original positions...<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">4th May 2011, 09:00</div></div><div class="posttext">here's what happens when defining MUI_BGCOLOR (mind the background of those buttons)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">4th May 2011, 09:38</div></div><div class="posttext">I'll look into it thanks.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">4th May 2011, 15:49</div></div><div class="posttext">New plug-in version (.2) uploaded. Still waiting for Yathosho to check his button issue is fixed though (but I can't seem to reproduce so perhaps it is fixed).<br />
<br />
Fair number of changes/fixes:1.0.0.2 - 4th May 2011<br />
* Fixed typo Window -&gt; CompositedWindow::Window in WM_THEMECHANGED<br />
  (thanks Anders).<br />
* Now uses theme text colour for branding text (but still original<br />
  font).<br />
* Improved fall-back drawing if DWM composition is disabled (all drawing<br />
  then handled by Windows/NSIS).<br />
* Now re-shows old branding text and horizontal ruler when DWM<br />
  composition is disabled.<br />
* Plug-in now loads even if DWM composition is disabled, but could be<br />
  enabled.<br />
* Now only handles WM_CTLCOLORBTN for the Back, Next and Cancel buttons.<br />
* Now uses GetThemeBackgroundContentRect to determine the button area<br />
  to draw opaque.Stu<br />
<br />
Edit: Oh and I changed the button property names to _StuAeroWndProc_ :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jiake</div><div class="date">18th May 2011, 03:51</div></div><div class="posttext">Feedback for others:<br />
http://www.ijeffio.com/nsis/Aero%20plug-in.jpg<br />
<br />
Chinese charactor didn't display when using this plug-in.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">18th May 2011, 08:27</div></div><div class="posttext">@jiake: Did you use Unicode NSIS?<br />
I assume ANSI NSIS cannot display them correctly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jiake</div><div class="date">18th May 2011, 09:20</div></div><div class="posttext">I have not used the plugin yet, for I am still using Windows XP.<br />
The problem was found by other person, he lets me to feedback.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">18th May 2011, 11:54</div></div><div class="posttext">Currently using MultiByteToWideChar in the ANSI plug-in (DrawThemeTextEx is Unicode only) so this is likely the problem. I will change the code to avoid it when I have time (i.e. call GetWindowTextW).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th May 2011, 10:32</div></div><div class="posttext">New version uploaded which should fix your Chinese characters bug (I hope).1.0.0.3 - 19th May 2011<br />
* Now always uses GetWindowTextW for the branding text (as DrawThemeTextEx is Unicode only).Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st July 2011, 11:26</div></div><div class="posttext">New version:* Fixed transparent button text in some situations for Next/Back/Cancel buttons.http://nsis.sourceforge.net/File:Aero.zip<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">3rd July 2011, 22:23</div></div><div class="posttext">no longer got that problem with the latest build</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">4th July 2011, 22:44</div></div><div class="posttext">* Fixed transparent button text in some situations for Next/Back/Cancel buttons.<br />
<br />
did anybody say transparency?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">6th July 2011, 06:15</div></div><div class="posttext">@Yathosho: MUI2 contains two dialogs: outer [which is transparent] and inner dialog [that grey area]<br />
There is probably som problem with inner dialog transparency...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th July 2011, 11:02</div></div><div class="posttext">I'm not sure what you are trying to do but you can't mix Aero with Windows controls without owner drawing them. I had to draw the navigation buttons myself to fix the transparency issue (and it still wasn't perfect until the last release). The problem is that the transparency key is black (and it has to be) and so all black objects (text etc.) will be rendered transparent.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">7th July 2011, 17:48</div></div><div class="posttext">I'm not sure what you are trying to do but you can't mix Aero with Windows controls without owner drawing them. I had to draw the navigation buttons myself to fix the transparency issue (and it still wasn't perfect until the last release). The problem is that the transparency key is black (and it has to be) and so all black objects (text etc.) will be rendered transparent.<br />
<br />
Stu<br />
<br />
this made the difference, not the colors<br />
#old code<br />
ShowWindow $HWNDPARENT 2<br />
BringToFront<br />
Aero::Apply ;causes infrequent crashes<br />
<br />
#new code<br />
Aero::Apply ;causes infrequent crashes<br />
ShowWindow $HWNDPARENT 2<br />
BringToFront</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">7th July 2011, 20:40</div></div><div class="posttext">Just noticed this plug-in. Great stuff. Thanks for sharing :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th July 2011, 11:24</div></div><div class="posttext">I haven't experienced any crashes. Please can you post a script which reproduces the problem.<br />
<br />
Edit: and what is the minimize and bring to front for?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">isawen</div><div class="date">8th July 2011, 14:05</div></div><div class="posttext">First of all I would like to give you a big :up: for the great work you have made with this plugin.<br />
<br />
And my question :) is ...<br />
The branding text is displayed on WelcomeFinish page when Aero is activated; when Aero is deactivated, the branding text is hidden. I'm used to not have this branding text on the first and last page. Did you intend to have this branding text displayed while Aero is activated or it's a bug? Is there a way to not have it displayed on first&amp;last page?<br />
<br />
Thanks<br />
Isawen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th July 2011, 15:13</div></div><div class="posttext">At the moment the branding text is either drawn or it isn't. It's not a static text control, it is simply drawn where the original static text used to be. Because of this, MUI does not hide/show it. I will fix it when I have time.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">9th July 2011, 02:12</div></div><div class="posttext">Edit: and what is the minimize and bring to front for?<br />
<br />
Stu<br />
<br />
I'm guessing this fixes some kind of drawing bug...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th July 2011, 12:50</div></div><div class="posttext">1.0.0.5 - 9th July 2011<br />
* Branding text now hidden when branding text static text control is hidden.Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">11th July 2011, 21:19</div></div><div class="posttext">Is there any chance to have the branding text centered in &quot;classic&quot; UI?<br />
<br />
http://img804.imageshack.us/img804/179/webupdate20110711221736.png</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th July 2011, 21:55</div></div><div class="posttext">Possibly but keep in mind there's a hidden Back button there so even if I do centre it it won't be centred in between Cancel and Close. The original branding text isn't centred IIRC it just happens to fit nicely for classic UI (when you have all 3 buttons).<br />
<br />
Edit: It is in fact but still only centred between the 3 buttons.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">11th July 2011, 22:00</div></div><div class="posttext">Possibly but keep in mind there's a hidden Back button there so even if I do centre it it won't be centred in between Cancel and Close. The original branding text isn't centred IIRC it just happens to fit nicely for classic UI (when you have all 3 buttons).<br />
<br />
Edit: It is in fact but still only centred between the 3 buttons.<br />
<br />
Stu<br />
<br />
Yup, I know it's centered between the three buttons and still wouldn't be perfectly centered with only two buttons visible. Anyway, I think it looks better than glued to the left button. Also moving the buttons down by a few pixels wouldn't hurt (if possible).<br />
<br />
Thanks :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th July 2011, 00:12</div></div><div class="posttext">1.0.0.6 - 12th July 2011<br />
* Fixed branding text not re-showing on DWM disable and re-enable.<br />
* Centred branding text for classic UI.<br />
* Nudged buttons down by 3 pixels for classic UI.Night :)<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">12th July 2011, 00:27</div></div><div class="posttext">Night :)<br />
<br />
Stu<br />
<br />
Great :up:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">14th July 2011, 18:48</div></div><div class="posttext">not sure if it's just me (again?), but the glow effect on the left border seems cut off.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th July 2011, 18:56</div></div><div class="posttext">That's odd I don't get that. Are you using a modified UI? It uses the same left coordinate that the original branding text is which is 5 dialog units from the left according to Resource Hacker (modern.exe).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">14th July 2011, 19:02</div></div><div class="posttext">nope, using mui2. no special windows theme or alternate shell either, i tested the win7 standard theme as well. get the same when compiling Examples\makensis.nsi with added aero plugin.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th July 2011, 19:05</div></div><div class="posttext">Is that the latest plug-in version? You shouldn't have any branding text on the welcome/finish pages.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">14th July 2011, 21:54</div></div><div class="posttext">Just a side note:<br />
<br />
With a none standard DPI setting (i.e. other than &quot;96 dpi&quot; aka &quot;100%&quot;), there is a strange border with Aero plug-in enabled.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">15th July 2011, 08:28</div></div><div class="posttext">Is that the latest plug-in version? You shouldn't have any branding text on the welcome/finish pages.<br />
<br />
Stu<br />
<br />
true, i didn't use the latest version. i recompiled and there's no branding on the welcome page. can't say if anything else changed as i'm logged in via RDP (no aero!), will do so when i get home.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">15th July 2011, 18:32</div></div><div class="posttext">the branding text is no longer cut off when using the latest version!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">isawen</div><div class="date">2nd August 2011, 13:09</div></div><div class="posttext">Stu, if you set a big text for the branding text you should see that it's overlapped by the Back button.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Collector9999</div><div class="date">3rd November 2011, 09:12</div></div><div class="posttext">I just started experimenting with this plugin. It looks good, but I found one oddity. If a link is added to the finish page, the text color of the link changes to black with a black line below and a black block to the right.<br />
http://www.sierrahelp.com/Temp/Aero.png</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">4th November 2011, 06:42</div></div><div class="posttext">This is known bug - it is the same thing which Checkbox/Radiobuttons suffer too.<br />
I use XPStyle off to remove this behaviour, but maybe Stu will know what to change in sources to remove it completely.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">4th November 2011, 14:04</div></div><div class="posttext">MUI2? This isn't the same as checkboxes/radiobuttons. Static texts should not have this problem, although a link may do (which is a static text with added effects) but that depends on the code behind it.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">4th November 2011, 14:09</div></div><div class="posttext">Strange. No such problem here:<br />
http://img443.imageshack.us/img443/1002/lamexpv403final1build76n.png</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">4th November 2011, 14:53</div></div><div class="posttext">Yeah that's why I think he might be using MUI1.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Collector9999</div><div class="date">5th November 2011, 00:10</div></div><div class="posttext">It is MUI2. I am using MUI_FINISHPAGE_LINK and MUI_FINISHPAGE_LINK_LOCATION for the finish page link.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">5th November 2011, 15:16</div></div><div class="posttext">Me too... :confused:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Collector9999</div><div class="date">6th November 2011, 06:11</div></div><div class="posttext">I just tried adding the MUI_FINISHPAGE_LINK and MUI_FINISHPAGE_LINK_LOCATION  to the &quot;Aero ModernUI.nsi&quot; example included with the plug in and got the same results. I had the logging build of NSIS, so to be sure that it was not something odd with it, I compiled the script with the normal ANSI NSIS 2.46 and still got the same results with both my script and the example with the finish page link added. My machine is Win7 x64 Pro, if that might make any difference.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">6th November 2011, 12:30</div></div><div class="posttext">I always use Unicode NSIS, if that matters.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Collector9999</div><div class="date">7th November 2011, 08:31</div></div><div class="posttext">I have been putting off installing Unicode NSIS. Perhaps I'll give it a try to see if it fixes it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th November 2011, 10:13</div></div><div class="posttext">I am using non Unicode NSIS and I do not have the problem (Windows 7 Professional x64). Please can you write a minimal script that reproduces the problem.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">7th November 2011, 14:13</div></div><div class="posttext">have you set custom colors for any element in your script? i had similiar problems when using a custom header background color, though i think the problem disappeared in a later version</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Collector9999</div><div class="date">7th November 2011, 14:37</div></div><div class="posttext">Unicode did not help. It happens even with the included example if I add a finish page link:<br />
!include MUI2.nsh<br />
<br />
OutFile TestModernUI.exe<br />
RequestExecutionLevel user<br />
<br />
!define MUI_CUSTOMFUNCTION_GUIINIT onGUIInit<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_LICENSE ModernUI.nsi<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!define MUI_FINISHPAGE_LINK &quot;Click here to find more New Sierra Game Installers&quot;<br />
!define MUI_FINISHPAGE_LINK_LOCATION &quot;http://www.sierrahelp.com/Patches-Updates/NewSierraInstallers.html&quot;<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
!insertmacro MUI_LANGUAGE English<br />
<br />
Function onGUIInit<br />
<br />
  Aero::Apply<br />
<br />
FunctionEnd<br />
<br />
Section<br />
SectionEnd<br />
I am not using any custom themes on my system.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th November 2011, 14:44</div></div><div class="posttext">Looks fine for me :(.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Collector9999</div><div class="date">7th November 2011, 22:07</div></div><div class="posttext">I'm not sure what's happened to my post. How many more of my posts have to be approved before I can just post?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">8th November 2011, 01:02</div></div><div class="posttext">Collector9999: Which exact version of windows is this? Win7 SP0 x86? Could you create an extra label and set the color on it (and maybe transparent background) and see what happens?<br />
<br />
Afrow: Is it possible that you are doing a black FillRect or not restoring a HDC or something like that? The problem could be in the link control also of course, a dev needs to reproduce the issue before we can board the blame train :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Collector9999</div><div class="date">8th November 2011, 02:46</div></div><div class="posttext">My PC is Win7 x64 Pro SP1. I am not sure what you mean with the extra label.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Collector9999</div><div class="date">8th November 2011, 08:06</div></div><div class="posttext">OK, I figured out what you meant, but I am not sure how to set a transparent background. It also has the black at the side of the new link.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Collector9999</div><div class="date">10th November 2011, 02:58</div></div><div class="posttext">When the Aero plugins is enabled it will not let me change the color of the link. It is always black. I can change the color of an extra link, even though it also has the same black block.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Collector9999</div><div class="date">12th November 2011, 19:12</div></div><div class="posttext">I had a number of people test a build of the above script compiled with a clean installation of NSIS with only the Aero plugin added and they got the same result. So the issue is not with how my system displays it nor in any customizations of NSIS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Collector9999</div><div class="date">12th November 2011, 19:23</div></div><div class="posttext">Sorry for the multiple posts, but I have solved the problem. I got the plugin from the Wiki but I had an earlier build. Updating it to the latest fixed it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">voyteckst</div><div class="date">29th November 2011, 06:02</div></div><div class="posttext">Hi. Is it intended to work also with UMUI?<br />
http://imageshack.us/photo/my-images/94/umuiaero.jpg/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">29th November 2011, 10:55</div></div><div class="posttext">I have not tested it with UMUI nor do I use it so no.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">voyteckst</div><div class="date">29th November 2011, 11:10</div></div><div class="posttext">Have You seen screenshot? IS it somehow fixable or not?<br />
<br />
If not, is that easy to move from UMUI to MUI2?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">29th November 2011, 12:12</div></div><div class="posttext">Yes I saw the screenshot. The plug-in only supports the official MUI, MUI2 and classic UIs, which do not use any skinning. It would not be possible to get UMUI to work with aero because of the skinning. It should be fairly easy to convert the script to MUI2; just look at the MUI2 example scripts.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">voyteckst</div><div class="date">29th November 2011, 13:17</div></div><div class="posttext">Yes I saw the screenshot. The plug-in only supports the official MUI, MUI2 and classic UIs, which do not use any skinning. It would not be possible to get UMUI to work with aero because of the skinning. It should be fairly easy to convert the script to MUI2; just look at the MUI2 example scripts.<br />
<br />
Stu<br />
<br />
Ok thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th April 2012, 18:48</div></div><div class="posttext">New version:1.0.0.7 - 26th April 2012<br />
* Implemented a new button drawing method to fix white text flicker (/btnold switch reverts to the old method).<br />
* Now disables Aero if the theme data cannot be loaded on theme change.Explanations of the old and new button drawing methods and their pros and cons are in the readme.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GaNi</div><div class="date">25th May 2012, 22:21</div></div><div class="posttext">Afrow,<br />
<br />
With this new plugin, the option /nobranding makes the UI draw no button at all. Alternatively using /nobranding /btnold uses older library to draw I guess.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GaNi</div><div class="date">26th May 2012, 18:09</div></div><div class="posttext">Afrow,<br />
<br />
With this new plugin, the option /nobranding makes the UI draw no button at all. Alternatively using /nobranding /btnold uses older library to draw I guess.<br />
<br />
Edit: Installer crashes</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">26th May 2012, 19:28</div></div><div class="posttext">Bad news for people that like the Aero plug-in:<br />
http://www.wired.com/gadgetlab/2012/05/microsoft-drops-aero-glass-ui-in-windows-8/<br />
<br />
It seems that Microsoft currently tires to cripple the &quot;classical&quot; Desktop as much as possible in order to make &quot;Metro&quot; appear less annoying/limited. The result will be an OS that has a &quot;Touchscreen&quot; interface, which is completely unusable and infeasible for anything but Tablet computers, combined with a totally crippled Desktop, which isn't more than a emergency fall-back feature. I would be fine to consider Windows 8 a pure Tablet-OS, but my biggest fear is that the epic fail of Windows 8 that we'll see on the Desktop market (we'll see how well it goes on the &quot;Mobile&quot; market) will give a great boost to Mac OS X. Might also be chance for Linux to gain some popularity though...<br />
<br />
:rolleyes:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">27th May 2012, 21:08</div></div><div class="posttext">/ot this will drop win8 finally to death on desktops. win7 is supportet till 2020 - 8 years to go now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th May 2012, 22:25</div></div><div class="posttext">Afrow,<br />
<br />
With this new plugin, the option /nobranding makes the UI draw no button at all. Alternatively using /nobranding /btnold uses older library to draw I guess.Fixed.<br />
<br />
1.0.0.8 - 27th May 2012<br />
* Fixed buttons not being drawn and crash when using /nobranding.Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GaNi</div><div class="date">28th May 2012, 01:20</div></div><div class="posttext">Bad news for people that like the Aero plug-in:<br />
http://www.wired.com/gadgetlab/2012/05/microsoft-drops-aero-glass-ui-in-windows-8/<br />
<br />
It seems that Microsoft currently tires to cripple the &quot;classical&quot; Desktop as much as possible in order to make &quot;Metro&quot; appear less annoying/limited. The result will be an OS that has a &quot;Touchscreen&quot; interface, which is completely unusable and infeasible for anything but Tablet computers, combined with a totally crippled Desktop, which isn't more than a emergency fall-back feature. I would be fine to consider Windows 8 a pure Tablet-OS, but my biggest fear is that the epic fail of Windows 8 that we'll see on the Desktop market (we'll see how well it goes on the &quot;Mobile&quot; market) will give a great boost to Mac OS X. Might also be chance for Linux to gain some popularity though...<br />
<br />
:rolleyes:<br />
<br />
This release would be a total fail as Vista. I guess, very few people would upgrade to windows 8.<br />
<br />
@Affrow,<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">25th January 2013, 23:06</div></div><div class="posttext">Afrow UK,<br />
<br />
today I rebuilt one of my installers in order to update some of the files included. The installer is using the &quot;inetc&quot; plug-in and I noticed that the text in the &quot;Cancel&quot; button (while downloading) had disappeared! Since the installer script had not been modified, I was quite surprised. My next thought was about the plug-in versions. So I extracted the plug-in DLL's from the &quot;old&quot; working binary of the installer. I discovered that I was still building with the very same &quot;inetc.dll&quot; (latest version available) but had updated the &quot;aero.dll&quot; in the meantime! And indeed, switching back to the older &quot;aero.dll&quot; resolved the issue. So I believe this might be a bug in your &quot;aero&quot; plug-in :confused:<br />
<br />
Aero.DLL version 2012-03-10:<br />
http://img14.imageshack.us/img14/8890/aerodllold.png<br />
<br />
Aero.DLL version 2012-05-27:<br />
http://img42.imageshack.us/img42/3456/aerodllnew.png<br />
<br />
Really only change is the Aero.DLL. I'm using Unicode NSIS (v2.46.5) , in case that matters.<br />
<br />
Any thoughts?<br />
<br />
Thanks and keep up the good work,<br />
MuldeR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th January 2013, 12:22</div></div><div class="posttext">This occurs because the Aero plug-in draws the Cancel button text itself. The inetc plug-in reads the Cancel button text to use it for its own Cancel button but gets an empty string. Just add /canceltext $(^CancelBtn) to the inetc plug-in call.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">28th January 2013, 12:45</div></div><div class="posttext">Thank you for the reply.<br />
<br />
So I now have to set all texts for &quot;inetc&quot; manually. Fair enough. Still I wonder why the (slightly) older version didn't need such workaround.<br />
<br />
Something must have changed between those two versions that &quot;broke&quot; it...<br />
<br />
Regards,<br />
MuldeR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th January 2013, 13:28</div></div><div class="posttext">You don't have to set all the texts, just the Cancel text. And giving it $(^CancelBtn) is what it would be set to anyway, so I don't see that as an issue? Yes, the way the rendering was done has changed (the old method didn't work well on Windows 8).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">28th January 2013, 20:42</div></div><div class="posttext">You don't have to set all the texts, just the Cancel text. And giving it $(^CancelBtn) is what it would be set to anyway, so I don't see that as an issue?<br />
<br />
Yeah, not a big deal - once you have figured out what to do. Still it would be preferable if no such workaround was needed. Couldn't other random things &quot;break&quot; in other plug-in's?<br />
<br />
Yes, the way the rendering was done has changed (the old method didn't work well on Windows 8).<br />
<br />
If Windows 8 is the (only) reason for the changed behavior, wouldn't it be easier to simply add a version check and completely disable/skip the Aero plug-in on Windows 8? I mean, in Windows 8 they have replaced the &quot;Aero&quot; UI with something that looks like the emulation of a computer from the 1980's. So I don't think the Aero plug-in has much of an effect on that system anyway. Or am I wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th January 2013, 22:24</div></div><div class="posttext">This issue is specific to inetc because Takhir decided to use the existing button text rather than hard code a string. There could be other plug-ins but none that I can think of (except perhaps NSISdl).<br />
<br />
Windows 8 doesn't have transparency but still has Aero glass (DWM Composition) so yes the plug-in does make the installer look very different. Also it was not just a fix for Windows 8 - it is a general improvement which reduces text flicker on Windows Vista/7 as well.<br />
<br />
You can still use the old text rendering if you want to (see the readme).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">28th January 2013, 22:36</div></div><div class="posttext">You can still use the old text rendering if you want to (see the readme).<br />
<br />
I had missed that option. Thank you for pointing me at that :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">29th January 2013, 01:42</div></div><div class="posttext">I had missed that option. Thank you for pointing me at that :)<br />
<br />
For some reason /btnold for Aero::Apply didn't have any effect on my problem, so I'll just use /CANCELTEXT with inetc.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">habenyamin</div><div class="date">30th January 2013, 13:10</div></div><div class="posttext">Aero::Apply and BrandingText At RTL lang ?(farsi)<br />
before Aero adding<br />
http://uploadpic.org/storage/2011/thumb_fzvtHpLqAxrMfzbWhkt2NIWoE.jpg (http://uploadpic.org/v.php?img=BVhhVjKVXI)<br />
After Aero Adding<br />
http://uploadpic.org/storage/2011/thumb_lsZObF4fsWvjcEyf3xdeir9.jpg (http://uploadpic.org/v.php?img=SnFbWlPTr)<br />
<br />
Hide Branding under cancel and next bt<br />
dose not work with BrandingText  TRIMLEFT, /TRIMRIGHT or /TRIMCENTER (farsi)<br />
<br />
with option /nobarding just removes  BrandingText</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th January 2013, 17:52</div></div><div class="posttext">There is no support for RTL languages at the moment. I will have to look at it when I have time - I have other priorities at the moment I'm afraid.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">habenyamin</div><div class="date">31st January 2013, 17:18</div></div><div class="posttext">بسیارممنون Thank you:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd February 2013, 20:41</div></div><div class="posttext">New version:1.0.0.9 - 2nd February 2013<br />
* Fixed button and branding text rendering for right-to-left languages.<br />
* Fixed bug which could cause a crash due to a variable not being initialized to NULL (only when Aero could not be enabled).<br />
* Fixed Aero not being applied on classic UI installers with RTL languages.http://nsis.sourceforge.net/File:Aero.zip<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">3rd February 2013, 15:50</div></div><div class="posttext">Thank you for the update!<br />
<br />
&lt;nitpicking&gt; Seems like you forgot to update the version info. &lt;/nitpicking&gt;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd February 2013, 16:55</div></div><div class="posttext">Fixed.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">habenyamin</div><div class="date">6th February 2013, 22:23</div></div><div class="posttext">thank u so much (to fix it for RTL Lan)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>