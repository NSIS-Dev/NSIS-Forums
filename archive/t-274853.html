<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" finish page questions, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  finish page questions NSIS Discussion" />
	
	<title> finish page questions [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  finish page questions</div>
<hr />
<div class="pda"><a href="t-274853.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=274853">finish page questions</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">empezar</div><div class="date">24th July 2007, 08:45</div></div><div class="posttext">I'm having some problems with the finish page:<br />
<br />
1. I added a custom page that sometimes does not get displayed AFTER the instpage. This causes the finish page to have an ENABLED Back button, which will make the installer go back to the instpage if this custom page does not get shown (if there are no errors during the installation). How do I make the finish page disable the Back button when there were no errors (Unless $ERRORS &gt; 0)?<br />
<br />
2. My installer automatically becomes an offline installer, customizing all the pages to suit such an installer. However, the finish page still has a checkbox with &quot;Visit the community site&quot;, which I want to remove IF the installer goes offline. How do I modify the finishpage's appearance &quot;on the fly&quot;. So if you click &quot;Yes, I am offline&quot; during the initialization of the installation, the installer removes the community site link on the finish page?<br />
<br />
Here's a picture of my finish page:<br />
<br />
http://f.nu/nquake/finishpage.png</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th July 2007, 10:29</div></div><div class="posttext">1.<br />
StrCmp $ERRORS 0 +3<br />
GetDlgItem $R0 $HWNDPARENT 3<br />
EnableWindow $R0 0<br />
<br />
2.<br />
Use the dialer plug-in to check the internet connection status and then you can hide the control in the finish page's show function:<br />
<br />
!include WinMessages.nsh<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW FinishShow<br />
!insertmacro MUI_PAGE_FINISH<br />
...<br />
Function FinishShow<br />
...<br />
!insertmacro MUI_INSTALLOPTIONS_READ $R0 ioSpecial.ini &quot;Field #&quot; &quot;HWND&quot;<br />
ShowWindow $R0 ${SW_HIDE}<br />
skip:<br />
FunctionEnd<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">empezar</div><div class="date">24th July 2007, 18:36</div></div><div class="posttext">where do I put all this stuff?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">empezar</div><div class="date">24th July 2007, 22:07</div></div><div class="posttext">and what is winmessages.nsh?<br />
<br />
ioSpecial.ini?<br />
<br />
i have no clue whatsoever how to incorporate your code into my installer.<br />
<br />
i've tried putting it in but no cigar.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th July 2007, 23:52</div></div><div class="posttext">The first code snippet will disable the back button depending on the value of $ERRORS. You want to call it like so:<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW InstFilesShow<br />
!insertmacro MUI_PAGE_INSTFILES<br />
<br />
Function InstFilesShow<br />
StrCmp $ERRORS 0 +3<br />
GetDlgItem $R0 $HWNDPARENT 3<br />
EnableWindow $R0 0<br />
FunctionEnd<br />
<br />
As for the second code snippet, WinMessages.nsh contains exactly that, definitions for control window messages (the code snippet uses SW_HIDE). The MUI finish page is actually an InstallOptions page and ioSpecial.ini is the InstallOptions INI file that it uses. If you give it the correct # for Field # then you can hide the check box if the user is not connected. Look at the dialer plug-in readme.<br />
<br />
I'm not sure why I'm telling you so much you could do some homework :p<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">empezar</div><div class="date">25th July 2007, 09:35</div></div><div class="posttext">I'm extremely grateful, you are saving me a lot of work that I can put into school instead.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">empezar</div><div class="date">25th July 2007, 10:05</div></div><div class="posttext">this worked awesomely!<br />
<br />
now one last question if you don't mind :)<br />
<br />
how do I modify the text on the first page during the installation? the welcome page. it says &quot;this is an online installer&quot;, but when an internet connection is missing - it's not!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">empezar</div><div class="date">25th July 2007, 10:55</div></div><div class="posttext">solved it myself this time!<br />
<br />
this is how i did it:<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE &quot;WelcomeShow&quot;<br />
!insertmacro MUI_PAGE_WELCOME<br />
...<br />
Function WelcomeShow<br />
  StrCmp $OFFLINE 0 +2<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 3&quot; &quot;Text&quot; &quot;This is an offline installer...&quot;<br />
FunctionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>