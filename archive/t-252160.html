<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Postgres Silent Install Failure, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Postgres Silent Install Failure NSIS Discussion" />
	
	<title> Postgres Silent Install Failure [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Postgres Silent Install Failure</div>
<hr />
<div class="pda"><a href="t-252160.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=252160">Postgres Silent Install Failure</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">yugo45</div><div class="date">28th July 2006, 21:09</div></div><div class="posttext">Part of my installer executes a PostgreSQL silent installer.<br />
<br />
The line of code that does this looks like this:<br />
execWait &quot;MSIEXEC /i $\&quot;postgresql-8.1-int.msi$\&quot; /qb ADDLOCAL=server, nls, postgis, pljava, psql, pgadmin, jdbc, npgsql, psqlodbc, pgoledb, includefiles, libfiles, msvclibs, pgxs, binfiles INTERNALLAUNCH=1 DOSERVICE=1 CREATESERVICEUSER=0 DOINITDB=1 SERVICEDOMAIN=$\&quot;%COMPUTERNAME%$\&quot; SERVICEACCOUNT=$\&quot;postgres$\&quot; SERVICEPASSWORD=$\&quot;randompass1$\&quot; SERVICENAME=$\&quot;PostgreSQL Database Server 8.1$\&quot; SUPERUSER=$\&quot;postgres$\&quot; SUPERPASSWORD=$\&quot;randompass2$\&quot; LOCALE=C ENCODING=SQL_ASCII LISTENPORT=5432 PERMITREMOTE=1 PL_PGSQL=1 PL_PERL=1 PL_PERLU=1 PL_TCL=0 PL_TCLU=0 PL_PYTHONU=0 PL_JAVA=1 BASEDIR=$\&quot;$INSTDIR\PostgreSQL\8.1$\&quot;&quot;<br />
When I run this line of code (minus the execWait) directly in the cmd window it works fine. However when ran from the nullsoft installer the Postgres installer starts up and then throws an error saying: &quot;User account ***9633;***9633;***9633;***9633;***9633;***9633;***9633;s***9633;***9633;***9633;***9633;\***9633;***9633;***9633;***9633;***9633;W does not exist&quot;<br />
<br />
So it seems that for some reason nullsoft installer messes with the command line arguments of msiexec, and instead of reading &quot;postgres&quot; as the user it uses a random unknown string (always the same one).<br />
<br />
Any ideas why this happens?<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ginglese</div><div class="date">4th October 2007, 08:08</div></div><div class="posttext">hi,<br />
<br />
i have the same issue, have you find the solution ?<br />
<br />
guillaume</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yugo45</div><div class="date">4th October 2007, 16:49</div></div><div class="posttext">It's been a long time since I worked on this, but if I remember well I didn't manage to get that particular line of code working. Instead, I placed that code into a batch file, and then I called that batch file from the installer. So in the installer script I had: <br />
<br />
ExecWait &quot;silentPostgresInstall.bat&quot;<br />
<br />
I hope that helps. It worked for me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ginglese</div><div class="date">5th October 2007, 08:59</div></div><div class="posttext">Thanks !<br />
In fact, i have tried this method before your answer and it works.I was curious to know if there were &quot;better&quot; solutions, seems not.<br />
<br />
thanks again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">5th October 2007, 09:07</div></div><div class="posttext">you can use Process Explorer to verify the command line passed by NSIS installer to MsiExec process</div></div><hr />


<div class="post"><div class="posttop"><div class="username">3point2</div><div class="date">20th November 2007, 13:25</div></div><div class="posttext">I've had similar problems running a silent PostgreSQL install.  The batch file workaround worked for me, although it would be great if this problem was fixed.<br />
<br />
As a result of the batch file workaround, I then had to then figure out how to avoid a command prompt window opening while the batch file ran (used nsExec).<br />
<br />
A silent Java install runs with no problems from within NSIS. The error I would get from the postgresql install was &quot;Internal account lookup failure. No mapping between account names and security IDs was done.&quot;, although in my efforts to get it to work I also stumbled on the error mentioned in the first post.<br />
<br />
I can't figure out whether this is a problem in the postgresql installer or whether something about being run from within NSIS affects its attempts to create or administer the postgres system user.<br />
<br />
Is there anyone who knows enough about NSIS internals to figure this one out?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsisuser18</div><div class="date">5th December 2007, 21:02</div></div><div class="posttext">Hello,<br />
I have to do the postgres Install Using NSIS Installer.<br />
I have to :<br />
Uninstall postgres(If installed)<br />
delete pguser(if account there)<br />
Install postgres<br />
add pguser to local group<br />
stop postgres<br />
start postgres</div></div><hr />


<div class="post"><div class="posttop"><div class="username">acordner</div><div class="date">25th March 2008, 23:54</div></div><div class="posttext">I am installing 8.1.4 on a Windows XP SP2 virtual machine (VMWare). It seems that if I specify BASEDIR=&lt;path&gt; in my command line, and &lt;path&gt; is NOT the default install path, I get the error &quot;internal account lookup failure&quot; immediately after the postgres user account is created. If I leave the BASEDIR statement out of the command line, the install succeeds.<br />
<br />
When performing the initial installation, Simple File Sharing was enabled. My installation was disabling Simple File Sharing, but not until after the PostgreSQL install was complete. However, if I disable Simple File Sharing prior to installing PostgreSQL, I can specify a BASEDIR and I do not receive the error message indicated above.<br />
<br />
Thus, it appears the Simple File Sharing setting interferes with the PostgreSQL installation's ability to set permissions on the \&lt;BASEDIR&gt; folder.<br />
<br />
To disable Simple File Sharing, change the registry setting:<br />
<br />
HKLM\SYSTEM\CurrentControlSet\Control\Lsa\forceguest = 0<br />
<br />
Or uncheck the &quot;Tools &gt; Folder Options &gt; View &gt; Use simple file sharing&quot; option from Windows Explorer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">acordner</div><div class="date">27th March 2008, 00:27</div></div><div class="posttext">After digging deeper, it seems that the Simple File Sharing setting is not the key to the problem. It has a lot to do with the SERVICEDOMAIN and BASEDIR settings.<br />
<br />
- If I do not specify BASEDIR or SERVICEDOMAIN, the installation succeeds.<br />
<br />
- If I specify BASEDIR but not SERVICEDOMAIN, the installation never succeeds regardless of the state of the Simple File Sharing setting.<br />
 <br />
- I have never been able to get the installation to succeed using SERVICEDOMAIN=&quot;%COMPUTERNAME%&quot; - it fails every time with the same &quot;Internal account lookup failure&quot; error.<br />
<br />
- If I specify SERVICEDOMAIN and pass the name of the computer as read from the Windows Registry (i.e. SERVICEDOMAIN=&quot;MYCOMPUTER&quot;), I am also able to specify BASEDIR regardless of the state of the Simple File Sharing setting and the installation seems to succeed every time!<br />
<br />
Hope this helps!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">acordner</div><div class="date">27th March 2008, 23:31</div></div><div class="posttext">After more extensive testing on various operating systems (2K SP4, XP SP2, Server 2003, and Vista Business), here is information regarding the use of different &quot;silent mode&quot; switches in combination with the SERVICEDOMAIN and BASEDIR switches:<br />
<br />
<br />
Using the command line: (do not specify SERVICEDOMAIN or BASEDIR) <br />
msiexec /i &quot;&lt;path&gt;\postgresql-8.1-int.msi&quot; &lt;UIType&gt; INTERNALLAUNCH=1 SERVICEPASSWORD=&quot;&lt;pwd&gt;&quot; CREATESERVICEUSER=1 SUPERPASSWORD=&quot;&lt;pwd&gt;&quot; ENCODING=UTF8 ADDLOCAL=server,psql,pgadmin<br />
<br />
where &lt;UIType&gt; = <br />
/qr - install succeeds on 2K/XP/Server 2003/Vista<br />
/qn - install fails on XP/Server 2003 (assumed &quot;Internal account lookup failure&quot; error)<br />
/qb - install fails on 2K/XP/Server 2003 with &quot;Internal account lookup failure&quot; error<br />
<br />
<br />
<br />
Using the command line: (specify both SERVICEDOMAIN and BASEDIR) <br />
msiexec /i &quot;&lt;path&gt;\postgresql-8.1-int.msi&quot; &lt;UIType&gt; INTERNALLAUNCH=1 SERVICEDOMAIN=&quot;&lt;ComputerName&gt;&quot; SERVICEPASSWORD=&quot;&lt;pwd&gt;&quot; CREATESERVICEUSER=1 SUPERPASSWORD=&quot;&lt;pwd&gt;&quot; ENCODING=UTF8 ADDLOCAL=server,psql,pgadmin BASEDIR=&quot;C:\PostgreSQL&quot;<br />
<br />
where &lt;ComputerName&gt; is setting read from Windows Registry and &lt;UIType&gt; = <br />
/qr - install succeeds on 2K/XP/Vista but fails on Server 2003 with &quot;Internal account lookup failure&quot; error <br />
/qn - install succeeds on XP but fails on Server 2003 (assumed &quot;Internal account lookup failure&quot; error)<br />
/qb - install succeeds on 2K/XP but fails on Server 2003 with &quot;Internal account lookup failure&quot; error  <br />
<br />
<br />
<br />
Using the command line: (specify BASEDIR, do not specify SERVICEDOMAIN) <br />
msiexec /i &quot;&lt;path&gt;\postgresql-8.1-int.msi&quot; &lt;UIType&gt; INTERNALLAUNCH=1 SERVICEPASSWORD=&quot;&lt;pwd&gt;&quot; CREATESERVICEUSER=1 SUPERPASSWORD=&quot;&lt;pwd&gt;&quot; ENCODING=UTF8 ADDLOCAL=server,psql,pgadmin BASEDIR=&quot;C:\PostgreSQL&quot;<br />
<br />
where &lt;UIType&gt; =<br />
/qr - install succeeds on 2K/XP/Server 2003/Vista<br />
/qn - install fails on XP/Server 2003 (assumed &quot;Internal account lookup failure&quot; error)<br />
/qb - install fails on 2K/XP/Server 2003 with &quot;Internal account lookup failure&quot; error</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thready</div><div class="date">5th September 2008, 03:08</div></div><div class="posttext">I have tried to run the same silent installer on the command line - without ever using NSIS - and I get the exact same error - &quot;User account â–¡â–¡â–¡â–¡â–¡â–¡â–¡sâ–¡â–¡â–¡â–¡\â–¡â–¡â–¡â–¡â–¡W does not exist&quot;.  This looks more like a Postgres .msi installer problem - not an NSIS problem.....  Has anyone solved this problem?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ginglese</div><div class="date">9th June 2009, 13:50</div></div><div class="posttext">Thready, <br />
<br />
i know it's a late answer but here is my one cents:<br />
<br />
Do not create the user account thanks to Posgresql installer.<br />
Do it by hand in a batch file.<br />
<br />
For exemple :<br />
net user postgres password /passwordreq:yes /PASSWORDCHG:no /add<br />
<br />
Guillaume</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vengaboy</div><div class="date">22nd October 2011, 17:59</div></div><div class="posttext">Hi all, I had install postgresql server in nsis in silent mode and i want to uninstall it from the installer,<br />
How</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">22nd October 2011, 20:48</div></div><div class="posttext">Answer is here: http://forums.winamp.com/showthread.php?p=2812056&amp;posted=1#post2812056</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kalverson</div><div class="date">28th October 2011, 20:05</div></div><div class="posttext">Our experience with the create user was that the password for the new postgresql user was not passing the domain password policy.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>