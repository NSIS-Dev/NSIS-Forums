<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How can I make this custom page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How can I make this custom page NSIS Discussion" />
	
	<title> How can I make this custom page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How can I make this custom page</div>
<hr />
<div class="pda"><a href="t-219597.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=219597">How can I make this custom page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Sp33dy Gonzale$</div><div class="date">23rd June 2005, 10:36</div></div><div class="posttext">Hy I would make me an custom page for my Counter-Strike 1.6 Extension Pack. In this custom page the user should can choose with an File Dir an (how can I make it that he can only chose mp3-files ?) MP3-File who he can hear at the startmenu of counter-Strike 1.6.<br />
<br />
The File must be put in in $Installdir\cstrike\media<br />
and it must be rename in gamestartup.mp3<br />
<br />
Could anybody help me ? I don't know what I must do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">23rd June 2005, 13:56</div></div><div class="posttext">Firstly, in the INI file for the FileRequest, you want:<br />
Filter=MP3 Files|*.mp3<br />
<br />
To get the path selected, in the Page's Leave Function (set with Page pageFunc pageLeaveFunc), read the value from the INI file with MUI_INSTALLOPTIONS_READ.<br />
Then, to move the file, do:<br />
!insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;ini_file.ini&quot; &quot;Field X&quot; &quot;State&quot;<br />
Rename &quot;$INSTDIR\cstrike\media\gamestartup.mp3&quot; &quot;$INSTDIR\cstrike\media\gamestartup-old.mp3&quot;<br />
Rename &quot;$R0&quot; &quot;$INSTDIR\cstrike\media\gamestartup.mp3&quot;<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sp33dy Gonzale$</div><div class="date">23rd June 2005, 18:19</div></div><div class="posttext">Hy Afrow UK <br />
you're very friendly and help me a lot.<br />
<br />
Thank you<br />
<br />
I've tried to make the Custom Page like you've write. But I think that I've make something wrong, because there comes always the Error:<br />
<br />
Error: resolving create-page function &quot;PageMP3-File&quot; in install pages<br />
Note: uninstall functions must begin with &quot;un.&quot;, and install functions must not<br />
Error - aborting creation process<br />
<br />
<br />
Could you help me to find what I've make wrong?<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">23rd June 2005, 19:28</div></div><div class="posttext">Quite obviously, you're missing the PageMP3-File Function in your script.<br />
<br />
You need:<br />
Function PageMP3-File<br />
 !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;MP3-File.ini&quot;<br />
 !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;MP3-File.ini&quot;<br />
FunctionEnd<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sp33dy Gonzale$</div><div class="date">24th June 2005, 14:18</div></div><div class="posttext">Hy, thank you for the reply. I've added the function but there is still the same error. <br />
<br />
I write all the thing who I write in the .nsi in the following code.<br />
<br />
Is there something wrong?<br />
<br />
<br />
<br />
; ReserveFiles<br />
ReserveFile &quot;MP3-File.ini&quot;<br />
<br />
<br />
<br />
; Pages<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!insertmacro MUI_PAGE_INSTFILES<br />
Page custom PageMP3-File PageLeaveMP3-File<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
<br />
; Funtions<br />
Function .onInit<br />
<br />
    !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;MP3-File.ini&quot;<br />
    <br />
FunctionEnd<br />
<br />
<br />
; Page MP3-File<br />
Function PageMP3-File<br />
<br />
   <br />
   !insertmacro MUI_HEADER_TEXT &quot;MP3-File Einfügen&quot; &quot;Spielmenü Sound ändern&quot;<br />
   !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;MP3-File.ini&quot;<br />
   !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;MP3-File.ini&quot; &quot;Field 1&quot; &quot;FileRequest&quot;<br />
   Rename &quot;$INSTDIR\cstrike\media\gamestartup.mp3&quot; &quot;$INSTDIR\cstrike\media\gamestartup-old.mp3&quot;<br />
   Rename &quot;$R0&quot; &quot;$INSTDIR\cstrike\media\gamestartup.mp3&quot;<br />
   <br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th June 2005, 19:58</div></div><div class="posttext">You still need the Leave function present too!<br />
Please read about the Page instruction syntax in the NSIS manual.<br />
<br />
; ReserveFiles<br />
ReserveFile &quot;MP3-File.ini&quot;<br />
<br />
; Pages<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!insertmacro MUI_PAGE_INSTFILES<br />
Page custom PageMP3-File PageLeaveMP3-File<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
; Funtions<br />
Function .onInit<br />
<br />
    !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;MP3-File.ini&quot;<br />
    <br />
FunctionEnd<br />
<br />
<br />
; Page MP3-File<br />
Function PageMP3-File<br />
   <br />
   !insertmacro MUI_HEADER_TEXT &quot;MP3-File Einfügen&quot; &quot;Spielmenü Sound ändern&quot;<br />
   !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;MP3-File.ini&quot;<br />
   <br />
FunctionEnd<br />
<br />
Function PageLeaveMP3-File<br />
<br />
   !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;MP3-File.ini&quot; &quot;Field 1&quot; &quot;FileRequest&quot;<br />
   Rename &quot;$INSTDIR\cstrike\media\gamestartup.mp3&quot; &quot;$INSTDIR\cstrike\media\gamestartup-old.mp3&quot;<br />
   Rename &quot;$R0&quot; &quot;$INSTDIR\cstrike\media\gamestartup.mp3&quot;<br />
   <br />
FunctionEnd<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sp33dy Gonzale$</div><div class="date">25th June 2005, 17:49</div></div><div class="posttext">Hy thank you the error isn' come more. And the rename of gamestartup.mp3 in gamestartup.mp3 works too. But the transfer from the $R0 in $Installdir\cstrike\media<br />
doesn't work I've test if it works when I writc<br />
<br />
<br />
; Page Leave MP3-File<br />
Function PageLeaveMP3-File<br />
<br />
   !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;MP3-File.ini&quot; &quot;Field 1&quot; &quot;FileRequest&quot;<br />
   Delete &quot;$INSTDIR\cstrike\media\gamestartup.mp3&quot;<br />
   CreateDirectory $INSTDIR\cstrike\media<br />
   CopyFiles /silent &quot;$R0&quot; &quot;$INSTDIR\cstrike\media&quot;<br />
   Rename &quot;$R0&quot; &quot;gamestartup.mp3&quot;<br />
<br />
FunctionEnd<br />
<br />
<br />
But it isdn't work. What could I do?<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th June 2005, 20:15</div></div><div class="posttext">Just do:<br />
<br />
   Delete &quot;$INSTDIR\cstrike\media\gamestartup.mp3&quot;<br />
   CopyFiles /silent &quot;$R0&quot; &quot;$INSTDIR\cstrike\media\gamestartup.mp3&quot;<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sp33dy Gonzale$</div><div class="date">25th June 2005, 21:24</div></div><div class="posttext">Hy thank you for always answer me very friendly. I've make it now like you have write, but it doesn't works. The old gamestartup.mp3 is deleted but there isn't the new. Could it be that I must write something in the MP3-Page.ini ?<br />
<br />
This is it:<br />
<br />
[Settings]<br />
NumFields=3<br />
CancelEnabled=0<br />
CancelShow=0<br />
BackEnabled=0<br />
<br />
[Field 1]<br />
Type=FileRequest<br />
State=FileRequest<br />
Left=30<br />
Right=153<br />
Top=27<br />
Bottom=40<br />
Filter=MP3 Files|*.mp3<br />
<br />
[Field 2]<br />
Type=Label<br />
Text=Wählen sie eine MP3-Audio Datei, die Sie im Spielmenü von                      Counter-Strike 1.6 hören wollen.<br />
Left=4<br />
Right=197<br />
Top=2<br />
Bottom=19<br />
<br />
[Field 3]<br />
Type=Label<br />
Text=Bei keiner wird die jetzige behalten<br />
Left=37<br />
Right=150<br />
Top=44<br />
Bottom=52</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th June 2005, 22:21</div></div><div class="posttext">Perhaps you should add validation for this:<br />
<br />
!insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;MP3-File.ini&quot; &quot;Field 1&quot; &quot;FileRequest&quot;<br />
StrCmp $R0 &quot;&quot; +2<br />
IfFileExists $R0 +2<br />
 Abort<br />
Delete &quot;$INSTDIR\cstrike\media\gamestartup.mp3&quot;<br />
CopyFiles /silent &quot;$R0&quot; &quot;$INSTDIR\cstrike\media\gamestartup.mp3&quot;<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sp33dy Gonzale$</div><div class="date">26th June 2005, 18:00</div></div><div class="posttext">Mmh no it doesn't works. But thank you that you have help me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th June 2005, 18:07</div></div><div class="posttext">Ok, try:<br />
CopyFiles /silent &quot;$R0&quot; &quot;$INSTDIR\cstrike\media\*&quot;<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sp33dy Gonzale$</div><div class="date">26th June 2005, 19:11</div></div><div class="posttext">Hy Afrow UK,<br />
the code <br />
<br />
!insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;MP3-File.ini&quot; &quot;Field 1&quot; &quot;FileRequest&quot;<br />
StrCmp $R0 &quot;&quot; +2<br />
IfFileExists $R0 +2<br />
Abort<br />
Delete &quot;$INSTDIR\cstrike\media\gamestartup.mp3&quot;<br />
CopyFiles /silent &quot;$R0&quot; &quot;$INSTDIR\cstrike\media\gamestartup.mp3&quot;<br />
 <br />
<br />
hasn't works so I've tested the Code<br />
<br />
 CopyFiles /silent &quot;$R0&quot; &quot;$INSTDIR\cstrike\media\*&quot;<br />
<br />
with this code<br />
<br />
Function PageLeaveMP3-File<br />
<br />
!insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;MP3-File.ini&quot; &quot;Field 1&quot; &quot;FileRequest&quot;<br />
Delete &quot;$INSTDIR\cstrike\media\gamestartup.mp3&quot;<br />
CopyFiles /silent &quot;$R0&quot; &quot;$INSTDIR\cstrike\media\*&quot;<br />
<br />
FunctionEnd<br />
<br />
But it isn't works <br />
<br />
Thank you Sp33dy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th June 2005, 19:34</div></div><div class="posttext">I don't see why it can't work, unless the $INSTDIR\cstrike\media folder does not exist. Plus you need the code I posted in case the user does not enter an MP3 file on the custom page (if that happens it will delete their gamestartup.mp3 and not replace it).<br />
Just keep messing with CopyFiles. I can't help you any further because I can't see anything wrong with the code.<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>