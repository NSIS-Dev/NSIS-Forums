<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" InstallOptionsEx, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  InstallOptionsEx NSIS Discussion" />
	
	<title> InstallOptionsEx [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  InstallOptionsEx</div>
<hr />
<div class="pda"><a href="t-181087.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181087">InstallOptionsEx</a></p>
<hr />
<div id="pagenumbers"><b>Pages :</b>
[<b>1</b>]
<a href="t-181087-p-2.html">2</a>
</div>
<hr />

<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">25th May 2004, 00:34</div></div><div class="posttext">I modified the original version of InstallOptions to add some controls (not supported by all OS, or with others special requirements) and to make some additional changes:<br />
<br />
- Removed NumFields from INI File &quot;Settings&quot; section.<br />
- Added Animation and ProgressBar controls.<br />
- Added ability of ComboBox and DropList controls of supporting images for each item in their list boxes. <br />
- Added TRANSPARENT, CENTER and NOAUTOPLAY flags for Animation controls and SMOOTH and VERTICAL flags for ProgressBar controls.<br />
- Added support of NOTIFY flag for Text, Password and ComboBox controls.<br />
<br />
This is just beta version, it probably has some bugs and I don't know, I'm not responsible for problems it gonna make, as even it's my first touch in C++.<br />
<br />
Included the .dll and its readme.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">25th May 2004, 01:09</div></div><div class="posttext">I'll test it :)<br />
<br />
// edit by me</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">25th May 2004, 01:19</div></div><div class="posttext">For the next version I'll be targeting the easiest controls to implement, as Trackbar.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">25th May 2004, 16:33</div></div><div class="posttext">It would be cool if it supported the property grid control, very useful for pre-configuration setup....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">25th May 2004, 22:07</div></div><div class="posttext">But one thing can be done even without C++, create an editor of InstallOptions pages which shows the page and edits it at the same time, using the great &quot;Rect&quot; page attribute (where you can assign a page with a part of the resource, if used correctly, it can even show several pages at the same time).<br />
<br />
One problem is: how can I unload InstallOptions without going to other pages or quiting the program? Probably the idea of creating a .dll function called &quot;Clear&quot; (as I saw in another modification) would be great to add, but as you know, I don't have that kind of knowledge of how to do it (so help is appreciated here)...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">31st May 2004, 13:56</div></div><div class="posttext">OK! New version beta 2 (5/31/2004):<br />
<br />
- Added TrackBar and IPAddress controls.<br />
- Added ability of Button controls of<br />
supporting an image or icon.<br />
- Added BACK_RECT, TOOLTIPS and NO_TICKS flags for<br />
TrackBar controls and BITMAP and ICON flags for<br />
Button controls.<br />
- Added support of NOTIFY flag for IPAddress control.<br />
- Removed TRANSPARENT and NOAUTOPLAY flags for Animation<br />
control.<br />
<br />
Included .dll and its Readme.<br />
<br />
Main TODO -&gt; Addition of new controls.<br />
<br />
Any help to make this plugin even better is accepted at any times.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">7th June 2004, 11:01</div></div><div class="posttext">OK! New version beta 3 (6/7/2004):<br />
<br />
- Added DateTime and MonthCalendar controls. <br />
- Added UPDOWN flag for DateTime controls and NOTODAY, NOTODAYCIRCLE and WEEKNUMBERS flags for MonthCalendar controls.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">9th June 2004, 10:22</div></div><div class="posttext">Your additions sounds great. How about adding a few samples to your package?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">9th June 2004, 11:25</div></div><div class="posttext">I'm planning it for the next or the following version. I didn't do any until now because I was trying to change more things of it!<br />
<br />
Planned:<br />
<br />
- Addition of UpDown control. (not attached with other controls)<br />
- Add ability of it to make other controls as its buddy control (UpDown control).<br />
- Remove FileRequest and DirRequest.<br />
- Add flags for Button controls to make it act like same as FileRequest and DirRequest but using a buddy control (don't need to the a Text control). Makes the Text control free to use its NOTIFY flag and the Button control to be user customized.<br />
- Implement NSIS style $\n,$\r and $\t. Try to implement common variables ($0-9 $R0-9) as input and output.<br />
<br />
I ever wanted to make that change of splitting FileRequest and DirRequest Text control from the Button control since I discovered: after using those controls, to get a control handle you had to use a control number different than the InstallOptions one. Now it will be balanced.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">12th June 2004, 00:39</div></div><div class="posttext">OK! New version beta 4 (6/11/2004):<br />
<br />
- Added UpDown control. <br />
- Removed FileRequest and DirRequest controls. Use Text and Button controls instead.<br />
- Added FILEREQUEST and DIRREQUEST flags for Button controls and LEFT, HORIZONTAL and WRAP flags for UpDown controls. <br />
- NSIS $\n, $\r and $\t imported to remove the need for conversions between NSIS characters and plugin's.<br />
<br />
This version is about exactly as I planned before (except for the variables thing, I'm trying to implement that).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">12th June 2004, 02:53</div></div><div class="posttext">How about the source code as well? Wouldn't hurt to get it peer reviewed.<br />
A couple of questions-<br />
a) What is the advantage of using NSIS style $\r $\n instead of \r \n?<br />
b) What exactly are you trying to implement for the &quot;variables&quot; feature? I'm a little hazy on that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">12th June 2004, 11:50</div></div><div class="posttext">I wasn't posting the source because to don't boost much my post count for each version that is launched. Anyways, I posted it below.<br />
<br />
(If you see, there are comments of what I added or changed, but I didn't comment removed parts)<br />
<br />
a) Because before implementing that, if you would write and/or read Install Options INI files, you had to convert the string from NSIS -&gt; Install Options and/or Install Options -&gt; NSIS to be supportable with one another. For example:<br />
<br />
NSIS string: &quot;// NSIS string test \\$\r$\n// NSIS second line \\&quot;<br />
<br />
Putting this exact NSIS string into an INI file from Install Options and making it show, it would appear like this:<br />
<br />
// NSIS string test \$$// NSIS second line \<br />
<br />
So I think this explained it.<br />
<br />
2) I don't know why I posted it! I should be saying before &quot;not a good idea&quot; instead of &quot;I'm trying to implement that&quot; by now. Sometimes I paste the information without changes and forget the spelling...:(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">12th June 2004, 15:05</div></div><div class="posttext">Overall, I think this is pretty good. A couple of comments:<br />
a) I still don't see any advantage of using &quot;NSIS&quot; syntax for special characters as opposed to the current &quot;C&quot; syntax that InstallOptions uses. In fact, I couldn't even get the &quot;NSIS&quot; syntax to work. Do you have an example showing how it works? See my attached script. It doesn't seem to work properly.<br />
b) I agree with you, drop the whole &quot;variables&quot; thing. I don't see any advantage in implementing it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">12th June 2004, 19:09</div></div><div class="posttext">a) Fixed. Same version.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">12th June 2004, 19:11</div></div><div class="posttext">...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">13th June 2004, 02:58</div></div><div class="posttext">OK, I see that you have fixed the &quot;NSIS&quot; style escape characters. But I still don't see the advantage of it.<br />
Either way I have do conversions- whether it uses the &quot;C&quot; style or the &quot;NSIS&quot; style.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">13th June 2004, 03:22</div></div><div class="posttext">As you insist, I'll put a define in the Source Code to use the old &quot;C&quot; style.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">13th June 2004, 06:08</div></div><div class="posttext">Is these any sample to show the new feature?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">13th June 2004, 13:56</div></div><div class="posttext">Hi deguix<br />
,NOTIFY flags in DropList control not work,Can you have a look?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">13th June 2004, 15:42</div></div><div class="posttext">Don't get me wrong- I think you've done a good job. I don't want to insist that you change anything. But if something as basic as the escape character is going to be changed, I think we should see a clear advantage for it.<br />
The other thing of course is that it will not be compatible with MUI.<br />
<br />
Another suggestion is to document which OS the new controls do not work on- since you did say that the InstallOptionsEx is not 100% supported by all Windows OS'es.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">13th June 2004, 20:23</div></div><div class="posttext">Is these any sample to show the new feature?<br />
<br />
Hmmm... I didn't launch any sample yet, I'm working on one.<br />
<br />
Hi deguix<br />
,NOTIFY flags in DropList control not work,Can you have a look?<br />
<br />
Yep, it happens when you use the new feature for it: 16x16 Image for each item. This happens because it doesn't use the normal DropList but a modified instead. But I'll try to put the NOTIFY as soon as possible.<br />
<br />
Don't get me wrong- I think you've done a good job. I don't want to insist that you change anything. But if something as basic as the escape character is going to be changed, I think we should see a clear advantage for it.<br />
The other thing of course is that it will not be compatible with MUI.<br />
<br />
I'm playing on conservative side now. I understand, everyone used &quot;\r\n&quot; way since InstallOptions had the MULTILINE support. I'll go back in that change, but I'll make a define for people who liked this change I made. As a matter of fact this project continues with the name &quot;InstallOptions&quot; at front of it, isn't it? The discussion of that ends here.<br />
<br />
Another suggestion is to document which OS the new controls do not work on- since you did say that the InstallOptionsEx is not 100% supported by all Windows OS'es.<br />
<br />
Thanks for the suggestion, I'll put this on the next version of InstallOptionsEx.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th June 2004, 21:43</div></div><div class="posttext">Isn't the problem with NSIS style escaping that NSIS converts them before writing to the INI file using WriteIniStr?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">14th June 2004, 03:07</div></div><div class="posttext">Ohhh :eek: ... that's why he doesn't see an advantage of that... How I am stupid! I have to punch my face after that. Anyways, I was going to back up that change...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">14th June 2004, 04:27</div></div><div class="posttext">Yep. The NSIS style escaping works if the text is already in the INI file. However, if you want to dynamically write to the INI file, you will have to convert everything. <br />
Thanks Joost for explaining it better than I could.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">15th June 2004, 00:20</div></div><div class="posttext">Just to fix that, I made a version &quot;before the launching of the next version&quot;. But I made some small additions that will have in the next version:<br />
<br />
- NOTIFY flag for MonthCalendar, DateTime and UpDown controls.<br />
- Returned to old &quot;C&quot; style escape characters.<br />
<br />
These changes are undocumentated.<br />
<br />
I'm making this version because of the full week of school work on me (because the school year is ending) and the final tests. Next version is planned to be launched next week (after Tuesday).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">15th June 2004, 00:24</div></div><div class="posttext">...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">15th June 2004, 00:43</div></div><div class="posttext">Thanks deguix,I like this EX version very much.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">15th June 2004, 00:51</div></div><div class="posttext">If you know, Ex is for &quot;Expanded&quot;. Generally I did put for my functions the &quot;Adv&quot; for &quot;Advanced&quot;. I just didn't put &quot;Adv&quot; on the plugin name because it doesn't have dramatic changes comparing with the normal InstallOptions. It just adds more controls and new features.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">27th June 2004, 23:27</div></div><div class="posttext">- Added HotKey control. <br />
- Added support of NOTIFY flag for MonthCalendar, DateTime, UpDown and HotKey controls. <br />
- Added information to controls and options their minimum supportable OS. <br />
- C style escape characters restored again.<br />
- Fixed problems with new controls about the TabStop not working.<br />
<br />
HotKey control doesn't have a 100% correct translation Input-&gt;Control-Control-&gt;Output: If you type &quot;Ctrl + +&quot; as input it will convert to &quot;Ctrl +&quot;, and if you type some keys that I don't know their VK_ names (like some numpad keys) it won't output these. But for most of the keys the control will work correctly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">27th June 2004, 23:29</div></div><div class="posttext">...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">3rd July 2004, 13:13</div></div><div class="posttext">I found that droplist can not list item,but InstallOption can.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">3rd July 2004, 19:38</div></div><div class="posttext">What do you mean by that?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">3rd July 2004, 23:50</div></div><div class="posttext">This same code in here: http://forums.winamp.com/showthread.php?postid=1399824#post1399824<br />
When change InstallOptions:: to InstallOptionsEx:: the droplist items missing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">4th July 2004, 07:37</div></div><div class="posttext">Everything is working fine for me.<br />
<br />
InstallOptionsEx v.2.4 beta 5<br />
NSIS 2.0 -&gt; latest development snapshot<br />
Windows XP Home Edition -&gt; latest updates<br />
<br />
What InstallOptionsEx, NSIS and Windows version do you use?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">4th July 2004, 10:09</div></div><div class="posttext">InstallOptionsEx v.2.4 beta 5<br />
NSIS 2.0 Specail(Open LogSet command)<br />
Windows Server 2003 Simplified Chinese<br />
<br />
I upload the script and exefile here,would you have a look what wrong for me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">4th July 2004, 22:56</div></div><div class="posttext">Remove Text=DropList lines inside your .ini file for now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">5th July 2004, 09:03</div></div><div class="posttext">OK.Thanks deguix,the ini file create by HM NIS Edit,I forgot this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AlexBienheureux</div><div class="date">9th July 2004, 14:26</div></div><div class="posttext">could you put an example which one sees all the possibilities?<br />
<br />
thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">10th July 2004, 02:48</div></div><div class="posttext">If I do it now, I have to change it for every version I launch as you know that it's a beta version. When it becomes stable I'll do one. This is not the right time to do that.<br />
<br />
Now, about the changes for the next version, I've done some fixes to it, like that one from bluenet. But I'm not giving more details on it right now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VegetaSan</div><div class="date">10th July 2004, 16:18</div></div><div class="posttext">OMG .. that's some nice shit ^^</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AlexBienheureux</div><div class="date">15th July 2004, 12:03</div></div><div class="posttext">Originally posted by deguix <br />
If I do it now, I have to change it for every version I launch as you know that it's a beta version. When it becomes stable I'll do one. This is not the right time to do that.<br />
<br />
Now, about the changes for the next version, I've done some fixes to it, like that one from bluenet. But I'm not giving more details on it right now.  *<br />
<br />
<br />
ok, thank you !! :up:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">23rd July 2004, 13:17</div></div><div class="posttext">Ok, next version planned (and almost done) changes are:<br />
<br />
- Support for changing font and colors of controls (which gives a wide range of commands). This is quite limited, but at least it gives a better look w/o using NSIS itself. Some controls that don't support this because:<br />
<br />
 &gt; Windows Themes can sometimes fill completely controls (Button).<br />
<br />
 &gt; Some controls don't call WM_OWNERDRAW or WM_CTLCOLORS* or don't have messages to change the colors or font (IPAddress, HotKey, UpDown, TrackBar, RadioButton, CheckBox, GroupBox).<br />
<br />
 &gt; ComboBox + ImageList = Special drawing (ComboBox /w Images).<br />
<br />
- Fix that problem I already said in older posts.<br />
- Fix the cutting of controls when its &quot;right&quot; or &quot;bottom&quot; values that are bigger than rectangle's.<br />
- Small bugs from last version.<br />
<br />
This version will appear here soon.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">25th July 2004, 21:13</div></div><div class="posttext">- Added a wide range of commands for setting initial color and font formatting without using NSIS commands. <br />
- Fixed the control extention beyond the rect height and width. This makes the control to resize itself when necessary. <br />
- Added file verification before setting a bitmap or icon to DropList , ComboBox and Button controls. <br />
- Fixed a stupid bug that made some controls flags to be set when you did not specify them. <br />
- Fixed another stupid bug that made ProgresBar controls to do not show their indicator bar correctly. <br />
- Added one laking information about the standalone keys for HotKey controls. <br />
- Fixed other minor bugs.<br />
<br />
Yeah, it has more fixes than I expected yesterday. By using the ProgressBar control I found 2 serious bugs.<br />
<br />
Now what I expect for the next version is an appearance of the powerful RichText control (used by the actual NSIS license page) and more fixes as it is in a beta version. Any bug you find is very important to me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">25th July 2004, 21:14</div></div><div class="posttext">...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th July 2004, 21:56</div></div><div class="posttext">OMG This is neat! Thanks for all your hard work!<br />
<br />
Cheers<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">26th July 2004, 03:16</div></div><div class="posttext">Hummm... Did you test it? I see 0 downloads up to now and you already commented...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th July 2004, 14:06</div></div><div class="posttext">I've got it now :)<br />
<br />
I couldn't try it as I was at work :/<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">26th July 2004, 14:54</div></div><div class="posttext">Oh, no problems.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">27th July 2004, 13:01</div></div><div class="posttext">have you thought of including lobo's tooltip plugin into IOex? would be a lot work less, if one could simple put the tooltip-text into the ini-file of a io-page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">27th July 2004, 13:18</div></div><div class="posttext">Another thing you would say is to include lobo's dialogs plugin into it.<br />
<br />
Yes, I can include those additions, but you have to wait a while, since I'm working on other projects at the same time.<br />
<br />
Just a question to lobo first. What are the control ID's of your tooltips? (if you know, tooltips are the same as normal controls)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">27th July 2004, 13:42</div></div><div class="posttext">Oh, I forgot to tell about some IOEx new features not mentioned in the documentation:<br />
<br />
- You can specify the height and/or width of a control using the Height and/or Width INI value names. They are used instead of Right and/or Bottom INI value names.<br />
<br />
- ListItemsHeight INI value name adjusts the height of each ListBox, ComboBox and DropList item. It's mentioned on the documentation from other INI value names, but it's not directly included.<br />
<br />
If I forgot them, probably they are not even tested fully. Can you all test these for me?<br />
<br />
(If it's better than I thought, what else good can be waiting for me now?)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">11th August 2004, 15:57</div></div><div class="posttext">(If it's better than I thought, what else good can be waiting for me now?)One thing good that I discovered on this time that passed is that InstallOptionsEx first versions had the fixes of the InstallOptions 2.5 already (even MUCH before the time), so people who used this didn't have the Next button problem since beta 1.<br />
<br />
Now the bad things: several bugs were found on the code, including one critical that DISABLED controls which were added the font and/or paint features didn't draw correctly. And there are some others which I don't want to comment right now.<br />
<br />
Apparently now I have an image of ever doing buggy projects without testing fully (yeah, even StrFunc.nsh has one, but much less apparent than IOEx). If you see most of my older functions you can see 2 or 3 bugs each... I'm much more lucky with projects outside NSIS though where you can't find them easily.<br />
<br />
(You can now see the list of projects I'm working now and to work after on my signature)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">11th August 2004, 21:46</div></div><div class="posttext">I wanted to make a small modification on ListBoxes when I'm fixing the &quot;DISABLED controls not drawing correctly [sometimes]&quot;. I would like to change the colors of selected and deselected items of a DISABLED ListBox by default. I don't like the actual default IO's colors because sometimes you can think that a ListBox is enabled, but it's really disabled.<br />
<br />
On the image the:<br />
<br />
- Left DISABLED ListBox is from InstallOptions<br />
- Right DISABLED ListBox is from InstallOptionsEx<br />
<br />
The image:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">12th August 2004, 01:34</div></div><div class="posttext">Tooltip is a good feature, I hope beta 7 would include it.Thanks deguix's work. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">12th August 2004, 03:37</div></div><div class="posttext">Hummm... I don't have a defined plan for the next version, but yeah, I'm thinking on some plugins combinations with IOEx for the future:<br />
<br />
- Dialogs and tooltips -&gt; additional dialogs and tooltips support.<br />
- Banner -&gt; creation of dialogs not based on resources (it's not really true but I have this idea when looking at it), timeout, extented NOTIFY for running NSIS codes when the dialog is being shown.<br />
- AdvSplash -&gt; Alpha Blending, extended timeout, extended NOTIFY for running NSIS codes when a click is made to the image, modeless dialog boxes, special effects when showing window (it's not really true but I have this idea when looking at it).<br />
<br />
...<br />
<br />
About NOTIFY flag: I'm planning to change a little bit the way NOTIFY flags are handled:<br />
<br />
- Create another INI value name for &quot;Settings&quot; page called &quot;Notification&quot; (or something like it) where you can get the type of the notification being sent by a control.<br />
<br />
- Each field will have an additional INI value name called &quot;Notification&quot; where you can set the notification flags you want for the control.<br />
<br />
What do you think of this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">12th August 2004, 03:56</div></div><div class="posttext">Hummm... I don't have a defined plan for the next version, but yeah, I'm thinking on some plugins combinations with IOEx for the future:<br />
<br />
- Dialogs and tooltips -&gt; additional dialogs and tooltips support.<br />
- Banner -&gt; creation of dialogs not based on resources (it's not really true but I have this idea when looking at it), timeout, extented NOTIFY for running NSIS codes when the dialog is being shown.<br />
- AdvSplash -&gt; Alpha Blending, extended timeout, extended NOTIFY for running NSIS codes when a click is made to the image, modeless dialog boxes, special effects when showing window (it's not really true but I have this idea when looking at it).<br />
<br />
...<br />
<br />
About NOTIFY flag: I'm planning to change a little bit the way NOTIFY flags are handled:<br />
<br />
- Create another INI value name for &quot;Settings&quot; page called &quot;Notification&quot; (or something like it) where you can get the type of the notification being sent by a control.<br />
<br />
- Each field will have an additional INI value name called &quot;Notification&quot; where you can set the notification flags you want for the control.<br />
<br />
What do you think of this?<br />
<br />
What I already done for InstallOptionsEx 2.5 beta 7:<br />
<br />
- &quot;Fixed the control extention beyond the rect height and width. This makes the control to resize itself when necessary.&quot; change removed. It's quite useful to have a way to do not show controls to the user sometimes...<br />
<br />
- Fixed &quot;Text&quot; and &quot;ListBox&quot; control w/ DISABLED flag: Didn't redraw right.<br />
<br />
- Added missing features which documentation from last version didn't mention.<br />
<br />
- Added &quot;FontName&quot; INI value to all known controls that support font changes.<br />
<br />
- Added &quot;Dis*&quot; commands for &quot;ListBox&quot; controls which enables to set colors for DISABLED controls.<br />
<br />
- Added a new flag to &quot;CheckBox&quot; controls, the old and famous &quot;3STATE&quot; flag that allows you to set additonally an indeterminated (or grayed) state.<br />
<br />
- &quot;ListItems&quot; for &quot;Button&quot; controls w/ &quot;DIRREQUEST&quot; flag is the text which appears above the Tree-View control of directories.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">14th August 2004, 22:20</div></div><div class="posttext">This version brings a new system for control notifications. I'll explain a little bit how it works. Let's have an example INI file to start:<br />
<br />
[Field 1]<br />
Type=ComboBox<br />
Left=0<br />
Top=0<br />
Width=100<br />
Height=400<br />
Notify=ONTEXTCHANGE<br />
<br />
[Field 2]<br />
Type=Button<br />
Left=110<br />
Top=0<br />
Width=50<br />
Height=12<br />
Notify=ONDBLCLICK|ONKILLFOCUS<br />
State=C:\MyDir<br />
<br />
You can see there is a new INI value name for each field called &quot;Notify&quot;, with this you can use notification flags for each control. I made the flags to be supported for more than one control to make easier the use of them. This INI value name is used for notification flags that, when the user does the action, triggers the calling to the validation function.<br />
<br />
On the first field, there is a &quot;ONTEXTCHANGE&quot; notification flag which makes the plugin call the validation function after the text is changed by the user and after it appears on the screen.<br />
<br />
On section &quot;Field 2&quot;, there is &quot;ONDBLCLICK&quot; which makes the plugin to use &quot;ShellExecute&quot; and the text specified by &quot;State&quot; value (this is special for Buttons and Links). And there is a &quot;ONKILLFOCUS&quot; which is when a control loses focus.<br />
<br />
Now, when for example the first field receives focus it won't call the validation function. Why? You didn't specify it to do it, so you change it to:<br />
<br />
[Field 1]<br />
Type=ComboBox<br />
Left=0<br />
Top=0<br />
Width=100<br />
Height=400<br />
Notify=ONTEXTCHANGE|ONSETFOCUS<br />
<br />
And now there is another addition to this system. After a control called the validation function it records what control did call it and the action the user did to the control:<br />
<br />
[Settings]<br />
State=2<br />
Notify=ONTEXTCHANGE<br />
<br />
This could be different if another action from the user is made:<br />
<br />
[Settings]<br />
State=2<br />
Notify=ONSETFOCUS<br />
<br />
As you saw, I added ONSETFOCUS and ONDBLCLICK and some other notification flags that the normal NOTIFY flag couldn't do. I made some other changes, so let's see them all:<br />
<br />
- Rearranged control notification system: <br />
- - Added Notify value name for &quot;Settings&quot; and &quot;Field #&quot; sections. <br />
- - Added: ONSETFOCUS, ONKILLFOCUS, ONLISTOPEN, ONLISTCLOSE, ONSELCHANGE, ONTEXTCHANGE, ONTEXTUPDATE, ONCLICK, ONDBLCLICK, ONTEXTTRUNCATE, ONTEXTVSCROLL, ONSTART and ONSTOP notification flags. <br />
- Added BackShow, NextEnabled and NextShow for &quot;Settings&quot; section. <br />
- Fixed the control extention beyond the rect height and width addition of the last version removed. <br />
- Fixed Text controls: &quot;black&quot; color was being set even when you didn't. <br />
- Fixed ListBox controls: didn't appear as they were disabled. <br />
- Added missing features to the documentation which last version's didn't mention. <br />
- Added FontName for Label, Link, ListBox, ComboBox, DropList, Text and Password controls, DisBgColor, DisTxtColor, DisSelBgColor and DisSelTxtColor for ListBox control. <br />
- ListItems for Button controls w/ DIRREQUEST flag is the text which appears above the Tree-View control of directories. <br />
- Added a new flag to CheckBox controls, the old and famous &quot;3STATE&quot; flag that allows you to set additonally an indeterminated (or grayed) state.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">14th August 2004, 22:22</div></div><div class="posttext">...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">15th August 2004, 04:48</div></div><div class="posttext">wonderful£¬Thanks deguix, I have a test.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">16th August 2004, 22:34</div></div><div class="posttext">On the next version I'll add ToolTips support (which is halfway done) and much less fixes because most of them I fixed on the last version...<br />
<br />
Some more additions comparing with Lobo's ToolTips plugin are the ability to change text and background colors of ToolTips, additional flags, notifications? (thinking, not planned) and multiline support (searching for information).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">18th August 2004, 14:52</div></div><div class="posttext">I added the ToolTips feature to InstallOptionsEx in this version. See an example for INI file using all ToolTip value names:<br />
<br />
[Field 1]<br />
Type=Label<br />
Left=0<br />
Top=0<br />
Width=100<br />
Height=10<br />
Text=Default Options:<br />
ToolTipIcon=INFO<br />
ToolTipTitle=Default options<br />
ToolTipText=Makes the program to select all the default program options<br />
ToolTipFlags=BALLOON<br />
ToolTipTxtColor=0xFFFFFF<br />
ToolTipBgColor=0x009900<br />
ToolTipMaxWidth=300<br />
<br />
ToolTip features:<br />
<br />
- ToolTip types supported: Normal or Balloon.<br />
- Colors of tooltips can be changed.<br />
- Balloon tooltips are supported for those who have IE 5, for all Windows versions.<br />
- Multiline is halfway supported. It does not supported escape characters, but there is ToolTipMaxWidth that makes the ToolTip to break lines when it does reach the width limit.<br />
- XPStyle makes the Balloon tooltips icons to have a better quality.<br />
<br />
ToolTip notes:<br />
<br />
- ToolTips disappear when you click on their controls.<br />
- Tracking and In-Place ToolTips aren't supported right now.<br />
<br />
Changes comparing to the last version:<br />
<br />
- Added ToolTips feature -&gt; Added ToolTipText, ToolTipFlags, ToolTipMaxWidth, ToolTipTxtColor, ToolTipBgColor, ToolTipIcon and ToolTipTitle value names. <br />
- Fixed DISABLED ComboBox and DropList controls bug: Didn't redraw right. <br />
- Fixed DISABLED ListBox controls bug: User specified colors didn't apply.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">18th August 2004, 14:54</div></div><div class="posttext">...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">18th August 2004, 21:59</div></div><div class="posttext">nice work!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">19th August 2004, 13:57</div></div><div class="posttext">I uploaded plugin's Archive page here (http://nsis.sourceforge.net/archive/viewpage.php?pageid=507).<br />
<br />
(Comm@nder21, two of the links in your signature are broken or going to wrong pages.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">22nd August 2004, 13:21</div></div><div class="posttext">It seem a bug. When disable a text contrl, the text not change to gray. Link contrl can not &quot;ExecShell&quot; a file that local in some directory.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">22nd August 2004, 16:11</div></div><div class="posttext">thanks, deguix, fixed :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">22nd August 2004, 18:46</div></div><div class="posttext">When disable a text contrl, the text not change to gray.I can't reproduce this bug. You have to say what IOEx version you are using, and if you're using XPStyle on or off.<br />
<br />
Link contrl can not &quot;ExecShell&quot; a file that local in some directory.Local directory = where the application is. If that file you specified doesn't exist, it won't work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Deliverator</div><div class="date">22nd August 2004, 23:52</div></div><div class="posttext">When using this with the Modern UI my Welcome and Finish pages are not displayed correctly.<br />
<br />
The background of the window is gray, and the background of the text is white.<br />
<br />
What am I doing wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">23rd August 2004, 01:37</div></div><div class="posttext">I make a sample to show this. When click the checkbox and link you can see the two problem. Sorry my wrong, contrl is a Label not a Text.<br />
The version is beta 8.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">23rd August 2004, 11:48</div></div><div class="posttext">Fixed both on beta 9. (Deliverator's and bluenet's)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">23rd August 2004, 13:31</div></div><div class="posttext">Mostly, this is a bug fixing version of IOEx from the older versions additions:<br />
<br />
- Fixed DISABLED Label controls: didn't draw shadow. <br />
- DISABLED Label and Link are now controls supported by DisTxtColor value name. <br />
- Fixed Label and Link controls: didn't draw background color on the entire control. <br />
- Shadow Text feature added. Added TxtShwColor, DisTxtShwColor, SelTxtShwColor and DisSelTxtShwColor. <br />
- FIRST DLL optimizations: 0.5 kb smaller on decompressed build (no change for compressed build). <br />
- Fixed text positioning of ComboBox, DropList and ListBox controls. They are now closer to the control border. <br />
- Fixed focus rectangle not appearing on ComboBox and DropList. <br />
- ListBox, ComboBox and DropList controls have automatic word ellipsis. <br />
- FontOrientation and FontEscapement removed - because most of the drawing commands do not support this feature.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">23rd August 2004, 13:32</div></div><div class="posttext">...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">billym</div><div class="date">1st September 2004, 15:51</div></div><div class="posttext">I have needed flash support (for short guides) in my installer's for a while but not able to code it. Could support for this control be added to InstallOptionsEx so we have the flash option. If not could someone please assist in creating a plugin for this purpose. Thanks in advance for any assistance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">3rd September 2004, 00:42</div></div><div class="posttext">This I'm doing is just the beggining. It's better you to create a plugin for that.<br />
<br />
I've just added some Windows controls because they're from the Operational System. Adding too many custom controls on one plugin makes its size to explode. (that's why exists an item on TODO list saying about implementing custom controls -&gt; separated sub-plugins for IO)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dilox77</div><div class="date">4th September 2004, 16:13</div></div><div class="posttext">Hi deguix!<br />
Can you have a look here?<br />
http://forums.winamp.com/showthread.php?s=&amp;postid=1459067#post1459067<br />
Do you think I can resolve my problem with your modified version of installoptions?<br />
Thank's in advance.<br />
dilox</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">4th September 2004, 18:14</div></div><div class="posttext">No. When I thought of it, people were only against this feature.<br />
<br />
I put things on InstallOptionsEx depending on how many people would like the feature included and their reasons (not totally true but...). I only heard against, so I didn't include it. If you wanna this now, maybe it's still possible...<br />
<br />
When there is too much request on one thing, I become estimulated (!) and then I do it, depending if I do know how to do it (there are sometimes problems with knowing something, as I only started coding with C when I modified IO, so common &quot;C&quot; mistakes are done).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dilox77</div><div class="date">4th September 2004, 20:04</div></div><div class="posttext">Ok.. but why people are against this feature? I think the possibility of inserting variables and codes into file .ini and having default value (and other kind of value) not fixed but variable, are great opportunities.<br />
I don't know if and how it's possible to realize that in C.<br />
I only hope you put this feature in your to-do list as soon as possible <br />
:)<br />
Bye, dilox</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">4th September 2004, 22:13</div></div><div class="posttext">I'm not working on InstallOptionsEx right now but if I can I'll try to implement that. Ok?<br />
<br />
Now you know that I keep editing even much after I posted the original post. I wasn't expecting your answer right now...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dilox77</div><div class="date">4th September 2004, 22:26</div></div><div class="posttext">Sincerly I don't understand what you mean, can you explain me better?<br />
The problem is that if you make any changes to the installoptions file (through code, writeinistr, etc..) then you have to recompile the file .nsi that include it to see modifications to take effect. :(<br />
You can not parse custompage during runtime.<br />
Is this an unsolveble problem?<br />
Hope don't...<br />
Bye, dilox</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">4th September 2004, 22:52</div></div><div class="posttext">The problem is that if you make any changes to the installoptions file (through code, writeinistr, etc..) then you have to recompile the file .nsi that include it to see modifications to take effect.1) You didn't understand what &quot;Variables&quot; feature I'm talking about (but I never explained so I'll do it now):<br />
<br />
You put a common variable ($0-$9, $R0-$R9) as text or state of a control and it will convert the variable into the actual contents of the variable at the time a page is reserved, showed (w/o reserving it) or updated by controls notifications.<br />
<br />
2) About writting not taking effect until the next compilation:<br />
<br />
The plugin reads information from the INI file everytime you reserve a page or show it directly (w/o reserving it). If the INI file is not updated at all if you try to change it before the reading of the INI file by the plugin, it's not my problem, but a scripting problem of yours.<br />
<br />
As I don't know how your level of NSIS knowledge is, I'll explain the scripting problem:<br />
<br />
If you use Modern UI and you are using the default way of including a custom page under the installer, use !insertmacro MUI_INSTALLOPTIONS_WRITE instead of using WriteINIStr. If you use Win9x, use FlushINI before and after writting to INI files.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dilox77</div><div class="date">4th September 2004, 23:12</div></div><div class="posttext">l</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dilox77</div><div class="date">4th September 2004, 23:23</div></div><div class="posttext">Thank's for better explanations and for tring to implement this new feature! Have a good job! ;)<br />
Bye, dilox</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">4th September 2004, 23:37</div></div><div class="posttext">Sorry, when I keep editing posts generally the original post is rude. I try to make it less rude the more I edit, but sometimes it continues rude. This probably will change when I know totally how to benefit from the English language, so I can make more post editions before posting making it not hurt anyone...<br />
<br />
Thank's for better explanations and for tring to implement this new feature! Have a good job!I won't do this right now. See on my signature that I have much work to be done besides IOEx...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">5th September 2004, 05:27</div></div><div class="posttext">Hi, is these possible add a feature that Button Flags FILEREQUEST can select multi files?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">5th September 2004, 14:18</div></div><div class="posttext">is these possible add a feature that Button Flags FILEREQUEST can select multi files?Hmmm... I don't know what to say. I'll have to see when I come back to IOEx development. (See my signature)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">6th September 2004, 02:03</div></div><div class="posttext">The file open dialog can only select one file, some time I want to select mutli files, how can I do that?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">6th September 2004, 02:09</div></div><div class="posttext">I understood your question. However I do not know right now how to do it (I actually heard a little about this but not enough). I'll only see it when I go back to IOEx development. Please, be patient until then.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">18th September 2004, 01:32</div></div><div class="posttext">I was looking lately though source codes from GUI's builders made for other programs so that I can get some knowledge from them. An example is the automatic control positioning. However as I'm not working on IOEx now, I cannot verify them right now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">15th October 2004, 00:31</div></div><div class="posttext">I've discovered when adding a new feature that enables you to choose which character to use on password masking (hehe, couldn't resist :)), flags not even mentioned on InstallOptions (original) documentation:<br />
<br />
- PASSWORD for Text controls (same as Password controls).<br />
- DROPLIST for ComboBox controls (same as DropList controls).<br />
<br />
I think this information should be added to IO docs, because even the unmeaningful things can mean something to someone. It's just a simple thing anyways...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th October 2004, 00:46</div></div><div class="posttext">Those are for internal usage of InstallOptions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">16th October 2004, 00:26</div></div><div class="posttext">Yeah, I know... As those can be used externally as well, I will add them to IOEx documentation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">16th October 2004, 02:27</div></div><div class="posttext">another suggestion: seperation lines for the droplist dialog</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">16th October 2004, 11:35</div></div><div class="posttext">OK, added to the TODO list.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">30th October 2004, 00:01</div></div><div class="posttext">The greatest addition here is the variables support for ANY value of a value name. It can even be used several times on the same value. Get a look at the list of changes below:<br />
<br />
- Fixed VSCROLL flag: wasn't supported by ListBox controls. <br />
- Changed flag name: HORIZONTAL to HSCROLL. <br />
- Mentioned PASSWORD for Text and DROPLIST for ComboBox controls on the documentation. <br />
- Added new feature to Password controls: Password mask character (see Text INI value name). <br />
- Added new features to Icon controls: <br />
  - Supports getting icons from executables, and dlls (see Text and State INI value names). <br />
  - Supports default Windows icons (see State INI value). Options: APPLICATION, EXCLAMATION, INFORMATION, QUESTION, STOP and WINLOGO. <br />
- Added variables $0-$9, $R0-$R9 support before reserving or showing without reserving pages. It is supported on every value of a value name and can be used multiple times on the same value.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">30th October 2004, 00:02</div></div><div class="posttext">...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">7th November 2004, 18:16</div></div><div class="posttext">The most important fix for this version is that all font related commands works for all control types. See what changed this version:<br />
<br />
- &quot;Flags&quot; INI value optimizations: <br />
&amp;nbsp;&amp;nbsp;- Removed the &quot;not useful&quot; BACK_RECT, NOTODAYCIRCLE, TRANSPARENT and CENTER flags. The second flag effect is implemented with NOTODAY and the last flag is implemented to the Animation control normal functionality. <br />
&amp;nbsp;&amp;nbsp;- Removed VERTICAL flag. Use VSCROLL instead. <br />
- Fixed ComboBox and DropList controls: Disabled controls now have their text on the right color by default. <br />
- Fixed ListBox controls: Focus boundary rectangle wasn't being drawn. <br />
- Font INI value names are now supportable by all controls. <br />
- Fixed Link controls: They are underlined by default except when FontUnderline=0 is set. <br />
- Changed importance level of Height and Width. Now if Right is specified, Width is ignored, and if Bottom is specified, Height is ignored. <br />
- Fixed &quot;Back&quot; button appearance: It should appear only after the first page. <br />
- Changed State and Notify INI value names from Settings INI section: <br />
&amp;nbsp;&amp;nbsp;- Fixed: State had the value of 0 and Notify didn't even appear when OPEN_FILEREQUEST, SAVE_FILEREQUEST or DIRREQUEST were used on a Button control. <br />
&amp;nbsp;&amp;nbsp;- As the appearance of these INI value names are imminent: If State = 0, the page returned a notification. If Notify = ONNEXT, ONBACK or ONCANCEL, the user clicked on next, back or cancel buttons, respectively.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">7th November 2004, 18:17</div></div><div class="posttext">...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">12th November 2004, 23:56</div></div><div class="posttext">There had a bug that was appearing since beta 10 (when I implemented the variables) which made the &quot;0&quot; on values for INI value names useless. That means, the code treated it like the default value. I fixed this on this &quot;before-the-next-release&quot; version because this affects all commands that transform the value into an integer (mostly those with &quot;0&quot; and &quot;1&quot; as options).<br />
<br />
This version only contains this fix as the difference between the original version.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">12th November 2004, 23:58</div></div><div class="posttext">...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">15th November 2004, 01:23</div></div><div class="posttext">In the future versions I'll focus more on the real-time acquirement of information from INI files. That means, the page will change everytime you change something on the INI file at run-time.<br />
<br />
This will bring real advantages against the original InstallOptions:<br />
<br />
- You could adjust the page controls without needing to show the page again.<br />
<br />
- You woudn't need the System or other plugins just to change a control appearance. Hence this would help a lot those who are learning NSIS and don't know System plugin and experts who have a lot of codes for run-time actions.<br />
<br />
- You could use an editor to do the first touches on an INI file and make final adjustments yourself afterwards with InstallOptionsEx easily, without the need of reshowing the page every time you want to do a change on the page.<br />
<br />
- I could create new abities without worrying if the user could change them at run-time. For Example: Now you can't use WM_SETTEXT to set the text of a label because it's being drawn internally by the plugin. If I add this, you could change it, and even the shadow colors...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">14th December 2004, 14:32</div></div><div class="posttext">Sorry for bothering you again with installoptionsex, but i guess i found a bug.<br />
<br />
I used the leave function for notification checks, but the Value &quot;ONNEXT&quot; in the Settings Sections is only filled if the page is destroyed. Every check and abort in the leave function led to an empty value, but as i re-read the variable in the instpage i noticed, that &quot;ONNEXT&quot; was written within. You should change the check to let the people abort if neccesary from within the leave function.<br />
<br />
Tested with Build 11.2<br />
<br />
Regards<br />
<br />
flizebogen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">14th December 2004, 23:07</div></div><div class="posttext">Thanks. Fix already prepared for the next version.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">20th December 2004, 10:02</div></div><div class="posttext">For the next version, I also fixed icon problems based on their sizes, and added ability to support cursors and animated cursors. This time I warned about this because someone wanted it fixed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">28th December 2004, 16:50</div></div><div class="posttext">The greatest thing this version is the ability of updating pages when they're running. On the best side, it makes every feature of IOEx available without the knowledge of System plugin. On the other, it allows anyone to update it by hand, so it's better to secure it for now. It's basic for now. Now take a look on the other changes in this version:<br />
<br />
- Added the ability to update the page when showing it. (There are still bugs to be fixed here.)<br />
- DLL size reduced to 13.5kb. Increased speed to load pages by fixing internal memory leaks.<br />
- Flags INI value name optimizations: <br />
- - Added MULTISELECT flag for Button controls.<br />
- - Fixed FILE_EXPLORER flag: had effect similar to HSCROLL flag.<br />
- - HSCROLL and VSCROLL flags support for Button controls was removed.<br />
- New documentation (which will be improved more in future versions).<br />
- Removed HotKey control, for optimization purposes.<br />
- Removed a ComboBox feature of setting images for each list item. It already had lots of problems since its inclusion.<br />
- Fixed Icon controls: Didn't use the right icon size when told to do so.<br />
- Icon controls additionally support cursors (*.cur) and animated cursors (*.ani).<br />
- Fixed DateTime and MonthCalendar controls: Not enough space on buffers, changed date and time format.<br />
- Made the focus rectangle on Link controls to occupy the control rectangle border, not the text rectangle border.<br />
- New lines work again on Link controls.<br />
- Fixed documentation: MonthCalendar controls can have a State INI value.<br />
<br />
Another thing: The new documentation doubled it's size when not in a zip file but it was dramastically reduced inside one (interesting...). So that means, only 1 file for both the plugin and source.<br />
<br />
As it uses the expand/collapse feature, you have to enable ActiveX to see it correctly. Please, warn me if there are any problems w/ the readme. If there are enough problems, I'm going to return to the old one.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WebMatze</div><div class="date">28th December 2004, 19:57</div></div><div class="posttext">Hello deguix and thanks a lot for this very useful plugin. But i have a little problem since the beta 11 and always with the beta 12, when i use a link control it does not launch the link but open a dirrequest window, i tried everything but i cant get it work, i tried to use notify=onsetfocus and it opens a dirrequest window and then loads the link... I dont understand.<br />
<br />
Can you please help me<br />
<br />
[Field 2]<br />
Type=Link<br />
Notify=ONCLICK<br />
Left=23<br />
Right=61<br />
Top=0<br />
Bottom=10<br />
State=http://www.dfsfddsf.tk/<br />
Text=dfsfddsf</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">28th December 2004, 21:07</div></div><div class="posttext">Whooops! I was testing the Link controls just before launching the new version that appeared right next to my eyes and I was still not seeing it! Thanks, fixed. Same version.<br />
<br />
Can you find more? If so, I'm going to still use the same version if they are quick to be fixed like that one.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WebMatze</div><div class="date">29th December 2004, 07:38</div></div><div class="posttext">Hello i get another problem with the new beta 12 version, i use a button to quit my app and one to go to a section, and when i clic on these buttons it opens a browser window instead of executing the actions. I think the problem is that the ini state setting doesnt get updated when i clic on the buttons and i dont know why, i use a third button with a open_filerequest flag and this one works.<br />
Do you have a idea of the problem?<br />
<br />
here is my ini :<br />
<br />
[Settings]<br />
CancelShow=0<br />
NextShow=0<br />
BackShow=0<br />
<br />
[Field 1]<br />
Type=Label<br />
Left=62<br />
Right=70<br />
Top=0<br />
Bottom=10<br />
Text=le<br />
<br />
[Field 2]<br />
Type=link<br />
Text=gdsgs<br />
Notify=ONCLICK<br />
State=http://www.dfsgfsgfsd.tk<br />
Left=23<br />
Right=61<br />
Top=0<br />
Bottom=10<br />
<br />
[Field 3]<br />
Type=Label<br />
Left=10<br />
Right=-70<br />
Top=20<br />
Bottom=30<br />
Text=install folder:<br />
<br />
[Field 4]<br />
Type=Link<br />
Notify=ONCLICK<br />
Left=190<br />
Right=-1<br />
Top=20<br />
Bottom=30<br />
State=<br />
Text=<br />
<br />
[Field 5]<br />
Type=Text<br />
Notify=ONTEXTCHANGE<br />
Flags=READONLY<br />
Left=10<br />
Right=-10<br />
Top=30<br />
Bottom=42<br />
<br />
[Field 6]<br />
Type=Button<br />
Text=Browse<br />
Notify=ONCLICK<br />
State=5<br />
Flags=OPEN_FILEREQUEST|FILE_MUST_EXIST<br />
Filter=<br />
Left=164<br />
Right=218<br />
Top=65<br />
Bottom=79<br />
<br />
[Field 7]<br />
Type=Icon<br />
Left=190<br />
Right=-1<br />
Top=-0<br />
Bottom=0<br />
<br />
[Field 8]<br />
Type=Label<br />
Left=10<br />
Right=65<br />
Top=0<br />
Bottom=10<br />
Text=Par <br />
<br />
<br />
[Field 9]<br />
Type=Label<br />
Left=71<br />
Right=120<br />
Top=0<br />
Bottom=10<br />
Text=<br />
<br />
[Field 10]<br />
Type=Button<br />
Text=Quit<br />
Notify=Onclick<br />
Left=82<br />
Right=136<br />
Top=65<br />
Bottom=79<br />
<br />
[Field 11]<br />
Flags=Disabled<br />
Type=Button<br />
Text=Patch<br />
Notify=ONCLICK<br />
Left=0<br />
Right=54<br />
Top=65<br />
Bottom=79</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">29th December 2004, 08:09</div></div><div class="posttext">I Problem with the Validation Function in the previous beta isn't fixed but changed.<br />
<br />
Now the Value &quot;ONNEXT&quot; is written everytime. Even if i simply click on a Button which acts as a Filerequest. <br />
<br />
One note to the new docs. The collaps / expand feature is very nice but you should add an &quot;expand all&quot; button, for easier searching / printing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">29th December 2004, 10:41</div></div><div class="posttext">The buttons bug is (I think) fixed now. (As I should say, a stupid bug caused by the previous build fix)<br />
<br />
For that suggestion about &quot;collapse/expand all&quot;: I'm going to do that next version as I have to come up with the code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WebMatze</div><div class="date">29th December 2004, 12:01</div></div><div class="posttext">Thanks a lot, it works great now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">29th December 2004, 13:30</div></div><div class="posttext">My problem still exists.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">29th December 2004, 22:44</div></div><div class="posttext">Now I fixed yours (try it please).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">12th January 2005, 16:53</div></div><div class="posttext">do you plan to add more examples to the documentation? i tried to use the tooltips, but failed miserably :p</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Toopak</div><div class="date">12th January 2005, 18:03</div></div><div class="posttext">Found two problems.<br />
<br />
1. When i have a field with type=Password and i don't specify &quot;Text=*&quot; it crashes the installer.<br />
<br />
2. I have 30 controls on my form and there are 2 checkboxes with notify ONCLICK method on them (I want to catch when the status of checkbox is changed). I could not figureout why but sometimes when I click on one of those checkboxes the form &quot;blinks&quot;. It did not happen with original InstallOpptions.dll<br />
<br />
+ I have a problem: I have two editboxes on the form. One is enabled so user can enter data into it and another one is disabled. I need to get the behaviour when a user types something in the 1st editbox so that string is copied to second (disabled) editbox. I managed to put ONTEXTCHANGE flag and catch the change and to read the string from the control, but it won't to accept the string in the second disabled editbox when I write it there. Any ideas why it can happen?<br />
<br />
Thanks in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th January 2005, 18:47</div></div><div class="posttext">Have you tried<br />
GetDlgItem $R0 $hwnd 20xx<br />
SendMessage $R0 &quot;${WM_SETTEXT}&quot; 0 &quot;STR:Text&quot;<br />
<br />
$hwnd is from using InstallOptionsEx::initDialog /NOUNLOAD &quot;ioFile.ini&quot;<br />
20xx is control ID (1200 + Field number - 1)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Toopak</div><div class="date">12th January 2005, 20:20</div></div><div class="posttext">Originally posted by Afrow UK <br />
Have you tried<br />
GetDlgItem $R0 $hwnd 20xx<br />
SendMessage $R0 &quot;${WM_SETTEXT}&quot; 0 &quot;STR:Text&quot;<br />
<br />
$hwnd is from using InstallOptionsEx::initDialog /NOUNLOAD &quot;ioFile.ini&quot;<br />
20xx is control ID (1200 + Field number - 1)<br />
<br />
-Stu  <br />
<br />
I tried it... did not work for me :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th January 2005, 20:39</div></div><div class="posttext">Works fine here (using InstallOptions.dll)InstallOptions::initDialog /NOUNLOAD &quot;$PLUGINSDIR\dlg&quot;<br />
Pop $R0<br />
<br />
GetDlgItem $R1 $R0 1201<br />
SendMessage $R1 &quot;${WM_SETTEXT}&quot; 0 &quot;STR:Some text&quot;<br />
<br />
InstallOptions::showYou need to move it to the Leave function though of course (the GetDlgItem + SendMessage)<br />
<br />
Make sure you !include WinMessages.nsh too<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Toopak</div><div class="date">12th January 2005, 21:05</div></div><div class="posttext">Originally posted by Afrow UK <br />
Works fine here (using InstallOptions.dll)InstallOptions::initDialog /NOUNLOAD &quot;$PLUGINSDIR\dlg&quot;<br />
Pop $R0<br />
<br />
GetDlgItem $R1 $R0 1201<br />
SendMessage $R1 &quot;${WM_SETTEXT}&quot; 0 &quot;STR:Some text&quot;<br />
<br />
InstallOptions::showYou need to move it to the Leave function though of course (the GetDlgItem + SendMessage)<br />
<br />
Make sure you !include WinMessages.nsh too<br />
<br />
-Stu  <br />
<br />
this code is in the leave function and it works perfect for the checkboxes (except that blinking effect). WinMessages.nsh is included (needed to add a few defines myself though). At this moment that blinking thing is major for me if i dont find a way to fix it i'll need to go back to InstallOptions. :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th January 2005, 21:10</div></div><div class="posttext">An example script showing it happen should help deguix fix it.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Toopak</div><div class="date">12th January 2005, 21:30</div></div><div class="posttext">Originally posted by Afrow UK <br />
An example script showing it happen should help deguix fix it.<br />
<br />
-Stu  <br />
<br />
Man! I found it! :) THANKS for your help! :)<br />
<br />
I just did not know that &quot;STR:&quot; plays any role at all.... I thought it's just a &quot;test&quot; string you guys use....<br />
<br />
I'm going to update my install script... I'm 99% sure the whole thing will be alright now.<br />
<br />
2deguix: Man, You rock! Keep up the great work! :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Toopak</div><div class="date">12th January 2005, 22:18</div></div><div class="posttext">Ok.... I have reproduced blink effect.... Please see the scripts in the attachment. If you click &quot;Use Win Auth&quot; checkbox on the Profile DB group you'll see that blink. The second checkbox on PDM DB tab works just fine. The only difference is:<br />
<br />
<br />
StrCmp $0 1 +1 +4<br />
WriteINIStr &quot;$PLUGINSDIR\DBConnection.ini&quot; &quot;Field 9&quot; &quot;Flags&quot; &quot;DISABLED&quot;<br />
WriteINIStr &quot;$PLUGINSDIR\DBConnection.ini&quot; &quot;Field 11&quot; &quot;Flags&quot; &quot;DISABLED&quot;<br />
Goto +3<br />
WriteINIStr &quot;$PLUGINSDIR\DBConnection.ini&quot; &quot;Field 9&quot; &quot;Flags&quot; &quot;&quot;<br />
WriteINIStr &quot;$PLUGINSDIR\DBConnection.ini&quot; &quot;Field 11&quot; &quot;Flags&quot; &quot;&quot;<br />
 <br />
<br />
I need to disable the controls so when user clicks back button and then returns to this page those controls are still disabled.<br />
<br />
Thanks in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">15th January 2005, 23:56</div></div><div class="posttext">That blink effect is the page update I talked about which, unfortunately, didn't go well. It's slow because the DLL updates every control (the DLL only knows that the INI file has changed). Maybe a solution would be creating a new DLL call so you can inform what INI value name from a control changed in the INI file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Toopak</div><div class="date">19th January 2005, 22:26</div></div><div class="posttext">Basically I don't mind extra code in my install script to prevent this problem. I'm pretty far from C++ language (did not touch it for a few years) so I think you'll better make a decision based on your experience. :)<br />
<br />
Thanks for the hard work man!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">22nd January 2005, 18:29</div></div><div class="posttext">Toopak: Your bug is fixed. &quot;Page update from its INI file&quot; feature was removed though. At least it won't blink anymore on your pages :).<br />
<br />
flizebogen: I also added the Collapse/Expand All feature to the docs. I think you're going to like the speed to load the docs :D.<br />
<br />
See full list of changes:<br />
<br />
- Added VSCROLL for ComboBox and DropList controls, and READONLY flag for CheckBox and RadioButton controls.<br />
- Text on Button controls is automatically wrapped if there has no sufficient space.<br />
- Label, Bitmap and Icon controls can have Link controls underneath them so the &quot;hand&quot; cursor shows when pointing to those.<br />
- The text of DateTime controls is now aligned to the right when RTL is activated.<br />
- ListBox controls new feature: multiple vertical columns (see Text INI value name).<br />
- Added &quot;Collapse/Expand/Invert All&quot; options to documentation.<br />
- Optimized the documentation.<br />
- Removed &quot;page update from INI file changes&quot; feature.<br />
- Added TRANSPARENT flag for Bitmap controls.<br />
<br />
If kichik is going to launch the new InstallOptions next NSIS version (2.05), probably the next IOEx version will be 2.4.2 beta 1 :confused:. I organized IOEx betas like that so I can't revert it anymore (I forgot about that IO could change). But it's still usable :rolleyes:...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">23rd January 2005, 14:24</div></div><div class="posttext">Thanks for the changes to the docs, now its a lot easier to search and print.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">24th January 2005, 15:46</div></div><div class="posttext">Print? Wow, what a useful way to read one! Quite interesting...<br />
<br />
I was thinking, what would be a great thing to release on 2.4.2 beta 1. New control types, just like I did on 2.4.1 beta 1? Maybe.... With the extra time I got from the blizzard here with 30+ inches of snow (about 75 cm of height), no school for 2 days... :D I think it's a great time to implement TreeView controls isn't :)? But it is difficult because of the grouping of items :confused: (ListItems is in only one line). I don't know if this is a great way to group items in a group...:<br />
<br />
I|II{A|B{1|2|3}}|III{A|B|C}<br />
<br />
It would appear like:<br />
<br />
I<br />
II<br />
+-A<br />
+-B<br />
+-+-1<br />
--+-2<br />
--+-3<br />
III<br />
+-A<br />
+-B<br />
+-C<br />
<br />
Is there any other ideas that might be a good solution for grouping items together in one line?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th January 2005, 17:52</div></div><div class="posttext">How about:<br />
I|II|&gt;A|&gt;B|&gt;&gt;1|&gt;&gt;2|&gt;&gt;3|III|&gt;A|&gt;B|&gt;C<br />
<br />
Basically &gt; makes it step inwards if you know what I mean.<br />
I think this would be easier to use because you don't have to worry about missing a curly bracket off by accident, plus I'm sure it would be easier to parse the string in your source code too :D<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">24th January 2005, 19:37</div></div><div class="posttext">I'm sure it would be easier to parse the string in your source code tooIt's just a little bit harder because the DLL won't know when the group will end or start (like on I|&gt;&gt;1) so it would need 2 extra loops, and also, it would need to record which level each item is being written to. But your idea is still brillant because of the easiness to use.<br />
<br />
Resuming both ideas:<br />
<br />
&quot;{&quot; and &quot;}&quot;:<br />
<br />
- Strengths:<br />
--- Small line.<br />
--- The item left to the '{' is always the parent.<br />
--- Fast DLL process.<br />
<br />
- Weaknesses:<br />
--- Someone could forget a bracket.<br />
--- Not easily to seen on HM NIS Edit.<br />
--- Difficult to know which level an item is in.<br />
<br />
&quot;&gt;&quot;:<br />
<br />
- Strengths:<br />
--- Number of &quot;&gt;&quot; indicate the number of levels the item is.<br />
--- Previous item with a any previous level than the item is the parent.<br />
--- Neatly seen on HM NIS Edit.<br />
<br />
- Weaknesses:<br />
--- Big line.<br />
--- Slower than &quot;{&quot; and &quot;}&quot;.<br />
<br />
Anyone else?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th January 2005, 20:58</div></div><div class="posttext">Ah I see what you mean.<br />
<br />
I was thinking about placing + to make groups, but that still doesn't tell where a group should end.<br />
I think your original idea would be best.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Toopak</div><div class="date">24th January 2005, 21:49</div></div><div class="posttext">Originally posted by deguix <br />
Toopak: Your bug is fixed. &quot;Page update from its INI file&quot; feature was removed though. At least it won't blink anymore on your pages :).<br />
 <br />
<br />
Thanks, man! Works great now! :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th January 2005, 21:58</div></div><div class="posttext">Hey it would be ideal to make some macros to do common tasks like check/uncheck check-boxes, add list-box items and so on (in Leave function).<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">24th January 2005, 22:44</div></div><div class="posttext">I planned to create a DLL call that warns the DLL about a change on the INI file: Maybe a solution would be creating a new DLL call so you can inform what INI value name from a control changed in the INI file.It'll do everything you wish for that can be also changable on the INI file (if that approach works) without even using GetDlgItem. This enables also to use InstallOptionsEx to create more than 1 page at a time (which I don't know how to do at this point), and so it goes on. It's all matter of time... and also a little bit of luck with the weather around here...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">26th January 2005, 18:52</div></div><div class="posttext">As a TreeView control on generally would be compared to the Components page TreeView control, I'm trying to do these things below:<br />
<br />
- When you don't have CHECKBOXES flag activated, State INI value only indicates 1 item to be selected.<br />
- When using the CHECKBOXES flag, State INI value indicates the state of every item used on ListItems INI value name.<br />
<br />
- Text INI value is the bitmap file where the checkboxes can be located. It's the same format as found on the components page. This is required or the checkboxes won't show. Requires at least: Internet Explorer 3.0.<br />
<br />
Maybe I should stop talking about it and do it. :blah:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">5th February 2005, 03:05</div></div><div class="posttext">I was thinking lately about the usefulness of the ValidateText value name. After I included the notification system I don't think it's that useful anymore. You could do the same thing by using a notification like ONTEXTCHANGE, StrLen to verify the length of the string, and a MessageBox to show a string. Do you think I should keep it, or remove it from the next versions? (MaxLen and MinLen will still be usable to support some control abilities)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">6th February 2005, 06:01</div></div><div class="posttext">how to handle buttons ?<br />
<br />
i have 2 buttons on my IO and how do i read out which one was clicked ?<br />
<br />
it is to mention that these 2 buttons replaces 2 radiobuttons and depending on this it choses different IO pages following thereafter<br />
<br />
before:<br />
o bla<br />
o blubb<br />
[next]<br />
<br />
after<br />
[bla] [blubb]<br />
(no next)<br />
<br />
PS how to open a HLP file from a button like LINK ???</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">6th February 2005, 16:11</div></div><div class="posttext">i have 2 buttons on my IO and how do i read out which one was clicked ?Read the &quot;State&quot; value name of &quot;Settings&quot; section of your INI file using &quot;ReadINIStr&quot;. Like:ReadINIFile $0 &quot;YourPage.ini&quot; &quot;Settings&quot; &quot;State&quot;But, in order for the page to notify you about button clicks, you have to put a notification flag on the &quot;Notify&quot; value name of the field you want on your INI file. Like:[Field 1]<br />
Type=Button<br />
Text=Blablabla<br />
Left=0<br />
Right=30<br />
Top=0<br />
Bottom=10<br />
Notify=ONCLICKit is to mention that these 2 buttons replaces 2 radiobuttons and depending on this it choses different IO pages following thereafterIn this case, you need to use WriteINIStr after the page was shown to change the &quot;Type&quot; value of those fields. Like:WriteINIStr &quot;YourPage.ini&quot; &quot;Field 1&quot; &quot;Type&quot; &quot;Button&quot;PS how to open a HLP file from a button like LINK ???Put the full path location where it's found on the &quot;State&quot; of that link control. Like:[Field 3]<br />
Type=Link<br />
Text=Click me<br />
Left=100<br />
Right=-1<br />
Top=40<br />
Bottom=70<br />
State=C:\MyDir\MyHelpFile.hlpYou can also put a variable $0-$9, $R0-$R9 to specify the path if you think it's easier:<br />
State=$R9\MyHelpFile.hlp</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">7th February 2005, 00:46</div></div><div class="posttext">doesn't work here<br />
[Field 1]<br />
Type=Button<br />
Text=Save<br />
Left=30<br />
Right=130<br />
Top=10<br />
Bottom=30<br />
State=<br />
Notify=ONCLICK<br />
FONTBOLD=1<br />
<br />
[Field 2]<br />
Type=Button<br />
Text=Restore<br />
Left=160<br />
Right=260<br />
Top=10<br />
Bottom=30<br />
State=<br />
Notify=ONCLICK<br />
FONTBOLD=1<br />
<br />
<br />
State of INI [SETTINGS] is both 0<br />
ReadINIStr $BUTTON &quot;$PLUGINSDIR\menu01.ini&quot; &quot;Settings&quot; &quot;State&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $BUTTON &quot;menu01.ini&quot; &quot;Settings&quot; &quot;State&quot;<br />
<br />
<br />
doesn't work either<br />
State=$R9\MyHelpFile.hlp<br />
<br />
nsis205, latest IOex 2.41b13<br />
<br />
The IO is called w/o any PAGE and hast no PRE or LEAVE functions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">7th February 2005, 04:54</div></div><div class="posttext">The IO is called w/o any PAGE and hast no PRE or LEAVE functions.That's why it's not working. It has to be read on the leave function. After the leave function, a page notification is always set (like ONNEXT, ONBACK or ONCANCEL) and state will always be 0.<br />
<br />
Secondly, remove the empty &quot;State&quot; INI value names from your fields. The plugin will think that you want to execute something and it won't return to the leave function.<br />
<br />
Thirdly, the &quot;State&quot; of a Button or Link field is the same thing as the first parameter of the Exec NSIS command. So that means if you are used to run an application like this with NSIS:Exec &quot;C:\MyDir\MyApp.exe&quot;You can just put exactly as it appears:State=C:\MyDir\MyApp.exe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">7th February 2005, 09:58</div></div><div class="posttext">&gt;&gt; That's why it's not working. It has to be read on the leave function<br />
<br />
whoops - i should have a closer look to my script (now for 1.5 years - still no end)<br />
<br />
&gt; page custom selectaction<br />
<br />
Should PAGE end here ?<br />
  InstallOptionsEx::dialog &quot;menu01.ini&quot;<br />
    Pop $R0<br />
<br />
<br />
The button state should be returned state in POP (differs from back next cancel) as well...<br />
<br />
... after a while...<br />
<br />
ok i managed the leave function.<br />
<br />
but now i have next problem:<br />
i have a 3rd button [Go] which selects a language.<br />
<br />
if i click there the code behind is working fine but the leave function does not get a new state - exactly: its empty ''<br />
the Go-button return (aborts) back to the IO page which need to be redrawn in new language - nothing happens...<br />
<br />
<br />
Help-Link - i tried now everything, it still doesn't work<br />
<br />
[Field 8]<br />
Type=Link<br />
Text=Online-Help<br />
Left=30<br />
Right=68<br />
Top=120<br />
Bottom=128	<br />
State=<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;menu01.ini&quot; &quot;Field 8&quot; &quot;State&quot; &quot;$EXEPATH\onlinehelp.hlp&quot;<br />
<br />
State, path and file are correct but nothing happens.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">14th February 2005, 14:38</div></div><div class="posttext">let me guess - you have no clue ? :cry:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th February 2005, 16:44</div></div><div class="posttext">Don't you mean $EXEDIR or perhaps $INSTDIR not $EXEPATH...<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">14th February 2005, 17:25</div></div><div class="posttext">sorry - yes - i mask some code ;)<br />
<br />
it is: strcpy $B2BPATH $exedir &gt; exepath ^^<br />
<br />
later it is<br />
!insertmacro MUI_INSTALLOPTIONS_WRITE &quot;menu01.ini&quot; &quot;Field 8&quot; &quot;State&quot; &quot;$B2BPATH\online.hlp&quot;<br />
<br />
but that dont work as mentioned (although ini is ok)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th February 2005, 19:01</div></div><div class="posttext">Perhaps you could attach your script.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">14th February 2005, 21:07</div></div><div class="posttext">sorry, thats not really possible, only snippets<br />
(it's a 40kb script with many subroutines and lots of <br />
variables and some external language files)<br />
<br />
[Settings]<br />
NumFields=8<br />
Title=<br />
BackEnabled=0<br />
BackButtonText=&lt; Back<br />
NextEnabled=1<br />
NextButtonText=Next &gt;<br />
CancelEnabled=1<br />
CancelButtonText=Quit<br />
<br />
CancelShow=1<br />
NextShow=0<br />
BackShow=0<br />
<br />
<br />
[Field 1]<br />
[Field 2]<br />
[Field 3]<br />
[Field 4]<br />
[Field 5]<br />
[Field 6]<br />
[Field 7]<br />
<br />
[Field 8]<br />
Type=Link<br />
Text=Online-Help<br />
Left=30<br />
Right=68<br />
Top=120<br />
Bottom=128	<br />
State=<br />
<br />
<br />
<br />
strcpy $B2BPATH $exedir<br />
;for testing purpose only cause later the path <br />
;is compared with the real installpath from registry<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;menu01.ini&quot; &quot;Field 8&quot; &quot;State&quot; &quot;$B2BPATH\online.hlp&quot;<br />
<br />
  InstallOptionsEx::dialog &quot;$PLUGINSDIR\$LANGSHORTmenu01.ini&quot;<br />
    Pop $R0<br />
<br />
<br />
The next normal IO is fully functional<br />
<br />
[Field 12]<br />
Type=Link<br />
Left=260<br />
Right=310<br />
Top=124<br />
Bottom=134<br />
State=Online.hlp<br />
Text=Online Help<br />
<br />
<br />
... this way or i put the full path+file into it..<br />
but not in IOex.<br />
<br />
do you need more information ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">16th February 2005, 19:10</div></div><div class="posttext">Sorry, I was out of NSIS for a while, and I'm now at my school. But I can see from your code that you forgot about the Notify INI value name for Link and Button controls are always required. Clicks won't work if you don't specify this for those 2 controls. This is considered as a feature.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NHOCSUNG</div><div class="date">17th February 2005, 16:41</div></div><div class="posttext">i just want to set the bitmap for Back, Next, Cancel button .... can you guy tell me how</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">20th February 2005, 00:12</div></div><div class="posttext">&gt;&gt; you forgot about the Notify INI value name for Link<br />
i need notify for link ???<br />
Do u want to fool me ? ;)<br />
Displays a static hot text that, when the mouse is passed over its area, the mouse cursor turns into a hand. When combined with Label, Bitmap and Icon controls, this makes their areas also make the mouse turn into a hand, and execute the action of this control. It's better to don't use any text with this trick.<br />
<br />
Please update your readme, thanks i reserved the old one<br />
[...]See Notify value name below for more information on notifications.<br />
I'll try...<br />
notify=onclick works without any additional code thx<br />
<br />
now the other point - i need to redraw the IO after abort - possible ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">20th February 2005, 14:04</div></div><div class="posttext">Please update your readmeAs IOEx is on betas this is not a thing that is going to be usually done. My priority is more on the plugin itself than docs so maybe some kind of information on docs could be still wrong after changes.<br />
<br />
now the other point - i need to redraw the IO after abort - possible ?That's what I'm trying to do on next versions. Fortunately I'm going to work more on IOEx this week because of the February school vacation.:D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th February 2005, 14:41</div></div><div class="posttext">Originally posted by deguix <br />
That's what I'm trying to do on next versions. Fortunately I'm going to work more on IOEx this week because of the February school vacation.:D <br />
<br />
Damn, this is my last day today :(<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">20th February 2005, 16:48</div></div><div class="posttext">If I had school Saturdays and Sundays, and they took off those winter days off and holidays, about more than half of the year would be a vacation. :D (180 days of school in total)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">20th February 2005, 17:57</div></div><div class="posttext">@deguix<br />
thx for help - i did it another way now, not less comfortable<br />
<br />
wish you happy holidays :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">robber98</div><div class="date">26th February 2005, 01:28</div></div><div class="posttext">Hi deguix<br />
<br />
I tried out the transparent flags for BMP and it works! Thanks a lot!  <br />
<br />
However, the custom page re-draw itself slowly (really slow).  I am pretty sure that the flag slowing it down because once the flag removed, the custom page loaded just fine.  Is there any work around that I could avoild this problem until next release? FYI, I have 4 BMP on custom page: a background image and 3 images with transpanent flag.  Thanks in advance!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">26th February 2005, 01:39</div></div><div class="posttext">@robber98: I implemented exactly as on original InstallOptions. Try your INI file on it and see if it continues to slow down.<br />
<br />
I'm now accepting help including new features to the plugin. If anyone wants to make or made patches for this plugin, think they're useful, and want them to be implemented on IOEx, you're welcome. TreeView is not an easy control to implement (a month passed and still less than 50% of the TreeView is done) and about no features were added besides the control.<br />
<br />
I lately added a screenshot of the TreeView control to the IOEx Archive page. It's simple looking now, but I'll try to improve it more in the next days.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">geoffrey_4js</div><div class="date">9th March 2005, 16:33</div></div><div class="posttext">Hi,<br />
I'm working on scripts that used installoptions.dll (not installoptionsex) and i've just downloaded and installed InstallOptionsEx and my question is : how to replace the use of installoptions by installoptionsex ?<br />
<br />
(I'm using W2000 SPa and NSIS 2.05)<br />
<br />
Geo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th March 2005, 17:02</div></div><div class="posttext">Have you read the InstallOptionsEx readme?<br />
Place InstallOptionsEx.dll in yor Plugins folder and use InstallOptionsEx:: call.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">geoffrey_4js</div><div class="date">9th March 2005, 17:16</div></div><div class="posttext">I've read that (sorry but as I'm working on a code I've not done, and the guy has quit the company so many things are confusing for me), I will try futhermore (there're no InstallOptions:: call used in the code).<br />
<br />
EDIT : I've changed all InstallOptions:: call by InstallOptionsEx:: call in system.nsh. It compiles, it make InstallOptionsEx properties working (I've tried with NextEnabled=0) but MUI_PAGE_WELCOME doesn't displayed rightly.<br />
<br />
EDIT 2 : as written in the doc, I've also try to rename InstallOptionsEx.dll in InstallOptions.dll but the MUI_PAGE_WELCOME doesn't displayed rightly anymore.<br />
<br />
To be sure I've understant a main point : InstallOptionsEx is InstallOptions, but developped more deeply ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th March 2005, 17:43</div></div><div class="posttext">Yes.<br />
If you need to use InstallOptionsEx's features, then use it instead of just InstallOptions, else stick with default InstallOptions.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">10th March 2005, 01:24</div></div><div class="posttext">EDIT 2 : as written in the doc, I've also try to rename InstallOptionsEx.dll in InstallOptions.dll but the MUI_PAGE_WELCOME doesn't displayed rightly anymore.That's what I'm planning to next version, try to make support again to the &quot;SendMessage&quot; command on some controls that have been using the &quot;custom draw&quot;.<br />
<br />
To be sure I've understant a main point : InstallOptionsEx is InstallOptions, but developped more deeply ?Yes, except for the docs which is not looking that &quot;helpful&quot; right now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">geoffrey_4js</div><div class="date">10th March 2005, 08:17</div></div><div class="posttext">So is it a way to use InstallOptionsEx instead of InstallOptions and having the pages displayed correctly ? <br />
<br />
Or should I use InstallOptions and use InstallOptionsEx with some dll call when I need it ? (I can't really figure out how both can works together... :-\ )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th March 2005, 08:45</div></div><div class="posttext">In MUI's System.nsh, just use InstallOptionsand in your installer script use InstallOptionsEx. As simple as that.<br />
That means you get two InstallOptions dll's in your installer though.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">geoffrey_4js</div><div class="date">10th March 2005, 10:24</div></div><div class="posttext">It's me again :)<br />
<br />
In my custom dialog, I've tried to use InstallOptionsEx but I can't extract the INI file.<br />
<br />
With InstallOptions.dll, I was doing that in tne .init function :<br />
<br />
Function DlgJvmDetection.onInit<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT_AS &quot;${INCLUDES_DLGS_DIR}\DlgJvmDetection.ini&quot; &quot;DlgJvmDetection.ini&quot;<br />
FunctionEnd<br />
<br />
And I've tried :<br />
<br />
Function DlgJvmDetection.onInit<br />
  InitPluginsDir<br />
  File /oname=$PLUGINSDIR\DlgJvmDetection.ini DlgJvmDetection.ini<br />
FunctionEnd<br />
<br />
Function DlgJvmDetection.onInit<br />
  File /oname=${INCLUDES_DLGS_DIR}\DlgJvmDetection.ini DlgJvmDetection.ini<br />
FunctionEnd<br />
<br />
<br />
But I get a &quot;File: &quot;DlgJvmDetection.ini&quot; -&gt; no files found.&quot; error in both of the case.<br />
<br />
EDIT : Ok, I've look inside system.nsh and solve my problem :<br />
<br />
Function DlgJvmDetection.onInit<br />
  InitPluginsDir<br />
  File &quot;/oname=$PLUGINSDIR\DlgJvmDetection.ini&quot; &quot;${INCLUDES_DLGS_DIR}\DlgJvmDetection.ini&quot;<br />
FunctionEnd<br />
<br />
<br />
EDIT 2 : I achieve to made all work together :D, thx for your help.<br />
All I had to do is to add two macros (the two I was using with InstallOptions) :<br />
!macro MUI_INSTALLOPTION****INITDIALOG FILE<br />
<br />
  !verbose push<br />
  !verbose ${MUI_VERBOSE}<br />
<br />
  InstallOptionsEx::initDialog /NOUNLOAD &quot;$PLUGINSDIR\${FILE}&quot;<br />
<br />
  !verbose pop<br />
<br />
!macroend<br />
<br />
!macro MUI_INSTALLOPTION****SHOW<br />
<br />
  !verbose push<br />
  !verbose ${MUI_VERBOSE}<br />
<br />
  InstallOptionsEx::show<br />
  Pop $MUI_TEMP1<br />
<br />
  !verbose pop<br />
<br />
!macroend<br />
<br />
I've got (a last ?) question : for the moment, I put those macro in DlgJvmDetection.nsi containing the callbacks functions and some functions to go with my custom page INI (DlgJvmDetection.ini).<br />
<br />
I will probably have to use InstallOptionEx in other custom pages so what is better :<br />
- to put those macros in system.nsh<br />
- to create a system_ex.nsh containing the macro specific to InstallOptionEx ??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">10th March 2005, 12:22</div></div><div class="posttext">2. Answer: to create a system_ex.nsh containing the macro specific to InstallOptionEx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">geoffrey_4js</div><div class="date">10th March 2005, 14:09</div></div><div class="posttext">Thx for your quick help and advices. The library is done and used.<br />
<br />
I've got a new problem. I've got a LINK control, and would like that when clicked, it open an URL with Internet Explorer (to install a program,it needs IE :-\). My main webbrowser is Firefox, and if I just put an URL as STATE value for the LINK control, with notify=ONCLICK , it correctly open the link in Firefox.<br />
<br />
In the doc, there is written, for the STATE field option used with a LINK control : &quot;Specifies something to be executed or opened (like &quot;Exec&quot; command from NSIS).&quot;<br />
<br />
But I've tried many different syntax but it doesn't work (nothing happens when I click) <br />
<br />
(I'm using WriteIniStr in the .pre callback on my custom dialog)<br />
<br />
WriteIniStr &quot;$PLUGINSDIR\DlgJvmDetection.ini&quot; &quot;Field 10&quot; &quot;State&quot; &quot;Exec '$WINDIR\explorer.exe ${JVM_DOWNLOAD_URL}'&quot;<br />
<br />
WriteIniStr &quot;$PLUGINSDIR\DlgJvmDetection.ini&quot; &quot;Field 10&quot; &quot;State&quot; '&quot;$WINDIR\explorer.exe&quot; &quot;${JVM_DOWNLOAD_URL}&quot;'<br />
<br />
WriteIniStr &quot;$PLUGINSDIR\DlgJvmDetection.ini&quot; &quot;Field 10&quot; &quot;State&quot; 'Exec '&quot;$WINDIR\explorer.exe ${JVM_DOWNLOAD_URL}&quot;'<br />
<br />
WriteIniStr &quot;$PLUGINSDIR\DlgJvmDetection.ini&quot; &quot;Field 10&quot; &quot;State&quot; &quot;$WINDIR\explorer.exe ${JVM_DOWNLOAD_URL}&quot;<br />
<br />
Is it a syntax problem (with the &quot; and '), or something else ?<br />
<br />
And secondly, does a way to center text in a LABEL control exist ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th March 2005, 15:21</div></div><div class="posttext">Just pass it ${JVM_DOWNLOAD_URL}. You don't need to pass it the path to Windows explorer.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">geoffrey_4js</div><div class="date">10th March 2005, 15:23</div></div><div class="posttext">The problem is that if I do that, it will open the URL with the default web browser, but I want to force the use of IE.<br />
<br />
I've got that in my .ini at execution :<br />
<br />
[Field 10]<br />
Type=Link<br />
Text=Windows Automated Downloads<br />
Left=95<br />
Right=292<br />
Top=79<br />
Bottom=87<br />
Notify=ONCLICK<br />
State=&quot;C:\WINNT\explorer.exe&quot; &quot;http://www.java.com/en/download/windows_automatic.jsp&quot;<br />
<br />
And if I paste &quot;C:\WINNT\explorer.exe&quot; &quot;http://www.java.com/en/download/windows_automatic.jsp&quot; in my windows workplace, it launch IE and open the right page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pidgeot</div><div class="date">10th March 2005, 16:32</div></div><div class="posttext">Try WriteIniStr &quot;$PLUGINSDIR\DlgJvmDetection.ini&quot; &quot;Field 10&quot; &quot;State&quot; '&quot;$WINDIR\explorer.exe&quot; ${JVM_DOWNLOAD_URL}'<br />
or<br />
WriteIniStr &quot;$PLUGINSDIR\DlgJvmDetection.ini&quot; &quot;Field 10&quot; &quot;State&quot; '&quot;$PROGRAMFILES\Internet Explorer\iexplore.exe&quot; ${JVM_DOWNLOAD_URL}'.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">geoffrey_4js</div><div class="date">10th March 2005, 17:03</div></div><div class="posttext">It stil doesn't work. What strange is, is that if I take the string in the State field and copy it in the command prompt, the page open in a IE window...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th March 2005, 18:04</div></div><div class="posttext">If you set up FireFox as your default web browser (go to Options &gt; General) then it will open URL's in Firefox not IE.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pidgeot</div><div class="date">10th March 2005, 19:01</div></div><div class="posttext">That would be the exact problem - the automatic Java installer only works for IE.<br />
<br />
You could try to detect whether or not IE is the default browser. If it isn't, change the link to go to the manual install page, http://www.java.com/en/download/manual.jsp.<br />
<br />
If your app requires Java to run, you could also detect whether it is already installed (there's a function in the archive), and then use MUI_FINISHPAGE_RUN, although it's probably not the most elegant solution.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">10th March 2005, 20:58</div></div><div class="posttext">And secondly, does a way to center text in a LABEL control exist ?This is also planned on next versions. EDIT: I'll create 4 more value names called Align, VAlign (for control positionment), TxtAlign, TxtVAlign (for text).<br />
<br />
It stil doesn't work. What strange is, is that if I take the string in the State field and copy it in the command prompt, the page open in a IE window...IOEx uses the ShellExecute (http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/reference/functions/shellexecute.asp) function from Win API. It requires the file location to be separated from the parameters on separate function parameters (meaning, separated into &quot;lpFile&quot; and &quot;lpParameters&quot;). So what you're trying to do is not possible right now. InstallOptions also has this problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">geoffrey_4js</div><div class="date">11th March 2005, 08:11</div></div><div class="posttext">@Pidgeot : I didn't find the function in the archive but developpe my own. It's a good idea to test if IE is the default browser or not, and then choose the url. I will apply this solution.<br />
<br />
@deguix : the manuel is a bit confusing cause according to it, what I would like to do seems possible. Do you plan to add this functionnality to InstallOptionsEx ? (for exemple by addind a field in the ini (one for the app to launch and one for the parameters for exemple ??). So it's only possible to put :<br />
- an url<br />
- an exec without parameters<br />
in the State field of a Link control ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">11th March 2005, 09:13</div></div><div class="posttext">Do you plan to add this functionnality to InstallOptionsEx ? (for exemple by addind a field in the ini (one for the app to launch and one for the parameters for exemple ??).Yes, but how I still don't know at this point. I gonna figure this out later.<br />
<br />
So it's only possible to put :<br />
- an url<br />
- an exec without parameters<br />
in the State field of a Link control ?Yeah.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">geoffrey_4js</div><div class="date">11th March 2005, 09:44</div></div><div class="posttext">OK, i'll keep watching out this topic. Great great job indeed :up:, the whole NSIS stuff.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">11th March 2005, 12:26</div></div><div class="posttext">TreeView control is complete for this version (I'll leave &quot;ownerdraw&quot; style for the next version). IOEx planned release date is probably sometime next week or a week after.<br />
<br />
To fix your problem, geoffrey_4js, I'm thinking on spliting the string by an &quot;|&quot;. My objective is to make the syntax compact (not so many INI value names).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">geoffrey_4js</div><div class="date">11th March 2005, 14:00</div></div><div class="posttext">Your idea sounds good,so we could do something like that :<br />
State=&quot;$WINDIR/explorer.exe&quot;|&quot;$URL&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">17th March 2005, 07:18</div></div><div class="posttext">Either i didn't found it in the docs or it's not yet supported:<br />
<br />
I have a DropList with a lot of values. Is there a way to make this control editable? My list will never contain all possible values so i want to give the user the chance to enter a new value or chance an list entry.<br />
<br />
Any idea?<br />
<br />
(Using latest Version dated Jan 22 2005)<br />
<br />
regards<br />
<br />
flizebogen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">17th March 2005, 08:49</div></div><div class="posttext">You'd need a combo box for editing. I don't know if it's in IOEx (can't check here at college).<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">17th March 2005, 09:06</div></div><div class="posttext">Thanks, combobox is exactly what i'm looking for and works very well</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">19th March 2005, 22:45</div></div><div class="posttext">Your idea sounds good,so we could do something like that :<br />
State=&quot;$WINDIR/explorer.exe&quot;|&quot;$URL&quot;I changed my idea over it. Maybe this new idea will go against the direction which this feature was going, but I now think that it should be removed from IOEx, because there is already a better way to doing that with NSIS (using &quot;LeaveFunction&quot; and Exec command). The same applies for &quot;ValidateText&quot; (using &quot;LeaveFunction&quot; and MessageBox command).<br />
<br />
What do you think about it, should I keep those two, or should I remove them from IOEx?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kike_velez</div><div class="date">21st March 2005, 08:30</div></div><div class="posttext">Hello<br />
<br />
Is posible works with InstallOptionEx in an IDE like HM Nis Edit?<br />
<br />
Thanks in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">21st March 2005, 14:25</div></div><div class="posttext">Yes, but you should create &quot;Unknown&quot; controls for controls that don't exist on InstallOptions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">22nd March 2005, 09:31</div></div><div class="posttext">Not so many things this version were implemented, but the implementation of TreeView was the feature I spent my time the most. Other big changes were the fix of a bug existant since 2.4.1 beta 10 about Password controls, and the inclusion 4 brand new INI value names for &quot;Field #&quot; INI section. Take a look at the changes:<br />
<br />
- Added new control type: TreeView. <br />
- Major Fix: Password controls without a value for Text INI value name gave a fatal error. <br />
- Added new flags to Flags INI value name: CHECKBOXES for TreeView controls, TRANSPARENT for Animation controls (second implementation). <br />
- Removed flags from Flags INI value name: RIGHT for CheckBox and RadioButton controls, LEFT for UpDown controls. <br />
- Added new INI value names for &quot;Field #&quot; INI sections: Align, VAlign, TxtAlign,and TxtVAlign. <br />
- Removed ellipsis support for strings that pass control border boundaries on Label, Link, DropList, ComboBox and ListBox controls. <br />
- Added tab character support for Label and Link controls. <br />
Added carriage return, new line and tab characters support for DropList, ComboBox and ListBox controls. <br />
- Adjusted rectangles of Label and Link controls so that the focus rectangle don't cut part of strings (only Link controls) and have at least 1 pixel of background color on the left and right of the control. <br />
- Right-To-Left dialogs have the UpDown control to invert its position in relation to its buddy control. <br />
- Forgot to mention about NOWORDWRAP flag for Text and Password controls in the documentation. <br />
- MaxLen INI value name for TrackBar controls didn't calculate correctly the maximum number of items. Now if you specify 10, there will be 10 items. <br />
- Aplied patch #1164307 (http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1164307&amp;group_id=22049&amp;atid=373087).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dandaman32</div><div class="date">21st April 2005, 21:12</div></div><div class="posttext">Would like a &quot;display and continue script&quot; function (for things like showing a trial version nag screen and disabling the Next button for 5 seconds)<br />
<br />
-dandaman32</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dimator</div><div class="date">26th April 2005, 01:50</div></div><div class="posttext">Hi, I'm curious to see a usage of the progressbar control.  What I tried to do was this:<br />
<br />
<br />
Function MyPage<br />
  InstallOptionsEx::initDialog /NOUNLOAD &quot;$PLUGINSDIR\test.ini&quot;<br />
  Pop $hwnd<br />
  InstallOptionsEx::show<br />
  Pop $0<br />
<br />
  StrCpy $R0 &quot;0&quot;<br />
<br />
  loop:<br />
    WriteINIStr &quot;$PLUGINSDIR\test.ini&quot; &quot;Field 2&quot; &quot;State&quot; &quot;$R0&quot;<br />
  <br />
    IntOp $R0 $R0 + 1<br />
    Sleep 25<br />
  IntCmp $R0 100 +1 loop +1<br />
  <br />
  cancel:<br />
<br />
FunctionEnd<br />
<br />
<br />
Where Field 2 is a progress bar of course, but I guess that's not the way, because IOEx::show does not return?  Any suggestions?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">26th April 2005, 11:10</div></div><div class="posttext">You have to use SendMessage to adjust the current position with the message PBM_SETPOS:<br />
  !define PBM_SETPOS 0x0402<br />
<br />
  GetDlgItem $0 $hwnd 1201 ;field # + 1200 - 1<br />
  StrCpy $R0 &quot;0&quot;<br />
<br />
  loop:<br />
    SendMessage $0 ${PBM_SETPOS} $R0 &quot;&quot;<br />
  <br />
    IntOp $R0 $R0 + 1<br />
    Sleep 25<br />
  IntCmp $R0 100 +1 loop +1<br />
  <br />
  cancel:<br />
Or using LogicLib.nsh:<br />
  !define PBM_SETPOS 0x0402<br />
<br />
  GetDlgItem $0 $hwnd 1201 ;field # + 1200 - 1<br />
<br />
  ${For} $R0 1 100<br />
    SendMessage $0 ${PBM_SETPOS} $R0 &quot;&quot;<br />
    Sleep 25<br />
  ${Next}<br />
About the docs:<br />
<br />
- I found a problem in the new docs where &quot;Notify&quot; INI value name in &quot;Field #&quot; section disappeared. I'm gonna check this out later.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dimator</div><div class="date">28th April 2005, 00:15</div></div><div class="posttext">Having such loops block other UI activity by the user, so he can't for example click Cancel.  I wonder if it's possible to include System::Call ${sysGetMessage} and System::Call ${sysDispatchMessage} in the loop, to keep the UI responsive.<br />
<br />
I am not totally comfortable with how NSIS handles the message loop, so any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dimator</div><div class="date">4th May 2005, 03:04</div></div><div class="posttext">So, due to my complete confusion regarding how to update a progress bar without blocking the rest of the UI, I have decided to hack IOEx.  What I want to do is to modify the following loop in showCfgDlg() (InstallerOptions.cpp):<br />
<br />
<br />
  while (!g_done) {<br />
    MSG msg;<br />
    int nResult = GetMessage(&amp;msg, NULL, 0, 0);<br />
    if (!IsDialogMessage(hConfigWindow,&amp;msg) &amp;&amp; !IsDialogMessage(hMainWindow,&amp;msg))<br />
    {<br />
      TranslateMessage(&amp;msg);<br />
      DispatchMessage(&amp;msg);<br />
    }<br />
  }<br />
<br />
<br />
Somewhere in there, I want to add code that will callback a function in my NSIS installer.  The callback will be... called based on a timer.  So when setting up the IOEx dialog, I will pass a time parameter like 500 msecs, and the above while loop will determine if that time has elapsed and call my callback.  Then, in my callback, I can update the progress bar, and do all the other things I need to do.<br />
<br />
(This whole idea is due to my frustration with all other attempts to update a progress bar automatically, without blocking the UI in a loop.  I have attempted various user32::SetTimber/callback based approaches, but with no luck, so if someone can point me to the &quot;right&quot; way to do this, I'd be happy. :) )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">4th May 2005, 06:49</div></div><div class="posttext">Hmmm... there existed one InstallOptions modification in the past that used this feature... I could merge his idea to the plugin! I just wanted this feature to be implemented as the value name of &quot;Settings&quot; INI section, and to be known as a page notification (like ONTIMEOUT or something). What do you think?<br />
<br />
I forgot about that feature, thanks for reminding me! :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dimator</div><div class="date">4th May 2005, 21:08</div></div><div class="posttext">Sure, that is a good idea.  My approach just calls the Page's leave function after a half a second (repeatedly), although that should probably be specifiable somehow, as in the INI as you said, but I have a deadline for a project, so my goal is to get it working for my needs asap.<br />
<br />
Looking forward to your update!  If it's soon enough, I look forward to using it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">5th May 2005, 23:26</div></div><div class="posttext">Done, I just need to prepare docs. The feature included also halts when a notification from controls is called (like ONCLICK).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dimator</div><div class="date">5th May 2005, 23:36</div></div><div class="posttext">Cool, I'm curious to learn how you implemented this.  I'd be happy to beta test.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">7th May 2005, 08:14</div></div><div class="posttext">This version really don't have much. The only implementation is the TimeOut value name for &quot;Settings&quot; section. See the full list below:<br />
<br />
- Added TimeOut INI value name for &quot;Settings&quot; section. This enables the page to return after the specified time. When notifications are activated, the timer pauses until &quot;Abort&quot; is called on page's validation function. Also, it continues to repeat until the page is closed.<br />
- Added ONRCLICK for TreeView controls.<br />
- Fixed ONCLICK notification flag: Only captured single-clicks when ONDBLCLICK was not set.<br />
- Added the missing Notify INI value name on the documentation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dimator</div><div class="date">9th May 2005, 23:55</div></div><div class="posttext">The TimeOut works great for my purposes.  I'm glad I'll be able to keep my IOEx standard, instead of maintaining my patches.  Thanks again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pingcrosby</div><div class="date">10th June 2005, 12:11</div></div><div class="posttext">InstallOptionsEx &quot;DropList&quot; problem is showing the item lists all compressed togethor.<br />
<br />
To call invoke InstallOptionsEX .. i call<br />
<br />
!macro MUI_RESERVEFILE_INSTALLOPTIONSEX<br />
  !verbose push<br />
  !verbose ${MUI_VERBOSE}<br />
  ReserveFile &quot;${NSISDIR}\Plugins\InstallOptionsEx.dll&quot;<br />
  !verbose pop<br />
!macroend<br />
  <br />
!macro MUI_INSTALLOPTION****DISPLAY FILE<br />
  !verbose push<br />
  !verbose ${MUI_VERBOSE}<br />
  InstallOptionsEX::dialog &quot;$PLUGINSDIR\${FILE}&quot;<br />
  Pop $MUI_TEMP1<br />
  !verbose pop<br />
!macroend<br />
<br />
!insertmacro MUI_INSTALLOPTION****DISPLAY my.ini<br />
Function CustomPageFunction<br />
   !insertmacro MUI_INSTALLOPTION****DISPLAY &quot;my.ini&quot;<br />
FunctionEnd<br />
<br />
<br />
With image below shows both a non InstallOptionsEX and InstallOptions droplist .  As you can see one of the droplists shows the text in a somewhat &quot;cramped&quot; form.<br />
<br />
I have seen this before in Win32 but i cannot remember the reasons/fix.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">10th June 2005, 19:45</div></div><div class="posttext">The fix is to use ListItemsHeight to a higher value (the default is 10 pixels, I think). I knew of this problem before but I didn't know if there are any computer that uses larger fonts. Thanks for the report!<br />
<br />
You see, ListItemsHeight INI value name is similar to Height for other controls, but I just don't implement like this because that's the Windows default. You can suggest me this if you think it's better.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pingcrosby</div><div class="date">10th June 2005, 21:30</div></div><div class="posttext">ListItemsHeight :: make sense.  I just didnt see it in the .ini settings inside the documentation.<br />
<br />
If i may humbly make a couple of suggestions!<br />
<br />
Could you make a note as to why you may want to use ListItemsHeight in the documentation.<br />
<br />
Would you consider re-ordering the .ini file list in the documentation - ListItemsHeight sits between the Font... settings in my docs.<br />
<br />
***<br />
PS..<br />
I really should just shut up and say thankyou for InstallOptionsEX - you ve done a fantastic job.<br />
<br />
Its made my installer very cool.. <br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">11th June 2005, 04:03</div></div><div class="posttext">Thanks. On the next version in the documentation, &quot;ListItemsHeight&quot; will be located right after &quot;Left/Right/Top/Bottom/Height/Width&quot;.<br />
<br />
Could you make a note as to why you may want to use ListItemsHeight in the documentation.Do you mean if I could put in the docs why I chose &quot;ListItemsHeight&quot; instead of putting in place of the normal &quot;Height&quot;, and not changing the actual value for &quot;Height&quot; to another INI value name, like &quot;DropListHeight&quot;?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pingcrosby</div><div class="date">11th June 2005, 11:13</div></div><div class="posttext">Could you make a note as to why you may want to use ListItemsHeight in the documentation.<br />
<br />
<br />
Please ignore this - i wrote this when i was very tired and on further reading this morning it is nonsensical.  All the information is already included in the documentation.<br />
<br />
Sorry to waste your time on this one.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">KenA</div><div class="date">20th June 2005, 22:03</div></div><div class="posttext">Ok, I'm lost. :confused: Has anybody has a bit of code showing how to use the ProgressBar control with InstallOptionEx ?<br />
<br />
Thanks in advance,<br />
<br />
KenA</div></div><hr />


<div class="post"><div class="posttop"><div class="username">KenA</div><div class="date">21st June 2005, 10:42</div></div><div class="posttext">Hi,<br />
<br />
I'm sorry to insist but nobody has a working piece of code using the ProgressBar control ? Or at least some pseudo code or explanations describing what should go in the pre page and what should go to the leave page ? So far I managed to either freeze the installer (I use the initDialog with /NOUNLOAD or quit with a crash without /NOUNLOAD, with no update of the control in either case. :(<br />
D'oh ! The latest version (and the latest help file in particular) posted in this forum opened my eyes, so problem solved !:D <br />
<br />
Deguix, thanks again for the great plugin even if sometimes I really struggle with the doc.:up: <br />
<br />
KenA</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">28th June 2005, 12:04</div></div><div class="posttext">it would probably be a good idea to replace the seperators of ListItem (&quot;|&quot;) with something else, so one can use it for a listed item. so far i have to replace all | with $\ and all $ with $$. how about making a future version of IOEx use something else (i.e. $\n)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">28th June 2005, 13:03</div></div><div class="posttext">Deguix, thanks again for the great plugin even if sometimes I really struggle with the doc.:up:<br />
Sorry about that, maybe I'm better at programming IOEx than at developing docs...<br />
<br />
it would probably be a good idea to replace the seperators of ListItem (&quot;|&quot;) with something else, so one can use it for a listed item. so far i have to replace all | with $\ and all $ with $$. how about making a future version of IOEx use something else (i.e. $\n)?<br />
<br />
I might never told you this, but &quot;\n&quot; and &quot;\r&quot; actually work in ListBox, DropList and ComboBox controls. Also, $\n would bring confusion between NSIS syntax. Writing that with WriteINIStr would be not good at all.<br />
<br />
There is one thing I could do. I could create some escape characters for the characters used on lists: &quot;\|&quot;, &quot;\{&quot; and &quot;\}&quot;. It's quite unfare to don't let the user to use those characters as item names.<br />
<br />
EDIT: Wow! This thread is quite big! It's going to beat the record of the thread with the most posts in NSIS forums!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th June 2005, 14:04</div></div><div class="posttext">:D<br />
<br />
I have an idea. It would be cool to add 'tabs' (like on Desktop Properties). I could use this on one of my installers.<br />
<br />
Something like<br />
<br />
Type=Tabs<br />
...<br />
Text=Tab 1|Tab 2<br />
State=1<br />
<br />
Text = tab names<br />
State = selected index<br />
<br />
The tab clicks would act like NOTIFY and we could use them to change to another IOEx form with the exact same tabs (but with the next one selected with State field).<br />
<br />
How easy would this be to implement?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">28th June 2005, 22:42</div></div><div class="posttext">Tabs are used to hold other controls. This would be a little easy because it only needs to know which controls are going to appear when one tab is selected. Also, the Tab control will need to hide or show the controls when a tab is selected.<br />
<br />
The simplest implementation would be using the value name that I'll add for the next version which is &quot;RefFields&quot; value name. This will be a list of fields to be hidden or shown when tabs are selected or unselected. This list will probably use &quot;|&quot; and &quot;,&quot; characters to separate field indexes.<br />
<br />
The simplest answer then would be yes. I never thought on this idea until now. Thanks for bringing this up! :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th June 2005, 23:09</div></div><div class="posttext">Well, ok if you're up for it, that would be great :)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saivert</div><div class="date">30th June 2005, 17:45</div></div><div class="posttext">Tabs are great, but I don't know how good looking tabs would be in a Wizard dialog. That's why you got multiple pages and next/back buttons. But since I'm a nice guy I wont overrule this completely. Here is my tips:<br />
<br />
Here is my pseudo INI layout:<br />
<br />
<br />
[Field 1]<br />
Type=TabbedPages<br />
Text=Tab 1|Tab 2|Tab 3<br />
State=1<br />
; You got separate IO pages<br />
Pages=page1.ini|page2.ini|page3.ini<br />
Tab= ;filled in by IOEx<br />
<br />
<br />
State in this case contains the index of the tabpage that is visible (to follow the same scheme as the other controls).<br />
You must read the [Settings]State key from the page INI of the visible page to check for clicks on controls within a page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">2nd July 2005, 14:50</div></div><div class="posttext">As I said, I had this idea:<br />
<br />
<br />
Type=Tab<br />
ListItems=Tab 1|Tab 2<br />
State=Tab 2<br />
RefFields=1,2,4|3<br />
<br />
<br />
That's the simplest, effective and most useful general solution to have the least amount of addition of structure to the DLL. I'm trying to find balance between size and features.<br />
The only thing I need to implement here is the handling of Tab controls and the &quot;RefFields&quot; multiple field ID's to work with, nothing more.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">2nd July 2005, 16:02</div></div><div class="posttext">Lately, my betas were slowing down, which is not good for betatesters at all. Also, the TODO's from previous versions which weren't done are now giving a toll on me. Expect to don't have new controls, and to have fast, bugfixing only builds for some versions to come.<br />
<br />
For the plugin size, the most responsible for the increases are new INI value names. 3KB were added to the compressed build this version (19 KB now) and half of it were because of new INI value names. I'm expecting it to make somewhat near the 30KB mark at the end of beta development.<br />
<br />
Now, on to the new features. ListView control is the newest attraction on IOEx. It has features like CHECKBOXES flag (imported from TreeView control), view mode flags, and extra options just for the REPORT_VIEW (which will be futurely used by Header controls). But Link and Button controls aren't going to be passed aside that easily. They have 2 new dialog flags: COLORREQUEST and FONTREQUEST. Let's see the full list of changes:<br />
 Added new value names for &quot;Field #&quot; section: RefField, StateImageList, SmallImageList, LargeImageList, HeaderItems, HeaderItemsAlign, HeaderWidth.<br />
 Added new flags for ListView controls: LIST_VIEW, ICON_VIEW, SMALLICON_VIEW, and REPORT_VIEW and for Link and Button controls: COLORREQUEST, FONTREQUEST.<br />
 Older INI's braking notice: All values supported by OPEN_FILEREQUEST, SAVE_FILEREQUEST and DIRREQUEST flags for Link and Button<br />
controls on State value name and UpDown controls on Text value name were transfered to RefField value name.<br />
 Now Link and Button controls with OPEN_FILEREQUEST, SAVE_FILEREQUEST, DIRREQUEST, COLORREQUEST, FONTREQUEST flags output state values to State value name.<br />
 UpDown controls now detect automatically the text from its buddy control. State value is not used anymore when the buddy control is set.<br />
 Older INI's braking notice: All values for TreeView controls on Text value name ware transfered to StateImageList value name.<br />
 Fixed automatic Custom Draw setting for Label, DropList, ComboBox, and ListBox. Custom Draw setting will only be set if you specify one of the color commands values. Because of this, when this setting is disabled, the colors will be as the Windows' default, and some features like multiline for those controls (except Label) will be disabled. The good news is that this fixes problems when setting text to those controls or change some colors for now. To use custom draw in controls with default color values, use empty values like on &quot;TxtColor=&quot;.<br />
 Added forgotten details about Animation controls support for the State INI value, types of animation supported, TreeView controls support for the StateImageList INI value, and the ONSELCHANGE notification flag.<br />
 Fixed problems with notifications that executed when other handled or non-handled notifications were activated.<br />
 Fixed checkbox state changes on TreeView controls when the space key was pressed.<br />
 Other small bugfixes.<br />
<br />
Just a note on this version, this is what I know I couldn't do yet:<br />
 the flag EDITLABELS is not finished.<br />
 the &quot;\|&quot; escape character is not implemented yet.<br />
 there is a bug on the last parameter of FONTREQUEST flag &quot;State&quot; INI value. The color is indicated as a decimal number.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">2nd July 2005, 20:10</div></div><div class="posttext">I forgot to fix a bug before launching it:<br />
<br />
- ListItems of ListView controls have problems when setting empty item names.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">3rd July 2005, 08:22</div></div><div class="posttext">I made two changes to this build:<br />
<br />
- Added EDITLABELS flag for TreeView and ListView controls.<br />
- Fixed empty item names for TreeView controls.<br />
<br />
This increased the build size in 0.5 KB (now 19.5 KB). First, add features, then remove unnecessary ones and fix bugs.<br />
<br />
I think this strategy keeps me from forgetting what I changed in the plugin, because now I always have a list of what changed. I don't know, keep posting versions this quick would be good for posting numbers here in forums. At least, nobody has to wait anymore for features, because they come as fast as I implement them! :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">3rd July 2005, 22:04</div></div><div class="posttext">Another build, and more fixes and additions:<br />
<br />
- Added MULTISELECT for ListView controls (made single selection default in this case).<br />
- Fixed the return of State and ListItems INI values for Link and Button controls with COLORREQUEST flag.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">4th July 2005, 08:06</div></div><div class="posttext">I have a question regarding the Beta 3 Post build 3:<br />
<br />
I have the following Ini Code:<br />
<br />
<br />
<br />
[Field 17]<br />
Type=Text<br />
Left=20<br />
Right=120<br />
Top=160<br />
Bottom=175<br />
State=<br />
Flags=Disabled<br />
<br />
[Field 18]<br />
Type=Button<br />
Left=130<br />
Right=150<br />
Top=160<br />
Bottom=175<br />
RefField=17<br />
State=<br />
Text=...<br />
Flags=OPEN_FILEREQUEST<br />
NOTIFY=ONCLICK<br />
Filter=All Files|*.*<br />
ToolTipIcon=INFO<br />
ToolTipTitle=Messagetext<br />
ToolTipText=Choose a File to add to your Mail<br />
ToolTipFlags=BALLOON<br />
ToolTipTxtColor=0x000000<br />
ToolTipBgColor=0xE1FFFF<br />
ToolTipMaxWidth=300<br />
<br />
<br />
<br />
I use this 2 Controls to display which file the user had selected. In your Docs you're saying that the Reffield command is input only and that the output of the Filerequest control is the state value of that control. So my question is: Is it still possible that the output is given to another control?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">4th July 2005, 12:55</div></div><div class="posttext">It's RefFields, sorry 'bout that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">4th July 2005, 13:45</div></div><div class="posttext">Now i works - thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saivert</div><div class="date">5th July 2005, 14:00</div></div><div class="posttext">I still think my Tab idea is the best. It make the hole thing more structured as you can keep the fields for the different tabs in separate Ini files. Nothing more would be required really. You just have to read more than one INI in your page leave callback function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">5th July 2005, 18:57</div></div><div class="posttext">Ok? How about the control IDs of the fields when importing other INI's, would fields have to start at 1 also in those INI's?<br />
<br />
1) If yes: This would need extra handling for additional types of control ID's (starting at 1300 for example), a variable containing the groups of tabs that occupy certain ID groups, and a defined limitation of number of controls a page can have. Also, there is the nesting of tabs inside others. What would be the ID's of the controls inside this tab control nested in another? They would have to be in the same ID group, so the division in the number of controls the group could have is halved, and thus the limitation could make the nesting of 5 tab controls, one inside another, to reduce considerably to just 1 control (if the actual limit of controls is 100). I'm not even counting how many INI files you would need to create for this nesting, because that would be in an huge number.<br />
<br />
2) If no: What's the reason for creating separated pages then? You'll be limited to use different ID's for the controls anyways. It's a lot better having only 1 INI to worry about. If you need to be in separate pages, why not concatenate the INI files at run-time? That would be easier than adding more KB's to your favorite plugin for nothing. People don't usually use this feature. This feature is not  even GUI related.<br />
<br />
So, does everyone agree that my idea is better for the future of IOEx? :rolleyes:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th July 2005, 19:31</div></div><div class="posttext">I think it's fine. It'll be easier to manage everything in one INI file as well I think.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saivert</div><div class="date">6th July 2005, 05:28</div></div><div class="posttext">So you mean that you want a very huge INI file?<br />
And the controls that are on the tabs are hosted in their own childdialog anyway. You can't just place all contols on one dialog and then do show/hide of controls depending on what tab is selected. No real applications does this. They create separate dialogs for each tab and then swap between these page dialogs (moves active page dialog up z order and hides non-active page dialogs).<br />
<br />
Thus you can have separate INI files and you don't have to worry about control IDs as they are unique within each dialog anyway.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">6th July 2005, 10:35</div></div><div class="posttext">Ok, you have the reason in saying that controls have unique ID's and it does the basic job of Tab controls. :( I was not studying over this type of control yet (didn't read SDK). I was more thinking on fixing bugs and implementing missing features first, and just then implement controls.<br />
<br />
I still don't think I can do it for next versions, because, as I said, it's still a little difficult to manage INI files like that (independent window messages handling and other stuff). <br />
<br />
For this, IOEx would need the support to be used for multiple dialogs, and this is a major TODO. If I can get this going, I can also get the creation of independent dialogs which is also a major TODO. However, I need to work first on remodelating the source code for the implementation of external controls (major TODO). As I implemented almost all the controls that don't need the major TODO's (except for HotKey, ScrollBar, ToolBar, StatusBar) IOEx is getting closer and closer from major release.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saivert</div><div class="date">6th July 2005, 17:26</div></div><div class="posttext">I don't think you should work this much on IOEx. The original purpose of IOEx was to bring more control classes to the playground and not be a complete user-interface tool for NSIS. I don't think we need that much in a installer anyway. If NSIS evolved into being a complete apllication development platform, then maybe...<br />
<br />
What I would like is an easy way in the original InstallOptions plug-in to set and retrieve listbox items without using SendMessaget and GetDlgItem functions. What about simple functions called &quot;ListboxGetItem&quot;, &quot;ListboxSetItem&quot;, &quot;ListboxGetCurSel&quot;, &quot;ListboxDeleteItem&quot; exported by the plug-in. I hate doing extensive string manipulations on the ListItems INI key (searching for a string matching the State and splitting on &quot;|&quot; character. And the NSIS script language was really not intended for this heavy string processing. The end result: You can drop a listbox and have add/remove buttons so people can configure some app right in the installer (add remove some items).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">6th July 2005, 19:23</div></div><div class="posttext">1)I don't know what's the future of NSIS, so I don't also know when I should stop developing on what I have. IOEx might be by far behind other user-interface programs, but at least there is something. If I didn't change it, then you would be stuck with IO and you would try to do it also. This also plays an experience role for me. Besides, NSIS is a really easy language to learn and with a powerful compiler that has a very low overhead and that compiles things very fast in slow computers.<br />
<br />
2) I know, that's what I'm doing right now. I'm verifying the possibility of organizing the plugin's structure to be more object-orientated, which would allow it to easily export individual functions from the DLL. I'm trying to find what's already available (MFC), get a small part of the things I find and modify them to IOEx's ways. After this optimization I could export any type of function you need. But I'm still looking for information, so don't trust totally on what I say here.<br />
<br />
Also, there is one more InstallOptions bug I discovered (without Ex): the text returned by a ComboBox and Text controls can be up to 2 times the actual buffer limit.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th July 2005, 19:31</div></div><div class="posttext">I've always felt that NSIS would be an ideal platform for program development, but it's always lacked some really necessary controls. One thing we could also do with would be to add customised menu (ie File, Edit View etc) and maybe a status bar too.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">6th July 2005, 19:37</div></div><div class="posttext">Yes, of course, I'll get there. But I have no experience with menus whatsoever. What syntax would you suggest?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th July 2005, 21:06</div></div><div class="posttext">I think you'd have to have a Field # for each menu item and it would do NOTIFY by default. You won't need to specify the position/size attributes because it will always be put on the top, in order of Field #. E.g.<br />
<br />
[Field 1]<br />
Type=Menu<br />
ListItems=Open|Save|Save As<br />
<br />
State would be the ListItem that was selected which we can check on the Leave function.<br />
<br />
As for sub-menus, that's something different - not sure if we could do that... in fact I doubt there would be any need to anyway. Basic menus are plenty!<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saivert</div><div class="date">9th July 2005, 05:23</div></div><div class="posttext">The core of NSIS currently handles the UI in such a strict way that turning it into an application programming platform requires massive changes to the core. The wizard page based system only loads plug-ins in the context of a page, and not persistent through the entire application. My NSIS Debugger plug-in creates a new thread where it handles the message queue of a separate window, but that is a different thing. You can pull off many hacks to take over the wizard dialog of NSIS (my recently posted wansis plug-in demonstrates this) but ultimately in the end it is an installer and nothing else.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">9th July 2005, 12:19</div></div><div class="posttext">That's true. But if you treated NSIS differently than a installer system, then it would go away from the goal of being NSIS in the first place. Logically, if everybody would want NSIS to turn into an independent language, it would be harder on people looking for building installers effectivelly. I would prefer NSIS to be more of a programming language, but there are others who prefer NSIS as an ideal tool for creating installers. Even though NSIS have few things big programming languages have, those languages don't have an efficient tool for creating installers like NSIS is. kichik has done a good job on equilibrating both. This equilibrium is also thanks to brainsucker for creating the System plugin.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">18th July 2005, 07:09</div></div><div class="posttext">I agree. I once tried making an installer out of visual basic but that did't work. I see NSIS as an installer system that has its perks. Such as: easy writing of INI files; creates program shortcuts easily; writes to the registry easily; you can use custom graphics; use a background gradient; can use custom made pages; etc... I could go on about it, but to stop taking up space on the server I will stop now. <br />
<br />
I have never found such an installer system that was so easy to learn. I use HM NIS edit to edit my .nsi files. The first time I use NIS edit I went straight to the wizard so I could study the script it produced. My skills have increased dramatically. My hangman setup program is an example of my skills. I might post it on my thread &quot;Just a thought..&quot; just to show what could be done. :cool:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">24th July 2005, 18:39</div></div><div class="posttext">Wow, I about deleted this build from my computer. Luckly there is a recycle bin which I don't clean often. I've changed these things below:<br />
<br />
- Added ListView and TreeView controls support for TxtColor and BgColor values.<br />
- Fixed an interminable loop when UpDown controls had a buddy control that had the ONTEXTCHANGE or ONTEXTUPDATE notification flags.<br />
<br />
I can't promise much about beta 4. It's better to do something than be talking about it every time. Also, no more fast builds. I got tired of doing them when I have not much to offer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th July 2005, 19:51</div></div><div class="posttext">Will tabs still be added someday?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">25th July 2005, 06:08</div></div><div class="posttext">Yes, of course. But there are a lot of suggestions pending. If you want a feature right away, why don't you help me to add what you want quickly? I'd be glad to have my work changed by someone else :rolleyes:.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saivert</div><div class="date">25th July 2005, 11:51</div></div><div class="posttext">Yeah! There are a lot of people who know how to code, but which rather want to wait for others to do it instead.<br />
<br />
Come on... make something all of you...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th July 2005, 11:52</div></div><div class="posttext">I'm still a C++ newb and the IO source especially scares me lol<br />
I'll have a mess around with tabs later today and see if I can implement it into IO.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saivert</div><div class="date">25th July 2005, 15:42</div></div><div class="posttext">That's good to hear. I will try to fixup my wansis plug-in to support skinning of tabcontrols. Read more about it in the proper topic.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">29th July 2005, 17:54</div></div><div class="posttext">Don't know if this is a bug or not, but when I try to use the DropList on Win2k, it is all congested and you can't see the list drop down.  I've attached the image and here's the code:<br />
<br />
<br />
[Field 15]<br />
Type=Label<br />
Text=Select Language:<br />
Left=260<br />
Right=315<br />
Top=8<br />
Bottom=18<br />
Width=<br />
Height=<br />
FontHeight=8<br />
<br />
[Field 16]<br />
Type=DropList<br />
ListItems=English|Japanese<br />
State=English<br />
Left=260<br />
Right=350<br />
Top=18<br />
Bottom=<br />
Width=<br />
Height=<br />
ListItemsHeight=12<br />
Notify=ONSELCHANGE<br />
Flags=DROPLIST<br />
<br />
Also, all of the items are there in the droplist because when the droplist has focus, I can use the keyboard.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">29th July 2005, 17:56</div></div><div class="posttext">Oops, here's the image...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">29th July 2005, 18:05</div></div><div class="posttext">Set &quot;ListItemsHeight&quot; INI value to a number bigger than 15 (the default on the current version).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">29th July 2005, 18:48</div></div><div class="posttext">This doesn't seem to have any effect.  Without ListItemsHeight, it works on XP, just not on 2k.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">29th July 2005, 19:57</div></div><div class="posttext">I misunderstood your problem. Set the &quot;Bottom&quot; value of your &quot;DropList&quot; to be big enough so that it appears correctly on Win2K (I never had Win2K, so I can't test it). Also, take out the &quot;DROPLIST&quot; flag. This is not needed if you're using a &quot;DropList&quot; type of control.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">1st August 2005, 17:07</div></div><div class="posttext">That worked, thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">3rd August 2005, 16:22</div></div><div class="posttext">This time there is some big things: new value names for Settings section that add more compatibility to IO. MUnit INI value name: it adds the ability to use pixels coordinates instead of the dialog units. IOEx just became compatible with InstallOptions 1 pages.<br />
 Reimplementation of NumFields INI value name: The only thing different from IO is that it now detects the number of fields existent in the INI file automatically as default.See the full list of changes for this version: Added MUnit value name for Settings section and NotifyCursor for Field # section. <br />
 Added ListView and TreeView controls support for TxtColor and BgColor values. <br />
 Added EDITLABELS flag for TreeView and ListView controls and MULTISELECT for ListView controls (made single selection default in this case). <br />
 Fixed empty item names for TreeView and ListView controls. <br />
 Fixed the return of State and ListItems INI values for Link and Button controls with COLORREQUEST flag. <br />
 Fixed an interminable loop when UpDown controls had a buddy control that had the ONTEXTCHANGE or ONTEXTUPDATE notification flags. <br />
 Re-added NumFields from original InstallOptions for compatibility reasons. <br />
 Fixed the range of numbers for UpDown controls. Maximum value for MaxLen and MinLen is 2147483646 and the minimum is -2147483646. Also the default values for the two value names are 2147483646 and -2147483646, respectively.I've  discovered the problem that happens with non-WinXP systems about the ComboBox &quot;Height&quot; value: WinXP: 0 = ListItemsHeight + border height * 2 (control is required to show up).<br />
 Other Versions: 0 = 0 (control doesn't show up).I tried to expand the notification system but I didn't get far. I knew that it would be better to have separate plugins to capture mouse movements and for key presses than making everything built-in inside one plug-in.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">niteflyer</div><div class="date">16th August 2005, 14:45</div></div><div class="posttext">Could you confirm 2 bugs in InstallOptionsEx 2.4.2.b4 regarding the flag DIRREQUEST for buttons:<br />
<br />
1) STATE will not be used as input to set the default folder of the DirRequester dialog. I know, this is not documented, but even the documented feature (the default folder will be previous selected one) does not work. REFFIELDS work, but only as documented for the output of the DirRequester. It would be nice to be able to initialize the dialog's default folder via STATE or the referenced textcontrol.  <br />
<br />
2) LISTITEMS displays a pipe character (|) at the end of the string. I can only get rid of this by appending about 700 space characters to the string.<br />
<br />
Two hints for the documentation: you should mention that the NOTIFY-value is mandatory for a button to display a requester. I had no examples and was puzzling some hours to get it work like in 'old' InstallOptions.<br />
<br />
In &quot;How to use - Step 6: Return Value&quot; you mention the return value on the stack (this is documented for &quot;InstallOptions&quot; as well) but in your example for Step 3 (Call the DLL - &quot;show&quot;) you &quot;forget&quot; to pop the return value from the stack. Does InstallOptionsEx provide no return value anymore or did you really forget the POP (there have to be 2 POPs) ?  <br />
<br />
I am currently using NSIS 2.07.<br />
<br />
See my custom testpage in the attachment.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">16th August 2005, 15:44</div></div><div class="posttext">1) There is actually no way to fix this without creating a new custom dialog for this occasion. The input of a folder is not accepted by the BROWSEINFO structure used by the SHBrowseForFolder. If you verify throughtly, even NSIS and InstallOptions have this problem. It always points to the &quot;My Documents&quot; folder first.<br />
<br />
That default value is actually the value when you read from the INI file, not the one which appears, because you can't input a folder name to the control. So, there is no reason for saying the default value that appears, because it's the Windows default = &quot;My Documents&quot;. But still, is better to say what appears anyways for this misunderstanding to don't happen again.<br />
<br />
2) I'll fix that.<br />
<br />
3) Actually, any notification will be enough to bring up the dir request dialog. I'll fix this also.<br />
<br />
4) InstallOptions' example is also wrong on this (the example is copied from there). I'll remove the first push for it to make clear that the plug-in function has a return value.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">niteflyer</div><div class="date">16th August 2005, 16:58</div></div><div class="posttext">I don't see that NSIS or InstallOptions are having problems to set a default folder for SHBrowseForFolder (I did not take a look at the sourcecode). Even Delphi calls this function and it behaves like expected. I don't know how NSIS or InstallOptions are doing this, but Delphi seems to use SendMessage to select the folder [SendMessage(Wnd,BFFM_SETSELECTION,Longint(True),Longint(PChar(TBrowseFolderDlg(Data).FolderName))); in unit BrowseDlg]. Forgive me my insisting...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">16th August 2005, 17:26</div></div><div class="posttext">Oh, I forgot to see the browse callback function, probably there is a way to select it after all. Thanks for giving me the crucial hint (BFFM_SETSELECTION). And I think the problem only happens with IOEx, because this SendMessage was already in the code... I don't like when this happens.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">16th August 2005, 18:09</div></div><div class="posttext">I'm not sure if I found a bug or not, but whenever I try to set the label or link fields (at run-time) in Japanese, the Japanese text doesn't come out right.  I have all my files (nsi,nsh,ini) in Shift-JIS.  I commented in here (http://forums.winamp.com/showthread.php?s=&amp;threadid=224042)  but I wasn't sure if it also applied here.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">16th August 2005, 18:16</div></div><div class="posttext">Can you post a screenshot about the characters appear? IOEx supports only calls ANSI functions and it doesn't support Unicode.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">16th August 2005, 18:55</div></div><div class="posttext">Unfortunately I cannot post a screenshot because of work.  The characters that do appear are Japanese, but they're not the ones that are suppose to be appearing.<br />
<br />
The weird thing, I thought, was that when I do a SetFont on the labels and links between init and show, the Japanese appears correct, but only on English WinXP running in Japanese.<br />
<br />
Here is an example of one field from the ini file and the corresponding code that sets it in the script.<br />
<br />
<br />
[Field 1]<br />
Type=Link<br />
Text=<br />
Left=54<br />
Right=188<br />
Top=8<br />
Bottom=22<br />
Width=<br />
Height=<br />
Notify=ONCLICK<br />
TxtColor=0x000000<br />
BgColor=0xE9E8E5<br />
NotifyCursor=HAND<br />
<br />
<br />
LangString localizedString ${LANG_ENGLISH} &quot;english&quot;<br />
LangString localizedString ${LANG_JAPANESE} &quot;japanese&quot;<br />
...<br />
WriteINIStr &quot;$PLUGINSDIR\install_menu.ini&quot; &quot;Field 1&quot; &quot;Text&quot; &quot;$(localizedString)&quot;<br />
...<br />
Function MenuPre<br />
  Push $HWND<br />
  InstallOptionsEx::initDialog /NOUNLOAD $PLUGINSDIR\install_menu.ini<br />
  Pop $HWND ; HWND of window<br />
  GetDlgItem $R0 $HWND 1200<br />
  SendMessage $R0 ${WM_SETFONT} $MyFont 1<br />
  InstallOptionsEx::show<br />
FunctionEnd<br />
<br />
The font is being set correctly.  The langstring for japanese actually has Japanese in it.  And I've saved all of my script files, ini files, etc. as Shift-JIS encoding.<br />
<br />
Thanks for the help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">16th August 2005, 19:37</div></div><div class="posttext">The weird thing, I thought, was that when I do a SetFont on the labels and links between init and show, the Japanese appears correct, but only on English WinXP running in Japanese.<br />
<br />
Hmmm... this problem doesn't appear to be an IOEx issue. IOEx uses the exact font from the main window, which is from NSIS itself.<br />
<br />
I might know what this problem really is though, SetFont sets the charset to the default ANSI charset. You should use System plug-in and call the &quot;CreateFont&quot; from the Windows API with the SHIFTJIS_CHARSET charset for the font to show correctly. There is a thread talking about this:<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=219310&amp;highlight=SetFont</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">16th August 2005, 21:50</div></div><div class="posttext">I had had the system plug-in and call to CreateFont (based from that thread) and didn't think about changing the charset.  However, I was using the DEFAULT_CHARSET, which should have worked on a Japanese system, right?  Anyways, I changed it to:<br />
<br />
!define DEFAULT_CHARSET 0x01<br />
!define SHIFTJIS_CHARSET 0x80<br />
${If} $LANGUAGE == ${LANG_JAPANESE}<br />
  StrCpy $CharSet ${SHIFTJIS_CHARSET}<br />
${Else}<br />
  StrCpy $CharSet ${DEFAULT_CHARSET}<br />
${EndIf}<br />
System::Call &quot;gdi32::CreateFont(i 0, i 0, i 0, i 0, i 0, \<br />
                i 0, i 0, i 0, i $CharSet, i ${OUT_DEFAULT_PRECIS}, \<br />
                i ${CLIP_DEFAULT_PRECIS}, i ${DEFAULT_QUALITY}, \<br />
                i ${DEFAULT_PITCH}, t 'Sans Serif') i .r0&quot;<br />
<br />
This doesn't work either.  It will still change appropriately on my English WinXP system, but my Japanese WinXP system, still doesn't show correct Japanese.<br />
<br />
Thanks.<br />
<br />
EDIT:<br />
Also, the title bar caption and the button I have don't change on the English WinXP (ever).  Is this because of how Windows works?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">17th August 2005, 23:18</div></div><div class="posttext">Well, I just tested IO vs IOEx with only a custom page and one button.  The results: IO displayed correct Japanese on Japanese machine and IOEx displayed the word &quot;2Button&quot; instead of Japanese text on Japanese machine.<br />
<br />
If you need more information, just let me know.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>