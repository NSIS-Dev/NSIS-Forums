<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" extraction on quit ???, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  extraction on quit ??? NSIS Discussion" />
	
	<title> extraction on quit ??? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  extraction on quit ???</div>
<hr />
<div class="pda"><a href="t-269690.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=269690">extraction on quit ???</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">theblazingangel</div><div class="date">17th April 2007, 15:24</div></div><div class="posttext">i've got another problem. the following script (stripped down) creates C:\temp\test.txt (0 byte file) when it's not supposed to (prerequisite check failed)<br />
<br />
note #1: the file is not actually 0 bytes, the one i'm testing with is 21 bytes!<br />
note #2: it only happens after pressing the 'ok' button on the error message<br />
note #3: it only happens with the finish page reference present<br />
<br />
i'm using nsis v2.25<br />
<br />
;--------------------------------<br />
; Modern interface settings<br />
<br />
    !include &quot;MUI.nsh&quot;<br />
<br />
;--------------------------------<br />
; General<br />
<br />
    Name 'test'<br />
    InstallDir &quot;C:\temp\&quot;<br />
    OutFile &quot;test.exe&quot;<br />
<br />
;--------------------------------<br />
; Pages<br />
<br />
    !insertmacro MUI_PAGE_DIRECTORY<br />
      !define MUI_PAGE_CUSTOMFUNCTION_SHOW 'InstFunc_CheckPreReq'<br />
    !insertmacro MUI_PAGE_INSTFILES<br />
    !insertmacro MUI_PAGE_FINISH<br />
<br />
;--------------------------------<br />
; Languages<br />
 <br />
    !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
;--------------------------------<br />
; Installation<br />
<br />
    Section 'Installation'<br />
<br />
	SetOutPath $INSTDIR<br />
<br />
	File test.txt<br />
<br />
    SectionEnd<br />
<br />
;--------------------------------<br />
; Installer/Uninstaller Functions<br />
<br />
    Function InstFunc_CheckPreReq<br />
<br />
	IfFileExists $INSTDIR\test_2.txt +3 0<br />
	    MessageBox MB_OK|MB_ICONSTOP &quot;Error: Prerequisite check failed! You must install ' test_2.txt ' first!&quot;<br />
	    Quit<br />
<br />
    FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">theblazingangel</div><div class="date">17th April 2007, 15:52</div></div><div class="posttext">nevermind, fixed it by using MUI_PAGE_CUSTOMFUNCTION_PRE instead of MUI_PAGE_CUSTOMFUNCTION_SHOW<br />
<br />
but shouldn't the fact it does this be considered a bug?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th April 2007, 20:12</div></div><div class="posttext">Talk about some mad usage of Quit... I added a check for Quit so the sections won't start executing if Quit was called in the show function.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>