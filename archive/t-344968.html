<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait in separate thread, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait in separate thread NSIS Discussion" />
	
	<title> ExecWait in separate thread [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait in separate thread</div>
<hr />
<div class="pda"><a href="t-344968.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=344968">ExecWait in separate thread</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">samiz</div><div class="date">18th May 2012, 07:58</div></div><div class="posttext">Hi,<br />
<br />
My installer does heavy processing/DB interaction by calling a separate exe. I am using ExecWait to call that exe but the issue is that NSIS installer GUI shows 'Not Responding' in its title bar after some time (specially if you click once or twice on NSIS UI). Can I call ExecWait so that it does not block NSIS GUI thread?<br />
<br />
Thanks,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">18th May 2012, 11:53</div></div><div class="posttext">First you should specify why you are performing a lengthy process execution in page callbacks? Are you modifying the database? If so then you should be doing this in a Section. The user's machine should never be modified until they have clicked Install.<br />
<br />
If you must run it before the user clicks Install then you are out of luck. NSIS does not support threading as its instructions are not atomic - they will not work correctly in multiple threads (trust me I have tried).<br />
<br />
Are you displaying a Banner while it does its work? The installer may become unresponsive but a Banner will still display a message.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">18th May 2012, 16:52</div></div><div class="posttext">You could try http://nsis.sourceforge.net/BgWorker_plug-in but as Afrow said, not everything in NSIS is thread safe...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">samiz</div><div class="date">29th May 2012, 05:50</div></div><div class="posttext">Thanks for ur replies. Can I call macros in BGWorker (instead of functions).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">29th May 2012, 09:38</div></div><div class="posttext">Yes and no, macros work at compile time, not run time...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">samiz</div><div class="date">29th May 2012, 09:42</div></div><div class="posttext">I want to pass parameters to that function. Previously I had done it using macros. Any idea how to do this in BGWorker case?<br />
<br />
Thanks,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">29th May 2012, 11:47</div></div><div class="posttext">The stack and/or registers will probably work...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">29th May 2012, 23:51</div></div><div class="posttext">Can I call ExecWait so that it does not block NSIS GUI thread?<br />
<br />
If you want a non-blocking version of ExecWait(), why not simply use Exec()?<br />
<br />
Am I right that you want to create the process asynchronously and then wait for its termination at a later point?<br />
<br />
In that case ExecShellWait() from my StdUtils plug-in may be possible way to go:<br />
http://nsis.sourceforge.net/StdUtils_plug-in#ExecShellWait<br />
<br />
(It splits creating the process and waiting for its termination into two separate commands)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th May 2012, 13:29</div></div><div class="posttext">He wants to use ExecWait but without blocking the window message loop.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">samiz</div><div class="date">10th April 2013, 12:49</div></div><div class="posttext">Hi,<br />
<br />
I had successfully incorporated bgworker::callandwait in my code but on one machine (win 7 32 bit) the method I pass isnt being called.<br />
<br />
This is happening on a specific machine only.<br />
<br />
Any idea why?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">11th April 2013, 01:45</div></div><div class="posttext">Maybe you could give us some more information? Example code?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">samiz</div><div class="date">11th April 2013, 08:24</div></div><div class="posttext">Function ConfigurationStart<br />
     GetFunctionAddress $0 Extract<br />
     messagebox mb_ok &quot;$0&quot;    <br />
     BgWorker::CallAndWait<br />
     messagebox mb_ok &quot;done&quot;    <br />
FunctionEnd<br />
<br />
<br />
Function Extract<br />
      messagebox mb_ok &quot;Extracting...&quot;    <br />
FunctionEnd<br />
<br />
<br />
This is sample code which I am using. &quot;Extracting...&quot; never gets displayed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">samiz</div><div class="date">17th April 2013, 07:54</div></div><div class="posttext">any soln?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">19th April 2013, 08:59</div></div><div class="posttext">There is no problem in the code you posted, it worked for me.<br />
This code is not working only on some specific machine?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">samiz</div><div class="date">22nd April 2013, 11:53</div></div><div class="posttext">Yes its happening on a particular machine. Otherwise works fine.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>