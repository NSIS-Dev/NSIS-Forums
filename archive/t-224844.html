<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait, and then wait for 2nd process?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait, and then wait for 2nd process? NSIS Discussion" />
	
	<title> ExecWait, and then wait for 2nd process? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait, and then wait for 2nd process?</div>
<hr />
<div class="pda"><a href="t-224844.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=224844">ExecWait, and then wait for 2nd process?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ShakerWD</div><div class="date">30th August 2005, 12:15</div></div><div class="posttext">hi,<br />
just begun working with nsis. its really nice to work with, especially with EclipseNSIS. first off all thx for these great tools!<br />
<br />
in my installer i'm checking if acrobat reader is installed.<br />
if not, i start the installation with ExecWait. the problem is that the newest acrobat installer launches 2 processes. the first process invoked by me is AcrReader.exe<br />
This process ends and the Reader installation is continued with the msiexec.exe process. <br />
<br />
thus my installation continues during the main reader-instalaltion 'cause AcrReader.exe ended.<br />
<br />
how i can observe these 2 processes? nothing found so far.<br />
need to wait until the 2nd process returns.<br />
<br />
cheers<br />
<br />
Daniel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">KenA</div><div class="date">30th August 2005, 15:43</div></div><div class="posttext">Hi ShakerWD,<br />
<br />
you should be able to monitor msiexec.exe, and any other process for that matter, with the &quot;FindProcDLL&quot; plug-in. Don't remember if it's in standard NSIS install tho.<br />
<br />
Hope this helps,<br />
<br />
KenA</div></div><hr />


<div class="post"><div class="posttop"><div class="username">OJi</div><div class="date">30th August 2005, 19:42</div></div><div class="posttext">when you launch the exe does it begin to decompress acrobat reader ?<br />
if yes - unpack it your self and lauch the msi directly.<br />
<br />
hope it helps.<br />
<br />
OJi.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ShakerWD</div><div class="date">30th August 2005, 21:19</div></div><div class="posttext">you should be able to monitor msiexec.exe, and any other process for that matter <br />
thats what i've already done. the problem with this solution is that adobe starts the msiexec 4!! times. 3 times with the logged in user, the 4th time with an system account. works fine. i'm waiting a well defined time. checking the state of the process. problem is that the 4th msiexec.exe never dies. it will run until the end of windows session. or until killed by hand. so moitoring the process wont give the right solution.<br />
<br />
unpack it your self and lauch the msi directly <br />
took a while to find the needed files. will try tomorrow if it works. but think execwait will run against the same wall as the aproach above cause the hanging process. will try an older reader version too.<br />
<br />
thx for your replies<br />
<br />
cheers<br />
<br />
Daniel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">31st August 2005, 07:03</div></div><div class="posttext">You can launch Acrobat setup at the end on installation (last section, for example) and finish your installer instead of waiting. NSIS 'finish' page must be omitted this case - see finPre function in the attached script. I did this trick for .NET 1.1 installation because it may require reboot (if replaces 1.0). Attached script is draft only, it searchs $EXEDIR for 2 additional predefined setup files (dotnetfx and 'components' package) and (if any) displays sections page (editor itself not requires sections). Hides itself during 'components' package installation (SEC_2).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ShakerWD</div><div class="date">31st August 2005, 09:43</div></div><div class="posttext">thx takhir,<br />
<br />
solved it this way. searched the unpacked files.<br />
added them to installer.<br />
<br />
starting installation with <br />
<br />
ExecWait &quot;msiexec.exe /i $TEMP\Test\Acrobat\Reader.msi&quot;<br />
<br />
<br />
ExecWait can handle the hanging process. works fine now.<br />
<br />
thx for your replies</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>