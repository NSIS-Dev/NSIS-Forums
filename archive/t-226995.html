<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" To remove the startmenu folder, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  To remove the startmenu folder NSIS Discussion" />
	
	<title> To remove the startmenu folder [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  To remove the startmenu folder</div>
<hr />
<div class="pda"><a href="t-226995.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=226995">To remove the startmenu folder</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Maxim30</div><div class="date">26th September 2005, 22:30</div></div><div class="posttext">About the startmenu goup creation I have written:<br />
   Var STARTMENU_FOLDER<br />
   ...<br />
   !insertmacro MUI_PAGE_STARTMENU StartMenu $STARTMENU_FOLDER<br />
   ...<br />
   !insertmacro MUI_STARTMENU_WRITE_BEGIN StartMenu<br />
      CreateDirectory &quot;$SMPROGRAMS\$STARTMENU_FOLDER&quot;<br />
      CreateShortcut ...<br />
   !insertmacro MUI_STARTMENU_WRITE_END  <br />
   ...<br />
   Section &quot;Uninstall&quot;<br />
      !insertmacro MUI_STARTMENU_GETFOLDER MenuAvvio $0<br />
      RmDir &quot;$SMPROGRAMS\$0&quot;<br />
   SectionEnd<br />
<br />
But it does not work not removing the startmenu group with only 4 links: how to write the code to remove correctly the startmenu group ?<br />
About the startmenu goup creation I have written:<br />
   Var STARTMENU_FOLDER<br />
   ...<br />
   !insertmacro MUI_PAGE_STARTMENU StartMenu $STARTMENU_FOLDER<br />
   ...<br />
   !insertmacro MUI_STARTMENU_WRITE_BEGIN StartMenu<br />
      CreateDirectory &quot;$SMPROGRAMS\$STARTMENU_FOLDER&quot;<br />
      CreateShortcut ...<br />
   !insertmacro MUI_STARTMENU_WRITE_END  <br />
   ...<br />
   Section &quot;Uninstall&quot;<br />
      !insertmacro MUI_STARTMENU_GETFOLDER MenuAvvio $0<br />
      RmDir &quot;$SMPROGRAMS\$0&quot;<br />
   SectionEnd<br />
<br />
But it does not work not removing the startmenu group with only 4 links: how to write the code to remove correctly the startmenu group ?<br />
<br />
Massimo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">26th September 2005, 22:33</div></div><div class="posttext">You need to store the folder it was created in.  You could store this value in the registry and then read this to remove the start menu folder during uninstall.  Be careful not to remove the entire start menu, though. ;-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MichaelFlya</div><div class="date">27th September 2005, 05:38</div></div><div class="posttext">Try this...<br />
<br />
<br />
<br />
Section &quot;Uninstall&quot;<br />
!insertmacro MUI_STARTMENU_GETFOLDER Application $STARTMENU_FOLDER<br />
<br />
;You must delete files before deleting folders or it will not work.  For example: <br />
  Delete &quot;$SMPROGRAMS\$STARTMENU_FOLDER\File_01.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\$STARTMENU_FOLDER\File_02.lnk&quot;<br />
<br />
; You also have to delete sub folders if they are there.<br />
  RMDir &quot;$SMPROGRAMS\$STARTMENU_FOLDER\Folder_01&quot;<br />
<br />
; Now the main folder.<br />
  StrCpy $STARTMENU_FOLDER &quot;$SMPROGRAMS\$STARTMENU_FOLDER&quot;<br />
 <br />
  startMenuDeleteLoop:<br />
	ClearErrors<br />
    RMDir $STARTMENU_FOLDER<br />
    GetFullPathName $STARTMENU_FOLDER &quot;$STARTMENU_FOLDER\..&quot;<br />
    <br />
    IfErrors startMenuDeleteLoopDone<br />
  <br />
    StrCmp $STARTMENU_FOLDER $SMPROGRAMS startMenuDeleteLoopDone startMenuDeleteLoop<br />
  startMenuDeleteLoopDone:<br />
SectionEnd<br />
<br />
The var was declared at the top of your script and called<br />
to be stored as the menu writing application var. You must<br />
start with $ at the first it when calling it. <br />
<br />
<br />
-MichaelFlya-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Maxim30</div><div class="date">29th September 2005, 22:43</div></div><div class="posttext">Hello,<br />
your code does not work. My code works, using 'rmdir /r ...', only if installing in the main folder startmenu (programs), not in a subfolder.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>