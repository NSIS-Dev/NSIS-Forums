<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to execute a file?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to execute a file? NSIS Discussion" />
	
	<title> How to execute a file? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to execute a file?</div>
<hr />
<div class="pda"><a href="t-203898.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=203898">How to execute a file?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">duja</div><div class="date">4th January 2005, 21:17</div></div><div class="posttext">Hi!<br />
I'm a total noob on NSIS script etc.<br />
But i got one to work when i used the wizard to install a VB6 app that i made.<br />
But if i want to install all the VB6 needed files and have a simple program thats just extracts them, how do i execute this program in the NSIS setup.<br />
I tried the !execute and then the filepath!<br />
But i dont know where to put the !execute line to get it work.<br />
<br />
I want to execute this program when all the files that i have added are extracted to the specified dir.<br />
When the installation is in progress i wnat the program to be executed!<br />
anyone know how to do this!?<br />
<br />
Greets Duja</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thico_</div><div class="date">4th January 2005, 21:28</div></div><div class="posttext">!define MUI_FINISHPAGE_RUN &quot;$INSTDIR\YourAppName.exe&quot;<br />
<br />
I hope it will help You</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">4th January 2005, 21:37</div></div><div class="posttext">If you haven't already, check all the examples in Examples\Modern UI.<br />
You can view the Modern UI (MUI) readme in Contrib\Modern UI\Readme.html<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">5th January 2005, 07:04</div></div><div class="posttext">Originally posted by duja <br />
I want to execute this program when all the files that i have added are extracted to the specified dir.<br />
When the installation is in progress i want the program to be executed!<br />
 <br />
<br />
You can use one of Exec commands or nsexec plug-in (this depends on your program type - Win or DOS) at the end of Section, please read NSIS manual 4.9.1.2-4</div></div><hr />


<div class="post"><div class="posttop"><div class="username">duja</div><div class="date">5th January 2005, 15:13</div></div><div class="posttext">Thicos example, isn't that just if you choose to run the program after finished installation?<br />
Because i get an error, look at the line of code:<br />
<br />
<br />
; Finish page<br />
!define MUI_FINISHPAGE_RUN &quot;$INSTDIR\PcGuard.exe&quot;<br />
!define MUI_FINISHPAGE_RUN &quot;$TEMP\vbrun60sp6.exe&quot;<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
 <br />
this is the error:<br />
Error in script &quot;C:\Program Files\Microsoft Visual Studio\VB98\PcGuard\SETUP.nsi&quot; on line 42 -- aborting creation process<br />
<br />
Anyone know how to just execute this app. to install needed files!?<br />
<br />
/ Duja</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pidgeot</div><div class="date">5th January 2005, 17:49</div></div><div class="posttext">The MUI_FINISHPAGE_RUN only lets the user choose to run the program after the install is done (you must be using the modern UI for this to be possible). It won't let you execute the defined programs while the installer is still installing.<br />
<br />
After extracting the needed files, place <br />
<br />
Exec &quot;D:\Path\to\file.exe&quot;<br />
<br />
if you want the installation to continue while the file runs. Else, use<br />
<br />
ExecWait &quot;D:\Path\to\file.exe&quot;<br />
<br />
to make the installer wait for the executed program to finish. I'm guessing that's the one you want.<br />
<br />
Alternatively, you could use the nsExec plugin if that's what you need. See the nsExec readme for that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th January 2005, 18:44</div></div><div class="posttext">You missed part of the error. I think it was this...<br />
!define: &quot;MUI_FINISHPAGE_RUN&quot; already defined!<br />
You can't define something twice.<br />
<br />
The MUI_FINISHPAGE_RUN define forces MUI to place a check-box on the finish page which allows the user to decide whether he/she wants to run the single executable in question.<br />
<br />
To execute a program (or two) 'forcefully' when the user clicks Exit/Close you need to do do this:!define MUI_PAGE_CUSTOMFUNCTION_LEAVE &quot;execApps&quot;<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
Function &quot;execApps&quot;<br />
 Exec &quot;$INSTDIR\PcGuard.exe&quot;<br />
 Exec &quot;$TEMP\vbrun60sp6.exe&quot;<br />
FunctionEndIf one of them is a command-line application (with no graphical user-interface) you can use nsExec::Exec (a plugin) instead of Exec to hide the command-line popup window.<br />
<br />
I also recommend you have a message saying that 'appnames' will now run (perhaps a MessageBox). Having two applications with GUI's run at the same time won't make your user's very happy I'm sure...<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">duja</div><div class="date">7th January 2005, 19:16</div></div><div class="posttext">Thank you very much from all help!<br />
I soved it and it works Great now, big thanks to all of you ;)<br />
<br />
/ Duja</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>