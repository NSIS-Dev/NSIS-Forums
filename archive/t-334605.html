<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MUI_DIRECTORYPAGE symbolic path entry?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MUI_DIRECTORYPAGE symbolic path entry? NSIS Discussion" />
	
	<title> MUI_DIRECTORYPAGE symbolic path entry? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MUI_DIRECTORYPAGE symbolic path entry?</div>
<hr />
<div class="pda"><a href="t-334605.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=334605">MUI_DIRECTORYPAGE symbolic path entry?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Ron.Stordahl</div><div class="date">10th September 2011, 17:20</div></div><div class="posttext">Using MUI_DIRECTORYPAGE_VARIABLE the user is offered an opportunity to enter an alternative path to the offered 'variable'.<br />
<br />
I issue this page twice, the first for the location to install program files, and the second time for the destination for the application data files.  This is essential for Vista and Windows 7 and valuable for prior OS versions.<br />
<br />
The path the user enters must be a literal one, but what I would like to offer is something symbolic like %appdata%\BPQ32, which would then be expanded to the rather lengthy literal path.<br />
<br />
Is this possible?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ron.Stordahl</div><div class="date">10th September 2011, 17:38</div></div><div class="posttext">To clarify.  I would like to offer the user the opportunity to enter a symbolic path, such as %appdata%\&quot;something&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">10th September 2011, 17:41</div></div><div class="posttext">Use ExpandEnvStrings to expand the path (Note: You talk about installing to $programfiles so you are elevated and then %AppData% could expand to the wrong users AppData)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ron.Stordahl</div><div class="date">12th September 2011, 22:42</div></div><div class="posttext">I would use this in conjunction with MUI_PAGE_DIRECTORY.  But after the user entered something that I would use ExpandEnvStrings to process I would need to reissue that page with the expanded strings for his approval or to try again.<br />
<br />
So I would want to loop that page somehow until the user approved it.<br />
<br />
Is that possible?  I am aware of MUI_PAGE_CUSTOMFUNCTION_PRE, SHOW and LEAVE, but I am not aware of how the same page can be looped until approved.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">13th September 2011, 06:07</div></div><div class="posttext">In the leave function, you could set the new, expanded string to the dirrequest field and then call abort. Obviously you'll need to add some If ElseIf logic to only call abort once, otherwise you're stuck on the page forever.<br />
<br />
To set the new path, you'll need the HWND of the dirrequest field. To get it, use WinSpy++ to get the field's Control ID. (Start winspy++, drag the white square onto the dirrequest field of an installer's DIRECTORY page, it will show you the Control ID and other stuff.) Then use that Control ID as the item_id parameter for GetDlgItem.<br />
<br />
FindWindow $1 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
GetDlgItem $0 $1 0x3FB<br />
${NSD_SetText} $0 &quot;New Path&quot;<br />
<br />
Please see also: http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.14.6</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>