<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Set focus to textbox, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Set focus to textbox NSIS Discussion" />
	
	<title> Set focus to textbox [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Set focus to textbox</div>
<hr />
<div class="pda"><a href="t-272587.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=272587">Set focus to textbox</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">starsign</div><div class="date">10th June 2007, 11:05</div></div><div class="posttext">Hi,<br />
<br />
I have just started using NSIS - thanks for a great piece of software.<br />
<br />
I have seen a number of posts on setting focus but, perhaps because I am new, they seem to suggest different ways.  I would like to understand which is the best way to set the focus to a text box.<br />
<br />
I have a custom page with 2 textboxes which have to be filled in.  When the user clicks 'Next' and one of the textboxes is empty, I would like set the focus to the empty textbox.  <br />
<br />
My code quite happily catches when a textbox is empty and keeps the user on the page (see below), but to make the interface more user friendly I would like to have the cursor in the empty textbox too:<br />
<br />
Function ValidateUserRegistrationPage<br />
<br />
   ReadINIStr $R0 &quot;$PLUGINSDIR\User Registration.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
  StrCmp $R0 &quot;&quot; 0 +3<br />
    MessageBox MB_ICONEXCLAMATION|MB_OK &quot;Please enter your name.&quot;<br />
    Abort<br />
<br />
   ReadINIStr $R0 &quot;$PLUGINSDIR\User Registration.ini&quot; &quot;Field 4&quot; &quot;State&quot;<br />
  StrCmp $R0 &quot;&quot; 0 +3<br />
    MessageBox MB_ICONEXCLAMATION|MB_OK &quot;Please enter company.&quot;<br />
    Abort<br />
    <br />
FunctionEnd<br />
<br />
I have seen this post below but it seems to mention different ways to do it (e.g. &quot;From version 2.24 InstallOptions has native FOCUS flag&quot;) - how do i use that?<br />
<br />
http://forums.winamp.com/showthread.php?threadid=233866&amp;highlight=focus <br />
<br />
Thanks in advance for any help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th June 2007, 11:59</div></div><div class="posttext">Flags=FOCUS<br />
<br />
If that does not work, use the code on that link that you provided.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">10th June 2007, 16:56</div></div><div class="posttext">My experience with the new FOCUS flag is that it will only work for the first time the screen is displayed. To change the focus after the validation routine fails the user's selections, you need to move focus like this:  ReadINIStr $R0 &quot;$PLUGINSDIR\User Registration.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
  StrCmp $R0 &quot;&quot; 0 +5<br />
  MessageBox MB_ICONEXCLAMATION|MB_OK &quot;Please enter your name.&quot;<br />
  ReadINIStr $R0 &quot;$PLUGINSDIR\User Registration.ini&quot; &quot;Field 3&quot; &quot;HWnd&quot;<br />
  System::Call &quot;User32::SetFocus(i R0).R0&quot;<br />
  Abort<br />
That uses the System plugin, but you don't need to add any includes or anything to call it.<br />
<br />
I recommend using the LogicLib header. It adds a lot of readability to your script and you won't need to use the relative jump that is native to the NSIS commands.<br />
<br />
The StrCmp jump operand changed in the fragment above because the two lines to set the focus were added after the MessageBox. If you remove the MessageBox the relative jump will have to be changed again from 5 to 4. With the LogicLib you would have an If/EndIf structure instead of relative jumps:  ReadINIStr $R0 &quot;$PLUGINSDIR\User Registration.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
  ${If} $R0 == &quot;&quot;<br />
    MessageBox MB_ICONEXCLAMATION|MB_OK &quot;Please enter your name.&quot;<br />
    ReadINIStr $R0 &quot;$PLUGINSDIR\User Registration.ini&quot; &quot;Field 3&quot; &quot;HWnd&quot;<br />
    System::Call &quot;User32::SetFocus(i R0).R0&quot;<br />
    Abort<br />
  ${EndIf}<br />
And since I've already jumped up on the soapbox to say how I like to do things, I like the MUI appearance better than the 'classic'. It isn't always easy to find answers in the documentation, but IMHO the results look better.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">starsign</div><div class="date">10th June 2007, 21:06</div></div><div class="posttext">Thanks for both of your replies.  I will try the implementation you describe.  <br />
<br />
Just one q Don, you mention using the MUI as it looks better - I agree, my code does use it...am I doing something in my code that suggests that i'm not?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th June 2007, 21:42</div></div><div class="posttext">Not really, but when using MUI we tend to use...<br />
!insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;User Registration.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
...instead of...<br />
ReadINIStr $R0 &quot;$PLUGINSDIR\User Registration.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
<br />
They both do exactly the same thing, however.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>