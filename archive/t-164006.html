<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Much to say..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Much to say... NSIS Discussion" />
	
	<title> Much to say... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Much to say...</div>
<hr />
<div class="pda"><a href="t-164006.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=164006">Much to say...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">9th January 2004, 12:18</div></div><div class="posttext">...about:<br />
<br />
Install Options Plugin:<br />
<br />
- Bug: When disabling a filerequest control (at run-time), just disables the textbox, not the button, and after you try to enable (at run-time), it disables the text and enables the button. I will post a snapshot tomorrow due to school.<br />
<br />
- Bug: Everytime I call to reserve a page with a control (or more) with &quot;NOTIFY&quot; flag, it calls the &quot;Leave Function&quot; two times, and return to the location you reserved, and rarely ever call the &quot;Leave Function&quot; naturally (Function (code ends) -&gt; Leave Function (code starts)).<br />
<br />
NSIS Scripting:<br />
<br />
- Bug: When I use SetPluginUnload manual, and call a plugin to unload, it doesn't unload and continue in the $PLUGINSDIR folder, even after quiting the program.<br />
<br />
Zip2Exe:<br />
<br />
- It could be done with NSIS, like the NSIS Updater?<br />
<br />
- Bug: If it converts &quot;a ZIP file to a self extracting&quot; file, should not be &quot;Setup&quot; and &quot;Install&quot; but &quot;NSIS Self-Extractor&quot; and &quot;Extract&quot;, isn't it?<br />
<br />
- Suggestion: Add an option in the explorer context menu the command &quot;Create Self-Extractor with NSIS (Zip2Exe)&quot; of .zip files.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">9th January 2004, 12:30</div></div><div class="posttext">Zip2Exe:<br />
<br />
Yes, it could be done using NSIS, but the current C++ version works fine.<br />
<br />
If you want a diffent name, you can always modify the header file. Setup doesn't sound wrong to me.<br />
<br />
That context menu is a good idea.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eccles</div><div class="date">9th January 2004, 14:06</div></div><div class="posttext">InstallOptions:[list=1] See testnotify.nsi in the Contrib\InstallOptions folder for an example of how to do this. Briefly, FileRequest and DirRequest fields are made up of two Windows controls that you will have to deal with individually. I don't understand. Can you give an example?[/list=1]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">10th January 2004, 10:45</div></div><div class="posttext">The example is here (http://www.geocities.com/civ_deguix/files/rc.zip). Size: 518 kb.<br />
<br />
It is a very complicated example (an installer and a program, both made with NSIS), but is where I found the basic bugs of NSIS.<br />
<br />
Some instructions:<br />
<br />
- To the installer works you need to create a file &quot;cevo.exe&quot; in any folder (the installer verifies every folder for it).<br />
<br />
- To the compilation works, you need to rename the original InstallOptions.dll to InstallOptionsOri.dll and the &quot;Install Options Modification dll&quot; to InstallOptions.dll.<br />
<br />
After installing the program:<br />
<br />
- To see the FileRequest bug, compile the RCPatches.nsi in the subfolder &quot;Source&quot;, or go to &quot;C-Evo Patches Installation&quot; inside the program.<br />
<br />
- To see the NOTIFY bug, compile the RCData.nsi, or go to &quot;New Games Data Options&quot; inside the program.<br />
<br />
- I remembered another bug, when I'm using the Banner Plugin and I use or click in another program at the same time, it doesn't load anything anymore, and you can only close the banner using &quot;Ctrl + Alt + Del&quot;. If you want to verify that, compile the RCMainMenu.nsi, or just run &quot;Registry Changer.exe&quot;.<br />
<br />
- Because you don't installed Civ Evolution (http://c-evo.org), some parts aren't accessible, like the selection pages (I did a very good work here, principally the AI's (using the InstallOptions modification) and those &quot;packs selection&quot;, they are about done).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eccles</div><div class="date">10th January 2004, 11:25</div></div><div class="posttext">The .zip file seems to be corrupted. I tried downloading more than once, and WinZip always gives these errors:<br />
<br />
warning [D:/Documents and Settings/.../rc[1].zip]:  extra 1 bytes at beginning or within Zip file (attempting to process anyway)<br />
Error in file #1:  bad Zip file offset (Error local header signature not found):  0<br />
(attempting to re-compensate)<br />
Extracting RC Installer.exe<br />
bad CRC 2c98ea26  (should be e2cc06dc)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">11th January 2004, 10:46</div></div><div class="posttext">Solved the problem recompiling again the installator (ha?).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eccles</div><div class="date">11th January 2004, 16:08</div></div><div class="posttext">OK, it's working for me now, thanks.To the compilation works, you need to rename the original InstallOptions.dll to InstallOptionsOri.dll and the &quot;Install Options Modification dll&quot; to InstallOptions.dll.&quot;Install Options Modification&quot;? I hacked your scripts so that they compile with the standard InstallOptions, in order to test the problems; but if there are any problems with this modified plugin you should contact its author.with &quot;NOTIFY&quot; flag, it calls the &quot;Leave Function&quot; two timesI can reproduce this one (intermittently), thanks.  I think I know the cause; it will be fixed soon.and rarely ever call the &quot;Leave Function&quot; naturally (Function (code ends) -&gt; Leave Function (code starts))I think I know what you mean here now.  This is not a bug; the &quot;leave&quot; function (a.k.a. the &quot;validate&quot; function) is only called when the Next button is pressed.  Any script you need to run regardless of which button is pressed should follow InstallOptions::dialog/show, and not be in the &quot;leave&quot; function.To see the FileRequest bug, compile the RCPatches.nsi in the subfolder &quot;Source&quot;, or go to &quot;C-Evo Patches Installation&quot; inside the program.This is not a bug; I explained this in my previous post.  You have to handle the textbox and button as two separate controls, and account for them as such when working out what value to give to GetDlgItem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">12th January 2004, 10:20</div></div><div class="posttext">it will be fixed soon.<br />
<br />
OK! Have some progress here.<br />
<br />
At that time, I said what I forgot to change, the &quot;Leave Function&quot; calling was right.<br />
<br />
This is not a bug; I explained this in my previous post. You have to handle the textbox and button as two separate controls, and account for them as such when working out what value to give to GetDlgItem.<br />
<br />
How? They use the same field (in Install Options). So what control number is(are) the button(s)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eccles</div><div class="date">12th January 2004, 15:10</div></div><div class="posttext">How? They use the same field (in Install Options). So what control number is(are) the button(s)?(The example script I mentioned in an earlier post has an example of this.) The control ID of the button part is the control ID of the text part + 1. The control IDs of all following fields are then also + 1. E.g. if fields 1 to 3 are Label, FileRequest and Text, the IDs are:Field 1 (Label):                 1200<br />
Field 2 (FileRequest) text part: 1201<br />
                    button part: 1202<br />
Field 3 (Text):                  1203I'll see if I can make a note about this in the InstallOptions readme (after I sort that bug out...)!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">12th January 2004, 21:13</div></div><div class="posttext">Now things are clear, thanks eccles.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eccles</div><div class="date">12th January 2004, 23:33</div></div><div class="posttext">with &quot;NOTIFY&quot; flag, it calls the &quot;Leave Function&quot; two timesOK, this bug is now fixed. Thanks for the report.<br />
<br />
Anyone want to look at the Banner plugin problem? I'm not familiar with the Banner plugin code.<br />
<br />
-- <br />
Dave.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">11th April 2004, 13:52</div></div><div class="posttext">Now I have a new problem with Install Options plugin:<br />
<br />
- Question: I have a button control in a page to quit the program and to open another using NOTIFY flag with its code in the leave_function. But how can I unload InstallOptions plugin on this situation, as it is showing the page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th April 2004, 18:08</div></div><div class="posttext">When closing your installer everything will be unloaded.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">11th April 2004, 21:46</div></div><div class="posttext">Yeah, but when you quit the program, its file InstallOptions.dll that is inside the $PLUGINSDIR is kept there. I can only delete the dll when it's unloaded, but if I can't unload before quiting, the file will stay in the user's computer...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th April 2004, 23:02</div></div><div class="posttext">You can always let it continue and quit in the pre function of the next page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">12th April 2004, 23:07</div></div><div class="posttext">Joost, I think something should be changed here, as you said here:<br />
<br />
When closing your installer everything will be unloaded.<br />
<br />
And everytime a plugin is unloaded its file is deleted when the installer quits, as you said in another thread (considering here that I didn't unload it on the normal NSIS script):<br />
<br />
...[Files inside $PLUGINSDIR] will automatically be deleted when the installer quits.<br />
<br />
So a plugin used should be deleted (as it is in $PLUGINSDIR) even when not unloaded using a normal NSIS script, because it will be unloaded when the installer quits and deleted after deleting the files.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th April 2004, 07:35</div></div><div class="posttext">If the plug-in is in use it won't be deleted, because the installer is still running when deleting plug-ins.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>