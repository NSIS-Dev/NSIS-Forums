<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" HowTo: show webpages within sections?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  HowTo: show webpages within sections? NSIS Discussion" />
	
	<title> HowTo: show webpages within sections? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  HowTo: show webpages within sections?</div>
<hr />
<div class="pda"><a href="t-228801.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228801">HowTo: show webpages within sections?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">l_d_allan</div><div class="date">19th October 2005, 14:44</div></div><div class="posttext">I want to be able to have several sections that allow the person doing the install to optionally see web-pages. This almost works ok with ExecShell, but I don't see how to accomplish a &quot;wait&quot; ... the net result is that use of ExecShell doesn't wait between sections.<br />
<br />
I can use ExecWait, but nothing shows up. I suppose I could track down where the end-user has their web-browser installed and invoke that, but that seems flawed and I was hoping for a simpler approach.<br />
<br />
I didn't see how to do this in the documentation or examples. Did I miss something?<br />
<br />
<br />
;Name and file<br />
Name &quot;Demo of ExecShellNoWait problem&quot;<br />
OutFile &quot;ProblemSetup.exe&quot;<br />
<br />
;Default installation folder<br />
InstallDir &quot;$TEMP\Problem&quot;<br />
<br />
Page directory<br />
Page components<br />
Page instfiles<br />
;--------------------------------<br />
;Installer Sections<br />
Section &quot;Some Page With ExecWait&quot;<br />
  ExecWait &quot;http://www.yahoo.org&quot;<br />
SectionEnd<br />
<br />
Section &quot;Another Page with ExecWait&quot;<br />
  ExecWait &quot;http://www.msn.org&quot;<br />
SectionEnd<br />
<br />
Section &quot;Another Page With ExecShell&quot;<br />
  ExecShell &quot;open&quot; &quot;http://www.yahoo.com&quot;  ; works but does not wait<br />
SectionEnd<br />
<br />
Section &quot;Another Page with ExecShell&quot;<br />
  ExecShell &quot;open&quot; &quot;http://www.msn.com&quot;  ; works but does not wait<br />
SectionEnd<br />
<br />
Section /o &quot;Show Variables MB&quot;<br />
  MessageBox MB_OK &quot;SMPROGRAMS: $SMPROGRAMS  $\r$\n \<br />
                    Temp: $TEMP $\r$\n \<br />
                    StartMenu: $STARTMENU $\r$\n \<br />
                    QuickLaunch: $QUICKLAUNCH $\r$\n \<br />
                    Documents: $Documents $\r$\n \<br />
                    SmStartup: $SMSTARTUP&quot;<br />
 <br />
SectionEnd<br />
<br />
;--------------------------------<br />
;Uninstaller Section<br />
Section &quot;Uninstall&quot;<br />
  RMDir /r &quot;$INSTDIR&quot;<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">19th October 2005, 17:06</div></div><div class="posttext">I don't think you can actually directly do what you want- i.e., open a web page and wait for the user to close it before continuing. Since the browser is not a console process, I don't think that any of the NSIS exec functions can wait for it.<br />
You might want to use FindWindow to find the browser window and then sleep &amp; loop until is is closed.<br />
Or maybe create a plug-in DLL similar to InstallOptions which lets you embed the web page into the installer window?<br />
ExecWait needs you to provide an executable. Just providing the URL is not enough. And even if you provided the path to the browser exe, it probably won't work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">19th October 2005, 17:40</div></div><div class="posttext">2 other options to think about would be to simply add a MessageBox after the WebPage call, that says something like &quot;Click OK to continue the install&quot;.  Or you could check out a cool program called AutoIt (http://www.hiddensoft.com/AutoIt), which has very good wait/logic commands.  Hope this helps.<br />
<br />
Jnuw</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">19th October 2005, 17:50</div></div><div class="posttext">Originally posted by iceman_k <br />
And even if you provided the path to the browser exe, it probably won't work. <br />
Attached script works on my comp (tested with IE). Please note AutoCloseWindow true parameter.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">l_d_allan</div><div class="date">19th October 2005, 18:42</div></div><div class="posttext">&quot;Ask and ye shall receive.&quot; :D <br />
<br />
Both suggestions in the previous posts seem to work. (although I've only briefly checked the 2nd with WinXp-Sp2 ... makes me wonder about other/earlier o/s such as Win98 and with other browsers)<br />
<br />
<br />
Section &quot;Another Page with ExecShell&quot;<br />
  ExecShell &quot;open&quot; &quot;http://www.msn.com&quot;  ; works but does not wait<br />
  MessageBox MB_OK &quot;Please click on OK to continue the installation&quot;<br />
SectionEnd<br />
<br />
Section &quot;Try ShellOpenCommand&quot;<br />
   ReadRegStr $0 HKCR &quot;htmlfile\shell\open\command&quot; &quot;&quot;<br />
   ExecWait '$0 http://www.google.com'<br />
SectionEnd<br />
<br />
<br />
BTW ... Takhir ... your script has nsis.sourceforge.com</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">19th October 2005, 18:52</div></div><div class="posttext">Boy, was I wrong! :o <br />
That'll teach me to try something first before saying it can't be done. :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">l_d_allan</div><div class="date">19th October 2005, 20:11</div></div><div class="posttext">The &quot;ShellOpenCommand&quot; approach seems to work ok with Win2000 (not a surprise) and ...<br />
<br />
drum-roll please ...<br />
<br />
ok with Win98-First Edition using IE 4.72.3110 (IE which came with Win98-FE)<br />
<br />
Not bad :D<br />
<br />
Somewhere, I've got a whole &quot;suite&quot; of old NetScape browsers, and will maybe check them. But I suppose that would involve changing the default browser setting.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">20th October 2005, 06:49</div></div><div class="posttext">This even works with Win95 Gold - last version without IE. Was tested with a full set of browsers for http://www.imageplayer.net (few years ago). NS 4.7 specifics not touches this situation.<br />
Might be a bit better to check HKCR .html file type in registry first, but this is optional, because type is htmlfile :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>