<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Unable to altering a list box, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Unable to altering a list box NSIS Discussion" />
	
	<title> Unable to altering a list box [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Unable to altering a list box</div>
<hr />
<div class="pda"><a href="t-275679.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=275679">Unable to altering a list box</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">davidnewcomb</div><div class="date">10th August 2007, 14:56</div></div><div class="posttext">Try as I might I have been unable to update the contents of a list box. I have searched and searched to no avail so any help on this would be appreciated.<br />
<br />
I have a list box with some values in it.<br />
When I hit &quot;Go&quot; I want to select that entry in the list box<br />
<br />
On reading some external documentation LB_FINDSTRING returns LB_ERR which is not defined anywhere. I have added a bug on SF (1771644) which covers it, but it would be nice to know so that I can include it in my installer before your next release.<br />
<br />
Aside from the LB_ERR issue which is almost academic because no matter what I do it never works.<br />
<br />
Tried of programming by trail and error. :(<br />
Help !<br />
<br />
Cheers,<br />
David.<br />
<br />
<br />
<br />
[Settings]<br />
NumFields=3<br />
<br />
[Field 1]<br />
Type=DropList<br />
Left=30<br />
Top=26<br />
Right=-31<br />
Bottom=100<br />
Flags=Notify<br />
State=<br />
ListItems=<br />
<br />
[Field 2]<br />
Type=Text<br />
Left=30<br />
Top=94<br />
Right=119<br />
Bottom=114<br />
State=three<br />
<br />
[Field 3]<br />
Type=Button<br />
Left=156<br />
Top=89<br />
Right=-5<br />
Bottom=119<br />
Text=Go<br />
Flags=NOTIFY<br />
<br />
<br />
<br />
<br />
<br />
Name 'ListBoxExample'<br />
OutFile 'ListBoxExample.exe'<br />
<br />
!include &quot;MUI.nsh&quot;<br />
!include &quot;WinMessages.nsh&quot;<br />
;!include LogicLib.nsh<br />
<br />
!define F_SYSTEM__NEXT_ID 0<br />
!define F_LIST_ID         1<br />
!define F_LIST            &quot;Field ${F_LIST_ID}&quot;<br />
!define F_TEXT_ID         2 <br />
!define F_TEXT            &quot;Field ${F_TEXT_ID}&quot;<br />
!define F_BUTTON_GO_ID    3<br />
!define F_BUTTON_GO       &quot;Field ${F_BUTTON_GO_ID}&quot;<br />
<br />
Page Custom CustomCreate CustomLeave<br />
<br />
Var text_value<br />
Var list_hw<br />
<br />
Section empty<br />
SectionEnd<br />
<br />
Function CustomCreate<br />
<br />
   !insertmacro MUI_HEADER_TEXT &quot;ListBox Example&quot; &quot;Why won't it work?&quot;<br />
   !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ListBoxExample&quot; &quot;${F_LIST}&quot; &quot;ListItems&quot; &quot;one|two|three|four&quot;<br />
   !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ListBoxExample&quot; &quot;${F_TEXT}&quot; &quot;State&quot; &quot;three&quot;<br />
   !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;ListBoxExample&quot;<br />
<br />
FunctionEnd<br />
 <br />
Function CustomLeave<br />
<br />
   !insertmacro MUI_INSTALLOPTIONS_READ $text_value &quot;ListBoxExample&quot; &quot;${F_TEXT}&quot; &quot;State&quot;<br />
    MessageBox MB_OK &quot;text_value=$text_value|&quot;<br />
   !insertmacro MUI_INSTALLOPTIONS_READ $list_hw &quot;ListBoxExample&quot; &quot;${F_LIST}&quot; &quot;HWND&quot;<br />
    MessageBox MB_OK &quot;list_hw=$list_hw|&quot;<br />
    <br />
   !insertmacro MUI_INSTALLOPTIONS_READ $0 &quot;ListBoxExample&quot; &quot;Settings&quot; &quot;State&quot;<br />
   StrCmp $0 ${F_SYSTEM__NEXT_ID} end<br />
   StrCmp $0 ${F_BUTTON_GO_ID} go<br />
   Abort<br />
<br />
go:<br />
<br />
  # Show in List box<br />
  SendMessage $list_hw ${LB_SELECTSTRING} -1 &quot;STR:$text_value&quot; $0 /TIMEOUT=5000<br />
  <br />
end:<br />
   Abort<br />
<br />
FunctionEnd<br />
 <br />
<br />
Function .onInit<br />
         !insertmacro MUI_INSTALLOPTIONS_EXTRACT_AS &quot;ListBoxExample.ini&quot; &quot;ListBoxExample&quot;<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th August 2007, 15:02</div></div><div class="posttext">If the return value is &lt;0 then it was not successful.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">davidnewcomb</div><div class="date">10th August 2007, 15:32</div></div><div class="posttext">Thanks Stu, any idea why the code isn't working?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th August 2007, 15:40</div></div><div class="posttext">DropList is not a list box, it's a combo box control.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">davidnewcomb</div><div class="date">10th August 2007, 16:44</div></div><div class="posttext">I want to have your babies! All fixed now - thanks.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>