<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Configuring the finish page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Configuring the finish page NSIS Discussion" />
	
	<title> Configuring the finish page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Configuring the finish page</div>
<hr />
<div class="pda"><a href="t-284449.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=284449">Configuring the finish page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pgg1</div><div class="date">5th January 2008, 21:15</div></div><div class="posttext">Hi<br />
<br />
I wish to configure the finish page so it has four checkboxes.<br />
I've taken the code from the forum and docs.<br />
<br />
<br />
;NSIS Modern User Interface<br />
;Welcome/Finish Page Example Script<br />
;Written by Joost Verburg<br />
<br />
;--------------------------------<br />
;Include Modern UI<br />
<br />
!include &quot;MUI.nsh&quot;<br />
<br />
;--------------------------------<br />
;General<br />
<br />
  ;Name and file<br />
  Name &quot;Modern UI Test&quot;<br />
  OutFile &quot;WelcomeFinish.exe&quot;<br />
<br />
  ;Default installation folder<br />
  InstallDir &quot;$PROGRAMFILES\Modern UI Test&quot;<br />
<br />
  ;Get installation folder from registry if available<br />
  InstallDirRegKey HKCU &quot;Software\Modern UI Test&quot; &quot;&quot;<br />
<br />
;--------------------------------<br />
;Interface Settings<br />
;--------------------------------<br />
  !define MUI_ABORTWARNING<br />
  !define MUI_HEADERIMAGE<br />
  !define MUI_ICON                     &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-install-blue.ico&quot;<br />
  !define MUI_HEADERIMAGE_BITMAP       &quot;${NSISDIR}\Contrib\Graphics\Header\orange-nsis.bmp&quot;<br />
  !define MUI_WELCOMEFINISHPAGE_BITMAP &quot;${NSISDIR}\Contrib\Graphics\Wizard\orange-nsis.bmp&quot;<br />
<br />
;--------------------------------<br />
;Pages<br />
;--------------------------------<br />
  !insertmacro MUI_PAGE_WELCOME<br />
  !insertmacro MUI_PAGE_LICENSE &quot;${NSISDIR}\Docs\Modern UI\License.txt&quot;<br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  <br />
  ;------------------------------<br />
  ; Finish Page<br />
  ;------------------------------<br />
  <br />
  ; 2 Checkboxes for Quick launch and Desktop.<br />
  !define MUI_PAGE_CUSTOMFUNCTION_PRE CreateControls<br />
  !define MUI_PAGE_CUSTOMFUNCTION_SHOW SetControlColours<br />
  !define MUI_PAGE_CUSTOMFUNCTION_LEAVE DisplayQuickLaunchAndDesktopIcon<br />
<br />
  ; 1 Checkbox for release notes.<br />
  !define MUI_FINISHPAGE_SHOWREADME<br />
  !define MUI_FINISHPAGE_SHOWREADME_TEXT &quot;Show Release Notes&quot;<br />
  !define MUI_FINISHPAGE_SHOWREADME_FUNCTION ShowReleaseNotes<br />
<br />
  ; 1 Checkbox to launch the app.<br />
  !define MUI_FINISHPAGE_RUN<br />
  !define MUI_FINISHPAGE_RUN_TEXT &quot;Launch Application&quot;<br />
  !define MUI_FINISHPAGE_RUN_FUNCTION &quot;LaunchApp&quot;<br />
  !insertmacro MUI_PAGE_FINISH<br />
  <br />
  !insertmacro MUI_UNPAGE_WELCOME<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_UNPAGE_INSTFILES<br />
  !insertmacro MUI_UNPAGE_FINISH<br />
<br />
;--------------------------------<br />
;Languages<br />
<br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
;--------------------------------<br />
;Installer Sections<br />
<br />
Section &quot;Dummy Section&quot; SecDummy<br />
<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
<br />
  ;ADD YOUR OWN FILES HERE...<br />
<br />
  ;Store installation folder<br />
  WriteRegStr HKCU &quot;Software\Modern UI Test&quot; &quot;&quot; $INSTDIR<br />
<br />
  ;Create uninstaller<br />
  WriteUninstaller &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
SectionEnd<br />
<br />
;--------------------------------<br />
;Uninstaller Section<br />
<br />
Section &quot;Uninstall&quot;<br />
<br />
  ;ADD YOUR OWN FILES HERE...<br />
<br />
  Delete &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
  RMDir &quot;$INSTDIR&quot;<br />
<br />
  DeleteRegKey /ifempty HKCU &quot;Software\Modern UI Test&quot;<br />
<br />
SectionEnd<br />
<br />
;-----------------------------------------------------------------<br />
;  The following two functions CreateControls &amp; SetControlColours<br />
;  are editing the ini file at runtime so we can add the two<br />
;  additional check boxes.<br />
;-----------------------------------------------------------------<br />
<br />
Function CreateControls<br />
<br />
  ; Quicklaunch short cut.<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Settings&quot; &quot;NumFields&quot; &quot;6&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Type&quot; &quot;CheckBox&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Text&quot; &quot;&amp;Create Quick Launch Shortcut&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Left&quot; &quot;120&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Right&quot; &quot;315&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Top&quot; &quot;130&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Bottom&quot; &quot;140&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;State&quot; &quot;1&quot;<br />
<br />
  ; Desktop short cut.<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Settings&quot; &quot;NumFields&quot; &quot;7&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Type&quot; &quot;CheckBox&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Text&quot; &quot;&amp;Create Desktop Shortcut&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Left&quot; &quot;120&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Right&quot; &quot;315&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Top&quot; &quot;130&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Bottom&quot; &quot;180&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;State&quot; &quot;1&quot;<br />
  <br />
FunctionEnd<br />
<br />
Function SetControlColours<br />
  ReadINIStr $0 &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;HWND&quot;<br />
  SetCtlColors $0 0x000000 0xFFFFFF<br />
  ReadINIStr $0 &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;HWND&quot;<br />
  SetCtlColors $0 0x000000 0xFFFFFF<br />
FunctionEnd<br />
<br />
Function LaunchApp<br />
  ;MessageBox MB_OK &quot;Deal with launching application&quot;<br />
FunctionEnd<br />
<br />
Function ShowReleaseNotes<br />
  ;MessageBox MB_OK &quot;Deal with release notes&quot;<br />
FunctionEnd<br />
<br />
Function DisplayQuickLaunchAndDesktopIcon<br />
  ;ReadINIStr $0 &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;State&quot;<br />
  ;StrCmp $0 &quot;0&quot; end<br />
  ;  CreateShortCut ...<br />
  ;end:<br />
  ;ReadINIStr $0 &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;State&quot;<br />
  ;StrCmp $0 &quot;0&quot; finish<br />
  ;  CreateShortCut ...<br />
  ;finish:<br />
FunctionEnd<br />
<br />
<br />
The layout is fine and it all looks great. <br />
<br />
The problem is should I need to remove one of the check boxes (e.g. Launch Application) Then I can't seem to position the remaining check boxes neatly despite trying all sorts of positioning permutations.<br />
<br />
Is this the correct way to go? Is there an easier way to do things?<br />
<br />
Regards<br />
<br />
Paul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th January 2008, 21:31</div></div><div class="posttext">WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Left&quot; &quot;120&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Right&quot; &quot;-10&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Top&quot; &quot;130&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Bottom&quot; &quot;142&quot;<br />
<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Left&quot; &quot;120&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Right&quot; &quot;-10&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Top&quot; &quot;144&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Bottom&quot; &quot;156&quot;<br />
<br />
Your top values were the same so one would surely have been under another!<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pgg1</div><div class="date">6th January 2008, 00:57</div></div><div class="posttext">Weird, it still displayed everything perfectly though. I've used your code instead. However, if you comment out the following three lines of code along with the function call we lose the &quot;Launch Application&quot; checkbox (which i need to do sometimes). Therefore you get the 3 checkboxes but not underneath each other.<br />
<br />
<br />
!define MUI_FINISHPAGE_RUN<br />
!define MUI_FINISHPAGE_RUN_TEXT &quot;Launch Application&quot;<br />
!define MUI_FINISHPAGE_RUN_FUNCTION &quot;LaunchApp&quot;<br />
<br />
<br />
This is what I do not understand:<br />
<br />
I don't know for sure what the left, right, top and bottom values stand for. For example if we have the values 120,-10,130,142 respectively at a guess a checkbox is 120 in from the left of the frame but what does the -10 stand for? Similarly 130 down from the top but does the 156 stand for?<br />
<br />
It doesn't make sense to have 4 values because all you need to position anything is x and y.<br />
<br />
How do I change the values of the bottom 2 checkboxes to get the three of them underneath each other with equal spacing?<br />
<br />
I've been playing around with it and it doesn't make any sense.<br />
<br />
Regards<br />
<br />
Paul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pgg1</div><div class="date">6th January 2008, 00:59</div></div><div class="posttext">Typo:<br />
<br />
This &quot;but does the 156 stand for?&quot; should be this &quot;but does the 142 stand for?&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th January 2008, 12:22</div></div><div class="posttext">Think of the figures as dialog units. Positive is from the top or left and negative is from the bottom or right.<br />
<br />
It's confusing at first but right=-10 sets the right position of a control/field to -10 units from the right hand side of the dialog. right=50 would put the right hand side to be 50 units from the left of the dialog.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>