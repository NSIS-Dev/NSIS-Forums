<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Compiling Win64 installer on 32bit system, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Compiling Win64 installer on 32bit system NSIS Discussion" />
	
	<title> Compiling Win64 installer on 32bit system [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Compiling Win64 installer on 32bit system</div>
<hr />
<div class="pda"><a href="t-241507.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=241507">Compiling Win64 installer on 32bit system</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ncsengodi</div><div class="date">22nd March 2006, 10:39</div></div><div class="posttext">I tried compile 64bit installer on a 32bit system in this way:<br />
1. Compiling Exehead's and ui's for AMD64<br />
2. Replacing the binaries in the NSIS directory strcuture with the 64bit version<br />
3. Compiling the script with the 32bit version of makensis<br />
<br />
The compilation process was broken at the ChangeUI command.<br />
( I use ModernUI )<br />
<br />
Is there any solution for my problem?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd March 2006, 18:13</div></div><div class="posttext">Not yet. The resource editor can't edit 64-bit resources. You can try simply replacing the the structure definitions with the 64-bit version. It might work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ncsengodi</div><div class="date">24th March 2006, 15:10</div></div><div class="posttext">I changed the _IMAGE_NT_HEADERS struct to _IMAGE_NT_HEADERS64, but in _IMAGE_NT_HEADERS64 struct's sub element IMAGE_OPTIONAL_HEADER64  no more BaseOfData member.<br />
<br />
After commenting out two lines in ResourceEditor.cpp (318 and 319) the compilation finished, but the makensis.exe tried to read the stub from it's own file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th March 2006, 15:57</div></div><div class="posttext">What do you mean by saying makensis.exe is trying to read the stub from its own file? The stub file should have no affect here. It's read into memory before the resource editor gets into action. Or are you no longer talking about the resource editor? What error message does it show?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ncsengodi</div><div class="date">29th March 2006, 16:58</div></div><div class="posttext">I don't remember the real message.<br />
The makensis.exe tried to read the &quot;...makensis.exe/zlib&quot; stub.<br />
<br />
I tried again the modification with the original source code of 2.15 and I made it. :D<br />
<br />
I modified the ResourceEditor.h/.c and the plugin.c.<br />
Both were IMAGE_NT_HEADERS64 dependent.<br />
<br />
Compiling the stub-s to amd64 is strange because memset amd memcpy functions are needed. :weird:<br />
Appending memset.c and memcpy.c from the source package to the files list in Sconscript file wasn't a good way for me. I added the libc.lib to the libs.<br />
<br />
I cannot compile the system plugin.<br />
There are three naked functions and the compilert don't support inline assembly.<br />
<br />
----------------------------------------------<br />
I have the worst english knowledge. Sorry. :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ncsengodi</div><div class="date">29th March 2006, 17:09</div></div><div class="posttext">One more thing:<br />
<br />
In the szXPManifest XML string the processorArchitecture property must be Amd64 or Ia64.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st March 2006, 13:44</div></div><div class="posttext">Do the generated installers actually work? There are some &quot;unsafe&quot; casts in the code which are a bit too much over to the unsafe side. For example, the blocks loading loop in loadHeaders forces a 64-bit pointer to a 32-bit integer. Those block pointers are then used everywhere in the code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ncsengodi</div><div class="date">31st March 2006, 14:48</div></div><div class="posttext">I haven't solved any cast warning in the code.<br />
It works without any problem at this moment.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>