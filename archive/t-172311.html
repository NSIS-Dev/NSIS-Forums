<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" 2 questions : first on nsExec with Xcopy, second on directory of the exe, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  2 questions : first on nsExec with Xcopy, second on directory of the exe NSIS Discussion" />
	
	<title> 2 questions : first on nsExec with Xcopy, second on directory of the exe [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  2 questions : first on nsExec with Xcopy, second on directory of the exe</div>
<hr />
<div class="pda"><a href="t-172311.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=172311">2 questions : first on nsExec with Xcopy, second on directory of the exe</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">benchetrit</div><div class="date">6th March 2004, 17:36</div></div><div class="posttext">First question :<br />
I have try to use the nsExec dll like below with an xcopy action, but no copy is made.<br />
<br />
nsExec:Exec '&quot;xcopy&quot; c:\from\*.* c:\to\*.*'<br />
<br />
So unfortunately, I was obliged to use ExecWait.<br />
<br />
Second question :<br />
I explain. The user have copied the install.exe somewhere. Then he start it. I would like to know where is this exe, because I need to use it at the next logon of the user. Is it possible to know from which directory the intall.exe was started.<br />
<br />
Many thanks to all of us and specially for people who have developped NSIS and let it free to use. A great product. I will have more questions, but answers to these first ones will help me to finish a first version of my product.<br />
<br />
Regards<br />
<br />
Thierry</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th March 2004, 18:53</div></div><div class="posttext">1) Dave, got time to look at this?<br />
<br />
2) $EXEDIR.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">6th March 2004, 21:37</div></div><div class="posttext">Using an external application like xcopy is not such a good idea anyway. Why not use CopyFiles?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">benchetrit</div><div class="date">7th March 2004, 07:09</div></div><div class="posttext">I use CopyFiles elsewhere. But Xcopy offer more parameters like /exclude:filetoexclude.lst or other switch. So Dave, if you have a solution do not hesitate to post it.<br />
<br />
Many thanks for your answers.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eccles</div><div class="date">7th March 2004, 10:23</div></div><div class="posttext">Did you give the full path to xcopy? (I.e. &quot;$SYSDIR\xcopy.exe&quot;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">benchetrit</div><div class="date">7th March 2004, 14:35</div></div><div class="posttext">I did not give the full path.<br />
...<br />
But now, I have done. And it does not solve the issue. No copy is made. If I execute the same command in a dos window or by ExecWait it works.<br />
<br />
Any more ideas ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th March 2004, 19:01</div></div><div class="posttext">Please attach a little example to demonstrate the problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">benchetrit</div><div class="date">12th March 2004, 08:47</div></div><div class="posttext">An example.<br />
<br />
; nsixcopy.nsi<br />
<br />
; The name of the installer<br />
Name &quot;nsixcopy&quot;<br />
<br />
; The file to write<br />
OutFile &quot;nsixcopy.exe&quot;<br />
<br />
Section &quot;&quot; ;No components page, name is not important<br />
<br />
;Just initiate the example<br />
CreateDirectory &quot;c:\from&quot;<br />
CopyFiles &quot;$EXEDIR\nsixcopy.exe&quot; &quot;c:\from&quot;<br />
<br />
  nsExec::ExecToStack 'cmd /c dir c:\from'<br />
  Pop $0 <br />
  Pop $1 <br />
  MessageBox MB_OK|MB_ICONINFORMATION &quot;Dir c:\from $\nCode : $0$\nResult :$\n$1&quot;<br />
  <br />
  nsExec::ExecToStack '&quot;$SYSDIR\xcopy.exe&quot; &quot;c:\from\*.*&quot; &quot;c:\to\*.*&quot;'<br />
  Pop $0 <br />
  Pop $1 <br />
  MessageBox MB_OK|MB_ICONINFORMATION &quot;$SYSDIR\xcopy.exe c:\from\*.* c:\to\*.*$\nCode : $0$\nResult :$\n$1&quot;<br />
<br />
  nsExec::ExecToStack 'cmd /c dir c:\to'<br />
  Pop $0 <br />
  Pop $1 <br />
  MessageBox MB_OK|MB_ICONINFORMATION &quot;Dir c:\to $\nCode : $0$\nResult :$\n$1&quot;<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th March 2004, 10:36</div></div><div class="posttext">Fixed in latest CVS version. nsExec didn't create a valid input handle which apparently bothered xcopy.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">benchetrit</div><div class="date">12th March 2004, 11:50</div></div><div class="posttext">Thanks. Could you tell me when the release will be available ?<br />
<br />
Moreover, I have other questions concerning nsExec. It seems that if does not accept pipe or redirection of the output like :<br />
<br />
nsExec::Exec 'echo toto &gt; toto.txt'<br />
<br />
or <br />
<br />
nsExec::Exec 'echo toto | sed s/o/a/'<br />
<br />
Is it normal ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th March 2004, 11:53</div></div><div class="posttext">To get it:<br />
<br />
http://nsis.sourceforge.net/development<br />
<br />
As for redirection, you need to use cmd or command. You can get the path reading CMDSPEC. Search the forum, there are some threads about this topic. Search for `mysql'.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">benchetrit</div><div class="date">12th March 2004, 13:18</div></div><div class="posttext">It seems that the .dll is older <br />
(Sat Jan 31 19:54:45 2004 UTC (5 weeks, 5 days ago) by kichik) than your resolution at :<br />
http://cvs.sourceforge.net/viewcvs.py/nsis/NSIS/Plugins/nsExec.dll<br />
<br />
Perhaps I search in the wrong place :-(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th March 2004, 13:26</div></div><div class="posttext">Well, I guess SourceForge's annoymous CVS service is still lagging 5 hours behind, sometimes even longer. Use the snapshot, it's updated a couple of times a day.<br />
<br />
For now use the attachment.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">benchetrit</div><div class="date">12th March 2004, 13:39</div></div><div class="posttext">Obviously it works. Great !!! Thank you !</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>