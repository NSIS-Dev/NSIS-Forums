<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to attach data to window handle, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to attach data to window handle NSIS Discussion" />
	
	<title> How to attach data to window handle [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to attach data to window handle</div>
<hr />
<div class="pda"><a href="t-351787.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=351787">How to attach data to window handle</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">sss123next</div><div class="date">10th November 2012, 17:44</div></div><div class="posttext">Hi all, i need to attach some data to windows handle for later use, i trying to use {Get/Set}WindowLong, but with no success, i trying following<br />
<br />
<br />
!define GWL_USERDATA -21<br />
System::Call 'user32::SetWindowLong(i $hwnd, i ${GWL_USERDATA}, tr3)'<br />
System::Call 'user32::GetWindowLong(i $hwnd, i ${GWL_USERDATA}) i.r4'<br />
MessageBox MB_OK &quot;USERDATA $4&quot;<br />
<br />
i storing in $3 some text data, which i need to check later, but in $4 i have pointer address, how i can dereference it ?, and another problem, looks like windows loosing it's style's after this calls, is here another right way to do what i need ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">10th November 2012, 22:21</div></div><div class="posttext">Don't use GWL_USERDATA, NSIS already uses it.<br />
<br />
If you want to store data &quot;on&quot; a hwnd, use user32::SetProp. If the control is on a nsDialogs page, use nsDialogs::SetUserData.<br />
<br />
If you want to store a string you cannot use the trX syntax, you need to allocate real memory with the system plugin and then use the struct syntax to copy strings in and out...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sss123next</div><div class="date">10th November 2012, 22:30</div></div><div class="posttext">thx for info.<br />
do i need to call free after  nsDialogs::SetUserData call ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th November 2012, 02:23</div></div><div class="posttext">You only need to allocate memory if you call user32::SetProp or user::SetWindowLong directly. nsDialogs::SetUserData takes care of memory allocation for you. Every control you create has memory set aside for user data. nsDialogs frees this memory when the control is destroyed along with the dialog.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sss123next</div><div class="date">11th November 2012, 08:10</div></div><div class="posttext">good, thx.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>