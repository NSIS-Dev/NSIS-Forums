<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to pull all lines of a text file into a drop down, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to pull all lines of a text file into a drop down NSIS Discussion" />
	
	<title> How to pull all lines of a text file into a drop down [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to pull all lines of a text file into a drop down</div>
<hr />
<div class="pda"><a href="t-255856.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=255856">How to pull all lines of a text file into a drop down</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">GarBear</div><div class="date">20th September 2006, 16:32</div></div><div class="posttext">How to pull lines of text into a dropdown and select that in an NSIS install? <br />
<br />
I am building an application installation that needs to pull a list of SQL Servers from the network.  I have figured out how to do it with a vb script but I am now looking for a way to take the text file created by my VB script that lists the servers on their network.<br />
<br />
What I have done so far...<br />
<br />
<br />
<br />
 Created a INI script file called DBConnection.ini<br />
 Created a text file using my VBS(WSH Visual Basic script)<br />
 Created a demo install that pulls in only one database<br />
 <br />
<br />
// START DBConnection_Script.nsi<br />
<br />
!define VERSIONNUMBER &quot;version1.0.0.0&quot;<br />
!define APPNAME &quot;Choose Database&quot;<br />
!define APPNAMEANDVERSION &quot;Database Connection&quot;<br />
Name &quot;DB Config Test&quot;<br />
OutFile &quot;Database_Setup.exe&quot;<br />
InstallDir &quot;$TEMP\BLAH&quot;<br />
ShowInstDetails show<br />
Var List<br />
<br />
!include &quot;XPUI.nsh&quot; <br />
<br />
Function .oninit<br />
	!insertmacro XPUI_INSTALLOPTIONS_EXTRACT_AS &quot;DBConnection.ini&quot; &quot;DBConnection.ini&quot;<br />
	FileOpen $4 &quot;SVRList.txt&quot; r<br />
	FileSeek $4 0 ; we want to start reading at the 1000th byte<br />
	FileRead $4 $1 ; we read until the end of line (including carriage return and new line) and save it to $1<br />
	FileRead $4 $2 30 ; read 30 characters from the next line<br />
	StrCpy $List $2 ; add line two to the list variable<br />
	FileClose $4 ; and close the file 	<br />
FunctionEnd<br />
<br />
; XPUI Settings<br />
!define XPUI_ABORTWARNING<br />
<br />
; Pages<br />
!insertmacro XPUI_PAGE_WELCOME<br />
Page custom &quot;DB_Connection&quot; &quot;WriteDBReg&quot;<br />
;!insertmacro XPUI_PAGE_INSTFILES<br />
;!insertmacro XPUI_PAGE_FINISH<br />
!insertmacro XPUI_LANGUAGE &quot;English&quot;<br />
<br />
Section &quot;DatabaseUpdate&quot; SEC01<br />
SectionEnd<br />
<br />
<br />
Function DB_Connection<br />
<br />
	!insertmacro XPUI_INSTALLOPTIONS_EXTRACT &quot;DBConnection.ini&quot;<br />
	!insertmacro XPUI_INSTALLOPTIONS_WRITE &quot;DBConnection.ini&quot; &quot;Field 6&quot; &quot;ListItems&quot; &quot;$List&quot;<br />
	!insertmacro XPUI_INSTALLOPTIONS_DISPLAY &quot;DBConnection.ini&quot;<br />
<br />
FunctionEnd<br />
<br />
Function WriteDBReg<br />
	!insertmacro XPUI_INSTALLOPTIONS_READ $0 &quot;DBConnection.ini&quot; &quot;Field 6&quot; &quot;ListItems&quot;<br />
		StrCpy $List &quot;$0&quot;<br />
		WriteRegStr HKEY_LOCAL_MACHINE &quot;Software\Application\General&quot; &quot;ServerList&quot; &quot;$List&quot;<br />
FunctionEnd<br />
<br />
Section -Post<br />
SectionEnd<br />
// END DBConnection_Script.nsi<br />
<br />
// START DBConnection.ini script<br />
[Settings]<br />
NumFields=10<br />
<br />
[Field 1]<br />
Type=Label<br />
Text=Database Connection:<br />
Left=5<br />
Right=193<br />
Top=3<br />
Bottom=11<br />
<br />
[Field 2]<br />
Type=Label<br />
Text=Please enter the server name where you have installed Microsoft SQL Server 2005.<br />
Left=9<br />
Right=248<br />
Top=22<br />
Bottom=41<br />
<br />
[Field 3]<br />
Type=Groupbox<br />
Text=SQL 2005 Connection Information<br />
Left=2<br />
Right=250<br />
Top=41<br />
Bottom=160<br />
<br />
[Field 4]<br />
Type=Checkbox<br />
Text= Use Microsoft Windows Domain/Active Directory authentication.<br />
Left=21<br />
Right=239<br />
Top=60<br />
Bottom=70<br />
<br />
[Field 5]<br />
Type=Label<br />
Text=Server(\\Instance):<br />
Left=10<br />
Right=69<br />
Top=78<br />
Bottom=86<br />
<br />
[Field 6]<br />
Type=Combobox<br />
Text=Combobox<br />
ListItems=<br />
Left=73<br />
Right=240<br />
Top=76<br />
Bottom=89<br />
<br />
[Field 7]<br />
Type=Label<br />
Text=Password:<br />
Left=33<br />
Right=66<br />
Top=99<br />
Bottom=107<br />
<br />
[Field 8]<br />
Type=Password<br />
Left=73<br />
Right=240<br />
Top=97<br />
Bottom=110<br />
<br />
[Field 9]<br />
Type=Label<br />
Text=Database Name:<br />
Left=12<br />
Right=66<br />
Top=121<br />
Bottom=129<br />
<br />
[Field 10]<br />
Type=Droplist<br />
Text=Droplist<br />
ListItems=<br />
Left=73<br />
Right=240<br />
Top=118<br />
Bottom=155<br />
<br />
// END DBConnection.ini script<br />
<br />
// START SVRList.txt<br />
(Local)<br />
ServerName1<br />
ServerName2<br />
ServerName3<br />
ServerName4<br />
// END SVRList.txt</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th September 2006, 17:24</div></div><div class="posttext">Do you want to read the selected list box item?<br />
It's stored in the State field attribute.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GarBear</div><div class="date">20th September 2006, 17:49</div></div><div class="posttext">Thanks for taking the time to respond.  The code above opens the sqllist.txt file(which normally would have been created by the vb script) and then looks at line two, sets the list var to what was on line two and inserts the field into the dropdown - which works;however, what I am hoping to glean from the group is how to concatinate all the lines into the dropdown and allow the user to select only one, then run a check to connect and populate another list file of all the databases on that server. <br />
<br />
Also: I'll provide all my vb scripts later in a zip file for everyone when I get everything working. For now I am just trying to keep things as simple as possible.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th September 2006, 17:56</div></div><div class="posttext">Loop through the lines in the file, trimming each line and concatenate each line with StrCpy...<br />
<br />
StrCpy $List $List|$R0<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>