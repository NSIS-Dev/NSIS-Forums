<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Looking for a Font installation example, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Looking for a Font installation example NSIS Discussion" />
	
	<title> Looking for a Font installation example [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Looking for a Font installation example</div>
<hr />
<div class="pda"><a href="t-172162.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=172162">Looking for a Font installation example</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Cecilio</div><div class="date">5th March 2004, 16:58</div></div><div class="posttext">Could any one give me an example of installing a font using the Vytautas scripts FontName.nsh &amp; FontReg.nsh ?<br />
<br />
I'm trying this code:<br />
<br />
<br />
InstalarFont:<br />
     ClearErrors<br />
     StrCpy $FONT_DIR $FONTS<br />
     !insertmacro InstallTTFFont '..\Fonts\LeMusNot.ttf'<br />
     SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0 /TIMEOUT=5000<br />
     IfErrors +1 FinInstalarFont<br />
       MessageBox MB_RETRYCANCEL|MB_ICONEXCLAMATION $(ERROR_InstalarFont) IDRETRY InstalarFont<br />
       MessageBox MB_YESNO|MB_ICONQUESTION $(MSG_CONTINUE) IDYES +2<br />
	      Abort &quot;$(MSG_ABORT)&quot;<br />
     FinInstalarFont:<br />
<br />
<br />
But I'm getting errors in compilation. Any suggestion?<br />
<br />
Thank you very much</div></div><hr />


<div class="post"><div class="posttop"><div class="username">apollo51</div><div class="date">5th March 2004, 20:27</div></div><div class="posttext">Did you check these already?<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=392<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=400</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cecilio</div><div class="date">6th March 2004, 16:31</div></div><div class="posttext">Yes, thank you. I did checked both pages. In fact I took the macros from there. But I am having problems using them and I do not know how to continue.<br />
<br />
My problem is that in compilation, I get the following messages:<br />
<br />
<br />
!insertmacro: InstallTTFFont<br />
Push: $R0<br />
Push: $R1<br />
Push: $R2<br />
!define: &quot;Index&quot;=&quot;Line215.5&quot;<br />
SetOutPath: &quot;$FONT_DIR&quot;<br />
IfFileExists: &quot;$FONT_DIR\..\Fonts\LeMusNot.ttf&quot; ? Line215.5 : <br />
File: &quot;LeMusNot.ttf&quot; 17192 bytes<br />
ReadRegStr $R0 HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\CurrentVersion<br />
IfErrors ?Line215.5-9x:Line215.5-NT<br />
StrCpy $R1 &quot;Software\Microsoft\Windows NT\CurrentVersion\Fonts&quot; () ()<br />
Goto: Line215.5-GO<br />
StrCpy $R1 &quot;Software\Microsoft\Windows\CurrentVersion\Fonts&quot; () ()<br />
Goto: Line215.5-GO<br />
ClearErrors<br />
!insertmacro: FontName<br />
Push: $FONT_DIR\..\Fonts\LeMusNot.ttf<br />
Call &quot;TranslateFontName&quot;<br />
Invalid command: FontName::Name<br />
Error in macro FontName on macroline 3<br />
Error in macro InstallTTFFont on macroline 25<br />
Error in script &quot;C:\LenMus\LenMus\Instalacion\Instalar.nsi&quot; on line 215 -- aborting creation process<br />
<br />
And I don't know how to debug this. Line 3 of macro FontName is this:<br />
Fontname::Name<br />
<br />
I supose it is a call to the Name function in FontName.dll plugin but I do not know either how to continue nor what to do. Thas's why I was trying to find a full example, to try to find differences from my code.<br />
<br />
Thank you anyway.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th March 2004, 18:51</div></div><div class="posttext">Put the FontName plug-in in the Plugins directory.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cecilio</div><div class="date">6th March 2004, 20:45</div></div><div class="posttext">Thank you very much. But I already did put the file FontName.dll in the plugins directory. Should I put any thing else there or do something to register this dll?<br />
<br />
Also there are two includes in my source file:<br />
  !include &quot;FontReg.nsh&quot;<br />
  !include &quot;FontName.nsh&quot;<br />
Both files are in the NSIS\include directory<br />
<br />
Thank you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">6th March 2004, 21:51</div></div><div class="posttext">You can also use the code in this topic (standard System plug-in):<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=137726&amp;highlight=register+font</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th March 2004, 22:04</div></div><div class="posttext">If &quot;FontName::Name&quot; is an invalid command you've put it in the wrong place or put the wrong file. Put FontName.dll in the Plugins directory where NSISdl.dll, System.dll and BgImage.dll are. Make sure it is named FontName.dll.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cecilio</div><div class="date">7th March 2004, 12:18</div></div><div class="posttext">Thank you very much for your answers.<br />
<br />
To Joost Verburg: I tested the code taken from an example found in the forum. The example was named &quot;main menu.nsi&quot; (Sorry, I can't find the page from where I downloaded it). It works OK.<br />
But I was looking for a more modular and robust solution that could be maintained in the future as part of the NSIS core. That's why I was trying to use the Vytautas macros.<br />
Thank you anyway for your suggestion. And thank you very much for MUI and all your good work.<br />
<br />
To kichik: The dll is in the right place. I will download a new version of the dll and re-check everything. I will tell you later. Thank you very much for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cecilio</div><div class="date">7th March 2004, 12:42</div></div><div class="posttext">I downloaded again the FontName plugin (version 0.6) and re-checked. The same problem. By the way, I sent to Vitautas the spanish translation to be incorporated to the macro. Here it is just in case any one needs it:<br />
<br />
  StrCmp $LANGUAGE 1034 0 End-1034 ; Spanish (traditional) <br />
    Push &quot;Versión del font incorrecta&quot;<br />
    Push &quot;Error de dirección de archivo mapeado: %u&quot;<br />
    Push &quot;Error de archivo mapeado: %u&quot;<br />
    Push &quot;Tamaño de archivo erroneo: %u&quot;<br />
    Push &quot;Manipulador de archivo erroneo: %u&quot;<br />
    Push &quot;Plugin de NSIS para FontName %s &quot;<br />
    goto ${Index}<br />
  End-1034:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">7th March 2004, 12:44</div></div><div class="posttext">Is the FontName plug-in listed in the compiler output (at the beginning)?<br />
<br />
You can also put the other code that uses the System plug-in in a macro.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cecilio</div><div class="date">7th March 2004, 13:58</div></div><div class="posttext">Yes, but they appears as follows:<br />
<br />
      ...<br />
 - Dialer::AutodialUnattended<br />
 - Dialer::GetConnectedState<br />
 - VPatch::vpatchfile<br />
 - FontName.DLL::name<br />
 - FontName.DLL::version<br />
<br />
<br />
umh! is it right to be &quot;FontNAme.DLL::name&quot; instead of &quot;FontName::Name?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cecilio</div><div class="date">7th March 2004, 14:42</div></div><div class="posttext">The cause of the problem is found. The FonName-0.6.exe installer installs the &quot;FontName.dll&quot; as &quot;FontName.DLL&quot; (upper case extention). Somehow the extention &quot;.DLL&quot; is not interpreted correctly and it is assumed the name &quot;FontName.DLL.dll&quot;. Changing the extention to lower case &quot;.dll&quot; fixes &quot;my&quot; problem (not the deeper problem).<br />
<br />
Thank you very very much for all your help. I appreciate it very much. <br />
<br />
I will send a message to Vytatutas to keep him informed about all this.<br />
<br />
Thank you everybody again. Kind regards.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">8th March 2004, 03:13</div></div><div class="posttext">Thanks cecilio for spotting that error.  I will upload the fix installer later today, don't have the files on this PC. :) Also I will include the Spanish tyranslation you provided in the PM.<br />
<br />
Although I think it would be a good idea to fix this plugin detection error in NSIS code as well. ;) <br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th March 2004, 19:33</div></div><div class="posttext">Fixed in latest CVS version.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>