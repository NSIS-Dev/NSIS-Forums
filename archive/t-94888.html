<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Either launch install or launch app?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Either launch install or launch app? NSIS Discussion" />
	
	<title> Either launch install or launch app? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Either launch install or launch app?</div>
<hr />
<div class="pda"><a href="t-94888.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=94888">Either launch install or launch app?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Obra</div><div class="date">17th July 2002, 21:57</div></div><div class="posttext">I'd love to have my CDROM autoplay and then check the registry to see if my app is already installed.<br />
It should then run the installer if not installed, or run the app if already installed.<br />
<br />
Is this possible with NSIS?  I've searched around but I'm starting to think this is not possible.<br />
<br />
Any suggestions on how to accomplish this much appreciated!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DuaneJeffers</div><div class="date">18th July 2002, 08:45</div></div><div class="posttext">Yes, this is very possible.<br />
<br />
First, you should know how to autorun the app. If you don't, then I can tell you later.<br />
<br />
Second, In the .nsi script type the following example, but replacing it with your appropriate coding:<br />
<br />
InstallDirRegKey HKCU MyApp &quot;&quot;<br />
InstallDir &quot;$PROGRAMFILES\MyAPP\&quot;<br />
<br />
<br />
The Reg key will replace the InstallDir with what the user has placed instead.<br />
<br />
Hope this helps<br />
-Duane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Obra</div><div class="date">18th July 2002, 15:59</div></div><div class="posttext">Thanks Duane.  It's the &quot;now that I know the app is installed, dont run the NSIS installer, but run the app instead&quot; part that I can't seem to get to work.  I do have the app launching after the install is complete just fine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">18th July 2002, 21:10</div></div><div class="posttext">Do something like this:InstallDir $PROGRAMFILES\MyApp<br />
<br />
function .onInit<br />
ReadRegStr $0 HKLM &quot;Software\MyApp&quot; &quot;InstallPath&quot;<br />
StrCmp $0 &quot;&quot; Done<br />
Exec &quot;$0\MyApp.exe&quot; it is installed! so run the program!<br />
Quit<br />
Done: ; So not installed? continue install then!<br />
functionend<br />
<br />
section<br />
; some install stuff<br />
sectionend<br />
<br />
section ; do not forget to write the regkey<br />
; to know next time that it is installed<br />
WriteRegStr HKLM &quot;Software\MyApp&quot; &quot;InstallPath&quot; &quot;$INSTDIR&quot;<br />
sectionend<br />
To autorun, create a file &quot;autorun.inf&quot; containing this:[autorun]<br />
open=&quot;path to app&quot; ; replace!<br />
icon=&quot;icon file&quot;   ; replace!<br />
<br />
Good luck,<br />
-Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Obra</div><div class="date">18th July 2002, 21:52</div></div><div class="posttext">Thanks!  Not having the code in an .onInit function is where I was messed up!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">19th July 2002, 03:41</div></div><div class="posttext">I would prefer checking the if the file exist (fileexist) instead of the registry.  If the user has deleted the file, then that method would fail to exec it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">19th July 2002, 08:12</div></div><div class="posttext">Yes, you need to perform a FileCheck before execution. But running from CD, we cannot do without the registry since we don't know where the app has been installed.<br />
<br />
-Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mlbl</div><div class="date">19th July 2002, 12:58</div></div><div class="posttext">Just wondering, can't you just check the registry key to see if it exists? If it doesn't, then the app wouldn't have been installed</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">19th July 2002, 13:11</div></div><div class="posttext">Originally posted by rainwater <br />
If the user has deleted the file, then that method would fail to exec it.Mlbl, that's the reason for the FileCheck!<br />
<br />
-Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">19th July 2002, 15:13</div></div><div class="posttext">Originally posted by Smile2Me <br />
Mlbl, that's the reason for the FileCheck!<br />
<br />
-Hendri. <br />
<br />
I don't see a filecheck in that function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">19th July 2002, 15:31</div></div><div class="posttext">Originally posted by Smile2Me <br />
Yes, you need to perform a FileCheck before execution. But running from CD, we cannot do without the registry since we don't know where the app has been installed.<br />
<br />
-Hendri.  It needed to be added indeed, I just quoted you to show that the code needed some work, so:InstallDir $PROGRAMFILES\MyApp<br />
<br />
function .onInit<br />
ReadRegStr $0 HKLM &quot;Software\MyApp&quot; &quot;InstallPath&quot;<br />
StrCmp $0 &quot;&quot; Done<br />
IfFileExists &quot;$0\myapp.exe&quot; 0 errorquit<br />
Exec &quot;$0\MyApp.exe&quot; ; it is installed! so run the program!<br />
Quit<br />
ErrorQuit:<br />
MessageBox MB_OK &quot;You stupid man! You deleted the program! ERROR!&quot;<br />
Quit<br />
Done: ; So not installed? continue install then!<br />
functionend<br />
<br />
section<br />
; some install stuff<br />
sectionend<br />
<br />
section ; do not forget to write the regkey<br />
; to know next time that it is installed<br />
WriteRegStr HKLM &quot;Software\MyApp&quot; &quot;InstallPath&quot; &quot;$INSTDIR&quot;<br />
sectionend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">19th July 2002, 15:43</div></div><div class="posttext">Wouldn't this be better:<br />
<br />
<br />
InstallDir $PROGRAMFILES\MyApp<br />
<br />
function .onInit<br />
ReadRegStr $0 HKLM &quot;Software\MyApp&quot; &quot;InstallPath&quot;<br />
StrCmp $0 &quot;&quot; Done<br />
IfFileExists &quot;$0\myapp.exe&quot; 0 Done<br />
Exec &quot;$0\MyApp.exe&quot; ; it is installed! so run the program!<br />
Quit<br />
Done: ; So not installed? continue install then!<br />
functionend<br />
<br />
section<br />
; some install stuff<br />
sectionend<br />
<br />
section ; do not forget to write the regkey<br />
; to know next time that it is installed<br />
WriteRegStr HKLM &quot;Software\MyApp&quot; &quot;InstallPath&quot; &quot;$INSTDIR&quot;<br />
sectionend<br />
<br />
<br />
<br />
I would think you would want the installer to run if the file is not there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">19th July 2002, 17:33</div></div><div class="posttext">My solution is intended to run the program on harddisk if installed. Otherwise the installation will continue. So no aditional installation needed that should be run. My solution prouces a small exe can be put on CD, autorun and work as installer or as program starter.<br />
<br />
-Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">19th July 2002, 18:19</div></div><div class="posttext">Originally posted by Smile2Me <br />
My solution is intended to run the program on harddisk if installed. Otherwise the installation will continue. So no aditional installation needed that should be run. My solution prouces a small exe can be put on CD, autorun and work as installer or as program starter.<br />
<br />
-Hendri. <br />
<br />
I'm not sure I understand.  If the user's registry key doesnt get deleted when the program was removed, your solution would fail to install the application.  Correct?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">19th July 2002, 19:07</div></div><div class="posttext">So indeed, we need a proper uninstall, but that was not he question :)<br />
<br />
-Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">20th July 2002, 07:43</div></div><div class="posttext">A solution to the problem that people delete applications instead of uninstalling them could be this: if no regkey -&gt; just install. If the regkey is present -&gt; present an InstOpts dialog asking to &quot;reinstall&quot; or &quot;run&quot; (and maybe even &quot;uninstall&quot;) and where run is default. This way this problem would have been solved.<br />
<br />
-Hendri.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>