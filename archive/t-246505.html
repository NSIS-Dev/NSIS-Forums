<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installer and Uninstaller Redundancy, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installer and Uninstaller Redundancy NSIS Discussion" />
	
	<title> Installer and Uninstaller Redundancy [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installer and Uninstaller Redundancy</div>
<hr />
<div class="pda"><a href="t-246505.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246505">Installer and Uninstaller Redundancy</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Don Tommaso</div><div class="date">19th May 2006, 10:51</div></div><div class="posttext">I'm a newbie to NSIS and I can't figure out how<br />
to use the same functions for the installer and the uninstaller. Since the uninstaller functions must start<br />
with the un-prefix and the installer functions must not,<br />
my code is starting look horrible. E.g, I'm using<br />
the EnumUsersReg.nsh module/file in both the installer and in the uninstaller and I had to copy the file and rename<br />
every macro and function. Since no sensible language could<br />
force this kind of redundancy I assume that it can be solved somehow. But how?<br />
<br />
/Tomas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">19th May 2006, 12:07</div></div><div class="posttext">It is not the language, but I agree sharing functions between Installer and Uninstaller could be improved.<br />
<br />
Reason: Actually you are building TWO applications, an INSTALLER and an UNINSTALLER. Since you could need routines in your Installer you do not need in you uninstaller including them in both would make the unistaller unnessecair bigger filesize.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Don Tommaso</div><div class="date">19th May 2006, 12:27</div></div><div class="posttext">Ok. But is it possible to achieve my goal somehow? I cannot<br />
implement two versions of every function I'm using. It is madness!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th May 2006, 12:52</div></div><div class="posttext">You can use a macro.!macro myfunc un<br />
Function ${un}myfunc<br />
  Call ${un}someotherfunc<br />
  DetailPrint something<br />
FunctionEnd<br />
!macroend<br />
<br />
!insertmacro myfunc &quot;&quot;<br />
!insertmacro myfunc &quot;un.&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Don Tommaso</div><div class="date">19th May 2006, 15:04</div></div><div class="posttext">Thanks, it works great!<br />
You've saved my day.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">21st May 2006, 21:12</div></div><div class="posttext">Good codeing! Although obvious if you know it all....<br />
.. but that is not the situation for everyone. <br />
<br />
IDEA: Maybe somwhere to add example to the Wiki.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">22nd May 2006, 01:57</div></div><div class="posttext">I have just made an example here (http://nsis.sourceforge.net/Sharing_functions_between_Installer_and_Uninstaller).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wabiloo</div><div class="date">13th September 2006, 22:33</div></div><div class="posttext">Ah yes, but what happens if I want to use an existing function, like, say ${WordFind}?<br />
<br />
<br />
!macro myfunc un<br />
Function ${un}myfunc<br />
  ${WordFind} $CMDLINE &quot;/&quot; &quot;E+$8&quot; $7<br />
  DetailPrint something<br />
FunctionEnd<br />
!macroend<br />
<br />
!insertmacro myfunc &quot;&quot;<br />
!insertmacro myfunc &quot;un.&quot;<br />
<br />
<br />
doesn't work (obviously)...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">14th September 2006, 19:03</div></div><div class="posttext">Then you adapt the existing function to a similar scheme :)<br />
<br />
btw, this use of macros to create both an installer and an uninstaller function is in the NSIS help.  It's sadly hidden in the &quot;Scripting Structure &gt; 2.3.6 Compiler Commands&quot; topic, though.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th September 2006, 12:06</div></div><div class="posttext">!macro myfunc un<br />
Function ${un}myfunc<br />
  ${${un}WordFind} $CMDLINE &quot;/&quot; &quot;E+$8&quot; $7<br />
  DetailPrint something<br />
FunctionEnd<br />
!macroend<br />
<br />
!insertmacro myfunc &quot;&quot;<br />
!insertmacro myfunc &quot;un.&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wabiloo</div><div class="date">15th September 2006, 15:19</div></div><div class="posttext">${${un}WordFind} $CMDLINE &quot;/&quot; &quot;E+$8&quot; $7<br />
 <br />
<br />
Oooh, I didn't know I could do that (really I should have tried before assuming, or read TFM...).<br />
Just out of interest, is there any limit to the number of levels?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th September 2006, 16:04</div></div><div class="posttext">Nope, no limit.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">frodelan</div><div class="date">4th June 2009, 13:04</div></div><div class="posttext">I have following code in a .nsh file:<br />
<br />
!define Test &quot;!insertmacro Test&quot;<br />
<br />
!macro Test Var<br />
   Push &quot;${Var}&quot;<br />
   Call Test<br />
!macroend	<br />
<br />
Function Test<br />
   Exch $0<br />
   .....<br />
   Pop $0<br />
FunctionEnd<br />
<br />
I call this macro from a .nsi file with:<br />
<br />
${Test} &quot;Value&quot;<br />
<br />
How should I use this in an Uninstall section? I have tried to do as explained in previous posts. I put my function Test inside a &quot;DualFunction&quot; macro like myfunc, but I got a error that said I have wrong number of parameters to my function call. Anyone that has a suggestion?<br />
<br />
Best regards, Frode</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>