<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Need a system.dll push, please, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Need a system.dll push, please NSIS Discussion" />
	
	<title> Need a system.dll push, please [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Need a system.dll push, please</div>
<hr />
<div class="pda"><a href="t-141579.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=141579">Need a system.dll push, please</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">9th July 2003, 00:45</div></div><div class="posttext">:cry:<br />
Seems that system can solve problems related to API, ok...<br />
I understand the syntax, but I don't know how to convert<br />
my VB 6 API format to system plugin format.<br />
I read the example and the WEb archive, but still... :(<br />
Also my english isn't very well... :cry:<br />
for example:<br />
<br />
;Example of VB 6 API declare:<br />
Declare Function ShellAbout Lib &quot;shell32.dll&quot; Alias &quot;ShellAboutA&quot; _<br />
(ByVal hwnd As Long, ByVal szApp As String, ByVal szOtherStuff As _ <br />
String, ByVal hIcon As Long) As Long<br />
<br />
How do I convert it in system syntax...<br />
<br />
<br />
Declare Function GetUserDefaultLangID Lib &quot;kernel32&quot; _<br />
Alias &quot;GetUserDefaultLangID&quot; () As Integer<br />
<br />
How?<br />
:cry:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th July 2003, 12:38</div></div><div class="posttext">It's usually better to get the MSDN page on the function and not the VB page. See this (http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/reference/functions/shellabout.asp) page.<br />
<br />
As you can see, the function takes strings as arguments. Because of that (or because the MSDN page says so - not in this case) it has both Unicode and ASCII versions. This means you can call it in two ways, as ShellAboutA and as ShellAboutW. Since NSIS is ASCII too you must call it as ShellAboutA.<br />
<br />
Now to the DLL it's located in. According to the VB definition it's shell32.dll. This is usually at the bottom of the MSDN page (Import library - shell32.lib). So the line should look like this for now:<br />
<br />
System::Call &quot;shell32::ShellAboutA(<br />
<br />
Now for the arguments. The first argument is &quot;Window handle to a parent window. This parameter can be NULL.&quot;, though can be NULL we have the value so we will send it. HWND is a handle, and handles are to be sent as integers in System.dll. So our line will now look like:<br />
<br />
System::Call &quot;shell32::ShellAboutA(i $HWNDPARENT,<br />
<br />
Next argument is the title, text title. Text is 't' in System.dll.<br />
<br />
System::Call &quot;shell32::ShellAboutA(i $HWNDPARENT, t 'My title#my second title', <br />
<br />
Next argument is &quot;other stuff&quot;, also text.<br />
<br />
System::Call &quot;shell32::ShellAboutA(i $HWNDPARENT, t 'My title#my second title', t 'other stuff, copyright 2003, bla bla bla'<br />
<br />
Next, and last argument is a handle to an icon. To avoid loading icons with System.dll for now we'll just use the default icon and for that we'll pass on NULL (see the MSDN page). NULL is actually 0 and as I said before a handle is 'i' in System.dll, so:<br />
<br />
System::Call &quot;shell32::ShellAboutA(i $HWNDPARENT, t 'My title#my second title', t 'other stuff, copyright 2003, bla bla bla', i 0)<br />
<br />
Last but not least is the return value. The return value is an integer, again i. So:<br />
<br />
System::Call &quot;shell32::ShellAboutA(i $HWNDPARENT, t 'My title#my second title', t 'other stuff, copyright 2003, bla bla bla', i 0) i .s&quot;<br />
<br />
The last .s means the return value will be pushed on the NSIS stack so you should pop to get its value.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">9th July 2003, 16:13</div></div><div class="posttext">ok...thanks kichik..I think I learn now...<br />
So easy, now....<br />
I'll try with other Win32 API's<br />
Thanks...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">9th July 2003, 16:56</div></div><div class="posttext">sorry, me again...<br />
What's a hdc and how to use it with system?<br />
<br />
Declare Function GetDeviceCaps Lib &quot;gdi32&quot; (ByVal hdc As Long, _<br />
ByVal nIndex As Long) As Long</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th July 2003, 13:33</div></div><div class="posttext">This MSDN page (http://msdn.microsoft.com/library/en-us/gdi/devcons_0g6r.asp) provides information about device contexts. HDC is a handle to a device context. You usually get it by using the GetDC function (http://msdn.microsoft.com/library/en-us/gdi/devcons_4esj.asp).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>