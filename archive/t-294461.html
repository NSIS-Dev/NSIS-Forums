<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Notice/Message before a page.., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Notice/Message before a page.. NSIS Discussion" />
	
	<title> Notice/Message before a page.. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Notice/Message before a page..</div>
<hr />
<div class="pda"><a href="t-294461.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=294461">Notice/Message before a page..</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">XxXGoD</div><div class="date">14th July 2008, 01:26</div></div><div class="posttext">How can i put a message up just before the directory page apears... cos i want to tell them something before it apears or when it apears...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">14th July 2008, 01:29</div></div><div class="posttext">Use the page show_function or pre_function!<br />
<br />
More info at &quot;4.5.4 Page&quot; in the documentation ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">XxXGoD</div><div class="date">14th July 2008, 03:13</div></div><div class="posttext">I added:<br />
<br />
  <br />
Function .onVerifyInstDir<br />
MessageBox MB_OK &quot;My message&quot;<br />
  FunctionEnd<br />
<br />
<br />
But it shows at end of component page and start of directory page...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yelkrebb</div><div class="date">14th July 2008, 03:30</div></div><div class="posttext">Maybe this will help. <br />
<br />
MUI_PAGE_CUSTOMFUNCTION_PRE MyMessage<br />
MUI_PAGE_DIRECTORY<br />
<br />
Function MyMessage<br />
MessageBox MB_OK &quot;My message&quot;<br />
FunctionEnd<br />
<br />
~Berks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">XxXGoD</div><div class="date">14th July 2008, 03:32</div></div><div class="posttext">Ermm, Im using ExperienceUI<br />
<br />
SO MUI_PAGE_DIRECTORY...etc dont work</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yelkrebb</div><div class="date">14th July 2008, 03:35</div></div><div class="posttext">I see.. Sorry.<br />
<br />
How about this one..<br />
<br />
!define XPUI_PAGE_CUSTOMFUNCTION_PRE MyMessage<br />
!insertmacro XPUI_PAGE_DIRECTORY<br />
<br />
Function MyMessage<br />
MessageBox MB_OK &quot;My message&quot;<br />
FunctionEnd<br />
<br />
~Berks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">14th July 2008, 03:49</div></div><div class="posttext">Originally posted by XxXGoD <br />
I added:<br />
<br />
  <br />
Function .onVerifyInstDir<br />
MessageBox MB_OK &quot;My message&quot;<br />
  FunctionEnd<br />
<br />
<br />
But it shows at end of component page and start of directory page...  <br />
<br />
The .onVerifyInstDir function will be called every time the user changes the directory on the directory page. It will be called even when the user changes only one single character of the directory. And it will be called when a new folder is highlighted in the &quot;Browse...&quot; dialog. Therefore this function is not suitable for displaying message boxes. Make a custom &quot;pre_function&quot; as described in chapter &quot;4.5.4 Page&quot; of the NSIS manual. Reading the manual can help a lot...<br />
<br />
You must do it like:<br />
<br />
; pages<br />
page directory MyPreDirectoryFunction<br />
<br />
[..]<br />
<br />
Function MyPreDirectoryFunction<br />
  MessageBox MB_OK &quot;Be warned, you'll have to choose a directory now!&quot;<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">XxXGoD</div><div class="date">14th July 2008, 13:55</div></div><div class="posttext">LoRd_MuldeR<br />
<br />
That doesn't work for me.<br />
<br />
<br />
yelkrebb that pops up one and works for me but i cant seem to make it pop up at the directory page, it pops up at the start just after my spash screen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">14th July 2008, 14:34</div></div><div class="posttext">My code is correct, though ExperienceUI does hide the actual &quot;page&quot; commands in it's macros! So you will have to use the Syntax provided by ExperienceUI instead of the &quot;native&quot; NSIS syntax in that case. Should be documented in the ExperienceUI manual...<br />
<br />
This is how I think it should work:<br />
; page macros<br />
!define XPUI_PAGE_CUSTOMFUNCTION_PRE MyMessage<br />
!insertmacro XPUI_PAGE_DIRECTORY<br />
<br />
; custom functions<br />
Function MyMessage<br />
  MessageBox MB_OK &quot;My message&quot;<br />
FunctionEnd<br />
<br />
Make sure you put the XPUI_PAGE_CUSTOMFUNCTION_PRE define *directly* before the XPUI_PAGE_DIRECTORY macro! Do *not* put any other page macros in between! That's at least how it works with MUI, MUI2 and UMUI...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">XxXGoD</div><div class="date">14th July 2008, 15:03</div></div><div class="posttext">!insertmacro: XPUI_PAGE_DIRECTORY<br />
!insertmacro: XPUI_PAGECHECKS<br />
Call must be used with function names starting with &quot;un.&quot; in the uninstall section.<br />
Usage: Call function_name | [:label_name]<br />
Error in macro XPUI_PAGE_CUSTOMFUNCTION on macroline 3<br />
Error in macro XPUI_PAGE_DIRECTORY on macroline 38<br />
Error in script &quot;C:\Documents and Settings\Ryan\Desktop\h1o.nsi&quot; on line 110 -- aborting creation process<br />
<br />
<br />
Doesn't work for some reason... <br />
<br />
The reason im using XPUI is because it looks nicer than normal installers and cant seem to make normal installers look like XPUI</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">14th July 2008, 15:29</div></div><div class="posttext">Are doing this for the UNinstaller ???<br />
<br />
Please post your complete script code...<br />
<br />
<br />
[EDIT]<br />
<br />
This is from XPUI docs, took my one click in Google to find ;)<br />
<br />
Using custom page/GUI functions<br />
<br />
XPUI_CUSTOMFUNCTION_GUIINIT myFunction - Define this to call custom function &quot;myFunction&quot; during the installer's GUI initialization.<br />
<br />
XPUI_CUSTOMFUNCTION_GUIEND myFunction - Define this to call custom function &quot;myFunction&quot; during the installer's GUI de-initialization. Use this to unload any plugins you have and delete any temporary files that you dumped on to the user's hard drive.<br />
<br />
XPUI_PAGE_CUSTOMFUNCTION_PRE myFunction - Call function &quot;myFunction&quot; during the early initialization of an installer page.<br />
<br />
XPUI_PAGE_CUSTOMFUNCTION_SHOW myFunction - Call function &quot;myFunction&quot; right before an installer page shows.<br />
<br />
XPUI_PAGE_CUSTOMFUNCTION_LEAVE myFunction - Call function &quot;myFunction&quot; while an installer page is unloading.<br />
<br />
NOTE: After defining the XPUI_PAGE_CUSTOMFUNCTION symbols, insert the page of your choice, and that will be the page that calls your custom functions. You will need to define the CUSTOMFUNCTION symbols for every page that you want a custom function for. <br />
<br />
[EDITÂ²]<br />
<br />
If you used XPUI before, you might want to check out UMUI as well:<br />
http://sourceforge.net/project/showfiles.php?group_id=146999&amp;package_id=161955</div></div><hr />


<div class="post"><div class="posttop"><div class="username">XxXGoD</div><div class="date">14th July 2008, 15:50</div></div><div class="posttext">I fixed it<br />
<br />
Had to do:<br />
<br />
	${Page} Welcome<br />
;	${LicensePage} &quot;E:\Documents and Settings\User\Desktop\lic.rtf&quot;<br />
	${Page} Components<br />
	!define XPUI_PAGE_CUSTOMFUNCTION_PRE AccountDir<br />
	${Page} Directory<br />
	${Page} InstFiles<br />
	${Page} Finish<br />
<br />
Have to put the define in where the page's are and then move the rest of what you said below the pages<br />
<br />
<br />
I have been reading the INI section of the documentation and am wondering if:<br />
<br />
Can i edit a text file and add a line at the bottom of it adding the text<br />
<br />
exec autoexec.cfg</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">14th July 2008, 16:00</div></div><div class="posttext">As I said: You must put the XPUI_PAGE_CUSTOMFUNCTION_PRE define right before the page macro. Don't put anything in between, especially no other page macro!<br />
<br />
<br />
Append lines to a text file this way:<br />
<br />
  ; open file<br />
  ClearErrors<br />
  FileOpen $0 &quot;autoexec.cfg&quot; a<br />
  IfErrors FileErrors<br />
<br />
  ; seek to the end of the file<br />
  FileSeek $0 0 END<br />
<br />
  ; append a few lines<br />
  FileWrite $0 &quot;Rabbit$\r$\n&quot;<br />
  FileWrite $0 &quot;Umbrella$\r$\n&quot;<br />
  FileWrite $0 &quot;Joker$\r$\n&quot;<br />
<br />
  ; close file<br />
  FileClose $0<br />
<br />
  FileErrors:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">XxXGoD</div><div class="date">14th July 2008, 17:15</div></div><div class="posttext">What does the foloowing do:<br />
<br />
$\r$\n</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">14th July 2008, 17:37</div></div><div class="posttext">$\r$\n are symbols for a carriage return ($\r) and new line ($\n) character.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">XxXGoD</div><div class="date">14th July 2008, 18:19</div></div><div class="posttext">Works perfectly, however on some peoples pc's it wont be there..<br />
<br />
How can i add it so IF that file isn't there it will put it there, but if it is it wont... but the other files what im putting in i want to overright</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">14th July 2008, 18:27</div></div><div class="posttext">You can check for file existence with IfFileExists command ;)<br />
<br />
Also, the above code should work, no matter if the file exists before or not...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">XxXGoD</div><div class="date">14th July 2008, 19:28</div></div><div class="posttext">Originally posted by LoRd_MuldeR <br />
You can check for file existence with IfFileExists command ;)<br />
<br />
Also, the above code should work, no matter if the file exists before or not...  <br />
But theres 1 file what i dont want it to overwrite.<br />
<br />
I want it to only put the file in if there is no file there....<br />
<br />
EDIT:<br />
<br />
IfFileExists $INSTDIR\autoexec.cfg autoexecfound<br />
File &quot;C:\Documents and Settings\Ryan\Desktop\autoexec.cfg&quot;<br />
     autoexecfound:<br />
  ClearErrors<br />
  FileOpen $0 &quot;$INSTDIR\autoexec.cfg&quot; a<br />
  IfErrors FileErrors<br />
  FileSeek $0 0 END<br />
  FileWrite $0 &quot;TestLine$\r$\n&quot;<br />
  FileClose $0<br />
  FileErrors:<br />
<br />
Is that right?<br />
<br />
So if the file is there it's going to jump the step: File &quot;C:\Documents and Settings\Ryan\Desktop\autoexec.cfg&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">14th July 2008, 20:36</div></div><div class="posttext">You code should extract a the &quot;autoexec.cfg&quot; to the $INSTDIR folder, but *only* when there is no such file yet. If the file already exists, that part will be skipped. In both cases one line, namely &quot;TestLine&quot;, will be appended to the &quot;autoexec.cfg&quot; file. One tip though: You can not be sure that the last line of the user's &quot;autoexec.cfg&quot; file has a carriage return at it's end. So it might be more safe to do it this way:<br />
<br />
  IfFileExists $INSTDIR\autoexec.cfg autoexecfound<br />
  File &quot;C:\Documents and Settings\Ryan\Desktop\autoexec.cfg&quot;<br />
  <br />
  autoexecfound:<br />
  <br />
  ClearErrors<br />
  FileOpen $0 &quot;$INSTDIR\autoexec.cfg&quot; a<br />
  IfErrors FileErrors<br />
  FileSeek $0 0 END<br />
  FileWrite $0 &quot;$\r$\n&quot; ; &lt;-- THIS IS NEW<br />
  FileWrite $0 &quot;TestLine$\r$\n&quot;<br />
  FileClose $0<br />
<br />
  FileErrors:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">14th July 2008, 20:48</div></div><div class="posttext">Or even better:<br />
<br />
IfFileExists $INSTDIR\autoexec.cfg autoexecfound<br />
  File &quot;C:\Documents and Settings\Ryan\Desktop\autoexec.cfg&quot;<br />
  <br />
  autoexecfound:<br />
  <br />
  ClearErrors<br />
  FileOpen $0 &quot;$INSTDIR\autoexec.cfg&quot; a<br />
  IfErrors FileErrors<br />
  FileSeek $0 1 END<br />
  FileReadByte $0 $1<br />
  StrCmp $1 10 CarriageReturnFound:<br />
  FileWrite $0 &quot;$\r$\n&quot;<br />
<br />
  CarriageReturnFound:<br />
  FileWrite $0 &quot;TestLine$\r$\n&quot;<br />
  FileClose $0<br />
<br />
  FileErrors:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">XxXGoD</div><div class="date">14th July 2008, 20:50</div></div><div class="posttext">yeah, awesome i learnt alot today :D</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>