<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Winmessages keystroke, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Winmessages keystroke NSIS Discussion" />
	
	<title> Winmessages keystroke [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Winmessages keystroke</div>
<hr />
<div class="pda"><a href="t-223382.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=223382">Winmessages keystroke</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ender7584</div><div class="date">4th August 2005, 21:16</div></div><div class="posttext">Is there a way to send a window a specific keystroke using winmessages?<br />
<br />
If not, then is there a way to get an &quot;ok&quot; button clicked?<br />
<br />
I have been searching and cannot find much documentation (except in the case of closing a window), my ultimate goal is to keep selecting next (and a few radio buttons) on the &quot;search the net for newer drivers&quot; win XP system popup when a USB cable is inserted.<br />
<br />
Basically I can get the class name of the window using win32 spy, but I'm unsure how to use the other paramaters of the findwindow and sendmessage commands.  I also am totally lost with GetDlgItem, and do not know if I even need it (I have read the documentation, and still do not get it).  Can someone please explain how to do this?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">6th August 2005, 18:25</div></div><div class="posttext">${WM_KEYDOWN} (from WinMessages.nsh) is probably what you need.  However, I'm not 100% sure of the syntax--you may need to exeriment with it.     This MSDN article (http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputmessages/wm_keydown.asp) may help.<br />
<br />
And I'm not sure about whether you'd need to use GetDlgItem or just FindWindow.  (My guess is that the Window itself is what responds to keystrokes, so you'd probably just need to use FindWindow.)<br />
<br />
The only thing I'd caution on is the fact that by sending keystrokes a window, you assume that the window is the same all the time.  There could be that one time where the dialog is slightly different (becuase of a different serive pack, optional software, etc.)  If you are not careful, you could end up sending the user down a totally different path than you indended.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ender7584</div><div class="date">8th August 2005, 14:18</div></div><div class="posttext">Thanks for your reply.  I tried a bunch of differant things with it, and nothing seemed to work.  I ended up just writing a C applet that I can call from NSIS that will send the specified keystrokes. And yes, the problem with this, is if for some reason the user window is differant, which leads me to my next question.<br />
<br />
Is there any way to, knowing the name of the hardware device, check to see that it is installed?  Of course I will also be testing my code with every SP of XP (since it only needs to run on XP) but it would also be nice as a just in case factor to check to make sure it's installed.  If for some reason it's not installed, I'll have to prompt the user to do a manual installation.  Hopefully there is a way to do this, but I again cannot find it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th August 2005, 14:35</div></div><div class="posttext">This is the code you want to click Next I think:<br />
<br />
SendMessage $HWNDPARENT ${WM_NOTIFY_OUTER_NEXT} 1 0<br />
<br />
Haven't tried it, but it's what InstallOptions uses for Notify buttons.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ender7584</div><div class="date">8th August 2005, 15:58</div></div><div class="posttext">Alright, Tested my C applet, and it's pretty stable.<br />
<br />
Definatly my problem now would be trying to detect if a device is installed.  My particular device i called &quot;USB superlink adapter&quot;.  It seems like you should be able to use the system plugin to call something in windows that will tell you if this device is installed on the system...but I can't find anything like it.  Any ideas?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>