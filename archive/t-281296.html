<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Relgotopage - understanding problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Relgotopage - understanding problem NSIS Discussion" />
	
	<title> Relgotopage - understanding problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Relgotopage - understanding problem</div>
<hr />
<div class="pda"><a href="t-281296.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=281296">Relgotopage - understanding problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">cheryll</div><div class="date">12th November 2007, 08:43</div></div><div class="posttext">hi,<br />
I'm having some problems with an installer again. <br />
<br />
I'm writing an installer for a program that needs Word and Excel. I have one custam page with radio buttons to choose the Officeversion to use with the problem. Now I'm trying to add another custom page that's only called if excel.exe isn't found in the appropriate directory.<br />
I tried RelGotoPage for that, but I can't realy puzzle out the  documentation for that function. I used:<br />
<br />
Function &quot;Jump&quot;<br />
Iffileexists &quot;$WORD_VERSIONEXCEL.EXE&quot; 0 OfficeNV<br />
StrCpy $R9 &quot;2&quot;<br />
Call RelGotoPage<br />
Abort<br />
OfficeNV:<br />
StrCpy $R9 &quot;1&quot;<br />
Call RelGotoPage<br />
Abort<br />
FunctionEnd<br />
<br />
but that didn't work at all, I allways got to the second custom page.<br />
<br />
I think I should use something like this example:<br />
<br />
!include &quot;MUI.nsh&quot; ;Required by MUI<br />
 <br />
Page custom CustomPage<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE Components_PreFunction<br />
  !insertmacro MUI_PAGE_COMPONENTS<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE Directory_PreFunction<br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  <br />
!define MUI_CUSTOMFUNCTION_ABORT &quot;FunctionName&quot;<br />
!insertmacro MUI_LANGUAGE &quot;English&quot; ;Required by MUI<br />
 <br />
Function CustomPage<br />
  StrCpy $R8 1 ;This is the first page<br />
  InstallOptions::dialog &quot;C:\MyDir\MyIOPage.ini&quot;<br />
  Pop $0<br />
FunctionEnd<br />
 <br />
Function Components_PreFunction<br />
  StrCpy $R8 2 ;This is the second page<br />
FunctionEnd<br />
 <br />
Function Directory_PreFunction<br />
  StrCpy $R8 3 ;This is the third page<br />
FunctionEnd<br />
 <br />
Function FunctionName<br />
  StrCmp $R8 1 0 End ;Compare the variable with the<br />
                     ;page index of your choice<br />
    StrCpy $R9 1<br />
    Call RelGotoPage<br />
    Abort<br />
  End:<br />
FunctionEnd<br />
but I just don't understand what all that means and how I should adapt it for my installer. I'd be quite grateful if someone could explain it to me a bit more detailed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th November 2007, 08:47</div></div><div class="posttext">You should try and refrain from using RelGotoPage because when the user clicks the back button they will still be shown the page. Instead what you should do is call Abort in page's pre functions and custom page's show functions if a certain condition is set to skip them.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cheryll</div><div class="date">12th November 2007, 09:09</div></div><div class="posttext">Ok, thanks, it's working now, and it's shorter too.:)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>