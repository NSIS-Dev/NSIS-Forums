<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installation on WinNT4.0: All User!!, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installation on WinNT4.0: All User!! NSIS Discussion" />
	
	<title> Installation on WinNT4.0: All User!! [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installation on WinNT4.0: All User!!</div>
<hr />
<div class="pda"><a href="t-58791.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=58791">Installation on WinNT4.0: All User!!</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Chris64</div><div class="date">31st August 2001, 15:58</div></div><div class="posttext">Hi all,<br />
I have the following problem: On a WinNT4-PC: If the admin installs my program a link in the startmenu of the admin is created. How can I detect in my script, if the admin of the WinNT-system is logged in and tries to install my program and then to let choose him, if he wants to create a shortcut in the AllUser-startmenu or the startmenu of the admin. Hopefully somebody can help me. <br />
<br />
General: If this option is actually not supported in NSIS, the developers should include this. ;) All well-known installer can this and NSIS should support it, too :)<br />
<br />
Regards<br />
Christian</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DuaneJeffers</div><div class="date">1st September 2001, 07:37</div></div><div class="posttext">First off, NSIS is developed by one guy, Justin Frankel. If you don't know who this is, then you are in the wrong forums.<br />
<br />
1)From what I know, all NT functions are not added into NSIS for many reasons. This was originally for people who develop programs for Win98 and WinME/2000. This is supposed to be a small complex installer and something that was not suppost to take up much space.<br />
<br />
-DJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pjw62</div><div class="date">1st September 2001, 13:20</div></div><div class="posttext">Use a MessageBox;<br />
<br />
MessageBox MB_YESNO &quot;Put links in the ALLUsers menu?&quot; IDYES AllUsers<br />
; code for admin menu<br />
  AllUsers:<br />
; code for AllUsers<br />
<br />
for just the local machine or machines that dont have a set start menu copied by script on login, I think it would be safe to GetParent dir of the admin's start menu a few times, then append the all users directory and start menu.. unless you just read the value from the registry (sorry, dont know key off hand).<br />
<br />
You would need to put it in your script because as Duane says, no one wants a huge exe header wasting precious clock cycles deciding whether it is running on winnt or not.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">prodangle</div><div class="date">3rd September 2001, 01:53</div></div><div class="posttext">calm down chris64, try to be a bit nicer.  No need for the mention of rival installers<br />
<br />
:D :D :D <br />
<br />
You could always cheat and send the link to &quot;C:\Documents and Settings\All Users &quot;should work in 99% of cases but it is a bit messy<br />
I dont know whether a &quot;$STARTMENU\..\..\All Users&quot; (going 2 dirs back from the current user's Sm and then into AllUsers) thing would work, but even if it does this could be messy if that users SM isn't in the standard place - I can't be bothered trying it right now but it might be worth a shot<br />
<br />
in a multiuser win9x system there is also an All Users folder in $WINDIR\All Users\Start Menu btw<br />
<br />
(sorry for promoting messy tacky scripting here - Ive never done anything like that myself - honest)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Someonebutnotme</div><div class="date">4th September 2001, 13:40</div></div><div class="posttext">Originally posted by DuaneJeffers <br />
First off, NSIS is developed by one guy, Justin Frankel. If you don't know who this is, then you are in the wrong forums.<br />
<br />
Jesus H Christ man, everyone is welcome whether or not they know if Justin creates this by himself.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Gonzotek</div><div class="date">10th September 2001, 15:17</div></div><div class="posttext">And, while Justin is the primary developer, others have contributed to the code and are credited with those contributions.  So developer*S* would indeed be the correct usage.  If someone else figured out an elegant and workable solution to his problem, what would be wrong with that?<br />
<br />
-=Gonzotek=-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Chris64</div><div class="date">17th October 2001, 14:14</div></div><div class="posttext">Hello all, :) <br />
Do nobody use NSIS with Windows NT 4.0? I cannot imagine that! ;) How do you solve this problem? I think to display a message-box and ask the user is not the best solution, because many *normal* win9x would be VERY confused, if they would be confronted with a NT-question!... Most of the *normal* users of win9x don't know what a &quot;All user&quot; and a &quot;User&quot;-startmenu is! <br />
Can somebody give me an advise how to solve this problem? Otherwise I am not able to use this nice, small NSIS-installer ;) And I really like the small size !!! :)<br />
<br />
Regards<br />
Christian</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsfis</div><div class="date">18th October 2001, 07:36</div></div><div class="posttext">Instead of $SMPROGRAMS I find out the right directory for All users this way:<br />
<br />
ReadRegStr $9 HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders&quot; &quot;Common Programs&quot;</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>