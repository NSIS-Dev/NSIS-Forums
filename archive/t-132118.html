<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" EnumCDs with Adapter and ID, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  EnumCDs with Adapter and ID NSIS Discussion" />
	
	<title> EnumCDs with Adapter and ID [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  EnumCDs with Adapter and ID</div>
<hr />
<div class="pda"><a href="t-132118.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=132118">EnumCDs with Adapter and ID</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">17th April 2003, 17:12</div></div><div class="posttext">Making an installation for another program I found the need of knowing how many cd drives are in the system, and which Adapter and ID use. Can this be known in some way?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th April 2003, 17:25</div></div><div class="posttext">This one enumerates all CDs on the system:<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=82<br />
<br />
I know how to get the serial number of the drive but have no idea how to get the adapater. If you find something about it in the internet I can help you write the plug-in.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">18th April 2003, 01:26</div></div><div class="posttext">ok, I'll search a bit.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">24th June 2003, 14:31</div></div><div class="posttext">In a ASPI document I found this example. This example scans the system for all CD-ROM drives (all targets must be at LUN #0). Please note that MAX_HA_ID and MAX_TARGET_ID should be replaced with a host adapter count returned by etASPI32SupportInfo and a target count retrieved from a SC_HA_INQUIRY SRB performed within the host adapter loop.<br />
<br />
I also found that I could check all host/adapter pairs with the command SC_GET_DEV_TYPE and check if the device type is DTYPE_CDROM.<br />
<br />
I asked kichik and he doesn't know how to deal with ASPI, can anybody else help me?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ramon18</div><div class="date">24th June 2003, 16:43</div></div><div class="posttext">Check this site:<br />
<br />
http://www.hochfeiler.it/alvise/ASPI_1.HTM<br />
<br />
If you need help with programming, PM me<br />
<br />
good luck<br />
Ramon</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ramon18</div><div class="date">25th June 2003, 12:19</div></div><div class="posttext">Dear n0On3,<br />
<br />
Check attachment application I made and let me know if you think it is what you need,<br />
<br />
If yes I can make the plugin using the code code, to return how many CD-ROMs found, which SCSI IDs and adapters Numbers<br />
<br />
bye<br />
Ramon</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">25th June 2003, 18:07</div></div><div class="posttext">Thanks for your help.<br />
<br />
I need the &quot;100&quot; string in the stack when the Adapter is 1 and the ID 0. I don't know what the last zero means.<br />
<br />
I have the idea to pop in a loop until &quot;NoMoreCDRoms&quot; is found.<br />
<br />
so the stack would be:<br />
<br />
100<br />
010<br />
020<br />
NoMoreCDRoms<br />
...<br />
...<br />
[whatever there was in the stack before the plugin]<br />
<br />
I attach a snapshot that shows differences with your program numbers and what I need.<br />
<br />
I don't know how this program writes a cdrom in the ID = 200. But if the dll works with low numbers it's enough for me. At least, I always seen CDRoms in low numbers.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ramon18</div><div class="date">25th June 2003, 19:43</div></div><div class="posttext">Hi,<br />
<br />
you can forget the &quot;lun X&quot; numbers, this was just for debug, coze it was my first tests with ASPI.<br />
<br />
My idea was the following:<br />
<br />
you call something like:<br />
<br />
  ASPIInfo::GetCDRoms /CDROM<br />
<br />
then the stack would be (eg: for 3 CDRoms):<br />
  <br />
  &quot;3&quot; -&gt; number of CDRoms found<br />
  &quot;1&quot; -&gt; 1º CDRom Adapter ID<br />
  &quot;0&quot; -&gt; 1º CDRom ID<br />
  &quot;1&quot; -&gt; 2º CDRom Adapter ID<br />
  &quot;1&quot; -&gt; 2º CDRom ID<br />
  &quot;1&quot; -&gt; 3º CDRom Adapter ID<br />
  &quot;2&quot; -&gt; 3º CDRom ID<br />
<br />
what do you think?<br />
<br />
<br />
PS: What do you mean by : &quot;...writes a cdrom in the ID = 200...&quot;<br />
<br />
cyas<br />
Ramon</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">25th June 2003, 22:08</div></div><div class="posttext">yes, this format is ok. But I suggest adding some dummy string to know when there are no more cdroms numbers in the stack.<br />
<br />
PS: What do you mean by : &quot;...writes a cdrom in the ID = 200...&quot; &lt;- You asked me in a pm which limits has that ID number. And I wanted that I don't know. Just do what you think is ok, because all IDs I've seen are one digit.<br />
<br />
<br />
Thanks for you help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ramon18</div><div class="date">26th June 2003, 00:06</div></div><div class="posttext">Hi,<br />
<br />
You must detect if there are more CDRoms or no using the top of stack, this way <br />
<br />
<br />
...<br />
  push $2<br />
  push $1<br />
  push $0<br />
  ASPIInfo::GetCDRoms /CDROM<br />
  pop $0 ; -&gt; retrieve how many CDRoms<br />
DO_LOOP:<br />
  IntCmp $0 0 END_LOOP<br />
  pop $1 ; -&gt; retrieve Adapter<br />
  pop $2 ; -&gt; retrieve ID<br />
  DetailPrint &quot;Adapter = $1, ID = $2&quot;<br />
  IntOp $0 $0 - 1<br />
  goto DO_LOOP<br />
END_LOOP:<br />
  pop $0<br />
  pop $1<br />
  pop $2<br />
...<br />
 <br />
<br />
btw, do you need the CDRom/Hardware String Identifier (eg. my DVD combo string is : &quot;TOSHIBA DVD-ROM SD-C2402&quot;)?<br />
<br />
br,<br />
Ramon:p</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">26th June 2003, 15:21</div></div><div class="posttext">Ok, this format is ok.<br />
<br />
I don't particularly need the String Identifier as much as I need the adapter/host, but it would be nice to have it :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ramon18</div><div class="date">26th June 2003, 17:57</div></div><div class="posttext">Hi,<br />
<br />
So the new code in your script with support for &quot;CDRom/Hardware String Identifier&quot; would be:<br />
<br />
<br />
...<br />
  push $3<br />
  push $2<br />
  push $1<br />
  push $0<br />
  ASPIInfo::GetCDRoms /CDROM<br />
  pop $0 ; -&gt; retrieve how many CDRoms<br />
DO_LOOP:<br />
  IntCmp $0 0 END_LOOP<br />
  pop $1 ; -&gt; retrieve Adapter<br />
  pop $2 ; -&gt; retrieve ID<br />
  pop $3 ; -&gt; retrieve CDRom/Hardware String<br />
  DetailPrint &quot;Adapter = $1, ID = $2, CD-ROM Name = $3&quot;<br />
  IntOp $0 $0 - 1<br />
  goto DO_LOOP<br />
END_LOOP:<br />
  pop $0<br />
  pop $1<br />
  pop $2<br />
  pop $3<br />
...<br />
<br />
<br />
When I have this completed I will reply again,<br />
<br />
Good bye<br />
Ramon</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">26th June 2003, 21:48</div></div><div class="posttext">ok, I'll be waiting ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ramon18</div><div class="date">1st July 2003, 08:54</div></div><div class="posttext">Hi,<br />
<br />
I found some problems under win9X, you have to wait a little more, sorry<br />
<br />
WinNT/2000/XP is working good :)<br />
<br />
cyas<br />
Ramon</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">1st July 2003, 19:56</div></div><div class="posttext">Don't worry, I can wait. It's great seeing that your are testing with win9x aswell:up:</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>