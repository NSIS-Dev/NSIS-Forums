<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Env var for sub installer - how to set?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Env var for sub installer - how to set? NSIS Discussion" />
	
	<title> Env var for sub installer - how to set? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Env var for sub installer - how to set?</div>
<hr />
<div class="pda"><a href="t-352910.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=352910">Env var for sub installer - how to set?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">SJSJ</div><div class="date">29th November 2012, 09:40</div></div><div class="posttext">Hello, <br />
<br />
I would really appreciate if somebody can help me here. <br />
<br />
This is the scenario I am attempting <br />
<br />
1. Main installer calls sub_installer #1 (OpenSSL - 3rd party).  <br />
2. Main installer appends env var PATH with the path of application installed in sub_installer #1. (For some reason, it is not done in the sub installer itself. ) <br />
3. Main installer executes sub_installer #2 (3rd party) which needs the value in PATH done in step 2. <br />
<br />
The step 2 is done as follows:<br />
<br />
ReadEnvStr $R0 &quot;PATH&quot;<br />
StrCpy $R0 &quot;$R0;C:\OpenSSL&quot;<br />
System::Call 'Kernel32::SetEnvironmentVariableW(t, t) i(&quot;PATH&quot;, R0).r0'<br />
StrCmp $0 0 error<br />
Goto done<br />
error:<br />
MessageBox MB_OK &quot;Can't set environment variable&quot;<br />
ReadEnvStr $R0 &quot;PATH&quot;<br />
MessageBox MB_OK $R0<br />
Abort<br />
done:<br />
MessageBox MB_OK &quot;Updated Path temporarily&quot;<br />
ReadEnvStr $R0 &quot;PATH&quot;<br />
MessageBox MB_OK $R0<br />
<br />
From what I see during execution, I do get the &quot;Updated Path temporarily&quot; message and the appended PATH in $R0; but the sub_installer #2 does not seem to find the value in PATH (it says OpenSSL is not installed). <br />
<br />
Now, If I execute the same steps manually by running the installers and seting the PATH in between, the sub_installer #2 is able to find the OpenSSL installed.  <br />
<br />
I use NSIS Unicode 2.46, Windows 7 (32 bit).<br />
<br />
As per above code, wouldn't the child process (here, sub_installer #2) get the modified PATH? <br />
Am I doing a mistake here? <br />
<br />
-SJSJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">29th November 2012, 12:22</div></div><div class="posttext">http://forums.winamp.com/showthread.php?t=274158</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">29th November 2012, 14:06</div></div><div class="posttext">Try Exec '&quot;cmd&quot; /k set' to verify that it is set correctly. (Or Process Explorer)<br />
<br />
Also, don't mix t and W, use &quot;SetEnvironmentVariable(t, t)&quot; or &quot;SetEnvironmentVariableW(w, w)&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SJSJ</div><div class="date">30th November 2012, 04:27</div></div><div class="posttext">Thanks Anders, for pointing out the mix-up. <br />
I shall try checking the var as you suggested.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SJSJ</div><div class="date">13th December 2012, 06:34</div></div><div class="posttext">Sorry for the late update.<br />
The issue is fixed. <br />
The problem was in sub_installer #2 (3rd party) as well.<br />
Thanks for pointing the Ansi, Unicode mix up!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>