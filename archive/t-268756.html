<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" drop-down popup during download?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  drop-down popup during download? NSIS Discussion" />
	
	<title> drop-down popup during download? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  drop-down popup during download?</div>
<hr />
<div class="pda"><a href="t-268756.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=268756">drop-down popup during download?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">empezar</div><div class="date">1st April 2007, 16:52</div></div><div class="posttext">is it possible to display a drop-down popup containing e.g. alternative mirrors during a download?<br />
<br />
say if a download fails, because the current mirror used is down. the user might want to change mirror without restarting setup.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">2nd April 2007, 00:07</div></div><div class="posttext">Could be something like this (4th server is the good one),<br />
!define INI &quot;$PLUGINSDIR\custom.ini&quot;<br />
<br />
outfile 'nsisdl.exe'<br />
<br />
page custom cte lve<br />
page instfiles &quot;&quot; &quot;&quot; ilve<br />
<br />
Function .onInit<br />
 InitPluginsDir<br />
  WriteINIStr &quot;${INI}&quot; &quot;Settings&quot; &quot;NumFields&quot; &quot;1&quot;<br />
  WriteINIStr &quot;${INI}&quot; &quot;Settings&quot; &quot;NextButtonText&quot; &quot;Download&quot;<br />
  WriteINIStr &quot;${INI}&quot; &quot;Field 1&quot; &quot;type&quot; &quot;DropList&quot;<br />
  WriteINIStr &quot;${INI}&quot; &quot;Field 1&quot; &quot;left&quot; &quot;10&quot;<br />
  WriteINIStr &quot;${INI}&quot; &quot;Field 1&quot; &quot;right&quot; &quot;-10&quot;<br />
  WriteINIStr &quot;${INI}&quot; &quot;Field 1&quot; &quot;top&quot; &quot;30&quot;<br />
  WriteINIStr &quot;${INI}&quot; &quot;Field 1&quot; &quot;bottom&quot; &quot;78&quot;<br />
  WriteINIStr &quot;${INI}&quot; &quot;Field 1&quot; &quot;state&quot; &quot;http://nsis.sourceforge.net/nihtgly/nsis.zip&quot;<br />
  WriteINIStr &quot;${INI}&quot; &quot;Field 1&quot; &quot;listitems&quot; &quot;http://nsis.sourceforge.net/nihtgly/nsis.zip|\<br />
  http://nsis.sourceforge.net/nitghly/nsis.zip|http://nsis.sourceforge.net/nihgtly/nsis.zip|\<br />
  http://nsis.sourceforge.net/nightly/nsis.zip&quot;<br />
FunctionEnd<br />
<br />
Function cte<br />
  InstallOptions::Dialog &quot;${INI}&quot;<br />
FunctionEnd<br />
<br />
Function lve<br />
  ReadIniStr $0 &quot;${INI}&quot; &quot;field 1&quot; &quot;state&quot;<br />
Functionend<br />
<br />
Function ilve<br />
  Strcmp $R0 &quot;back&quot; 0 end<br />
   SendMessage $HWNDPARENT &quot;0x408&quot; &quot;-1&quot; &quot;0&quot;<br />
   Abort<br />
end:<br />
Functionend<br />
  <br />
Section &quot;dummy&quot;<br />
 NSISdl::download &quot;$0&quot; &quot;$EXEDIR\nsis.zip&quot;<br />
 Pop $0 ;Get the return value<br />
  StrCmp $0 &quot;success&quot; good<br />
  MessageBox MB_YESNO &quot;Download failed: $0$\r$\nSelect another mirror?&quot; IDNO good<br />
  Strcpy $R0 &quot;back&quot;<br />
  goto end<br />
good:<br />
  Strcpy $R0 &quot;&quot;<br />
end:<br />
Sectionend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">2nd April 2007, 03:43</div></div><div class="posttext">RedWine, what does this do?SendMessage $HWNDPARENT &quot;0x408&quot; &quot;-1&quot; &quot;0&quot; I don't see 0x408 in WinMessages.nsh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">empezar</div><div class="date">2nd April 2007, 07:39</div></div><div class="posttext">will that just select the next server in the mirror list?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">2nd April 2007, 09:05</div></div><div class="posttext">Originally posted by empezar <br />
will that just select the next server in the mirror list? The simplified above example, if download fails, just jumps back to the previous page<br />
where users are able to select a different mirror from mirrors list.<br />
<br />
See here for details about jump to a page. (http://nsis.sourceforge.net/Go_to_a_NSIS_page)<br />
<br />
Just compile it and run it to see how it works.<br />
I guess if you play a little with it, you should be able<br />
to make it select automatically the next mirror from the list.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">empezar</div><div class="date">2nd April 2007, 16:12</div></div><div class="posttext">when I jump back 3 steps to the mirror selection, and then press Next and get the same error, aborting will not jump back to the mirror selection page, but to the license agreement (another 3 steps backwards), and when I click Agree there, and press abort again, it will cancel the installation.<br />
<br />
so the problem seems to be this<br />
<br />
Display welcome screen<br />
Display license agreement<br />
Select components<br />
Select mirror<br />
Select installation path<br />
Select start menu folder<br />
Install -&gt; Click Abort<br />
Go back 3 steps to &quot;Select mirror&quot;<br />
Install -&gt; Click Abort<br />
Go back 3 steps to &quot;Display license agreement&quot;<br />
<br />
so, how do I &quot;reset&quot; the page so once I select a mirror for the second time and it still fails, I won't go back ANOTHER 3 steps, but back to the mirror selection?<br />
<br />
another related question: how do I go back in sections? I mean, if a download fails and a user chooses to try a different mirror, the installer should not abandon that section and try the new mirror with the next section, it should RETRY the current section with the newly selected mirror.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">2nd April 2007, 17:31</div></div><div class="posttext">Probably this needs 2 instfiles pages  1st for download section and 2nd for all other selected sections when download success.<br />
I suppose select mirror page should reside just before the 1st instfiles page and right after the 2nd instfiles.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>