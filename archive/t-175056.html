<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" deleting question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  deleting question NSIS Discussion" />
	
	<title> deleting question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  deleting question</div>
<hr />
<div class="pda"><a href="t-175056.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=175056">deleting question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">gieltje</div><div class="date">2nd April 2004, 07:04</div></div><div class="posttext">Hi all,<br />
<br />
I need to delete some folders that are not in the install folder, and have varying names.<br />
<br />
I cannot simply delete the folder in which they are because it is a system folder.<br />
<br />
example;<br />
c:\blaat<br />
c:\blaat\1<br />
C:\blaat\2<br />
Now 1 &amp; 2 need to be deleted, but blaat cannot be.<br />
<br />
How do I this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evilO</div><div class="date">2nd April 2004, 07:37</div></div><div class="posttext">Hi :)<br />
<br />
<br />
4.9.1.8 RMDir<br />
[/r|/REBOOTOK] directory_name<br />
<br />
Remove the specified directory (which should be a full path). Without /r, the directory will only be removed if it is completely empty. If /r is specified, the directory will be removed recursively, so all directories and files in the specified directory will be removed. If /REBOOTOK is specified, and the directory cannot be overwritten, then the directory will be deleted when the system reboots -- if the directory will be removed on a reboot, the reboot flag will be set. The error flag is set if the directory cannot be removed.<br />
 <br />
<br />
I don't know exactly if I understood your problem, but to remove these directories you just have to do that:<br />
<br />
- If the folders are empty:<br />
<br />
RmDir c:\blaat\1<br />
RmDir c:\blaat\2<br />
<br />
<br />
- If the folders are *not* empty:<br />
<br />
RmDir /r c:\blaat\1<br />
RmDir /r c:\blaat\2<br />
<br />
<br />
<br />
Is that what you want to achieve ?<br />
<br />
evilO/Olive</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gieltje</div><div class="date">2nd April 2004, 07:39</div></div><div class="posttext">allmost, another problem is the names of these dirs are always changing so RMDir &quot;c:\blaat\*&quot; should be it but it does not delete every dir in c:\blaat but trys to remove c:\blaat which cannot be done (because it is a system folder)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evilO</div><div class="date">2nd April 2004, 13:36</div></div><div class="posttext">Ok, I got it now. You can use the following code to achieve this, but BE CAREFUL: it will remove EVERY SUBDIRECTORY (not the files) of the specified directory. Especially if &quot;c:\blaat&quot; is a system folder.<br />
<br />
<br />
Function EmptyFolder<br />
  Exch $R0 ; Name of the folder to empty<br />
  Push $R1 ; Search handle<br />
  Push $R2 ; Current file or folder<br />
  <br />
  ${If} ${FileExists} &quot;$R0\\*.*&quot;                  ; If the current element is a directory<br />
    ClearErrors<br />
    FindFirst $R1 $R2 &quot;$R0\\*.*&quot;                  ; Starts the search<br />
    ${Unless} ${Errors}<br />
      ${Do}<br />
        ${Select} $R2<br />
          ${Case2} &quot;.&quot; &quot;..&quot;                      ; If the current element is '.' or '..' do nothing<br />
<br />
          ${CaseElse}                            ; Otherwise<br />
            ${If} ${FileExists} &quot;$R0\\$R2\\*.*&quot;    ; If the current element is a directory<br />
              Rmdir /r &quot;$R0\\$R2&quot;                 ; Removes it<br />
            ${EndIf}<br />
        ${EndSelect}<br />
        FindNext $R1 $R2                         ; Continues the search<br />
      ${LoopUntil} ${Errors}<br />
      FindClose $R1                              ; Closes the search handle<br />
    ${EndUnless}<br />
  ${EndIf}<br />
<br />
  Pop $R2<br />
  Pop $R1<br />
  Pop $R0<br />
FunctionEnd <br />
<br />
<br />
And to use it: <br />
<br />
<br />
Push &quot;c:\\blaat&quot;<br />
Call EmptyFolder<br />
<br />
<br />
I hope that helps :)<br />
<br />
evilO/Olive</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gieltje</div><div class="date">2nd April 2004, 17:16</div></div><div class="posttext">it does the correct thing, but wont compile:confused: <br />
  ${If} ${FileExists} &quot;$R0\*.*&quot;                  ; If the current element<br />
that's the line it breaks on:hang:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">2nd April 2004, 22:17</div></div><div class="posttext">You should include LogicLib.nsh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gieltje</div><div class="date">3rd April 2004, 17:02</div></div><div class="posttext">Variable &quot;_LOGICLIB_TEMP&quot; not referenced, wasting memory!<br />
how do I define it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">3rd April 2004, 17:45</div></div><div class="posttext">You don't have to define anything, it can safely be ignored.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gieltje</div><div class="date">3rd April 2004, 19:05</div></div><div class="posttext">damn I hate ignoring errors</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">3rd April 2004, 20:09</div></div><div class="posttext">It's not an error. A variable has been declared but is not used.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gieltje</div><div class="date">4th April 2004, 12:09</div></div><div class="posttext">if I dont include LogicLib.nsh it wont compile so I guess it is being used</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">4th April 2004, 12:45</div></div><div class="posttext">It's a variable that is not used by the part of LogicLib you are using.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gieltje</div><div class="date">22nd September 2004, 08:44</div></div><div class="posttext">${If} ${FileExists} &quot;$R0\*.*&quot;                  ; If the current element is a directory<br />
    ClearErrors<br />
    FindFirst $R1 $R2 &quot;$R0\*.*&quot;                  ; Starts the search<br />
    ${Unless} ${Errors}<br />
      ${Do}<br />
        ${Select} $R2<br />
          ${Case2} &quot;.&quot; &quot;..&quot;                      ; If the current element is '.' or '..' do nothing<br />
          ${CaseElse}                            ; Otherwise<br />
            ${If} ${FileExists} &quot;$R0\$R2\*.*&quot;    ; If the current element is a directory<br />
              Rmdir /r &quot;$R0\$R2&quot;                 ; Removes it<br />
            ${EndIf}<br />
	Delete &quot;$R0\*.*&quot;			 ; Removes every file from the root folder<br />
        ${EndSelect}<br />
        FindNext $R1 $R2                         ; Continues the search<br />
      ${LoopUntil} ${Errors}<br />
      FindClose $R1                              ; Closes the search handle<br />
    ${EndUnless}<br />
  ${EndIf}<br />
<br />
Added a little thing to remove every file in the root folder if anyone is interested</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>