<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Call Abort in custom page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Call Abort in custom page NSIS Discussion" />
	
	<title> Call Abort in custom page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Call Abort in custom page</div>
<hr />
<div class="pda"><a href="t-223010.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=223010">Call Abort in custom page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Sp33dy Gonzale$</div><div class="date">31st July 2005, 19:33</div></div><div class="posttext">Hy I've make an custom page drop list. Now I would, when State=<br />
<br />
I thought that it calls blank? <br />
<br />
It shows a message box with an error to the user.<br />
<br />
How can I do this<br />
<br />
The message box should be have one OK Button</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">31st July 2005, 21:01</div></div><div class="posttext">What I usually do is build the InstallOptions ini to have the first item say something &quot;Please select...&quot;  This helps direct the end-users on what they are supposed to do.<br />
<br />
Example:<br />
 <br />
[Field 1]<br />
Type=Combobox<br />
Text=Combobox<br />
State=Please select something...<br />
ListItems=Please select something...|Selection1|Selection2|Selection3<br />
;    size and position elements have been <br />
;    omitted in this example...<br />
<br />
Then, in your exit function, do something like this:<br />
<br />
ReadIniStr $0 '$PLUGINSDIR\myfile.ini' 'Field 1' 'State'<br />
strcmp $0 'Please select something...' error ok<br />
error:<br />
MessageBox MB_OK &quot;You didn't select anything!&quot;<br />
abort<br />
ok:<br />
; continue your code here</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sp33dy Gonzale$</div><div class="date">1st August 2005, 08:30</div></div><div class="posttext">Hy thank you I've tested it and it works ... but not like it should <br />
<br />
The error Please select something comes too late.<br />
<br />
Can you show what is wrong</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sp33dy Gonzale$</div><div class="date">2nd August 2005, 14:14</div></div><div class="posttext">Please help me.<br />
<br />
There must be an little problem but I don't find it.<br />
<br />
Perhaps you can download the *.rar there is the full code<br />
<br />
<br />
Or I it is enough to help me this is the code which is needed for the Call abort<br />
<br />
The error &quot; Please select something &quot; comes when the MUI_PAGE_INSTFILES page is active and not when I click  next on the Page custom NetsettingsPage.<br />
<br />
<br />
THANK you to all people which help me<br />
<br />
;Reserve File<br />
ReserveFile &quot;netsettings.ini&quot;<br />
<br />
<br />
Page custom NetsettingsPage<br />
; Instfiles page<br />
!insertmacro MUI_PAGE_INSTFILES<br />
<br />
<br />
<br />
; MUI end ------<br />
<br />
Name &quot;${PRODUCT_NAME}&quot;<br />
OutFile &quot;Setup.exe&quot;<br />
InstallDir &quot;$PROGRAMFILES\Droplist&quot;<br />
ShowInstDetails show<br />
ShowUnInstDetails show<br />
<br />
Section &quot;Config &amp; mehr&quot; SEC01<br />
  Call CopyNetsettings<br />
SectionEnd<br />
<br />
Section -AdditionalIcons<br />
  SetOutPath $INSTDIR<br />
  CreateDirectory &quot;$SMPROGRAMS\Droplist&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\Droplist\Website.lnk&quot; &quot;$INSTDIR\${PRODUCT_NAME}.url&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\Droplist\Uninstall.lnk&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
SectionEnd<br />
<br />
Section -Post<br />
  WriteUninstaller &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayName&quot; &quot;$(^Name)&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
SectionEnd<br />
<br />
; Funtions<br />
Function .onInit<br />
<br />
   !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;netsettings.ini&quot;<br />
<br />
FunctionEnd<br />
<br />
; Netsettings Page<br />
Function NetsettingsPage<br />
<br />
   !insertmacro MUI_HEADER_TEXT &quot;Konfiguration des Erweiterungs System&quot; &quot;Wählen Sie, mit welcher Verbindung sie spielen.&quot;<br />
   !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;netsettings.ini&quot;<br />
<br />
FunctionEnd<br />
<br />
!macro COPY_FILES SOURCE<br />
CopyFiles /silent &quot;$INSTDIR\CONFIG &amp; MEHR\Infos\Netsettings\${SOURCE}\netsettings.cfg&quot; &quot;$INSTDIR\CONFIG &amp; MEHR\cstrike&quot;<br />
goto done<br />
!macroend<br />
<br />
; Page Leave Netsettings<br />
<br />
Function CopyNetsettings<br />
<br />
; THIS IS THE NEW CODE<br />
<br />
ReadIniStr $0 '$PLUGINSDIR\netsettings.ini' 'Field 1' 'State'<br />
   strcmp $0 '' no ok<br />
   no:<br />
   MessageBox MB_OK &quot;Sie haben keine Verbindung gewählt!&quot;<br />
   abort<br />
   ok:<br />
   <br />
; THIS IS THE NEW CODE END<br />
<br />
Push $R0<br />
ReadINIStr $R0 &quot;$PLUGINSDIR\netsettings.ini&quot; &quot;Field 1&quot; &quot;State&quot;<br />
StrCmp $R0 &quot;LAN&quot; 0 notLAN<br />
!insertmacro COPY_FILES LAN<br />
<br />
notLAN:<br />
StrCmp $R0 &quot;56K Modem&quot; 0 not56K_Modem<br />
!insertmacro COPY_FILES 56K_Modem<br />
<br />
not56K_Modem:<br />
StrCmp $R0 &quot;ISDN&quot; 0 notISDN<br />
!insertmacro COPY_FILES ISDN<br />
<br />
notISDN:<br />
StrCmp $R0 &quot;D-ISDN&quot; 0 notD-ISDN<br />
!insertmacro COPY_FILES D-ISDN<br />
<br />
notD-ISDN:<br />
StrCmp $R0 &quot;S-DSL&quot; 0 notS-DSL<br />
!insertmacro COPY_FILES S-DSL<br />
<br />
notS-DSL:<br />
StrCmp $R0 &quot;A-DSL&quot; 0 notA-DSL<br />
!insertmacro COPY_FILES A-DSL<br />
<br />
notA-DSL:<br />
StrCmp $R0 &quot;Cable&quot; 0 notCable<br />
!insertmacro COPY_FILES Cable<br />
<br />
notCable:<br />
StrCmp $R0 &quot;Q-DSL&quot; 0 notQ-DSL<br />
!insertmacro COPY_FILES Q-DSL<br />
<br />
notQ-DSL:<br />
StrCmp $R0 &quot;DSL mit FP&quot; 0 done<br />
!insertmacro COPY_FILES DSL_mit_FP<br />
<br />
done:<br />
<br />
Pop $R0<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">3rd August 2005, 04:10</div></div><div class="posttext">The problem is that you are calling your 'CopyNetSettings' function from a section.  Section are only processed during installing file.  That's the reason you only see the error during installing files.<br />
<br />
Take the 'new code' block out of the function 'CopyNetSettings' and make it a funtion on it's own.  Something like this:<br />
<br />
Function LeaveNetSettings<br />
   ReadIniStr $0 '$PLUGINSDIR\netsettings.ini' 'Field 1'  'State'<br />
   strcmp $0 '' no ok<br />
   no:<br />
   MessageBox MB_OK &quot;Sie haben keine Verbindung gewählt!&quot;<br />
   abort<br />
   ok:<br />
FunctionEnd<br />
<br />
<br />
Then, change your custom page call to this:<br />
<br />
Page custom NetsettingsPage LeaveNetSettings<br />
<br />
<br />
&lt;&lt;Edit&gt;&gt;<br />
PS:  Try to refrain from posting entire scripts when they are large.  It makes the forums harder to read.   ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sp33dy Gonzale$</div><div class="date">4th August 2005, 20:16</div></div><div class="posttext">THX IT WORKS</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>