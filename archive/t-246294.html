<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Passing data through to !included files, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Passing data through to !included files NSIS Discussion" />
	
	<title> Passing data through to !included files [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Passing data through to !included files</div>
<hr />
<div class="pda"><a href="t-246294.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246294">Passing data through to !included files</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">surfdabbler</div><div class="date">16th May 2006, 14:19</div></div><div class="posttext">I have a set of similar installations based on one common NSIS script.  Mostly the same fileset, but a different main exe, different product name, different Start Menu name, etc. (i.e. different versions for different customers).<br />
<br />
I use an external script to swap in the appropriate exe to a standard name before running the script.<br />
<br />
I have tried using 2 nsi files, as follows...<br />
<br />
product1.nsi<br />
<br />
!define APP_NAME &quot;Product1&quot;<br />
!include &quot;common.nsi&quot;<br />
<br />
And common.nsi then uses APP_NAME for the Name, install dir, StartMenu naming, etc.  But, APP_NAME doesn't seem to carry through to the second file.  It only works if I define it in common.nsi.  Any hints on how to make this work, or different ways of doing this?<br />
<br />
I've tried using a Var, but it doesn't seem to work either.  I can define &quot;Name&quot; in product1.nsi, and it carries through to common.nsi, but that doesn't do everything I need it to do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">16th May 2006, 18:08</div></div><div class="posttext">compile common.nsi and use a header with all needed info.<br />
i.e. !include header.nsh where header.nsh could be like this:<br />
!define APP_NAME 'my app'<br />
!define VERSION '1.5.0.0'<br />
!define MAIN_EXE 'c:\temp\myapp.exe'<br />
etc</div></div><hr />


<div class="post"><div class="posttop"><div class="username">surfdabbler</div><div class="date">17th May 2006, 00:45</div></div><div class="posttext">Thanks for the reply.<br />
<br />
I don't understand how using a header file allows me to select at compile time which values to use.  I would have to somehow selectively include one of several different .nsh files, or write several common.nsi files to include the different headers, which defeats the whole purpose of common.nsi.<br />
<br />
My external shell script knows about the different versions, but how can this information be handled in the NSI scripting?<br />
<br />
The shell script can copy the appropriate product1.nsh or product2.nsh to a standard name, product.nsh, and common.nsi can include product.nsh, but surely there's a nicer way...?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">17th May 2006, 01:41</div></div><div class="posttext">One thing that I do is create a separate EXE using an NSIS script that generates an custom page that asks the user options he/she wants to use.  This EXE would then create a header file  on the fly.<br />
<br />
Then, in your main script, add the following lines of code:<br />
<br />
!system &quot;SelectBuild.exe&quot;  ### this is the name of your EXE<br />
!include &quot;ProductVersion.nsh&quot;  ### this is the header that is created<br />
; the rest of your code goes here...<br />
<br />
<br />
The attached sample script helps illustrate the header creation file.<br />
<br />
Anther option:<br />
Pass a define using the '/d' command on MakeNSIS.exe and then use !ifdef blocks for each of your products.<br />
<br />
For more ideas, have a look at the NSIS help manual, compile-time commands (chapter 5)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">17th May 2006, 05:53</div></div><div class="posttext">I don't understand how using a header file allows me to select at compile time which values to use. I would have to somehow selectively include one of several different .nsh files, or write several common.nsi files to include the different headers, which defeats the whole purpose of common.nsi.<br />
use !ifdef on header.nsh<br />
<br />
!ifdef PROG_1<br />
&lt;include this and that&gt;<br />
!endif<br />
<br />
!ifdef PROG_2<br />
..............<br />
!endif<br />
<br />
and in nsi file:<br />
!define PROG_1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">surfdabbler</div><div class="date">17th May 2006, 06:15</div></div><div class="posttext">This goes back to my original solution of having multiple main files, that include common.nsi.  And after trying this for several hours yesterday, I tried it again today, and it actually works now.  I don't know what's different, but it is all good.  Thanks for your help!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>