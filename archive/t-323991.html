<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" CreateShortCut Vista Issue, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  CreateShortCut Vista Issue NSIS Discussion" />
	
	<title> CreateShortCut Vista Issue [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  CreateShortCut Vista Issue</div>
<hr />
<div class="pda"><a href="t-323991.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=323991">CreateShortCut Vista Issue</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">HondaGuy</div><div class="date">12th November 2010, 15:42</div></div><div class="posttext">I apologize if this has been answered before.  I searched the forum, but didn't find anything exactly like this.<br />
<br />
My 'Modern UI' EXE install runs fine on XP.  On Vista it runs fine except that it does not create the desktop shortcut unless I right-click the EXE and 'Run as Administrator'.  (I am logged in as a user with Admin priviledges.)  I thought maybe I needed the NSIS UAC plugin so the script could create the shortcut as Administrator, but after downloading and reading everything, sounds like the user running the install needs the desktop shortcut, not the Administrator, which is the way it is already configured.  The user I am logged in as when I run the install can manually create desktop shortcuts without a problem.  The script has the code to request user application privileges:<br />
<br />
;Request application privileges for Windows Vista<br />
RequestExecutionLevel user<br />
<br />
So I'm confused.  Any help would be appreciated.  Haven't tried it on Windows 7, but am guessing the same issue would occur.  This is NSIS version 2.46.<br />
<br />
Thanks,<br />
Ken</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">12th November 2010, 16:11</div></div><div class="posttext">Did you call &quot;SetShellVarContext all&quot;? If not, CreateShortcut on $desktop should work with &quot;RequestExecutionLevel user&quot; unless the desktop directory is otherwise locked down.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">HondaGuy</div><div class="date">12th November 2010, 16:26</div></div><div class="posttext">Yes, this is the standard 'Modern UI' example script and it has:<br />
<br />
SetShellVarContext all<br />
<br />
Should that be removed in this case?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">12th November 2010, 16:44</div></div><div class="posttext">Well, yes, &quot;SetShellVarContext all&quot; turns $desktop into c:\programdata\... or whatever (all users folder on &lt; Vista, and you need to be admin to write there)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">HondaGuy</div><div class="date">12th November 2010, 17:15</div></div><div class="posttext">Sorry to be so dense, but are you saying SetShellVarContext functions differently between XP and Vista? Just to clarify, here's the section that creates the desktop shortcut in XP.  So if I remove the SetShellVarContext, it should work in both XP and Vista because $DESKTOP doesn't get changed?  Just confused about why it works in XP if $DESKTOP is changed by SetShellVarContext.  Thanks.<br />
 <br />
Section &quot;myApp v0.45&quot; SecInst<br />
SetShellVarContext all<br />
CreateDirectory &quot;\myApp&quot;<br />
SetOutPath &quot;$INSTDIR&quot;<br />
;Store installation folder<br />
WriteRegStr HKCU &quot;Software\myApp&quot; &quot;&quot; $INSTDIR<br />
;Create uninstaller<br />
WriteUninstaller &quot;$INSTDIR\Uninstall.exe&quot;<br />
; create the desktop shortcut<br />
CreateShortCut &quot;$DESKTOP\myApp.lnk&quot; &quot;$INSTDIR\myApp.jar&quot; &quot;&quot; &quot;$INSTDIR\myApp.ico&quot;<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th November 2010, 18:16</div></div><div class="posttext">Don't use SetShellVarContext all. Also why do you have CreateDirectory &quot;\myApp&quot;? You should never use relative paths.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">12th November 2010, 18:20</div></div><div class="posttext">Sorry to be so dense, but are you saying SetShellVarContext functions differently between XP and Vista? <br />
<br />
No it works exactly the same, you just failed to test on XP as non admin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">HondaGuy</div><div class="date">12th November 2010, 18:43</div></div><div class="posttext">Actually, the test I did on XP was done the same way as the test I did on Vista.  As a standard user, but with 'Computer Administrator' privileges.  That's why I was confused about the inconsistent results.  I'll remove 'SetShellVarContext all' and start another round of testing.  (Thought I started with one of the Modern UI examples, but none of them use that command, so not sure where I got the code that has it.  Has been a while since I built the script and it has been working for everyone doing XP installs.)<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">12th November 2010, 22:54</div></div><div class="posttext">&quot;As a standard user, but with 'Computer Administrator' privileges&quot; what does that even mean? A standard (aka limited, normal) user is not a member of the administrators group.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">HondaGuy</div><div class="date">12th November 2010, 23:05</div></div><div class="posttext">Start/Control Panel/User Accounts<br />
<br />
Looking at the user which is logged on and running the install script:<br />
<br />
jsmith<br />
Computer Administrator<br />
Password Protected<br />
<br />
This is XP.  I'll have to check the Vista machine which had the issue (can't get to it until Monday), but I purposely set it up the same way, so I would expect similar attributes for the user.  Administrator privileges means that it is a user other than 'Administrator' which has been given the 'Computer administrator' type instead of 'Limited' type.  (Those are the only 2 options at account setup.)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>