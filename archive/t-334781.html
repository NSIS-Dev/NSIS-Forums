<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" value of user_var in a !define, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  value of user_var in a !define NSIS Discussion" />
	
	<title> value of user_var in a !define [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  value of user_var in a !define</div>
<hr />
<div class="pda"><a href="t-334781.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=334781">value of user_var in a !define</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">zackbuffo</div><div class="date">15th September 2011, 15:42</div></div><div class="posttext">Is there any possibility to put the value of user_var in a !define and vice versa?<br />
StrCpy doesn't work with defines.<br />
<br />
I have to call a function out of a DLL-file, that needs a !define as a parameter, but I have to read the value out of an INI-file before. ReadINIStr works only with a user_var.<br />
<br />
At first, with a define right into the push-string (1. parameter for CallInstDLL) it looked like this (and worked fine):<br />
<br />
!define XYZ<br />
...<br />
Push &quot;$$$$XYZ$$$$=${XYZ}&quot;<br />
CallInstDLL Some.dll function<br />
<br />
I tried it this way, but that doesn't work:<br />
<br />
Var /GLOBAL setXYZ<br />
ReadINIstr $setXYZ ...<br />
...<br />
Push &quot;$$$$XYZ$$$$=$setXYZ&quot;<br />
CallInstDLL Some.dll function<br />
<br />
I can't change the $-inferno because it is needed for the called function/DLL and the corresponding XML file. <br />
<br />
Any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">15th September 2011, 17:03</div></div><div class="posttext">Try it like this:Var /GLOBAL setXYZ<br />
ReadINIstr $setXYZ ...<br />
...<br />
Strcpy $0 &quot;$$$$XYZ$$$$=$setXYZ&quot;<br />
Push $0<br />
CallInstDLL Some.dll function<br />
(You may have to escape the $ inferno, especially if there is a variable $XYZ).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">15th September 2011, 17:41</div></div><div class="posttext">I have to call a function out of a DLL-file, that needs a !define as a parameter, but I have to read the value out of an INI-file before. ReadINIStr works only with a user_var.<br />
This is wrong. When you call a dll function, it needs parameters. These parameters can be any string/integer. The DLL doesn't care how the parameter is passed, as long as it gets it. So despite what you think, what you need to do is simply use readinistr, and then use the returned string (in a user var!) as the parameter in your DLL.<br />
<br />
<br />
As for defines versus variables, you are confused about the difference between compiletime and runtime. I suggest you google it and find out what the difference is.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zackbuffo</div><div class="date">19th September 2011, 10:23</div></div><div class="posttext">&quot;Worst case&quot; happened: I tried my code the other day, using the user_var version and it did work. I have no clue, what went wrong before I started this thread. I didn't change anything. :igor:<br />
<br />
@MSG: I'm aware of the difference between run- and compiletime. But while playing around with NSIS scripting, in some situations I would prefer the possibility to pass a !define value over to a user_var to use it during compile- and runtime instead of initializing it twice.<br />
<br />
At least this possibility would make sense for me - disregarding possible compiling-issues, that I don't know yet. Maybe someone can tell a little bit about what's going on under the hood, while NSIS is compiling...?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">19th September 2011, 12:03</div></div><div class="posttext">When the precompiler finds a reference to a !defined value, in the form of ${DefineName}, it simply replaces the &quot;${DefineName}&quot; text with whatever the define was !defined as. Example:<br />
<br />
Precompiler sees (in the nsi script):<br />
!define SomeDefine `bar`<br />
StrCpy $YourVar &quot;foo ${SomeDefine}&quot;<br />
<br />
Compiler sees (after precomilation):<br />
StrCpy $YourVar &quot;foo bar&quot;<br />
<br />
As you can see, the compiler never even gets to see any defines. The precompiler simply replaces them with their defined text contents. This is why your question about putting defines into variables doesn't make any sense: At runtime, which is when variables are being used, there ARE no defines. There are only strings, and other variables.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>