<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with custom DLL when installing on different computer, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with custom DLL when installing on different computer NSIS Discussion" />
	
	<title> Problem with custom DLL when installing on different computer [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with custom DLL when installing on different computer</div>
<hr />
<div class="pda"><a href="t-322153.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322153">Problem with custom DLL when installing on different computer</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">rmacyn</div><div class="date">2nd September 2010, 07:44</div></div><div class="posttext">Hi All,<br />
<br />
I'm having some issues with NSIS executing a DLL function that works fine when I test the installer locally (Win7-64) but fails when the installer is run on a different computer (Win7-64).<br />
<br />
Basically, I have a simple DLL function that returns &quot;Hello&quot; on the stack as follows:<br />
<br />
Function .onInit<br />
	InitPluginsDir	<br />
<br />
	MyDll::Hello<br />
	Pop $R0<br />
	MessageBox MB_ICONEXCLAMATION $R0<br />
	Abort<br />
FunctionEnd<br />
<br />
This code works fine if I run the installer on the machine that I created the installer on (locally).<br />
<br />
However, if I run that same generated installer on a different machine, it appears that the MyDll::Hello is either not called or is not returning anything on the stack. In this case, $R0 contains &quot;&quot;.<br />
<br />
Doesn't the NSIS compiler automatically pull in all dlls that are called via DLL::FUNCTION calls?<br />
<br />
Any help would be greatly appreciated!!<br />
<br />
-rmacyn</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">2nd September 2010, 08:32</div></div><div class="posttext">i'd use http://www.dependencywalker.com/ to see what dll's you plug-in depends upon to run as i wouldn't be surprised if the non-development machine doesn't have them (like using a debug release mode when building the plug-in).<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rmacyn</div><div class="date">2nd September 2010, 09:57</div></div><div class="posttext">DrO, you're a genius!!<br />
<br />
That Dependency Walker tool is awesome!! I ran the tool and right away it told me which DLL I was missing !!!<br />
<br />
Thank you for the help... you're a real lifesaver!!<br />
<br />
-rmacyn</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>