<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Ask user about desktop shortcut?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Ask user about desktop shortcut? NSIS Discussion" />
	
	<title> Ask user about desktop shortcut? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Ask user about desktop shortcut?</div>
<hr />
<div class="pda"><a href="t-289335.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289335">Ask user about desktop shortcut?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">creatman</div><div class="date">30th March 2008, 15:41</div></div><div class="posttext">Hi!<br />
<br />
I am novice in Installation development and have following problem:<br />
I need to ask user about creation of the desktop shortcut of my application on his deskstop. Is there any standard way to do this? Some example script which demonstrates such behavior would be a perfect. I didn't find some on NSIS page :(<br />
I add pages as follows:<br />
<br />
  !insertmacro MUI_PAGE_WELCOME<br />
  !insertmacro MUI_PAGE_LICENSE &quot;license.rtf&quot;<br />
  <br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_PAGE_FINISH<br />
<br />
  !insertmacro MUI_UNPAGE_WELCOME<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_UNPAGE_INSTFILES<br />
  !insertmacro MUI_UNPAGE_FINISH<br />
<br />
Alex.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">30th March 2008, 16:07</div></div><div class="posttext">You could use MUI_FINISHPAGE_RUN_FUNCTION for this, (see MUI documentation) or build a custom page if you prefer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">creatman</div><div class="date">30th March 2008, 18:42</div></div><div class="posttext">Thanks! <br />
<br />
<br />
I tryied to make this by following code:<br />
<br />
<br />
  ; 2 Checkboxes for Quick launch and Desktop.<br />
  !define MUI_PAGE_CUSTOMFUNCTION_PRE CreateControls<br />
  !define MUI_PAGE_CUSTOMFUNCTION_SHOW SetControlColours<br />
  !define MUI_PAGE_CUSTOMFUNCTION_LEAVE DisplayQuickLaunchAndDesktopIcon<br />
  !insertmacro MUI_PAGE_FINISH<br />
<br />
.....<br />
<br />
Function CreateControls<br />
<br />
  ; Quicklaunch short cut.<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Settings&quot; &quot;NumFields&quot; &quot;6&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Type&quot; &quot;CheckBox&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Text&quot; &quot;&amp;Add to quick launch&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Left&quot; &quot;120&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Right&quot; &quot;-10&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Top&quot; &quot;130&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Bottom&quot; &quot;142&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;State&quot; &quot;1&quot;<br />
<br />
  ; Desktop short cut.<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Settings&quot; &quot;NumFields&quot; &quot;7&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Type&quot; &quot;CheckBox&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Text&quot; &quot;&amp;Add to desktop&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Left&quot; &quot;120&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Right&quot; &quot;-10&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Top&quot; &quot;144&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Bottom&quot; &quot;156&quot;<br />
  WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;State&quot; &quot;1&quot;<br />
  <br />
FunctionEnd<br />
<br />
Function SetControlColours<br />
  ReadINIStr $0 &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;HWND&quot;<br />
  SetCtlColors $0 0x000000 0xFFFFFF<br />
  ReadINIStr $0 &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;HWND&quot;<br />
  SetCtlColors $0 0x000000 0xFFFFFF<br />
FunctionEnd<br />
<br />
Function DisplayQuickLaunchAndDesktopIcon<br />
  ReadINIStr $0 &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;State&quot;<br />
  StrCmp $0 &quot;0&quot; end<br />
	CreateShortCut &quot;$QUICKLAUNCH\${prodname}.lnk&quot; &quot;$INSTDIR\${exec}&quot; &quot;&quot; &quot;$INSTDIR\${icon}&quot;<br />
  end:<br />
  ReadINIStr $0 &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;State&quot;<br />
  StrCmp $0 &quot;0&quot; finish<br />
    CreateShortCut &quot;$DESKTOP\${prodname}.lnk&quot; &quot;$INSTDIR\${exec}&quot; &quot;&quot; &quot;$INSTDIR\${icon}&quot;<br />
  finish:<br />
FunctionEnd<br />
<br />
<br />
<br />
That's ok for me, but there is another problem: two these checkboxes appear not instantly on FINISH_PAGE is shown, but  after some timeout or thay can appear only when I move mouse over the finish page window. What I did wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th March 2008, 18:48</div></div><div class="posttext">Sounds like another control such as a label is covering them up.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">creatman</div><div class="date">30th March 2008, 19:00</div></div><div class="posttext">and then what can be done to make it ok?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th March 2008, 19:08</div></div><div class="posttext">Check the ioSpecial.ini file at run time to identify which other field has a Bottom value that is negative or over 130.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">30th March 2008, 23:04</div></div><div class="posttext">Why not use the standard finish page checkboxes?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">creatman</div><div class="date">30th March 2008, 23:44</div></div><div class="posttext">Unfortunatly, I didn't see them on default finish page. How make them active and visible? Is there any example maybe?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">31st March 2008, 03:01</div></div><div class="posttext">Check the Modern UI Readme for the finish page settings to enable them. The default functions run an application or show a Readme file when the box is checked, but with custom functions you can link any action you want.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Daniel James</div><div class="date">31st March 2008, 12:31</div></div><div class="posttext">Originally posted by creatman <br />
I need to ask user about creation of the desktop shortcut of my application on his deskstop. Is there any standard way to do this? <br />
If you had a components page you could just put the code to create the shortcut in a separate section, and it would automatically appear among the components to be installed, with a checkbox the user could select or clear. It's probably a bit much to add a components page when the only options are &quot;The application&quot; and &quot;A desktop shortcut&quot;!<br />
<br />
Another very easy approach would be to use a YES/NO MessageBox to ask the question. It wouldn't look quite a neat as, for example, adding a checkbox to the finish page, but would be really easy.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mauvecloud</div><div class="date">3rd April 2008, 16:35</div></div><div class="posttext">I know how to offer desktop shortcuts in place of the readme, but I'm puzzled that Modern UI doesn't already allow a third checkbox for desktop shortcuts. Can someone explain that?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>