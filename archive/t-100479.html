<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Killing all explorer windows, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Killing all explorer windows NSIS Discussion" />
	
	<title> Killing all explorer windows [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Killing all explorer windows</div>
<hr />
<div class="pda"><a href="t-100479.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=100479">Killing all explorer windows</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">o_cee</div><div class="date">19th August 2002, 16:32</div></div><div class="posttext">I guess this has been discussed before, but I can't find anything about this here (seems like stuff gets deleted pretty quick).<br />
<br />
The problem is that I need to replace a .dll file that's used by the shell. In order to release it, all regentries are deleted, but sometimes open explorer windows also needs to be closed in order to delete the file.<br />
<br />
I don't know what to search for when using FindWindow. Or is this better done with an external dll?<br />
<br />
I could really need some help here :)<br />
<br />
o_cee</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th August 2002, 18:26</div></div><div class="posttext">Nothing gets deleted around here... Search the forum and you will find it if it has been discussed.<br />
<br />
As far as I know there is no peacful way of restarting explorer. Most things that you think require explorer to be restarted can be done without it, especially in Windows NT and above. Try searching the web, I am sure you will not end up empty ended.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_cee</div><div class="date">19th August 2002, 22:01</div></div><div class="posttext">Well, I really don't need to restart explorer, just close down any active file browsing windows. (The dll is a plugin that acts on files right click menu, thus beeing activated when a file browser is open..)<br />
<br />
No ideas? I don't need to close explorer.exe, not the entire process, just the filebrowsers.. Hope you understand what I mean.<br />
<br />
<br />
o_cee</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th August 2002, 22:13</div></div><div class="posttext">In that case all you need is a loop that finds any explorer windows (using FindWindow) and then send them WM_CLOSE. To find out the class name of explorer windows use Win32Spy (http://www.gena01.com/win32spy/). Both Windows XP and 98 explorer class name is &quot;CabinetWClass&quot; so it is a safe bet it is the same in all other versions of windows. I am not sure though that it is not used with any other windows... To find out the value of WM_CLOSE just use WinMessages.NSH. It defines all of Windows messages (SendMessage $R0 ${WM_CLOSE} 0 0).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_cee</div><div class="date">20th August 2002, 10:20</div></div><div class="posttext">Still don't get it right.<br />
<br />
!Include WinMessages.NSH<br />
Name &quot;&quot;<br />
OutFile &quot;exrunning.exe&quot;<br />
Section &quot;Explorer running?&quot;<br />
FindWindow $R0 ExploreWClass<br />
IsWindow $R0 ExRunning<br />
Abort<br />
ExRunning:<br />
MessageBox MB_OK &quot;ex running&quot;<br />
SendMessage $R0 ${WM_CLOSE} 0 0<br />
SectionEnd<br />
<br />
Win32Spy gives me &quot;ExploreWClass&quot; wich also is found by NSIS. But it doesn't accept the close command beeing sent anyway, absolutely nothing happens. Is there some difference with Windows XP?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th August 2002, 11:35</div></div><div class="posttext">Closing explorer windows doesn't work on Windows XP either...<br />
<br />
I will keep looking.<br />
<br />
Have you tried using UnregDll?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_cee</div><div class="date">20th August 2002, 15:43</div></div><div class="posttext">Yeah, but it still won't del the .dll if any windows are open.. <br />
<br />
Thanks for the help<br />
<br />
<br />
o_cee</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th August 2002, 18:27</div></div><div class="posttext">I am sorry but I have no more ideas... Try searching the web, I have no other suggestions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_cee</div><div class="date">22nd August 2002, 15:35</div></div><div class="posttext">I got a suggestion from a friend wich solved it.<br />
<br />
SendMessage $R0 ${WM_SYSCOMMAND} 0xF060 0<br />
<br />
0xF060 is SC_CLOSE.<br />
<br />
<br />
:)<br />
<br />
o_cee</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>