<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS installer causes APPDATA variable to disappear from environment, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS installer causes APPDATA variable to disappear from environment NSIS Discussion" />
	
	<title> NSIS installer causes APPDATA variable to disappear from environment [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS installer causes APPDATA variable to disappear from environment</div>
<hr />
<div class="pda"><a href="t-335565.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=335565">NSIS installer causes APPDATA variable to disappear from environment</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">forest_gump</div><div class="date">4th October 2011, 06:15</div></div><div class="posttext">I'm facing a very unusual problem that occurs on a few PCs only, and don't have a clue on where to begin. I have an NSIS based installer which uses the following plugins and runs in admin mode.<br />
<br />
!include MUI2.nsh<br />
!include LogicLib.nsh<br />
!include Library.nsh<br />
!include EnvVarUpdate.nsh<br />
!include &quot;winmessages.nsh&quot;<br />
<br />
On some PCs, the windows APPDATA environment variable &quot;goes away&quot; from explorer.exe's environment space when my installer has completed running i.e. we cannot echo it anymore on a new cmd shell started after the installer is complete. The only way to get it back is to kill explorer.exe and restart it or reboot the PC. Note, my installer does not use APPDATA directly at all.<br />
This is reproducible every time on certain PCs. so far I've observed this on XP PCs only. We think some shell extension is corrupting environment space but can't figure out which one. Clearly NSIS or one of it's extensions seems to be playing a role in corrupting the environment space. What could be going on behind the scenes that could cause such a behavior ? Can anyone please help ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">forest_gump</div><div class="date">4th October 2011, 06:16</div></div><div class="posttext">Oh, I forgot to say that I'm using NSIS 2.46 (large).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">forest_gump</div><div class="date">6th October 2011, 00:22</div></div><div class="posttext">can anyone please help give a clue ? is this a known issue ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th October 2011, 12:07</div></div><div class="posttext">If it's a known issue then you will find it by searching. Otherwise, it must be something in your script.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">6th October 2011, 20:50</div></div><div class="posttext">Well it's not that it MUST be something in the script, but it probably is. Please supply us with a minimal script that reproducibly shows this problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">7th October 2011, 08:19</div></div><div class="posttext">I'm guessing !include EnvVarUpdate.nsh and its code is the problem, generally the env. scripts on the wiki are unsafe</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>