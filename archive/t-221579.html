<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Script to execute a bat, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Script to execute a bat NSIS Discussion" />
	
	<title> Script to execute a bat [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Script to execute a bat</div>
<hr />
<div class="pda"><a href="t-221579.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221579">Script to execute a bat</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Guillaume.L</div><div class="date">16th July 2005, 02:40</div></div><div class="posttext">I suck at scripting... but I need a script to execute a .bat file after extracting everything. Can anyone help me?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">16th July 2005, 06:38</div></div><div class="posttext">Just use Exec or ExecShell in a section or function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">16th July 2005, 07:20</div></div><div class="posttext">To hide DOS window use nsExec (nsis\contrib\nsexec) or ExecDos (http://forums.winamp.com/showthread.php?postid=1587794#post1587794). Anders' remark in the ExecDos thread about bat files execution is important.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guillaume.L</div><div class="date">16th July 2005, 17:16</div></div><div class="posttext">Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guillaume.L</div><div class="date">16th July 2005, 17:24</div></div><div class="posttext">Is there a way to make sure that the files get extracted in a precice folder? Because the paths in the .bat needs it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th July 2005, 17:28</div></div><div class="posttext">Use SetOutPath first.<br />
..or..<br />
for single files you can use:<br />
File &quot;/oname=$INSTDIR\file.ext&quot; &quot;localfile.ext&quot;<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guillaume.L</div><div class="date">16th July 2005, 22:13</div></div><div class="posttext">One last thing... how can I make this work?<br />
ExecShell &quot;at 00:00 /every:Su,M,T,W,Th,F,S &quot;cd $INSTDIR | .\update.bat&quot;&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">16th July 2005, 22:55</div></div><div class="posttext">The ExecShell command is used to execute Windows shell commands, which appear in the &quot;right-click&quot; menu--things such as &quot;open&quot;, &quot;print&quot;, etc. <br />
<br />
So, to run a batch file, it would be something like this:<br />
<br />
ExecShell &quot;open&quot; &quot;C:\path\update.bat&quot;<br />
<br />
<br />
But looking at your example, it seems that that you also want to run this as batch file as a scheduled task.  The only way that I know of doing this is to incorporate this into Windows as a scheduled task.  This means that you're going to have to make some type of API call or call to an external EXE that will set this up. <br />
<br />
Take a look at this forum topic to get some more information about setting up scheduled tasks in Windows:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=147686&amp;highlight=task</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guillaume.L</div><div class="date">17th July 2005, 01:26</div></div><div class="posttext">Thank you very much!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">17th July 2005, 12:20</div></div><div class="posttext">Well, 'at' is a command-line executable so you just need to call it with %COMSPEC%:<br />
<br />
ReadEnvStr $R0 COMSPEC<br />
nsExec::Exec '&quot;$R0&quot; /C at 00:00 /every:Su,M,T,W,Th,F,S &quot;cd $INSTDIR | .\update.bat&quot;'<br />
<br />
Edit: However, I don't think at.exe is on Win9x therefore the Scheduled Tasks link will be bettr.<br />
<br />
.bat files are not a registered Windows Shell file type as they are part of DOS/CMD. Therefore you do not need to use ExecShell on them - they act like an exe, hence why you can even use them for Shell on other file types.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guillaume.L</div><div class="date">17th July 2005, 14:58</div></div><div class="posttext">I used the Scheduled Task plugin :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>