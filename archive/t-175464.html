<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Checking whether 98 or 98SE?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Checking whether 98 or 98SE? NSIS Discussion" />
	
	<title> Checking whether 98 or 98SE? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Checking whether 98 or 98SE?</div>
<hr />
<div class="pda"><a href="t-175464.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=175464">Checking whether 98 or 98SE?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">janedoe2003</div><div class="date">5th April 2004, 22:01</div></div><div class="posttext">Hi<br />
<br />
Since 98 seems to not like my installing MSINET.OCX and MSCOMCTL.OCX while I can't reproduce this error with 98SE over here, I was wondering it someone knew of a way to tell which version of 98 the user has?<br />
<br />
For those interested, at best, regsvr32 fails, at worst, I get a GPF in KERNEL.DLL. I guess it's yet another bug of 98.<br />
<br />
Thank you<br />
JD.<br />
<br />
PS: May I piggy-back on this message while I'm at it? :-)<br />
<br />
1. I'd like to compare the version number of an OCX with the information that I listed in a INI file, and _only download + register if the one currently installed is older_ to avoid a needless download.<br />
<br />
Does anyone know how to do this, without first downloading the latest and greatest from our site?<br />
<br />
2. Can you confirm that the File instruction doesn't allow variables?<br />
<br />
;Input : $5 = name of file<br />
Function Check<br />
	SetOutPath $SYSDIR<br />
	;Compile error	<br />
	File &quot;d:\temp\$5&quot;<br />
	ClearErrors<br />
	RegDLL $SYSDIR\$5<br />
	IfErrors 0 end<br />
	MessageBox MB_OK &quot;Error registering $5&quot;<br />
end:<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">5th April 2004, 22:33</div></div><div class="posttext">1) Combine UpgradeDLL with NSISdl. I think there is not a ready-to-use example yet.<br />
<br />
2) If you are using variables, how should the compiler know what files to include? Use the /oname switch for the location.<br />
<br />
3) Search Google for possible information about this version conflict with Windows 98. Make sure you have the latest version of the OCX files. If you really want to detect the edition use the build number in the registry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">janedoe2003</div><div class="date">6th April 2004, 00:31</div></div><div class="posttext">Thx Joost for the prompt answer :-)<br />
<br />
&gt;&gt; I think there is not a ready-to-use example yet.<br />
<br />
Too bad. I'll see if I can find a way to avoid downloading a file needlessly.<br />
<br />
&gt;&gt; If you are using variables, how should the compiler know what files to include? Use the /oname switch for the location.<br />
<br />
Too bad again that File can't use variables. Not sure why you mentionned the /oname switch though, as the error is the second parameter, ie. the following is NOK:<br />
<br />
<br />
;Input : $R0 is the name of the file to handle<br />
Function Check<br />
    SetOutPath $SYSDIR<br />
<br />
    ;Doesn't work<br />
    File &quot;d:\temp\$R0&quot;<br />
    <br />
    ;Doesn't work any better<br />
    File /oname=&quot;$R0&quot; &quot;d:\temp\$R0&quot;<br />
<br />
    ;Works<br />
    File &quot;d:\temp\myfile.dll&quot;<br />
<br />
    ClearErrors<br />
    RegDLL $SYSDIR\$R0<br />
    IfErrors 0 end<br />
        MessageBox MB_OK &quot;Erreur enregistrement $R0&quot;<br />
end:<br />
FunctionEnd<br />
<br />
<br />
&gt;&gt; 3) Search Google for possible information about this version conflict with Windows 98. Make sure you have the latest version of the OCX files.<br />
<br />
Thx for the tip. For those interested, the GetWindowsVersion() NSIS function looks up version info fro the Registry. I'll try to find a CD of 98 tomorrow and see if this function returns something different when running under 98 and 98SE.<br />
<br />
BTW, installing the latest and greatest OCX is precisely what 98 doesn't seem to like :-) Hence the need to distinguish between those two versions and avoid a GPF.<br />
<br />
Thx again<br />
JD.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">6th April 2004, 14:23</div></div><div class="posttext">It is possible to create a system with a online INI/data file with versions. It does require some script writing.<br />
<br />
The compiler includes a file in your installer. If you use a variable that can have any value, it doesn't know what files to include. Or do you want it to include your whole hard drive? :)<br />
<br />
GetWindowsVersion does not check the build number, it returns the same for 98 and 98SE.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">janedoe2003</div><div class="date">6th April 2004, 17:42</div></div><div class="posttext">&gt;&gt; It is possible to create a system with a online INI/data file with versions. It does require some script writing.<br />
<br />
If someone already has some enhanced UpgradeDLL code to let me check the version of an existing file on the user's HD again some version info without first downloading the possibly newer file, I'm interested :-)<br />
<br />
&gt;&gt; The compiler includes a file in your installer. If you use a variable that can have any value, it doesn't know what files to include. Or do you want it to include your whole hard drive?<br />
<br />
I'd agree if the filename were entered at runtime through the equivalent of eg. VB's InputBox(), but in this casse, the filenames are in the source code, so it seems to me that it should be possible to use File in such a case. But then, it's not a big issue, such a convenience.<br />
<br />
&gt;&gt; GetWindowsVersion does not check the build number, it returns the same for 98 and 98SE<br />
<br />
I found an old CD of the original version of 98. For those interested, the Registry shows a distinct build number, so  a little bit of hacking in GetWindowsVersion() will enable you to discriminate the two.<br />
<br />
Thank you<br />
Fred.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">6th April 2004, 19:06</div></div><div class="posttext">Variables can have any value. There is no way the compiler can detect which values it might have.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">janedoe2003</div><div class="date">6th April 2004, 19:57</div></div><div class="posttext">Thx for the tip :-)<br />
<br />
One last question so I can move on to the UpgradeDLL part: I can't figure out the difference between GetDLLVersion() and GetDLLVersionLocal().<br />
<br />
Is the former only allowed at runtime, while the latter is only allowed during compiling? I didn't find much infos in either the examples or the archives here, hence my question.<br />
<br />
Thank you<br />
JD.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">6th April 2004, 20:30</div></div><div class="posttext">The Local one is for the compiler system, it is actually being converted to two StrCpy commands that set two variables.<br />
<br />
With the value of the Local command (which is the version on your system), you can compare the version on the user's system using the other command.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">janedoe2003</div><div class="date">6th April 2004, 20:43</div></div><div class="posttext">OK, so the Local version is a way to hold a copy of the version of a DLL inside the generated EXE, so I can compare this info with the same DLL on the customer's host when he runs the EXE. Makes sense :-)<br />
<br />
Thank you for your help<br />
JD.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>