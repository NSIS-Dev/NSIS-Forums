<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Instr-Function in NSIS?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Instr-Function in NSIS? NSIS Discussion" />
	
	<title> Instr-Function in NSIS? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Instr-Function in NSIS?</div>
<hr />
<div class="pda"><a href="t-271262.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=271262">Instr-Function in NSIS?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">phisuio</div><div class="date">16th May 2007, 18:52</div></div><div class="posttext">Hi,<br />
I have some Basic code and wonder, how to port it to NSIS:<br />
<br />
dim x as string<br />
dim y as integer<br />
x = &quot;123456&quot;<br />
y = instr(1,x,&quot;23&quot;)<br />
<br />
so y is the position of the signs 23, but how to realize this in NSIS?<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">phisuio</div><div class="date">16th May 2007, 22:32</div></div><div class="posttext">Anyone? I am under high time pressure, any tips are welcome!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">phisuio</div><div class="date">16th May 2007, 22:45</div></div><div class="posttext">Hi, found out myself:<br />
<br />
!include &quot;StrFunc.nsh&quot;<br />
${StrLoc}<br />
...<br />
${StrLoc} $TempPath &quot;This is just an example&quot; &quot;just&quot; &quot;&lt;&quot;<br />
...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">phisuio</div><div class="date">16th May 2007, 22:56</div></div><div class="posttext">btw: anyone has an idea, how to find the second appearence of a string in another string? for example:<br />
string = &quot;Test Test Test&quot;<br />
searchString = &quot;Test&quot;<br />
should say position is 6, because the second string starts at this position.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">17th May 2007, 04:25</div></div><div class="posttext">${StrStrAdv} should do the trick.  See the ${NSISDIR}\Docs\StrFunc for details.<br />
<br />
You might also take a look at the Word Functions (http://nsis.sourceforge.net/Docs/AppendixE.html#E.3) in Appendix E of the NSIS help files for other string manipulation functions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">phisuio</div><div class="date">17th May 2007, 06:46</div></div><div class="posttext">Hi, thanks a lot for this help.<br />
Now I have a string to a path:<br />
&quot;C:\Program Files\Program<br />
but the first char is a &quot;, I want to remove this, I thought of either using a Replace or Trim function. My replace function:<br />
${StrRep} $tempPath $tempPath &quot;&quot;&quot; &quot;&quot;<br />
but it gives an error, since I have &quot; as a value of the function, any idea?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">srinannapa</div><div class="date">17th May 2007, 09:33</div></div><div class="posttext">Hi ,<br />
<br />
I'm using NSIS,<br />
When i call StrLoc i'm getting error <br />
<br />
Error: resolving install function &quot;StrLoc&quot; in function &quot;InstallJavaPageLeave&quot;<br />
Note: uninstall functions must begin with &quot;un.&quot;, and install functions must not<br />
Error - aborting creation process<br />
<br />
I'm calling StrLoc like below:<br />
-------------------------------<br />
<br />
!include &quot;LogicLib.nsh&quot;<br />
!include &quot;StrFunc.nsh&quot;<br />
<br />
Push &quot;This is just an example&quot;<br />
Push &quot;just&quot;<br />
Push &quot;&lt;&quot;<br />
Call StrLoc<br />
Pop $0<br />
<br />
<br />
<br />
Thanks in advance,<br />
Srinivas N</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">17th May 2007, 10:40</div></div><div class="posttext">You should review the StrFunc documentation, e.g.<br />
<br />
!include &quot;StrFunc.nsh&quot;<br />
${StrLoc}<br />
<br />
........<br />
<br />
section<br />
${StrLoc} $0 &quot;This is just an example&quot; &quot;just&quot; &quot;&lt;&quot;<br />
<br />
.......</div></div><hr />


<div class="post"><div class="posttop"><div class="username">phisuio</div><div class="date">18th May 2007, 03:15</div></div><div class="posttext">Hi,<br />
and for example, how could I use a &quot; sign in a string:<br />
<br />
${StrRep} $Path &quot;12345 &quot; &quot; &quot;&quot;&quot; &quot;6789&quot;<br />
<br />
perhaps with the ASCII-code?<br />
<br />
Any idea is welcome!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">srinannapa</div><div class="date">18th May 2007, 06:28</div></div><div class="posttext">Try out this...<br />
<br />
'Some string with &quot;doublequote&quot;'<br />
<br />
${StrRep} $Path &quot;12345 &quot; ' &quot;&quot;' &quot;6789&quot;<br />
<br />
And By the way i wanted to ask you how ur able to use <br />
&quot;StrLoc&quot; can u upload ur required .nsh function or sample code ur using, i saw that ur also have some problem with StrLoc.<br />
<br />
And my requirement is like , i'm setting up the &quot;path&quot; environment variable after the java installation.<br />
<br />
it looks like this PATH=&quot;C:\JAVA\BIN\&quot;;<br />
<br />
And i want to check if that PATH is already exists in that evironment variable PATH,If not then only i want to set the path,Other wise PATH will be appended multiple times like <br />
PATH=&quot;C:\JAVA\BIN;C:\JAVA\BIN&quot;; which is almost wrong looks irregular.At this point of time i don't want the code for How to read and write environment variable etc. i need only how to check the occurence of the string after i get the path in some local variable let us say $R4.<br />
<br />
<br />
<br />
<br />
<br />
Thanks in advance,<br />
Srinivas N</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">18th May 2007, 14:06</div></div><div class="posttext">I use the following macros and functions to add (or remove) paths to the PATH environment variable:Section -PathVar<br />
# Environment Path variable<br />
Push 1	; prefix<br />
Push &quot;C:\Ipls\dlls&quot;<br />
Call SetPathVar<br />
<br />
Push 2	; append<br />
Push &quot;C:\Ipls\utilities;C:\ipls\utilities\pkzip;&quot;<br />
Call SetPathVar<br />
SectionEnd<br />
<br />
Section Uninstall<br />
...<br />
# cleanup the Environment Path variable<br />
Push 0		; 0 = remove<br />
Push &quot;C:\Ipls\dlls;C:\Ipls\utilities;C:\ipls\utilities\pkzip&quot;<br />
Call Un.SetPathVar<br />
SectionEnd<br />
<br />
...<br />
!macro DualUseFunctions_ un_<br />
function ${un_}SetPathVar<br />
	Exch $0		; new string<br />
	Exch<br />
	Exch $1		; append = 2, prefix = 1, remove = 0<br />
	Push $R0	; saved working registers<br />
	<br />
	ReadRegStr $R0 HKLM &quot;${REG_ENVIRONMENT}&quot; &quot;Path&quot;<br />
	<br />
	${Select} $1<br />
	${Case} 0<br />
		${${un_}WordAdd} &quot;$R0&quot; &quot;;&quot; &quot;-$0&quot; $R0<br />
	${Case} 1<br />
		${${un_}WordAdd} &quot;$0&quot; &quot;;&quot; &quot;+$R0&quot; $R0<br />
	${Case} 2<br />
		${${un_}WordAdd} &quot;$R0&quot; &quot;;&quot; &quot;+$0&quot; $R0<br />
	${EndSelect}<br />
	<br />
	WriteRegExpandStr HKLM &quot;${REG_ENVIRONMENT}&quot; &quot;Path&quot; &quot;$R0&quot;<br />
	System::Call 'Kernel32::SetEnvironmentVariableA(t, t) i(&quot;PATH&quot;, R0).r2'<br />
	<br />
	Pop $R0				; restore registers<br />
	Pop $1<br />
	Pop $0<br />
functionEnd<br />
!macroend<br />
!insertmacro DualUseFunctions_ &quot;&quot;<br />
!insertmacro DualUseFunctions_ &quot;un.&quot;<br />
<br />
My uninstaller calls ${un.SetPathVar} to remove what I've added.<br />
<br />
${WordAdd} is in the WordFunc.nsh header and requires these lines near the top of your script!include &quot;LogicLib.nsh&quot;<br />
!include &quot;WordFunc.nsh&quot;<br />
!insertmacro WordAdd<br />
!define REG_ENVIRONMENT &quot;SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot;<br />
<br />
<br />
Don</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>