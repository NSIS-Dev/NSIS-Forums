<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" SQL sa info check, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  SQL sa info check NSIS Discussion" />
	
	<title> SQL sa info check [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  SQL sa info check</div>
<hr />
<div class="pda"><a href="t-245702.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=245702">SQL sa info check</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">carlosfocker</div><div class="date">8th May 2006, 17:47</div></div><div class="posttext">Once agian I must call upon you guys for help. <br />
<br />
My installer needs to check if the sa username and password givin by the user during the install are correct. This needs to happen right after the user enters this info on a custom page and clicks next.<br />
<br />
I am running a sql script using nsExec::ExecToStack that connects and checks for a table. This works because it returns if the connection was successful. My problem is that I put this at the end of the custom page section that this needs to happen on and I cant click back, or cancel unless I put in the proper sa and password. <br />
<br />
Is there a better way to do this? I know about afrow-UK's buttonevent handler but I cant figure how to get it work with this situation. <br />
<br />
thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">carlosfocker</div><div class="date">9th May 2006, 14:12</div></div><div class="posttext">If anyone is unsure of what I am talking about please tell me. I sounded good in my head, but might not have translated well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th May 2006, 14:40</div></div><div class="posttext">You should put the check in the leave callback function of the page. To let the user know something is happening, you can use the Banner plug-in or any of its variants (EBanner, MsXBanner, etc.).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">carlosfocker</div><div class="date">9th May 2006, 18:59</div></div><div class="posttext">Got it to work. thanks.<br />
<br />
Code Example:<br />
<br />
page Custom SqlConnect componentsLeave<br />
<br />
Function componentsLeave<br />
    nsExec::ExecToStack &quot;Osql command&quot;<br />
    Pop $0 <br />
    ${If} $0 = 1<br />
    MessageBox MB_OK &quot;Unable to connect to SQL Server.&quot;<br />
    ${EndIf}<br />
FunctionEnd<br />
<br />
Also how would I</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>