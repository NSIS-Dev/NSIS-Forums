<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Windows Vista Standard session =&gt; Manifest without rights : Install = KO, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Windows Vista Standard session =&gt; Manifest without rights : Install = KO NSIS Discussion" />
	
	<title> Windows Vista Standard session =&gt; Manifest without rights : Install = KO [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Windows Vista Standard session =&gt; Manifest without rights : Install = KO</div>
<hr />
<div class="pda"><a href="t-259216.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=259216">Windows Vista Standard session =&gt; Manifest without rights : Install = KO</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">youn75</div><div class="date">9th November 2006, 18:09</div></div><div class="posttext">Under Windows Vista on standard session user,<br />
It is not possible to have an install in Program Files Path.<br />
Manifest file is not complete.<br />
On build with NSIS v2.21 we have this Manifest :<br />
<br />
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;<br />
&lt;assembly xmlns=&quot;urn:schemas-microsoft-com:asm.v1&quot; manifestVersion=&quot;1.0&quot;&gt;<br />
&lt;assemblyIdentity <br />
    version=&quot;1.0.0.0&quot;<br />
    processorArchitecture=&quot;X86&quot;<br />
    name=&quot;Nullsoft.NSIS.exehead&quot; <br />
    type=&quot;win32&quot;<br />
/&gt;<br />
&lt;description&gt;Nullsoft Install System v2.21&lt;/description&gt;<br />
&lt;dependency&gt;<br />
    &lt;dependentAssembly&gt;<br />
        &lt;assemblyIdentity<br />
             type=&quot;win32&quot;<br />
             name=&quot;Microsoft.Windows.Common-Controls&quot;              <br />
             version=&quot;6.0.0.0&quot; <br />
             processorArchitecture=&quot;X86&quot;<br />
             publicKeyToken=&quot;6595b64144ccf1df&quot; <br />
             language=&quot;*&quot;<br />
        /&gt;<br />
    &lt;/dependentAssembly&gt;<br />
&lt;/dependency&gt;<br />
&lt;/assembly&gt;<br />
<br />
For a right install on Standard User session with highest privileges we must have this Manifest :<br />
<br />
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;<br />
&lt;assembly xmlns=&quot;urn:schemas-microsoft-com:asm.v1&quot; manifestVersion=&quot;1.0&quot;&gt;<br />
&lt;assemblyIdentity<br />
    version=&quot;1.0.0.0&quot;<br />
    processorArchitecture=&quot;X86&quot;<br />
    name=&quot;Nullsoft.NSIS.exehead&quot;<br />
    type=&quot;win32&quot;<br />
/&gt;<br />
&lt;description&gt;Nullsoft Install System v2.21&lt;/description&gt;<br />
&lt;dependency&gt;<br />
    &lt;dependentAssembly&gt;<br />
        &lt;assemblyIdentity<br />
            type=&quot;win32&quot;<br />
            name=&quot;Microsoft.Windows.Common-Controls&quot;<br />
            version=&quot;6.0.0.0&quot;<br />
            processorArchitecture=&quot;X86&quot;<br />
            publicKeyToken=&quot;6595b64144ccf1df&quot;<br />
            language=&quot;*&quot;<br />
        /&gt;<br />
    &lt;/dependentAssembly&gt;<br />
&lt;/dependency&gt;<br />
&lt;trustInfo xmlns=&quot;urn:schemas-microsoft-com:asm.v3&quot;&gt;<br />
	&lt;security&gt;<br />
		&lt;requestedPrivileges&gt;<br />
			&lt;requestedExecutionLevel<br />
				level=&quot;highestAvailable&quot;<br />
				uiAccess=&quot;false&quot;/&gt;<br />
		&lt;/requestedPrivileges&gt;<br />
	&lt;/security&gt;<br />
&lt;/trustInfo&gt; <br />
&lt;/assembly&gt;<br />
<br />
<br />
I think the most expected into the next build version of NSIS, it will be to have a new variable in NSIS script : <br />
1) for adding requestedPrivileges into manifest on compilation process, <br />
2) for choosing the requestedExecutionLevel of requestedPrivileges.<br />
<br />
Regards,<br />
<br />
Yves</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th November 2006, 18:23</div></div><div class="posttext">NSIS 2.21 is exactly the version that added this feature. Use RequestExecutionLevel (http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.32).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">10th November 2006, 08:25</div></div><div class="posttext">I tested V.2.21 under Vista RC1 and was not able to install a nsis script.<br />
<br />
RequestExecutionLevel admin was set. The UAC didn't pop up, but the installation to C:\Program files was denied.<br />
<br />
Changing RequestExecutionLevel to user made the UAC pop up and then installing to C:\Program files worked.<br />
<br />
<br />
Regards,<br />
Flizebogen<br />
<br />
Strange - I tried it again and not it worked as expected.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">10th November 2006, 10:07</div></div><div class="posttext">Windows Vista RC2 (or RTM out real soon) might change behaviour still.<br />
<br />
Let us know if your defect encountered still is there on these versions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">youn75</div><div class="date">10th November 2006, 10:57</div></div><div class="posttext">Ok, I see it but for &quot;RequestExecutionLevel&quot; it exists another  one. This one :<br />
<br />
highestAvailable<br />
<br />
It is the most important level otherwise it is not possible to install files to &quot;Program Files&quot; dir.<br />
<br />
Add it for next version is needed.<br />
<br />
Regards,<br />
<br />
Yves</div></div><hr />


<div class="post"><div class="posttop"><div class="username">youn75</div><div class="date">10th November 2006, 11:28</div></div><div class="posttext">I have done a new test and I have changed manifest in ressource : <br />
requestedExecutionLevel level=&quot;requireAdministrator&quot;<br />
by<br />
RequestExecutionLevel level=&quot;highestAvailable&quot;<br />
<br />
After than I have launched by arg /NCRC for seeing what's happening.<br />
unfortunately, installation on standard user session in &quot;Program Files&quot; is no more done.<br />
<br />
I don't understand why because, it is OK with Installshield v12.0.<br />
<br />
Regards,<br />
<br />
Yves</div></div><hr />


<div class="post"><div class="posttop"><div class="username">youn75</div><div class="date">10th November 2006, 12:21</div></div><div class="posttext">Oups,<br />
<br />
I had some files before to install in Windows folder and that stopped intall progress process.<br />
For me it is 'OK' for installation in &quot;Program Files&quot; but I think it will be better to add &quot;highestAvailable&quot; parameter for &quot;RequestExecutionLevel&quot;.<br />
<br />
Regards,<br />
<br />
Yves</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th November 2006, 14:57</div></div><div class="posttext">I've tested it again on Vista build 5728. With an administrator account, I was able to write to the Program Files folder with everything but `user` execution level. When using the power user, it asked me for the administrator's password. When using highest, it also gave me an option to use the power user's privileges which were not good enough to write to the Program Files folder. `user` was a failure with the power user as well. With normal user and guest accounts, `admin` worked and `highest` and `user` failed. Providing no manifest always worked because it used administrator's privileges.<br />
<br />
According to this tests, `admin` allows you to do anything, `highest` gives you the best the user has to offer and `user` allows nothing. This matches what MSDN (http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnlong/html/AccProtVista.asp) has to say about the issue and almost matches what the current documentation of NSIS has to say. I've mistakenly written that `user` will allow the best the user has to offer. That's actually `highest`. I've added `highest` to the latest version and modified the documentation to match.<br />
<br />
Something else might have happened to you while trying to write to Program Files. According to MSDN and tests `administrator` gives you administrator's privileges which should be sufficient to write to the Program Files folder.<br />
<br />
flizebogen, the UAC pop-up should always appear when using `admin`. Can you rerun the tests to make sure?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>