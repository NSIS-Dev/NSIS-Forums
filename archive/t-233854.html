<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Simple Text File Logging Macro, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Simple Text File Logging Macro NSIS Discussion" />
	
	<title> Simple Text File Logging Macro [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Simple Text File Logging Macro</div>
<hr />
<div class="pda"><a href="t-233854.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=233854">Simple Text File Logging Macro</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MikeSchinkel</div><div class="date">23rd December 2005, 08:24</div></div><div class="posttext">I just made my first contribution to the Wiki: a Simple Text File Logging Macro (http://nsis.sourceforge.net/Logging:_Simple_Text_File_Logging_Macro).<br />
<br />
It also provides an example which shows the order in which sections and functions are executed by NSIS.<br />
<br />
Since I'm really a newbie to NSIS, will you NSIS gurus take a second to look at my contribution and make any comments and/or suggestions so that I can improve the quality of my NSIS code and any potential future contributions to the wiki? Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd December 2005, 11:11</div></div><div class="posttext">Seems fine, thanks for the contribution.<br />
<br />
There are, however, a couple of problems. First of all, there's no need to put the page in those three categories. Logging Functions is a subcategory of Functions &amp; Macros and  Code Examples doesn't really fit as the example is just an example for the function.<br />
<br />
Beside that, there's a little bug in the code. LOG_SET_FILE_NAME resets $__TextLogState, if the log is already open. I have added the following text to the documentation. It should explain the problem.Note that macro insertion is not considered as one instruction when it comes to relative jumps. The macro is expanded before relative jumps are applied, and so relative jumps can jump into code inside an inserted macro. The following code, for example, will not skip the macro. It will show a message box.!macro relative_jump_test<br />
  MessageBox MB_OK &quot;first macro line&quot;<br />
  MessageBox MB_OK &quot;second macro line&quot;<br />
!macroend<br />
<br />
Goto +2<br />
!insertmacro relative_jump_test</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MikeSchinkel</div><div class="date">26th December 2005, 05:16</div></div><div class="posttext">Beside that, there's a little bug in the code. LOG_SET_FILE_NAME resets $__TextLogState, if the log is already open. I have added the following text to the documentation. It should explain the problem.<br />
 Thanks.  And wow, I never would have thought of that, but now that you've explained it the problem is totally obvious.  <br />
<br />
I've rearchitected the include using what I've learned about NSIS and other's add-ons over the past several days, and the link is here: Logging: Simple Text File Logging Functions and Macros (http://nsis.sourceforge.net/Logging:_Simple_Text_File_Logging_Macro).<br />
<br />
If you have time and don't mind, I would appreciate it you could eyeball this version too, for styles as well as for substance. I have other things I might be able to contribute, but I'd like to make sure I contribute things that are consistent with the coding-style representative of the NSIS community.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">27th December 2005, 11:17</div></div><div class="posttext">Nice,<br />
<br />
I would however chance the Wiki example<br />
<br />
Function .onInit<br />
	${LogSetFileName} &quot;$INSTDIR\MyInstallLog.txt&quot;<br />
<br />
to write the file to the users temp directory since the log does not really belong to the installed program.<br />
<br />
But hey, I'm a nitpicker ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th December 2005, 18:22</div></div><div class="posttext">A couple more: Instead of:Push $0<br />
Exch<br />
Pop $0You can use:Exch $0 I'm sure there's really a need to call LogSetOff if the state isn't &quot;open&quot;. It'll just clear the state, but the functions only care if it's &quot;open&quot; or not. You should use IfErrors to check if the file opened successfully. Don't forget to use ClearErrors before FileOpen.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>