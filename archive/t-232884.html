<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" &quot;no disk&quot; browse problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  &quot;no disk&quot; browse problem NSIS Discussion" />
	
	<title> &quot;no disk&quot; browse problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  &quot;no disk&quot; browse problem</div>
<hr />
<div class="pda"><a href="t-232884.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=232884">&quot;no disk&quot; browse problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">AndyM</div><div class="date">9th December 2005, 18:05</div></div><div class="posttext">Hello.  I am getting this error message when I click the 'Browse' button on a MUI_PAGE_DIRECTORY page:<br />
<br />
&quot;There is no disk in the drive.  Please insert into drive \Device\Harddisk1\DR1.&quot;<br />
<br />
It keeps popping up over and over again whenever D: is in the view.<br />
<br />
- NSIS 2.11 on Windows 2000<br />
- I have searched the forum and FAQ and cannot find a solution<br />
- I have a ZIP drive installed, but haven't used it in years<br />
- I have not had this problem with other Windows programs - only my installer<br />
- I am not a 'native Windows' developer or user - maybe I don't understand something about Windows and users are used to this annoyance?<br />
<br />
Secondary question:  How do I change the text &quot;Select the folder to install NNN in:&quot; in the browse window?<br />
<br />
Thank you for your help!<br />
<br />
- Andy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th December 2005, 18:36</div></div><div class="posttext">Second question answer:<br />
http://forums.winamp.com/showthread.php?s=&amp;postid=1822969#post1821600<br />
(a few topics down)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndyM</div><div class="date">9th December 2005, 19:21</div></div><div class="posttext">Hey - thanks for the quick response.  I tried this:<br />
<br />
DirText &quot;&quot; &quot;&quot; &quot;&quot; &quot;Select a directory for your projects.&quot;<br />
<br />
And that worked great - except that it changed both MUI_PAGE_DIRECTORY pages.  How do I make it change just on my second MUI_PAGE_DIRECTORY page?<br />
<br />
Thanks!<br />
<br />
- Andy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th December 2005, 19:57</div></div><div class="posttext">Oh sorry, I thought you meant for a custom InstallOptions page.<br />
To change that text, I think you use !define MUI_DIRECTORYPAGE_TEXT_DESTINATION before each !insertmacro MUI_PAGE_DIRECTORY.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndyM</div><div class="date">9th December 2005, 20:04</div></div><div class="posttext">To change that text, I think you use !define MUI_DIRECTORYPAGE_TEXT_DESTINATION before each !insertmacro MUI_PAGE_DIRECTORY.<br />
 <br />
<br />
No - that changes the name of the frame around the path and browse button...<br />
<br />
The previous solution would work if there were a way to set/save state of the DirText, but I don't think that can be done...<br />
<br />
- Andy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">10th December 2005, 06:54</div></div><div class="posttext">First question may come from not existing default installation folder (wrong registry value or script default, 4.8.1.21 and 22 of Manual). You can check this using IfFileExists in the dir's page show function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndyM</div><div class="date">12th December 2005, 02:40</div></div><div class="posttext">[Now that I have the registration thing sorted, I can reply...]<br />
<br />
Takhir,<br />
<br />
Thanks for the response.  The directory definitely exists.  I created the installer using EclipseNSIS and modified it for my project.  I've checked the default dir and everything looks in order.<br />
<br />
- Andy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndyM</div><div class="date">19th December 2005, 17:45</div></div><div class="posttext">[Bump]<br />
<br />
Anyone have any thoughts on either issue?<br />
<br />
Thanks.<br />
<br />
- Andy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th December 2005, 18:32</div></div><div class="posttext">Do you get that only with your installer? Does it happen with the NSIS paclage installer? Maybe it's some broken shell link that the browse dialog shows... If not, attach the script, not much can be said without it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndyM</div><div class="date">20th December 2005, 21:44</div></div><div class="posttext">Originally posted by kichik <br />
Does it happen with the NSIS package installer? <br />
<br />
Yes it happens with the NSIS installer as well.  If I click Browse it comes up with C: open which takes up the whole viewing area.  If I then scroll down, right when it's about to display the D: drive it starts giving me that error.  I can click 'Cancel' to make it go away, but then whenever I move the scroll bar it comes up again if D: is visible in the viewing area.<br />
<br />
- Andy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd December 2005, 11:59</div></div><div class="posttext">Does it happen with browse dialogs in other applications? I could call SetErrorMode to suppress the message, but I don't think that'd be the right thing to do in this case. Seems to me like something is wrong on your machine. Is the ZIP drive on D:? I have a ZIP drive, and I don't get this message when browsing for a folder. Maybe there's a driver problem that interferes with the detection of an inserted ZIP disk and causes this error.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">23rd December 2005, 12:47</div></div><div class="posttext">Try this. Just a small VB.NET app that will show a folder browse dialog and catch any errors made in a message box.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndyM</div><div class="date">23rd December 2005, 15:21</div></div><div class="posttext">Thanks for the replies.<br />
<br />
kichik - It does not happen in other browse dialogs that I can find.  I've tried several installers and it seems like only the NSIS ones are choking.  I really only use a handful of apps and haven't seen it within any of those either.<br />
<br />
The ZIP drive is D: and I only started seeing this when I started with NSIS.  It is certainly possible that it's a driver issue, although I have everything as up-to-date as possible.<br />
<br />
Afrow UK - After finding and dowloading mscoree.dll , I get the following when I run the program:<br />
<br />
&quot;The Application failed to initialize properly (0xc0000022)...&quot;<br />
<br />
Thanks guys. If it's just me with the problem then that's OK.  I would just hate to have a customer get this if it's a more general problem.<br />
<br />
Happy Hanukkah/Happy Kwanzaa/Merry Christmas/Festive Festivus!<br />
<br />
[i]- Andy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">23rd December 2005, 15:39</div></div><div class="posttext">Have you got MS .NET Framework installed?<br />
http://www.microsoft.com/downloads/details.aspx?familyid=262D25E3-F589-4842-8157-034D1E7CF3A3&amp;displaylang=en<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndyM</div><div class="date">23rd December 2005, 15:47</div></div><div class="posttext">Originally posted by Afrow UK <br />
Have you got MS .NET Framework installed?<br />
<br />
<br />
No I don't.  [And I don't really want to...]<br />
<br />
Is it possible to build the test app without it?<br />
<br />
- Andy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">23rd December 2005, 15:52</div></div><div class="posttext">No because it is written in VB.NET as I have already said.<br />
You'll have to install it one day anyway because a hell of a lot of people are writing VB.NET, C# and C/C++ 7<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd December 2005, 15:56</div></div><div class="posttext">For the purpose of this simple test, you can run drwtsn32.exe and click on the first browse button. It uses the directory browsing dialog.<br />
<br />
Even better, the Windows file find dialog has a browse button which uses the same method as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndyM</div><div class="date">23rd December 2005, 16:39</div></div><div class="posttext">Originally posted by Afrow UK <br />
No because it is written in VB.NET as I have already said.<br />
You'll have to install it one day anyway because a hell of a lot of people are writing VB.NET, C# and C/C++ 7<br />
<br />
Sorry - I obviously wasn't paying attention.  I don't expect to have to install .NET stuff because I use the machine for only one thing: compiling/testing our Windows 2000 app.<br />
<br />
kichik -  the Windows find Browse dialog does not give me this error.  I used &quot;Search for Files or Folders...&quot; and Look in: Browse.  No problemo.<br />
<br />
- Andy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd December 2005, 18:08</div></div><div class="posttext">Then it's probably the SHGetPathFromIDList call. The attached example should trigger the error message.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndyM</div><div class="date">23rd December 2005, 22:33</div></div><div class="posttext">kichik -  I'm away from my PC for the next week or so.  I will try it when I get back and let you know!<br />
<br />
Thanks for the help.<br />
<br />
- Andy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndyM</div><div class="date">31st December 2005, 23:20</div></div><div class="posttext">kichik - Yep - that test reproduces my problem.<br />
<br />
- Andy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd January 2006, 19:29</div></div><div class="posttext">Great. Now lets see if SetErrorMode makes it go away.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndyM</div><div class="date">3rd January 2006, 19:52</div></div><div class="posttext">Nope - that didn't fix it.<br />
<br />
- Andy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd January 2006, 20:07</div></div><div class="posttext">That's weird. I'm afraid there's nothing more I can do. SetErrorMode usually suffices. Did you try another driver?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndyM</div><div class="date">3rd January 2006, 20:17</div></div><div class="posttext">OK.  Thanks for the help.  I will try to find a new driver.<br />
<br />
- Andy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndyM</div><div class="date">4th January 2006, 19:49</div></div><div class="posttext">FWIW I updated to the latest Iomega drivers and I still have the problem.<br />
<br />
- Andy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th January 2006, 17:50</div></div><div class="posttext">Maybe it's some background program?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndyM</div><div class="date">6th January 2006, 17:11</div></div><div class="posttext">I have a very simple setup.  I have no idea how to track this down [remember I'm not a Windows guy :-)].  If I ever figure it out or it &quot;Just Goes Away&quot;(tm), I'll let you know here.<br />
<br />
Thanks again.<br />
<br />
- Andy</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>