<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MUI Finish page - how to show 'show readme' and 'reboot' at the same time, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MUI Finish page - how to show 'show readme' and 'reboot' at the same time NSIS Discussion" />
	
	<title> MUI Finish page - how to show 'show readme' and 'reboot' at the same time [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MUI Finish page - how to show 'show readme' and 'reboot' at the same time</div>
<hr />
<div class="pda"><a href="t-313708.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=313708">MUI Finish page - how to show 'show readme' and 'reboot' at the same time</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">justme123</div><div class="date">12th October 2009, 12:31</div></div><div class="posttext">Hi,<br />
<br />
i'm creating an installer that requires a reboot and i want to add a checkbox to the finish page that allows to create a shortcut.<br />
<br />
In the main section there is &quot;SetRebootFlag true&quot; and the finish page is created with <br />
<br />
<br />
!define MUI_FINISHPAGE_SHOWREADME<br />
!define MUI_FINISHPAGE_SHOWREADME_NOTCHECKED<br />
!define MUI_FINISHPAGE_SHOWREADME_TEXT &quot;Create Desktop Shortcut&quot;<br />
!define MUI_FINISHPAGE_SHOWREADME_FUNCTION createDesktopShortcut<br />
!define MUI_FINISHPAGE_REBOOTLATER_DEFAULT<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
<br />
But the finish page only displays the reboot radiogroup.<br />
<br />
If i disable reboot support with '!define MUI_FINISHPAGE_NOREBOOTSUPPORT', it shows the checkbox.<br />
<br />
I checked Contrib\Modern UI 2\Pages\Finish.nsh and it looks like the calculations for positioning the reboot radiogroup doesn't take the option checkboxes (readme / run) into account. <br />
Is there any way to reorganize the boxes without changing Finish.nsh?<br />
<br />
regards,<br />
  justme123</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">12th October 2009, 15:13</div></div><div class="posttext">This post should get you started:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=264181</div></div><hr />


<div class="post"><div class="posttop"><div class="username">justme123</div><div class="date">12th October 2009, 16:57</div></div><div class="posttext">Thanks for the pointer to that Thread. Reads like it's what i need.<br />
<br />
Unfortunatly it doesn't seem to do the trick with MUI2's finish page and reboot.<br />
<br />
Maybe i'm using the wrong fieldindex?<br />
I assume there are 5 fields in a finish page (image, header,text,rebootnow,rebootlater) so using field 6 as in that example should work, but it does not :/<br />
<br />
As a workaround, i've created a new custom page with a checkbox for the shortcut. Overkill for a single checkbox, but it looks like there are more to come anyways.<br />
 <br />
ps. i know about sections/components, but the components page layout is a bit cluttered. If anyone knows how to strip it down to just a list of checkboxes (no description pane that eats half the horizontal space, no additional border) i'd be happy to use that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tom_q</div><div class="date">26th June 2013, 15:46</div></div><div class="posttext">As it stands, there is still no way (that I know of) to fix this in MUI.<br />
<br />
I understand the rationale of hiding readme and run program in case of a reboot. However this could have been worked around by launching the program or showing the readme after the reboot (registry, runonce). <br />
<br />
Besides, since these buttons are hidden, any other use of the checkboxes (e.g. for links) is also made impossible when a reboot is needed.<br />
<br />
I'm currently looking towards manually designing the entire finish page with nsdialogs instead. Does anyone know of a fix that involves less work?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">26th June 2013, 18:06</div></div><div class="posttext">You can add your own controls in MUI2 in the show callback for the finish page...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">26th June 2013, 22:10</div></div><div class="posttext">Yes, see here (http://stackoverflow.com/questions/6531115/customizing-an-exsisting-nsis-mui2-page) for an example.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tom_q</div><div class="date">4th July 2013, 09:29</div></div><div class="posttext">Thanks! Will do that.<br />
<br />
Edit: sorry for coming back again so soon... I tried the proposed solution; I first tried adapting it to my code, and when this didn't work I copied what Anders posted on StackOverflow (slightly simplified here):<br />
<br />
var Checkbox<br />
<br />
Function MyFinishShow<br />
  ${NSD_CreateCheckbox} 120u 110u 100% 10u &quot;Something&quot;<br />
  Pop $Checkbox<br />
FunctionEnd<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW MyFinishShow<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
<br />
This compiles fine but crashes on execution when the finish page loads (&quot;... has stopped responding&quot;).<br />
<br />
Based on messagebox debugging, the crash occurs on this specific line:<br />
<br />
${NSD_CreateCheckbox} 120u 110u 100% 10u &quot;Something&quot;<br />
<br />
The same thing happens when using a Label instead of CheckBox. I'll keep working on it if/when I find time, although I'll probably go for rewriting the finish page. But if anyone has another solution (or figures out why my code doesn't execute properly) it will be much appreciated! Additional info: using NSIS 2.46.<br />
<br />
... Alternatively, if anyone knows how to include new lines in the finish page label, that could also help me (that way I would just change the label text instead of adding a label).  Setting MUI_FINISHPAGE_TEXT works for text... but anything that follows a &quot;$\n&quot; isn't shown (I don't know what to attribute this to; maybe the label height is not correctly set when there are newlines? The finish page label shows very long wrapped text string just fine). &quot;$\n&quot; works fine in message boxes or custom page labels.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tom_q</div><div class="date">4th July 2013, 17:27</div></div><div class="posttext">Problem solved. I was still including MUI.nsh instead of MUI2.nsh, hence the crash.<br />
Thanks again everyone.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>