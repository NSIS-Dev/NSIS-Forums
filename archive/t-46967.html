<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Version checking - ChkVer.exe v1.0, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Version checking - ChkVer.exe v1.0 NSIS Discussion" />
	
	<title> Version checking - ChkVer.exe v1.0 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Version checking - ChkVer.exe v1.0</div>
<hr />
<div class="pda"><a href="t-46967.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=46967">Version checking - ChkVer.exe v1.0</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">12th April 2001, 19:23</div></div><div class="posttext">Hi everyone,<br />
<br />
I made a little exe which creates a textfile if a file has a higher version number. I hope you like it.<br />
<br />
Please note: it uses Visual Basic 6.0 Runtimes!<br />
So this program is only useful when installing Visual Basic applications which include runtimes.<br />
<br />
Source code has been included, modify it as you like. Maybe someone can rewrite this in Visual C++?<br />
<br />
I shouldn't take full credit for this, because I used the version code made by Randy Birch: http://www.mvps.org/vbnet, except for Sub Main, which has been created by me so it can check version differences between 2 files from command line. If 2nd file is newer, the 3rd filename is created.<br />
<br />
<br />
Example:<br />
<br />
~CHKVER C:\Windows\System\Comdlg32.ocx*C:\temp\Comdlg32.ocx*C:\temp\~chk_new.txt<br />
<br />
'My website: http://www.tibed.net<br />
I hope this works for you. Here's an example on how to use it in NSIS.<br />
<br />
SetOutPath $TEMP<br />
File ~ChkVer.exe<br />
File Comdlg32.ocx<br />
SetOutPath $SYSDIR<br />
<br />
Delete $TEMP\~chk_new.tmp<br />
ExecWait '&quot;$TEMP\~ChkVer.exe&quot; $SYSDIR\Comdlg32.ocx*$TEMP\Comdlg32.ocx*$TEMP\~chk_new.tmp'<br />
IfFileExists $TEMP\~chk_new.tmp 0 2<br />
File Comdlg32.ocx<br />
Delete $TEMP\Comdlg32.ocx<br />
<br />
RegDLL $SYSDIR\Comdlg32.ocx<br />
<br />
My e-mail: kvds2000@bigfoot.com<br />
If you think this code su**s, then don't use it.<br />
<br />
Oh, and finally, here's the URL:<br />
http://www.vdsp.myweb.nl/chkver.zip</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>