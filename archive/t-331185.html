<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Weak performance, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Weak performance NSIS Discussion" />
	
	<title> Weak performance [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Weak performance</div>
<hr />
<div class="pda"><a href="t-331185.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=331185">Weak performance</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">3rd June 2011, 09:31</div></div><div class="posttext">i'm using the Locate (http://nsis.sourceforge.net/Locate_plugin) plugin and ReplaceInFile (http://nsis.sourceforge.net/ReplaceInFile) to write file names into a file. unfortunately, this performs incredibly slow. <br />
<br />
for reference:<br />
275 files (max. file size 43kb) in 12 folders took more than 2 minutes on a core2quad 2.66mhz and a intel postville g2 ssd<br />
<br />
here the essential commands:<br />
${locate::Open} &quot;$MyDirectory&quot; &quot;/D=0 /G=1 /M=*.$MyFileType /SD=NAME /SF=NAME&quot; $0<br />
..<br />
StrCpy $R0 0<br />
StrCpy $R1 1<br />
loop:<br />
${locate::Find} $0 $1 $2 $3 $4 $5 $6<br />
IfFileExists &quot;$1&quot; 0 close<br />
${ReplaceInFile} &quot;$MyScript.nsi&quot; &quot;##MYFILE-$R0##&quot; &quot;File $\&quot;$3$\&quot;$\n  ##MYFILE-$R1##&quot;<br />
IntOp $R0 $R0 + 1<br />
IntOp $R1 $R1 + 1<br />
Goto loop<br />
close:<br />
<br />
any ideas why this takes so long?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">3rd June 2011, 10:04</div></div><div class="posttext">Could you comment out the call to ${ReplaceInFile} to check the performance of locate? It should not be slow unless the plugin is badly designed. It would not surprise me if ReplaceInFile is the problem, NSIS code is not super fast, and FileRead to read one line at the time in a loop is going to be slow...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">3rd June 2011, 10:23</div></div><div class="posttext">that's it. i shouldn't be surprised, had performance issues with ReplaceInFile before. i take it then that afrow's function (http://nsis.sourceforge.net/More_advanced_replace_text_in_file) ain't much faster. let's see how good textreplace (http://nsis.sourceforge.net/TextReplace_plugin) is.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">3rd June 2011, 10:51</div></div><div class="posttext">that did the job, the same task is done within a few seconds. thanks!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>