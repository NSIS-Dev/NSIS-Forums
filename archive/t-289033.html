<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Game Explorer without GDF, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Game Explorer without GDF NSIS Discussion" />
	
	<title> Game Explorer without GDF [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Game Explorer without GDF</div>
<hr />
<div class="pda"><a href="t-289033.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289033">Game Explorer without GDF</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mauvecloud</div><div class="date">25th March 2008, 16:06</div></div><div class="posttext">I have been able to successfully add a game to the game explorer when there was a DLL with the GDF embedded in it. However, what about games without GDFs (and that aren't in the list of known legacy games)? I can manually drag and drop a shortcut to the Game Explorer, which at least creates a play link, even if it doesn't add a support link, parental control ratings, etc. How can I do that in an NSIS installer, though?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th March 2008, 19:36</div></div><div class="posttext">Open ProcMon while dragging a game to the Game Explorer and see where it creates the shortcut and what registry keys it affects. Maybe we can mimic the process and if not, at least get a hint as to which API should be used.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mauvecloud</div><div class="date">25th March 2008, 21:51</div></div><div class="posttext">Thank you. That helps some, but unfortunately, it isn't enough.<br />
I think the following code works for adding it to the registry:<br />
<br />
!define REG_GE &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\GameUX\Games&quot;<br />
WriteRegStr HKLM &quot;${REG_GE}\${GAME_GUID}&quot; &quot;AppExePath&quot; &quot;$INSTDIR\${GAME_EXE}&quot;<br />
WriteRegStr HKLM &quot;${REG_GE}\${GAME_GUID}&quot; &quot;ApplicationId&quot; &quot;${GAME_GUID}&quot;<br />
WriteRegStr HKLM &quot;${REG_GE}\${GAME_GUID}&quot; &quot;ConfigApplicationPath&quot; &quot;$INSTDIR&quot;<br />
WriteRegStr HKLM &quot;${REG_GE}\${GAME_GUID}&quot; &quot;ConfigInstallType&quot; &quot;4&quot;<br />
WriteRegStr HKLM &quot;${REG_GE}\${GAME_GUID}&quot; &quot;Title&quot; &quot;${GAME_TITLE}&quot;<br />
<br />
<br />
However, I don't see how to add tasks to the game explorer for all users after that. Once the above registry keys have been added, the game appears in the Game Explorer, but it shows a default icon for it, and it creates a directory for the current user to put the play link into (%USERPROFILE%\AppData\Roaming\Microsoft\Windows\GameExplorer\GAME_GUID\PlayTasks\0), but even if I put a link into a similar directory under the &quot;all users&quot; AppData (I think &quot;C:\ProgramData&quot; is the Vista default for that), it doesn't pick it up.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th April 2008, 18:36</div></div><div class="posttext">Doesn't ProcMon show you the path of the shortcut you create for all users when you drag &amp; drop?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mauvecloud</div><div class="date">21st April 2008, 21:15</div></div><div class="posttext">Drag &amp; drop only creates it for the current user. I was hoping there was a way to simulate the effects, only have it appear for all users.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>