<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How can I add a shortcut to Startup folder?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How can I add a shortcut to Startup folder? NSIS Discussion" />
	
	<title> How can I add a shortcut to Startup folder? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How can I add a shortcut to Startup folder?</div>
<hr />
<div class="pda"><a href="t-245920.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=245920">How can I add a shortcut to Startup folder?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Angry Coder</div><div class="date">11th May 2006, 02:27</div></div><div class="posttext">Hello,<br />
<br />
I am wondering how I add a shortcut of my program to Startup folder?<br />
<br />
Please help. Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">11th May 2006, 02:57</div></div><div class="posttext">CreateShortCut &quot;$SMPROGRAMS\Startup\My Program.lnk&quot; &quot;$INSTDIR\My Program.exe&quot; \<br />
  &quot;some command line parameters&quot; &quot;$INSTDIR\My Program.exe&quot; 2 SW_SHOWNORMAL \<br />
  ALT|CTRL|SHIFT|F5 &quot;a description&quot;<br />
<br />
A Few notes:<br />
<br />
 $SMPROGRRAMS is a constant for the programs folder under the start menu.  Default is for the user's start menu.  For all users, use SetShellVarContext.  Refer to NSIS help for more info<br />
 The example CreateShortcut command is from the help files.  For a complete list of all the options, refer to NSIS help files</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angry Coder</div><div class="date">11th May 2006, 03:14</div></div><div class="posttext">Thanks!<br />
<br />
What's &quot;some command line parameters&quot; or &quot;a description&quot;?<br />
<br />
Should I leave it as is?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">11th May 2006, 03:20</div></div><div class="posttext">&quot;some command line parameters&quot;<br />
This would be extra command line parmaters for the EXE. Normally, this would be null (&quot;&quot;).<br />
<br />
&quot;a desciption&quot;<br />
This can be anything you want.  It just serves as a way to describe the shortcut. It can be blank if you wish.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angry Coder</div><div class="date">11th May 2006, 03:51</div></div><div class="posttext">Really appreciate your help. Thanks :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angry Coder</div><div class="date">11th May 2006, 04:05</div></div><div class="posttext">But the shortcut icon  is not showing. I am getting the default windows exe icon :(<br />
<br />
What's wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">11th May 2006, 05:19</div></div><div class="posttext">Keep it simple:<br />
CreateShortCut &quot;$SMPROGRAMS\Startup\My Program.lnk&quot; &quot;$INSTDIR\My Program.exe&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">11th May 2006, 10:21</div></div><div class="posttext">the correct folder variable is $SMSTARTUP not $SMPROGRAMS\Startup so the instructions should be: CreateShortCut &quot;$SMSTARTUP\My Program.lnk&quot; &quot;$INSTDIR\My Program.exe&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">11th May 2006, 22:47</div></div><div class="posttext">Good point. Our mistake.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angry Coder</div><div class="date">11th May 2006, 23:54</div></div><div class="posttext">Thanks guys for your follow-ups. But as I have mentionned:<br />
<br />
The shortcut icon is not showing. I am getting the default windows exe icon... What's wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">12th May 2006, 02:57</div></div><div class="posttext">Is it just the icon that is messed up or is the entire shortcut screwed up? What was the exact command you used in your script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angry Coder</div><div class="date">12th May 2006, 03:02</div></div><div class="posttext">Everything is working fine, but the icon is not showing up.<br />
<br />
  SetShellVarContext all<br />
<br />
  CreateShortCut &quot;$SMSTARTUP\my prog.lnk&quot; &quot;$INSTDIR\my prog.exe&quot; \<br />
  &quot;&quot; &quot;$INSTDIR\my prog.exe&quot; 2 SW_SHOWNORMAL \<br />
  ALT|CTRL|SHIFT|F5 &quot;Do not delete this shortcut!&quot;<br />
<br />
I found this on the manual but I didn't get it.<br />
<br />
4.9.3.4 CreateShortCut<br />
link.lnk target.file [parameters [icon.file [icon_index_number [start_options [keyboard_shortcut [description]]]]]]<br />
Creates a shortcut 'link.lnk' that links to 'target.file', with optional parameters 'parameters'. The icon used for the shortcut is 'icon.file,icon_index_number'; for default icon settings use empty strings for both icon.file and icon_index_number. start_options should be one of: SW_SHOWNORMAL, SW_SHOWMAXIMIZED, SW_SHOWMINIMIZED, or an empty string. keyboard_shortcut should be in the form of 'flag|c' where flag can be a combination (using |) of: ALT, CONTROL, EXT, or SHIFT. c is the character to use (a-z, A-Z, 0-9, F1-F24, etc). Note that no spaces are allowed in this string. A good example is &quot;ALT|CONTROL|F8&quot;. $OUTDIR is used for the working directory. You can change it by using SetOutPath before creating the Shortcut. description should be the description of the shortcut, or comment as it is called under XP. The error flag is set if the shortcut cannot be created (i.e. either of the paths (link or target) does not exist, or some other error).<br />
<br />
CreateDirectory &quot;$SMPROGRAMS\My Company&quot;<br />
CreateShortCut &quot;$SMPROGRAMS\My Company\My Program.lnk&quot; &quot;$INSTDIR\My Program.exe&quot; \<br />
  &quot;some command line parameters&quot; &quot;$INSTDIR\My Program.exe&quot; 2 SW_SHOWNORMAL \<br />
  ALT|CTRL|SHIFT|F5 &quot;a description&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angry Coder</div><div class="date">12th May 2006, 03:08</div></div><div class="posttext">Ok, it worked when I did:<br />
<br />
  CreateShortCut &quot;$SMSTARTUP\My Program.lnk&quot; &quot;$INSTDIR\My Program.exe&quot; &quot;hourglass.ico&quot;<br />
<br />
But how can I add the comment: &quot;Do not delete this shortcut&quot;?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angry Coder</div><div class="date">12th May 2006, 03:11</div></div><div class="posttext">And...<br />
<br />
This is not working also:<br />
<br />
Section &quot;Uninstall&quot;<br />
<br />
  Delete &quot;$INSTDIR\Uninstall My Program.exe&quot;<br />
  Delete &quot;$INSTDIR\My Program.exe&quot;<br />
  RMDir $INSTDIR<br />
  Delete &quot;$SMSTARTUP\My Program.lnk&quot; &lt;------- Everything is ok, except this line. It doesn't remove the shortcut!<br />
<br />
SectionEnd<br />
<br />
Please help. Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">12th May 2006, 04:30</div></div><div class="posttext">Please, PLEEEEEESE do not double post. They are often ignored, or people will stop posting.<br />
<br />
Shortcut description:<br />
<br />
CreateShortCut &quot;$SMPROGRAMS\My Company\My Program.lnk&quot; &quot;$INSTDIR\My Program.exe&quot; &quot;&quot; &quot;hourglass.ico&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;a description&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angry Coder</div><div class="date">12th May 2006, 05:44</div></div><div class="posttext">I'm really, Realllllly sorry :o</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gbstack</div><div class="date">24th June 2013, 07:28</div></div><div class="posttext">Actually you can add program path to registry &quot;Run&quot; key as well. If you add program to Start Menu/Startup folder, users can easily remove them by &quot;Right Click-&gt;Delete&quot;. This post (http://redino.net/blog/2013/06/nsis-start-program-automatically-when-windows-starts/) describes how to start program automatically in several ways, Also RunOnce key is an available option.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>