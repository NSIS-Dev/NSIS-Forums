<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Checking dialog checkboxes, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Checking dialog checkboxes NSIS Discussion" />
	
	<title> Checking dialog checkboxes [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Checking dialog checkboxes</div>
<hr />
<div class="pda"><a href="t-185213.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=185213">Checking dialog checkboxes</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st July 2004, 13:52</div></div><div class="posttext">This is a checkbox control on an exe dialog (not InstallOptions)<br />
<br />
Is there a WindowsMessage to do this, because I'd rather not have to use the System plugin with BM_SETCHECK (http://www.minigui.com/api_ref/group__ctrl__button__msgs.html#a1)<br />
<br />
Cheers<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">1st July 2004, 19:18</div></div><div class="posttext">Did you forget SendMessage NSIS command? It does exactly the same thing as using SendMessage from System plugin (except it can't get parameters from &quot;wparam&quot; and &quot;lparam&quot;, it just set).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">1st July 2004, 20:43</div></div><div class="posttext">Yeh SendMessage will do it.  I'ved used it for working with checkboxes as follows...<br />
<br />
<br />
SendMessage $R1 ${BM_SETCHECK} 1 0<br />
<br />
To set the checkbox state.  I believe changing the 1 to 0 will turn the checkbox off.<br />
<br />
<br />
SendMessage $R1 ${BM_GETSTATE} 0 0 $R2<br />
<br />
To get the checkbox state and $R2 will contain either 1 or 0 depending on if the checkbox is checked or not.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st July 2004, 22:03</div></div><div class="posttext">Yes, but wheres the BM_SETCHECK define? It's not in WinMessages.nsh (not the one that I have anyhow)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">1st July 2004, 22:18</div></div><div class="posttext">No it isn't you have to add it.  It's in some windows header file if you really want to look it up.  Just type in BM_SETCHECK in any source file in visual studio and select &quot;go to definition&quot;.  That'll give you the value or just copy the following...<br />
<br />
!define BM_GETSTATE 0x00F2<br />
!define BM_SETCHECK 0x00F1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st July 2004, 22:23</div></div><div class="posttext">That's what I've been trying to find (must reinstall VB!)<br />
<br />
Thanks<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">3rd July 2004, 02:00</div></div><div class="posttext">Thanks rsegal.Now I have another question: how can I send message to change a droplist box state?A sample ini file like this<br />
[Settings]<br />
NumFields=1<br />
<br />
[Field 1]<br />
Type=Droplist<br />
Text=Droplist<br />
State=1<br />
ListItems=1|2|3<br />
Left=77<br />
Right=174<br />
Top=27<br />
Bottom=119 <br />
<br />
Default state is &quot;1&quot;,I want to send a message cause it change to &quot;2&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">3rd July 2004, 06:40</div></div><div class="posttext">!define CB_FINDSTRINGEXACT          0x0158<br />
!define CB_SETCURSEL                0x014E<br />
<br />
SendMessage $hCtrl ${CB_FINDSTRINGEXACT} -1 &quot;String to be selected&quot; $0<br />
SendMessage $hCtrl ${CB_SETCURSEL} $0 &quot;&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">3rd July 2004, 11:49</div></div><div class="posttext">I test deguix's code,but not work.These is my code<br />
<br />
Name                 &quot;Test&quot;<br />
OutFile              &quot;.\test.exe&quot;<br />
Caption              &quot;Test&quot;<br />
SetCompressor        lzma<br />
ShowInstDetails      show<br />
!include             MUI.nsh<br />
<br />
  Page custom SetCustom LeaveCustom<br />
	<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_LANGUAGE English<br />
<br />
Section<br />
SectionEnd<br />
<br />
Function SetCustom<br />
  InstallOptions::initDialog /NOUNLOAD &quot;$PLUGINSDIR\test2.ini&quot;<br />
	Pop $9<br />
 	InstallOptions::show<br />
FunctionEnd<br />
<br />
; --------------------------------------<br />
!define CB_FINDSTRINGEXACT          0x0158 <br />
!define CB_SETCURSEL                0x014E <br />
<br />
Function LeaveCustom<br />
	ReadINIStr $R0 &quot;$PLUGINSDIR\test2.ini&quot; Settings State<br />
  StrCmp $R0 0 validate  <br />
  StrCmp $R0 2 droplist  <br />
	Abort<br />
	<br />
	droplist:<br />
	ReadINIStr $1 &quot;$PLUGINSDIR\test2.ini&quot; &quot;Field 2&quot; State<br />
  GetDlgItem $R1 $9 1200<br />
	SendMessage $R1 ${CB_FINDSTRINGEXACT} -1 $1 $0 <br />
	SendMessage $R1 ${CB_SETCURSEL} $0 &quot;&quot;	<br />
	;EnableWindow $R1 0<br />
	Abort<br />
	<br />
	validate:<br />
FunctionEnd	<br />
<br />
Function .onInit<br />
  InitPluginsDir<br />
	File &quot;/oname=$PLUGINSDIR\test2.ini&quot; &quot;.\test2.ini&quot;<br />
FunctionEnd<br />
<br />
And these is my ini file<br />
<br />
; Ini file generated by the HM NIS Edit IO designer.<br />
[Settings]<br />
NumFields=2<br />
<br />
[Field 1]<br />
Type=Droplist<br />
Text=Droplist<br />
State=1<br />
ListItems=1|2|3<br />
Left=61<br />
Right=218<br />
Top=6<br />
Bottom=100<br />
<br />
[Field 2]<br />
Type=Droplist<br />
Text=Droplist<br />
Flags=NOTIFY<br />
State=1<br />
ListItems=1|2|3<br />
Left=62<br />
Right=220<br />
Top=60<br />
Bottom=151<br />
<br />
<br />
I want droplist 2 control droplist 1.What wrong for me?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">3rd July 2004, 19:32</div></div><div class="posttext">I thought it would not work because of that -1 I put for ${CB_FINDSTRINGEXACT}. MSDN says that if wparam is -1 it would search the whole list, but that doesn't happen. Put 0 on its place.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">3rd July 2004, 23:54</div></div><div class="posttext">I replaceed -1 with 0,but still not work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">4th July 2004, 07:31</div></div><div class="posttext">Hmmm... Aparently there is a problem with SendMessage from NSIS. Everytime I change the number in wparam and/or lparam it should return the correct index of the item (it now returns 0). This is the correct (tested this time):<br />
<br />
!define CB_FINDSTRINGEXACT          0x0158 <br />
!define CB_SETCURSEL                0x014E <br />
<br />
  System::Call 'user32::SendMessageA(i R1, i ${CB_FINDSTRINGEXACT}, i -1, t r1)i .r0'<br />
  System::Call 'user32::SendMessageA(i R1, i ${CB_SETCURSEL}, i r0,)'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">4th July 2004, 10:18</div></div><div class="posttext">I got a idear to do it<br />
<br />
!define CB_GETCURSEL                0x0147 <br />
!define CB_SETCURSEL                0x014E<br />
GetDlgItem $R1 $HWND 1201<br />
SendMessage $R1 ${CB_GETCURSEL} -1 0 $R2	<br />
GetDlgItem $R1 $HWND 1200<br />
SendMessage $R1 ${CB_SETCURSEL} $R2 0</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>