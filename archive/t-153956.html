<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" noob vs System.dll, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  noob vs System.dll NSIS Discussion" />
	
	<title> noob vs System.dll [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  noob vs System.dll</div>
<hr />
<div class="pda"><a href="t-153956.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=153956">noob vs System.dll</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">blayde</div><div class="date">25th October 2003, 20:24</div></div><div class="posttext">i'm hoping someone can point out what i'm missing here, i'm trying to use system.dll.<br />
<br />
i've spent a good two hours trying this way and that to get a single call to a dll working.  i've read the faq, forum archives etc and can't find the solution.<br />
<br />
in my dll is the function<br />
int __stdcall GetDriveFSType( LPCTSTR pDriveRoot, char* outFSType )<br />
<br />
the first argument is a string : a drive letter essentially.<br />
the second argument gets set as the result.<br />
the return indicates any errors.<br />
<br />
i've followed this example by bjc (http://nsis.sourceforge.net/Docs/AppendixC.html#C.5) but with no luck.  the second argument is always 1024 after the call ( i strpy it 1024, see the link to see why ).  yet the return value comes back fine.<br />
<br />
could someone please tell me the right line of code to use to call this function.<br />
<br />
TIA</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">25th October 2003, 20:37</div></div><div class="posttext">There are examples in available in the archive that explain how to get the drive type<br />
<br />
http://nsis.sf.net/archive</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">25th October 2003, 21:09</div></div><div class="posttext">... maybe putting a direct link to System Plugin examples:<br />
<br />
System Plugin Examples (http://nsis.sourceforge.net/archive/nsisweb.php?page=135&amp;instances=0,32)<br />
<br />
(please any Archive admin, move my Create Font API to System Plugin Examples folder)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">26th October 2003, 00:30</div></div><div class="posttext">System::Call 'mydll::GetDriveFSType(t r0, t .r1) i .r2'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">blayde</div><div class="date">26th October 2003, 05:50</div></div><div class="posttext">brainsucker :<br />
<br />
well bugger me it worked.  it's always the one thing i didn't think of : no '.' for the first argument. thanks a lot.<br />
<br />
only, now i'm really confused. this code, to my mind, goes against the example code (http://nsis.sourceforge.net/Docs/AppendixC.html#C.5).  it says placing a period/dot ('.') in front of a System.dll variable means 'makes no change to source' and it appears to be used everywhere except where a pointer is returned.<br />
but you used it on variables that changed, and didn't on variables that stayed the same. <br />
<br />
<br />
everyone else :<br />
<br />
thanks for the suggestions.  to make my question clearer i should have added that my dll had other functions i need as well, so i have to use it.  but thanks all the same.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">26th October 2003, 23:58</div></div><div class="posttext">I've asked NSIS developers to change this example and documentation tens of times... <br />
Everything is simple: param defenition looks like &quot;TYPE INPUT OUTPUT&quot;.<br />
Before proc run it parses INPUT for value (with required type), and after proc run it outputs value to the OUTPUT. In case when the input doesn't matter, but you want to specify output, you could use dot ('.'), to skip it. For example &quot;i r1 r2&quot;, will read input from $1, and after run put it to $2. &quot;i r1&quot; will only read from $1 and never put output to somewhere. &quot;i .r2&quot; will take no input, but will place output value to r2.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th October 2003, 18:29</div></div><div class="posttext">Didn't we say I was just going to rewrite the readme?<br />
<br />
Well, it's taking too long anyway... I'd better update that page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd November 2003, 10:41</div></div><div class="posttext">Updated.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>