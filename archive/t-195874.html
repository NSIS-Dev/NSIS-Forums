<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" current user vs administrator, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  current user vs administrator NSIS Discussion" />
	
	<title> current user vs administrator [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  current user vs administrator</div>
<hr />
<div class="pda"><a href="t-195874.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=195874">current user vs administrator</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">amhigh</div><div class="date">7th October 2004, 17:07</div></div><div class="posttext">Dear ALL:<br />
<br />
  I have a script which uses the following to set a environment variable: <br />
  <br />
  WriteRegStr HKCU &quot;Environment&quot; &quot;ART&quot; &quot;$INSTDIR\Art.exe&quot;  <br />
  <br />
but when a user &quot;art&quot; login to WinXP, who does not own the administrator privillege, <br />
so this user click the setup.exe and press the right mouse to select administrator <br />
to run this setup.exe.  After it installs, the variable &quot;ART&quot; is set but under the <br />
administraor account, not the current user &quot;art&quot;.  How can I solve this problem?<br />
(same if for the shortcut problem -- the following statement <br />
<br />
CreateShortCut &quot;$DESKTOP\AART.lnk&quot; &quot;$INSTDIR\bin\AART.exe&quot;<br />
<br />
create a shortcut to administrator desktop, but not the current user &quot;art&quot; desktop!)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th October 2004, 15:09</div></div><div class="posttext">I think the easiest and probably the best solution all around would be checking if the user is admin and then installing for all of the users, not just the current user.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">amhigh</div><div class="date">12th October 2004, 03:26</div></div><div class="posttext">Originally posted by kichik <br />
I think the easiest and probably the best solution all around would be checking if the user is admin and then installing for all of the users, not just the current user.  <br />
<br />
If I install to all user, how can I do for the un-install? The un-installer can take away the setting for the current user only.  Is there any example script that I reference? <br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th October 2004, 22:24</div></div><div class="posttext">The uninstaller can take it out for all users just as the installer can put it for all users. Note that I'm not talking about putting a shortcut for every user, but putting it in a common directory. For example:SetShellVarContext all<br />
CreateShortcut $DESKTOP\prog.lnk $INSTDIR\prog.exe</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>