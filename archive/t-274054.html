<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Registry Search - How to end search ???, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Registry Search - How to end search ??? NSIS Discussion" />
	
	<title> Registry Search - How to end search ??? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Registry Search - How to end search ???</div>
<hr />
<div class="pda"><a href="t-274054.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=274054">Registry Search - How to end search ???</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">vc6</div><div class="date">8th July 2007, 19:04</div></div><div class="posttext">I am using Instructor's Registry NSIS plugin v3.1 to perform search for all registry keys containing &quot;VC6MYKEY&quot;:<br />
<br />
Function un.DeleteAllRegKeysContaining_VC6MYKEY<br />
  ${registry::Open} &quot;HKEY_LOCAL_MACHINE\\SYSTEM&quot; &quot;/K=1 /V=0 /S=0 /B=1 /NI='VC6MYKEY'&quot; $0<br />
  StrCmp $0 0 0 L_LOOP<br />
  MessageBox MB_OK &quot;Error&quot; IDOK L_CLOSE<br />
<br />
  L_LOOP:<br />
  ${registry::Find} &quot;$0&quot; $1 $2 $3 $4  # path, value/key, string, type<br />
  StrCmp $2 &quot;&quot; 0 L_VERIFYSUBSTRING<br />
  MessageBox MB_OK &quot;First registry::Find $0 empty??? ($1,$2,$3,$4)&quot; IDOK L_CLOSE<br />
<br />
  L_VERIFYSUBSTRING:<br />
  Push $2                      # (longer) string to be searched<br />
  Push &quot;VC6MYKEY&quot;              # what to search for<br />
  Call un.StrStr<br />
  Pop $R0                      # $R0 at this point starts with VC6MYKEY<br />
<br />
  StrCmp $R0 &quot;&quot; L_LOOP 0 <br />
  DetailPrint &quot;Delete registry key: $1\$2&quot;<br />
  DeleteRegKey HKLM &quot;$1\$2&quot;<br />
  goto L_LOOP<br />
<br />
  L_CLOSE:<br />
  ${registry::Close} &quot;$0&quot;<br />
  ${registry::Unload}<br />
FunctionEnd<br />
It does find those keys correctly, but if I want to end the search by the first return of an empty string ($2==&quot;&quot;), I can't because...  ${registry::Find} returns such empty string beore finding the first occurrence of &quot;VC6MYKEY&quot;.<br />
<br />
So... I may be able to understand how ${registry::Find} behaves (&quot;every call returns, but if not found, it will return all for vars $1 $2 $3 $4 with empty strings&quot;), but that doesn't help solve the problem that I am facing:<br />
<br />
I need to find (and delete) all occurrences of &quot;VC6MYKEY&quot; under HKEY_LOCAL_MACHINE\SYSTEM.<br />
<br />
To further clarify, all I really need is some indication that I reached &quot;the end of the registry&quot;. For example, I tried the following test:<br />
<br />
<br />
  L_LOOP:<br />
  ${registry::Find} &quot;$0&quot; $1 $2 $3 $4  # path, value/key, string, type<br />
  StrCmp $2 &quot;&quot; L_LOOP L_PRINTFOUND<br />
<br />
  L_PRINTFOUND:<br />
  DetailPrint &quot;Delete registry key: $1\$2&quot;<br />
  goto L_LOOP<br />
 but it gets stuck in endless loop.<br />
<br />
Is there a solution to this problem?<br />
<br />
Thanks,<br />
Victor</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">10th July 2007, 14:24</div></div><div class="posttext">http://forums.winamp.com/showthread.php?postid=2208894#post2208894</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vc6</div><div class="date">11th July 2007, 17:22</div></div><div class="posttext">Originally posted by Instructor <br />
http://forums.winamp.com/showthread.php?postid=2208894#post2208894  Instructor, thank you very much!<br />
<br />
I wish version 3.2 was there a few weeks ago, when I downloaded the plugin.<br />
<br />
At the moment, my project schedule takes me elsewhere. I will check the latest version and report back the results as soon as I can.<br />
<br />
Thanks again,<br />
Victor</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>