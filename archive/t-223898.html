<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" two questions, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  two questions NSIS Discussion" />
	
	<title> two questions [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  two questions</div>
<hr />
<div class="pda"><a href="t-223898.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=223898">two questions</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mondofan</div><div class="date">13th August 2005, 19:38</div></div><div class="posttext">hi, it's me again<br />
i have two questions which i haven't found answers to here<br />
<br />
1) about the ExecShell command, i want to print a document (*.txt or *.doc), &quot;open&quot; works fine for viewing it, and &quot;print&quot; prints it. however, it immediately sends it to default printer, is there any way to display print dialog (the one where you can choose printer, settings, etc) first?<br />
<br />
2) i have tried to do &quot;log&quot; textarea (similar to the one used in install dialog). i am using custom page made with installoptions and &quot;text&quot; item. i process list of files and i want to write some message about every single one of them upon their completion. if i do it &quot;get whole content, add a new line and display it sending WM_SETTEXT message&quot;, it works only for small lists of files (since size of string in nsis is very limited). there must me another way - just adding a new line on bottom of the content. i remember the trick i used to do this when i played with winapi - select whole content (EM_SETSEL &quot;0&quot; &quot;-1&quot;), get selection boundaries (EM_GETSEL lower upper), select the EMPTY end of the content (EM_SETSEL upper upper) and then replace it with the text i want to add (EM_REPLACESEL &quot;0&quot; &quot;new text&quot;). the question: both setsel and replacesel messages seem to work fine in nsis, but how to tame getsel message? i cannot find a way to pass parameters to it (it should return the boundaries in it), does anyone know how can i do it?<br />
<br />
thanks in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th August 2005, 20:26</div></div><div class="posttext">1. I think print calls notepad with the /P switch. There's also a /PT switch:<br />
/PT &lt;filename&gt; &lt;printername&gt; &lt;driverdll&gt; &lt;port&gt;<br />
But I don't think that'll do what you want.<br />
<br />
2. Use the special build NSIS which has an 8192 character string length.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mondofan</div><div class="date">14th August 2005, 00:01</div></div><div class="posttext">thanks for reply<br />
ad 1) you are right, but i'd still prefer the print dialog variant (i will continue to search)<br />
<br />
ad 2) that might help, but there is still a limit, btw does it mean that nsis cannot handle sending messages that return some data?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th August 2005, 11:33</div></div><div class="posttext">If data returned with SendMessage is greater than the 8192 buffer, you'll just end up getting the rest of it cut off.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mondofan</div><div class="date">15th August 2005, 07:05</div></div><div class="posttext">this shouldn't be a problem, EM_GETSEL should return two numbers (ie selection range), but i don't know how to pass those parameters (SendMessage $0 ${EM_GETSEL} $1 $2 doesn't work, both $1 and $2 return without value ($0 contains HWND, that isn't problem))</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th August 2005, 10:38</div></div><div class="posttext">I don't know why it's not working, but why not use a ListBox control instead?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">15th August 2005, 12:50</div></div><div class="posttext">SendMessage cannot return values in the parameters of the function. Use the System plug-in to call the SendMessageA function from user32.dll.<br />
<br />
It should be something like this:<br />
System::Call &quot;user32::SendMessage(i,i,i,i)i (r0,${EM_GETSEL},.r1,.r2)&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mondofan</div><div class="date">16th August 2005, 06:34</div></div><div class="posttext">works perfectly, thanks deguix</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>