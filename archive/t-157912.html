<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Start Menu Folder Problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Start Menu Folder Problem NSIS Discussion" />
	
	<title> Start Menu Folder Problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Start Menu Folder Problem</div>
<hr />
<div class="pda"><a href="t-157912.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=157912">Start Menu Folder Problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">alan93</div><div class="date">28th November 2003, 18:47</div></div><div class="posttext">The first version of my program was 1.0.0<br />
<br />
So I did this:<br />
<br />
!define VERSION &quot;1.0.0&quot;<br />
<br />
This writes<br />
   MyProgramName 1.0 to the following key<br />
   HKEY_LOCAL_MACHINE\SOFTWARE\MyProgramName<br />
   string: Start Menu Folder<br />
   value: MyProgramName 1.0<br />
<br />
Now when I change to this<br />
    !define VERSION &quot;1.1.0&quot;<br />
<br />
All the install dialogs say 1.1.0 except <br />
the &quot;Choose Start Menu Folder&quot; dialog. It still displays<br />
   MyProgramName 1.0<br />
<br />
from the first install<br />
<br />
Do I have to change this registry entry on every install(update)?<br />
If so how?<br />
<br />
or another option</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alan93</div><div class="date">28th November 2003, 18:51</div></div><div class="posttext">Here's what I have for the pages<br />
<br />
  ;Start Menu Folder Page Configuration<br />
  !define MUI_STARTMENUPAGE_REGISTRY_ROOT &quot;HKLM&quot; <br />
  !define MUI_STARTMENUPAGE_REGISTRY_KEY &quot;Software\MyProgramName&quot; <br />
  !define MUI_STARTMENUPAGE_REGISTRY_VALUENAME &quot;Start Menu Folder&quot;<br />
<br />
I'm not even sure why or how the version number shows up in this registry entry, because the shortcuts don't show it.<br />
<br />
?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">28th November 2003, 19:59</div></div><div class="posttext">You have configured the Start Menu Folder Page to remember the last used Start Menu Folder. I recommend you not to add a version number to the folder name.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alan93</div><div class="date">28th November 2003, 21:07</div></div><div class="posttext">where am I adding a version to the folder name?<br />
or do you mean program name?<br />
<br />
Becauase I do have this:<br />
<br />
;Configuration<br />
<br />
  ;General<br />
  !define VERSION &quot;1.1.0&quot;<br />
  Name &quot;MyProgramName ${VERSION}&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alan93</div><div class="date">28th November 2003, 21:18</div></div><div class="posttext">I am trying to delete that first install version number on subsequent installs but can't even delete it using:<br />
<br />
;Start Menu Folder - this can be removed later<br />
  WriteRegStr HKLM &quot;SOFTWARE\MyProgramName &quot;Start Menu Folder&quot; &quot;MyProgramName&quot;   //instead of &quot;MyProgramName 1.0&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alan93</div><div class="date">28th November 2003, 21:38</div></div><div class="posttext">I have deleted the key manually<br />
<br />
DeleteRegKey HKLM &quot;SOFTWARE\MyProgramName&quot; //which had MyProgramName 1.0<br />
<br />
and it still shows up in &quot;Chose Start Menu Folder&quot; !!!????<br />
<br />
I have searched the registry for this and can't find it! Where is it getting it from?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">28th November 2003, 21:41</div></div><div class="posttext">It really gets it from the key you have set in your script.<br />
<br />
If you have not set MUI_STARTMENUPAGE_DEFAULTFOLDER it will use the name.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alan93</div><div class="date">28th November 2003, 21:44</div></div><div class="posttext">But I don't have version or 1.0 used anywhere in the script.<br />
<br />
??<br />
<br />
<br />
So its not in the script and its not in the registry.<br />
<br />
??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alan93</div><div class="date">28th November 2003, 21:47</div></div><div class="posttext">Should I change it to this?<br />
<br />
  ;Start Menu Folder Page Configuration<br />
  !define MUI_STARTMENUPAGE_DEFAULTFOLDER<br />
  ;!define MUI_STARTMENUPAGE_REGISTRY_ROOT &quot;HKLM&quot; <br />
  ;!define MUI_STARTMENUPAGE_REGISTRY_KEY &quot;Software\MyProgramName&quot; <br />
  ;!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME &quot;Start Menu Folder&quot;<br />
<br />
<br />
but then there would be no option on a first time install right?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">28th November 2003, 21:52</div></div><div class="posttext">Really, it does not make up that name itself :) It uses the key you have defined in your script.<br />
<br />
If you want your installer to remember the last folder, you should keep the registry settings.<br />
<br />
By default, the default folder uses the name set using the Name command. You have added a version number to that one, so you will have to use MUI_STARTMENUPAGE_DEFAULTFOLDER if you don't want the version number.<br />
<br />
So you should use these settings:<br />
!define MUI_STARTMENUPAGE_DEFAULTFOLDER &quot;MyProgramName&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_ROOT &quot;HKLM&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_KEY &quot;Software\MyProgramName&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME &quot;Start Menu Folder&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alan93</div><div class="date">28th November 2003, 22:04</div></div><div class="posttext">I tried that and it doesn't remove the version number even when I removed the version number from the name. How do I remove the version number (or update it to newer one) for the &quot;Choose start menu folder&quot; dialog on subsequent installs? <br />
<br />
Or there is really no way to remove this value on installs after the original one?<br />
<br />
Unless it is uninstalled and then the corrected one (your example) is installed later?<br />
<br />
Another thing I mentioned earlier that I don't understand is why does the start menu not have the 1.0 on mine like Microsoft Visual Studio 6.0 has its version number on the menu? It just shows up in the install &quot;Chose Start Menu Folder&quot; dialog.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">28th November 2003, 22:08</div></div><div class="posttext">It uses the default name if there is no name in the registry key. After you have completed an installation with a new folder name, it will use that name<br />
<br />
If you always want a version number and you don't want it to remember anything, you don't have to use these settings.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alan93</div><div class="date">28th November 2003, 22:19</div></div><div class="posttext">Lets strike your first sentence and say its moot because perhaps 200 people have installed my 1.0.0 version program<br />
<br />
Now, I put the example you gave me in 1.1.0<br />
and remove the version from the program name.<br />
<br />
The first time that 1.1.0 is installed, I get:<br />
&quot;Chose Start Menu Folder&quot; MyProgramName 1.0<br />
<br />
The second time I install it I STILL get:<br />
&quot;Chose Start Menu Folder&quot; MyProgramName 1.0<br />
<br />
Why isn't your second sentence true regarding my above example?<br />
Or am I misunderstanding again?<br />
<br />
How do change the installer to get this:<br />
&quot;Chose Start Menu Folder&quot; MyProgramName.<br />
<br />
?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">28th November 2003, 22:23</div></div><div class="posttext">If you remove the registry setting, it will never use the registry name anymore.<br />
<br />
If you have set a registry key, it will always use the last value. If you have changed the name and completed the installation, it will use the new name.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alan93</div><div class="date">28th November 2003, 22:28</div></div><div class="posttext">I tried to delete it, that was one of my previous questions........<br />
<br />
I put this in a section:<br />
DeleteRegKey HKLM &quot;SOFTWARE\MyProgramName&quot;<br />
<br />
This has the &quot;Start Menu Folder&quot; string with data &quot;MyProgramName 1.0&quot;<br />
<br />
after the 1.1.0 install is run, This key is gone. yea!<br />
<br />
the second time the 1.1.0 insatll is run, it puts it back in somehow<br />
when I am NOT using the version as part of the Name and the text &quot;1.0&quot; is no where in my script! no where.<br />
<br />
so where is it getting it from now?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">28th November 2003, 22:29</div></div><div class="posttext">Remove MUI_STARTMENUPAGE_REGISTRY_ROOT etc. and it will never remember a folder name.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alan93</div><div class="date">28th November 2003, 22:34</div></div><div class="posttext">strange, interesting, and it gets the result i need.  !! yea<br />
<br />
but i would have thought that leaving in the surrounding defs:<br />
MUI_STARTMENUPAGE_DEFAULTFOLDER and MUI_STARTMENUPAGE_REGISTRY_KEY <br />
would cause problems.<br />
<br />
I still don't understand how anyone would ever update a Start Menu Folder with a version number.<br />
<br />
But at least my problem of showing the old incorrect one on new installs is solved.<br />
<br />
Thanks for the persistant help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">28th November 2003, 23:26</div></div><div class="posttext">You don't seem to get the point of using the registry setting.<br />
<br />
You only need MUI_STARTMENUPAGE_REGISTRY_KEY if you want it to remember the previous preference. For example, if the user wants to put your shortcuts in AAA instead YourApp and runs the installer again, AAA will still be the default setting.<br />
<br />
It shows the previous number because that was the stored folder. You could add some string parsing that will increase the stored version number, but that will give some problems, since the user can choose any format (like &quot;My App 1.0 - Second Install&quot;, &quot;1.0 My App&quot; etc.).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>