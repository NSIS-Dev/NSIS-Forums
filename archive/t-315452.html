<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem copying file to $APPDATA, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem copying file to $APPDATA NSIS Discussion" />
	
	<title> Problem copying file to $APPDATA [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem copying file to $APPDATA</div>
<hr />
<div class="pda"><a href="t-315452.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=315452">Problem copying file to $APPDATA</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dr_legg</div><div class="date">18th December 2009, 09:35</div></div><div class="posttext">I'm trying to copy a file into the $APPDATA folder but it's not working.<br />
<br />
I have the following:<br />
<br />
SetShellVarContext all<br />
  <br />
CopyFiles &quot;$INSTDIR\Configuration.xml&quot; &quot;$APPDATA\MyApp\Configuration\Configuration.xml&quot;<br />
<br />
The folder exists, as does the file so why doesn't it work?<br />
<br />
Thanks<br />
Clegg</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">18th December 2009, 09:51</div></div><div class="posttext">You probably don't have write permissions in the directory. Try running as admin.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dr_legg</div><div class="date">18th December 2009, 09:54</div></div><div class="posttext">I am logged on to my machine as an administrator - I can copy files manually to this directory with no problem.<br />
<br />
Is this what you meant or do I need to set something in the installer?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">19th December 2009, 12:55</div></div><div class="posttext">Hmm. First order of business would probably be to isolate the cause of the problem. Create a skeleton installer that only tries to copy the file:<br />
<br />
Outfile &quot;test.exe&quot;<br />
requestexecutionlevel admin<br />
Section<br />
SetShellVarContext all<br />
SetOutPath &quot;$APPDATA\MyApp\Configuration&quot;<br />
CopyFiles &quot;$EXEDIR\Configuration.xml&quot; &quot;$APPDATA\MyApp\Configuration\Configuration.xml&quot;<br />
SectionEnd<br />
<br />
If that works, the problem lies elsewhere in your installer. If if doesn't work... Well, I'm not sure why it wouldn't work. But at least you'll know it's caused by either the folder creation or file copying commands.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dr_legg</div><div class="date">23rd December 2009, 10:49</div></div><div class="posttext">Many thanks for the reply - i've discovered the problem and as per usual it's my own stupid fault!<br />
<br />
The application has a folder in the Program Files directory as well as $APPDATA - I copied and pasted the one from Program Files and it's ever so slightly different which caused the error<br />
<br />
....\Provider\App2.0\AppAgent\   as opposed to<br />
....\Provider\App2.0\App Agent\  <br />
<br />
it's a 3rd party app so I can't make them both the same but at least I know what the problem is now.<br />
<br />
Thanks for all your help and sorry for wasting your time.<br />
<br />
Clegg</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>