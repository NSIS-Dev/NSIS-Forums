<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Screensaver Installer / Vista 64 Issue, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Screensaver Installer / Vista 64 Issue NSIS Discussion" />
	
	<title> Screensaver Installer / Vista 64 Issue [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Screensaver Installer / Vista 64 Issue</div>
<hr />
<div class="pda"><a href="t-304701.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=304701">Screensaver Installer / Vista 64 Issue</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Slackluster</div><div class="date">28th March 2009, 00:46</div></div><div class="posttext">I made an installer for a screensaver that seems to work fine on xp and vista but I am having problems with vista 64.  Here is the relevant code...<br />
<br />
!include &quot;x64.nsh&quot;<br />
<br />
InstallDir &quot;$SYSDIR&quot;<br />
<br />
SetOutPath &quot;$INSTDIR&quot;<br />
File &quot;PixelWords.scr&quot;<br />
Exec 'RUNDLL32.exe DESK.CPL,InstallScreenSaver PixelWords.scr'<br />
<br />
This is difficult for me to test because I don't have a vista 64 machine accessible to me.  I think I am at the point where it does install to the syswow64 folder but it is still not persisting in the screensavers window.  Can anyone offer some advice?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Slackluster</div><div class="date">28th March 2009, 05:43</div></div><div class="posttext">Ok, my bro tried the install on his vista 64 system.  It seems to have worked.  Here is the script for those interested.<br />
<br />
<br />
;NSIS Screensaver Install Script<br />
;Adaped from Header Bitmap Example Script by Joost Verburg<br />
<br />
;--------------------------------<br />
;Include Modern UI<br />
<br />
	!include &quot;MUI2.nsh&quot;<br />
	!include &quot;x64.nsh&quot;<br />
<br />
;--------------------------------<br />
;General<br />
<br />
	;Name and file<br />
	Name &quot;Pixel Words&quot;<br />
	OutFile &quot;PixelWordsSetup.exe&quot;<br />
<br />
	;Default installation folder<br />
	InstallDir &quot;$SYSDIR&quot;<br />
<br />
	;Request application privileges for Windows Vista<br />
	RequestExecutionLevel none <br />
<br />
;--------------------------------<br />
;Interface Configuration<br />
<br />
	!define MUI_HEADERIMAGE<br />
	!define MUI_HEADERIMAGE_BITMAP &quot;background.bmp&quot; ; optional<br />
	!define MUI_ABORTWARNING<br />
	!define MUI_ICON &quot;icon.ico&quot;<br />
	!define MUI_FINISHPAGE_RUN<br />
	!define MUI_FINISHPAGE_RUN_TEXT &quot;Set Pixel Words as the active screensaver&quot;    <br />
	!define MUI_FINISHPAGE_RUN_FUNCTION &quot;SetScreensaver&quot;<br />
	;!define MUI_FINISHPAGE_RUN_NOTCHECKED<br />
<br />
	; show install details<br />
	;!define MUI_FINISHPAGE_NOAUTOCLOSE<br />
	;ShowInstDetails show<br />
<br />
;--------------------------------<br />
;Pages<br />
<br />
	!insertmacro MUI_PAGE_LICENSE &quot;License.txt&quot;<br />
	!insertmacro MUI_PAGE_INSTFILES<br />
	!insertmacro MUI_PAGE_FINISH<br />
  <br />
;--------------------------------<br />
;Languages<br />
<br />
	!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
;--------------------------------<br />
;Installer Sections<br />
<br />
Section &quot;Dummy Section&quot; SecDummy<br />
<br />
	SetOutPath &quot;$INSTDIR&quot;<br />
<br />
	File &quot;PixelWords.scr&quot;<br />
<br />
SectionEnd<br />
<br />
Function SetScreensaver<br />
<br />
	;Set screensaver and make it active<br />
	Exec 'RUNDLL32.exe DESK.CPL,InstallScreenSaver PixelWords.scr'<br />
	<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LingoSag</div><div class="date">28th March 2009, 06:32</div></div><div class="posttext">;Forget Exec 'RUNDLL32.exe DESK.CPL,InstallScreenSaver PixelWords.scr'<br />
<br />
;Edit registry directly<br />
<br />
<br />
;For Installation<br />
<br />
!include LogicLib.nsh<br />
<br />
!define PRODUCT_NAME &quot;Your ScreenSaver Name&quot;<br />
<br />
;IMPORTANT After file on Disq<br />
<br />
GetFullPathName /SHORT $sDosName &quot;$SYSDIR\${PRODUCT_NAME}.scr&quot;<br />
<br />
WriteRegStr HKCU &quot;Control Panel\Desktop&quot; &quot;SCRNSAVE.EXE&quot; $sDosName<br />
<br />
WriteRegStr HKCU &quot;Control Panel\Desktop&quot; &quot;ScreenSaveActive&quot; &quot;1&quot;<br />
<br />
<br />
;For UnInstall<br />
<br />
ReadRegStr $sUnInstActiveScnSaverDosName HKCU &quot;Control Panel\Desktop&quot; &quot;SCRNSAVE.EXE&quot;<br />
<br />
GetFullPathName /SHORT $sUnInstScnSaverDosName &quot;$SYSDIR\${PRODUCT_NAME}.scr&quot;<br />
<br />
;The Conditionnal is for not deactivate de ScreenSaver is not your...<br />
<br />
<br />
 ${If} $sUnInstActiveScnSaverDosName == $sUnInstScnSaverDosName<br />
<br />
  DeleteRegValue HKCU &quot;Control Panel\Desktop&quot; &quot;SCRNSAVE.EXE&quot;<br />
<br />
  WriteRegStr HKCU &quot;Control Panel\Desktop&quot; &quot;ScreenSaveActive&quot; &quot;0&quot;<br />
<br />
 ${EndIf}<br />
 <br />
;Work perfectly on Xp I can't garanty on Vista 64<br />
<br />
;Vista, what Vista ??? :)<br />
<br />
;SylBou</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>