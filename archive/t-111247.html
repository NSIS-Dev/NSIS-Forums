<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Using Variables in the uninstall section, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Using Variables in the uninstall section NSIS Discussion" />
	
	<title> Using Variables in the uninstall section [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Using Variables in the uninstall section</div>
<hr />
<div class="pda"><a href="t-111247.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=111247">Using Variables in the uninstall section</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Paul_Hammons</div><div class="date">24th October 2002, 15:26</div></div><div class="posttext">I am using install options to have a user enter a information that I am tagging onto the end of a filename and creating a custom directory.  The install works just fine, but it appears that the uninstaller is not being created with the variable information.  When I view the detail in during an uninstall, where the variables are located in the script, there is a blank space in the uninstall detail.<br />
<br />
Examples below:<br />
Install line:<br />
CopyFiles /Silent /Filesonly &quot;$EXEDIR\eSecureTail.exe&quot; &quot;$WINDIR\$R2.exe&quot; 58<br />
<br />
Uninstall line:<br />
Delete &quot;$WINDIR\$R2.exe&quot;<br />
<br />
and <br />
<br />
UninstallText &quot;This will uninstall $R2 from your system&quot;<br />
<br />
In the uninstall text, it displays &quot;$R2&quot; in the text, it doesn't convert it to the value of the variable.<br />
<br />
Any help would be greatly appreciated.<br />
-Paul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">24th October 2002, 15:41</div></div><div class="posttext">How would the uninstaller know the value of $R2?<br />
<br />
You have to save that variable somewhere (for example, in the registry) and read it in the uninstaller.<br />
<br />
UninstallText is an installer atribute, so you cannot use a variable in it:<br />
<br />
The commands below all adjust attributes of the installer. These attributes control how the installer looks and functions, including which pages are present in the installer, as what text is displayed in each part of each page, how the installer is named, what icon the installer uses, the default installation directory, what file it writes out, and more. Note that these attributes can be set anywhere in the file except in a Section or Function. With the exception of InstallDir, none of these attributes allow use of Variables other than $\r and $\n in their strings.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Paul_Hammons</div><div class="date">24th October 2002, 16:24</div></div><div class="posttext">I understand the installdir text part, but what is confusing me is that the uninstaller knows $INSTDIR and $WINDIR.  I would assume that these values are expanded into the uninstaller command lines when the uninstaller is created.<br />
<br />
The uninstaller also gets this line correct....<br />
DeleteRegKey HKEY_LOCAL_MACHINE &quot;SOFTWARE\e-Security\eSecureTail\$R2&quot;<br />
<br />
and<br />
<br />
Delete &quot;$INSTDIR\$R2\uninst.exe&quot; <br />
<br />
But not this.....<br />
<br />
ExecWait &quot;net stop $R2&quot;<br />
<br />
It seems like in some cases the variable is converted to the value when it creates the uninstaller and sometimes not.....<br />
<br />
Is there a way to get user input when uninstalling?  Maybe use install options in the uninstall section?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">24th October 2002, 16:40</div></div><div class="posttext">$INSTDIR and $WINDIR are automatically set by the uninstaller ($INSTDIR is the directory where the uninstaller is located, $WINDIR can be retrieved using an API function).<br />
<br />
$R2 is a normal general purpose variable. It's just in the memory when the installer runs, but it will not be saved to the disk. The uninstaller is a separate application which does not know anything about the installer variables.<br />
<br />
$R2 in the uninstaller is empty by default. If you want to use the user input in the uninstaller, you should save this value to the disk.<br />
<br />
Installer &gt; Write $R2 to registry<br />
Uninstaller &gt; Get $R2 from registry</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>