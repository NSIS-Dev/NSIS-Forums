<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Silent install but non-silent uninstall?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Silent install but non-silent uninstall? NSIS Discussion" />
	
	<title> Silent install but non-silent uninstall? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Silent install but non-silent uninstall?</div>
<hr />
<div class="pda"><a href="t-318575.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318575">Silent install but non-silent uninstall?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">drjasonharrison</div><div class="date">21st April 2010, 22:26</div></div><div class="posttext">It appears that when we run our NSIS installer using the /S (silent) command line flag that it creates a silent uninstaller.<br />
<br />
Is there a way to make the uninstaller non-silent when run from the start menu entry?<br />
<br />
That is, after running<br />
<br />
 % installer.exe /S<br />
<br />
We could select Start&gt;Programs&gt;abc&gt;uninstall, and it should pop up the typical &quot;do you want to uninstall&quot; message boxes<br />
<br />
but running C:\Program Files\abc\uninst.exe would be silent.  We need this second behaviour for installing updates.<br />
<br />
-Jason</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">21st April 2010, 23:05</div></div><div class="posttext">Let me first say that passing /S when doing the update is a much better idea.<br />
<br />
But if you want to do it your way: The shortcut needs to pass some kind of parameter, then in .onInit, check for this parameter and toggle the silent mode (Silent mode can be changed at runtime in .onInit)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">22nd April 2010, 01:19</div></div><div class="posttext">Anders is right, your update process should call the uninstaller passing /S as argument<br />
<br />
Or maybe you always want your uninstall to be silent (bad idea), then use SilentUnInstall</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drjasonharrison</div><div class="date">22nd April 2010, 19:28</div></div><div class="posttext">I don't think I made myself clear.<br />
<br />
We have a &quot;master application&quot; that as part of its NSIS installer, installs a &quot;helper application&quot;.  The &quot;helper application&quot; is installed using a NSIS installer, which is not-silent when run separately, and passed the /S flag when we call it from the &quot;master application&quot; installer.<br />
<br />
But, then the uninstaller for the &quot;helper application&quot; is marked as &quot;run silently&quot; so when the customer selects the uninstaller in the program files menu, the uninstaller goes ahead and runs without any confirmation or message boxes.  Thus twitchy clicks on the wrong menu item uninstall the helper application.<br />
<br />
We can remove the shortcut from the program files menu, but are looking for a better solution.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">22nd April 2010, 22:59</div></div><div class="posttext">I just tested.<br />
There is no such thing in NSIS like &quot;when the installer is run silently, it marks the uninstaller to run silently also&quot;.<br />
<br />
Unless *you* programmed it like that, using SilentUninstall, or SetSilent in un.onInit, or by calling the uninstaller with /S argument.<br />
<br />
Are you sure your Start menu shortcut doesn't have a /S argument ?<br />
<br />
my test code:<br />
outfile &quot;test.exe&quot;<br />
<br />
section main<br />
	writeuninstaller &quot;$EXEDIR\testu.exe&quot;<br />
sectionend<br />
<br />
section un.main<br />
	delete &quot;$INSTDIR\testu.exe&quot;<br />
sectionend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drjasonharrison</div><div class="date">23rd April 2010, 18:09</div></div><div class="posttext">Ah, you are correct.  Here is my incorrect code which was producing the behaviour that I confused with &quot;silent install&quot; == &quot;silent uninstall&quot;<br />
<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
Function un.onInit<br />
	IfSilent 0 +3<br />
		MessageBox MB_ICONQUESTION|MB_YESNO|MB_TOPMOST &quot;Are you sure you want to completely remove $(^Name) and all of its components?&quot; IDYES +2<br />
		Abort<br />
	HideWindow<br />
FunctionEnd<br />
<br />
<br />
<br />
<br />
The IfSilent was incorrect, should have been &quot;IfSilent +3&quot;<br />
<br />
Thank you for clarifying this,<br />
-Jason</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">23rd April 2010, 18:58</div></div><div class="posttext">You should use the LogicLib, then you will not have jump errors like that</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>