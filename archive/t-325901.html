<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Allow update of license and program, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Allow update of license and program NSIS Discussion" />
	
	<title> Allow update of license and program [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Allow update of license and program</div>
<hr />
<div class="pda"><a href="t-325901.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=325901">Allow update of license and program</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mvpetrovich</div><div class="date">13th January 2011, 04:48</div></div><div class="posttext">I am new to NSIS.  After 12 years of Installshield Express, I've grown tired of its expense and lack of flexibility.  After some effort I basically have my software installation scripts working -- only one slight problem, it does not work on Windows Vista.  With my Installshield installations, I had to have two different installation programs for my software -- one for first-time installation, and one for upgrading.  I think I have solved this by using NSIS for a single installation program.<br />
<br />
I have a simple installation with a single executable and some optional data files.<br />
<br />
I need advice on the best approach to do the following.<br />
<br />
Once someone installs the software, they need to be able to update the license information.  Currently that is stored in HKLM.  The license information is updated via a software dialog, so I know that it will be written only if it is valid.<br />
<br />
The second thing I need to be able to do is upgrade the software by overwriting the executable program.  With Installshield about 20% of my end users require uninstall of the program before they can upgrade - a problem I cannot duplicate on any of our in-house systems.<br />
<br />
I am thinking to use the AccessControl plug-in.<br />
<br />
I would need to make the HKLM &quot;Software\vendor\program\License&quot; with write permissions.<br />
<br />
I do not like the idea of making the executable writable, except by the subsequent installation program, but may have to do so.<br />
<br />
I am sure this is a common inquiry, but could not find this with my search terms.  I appreciate any help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">13th January 2011, 07:11</div></div><div class="posttext">If you use HKLM, you always must ask for admin privileges at installation. And since you installed as admin once, it doesn't make sense to 'upgrade' it at userlevel. Your upgrader will simply have to request admin access as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mvpetrovich</div><div class="date">13th January 2011, 14:22</div></div><div class="posttext">I was able to do exactly what I had requested using:<br />
<br />
AccessControl::GrantOnRegKey HKLM &quot;Software\vendor\program\License&quot; &quot;Everyone&quot; &quot;FullAccess&quot;<br />
<br />
This allows updating the license by the user.<br />
There is also not a problem with upgrading the files.<br />
<br />
This is great!!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>