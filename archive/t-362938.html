<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS Registry Key Overwriting Default Open In Context Menu, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS Registry Key Overwriting Default Open In Context Menu NSIS Discussion" />
	
	<title> NSIS Registry Key Overwriting Default Open In Context Menu [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS Registry Key Overwriting Default Open In Context Menu</div>
<hr />
<div class="pda"><a href="t-362938.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=362938">NSIS Registry Key Overwriting Default Open In Context Menu</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pspjhp</div><div class="date">4th June 2013, 14:30</div></div><div class="posttext">Hey everyone,<br />
<br />
I know this is probably an easy fix , but I'm having some trouble with it.  I create a couple keys so that when someone right clicks on a directory OR file my program shows up in the options.  When you click the program option then the program is launched.  Easy.<br />
<br />
The problem is that these keys that I'm creating are making it so when I double click on a direcotyr or file that it launches my program.  It is the default option for dealing with directorys/files instead of 'Open'.  I would like it just to be like the 2nd or 3rd option or something after Open or Open in New Window.<br />
Here is an example of my line of code:<br />
WriteRegStr HKCR &quot;Directory\shell\Context Menu Line\command&quot; &quot;&quot; '&quot;C:\\TestProgram.exe&quot; &quot;%1&quot;'<br />
<br />
Any help would be greatly appreciated.<br />
<br />
Thanks!<br />
Justin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">4th June 2013, 15:21</div></div><div class="posttext">The default value in the shell key will specify the default action. Its value should be set to &quot;none&quot;.<br />
<br />
WriteRegStr HKCR &quot;Directory\shell&quot; &quot;&quot; &quot;none&quot;<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">5th June 2013, 00:25</div></div><div class="posttext">The default value in the shell key will specify the default action. Its value should be set to &quot;none&quot;.<br />
<br />
WriteRegStr HKCR &quot;Directory\shell&quot; &quot;&quot; &quot;none&quot;<br />
<br />
Setting the default shell value to none is not a good idea AFAIK, do you know any MSDN docs that say otherwise?<br />
<br />
If all you are doing is adding HKCR\Directory\shell\mything\command it should not get invoked as the default action. The context menu for a file system folder comes from 3 places (5 on XP+) HKCR\Folder, HKCR\Directory and HKCR\AllFilesystemObjects and you should never touch the default shell value because it can mess up the way explorer opens folders!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pspjhp</div><div class="date">7th June 2013, 12:51</div></div><div class="posttext">Yeah I agree however, for some reason the default action becomes my program when I try to open anything up.  Until I uninstall and then it goes back to the normal thing.  I'm using Windows 7 if that changes anything. I could include a small screen shot or something of my context menu and/or registry if that helps.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pspjhp</div><div class="date">7th June 2013, 13:07</div></div><div class="posttext">What it seems to be doing is putting the key at the top in the shell &quot;folder&quot;<br />
so under the shell &quot;folder&quot; it displays:<br />
My Program<br />
removeproperties<br />
<br />
don't know why it's installing it at the top.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">7th June 2013, 21:48</div></div><div class="posttext">Maybe you could post the contents of a regedit exported .reg of HKCR\Directory?<br />
<br />
You could also try adding a dword called NeverDefault under ..\shell\mything</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th June 2013, 23:37</div></div><div class="posttext">Setting the default shell value to none is not a good idea AFAIK, do you know any MSDN docs that say otherwise?&quot;none&quot; is the default value on Windows 7 and 8 (not checked below). Using an empty value rather than &quot;none&quot; changes the default action for folders to one of the commands listed in the registry key. This may be specific to the Directory shell commands list though.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">8th June 2013, 03:13</div></div><div class="posttext">&quot;none&quot; is the default value on Windows 7 and 8 (not checked below). Using an empty value rather than &quot;none&quot; changes the default action for folders to one of the commands listed in the registry key. <br />
OK but since you should not touch the default anyway it is going to be whatever is correct for that version of Windows.<br />
<br />
This may be specific to the Directory shell commands list though.<br />
<br />
This would be my guess as well...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pspjhp</div><div class="date">18th June 2013, 18:28</div></div><div class="posttext">So it looks like the software installs on other computers fine.  I must have messed up my registry somehow, but not sure how...  I'll also try out the DWORD thing...just worrisome of the possibility that it could occur on another person's machine.  Here is the contents of my export.  The 'Run Test Program' is the program that I'm running.<br />
<br />
Windows Registry Editor Version 5.00<br />
<br />
[HKEY_CLASSES_ROOT\Directory]<br />
<br />
[HKEY_CLASSES_ROOT\Directory\Background]<br />
<br />
[HKEY_CLASSES_ROOT\Directory\Background\shell]<br />
<br />
[HKEY_CLASSES_ROOT\Directory\Background\shell\cmd]<br />
@=&quot;@shell32.dll,-8506&quot;<br />
&quot;Extended&quot;=&quot;&quot;<br />
&quot;NoWorkingDirectory&quot;=&quot;&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\Background\shell\cmd\command]<br />
@=&quot;cmd.exe /s /k pushd \&quot;%V\&quot;&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\Background\shellex]<br />
<br />
[HKEY_CLASSES_ROOT\Directory\Background\shellex\ContextMenuHandlers]<br />
<br />
[HKEY_CLASSES_ROOT\Directory\Background\shellex\ContextMenuHandlers\DropboxExt]<br />
@=&quot;{FB314ED9-A251-47B7-93E1-CDD82E34AF8B}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\Background\shellex\ContextMenuHandlers\Gadgets]<br />
@=&quot;{6B9228DA-9C15-419e-856C-19E768A13BDC}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\Background\shellex\ContextMenuHandlers\igfxcui]<br />
@=&quot;{3AB1675A-CCFF-11D2-8B20-00A0C93CB1F4}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\Background\shellex\ContextMenuHandlers\New]<br />
@=&quot;{D969A300-E7FF-11d0-A93B-00A0C90F2719}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\Background\shellex\ContextMenuHandlers\Sharing]<br />
@=&quot;{f81e9010-6ea4-11ce-a7ff-00aa003ca9f6}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\DefaultIcon]<br />
@=hex(2):25,00,53,00,79,00,73,00,74,00,65,00,6d,00,52,00,6f,00,6f,00,74,00,25,\<br />
  00,5c,00,53,00,79,00,73,00,74,00,65,00,6d,00,33,00,32,00,5c,00,73,00,68,00,\<br />
  65,00,6c,00,6c,00,33,00,32,00,2e,00,64,00,6c,00,6c,00,2c,00,33,00,00,00<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shell]<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shell\cmd]<br />
@=&quot;@shell32.dll,-8506&quot;<br />
&quot;Extended&quot;=&quot;&quot;<br />
&quot;NoWorkingDirectory&quot;=&quot;&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shell\cmd\command]<br />
@=&quot;cmd.exe /s /k pushd \&quot;%V\&quot;&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shell\find]<br />
&quot;LegacyDisable&quot;=&quot;&quot;<br />
&quot;SuppressionPolicy&quot;=dword:00000080<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shell\find\command]<br />
@=hex(2):25,00,53,00,79,00,73,00,74,00,65,00,6d,00,52,00,6f,00,6f,00,74,00,25,\<br />
  00,5c,00,45,00,78,00,70,00,6c,00,6f,00,72,00,65,00,72,00,2e,00,65,00,78,00,\<br />
  65,00,00,00<br />
&quot;DelegateExecute&quot;=&quot;{a015411a-f97d-4ef3-8425-8a38d022aebc}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shell\Run Test Program]<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shell\Run Test Program\command]<br />
@=&quot;\&quot;C:\\\\Program Files (x86)\\\\Justin HP\\\\My Test Folder\\\\Test Program.exe\&quot; \&quot;%1\&quot;&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex]<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\ContextMenuHandlers]<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\ContextMenuHandlers\7-Zip]<br />
@=&quot;{23170F69-40C1-278A-1000-000100020000}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\ContextMenuHandlers\AgentRansack]<br />
@=&quot;{2AE9D6D8-E348-4853-B266-C78844D31B97}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\ContextMenuHandlers\DropboxExt]<br />
@=&quot;{FB314ED9-A251-47B7-93E1-CDD82E34AF8B}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\ContextMenuHandlers\EncryptionMenu]<br />
@=&quot;{A470F8CF-A1E8-4f65-8335-227475AA5C46}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\ContextMenuHandlers\Offline Files]<br />
@=&quot;{474C98EE-CF3D-41f5-80E3-4AAB0AB04301}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\ContextMenuHandlers\SavShellExt]<br />
@=&quot;{A3A1D8A1-006D-4B93-BA27-6F6B4C9C4F1D}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\ContextMenuHandlers\Sharing]<br />
@=&quot;{f81e9010-6ea4-11ce-a7ff-00aa003ca9f6}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\ContextMenuHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}]<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\CopyHookHandlers]<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\CopyHookHandlers\FileSystem]<br />
@=&quot;{217FC9C0-3AEA-1069-A2DB-08002B30309D}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\CopyHookHandlers\Sharing]<br />
@=&quot;{40dd6e20-7c17-11ce-a804-00aa003ca9f6}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\DragDropHandlers]<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\DragDropHandlers\7-Zip]<br />
@=&quot;{23170F69-40C1-278A-1000-000100020000}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\PropertySheetHandlers]<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\PropertySheetHandlers\Offline Files]<br />
@=&quot;{7EFA68C6-086B-43e1-A2D2-55A113531240}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\PropertySheetHandlers\Sharing]<br />
@=&quot;{f81e9010-6ea4-11ce-a7ff-00aa003ca9f6}&quot;<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\PropertySheetHandlers\{1f2e5c40-9550-11ce-99d2-00aa006e086c}]<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\PropertySheetHandlers\{4a7ded0a-ad25-11d0-98a8-0800361b1103}]<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\PropertySheetHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}]<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\PropertySheetHandlers\{ECCDF543-45CC-11CE-B9BF-0080C87CDBA6}]<br />
<br />
[HKEY_CLASSES_ROOT\Directory\shellex\PropertySheetHandlers\{ef43ecfe-2ab9-4632-bf21-58909dd177f0}]<br />
@=&quot;&quot;<br />
<br />
<br />
thanks,<br />
Justin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pspjhp</div><div class="date">20th June 2013, 15:52</div></div><div class="posttext">Maybe you could post the contents of a regedit exported .reg of HKCR\Directory?<br />
<br />
You could also try adding a dword called NeverDefault under ..\shell\mything<br />
<br />
That totally worked!  Adding the dword called NeverDefault!  Thanks for that.  I was just thinking, is there anyway to move it up the context menu so it's right under open or whatever the first default is?  Just curious.  This is more like micro-optimization, just have some programs that I installed in the context menu and it put my program underneath them all.<br />
<br />
thanks again!<br />
Justin</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>