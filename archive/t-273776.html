<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installation Directory Restrictions, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installation Directory Restrictions NSIS Discussion" />
	
	<title> Installation Directory Restrictions [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installation Directory Restrictions</div>
<hr />
<div class="pda"><a href="t-273776.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=273776">Installation Directory Restrictions</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">madams</div><div class="date">2nd July 2007, 21:18</div></div><div class="posttext">Hello, <br />
<br />
What I am trying to do is check the installation directory chosen by the user, and if it contains any spaces (ex: Program Files) disable the &quot;next&quot; button and show a message box informing the user that the installation directory may not contain spaces. I know how to disable the &quot;next&quot; button and create a message box, but I can't figure out how to check for spaces in the $INSTDIR variable. <br />
<br />
If anyone knows how to do this, please let me know.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">2nd July 2007, 23:59</div></div><div class="posttext">; ---------------------------------------------------------------<br />
; Function StrOutOfStr <br />
                                                               /*<br />
     Usage:<br />
<br />
       !insertmacro StrOutOfStr     ; for installer<br />
       !insertmacro un.StrOutOfStr  ; for uninstaller<br />
<br />
<br />
     Whithin installer section/function use:<br />
<br />
          ${StrOutOfStr} &quot;Input_String&quot; &quot;String_To_Get&quot; &quot;$var&quot;<br />
               $var = String_To_Get if found<br />
               if not found/error then $var = error<br />
<br />
<br />
     Whithin uninstaller section/function use:<br />
<br />
          ${un.StrOutOfStr} &quot;Input_String&quot; &quot;String_To_Get&quot; &quot;$var&quot;<br />
               $var = String_To_Get if found<br />
               if not found/error then $var = error<br />
                                                               */<br />
<br />
!macro StrOutOfStrFunc UN<br />
Function ${UN}StrOutOfStr<br />
   Exch $0 ;str to get<br />
   Exch<br />
   Exch $1 ;input str<br />
   Push $2<br />
   Push $3<br />
   Push $4<br />
   Push $5<br />
<br />
        StrCpy $3 &quot;0&quot;<br />
        StrLen $4 &quot;$0&quot;<br />
        StrLen $5 &quot;$1&quot;<br />
        IntCmp $4 $5 0 0 _err<br />
        Intop $5 $5 - $4<br />
<br />
  _start:<br />
        StrCpy $2 &quot;$1&quot; $4 $3<br />
        StrCmp &quot;$2&quot; &quot;$0&quot; _done<br />
        IntCmp &quot;$3&quot; &quot;$5&quot; _err<br />
        Intop $3 $3 + 1<br />
        Goto _start<br />
<br />
   _err:<br />
        StrCpy $2 &quot;error&quot;<br />
<br />
  _done:<br />
        StrCpy $0 &quot;$2&quot;<br />
<br />
   Pop $5<br />
   Pop $4<br />
   Pop $3<br />
   Pop $2<br />
   Pop $1<br />
   Exch $0<br />
FunctionEnd<br />
!macroend<br />
<br />
!macro StrOutOfStrCall _UN _INPUT _FIND _RESULT<br />
    Push &quot;${_INPUT}&quot;<br />
    Push &quot;${_FIND}&quot;<br />
    Call ${_UN}StrOutOfStr<br />
    Pop &quot;${_RESULT}&quot;<br />
!macroend<br />
<br />
!macro StrOutOfStr<br />
    !define StrOutOfStr `!insertmacro StrOutOfStrCall &quot;&quot;`<br />
    !insertmacro StrOutOfStrFunc &quot;&quot;<br />
!macroend<br />
<br />
!macro un.StrOutOfStr<br />
    !define un.StrOutOfStr `!insertmacro StrOutOfStrCall &quot;un.&quot;`<br />
    !insertmacro StrOutOfStrFunc &quot;un.&quot;<br />
!macroend<br />
<br />
<br />
;----------------------------------------<br />
; Example of usage<br />
<br />
outfile 'test.exe'<br />
ShowInstDetails show<br />
<br />
!define STRING_TO_GET  &quot; &quot;<br />
<br />
!insertmacro StrOutOfStr<br />
;!insertmacro un.StrOutOfStr<br />
<br />
Section -<br />
    ${StrOutOfStr} &quot;$PROGRAMFILES&quot;  &quot;${STRING_TO_GET}&quot;  &quot;$R0&quot;<br />
     DetailPrint &quot;Search result: [$R0]&quot;<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">madams</div><div class="date">3rd July 2007, 14:23</div></div><div class="posttext">Thanks for the code Red Wine. I'm pretty new to NSIS though, and I'm not totally sure how I'm supposed to use it. If you could give me little bit more usage information, that would be great.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">3rd July 2007, 18:47</div></div><div class="posttext">Don't know what else should I add, it is a function that you can use to find a specific string within a given sting, so it finds the space for your case.<br />
There is a small example of usage as well, just copy/paste and compile the code to see the action.<br />
Furthermore, you said that you know all the rest ;)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>