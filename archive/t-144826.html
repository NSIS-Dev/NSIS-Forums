<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Keeping Window Contents Visible, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Keeping Window Contents Visible NSIS Discussion" />
	
	<title> Keeping Window Contents Visible [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Keeping Window Contents Visible</div>
<hr />
<div class="pda"><a href="t-144826.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=144826">Keeping Window Contents Visible</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">deepThink</div><div class="date">5th August 2003, 19:36</div></div><div class="posttext">I understand to validate a custom page, I am to retrieve the value of success, back, cancel, error, etc.  I have the code working properly as follows:<br />
<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
<br />
exitVideoInstall:<br />
<br />
push $5<br />
!insertmacro MUI_INSTALLOPTIONS_DISPLAY_RETURN &quot;ioB.ini&quot;<br />
Pop $5<br />
<br />
<br />
!insertmacro MUI_INSTALLOPTIONS_READ $R2 &quot;ioB.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_READ $R5 &quot;ioB.ini&quot; &quot;Field 6&quot; &quot;State&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_READ $R3 &quot;ioB.ini&quot; &quot;Field 9&quot; &quot;State&quot;<br />
<br />
;;Check for proper directory names.  If a directory has a &quot;\&quot; at the end of it, remove the &quot;\&quot;<br />
<br />
    strcpy $6 $R2 1 -1<br />
    strcmp $6 &quot;\&quot; &quot;&quot; +2<br />
    	strcpy $R2 $R2 -1 ;Remove &quot;\&quot;<br />
    strcpy $6 $R5 1 -1<br />
    strcmp $6 &quot;\&quot; &quot;&quot; +2<br />
    	strcpy $R5 $R5 -1 ;Remove &quot;\&quot;<br />
    strcpy $6 $R3 1 -1<br />
    strcmp $6 &quot;\&quot; &quot;&quot; +2<br />
    	strcpy $R3 $R3 -1 ;Remove &quot;\&quot;<br />
<br />
;Check to make sure each directory has a &quot;:&quot; as the second character<br />
<br />
    strcpy $6 $R2 1 1<br />
    strcmp $6 &quot;:&quot; &quot;&quot; abortMyPage<br />
    strcpy $6 $R5 1 1<br />
    strcmp $6 &quot;:&quot; &quot;&quot; abortMyPage<br />
    strcpy $6 $R3 1 1<br />
    strcmp $6 &quot;:&quot; exitPage abortMyPage<br />
<br />
    abortMyPage:<br />
        ;Do pop up window if next button is pushed<br />
       	strcmp $5 &quot;success&quot; &quot;&quot; exitPage<br />
    	MessageBox MB_ICONEXCLAMATION|MB_OK 'Your directories must exist on local drives or your \<br />
    	                               network drives must be mapped to a drive letter.  All \<br />
    	                               drives must begin &quot;Z:\&quot; where Z is an appropriate drive \<br />
    	                               letter.'<br />
    	goto exitVideoInstall<br />
<br />
  exitPage:<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
<br />
My problem is that when the MessageBox appears, the contents on the screen behind the MessageBox disappear.  Is there a way to keep the contents in the custom page appearing behind the MessageBox window; similar to what happens when the Cancel button is pushed?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">5th August 2003, 19:54</div></div><div class="posttext">If you use a &quot;leave&quot; function for your custom page and do the validation in the &quot;leave&quot; function then the message box generated by the &quot;leave&quot; function will appear on top of the custom page (so you can still see the custom page contents).<br />
<br />
You need to be using NSIS 2.0b4 in order to be able to use a custom page &quot;leave&quot; function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deepThink</div><div class="date">5th August 2003, 20:28</div></div><div class="posttext">How would I set up the code for that?  Is it similar to the standard LEAVE, SHOW, and PRE set up?  <br />
<br />
Once set up, how do I return to the page if validation fails or continue if validation is successful?<br />
<br />
Also, where would I get the latest version NSIS 2.0b4?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">5th August 2003, 21:04</div></div><div class="posttext">Hopefully these simple code fragments will give you some hints about how to use a leave function with a custom page.<br />
<br />
When listing the pages for your installer, specify a &quot;leave&quot; function for the custom page:!insertmacro MUI_PAGE_DIRECTORY<br />
Page custom MyCustomPage &quot;MyLeaveFunction&quot;In your custom page function, display the custom page:Function MyCustomPage<br />
<br />
  ; Display the custom page<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;demo.ini&quot;<br />
<br />
FunctionEndUse the &quot;leave&quot; function to do your input validation:Function MyLeaveFunction<br />
  Push $R9<br />
  Push $R8<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R9 &quot;demo.ini&quot; &quot;Field 2&quot; &quot;State&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R8 &quot;demo.ini&quot; &quot;Field 4&quot; &quot;State&quot;<br />
<br />
  StrCmp $R9 $R8 bad_data good_data<br />
<br />
bad_data:<br />
  MessageBox MB_OK|MB_ICONEXCLAMATION &quot;Input values cannot be the same&quot;<br />
  ; Stay with the custom page created by &quot;MyCustomPage&quot;<br />
  Pop $R8<br />
  Pop $R9<br />
  Abort<br />
<br />
good_exit:<br />
  ; Allow next page in the installation sequence to be shown<br />
  Pop $R8<br />
  Pop $R9<br />
FunctionEndHope this helps.<br />
<br />
You can download the latest CVS snapshot from http://nsis.sourceforge.net/nightly/nsis.zip</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deepThink</div><div class="date">5th August 2003, 22:37</div></div><div class="posttext">When I put a MessageBox (just for checking purposes) in my validating function that is supposed to trigger when the user leaves the custom page, the MessageBox pops up upon coming into the page, not upon leaving it.  It appears to be a PRE trigger and not a LEAVE trigger.  Is this an error?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deepThink</div><div class="date">5th August 2003, 22:43</div></div><div class="posttext">When I put a MessageBox (just for checking purposes) in my validating function that is supposed to trigger when the user leaves the custom page, the MessageBox pops up upon coming into the page, not upon leaving it.  It appears to be a PRE trigger and not a LEAVE trigger.  Is this an error?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">6th August 2003, 00:25</div></div><div class="posttext">If you want to display a message box when you leave the custom page, you can put it in the custom page function, after the MUI_INSTALLOPTIONS_DISPLAY (or MUI_INSTALLOPTIONS_DISPLAY_RETURN if that is what you are using).Function MyCustomPage<br />
<br />
  ; Display the custom page<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;demo.ini&quot;<br />
<br />
  MessageBox MB_OK &quot;Good-bye&quot;<br />
<br />
FunctionEndThe &quot;Good-bye&quot; message box should be seen after &quot;good&quot; data has been entered (i.e. if the &quot;leave&quot; function exits normally, without using the &quot;Abort&quot; command).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deepThink</div><div class="date">6th August 2003, 11:15</div></div><div class="posttext">What happened was I put the leave callback function on the custom page right before the custom page that I wanted to insert it onto, thus, making it appear as though the function was being called as a pre callback.<br />
<br />
It works fine now.  Thanks much for your input.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">6th August 2003, 12:30</div></div><div class="posttext">Glad I was able to help.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>