<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Gradual progress bar when install applications silently, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Gradual progress bar when install applications silently NSIS Discussion" />
	
	<title> Gradual progress bar when install applications silently [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Gradual progress bar when install applications silently</div>
<hr />
<div class="pda"><a href="t-318114.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318114">Gradual progress bar when install applications silently</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jdt2oo7</div><div class="date">2nd April 2010, 00:12</div></div><div class="posttext">Hello all,<br />
<br />
I've been looking through progress bar threads in this forum and haven't find what I need yet. I have an installer which installs a few applications base on user's selection. <br />
<br />
The problem I am having: if an application A is installing silently, the progress status doesn't increase until installation is completed, or just barely increase that user can't even notice. For example, at the beginning of application A installation, progress is positioned at 8%, then after installation, it would jumps to 15%. One application could take up to 2 minutes to install, and since there is no increase in progress bar, it gives user an impression that the installation hangs.<br />
<br />
Number of applications to be installed varies depend on user's selection so I can't pre-defined the percentage of progress bar to each app.<br />
<br />
Any help/pointer is greatly appreciate.<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">2nd April 2010, 02:29</div></div><div class="posttext">You could pop up a little dialog with a marquee style progressbar (the kind that runs from left to right indefinitely) using Nxs:<br />
http://nsis.sourceforge.net/Nxs_plug-in<br />
<br />
Just pop it up before you install the app and close it when done.<br />
<br />
If you're installing a bunch of things in silent mode one after the other, you can use its update function to change the text displayed, or get the window handle and play with the controls from there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jdt2oo7</div><div class="date">2nd April 2010, 23:17</div></div><div class="posttext">Thanks Animaether!<br />
<br />
1. Do you know if there is an option to disable the blue screen display in the background &quot;^Name Setup&quot; ?<br />
<br />
2. I want to have an option for user to hide the progress bar if they don't want to see it anymore.<br />
<br />
nxs::Show /NOUNLOAD &quot;$(Installing)...&quot; /top &quot;$(Installing)...&quot; /h 0 /can 1 /marquee 50 /end<br />
<br />
nxs::getWindow /NOUNLOAD<br />
Pop $0                                        ; $0 now contains the handle to the dialog<br />
GetDlgItem $1 $0 2                       ; button=2; top=8; progress=10; sub=11; icon=12<br />
SendMessage $1 ${WM_SETTEXT} 1 &quot;STR:&amp;Hide&quot;    ; Change button label &amp;Cancel to &amp;Hide<br />
StrCpy $1 -1<br />
<br />
ExecWait &quot;Setup.exe /S&quot; $ExitCode5<br />
<br />
sleep:<br />
IntOp $1 $1 + 1<br />
Sleep $1<br />
<br />
nxs::HasUserAborted /NOUNLOAD<br />
Pop $0                                 ; $0 now contains &quot;1&quot; if user clicked Cancel or &quot;0&quot; otherwise.<br />
StrCmp $0 1 destroy<br />
StrCmp $1 100 0 sleep<br />
<br />
destroy:<br />
nxs::Destroy<br />
<br />
----------<br />
The problem is I use &quot;ExecWait&quot;, so it won't able to check if user click &quot;Hide&quot; button.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jdt2oo7</div><div class="date">3rd April 2010, 01:26</div></div><div class="posttext">I able to disable the background (question 1 above).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">3rd April 2010, 01:35</div></div><div class="posttext">The big gradiented blue background is unrelated to NxS - it's just part of the example files.  Here's a more minimal example.<br />
<br />
Name &quot;Nxs example&quot;<br />
<br />
!addplugindir &quot;.&quot;<br />
!include &quot;MUI2.nsh&quot;<br />
!include &quot;WinMessages.nsh&quot;<br />
<br />
XPStyle on ; Required for Marquee-style progressbars! already defined in MUI, but just in case...<br />
ShowInstDetails show<br />
<br />
OutFile &quot;test.exe&quot;<br />
<br />
Page instfiles<br />
<br />
<br />
!define MUI_CUSTOMFUNCTION_GUIINIT onGuiInit<br />
<br />
Function onGUIInit<br />
  ; plug-in requires this to be called in .onGUIInit<br />
  ; if you use it in the .onInit function.<br />
  ; If you leave it out the installer dialog will be minimized.<br />
  ShowWindow $HWNDPARENT 2<br />
FunctionEnd<br />
<br />
Section<br />
	StrCpy $0 &quot;Windows Installer&quot;<br />
	DetailPrint &quot;Installing $0&quot;<br />
	nxs::Show /NOUNLOAD `$(^Name) Setup` /top `Installing third party software$\r$\nPlease wait...` /sub `$\r$\n$\r$\n$0` /h 0 /marquee 30 /end<br />
	Sleep 3000 ; simulate installing something...<br />
<br />
	StrCpy $0 &quot;Microsoft .NET Framework&quot;<br />
	DetailPrint &quot;Installing $0&quot;<br />
	nxs::Update /NOUNLOAD /sub `$\r$\n$\r$\n$0` /h 0 /marquee 30 /end<br />
	Sleep 3000 ; simulate installing something...<br />
<br />
	StrCpy $0 &quot;SUN Java Run-Time Environment&quot;<br />
	DetailPrint &quot;Installing $0&quot;<br />
	nxs::Update /NOUNLOAD /sub `$\r$\n$\r$\n$0` /h 0 /marquee 30 /end<br />
	Sleep 3000 ; simulate installing something...<br />
<br />
	nxs::Destroy<br />
SectionEnd<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
<br />
If you want to hide the progressbar, then check whether the user has aborted, destroy the dialog, and set a little variable that you can check that so that you won't open/update/destroy it when it no longer exists.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>