<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" question about installation folder on win7, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  question about installation folder on win7 NSIS Discussion" />
	
	<title> question about installation folder on win7 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  question about installation folder on win7</div>
<hr />
<div class="pda"><a href="t-319795.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=319795">question about installation folder on win7</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kobolds</div><div class="date">9th June 2010, 10:20</div></div><div class="posttext">I having some confuse with installation folder on win7 client pc in network environment<br />
<br />
if I want to install my program on C:\Program Files\myprog then I will need administrator password . <br />
after I install when I try to run my program I get error cause my program can't create files in the installed folder . I need administrator  to run my program without problem.<br />
<br />
what should I do cause I don't want user to run my program as admin  .<br />
<br />
I found that if I change the installation path to c:\myprog , I can install it as user and run it as user without any problem . <br />
<br />
is this the correct way ? I don't think install c: root is correct way<br />
<br />
any advice?:confused:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th June 2010, 10:41</div></div><div class="posttext">Per user applications shouldn't be installed in Program Files, they should go in $APPDATA or somewhere like that.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kobolds</div><div class="date">9th June 2010, 12:27</div></div><div class="posttext">Per user applications shouldn't be installed in Program Files, they should go in $APPDATA or somewhere like that.<br />
<br />
Stu<br />
<br />
Nope , this is not per user application . <br />
<br />
I don't have any problem on winxp client pc . not sure what is the best solution that can work on xp and win7. <br />
<br />
I don't want endup with 2 different installation</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">9th June 2010, 12:47</div></div><div class="posttext">There are two things you can do. First, you can test the selected installation directory for writing privileges, and if the user doesn't have them do not allow installation there. I've pasted some code that checks this here: http://forums.winamp.com/showthread.php?t=317018<br />
Second, you can create your app's (config?) files during installation and use the accesscontrol plugin to give all users write access to those files.<br />
<br />
(Note that it is a very bad idea to give all users write access to the whole installation directory! The admin would believe that, since the dir is in Program Files, it's a safe directory. He then might end up admin-running an .exe that was infected or otherwise compromised by a regular user.)<br />
<br />
<br />
Edit: actually, both these methods are wrong. What you SHOULD do is to change your application to save files to MyDocs or AppData, instead of $instdir.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">9th June 2010, 12:51</div></div><div class="posttext">settings really shouldn't be written in the program folder under any case - that is what XP started (though poorly enforced) and Vista/Win7 have properly enforced this requirement with the need for admin access to write into the program files directory.<br />
<br />
like stu says, using the appdata folder is the norm / suggested way for dealing with settings.<br />
<br />
from a bit more looking (as i couldn't remember it after last looking into this early last year), CSIDL_COMMON_APPDATA (used with the SHGetSpecialFolderPath OS api function - can't remember if NSIS does this natively or only via the system plug-in) is the equivalent place for saving a programs settings but in a folder with the correct access (works on Win2k and higher and seems to be valid under Win9x as well).<br />
<br />
for XP this typically maps to C:\Documents and Settings\All Users\Application Data and with Vista / Win7 it goes to C:\ProgramData<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">9th June 2010, 13:00</div></div><div class="posttext">That would be either $LOCALAPPDATA or $APPDATA, using shellvarcontext all. Can't remember which one.<br />
<br />
Edit: Although it's not guaranteed that that folder is world-writable. If an admin creates a directory there, he gets ownership and users are left hanging.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">9th June 2010, 13:04</div></div><div class="posttext">for NSIS and reading the docs i'd expect it to be $APPDATA with SetShellVarContext all.<br />
<br />
though really the app needs to be changed to be more compliant than having the installer fiddling things as if the app isn't working correctly and not following things then it really doesn't matter what the installer does as it won't really have any effect.<br />
<br />
-daz</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>