<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" install winpcap from installer, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  install winpcap from installer NSIS Discussion" />
	
	<title> install winpcap from installer [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  install winpcap from installer</div>
<hr />
<div class="pda"><a href="t-302462.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=302462">install winpcap from installer</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">26th January 2009, 21:12</div></div><div class="posttext">Hi<br />
<br />
I am trying to install WinpCap from within the installer.  I used 7-zip to extract the installer (another NSIS installer), and placed those files into a system and system\drivers folder.  Would installing it that way suffice?  <br />
<br />
Or should I launch it's own installer?<br />
<br />
Please advise.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">26th January 2009, 21:23</div></div><div class="posttext">Don't know what is WinpCap but if originally it installs into system folder, probably installs registry entries as well. That you must include in your installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">26th January 2009, 21:41</div></div><div class="posttext">So using regdll won't be enough?<br />
how do i call an external NSIS installer then?<br />
<br />
it installs essentially four dll files into System32, and a sys file into system32\drivers.<br />
<br />
Looking in registry just one entry for uninstall info, one entry in HKLM software with just the name.<br />
<br />
and under services, a daemon gets installed: expert is:<br />
<br />
Windows Registry Editor Version 5.00<br />
<br />
[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\rpcapd]<br />
&quot;Type&quot;=dword:00000010<br />
&quot;Start&quot;=dword:00000003<br />
&quot;ErrorControl&quot;=dword:00000001<br />
&quot;ImagePath&quot;=hex(2):22,00,25,00,50,00,72,00,6f,00,67,00,72,00,61,00,6d,00,46,00,\<br />
  69,00,6c,00,65,00,73,00,25,00,5c,00,57,00,69,00,6e,00,50,00,63,00,61,00,70,\<br />
  00,5c,00,72,00,70,00,63,00,61,00,70,00,64,00,2e,00,65,00,78,00,65,00,22,00,\<br />
  20,00,2d,00,64,00,20,00,2d,00,66,00,20,00,22,00,25,00,50,00,72,00,6f,00,67,\<br />
  00,72,00,61,00,6d,00,46,00,69,00,6c,00,65,00,73,00,25,00,5c,00,57,00,69,00,\<br />
  6e,00,50,00,63,00,61,00,70,00,5c,00,72,00,70,00,63,00,61,00,70,00,64,00,2e,\<br />
  00,69,00,6e,00,69,00,22,00,00,00<br />
&quot;DisplayName&quot;=&quot;Remote Packet Capture Protocol v.0 (experimental)&quot;<br />
&quot;ObjectName&quot;=&quot;LocalSystem&quot;<br />
&quot;Description&quot;=&quot;Allows to capture traffic on this machine from a remote machine.&quot;<br />
<br />
[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\rpcapd\Security]<br />
&quot;Security&quot;=hex:01,00,14,80,90,00,00,00,9c,00,00,00,14,00,00,00,30,00,00,00,02,\<br />
  00,1c,00,01,00,00,00,02,80,14,00,ff,01,0f,00,01,01,00,00,00,00,00,01,00,00,\<br />
  00,00,02,00,60,00,04,00,00,00,00,00,14,00,fd,01,02,00,01,01,00,00,00,00,00,\<br />
  05,12,00,00,00,00,00,18,00,ff,01,0f,00,01,02,00,00,00,00,00,05,20,00,00,00,\<br />
  20,02,00,00,00,00,14,00,8d,01,02,00,01,01,00,00,00,00,00,05,0b,00,00,00,00,\<br />
  00,18,00,fd,01,02,00,01,02,00,00,00,00,00,05,20,00,00,00,23,02,00,00,01,01,\<br />
  00,00,00,00,00,05,12,00,00,00,01,01,00,00,00,00,00,05,12,00,00,00</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">26th January 2009, 21:45</div></div><div class="posttext">Originally posted by Red Wine <br />
Don't know what is WinpCap but if originally it installs into system folder, probably installs registry entries as well. That you must include in your installer.  <br />
<br />
WinPCap captures ethernet data, part of Ethereal/Wireshark.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">26th January 2009, 21:57</div></div><div class="posttext">Installing drivers/devices/services etc is more complicated procedure. Most likely you'll find valuable info searching the forum and wiki.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">26th January 2009, 22:01</div></div><div class="posttext">Is it possible to just install the installer from my nsis script?<br />
<br />
i prefer this to be auytomated and behind the scenes like how one can do with msi files/ or .net.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">26th January 2009, 22:02</div></div><div class="posttext">This is old, but I found it on winPcap website: http://www.winpcap.org/pipermail/winpcap-users/2005-August/000235.html</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">26th January 2009, 22:26</div></div><div class="posttext">It seems a silent installer is impossible.<br />
<br />
So essentially, this is my new question.<br />
<br />
1. How do I determine if winpcap 4.0.2 is isntalled.<br />
2. If it is, skip and go on.<br />
3. If it isn't launch it's own installer and enduser will use its GUI, when that is done, nsis installer goes on.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">27th January 2009, 13:04</div></div><div class="posttext">If winPcap installer is a nsis installer must accept the /S parameter unless the developer strictly disallow it.<br />
<br />
How to determine if winPcap is already installed?<br />
Looking for the running service.<br />
Looking for registry entries.<br />
Looking for specific files into system directory.<br />
etc (I guess)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">28th January 2009, 04:07</div></div><div class="posttext">my understanding the developer disabled silent installs.<br />
so i guess launch the installer and allow it to install as normal, or just put the installer on the install disc andlet the enduser install it manually are prolly the best two options..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">28th January 2009, 15:25</div></div><div class="posttext">is this how the /S is invoked in this case?<br />
<br />
ExecWait `&quot;$EXEDIR\WinpCap\WinPcap_4_0_2.exe&quot; /S` $R0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">28th January 2009, 22:30</div></div><div class="posttext">GetDllVersion &quot;$SYSDIR\Packet.dll&quot; $R0 $R1<br />
   IntOp $R2 $R0 / 0x00010000<br />
   IntOp $R3 $R0 &amp; 0x0000FFFF<br />
   IntOp $R4 $R1 / 0x00010000<br />
   IntOp $R5 $R1 &amp; 0x0000FFFF<br />
   StrCpy $0 &quot;$R2.$R3.$R4.$R5&quot;<br />
   MessageBox MB_OK $0<br />
<br />
  ; 4.0.0.1040<br />
  ${If} $0 == &quot;4.0.0.1040&quot;<br />
  Goto go_on_further<br />
  ${Else}<br />
  SetDetailsPrint textonly<br />
  DetailPrint &quot;Installing WinPcap 4.02...&quot;<br />
  SetDetailsPrint none<br />
  ExecWait `&quot;$EXEDIR\WinpCap\winpcap-nmap-4.02.exe&quot; /S` $R0<br />
  ${EndIf}<br />
<br />
<br />
Allright, this seems to work on my PC, but it doesn't work on anyone elses machine.  If I have winpcap installed it won't install it again, if i don't have it, it will install it.  <br />
<br />
it does so silently since i got the silent-able version from nmap.<br />
<br />
if it isnt there, the file version is 0.0.0.0, but if it is the proper version - it skips it- rather, if it is there, it does indeed show the file version.<br />
<br />
not too sure why it isn't going into the else function.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>