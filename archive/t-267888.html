<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Too heavy on Win98, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Too heavy on Win98 NSIS Discussion" />
	
	<title> Too heavy on Win98 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Too heavy on Win98</div>
<hr />
<div class="pda"><a href="t-267888.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267888">Too heavy on Win98</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Mark Nascimento</div><div class="date">16th March 2007, 17:58</div></div><div class="posttext">Please, take a look at this script. When running on Win98,<br />
one on a 1.4 GHz, 256MBram, cache64+64 an on other 1.3 GHz, 64, cache 128+128,<br />
the computer, after some minutes, and running other apps,<br />
shows message box &quot;explorer executed an non authoryzed...&quot;<br />
and closes the explorer, IE and all other running processes,<br />
one by one, in sequence. (on both computers, in different places, independent, both win98SE)<br />
<br />
So, SLEEP stops the use of core while sleeping?<br />
Is there a way to make this script lighter or<br />
not to cause crash?<br />
<br />
<br />
<br />
OutFile &quot;..\Monitorador.exe&quot;<br />
Name &quot;Monitorador&quot;<br />
!include WinMessages.nsh<br />
;LoadLanguageFile &quot;D:\Roteiro\PORTUGUESEBR.NLF&quot;<br />
;Icon clip.ico<br />
SilentInstall Silent<br />
Page Instfiles<br />
<br />
<br />
Section<br />
############# Allow only one installer instance  =System::Call &quot;kernel32::CreateMutexA(i 0, i 0, t '$(^Name)') i .r0 ?e&quot;<br />
System::Call &quot;kernel32::CreateMutexA(i 0, i 0, t '$(^Name)') i .r0 ?e&quot;<br />
Pop $R0<br />
StrCmp $R0 0 DoRunInstall<br />
Banner::show /NoUnload &quot;O Monitorador jÃ¡ estÃ¡ aberto !&quot;<br />
Sleep 2000<br />
Banner::Destroy<br />
Abort<br />
DoRunInstall:<br />
########## Baixar prioridade - lower priority<br />
System::Call &quot;kernel32::GetCurrentProcess() i .s&quot;<br />
System::Call &quot;kernel32::SetPriorityClass(i s, i 0x00000040)&quot;<br />
########## Indicar que estÃ¡ ligado para o Proxy do Papai (botÃ£o 23)<br />
<br />
########## VÃª o que estÃ¡ lÃ¡ para nÃ£o lanÃ§ar de arranque.See what is in clipboard for not launch on start<br />
Delete &quot;$temp\mt.ini&quot;<br />
WriteIniStr &quot;$temp\mt.ini&quot; 1 2 Ligado<br />
System::Call 'user32::OpenClipboard(i 0)'<br />
System::Call 'user32::GetClipboardData(i 1) t .r0'<br />
System::Call &quot;user32::CloseClipboard()&quot;<br />
Pop $0<br />
WriteIniStr &quot;$temp\mt.ini&quot; 1 1 $0<br />
########## Iniciar o Looping - start looping/watching<br />
loop:<br />
ReadIniStr $2 &quot;$temp\mt.ini&quot; 1 2<br />
StrCmp $2 desligar Fechar   ;TrocarProxy.exe will close Monitorador, if I want, at any time, writing this line<br />
Sleep 2000<br />
System::Call 'user32::OpenClipboard(i 0)'<br />
System::Call 'user32::GetClipboardData(i 1) t .r0'<br />
System::Call &quot;user32::CloseClipboard()&quot;<br />
Pop $0<br />
ReadIniStr $9 &quot;$temp\mt.ini&quot; 1 1<br />
StrCmp $0 $9 loop  ; 9 Ã© o original<br />
########## Agora, ver se o dado HTTP Ã© vÃ¡lido: LetÂ´s see if it is http<br />
StrCpy $1 $0 7<br />
StrCmp $1 &quot;http://&quot; 0 naoehttp<br />
ClearErrors<br />
Rename &quot;$exedir\TrocarProxy.exe&quot; &quot;$exedir\TrocarProxy.exe&quot;<br />
IfErrors 0 +2<br />
fct::fct /WC '#32770' /WT &quot;Proxy do Papai&quot;<br />
WriteIniStr &quot;$temp\mt.ini&quot; 1 1 $0   ;  What is in clipboard becomes original<br />
WriteINIStr &quot;$exedir\n.ini&quot; &quot;Field 41&quot; Text &quot;Do Monitorador&quot;<br />
Exec &quot;$exedir\TrocarProxy.exe&quot;  ; The app that waits to be launched<br />
GoTo loop<br />
########## Agora, ver se o dado PROXY Ã© vÃ¡lido: see if proxy is valid, by my criteria<br />
naoehttp:<br />
StrCpy $1 $0 1 -6<br />
StrCmp $1 &quot;:&quot; certo1 ;OK 1<br />
StrCpy $1 $0 1 -5<br />
StrCmp $1 &quot;:&quot; certo1<br />
StrCpy $1 $0 1 -4<br />
StrCmp $1 &quot;:&quot; certo1<br />
StrCpy $1 $0 1 -3<br />
StrCmp $1 &quot;:&quot; certo1 loop<br />
certo1:<br />
StrCpy $1 $0 &quot;&quot; -2<br />
intop $2 $1 / $1<br />
StrCmp $2 1 0 loop  ;ver se Ã© nÃºmero-is it a number?<br />
StrCmp $1 80 certo          ;- Portas permitidas (dezena e unidade.) ALLOWED terminations<br />
StrCmp $1 28 certo          ;- Portas permitidas (Centena em diante Ã© irrelevante)<br />
StrCmp $1 08 certo          ;- Portas permitidas<br />
StrCmp $1 50 certo          ;- Portas permitidas<br />
StrCmp $1 24 certo          ;- Portas permitidas<br />
StrCmp $1 88 certo          ;- Portas permitidas<br />
StrCmp $1 27 certo          ;- Portas permitidas<br />
GoTo loop<br />
########## If wrong,  loop. If right, certo.<br />
certo:<br />
########## Trocar proxy is already opened?<br />
ClearErrors<br />
Rename &quot;$exedir\TrocarProxy.exe&quot; &quot;$exedir\TrocarProxy.exe&quot;<br />
IfErrors 0 SemRever<br />
ReadIniStr $2 &quot;$temp\mt.ini&quot; 1 2<br />
StrCmp $2 desligar Fechar  ;TrocarProxy.exe will close Monitorador, if I want, at any time, writing this line<br />
fct::fct /WC '#32770' /WT &quot;Proxy do Papai&quot;<br />
SemRever:<br />
########## Mudar o proxy - change proxy<br />
WriteRegDWORD HKU &quot;.DEFAULT\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot; &quot;ProxyEnable&quot; 1<br />
WriteRegDWORD HKLM &quot;Config\0001\Software\Microsoft\windows\CurrentVersion\Internet Settings&quot; &quot;ProxyEnable&quot; 1<br />
WriteRegDWORD HKCU &quot;Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot; &quot;ProxyEnable&quot; 1<br />
WriteRegStr HKCU &quot;Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot; &quot;ProxyServer&quot; &quot;$0&quot;<br />
WriteRegStr HKU &quot;.DEFAULT\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot; &quot;ProxyServer&quot; &quot;$0&quot;<br />
########## Mudar config da interface para ligar configurado - Change interface of TrocarProxy.exe<br />
WriteIniStr &quot;$exedir\n.ini&quot; &quot;Field 10&quot; &quot;State&quot; 0<br />
WriteINIStr &quot;$exedir\n.ini&quot; &quot;Field 11&quot; &quot;Flags&quot; &quot;Notify|DISABLED&quot;<br />
WriteINIStr &quot;$exedir\n.ini&quot; &quot;Field 2&quot; &quot;Flags&quot; &quot;&quot;<br />
WriteINIStr &quot;$exedir\n.ini&quot; &quot;Field 3&quot; &quot;Flags&quot; &quot;Notify&quot;<br />
WriteINIStr &quot;$exedir\n.ini&quot; &quot;Field 41&quot; Text &quot;Do Monitorador&quot;<br />
WriteIniStr &quot;$temp\mt.ini&quot; 1 1 $0   ; O que estÃ¡ no clipboard passa a ser original.<br />
Exec &quot;$exedir\TrocarProxy.exe&quot;<br />
GoTo loop<br />
<br />
Fechar:<br />
Delete &quot;$temp\mt.ini&quot;<br />
<br />
sectionend<br />
autoclosewindow true</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">16th March 2007, 18:26</div></div><div class="posttext">I think would help if you disable this 'SilentInstall Silent' and enable 'ShowInstDetails show' to see if the target systems crash at the same point of script execution.<br />
<br />
BTW what exactly does this: <br />
Rename &quot;$exedir\TrocarProxy.exe&quot; &quot;$exedir\TrocarProxy.exe&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">16th March 2007, 18:54</div></div><div class="posttext">might be unrelated, but some of my scripts only worked properly on win9x if i used &quot;s for all variables</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mark Nascimento</div><div class="date">16th March 2007, 19:00</div></div><div class="posttext">Rename trocarproxy.exe  trocarproxy.exe<br />
is the most safe way to see if  trocarproxy.exe is<br />
currently running. I tryied all other ways but,<br />
early or later, fails.<br />
Rename a file by itself NEVER FAILED.<br />
<br />
This crash only happens when this script is active,<br />
and almost always. (not ALL the times.)<br />
<br />
It always crashes when screensave activates.<br />
<br />
It always crashes when Explorer.exe (or IE, or IE and Explorer.exe) is on and I open<br />
Excell (2K) AND Word (2K).<br />
<br />
What you Mean? Is it like put a detailprint after each<br />
action to see if the crash occurs always at the same point?<br />
I think IÂ´ll try to write this on registry or inifile, because when it crashes, I can do nthing else but press<br />
reset (that buton that indian woman have above and between the eyes).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mark Nascimento</div><div class="date">16th March 2007, 19:23</div></div><div class="posttext">Tell me more. How &quot;s ?<br />
Is it<br />
var s1<br />
var s2 ;etc<br />
instead of $1, $2  etc ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mark Nascimento</div><div class="date">16th March 2007, 19:29</div></div><div class="posttext">Tell me more. How &quot;s ?<br />
Is it<br />
var s1<br />
var s2 ;etc<br />
instead of $1, $2  etc ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mark Nascimento</div><div class="date">16th March 2007, 19:39</div></div><div class="posttext">Undesrstood you question.<br />
Rename itself, in this case, is useless.<br />
ThatÂ´s because there WAS a MB_YESNO after IfErrors,<br />
asking if close it and restart or leave as is.<br />
Now, only closes TrocarProxy.exe.<br />
<br />
PLEASE !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">16th March 2007, 20:31</div></div><div class="posttext">For me is difficult reading a script to follow the the logic and determine if there is something improper or incorrect, plus I haven't access to any 9x/Me machine so I can't go further with this.<br />
So all I can say is what I'd do if I had the problem, try to debug it.<br />
<br />
BTW In my neighborhood lives a family from India (you know India? that big country in south Asia with the ancient civilization), these people are my friends, I can assure you that aside from the fact that they are nice and gently persons, they look ordinary (no buttons).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mark Nascimento</div><div class="date">16th March 2007, 23:27</div></div><div class="posttext">Thank you.<br />
I'll try this.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>