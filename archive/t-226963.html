<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Check if program is already installed, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Check if program is already installed NSIS Discussion" />
	
	<title> Check if program is already installed [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Check if program is already installed</div>
<hr />
<div class="pda"><a href="t-226963.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=226963">Check if program is already installed</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Paddy82</div><div class="date">26th September 2005, 12:50</div></div><div class="posttext">Hi all,<br />
<br />
how do I proof if my Programm is already installed on the PC and make then a messagebox like &quot;The Programm you want to install is already installed. Do you want to uninstall it first? yes no (2 Buttons)&quot;<br />
<br />
I hope anyone of you knows the answer to my question.<br />
<br />
Thanks a lot,<br />
<br />
greetings Paddy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th September 2005, 13:16</div></div><div class="posttext">Well how would you know the program is installed?<br />
<br />
What does your program add to the system to show that it's installed - e.g. registry entries?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Paddy82</div><div class="date">26th September 2005, 14:32</div></div><div class="posttext">The problem is, that the group policies of our company always regenerates the registry and the entries, which my Installation made are not still in the registry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th September 2005, 15:11</div></div><div class="posttext">I see. Where would your program be located. Will any of its files be in a fixed folder / location?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">26th September 2005, 15:16</div></div><div class="posttext">You can search computer hard disks for specific file names.<br />
This (http://nsis.sourceforge.net/wiki/FindIt:_Simple_search_for_file_/_directory) , this (http://nsis.sourceforge.net/wiki/Search_For_a_File) or this (http://nsis.sourceforge.net/wiki/Search_for_a_File_or_Directory_%28Alternative%29) links can help you with file searching.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MichaelFlya</div><div class="date">27th September 2005, 04:33</div></div><div class="posttext">Well, easy and fast does it best.<br />
<br />
<br />
<br />
Function FunctionName<br />
    IfFileExists &quot;$INSTDIR\Program.exe&quot; Ask_Question<br />
     Goto INSTALL<br />
<br />
    Ask_Question:<br />
     MessageBox MB_YESNO &quot;You seem to have this program \<br />
                          already installed. Would you like to \<br />
                          uninstall it first?&quot; \<br />
                          IDYES UNINSTALL IDNO INSTALL<br />
<br />
    UNINSTALL:<br />
     ExecWait '&quot;$INSTDIR\Uninstaller.exe&quot;'<br />
<br />
    INSTALL:<br />
FunctionEnd<br />
<br />
-MichaelFlya-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">27th September 2005, 11:25</div></div><div class="posttext">2MichaelFlya<br />
How are you detect $INSTDIR?<br />
The problem is, that the group policies of our company always regenerates the registry and the entries, which my Installation made are not still in the registry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MichaelFlya</div><div class="date">27th September 2005, 15:50</div></div><div class="posttext">Why look at it that complicated? The user installs<br />
where they do, then the program is told what $INSTDIR<br />
is. It just depends on whether or not you set it after<br />
the directory page or not and if you use a directory<br />
page. Paddy82 knows what files are installed that are<br />
constantly there. This doesn't use reg entry so it<br />
wouldn't get erased like Paddy82 was explaining.<br />
<br />
If the installer must detect the install directory before<br />
the directory page then have a note pad or xml installed<br />
and parse it. You can use what you grab and store it as<br />
the $INSTDIR var. This is also file based and will not be<br />
erased like the registry would be when it is regenerated<br />
from their group policy function.<br />
<br />
-MichaelFlya-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">madden</div><div class="date">27th September 2005, 23:23</div></div><div class="posttext">The program is installed if it appears in the Add/Remove programs list in Control Panel.<br />
<br />
If it does not, it is not installed or is not corectly installed.<br />
<br />
And if the OP can not use the registry I think he/she can use <br />
$COMMONFILES\${COMPANY}\${PRODUCT}\Install.log (or some other file in that directory) to see if his/her executables are there and where they are. And after any successful install, the installer should output the user-selected (or otherwise the default) path to executables in the Install.log file<br />
<br />
Adrian Constantin<br />
Romania</div></div><hr />


<div class="post"><div class="posttop"><div class="username">madden</div><div class="date">27th September 2005, 23:35</div></div><div class="posttext">Or maybe<br />
<br />
SetShellVarContext all <br />
 and then look for and read<br />
$APPDATA\${COMPANY}\${PRODUCT}\Install.log<br />
<br />
if the user is on Win2000 or later or otherwise if he/she has SHFolder.dll redistributable (from Microsoft or form IE5) installed in $SYSDIR.<br />
<br />
By the way, currently Microsoft suggests not using the registry to store application configuration data because it does not support roaming profiles. Instead some .ini or .xml files in $APPDATA should be used. Can you believe it ?<br />
<br />
Adrian Constantin<br />
Romania</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>