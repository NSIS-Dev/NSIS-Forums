<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Open port on XP firewall, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Open port on XP firewall NSIS Discussion" />
	
	<title> Open port on XP firewall [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Open port on XP firewall</div>
<hr />
<div class="pda"><a href="t-228229.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228229">Open port on XP firewall</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">fabiochelly</div><div class="date">12th October 2005, 09:35</div></div><div class="posttext">Hi,<br />
<br />
How can I check if the XP Firewall is enabled and if a port is open?<br />
<br />
And if it is not, is it possible to open it from my NSIS script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">12th October 2005, 10:38</div></div><div class="posttext">Well it is possible to open a port on the XP firewall(SP21 AND SP2!) , it took me three months to figure it out, and i'm quite experienced in programming. I will not give you any code since this can be mis-used also. So, it IS possible without user intervention to open a port via client software. A NSIS plugin could be created since it involves a LOT of low level stuff. So if you really want it you know you can have success, maybe tht is good motivation.<br />
<br />
My advise is however you should refrase your question and tell us what you want to achieve, it is possible that there is a better way... because the path you want to walk no will be loooong an difficult.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lel</div><div class="date">7th July 2006, 11:11</div></div><div class="posttext">and what if I want to ask the user to open the port during install time, and without launching my app?<br />
thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">8th July 2006, 01:20</div></div><div class="posttext">Try this and see if it helps:<br />
http://support.microsoft.com/default.aspx?kbid=875357<br />
<br />
Toward the bottom of the article, it describes a command line tool called NetSh that you might be able to take advantage of. However, it will require that your installation is run under and administrator account.  <br />
<br />
The one problem I see is that the Windows firewall is only one of many available firewall products available to users.  Seems to me it would be better to address these issues from within the application (not the installation).  But that's just my opinion.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">8th July 2006, 11:40</div></div><div class="posttext">it would be too easy for malware to open any port in windows firewall - lol<br />
but if it works - lmao - but windows firewall ist the worst firewall you can use - all leaktests passed this crap wall</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">8th July 2006, 16:16</div></div><div class="posttext">A lot of open source p2p apps can open ports in the xp firewall so not showing the code bcuz of security is wrong IMHO</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">9th July 2006, 10:47</div></div><div class="posttext">I know, and if a lot of open source p2p apps do this, why not use that code as example then? I think I'm still entitled not to show my code since IMHO it can be used to disadvantage by some others.<br />
<br />
Do not forget a customer has a firewall for a reason: to prevent mis-use.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">QuaKx</div><div class="date">13th July 2006, 10:56</div></div><div class="posttext">IMHO: If you don't have anything to say: Don't.<br />
This took me 30 min to create. And I seems to work fine.<br />
<br />
Hope it helps!<br />
<br />
<br />
Function OpenFWPort<br />
   Var /global PORT<br />
   <br />
   Push $0<br />
   StrCpy $PORT &quot;80&quot;   <br />
   FileOpen $0 '$TEMP\OpenFWPort.vbs' w<br />
   <br />
   FileWrite $0 &quot;Option Explicit$\n&quot;<br />
   FileWrite $0 &quot;On Error GoTo 0$\n&quot;<br />
   FileWrite $0 &quot;'Set Constants$\n&quot;<br />
   FileWrite $0 &quot;Const NET_FW_IP_PROTOCOL_UDP = 17$\n&quot;<br />
   FileWrite $0 &quot;Const NET_FW_IP_PROTOCOL_TCP = 6$\n&quot;<br />
   FileWrite $0 &quot;Const NET_FW_SCOPE_ALL = 0$\n&quot;<br />
   FileWrite $0 &quot;Const NET_FW_SCOPE_LOCAL_SUBNET = 1$\n&quot;<br />
<br />
   FileWrite $0 &quot;'Declare variables$\n&quot;<br />
   FileWrite $0 &quot;Dim errornum$\n&quot;<br />
   FileWrite $0 &quot;'Create the firewall manager object.$\n&quot;<br />
   FileWrite $0 &quot;Dim fwMgr$\n&quot;<br />
   FileWrite $0 &quot;Set fwMgr = CreateObject($\&quot;HNetCfg.FwMgr$\&quot;)$\n&quot;<br />
<br />
   FileWrite $0 &quot;'Get the current profile for the local firewall policy.$\n&quot;<br />
   FileWrite $0 &quot;Dim profile$\n&quot;<br />
   FileWrite $0 &quot;Dim port$\n&quot;   <br />
   FileWrite $0 &quot;Set profile = fwMgr.LocalPolicy.CurrentProfile$\n&quot;<br />
   FileWrite $0 &quot;Set port = CreateObject($\&quot;HNetCfg.FWOpenPort$\&quot;)$\n&quot;<br />
   FileWrite $0 &quot;port.Name = $\&quot;${_PRODUCT}$\&quot;$\n&quot;<br />
   FileWrite $0 &quot;port.Protocol = NET_FW_IP_PROTOCOL_TCP$\n&quot;<br />
   FileWrite $0 &quot;port.Port = $PORT$\n&quot;<br />
<br />
   FileWrite $0 &quot;'If using Scope, don't use RemoteAddresses$\n&quot;<br />
   FileWrite $0 &quot;port.Scope = NET_FW_SCOPE_ALL$\n&quot;<br />
   FileWrite $0 &quot;'Use this line to scope the port to Local Subnet only$\n&quot;<br />
   FileWrite $0 &quot;'port.Scope = NET_FW_SCOPE_LOCAL_SUBNET$\n&quot;<br />
   FileWrite $0 &quot;port.Enabled = TRUE$\n&quot;<br />
   <br />
   FileWrite $0 &quot;On Error Resume Next$\n&quot;<br />
   FileWrite $0 &quot;profile.GloballyOpenPorts.Add port$\n&quot;<br />
   FileWrite $0 &quot;errornum = E******mber$\n&quot;<br />
   FileWrite $0 &quot;If errornum &lt;&gt; 0 Then$\n&quot;<br />
   FileWrite $0 &quot;   WScript.Echo($\&quot;Adding the port failed. Error Number: $\&quot; &amp; errornum)$\n&quot;<br />
   FileWrite $0 &quot;End If$\n&quot;<br />
   <br />
   FileClose $0<br />
   <br />
   DetailPrint 'Opening firewall port $PORT'<br />
   nsExec::Exec /TIMEOUT=20000 '&quot;$SYSDIR\cscript.exe&quot; &quot;$TEMP\OpenFWPort.vbs&quot;'<br />
   Pop $1<br />
   StrCmp $1 '0' OpenPortSucceded<br />
   DetailPrint 'Error $1 in OpenFWPort.vbs'<br />
   Delete &quot;$TEMP\OpenFWPort.vbs&quot;<br />
   Abort 'Failed to open port'<br />
   <br />
   OpenPortSucceded:<br />
   DetailPrint 'Succeded opening port'<br />
   Delete &quot;$TEMP\OpenFWPort.vbs&quot;<br />
   Pop $0<br />
FunctionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>