<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Force user to select only drive letter, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Force user to select only drive letter NSIS Discussion" />
	
	<title> Force user to select only drive letter [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Force user to select only drive letter</div>
<hr />
<div class="pda"><a href="t-262924.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=262924">Force user to select only drive letter</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ionut_y</div><div class="date">3rd January 2007, 07:35</div></div><div class="posttext">I have an application that works on a drive folder like<br />
 c:\myapp, d:\myapp, e:\myapp ..... how can I replace  MUI_PAGE_DIRECTORY with a combobox for selecting only drives letter available.I'm new with nsis and please I want a small script file to see that.For 2 days I'm looking for a solution.<br />
Many thanks !!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">3rd January 2007, 07:45</div></div><div class="posttext">Already discussed here:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=262165</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ionut_y</div><div class="date">3rd January 2007, 07:59</div></div><div class="posttext">Originally posted by Red Wine <br />
Already discussed here:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=262165  <br />
<br />
Thanks for answer.... but this is not what i'm looking for, user can also chose a subdir ...and i want to force it to choose only drive letter from a combo.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">3rd January 2007, 08:07</div></div><div class="posttext">Nope, this is exactly what you're looking, though, feel free to build a custom page with a combo, find all available HDD with GetDrives, and add them to ListItems.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ionut_y</div><div class="date">3rd January 2007, 08:18</div></div><div class="posttext">Originally posted by Red Wine <br />
Nope, this is exactly what you're looking, though, feel free to build a custom page with a combo, find all available HDD with GetDrives, and add them to ListItems.  <br />
<br />
Thanks again ...this is my problem...i don't know how i can do it.I use nsis for 3 days,I wand i script for exemple.Thanks !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Backland</div><div class="date">3rd January 2007, 11:45</div></div><div class="posttext">I dont think there is one available, but the concept is very simple:<br />
<br />
Enumerate the drives with the plugin, and add them to your custom page's combo with the WriteINIStr. You should probably start by looking through the InstallOptions examples provided with NSIS. It looks a bit daunting at first, but its quite simple.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">3rd January 2007, 12:37</div></div><div class="posttext">Take this as a starting point :-)<br />
!define APPNAME &quot;My Application&quot;<br />
Name '${APPNAME}'<br />
OutFile 'test.exe'<br />
LicenseData '${NSISDIR}\License.txt'<br />
LicenseBkColor 0xFFFFFF<br />
ShowInstDetails show<br />
AllowRootDirInstall true<br />
<br />
!include FileFunc.nsh<br />
!insertmacro GetDrives<br />
<br />
Page License<br />
Page Custom CustomCreate CustomLeave<br />
Page InstFiles<br />
<br />
Section &quot;boo&quot;<br />
        SetOutPath '$INSTDIR'<br />
SectionEnd<br />
<br />
Function CustomCreate<br />
         WriteIniStr '$PLUGINSDIR\custom.ini' 'Settings' 'NumFields' '2'<br />
<br />
         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 1' 'Type' 'Label'<br />
         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 1' 'Left' '5'<br />
         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 1' 'Top' '5'<br />
         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 1' 'Right' '-6'<br />
         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 1' 'Bottom' '17'<br />
         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 1' 'Text' \<br />
         'Select Installation drive:'<br />
<br />
         StrCpy $R2 0<br />
         StrCpy $R0 ''<br />
         ${GetDrives} &quot;HDD&quot; GetDrivesCallBack<br />
<br />
         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 2' 'Type' 'DropList'<br />
         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 2' 'Left' '30'<br />
         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 2' 'Top' '25'<br />
         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 2' 'Right' '-31'<br />
         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 2' 'Bottom' '105'<br />
         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 2' 'State' '$R1'<br />
         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 2' 'ListItems' '$R0'<br />
<br />
         push $0<br />
         InstallOptions::Dialog '$PLUGINSDIR\custom.ini'<br />
         pop $0<br />
         pop $0<br />
FunctionEnd<br />
<br />
Function CustomLeave<br />
        ReadIniStr $0 '$PLUGINSDIR\custom.ini' 'Field 2' 'State'<br />
        StrCpy '$INSTDIR' '$0'<br />
FunctionEnd<br />
<br />
Function GetDrivesCallBack<br />
         IntCmp $R2 '0' def next next<br />
      def:<br />
         StrCpy $R1 '$9${APPNAME}'<br />
      next:<br />
         IntOp $R2 $R2 + 1<br />
         StrCpy $R0 '$R0$9${APPNAME}|'<br />
	 Push $0<br />
FunctionEnd<br />
<br />
Function .onInit<br />
         InitPluginsDir<br />
         GetTempFileName $0<br />
         Rename $0 '$PLUGINSDIR\custom.ini'<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ionut_y</div><div class="date">3rd January 2007, 13:32</div></div><div class="posttext">Originally posted by Red Wine <br />
Take this as a starting point :-)<br />
!define APPNAME &quot;My Application&quot;<br />
Name '${APPNAME}'<br />
OutFile 'test.exe'<br />
......................<br />
  <br />
<br />
Thanks very much ... is seems ok. I'll start learnig nsis deeply.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">3rd January 2007, 17:41</div></div><div class="posttext">You're welcome!<br />
Just added a wiki page (http://nsis.sourceforge.net/Adding_DropList_with_available_drives_instead_of_directory_page) with the complete example that calculates the free space of every drive and adds only those drives that they have enough space for the uncompressed installation.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>