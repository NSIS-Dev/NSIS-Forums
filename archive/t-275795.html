<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem reading registry entry which contains &quot; symbol, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem reading registry entry which contains &quot; symbol NSIS Discussion" />
	
	<title> Problem reading registry entry which contains &quot; symbol [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem reading registry entry which contains &quot; symbol</div>
<hr />
<div class="pda"><a href="t-275795.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=275795">Problem reading registry entry which contains &quot; symbol</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Rantam</div><div class="date">12th August 2007, 16:55</div></div><div class="posttext">Hi,<br />
<br />
I've been looking about this, but no luck, so:<br />
<br />
I'm creating an installer that is going to update an already installed program.<br />
<br />
It searchs into the windows registry to get the path of that installed program. The path is stored is a RG_SZ type key named InstallPath, and the value is:<br />
<br />
&quot;D:\Programs\Mountain&quot;<br />
<br />
NOTE: The value includes the &quot; symbols inside.<br />
<br />
I'm using this code to read the key's value <br />
<br />
ReadRegStr $R0 HKLM &quot;Software\Mountain&quot; &quot;InstallPath&quot; ;<br />
IfErrors +2<br />
StrCpy $INSTDIR<br />
<br />
Below in the script I have this code to install files:<br />
<br />
SetOutPath &quot;$INSTDIR&quot;<br />
                   File &quot;Data\fil1.txt&quot;<br />
                   File &quot;Data\file2.txt&quot;<br />
<br />
I compile the installer without problems, but when the installer starts installing an error message is shown:<br />
<br />
Error opening file for writing.<br />
D\Programs\Mountain\fil1.txt<br />
Clic abort to cancel installation, bla bla bla<br />
<br />
(Note the : path symbol seems to be lost)<br />
<br />
So it seems that the &quot; symbols is not being stored inside $INSTDIR<br />
<br />
If I manually delete the &quot; symbols inside that registry key the installer works without problems, installing all the files correctly. But I can't ask the users to do that to install the update, so the &quot; symbols should be stored with the rest of the path.<br />
<br />
How can I solve it?<br />
<br />
Lot of thanks in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">12th August 2007, 19:23</div></div><div class="posttext">Just use InstallDirRegKey,<br />
<br />
http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.22</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Rantam</div><div class="date">12th August 2007, 22:16</div></div><div class="posttext">Lot of thanks! Now it works fine.<br />
<br />
Thanks again for your excelent support! :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>