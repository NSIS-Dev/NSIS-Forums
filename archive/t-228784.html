<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Locate and pass a reg key value?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Locate and pass a reg key value? NSIS Discussion" />
	
	<title> Locate and pass a reg key value? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Locate and pass a reg key value?</div>
<hr />
<div class="pda"><a href="t-228784.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228784">Locate and pass a reg key value?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Alcasar</div><div class="date">19th October 2005, 06:43</div></div><div class="posttext">Hi my Problem is simple.<br />
<br />
I want read path string from the Registry and pass it over to the install path.<br />
<br />
Say I have already an App installed and now I want to install additional documents into the &quot;docs&quot; folder<br />
Now I want the setup to detect the product location from the reg key. So the user doesnt have to select the install path by himself.<br />
<br />
Example:<br />
<br />
In HKEY_LOCAL_MACHINE\SOFTWARE\[Product]\ there is a key telling me where the [Product] is installed. ( Say a value like &quot;C:\Product\&quot; is written in &quot;Product_Path&quot;)<br />
<br />
I want to extract that value from the reg key &quot;Product_Path&quot; and sort of &quot;paste&quot; it into  the InstallDir ( like InstallDir &quot;$detect\docs&quot;. So the Setup would automatically detect the path of my already installed product and just add files into product's directory.<br />
<br />
I tried this:<br />
<br />
Section GetPath <br />
ReadRegStr $detect HKLM &quot;SOFTWARE\Product\&quot; &quot;Product_Path&quot;<br />
SectionEnd<br />
<br />
InstallDir &quot;$detect\docs&quot;<br />
<br />
But it seems not to work :(<br />
<br />
Please help me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">19th October 2005, 07:06</div></div><div class="posttext">Try $INSTDIR var, NSIS Manual 4.2.2<br />
<br />
StrCpy $INSTDIR &quot;$detect\docs&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Alcasar</div><div class="date">19th October 2005, 07:41</div></div><div class="posttext">didnt work<br />
<br />
I tried even with global variable but it didn't work.<br />
where is the .onInit<br />
<br />
and where is the $INSTDIR var specified</div></div><hr />


<div class="post"><div class="posttop"><div class="username">l_d_allan</div><div class="date">19th October 2005, 16:15</div></div><div class="posttext">If I understand your question:<br />
<br />
Read about and try:<br />
InstallDirRegKey<br />
<br />
(Most of the ModernUI examples use InstallDirRegKey, and also check the &quot;non-modern&quot; example2.nsi)<br />
<br />
The .onInit function is called before your installer gets going. You can do quite a bit of initialization there.<br />
<br />
<br />
Function .onInit<br />
  SetRebootFlag false<br />
  ClearErrors<br />
  ReadEnvStr $SwordPathFolder SWORD_PATH<br />
  ReadRegStr $WordPadExePath HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\WORDPAD.EXE&quot; &quot;&quot;<br />
  ExpandEnvStrings $WordPadExeExpPath $WordPadExePath<br />
FunctionEnd<br />
<br />
Function .onInstSuccess # called after installer finished<br />
  Exec '&quot;$INSTDIR\MyApp.exe&quot;'<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Alcasar</div><div class="date">20th October 2005, 01:08</div></div><div class="posttext">Thanks.<br />
<br />
InstallDirRegKey helped. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">P_B</div><div class="date">20th October 2005, 13:59</div></div><div class="posttext">hey alcasar, could u plz provide me tat sample code to get the installation path using InstallDirRegKey. i'm facing the same issue here.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Alcasar</div><div class="date">20th October 2005, 17:23</div></div><div class="posttext">I used the Basic.nsi example in the ModernUI folder and just modified this line:<br />
<br />
InstallDirRegKey HKCU &quot;Software\Modern UI Test&quot; &quot;&quot;<br />
<br />
into something like<br />
<br />
InstallDirRegKey HKCU &quot;Software\MyProduct&quot; &quot;ProductPath&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">l_d_allan</div><div class="date">20th October 2005, 20:56</div></div><div class="posttext">Just for completeness ... don't overlook that you have to set the registry entry that InstallDirRegKey will be referencing ... it isn't automagically done. <br />
<br />
This can typically be done in a required [RO] section (see example2.nsi). <br />
<br />
WriteRegStr HKLM SOFTWARE\NSIS_Example2 &quot;Install_Dir&quot; &quot;$INSTDIR&quot;</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>