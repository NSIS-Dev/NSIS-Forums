<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" working with dll exported functions ..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  working with dll exported functions ... NSIS Discussion" />
	
	<title> working with dll exported functions ... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  working with dll exported functions ...</div>
<hr />
<div class="pda"><a href="t-322157.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322157">working with dll exported functions ...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">thanatos83</div><div class="date">1st September 2010, 20:47</div></div><div class="posttext">Hi all.<br />
<br />
i have some questions about this, please any help:<br />
<br />
First, i need use System.dll to call unrar.dll ?, so i put down some functions of this plugin but i need some functions, not all really?, to extract contents of RAR file.<br />
<br />
- unrar::RARCloseArchive<br />
- unrar::RARGetDllVersion<br />
- unrar::RAROpenArchive<br />
- unrar::RAROpenArchiveEx<br />
- unrar::RARProcessFile<br />
- unrar::RARProcessFileW<br />
- unrar::RARReadHeader<br />
- unrar::RARReadHeaderEx<br />
- unrar::RARSetCallback<br />
- unrar::RARSetChangeVolProc<br />
- unrar::RARSetPassword<br />
- unrar::RARSetProcessDataProc<br />
- unrar::___CPPdebugHook<br />
<br />
I read about the plugin http://nsis.sourceforge.net/Calling_an_external_DLL_using_the_System.dll_plugin<br />
<br />
But i confused about how to put first in the script... :s</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thanatos83</div><div class="date">2nd September 2010, 16:25</div></div><div class="posttext">Hi.<br />
<br />
I was starting to write some script to use some exported functions from &quot;unrar.dll&quot; and the objective of all of this is to extract some rar files to target dir installation like &quot;$INSTALLDIR&quot;.<br />
<br />
First i put this:<br />
<br />
# Installer sections<br />
<br />
Section -Base SEC0000<br />
    <br />
    SetPluginUnload  alwaysoff<br />
    SetOutPath &quot;$PLUGINSDIR&quot;                 ; create temp directory<br />
    File &quot;${NSISDIR}\Plugins\unrar.dll&quot;        ; copy dll there    <br />
    CallInstDLL &quot;$PLUGINSDIR\unrar.dll&quot; unrar::RAROpenArchive           <br />
    SetPluginUnload manual         <br />
    #System::Free 0    <br />
    #WriteRegStr HKLM &quot;${REGKEY}\Components&quot; Base 1<br />
    <br />
SectionEnd<br />
<br />
how i can continue?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">3rd September 2010, 16:23</div></div><div class="posttext">You're not really using System to call your DLL here.<br />
CallInstDLL is the old way of calling NSIS plugins.<br />
<br />
You should use System::Call to call unrar.dll function. It will requires you to specify the prototype of the function using System specific syntax (see System plugin help file)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jiake</div><div class="date">5th September 2010, 05:50</div></div><div class="posttext">Download this file:<br />
http://www.rarlab.com/rar/UnRARDLL.exe<br />
And extract it using WinRAR, read unrardll.txt. It shows you the structrue and functions of unrar.dll, and the constants are defined in unrar.h.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thanatos83</div><div class="date">5th September 2010, 12:03</div></div><div class="posttext">OK thanks...<br />
<br />
So it's more easy with unrar.exe, but progress bar jumps when you use it with nsExecToLog.<br />
<br />
Is there anyway to set a proper progress bar with this compressor, for example when the compressor is extracting a file?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">5th September 2010, 19:22</div></div><div class="posttext">No.<br />
<br />
Note: Even when NSIS is extracting a file by itself, the progress bar is not moving (only a percentage of the progress is displayed)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>