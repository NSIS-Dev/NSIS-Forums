<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Select Statements, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Select Statements NSIS Discussion" />
	
	<title> Select Statements [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Select Statements</div>
<hr />
<div class="pda"><a href="t-149748.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=149748">Select Statements</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dselkirk</div><div class="date">19th September 2003, 21:06</div></div><div class="posttext">Another library I slapped together to make things a little easier. This one provides NSIS with the select statement functionality.<br />
<br />
<br />
  ;Usage:<br />
  ;<br />
  ;open a new select statement<br />
  ;!insertmacro SELECT &lt;selectname&gt; &lt;selectvalue&gt;<br />
  ;add case statements<br />
  ;!insertmacro CASE &lt;comparevalues&gt;<br />
  ;!insertmacro CASE &lt;comparevalues&gt;<br />
  ;if comparison not found, optional<br />
  ;!insertmacro CASE_ELSE<br />
  ;close select statement<br />
  ;!insertmacro SELECTEND<br />
  ;<br />
  ;Variable descriptions:<br />
  ;&lt;selectname&gt; is if you want multiple selects<br />
  ;&lt;selectvalue&gt; is the value to compare too<br />
  ;&lt;comparevalues&gt; is a &quot;;&quot; delimited string of the compare values<br />
<br />
  Section<br />
    !insertmacro SELECT &quot;TESTCASE&quot; &quot;test1&quot;<br />
      !insertmacro CASE &quot;test1&quot;<br />
        MessageBox MB_OK &quot;case test1&quot;<br />
      !insertmacro CASE &quot;test 2;test3&quot;<br />
        MessageBox MB_OK &quot;case test2 or test3&quot;<br />
      !insertmacro CASE_ELSE<br />
        MessageBox MB_OK &quot;case else&quot;<br />
    !insertmacro SELECTEND<br />
  SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dselkirk</div><div class="date">20th September 2003, 05:13</div></div><div class="posttext">Here is version 1.1. I've added simplified macros as discussed here:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=149805<br />
I also removed the required of the name field.<br />
Enjoy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">20th September 2003, 12:02</div></div><div class="posttext">We already got !ifdef, !else ifdef, !else etc. What is the difference?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dselkirk</div><div class="date">20th September 2003, 15:44</div></div><div class="posttext">There are 3 major differences. First, !ifdef, !endif only work during compile time while this works after compile. 2nd, !ifdef only checks if another define exists instead of check the value. And finally, This can handle multipe values, you can check if a single variable is equivalant to multiple values. You can also compare this to the C++ switch statement or the VB select case statement. Does that answer your questions?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">20th September 2003, 17:07</div></div><div class="posttext">Yes, I understand. !insertmacro is a compile time command, so that's why it's a bit confusing.<br />
<br />
Something that would be even more useful is run-time If, ElseIf and EndIf support. That's easier than using StrCmp etc.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dselkirk</div><div class="date">20th September 2003, 17:44</div></div><div class="posttext">Agreed, If..ElseIf..Else statements would be better than using the StrCmp function. This was meant as a work around until we get that sort of support. I've already started to modify the selectlib to act like an if statement. I'll let you know when its done.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st September 2003, 15:14</div></div><div class="posttext">No Archive page? :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dselkirk</div><div class="date">22nd September 2003, 19:08</div></div><div class="posttext">Please excuse the delay of my reply. Been busy polishing up this code. It is now called the NSIS Logic Lib and not only provides better Select statements but also If statements as well. Enjoy!<br />
<br />
Archive Page:<br />
http://nsis.sourceforge.net/archive/nsisweb.php?page=410&amp;instances=0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eccles</div><div class="date">22nd September 2003, 22:35</div></div><div class="posttext">Funnily enough I was experimenting with a similar idea a while back but never completed it.  Thanks to your posts I decided to dig it out and clean it up.  :)<br />
<br />
Mine does not have select/case but it does have do and while style loops.<br />
<br />
Maybe some of our ideas can be combined?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">23rd September 2003, 15:54</div></div><div class="posttext">Maybe you can use some unique values like ${__LINE__} to make usage unlimited.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dselkirk</div><div class="date">23rd September 2003, 20:01</div></div><div class="posttext">eccles: just had a chance to go through your version. Very nice. I noticed you were using the quick macros. Now those are a time saver. I espically love your Push and Pop Logic, great way to get around the limitations of mine. It also makes the code simpler. I'll try integrating our 2 codes to gether and see what I can come up with. Can you think of any other logic statements that might be good to include?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eccles</div><div class="date">23rd September 2003, 22:21</div></div><div class="posttext">dselkirk,<br />
<br />
Yes, I put your defines in just before posting. 'tis a good trick!<br />
<br />
It's a shame the select/case code has to do all that work at run-time checking for ';'. How do you feel about it being done at compile time? e.g.<br />
${SELECT} &quot;test1&quot;<br />
  ${CASE} &quot;test1&quot;<br />
    MessageBox MB_OK &quot;case: test1&quot;<br />
  ${CASE2} &quot;test2&quot; &quot;test3&quot;<br />
    MessageBox MB_OK &quot;case: test2 or test3&quot;<br />
  ${CASE_ELSE}<br />
    MessageBox MB_OK &quot;case else&quot;<br />
${ENDSELECT}<br />
<br />
As for logic statements, I can't think of any others at the mo.<br />
<br />
How about more tests though? First of all, unsigned integer comparisons (IntCmpU). What symbols could be used for these?<br />
<br />
Next, other tests that NSIS has, e.g. IfFileExists. Slightly tricky as the If template is operand_1 operator operand_2, but maybe something like ${If} &quot;some_file_name&quot; does exist could be made to work?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dselkirk</div><div class="date">23rd September 2003, 23:54</div></div><div class="posttext">Good idea for the select..case. We cap it off at case5, if a user needs to use more then they can simply use multipe cases.<br />
<br />
I thought of another great statement to do. It will save us all alot of time. For..Next statements:<br />
<br />
  !macro For _v _f _t _o _s<br />
    StrCpy ${_v} ${_f}<br />
    !insertmacro _PushLogic<br />
    !define ${_Logic}For _${__LINE__}<br />
    !define ${_Logic}For2 _${__LINE__}<br />
    !define ${_Logic}Next _${__LINE__}<br />
    Goto ${${_Logic}For2}<br />
    ${${_Logic}For}:<br />
      IntOp ${_v} ${_v} ${_o} ${_s}<br />
    ${${_Logic}For2}:<br />
    !insertmacro _&gt; ${_v} ${_t} ${${_Logic}Next} &quot;&quot;<br />
    !undef ${_Logic}For2<br />
  !macroend<br />
  !define For &quot;!insertmacro For&quot;<br />
<br />
  !macro ExitFor<br />
    ;Goto <br />
  !macroend<br />
  !define ExitFor &quot;!insertmacro ExitFor&quot;<br />
<br />
  !macro Next<br />
    !ifndef _Logic | ${_Logic}For<br />
      !error &quot;Cannot use Next without a preceding For&quot;<br />
    !endif<br />
    Goto ${${_Logic}For} ; Loop back to the For condition<br />
    ${${_Logic}Next}: ; Place the Next<br />
    !undef ${_Logic}For<br />
    !undef ${_Logic}Next<br />
    !insertmacro _PopLogic<br />
  !macroend<br />
  !define Next &quot;!insertmacro Next&quot;<br />
<br />
  ;${for} variable from to direction steps<br />
  ${for} $1 0 20 + 2<br />
  ${next}<br />
<br />
<br />
For the &quot;if&quot; statements, why don't we treat them basically as boolean returns:<br />
<br />
${if} ${FileExists} &quot;c:\test.txt&quot;<br />
or<br />
${if} &quot;5 &lt; 10&quot;<br />
<br />
<br />
I was also trying to write ExitFor, ExitDo and ExitWhile statements but with no luck. I thought of using two defines which would store the current and the previous loop end labels. Any ideas.<br />
<br />
There was something else but I can't remember it right now. I had written this entire message and hit my mouse by accident. It went back a page and I lost it, now I can't remember everything I mentioned before. huh!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eccles</div><div class="date">24th September 2003, 20:46</div></div><div class="posttext">Hadn't thought of For; good idea. Maybe Next should be called EndFor though, to match the others? :)<br />
<br />
I'll have a go at ExitFor/While/Do (although I'll do just one and call it Break) and also Continue. Might be more tricky though as they need to be kept separate from Ifs.<br />
<br />
Hope you remember what you forgot :) <br />
btw, do you visit the NSIS IRC channel?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>