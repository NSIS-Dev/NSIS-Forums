<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" PROGRAMFILES Windows 7, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  PROGRAMFILES Windows 7 NSIS Discussion" />
	
	<title> PROGRAMFILES Windows 7 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  PROGRAMFILES Windows 7</div>
<hr />
<div class="pda"><a href="t-316390.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=316390">PROGRAMFILES Windows 7</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">reace</div><div class="date">19th January 2010, 14:11</div></div><div class="posttext">Hi all,<br />
<br />
I got a problem with the PROGRAMFILES folder on Windows 7 (german version).<br />
<br />
Windows 7 detects the variable $PROGRAMFILES as <br />
<br />
&quot;C:\Program Files&quot;<br />
<br />
But in Windows 7 only exists &quot;C:\Programme&quot; therefore the files will be installed in &quot;C:\Programme&quot; and not in &quot;C:\Program Files&quot;.<br />
<br />
I write the path into the registry so that an external software can read the path from the entry to start it. <br />
But because NSIS detects &quot;Program Files&quot; instead of the real folder &quot;Programme&quot; the software can't be executed. The shortcuts point to &quot;C:\Program Files&quot; which doesn't exist.<br />
<br />
Is there a way to fix that?<br />
<br />
Thanks for help :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zinthose</div><div class="date">19th January 2010, 15:20</div></div><div class="posttext">AFAIK, NSIS gets the path from the %ProgramFiles% environment variable.  Could your environment variables be corrupt?<br />
<br />
To see what current setting is, from a command prompt window, run ECHO PROGRAMFILES=%PROGRAMFILES%<br />
<br />
It it's wrong then something in Windows is broke.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CrushBug</div><div class="date">19th January 2010, 17:04</div></div><div class="posttext">It is important to understand that in Windows 7, if you are looking through Explorer on a non-English OS, Explorer will show you &quot;C:\Programme&quot; EVEN THOUGH the actual file name of the directory is &quot;C:\Program Files&quot; in the file system.<br />
<br />
To verify this, you need to use another file system browser (I would recommend Total Commander - http://www.ghisler.com/ ) and look at the root of your C: drive. You will find a hidden .ini file in the root of Program Files that will tell Explorer what name it should display instead of the actual file system name. This makes it easier for them to localize the OS without having to localize the file system. I have personally looked at French Windows 7 and I see this.<br />
<br />
NSIS (thankfully) will not lie to you and it will show you the factual file system names.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">19th January 2010, 18:18</div></div><div class="posttext">Originally posted by Zinthose <br />
AFAIK, NSIS gets the path from the %ProgramFiles% environment variable. Wrong, NSIS does not use any environment variables, it only uses documented API functions like SHGet*(). The windows api to retrieve the temp dir does use %temp% internally, so that is the only one that could have a problem</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zinthose</div><div class="date">19th January 2010, 18:41</div></div><div class="posttext">Anders, It dose make more sense to me to use API Calls but I got the notion from somewhere. <br />
<br />
I dug around in the documentation and found 3.1.3 (http://nsis.sourceforge.net/Docs/Chapter3.html#3.1.3).  It is clearly only used to the build environment and not the installer.  But likely were I got the erroneous idea... :( <br />
<br />
My Bad.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">19th January 2010, 18:51</div></div><div class="posttext">Yes, the compiler has a couple, but that is because they SHOULD be possible to edit (and some of them are non standard with no shell constant)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">reace</div><div class="date">22nd January 2010, 13:24</div></div><div class="posttext">Thanks for your answers!<br />
<br />
@Crashbug: You are right, its easier for Microsoft, but not for me, because the program cant read the correct path ;) But thanks for the hint with total commander and the ini file!<br />
<br />
Well, its not that bad, I will try to avoid the use of $PROGRAMFILES for this application. <br />
<br />
Have a nice day!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CrushBug</div><div class="date">23rd January 2010, 00:48</div></div><div class="posttext">It's &quot;CrushBug&quot; =)<br />
<br />
The program is reading the correct path. It is not wrong. What I am trying to say is that Explorer is lying to you and not NSIS and not the file system. It also sounds like that other program is not handling the file system properly.<br />
<br />
I will double check one of our installers on French and see what happens because I know our stuff works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">23rd January 2010, 14:55</div></div><div class="posttext">/* off topic */<br />
Remove Win 7<br />
<br />
<br />
I tested windows 7 and the paths displayed on nsis directory page are wrong, maybe some unfinished job, I don't know...I still use XP for testing apps.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koopa</div><div class="date">23rd January 2010, 16:16</div></div><div class="posttext">CrushBug is right. The internal Windows 7 name is 'C:\Program Files', the Explorer shows 'C:\Programme' on your German system, though.<br />
<br />
If you install your application in the detected 'C:\Program Files' folder, it will be correctly installed in the your 'C:\Programme' folder.<br />
<br />
Just ignore what you see, the path will be correctly detected and after installation, you will see, that all things went well. ;)<br />
<br />
Joel:<br />
<br />
I'm not seeing any Windows 7 related path issues. All of my installers work well. For the above 'issue' you simply can ignore it, the files will be installed in the correct path, even if you'd guess, that the file path is wrong.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>