<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" how to make a non-installer for Vista?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  how to make a non-installer for Vista? NSIS Discussion" />
	
	<title> how to make a non-installer for Vista? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  how to make a non-installer for Vista?</div>
<hr />
<div class="pda"><a href="t-277958.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277958">how to make a non-installer for Vista?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">anadem</div><div class="date">26th September 2007, 21:17</div></div><div class="posttext">I'm using NSIS to package and deploy a repair tool. The plan is that the package places its files on the target, then execs its main app (one of the files), and finally removes all its files. It doesn't &quot;stay installed&quot;.<br />
<br />
There's no user interaction with the package, no choice of directory, no shortcuts installed - just a silent wrapper; (the repair app itself does have a dialog.) The package doesn't create entries in Add/Remove programs and so isn't really an &quot;installer&quot; per se.<br />
<br />
I'm very much a novice with NSIS but this seems to be working out, except on Vista (surprise!). <br />
<br />
After the package has finished (having successfully run the app) Vista pops up the 'Program Compatibility Assistant' saying:<br />
<br />
&quot;This program might not have installed correctly<br />
&quot;If this program didn't install correctly, try reinstalling using settings that are compatible with this version of Windows.&quot;<br />
<br />
with options:<br />
<br />
&quot;  o  Reinstall using recommended settings<br />
&quot;  o  This program installed correctly.&quot;<br />
<br />
Is there any way to make a package which Vista will not consider to be an installer? Or at least, stop Vista wanting to know if the package installed ok. (The UAC prompts prior to running the repair are fine -- user must indeed be admin to make the repair.)<br />
<br />
Any suggestions will be much appreciated.<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">26th September 2007, 22:31</div></div><div class="posttext">Are you setting the exit code?<br />
Are you using Requestexecutionlevel ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anadem</div><div class="date">26th September 2007, 22:36</div></div><div class="posttext">no, neither setting exit code nor using Requestexecutionlevel -- I'll add them &amp; see what happens (got yanked to other stuff for today, tho)<br />
<br />
thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anadem</div><div class="date">27th September 2007, 01:16</div></div><div class="posttext">thanks, RequestExecutionLevel did the trick!<br />
<br />
&gt; are you setting the exit code?<br />
<br />
the NSIS docs are coy on this ... does this mean &quot;set the NSIS installer's exit code&quot; or &quot;set the exitcode for the application which the installer execs&quot;? <br />
<br />
I can't find out how to set the installer's exit code.<br />
(My exec catches the app's exit code in a variable using<br />
  <br />
  ExecWait &quot;$INSTDIR\fixup.exe&quot; $retcode</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">27th September 2007, 01:32</div></div><div class="posttext">4.9.7.5 SetErrorLevel (http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.7.5) error_level<br />
<br />
Sets the error level of the installer or uninstaller to error_level. See Error Levels (http://nsis.sourceforge.net/Docs/AppendixD.html#D.1) for more information.<br />
<br />
IfRebootFlag 0 +2<br />
  SetErrorLevel 4</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anadem</div><div class="date">27th September 2007, 01:34</div></div><div class="posttext">thanks!!<br />
<br />
(fwiw I searched for exit code &amp; exitcode ... guess I should've been thinking DOS-style.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">27th September 2007, 02:26</div></div><div class="posttext">yeah, but unless you are setting it yourself, nsis should return 0 if everything is ok, if you want to force &quot;success&quot; you can set it to 0 yourself at the end of your last section</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chllen</div><div class="date">7th July 2009, 23:56</div></div><div class="posttext">I have 100% same problem.<br />
I add &quot;SetErrorLevel 0&quot;  at the end of &quot;Main&quot; section.<br />
see source: http://ovpnp.svn.sourceforge.net/viewvc/ovpnp/trunk/other/OpenVPNPortableSource/OpenVPNPortable.nsi?revision=31&amp;view=markup<br />
<br />
And its not helps for me..<br />
Any suggestions will be much appreciated :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>