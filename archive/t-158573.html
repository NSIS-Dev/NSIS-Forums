<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" VS_VERSION_INFO to VIProductVersion, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  VS_VERSION_INFO to VIProductVersion NSIS Discussion" />
	
	<title> VS_VERSION_INFO to VIProductVersion [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  VS_VERSION_INFO to VIProductVersion</div>
<hr />
<div class="pda"><a href="t-158573.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=158573">VS_VERSION_INFO to VIProductVersion</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">russcepd</div><div class="date">4th December 2003, 23:00</div></div><div class="posttext">I'm trying to get the VS_VERSION_INFO object info out of my MSVC app into the installer script's attributes, such as VIProductVersion or Name. <br />
<br />
I can grab the strings I need from the appropriate .rc file in the MSVC project, but in NSIS I have to use variables to do this. Nearly all the NSIS attributes to not accecpt variables as arguments.<br />
<br />
Anybody know a work-around?<br />
<br />
Thanks,<br />
Russ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">5th December 2003, 01:31</div></div><div class="posttext">Thats because variables are runtime and the version info commands are compile time instructions.  As a work around you will most likely have to create an installer or another program that will read the .rc file and generate a nsis script which the can be included into your main script.  This can be automated by using !system command.<br />
<br />
As a similar example search this forum for a thread about excluding files from recursive directory include as it is a good example of how !system command can be used to generate a semi-dynamic script at compile time.<br />
<br />
Vytautas ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">russcepd</div><div class="date">5th December 2003, 02:02</div></div><div class="posttext">Yea, I thought of that, but I was hoping for a way to do it in a single nsis script. Oh, well.<br />
<br />
Thanks,<br />
Russ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">5th December 2003, 03:41</div></div><div class="posttext">Well in the end to you it should appear as one script which includes the version info from a file generated by a program of some sort.  All the program has to do is output a simple text file with VIProductVersion commands with appropriate settings defined.<br />
<br />
Of cause there is another way of doing it but it is way more complicated.  It involves modifing NSIS Source code to create a function similar to GetLocalDLLVersion.<br />
<br />
Also I read in one of the thread a possibility of future versions of NSIS supporting compile-time plugins, or was I dreaming?<br />
<br />
Vytautas :D</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>