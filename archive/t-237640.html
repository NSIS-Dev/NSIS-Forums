<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Shell extension on folders, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Shell extension on folders NSIS Discussion" />
	
	<title> Shell extension on folders [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Shell extension on folders</div>
<hr />
<div class="pda"><a href="t-237640.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=237640">Shell extension on folders</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Wurstteppich</div><div class="date">9th February 2006, 20:02</div></div><div class="posttext">Hello<br />
<br />
i need to register a command in the shell - right click menu - which sends the path of to a directory to a program. That means i want to have a menu item when i right click on a directory in the explorer which says something like &quot;Add this folder to &lt;MyProgramNameHere&gt;&quot; which then starts my program like this:<br />
<br />
MyProgram.exe C:\ExampleDir\ExampleDir<br />
<br />
Is that possible in any way ?<br />
<br />
I would be glad to hear some ideas from you guys :)<br />
<br />
Thanks in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">9th February 2006, 22:06</div></div><div class="posttext">Add a new key to HKEY_CLASSES_ROOT\Directory with your program name.  Set the default value to the text to display in the right-click menu.  Now add a subkey called command.  Make the default value the path to your application in this form: &quot;C:\My Program\myprogram.exe&quot; &quot;%1&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wurstteppich</div><div class="date">9th February 2006, 23:22</div></div><div class="posttext">Ah thanks, i assumed something like the last part you described, but didn't exactly know where to set it with a directory. I just knew it for extensions.<br />
Thanks !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">10th February 2006, 00:38</div></div><div class="posttext">Actually, I was browsing a little more and came across this MSDN (http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/Default.asp?url=/technet/prodtechnol/windows2000serv/reskit/regentry/69673.asp) article.  It looks like it would be better placed in HKEY_LOCAL_MACHINE\SOFTWARE\Classes or in HKEY_CURRENT_USER\SOFTWARE\Classes, since that is where HKEY_CLASSES_ROOT is made up from.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">10th February 2006, 08:51</div></div><div class="posttext">Hmm, while I don't need to do this, I don't really understand what you're saying. My Registry entries there don't correspond exactly to what you're saying (i.e. in Directory there isn't just a list of keys with display names and program executable subkeys. It looks like this:<br />
<br />
HKEY_LOCAL_MACHINE<br />
`-&gt;SOFTWARE<br />
   `-&gt;Classes<br />
      `-&gt;Directory<br />
         |+]Background<br />
         |-&gt;DefaultIcon<br />
         |+]shell<br />
         `+]shellex<br />
<br />
Now, shellex contains some useful stuff, mostly classids associated with program names. However I'm a bit confused as this is quite different to what you said.<br />
<br />
Thoughts? :) I'm just curious, I don't need this functionality.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wurstteppich</div><div class="date">2nd March 2006, 14:17</div></div><div class="posttext">Me neither. The existing structure within that key doesn't imply that the custom key is set in the &quot;Directory&quot; key itself.<br />
<br />
The other programs registered there (zip program, icq,...) however seem to use a custom class id which have a dll which they use to display their shell extensions. Can shell enhancements on directories not be used to hand over the full path to just a simple executable ? If not how can i solve this (how to create a dll to have context menu on directories with your own entries?) ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">2nd March 2006, 16:03</div></div><div class="posttext">Is this (http://www.codeproject.com/shell/copylocation.asp) what you want? It copies the path to the clipboard. Then you could use this function (http://nsis.sourceforge.net/mediawiki/index.php?title=Copy_to%2C_or_get_from_Windows_Clipboard&amp;redirect=no) to retrieve it (or modify the DLL to send the path directly to the program you want it to).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wurstteppich</div><div class="date">3rd March 2006, 23:32</div></div><div class="posttext">This looks like a start for my purpose, but unfortunatly i dont know C++ programming (we a little but not enough). Do you have an other example where the program is started with Program.exe %1 after clicking on &quot;Copy Folder Location&quot; ?<br />
<br />
Thanks for you answer!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">OldGrumpy</div><div class="date">4th March 2006, 07:46</div></div><div class="posttext">What about creating a link in the SendTo folder? If your menu entry has to be directly in the context menu, you will probably have to create a custom dll. With the SendTo menu entry, all you have to do is to create a shortcut file in the SendTo folder somewhere under Documents and Settings\Username\... - at the expense of an extra mouse move or click ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wurstteppich</div><div class="date">4th March 2006, 16:27</div></div><div class="posttext">That would be a possible solution and surely not too bad, but i would like to try it with a dll in the first place. It would be more nice to have it in the main menu. I know it is a small issue and something cosmetical, but it would just be more pleasant to have it there.<br />
But thanks for that suggestion!<br />
<br />
So does anyone else know where i can such an example dll source which i can modify to my needs without any bigger knowledge of programming ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wilsonronl</div><div class="date">25th September 2006, 22:43</div></div><div class="posttext">Try setting the default key to HKEY_CLASSES_ROOT\Directory\shell\progname\command<br />
<br />
to something like:<br />
<br />
&quot;c:\path\to\program.exe&quot; &quot;%1&quot;</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>