<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Shift key -&gt; Checkbox Appears..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Shift key -&gt; Checkbox Appears... NSIS Discussion" />
	
	<title> Shift key -&gt; Checkbox Appears... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Shift key -&gt; Checkbox Appears...</div>
<hr />
<div class="pda"><a href="t-237087.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=237087">Shift key -&gt; Checkbox Appears...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">3rd February 2006, 18:37</div></div><div class="posttext">Hello all.<br />
<br />
I would like to add a Checkbox to one of my install pages, however I would like it only to appear if the use holds the shift key down right before the page loads.  This would be just like the current functionality of the MUI_PAGE_DIRECTORY page, where holding the shift key down while clicking next will give you the &quot;Log install process&quot; checkbox.<br />
<br />
I'm looking for 2 difference though, the page I want this &quot;Shift key activated checkbox&quot; on is a custom page, and is also the very first page that is display when starting my installer.  Is this possible?  I love to be able to work it so holding down the shift(or Ctrl) key while double clicking on the installer would produce the check box on the first page (custom).  Any thoughts?  Thanks all.<br />
<br />
Jnuw</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd February 2006, 20:36</div></div><div class="posttext">You can call GetAsyncKeyState in the pre or show callback function and act upon its result, just like the directory page does for the logging option.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">3rd February 2006, 20:56</div></div><div class="posttext">Originally posted by kichik <br />
You can call GetAsyncKeyState in the pre or show callback function and act upon its result, just like the directory page does for the logging option. <br />
Hi kichik, GetAsyncKeyState sounds like exactly what I need.  I checked the NSIS help file, forums, and WIKI, but don't see any mention of this command/function.  Am I missing something?  Can I get an example of its use?  Thanks very much.<br />
<br />
Jnuw</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th February 2006, 11:45</div></div><div class="posttext">It's a Windows API (http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/getasynckeystate.asp).!define VK_SHIFT 0x10<br />
System::Call &quot;user32::GetAsyncKeyState(i ${VK_SHIFT}) i.r0&quot;<br />
IntOp $0 $0 &amp; 0x8000<br />
# $0 is not zero, if shift is pressed</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">6th February 2006, 19:12</div></div><div class="posttext">kichik, thank you so much that worked beautifully!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>