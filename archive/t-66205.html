<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Japanese, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Japanese NSIS Discussion" />
	
	<title> Japanese [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Japanese</div>
<hr />
<div class="pda"><a href="t-66205.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=66205">Japanese</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mgentry</div><div class="date">20th November 2001, 19:14</div></div><div class="posttext">Attached to this message is a .nsh file like that supplied in some of the latest versions of PiMP for Japanese installers.<br />
<br />
To actually be able to create a Japanese installer though, I had to modify the resource.rc file to use the right language and code page obviously.<br />
<br />
I'm sure there's probably a means of doing this through the script (setting a code page and locale) so that the dialog can be modified on the fly, but for now I've only taken the quick and easy way out.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Antikropp</div><div class="date">14th March 2003, 12:08</div></div><div class="posttext">I'm currently trying to make a japanese installer, but I'm having problems on windows 98, the text just displays at garbage. Can you tell me how you changed the codepage for the installer? I tried to change resource language in Project Settings and change all the dialogs to Japanese too. Then I get the following error when running the script:<br />
<br />
WindowIcon: off<br />
Error removing window icon: IDD_LICENSE doesn't exist!<br />
Error in script &quot;term01.nsi&quot; on line 23 -- aborting creation process<br />
<br />
MakeNSIS don't find the dialogs. If I remove the WindowIcon off part, there are other dialogs missing.<br />
<br />
Could you give me some details about how you got it running?<br />
<br />
I'm using NSIS 2.0.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th March 2003, 13:51</div></div><div class="posttext">Are you using a Japanese vesion of Windows? Do other Japanese applications work?<br />
<br />
About the WindowIcon: can you attach the script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th March 2003, 11:43</div></div><div class="posttext">NSIS looks for the English dialogs to remove. If you change the language it can't find any dialog.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Antikropp</div><div class="date">16th March 2003, 16:02</div></div><div class="posttext">I'm testing it on japanese windows and I still get garbled text on win98, but on japanese Win XP it works fine. On english windows the text is always garbled. It's the japanese distributer who tests it, so I guess they have their windows setup properly.<br />
<br />
I attach the script with this reply if anyone can see any errors. <br />
<br />
If NSIS can't find dialogs with other languages, then how are you supposed to be able to change the language for the installer? Or shouldn't you mess with the dialogs at all?<br />
<br />
Hope anyone can help me out!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th March 2003, 21:45</div></div><div class="posttext">What is the exact version of NSIS you are using? To find out open MakeNSISw and look at the number on the bottom left corner. If there's no number there you are using a very old version and you shuold upgrade. Have a look at the FAQ for more details on that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">16th March 2003, 22:01</div></div><div class="posttext">You did not change the language of the resources?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Antikropp</div><div class="date">17th March 2003, 09:04</div></div><div class="posttext">I'm using version 2.0b1, so I don't think that is the problem. <br />
<br />
First I tried without changing the language of the resources, but the text got garbled. When I tried to change the resources to japanese, I couldn't even biuld the installer because MakeNSIS complained about not finding the dialogs.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th March 2003, 12:48</div></div><div class="posttext">Try b2 and the latest version and try to set the font to a Japanese font using SetFont. If you get it working with SetFont try the MUI too so we will know if it works with the MUI.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">17th March 2003, 13:43</div></div><div class="posttext">The default shell font for Win95/98 is MS Sans Serif.<br />
<br />
Maybe that one doesn't support Japense. Use SetFont or !define MUI_FONT (for the MUI).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Antikropp</div><div class="date">18th March 2003, 10:07</div></div><div class="posttext">The problem is solved. It was just a matter of changing the language of the resources and using a font that is supported on all japanese OS. <br />
<br />
Thanks alot for the help folks! =)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">18th March 2003, 11:01</div></div><div class="posttext">Can you please add a page to the NSIS Archive about Japanese installers on Win9x, so other people won't have all these troubles?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th March 2003, 11:32</div></div><div class="posttext">The problem is solved. It was just a matter of changing the language of the resources and using a font that is supported on all japanese OS.<br />
<br />
How did you change the language of the resources without getting into trouble with makensis? AFAIK it should work with just changing the font.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Antikropp</div><div class="date">20th March 2003, 09:12</div></div><div class="posttext">The last fixes were made ny our distributor in Japan, so I don't have all the details. As far as I understand, all you really have to do is change the font in the resource file. Open exehead/resource.rc in your favourite text editor and replace all <br />
<br />
FONT 8, &quot;MS Sans Serif&quot;<br />
<br />
with<br />
<br />
FONT 8, &quot;‚l‚r ‚oƒSƒVƒbƒN&quot;<br />
<br />
Yes, it's supposed to look like that. Guess it's a multibyte name. <br />
<br />
I also changed the language of the dialogs to japanese. I'm not sure if this is necessary and some script-commands have problems finding the dialogs after this. &quot;WindowIcon off&quot; didnät work, so I had to disable the icons in the resource editor. It looks alright but not very dynamic. <br />
<br />
So, to summarize what I've learned. To get a japanese installer you have to:<br />
<br />
- change the font to one supported by the japanese OS<br />
- make some changes to the resources if scripting doesn't work<br />
<br />
Hope this is helping anyone!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th March 2003, 11:45</div></div><div class="posttext">You don't have to change the font in the resources, you can use SetFont, much easier ;) And as I said, it works for me without changing the dialog language and I do remember it worked for other Japanese and Chinese users so I don't think you should change it. SetFont is enough.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tderouin</div><div class="date">28th March 2003, 20:50</div></div><div class="posttext">I'm having a similar problem with Windows 98. I followed the suggestions and everything was good, except.<br />
1) the first image on the welcome screen and finish screen of the mui is missing (even though I'm using the default one) (this happens on windows95 too for the english version)<br />
2) the font for the title is garbled. (do I have to set MUI_FONT_HEADER ?)<br />
<br />
I'll attach screenshots. Any ideas?<br />
(how do you post screenshots)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">28th March 2003, 20:55</div></div><div class="posttext">You have to set another font for the title (that supports Japanese), please check the MUI Readme.<br />
<br />
Did you modify resource langauges? Try it with the normal language.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tderouin</div><div class="date">28th March 2003, 20:57</div></div><div class="posttext">Yeah, I think I realized the font thing.<br />
<br />
The missing image is a problem though, I've noticed it happening on windows 95 machines for english installs too. I posted about this awhile back and everyone said it worked for them, I modified the ioSpecial.ini file to accomodate more text in the intro section, it appears fine on win2k, xp, but on some 98 machines the image disappears.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">virtlink</div><div class="date">28th March 2003, 21:01</div></div><div class="posttext">tderouin: You can post screenshots in two ways:<br />
1) By copying them to a website or something that is online and can be accessed trough the internet. Use the IMG button of your 'Post Reply' form to refer to the file.<br />
2) By putting them all in a single zip file, ensure that it's size doesn't exceed the 10 kB, and upload it by selecting it at the 'Attach file:' part of the 'Post Reply' form. This file doesn't have to be online somewhere, as long as you can reach it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">28th March 2003, 21:32</div></div><div class="posttext">Can you please link to the older bugreport?<br />
<br />
So the image on the left side of the Welcome/Finish page disappears on older Windows versions?<br />
<br />
Using the latest NSIS 2 version?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tderouin</div><div class="date">28th March 2003, 22:03</div></div><div class="posttext">MakeNSIS v2.0b1<br />
<br />
It wasn't a bug report, it was a posting on this board.<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=122191</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">28th March 2003, 22:07</div></div><div class="posttext">Please upgrade to the latest version. The title can contain 3 lines now (beta 3) and no problems have been reported.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tderouin</div><div class="date">28th March 2003, 22:09</div></div><div class="posttext">Upgrading to the latest version isn't as easy as that if I've made customizations to the source.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tderouin</div><div class="date">28th March 2003, 22:11</div></div><div class="posttext">I found that resizing welcome.bmp to align with the size in the ioSpecial.ini file worked.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">28th March 2003, 22:20</div></div><div class="posttext">Did you modify the bitmap size in the INI file?<br />
<br />
What kind of modifications did you make? Using CVS, you can merge changes.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tderouin</div><div class="date">28th March 2003, 23:35</div></div><div class="posttext">For future info, the better fix is to keep the image the same size (314x164 or something), make that the image size in the ioSpecial.ini file and remove RESIZETOFIT. Then the image appears properly on win98 and win2k.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tderouin</div><div class="date">29th March 2003, 23:58</div></div><div class="posttext">Would anyone know why packages built on a &quot;Windows 2000 Server&quot; machine would have the problem with fonts not showing up on win98 machines, and packages built on &quot;Windows 2000 Professional&quot; are fine?<br />
<br />
Both are english OS's with their locale set to Japanese. I found that when the locale wasn't set to Japanese that the fonts wouldn't display properly, does anyone know why? <br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">30th March 2003, 11:52</div></div><div class="posttext">The OS that build the script should make no difference.<br />
<br />
NSIS doesn't use Unicode (because that doesn't work on 9x), so you should set the language for non-Unicode applications to Japanese.<br />
<br />
Removing RESIZETOFIT from ioSpecial.ini is not a good idea, because it won't work a custom DPI setting.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tderouin</div><div class="date">30th March 2003, 16:10</div></div><div class="posttext">Ok, so I'm still trying futher to debug this problem. What is seems like is that there's a problem with the install options dll, because in custom dialogs that I implemented with InstallOptions don't show up either in the installation.<br />
<br />
When I package the client on my windows 2000 pro machine at work and at home it works fine. But when I use our 2 different build machines (one is a win2k pro, the other is a win2k server). The only difference that I can immediately tell between these 4 machines is that on the 2 machines that it works is I've installed NSIS and NSIS workbench. In all situations our copy of NSIS is grabbed from source control to the machine and then is used to build the package. Does the NSIS installation update any system dlls that might be used by Install Options? I notice there's a comdlg32.dll dependency.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">30th March 2003, 17:13</div></div><div class="posttext">NSIS does not install any system files.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tderouin</div><div class="date">30th March 2003, 17:19</div></div><div class="posttext">Ok, so do you have any other idea of what could be the root cause? I realize that it could be a configuration error on my part, but I've narrowed several possibilities and still have the problem so it's a possibility that there's something else going on. <br />
<br />
Two packages built on two different machines using the same installer code base (NSIS), it's the exactly the same NSIS because it's checked into soure control. The resultant packages are exactly the same size - 1201KB. One package doesn't work properly on Japanese Windows 98, the text and image doesn't show up on the MUI welcome and finish page, and any custom dialogs don't have any text show up. The other package works as expected.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tderouin</div><div class="date">14th April 2003, 20:30</div></div><div class="posttext">I've run into a new problem creating packages with japanese fonts. When I specify the font in the Japanese language and build on a machine whose locale is set to EN_US, the installer comes out with large windows. When I specify the font in English on an English machine, it works fine except for Windows 98 as above. When I specify the font in Japanese on machine whose system locale is JP, such as:<br />
<br />
; japanese font<br />
!define MUI_FONT &quot;‚l‚r ‚oƒSƒVƒbƒN&quot;<br />
!define MUI_FONT_TITLE &quot;‚l‚r ‚oƒSƒVƒbƒN&quot;<br />
!define MUI_FONT_HEADER &quot;‚l‚r ‚oƒSƒVƒbƒN&quot;<br />
!define MUI_FONTSIZE 8<br />
SetFont &quot;‚l‚r ‚oƒSƒVƒbƒN&quot; 8<br />
<br />
Everything works as expected. The only problem with this is that our build machine handles builds for multiple locales, and I can't (through an Automated process) switch the locale because it requires rebooting. I think the problem is the font names are in English when the system's locale is set to English, even using the MS Windows 2k MUI and setting the user's locale to Japanese, the font names are still in English and somehow when the dialog properties are set they are either set incorrectly or just don't display properly on machines whose font names are in Japanese.<br />
<br />
Any suggestions?<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th April 2003, 08:06</div></div><div class="posttext">The problem is that NSIS converts the font name (and other texts in the resources) from MBCS to Unicode using CP_ACP and not the local code page. I do intend to add some more parameters to the language files so they can specify the code page, and a font name. For now you can create a special build of NSIS where every CP_ACP in DialogTemplate.cpp is replaced with the appropriate code page (you can find a list of code pages here (http://msdn.microsoft.com/library/default.asp?url=/library/en-us/intl/unicode_81rn.asp)).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>