<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Command Prompt Install, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Command Prompt Install NSIS Discussion" />
	
	<title> Command Prompt Install [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Command Prompt Install</div>
<hr />
<div class="pda"><a href="t-318758.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318758">Command Prompt Install</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">marcellokera</div><div class="date">28th April 2010, 21:57</div></div><div class="posttext">Hello, <br />
I am facing two problems with NSIS scripts. I am new on this but if someone could help me would be great...<br />
<br />
I have to do a installer that runs from a command prompt. I have to set some parameter that the user needs to set (I have done that already), but if the user doesn´t pass the parameter the installer should show a message on command prompt usage: installer.exe -d &lt;directory&gt;<br />
<br />
the other problem is that when I run the uninstall i have to zip the directory and save to a backup, I saw all the plugins but they just extract zip files they don´t create one...<br />
<br />
can anyone help me?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th April 2010, 22:07</div></div><div class="posttext">To create Zip files you could include a copy of 7za.exe (7-zip.org) and extract and execute that (with ExecDos/nsExec). The executable is a little on the heavy side but I'm not sure if there are any other freely available command line zippers out there.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">28th April 2010, 22:29</div></div><div class="posttext">I have coded this several times for other people, try a forum search next time...<br />
<br />
On XP and later it can be done perfectly: http://forums.winamp.com/showpost.php?p=2303779&amp;postcount=4<br />
<br />
For older platforms, there is no AttachConsole so you would have to call AllocConsole instead on those systems</div></div><hr />


<div class="post"><div class="posttop"><div class="username">marcellokera</div><div class="date">29th April 2010, 13:54</div></div><div class="posttext">Thanks a lot guys...<br />
Was very helpfull</div></div><hr />


<div class="post"><div class="posttop"><div class="username">marcellokera</div><div class="date">30th April 2010, 15:42</div></div><div class="posttext">Hi guys,<br />
<br />
I have done this way... thanks for the help :up:<br />
<br />
<br />
		 StrCpy $R0 &quot;$\r$\n $R0 $\r$\n&quot;		 <br />
		 StrLen $R4 $R0		 <br />
		 System::Call &quot;kernel32::AttachConsole(i -1)i .r0&quot;<br />
		 StrCmp $0 0 end		 <br />
		 System::Call &quot;kernel32::GetStdHandle(i -11)i .r0&quot;<br />
		 System::Call &quot;*(i 0)i .r1&quot;<br />
		 System::Call &quot;kernel32::WriteConsole(i r0, t R0, i R4, i r1, i 0)&quot;<br />
		 System::Free $1<br />
		 System::Call &quot;kernel32::FreeConsole()&quot;		 <br />
		 end:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">30th April 2010, 16:22</div></div><div class="posttext">You should not use writeconsole to write plain ansi text, use WriteFile (If you use WriteFile, the output can be redirected and/or piped)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">marcellokera</div><div class="date">30th April 2010, 17:34</div></div><div class="posttext">Hum ok...<br />
I changed to <br />
System::Call &quot;kernel32::WriteFile(i r0, t R0, i R4, i r1, i 0)&quot;<br />
<br />
well I have another question Anders... <br />
<br />
Is there a way to keep the prompt right after the command? like<br />
<br />
c:\&gt;example.exe -d d: &lt;here comes the error message&gt;<br />
<br />
instead of what is doing now<br />
c:\&gt;example.exe -d d:<br />
c:\&gt; Error Message</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">30th April 2010, 18:39</div></div><div class="posttext">I changed to <br />
System::Call &quot;kernel32::WriteFile(i r0, t R0, i R4, i r1, i 0)&quot;<br />
<br />
<br />
The nsis FileWrite command calls WriteFile (See the link I posted)<br />
<br />
As far as the newline goes, the answer is yes and no. The short answer is, NO. The long answer is, you have full control over the console buffer and can do anything you want to it by calling the correct windows api's</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>