<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" FileOpen doesn't work, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  FileOpen doesn't work NSIS Discussion" />
	
	<title> FileOpen doesn't work [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  FileOpen doesn't work</div>
<hr />
<div class="pda"><a href="t-218872.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=218872">FileOpen doesn't work</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">blue_raptor</div><div class="date">14th June 2005, 11:59</div></div><div class="posttext">I try to open a file with FileOpen. But it does not work. With my Explorer I am able to open that file with no problems. The file is created during the procedure by a vbscript (yes, that's nessesary).<br />
<br />
Here is my NSIS Code<br />
<br />
SetOverwrite on<br />
<br />
  SetOutPath &quot;$INSTDIR\tmp&quot;<br />
<br />
  File &quot;${BIN}\ImportAssistentScript.vbs&quot;<br />
  File &quot;${BIN}\ZertifikatImport.vbs&quot;<br />
  File &quot;${BIN}\ZertifikatsKonsole.msc&quot;<br />
<br />
  ;privates zertifikat in den speicher laden über die skripte<br />
  Exec 'cscript &quot;$INSTDIR\tmp\ImportAssistentScript.vbs&quot; &quot;$private_crt&quot; &quot;$pwd&quot;'<br />
  ExecWait 'cscript &quot;$INSTDIR\tmp\ZertifikatImport.vbs&quot; &quot;$INSTDIR\tmp\ZertifikatsKonsole.msc&quot; &quot;$INSTDIR&quot;'<br />
  <br />
  Delete &quot;${BIN}\ImportAssistentScript.vbs&quot;<br />
  Delete &quot;${BIN}\ZertifikatImport.vbs&quot;<br />
  Delete &quot;${BIN}\ZertifikatsKonsole.msc&quot;<br />
<br />
  ;datei tmp.txt wird im script geschrieben.<br />
  StrCpy $R1 &quot;$INSTDIR\tmp.txt&quot;<br />
<br />
  FileOpen $0 $R1 &quot;r&quot; ;hier tritt ein fehler auf. warum???<br />
  IfErrors error1<br />
<br />
  FileRead $0 $1<br />
  IfErrors error2<br />
  <br />
  MessageBox MB_OK &quot;Datei-Inhalt '$1'&quot;<br />
  <br />
  FileClose $0<br />
  goto done<br />
  <br />
  error1:<br />
  MessageBox MB_OK &quot;fehler beim öffnen der datei: '$R1'&quot;<br />
  goto done<br />
  <br />
  error2:<br />
  MessageBox MB_OK &quot;fehler beim lesen der datei&quot;<br />
  goto done<br />
  <br />
  done:<br />
  <br />
  Quit<br />
 <br />
<br />
It's only a testing part. First I copy the vbscript files to the instdir to run them on the target computer. after they are executed I delete the files. At this time, the file tmp.txt allready exists. But FileOpen fails. I have absolutely no idea why!<br />
<br />
For those who can script vb here's the part of writing the file in vbscript.<br />
<br />
Dim zertName<br />
zertName = objView.CellContents(objItem, 1)<br />
<br />
'Ergebnis in temp datei speichern<br />
Dim objFSO, file<br />
Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)<br />
Set file   = objFSO.CreateTextFile(path + &quot;\tmp.txt&quot;, true)<br />
file.WriteLine(zertName)<br />
file.Close()<br />
 <br />
<br />
I think, that this is not a NSIS Problem. But I don't know anyone who could help me... :cry:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">blue_raptor</div><div class="date">14th June 2005, 12:59</div></div><div class="posttext">I have to write<br />
<br />
FileOpen $0 &quot;$R1&quot; &quot;r&quot; ;hier tritt ein fehler auf. warum??? <br />
<br />
instead of <br />
<br />
FileOpen $0 $R1 &quot;r&quot; ;hier tritt ein fehler auf. warum???</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th June 2005, 01:29</div></div><div class="posttext">Try:<br />
  ClearErrors<br />
  FileOpen $0 $R1 &quot;r&quot; ;hier tritt ein fehler auf. warum???<br />
  IfErrors error1<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th June 2005, 01:30</div></div><div class="posttext">Also, I think the Delete's should be:<br />
  Delete &quot;$INSTDIR\tmp\ImportAssistentScript.vbs&quot;<br />
  Delete &quot;$INSTDIR\tmp\ZertifikatImport.vbs&quot;<br />
  Delete &quot;$INSTDIR\tmp\ZertifikatsKonsole.msc&quot;<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">blue_raptor</div><div class="date">16th June 2005, 10:03</div></div><div class="posttext">Originally posted by Afrow UK <br />
Also, I think the Delete's should be:<br />
  Delete &quot;$INSTDIR\tmp\ImportAssistentScript.vbs&quot;<br />
  Delete &quot;$INSTDIR\tmp\ZertifikatImport.vbs&quot;<br />
  Delete &quot;$INSTDIR\tmp\ZertifikatsKonsole.msc&quot;<br />
<br />
-Stu  <br />
<br />
Oh yes! You're right. Thanks!!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>