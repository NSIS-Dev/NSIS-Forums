<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" nsexec parameters with quotes, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  nsexec parameters with quotes NSIS Discussion" />
	
	<title> nsexec parameters with quotes [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  nsexec parameters with quotes</div>
<hr />
<div class="pda"><a href="t-297297.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=297297">nsexec parameters with quotes</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pbingel</div><div class="date">12th September 2008, 21:08</div></div><div class="posttext">I'm trying to write a script that will retrive the system manufacturer of the system and then install one program or another depending on the result. I have the cmd line command but am having trouble converting it so that I can use it in an nsis script. <br />
<br />
The cmd line command is:<br />
<br />
&quot;systeminfo&quot; |find &quot;System Manufacturer:&quot;<br />
<br />
<br />
I tried converting this into a nsExec::ExecToStack command<br />
<br />
<br />
nsExec::ExecToStack '&quot;systeminfo&quot; |find &quot;System Manufacturer:&quot; '<br />
Pop $0<br />
Pop $1<br />
MessageBox MB_OK '$0'<br />
MessageBox MB_OK '$1'<br />
<br />
<br />
However no matter which combinations of &quot;,',` I use I can't seem to get a command that works. Also tried using $\&quot; but the double quote is then completly ignored. <br />
<br />
Thanks in advance for help!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">13th September 2008, 01:45</div></div><div class="posttext">Originally posted by pbingel <br />
I'm trying to write a script that will retrive the system manufacturer of the system and then install one program or another depending on the result. I have the cmd line command but am having trouble converting it so that I can use it in an nsis script. <br />
<br />
The cmd line command is:<br />
<br />
&quot;systeminfo&quot; |find &quot;System Manufacturer:&quot;<br />
<br />
<br />
I tried converting this into a nsExec::ExecToStack command<br />
<br />
<br />
nsExec::ExecToStack '&quot;systeminfo&quot; |find &quot;System Manufacturer:&quot; '<br />
Pop $0<br />
Pop $1<br />
MessageBox MB_OK '$0'<br />
MessageBox MB_OK '$1'<br />
<br />
<br />
However no matter which combinations of &quot;,',` I use I can't seem to get a command that works. Also tried using $\&quot; but the double quote is then completly ignored. <br />
<br />
Thanks in advance for help!  <br />
<br />
I think nsExec can only run executables, it can NOT execute shell commands, like the COMMAND shell can do. So the &quot;|&quot; won't work. You'll have to do it like this:<br />
<br />
Section<br />
  nsExec::ExecToStack '&quot;$SYSDIR\cmd.exe&quot; /c systeminfo | find &quot;System Manufacturer:&quot;'<br />
  Pop $0<br />
  Pop $1<br />
  MessageBox MB_OK '$0'<br />
  MessageBox MB_OK '$1'<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pbingel</div><div class="date">15th September 2008, 14:53</div></div><div class="posttext">Thanks for the reply.<br />
<br />
Launching systeminfo isn't the problem. nsExec uses the command line so there is not issue with calling command line executables like systeminfo. However the problem lies in how nsexec gives the command line parameters. Parameters in nsexec are seperated by a space but many parameters for command line arguments have spaces in them. No matter how I mix quotes I always get <br />
<br />
ERROR:Invalid Argument/Option- '|find'. <br />
or<br />
ERROR:Invalid Argument/Option- '|find System'  &lt;notice quote was ignored<br />
<br />
The argument must be exactly '|find &quot;System Manufacturer:&quot; including the quotes around System Manufacturer:<br />
<br />
Any help would be appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">15th September 2008, 15:18</div></div><div class="posttext">I already posted a working (tested) example ...<br />
<br />
http://img153.imageshack.us/img153/4154/sysinfonsisdk3.th.png (http://img153.imageshack.us/my.php?image=sysinfonsisdk3.png)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pbingel</div><div class="date">15th September 2008, 15:27</div></div><div class="posttext">I apologize when I copied your example earlier and tried it and it gave me an error and actually crashed the editor twice. But when I tried it again now it worked fine... <br />
<br />
Thanks very much and again I apologize.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">15th September 2008, 16:00</div></div><div class="posttext">No problem. You may even do it this way, using only *full* paths:<br />
<br />
OutFile &quot;TestCMD.exe&quot;<br />
Name &quot;Sysinfo Test&quot;<br />
<br />
!define CmdLine '&quot;$SYSDIR\cmd.exe&quot; /c &quot;&quot;$SYSDIR\systeminfo.exe&quot; | &quot;$SYSDIR\find.exe&quot; &quot;System Manufacturer:&quot;&quot;'<br />
<br />
Section<br />
  DetailPrint 'Exec: ${CmdLine}'<br />
  nsExec::ExecToStack '${CmdLine}'<br />
  Pop $0<br />
  Pop $1<br />
  DetailPrint &quot;Exit Code: $0&quot;<br />
  DetailPrint &quot;$1&quot;<br />
  MessageBox MB_OK '$1'<br />
SectionEnd<br />
<br />
(Yes, the quotes are correct, although it looks strange. The &quot;cmd.exe&quot; has some ugly quotes handling ^^)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>