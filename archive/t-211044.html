<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" LogSet turns itself Off..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  LogSet turns itself Off... NSIS Discussion" />
	
	<title> LogSet turns itself Off... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  LogSet turns itself Off...</div>
<hr />
<div class="pda"><a href="t-211044.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=211044">LogSet turns itself Off...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">21st March 2005, 21:23</div></div><div class="posttext">I'm updating my installer (with 2.05) with some new features, and one of the things I did was move the &quot;LogSet On&quot; command from my first section to the .onInit function, for more complete logging.  Now Iâ€™m getting logging from the very beginning of the install which is nice.  However, I found a problem.<br />
<br />
When I run my installer in silent mode, I get 100% of the logging.  However when I run it in normal (MUI) mode, the logging stops right after my DirectoryLeave function.  The next page in my installer is the MUI_PAGE_INSTFILES, so I just added the &quot;LogSet On&quot; command (for the second time) to the first line of the first section, and it continues on.<br />
<br />
Its like my DirectoryLeave function or the INSTFILES page turns off the LogSet setting.  Any thoughts?<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">22nd March 2005, 16:38</div></div><div class="posttext">I created a sample nsi file that this problem is reproducible in.  Compile the below code and run it by double clicking on it.  After it runs (on you desktop is fine) you will see that the log file stops logging right after the directory leave function.  Then run it in silent mode from command line, (logset.exe /S) and you will see the logging keeps going throughout the sections.<br />
<br />
If you then un-comment the ;LogSet On command in the -Pre section, that seems to correct the problem, but having to set LogSet twice (in .onInit and in the first section) seems like a bug.  Thanks all.<br />
<br />
<br />
<br />
; NSIS 2.05<br />
<br />
!define PRODUCT_NAME &quot;LogSet&quot;<br />
!include &quot;MUI.nsh&quot;<br />
!define MUI_ABORTWARNING<br />
<br />
; Pages<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
!define MUI_PAGE_CUSTOMFUNCTION_LEAVE &quot;DirectoryLeave&quot;<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_PAGE_FINISH<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
; MUI end------<br />
Name &quot;${PRODUCT_NAME}&quot;<br />
AllowRootDirInstall True<br />
OutFile &quot;LogSet.exe&quot;<br />
InstallDir &quot;$EXEDIR&quot;<br />
ShowInstDetails Hide<br />
<br />
<br />
Section &quot;-Pre&quot;<br />
  ;LogSet On<br />
  IfSilent 0 End<br />
    Call DirectoryLeave<br />
  End:<br />
SectionEnd<br />
<br />
<br />
Section &quot;1&quot; SEC01<br />
  DetailPrint &quot;In Section 1&quot;<br />
SectionEnd<br />
<br />
<br />
Section &quot;2&quot; SEC02<br />
   DetailPrint &quot;In Section 2&quot;<br />
SectionEnd<br />
<br />
<br />
Section &quot;3&quot; SEC03<br />
   DetailPrint &quot;In Section 3&quot;<br />
SectionEnd<br />
<br />
<br />
<br />
;---------------------------------<br />
<br />
<br />
<br />
Function .onInit<br />
  LogSet On<br />
  LogText &quot;&quot;<br />
  LogText &quot;&quot;<br />
  LogText &quot;_________________________&quot;<br />
  LogText &quot;Start of ${PRODUCT_NAME}&quot;<br />
FunctionEnd<br />
<br />
Function DirectoryLeave<br />
   DetailPrint &quot;In DirectoryLeave&quot;<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd March 2005, 18:45</div></div><div class="posttext">The directory page can turn the logging on and off. If the user holds the shift key when moving into the directory page, he sees a checkbox asking him if he'd like to turn logging on. I guess the leave code doesn't check if shift was held and checks the checkbox anyway. When there is no checkbox, it turns off logging because the &quot;checkbox&quot; is not checked. Please submit a bug report in the bug tracker.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">22nd March 2005, 18:53</div></div><div class="posttext">Thanks kichik.  Will do, just going to get lunch first, thanks again!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">22nd March 2005, 21:55</div></div><div class="posttext">Bugged in bug tracker, thanks!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>