<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Read Version Information from MyApp.exe, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Read Version Information from MyApp.exe NSIS Discussion" />
	
	<title> Read Version Information from MyApp.exe [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Read Version Information from MyApp.exe</div>
<hr />
<div class="pda"><a href="t-234145.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=234145">Read Version Information from MyApp.exe</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">fellz</div><div class="date">27th December 2005, 22:52</div></div><div class="posttext">Hi!<br />
<br />
I am trying to read version information from my application's fileinfo. I want the installer to automatically show the Application's version (which is stored in MyApp.exe).<br />
<br />
I tried it that way - without any success:<br />
<br />
---<br />
!include &quot;FileFunc.nsh&quot;<br />
!insertmacro GetFileVersion<br />
Section test<br />
  ${GetFileVersion} &quot;MyApp.exe&quot; $R0<br />
  !define PRODUCT_VERSION &quot;$R0&quot;<br />
SectionEnd<br />
---<br />
<br />
Any clues what's wrong here?<br />
<br />
Many thanks in advance!<br />
<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th December 2005, 13:07</div></div><div class="posttext">Make sure you specify a full path and not a relative one.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fellz</div><div class="date">28th December 2005, 16:02</div></div><div class="posttext">thanks,<br />
<br />
i also tried using a full path before - without luck :-(<br />
and yes, windows explorer shows the version information of the .exe - so this should be ok as well (even the my program itself reads it from the exe)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th December 2005, 16:59</div></div><div class="posttext">O.K. I see your problem I think.<br />
Check the value of $R0 in your Section (e.g. with a MessageBox). It should be correct.<br />
<br />
Now, the problem is that you are defining PRODUCT_VERSION as $R0. As soon as you change the value of $R0, PRODUCT_VERSION will also be changed. PRODUCT_VERSION is not a variable. It's just a constant and when you compile your installer, all instances of ${PRODUCT_VERSION} will be replaced with $R0.<br />
<br />
The best thing to do here would be to define a PRODUCT_VERSION variable with the Var instruction, and use that instead of $R0. The PRODUCT_VERSION define will no longer be necessary.<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>