<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Unicode Nsis - Problem reading a xml file, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Unicode Nsis - Problem reading a xml file NSIS Discussion" />
	
	<title> Unicode Nsis - Problem reading a xml file [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Unicode Nsis - Problem reading a xml file</div>
<hr />
<div class="pda"><a href="t-340424.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=340424">Unicode Nsis - Problem reading a xml file</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">11th January 2012, 12:37</div></div><div class="posttext">Hi all.<br />
I am trying to build a unicode setup. I have to read some informations from a xml file but in the unicode version i can not do it. I tried to use different plugins like XML plugin(the one i used for the ANSI setup and it works fine), nsisXml and some others. with XML plugin in the unicode version I retrieve instead of my values, other chars(like squares &lt;.&lt; or empty strings). I can't understand why this happend. Xml plugin could support unicode UTF-8.<br />
I attach the code I am using for reading the xml file and the xml file.<br />
<br />
&lt;root&gt;<br />
    &lt;version vers=&quot;myvalue&quot;/&gt;<br />
&lt;/root&gt;<br />
<br />
<br />
<br />
${If} ${FileExists} &quot;file.xml&quot;<br />
		${xml::LoadFile} &quot;file.xml&quot; $0<br />
	<br />
		${xml::FindNextElement} &quot;version&quot; $0 $1					<br />
	<br />
		${xml::ElementPath} $Path<br />
	<br />
		${xml::GotoPath} &quot;$Path&quot; $5<br />
	<br />
		${xml::GetAttribute} &quot;vers&quot; $myvar $2	<br />
	<br />
		${xml::Unload}<br />
	${EndIf}<br />
<br />
<br />
I can not understand why this code work in ANSI format returning in this example &quot;myvalue&quot; and does not work in UTF-8 returning a square or an empty string:hang::(.<br />
<br />
p.s. I am sorry for my English .-. and i can not find the answer in other threads so i made this...:p<br />
<br />
Thnx in advance<br />
Bennaloz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">12th January 2012, 05:44</div></div><div class="posttext">Please clarify which parts are unicode and which not!<br />
<br />
If you have UNICODE NSIS you need to have UNICODE plugins (xml plugin)<br />
But the .XML file still may be saved as NON-unicode!<br />
Reading ANSI xml file with Unicode plug-in will be probably fine but reading UTF-8 xml file<br />
may fail even with Unicode plug-in.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">12th January 2012, 07:37</div></div><div class="posttext">Ok for first I am sorry if I am making a stupid question or asking the obvious but I am a beginner in this field and I still don't know how things work. I will try to explain you better what the situation is.<br />
I am using Notepad++ as text editor. I made my non-Unicode setup so in ANSI format. But since I need an Unicode one I thought to convert it in UTF-8 with notepad but compiling it with Unicode NSIS it does not work. <br />
Initially I didn't think about the format of the .xml file but then I tried to convert it to UTF-8 and it didn't work the same so I tried again to ANSI format and the result was the same, I can't read the .xml file.<br />
I am using the XML plugin(nsis.sourceforge.net/XML_plug-in &lt;-- this one) that should support Unicode UTF-8.<br />
I don't understand why I can't read the .xml file.<br />
I hope I was clear explaining the problem.<br />
<br />
Thnx again</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">12th January 2012, 09:01</div></div><div class="posttext">you don't have to convert the script to unicode, the unicode compiler does this for you. however, you might have to convert your xml file to unicode to make it work with your unicode installer. a2u.exe  (http://code.google.com/p/unsis/downloads/detail?name=a2u.zip)should do the job!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">12th January 2012, 10:58</div></div><div class="posttext">Ok T.Slappy said the opposite that is &quot;Reading ANSI xml file with Unicode plug-in will be probably fine but reading UTF-8 xml file<br />
may fail even with Unicode plug-in. &quot;<br />
(And then I was thinking about that a unicode setup should be able to read an ansi and a unicode file because unicode includes also ansi chars if I am not wrong.)<br />
Anyway right now I have no ideas what to do.<br />
If I have to read a .xml file (ansi or unicode) with a unicode setup how can I do it? If I have to convert it to unicode from ansi I was trying Unicode plugin(because I need to convert it runtime) but it seems can't open the file and I don't know why.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">12th January 2012, 12:15</div></div><div class="posttext">I have just made a new setup. I tried only to load a .xml file that doesn't exist. The return should be a -1 because it doesn't exist but returned a square. So what is the problem? This plugin doesn't support unicode?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th January 2012, 13:06</div></div><div class="posttext">Have you extracted the Unicode version of the plug-in (if there is one)?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">12th January 2012, 13:30</div></div><div class="posttext">There is only a .dll file and a .nsh file (related .dll library) (nsis.sourceforge.net/XML_plug-in) this is the plugin I am using... I see the square compiling with unicode NSIS and showing the result with detailPrint or messageBox I don't think that the reason of the square is the way that I show the result. Anyway there is only a plugin in the pack and on sourceforge is write it support unicode UTF-8.<br />
I attached my source. Try to compile it with both NSIS unicode and ansi and you will see the difference. Obviously you must have my xml plugin you find it in the link above. let me know what's wrong if you can.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th January 2012, 14:50</div></div><div class="posttext">If you want to use a plug-in with Unicode NSIS you will usually need a Unicode build of that plug-in.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">12th January 2012, 14:53</div></div><div class="posttext">ah yes sure... So do you know some unicode plug-ins to read xml? i'll repeat that this one should be unicode anyway if you know others plugin please tell me maybe one that works...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th January 2012, 16:09</div></div><div class="posttext">http://wiz0u.free.fr/prog/nsisXML/<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">13th January 2012, 07:11</div></div><div class="posttext">tested... it gives me a Runtime error when I execute the unicode setup... also using the examples... so it's not a my mistake writing the source... but other problems and I don't know what kind of problems could be<br />
Can I ask someone to make a little example that works and read a .xml file(maybe with wizou's plugin)? Could the OS be the cause of the problem? (I don't think I am using XP)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">13th January 2012, 09:57</div></div><div class="posttext">OK I am noob I make it works now...@afro Thnx for the link you said it works and it works I said that it didn't work because before installing unicode nsis I took only the ansi plugin... anyway thnx for all...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">13th January 2012, 12:58</div></div><div class="posttext">Anybody know if NsisList plug-in support unicode?<br />
ok never mind I solved by myself</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th January 2012, 14:54</div></div><div class="posttext">There doesn't appear to be a Unicode build. Did you use a different plug-in instead?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">16th January 2012, 07:36</div></div><div class="posttext">Yes I used nsArray. If I am not wrong you made it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th January 2012, 12:47</div></div><div class="posttext">Correct :)<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">16th January 2012, 16:01</div></div><div class="posttext">At last it's a list managed like an array right? or not? u.u</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th January 2012, 21:07</div></div><div class="posttext">Yes it uses a linked list of pointers rather than a large allocation of contiguous memory.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">17th January 2012, 07:08</div></div><div class="posttext">yes because otherwise it would be impossible to add/delete elements. anyway thanks a lot again for the help...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>