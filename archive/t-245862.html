<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Automated (not Silent) Installer, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Automated (not Silent) Installer NSIS Discussion" />
	
	<title> Automated (not Silent) Installer [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Automated (not Silent) Installer</div>
<hr />
<div class="pda"><a href="t-245862.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=245862">Automated (not Silent) Installer</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Wabiloo</div><div class="date">10th May 2006, 10:55</div></div><div class="posttext">I've created a rather complex installer for my application, that &quot;intelligently&quot; finds what components to install, how to fill in the default values in the custom pages, etc. according to what's already on the computer. This is (at the moment) all done in the custom page functions.<br />
<br />
I would like now to make the installer fully automated, ie. not require the user to click the &quot;next&quot; button manually.<br />
However, I don't want it to be silent. First, because I would have to rewrite the whole thing so that the logic wouldn't be in the custom page functions (I discovered that the page functions are not called at all in a silent installer). Anyway, I want to see the GUI, even if I want to not have to interact with it.<br />
<br />
Is there a way, just after a page (be it custom page or standard MUI page) is displayed, to automatically go to the next page (as if the &quot;next&quot; button had been clicked)?<br />
<br />
I notice that if in a custom page I put a messagebox just after the call to MUI_INSTALLOPTIONS_DISPLAY, it will not appear until I actually click the &quot;next&quot; button...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">10th May 2006, 11:15</div></div><div class="posttext">you can make the installer to proccess your custom pages too when making a silent install.<br />
<br />
have a look at this thread, maybe it helps...<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=239240<br />
<br />
OJi.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wabiloo</div><div class="date">10th May 2006, 12:29</div></div><div class="posttext">Yes, but that what I meant when I said I didn't want to rewrite the whole thing. Plus, I actually want to see the screens, just not want to click them.<br />
<br />
What I'd like is some way of having each page show for 3 seconds, then the next button is &quot;clicked&quot; automatically.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">10th May 2006, 13:45</div></div><div class="posttext">i understood what you want.<br />
i just wanted to show you that it can be made in silent too. you don't have to rewrite everything.<br />
i had the same problem and with the help from the thread i specified i managed to do it. :)<br />
<br />
sorry, but i don't know how to make what you want.<br />
the solution will come, just be pacient. somebody from this forum will help you. they allways do ! :up: <br />
<br />
OJi.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galil</div><div class="date">10th May 2006, 17:33</div></div><div class="posttext">Clicking a button is a simple matter of sending a bm_click message to installer window.<br />
Problem here is that I don't think (though I might be wrong) there's a way to send it from installer itself when it finishes creating a page and waits for user input. <br />
So you have to compile an external proggy to do the job and run it from your main installer.<br />
Conceptual script for the proggy:<br />
SetCompress off<br />
Name &quot;Autoclick&quot;<br />
OutFile &quot;Autoclick.exe&quot;<br />
<br />
!include WinMessages.nsh<br />
<br />
Function .onInit<br />
loop:<br />
Sleep 3000 ;wait some (optional)<br />
FindWindow $0 &quot;#32770&quot; ;search for the NSIS window<br />
StrCmp $0 0 end ;quit if not found<br />
     GetDlgItem $0 $0 1 ;get handle of the proceed button<br />
     SendMessage $0 ${BM_CLICK} &quot;&quot; &quot;&quot; ;click the button<br />
     Goto loop ;repeat<br />
end:<br />
Quit<br />
FunctionEnd<br />
<br />
Section &quot;&quot;<br />
SectionEnd<br />
In your main script, add something like this:<br />
!define MUI_CUSTOMFUNCTION_GUIINIT myGuiInit<br />
  <br />
Function myGuiInit<br />
ClearErrors<br />
Exec &quot;$EXEDIR\Autoclick.exe&quot;<br />
IfErrors 0 +2<br />
MessageBox MB_OK &quot;Could not launch Autoclick! Manual step through.&quot;<br />
FunctionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>