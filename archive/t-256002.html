<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Start menu entries not created, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Start menu entries not created NSIS Discussion" />
	
	<title> Start menu entries not created [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Start menu entries not created</div>
<hr />
<div class="pda"><a href="t-256002.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=256002">Start menu entries not created</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">2biased</div><div class="date">22nd September 2006, 21:44</div></div><div class="posttext">Hi,<br />
<br />
by reading through the forum and the docs the Start Menu entry topic should be a easy thing but unfortunately I am not able to make it work for me. I try to create 3 sub folders in the start menu like<br />
<br />
$SMPROGRAMS\A Folder\B Folder\C Folder<br />
<br />
and within the C Folder 4 items<br />
<br />
StartApp    -&gt; goes to the exe<br />
ShowReadme  -&gt; points to a text file<br />
OpenManual  -&gt; points to a pdf file<br />
Uninstall   -&gt; points to the uninstaller<br />
<br />
The code for this looks like the following:<br />
<br />
<br />
Section &quot;ToStartMenu&quot;<br />
<br />
	; Install for all users if uncommented<br />
	; SetShellVarContext current<br />
	<br />
	IfFileExists &quot;$SMPROGRAMS\A Folder\*.*&quot; +2 0<br />
		CreateDirectory &quot;$SMPROGRAMS\A Folder&quot;<br />
	IfFileExists &quot;$SMPROGRAMS\A Folder\B Folder\*.*&quot; +2 0<br />
		CreateDirectory &quot;$SMPROGRAMS\A Folder\B Folder&quot;<br />
	IfFileExists &quot;$SMPROGRAMS\A Folder\B Folder\C Folder\*.*&quot; +2 0<br />
		CreateDirectory &quot;$SMPROGRAMS\A Folder\B Folder\C Folder&quot;<br />
	CreateShortCut &quot;$SMPROGRAMS\A Folder\B Folder\C Folder\StartApp.lnk&quot; &quot;$INSTDIR\StartApp.exe&quot;<br />
	CreateShortCut &quot;$SMPROGRAMS\A Folder\B Folder\C Folder\ReadMe.lnk&quot; &quot;$INSTDIR\TheRealReadme.txt&quot;<br />
	CreateShortCut &quot;$SMPROGRAMS\$SMPROGRAMS\A Folder\B Folder\C Folder\Manual.lnk&quot; &quot;$INSTDIR\User Manual.pdf&quot;<br />
	CreateShortCut &quot;$SMPROGRAMS\A Folder\B Folder\C Folder\Uninstall.lnk&quot; &quot;$INSTDIR\Uninst.exe&quot;<br />
	<br />
	; back to current user if uncommented<br />
	; SetShellVarContext current<br />
	<br />
SectionEnd<br />
<br />
<br />
The folders are created without problems but the installer claims to have problems to create the actual shortcuts. No matter if I try to install them into the user space or for all user using the SetShellVarContext commented out in this example.<br />
<br />
As I said, I didn't find a solution to the problem in the manual or the forum and I am pretty new to NSIS so I hope someone can give me a small hint what I do wrong.<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd September 2006, 21:46</div></div><div class="posttext">There's no need for all of those IfFileExists calls. CreateDirectory will create the directory and any missing parent directories and will simply continue if the directory already exists.<br />
<br />
I can't tell why the shortcuts are not being created from the example you gave, aside from that double $SMPROGRAMS typo. Make sure you're using the exact same path for CreateDirectory and CreateShortcut. If that doesn't work, attach a real example.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">2biased</div><div class="date">22nd September 2006, 23:41</div></div><div class="posttext">Thanks for the hint with the typo. In the actual code it wasn't this typo but I had an error with the paths I just didn't see. Sorry for the hassle thought but thanks a lot for the help. Really apreciate it.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>