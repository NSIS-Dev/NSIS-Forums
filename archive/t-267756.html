<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How can i install SQL Expres inthe slient, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How can i install SQL Expres inthe slient NSIS Discussion" />
	
	<title> How can i install SQL Expres inthe slient [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How can i install SQL Expres inthe slient</div>
<hr />
<div class="pda"><a href="t-267756.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267756">How can i install SQL Expres inthe slient</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mukeshnaval</div><div class="date">14th March 2007, 10:03</div></div><div class="posttext">Hi All,<br />
can anybody tell me hhow can we install sql express 2005 in the slient mode with the NSIS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Davion</div><div class="date">14th March 2007, 11:34</div></div><div class="posttext">Hi mukeshnaval,<br />
<br />
to install SQL Express in Silent mode you should read this (http://blogs.msdn.com/sqlexpress/archive/2006/09/20/configuring-sql-express-during-installation.aspx) first.<br />
<br />
There are some parameters and so on you may need.<br />
<br />
To call the Setup by CommandLine you should use ExecWait<br />
(look for 4.9.1.4 ExecWait in the Docs).<br />
<br />
Using ExecWait will grant that the SQLSetup is finishied before your installer proceeds.<br />
<br />
hope this helps,<br />
Greetz<br />
<br />
Dave</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">14th March 2007, 11:50</div></div><div class="posttext">I have a script that asks for parameters (the sql password for user sa) and then perform a sql express silent install, a client components install and a management console install.<br />
It also asks and eventually installs sql2005 express prerequisites (.net 2.0 and msinstaller 3.0). It's in italian but if you need i can try a translate and send it to you.<br />
<br />
basically you have to insert some statements like these:<br />
<br />
  ExecWait '&quot;SQL2005Express\SQLEXPR\SETUP.EXE&quot; /settings $PLUGINSDIR\SQL2005SRV.ini /qb'<br />
  IfErrors 0 +2<br />
  Abort &quot;Installation failed&quot;<br />
<br />
The SQL2005SRV.ini file is like following:<br />
<br />
[Options]<br />
INSTANCENAME=MSSQLSERVER<br />
ADDLOCAL=SQL_Engine,SQL_Data_Files<br />
SECURITYMODE=SQL<br />
SAPWD=&lt;insert your password here&gt;<br />
SQLCOLLATION=&lt;insert your collating here&gt;<br />
DISABLENETWORKPROTOCOLS=0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mukeshnaval</div><div class="date">15th March 2007, 13:41</div></div><div class="posttext">Hi... sgiusto<br />
<br />
can u send me the sample .ini file with the password 'sa'<br />
because i m getting error invalid ini file. <br />
<br />
my mailID: mukeshn@icreon.net</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jholguin</div><div class="date">16th March 2007, 19:58</div></div><div class="posttext">Here's what I have to install SQLExpress Advanced and the extra tools section. It should be fairly straight forward to narrow it down to just sqlexpress if you need.<br />
<br />
The code also searches to see if they have a pre-existing sql express version and asks them for permission to update. If they have normal sql express w/Advanced, it requires different command line parameters so that adds a little more code to it.<br />
<br />
I've tried to delete all my extra code, but I may have missed some things. <br />
<br />
!define SQLDest &quot;$PROGRAMFILES\Microsoft SQL Server&quot;<br />
!define SQLCatalog &quot;SQLExpress&quot;<br />
<br />
Section /o &quot;SQL Server&quot; secSQLServer<br />
  SectionIn 2<br />
  ;SQL Server needs about 600mbs, but with databases it can get much larger. Asking for 1.5 gigs.<br />
  AddSize 1500000<br />
  SetOutPath &quot;$INSTDIR\Tools&quot;<br />
  SetOverwrite ifnewer<br />
  File &quot;F:\Software\SQL 2005 Express\Sqlexpr_toolkit.exe&quot;<br />
  File &quot;F:\Software\SQL 2005 Express\Sqlexpr_adv.exe&quot;<br />
  File &quot;F:\Software\SQL 2005 Express\Osql.exe&quot;<br />
<br />
  ; search for SQLExpress 2005 instance<br />
  StrCpy $1 &quot;SOFTWARE\Microsoft\Microsoft SQL Server\${SQLCatalog}\MSSQLServer\CurrentVersion&quot;<br />
  StrCpy $2 &quot;CurrentVersion&quot;<br />
<br />
  ClearErrors<br />
  ;MessageBox MB_OK &quot;Checking $1   $2&quot;<br />
  ReadRegStr $0 HKLM &quot;$1&quot; &quot;$2&quot;<br />
  IfErrors SQLServerNotFound SQLServerFound<br />
<br />
SQLServerFound:<br />
 ;Update version Information when new version of SQL is added to the install<br />
 ${VersionCompare} $0 &quot;9.00.3042.00&quot; $3<br />
;    $3=0  Versions are equal<br />
;    $3=1  Version1 is newer<br />
;    $3=2  Version2 is newer<br />
 ${If} $3 == 2<br />
  MessageBox MB_YESNO|MB_ICONEXCLAMATION  &quot;SQLServer is not on the latest version of 9.00.3042.00; detected version $0.$\nWould you like to upgrade?&quot; IDYES true IDNO false<br />
true:<br />
  ExecWait '$INSTDIR\Tools\SQLEXPR_ADV.EXE /qb UPGRADE=SQL_Engine ADDLOCAL=SQL_Engine,SQL_Data_Files,SQL_Replication INSTANCENAME=${SQLCatalog} SECURITYMODE=SQL SAPWD=Password \<br />
  SQLBROWSERAUTOSTART=1 DISABLENETWORKPROTOCOLS=0 SQLACCOUNT=&quot;NT AUTHORITY\SYSTEM&quot; SQLBROWSERACCOUNT=&quot;NT AUTHORITY\SYSTEM&quot; INSTALLSQLDIR=&quot;${SQLDest}&quot; \<br />
  INSTALLSQLSHAREDDIR=&quot;${SQLDest}&quot; INSTALLSQLDATADIR=&quot;${SQLDest}&quot;'<br />
  ExecWait '$INSTDIR\Tools\SQLEXPR_Toolkit.EXE /qb UPGRADE=Client_Components ADDLOCAL=SQL_WarehouseDevWorkbench,Client_Components,Connectivity,SQL_SSMSEE INSTANCENAME=${SQLCatalog} \<br />
  SECURITYMODE=SQL SAPWD=Password SQLBROWSERAUTOSTART=1 DISABLENETWORKPROTOCOLS=0 INSTALLSQLDIR=&quot;${SQLDest}&quot; INSTALLSQLSHAREDDIR=&quot;${SQLDest}&quot; INSTALLSQLDATADIR=&quot;${SQLDest}&quot;'<br />
  Goto next<br />
false:<br />
  Messagebox MB_OK &quot;Cannot continue without updating SQL Server.&quot;<br />
  Abort &quot;can't install&quot;<br />
next:<br />
 ${EndIf}<br />
 Goto Continue<br />
<br />
SQLServerNotFound:<br />
  ExecWait '$INSTDIR\Tools\SQLEXPR_ADV.EXE /qb ADDLOCAL=SQL_Engine,SQL_Data_Files,SQL_Replication INSTANCENAME=SQLExpress SECURITYMODE=SQL SAPWD=Password \<br />
  SQLBROWSERAUTOSTART=1 DISABLENETWORKPROTOCOLS=0 SQLACCOUNT=&quot;NT AUTHORITY\SYSTEM&quot; SQLBROWSERACCOUNT=&quot;NT AUTHORITY\SYSTEM&quot; INSTALLSQLDIR=&quot;${SQLDest}&quot; \<br />
  INSTALLSQLSHAREDDIR=&quot;${SQLDest}&quot; INSTALLSQLDATADIR=&quot;${SQLDest}&quot;'<br />
  ExecWait '$INSTDIR\Tools\SQLEXPR_Toolkit.EXE /qb ADDLOCAL=SQL_WarehouseDevWorkbench,Client_Components,Connectivity,SQL_SSMSEE INSTANCENAME=SQLExpress \<br />
  SECURITYMODE=SQL SAPWD=Password SQLBROWSERAUTOSTART=1 DISABLENETWORKPROTOCOLS=0 INSTALLSQLDIR=&quot;${SQLDest}&quot; INSTALLSQLSHAREDDIR=&quot;${SQLDest}&quot; INSTALLSQLDATADIR=&quot;${SQLDest}&quot;'<br />
Continue:</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>