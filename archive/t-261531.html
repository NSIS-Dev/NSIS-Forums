<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Yet another onmouseover descriptions problem :), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Yet another onmouseover descriptions problem :) NSIS Discussion" />
	
	<title> Yet another onmouseover descriptions problem :) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Yet another onmouseover descriptions problem :)</div>
<hr />
<div class="pda"><a href="t-261531.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=261531">Yet another onmouseover descriptions problem :)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Kyoto</div><div class="date">11th December 2006, 05:22</div></div><div class="posttext">Hey all<br />
<br />
I'm working on an installer using NSIS and MUI<br />
<br />
<br />
<br />
Problem NÂ°1:<br />
<br />
My problem is I can't seem to get to change the color of the descriptions text in the components page<br />
<br />
I've tried searching the forums and searching again: all I've foud doesn't seem to work mith me, even thought it solved the problem for them<br />
<br />
<br />
here are the parts of code in regard of this I use: (the complete script is quite huge so it's best if I only post the parts concerning this problem)<br />
<br />
  !include &quot;MUI.nsh&quot;<br />
  !include &quot;LogicLib.nsh&quot;<br />
<br />
;--------------------------------<br />
;General<br />
<br />
Name &quot;blabla&quot;<br />
OutFile &quot;blabla_Setup.exe&quot;<br />
InstallDir $PROGRAMFILES\blabla<br />
InstallDirRegKey HKLM &quot;Software\blabla power v185479.6.5.8&quot; &quot;Install_Dir&quot;<br />
<br />
;--------------------------------<br />
;Interface Configuration<br />
<br />
  !define MUI_HEADERIMAGE<br />
  !define MUI_HEADERIMAGE_BITMAP &quot;${NSISDIR}\Contrib\Graphics\Header\myreallynice.bmp&quot; ; optional<br />
  !define MUI_ABORTWARNING<br />
  !define MUI_PAGE_CUSTOMFUNCTION_SHOW ChangeFont<br />
<br />
;--------------------------------<br />
;Language Selection Dialog Settings<br />
<br />
  ;Remember the installer language<br />
  !define MUI_LANGDLL_REGISTRY_ROOT &quot;HKCU&quot; <br />
  !define MUI_LANGDLL_REGISTRY_KEY &quot;Software\whocares&quot; <br />
  !define MUI_LANGDLL_REGISTRY_VALUENAME &quot;Installer Language&quot;<br />
<br />
;--------------------------------<br />
;Pages<br />
<br />
  !insertmacro MUI_PAGE_WELCOME<br />
  !insertmacro MUI_PAGE_LICENSE $(MUILicense)<br />
  !insertmacro MUI_PAGE_COMPONENTS<br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_PAGE_FINISH<br />
  <br />
  !insertmacro MUI_PAGE_WELCOME<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_UNPAGE_INSTFILES<br />
  !insertmacro MUI_PAGE_FINISH<br />
<br />
Function ChangeFont<br />
    FindWindow $0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
    GetDlgItem $0 $0 1043<br />
    CreateFont $1 &quot;Arial&quot; 8 400<br />
    SendMessage $0 ${WM_SETFONT} $1 0<br />
    EnableWindow $0 1 <br />
FunctionEnd<br />
<br />
<br />
<br />
and, right after the installation sections:<br />
<br />
Function .onMouseOverSection<br />
    FindWindow $R0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
    GetDlgItem $R0 $R0 1043 ; description item<br />
    ${If} $0 == -1<br />
      CreateFont $1 &quot;Arial&quot; 9 700 ; create the font for the default description<br />
      SetCtlColors $R0 0x5f5f61 0xffffff; set colors<br />
      SendMessage $R0 ${WM_SETFONT} $1 0<br />
      SendMessage $R0 ${WM_SETTEXT} 0 &quot;STR:DON'T PLACE YOUR CURSOR HERE! (or your comp will crash so badly it will drill a hole in the soil)&quot;<br />
    ${Else}<br />
        CreateFont $1 &quot;Arial&quot; 9 400 ; create the font for mouse over descriptions<br />
        SetCtlColors $R0 0x5f5f61 0xffffff; set colors<br />
        SendMessage $R0 ${WM_SETFONT} $1 0<br />
        ; show description for each section<br />
        ${If} $0 == 0<br />
      SendMessage $R0 ${WM_SETTEXT} 0 &quot;STR:This is a worm&quot;<br />
        ${ElseIf} $0 == 1<br />
      SendMessage $R0 ${WM_SETTEXT} 0 &quot;STR:This is a cool virus&quot;<br />
        ${ElseIf} $0 == 2<br />
      SendMessage $R0 ${WM_SETTEXT} 0 &quot;STR:This sux&quot;<br />
        ${ElseIf} $0 == 3<br />
      SendMessage $R0 ${WM_SETTEXT} 0 &quot;STR:This... huh: no clue!&quot;<br />
        ${ElseIf} $0 == 4<br />
      SendMessage $R0 ${WM_SETTEXT} 0 &quot;STR:This will give me your GF's credit card number&quot;<br />
        ${EndIf}<br />
    ${EndIf}<br />
FunctionEnd<br />
<br />
<br />
<br />
<br />
I've tried changing the values for &quot;SetCtlColors $R0 0x5f5f61 0xffffff&quot;, &quot;EnableWindow $0 1&quot; and trying parts of code from these forums so many times I think I might not actually survive...<br />
<br />
the result is always the same: I can choose the background color but nothing seems to affect the font color<br />
<br />
<br />
and that's really no luck at all, because what I'd like is exactly the contrary: <br />
I'd like the background to remain system's button face color (not only mine please: the setting on the end user comp would be quite more classy) and the font color to be a plain simple black (engraving is ok, as long as it's &quot;enabled&quot;, meaning with damn black somewhere in it ^^ )<br />
<br />
<br />
<br />
<br />
Problem NÂ°2:<br />
<br />
of course, I have several sections:<br />
one is required<br />
four others are optionnal (but at least one has to be selected)<br />
<br />
questions:<br />
-is there a way to have these four sections unchecked by default?<br />
-is there a way to make the installer refuse to continue if 2 or more of these 4 options are checked?<br />
-is there a way to make the installer refuse to continue if none of these 4 options is checked?<br />
<br />
<br />
<br />
I do understand I may ask a lot, but I'm really stuck and I've been for quite a while now, so any help would be rather appreciated :) <br />
<br />
Thanks for reading anyway</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">11th December 2006, 05:55</div></div><div class="posttext">Hi Kyoto!<br />
<br />
let's begin with the second part:<br />
<br />
&gt; -is there a way to have these four sections unchecked by <br />
&gt; default?<br />
<br />
Yes of course. Use <br />
Section /o MySection MYSEC000<br />
/o is for optional.<br />
<br />
&gt; -is there a way to make the installer refuse to continue <br />
&gt; if 2 or more of these 4 options are checked?<br />
&gt; -is there a way to make the installer refuse to continue <br />
&gt; if none of these 4 options is checked?<br />
<br />
It is possible.<br />
<br />
There are other possibilites as well. But I think that might be a good one.<br />
<br />
!include logiclib.nsh<br />
:<br />
:<br />
Function Validate<br />
StrCpy $R1 0<br />
<br />
${If} ${SectionIsSelected} ${Sec000}<br />
  IntOp $R1 $R1 + 1<br />
${EndIf}<br />
${If} ${SectionIsSelected} ${Sec00n}<br />
  IntOp $R1 $R1 + 1<br />
${EndIf}<br />
:<br />
:<br />
${If} $R1 &lt;&gt; 1<br />
MessageBox MB_OK &quot;Please make sure that you only select 1 of...&quot;<br />
Abort<br />
${EndIf}<br />
:<br />
:<br />
; Other validate code...<br />
:<br />
FunctionEnd<br />
<br />
Cheers<br />
<br />
Bruno</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">11th December 2006, 06:33</div></div><div class="posttext">Hi Kyoto!<br />
<br />
You have to move your definition of the custom function right before the page definition. Otherwise the function is executed by the welcome dialog, which has no effect.<br />
<br />
  !insertmacro MUI_PAGE_WELCOME<br />
  !insertmacro MUI_PAGE_LICENSE $(MUILicense)<br />
  !define MUI_PAGE_CUSTOMFUNCTION_SHOW ChangeFont<br />
  !insertmacro MUI_PAGE_COMPONENTS<br />
<br />
Cheers<br />
<br />
Bruno</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kyoto</div><div class="date">11th December 2006, 08:45</div></div><div class="posttext">Thank you, bholliger (aka Bruno ^^), for helping me out! :)<br />
<br />
<br />
all this was usefull:<br />
-no more font color problems!  (dang! am so happy to see them gone!)<br />
-and it looks like I'm definately a few steps forward, thanks to you!<br />
(I really did spend quite a few hours on this, and another &quot;quite a few&quot; searching these forums and all google has ever read about the word nsis :D )<br />
<br />
<br />
<br />
I'm close, but there's still a few issues: <br />
<br />
-&gt; the compiler does not accept &quot;Function Validate&quot; you told me about, because it's &quot;not referenced&quot; (so he says)<br />
<br />
I don't know what it means... I guess I have to declare something somewhere (or I've put some line after and not before some other line), but I obviously won't get it without your help :D <br />
<br />
<br />
-&gt; I want the installer to launch little tools on completion:<br />
1 a .bat file wich create a windows task for my exe<br />
2 a .chm that explains why the hell I'm wasting my youth on all this to the user<br />
3 a .hta witch basically gives easy access to some files that the user has to manually edit (oh well, after all, let's make him discover how cute notepad can be :D )<br />
<br />
to do this, here's what I've put in my script:  (come on: don't laugh! ^^ )<br />
Function .onInstSuccess<br />
   Exec &quot;$INSTDIR\Task.bat&quot;<br />
   Exec &quot;$INSTDIR\aide.chm&quot;<br />
   Exec &quot;$INSTDIR\Configuration.hta&quot;<br />
FunctionEnd<br />
<br />
for some reason, only the 1rst file is launched...<br />
<br />
I've tried making 3 separate &quot;Function .onInstSuccess&quot; but I soon realized that's not the way it should be ^^<br />
<br />
maybe a timout problem? or the syntax just isn't good, I don't know<br />
<br />
<br />
Any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">11th December 2006, 09:00</div></div><div class="posttext">-&gt; the compiler does not accept &quot;Function Validate&quot; you told me about, because it's &quot;not referenced&quot; (so he says)!define MUI_PAGE_CUSTOMFUNCTION_LEAVE validation<br />
!insertmacro MUI_PAGE_COMPONENTS <br />
-&gt; I want the installer to launch little tools on completion:Function .onInstSuccess<br />
   Exec &quot;$INSTDIR\Task.bat&quot;<br />
   ExecShell open &quot;$INSTDIR\aide.chm&quot;<br />
   ExecShell open &quot;$INSTDIR\Configuration.hta&quot;<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kyoto</div><div class="date">11th December 2006, 09:13</div></div><div class="posttext">Thanks Red Wine<br />
<br />
I'm pretty sure the execShell open stuff will work perfectly but I didn't get that far:<br />
<br />
&quot;Error: resolving install function &quot;validation&quot; in function &quot;mui.ComponentsLeave_36.5.12&quot;<br />
Note: uninstall functions must begin with &quot;un.&quot;, and install functions must not&quot;<br />
<br />
I can't tell you more: I've no idea what's going on<br />
<br />
<br />
edit:<br />
since it might be usefull to see the whole script, I've uploaded it here:<br />
MY.NSI (http://w11.easy-share.com/709909.html)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">11th December 2006, 10:52</div></div><div class="posttext">Hi Kyoto!<br />
<br />
You're welcome!<br />
<br />
MUI_PAGE_CUSTOMFUNCTION lets you set a function that is executed when the components page is left. The name of the function has to correspond with the name you define.<br />
<br />
So you have to write<br />
<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_LEAVE validation<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
:<br />
:<br />
<br />
Function validation<br />
:<br />
:<br />
FunctionEnd<br />
<br />
<br />
You'll find more information in the Modern UI Readme.<br />
<br />
Cheers<br />
<br />
Bruno</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">11th December 2006, 12:34</div></div><div class="posttext">Your script is perfect, you had just to change the validation function name with the real name of your function. <br />
Validation &gt;&gt; Validate</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kyoto</div><div class="date">12th December 2006, 09:08</div></div><div class="posttext">Great: I finally understand what was going wrong!<br />
<br />
Thanks a lot guys<br />
<br />
<br />
<br />
oh yes: by the way, Nsis &quot;it really kicks a lama's ass!&quot; :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">13th December 2006, 00:48</div></div><div class="posttext">Originally posted by Kyoto <br />
oh yes: by the way, Nsis &quot;it really kicks a lama's ass!<br />
You got it:-)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>