<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with Destination Folder's wright permission, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with Destination Folder's wright permission NSIS Discussion" />
	
	<title> Problem with Destination Folder's wright permission [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with Destination Folder's wright permission</div>
<hr />
<div class="pda"><a href="t-235895.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=235895">Problem with Destination Folder's wright permission</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Sujay</div><div class="date">19th January 2006, 11:47</div></div><div class="posttext">Hi, <br />
   i hv come accross one problem. i made a setup.exe for one application for windows. now i want to check that the destination folder user want to install is having the wright permissions or not. because at one machine there might not hving permission to wright in program files. I want to check this while installing the application and want to give one message to user to choose another folder.<br />
   thanks in advance.<br />
   -- Sujay</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th January 2006, 19:02</div></div><div class="posttext">You can use a method similar to that in the following thread:<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=204991&amp;highlight=write+permission<br />
<br />
Though I'd use GetTempFileName so it won't overwrite any files.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sujay</div><div class="date">20th January 2006, 05:18</div></div><div class="posttext">thanks .<br />
  but can u send me any exmple srcipts to use this. i tried a lot but didnt understand how to do this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">20th January 2006, 07:14</div></div><div class="posttext">!define MUI_PAGE_CUSTOMFUNCTION_LEAVE OnDirLeave<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
Function OnDirLeave<br />
  ClearErrors<br />
  SetOutPath &quot;$INSTDIR&quot; ; what about IfError creating $INSTDIR?<br />
  GetTempFileName $1 &quot;$INSTDIR&quot; ; creates tmp file (or fails)<br />
  FileOpen $0 &quot;$1&quot; &quot;w&quot; ; error to open?<br />
  FileWriteByte $0 &quot;0&quot;<br />
  IfErrors notPossible possible<br />
  <br />
notPossible:<br />
  RMDir &quot;$INSTDIR&quot; ; removes folder if empty<br />
  MessageBox MB_OK &quot;Not able to write into this directory!&quot;<br />
  Abort<br />
possible:<br />
  FileClose $0<br />
  Delete &quot;$1&quot;<br />
FunctionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>