<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Functions for saving/loading settings to/from registry, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Functions for saving/loading settings to/from registry NSIS Discussion" />
	
	<title> Functions for saving/loading settings to/from registry [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Functions for saving/loading settings to/from registry</div>
<hr />
<div class="pda"><a href="t-222310.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=222310">Functions for saving/loading settings to/from registry</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Rolando</div><div class="date">24th July 2005, 01:22</div></div><div class="posttext">Hi, I'm working on an installer with 5 pages and 14 checkboxes per page (using MUI custompages) and I want the installer to be able to remember the selected checkboxes by storing them in the registry. I was hoping someone could help me create 2 functions: one for saving settings to the registry and the other for loading them from the registry. This is probably easy to do, but I don't know my way around loops, which I think is the best way to do this since the pages are named options1.ini --&gt; options5.ini and there are 14 fields in each page. I'd appreciate any help offered. Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th July 2005, 01:24</div></div><div class="posttext">Use ReadRegStr and WriteRegStr for the registry parts, then ReadINIStr and WriteINIStr for the INI files.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">24th July 2005, 07:50</div></div><div class="posttext">http://nsis.sourceforge.net/wiki/RememberComponents</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Rolando</div><div class="date">24th July 2005, 11:46</div></div><div class="posttext">Ok thanks, well I'm almost done. I finished the SaveSettings function however, the LoadSettings function isn't working. Is there something wrong with the following:<br />
<br />
ReadRegStr $R0 HKCU &quot;Software\LTP\${CURRENT_VER}&quot; &quot;$R2-$R3&quot;<br />
<br />
because $R0 is returning a null result while I check the registry and it should have a numeric value. At this point, I checked and am sure that $R2 and $R3 have their correct values.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">25th July 2005, 06:00</div></div><div class="posttext">ReadRegStr can read only string values. Use ReadRegDWORD if you are reading integers, which is probable to happen in this case. If this is not enough, say which type has your value name.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">25th July 2005, 06:03</div></div><div class="posttext">I'd go into RegEdit and see if you can browse to HCKU\software\LTP\${CURRENT_VER} and read what $R2-$R3 is. <br />
<br />
If that doesn't work, you can insert a message box just before the command to see what the string &quot;Software\LTP\${CURRENT_VER}&quot; and &quot;$R2-$R3&quot; actually are at the time the command is being called.<br />
<br />
EDIT:  Deguix also has a good point!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>