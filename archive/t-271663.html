<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS 2.27 - NSIS Menu fails to link, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS 2.27 - NSIS Menu fails to link NSIS Discussion" />
	
	<title> NSIS 2.27 - NSIS Menu fails to link [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS 2.27 - NSIS Menu fails to link</div>
<hr />
<div class="pda"><a href="t-271663.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=271663">NSIS 2.27 - NSIS Menu fails to link</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">23rd May 2007, 19:44</div></div><div class="posttext">I have followed all setup instructions in the NSIS Docs Appendix.  I have wxWidgets 2.8.3; WXWIN is correctly set; Python 2.5.1; Scons 0.96.93; using a Visual Studio .NET 2003 terminal.<br />
<br />
The compilation is fine, but I cannot get it to link:<br />
<br />
cl /nologo /GS- /O1 /W3 /MD /EHsc /TP /D_CRT_SECURE_NO_WARNINGS /D_CRT_NONSTDC_N<br />
O_WARNINGS /IC:\wxWidgets-2.8.3\include /IC:\wxWidgets-2.8.3\lib\vc_libnsis\msw<br />
/c &quot;Contrib\NSIS Menu\nsismenu\nsismenu.cpp&quot; &quot;/Fobuild\release\NSIS Menu\nsismen<br />
u\nsismenu.obj&quot;<br />
nsismenu.cpp<br />
cl /nologo /GS- /O1 /W3 /MD /EHsc /TP /D_CRT_SECURE_NO_WARNINGS /D_CRT_NONSTDC_N<br />
O_WARNINGS /IC:\wxWidgets-2.8.3\include /IC:\wxWidgets-2.8.3\lib\vc_libnsis\msw<br />
/c &quot;Contrib\NSIS Menu\nsismenu\nslinks.cpp&quot; &quot;/Fobuild\release\NSIS Menu\nsismenu<br />
\nslinks.obj&quot;<br />
nslinks.cpp<br />
rc /D_CRT_SECURE_NO_WARNINGS /D_CRT_NONSTDC_NO_WARNINGS /IC:\wxWidgets-2.8.3\inc<br />
lude /IC:\wxWidgets-2.8.3\lib\vc_libnsis\msw &quot;/fobuild\release\NSIS Menu\nsismen<br />
u-rc.res&quot; &quot;Contrib\NSIS Menu\nsismenu\nsismenu.rc&quot;<br />
link /nologo /opt:nowin98 /map &quot;/OUT:build\release\NSIS Menu\NSIS.exe&quot; /LIBPATH:<br />
C:\wxWidgets-2.8.3\lib\vc_libnsis advapi32.lib comctl32.lib gdi32.lib shell32.li<br />
b user32.lib wxbase28.lib wxmsw28_core.lib wxmsw28_html.lib &quot;build\release\NSIS<br />
Menu\nsismenu\nsismenu.obj&quot; &quot;build\release\NSIS Menu\nsismenu\nslinks.obj&quot; &quot;buil<br />
d\release\NSIS Menu\nsismenu-rc.res&quot;<br />
wxbase28.lib(baselib_filename.obj) : error LNK2019: unresolved external symbol _<br />
_imp__CoCreateInstance@20 referenced in function &quot;public: bool __thiscall wxFile<br />
Name::GetShortcutTarget(class wxString const &amp;,class wxString &amp;,class wxString *<br />
)&quot; (?GetShortcutTarget@wxFileName@@QAE_NABVwxString@@AAV2@PAV2@@Z)<br />
wxmsw28_core.lib(corelib_app.obj) : error LNK2019: unresolved external symbol __<br />
imp__OleUninitialize@0 referenced in function &quot;void __cdecl wxOleUninitialize(vo<br />
id)&quot; (?wxOleUninitialize@@YAXXZ)<br />
wxmsw28_core.lib(corelib_clipbrd.obj) : error LNK2001: unresolved external symbo<br />
l __imp__OleUninitialize@0<br />
wxmsw28_core.lib(corelib_app.obj) : error LNK2019: unresolved external symbol __<br />
imp__OleInitialize@4 referenced in function &quot;bool __cdecl wxOleInitialize(void)&quot;<br />
 (?wxOleInitialize@@YA_NXZ)<br />
<br />
There are a total of 72 linker errors link this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd May 2007, 20:07</div></div><div class="posttext">Add ole32 to libs in Contrib\NSIS Menu\SConscript and let me know if it works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd May 2007, 20:09</div></div><div class="posttext">Actually, forget about that. You should rebuild wxWidgets with wxbuild.bat. Make sure you delete any intermediate files in the wxWidgets directory before you do that.<br />
<br />
Nothing from OLE should be used, as wxUSE_OLE is defined as 0 in setup.h.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">23rd May 2007, 20:53</div></div><div class="posttext">Sorry, I forgot to mention that I had already done that.  I first tried with wxWidgets 2.8.3 and when that failed I tried with 2.8.0.  When that also failed, I reverted back to 2.8.3.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd May 2007, 20:59</div></div><div class="posttext">Then try deleting everything, installing wxWidgets 2.8.4, running wxbuild.bat and compiling again. Somewhere along the way, a wrong setup.h has gotten into your previous build.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">23rd May 2007, 21:09</div></div><div class="posttext">No change.  Any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">23rd May 2007, 21:12</div></div><div class="posttext">Actually, let me remove the NSIS directory and re-extract and give it one more try.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">23rd May 2007, 21:20</div></div><div class="posttext">Nope, it's still not working.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd May 2007, 22:47</div></div><div class="posttext">It worked just fine for me yesterday with wxWidgets 2.8.4. OLE is definitly should not be used due to wxUSE_OLE and that specific code part that the compiler complains about is surrounded with #ifdef wxUSE_OLE. I don't know what's wrong with your build. There must be a stray setup.h laying around somewhere.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">23rd May 2007, 22:49</div></div><div class="posttext">I'm currently re-installing my development applications and will try again...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd May 2007, 22:51</div></div><div class="posttext">Manually building wxWidgets while making sure it's using the correct setup.h will do. There's no need to reinstall everything.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">23rd May 2007, 22:54</div></div><div class="posttext">So, which setup.h is the correct one?  And where should it go?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">23rd May 2007, 23:19</div></div><div class="posttext">I have been able to get it to build finally.  When I ran the wxbuild.bat from Contrib\NSIS Menu\wx instead of from the root of the extracted NSIS directory, all worked fine.<br />
<br />
Thanks for all the help kichik!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th May 2007, 00:32</div></div><div class="posttext">Thanks, I've updated wxbuild.bat to check for that too.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>