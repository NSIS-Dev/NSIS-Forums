<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" SQL Server Configuration, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  SQL Server Configuration NSIS Discussion" />
	
	<title> SQL Server Configuration [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  SQL Server Configuration</div>
<hr />
<div class="pda"><a href="t-231878.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=231878">SQL Server Configuration</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">williamsellick</div><div class="date">25th November 2005, 10:01</div></div><div class="posttext">Hi,<br />
<br />
I have been developing an installer with NSIS over the past month. I am currently working on a page to test if SQL Server is installed. I have successfully tested it and it skips the page if it isn't installed but my problem is when it is installed I want to display a list of servers which are running on the application. I would like it if I could display them in a listbox and allow the user to click on one of them.<br />
<br />
I am currently using an 'osql' command shown below and am trying to get to write the contents to the stack then read it off and print it to the listbox. Currently I am only getting 1 line returned from the command which happens to be the first line of the command prompt.<br />
<br />
ReadRegStr $R1 HKLM &quot;SOFTWARE\Microsoft\Microsoft SQLServer\80\Tools\ClientSetup&quot; &quot;SQLPath&quot;<br />
<br />
nsExec::ExecToStack cmd /C &quot;$R1\Binn\osql.exe&quot; -L <br />
<br />
Could anyone direct me to where I am going wrong or a better way of achieving what I am trying to do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">25th November 2005, 10:40</div></div><div class="posttext">you could try to redirect the output to a file and parse that instead: <br />
nsExec::ExecToStack cmd /C &quot;$R1\Binn\osql.exe&quot; -L &gt; $temp\servicelist.txt (or someting like that)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">25th November 2005, 10:41</div></div><div class="posttext">NSIS 2.11 nsExec Readme:<br />
To ensure that command are executed without problems on all windows versions,<br />
is recommended to use the following syntax:<br />
<br />
   nsExec::ExecToStack [OPTIONS] '&quot;PATH&quot; param1 param2 paramN'<br />
<br />
This way the application path may contain non 8.3 paths (with spaces)<br />
And you probably can scip cmd /C or use code below to keep Win vers compatibility<br />
ReadEnvStr $0 COMSPEC<br />
nsExec::ExecToStack '$0 /C &quot;$R1\Binn\osql.exe&quot; -L'<br />
Do not forget to test this on Win2003 server.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">williamsellick</div><div class="date">25th November 2005, 11:02</div></div><div class="posttext">Thanks for the quick reply. I have changed the formatting of the line so that now (once it creates the line from the different sources) it tries to run<br />
<br />
c:\windows\system32\cmd.exe /C &quot;c:\program files\Microsoft SQL Server\80\Tools\Binn\osql.exe&quot; -L<br />
<br />
This successfully works on the command prompt but when I check the stack it now doesn't contain anything.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">williamsellick</div><div class="date">25th November 2005, 11:04</div></div><div class="posttext">Anders,<br />
<br />
Thanks for the suggestion about the cmd --&gt; file --&gt; form. I had considered this but hoped I wouldn't have to use it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">25th November 2005, 11:09</div></div><div class="posttext">BTW ExecDos (http://nsis.sourceforge.net/ExecDos) has parameter for stdout file<br />
ExecDos::exec '&quot;$R1\Binn\osql.exe&quot; -L' '' '$EXEDIR\osql.log'</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>