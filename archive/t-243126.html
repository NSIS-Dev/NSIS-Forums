<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" InstallLib, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  InstallLib NSIS Discussion" />
	
	<title> InstallLib [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  InstallLib</div>
<hr />
<div class="pda"><a href="t-243126.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=243126">InstallLib</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">10th April 2006, 20:21</div></div><div class="posttext">I've been having a problem with InstallLib where it will register a dll, but not extract it.  Is there a setting similar to setOverwrite for InstallLib?  For one of my installers that uses InstallLib, it works fine in QA but when run on Staging or Prod, doesn't extract.  Any help?  Here's an example of the code:<br />
<br />
CreateDirectory $INSTDIR\myApp<br />
IfFileExists &quot;$INSTDIR\myApp\myDll.dll&quot; 0 +2<br />
  StrCpy $ALREADY_INSTALLED 1<br />
<br />
!insertmacro InstallLib REGDLL $ALREADY_INSTALLED NOREBOOT_NOTPROTECTED D:\myAppBuildDir\dll\myApp\myDll.dll $INSTDIR\myApp\myDll.dll %TEMP%<br />
<br />
<br />
Thanks,<br />
Eric</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">11th April 2006, 11:08</div></div><div class="posttext">did you try to delete the dll at runtime and check if you can?<br />
clearerrors<br />
IfFileExists &quot;$INSTDIR\myApp\myDll.dll&quot; 0 _new_installation<br />
unregdll &quot;$INSTDIR\myApp\myDll.dll&quot;<br />
iferrors 0 +4<br />
detailprint 'something went wrong with unregdll'<br />
detailprint 'try to unreg manualy e.g. regsvr32 /U and check if this works'<br />
clearerrors<br />
delete &quot;$INSTDIR\myApp\myDll.dll&quot;<br />
iferrors 0 _new_installation<br />
detailprint 'something wrong with delete try to replace on reboot'<br />
 StrCpy $ALREADY_INSTALLED 1<br />
# replace on reboot and check if this works<br />
!insertmacro InstallLib REGDLL $ALREADY_INSTALLED<br />
REBOOT_NOTPROTECTED D:\myAppBuildDir\dll\myApp\myDll.dll $INSTDIR\myApp\myDll.dll<br />
_new_installation:<br />
!insertmacro InstallLib REGDLL $ALREADY_INSTALLED <br />
NOREBOOT_NOTPROTECTED D:\myAppBuildDir\dll\myApp\myDll.dll $INSTDIR\myApp\myDll.dll</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">12th April 2006, 17:33</div></div><div class="posttext">Nope, but can try this.  Do others of you do this?  I thought that sort of gig was all handled by InstallLib...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhaelochon</div><div class="date">12th April 2006, 18:11</div></div><div class="posttext">I ran into the same issue, stonkers. I ended up having to insert an UnInstallLib before my InstallLib.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">12th April 2006, 20:32</div></div><div class="posttext">Cool thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th April 2006, 11:14</div></div><div class="posttext">What do you mean by registered but not extracted? Is it registering the old version? Try running it with a log (http://nsis.sourceforge.net/Special_Builds) and see if install.log shows anything of interest.<br />
<br />
There's a problem with the InstallLib call. The last parameter should be $TEMP, not %TEMP%. It may be related.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>