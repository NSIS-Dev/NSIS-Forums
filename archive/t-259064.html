<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How can I uninstall and install again with multi language, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How can I uninstall and install again with multi language NSIS Discussion" />
	
	<title> How can I uninstall and install again with multi language [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How can I uninstall and install again with multi language</div>
<hr />
<div class="pda"><a href="t-259064.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=259064">How can I uninstall and install again with multi language</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">7th November 2006, 09:31</div></div><div class="posttext">After finishing install with multi language,I want to check my software is installed or not on computer if user install is again.If is installed, I will uninstall and run new version. I search and see on Wiki (http://nsis.sourceforge.net/Auto-uninstall_old_before_installing_new)  . In my installer, I work with many language. If I put it on Init, I can not display many languages which I allow user choose. I think uninstall is finished, id of every language is stored and run my application with the same language which I installed in old version. I put function on this link above on function to call them. But I can not know where I can put it. <br />
<br />
Function Remove<br />
  ReadRegStr $R0 HKLM \<br />
  &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}&quot; \<br />
  &quot;UninstallString&quot;<br />
  StrCmp $R0 &quot;&quot; done<br />
       MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />
             &quot;${PRODUCT_NAME} is already installed. $\n$\nClick `OK` to remove the \<br />
              previous version or `Cancel` to cancel this upgrade.&quot; \<br />
       IDOK uninst<br />
       Abort<br />
;Run the uninstaller<br />
uninst:<br />
  ClearErrors<br />
  Exec '$R0' ;Do not copy the uninstaller to a temp file<br />
  IfErrors no_remove_uninstaller<br />
  no_remove_uninstaller:<br />
<br />
  done:<br />
FunctionEnd<br />
<br />
Please help me!<br />
My word is very bad, If you do not clear, please tell me!!!<br />
Thank a million!<br />
:p</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">8th November 2006, 01:18</div></div><div class="posttext">If someone used to see this problem, please help me!!!<br />
Your help is very useful for me!<br />
Thank a lot!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">8th November 2006, 06:25</div></div><div class="posttext">I want to make clearly about my idea.<br />
After I install my software, user continue to install my application to update. I must ask them to uninstall old version and install new one. <br />
My problem is here:<br />
When user uninstall my program, install program will execute. Because my program use with multi languages. The process install to continue but it does not allow for user to choose language which they want to install.<br />
I try my best to solve but I can not. <br />
I need your help too much if you can show me some solutions.<br />
Thank a lot,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">8th November 2006, 07:27</div></div><div class="posttext">Actually, I do not know exactly where I can put functionCall remove.If I put it here, I can not display multi language. However, I do not put it there, I can check old version.<br />
<br />
Function .onInit<br />
  Call Remove <br />
  !insertmacro MUI_LANGDLL_DISPLAY<br />
FunctionEnd<br />
<br />
Function Remove<br />
  ReadRegStr $R0 HKLM \<br />
  &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}&quot; \<br />
  &quot;UninstallString&quot;<br />
  StrCmp $R0 &quot;&quot; done<br />
       MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />
             &quot;${PRODUCT_NAME} is already installed. $\n$\nClick `OK` to remove the \<br />
              previous version or `Cancel` to cancel this upgrade.&quot; \<br />
       IDOK uninst<br />
       Abort<br />
;Run the uninstaller<br />
uninst:<br />
  ClearErrors<br />
  Exec '$R0' ;Do not copy the uninstaller to a temp file<br />
  IfErrors no_remove_uninstaller<br />
    ;You can either use Delete /REBOOTOK in the uninstaller or add some code<br />
    ;here to remove the uninstaller. Use a registry key to check<br />
    ;whether the user has chosen to uninstall. If you are using an uninstaller<br />
    ;components page, make sure all sections are uninstalled.<br />
  no_remove_uninstaller:<br />
<br />
  done:<br />
FunctionEnd<br />
[/SIZE]<br />
<br />
Please help me!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">8th November 2006, 08:50</div></div><div class="posttext">Hi sunlight112!<br />
<br />
I'm really sorry, I've been reading your post twice, but I'm sure, I haven't understand.<br />
<br />
I suggest moving the LangDll-Dialog in front. Why is this a problem for you?<br />
<br />
<br />
Function .onInit<br />
  !insertmacro MUI_LANGDLL_DISPLAY<br />
  Call Remove <br />
FunctionEnd<br />
<br />
<br />
First the installer ask for the language and checks for an existing installation.<br />
<br />
Cheers<br />
<br />
Bruno</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">8th November 2006, 10:59</div></div><div class="posttext">Thank bholliger for your reply,<br />
I am so sorry about it.<br />
My problem is : If old program is installed. I want to uninstall old version before I install new version. <br />
After I finish uninstalling old version, my new program will execute. But my application is installed with multilanguage. If means it allows user to choose many language to install.<br />
At that time, after uninstall successful, the page welcome is displayed with the same language which I choose to install in old version. <br />
I only want to know how can I allow user to choose language to install after uninstalling old program.<br />
My code here:<br />
<br />
Function .onInit<br />
  Call Remove <br />
  !insertmacro MUI_LANGDLL_DISPLAY<br />
FunctionEnd<br />
<br />
Function Remove<br />
  ReadRegStr $R0 HKLM \<br />
  &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}&quot; \<br />
  &quot;UninstallString&quot;<br />
  StrCmp $R0 &quot;&quot; done<br />
       MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />
             &quot;${PRODUCT_NAME} is already installed. $\n$\nClick `OK` to remove the \<br />
              previous version or `Cancel` to cancel this upgrade.&quot; \<br />
       IDOK uninst<br />
       Abort<br />
;Run the uninstaller<br />
uninst:<br />
  ClearErrors<br />
  Exec '$R0' ;Do not copy the uninstaller to a temp file<br />
  IfErrors no_remove_uninstaller<br />
    ;You can either use Delete /REBOOTOK in the uninstaller or add some code<br />
    ;here to remove the uninstaller. Use a registry key to check<br />
    ;whether the user has chosen to uninstall. If you are using an uninstaller<br />
    ;components page, make sure all sections are uninstalled.<br />
  no_remove_uninstaller:<br />
<br />
  done:<br />
FunctionEnd<br />
<br />
I also try put my code above and under !insertmacro MUI_LANGDLL_DISPLAYto display many languages for user choose to install.<br />
I try all my word to explain, if you do not know, I will try it again<br />
Thank you for your help,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">8th November 2006, 15:36</div></div><div class="posttext">Check your uninstaller. If there is no code to delete registry language settings -&gt; language selection dialog will not show.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">8th November 2006, 20:21</div></div><div class="posttext">Hi sunlight112!<br />
<br />
Ah, I guess I'm aware of the problem now. This might help you: Define MUI_LANGDLL_ALWAYSSHOW in your script.<br />
<br />
<br />
  !define MUI_LANGDLL_ALWAYSSHOW<br />
<br />
<br />
If you set this constant, the dialog will always show, no matter what setting has been saved before.<br />
<br />
Furter information:<br />
http://nsis.sourceforge.net/Docs/Modern%20UI/Readme.html<br />
Search for MUI_LANGDLL_ALWAYSSHOW<br />
<br />
Cheers<br />
<br />
Bruno</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">9th November 2006, 01:27</div></div><div class="posttext">Thank glory_man and bholliger very much,<br />
Now I can do it well. However, I have one question on this field. <br />
When I run my application, (in case my application is installed already) MessageBox will display to ask user to uninstall old version.<br />
After user click OK(it means uninstall it). A screen allow user choose language to install new version is appeared and follow it is Uninstall old version is displayed.<br />
I am worry if user click CANCEL on Uninstall program. The screen chooses language still allow user to install new version(it does not hide when uninstall program is click CANCEL). At that time, user  do not need to unintall old version and can continue to install new version although I check it before installing new version.<br />
How can I check if user click CANCEL on Uninstall screen? I do not allow them to install new version.<br />
I am sorry about my word.If you do not know, please tell me!<br />
Thank a lot,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">9th November 2006, 01:34</div></div><div class="posttext">Hi sunlight112!<br />
<br />
I'm not sure if you can use /S with the uninstaller. Can you try this?<br />
<br />
<br />
ExecWait '$R0 /S _?=$INSTDIR'<br />
<br />
<br />
Cheers<br />
<br />
Bruno</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">9th November 2006, 03:15</div></div><div class="posttext">Thank bholliger a lot,<br />
<br />
Bholliger posted:<br />
ExecWait '$R0 /S _?=$INSTDIR'<br />
<br />
Can you explain your code? I do not understand why we should use this.<br />
I also try with your code. Your code work well with my idea but it just deletes file &quot; *test.exe, website.link and registry&quot;and  not delete my &quot;uninst.exe&quot;.And, it also does not display screen uninstall(I know it because uninst.exe is not called)<br />
Can you tell me why &quot;uninst.exe&quot; is not deleted? <br />
I also try with this code:<br />
  ExecWait '$R0 _?=$INSTDIR'<br />
The result is the same your code.<br />
Thank you very much for your help,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">9th November 2006, 06:08</div></div><div class="posttext">Hi sunlight112!<br />
<br />
The uninstaller is called and executed with ExecWait, this causes the installer to wait until the uninstall is finished. It is called with the uninstall directory, so there's no need to ask for a directory and the uninstall process is performed silently in the background. Because of the fact the installer is overwritten anyway during your upcoming install, there's no need to remove the uninst.exe (Have a look at the wiki [1], the behaviour is explained there).<br />
<br />
In the end you have what you requested: The user is not able to cancel the uninstall process. Voila!<br />
<br />
Cheers<br />
<br />
Bruno<br />
<br />
[1] http://nsis.sourceforge.net/Auto-uninstall_old_before_installing_new</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">9th November 2006, 07:51</div></div><div class="posttext">Thank bholliger a lot, <br />
Now I can understand it clearly :)<br />
Thank you so much,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">9th November 2006, 07:56</div></div><div class="posttext">You're welcome!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">peeratep</div><div class="date">12th March 2007, 08:18</div></div><div class="posttext">i want continue install after uninstall successfuly!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>