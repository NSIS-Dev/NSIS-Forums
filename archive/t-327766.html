<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstall window running under Welcome screen.., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstall window running under Welcome screen.. NSIS Discussion" />
	
	<title> Uninstall window running under Welcome screen.. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstall window running under Welcome screen..</div>
<hr />
<div class="pda"><a href="t-327766.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=327766">Uninstall window running under Welcome screen..</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">joe131</div><div class="date">23rd February 2011, 21:40</div></div><div class="posttext">Hi All,<br />
<br />
Here's the problem.  As soon as my Installer runs it looks to see if there<br />
is an existing version, and if it finds it, it runs the Uninstaller to remove the<br />
previous version first.<br />
<br />
The problem is that after the Uninstall window runs for a second,<br />
the Welcome screen opens directly above it, and the user doesn't see the Uninstall<br />
window running, so they can easily hit &quot;Next&quot;, on the Welcome screen,<br />
and the Uninstall will be hosed.<br />
<br />
I'm currently using the Ultra Modern UI, but I've seen it happen with the MUI2.nsh<br />
also.<br />
<br />
What I'm currently doing is pretty kludgey.  I let the Uninstall run for a second<br />
and a half, then do a &quot;BringToFront&quot;, and that brings it back to the top,<br />
but it doesn't always work.<br />
<br />
Ideally I'd set a flag variable, in the Uninstall, saying that it's running<br />
and before the Welcome screen opens, it would check the flag, and if it was<br />
set, it would &quot;wait&quot; till the Uninstaller was finished before it opens.<br />
<br />
But it looks like you can't do any pre-opening stuff with the Welcome screen.<br />
<br />
Maybe, if I could create a Custom screen that looks exactly like the Welcome screen,<br />
then I could control it better.<br />
<br />
If anyone has any suggestions on how I can keep the Uninstall window from<br />
being covered over by the Welcome screen, I'd appreciate it!<br />
<br />
Oh, my Installer only runs on Windows, I'm not using it for any other platform.<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">23rd February 2011, 22:04</div></div><div class="posttext">You are probably executing the uninstaller incorrectly, are you using the _?= parameter and ExecWait?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">joe131</div><div class="date">24th February 2011, 01:02</div></div><div class="posttext">Thanks for your reply.<br />
<br />
I was using:<br />
<br />
ExecWait &quot;${INSTALL_DIRECTORY}\Webserver\bin\${UNINSTALLER}&quot;<br />
<br />
And tried changing it to:<br />
<br />
	ClearErrors<br />
	ExecWait &quot;${INSTALL_DIRECTORY}\Webserver\bin\${UNINSTALLER}&quot; $0<br />
<br />
And not doing anything with the return code '$0'<br />
<br />
I ran the Installer several times, and it seems to work, but the Welcome<br />
screen is under the Uninstall window every time.  It won't take much<br />
for it to &quot;decide&quot; to come to the front.<br />
<br />
I looked around and only found  _?=  used once in Examples\makensis.nsi<br />
and couldn't find any docs on how it's used.<br />
<br />
I did find out that I CAN add a MUI_PAGE_CUSTOMFUNCTION_PRE<br />
before my   !insertmacro MUI_PAGE_WELCOME<br />
<br />
And I wrote this Function:<br />
<br />
<br />
Function WelcomePre<br />
	<br />
Loop_Start:<br />
<br />
	StrCmp $UninstallRunning &quot;TRUE&quot; Loop_Start Loop_End <br />
	<br />
Loop_End:<br />
	<br />
FunctionEnd<br />
 <br />
<br />
And it looks like it works pretty well.<br />
<br />
How do I use _?=   ?<br />
<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">24th February 2011, 02:16</div></div><div class="posttext">You could RTFM (http://nsis.sourceforge.net/Docs/Chapter3.html#3.2.2).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">joe131</div><div class="date">24th February 2011, 14:47</div></div><div class="posttext">There isn't ONE WORD in the FM about &quot;_?=&quot;!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">24th February 2011, 14:49</div></div><div class="posttext">3.2.2 Uninstaller Specific Options<br />
<br />
_?= sets $INSTDIR. It also stops the uninstaller from copying itself to the temporary directory and running from there. It can be used along with ExecWait to wait for the uninstaller to finish. It must be the last parameter used in the command line and must not contain any quotes, even if the path contains spaces....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">joe131</div><div class="date">24th February 2011, 15:09</div></div><div class="posttext">Sorry, I found it in the Uninstaller section.  It wasn't in anything doing with<br />
ExecWait<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th February 2011, 15:59</div></div><div class="posttext">That is because it has nothing to do (directly) with ExecWait. _?= is a specific option for the NSIS uninstall executable.<br />
<br />
http://nsis.sourceforge.net/When_I_use_ExecWait_uninstaller.exe_it_doesn%27t_wait_for_the_uninstaller<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>