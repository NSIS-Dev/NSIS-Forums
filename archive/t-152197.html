<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecShell + Wait, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecShell + Wait NSIS Discussion" />
	
	<title> ExecShell + Wait [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecShell + Wait</div>
<hr />
<div class="pda"><a href="t-152197.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=152197">ExecShell + Wait</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Olomite</div><div class="date">10th October 2003, 20:10</div></div><div class="posttext">I'd like to use ExecShell to open up a word document so it'll use the right program.  But I'd like it to wait until it's closed, like using ExecWait.  <br />
<br />
Is there a way to accomplish this?<br />
<br />
Thanks so much~</div></div><hr />


<div class="post"><div class="posttop"><div class="username">atsuk</div><div class="date">10th October 2003, 20:38</div></div><div class="posttext">...i have also searched a way to solve this problem, but haven't managed to do it so far. i think, that there isn't that feature now(or am i wrong), or atleast it is not in a documentation of NSIS. if it would be possible to improve next NSIS release with this feature, i would be grateful.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">10th October 2003, 21:00</div></div><div class="posttext">Have one function. It do ABOUT all things of both two commands (uses registry):<br />
<br />
Wait file execution with parameters (http://nsis.sourceforge.net/archive/nsisweb.php?page=261) (requires String Replace Function (http://nsis.sourceforge.net/archive/nsisweb.php?page=124))<br />
<br />
You can see it in my signature too... :)<br />
<br />
I used it in Win98, to open notepad and a text file with it and worked. But (like the ExecWait command) some of the programs NSIS doesn't wait, and the code continue running.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Olomite</div><div class="date">11th October 2003, 00:41</div></div><div class="posttext">I'd really like to be able to open up a M$ word document, and then start the installer when they close it.<br />
<br />
The reason I'm having trouble using ExecWait is because I don't know how to execute Winword.exe.<br />
<br />
This doesn't work:<br />
ExecWait `winword &quot;$EXEDIR\README.doc&quot;`<br />
<br />
I don't know how to quickly detect where for sure the executable winword.exe will be.<br />
<br />
Does anyone know how to detect the correct execute string for winword so that I can use it with ExecWait?<br />
<br />
<br />
Thanks so much- This would really help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th October 2003, 13:14</div></div><div class="posttext">ExecShell does not support this feature (Windows API limitation). There is an API available to get the application associated with a certain file type, but that will only work if the application does not require additional command line parameters.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th October 2003, 13:31</div></div><div class="posttext">deguix's function does exactly what you want... It seems to only work with extensions 3 characters long, but that shouldn't be a problem to you because doc is exactly 2 characters.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th October 2003, 14:52</div></div><div class="posttext">I don't think that function will work with all application. There are quite some different ways to set the file associations (classnames etc.).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Olomite</div><div class="date">14th October 2003, 20:54</div></div><div class="posttext">In your Function ExecWaitWithParameters:<br />
<br />
The command at the end seems like it's missing $3 for the file name.<br />
<br />
ExecWait '$2 $0' ==&gt; ExecWait '$2 $3 $0'<br />
<br />
Can you verify this?  I'm changed it to <br />
   ExecWait '$2 $3'<br />
because I do not have any parameters and it works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th October 2003, 16:11</div></div><div class="posttext">If you have no paramenters, then $0 will be &quot;&quot;<br />
<br />
You should simply Push &quot;&quot; for the parameters part.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">15th October 2003, 22:29</div></div><div class="posttext">deguix's function does exactly what you want... It seems to only work with extensions 3 characters long, but that shouldn't be a problem to you because doc is exactly 2 characters.<br />
<br />
Works with any number of characters.<br />
<br />
There are quite some different ways to set the file associations (classnames etc.).<br />
<br />
Maybe you can say HOW to do those to make alternative ones...<br />
<br />
Now it have a problem, when the extension program uses DDE (don't put %1 in the string) will only run the program. I'm trying to fix it puting the string to open your document when don't have a &quot;%1&quot; string. It will arrive today or tomorrow.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th October 2003, 22:44</div></div><div class="posttext">Originally posted by deguix <br />
Works with any number of characters.<br />
<br />
When the extension &quot;&quot; is pushed on the stack the file name is examined and only the 3 last characters are taken. The function doesn't look for the dot, it assumes 3 characters. Of course this is only in the automatic mode, which is where my &quot;seems to&quot; fits in ;)<br />
<br />
Anyway, keep up the good work and keep filling the Archive :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">16th October 2003, 01:12</div></div><div class="posttext">But putting manually the extension it works. Right? So I will try to fix that too. THANKS!<br />
<br />
Anyway, keep up the good work and keep filling the Archive :)<br />
<br />
Sometimes you make me smile too :)...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>