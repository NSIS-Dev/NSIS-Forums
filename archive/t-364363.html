<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problems with CopyFiles, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problems with CopyFiles NSIS Discussion" />
	
	<title> Problems with CopyFiles [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problems with CopyFiles</div>
<hr />
<div class="pda"><a href="t-364363.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=364363">Problems with CopyFiles</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">nc10</div><div class="date">20th June 2013, 15:48</div></div><div class="posttext">Hi, <br />
<br />
sorry i'm new in working with nsis.<br />
<br />
I want to copy files using CopyFiles: <br />
<br />
CopyFiles &quot;$INSTDIR\$Save&quot; &quot;$INSTDIR\saved&quot; <br />
<br />
$Save is a relative path like logs\log.txt<br />
<br />
The command obove does not work!!! But if the command is:<br />
CopyFiles &quot;$INSTDIR\logs\log.txt&quot; &quot;$INSTDIR\saved&quot;  it WORKS! <br />
<br />
I can not understand why! Why can't i use a Variable in the source? <br />
<br />
Thanks for helping!<br />
<br />
NC10</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">21st June 2013, 10:29</div></div><div class="posttext">As far as I know CopyFiles is a normal runtime command so, unlike the File command, you should be able to use variables as parameters. If it's not working, most probably the value of the variable is wrong. Put this before the command to check:<br />
MessageBox MB_OK &quot;$INSTDIR\$Save&quot;<br />
It could also be that the $INSTDIR\saved doesn't exist yet, in which case it would copy it to a file called 'saved' inside $INSTDIR. First SetOutPath &quot;$INSTDIR\saved&quot;  to create the directory.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nc10</div><div class="date">26th June 2013, 15:11</div></div><div class="posttext">Thank you very much! <br />
I think the command CopyFiles also can't handle Variables as Parameters. If i use !define it works.<br />
<br />
 So far: I have another Problem. <br />
I want to read out filenames (relative pathes) out of a file with FileRead,<br />
like: FileRead $0 $Save (in a Loop)<br />
So $Save contains the first line of a file and in my case it contains a relative path,<br />
for example &quot;logging.log&quot;.<br />
If i compare $Save with &quot;logging.log&quot;, it does not match.<br />
Means: ${If} $Save == &quot;logging.log&quot; MessageBox &quot;JA&quot; ${EndIf} does not work!!! <br />
Although DetailPrint $Save prints &quot;logging.log&quot; <br />
I cannot understand why! I really need help! Maybe there is any Encoding Problem? What can i do? <br />
<br />
Thank you for help!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">26th June 2013, 15:19</div></div><div class="posttext">${If} $Save == &quot;logging.log&quot; MessageBox &quot;JA&quot; ${EndIf} does not work!!! <br />
<br />
You've got the LogicLib formatting wrong. Also the MessageBox is incorrect.<br />
${If} $Save == &quot;logging.log&quot;<br />
MessageBox MB_OK &quot;JA&quot;<br />
${EndIf}<br />
<br />
But like I said, you can just use MessageBox MB_OK &quot;$save&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nc10</div><div class="date">26th June 2013, 15:47</div></div><div class="posttext">Hey thanks for answer:<br />
But i cannot see any difference?!?! <br />
my code: <br />
${If} $Save == &quot;logging.log&quot;<br />
MessageBox MB_OK &quot;Ja!&quot;<br />
${EndIf}<br />
<br />
(I only forgot to write MB_OK and the formatting in the post is wrong, in my code it is right)<br />
<br />
What's wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">26th June 2013, 22:00</div></div><div class="posttext">Please note that the If statement is case sensitive.<br />
Also check if there are leading or trailing spaces in $Save.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th June 2013, 14:58</div></div><div class="posttext">The == and != operators are not case sensitive. S== and S!= are, however.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">27th June 2013, 22:15</div></div><div class="posttext">Ah, sorry, you're right, I was too quick on checking the wiki page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nc10</div><div class="date">1st July 2013, 09:00</div></div><div class="posttext">Also check if there are leading or trailing spaces in $Save. <br />
Thanks. Good Tip! Now i use a function which trims leading and trailing spaces. Now it works.<br />
Now my Code:<br />
	<br />
FileOpen $0 &quot;$INSTDIR\test_text.txt&quot; r			; open and read line by line<br />
	Loop:<br />
		IfErrors Done<br />
		FileRead $0 $Line 									<br />
		;DetailPrint &quot;$Line!&quot;<br />
		${un.Trim} $withoutSpaces $Line					 			<br />
	Goto Loop<br />
	Done:<br />
		FileClose $0<br />
<br />
The code works, but one more problem: At the end of the file, my loop always reads (and print) an empty line. I don't know why. I thought the loop only works  until either a newline (or carriage return newline pair) occurs, or until a null byte is read (see docu).<br />
 Any idea?<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">1st July 2013, 11:20</div></div><div class="posttext">Maybe obvious, but are you sure there's not actually a newline at the end of your file?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>