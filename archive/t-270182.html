<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" group exclusion, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  group exclusion NSIS Discussion" />
	
	<title> group exclusion [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  group exclusion</div>
<hr />
<div class="pda"><a href="t-270182.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=270182">group exclusion</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dev_akm</div><div class="date">25th April 2007, 22:11</div></div><div class="posttext">A recent post by Red Wine (here (http://forums.winamp.com/showthread.php?postid=2161864#post2161864)) gave me some much-needed clues about the quirks of using RadioButtons for selecting sections, but I'm really struggling with setting up some exclusion logic.<br />
<br />
Basically, I have several sets of optional sections that are mutually exclusive. The exclusion itself isn't the problem, per se. The problem is that the first call to UnSelectSection seems to also inadvertently deselect the first section, even though that section is required (RO) and never referenced by any of the RadioButton logic. <br />
<br />
Why does it do this and how can I work around it?<br />
<br />
I can sort of get around the problem with an ugly hack to repeatedly SelectSection ${Required}, but this doesn't work well if there's a choice to be made in the required sectiongroup, so it's really not a solution.<br />
<br />
My actual code is quite long, so for the sake of brevity and clarity I have replicated the issue using a modified version of Red Wine's script. To test it, check whatever options you want in the first two sectiongroups, then pick something in the last sectiongroup (grp3), then scroll back up to the top and you'll see that the Required section has somehow become deselected. I've commented out the aforementioned ugly hack.<br />
<br />
Any help would be greatly appreciated.<br />
<br />
<br />
<br />
; group-exlude.nsi<br />
;<br />
; This example demonstrates the problem with exclusive control <br />
; of section selection.<br />
<br />
;--------------------------------<br />
<br />
; Section define/macro header file<br />
; See this header file for more info<br />
<br />
!include &quot;Sections.nsh&quot;<br />
!include &quot;logiclib.nsh&quot;<br />
<br />
;--------------------------------<br />
<br />
Name &quot;Group Exclusion Problem&quot;<br />
OutFile &quot;group-exlude.exe&quot;<br />
<br />
;--------------------------------<br />
<br />
; Pages<br />
<br />
Page components<br />
<br />
;--------------------------------<br />
<br />
; Sections<br />
<br />
Section !Required Required<br />
  SectionIn RO<br />
SectionEnd<br />
<br />
SectionGroup /e &quot;Group 1&quot; grp1<br />
Section &quot;Group 1 - Option 1&quot; g1o1<br />
SectionEnd<br />
<br />
Section /o &quot;Group 1 - Option 2&quot; g1o2<br />
SectionEnd<br />
<br />
Section /o &quot;Group 1 - Option 3&quot; g1o3<br />
SectionEnd<br />
SectionGroupEnd<br />
<br />
SectionGroup /e &quot;Group 2&quot; grp2<br />
Section &quot;Group 2 - Option 1&quot; g2o1<br />
SectionEnd<br />
<br />
Section /o &quot;Group 2 - Option 2&quot; g2o2<br />
SectionEnd<br />
<br />
Section /o &quot;Group 2 - Option 3&quot; g2o3<br />
SectionEnd<br />
SectionGroupEnd<br />
<br />
SectionGroup /e &quot;Group 3 - excludes Group 2&quot; grp3<br />
Section /o &quot;Group 3 - Option 1&quot; g3o1<br />
SectionEnd<br />
<br />
Section /o &quot;Group 3 - Option 2&quot; g3o2<br />
SectionEnd<br />
<br />
Section /o &quot;Group 3 - Option 3&quot; g3o3<br />
SectionEnd<br />
<br />
Section /o &quot;Do Not Use Group 3&quot; g3NONE<br />
SectionEnd<br />
<br />
SectionGroupEnd<br />
<br />
;--------------------------------<br />
<br />
; Functions<br />
<br />
; $1 stores the status of group 1<br />
; $2 stores the status of group 2<br />
<br />
Function .onInit<br />
<br />
  StrCpy $1 ${g1o1} ; Group 1 - Option 1 is selected by default<br />
  StrCpy $2 ${g2o1} ; Group 2 - Option 1 is selected by default<br />
<br />
FunctionEnd<br />
<br />
Function .onSelChange<br />
<br />
SectionGetFlags ${grp1} $R0<br />
IntOp $R0 $R0 &amp; ${SF_SELECTED}<br />
<br />
${If} $R0 == ${SF_SELECTED}<br />
    !insertmacro SelectSection ${g1o1}<br />
    !insertmacro UnSelectSection ${g1o2}<br />
    !insertmacro UnSelectSection ${g1o3}<br />
${EndIf}<br />
<br />
  !insertmacro StartRadioButtons $1<br />
    !insertmacro RadioButton ${g1o1}<br />
    !insertmacro RadioButton ${g1o2}<br />
    !insertmacro RadioButton ${g1o3}<br />
  !insertmacro EndRadioButtons<br />
<br />
SectionGetFlags ${grp2} $R0<br />
IntOp $R0 $R0 &amp; ${SF_SELECTED}<br />
<br />
${If} $R0 == ${SF_SELECTED}<br />
    !insertmacro SelectSection ${g2o1}<br />
    !insertmacro UnSelectSection ${g2o2}<br />
    !insertmacro UnSelectSection ${g2o3}<br />
${EndIf}<br />
<br />
  !insertmacro StartRadioButtons $2<br />
    !insertmacro RadioButton ${g2o1}<br />
    !insertmacro RadioButton ${g2o2}<br />
    !insertmacro RadioButton ${g2o3}<br />
  !insertmacro EndRadioButtons<br />
<br />
SectionGetFlags ${grp3} $R0<br />
IntOp $R0 $R0 &amp; ${SF_SELECTED}<br />
<br />
${If} $R0 == ${SF_SELECTED}<br />
    !insertmacro SelectSection ${g3o1}<br />
    !insertmacro UnSelectSection ${g3o2}<br />
    !insertmacro UnSelectSection ${g3o3}<br />
    !insertmacro UnSelectSection ${g3NONE}<br />
    !insertmacro UnSelectSection ${grp2}<br />
    #!insertmacro SelectSection ${Required}<br />
${EndIf}<br />
<br />
  ${If} ${SectionIsSelected} ${g3o1}<br />
    !insertmacro UnSelectSection ${grp2}<br />
  !insertmacro StartRadioButtons $3<br />
    !insertmacro RadioButton ${g3o1}<br />
    !insertmacro RadioButton ${g3o2}<br />
    !insertmacro RadioButton ${g3o3}<br />
    !insertmacro RadioButton ${g3NONE}<br />
  !insertmacro EndRadioButtons<br />
    #!insertmacro SelectSection ${Required}<br />
  <br />
  ${ElseIf} ${SectionIsSelected} ${g3o2}<br />
    !insertmacro UnSelectSection ${grp2}<br />
  !insertmacro StartRadioButtons $3<br />
    !insertmacro RadioButton ${g3o1}<br />
    !insertmacro RadioButton ${g3o2}<br />
    !insertmacro RadioButton ${g3o3}<br />
    !insertmacro RadioButton ${g3NONE}<br />
  !insertmacro EndRadioButtons<br />
    #!insertmacro SelectSection ${Required}<br />
  <br />
  ${ElseIf} ${SectionIsSelected} ${g3o3}<br />
    !insertmacro UnSelectSection ${grp2}<br />
  !insertmacro StartRadioButtons $3<br />
    !insertmacro RadioButton ${g3o1}<br />
    !insertmacro RadioButton ${g3o2}<br />
    !insertmacro RadioButton ${g3o3}<br />
    !insertmacro RadioButton ${g3NONE}<br />
  !insertmacro EndRadioButtons<br />
    #!insertmacro SelectSection ${Required}<br />
  <br />
  ${ElseIf} ${SectionIsSelected} ${g3NONE}<br />
    !insertmacro UnSelectSection ${g3NONE}<br />
    !insertmacro UnSelectSection ${grp3}<br />
    #!insertmacro SelectSection ${Required}<br />
  ${EndIf}<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">26th April 2007, 05:55</div></div><div class="posttext">Nice code dev_akm :)<br />
Add the following line to function .onInit to resolve the referred issue,<br />
  StrCpy $3 ${g3o1} ; Group 3 - Option 1 is selected by default</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dev_akm</div><div class="date">26th April 2007, 16:07</div></div><div class="posttext">Originally posted by Red Wine <br />
Nice code dev_akm :)<br />
Add the following line to function .onInit to resolve the referred issue,<br />
  StrCpy $3 ${g3o1} ; Group 3 - Option 1 is selected by default  <br />
<br />
Thanks for the reply. Seems obvious, now that you mention it. :-)<br />
<br />
However, I'm doing this already in my actual code and it's not helping. <br />
<br />
I will experiment further and post a followup if I can replicate the issue in your example code.<br />
<br />
Thanks again!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>