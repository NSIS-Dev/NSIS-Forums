<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How can I dectect if the .NET Framework 2 is installed?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How can I dectect if the .NET Framework 2 is installed? NSIS Discussion" />
	
	<title> How can I dectect if the .NET Framework 2 is installed? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How can I dectect if the .NET Framework 2 is installed?</div>
<hr />
<div class="pda"><a href="t-246140.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246140">How can I dectect if the .NET Framework 2 is installed?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Angry Coder</div><div class="date">14th May 2006, 03:26</div></div><div class="posttext">Hi!<br />
<br />
I'm wondering how can I dectect if the .NET Framework 2 is installed.<br />
<br />
Please help. Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galil</div><div class="date">14th May 2006, 04:09</div></div><div class="posttext">Use forum Search and/or browse the NSIS Repository (http://nsis.sourceforge.net/Category:Browse_NSIS_Repository_by_Topic), esp. parts &quot;Functions &amp; Macros&quot; and &quot;Code Examples&quot;.<br />
Or JUST SIMPLY RTFM - &quot;Appendix C: Useful Scripts&quot;<br />
Kthx. Bye.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angry Coder</div><div class="date">14th May 2006, 04:49</div></div><div class="posttext">Ok... this is the best:<br />
<br />
http://nsis.sourceforge.net/Get_.NET_Version<br />
<br />
Thanks for the link!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">foxmt</div><div class="date">15th May 2006, 09:55</div></div><div class="posttext">You can use this:<br />
<br />
Function IsDotNETInstalled<br />
   Push $0<br />
   Push $1<br />
   Push $2<br />
   Push $3<br />
   Push $4<br />
<br />
   ; Check for HKLM\Software\Microsoft\.NETFramework\InstallRoot value<br />
   ReadRegStr $4 HKLM &quot;Software\Microsoft\.NETFramework&quot; &quot;InstallRoot&quot;<br />
   ; remove trailing back slash<br />
   Push $4<br />
   Exch $EXEDIR<br />
   Exch $EXEDIR<br />
   Pop $4<br />
   ; if the root directory doesn't exist .NET is not installed<br />
   IfFileExists $4 0 noDotNET<br />
<br />
   ; Loop through all subkeys in HKLM\Software\Microsoft\.NETFramework\Policy, looking for v2.0<br />
   StrCpy $0 0<br />
   EnumStart:<br />
     EnumRegKey $2 HKLM &quot;Software\Microsoft\.NETFramework\Policy&quot; $0<br />
     IntOp $0 $0 + 1<br />
     StrCmp $2 &quot;v2.0&quot; GotKey<br />
     StrCmp $2 &quot;&quot; noDotNet<br />
     goto EnumStart<br />
   GotKey:<br />
<br />
   ; Now loop through all values in appropriate key, and make sure its actual directory exists<br />
   StrCpy $1 0<br />
   EnumPolicy:<br />
     EnumRegValue $3 HKLM &quot;Software\Microsoft\.NETFramework\Policy\v2.0&quot; $1<br />
     IntOp $1 $1 + 1<br />
     StrCmp $3 &quot;&quot; noDotNet<br />
     IfFileExists &quot;$4\v2.0.$3&quot; GotDir EnumPolicy<br />
   GotDir:<br />
<br />
   ; We have now verified that .NET is there<br />
   StrCpy $0 &quot;$4\v2.0.$3&quot;<br />
StrCpy $DotNetOk &quot;1&quot;<br />
 ; MessageBox MB_OK &quot;Found .NET v2.0 at $0&quot;<br />
   Goto done<br />
<br />
   noDotNET:<br />
     StrCpy $0 &quot;&quot;<br />
     StrCpy $DotNetOk &quot;0&quot;<br />
     Goto done<br />
<br />
   done:<br />
     Pop $4<br />
     Pop $3<br />
     Pop $2<br />
     Pop $1<br />
     Exch $0<br />
FunctionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>