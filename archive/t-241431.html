<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Calling external DLL's, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Calling external DLL's NSIS Discussion" />
	
	<title> Calling external DLL's [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Calling external DLL's</div>
<hr />
<div class="pda"><a href="t-241431.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=241431">Calling external DLL's</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Rodrigog</div><div class="date">21st March 2006, 14:54</div></div><div class="posttext">I am learning how to write dll's and call them with NSIS.<br />
<br />
When I try the following I get an empty return value.<br />
<br />
<br />
....<br />
ReserveFile &quot;${NSISDIR}\Plugins\RGRegistration.dll&quot;<br />
....<br />
<br />
Function .onInit<br />
StrCpy $r1 &quot;RODRIGO&quot;<br />
System::Call 'RGRegistration::Test(t) t(r1).r0'    <br />
#Pop $r0 <br />
MessageBox MB_OK &quot;$r0&quot; <br />
FunctionEnd<br />
<br />
I am trying to pass a string value, and get a string value back.<br />
<br />
This is the dll function :<br />
<br />
_declspec(dllexport) LPCTSTR Test(LPCTSTR name)<br />
{<br />
	return &quot;Got it!&quot;;<br />
}<br />
<br />
What am I doing wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">21st March 2006, 16:34</div></div><div class="posttext">I think you are mixing up the method of using the System.dll and using other plug-ins.<br />
RGRegistration::Test $parameters<br />
Take a look at ${NSISDIR}\Examples\AdvSplash\Example.nsi or one of the other plugin example scripts. There are also plenty of other plug-ins out there that include the source and example usage.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st March 2006, 17:18</div></div><div class="posttext">You must also extract the DLL. Reserving it is not enough. Use:InitPluginsDir<br />
SetOutPath $PLUGINSDIR<br />
File &quot;${NSISDIR}\Plugins\RGRegistration.dll&quot;<br />
System::Call 'RGRegistration::Test(t) t(r1).r0'If you want to call it as dienjd suggested, you'd have to change the parameters your function accepts. Take a look at Contrib\ExDLL in the source package.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">21st March 2006, 17:32</div></div><div class="posttext">oops, didn't know you could do that, but it makes sense.<br />
<br />
Is there any advantage to using System.dll to call your plug-in? Seems like the call is cleaner when you call a plug-in directly, and you'd be bundling System.dll unneccesarily if you weren't making other system calls.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>