<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" upgrading msvcrt.dll, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  upgrading msvcrt.dll NSIS Discussion" />
	
	<title> upgrading msvcrt.dll [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  upgrading msvcrt.dll</div>
<hr />
<div class="pda"><a href="t-68361.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=68361">upgrading msvcrt.dll</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jamesrf</div><div class="date">11th December 2001, 15:32</div></div><div class="posttext">Hi guys,<br />
<br />
To those that it may concern: Good work chaps!<br />
<br />
My question: What is the definitive way of upgrading dlls such as msvcrt.dll and mfc42.dll? Don't the dlls need to be copied to the system directory on reboot, and then registered? The thread about CompareDLLVersions was useful but petered out at the end.<br />
<br />
I would be very grateful to whoever gives me the answer!<br />
<br />
Cheers,<br />
James:p</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Edgewize</div><div class="date">11th December 2001, 16:43</div></div><div class="posttext">To be perfectly honest, this is a bit of a pain regardless of what installer you use.  There are all sorts of version conflicts and possible future scenarios that make replacing MSVCRT.DLL a very dangerous proposition.<br />
<br />
I just link statically when I build.  You would think that it defeats the purpose of having these libraries, but it doesn't increase EXE size very much unless you rely heavily on MFC.<br />
<br />
That said, I think that Microsoft has a self-extracting redistributable binary somewhere.  You can just include that whole self-extracting EXE in your NSIS project and ExecWait it.  There is some command-line flag to make it quiet (ie, no message boxes)... try passing it /? and see what it says.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th December 2001, 18:11</div></div><div class="posttext">Hi!<br />
<br />
I just found the solution for my DLL problemes (CompareDLLVersion topic).<br />
<br />
Renaming the files will be done before runonce in the registery, so you should:<br />
<br />
File DLLNAME.TMP<br />
Rename /REBOOTOK DLLNAME.TMP DLLNAME.DLL<br />
<br />
Add to runonce in the registry (see my topic): regsvr32.exe /s DLLNAME.DLL (/s makes it silent, without messagebox) :)<br />
<br />
To check if the DLL on the system is older, see the GetLocalDLLVersion, GetDLLVersion info in my topic.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">F. Heidenreich</div><div class="date">12th December 2001, 09:27</div></div><div class="posttext">I think the best solution for DLL-Hell with system dlls (like mfc42.dll or msvcrt.dll) is to copy your versions of the dlls in your program directory. The programm directory is the first place the system searches for them.<br />
<br />
~ Florian</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>