<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" DirText issue, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  DirText issue NSIS Discussion" />
	
	<title> DirText issue [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  DirText issue</div>
<hr />
<div class="pda"><a href="t-149165.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=149165">DirText issue</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">LIGHTNING UK!</div><div class="date">14th September 2003, 11:39</div></div><div class="posttext">When trying to override the default GUI text using the DirText variable, I keep getting the following error from MakeNSISW<br />
<br />
DirText expects 0-3 parameters, got 4.<br />
Usage: DirText [directory_page_description] [directory_page_subtext] [browse_button_text] [browse_dlg_text]<br />
<br />
Ok, now to me that looks like 4 parameters going by the 'Usage' text, I'm supplying 4, so why does the function want 0 - 3?!<br />
<br />
btw, im using the latest nightly cvs snapshot - downloaded about 10 mins ago.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th September 2003, 11:45</div></div><div class="posttext">Thanks, that's a little typo in tokens.cpp. I have fixed this on my local version, but I can't upload right now because it includes far more than just this fix. I hope to upload it this evening. If you have a compiler you can change tokens.cpp line 49 to:<br />
<br />
{TOK_DIRTEXT,&quot;DirText&quot;,0,4,&quot;[directory_page_description] [directory_page_subtext] [browse_button_text] [browse_dlg_text]&quot;},</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LIGHTNING UK!</div><div class="date">14th September 2003, 12:23</div></div><div class="posttext">And just one more thing while im in the 'fixing bugs' frame of mind...<br />
<br />
BIF_RETURNONLYFSDIRS doesnt work as it should do on XP and 2003 - and possibly other OS's. The SHBrowseForFolder function needs to also rely on its callback procedure. You can test this by selecting 'My Computer'. It 'should' grey out the Ok button but it doesnt.<br />
<br />
I would like to suggest you add the following to 'BrowseCallbackProc' in the file UI.c<br />
<br />
<br />
else if(uMsg==BFFM_SELCHANGED)<br />
{<br />
  TCHAR szDir[MAX_PATH];<br />
  if(!SHGetPathFromIDList((LPITEMIDLIST) lparam ,szDir))<br />
  {<br />
   // Disable the OK button if the currently selected item isnt a valid path<br />
    SendMessage(hwnd, BFFM_ENABLEOK, 0, false);<br />
  }<br />
}<br />
<br />
<br />
You might also need to '|' an addition flag 'BIF_VALIDATE' in the BROSWEINFO structure before you call the SHBrowseForFolder function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th September 2003, 13:55</div></div><div class="posttext">Thanks, fixed that too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LIGHTNING UK!</div><div class="date">14th September 2003, 14:48</div></div><div class="posttext">Nice one :)<br />
<br />
Now I just have to wait and see which nightly snapshot contains the fixes ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th September 2003, 22:55</div></div><div class="posttext">Uploaded.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>