<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" make a custom plugin ?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  make a custom plugin ? NSIS Discussion" />
	
	<title> make a custom plugin ? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  make a custom plugin ?</div>
<hr />
<div class="pda"><a href="t-286045.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=286045">make a custom plugin ?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">arfgh</div><div class="date">31st January 2008, 18:07</div></div><div class="posttext">i need to use some plugin in my program<br />
Exactly is the FindProc. But this one is copyrighted and bytheway i got the decission to make my own plugin to find the process.<br />
<br />
The nsis plugins are simple dlls ? or i must know something more to make them ?<br />
<br />
example: This dll i told is usage like this:<br />
<br />
FindProcDLL::FindProc &quot;process_name.exe&quot;<br />
<br />
and the result come in the $R0 variable.<br />
What i must do in my dll to return th result on this variable ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">31st January 2008, 19:12</div></div><div class="posttext">setuservariable function will return stuff on nsis stack. I assuming that you already familiar with some c or c++ background and you have read exdll @ nsis source code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arfgh</div><div class="date">31st January 2008, 19:37</div></div><div class="posttext">well<br />
i can make normal dlls using also vb6.<br />
But i dont know if the structure of the nsis dll plugins must have some special.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st February 2008, 08:48</div></div><div class="posttext">You can't write plug-ins in VB. You'll need to learn a bit of C/C++ or Delphi. Other option is to write a VB6 executable but you'd have to install the VB6 run times first.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arfgh</div><div class="date">1st February 2008, 13:31</div></div><div class="posttext">sorry afrow UK, but VB6 is able to produce normal dlls as C/C++ do. The limitation to produce activex dlls was for the past.<br />
<br />
 i only need some documentation to know the special things on the dll to give the result of the built in dll function to the variable R0 as do this other plugin i related.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st February 2008, 14:54</div></div><div class="posttext">Yes you can create dll's in VB6 but whether you can call them using the calling convention and whether you can access the information that is passed to the dll is another matter.<br />
<br />
If you are able to, it will be helpful to others.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">1st February 2008, 14:55</div></div><div class="posttext">Originally posted by arfgh <br />
sorry afrow UK, but VB6 is able to produce normal dlls as C/C++ do. The limitation to produce activex dlls was for the past.<br />
<br />
 i only need some documentation to know the special things on the dll to give the result of the built in dll function to the variable R0 as do this other plugin i related. <br />
Now, that's very wrong, VB doesn't create &quot;normall&quot; dlls, because the dllmain entry points directly to visual basic 6 runtime, meaning only vb 6 apps can use them. But I think that there are some wrappers that can call you vb6 activex from C.<br />
As I told you setuservariable, from exdll.h, has the &quot;C&quot; function to return values to the stack, like $R0.<br />
I repeat, you can't use vb's dll directly with nsis as pointed by stu.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arfgh</div><div class="date">1st February 2008, 15:21</div></div><div class="posttext">ok, i go to repeat.<br />
<br />
VB6 by default only is able to create activex DLLs.<br />
But doing a simple modification to the linker, is able to produce normal dlls as in C !<br />
<br />
for that reason must be possible to create plugin for nsis using vb6.<br />
<br />
I just need only the info or documentation to know how to give the result of the function on the r0 variable as do for example the plugin called FindProcDll.<br />
<br />
can someon help ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arfgh</div><div class="date">6th February 2008, 00:40</div></div><div class="posttext">at finaly nobody can tell me why i cant do that ?<br />
<br />
i am able to load my dll from the c++ with <br />
<br />
hDLL = LoadLibrary(&quot;test.dll&quot;);<br />
<br />
<br />
Then why i cant use it with nsis ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">6th February 2008, 00:48</div></div><div class="posttext">use http://www.dependencywalker.com/ to make sure the exported function's name is correnct (no name mangling)<br />
<br />
also, exports must use the _cdecl calling convention</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>