<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" RMDir unfunctional, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  RMDir unfunctional NSIS Discussion" />
	
	<title> RMDir unfunctional [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  RMDir unfunctional</div>
<hr />
<div class="pda"><a href="t-294510.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=294510">RMDir unfunctional</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Backtassaar</div><div class="date">14th July 2008, 19:46</div></div><div class="posttext">Hi everybody, I have a problem which many people here has been solving, but even after reading through lots of topics i didnt find my answer. I have this section:<br />
<br />
<br />
Section /o &quot;un.$(NAME_SecUnRemoveAllFiles)&quot; SecUnRemoveAllFiles<br />
    SetOutPath &quot;C:\&quot;<br />
    MessageBox MB_ICONQUESTION|MB_YESNO $(MB_REMOVE_ALL_FILES) IDNO skip_removeall<br />
        RMDir /r &quot;$INSTDIR&quot;<br />
    skip_removeall:<br />
SectionEnd<br />
<br />
<br />
This Section is my last section in uninstaller and i have set   OutPath to C:\ , but still, my folder is not deleted (only folder remains, all files inside are deleted). I looked on that uninstaller through Process Manager and it told me that process &quot;Au_.exe&quot; is still holding my $INSTDIR and so it cannot be deleted, but that was the unistaller process. So i pop-upped a message window with all variables i was using and it showed me that my InstDir is hold only by $INSTDIR.<br />
Now i have no idea what to do more. It looks like a bug in RMDir to me, because in official Scripting Reference is told that only $OUTDIR can block directory from being removed. And i dont want to delete it by some !system commands. Can you help me? Thanks a lot for every response.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">14th July 2008, 20:19</div></div><div class="posttext">first off, doing SetOutPath &quot;c:\&quot; might not be the best thing to do, the user might not have a c: drive, do SetOutPath with $temp or $desktop<br />
<br />
You might have a plugin or something like that with a handle open to $instdir, or if $instdir contains a COM dll or something that could be loaded in some other process.<br />
<br />
To get around all of this, add the reboot flag to rmdir</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Backtassaar</div><div class="date">29th July 2008, 10:27</div></div><div class="posttext">Well, i searched through my plugins - none of them is holding that path (I even tried to disable all of them - didnt help). Then i showed to myself a message window with all system registers during the uninstallation ($0, $1 .. $9, $R0 .. $R9). Not a single one has been holding way to that directory.  There is a possibility that somewhere inside my program is that path pushed into stack. Is there a possibility that stack is blocking it? Or do you have any ideas what else could still hold that handle? Thanks a lot!<br />
Backtassaar</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">29th July 2008, 12:48</div></div><div class="posttext">just having the path on the stack or in a variable will not stop you from deleting</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MidnightJava</div><div class="date">2nd November 2008, 04:29</div></div><div class="posttext">In case you're still looking for a solution to this: I had the same problem, and I couldn't find any reason the empty folder could not be deleted by RmDir. After trying many things, I moved the RmDir statement to the very end of the -un.post section, so it's the very last command that executes; and that fixed it.<br />
<br />
The only statements I had between the previous and final locations of the RmDir statement were statements deleting registry values and shortcuts. My best guess is the problem was caused by having a QuickLaunch shortcut pointing to a location that used to be inside the now-empty directory I was trying to delete. Perhaps that's what was holding on to the handle for the empty directory.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd November 2008, 13:48</div></div><div class="posttext">Just a note for you people using RMDir /r on $INSTDIR (which is potentially very harmful to a user's computer).<br />
http://nsis.sourceforge.net/Validating_$INSTDIR_before_uninstall<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>