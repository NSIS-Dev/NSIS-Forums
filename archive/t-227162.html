<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" XML plugin, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  XML plugin NSIS Discussion" />
	
	<title> XML plugin [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  XML plugin</div>
<hr />
<div class="pda"><a href="t-227162.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=227162">XML plugin</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">28th September 2005, 19:52</div></div><div class="posttext">XML plugin parses an XML document, and builds from that a Document Object Model (DOM) that can be read, modified and saved. XML plugin is based on TinyXml (http://www.sourceforge.net/projects/tinyxml) (2.4.0 RC).<br />
<br />
Features:<br />
- Read and/or modified xml files <br />
- Code is fast and lightweight <br />
- Unicode UTF-8 support <br />
- &quot;MSXML.DLL&quot; independent <br />
- Support for condense and non-condense white spaces <br />
- Row and Column tracking<br />
<br />
<br />
&quot;XML&quot; plugin v1.0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kike_velez</div><div class="date">29th September 2005, 09:17</div></div><div class="posttext">:up: :up: :up:  for <br />
<br />
&quot;MSXML.DLL&quot; independent  <br />
<br />
Best Regards and Good Job</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">20th October 2005, 17:49</div></div><div class="posttext">Changes:<br />
- TinyXml updated to v2.4.1<br />
- Fixed: output variable in xml::NoChildren<br />
- New: xml::GetText<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;Convenience function for easy access to the text inside current element.<br />
- New: xml::SetCDATA<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;Turns on or off a CDATA representation of the current element text.<br />
- New: xml::IsCDATA<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;Queries whether this represents text using a CDATA section.<br />
<br />
<br />
&quot;XML&quot; plugin v1.1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">20th October 2005, 19:58</div></div><div class="posttext">next plugin i repack for correct usage of nsis file structure :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">25th October 2005, 05:23</div></div><div class="posttext">-TinyXml updated to v2.4.2<br />
-Fixed: &quot;CreateNode&quot; appearance of the &quot;\r\n&quot; at the end (thanks Lee Thomason)<br />
-Fixed: Now error appears if current node is TEXT and uses &quot;InsertEndChild&quot;<br />
-Changed: &quot;AttributeByName&quot; -&gt; &quot;GetAttribute&quot; now not only returns value of the attribute, but also goes to it<br />
-New: &quot;GetNodeValue&quot; can be useful in some cases<br />
<br />
<br />
&quot;XML&quot; plugin v1.2</div></div><hr />


<div class="post"><div class="posttop"><div class="username">false</div><div class="date">7th November 2005, 18:58</div></div><div class="posttext">How would I go about selecting a particular node by it's name? Like how Olivier Marcoux's NSIS XML uses...<br />
<br />
nsisXML::select &lt;XPath expression&gt;<br />
<br />
Thx!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">7th November 2005, 19:35</div></div><div class="posttext">If you want to &quot;select&quot; the node you need go to it (FirstChildElement, NextSiblingElement ...). Easy for me, when you ask the concrete example, what you trying to do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">false</div><div class="date">7th November 2005, 21:59</div></div><div class="posttext">Somewhere nested in my XML, I have a set of child nodes who have the same name and share the same parent. The child nodes differ by having different attributes values.<br />
<br />
I would like to test if a particular node exists in an XML without having to drill down using FirstChildElement and NextSiblingElement. If the node with the target node name exists, I would make it the current node.<br />
<br />
I thought GotoHandle would do this for me but I am wrong in thinking it takes in a node name for a parameter.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">7th November 2005, 22:33</div></div><div class="posttext">I'll think about recursive node search</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">9th November 2005, 16:45</div></div><div class="posttext">New: [xml::FindNextElement /NOUNLOAD &quot;[name]&quot; .r0 .r1]<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Search for element (recursive), returns the element name and goes to it.<br />
New: [xml::FindCloseElement /NOUNLOAD]<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Closes search opened by xml::FindNextElement.<br />
New: [xml::ElementPath /NOUNLOAD .r0]<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Returns the current element path.<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;(e.g. &quot;/a/b/c[3]/d&quot;)<br />
New: [xml::GotoPath /NOUNLOAD &quot;[path]&quot; .r0]<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-Goes to the specified path.<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;(e.g. from root &quot;/a/b[2]/c/d&quot;, from current element &quot;a/b[2]/c/d&quot;,<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;using last element 'b' &quot;a/b[-1]/c/d&quot;)<br />
<br />
<br />
&quot;XML&quot; plugin v1.3</div></div><hr />


<div class="post"><div class="posttop"><div class="username">false</div><div class="date">9th November 2005, 16:56</div></div><div class="posttext">You da man! That was a fast. I'll give this a shot. Thx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">9th November 2005, 19:33</div></div><div class="posttext">Hey Instructor any plans for UTF-16 support?  I could really use that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">9th November 2005, 20:15</div></div><div class="posttext">DOM builds by TinyXML parser, so UTF-16 is depend on this project. BTW: Where is already have feature request (http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1111690&amp;group_id=13559&amp;atid=363559) about it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">9th November 2005, 21:01</div></div><div class="posttext">Ah excellent.  Good to know it's on the queue.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">10th November 2005, 15:04</div></div><div class="posttext">Added: now &quot;GotoPath&quot; can accept elements without name (e.g. using any last element &quot;a/[-1]/c/d&quot;)<br />
<br />
<br />
&quot;XML&quot; plugin v1.4</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">10th December 2005, 17:21</div></div><div class="posttext">Fixed: Now &quot;ElementPath&quot; and &quot;GotoPath&quot; correctly working with the document beginning. If &quot;ElementPath&quot; returns &quot;&quot; - the current element is the beginning of the document. [xml::GotoPath /NOUNLOAD &quot;&quot; .r0] - go to the document beginning.<br />
<br />
<br />
&quot;XML&quot; plugin v1.5</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kiggie</div><div class="date">13th January 2006, 11:04</div></div><div class="posttext">Hi,<br />
<br />
there seems to be a bug in the GetAttribute Method, it returns  <br />
always -1 for the first attribute of a node. <br />
<br />
A possible workaround is to check if the FirstAttribute differs from the desired attribute.<br />
<br />
Kind Regards,<br />
<br />
Rob</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chagam</div><div class="date">13th January 2006, 11:46</div></div><div class="posttext">Hi,<br />
<br />
May be I'm missing something but I don't understand how to replace a text value.<br />
<br />
There's a xml::GetText function. How do I do a xml::SetText ?<br />
<br />
Thanks in advance<br />
<br />
Chag</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kiggie</div><div class="date">13th January 2006, 11:54</div></div><div class="posttext">Originally posted by chagam <br />
Hi,<br />
<br />
May be I'm missing something but I don't understand how to replace a text value.<br />
<br />
There's a xml::GetText function. How do I do a xml::SetText ?<br />
<br />
Thanks in advance<br />
<br />
Chag <br />
<br />
Did you try the xml::SetNodeValue method ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chagam</div><div class="date">13th January 2006, 12:25</div></div><div class="posttext">Hi,<br />
<br />
Yes, I tried. May be a did something wrong.<br />
<br />
My xml file looks like this : <br />
&lt;config&gt;<br />
  &lt;local&gt;<br />
    &lt;host&gt;test&lt;/host&gt;<br />
  &lt;/local&gt;<br />
&lt;/config&gt;<br />
<br />
I tried : <br />
  xml::GotoPath /NOUNLOAD &quot;/config/local/host&quot; .r0<br />
  xml::SetNodeValue /NOUNLOAD &quot;1234&quot; .r0<br />
<br />
and my new xml file looks like this : <br />
&lt;config&gt;<br />
  &lt;local&gt;1234<br />
  &lt;/local&gt;<br />
&lt;/config&gt;<br />
<br />
Chag</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">13th January 2006, 13:26</div></div><div class="posttext">Name &quot;XMLTest&quot;<br />
OutFile &quot;XMLTest.exe&quot;<br />
<br />
Section<br />
	xml::LoadFile /NOUNLOAD &quot;test.xml&quot; .r0<br />
	MessageBox MB_OK &quot;xml::LoadFile$\n$$0=$0&quot;<br />
<br />
	xml::GotoPath /NOUNLOAD &quot;/config/local/host&quot; .r0<br />
	MessageBox MB_OK &quot;xml::GotoPath$\n$$0=$0&quot;<br />
<br />
	xml::FirstChild /NOUNLOAD &quot;&quot; .r0 .r1<br />
	MessageBox MB_OK &quot;xml::FirstChild$\n$$0=$0$\n$$1=$1&quot;<br />
<br />
	xml::SetNodeValue /NOUNLOAD &quot;1234&quot;<br />
	MessageBox MB_OK &quot;xml::SetNodeValue&quot;<br />
<br />
	xml::SaveFile &quot;test_saved.xml&quot; .r0<br />
	MessageBox MB_OK &quot;xml::SaveFile$\n$$0=$0&quot;<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">13th January 2006, 13:31</div></div><div class="posttext">there seems to be a bug in the GetAttribute Method, it returns <br />
always -1 for the first attribute of a node.Fixed, thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">13th January 2006, 14:40</div></div><div class="posttext">Fixed: GetAttribute returns -1 for the first attribute.<br />
New: &quot;SetText&quot; -convenience function for easy set the text of the current element.<br />
<br />
<br />
&quot;XML&quot; plugin v1.6</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xilay</div><div class="date">3rd March 2006, 13:32</div></div><div class="posttext">Hello,<br />
<br />
I need to create a new element without text.<br />
I use this code :<br />
xml::LoadFile /NOUNLOAD &quot;test.xml&quot; .r0<br />
xml::GotoPath /NOUNLOAD &quot;/root&quot; .r0<br />
xml::CreateNode /NOUNLOAD &quot;&lt;histo&gt;&lt;/histo&gt;&quot; .r0<br />
xml::InsertEndChild /NOUNLOAD &quot;$0&quot; .r0<br />
xml::SaveFile /NOUNLOAD &quot;test.xml&quot; .r0<br />
<br />
But the new element is with a blank at the end, like this :<br />
&lt;root&gt;<br />
    &lt;histo /&gt;<br />
&lt;/root&gt;<br />
<br />
If I create the element with text, it's ok.<br />
Have you got an idea?<br />
<br />
Thanks<br />
<br />
(sorry if my english is not very good)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">3rd March 2006, 15:13</div></div><div class="posttext">this is correct xml behaviour.<br />
empty elements have to be &lt;element /&gt;, not &lt;element&gt;&lt;/element&gt;.<br />
<br />
last one is no valid xml!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xilay</div><div class="date">3rd March 2006, 16:10</div></div><div class="posttext">Yes, I know, the problem is the blank after 'histo'.<br />
I have this &lt;histo /&gt; (you see, the blank between 'histo' and '/') and not this &lt;histo/&gt;.<br />
<br />
Sorry for my bad explanation :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">3rd March 2006, 20:16</div></div><div class="posttext">W3.org (which pretty much has the final word on markup languages like XML) recommends that a space should be used when declaring empty tags.<br />
<br />
So this would be proper XML:<br />
&lt;histo /&gt;<br />
<br />
NOT this:<br />
&lt;histo/&gt;<br />
<br />
See the section tags for empty elements at http://www.w3.org/TR/REC-xml/#sec-starttags for more info.<br />
<br />
[edit]<br />
And FWIW, I've always seen empty tags written using a space between the element name and the '/' character...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xilay</div><div class="date">6th March 2006, 08:10</div></div><div class="posttext">Ok, I use xmlspy and it deletes the blank, so, I thought it was not normal.<br />
Thanks a lot (and thanks for this perfect plugin)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">6th March 2006, 13:50</div></div><div class="posttext">Updated: TinyXml to v2.4.3<br />
Changed: Now plugin used header &quot;XML.nsh&quot; for custom user variables and<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;better compile errors check.<br />
<br />
Update from previous versions:<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- Insert line in script:<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;!include &quot;XML.nsh&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- Replace:<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;xml::LoadFile -&gt; ${xml::LoadFile} ...<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- Replace:<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;.r0 -&gt; $0, .r1 -&gt; $1 ...  .R0 -&gt; $R0, .R1 -&gt; $R1 ...<br />
<br />
&quot;XML&quot; plugin v1.7</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stwhit</div><div class="date">3rd May 2006, 14:52</div></div><div class="posttext">I need to be able to parse two XML documents at the same time (because I'm merging them during an upgrade process).<br />
<br />
From looking at the API and the source code, it looks like this XML plugin only supports working on a single XML document at a time, because there is no concept of a file handle being returned by ${xml::LoadFile} and being passed to the other functions.  It looks like there is a single, global XML document being edited (TiXmlDocument doc).<br />
<br />
So, two questions:<br />
<br />
1. Is it possible to edit two XML documents at the same time using this plugin?<br />
2. If not, would you consider enhancing the plugin to use file handles to support editing multiple XML documents at once?<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">3rd May 2006, 15:19</div></div><div class="posttext">1. Not.<br />
2. I'm not plaining this.<br />
<br />
But you can use ${xml::CloneNode}<br />
<br />
<br />
Section<br />
	${xml::LoadFile} &quot;file.xml&quot; $0<br />
	MessageBox MB_OK &quot;xml::LoadFile$\n$$0=$0&quot;<br />
<br />
	${xml::GotoPath} &quot;/&quot; $0<br />
	MessageBox MB_OK &quot;xml::GotoPath$\n$$0=$0&quot;<br />
<br />
	${xml::CloneNode} $R0<br />
	MessageBox MB_OK &quot;xml::CloneNode$\n$$R0=$R0&quot;<br />
<br />
	${xml::Unload}<br />
<br />
<br />
	${xml::LoadFile} &quot;file2.xml&quot; $0<br />
	MessageBox MB_OK &quot;xml::LoadFile$\n$$0=$0&quot;<br />
<br />
	${xml::GotoPath} &quot;/&quot; $0<br />
	MessageBox MB_OK &quot;xml::GotoPath$\n$$0=$0&quot;<br />
<br />
	${xml::InsertBeforeNode} &quot;$R0&quot; $0<br />
	MessageBox MB_OK &quot;xml::InsertBeforeNode$\n$$0=$0&quot;<br />
<br />
	${xml::FreeNode} &quot;$R0&quot; $0<br />
	MessageBox MB_OK &quot;xml::FreeNode$\n$$0=$0&quot;<br />
<br />
	${xml::SaveFile} &quot;file2.xml&quot; $0<br />
	MessageBox MB_OK &quot;xml::SaveFile$\n$$0=$0&quot;<br />
<br />
	${xml::Unload}<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">31st July 2006, 03:48</div></div><div class="posttext">I'm trying to create an XML file from scratch using this plugin.  Is this possible?  If so, can someone post an example of how I might accomplish this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">31st July 2006, 15:56</div></div><div class="posttext">FileWrite</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">1st August 2006, 00:48</div></div><div class="posttext">darn...<br />
I was hoping that I could build an XML file in memory using the plugin and then output the whole thing to a file.  (It would be a cool enhancement for sure.)<br />
<br />
I guess for now, I'll just write my own FileWrite functions to get me by for now.<br />
<br />
Thanks for the feedback!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">emmett_m</div><div class="date">16th August 2006, 07:00</div></div><div class="posttext">Hi, I am hoping you can help me, I tried some of the code examples found in \NSIS\Examples\XMLXMLTest.nsi. And tried to apply these examples with what I want with little success, here is what I am trying to achieve.<br />
<br />
I have the following xml file (VS.Net config file):<br />
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;<br />
&lt;configuration&gt;<br />
    &lt;configSections&gt;<br />
    &lt;/configSections&gt;<br />
<br />
    &lt;appSettings&gt;<br />
	&lt;add key=&quot;somekey&quot; value=&quot;some value&quot;/&gt;<br />
    &lt;/appSettings&gt;<br />
	<br />
    &lt;connectionStrings&gt;<br />
        &lt;add name=&quot;ConnString&quot; connectionString=&quot;TRYING TO MODIFY THIS TEXT&quot;<br />
            providerName=&quot;System.Data.SqlClient&quot; /&gt;<br />
    &lt;/connectionStrings&gt;<br />
&lt;/configuration&gt; <br />
<br />
When the installer runs, I am trying to change the text in the connectionString attribute of the &lt;add&gt; element. I have placed the file in the same directory as my install script, and the script includes the following code:<br />
<br />
!include &quot;XML.nsh&quot;<br />
<br />
var /global ReplacementString<br />
var /global fhandle<br />
<br />
${xml::LoadFile}     &quot;appname.exe.config&quot; $fhandle<br />
MessageBox MB_OK &quot;$fhandle&quot; ; always returns -1<br />
<br />
${xml::GotoPath}     &quot;/configuration/connectionStrings/add&quot; $fhandle<br />
${xml::SetAttribute} &quot;connectionString&quot; &quot;$ReplacementString&quot; $fhandle<br />
${xml::SaveFile}     &quot;$INSTDIR\appname.exe.config&quot; $fhandle<br />
${xml::Unload} ; unload plugin<br />
<br />
When attempting to open the file it always returns -1, can anybody tell me what the obvious mistake that I am making, and yes the file is in UTF8 format, I have however tried saving the format of the file from Notepad, into different formats in desperation, with no help (as I expected).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">16th August 2006, 08:17</div></div><div class="posttext">I have no problem. Make sure that the file exist and try to specify full path to it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">emmett_m</div><div class="date">16th August 2006, 09:00</div></div><div class="posttext">That is interesting, I tried as you suggested to supply the full path to the file, which is the same location as the setup program, and it works. However I thought when you specified a file like:<br />
<br />
${xml::LoadFile}     &quot;appname.exe.config&quot; $fhandle<br />
<br />
That it would use the file from the same directory as the installer, it would seem not. Also I tried the following:<br />
<br />
${xml::LoadFile}     &quot;$EXEDIR\appname.exe.config&quot; $fhandle<br />
<br />
Which seems to be what I should have done. Thanks for your time ;-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">17th August 2006, 18:47</div></div><div class="posttext">as the plugin is extracted to $PLUGINSDIR i guess it searches the file there, not in $EXEDIR.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">emmett_m</div><div class="date">18th August 2006, 00:59</div></div><div class="posttext">Just in case somebody else comes across this problem, what I really wanted to do was have the .config file wrapped up into the installer, and manipulate that version, to do this I did the following:<br />
<br />
Section &quot;MainSection&quot; SEC01<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  SetOverwrite ifnewer<br />
  File &quot;appname.exe.config&quot; ; reads file into memory and wraps(compresses) into installer<br />
Section <br />
<br />
  ${xml::LoadFile} &quot;appname.exe.config&quot; $fhandle ; modify the config file compressed in installer<br />
<br />
<br />
This seems to work great.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JDaniels13</div><div class="date">24th August 2006, 22:49</div></div><div class="posttext">I recently needed to edit existing .NET (Framework 1.1) config files within an NSIS install.  Using some of the info here and the XML plugin docs, I was able to put something together that actually appears to work for changing keys in .NET 1.1 config files.  Below is what I came up with.  (There are some extra message boxes for debugging that should be removed prior to using.)  Is there an easier way??!!  I was truly surprised at the lack of discussion of this topic.  I didn't want to write a .NET program in C# or VB.NET because I wanted it all to be in the NSIS setup, for simplicity's sake.  <br />
<br />
<br />
!include &quot;XML.nsh&quot;<br />
<br />
var /global IOResult<br />
var /global NewNodeHandle<br />
var /global CurrentValue<br />
var /global ElementName<br />
<br />
!macro EditDotNETConfigFile ConfigFile KeyPath KeyName KeyValue<br />
  ${xml::LoadFile} ${ConfigFile} $IOResult<br />
  ${xml::GotoPath} ${KeyPath} $IOResult<br />
  IntCmp $IOResult 0 pathLookupSucceeded noAppSettings<br />
pathLookupSucceeded:<br />
   MessageBox MB_OK &quot;pathLookupSucceeded for ${KeyPath}&quot;<br />
checkAttributeExistence:<br />
  ${xml::GetAttribute} &quot;key&quot; $CurrentValue $IOResult<br />
  ; Did we find an existing instance of our config setting?<br />
  IntCmp $IOResult 0 checkKeyAttributeValue toNextElement<br />
checkKeyAttributeValue:<br />
   MessageBox MB_OK &quot;checkKeyAttributeValue current value is $CurrentValue vs desired key ${KeyName}&quot;<br />
  ; OK, found one, is it our desired key?  Case-sensitive compare.<br />
  StrCmpS $CurrentValue ${KeyName} foundKeyAttribute toNextElement<br />
toNextElement:<br />
   MessageBox MB_OK &quot;checkKeyAttributeValue $CurrentValue didn't match ${KeyName}&quot;<br />
  ; Didn't find the &lt;add key= &quot; attribute name we wanted, check next &quot;&lt;add &quot; element<br />
  ${xml::NextSiblingElement} &quot;add&quot; $ElementName $IOResult<br />
   MessageBox MB_OK &quot;toNextElement name is $ElementName IOResult is $IOResult&quot;<br />
  IntCmp $IOResult 0 checkAttributeExistence noExistingEntry<br />
<br />
foundKeyAttribute:<br />
  ${xml::GetAttribute} &quot;value&quot; $CurrentValue $IOResult<br />
   MessageBox MB_OK &quot;foundKeyAttribute check value attribute $CurrentValue vs desired key ${KeyValue}&quot;<br />
  ; Did we find an existing instance of our config setting?<br />
  StrCmp $CurrentValue ${KeyValue} valueUnchanged valueChanged<br />
valueChanged:<br />
 ${xml::SetAttribute} &quot;value&quot; &quot;${KeyValue}&quot; $IOResult<br />
  IntCmp $IOResult 0 setAttributeWorked setAttributeFailed<br />
setAttributeWorked:<br />
  goto saveConfigFile<br />
<br />
noExistingEntry:<br />
   MessageBox MB_OK &quot;GetAttribute could not find existing value for ${KeyName}&quot;<br />
  ${xml::CreateNode} '&lt;add key=&quot;${KeyName}&quot; value=&quot;${KeyValue}&quot; /&gt;' $NewNodeHandle<br />
  ${xml::InsertAfterNode} $NewNodeHandle $IOResult<br />
  goto saveConfigFile<br />
setAttributeFailed:<br />
   MessageBox MB_OK &quot;SetAtribute failed for ${KeyName}&quot;<br />
   goto cleanUp<br />
noAppSettings:<br />
   MessageBox MB_OK &quot;XPath not resolved for ${KeyPath}&quot;<br />
   goto cleanUp<br />
saveConfigFile:<br />
  ${xml::SaveFile} ${ConfigFile} $IOResult<br />
valueUnchanged:<br />
  ; Just fall thru and unload<br />
cleanUp:<br />
  ${xml::Unload} ; unload plugin<br />
!macroend<br />
<br />
; Called as follows:<br />
<br />
!insertmacro EditDotNETConfigFile &quot;c:\InetPub\wwwroot\MyWebSite\Web.config&quot; &quot;configuration/appSettings/add&quot; &quot;connectionString&quot; &quot;MyTestConnString1a&quot;<br />
<br />
<br />
P.S. I tried the nsisXML plugin but it wanted to do &quot;extra&quot; things to the tags in the .NET config files, so I came back to this XML plugin and it's what I got to work first.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JDaniels13</div><div class="date">24th August 2006, 22:58</div></div><div class="posttext">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;<br />
&lt;configuration&gt;<br />
    &lt;appSettings&gt;<br />
        &lt;add key=&quot;@CBR_CBRFILE&quot; value=&quot;Initialization.cbr&quot; /&gt;<br />
        &lt;!-- Environment Setup Type should be &quot;PROD&quot; or &quot;DEV&quot; or &quot;QA&quot;  --&gt;<br />
        &lt;add key=&quot;Site.Environment&quot; value=&quot;QA&quot; /&gt;<br />
        &lt;!-- Environment Setup End --&gt;<br />
        &lt;!-- Security Setup --&gt;<br />
        &lt;add key=&quot;ConnectionString&quot; value=&quot;Case sensitive, shouldn't match this&quot; /&gt;<br />
        &lt;!--Socket Setup (used for refund transaction) --&gt;<br />
        &lt;!--add key=&quot;SocketPort&quot; value=&quot;3805&quot; / --&gt;<br />
        &lt;!--add key=&quot;SocketTimeout&quot; value=&quot;30000&quot; / --&gt;<br />
    &lt;/appSettings&gt;<br />
&lt;/configuration&gt;<br />
<br />
So after calling the macro, the file would be like this:<br />
<br />
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;<br />
&lt;configuration&gt;<br />
    &lt;appSettings&gt;<br />
        &lt;add key=&quot;@CBR_CBRFILE&quot; value=&quot;Initialization.cbr&quot; /&gt;<br />
        &lt;!-- Environment Setup Type should be &quot;PROD&quot; or &quot;DEV&quot; or &quot;QA&quot;  --&gt;<br />
        &lt;add key=&quot;Site.Environment&quot; value=&quot;QA&quot; /&gt;<br />
        &lt;!-- Environment Setup End --&gt;<br />
        &lt;!-- Security Setup --&gt;<br />
        &lt;add key=&quot;ConnectionString&quot; value=&quot;Case sensitive, shouldn't match this&quot; /&gt;<br />
        &lt;add key=&quot;connectionString&quot; value=&quot;This is the one that should get matched and changed&quot; /&gt;<br />
        &lt;!--Socket Setup (used for refund transaction) --&gt;<br />
        &lt;!--add key=&quot;SocketPort&quot; value=&quot;3805&quot; / --&gt;<br />
        &lt;!--add key=&quot;SocketTimeout&quot; value=&quot;30000&quot; / --&gt;<br />
    &lt;/appSettings&gt;<br />
&lt;/configuration&gt;<br />
<br />
<br />
The problem with .NET config files is that all the elements in the appsettings section are &quot;&lt;add &quot;, so you have to then navigate through each element looking for the attributes &quot;key&quot;, to find the node you want, and then once you find it, set the &quot;value&quot; attribute for that node.  Thus all the code for navigating within the duplicate-named &quot;&lt;add &quot; elements.<br />
<br />
If someone has an easier way, please share it!  I didn't see an NSIS plugin for .NET config file editing, is there one I missed?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JDaniels13</div><div class="date">24th August 2006, 23:41</div></div><div class="posttext">The thing that the nsisXML has going for it is it supports XPath, including the attribute specs in the XPath query.  I understand there is a Tiny XPath company to TinyXML, but the XPath functionality is not integrated into the XML plugin.<br />
<br />
Here's what I had for the nsisXML plugin version of the .NET 1.1 config file editing macro:<br />
<br />
!macro EditDotNETConfigFile2 ConfigFile KeyXPath KeyName KeyValue<br />
  SetPluginUnload alwaysoff<br />
  nsisXML::create<br />
  nsisXML::load ${ConfigFile}<br />
  nsisXML::select ${KeyXPath} /*  '/main/child[@attrib=&quot;value2&quot;]' */<br />
  IntCmp $2 0 notFound<br />
;  nsisXML::removeChild<br />
  nsisXML::createElement &quot;add&quot;<br />
  nsisXML::setText &quot; &quot;<br />
  nsisXML::appendChild<br />
  nsisXML::getAttribute ${KeyName}<br />
  DetailPrint &quot;Attribute ${KeyName} is $3&quot;<br />
  nsisXML::setAttribute &quot;key&quot; ${KeyName}<br />
  nsisXML::setAttribute &quot;value&quot; ${KeyValue}<br />
   MessageBox MB_OK &quot;attribute set&quot;<br />
  SetPluginUnload manual<br />
  nsisXML::save ${ConfigFile}<br />
  Goto end<br />
notFound:<br />
   MessageBox MB_OK &quot;XPath not resolved&quot;<br />
  DetailPrint &quot;XPath not resolved&quot;<br />
end:<br />
!macroend<br />
<br />
; Called like this:<br />
!insertmacro EditDotNETConfigFile2 &quot;c:\InetPub\wwwroot\MyWebSite\Web2.config&quot; '/configuration/appSettings/add[@key=&quot;connectionString&quot;]' &quot;connectionString&quot; &quot;TestConnString2&quot;<br />
<br />
It was very handy to use XPath to go right to the &quot;&lt;add &quot; element node with the &quot;key= &quot; attribute value I wanted.  Would have saved much of the navigation code I had to write in the (TinyXML-based) XML plugin.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mtyler</div><div class="date">6th September 2006, 18:10</div></div><div class="posttext">If anyone is interested, I have integrated the TinyXPath library with this plugin. It worked like a charm the very first time (surprised the heck out of me). Here are the steps:<br />
<br />
1) Download TinyXPath from <br />
http://tinyxpath.sourceforge.net/ <br />
<br />
2) Compile the TinyXPath LIB according to the instructions here http://tinyxpath.sourceforge.net/doc/index.html <br />
<br />
3) Copy the tinyxpath.lib file along with all the TinyXPath .h (header files), excluding the TinyXML header files, to the XML Plugin source directory.<br />
<br />
4) Add #include &quot;xpath_static.h&quot; to the top of xml.cpp (XML Plugin source file)<br />
<br />
5) Add the following code block to xml.cpp:<br />
<br />
extern &quot;C&quot; void __declspec(dllexport) _GotoXPath(HWND hwndParent, int string_size, <br />
                       char *variables, stack_t **stacktop)<br />
{<br />
	EXDLL_INIT();<br />
	{<br />
		popstring(szBuf);<br />
<br />
		nodeTmp = TinyXPath::XNp_xpath_node(node, szBuf);<br />
		if(nodeTmp)<br />
		{<br />
			node=nodeTmp;<br />
			pushstring(&quot;0&quot;);<br />
			return;<br />
		}<br />
		else<br />
		{<br />
			pushstring(&quot;-1&quot;);<br />
		}<br />
	}<br />
} <br />
<br />
<br />
6) Compile the XML Plugin source to the xml.dll file. Place the new xml.dll file in the NSIS/plugins directory (duh!)<br />
<br />
7) Add the following code block to the XML.nsh file located in the NSIS/include directory:<br />
<br />
<br />
!define xml::GotoXPath `!insertmacro xml::GotoXPath`<br />
<br />
!macro xml::GotoXPath _PATH _ERR<br />
    xml::_GotoXPath /NOUNLOAD `${_PATH}`<br />
    Pop ${_ERR}<br />
!macroend<br />
<br />
<br />
Viola! You're done. Use ${xml::GotoXPath} &quot;path&quot; $errvar in your installer script and the current node gets changed to the first node matching the XPath expression. If I have time, or someone else beats me to it, iterative expression matching could easily be added by storing the XPath state (by using the xpath_processor.h rather than xpath_static.h).<br />
<br />
Ask if you need any help. Let me know if this helps. And thank you &quot;Instructor&quot; for the Xml Plugin (way better than the rest of them)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JDaniels13</div><div class="date">6th September 2006, 18:48</div></div><div class="posttext">Thanks for your efforts!  I'm not very handy with C++ builds; could you post the resulting XML.dll here?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mtyler</div><div class="date">6th September 2006, 19:29</div></div><div class="posttext">This site will not allow me to upload a DLL. I've zipped to see if it will accept it. You will need to modify xml.nsh according to my message.<br />
<br />
Let me know if it works for you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mtyler</div><div class="date">7th September 2006, 01:43</div></div><div class="posttext">PLEASE NOTE:<br />
<br />
I hope that I have not overstepped my bounds by providing a modified version of xml.dll to this forum. The modification is based on the latest code base from &quot;Instructor&quot; and TinyXPath, but there are no promises of accuracy, reliability or safety, expressed or implied. Use at your own risk!<br />
<br />
It would be nice if &quot;Instructor&quot; integrated this addition into the next build of his XML Plugin, giving it full XPath capabilities.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jeichhorn</div><div class="date">8th September 2006, 08:55</div></div><div class="posttext">I am trying to use the ${xml::GotoXPath} command added by mtyler.<br />
<br />
Here is my test.xml:<br />
<br />
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;<br />
&lt;test&gt; <br />
	&lt;c1&gt;content1&lt;/c1&gt;<br />
	&lt;c2&gt; <br />
		&lt;c3&gt;c3_content1&lt;/c3&gt;<br />
		&lt;c3&gt;c3_content2&lt;/c3&gt;<br />
		&lt;c3&gt;c3_content3&lt;/c3&gt;<br />
	&lt;/c2&gt;<br />
&lt;/test&gt;<br />
<br />
<br />
I am trying to select the element /test/c2/c3 with the content 'c2_content2'.<br />
<br />
When i use the xpath <br />
${xml::GotoXPath} &quot;//c3[text()='c3_content2']&quot; $0<br />
the element is selected as expected, but when i use<br />
${xml::GotoXPath} &quot;/test/c2/c3[text()='c3_content2']&quot; $0 <br />
it does not find the element (result is -1).<br />
<br />
Do i use the GotoXPath function in a wrong way in my second example?<br />
<br />
Thanks for help.<br />
<br />
JÃ¶rg</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mtyler</div><div class="date">8th September 2006, 18:01</div></div><div class="posttext">The immediate workaround for your problem is to execute ${xml::RootElement} $1 $0 after loading the document and before conducting any static XPath queries that begin with the root element. Any XPath that is based on the top level element will work, including yours.<br />
<br />
The way the TinyXML works is to have a node above the top level element for the document itself. From this node you can get the document name and access XML comments that are outside the scope of the top level element. The XML plugin maintains it state as the current or last node that was read. This enables you to jump around from a relative perspective. But, from a technical perspective, conducting a static XPath query from the document node will not work.<br />
<br />
I considered modifying the GotoXPath function to account for this, but I think that it will defeat the purpose of the document node. So use the workaround specified above or use the XPath query Descendant notation along with the root element (even though this is not entirely accurate; you should use xml::RootElement):<br />
//test/c2/c3[text()='c3_content2']<br />
<br />
The original GotoPath function looks for a leading slash in the path designation and moves the current node to the root element before it locates the desired element. This works well for this function because it is a simple navigation function. The TinyXPath library is a robust XPath processor that will not benefit from the same logic used by the GotoPath function. Therefore, the suggestions I made above should become the norm.<br />
<br />
As usual, I hope that this has helped. Feel free to ask for assistance. I am appreciative of all the great tools and technologies supported by this community.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">10th September 2006, 14:48</div></div><div class="posttext">Changed: Compiled statically without msvcrt.lib, now plugin work on Win95.<br />
Added: Integrated TinyXPath v1.2.4 (thanks mtyler).<br />
Added: ${xml::XPathString} -compute a string XPath expression.<br />
Added: ${xml::XPathNode} -compute a node XPath expression and goes to it.<br />
Added: ${xml::XPathAttribute} -compute an attribute XPath expression and goes to it.<br />
Added: ${xml::CurrentAttribute} -returns name and value of the current attribute.<br />
Updated: TinyXml to v2.5.1<br />
Updated: StackFunc.h to v2.0<br />
<br />
<br />
&quot;XML&quot; plugin v1.8<br />
<br />
Download from Wiki (http://nsis.sourceforge.net/XML_plug-in)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rtpHarry</div><div class="date">24th November 2006, 11:50</div></div><div class="posttext">I almost abandoned this plugin yesterday when I was writing my installer. Now I have found a work around for it and I think its a great plugin again! ;) <br />
<br />
The problem arose when I tried to open an xml file for the second time. The first time I loaded the file (through a function attached to a custom page) it worked fine with this code (as I see it used in the forums as well):<br />
<br />
<br />
  ${xml::LoadFile} &quot;client-list.xml&quot; $0<br />
 <br />
<br />
The second time I used it was in a Section (for the install files part) and it failed with -1 every time until I saw somebody suggest for a different problem to prepend $EXEDIR to the start which fixed it.<br />
<br />
<br />
${xml::LoadFile} &quot;$EXEDIR\client-list.xml&quot; $8</div></div><hr />


<div class="post"><div class="posttop"><div class="username">atul123</div><div class="date">6th December 2006, 14:02</div></div><div class="posttext">Where can I find examples of &quot;How to use this XML plugin?&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">niklasu</div><div class="date">17th January 2007, 19:47</div></div><div class="posttext">Originally posted by Instructor <br />
Added: ${xml::XPathString} -compute a string XPath expression.<br />
Added: ${xml::XPathNode} -compute a node XPath expression and goes to it.<br />
Added: ${xml::XPathAttribute} -compute an attribute XPath expression and goes to it.<br />
<br />
<br />
I'm trying to use XPathAttribute to change a setting in a web.config file, like this:<br />
<br />
${xml::LoadFile} &quot;$INSTDIR\Web.config&quot; $0<br />
${xml::XPathAttribute} &quot;/configuration/appSettings/add[@key='EPsConnection']&quot; $0<br />
${xml::SetAttribute} &quot;value&quot; &quot;some value&quot; $0<br />
${xml::SaveFile} &quot;$INSTDIR\Web.config&quot; $0<br />
${xml::Unload}<br />
<br />
But everytime the xml:XPathAttribute statement executes the installer crashes with the following message:<br />
<br />
Microsoft Visual C++ Runtime Library<br />
Assertion failed!<br />
<br />
Program: setup.exe<br />
File: tinyxml.cpp<br />
Line: 173<br />
<br />
Expression: node-&gt;GetDocument() == 0 || node-&gt;GetDocument() == this-&gt;GetDocument()<br />
<br />
(And I get the same error when using XPathNode too...)<br />
What am I doing wrong here?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">18th January 2007, 21:38</div></div><div class="posttext">${xml::LoadFile} &quot;$INSTDIRWeb.config&quot; $0<br />
${xml::RootElement} $0 $1<br />
${xml::XPathAttribute} &quot;/configuration/appSettings/add[@key='EPsConnection']&quot; $0<br />
${xml::SetAttribute} &quot;value&quot; &quot;some value&quot; $0<br />
${xml::SaveFile} &quot;$INSTDIRWeb.config&quot; $0<br />
${xml::Unload}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">3rd February 2007, 13:10</div></div><div class="posttext">could you put this on the wiki please?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Commerzpunk</div><div class="date">9th February 2007, 09:53</div></div><div class="posttext">Originally posted by Instructor <br />
1. Not.<br />
2. I'm not plaining this.<br />
<br />
But you can use ${xml::CloneNode}<br />
<br />
<br />
Section<br />
	${xml::LoadFile} &quot;file.xml&quot; $0<br />
	MessageBox MB_OK &quot;xml::LoadFile$\n$$0=$0&quot;<br />
<br />
	${xml::GotoPath} &quot;/&quot; $0<br />
	MessageBox MB_OK &quot;xml::GotoPath$\n$$0=$0&quot;<br />
<br />
	${xml::CloneNode} $R0<br />
	MessageBox MB_OK &quot;xml::CloneNode$\n$$R0=$R0&quot;<br />
<br />
	${xml::Unload}<br />
<br />
<br />
	${xml::LoadFile} &quot;file2.xml&quot; $0<br />
	MessageBox MB_OK &quot;xml::LoadFile$\n$$0=$0&quot;<br />
<br />
	${xml::GotoPath} &quot;/&quot; $0<br />
	MessageBox MB_OK &quot;xml::GotoPath$\n$$0=$0&quot;<br />
<br />
	${xml::InsertBeforeNode} &quot;$R0&quot; $0<br />
	MessageBox MB_OK &quot;xml::InsertBeforeNode$\n$$0=$0&quot;<br />
<br />
	${xml::FreeNode} &quot;$R0&quot; $0<br />
	MessageBox MB_OK &quot;xml::FreeNode$\n$$0=$0&quot;<br />
<br />
	${xml::SaveFile} &quot;file2.xml&quot; $0<br />
	MessageBox MB_OK &quot;xml::SaveFile$\n$$0=$0&quot;<br />
<br />
	${xml::Unload}<br />
SectionEnd<br />
 <br />
<br />
<br />
I really tried hard to get this working for me.<br />
The installer always crashed, when I tried to &quot;InsertBeforeNode&quot;.<br />
<br />
Now, I used this code and changed it, had several hundered crashes.<br />
<br />
Here is the working result (for me):<br />
<br />
<br />
	${xml::LoadFile} &quot;file1.xml&quot; $0<br />
	MessageBox MB_OK &quot;xml::LoadFile$\n$$0=$0&quot;<br />
<br />
	${xml::GotoPath} &quot;Root/I&quot; $0<br />
	MessageBox MB_OK &quot;xml::GotoPath$\n$$0=$0&quot;<br />
<br />
	${xml::CloneNode} $R0<br />
	MessageBox MB_OK &quot;xml::CloneNode$\n$$R0=$R0&quot;<br />
<br />
	${xml::LoadFile} &quot;file2.xml&quot; $0<br />
	MessageBox MB_OK &quot;xml::LoadFile$\n$$0=$0&quot;<br />
	<br />
	${xml::RootElement} $0 $1 # THATS THE SOLUTION FOR NO CRASHING!<br />
	MessageBox MB_OK &quot;xml::RootElement$\n$$0=$0&quot;<br />
	MessageBox MB_OK &quot;xml::RootElement$\n$$1=$1&quot;<br />
	<br />
	${xml::GotoPath} &quot;I&quot; $0<br />
	MessageBox MB_OK &quot;xml::GotoPath$\n$$0=$0&quot;<br />
	<br />
	${xml::InsertBeforeNode} &quot;$R0&quot; $0<br />
	MessageBox MB_OK &quot;xml::InsertBeforeNode$\n$$0=$0&quot;<br />
<br />
	${xml::SaveFile} &quot;file2.xml&quot; $0<br />
	MessageBox MB_OK &quot;xml::SaveFile$\n$$0=$0&quot;<br />
<br />
	${xml::Unload}<br />
<br />
<br />
Messageboxes are for information and debugging only, of course!<br />
<br />
Greets,<br />
<br />
HA</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eafonsof</div><div class="date">10th May 2007, 20:31</div></div><div class="posttext">Hi there, I tried the following commands to modify the attribute named &quot;value&quot;. It's not working as I expected. Does anybody know what's missing or wrong?<br />
Thanks in advance.<br />
<br />
;Format of config file:<br />
;&lt;?xml version=&quot;1.0&quot; encoding=&quot;Windows-1252&quot;?&gt;<br />
;&lt;configuration&gt;<br />
;	&lt;appSettings&gt;<br />
;		&lt;add key=&quot;key1&quot; value=&quot;value1&quot; /&gt;<br />
;		&lt;add key=&quot;key2&quot; value=&quot;value2&quot; /&gt;<br />
;		&lt;add key=&quot;key3&quot; value=&quot;value3&quot; /&gt;<br />
;<br />
;		&lt;!-- Some comments --&gt;<br />
;		&lt;add key=&quot;key4&quot; value=&quot;value4&quot; /&gt;<br />
;	&lt;/appSettings&gt;<br />
;&lt;/configuration&gt;<br />
<br />
${xml::LoadFile} &quot;$configFile&quot; $0<br />
${xml::RootElement} $0 $1<br />
${xml::XPathAttribute} &quot;/configuration/appSettings/add[@key='${KEY4}']&quot; $0<br />
${xml::SetAttribute} &quot;value&quot; &quot;$newValue&quot; $0<br />
${xml::SaveFile} &quot;$configFile&quot; $0<br />
${xml::Unload}<br />
<br />
After this, the attribute &quot;value&quot; is set as an attribute of &quot;&lt;configuration&quot; instead of the corresponding &quot;&lt;add&quot; node.<br />
<br />
i.e.<br />
;<br />
;&lt;?xml version=&quot;1.0&quot; encoding=&quot;Windows-1252&quot;?&gt;<br />
;&lt;configuration value=&quot;new_value4&quot;&gt;<br />
;	&lt;appSettings&gt;<br />
;		&lt;add key=&quot;key1&quot; value=&quot;value1&quot; /&gt;<br />
;		&lt;add key=&quot;key2&quot; value=&quot;value2&quot; /&gt;<br />
;		&lt;add key=&quot;key3&quot; value=&quot;value3&quot; /&gt;<br />
;<br />
;		&lt;!-- Some comments --&gt;<br />
;		&lt;add key=&quot;key4&quot; value=&quot;value4&quot; /&gt;<br />
;	&lt;/appSettings&gt;<br />
;&lt;/configuration&gt;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">18th May 2007, 20:40</div></div><div class="posttext">${xml::LoadFile} &quot;$configFile&quot; $0<br />
${xml::RootElement} $0 $1<br />
${xml::XPathNode} &quot;/configuration/appSettings/add[@key='${KEY4}']&quot; $0<br />
${xml::SetAttribute} &quot;value&quot; &quot;$newValue&quot; $0<br />
${xml::SaveFile} &quot;$configFile&quot; $0<br />
${xml::Unload}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">1st June 2007, 13:14</div></div><div class="posttext">Updated: TinyXml to v2.5.3<br />
Updated: TinyXPath to v1.3.0<br />
<br />
<br />
&quot;XML&quot; plugin v1.9<br />
<br />
Download from Wiki (http://nsis.sourceforge.net/XML_plug-in)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrDan</div><div class="date">4th July 2007, 10:08</div></div><div class="posttext">I'm working on an installer that uses this plug-in. Now, depending on the contents in my XML I need to run an external progam (in fact another NSIS uninstaller) that will read in the XML file and make changes to it.<br />
<br />
The steps I am following are:<br />
<br />
1) Open the XML file in the main installer<br />
2) Manipulate as required<br />
3) Determine if an external uninstaller is required<br />
4) If an external uninstaller is required, then save the XML file, run the external uninstaller, re-load the XML file and carry on.<br />
5) If no external uninstaller is required, carry on.<br />
<br />
My question is, in step 4, should I also unload the XML plug-in (i.e. call ${xml::Unload}) before running the external uninstaller?<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizarth</div><div class="date">10th July 2007, 06:20</div></div><div class="posttext">Edit: Sorry, wrong thread.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">walb07</div><div class="date">20th August 2007, 10:46</div></div><div class="posttext">Hi,<br />
<br />
 I've problems to parse an XML file which contains DTD description between xml header and first root element<br />
<br />
 Method ${xml::RootElement} returns with &quot;-1&quot;. If I change the  &lt;!DOCTYPE ..[]&gt; to a comment &lt;!--DOCTYPE ...[]&gt; which isn't really feasible it will work.<br />
<br />
 It would be helpful to support the DOCTYPE dtag by default.<br />
<br />
example:<br />
<br />
&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;<br />
&lt;!DOCTYPE RootElement [<br />
  &lt;!ELEMENT RootElement (System+)&gt;<br />
  &lt;!ELEMENT System EMPTY&gt;<br />
<br />
  &lt;!ATTLIST RootElement Version CDATA #REQUIRED&gt;<br />
  ...<br />
]&gt;<br />
&lt;RootElement&gt;<br />
 ...<br />
&lt;/RootElement&gt;<br />
<br />
with regards,<br />
 Dierk</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jogijhelumi</div><div class="date">22nd January 2008, 11:09</div></div><div class="posttext">I'm trying to use XPathNode for expressions with namespace i.e. fns: Deployment<br />
, but it fails and return error code -1.<br />
<br />
Is there any trick/workaround to use it in this way.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">FkYkko</div><div class="date">29th January 2008, 16:24</div></div><div class="posttext">Hi I'm wondering if the attached plugin in this thread is the latest version of this plugin? It seems to me that the include file (xml.nsh) differs from the source code regarding some functions? For example, RemoveChild seems to return an error code while the include file and documentation does not specify any variable for this method. The RemoveAllChild function is not implemented in the source but is is availible in the documentation and include file?<br />
Are there any updates regarding this? Maybe set up a simple sourceforge page to be able to update it?<br />
<br />
or is there some other XML plugin which is generally used and better supported? <br />
<br />
p.s. jogijhelumi: tinyxpath.sourceforge.net/ (http://tinyxpath.sourceforge.net/) says that namespaces are not supported yet d.s.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">30th January 2008, 15:31</div></div><div class="posttext">Updated: TinyXPath to v1.3.1<br />
<br />
Fixed: missing &quot;xml::_RemoveAllChild&quot; in DLL.<br />
Fixed: ${xml::RemoveNode} incorrectly documented.<br />
<br />
<br />
&quot;XML&quot; plugin v2.0<br />
<br />
Download from Wiki (http://nsis.sourceforge.net/XML_plug-in)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">FkYkko</div><div class="date">31st January 2008, 08:01</div></div><div class="posttext">Thanks for the quick reply. <br />
As it happens, I still have some problems with this plugin and have changed to nsisXML (by W) which works after some rewrites.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tzzz</div><div class="date">21st March 2008, 16:38</div></div><div class="posttext">Hello,<br />
<br />
It seems to have ben many misunderstanding since the new XML::Xxxx functions were launched:<br />
<br />
<br />
Added: ${xml::XPathString} -compute a string XPath expression.<br />
Added: ${xml::XPathNode} -compute a node XPath expression and goes to it.<br />
Added: ${xml::XPathAttribute} -compute an attribute XPath expression and goes to it.<br />
<br />
<br />
I think that Instructor could get rid of most of them by improving the examples from its documentation:<br />
In particular :<br />
- Use of ${xml::RootElement} $0 $1 seems to fix many issues; please comment its use in XML::XPathNode, XML::XPathAttribute and XML::XPathString functions documentation whenever needed.<br />
- Use of ${xml::XPathNode} &quot;/configuration/components/component[@id='applicationSettings.default']/parameters/dbServerName&quot; $0 is badly documented, i.e.:<br />
. - XPath expression (e.g. &quot;/a/b/@attr&quot;) is documented only for ${xml::XPathAttribute}, not for ${xml::XPathNode} whereas it seems to be afix for many cases.<br />
. - Why is it that one shall use ${xml::XPathnode} prior to use a ${xml::SetAttribute} while logic would say to better use ${xml::XPathAttribute} instead. Instructor provides this kind of fixing but never fully explains why it is this way. Either fix ${xml::XPathAttribute} so that it allows to do what users think it should do, either fix the documentation so that its use is clearer compared to ${xml::XPathNode}.<br />
<br />
Thank you very much for your plugin.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xbarns</div><div class="date">26th March 2008, 12:48</div></div><div class="posttext">Hi all,<br />
<br />
i need to edit a xml structure like this <br />
<br />
<br />
&lt;Configuration<br />
&lt;ConfigModule name=&quot;BlaBla&quot;&gt;<br />
 &lt;/ConfigModule&gt;<br />
 &lt;ConfigModule name=&quot;FirebirdBridge&quot; DefaultConfig=&quot;FALSE&quot;&gt;<br />
    &lt;Section name=&quot;FirebirdBridge&quot; description=&quot;Configuration for Firebird DB Bridge&quot;&gt;<br />
      &lt;Data name=&quot;Host&quot; type=&quot;string&quot;&gt;127.0.0.1&lt;/Data&gt;<br />
      &lt;Data name=&quot;Database&quot; type=&quot;string&quot;&gt;C:\Program Files\Test\Database\Test.FDB&lt;/Data&gt;<br />
      &lt;Data name=&quot;User&quot; type=&quot;string&quot;&gt;User&lt;/Data&gt;<br />
      &lt;Data name=&quot;Password&quot; type=&quot;string&quot;&gt;Password&lt;/Data&gt;<br />
    &lt;/Section&gt;<br />
  &lt;/ConfigModule&gt;<br />
&lt;/Configuration&gt;<br />
<br />
In order to change the &quot;&lt;Data name=&quot;Database&quot; type=&quot;string&quot;&gt;C:\Program Files\Test\Database\Test.FDB&lt;/Data&gt;&quot; is there any other way then looping through the nodes and comparing attributes ?<br />
<br />
i am already looping through the &quot;ConfigModule&quot; Nodes and comparing, is there an easier way?<br />
<br />
Here is the code i have so far:<br />
<br />
<br />
${xml::LoadFile} &quot;$EXEDIR\scMaster.ctf&quot; $0<br />
loop:<br />
${xml::FindNextElement} &quot;ConfigModule&quot; $0 $1<br />
${xml::ElementPath} $0<br />
${xml::GetAttribute} &quot;name&quot; $1 $2 <br />
<br />
${IF} $1 == &quot;FirebirdBridge&quot;<br />
        <br />
    ${xml::GotoPath} &quot;$0/Section/Data&quot; $1<br />
<br />
	Loop here again ?<br />
         <br />
         <br />
${ELSE}<br />
        Goto loop        <br />
${ENDIF}<br />
<br />
${xml::FindCloseElement}<br />
${xml::SaveFile} &quot;$EXEDIR\scMaster2.ctf&quot; $0<br />
${xml::Unload}<br />
<br />
<br />
<br />
<br />
Thanks for helping :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">freeDB_man</div><div class="date">26th April 2008, 14:05</div></div><div class="posttext">I tried to use this plug-in with the special build of NSIS that has a string length limitation of 8192 instead of 1024 but the plug-in is indifferent to the change and only reads 1024 chars.<br />
<br />
Any workaround?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">spitze</div><div class="date">11th June 2008, 08:46</div></div><div class="posttext">Hi all,<br />
first of all great plugin. But i have a problem which i cannot solve.<br />
I want to insert a line in an XML file.<br />
<br />
The XML file looks like:<br />
<br />
<br />
<br />
&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot; standalone=&quot;no&quot;?&gt;<br />
&lt;adtf:configuration xmlns:adtv=&quot;adtv&quot;&gt;<br />
    &lt;general_settings&gt;<br />
        &lt;property name=&quot;gui_refresh_rate&quot; value=&quot;25&quot;/&gt;<br />
    &lt;/general_settings&gt;<br />
    &lt;module_directories&gt;<br />
    &lt;/module_directories&gt;<br />
    &lt;template_directories/&gt;<br />
&lt;/adtf:configuration&gt;<br />
<br />
<br />
Now i want to insert:<br />
<br />
<br />
        &lt;directory path=&quot;C:\program files\Test&quot;/&gt;<br />
<br />
<br />
between<br />
<br />
<br />
&lt;module_directories&gt;<br />
&lt;/module_directories&gt;<br />
<br />
<br />
<br />
I tried this piece of code<br />
<br />
<br />
${xml::FindNextElement} &quot;module_directories&quot; $0 $1<br />
${xml::CreateNode} '&lt;directory path=&quot;C:\program files\Test&quot;/&gt;' $4<br />
${xml::InsertAfterNode} $4 $5<br />
<br />
<br />
The Output is:<br />
<br />
<br />
&lt;module_directories /&gt;<br />
&lt;directory path=&quot;C:\program files\Test&quot;/&gt;<br />
<br />
<br />
but it should be:<br />
<br />
<br />
&lt;module_directories&gt;<br />
  &lt;directory path=&quot;C:\program files\Test&quot;/&gt;<br />
&lt;/module_directories&gt;<br />
<br />
<br />
Any suggestions??<br />
Thanx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">11th June 2008, 10:28</div></div><div class="posttext">${xml::FindNextElement} &quot;module_directories&quot; $0 $1 <br />
${xml::CreateNode} '&lt;directory path=&quot;C:program filesTest&quot;/&gt;' $4 <br />
${xml::InsertEndChild} $4 $5</div></div><hr />


<div class="post"><div class="posttop"><div class="username">radorl</div><div class="date">27th December 2008, 12:11</div></div><div class="posttext">I'm editing XML file which uses ***DDDD; notation for non-ASCII characters. I noticed that after saving of modified XML file all ***DDDD; characters were replaced by original two-byte UTF-8 codes.<br />
<br />
Is there some way how to instruct this wonderful plugin to use ***DDDD; notation?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">casioclave</div><div class="date">20th March 2009, 08:36</div></div><div class="posttext">Hi. Can U help me to change value in this stiring &lt;value&gt;en&lt;/value&gt;  from &quot;en&quot; to &quot;ru&quot; <br />
<br />
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;<br />
&lt;configuration&gt;<br />
    &lt;configSections&gt;<br />
        &lt;sectionGroup name=&quot;userSettings&quot; type=&quot;System.Configuration.UserSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot; &gt;<br />
            &lt;section name=&quot;inVisit.Properties.Settings&quot; type=&quot;System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot; allowExeDefinition=&quot;MachineToLocalUser&quot; requirePermission=&quot;false&quot; /&gt;<br />
        &lt;/sectionGroup&gt;<br />
    &lt;/configSections&gt;<br />
    &lt;connectionStrings&gt;<br />
        &lt;clear /&gt;<br />
        &lt;add name=&quot;LocalSqlServer&quot; connectionString=&quot;data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;User Instance=true&quot;<br />
            providerName=&quot;System.Data.SqlClient&quot; /&gt;<br />
        &lt;add name=&quot;inVisit.Properties.Settings.ivConnection&quot; connectionString=&quot;Data Source=.\sqlexpress;AttachDbFilename=;Initial Catalog=ivData;Integrated Security=True;Connect Timeout=30&quot;<br />
            providerName=&quot;&quot; /&gt;<br />
    &lt;/connectionStrings&gt;<br />
    &lt;userSettings&gt;<br />
        &lt;inVisit.Properties.Settings&gt;<br />
            &lt;setting name=&quot;WinFormState&quot; serializeAs=&quot;String&quot;&gt;<br />
                &lt;value&gt;Normal&lt;/value&gt;<br />
            &lt;/setting&gt;<br />
            &lt;setting name=&quot;WinFormSize&quot; serializeAs=&quot;String&quot;&gt;<br />
                &lt;value&gt;800, 600&lt;/value&gt;<br />
            &lt;/setting&gt;<br />
           ...<br />
            &lt;setting name=&quot;Language&quot; serializeAs=&quot;String&quot;&gt;<br />
                &lt;value&gt;en&lt;/value&gt;<br />
&lt;/setting&gt;<br />
&lt;setting name=&quot;AutoCheckOut&quot; serializeAs=&quot;String&quot;&gt;<br />
                &lt;value&gt;False&lt;/value&gt;<br />
            &lt;/setting&gt;<br />
            <br />
    &lt;/userSettings&gt;<br />
&lt;/configuration&gt;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mattm591</div><div class="date">26th May 2009, 15:03</div></div><div class="posttext">I am trying to use this plugin to get values from an XML structure.<br />
<br />
The document looks something like this:<br />
<br />
&lt;xml&gt;<br />
  &lt;groups&gt;<br />
    &lt;group id=&quot;1&quot;&gt;<br />
      &lt;name&gt;Group 1&lt;/name&gt;<br />
    &lt;/group&gt;<br />
    &lt;group id=&quot;2&quot;&gt;<br />
      &lt;name&gt;Group 2&lt;/name&gt;<br />
    &lt;/group&gt;<br />
    &lt;group id=&quot;3&quot;&gt;<br />
      &lt;name&gt;Group 3&lt;/name&gt;<br />
    &lt;/group&gt;<br />
  &lt;/groups&gt;<br />
&lt;/xml&gt;<br />
<br />
I want to get the values of id and name and am currently working on getting value. After loading the document I can get the value of the first group (id 1) by doing this,<br />
${xml::GotoPath} &quot;/xml/groups/group&quot; $0<br />
${xml::GetAttribute} &quot;id&quot; $0 $1<br />
but I cannot get any others.<br />
<br />
The code I am trying uses {xml::NextAttribute} and no matter what I do I alway get -1 returned for $2 and $0 and $1 are null. I originally tried it like this to get the loop, but it doesn't work even if I only run it once.<br />
${xml::NextAttribute} $0 $1 $2<br />
${While} $2 != -1<br />
  ${xml::NextAttribute} $0 $1 $2<br />
  MessageBox MB_OK $0<br />
${EndWhile}<br />
<br />
Can anyone please tell me what I'm doing wrong and how I can access these values.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mattm591</div><div class="date">27th May 2009, 15:37</div></div><div class="posttext">Ok I have managed to get it working.<br />
<br />
For anyone else with a similar issue here is what I did. (I used LastChild and PreviousSibling because I wanted to get the xml in reverse, replace with FirstChild and NextSibling to go through in order). Also, I make use of LogicLib which you will need to include if you're copying this example.<br />
<br />
${xml::GotoPath} &quot;/xml/groups&quot; $0<br />
${xml::LastChild} &quot;group&quot; $1 $0<br />
<br />
${While} $0 == 0<br />
<br />
  #get the group id<br />
  ${xml::GetAttribute} &quot;id&quot; $1 $3<br />
<br />
  #get the group name<br />
  ${xml::FirstChildElement} &quot;name&quot; $3 $4<br />
  ${xml::GetText} $2 $3<br />
<br />
  #move to next group<br />
  ${xml::Parent} $3 $4<br />
  ${xml::PreviousSibling} &quot;group&quot; $1 $0<br />
<br />
${EndWhile}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sag47</div><div class="date">18th October 2009, 23:26</div></div><div class="posttext">Here is a nice small example of using this plugin.  In my installer header I included XML.nsh.<br />
<br />
include &quot;XML.nsh&quot;<br />
<br />
Here is a sample XML file that you should extract to the temp folder ($TEMP).<br />
<br />
&lt;?xml version='1.0' encoding='UTF-8' ?&gt;<br />
<br />
&lt;account version='1.0'&gt;<br />
	&lt;account&gt;<br />
		&lt;protocol&gt;prpl-jabber&lt;/protocol&gt;<br />
		&lt;name&gt;&lt;/name&gt;<br />
		&lt;settings&gt;<br />
			&lt;setting name='use-global-buddyicon' type='bool'&gt;1&lt;/setting&gt;<br />
			&lt;setting name='require_tls' type='bool'&gt;1&lt;/setting&gt;<br />
			&lt;setting name='ft_proxies' type='string'&gt;gtalk.google.com:7777&lt;/setting&gt;<br />
			&lt;setting name='check-mail' type='bool'&gt;0&lt;/setting&gt;<br />
			&lt;setting name='connect_server' type='string'&gt;gtalk.google.com&lt;/setting&gt;<br />
			&lt;setting name='old_ssl' type='bool'&gt;0&lt;/setting&gt;<br />
			&lt;setting name='auth_plain_in_clear' type='bool'&gt;0&lt;/setting&gt;<br />
			&lt;setting name='buddy_icon_timestamp' type='int'&gt;0&lt;/setting&gt;<br />
			&lt;setting name='port' type='int'&gt;443&lt;/setting&gt;<br />
			&lt;setting name='custom_smileys' type='bool'&gt;1&lt;/setting&gt;<br />
		&lt;/settings&gt;<br />
		&lt;settings ui='gtk-gaim'&gt;<br />
			&lt;setting name='auto-login' type='bool'&gt;1&lt;/setting&gt;<br />
		&lt;/settings&gt;<br />
	&lt;/account&gt;<br />
&lt;/account&gt;<br />
<br />
Basically what I wanted to do in the XML file above was to set text inside of the &lt;name&gt;&lt;/name&gt; XML node to text that is dependent on user options in my installer.  Here's my NSIS code that I use to modify the above XML:<br />
  ${xml::LoadFile} &quot;$TEMP\\accounts.xml&quot; $0<br />
  IntCmp $0 0 +2 +1 +2<br />
  MessageBox MB_OK|MB_ICONSTOP &quot;Error loading accounts.xml!&quot;<br />
  ${xml::RootElement} $1 $0<br />
  ${xml::FirstChildElement} &quot;&quot; $1 $0<br />
  ${xml::FirstChildElement} &quot;name&quot; $1 $0<br />
  DetailPrint &quot;Setting sam@gtalk.google.com/Home&quot;<br />
  ${xml::SetText} &quot;sam@gtalk.google.com/Home&quot; $0<br />
  IntCmp $0 0 +2 +1 +2<br />
  MessageBox MB_OK|MB_ICONSTOP &quot;Error setting username!&quot;<br />
  ${xml::SaveFile} &quot;&quot; $0<br />
  IntCmp $0 0 +2 +1 +2<br />
  MessageBox MB_OK|MB_ICONSTOP &quot;Error saving accounts.xml!&quot;<br />
  ${xml::Unload}<br />
<br />
Commands above explained...<br />
[list=1]<br />
 ${xml::LoadFile} &quot;$TEMP\accounts.xml&quot; $0 loads my XML file to be modified.<br />
 ${xml::RootElement} $1 $0 selects the root node &lt;account version='1.0'&gt;<br />
 ${xml::FirstChildElement} &quot;&quot; $1 $0 selects the first childnode located in the root node (which happens to be &lt;account&gt;).  No argument means select the first childnode no matter what its name is.<br />
 ${xml::FirstChildElement} &quot;name&quot; $1 $0 selects the first childnode within the node accounts &gt; accounts that has the name &quot;name&quot; or &lt;name&gt;&lt;/name&gt;.<br />
 ${xml::SetText} &quot;sam@gtalk.google.com/Home&quot; $0 sets the text inside of &lt;name&gt;&lt;/name&gt; so the result is &lt;name&gt;sam@gtalk.google.com/Home&lt;/name&gt;<br />
 ${xml::SaveFile} &quot;&quot; $0 saves changes that I've made to my XML file.  No argument means save to the same file that was originally opened<br />
 ${xml::Unload} unloads the XML plugin since I'm done modifying my XML file.<br />
 If you're wondering about IntCmp (http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.4.13) $0 0 +2 +1 +2, $0 is the error code returned by the given XML command.  IntCmp compares the integer variable $0 with the integer 0 (zero).  If $0 is equal to 0 then go down +2 commands (skipping the error message).  If $0 is less than 0 then go down +1 command (show the error message).  If $0 is greater than 0 then go down +2 commands (skip the error message).  Skipping commands (http://nsis.sourceforge.net/Docs/Chapter4.html#4.4)  like that ignores comments.<br />
[/list=1]<br />
<br />
Here is what my XML file looks like after being modified...<br />
&lt;?xml version='1.0' encoding='UTF-8' ?&gt;<br />
<br />
&lt;account version='1.0'&gt;<br />
	&lt;account&gt;<br />
		&lt;protocol&gt;prpl-jabber&lt;/protocol&gt;<br />
		&lt;name&gt;sam@gtalk.google.com/Home&lt;/name&gt;<br />
		&lt;settings&gt;<br />
			&lt;setting name='use-global-buddyicon' type='bool'&gt;1&lt;/setting&gt;<br />
			&lt;setting name='require_tls' type='bool'&gt;1&lt;/setting&gt;<br />
			&lt;setting name='ft_proxies' type='string'&gt;gtalk.google.com:7777&lt;/setting&gt;<br />
			&lt;setting name='check-mail' type='bool'&gt;0&lt;/setting&gt;<br />
			&lt;setting name='connect_server' type='string'&gt;gtalk.google.com&lt;/setting&gt;<br />
			&lt;setting name='old_ssl' type='bool'&gt;0&lt;/setting&gt;<br />
			&lt;setting name='auth_plain_in_clear' type='bool'&gt;0&lt;/setting&gt;<br />
			&lt;setting name='buddy_icon_timestamp' type='int'&gt;0&lt;/setting&gt;<br />
			&lt;setting name='port' type='int'&gt;443&lt;/setting&gt;<br />
			&lt;setting name='custom_smileys' type='bool'&gt;1&lt;/setting&gt;<br />
		&lt;/settings&gt;<br />
		&lt;settings ui='gtk-gaim'&gt;<br />
			&lt;setting name='auto-login' type='bool'&gt;1&lt;/setting&gt;<br />
		&lt;/settings&gt;<br />
	&lt;/account&gt;<br />
&lt;/account&gt;<br />
<br />
Note: I changed XML values from my actual installer for the sake of this quick example to help get others started.  So I would ignore the actual content because it has no use at all.<br />
<br />
It took only a couple of minutes of reading the documentation that came with the XML plugin for NSIS that I created the above functions.  So read the documentation for a better explanation of all of the capabilities possible with this wonderful plugin.<br />
<br />
Sam Gleske</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ChocJunkie</div><div class="date">9th November 2009, 10:31</div></div><div class="posttext">What's the difference between using ${FirstChildElement} &quot;name&quot; $var1 $var2 and ${FirstChild} &quot;name&quot; $var1 $var2 for getting a element child? Especially, I'm interested what ${FirstChildElement} exists for, if the task can be done using ${FistChild}. A child can only be of type text or element. So that ${FirstChild} &quot;Name&quot; does search for a element child, doesn't it?<br />
<br />
Thanks :)<br />
<br />
CJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ChocJunkie</div><div class="date">25th November 2009, 10:46</div></div><div class="posttext">It think the plugin is missing a flug that declares the XML.nsh as already included!?<br />
<br />
CJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">phungus420</div><div class="date">18th December 2009, 16:25</div></div><div class="posttext">I'm not a programmer by trade and cannot figure out how to do what I need to do.  As background I have an installer for a video game mod, however it only works if the user has patched the game, and it's a frequent issue where users don't patch and then complain that the mod causes a crash.  I wanted to have the installer abort if the game isn't patched, and used a registry check, which works fine for 90% of users.  Unfortunately a certain distributer (STEAM) does not sign a version key to their registry, so I can't check the version number using the registry for steam users.  Also the script is a bit overly complex with all the various registry checks it needs to do anyway.<br />
<br />
There is a simpler way, the game has an XML document that contains the version number.  I tried to use the text reading function by Stu, but it fails, I assume because it's an XML file and not a text document.  So looking around I found this plug in.  Common sense would show that this plug in can be used to do what I want, unfortunately I can not figure out how to use it.<br />
<br />
Basically I want to open up an XML file, I know how to get NSIS to find the file on the user's computer.  Then I want to open it, go to line 10, and read what's there and return true if it's version is 319 and false if not.  The specific XML tag is this:<br />
	&lt;Define&gt;<br />
		&lt;DefineName&gt;CIV4_VERSION&lt;/DefineName&gt;<br />
		&lt;iDefineIntVal&gt;319&lt;/iDefineIntVal&gt;<br />
	&lt;/Define&gt;<br />
The iDefineIntVal is on line 10, and will always be on line 10.  This is why this method would be superior to the registry check I'm currently using (which fails for some users).<br />
<br />
Does anyone know how to read this, and get a true/false (or 1/0 etc) response if it's what it should be?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">msroboto</div><div class="date">18th December 2009, 19:11</div></div><div class="posttext">nsisXML::select /NOUNLOAD '/Define/iDefineIntVal'<br />
${If} $1 != &quot;0&quot;<br />
  nsisXML::getText /NOUNLOAD<br />
  ;the result should be in $3<br />
  ${If} $3 == &quot;319&quot;<br />
    ;do what you want<br />
  ${Endif}<br />
${Endif}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">phungus420</div><div class="date">18th December 2009, 19:48</div></div><div class="posttext">Originally posted by msroboto <br />
nsisXML::select /NOUNLOAD '/Define/iDefineIntVal'<br />
${If} $1 != &quot;0&quot;<br />
  nsisXML::getText /NOUNLOAD<br />
  ;the result should be in $3<br />
  ${If} $3 == &quot;319&quot;<br />
    ;do what you want<br />
  ${Endif}<br />
${Endif} <br />
<br />
Thanks for the response and help.  But I can't figure this out.  Where am I defining the file I am loading from?  Also the whole document is iDefineIntVal tags like the above, I need it to read specifically the one on line 10, or the one that the XML is defining as CIV4_VERSION.  As an example here is a snippet of the XML file:<br />
<br />
	&lt;Define&gt;<br />
		&lt;DefineName&gt;CIV4_VERSION&lt;/DefineName&gt;<br />
		&lt;iDefineIntVal&gt;319&lt;/iDefineIntVal&gt;<br />
	&lt;/Define&gt;<br />
	&lt;Define&gt;<br />
		&lt;DefineName&gt;MIN_VERSION&lt;/DefineName&gt;<br />
		&lt;iDefineIntVal&gt;000&lt;/iDefineIntVal&gt;<br />
	&lt;/Define&gt;<br />
	&lt;Define&gt;<br />
		&lt;DefineName&gt;SAVE_VERSION&lt;/DefineName&gt;<br />
		&lt;iDefineIntVal&gt;302&lt;/iDefineIntVal&gt;<br />
	&lt;/Define&gt;<br />
...<br />
Obviously I just want the CIV4_VERSION tag.  So how do I:<br />
1)define the XML file I'm reading this from (this file is on the User's computer, and I set the path off of the install directory; I can run a check for if the file exists easily, so defining it is easy, I just don't understand how to pass that to the XML NSIS function here)<br />
2)Define which tag to read</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ChocJunkie</div><div class="date">7th January 2010, 10:13</div></div><div class="posttext">I have a problem in understanding the xml::unload function. What exactly does it do?<br />
Does it unload the plugin or the loaded xml file?<br />
If it unloads the plugin, how can I unload the loaded file?<br />
<br />
Thanks. :)<br />
<br />
CJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">7th January 2010, 15:27</div></div><div class="posttext">From the XML plugin documentation${xml::Unload}<br />
Unload plugin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ChocJunkie</div><div class="date">7th January 2010, 16:08</div></div><div class="posttext">If it unloads the plugin, how can I unload the loaded file?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">7th January 2010, 16:20</div></div><div class="posttext">Why do you want to &quot;unload&quot; the file?<br />
<br />
If you have used the XML plugin to modify the file then use the plugin's &quot;SaveFile&quot; command.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ChocJunkie</div><div class="date">8th January 2010, 08:05</div></div><div class="posttext">I just want to read the file, I don't need it to be in memory any more, if I've got what I was looking for. So I would like to erase/unload the file from the memory.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xbarns</div><div class="date">25th January 2010, 14:23</div></div><div class="posttext">Hi all,<br />
<br />
i am trying to use the plugin with the Unicode Version of NSIS but it won't even open the file correctly.<br />
<br />
Am i just stupid or does it not work correctly with Unicode NSIS? (2.45)<br />
<br />
I use the following script to test....<br />
<br />
<br />
Name TestSetupSmall<br />
		<br />
OutFile TestSetupSmall.exe<br />
;Request application privileges for Windows Vista<br />
RequestExecutionLevel highest    <br />
 <br />
!include &quot;XML.nsh&quot;<br />
<br />
ShowInstDetails Show<br />
<br />
Page Instfiles<br />
<br />
Function .onInit<br />
    InitPluginsDir<br />
FunctionEnd<br />
<br />
<br />
Section TEST<br />
<br />
	SetOutPath $TEMP<br />
	File test.xml<br />
	<br />
	${xml::LoadFile} &quot;$TEMP\test.xml&quot; $0 <br />
	<br />
	DetailPrint &quot;-$0-&quot;<br />
	<br />
	<br />
SectionEnd<br />
<br />
<br />
The provided example does not work either.<br />
<br />
Any help would be much appreciated.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">garygumdrops</div><div class="date">17th February 2010, 00:25</div></div><div class="posttext">I think there is a bug with elements with blank text when the XML doc is saved:<br />
<br />
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;<br />
&lt;Settings&gt;<br />
  &lt;Setting1&gt;hello&lt;/Setting1&gt;<br />
  &lt;Setting2&gt;&lt;/Setting2&gt;<br />
&lt;/Settings&gt;<br />
<br />
if you save this using ${xml::save}<br />
you'll see that the last element is not what it should be and appear as:<br />
&lt;Setting2 /&gt;<br />
when it should be:<br />
&lt;Setting2&gt;&lt;/Setting2&gt;<br />
<br />
Everything is good if the element has any text inside it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">17th February 2010, 00:48</div></div><div class="posttext">To an XML parser, the elements &lt;sample/&gt; and &lt;sample&gt;&lt;/sample&gt; are the sameâ€”they're both empty sample elements.<br />
<br />
See Extensible Markup Language (XML) 1.0 (Fifth Edition):<br />
http://www.w3.org/TR/REC-xml/#dt-empty</div></div><hr />


<div class="post"><div class="posttop"><div class="username">garygumdrops</div><div class="date">17th February 2010, 00:52</div></div><div class="posttext">Oh yes I see now, thanks for pointing that out :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gringoloco023</div><div class="date">14th July 2010, 08:57</div></div><div class="posttext">FYI:<br />
<br />
xml::_Coordinate isn't pushing an error/success value<br />
So the macro, ${xml::Coordinate}, pops one to many !<br />
<br />
BTW: great plug-in, anything else seems to work fine, and MSXML.dll independent :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">guineapig</div><div class="date">19th August 2010, 14:24</div></div><div class="posttext">Hi all,<br />
I'm trying to use the xml plugin with nsis unicode v2.46 but it does not work.<br />
The plugin does not load the xml file and return error code is an unknown char (the classic square char). Before spending too much time on it, I would like to know if there are some known compatibility issue.<br />
<br />
thank you very much</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gringoloco023</div><div class="date">19th August 2010, 17:35</div></div><div class="posttext">try the NsisXML plug-in by Wizou, although it works great and also works with utf-16 xml files, it is msxml.dll depended !<br />
<br />
Another possibility which I personally am very happy with is calling the Xml plug-in from instructor with a special header file for unicode nsis. but utf-16 files are not supported (alternatively they could be re-encoded to utf-8 and back again)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">guineapig</div><div class="date">23rd August 2010, 15:59</div></div><div class="posttext">it works...<br />
thank you very much...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ssamuels_sv</div><div class="date">11th February 2011, 21:50</div></div><div class="posttext">I'm curious if anyone knows how to link this plug-in with a file that is hosted on a server.  I know that the plug-in can read a file locally, but it would be helpful in my application to read the file remotely rather than have to distribute the file along with the installer.  I want to use a generic installer and have it go grab the information that it needs.<br />
<br />
Or does anyone know of another plug-in that will simply grab a remote file so that this plug-in can parse the XML tree?<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th February 2011, 22:24</div></div><div class="posttext">NSISdl or InetC<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ssamuels_sv</div><div class="date">11th February 2011, 23:09</div></div><div class="posttext">Thank you.  I just figured that out and was going to say, never mind. Thanks for the quick reply.  I tried inetc, but I'll take a look at NSISdl as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">loyalp</div><div class="date">11th May 2011, 18:49</div></div><div class="posttext">I've just started using this plugin, and so far have it doing everything I need for inserting some new lines in a web.config file.  I do not see to be able to figure out how to get a new comment inserted, however.<br />
<br />
xml file is setup like:<br />
<br />
&lt;?xml version=&quot;1.0&quot; ?&gt;<br />
&lt;configuration&gt;<br />
    &lt;appSettings&gt;<br />
        &lt;add key=&quot;LogLevel&quot; value=&quot;4&quot; /&gt;<br />
    &lt;/appSettings&gt;<br />
&lt;/configuration&gt;<br />
<br />
I'm adding several new &lt;add key=  statements, but would also like to insert a comment at the same level.<br />
<br />
Final product would be:<br />
<br />
&lt;?xml version=&quot;1.0&quot; ?&gt;<br />
&lt;configuration&gt;<br />
    &lt;appSettings&gt;<br />
        &lt;!--Some Comment--&gt;<br />
        &lt;add key=&quot;LogLevel&quot; value=&quot;4&quot; /&gt;<br />
        &lt;add key=&quot;something&quot; value=&quot;&quot; /&gt;<br />
        &lt;add key=&quot;something&quot; value=&quot;&quot; /&gt;<br />
        &lt;add key=&quot;something&quot; value=&quot;&quot; /&gt;<br />
        &lt;add key=&quot;something&quot; value=&quot;&quot; /&gt;<br />
    &lt;/appSettings&gt;<br />
&lt;/configuration&gt;<br />
<br />
I've tried:<br />
<br />
<br />
		${xml::LoadFile} &quot;$INSTDIR\Web.config&quot; $0<br />
		${xml::RootElement} $0 $1<br />
		${xml::XPathNode} &quot;/configuration/appSettings&quot; $0<br />
		${xml::CreateNode} &quot;&lt;'!-- Some Comment--'/&gt;&quot; $4<br />
		${xml::InsertEndChild} $4 $5<br />
<br />
<br />
<br />
and also ${xml::CreateNode} &quot;&lt;'!-- Some Comment--'/&gt;&quot; $4.<br />
<br />
What am I missing here?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fefer</div><div class="date">5th December 2011, 09:25</div></div><div class="posttext">I create Installer that load xml file and read the node value<br />
<br />
I stop the installer running, I change the xml file node value and I run the Installer again<br />
<br />
at the second time the installer shows me that the value didn't change, and when I run oit again it's show me the value changed<br />
<br />
Way the istaller show me the prev value?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">5th December 2011, 10:40</div></div><div class="posttext">The XML file is packed inside installer or not?<br />
Maybe other process/application  is working with this file too?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gretty</div><div class="date">13th August 2012, 03:52</div></div><div class="posttext">I am attempting to add a large XML element to an existing XML file but it keeps failing to add the new node. What do you think is going wrong?<br />
<br />
I've tried making the XML element smaller(reducing OVERRIDES_TEXT) and that allows me to successfully add the new element/node to the XML file. But I need all the text(xml) in OVERRIDES_TEXT to be added to the element(I cant remove any of it).<br />
<br />
Any ideas on how I could achieve this?<br />
<br />
<br />
${xml::LoadFile} &quot;${xmlFileName}&quot; $R0<br />
${xml::GotoPath} &quot;${elementPath}&quot; $R0<br />
${xml::CreateNode} '&lt;Overrides&gt;${OVERRIDES_TEXT}&lt;/Overrides&gt;' $R0<br />
${xml::InsertAfterNode} $R0 $R1  # always fails here $R1 = -1<br />
<br />
# below is the string that causes the error<br />
!define OVERRIDES_TEXT &quot;&lt;Override&gt;\<br />
                &lt;Key&gt;EXDS_CUSTOMISATION_REVISION&lt;/Key&gt;\<br />
                &lt;Value&gt;1&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;CUSTOMER_USER_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;C:\12d\10.00\Customers\EXDS_Customisation\EXDS_User&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;CUSTOMER_LIB_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;C:\12d\10.00\Customers\EXDS_Customisation\EXDS_User_Lib&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;USER_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;C:\12d\10.00\User&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;USER_LIB_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;C:\12d\10.00\User_Lib&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;EXDS_USER_LIB&lt;/Key&gt;\<br />
                &lt;Value&gt;&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;EXDS_USER&lt;/Key&gt;\<br />
                &lt;Value&gt;&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;VERSION_12D_MODEL&lt;/Key&gt;\<br />
                &lt;Value&gt;10.0&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;CPATH&lt;/Key&gt;\<br />
                &lt;Value&gt;$$CUSTOMER_LIB_4D:$$CUSTOMER_USER_4D:$$USER_LIB_4D:$$USER_4D:$$LIB_4D:$$SET_UPS_4D&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;AUTHORIZATION_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;C:\12d\10.00\nodes.4d&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;USE_NAMES_COMMENT_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;1&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;FILE_READ_ADD_TO_VIEW_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;1&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;GENIO_WILDCARD_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;*.inp&lt;/Value&gt;\<br />
                &lt;State&gt;1&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;RUN_MACROS_FILE_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;$$USER\macros.4d&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;PROJECT_DETAILS_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;$$USER\project_details.dtl&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;REPORT_HEADER_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;1&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;AUTO_TIN_SYNC_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;1&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;AUTO_MODEL_SYNC_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;1&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;SHARE_CHECK_INTERVAL_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;300&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;SHARED_ELEMENT_COLOUR_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;blue&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;SHARING_ELEMENT_COLOUR_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;red&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;DEFAULT_PLAN_PLOT_SCALE_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;500&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;DWG_PLOT_SEED_FILE_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;$$USER\EXDS_Acad_Plot_Template.dwt&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;DEFAULT_RASTER_DPI_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;600&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;OPENGL_VIEW_BACKING_STORE_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;2&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;MULTI_LINE_TEXT_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;1&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;NEW_MTF_EDITOR_AUTOPAN_DEFAULT_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;1&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;WINDOWS_VEHICLE_PATH_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;C:\Apps\VPath&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;chainage_equality_4d&lt;/Key&gt;\<br />
                &lt;Value&gt;1&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;XML_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;1&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;\<br />
            &lt;Override&gt;\<br />
                &lt;Key&gt;USE_V10_BOXING_CALCS_4D&lt;/Key&gt;\<br />
                &lt;Value&gt;1&lt;/Value&gt;\<br />
                &lt;State&gt;0&lt;/State&gt;\<br />
            &lt;/Override&gt;&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">13th August 2012, 06:31</div></div><div class="posttext">Please don't paste such huge amounts of text in a post - use either an attachment or pastebin.<br />
<br />
Your problem is probably that the string you're trying to write is much bigger than ${NSIS_MAX_STRLEN}. The default NSIS builds have a max length of 1024 bytes. There is also a large string build of NSIS which supports op to 8192 bytes. But I don't think you're using the xml plugin properly. I've never used it myself, but what you're doing is telling it to write a single, huge textline &quot;&lt;Override&gt;&lt;Key&gt;EXDS_CUSTOMISATION_REVISION&lt;/Key&gt;&lt;Value&gt;1&lt;/Value&gt;&lt;State&gt;0&lt;/State&gt;&lt;/Override&gt;&lt;Override&gt;&lt;Key&gt;CUSTOMER_USER_4D&lt;/Key&gt;&lt;Value&gt;C:\12d\10.00\Customers\EXDS_Customisation\EXDS_User&lt;/Value&gt;&quot; etcetc. You could use FileWrite for that, so I doubt that's how the XML plugin is supposed to be used.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dacode</div><div class="date">17th August 2012, 18:09</div></div><div class="posttext">@Instructor - <br />
<br />
I would like to use this XML plugin as well as the Registry plugin by instructor, however, I do not see any license. <br />
<br />
Are all NSIS plugins licensed under the NSIS license?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PoRtAbLe_StEaLtH</div><div class="date">6th January 2013, 06:29</div></div><div class="posttext">Hi all,<br />
<br />
i need to edit a xml structure like this <br />
<br />
<br />
&lt;Configuration<br />
&lt;ConfigModule name=&quot;BlaBla&quot;&gt;<br />
 &lt;/ConfigModule&gt;<br />
 &lt;ConfigModule name=&quot;FirebirdBridge&quot; DefaultConfig=&quot;FALSE&quot;&gt;<br />
    &lt;Section name=&quot;FirebirdBridge&quot; description=&quot;Configuration for Firebird DB Bridge&quot;&gt;<br />
      &lt;Data name=&quot;Host&quot; type=&quot;string&quot;&gt;127.0.0.1&lt;/Data&gt;<br />
      &lt;Data name=&quot;Database&quot; type=&quot;string&quot;&gt;C:\Program Files\Test\Database\Test.FDB&lt;/Data&gt;<br />
      &lt;Data name=&quot;User&quot; type=&quot;string&quot;&gt;User&lt;/Data&gt;<br />
      &lt;Data name=&quot;Password&quot; type=&quot;string&quot;&gt;Password&lt;/Data&gt;<br />
    &lt;/Section&gt;<br />
  &lt;/ConfigModule&gt;<br />
&lt;/Configuration&gt;<br />
<br />
In order to change the &quot;&lt;Data name=&quot;Database&quot; type=&quot;string&quot;&gt;C:\Program Files\Test\Database\Test.FDB&lt;/Data&gt;&quot; is there any other way then looping through the nodes and comparing attributes ?<br />
<br />
i am already looping through the &quot;ConfigModule&quot; Nodes and comparing, is there an easier way?<br />
<br />
Here is the code i have so far:<br />
<br />
<br />
${xml::LoadFile} &quot;$EXEDIR\scMaster.ctf&quot; $0<br />
loop:<br />
${xml::FindNextElement} &quot;ConfigModule&quot; $0 $1<br />
${xml::ElementPath} $0<br />
${xml::GetAttribute} &quot;name&quot; $1 $2 <br />
<br />
${IF} $1 == &quot;FirebirdBridge&quot;<br />
        <br />
    ${xml::GotoPath} &quot;$0/Section/Data&quot; $1<br />
<br />
	Loop here again ?<br />
         <br />
         <br />
${ELSE}<br />
        Goto loop        <br />
${ENDIF}<br />
<br />
${xml::FindCloseElement}<br />
${xml::SaveFile} &quot;$EXEDIR\scMaster2.ctf&quot; $0<br />
${xml::Unload}<br />
<br />
<br />
<br />
<br />
Thanks for helping :)<br />
<br />
<br />
<br />
<br />
thanks.. this helped me tremendously..<br />
&lt;Configuration<br />
&lt;ConfigModule name=&quot;BlaBla&quot;&gt;<br />
 &lt;/ConfigModule&gt;<br />
 &lt;ConfigModule name=&quot;FirebirdBridge&quot; DefaultConfig=&quot;FALSE&quot;&gt;<br />
    &lt;Section name=&quot;FirebirdBridge&quot; description=&quot;Configuration for Firebird DB Bridge&quot;&gt;<br />
      &lt;Data name=&quot;Host&quot; type=&quot;string&quot;&gt;127.0.0.1&lt;/Data&gt;<br />
      &lt;Data name=&quot;Database&quot; type=&quot;string&quot;&gt;C:\Program Files\Test\Database\Test.FDB&lt;/Data&gt;<br />
      &lt;Data name=&quot;User&quot; type=&quot;string&quot;&gt;User&lt;/Data&gt;<br />
      &lt;Data name=&quot;Password&quot; type=&quot;string&quot;&gt;Password&lt;/Data&gt;<br />
    &lt;/Section&gt;<br />
  &lt;/ConfigModule&gt;<br />
&lt;/Configuration&gt;<br />
<br />
Correct XPath:<br />
/Configuration/ConfigModule/Section/Data[@name=&quot;Host&quot;]<br />
<br />
I was using: (Wrong)<br />
/Configuration/ConfigModule[@name=&quot;FirebirdBridge&quot;]/Section[@name=&quot;FirebirdBridge&quot;]/Data[@name=&quot;Host&quot;]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xbarns</div><div class="date">8th July 2013, 12:01</div></div><div class="posttext">Hi All,<br />
<br />
i use the plugin to replace certain values in an unattend.xml (used for Windows NT6 deployment, e.g. License Key, Company name aso.). <br />
<br />
But when i do this it will change a line <br />
<br />
&lt;CommandLine&gt;%systemdrive%\ASetup\LockScr.exe &quot;%systemdrive%\ASetup\asetup.bmp&quot;&lt;/CommandLine&gt;<br />
<br />
to <br />
<br />
&lt;CommandLine&gt;%systemdrive%\ASetup\LockScr.exe &amp;quot;%systemdrive%\ASetup\asetup.bmp&amp;quot;&lt;/CommandLine&gt;<br />
<br />
is there any way to preven the change from &quot; to &amp;quot; ?<br />
<br />
It seems to happen as a &quot;by product&quot; since i do not edit anything near the occurence of the &lt;CommandLine&gt; tags.<br />
<br />
Thanks a lot, any help is appreciated....<br />
x</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>