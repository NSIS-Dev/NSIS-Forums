<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" osql and batch file, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  osql and batch file NSIS Discussion" />
	
	<title> osql and batch file [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  osql and batch file</div>
<hr />
<div class="pda"><a href="t-248509.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=248509">osql and batch file</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">n.s.</div><div class="date">12th June 2006, 08:47</div></div><div class="posttext">Hi,<br />
<br />
I'm having some problem with executing an osql command from a batch file. I've already searched the forum to find information about osql and executing a batch file, but none of the posts could solve my problem.<br />
<br />
What I do is execute a batch file with the following rule:<br />
ExecWait '&quot;$EXEDIR\createdb.bat&quot;'<br />
<br />
The batch file contains the following lines:<br />
echo off<br />
echo please wait while creating Cr database...<br />
if not exist C:\Cr mkdir C:\Cr<br />
if not exist C:\Cr\Data mkdir C:\Cr\Data<br />
osql -S .\server -Usa -Pmasked -i tlvdc.sql -oC:\Cr\createdb.log<br />
<br />
What happens is that the a command window pops up, the directory C:\Cr\Data is created, but the osql command does not execute, the command window closes almost immediately.<br />
<br />
Is there anyone that can help me with my problem?<br />
<br />
Best regards,<br />
<br />
n.s.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CancerFace</div><div class="date">12th June 2006, 09:37</div></div><div class="posttext">Is it important where the osql command is running from (working dir) or is it something that exists in your path? In other words if you run the osql command from anywhere will it work?<br />
<br />
As for the batch file I would use something like this instead:IfFileExists 'C:\Cr\Data\*.*' +2 +1<br />
CreateDirectory 'C:\Cr\Data'<br />
nsExec::Exec '&quot;&lt;path&gt;\osql&quot; -S .\server -Usa -Pmasked -i tlvdc.sql -oC:\Cr\createdb.log'<br />
or you can use ExecWait if you want to see the DOS window popping up ...<br />
<br />
Maybe it would be a good idea to add a pause command in your batch file after the osql command to see if it complains for something and that's why it does not execute at all ...<br />
Hope this helps<br />
<br />
<br />
CF</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n.s.</div><div class="date">12th June 2006, 09:46</div></div><div class="posttext">Thanks for the reply,<br />
<br />
After some test I noticed that it had to do with an invalid path (as you suggested).<br />
<br />
The problem was that the sql file wasn't in the executing directory.<br />
<br />
I used the following to solve the problem:<br />
ExecWait '&quot;$EXEDIR\createdb.bat&quot; $EXEDIR'<br />
<br />
And adjusted the batch file like this:<br />
<br />
if not exist C:\Cr mkdir C:\Cr<br />
if not exist C:\Cr\Data mkdir C:\Cr\Data<br />
if &quot;%1&quot;==&quot;&quot; goto cont<br />
cd %1<br />
:cont<br />
osql -S .\server -Usa -Pmasked -i tlvdc.sql -oC:\Cr\createdb.log<br />
<br />
<br />
Best regards,<br />
<br />
n.s.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>