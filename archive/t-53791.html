<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Exec Strangeness, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Exec Strangeness NSIS Discussion" />
	
	<title> Exec Strangeness [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Exec Strangeness</div>
<hr />
<div class="pda"><a href="t-53791.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=53791">Exec Strangeness</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">nphelps</div><div class="date">30th June 2001, 07:32</div></div><div class="posttext">I cannot get either Exec or ExecWait to work at all in my NSI script.  I know it must work because the sample viewhtml.nsi works properly.  However, when I try the same code in my own functional script, it never launches the application... The script compiles properly, and the command appears in the install details--but the executable never gets launched and the error flag gets set.  Anyone have an idea of what could be causing this problem?  I'm on Windows 2000 SP2 and I'm simply doing this:<br />
<br />
ExecWait '&quot;$PROGRAMFILES\Internet Explorer\iexplore.exe&quot;'<br />
<br />
I have also tried:<br />
<br />
Exec &quot;C:\WINNT\notepad.exe&quot;<br />
<br />
Just for kicks...same result.<br />
<br />
Ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Gonzotek</div><div class="date">30th June 2001, 15:45</div></div><div class="posttext">What about shellexec?  Same result?<br />
<br />
The first line in your code...<br />
<br />
ExecWait '&quot;$PROGRAMFILES\Internet Explorer\iexplore.exe&quot;' <br />
<br />
<br />
had single quotes ('...') wrapped around double quotes (&quot;...&quot;), was that intentional?<br />
<br />
-=Gonzotek=-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nphelps</div><div class="date">30th June 2001, 15:59</div></div><div class="posttext">No, ExecShell works... and yes the extra quotes were intentional.  I had just cut 'n paste from the viewhtml.nsi which had the following line which included the extra quotes:<br />
<br />
ExecWait '&quot;$PROGRAMFILES\Internet Explorer\iexplore.exe&quot; &quot;$INSTDIR\makensis.htm&quot;'<br />
<br />
I'm assuming this is simply grouping the two statements into one arg.  So, I don't think the extra quotes affect the actual execution of the statement.  That is one reason I pulled them out on the second example.<br />
<br />
But again, ExecShell works... why would one work and not the other two?  I really need to use ExecWait if at all possible.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Gonzotek</div><div class="date">1st July 2001, 02:20</div></div><div class="posttext">If the sample works properly, maybe you could work back from there.  Take out everything from the example that you can, then build a new script around it.  Or perhaps Exec and ExecWait have an incompatibility eith compliling under WIN2k SP1?<br />
<br />
What about<br />
<br />
EXEC FILE.EXE<br />
<br />
<br />
in the directory that you are currently working in?<br />
<br />
-=Gonzotek=-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nphelps</div><div class="date">2nd July 2001, 01:19</div></div><div class="posttext">Fixed it!  For some reason, I had to place and SetOutPath statement prior to calling Exec or ExecWait for it to work.  I when through the viewhtml.nsi sample, and commented it out line by line.  When I removed the SetOutPath statement in the default section the Exec didn't launch Internet Explorer.  So, I just added a dummy SetOutPath statement in the function where I call Exec and sure enough, it worked!<br />
<br />
I suppose that is a bug, so like I said, to reproduce it, just comment out the line that says SetOutPath $INSTDIR in the viewhtml.nsi sample script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">spaetz</div><div class="date">3rd July 2001, 12:46</div></div><div class="posttext">That seems to be a bug for sure, but I had also experienced problemls with opening html pages. If you do a<br />
ExecShell &quot;open&quot; &quot;C:\test.html&quot;<br />
it might not open a webbrowser. It works perfectly if NS is the standard browser, but IE  didn't seem to set html to open correctly via that scheme (got bug reports from a couple of persons)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arune</div><div class="date">5th July 2001, 10:03</div></div><div class="posttext">How about using start.exe instead of open, <br />
or maybe itÂ´s &quot;start.exe c:\temp.html&quot;? <br />
Try with start.exe anyway!<br />
/arune</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>