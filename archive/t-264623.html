<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Local/network installation of .exe/.bat/manual, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Local/network installation of .exe/.bat/manual NSIS Discussion" />
	
	<title> Local/network installation of .exe/.bat/manual [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Local/network installation of .exe/.bat/manual</div>
<hr />
<div class="pda"><a href="t-264623.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=264623">Local/network installation of .exe/.bat/manual</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">LuP</div><div class="date">29th January 2007, 16:03</div></div><div class="posttext">Hello,<br />
<br />
I downloaded NSIS installer and I'd like to use it to create an installer. I studied manual, scripting language; the page/section architecture seems me clear. But the program to be installed is a Windows console application and has several special features.<br />
<br />
The program package consists of the main executable (.exe), a batch file (.bat which runs the selected file with the executable) and the manual directory.<br />
<br />
1) In most cases, the program will be placed on a shared location (e.g. network drive). So the first step of the installation should be selection of type of installation - &quot;Local&quot; (simply &quot;LocInst&quot;) (all mentioned files will be copied on a local drive) or &quot;Shared&quot; (simply &quot;ShInst&quot;) (only the .bat will be copied to the local drive). The first question is how the .nsi input scripting file shoud look to allow user to select &quot;LocInst&quot; or &quot;ShInst&quot; (maybe a simple dialog with 2 radio buttons will appear).<br />
<br />
2) When &quot;ShInst&quot; is selected, I need to allow user to enter path to the main executable. How via script to &quot;pre-fill&quot; the edit box where the path is to be entered? I would need to scan all drives and try to locate &lt;DRIVE&gt;\...\PROGRAM.exe. And - if the .exe is found - to fill in the edit box where the user is about to enter the path. - And how - via script - to check the path entered is correct and the .exe exists?<br />
<br />
3) In both - &quot;LocInst&quot; and &quot;ShInst&quot; - installation modes the user will be prompted to select the .bat file location. Similarly as in the previous step, I would like the installator to try to find a special directory. Existence of directories should be tried in the order: C:\Bat -&gt; C:\&lt;USER_NAME&gt;\Bat -&gt; (... several more). How to - via script - to find the first directory that exists?<br />
<br />
4) The common step in both installation modes is to associate an extension (e.g. .prg) with the copied .bat file. How to do it?<br />
<br />
Thanks.<br />
<br />
LuP</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>