<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" create custom aborted installation page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  create custom aborted installation page NSIS Discussion" />
	
	<title> create custom aborted installation page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  create custom aborted installation page</div>
<hr />
<div class="pda"><a href="t-303844.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=303844">create custom aborted installation page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">greatguns</div><div class="date">7th March 2009, 01:41</div></div><div class="posttext">I am trying to create a custom finish page which basically should say that the installation was aborted, and the application is not installed.<br />
<br />
I am current using the predefined pages like welcome,install files and finish.<br />
<br />
I want to use a finish page template to display this message.<br />
<br />
i know i can create a page using Page custom, but this does not allow me to show the page only when the user clicks cancel in the middle of the install wizard.<br />
<br />
how do i make NSIS to show a page only when the user clicks cancel install?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SuperPat</div><div class="date">7th March 2009, 10:48</div></div><div class="posttext">You can try UltraModernUI that featured an abort page</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">7th March 2009, 11:46</div></div><div class="posttext">You can create two custom pages, one for success and one for abort.<br />
Then use the callback functions .onInstFailed and .onInstSuccess to show the right custom page.<br />
(http://nsis.sourceforge.net/Docs/Chapter4.html#4.7.2.1.3)<br />
<br />
JP</div></div><hr />


<div class="post"><div class="posttop"><div class="username">greatguns</div><div class="date">7th March 2009, 12:23</div></div><div class="posttext">Function .onInstFailed<br />
    MessageBox MB_OK &quot;Better luck next time.&quot;<br />
  FunctionEnd<br />
<br />
This allows me to show a message dialog.....not declare a page and go into that flow of execution.<br />
<br />
if i declare the page after the finish page in my declaration, if i click on finish i am getting redirected to the custom page instead of exiting the installer.<br />
<br />
can you please tell me how we can create a page and not show it unless we call for it specifically?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">7th March 2009, 12:51</div></div><div class="posttext">You're right.<br />
Well, you can create a global variable, and change the value in the .onInstFailed function.<br />
Then compare the variable in the init function of the two custom pages, and call Abort in the Init function you don't need.<br />
<br />
Like:<br />
<br />
var /Global failedinstall<br />
<br />
Function .onInit<br />
   StrCpy failedinstall &quot;false&quot;<br />
FunctionEnd<br />
<br />
Function .onInstFailed<br />
   StrCpy failedinstall &quot;true&quot;<br />
FunctionEnd<br />
<br />
Function SuccessFinishPage<br />
   StrCmp failedinstall &quot;true&quot; +2<br />
      Abort<br />
   'successfinishpage code<br />
FunctionEnd<br />
<br />
Function FailedFinishPage<br />
   StrCmp failedinstall &quot;false&quot; +2<br />
      Abort<br />
   'failedfinishpage code<br />
<br />
<br />
Something like this<br />
(I was not able to test this code, because I don't have installed NSIS on the machine I'm currently using, so there might be errors, but you get the idea)<br />
<br />
JP<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">folklore</div><div class="date">8th March 2009, 05:15</div></div><div class="posttext">Originally posted by jpderuiter <br />
You're right.<br />
Well, you can create a global variable, and change the value in the .onInstFailed function.<br />
Then compare the variable in the init function of the two custom pages, and call Abort in the Init function you don't need.<br />
<br />
Like:<br />
<br />
var /Global failedinstall<br />
<br />
Function .onInit<br />
   StrCpy failedinstall &quot;false&quot;<br />
FunctionEnd<br />
<br />
Function .onInstFailed<br />
   StrCpy failedinstall &quot;true&quot;<br />
FunctionEnd<br />
<br />
Function SuccessFinishPage<br />
   StrCmp failedinstall &quot;true&quot; +2<br />
      Abort<br />
   'successfinishpage code<br />
FunctionEnd<br />
<br />
Function FailedFinishPage<br />
   StrCmp failedinstall &quot;false&quot; +2<br />
      Abort<br />
   'failedfinishpage code<br />
<br />
<br />
Something like this<br />
(I was not able to test this code, because I don't have installed NSIS on the machine I'm currently using, so there might be errors, but you get the idea)<br />
<br />
JP<br />
FunctionEnd  <br />
<br />
I think it will be work well.Base on custom page.<br />
But it can't automaticall chang the language when I select other installing language.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">greatguns</div><div class="date">8th March 2009, 12:54</div></div><div class="posttext">Originally posted by jpderuiter <br />
You're right.<br />
Well, you can create a global variable, and change the value in the .onInstFailed function.<br />
Then compare the variable in the init function of the two custom pages, and call Abort in the Init function you don't need.<br />
<br />
Like:<br />
<br />
var /Global failedinstall<br />
<br />
Function .onInit<br />
   StrCpy failedinstall &quot;false&quot;<br />
FunctionEnd<br />
<br />
Function .onInstFailed<br />
   StrCpy failedinstall &quot;true&quot;<br />
FunctionEnd<br />
<br />
Function SuccessFinishPage<br />
   StrCmp failedinstall &quot;true&quot; +2<br />
      Abort<br />
   'successfinishpage code<br />
FunctionEnd<br />
<br />
Function FailedFinishPage<br />
   StrCmp failedinstall &quot;false&quot; +2<br />
      Abort<br />
   'failedfinishpage code<br />
<br />
<br />
Something like this<br />
(I was not able to test this code, because I don't have installed NSIS on the machine I'm currently using, so there might be errors, but you get the idea)<br />
<br />
JP<br />
FunctionEnd  <br />
<br />
I tried something like that, if i try to put in the &quot;Page custom [creator function]&quot; in a function it gives me the error<br />
&quot;command Page not valid in Function&quot; so i guess it has problem with page declaration within a function.<br />
<br />
There must be some clean way of implementing this kinda behavior, it can't be so uncommon.....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">8th March 2009, 14:49</div></div><div class="posttext">You don't actually specify the &quot;Page&quot; command; just the commands that create the dialog.  However, I don't think you -can- create a dialog in the userAbort callback (seems to be okay in .onInstFailed, but that's not what you're looking for, I think).<br />
<br />
So you may just have to use something like...<br />
http://nsis.sourceforge.net/Go_to_a_NSIS_page<br />
...to go to a particular page.. your 'user aborted' page that checks whether the user aborted (set a variable).  If the user didn't abort installation, just abort that page so it never displays.<br />
<br />
Might be worth investigating UMUI if you need this functionality :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">8th March 2009, 22:51</div></div><div class="posttext">The thing I didn't think of was that (custom) pages are not called as soon the installer is aborted.<br />
So my code will never work.<br />
<br />
As far as I can see UMUI is the way to go.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">8th March 2009, 23:44</div></div><div class="posttext">well, the...<br />
http://nsis.sourceforge.net/Go_to_a_NSIS_page<br />
...page specifically deals with the user abort event (Standard and MUI), so that might be an option as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">9th March 2009, 00:04</div></div><div class="posttext">Well, as it says:<br />
Use it only on normal functions, the &quot;.onUserAbort&quot; callback function (w/o MUI) or the !define MUI_CUSTOMFUNCTION_ABORT &quot;Function&quot; (w/ MUI)I suppose you can't use it for .onInstFailed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">9th March 2009, 00:14</div></div><div class="posttext">not sure - but in the case of .onInstFailed, I could successfully pop up a dialog (nsDialogs) anyway, so it wouldn't be needed there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">greatguns</div><div class="date">10th March 2009, 02:15</div></div><div class="posttext">Thanks for your help ppl :)<br />
<br />
For my functionality atleast i think the combined solution of<br />
jpderuiter and  Animaether will work.<br />
<br />
I just create a custom page and check in the creator function if i need to show the page or just call abort in the creator function to continue on with the other pages.<br />
<br />
i thought of using the same, but figured it is a round about way of doing this.(still noob at NSIS i guess :) )</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>