<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" My Uninstall Runs Twice, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  My Uninstall Runs Twice NSIS Discussion" />
	
	<title> My Uninstall Runs Twice [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  My Uninstall Runs Twice</div>
<hr />
<div class="pda"><a href="t-281128.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=281128">My Uninstall Runs Twice</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Boneyhead</div><div class="date">9th November 2007, 22:37</div></div><div class="posttext">Every time that I run my uninstaller from Add/Remove appet it runs twice. I load the uninstaller, go through the uninstall (which works fine), get the Finish page, select the finish button and wham, the uninstall dialog just starts over again. After the second time it closes as it should. I can't figure out why this happens. Any idea? My script is:<br />
<br />
;NSIS Modern User Interface<br />
;Welcome/Finish Page Example Script<br />
;Written by Joost Verburg<br />
<br />
;--------------------------------<br />
;Include Modern UI<br />
<br />
  !include &quot;MUI.nsh&quot;<br />
<br />
  SetCompressor BZIP2<br />
<br />
;--------------------------------<br />
;General<br />
<br />
  ;Name and file<br />
  Name &quot;MyApp&quot;<br />
  OutFile &quot;\\c343267-a\C\Software\Projects\Gord Corp\ndi_de Projects\Premium\ndi_de\NSIS\ndi_de2.exe&quot;<br />
  XPStyle on<br />
  RequestExecutionLevel admin<br />
<br />
  !define MUI_ICON &quot;\\c343267-a\C\Software\Projects\Gord Corp\ndi_de Projects\Premium\ndi_de\NSIS\ndi_de.ico&quot;<br />
  !define MUI_UNICON &quot;\\c343267-a\C\Software\Projects\Gord Corp\ndi_de Projects\Premium\ndi_de\NSIS\ndi_de.ico&quot;<br />
<br />
  ;Default installation folder<br />
  InstallDir &quot;$PROGRAMFILES\MyApp&quot;<br />
<br />
  ;Get installation folder from registry if available<br />
  InstallDirRegKey HKCU &quot;Software\MyApp&quot; &quot;&quot;<br />
<br />
  VIAddVersionKey /LANG=${LANG_ENGLISH} &quot;ProductName&quot; &quot;MyApp&quot;<br />
  VIAddVersionKey /LANG=${LANG_ENGLISH} &quot;Comments&quot; &quot;Inventory, backup, restore and locate system drivers.&quot;<br />
  VIAddVersionKey /LANG=${LANG_ENGLISH} &quot;CompanyName&quot; &quot;Gord Corp.&quot;<br />
  VIAddVersionKey /LANG=${LANG_ENGLISH} &quot;LegalTrademarks&quot; &quot;MyApp is a trademark of Gord Corp.&quot;<br />
  VIAddVersionKey /LANG=${LANG_ENGLISH} &quot;LegalCopyright&quot; &quot;Â© Gord Corp. 2003 - 2007&quot;<br />
  VIAddVersionKey /LANG=${LANG_ENGLISH} &quot;FileDescription&quot; &quot;Inventory, backup, restore and locate system drivers.&quot;<br />
  VIAddVersionKey /LANG=${LANG_ENGLISH} &quot;FileVersion&quot; &quot;2.1.26&quot;<br />
<br />
  VIProductVersion &quot;2.1.26.0&quot;<br />
<br />
<br />
;--------------------------------<br />
;Interface Settings<br />
<br />
  !define MUI_ABORTWARNING<br />
<br />
;--------------------------------<br />
;Pages<br />
 <br />
  !insertmacro MUI_PAGE_WELCOME<br />
  !insertmacro MUI_PAGE_LICENSE &quot;\\c343267-a\C\Software\Projects\Gord Corp\ndi_de Projects\Premium\ndi_de\NSIS\Install Path\License.txt&quot;<br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  ;!insertmacro MUI_PAGE_FINISH<br />
<br />
  !insertmacro MUI_UNPAGE_WELCOME<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_UNPAGE_INSTFILES<br />
  !insertmacro MUI_UNPAGE_FINISH<br />
<br />
;--------------------------------<br />
;Modified Finish Page<br />
<br />
  !define MUI_PAGE_CUSTOMFUNCTION_PRE fin_pre<br />
  !define MUI_PAGE_CUSTOMFUNCTION_SHOW fin_show<br />
  !define MUI_PAGE_CUSTOMFUNCTION_LEAVE fin_leave<br />
<br />
  !define MUI_FINISHPAGE_RUN<br />
  !define MUI_FINISHPAGE_RUN_FUNCTION Desc_ShortCut<br />
  !define MUI_FINISHPAGE_RUN_TEXT &quot;Create Desktop Shortcut&quot;<br />
  !insertmacro MUI_PAGE_FINISH<br />
<br />
  !insertmacro MUI_UNPAGE_WELCOME<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_UNPAGE_INSTFILES<br />
  !insertmacro MUI_UNPAGE_FINISH<br />
<br />
;--------------------------------<br />
;Languages<br />
<br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
;--------------------------------<br />
;Installer Functions<br />
<br />
Function Desc_Shortcut<br />
SetOutPath &quot;$INSTDIR&quot;<br />
CreateShortCut &quot;$DESKTOP\MyApp.lnk&quot; &quot;$INSTDIR\myappexe.exe&quot;<br />
FunctionEnd<br />
<br />
Function fin_show<br />
ReadINIStr $0 &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;HWND&quot;<br />
SetCtlColors $0 0x000000 0xFFFFFF<br />
ReadINIStr $0 &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;HWND&quot;<br />
SetCtlColors $0 0x000000 0xFFFFFF<br />
FunctionEnd<br />
<br />
Function fin_pre<br />
WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Settings&quot; &quot;NumFields&quot; &quot;6&quot;<br />
WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Type&quot; &quot;CheckBox&quot;<br />
WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Text&quot; &quot;&amp;Create Quicklaunch Shortcut&quot;<br />
WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Left&quot; &quot;120&quot;<br />
WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Right&quot; &quot;315&quot;<br />
WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Top&quot; &quot;110&quot;<br />
WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;Bottom&quot; &quot;120&quot;<br />
WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;State&quot; &quot;1&quot;<br />
<br />
WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Settings&quot; &quot;NumFields&quot; &quot;7&quot;<br />
WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Type&quot; &quot;CheckBox&quot;<br />
WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Text&quot; &quot;&amp;Launch MyApp&quot;<br />
WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Left&quot; &quot;120&quot;<br />
WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Right&quot; &quot;315&quot;<br />
WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Top&quot; &quot;130&quot;<br />
WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;Bottom&quot; &quot;140&quot;<br />
WriteINIStr &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;State&quot; &quot;1&quot;<br />
<br />
FunctionEnd<br />
<br />
Function fin_leave<br />
ReadINIStr $0 &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 6&quot; &quot;State&quot;<br />
StrCmp $0 &quot;0&quot; end<br />
SetOutPath &quot;$INSTDIR&quot;<br />
CreateShortCut &quot;$QUICKLAUNCH\MyApp.lnk&quot; &quot;$INSTDIR\myappexe.exe&quot;<br />
<br />
ReadINIStr $0 &quot;$PLUGINSDIR\iospecial.ini&quot; &quot;Field 7&quot; &quot;State&quot;<br />
StrCmp $0 &quot;0&quot; end<br />
SetOutPath &quot;$INSTDIR&quot;<br />
Exec &quot;$INSTDIR\myappexe.exe&quot;<br />
<br />
end:<br />
FunctionEnd<br />
<br />
;--------------------------------<br />
;Installer Sections<br />
<br />
Section &quot;Dummy Section&quot; SecDummy<br />
<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
<br />
  ;ADD YOUR OWN FILES HERE...<br />
<br />
  File &quot;\\c343267-a\C\Software\Projects\Gord Corp\ndi_de Projects\Premium\ndi_de\myappexe.exe&quot;<br />
<br />
  File &quot;\\c343267-a\C\Software\Projects\Gord Corp\ndi_de Projects\Premium\ndi_de\Help\myappexe.chm&quot;<br />
<br />
  File &quot;\\c343267-a\C\Software\Projects\Gord Corp\ndi_de Projects\Premium\ndi_de\NSIS\Install Path\*.*&quot;<br />
<br />
  SetOutPath &quot;$INSTDIR\bin&quot;<br />
<br />
  File &quot;\\c343267-a\C\Software\Projects\Gord Corp\ndi_de Projects\Premium\ndi_de\NSIS\bin\*.*&quot;<br />
<br />
  SetOutPath &quot;$SYSDIR&quot;<br />
  SetOverwrite try<br />
<br />
  File &quot;\\c343267-a\C\Software\Projects\Gord Corp\ndi_de Projects\Premium\ndi_de\NSIS\System Path\*.*&quot;<br />
<br />
  SetOutPath &quot;$SYSDIR\wbem&quot;<br />
  SetOverwrite off<br />
<br />
  File &quot;\\c343267-a\C\Software\Projects\Gord Corp\ndi_de Projects\Premium\ndi_de\NSIS\wbem\*.*&quot;<br />
<br />
  ;Store installation folder<br />
  WriteRegStr HKCU &quot;Software\MyApp&quot; &quot;&quot; $INSTDIR<br />
<br />
  ;Create uninstaller<br />
  WriteUninstaller &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
  RegDLL &quot;$INSTDIR\bin\Codejock.CommandBars.v10.4.0.ocx&quot;<br />
  RegDLL &quot;$INSTDIR\bin\Codejock.DockingPane.v10.4.0.ocx&quot;<br />
  RegDLL &quot;$INSTDIR\bin\Codejock.PropertyGrid.v10.4.0.ocx&quot;<br />
  RegDLL &quot;$INSTDIR\bin\Codejock.ReportControl.v10.4.0.ocx&quot;<br />
  RegDLL &quot;$INSTDIR\bin\Codejock.TaskPanel.v10.4.0.ocx&quot;<br />
<br />
  RegDLL &quot;$SYSDIR\MSCOMCTL.OCX&quot;<br />
  RegDLL &quot;$SYSDIR\msvbvm60.dll&quot;<br />
  RegDLL &quot;$SYSDIR\scrrun.dll&quot;<br />
  RegDLL &quot;$SYSDIR\shfolder.dll&quot;<br />
<br />
  WriteRegExpandStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\MyApp&quot; &quot;UninstallString&quot; '&quot;$INSTDIR\uninstall.exe&quot;'<br />
  WriteRegExpandStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\MyApp&quot; &quot;InstallLocation&quot; &quot;$INSTDIR&quot;<br />
  WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\MyApp&quot; &quot;DisplayName&quot; &quot;MyApp&quot;<br />
  WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\MyApp&quot; &quot;DisplayIcon&quot; &quot;$INSTDIR\myappexe.exe,0&quot;<br />
  WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\MyApp&quot; &quot;DisplayVersion&quot; &quot;${VERSION}&quot;<br />
<br />
  WriteRegDWORD HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\MyApp&quot; &quot;NoModify&quot; &quot;1&quot;<br />
  WriteRegDWORD HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\MyApp&quot; &quot;NoRepair&quot; &quot;1&quot;<br />
<br />
SectionEnd<br />
<br />
;--------------------------------<br />
;Descriptions<br />
<br />
  ;Language strings<br />
  ;LangString DESC_SecDummy ${LANG_ENGLISH} &quot;A test section.&quot;<br />
<br />
  ;Assign language strings to sections<br />
  ;!insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />
  ;!insertmacro MUI_DESCRIPTION_TEXT ${SecDummy} $(DESC_SecDummy)<br />
  ;!insertmacro MUI_FUNCTION_DESCRIPTION_END<br />
<br />
;--------------------------------<br />
;Uninstaller Section<br />
<br />
Section &quot;Uninstall&quot;<br />
<br />
  ;ADD YOUR OWN FILES HERE...<br />
<br />
  RMDir /r /REBOOTOK &quot;$INSTDIR&quot;<br />
<br />
  Delete &quot;$DESKTOP\MyApp.lnk&quot;<br />
  Delete &quot;$QUICKLAUNCH\MyApp.lnk&quot;<br />
<br />
  DeleteRegKey HKCU &quot;Software\MyApp&quot;<br />
  DeleteRegKey HKCU &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\MyApp&quot;<br />
<br />
  Delete &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th November 2007, 23:01</div></div><div class="posttext">It doesn't help having the uninstall page macros inserted twice in the same script.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>