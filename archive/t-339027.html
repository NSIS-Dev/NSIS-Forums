<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" modify path startIn Icons, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  modify path startIn Icons NSIS Discussion" />
	
	<title> modify path startIn Icons [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  modify path startIn Icons</div>
<hr />
<div class="pda"><a href="t-339027.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=339027">modify path startIn Icons</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">hanenjom</div><div class="date">9th December 2011, 09:50</div></div><div class="posttext">Hi, <br />
can you help me please, <br />
<br />
I want to do an install of .exe, the installation wil be ok and the startin of my icons is for All Users.<br />
i have many users to use shortcuts they copy it on her computers, i want when they start icons, the path of start in change with the current user.<br />
<br />
can i do that please?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">9th December 2011, 10:32</div></div><div class="posttext">&quot;I want to create a shortcut for all users, but the working directory of the shortcut must be different for each user.&quot;<br />
<br />
Is that what you mean? If so, then you need to put an environment variable in the working directory, such as &quot;%LOCALAPPDATA%\YourApp\WorkDir&quot;. I'm not sure if this is possible using standard NSIS commands, as the workdir is set through SetOutPath, and it might convert the variable to a path. Try it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hanenjom</div><div class="date">9th December 2011, 13:43</div></div><div class="posttext">I try the $APPDATA and it's don't work :( .<br />
<br />
I create my exe in a server and i have many users, they copy the shortcuts, I want to have for each user his path in the start in.<br />
<br />
for example my Startin in the server is &quot;\Documents and Settings\All Users\Start Menu\Programs&quot; , and I want If XY copy the shortcut in his computer he will have startin: &quot;\Documents and Settings\XY\Start Menu\Programs&quot;.<br />
<br />
Thx.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">10th December 2011, 07:06</div></div><div class="posttext">You should not use an NSIS variable like $APPDATA. You should use an environment variable, such as %APPDATA%.<br />
<br />
But again, I'm not sure if this is possible in the 'normal' NSIS way. Try it:<br />
SetOutPath &quot;%APPDATA%\YourApp\Workdir&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hanenjom</div><div class="date">12th December 2011, 09:12</div></div><div class="posttext">thx for your answer,<br />
<br />
but how can I get the value of %APPDATA% for each user when he copy the icons in his work directory?<br />
<br />
i search and i can't have a solution for that :confused:<br />
<br />
can you help me please.<br />
Thx.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">12th December 2011, 09:18</div></div><div class="posttext">You should NOT get the value, that's the whole point. You need to leave it as the exact string, &quot;%APPDATA%&quot;, so that Windows can determine it by itself when the shortcut is executed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hanenjom</div><div class="date">12th December 2011, 13:48</div></div><div class="posttext">Thx for your help, it's working, just i have a last problem i use two os xp and seven and I can't use the some path for both.<br />
<br />
For Xp I use &quot;%USERPROFILE%\start Menu \programs&quot;<br />
<br />
For Seven I use &quot;%APPDATA%\Microsoft\Windows\Start Menu\programs&quot;<br />
<br />
How can I have the path for both?<br />
<br />
Can you help me please.<br />
Thx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">12th December 2011, 14:30</div></div><div class="posttext">Please do not set Start Menu as the working folder........</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hanenjom</div><div class="date">12th December 2011, 15:46</div></div><div class="posttext">why I don 't do that ? it poses a problem to do it ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">12th December 2011, 17:07</div></div><div class="posttext">You don't want your application to store files in the start menu, do you?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hanenjom</div><div class="date">12th December 2011, 17:14</div></div><div class="posttext">is not a problem for my application to do that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">12th December 2011, 18:21</div></div><div class="posttext">is not a problem for my application to do that.<br />
<br />
Yes it is a problem, you cannot let the user store files in the start menu.<br />
<br />
If your application depends on the working dir then set it to the required folder, if not, set it to $windir, $instdir or something like that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">12th December 2011, 19:54</div></div><div class="posttext">There is one case where it wouldn't be a problem if you set the working dir to the start menu: If the application only creates start menu shortcuts.<br />
<br />
For anything else, it is indeed a problem. You should not store normal files in the start menu.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hanenjom</div><div class="date">13th December 2011, 10:44</div></div><div class="posttext">thx for your answers ans explications, I will change it .</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>