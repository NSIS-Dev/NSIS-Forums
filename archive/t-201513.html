<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Help me, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Help me NSIS Discussion" />
	
	<title> Help me [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Help me</div>
<hr />
<div class="pda"><a href="t-201513.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=201513">Help me</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">manyoka</div><div class="date">8th December 2004, 11:22</div></div><div class="posttext">Hi everyone I am still battling to just create a simple dialog to get a user to input his password for SQL,without using INI.Files.If anyone has a script can u please reply.<br />
<br />
Thank You<br />
Matt</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bgosalci</div><div class="date">8th December 2004, 11:46</div></div><div class="posttext">why not use INI files, I have done the same thing as you, ask user for DB password. If you are intereseted i can post the code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bgosalci</div><div class="date">8th December 2004, 11:59</div></div><div class="posttext">Ha installer that I am working on at the moment does the similar staf as yours. I am installing MSDE and asking the user to provide the password for &quot;sa&quot; DB owner as well as for the DB user. I have used INI files, and it is working fine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">manyoka</div><div class="date">8th December 2004, 12:45</div></div><div class="posttext">Yes please that would be great.<br />
<br />
Much appreciated.<br />
Thanx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bgosalci</div><div class="date">8th December 2004, 14:30</div></div><div class="posttext">Ok, here is the INI file that asks the user for input:<br />
<br />
[Settings]<br />
NumFields=4<br />
Title=&quot;Configuration&quot;<br />
<br />
[Field 1]<br />
Type=Label<br />
Left=0<br />
Right=-1<br />
Top=0<br />
Bottom=8<br />
Text=&quot;Please provide the password for Database user&quot;<br />
<br />
[Field 2]<br />
Type=Text<br />
Left=0<br />
Right=60<br />
Top=10<br />
Bottom=25<br />
State=&quot;&quot;<br />
Flags=PASSWORD<br />
<br />
[Field 3]<br />
Type=Label<br />
Left=0<br />
Right=-1<br />
Top=35<br />
Bottom=43<br />
Text=&quot;Please re-enter the password&quot;<br />
<br />
[Field 4]<br />
Type=Text<br />
Left=0<br />
Right=60<br />
Top=45<br />
Bottom=60<br />
State=&quot;&quot;<br />
Flags=PASSWORD<br />
<br />
And the script:<br />
<br />
;---------------------<br />
;Include Modern UI<br />
<br />
  !include &quot;MUI.nsh&quot;<br />
<br />
;--------------------------------<br />
;General<br />
<br />
  ;Name and file<br />
  Name &quot;Test&quot;<br />
  OutFile &quot;test.exe&quot;<br />
<br />
  ;Default installation folder<br />
  InstallDir &quot;$PROGRAMFILES\LocalAlert&quot;<br />
<br />
;--------------------------------<br />
;Interface Settings<br />
<br />
  !define MUI_HEADERIMAGE<br />
  !define MUI_ABORTWARNING<br />
  !define APP_NAME &quot;Test&quot;<br />
<br />
;--------------------------------<br />
;Variables<br />
<br />
  Var DBpassword<br />
  Var DBpasswordAgain<br />
<br />
;--------------------------------<br />
;Pages<br />
<br />
  Page custom DBUserPassword ValidateDBUserPassword<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_PAGE_FINISH<br />
<br />
  BrandingText &quot;Â© Test Installer&quot;<br />
<br />
;--------------------------------<br />
;Reserve Files<br />
<br />
  ;These files should be inserted before other files in the data block<br />
  ;Keep these lines before any File command<br />
  ;Only for solid compression (by default, solid compression is enabled for BZIP2 and LZMA)<br />
  ReserveFile &quot;db_info.ini&quot;<br />
<br />
;--------------------------------<br />
;Languages<br />
<br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
  <br />
Section<br />
<br />
  MessageBox MB_ICONEXCLAMATION|MB_OK &quot;Test installer that shows how to get user inputs$\n$\n\<br />
                                      Password = $DBpassword&quot;<br />
<br />
SectionEnd<br />
  <br />
LangString TEXT_IO_TITLE ${LANG_ENGLISH} &quot;Database user password&quot;<br />
<br />
Function DBUserPassword<br />
<br />
  !insertmacro MUI_HEADER_TEXT &quot;$(TEXT_IO_TITLE)&quot; &quot;&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;db_info.ini&quot;<br />
<br />
FunctionEnd<br />
<br />
Function ValidateDBUserPassword<br />
<br />
  ;Read a value from an InstallOptions INI file<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $DBpassword &quot;db_info.ini&quot; &quot;Field 2&quot; &quot;State&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $DBpasswordAgain &quot;db_info.ini&quot; &quot;Field 4&quot; &quot;State&quot;<br />
<br />
  StrCmp $DBpassword &quot;&quot; noInput1 var1OK<br />
  var1OK:<br />
  StrCmp $DBpasswordAgain &quot;&quot; noInput2 var2OK<br />
  var2OK:<br />
  StrCmp $DBpassword $DBpasswordAgain done notSame<br />
  noInput1:<br />
  MessageBox MB_ICONEXCLAMATION|MB_OK &quot;No password entered$\n$\nPlease enter the password for Database user, in order to continue&quot;<br />
  Abort<br />
  noInput2:<br />
  MessageBox MB_ICONEXCLAMATION|MB_OK &quot;No password re-entered$\n$\nPlease re-enter the password for Database user, in order to continue&quot;<br />
  Abort<br />
  notSame:<br />
  MessageBox MB_ICONEXCLAMATION|MB_OK &quot;Both entries must be the same value, in order to continue&quot;<br />
  Abort<br />
  done:<br />
<br />
FunctionEnd<br />
<br />
Function .onInit<br />
<br />
  ;Extract InstallOptions INI files<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;tomcat_info.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;smtp_info.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;db_info.ini&quot;<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">8th December 2004, 14:33</div></div><div class="posttext">Mate, attach it as a file :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>