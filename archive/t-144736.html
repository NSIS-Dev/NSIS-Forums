<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Remove task bar item, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Remove task bar item NSIS Discussion" />
	
	<title> Remove task bar item [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Remove task bar item</div>
<hr />
<div class="pda"><a href="t-144736.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=144736">Remove task bar item</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">4th August 2003, 22:46</div></div><div class="posttext">If I am unable to create a tray icon, is it possible to hide the programs' task bar item?<br />
Also, once hiding it, I would like to be able to show it again.<br />
<br />
Thanks<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th August 2003, 12:09</div></div><div class="posttext">If it cannot be done using the System plugin, can it be done from changing somthing in the UI exe with Resource Hacker?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th August 2003, 12:44</div></div><div class="posttext">It can be done using the System plug-in. You need to call GetWindowLong and SetWindowLong. Search Google for C code that does this and try to convert it to System.dll calls.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th August 2003, 12:51</div></div><div class="posttext">I've looked at those on MSDN to no avail.<br />
All I want to do now is remove the task bar item for my settings exe that is executed from my main installer.<br />
I no-longer want to be able to get it back again.<br />
<br />
Help! :(<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th August 2003, 13:05</div></div><div class="posttext">First result on Google for &quot;SetWindowLong taskbar&quot;:<br />
http://www.experts-exchange.com/Programming/Programming_Languages/Delphi/Q_10081312.html<br />
<br />
Convert that to System.dll and it should work. If you have .NET Framework search for the constants (GWL_EXSTYLE, WE_EX_..., etc.) in the .h files in the Include directory of the framework. If you can't find it, add VB to the search term, they always define the constants there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th August 2003, 14:43</div></div><div class="posttext">This is a small attempt; i'm sure it is extremely incomplete or completely wrong!<br />
<br />
System::Call 'Win32::SetWindowLong($HWNDPARENT, GWL_EXSTYLE)'<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th August 2003, 14:49</div></div><div class="posttext">I also found this:<br />
http://upc.pkmn.co.uk/win32/task.shtml<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th August 2003, 14:11</div></div><div class="posttext">I know a plugin is being made to do this, but what would be the System plugin way?<br />
I just want to use the System plugin code for now to see what advantages/disadvantages it will make.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th August 2003, 14:15</div></div><div class="posttext">You were on the right track, why did you stop? You should define GWL_EXSTYLE as the right value, add another parameter to the function call (SetWindowLong takes 3 not 2) and add 'A' to the function name.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th August 2003, 14:30</div></div><div class="posttext">!define GWL_EXSTYLE -20<br />
<br />
System::Call 'Win32::SetWindowLongA($HWNDPARENT, ${GWL_EXSTYLE}, )'<br />
<br />
I'm not at all sure what GWL_EXSTYLE should be.<br />
I could only find<br />
Const GWL_EXSTYLE = (-20)<br />
on some web hits.<br />
<br />
Also, have I added another parameter correctly?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th August 2003, 14:35</div></div><div class="posttext">Looking on MSDN, is this what I want?<br />
<br />
WS_EX_NOACTIVATE<br />
<br />
Description:<br />
Windows 2000/XP: A top-level window created with this style does not become the foreground window when the user clicks it. The system does not bring this window to the foreground when the user minimizes or closes the foreground window. <br />
To activate the window, use the SetActiveWindow or SetForegroundWindow function.<br />
<br />
The window does not appear on the taskbar by default. To force the window to appear on the taskbar, use the WS_EX_APPWINDOW style.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th August 2003, 15:49</div></div><div class="posttext">You have to call it in .onGUIInit or it won't take affect. The code is:<br />
<br />
!define GWL_EXSTYLE         -20<br />
!define WS_EX_APPWINDOW     0x040000<br />
!define WS_EX_TOOLWINDOW    0x000080<br />
<br />
Function .onGUIInit<br />
System::Call &quot;user32::GetWindowLongA(i $HWNDPARENT, i ${GWL_EXSTYLE}) i .s&quot;<br />
Pop $1<br />
IntOp $2 ${WS_EX_APPWINDOW} ~<br />
IntOp $1 $1 &amp; $2<br />
IntOp $1 $1 | ${WS_EX_TOOLWINDOW}<br />
System::Call &quot;user32::SetWindowLongA(i $HWNDPARENT, i ${GWL_EXSTYLE}, i r1)&quot;<br />
FunctionEnd<br />
<br />
There are some problems with this. It won't show on the alt+tab window and the window itself becomes distorted. Try editing the UI and add those styles to it, it should at least help with the the distortion.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th August 2003, 17:18</div></div><div class="posttext">Yikes, I knew it wouldn't be that simple :(<br />
<br />
Thanks, it works perfect (on WinXP)<br />
I've added the styles to the ui too.<br />
<br />
It's good that it doesn't show in Alt+Tab too, because my installer is executing this dialog with ExecWait anyway.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tarwal2</div><div class="date">19th August 2003, 21:28</div></div><div class="posttext">I used a different (slightly easier) approach to this same problem.<br />
<br />
Basically I moved all of the content from my main install section to the GUIInit function and then changed my main install section to a single line reading: &quot;SetAutoClose true&quot;.<br />
<br />
I never see the installation window and everything works perfectly :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th August 2003, 14:26</div></div><div class="posttext">Shouldn't you have placed it all in onInit?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tarwal2</div><div class="date">20th August 2003, 16:11</div></div><div class="posttext">I don't think $HWNDPARENT works properly in .onInit...althought it might work. Since I'm trying to use a tray icon in my setup I assumed I would have the problem where the tray icon disappears where you mouse over it unless I put all of the stuff in my GUIInit function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th August 2003, 16:24</div></div><div class="posttext">Oh ok, when you said installing files, that's different.<br />
Yes, $HWNDPARENT only exists onGUIInit, and not onInit.<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>