<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installing DLL file to use in Custom Page Dialog, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installing DLL file to use in Custom Page Dialog NSIS Discussion" />
	
	<title> Installing DLL file to use in Custom Page Dialog [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installing DLL file to use in Custom Page Dialog</div>
<hr />
<div class="pda"><a href="t-324285.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=324285">Installing DLL file to use in Custom Page Dialog</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bsayakhom</div><div class="date">25th November 2010, 15:19</div></div><div class="posttext">Hi !<br />
<br />
I'm trying to install specific files, with a dynamic source path. The problem Is that I need to install this file in the PLUGINSDIR folder, so I used SetOutPath $PLUGINSDIR.<br />
<br />
!macro InstallFile ProductFolder<br />
 SetOutPath $PLUGINSDIR<br />
 File &quot;\\...\${ProductFolder}\MyFile.dll<br />
!macroend<br />
<br />
My custom Page is defined and called in another Macro SetupProject.<br />
<br />
I used another script to call the InstallFile macro, in the .onInit function, which also call the MUI_LANGDLL_DISPLAY Macro for multilingual installer (as an option top build my setup).<br />
<br />
If both macros are called, evrything works, and Myfile.dll is correctly copied to temporary Pluginsdir folder.<br />
<br />
If the MUI_LANGDLL_DISPLAY macro calling line is commented, nothing happens, and my file is not copied.<br />
<br />
<br />
 Function .onInit<br />
   ;!insertmacro MUI_LANGDLL_DISPLAY<br />
   !insertmacro  InstallFile &quot;${TargetFolder}&quot; ; Where Target folder is correctly set.<br />
   SetRebootFlag true<br />
 FunctionEnd <br />
<br />
So basically, my question is why the macro works in one case and not in the other.<br />
<br />
2nd question : Where else do you think I should Call my macro, considering that the following command SetOutPath $PLUGINSDIR has to set in sections or functions ? and as it has to be first called before the macro which called my Custom Page dialog ?<br />
<br />
Any help is welcome, because I tried to use global variables between functions and macro with no success...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">25th November 2010, 15:28</div></div><div class="posttext">You have to have a InitPluginsDir command before you can use SetOutPath $PluginsDir. MUI_LANGDLL_DISPLAY probably has that in it, which explains why it works when it is not commented.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bsayakhom</div><div class="date">26th November 2010, 08:36</div></div><div class="posttext">That works !<br />
<br />
Thanks for your support</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>