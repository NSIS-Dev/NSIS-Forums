<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" RMDir not RM'ing as anticipated, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  RMDir not RM'ing as anticipated NSIS Discussion" />
	
	<title> RMDir not RM'ing as anticipated [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  RMDir not RM'ing as anticipated</div>
<hr />
<div class="pda"><a href="t-148765.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=148765">RMDir not RM'ing as anticipated</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">tardo0807</div><div class="date">10th September 2003, 17:32</div></div><div class="posttext">Hello folks,<br />
<br />
I've included a code snippet from my uninstall section in the hopes that one of you might quickly see what I am doing wrong.<br />
<br />
Basically, my install directory should be gone after Uninstall. However, two .gif files and one .exe remain after using the uninstall.<br />
<br />
This situation persists even when I attempt to delete each item one by one, with these(*) three files remaining, but the other two do get deleted.<br />
<br />
Am I missing anything?<br />
<br />
Section Uninstall <br />
...code...<br />
...<br />
...code...<br />
...<br />
<br />
   ;tried it this way too...no luck<br />
   ;Delete &quot;$INSTDIR\############40.exe&quot;<br />
*  ;Delete &quot;$INSTDIR\######.exe&quot;<br />
   ;Delete &quot;$INSTDIR\Uninst.exe&quot;<br />
*  ;Delete &quot;$INSTDIR\logoAnim.gif&quot;<br />
*  ;Delete &quot;$INSTDIR\logoStill.gif &quot;<br />
<br />
  RMDir /r &quot;$INSTDIR&quot;<br />
<br />
SectionEnd<br />
<br />
Thanks<br />
JP</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tardo0807</div><div class="date">10th September 2003, 18:01</div></div><div class="posttext">oh yes, I also tried:<br />
<br />
Delete &quot;$INSTDIR&quot;<br />
<br />
with no luck, and the correct syntax for RmDir again with the same problem of remaining files.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th September 2003, 18:16</div></div><div class="posttext">Are you sure the files are not in use? Can you delete them manually?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tardo0807</div><div class="date">10th September 2003, 18:28</div></div><div class="posttext">This problem occurs even if I have just installed the application ( meaning it hasn't been run yet ) so I am very confident that the files are not being used by any programs. I was able to delete them manually. I'm still looking through old posts to try and find the reason, but I appreciate any help I can get.<br />
Thanks<br />
JP</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th September 2003, 18:45</div></div><div class="posttext">And you are not opening them for something else in the uninstaller? The only thing I can think of is files being in use or invalid rights.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tardo0807</div><div class="date">10th September 2003, 18:53</div></div><div class="posttext">here is the entire uninstall code:<br />
(sorry about the stupid hash marks...my boss would be worried if i sent out product names...so I'm using them to avoid any issues)<br />
<br />
  Push &quot;TEMP&quot;<br />
  Call un.DeleteEnvStr<br />
<br />
  DeleteRegKey HKEY_LOCAL_MACHINE &quot;SOFTWARE\#######&quot;<br />
  DeleteRegKey HKEY_LOCAL_MACHINE &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\######&quot;<br />
  DeleteRegKey HKLM &quot;Software\########&quot;<br />
  DeleteRegKey HKLM &quot;Software\LeCor\###&quot;<br />
<br />
  WriteRegStr HKLM &quot;Software\########&quot; &quot;name&quot; &quot;removed&quot;<br />
  WriteRegStr HKLM &quot;Software\Cor######&quot; &quot;value&quot; &quot;removed&quot;<br />
  WriteRegStr HKLM &quot;Software\######Corp&quot; &quot;version&quot; &quot;uit&quot;<br />
  WriteRegStr HKLM &quot;Software\LeCor\####&quot; &quot;version&quot; &quot;1.0&quot;<br />
<br />
<br />
  Delete &quot;$INSTDIR\#########40.exe&quot;<br />
  Delete &quot;$INSTDIR\######.exe&quot;<br />
  Delete &quot;$INSTDIR\Uninst.exe&quot;<br />
  Delete &quot;$INSTDIR\logoAnim.gif&quot;<br />
  Delete &quot;$INSTDIR\logoStill.gif &quot;<br />
<br />
  Delete &quot;$INSTDIR&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th September 2003, 20:39</div></div><div class="posttext">Can you really remove the files manually while the uninstaller is running? RMDir just calls a normal Windows API, like explorer does.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tardo0807</div><div class="date">12th September 2003, 16:46</div></div><div class="posttext">Sorry for the delay in getting back to you, I was at school all day yesterday. I just ran the installer again. When I uninstalled, I was able to delete the files in question while the uninstall splash screen was still active, so I'm assuming that it indeed allowed me to delete while in the midst of uninstalling.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th September 2003, 18:54</div></div><div class="posttext">Just to make sure, can you download Handle (http://www.sysinternals.com/ntw2k/freeware/handle.shtml), add a message box before the first Delete instruction, run Handle when the message box shows up and make sure non of the files are listed?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lzandman</div><div class="date">13th September 2003, 09:16</div></div><div class="posttext">Wild guess... Maybe the files are virus-infected and your anti-virus software is blocking access to them? I've had this once, although that situation didn't involve NSIS.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>