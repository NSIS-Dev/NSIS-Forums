<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Why this doesn't work?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Why this doesn't work? NSIS Discussion" />
	
	<title> Why this doesn't work? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Why this doesn't work?</div>
<hr />
<div class="pda"><a href="t-140240.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=140240">Why this doesn't work?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">26th June 2003, 22:34</div></div><div class="posttext">LangString IEmsg ${LANG_SPANISH} &quot;Tienes una versión $0.x de \<br />
Internet Explorer. $\r$\nSe requiere una versión ${IE}.x o superior \<br />
$\r$\npara visualizar correctamente ${MUI_PRODUCT}.&quot;<br />
LangString IEmsg ${LANG_ENGLISH} &quot;You have a $0.x version of \<br />
Internet Explorer. $\r$\nIt Require ${IE}.x o more to run correctly \<br />
${MUI_PRODUCT}.&quot;<br />
<br />
Function &quot;IEver&quot;<br />
GetDLLVersion &quot;$SYSDIR\shdocvw.dll&quot; $R0 $R1<br />
IfErrors 0 +3<br />
IntOp $R0 $R0 ^<br />
IntOp $R1 $R1 ^<br />
IntOp $R2 $R0 / 0x00010000<br />
IntOp $R3 $R0 &amp; 0x0000FFFF<br />
IntOp $R4 $R1 / 0x00010000<br />
IntOp $R5 $R1 &amp; 0x0000FFFF<br />
IntCmp $R0 ${IE} +2 0 +2<br />
MessageBox MB_OK|MB_ICONSTOP $(IEmsg)<br />
FunctionEnd<br />
<br />
It suppose to display to Message according to the select language.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">27th June 2003, 00:51</div></div><div class="posttext">Ok...<br />
I try everything...<br />
This is really starting to angry-me a little :igor:<br />
Can you analize this test script...<br />
I'm attempting these:<br />
1. Change the Language Dialog strings.<br />
2. Display the MessageBox when the installer detect a lower version<br />
of IE.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">27th June 2003, 08:31</div></div><div class="posttext">This aren't working, because Banner DLL not support message boxes when are showing the banners.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th June 2003, 12:46</div></div><div class="posttext">Banner has nothing to do with message boxes. The problem is that on .onInit the default language still holds. It's only after .onInit that the language selected by the user is taken into consideration.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">27th June 2003, 16:29</div></div><div class="posttext">I try it in the &quot;Welcome show&quot; function and is the same:<br />
no response.... :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th June 2003, 16:30</div></div><div class="posttext">I have an idea that may work.<br />
Have a custom page before the welcome page that shows nothing, but it's leave function contains your script.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">27th June 2003, 16:31</div></div><div class="posttext">I will try that....<br />
<br />
<br />
Yes...<br />
Before Welcome Page, I put a foony custom page.<br />
After selection of th language, it display the messagebox of the<br />
foony function :), can this be a bug?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th June 2003, 17:05</div></div><div class="posttext">I'm guessing that it was not working because the language does not initialise until the first page is shown?<br />
Therefore the function only works after the language initialises by putting a fake page infront.<br />
<br />
-Stu ???</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">27th June 2003, 17:14</div></div><div class="posttext">Yes...also one thing that I discover:<br />
The Function:<br />
<br />
Function &quot;IEver&quot;<br />
GetDLLVersion &quot;$SYSDIR\shdocvw.dll&quot; $R0 $R1<br />
IfErrors 0 +3<br />
IntOp $R0 $R0 ^<br />
IntOp $R1 $R1 ^<br />
IntOp $R2 $R0 / 0x00010000<br />
IntOp $R3 $R0 &amp; 0x0000FFFF<br />
IntOp $R4 $R1 / 0x00010000<br />
IntOp $R5 $R1 &amp; 0x0000FFFF<br />
IntCmp $R0 ${IE} +2 0 +2<br />
MessageBox MB_OK|MB_ICONSTOP $(IEmsg)<br />
FunctionEnd<br />
<br />
was wrong...I changed to:<br />
<br />
Function &quot;IEver&quot;<br />
GetDllVersion &quot;$SYSDIR\shdocvw.dll&quot; $R0 $R1<br />
IntOp $R2 $R0 / 0x00010000<br />
IntOp $R3 $R0 &amp; 0x0000FFFF<br />
IntOp $R4 $R1 / 0x00010000<br />
IntOp $R5 $R1 &amp; 0x0000FFFF<br />
;StrCpy $0 &quot;$R2.$R3.$R4.$R5&quot;<br />
IntCmp $R2 ${IE} +2 +1 +2<br />
MessageBox MB_OK|MB_ICONSTOP $(IEmsg)<br />
FunctionEnd<br />
<br />
<br />
Not too much, but :up: thanks all ...<br />
One question, though:<br />
Can we change the strings of the language dialog &quot;ok&quot; and &quot;cancel&quot;?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th June 2003, 20:07</div></div><div class="posttext">The language selected in .onInit only takes affect after .onInit. I don't know why it didn't work for you in the show function but it works for me. .onGUIInit is probably the best place to put multilingual message boxes.<br />
<br />
As for the 0 to +1 change, there is no difference. It has the exact same effect.<br />
<br />
You can't translate the OK and Cancel buttons, those are Windows strings.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>