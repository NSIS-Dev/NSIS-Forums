<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" vista installer detection, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  vista installer detection NSIS Discussion" />
	
	<title> vista installer detection [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  vista installer detection</div>
<hr />
<div class="pda"><a href="t-275345.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=275345">vista installer detection</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">runreason</div><div class="date">3rd August 2007, 19:28</div></div><div class="posttext">Hi, I have been struggling (to no avail) to find a way to get around Vista's Installer detection (without modifying local computer settings).  The problem is that after the installer completes, it pops up a window saying &quot;This Program Might Not Have Installed Correctly.&quot;.  From what I read here: (http://209.85.165.104/search?q=cache:Ptx01dif9vMJ:download.microsoft.com/download/5/6/a/56a0ed11-e073-42f9-932b-38acd478f46d/windowsvistauacdevreqs.doc+vista+UAC+how+detection+for+setup+programs&amp;hl=en&amp;ct=clnk&amp;cd=10&amp;gl=us&amp;client=firefox-a)<br />
<br />
this is because my installer doesn't add anything to the Add Remove Programs and thus Vista concludes that the installer failed (brilliant!).  <br />
<br />
Creating a manifest didn't help, get the same popup.<br />
<br />
Does anybody know of a way to get around this or perhaps a way to trick vista into not detecting the installer?<br />
<br />
thanks!<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd August 2007, 19:30</div></div><div class="posttext">The manifest is the only way to get around it as it disables the compatibility mode. Try it again with RequestExecutionLevel.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">runreason</div><div class="date">3rd August 2007, 20:01</div></div><div class="posttext">Hi Kickik, I'm still getting the problem.    Here's the contents of manifest I'm using:<br />
<br />
Executable: test.exe<br />
Manifest:test.exe.manifest<br />
Sample application manifest file:<br />
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;<br />
&lt;assembly xmlns=&quot;urn:schemas-microsoft-com:asm.v1&quot; manifestVersion=&quot;1.0&quot;&gt;<br />
  &lt;assemblyIdentity version=&quot;1.0.0.0&quot;<br />
     processorArchitecture=&quot;X86&quot;<br />
     name=&quot;test.exe&quot;<br />
     type=&quot;win32&quot;/&gt;<br />
  &lt;description&gt;CCT installer&lt;/description&gt;<br />
  &lt;!-- Identify the application security requirements. --&gt;<br />
  &lt;trustInfo xmlns=&quot;urn:schemas-microsoft-com:asm.v2&quot;&gt;<br />
    &lt;security&gt;<br />
      &lt;requestedPrivileges&gt;<br />
        &lt;requestedExecutionLevel<br />
          level=&quot;requireAdministrator&quot;<br />
          uiAccess=&quot;true&quot;/&gt;<br />
        &lt;/requestedPrivileges&gt;<br />
      &lt;/security&gt;<br />
  &lt;/trustInfo&gt;<br />
&lt;/assembly&gt;<br />
<br />
<br />
This is in a test.exe.manifest file residing in the same directory as the test.exe file.  Am I doing something wrong?<br />
<br />
thanks for your help!<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd August 2007, 20:42</div></div><div class="posttext">The embedded manifest probably overrides it. Use RequestExecutionLevel in the script to add the Vista nodes to the embedded manifest.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">runreason</div><div class="date">3rd August 2007, 21:50</div></div><div class="posttext">thanks Kickik, do you know of a good way to inject a manifest file into an existing installer exe?<br />
<br />
thanks,<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd August 2007, 21:56</div></div><div class="posttext">You can use Resource Hacker to do that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">runreason</div><div class="date">4th August 2007, 00:23</div></div><div class="posttext">thanks Kickik, <br />
<br />
Using RequestExecutionLevel in my installer script worked perfectly!<br />
<br />
-Mark</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>