<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Can't get SetForegroundWindow to work, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Can't get SetForegroundWindow to work NSIS Discussion" />
	
	<title> Can't get SetForegroundWindow to work [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Can't get SetForegroundWindow to work</div>
<hr />
<div class="pda"><a href="t-270799.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=270799">Can't get SetForegroundWindow to work</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">helix400</div><div class="date">7th May 2007, 19:11</div></div><div class="posttext">Hey all,<br />
<br />
Thanks to the forums, I'm one step away from making an installer that does *everything* I want.  (Which is why I love NSIS).  <br />
<br />
My last thing is getting SetForegroundWindow to work.  Because of the UAC plugin, my installer window pops up behind the active window. I'd just like to call SetForegroundWindow to bring it up front<br />
<br />
The line of code I'm using is thiis:<br />
<br />
System::Call &quot;user32::SetForegroundWindow(i $HWNDPARENT) i.&quot;<br />
<br />
However, that doesn't seem to make it work.  I've tried it at .onGuiInit, at the start of my main section, at the end of the section, etc.  I just can't get the window to come up front.  Any ideas on what I can do to fix this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">7th May 2007, 20:32</div></div><div class="posttext">You may try BringToFront<br />
<br />
http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.14.1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">helix400</div><div class="date">7th May 2007, 20:41</div></div><div class="posttext">No luck.  :(  Maybe my Windows Vista is preventing it, like the documentation said.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">7th May 2007, 20:55</div></div><div class="posttext">Sorry... Although I have a small experience about vista, I'm on the side who claims that vista is just the new bubble (like windows me) from M$.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">7th May 2007, 21:37</div></div><div class="posttext">if your call to SetForegroundWindow is correct, even if the window does not end up at the front, the taskbar icon should still flash. AllowSetForegroundWindow might be able to help you out if you can figure out the PID</div></div><hr />


<div class="post"><div class="posttop"><div class="username">helix400</div><div class="date">7th May 2007, 21:49</div></div><div class="posttext">Yes, I did notice the taskbar flashing.  If I get time, I'll check out the other API stuff<br />
<br />
(Argh, Windows Vista sure is complicating things too much).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">M-Force</div><div class="date">15th October 2007, 22:04</div></div><div class="posttext">Hi helix400 <br />
 <br />
could you please post you final solution about bringing the installer window to the front.<br />
<br />
I am dealing with the same problem.<br />
<br />
Thank you very much<br />
<br />
M.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">15th October 2007, 23:43</div></div><div class="posttext">There is no real solution, microsoft restricts SetForegroundWindow because of apps that abuse it, but, there was a hack added to the last version of the plugin, check it out and see if it helps</div></div><hr />


<div class="post"><div class="posttop"><div class="username">M-Force</div><div class="date">16th October 2007, 05:53</div></div><div class="posttext">Hi Anders,<br />
<br />
thank you for the quick response.<br />
When you are saying there is a new hack added to the last version of the plug-in, what plug-in do you mean.<br />
What is the name/URL/link for the plug-in that your are mentioned?<br />
<br />
Thanks<br />
<br />
M.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">16th October 2007, 07:23</div></div><div class="posttext">the uac plugin, thats what this thread is about, if you don't use the uac plugin, you can ignore this whole thread</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>