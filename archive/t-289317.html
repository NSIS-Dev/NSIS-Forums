<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Vista uninstal, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Vista uninstal NSIS Discussion" />
	
	<title> Vista uninstal [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Vista uninstal</div>
<hr />
<div class="pda"><a href="t-289317.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289317">Vista uninstal</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">travsey</div><div class="date">30th March 2008, 09:11</div></div><div class="posttext">I am attempting to convert some installers to be vista compatible. I am running into an issue where my uninstaller will not delete Applications (.exe) and extensions (.dll). These installers worked ok in previous versions of windows.<br />
<br />
So before the obvious reply is given, I have &quot;RequestExecutionLevel admin&quot; at the top of my script and &quot;SetShellVarContext all&quot; where appropriate;)<br />
<br />
Basically, when a file is installed (in a loop), the installer records it in the registry using:<br />
WriteRegStr HKLM &quot;${REGISTRY_FILES}&quot; &quot;file$COUNTER&quot; &quot;$TARGET_PATH\$1&quot;<br />
<br />
When uninstalling, the uninstaller loops through the registry and removes the registry, then the file:<br />
ReadRegStr $FULL_PATH HKLM &quot;${REGISTRY_FILES}&quot; $UNINSTALL_FILE_IDENTIFIER<br />
DeleteRegValue HKLM &quot;${REGISTRY_FILES}&quot; $UNINSTALL_FILE_IDENTIFIER<br />
Delete $FULL_PATH<br />
<br />
When I look back at the registries, the registry entries have been removed but the files remain. However other file types (.txt, .xml) are removed. This leads me to think that I may need some additional privileges to remove these files.<br />
<br />
I am using XP SP2 and NSIS v2.36.<br />
<br />
I've been able to fix my other vista issues thanks to this forum, but unfortunately this one has had me scratching my head for the better part of the weekend:cry:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mauvecloud</div><div class="date">30th March 2008, 15:16</div></div><div class="posttext">Is it possible to remove these .exe and .dll files by hand afterwards, or does it give you an error message, such as saying they're still in use?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">travsey</div><div class="date">30th March 2008, 22:00</div></div><div class="posttext">They can be manually deleted afterwards in windows explorer.<br />
<br />
The uninstaller does not show any errors or warnings when executing.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">l0k1</div><div class="date">2nd April 2008, 16:14</div></div><div class="posttext">If files are protected by Vista, have you try looking at : <br />
<br />
C:\Users\&quot;user_name&quot;\AppData\Local\VirtualStore\Program Files ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">travsey</div><div class="date">3rd April 2008, 08:58</div></div><div class="posttext">Sorry l0k1 I'm not sure what you are getting at, can you please clarify?<br />
<br />
Any ideas anyone? I am still scratching my head over this:(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">l0k1</div><div class="date">3rd April 2008, 09:28</div></div><div class="posttext">(sorry for bad english)<br />
<br />
For compatibility purpose, under Windows Vista, when processes try to write into protected directories like &quot;c:\program files&quot; without elevation rights, files are written in a virtual directory located at &quot;C:\Users\user_name\AppData\Local\VirtualStore&quot;.<br />
<br />
Another possible reason may be if your application is still running -&gt; kill process before uninstalling.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">travsey</div><div class="date">23rd April 2008, 08:37</div></div><div class="posttext">Well, I'm an idiot!<br />
<br />
Turns out I needed &quot;RequestExecutionLevel admin&quot; at the start of my uninstall macro, not just at the start of the script.<br />
<br />
Thanks to everyone for your help:)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>