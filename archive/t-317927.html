<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstall previous version problems, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstall previous version problems NSIS Discussion" />
	
	<title> Uninstall previous version problems [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstall previous version problems</div>
<hr />
<div class="pda"><a href="t-317927.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=317927">Uninstall previous version problems</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">23rd March 2010, 16:13</div></div><div class="posttext">We recently made a major version change to our software package, however we will still be offering the legacy version with the new version.<br />
<br />
That being said, normally when the installer loads up, it looks if the previous version is installed and it uninstalls it.<br />
<br />
Since the product name changed, the checker will now obviously only check if the new version is old, not both since it uses the $PRODUCT_NAME variable in the uninstall check function.<br />
<br />
Would I need to simply add two functions or is there a way to check both variables at once?<br />
<br />
<br />
ReadRegStr $R0 HKLM \<br />
  &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}&quot; \<br />
  &quot;UninstallString&quot;<br />
  StrCmp $R0 &quot;&quot; blah<br />
<br />
 ; this perhaps should be handled better.  maybe if they hit cancel the installer quits.<br />
  MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />
  &quot;${PRODUCT_NAME} is already installed. $\n$\nClick `OK` to remove the \<br />
  previous version or `Cancel` to cancel this upgrade.&quot; \<br />
  IDOK uninst<br />
  Abort<br />
<br />
;Run the uninstaller<br />
uninst:<br />
  ClearErrors<br />
  ExecWait '$R0 _?=$INSTDIR' ;Do not copy the uninstaller to a temp file<br />
<br />
  IfErrors no_remove_uninstaller<br />
  no_remove_uninstaller:<br />
<br />
blah:<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">23rd March 2010, 16:17</div></div><div class="posttext">Actually thinking about it, is it possible to use a wildcard?<br />
<br />
Product_Name for legacy and modern are similar enough.  <br />
So if my legacy product was called Foobar and the new version is Foobar Accelerator how can i just do somehting like &quot;Foobar*&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">23rd March 2010, 16:46</div></div><div class="posttext">You can't really use a wildcard*, but it's pretty simple to just check both the old and the new name, no?<br />
<br />
A little planning ahead goes a long way here, but just to note - you *could* keep the old name for the registry... the name that gets displayed in ARP is unrelated to the key name, after all.  That way you wouldn't have to worry about this at all.<br />
( the 'little planning ahead' would be to pick a generic name and sticking to it - or using a GUID )<br />
<br />
* You -can- use EnumRegKey to loop over each (sub)key, and then use the string comparison functions.  Fairly heavy functionality in the limited number of cases you've got, though.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">23rd March 2010, 17:34</div></div><div class="posttext">deleted</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">23rd March 2010, 17:38</div></div><div class="posttext">Good point I really don't need to differentiate in that section since other sections are hard coded with the name but just for htat one part it shouldnt matter what it's called.<br />
<br />
And you're right I should had planned this much better from the beginning.<br />
<br />
But, is there a way to change the name of the product without the productname variable so that i can use the original product name in the variable, but change the text for the Welcome to the Foobar Accelerator Installer?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">23rd March 2010, 18:10</div></div><div class="posttext">OMFG I am so dumb today, nevermind.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>