<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" $EXEDIR to mapped drive on Win7 and Vista, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  $EXEDIR to mapped drive on Win7 and Vista NSIS Discussion" />
	
	<title> $EXEDIR to mapped drive on Win7 and Vista [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  $EXEDIR to mapped drive on Win7 and Vista</div>
<hr />
<div class="pda"><a href="t-313770.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=313770">$EXEDIR to mapped drive on Win7 and Vista</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ChristianH</div><div class="date">13th October 2009, 13:08</div></div><div class="posttext">Hi, <br />
<br />
i am experiencing a small problem on win7 and vista. <br />
when i want to install from a mapped network share, <br />
the $exedir is always the unc path for this share. even if it is mapped. The behaviour is different (correct) on all other supported operating systems. perhaps there is something new in vista / win7...<br />
<br />
i made a small test. i created a visual basic application that will only do this statement: <br />
<br />
msgbox app.path <br />
<br />
when i execute it on the share, it will say X:\...<br />
when i then execute the same executable from the same place but using the nsis test.exe, the visual basic application will also ouput the unc path for the mapped drive. <br />
<br />
<br />
<br />
i would like to have the mapped path here. <br />
i even used 2 different functions in nsis to get the correct result. but i will always get that unc path. <br />
<br />
attached is a small test script for you ...<br />
<br />
<br />
Name &quot;test&quot;<br />
OutFile &quot;test.exe&quot;<br />
<br />
Function GetExePath<br />
	!define GetExePath `!insertmacro GetExePathCall`<br />
 <br />
	!macro GetExePathCall _RESULT<br />
		Call GetExePath<br />
		Pop ${_RESULT}<br />
	!macroend<br />
 <br />
	Push $0<br />
	Push $1<br />
	Push $2<br />
	StrCpy $0 $EXEDIR<br />
	System::Call 'kernel32::GetLongPathNameA(t r0, t .r1, i 1024)i .r2'<br />
	StrCmp $2 error +2<br />
	StrCpy $0 $1<br />
	Pop $2<br />
	Pop $1<br />
	Exch $0<br />
FunctionEnd<br />
<br />
Section<br />
        Exec vb6path.exe<br />
        ${GetExePath} $R0<br />
        MessageBox MB_OK &quot;$R0&quot;<br />
	System::Call &quot;kernel32::GetCurrentDirectory(i ${NSIS_MAX_STRLEN}, t .r0)&quot;<br />
	MessageBox MB_OK &quot;$0&quot;<br />
SectionEnd <br />
<br />
Thanks for your help! <br />
<br />
Christian</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ChristianH</div><div class="date">13th October 2009, 13:15</div></div><div class="posttext">here you have the vb6path.exe as an attachment for those who dont have visual basic ... <br />
<br />
greetings <br />
<br />
christian</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ChristianH</div><div class="date">13th October 2009, 14:27</div></div><div class="posttext">the solution was vistas execution level...<br />
requestexecutionlevel user did the trick, <br />
administrator does not have this network share mapped, so he cannot know. <br />
<br />
greetings</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>