<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" 64-Bit Registry Read + Manifest (Dummy Needs Help!), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  64-Bit Registry Read + Manifest (Dummy Needs Help!) NSIS Discussion" />
	
	<title> 64-Bit Registry Read + Manifest (Dummy Needs Help!) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  64-Bit Registry Read + Manifest (Dummy Needs Help!)</div>
<hr />
<div class="pda"><a href="t-318146.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318146">64-Bit Registry Read + Manifest (Dummy Needs Help!)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">cascadtx</div><div class="date">3rd April 2010, 16:44</div></div><div class="posttext">After reading dozens of posts in this forum and looking through the NSIS documentation, I have a problem I can't seem to solve.  Very simply, I have an application that was written for 32-bit installation and now desire to install under 64-bit O/S (Win 7) as well.  The code below works fine under 32-bit XP, but does not work under 64-bit Win7:<br />
<br />
StrCpy $Acad &quot;SOFTWARE\Autodesk\AutoCAD\R18.0\ACAD-8001:409&quot;<br />
ReadRegStr $5 HKLM $Acad &quot;ProductName&quot;<br />
MessageBox MB_OK &quot;Acad = $Acad    5 = $5&quot;<br />
StrCpy $Acad &quot;SOFTWARE\Microsoft\Windows\CurrentVersion&quot;<br />
ReadRegStr $5 HKLM $Acad &quot;ProductName&quot;<br />
<br />
Actually, I am able to read the Windows current version under either and that makes it all the more mysterious to me.  I would think that simply inserting 'SetRegView 64' before this code would make it work fine in 64-bit, but that doesn't seem to do the trick.<br />
<br />
Also, I'm not finding lots of help on the manifest.  Is it really just that I need to use NotePad to create a file named 'MyInstaller.exe.manifest' according to the format noted in http://msdn.microsoft.com/en-us/library/bb756929.aspx and place in the same folder as my NSIS installer exe?<br />
<br />
Like I said, kind of feeling like a dummy right now.  Thanks in advance for any help offered.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">3rd April 2010, 21:52</div></div><div class="posttext">Put RequestExecutionLevel in your script, that will create the manifest</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cascadtx</div><div class="date">6th April 2010, 14:00</div></div><div class="posttext">I tried putting 'RequestExecutionLevel admin' in the Application section and got an error.  On the plus side, I've gotten past the registry problems using SetRegView 64.  I had tried putting this in .oninit and still had problems, but they may have been related to some other things happening on the machine.  Now, I'm using it right before I read the registry in each function and things are working OK.  The WinVer.nsh and x64.nsh includes also worked magic in my app.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">6th April 2010, 14:59</div></div><div class="posttext">well, you still should put RequestExecutionLevel in your script, just put it as the first line in your script</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>