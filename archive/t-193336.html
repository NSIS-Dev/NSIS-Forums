<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Alternate install directories, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Alternate install directories NSIS Discussion" />
	
	<title> Alternate install directories [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Alternate install directories</div>
<hr />
<div class="pda"><a href="t-193336.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=193336">Alternate install directories</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Mikos21</div><div class="date">12th September 2004, 20:01</div></div><div class="posttext">I've been trying this for a few days now with no success.<br />
Basically I want a install directory page that gives an option to install in one of two directories. I have the page display fine using Installoptions. However I have no idea on how to write the script that will determine which of the directories has been selected and which directory to therefore install to. Any help would be appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th September 2004, 20:21</div></div><div class="posttext">I'd have two radio buttons, one by each directory box.<br />
<br />
Use ReadINIStr to find the State of the radio buttons. If radio button #1 State is 0, then radio button #2 must be selected, else its State will be 1.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mikos21</div><div class="date">13th September 2004, 00:34</div></div><div class="posttext">Afrow UK could you please provide more detail regarding ReadINIStr and how then to use the the state of the radio buttons to install in the chosen directory. I do have two radio buttons for the directories but the main problem is how to write the script. A brief example would definately help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">13th September 2004, 00:50</div></div><div class="posttext">If you use Modern UI, instead of using ReadINIStr you should use !insertmacro MUI_INSTALLOPTIONS_READ.<br />
<br />
An example of reading an INI file:ReadINIStr $0 &quot;MyINIFile.ini&quot; &quot;Field 3&quot; &quot;State&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mikos21</div><div class="date">13th September 2004, 02:13</div></div><div class="posttext">Thanks Afrow UK and deguix. I'm now further along but still uncertain about the next part. Now that I can read the 'state' what do I then add in the script that basically says ok if that's what has been selected now install these files to the selected directory ? I hope I'm being clear about what I'm asking.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mikos21</div><div class="date">14th September 2004, 03:55</div></div><div class="posttext">I still can't figure it out. Can anyone please help with a brief example ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">John P.</div><div class="date">29th September 2004, 10:54</div></div><div class="posttext">I have a similar question, so I'll post it in this thread instead of starting a new one:<br />
<br />
<br />
Instead of using radio buttons/chechboxes, I use a droplist in my custom MUI page.<br />
<br />
The listbox looks like this in the .ini:<br />
<br />
<br />
[Settings]<br />
NumFields=1<br />
<br />
[Field 1]<br />
Type=Droplist<br />
ListItems=U.S.(english)|UK(english)|French|German|Italian|Spanish<br />
State=U.S.(english)<br />
Left=40<br />
Right=-40<br />
Top=50<br />
Bottom=70<br />
<br />
Now - in the NSIS script, I have successfully made my custom page with the droplist appear before the Welcome page. So when I open the compiled installer now, the language select listbox comes up first.<br />
<br />
In the NSIS script, I have this so far:<br />
<br />
<br />
Function InstallLanguage  ;&quot;InstallLanguage&quot; defined with Page command<br />
  !insertmacro MUI_HEADER_TEXT &quot;$(TEXT_IO_TITLE)&quot; &quot;$(TEXT_IO_SUBTITLE)&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;ioDX-IW.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;ioDX-IW.ini&quot; &quot;Field 1&quot; &quot;U.S.(english)&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R1 &quot;ioDX-IW.ini&quot; &quot;Field 1&quot; &quot;UK(english)&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R2 &quot;ioDX-IW.ini&quot; &quot;Field 1&quot; &quot;French&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R3 &quot;ioDX-IW.ini&quot; &quot;Field 1&quot; &quot;German&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R4 &quot;ioDX-IW.ini&quot; &quot;Field 1&quot; &quot;Italian&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R5 &quot;ioDX-IW.ini&quot; &quot;Field 1&quot; &quot;Spanish&quot;<br />
FunctionEnd<br />
<br />
Now, I want to continue that function with code that will let me change the install directory according to what the user selected.<br />
<br />
To do that, I would like to put the user-selection into a common variable, so that ${USER_SELECTION} for instance is the installdir for the language the user selected.<br />
<br />
It's the same install dir in my case, but in the install dir path there is one folder for each language, and I'm supposed to extract files to the proper language folder based on the language the user chose.<br />
<br />
Is that possible, and if so how do I do it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">John P.</div><div class="date">29th September 2004, 11:58</div></div><div class="posttext">Would this code do what I want(mentioned above)?<br />
<br />
<br />
Function InstallLanguage  ;&quot;InstallLanguage&quot; defined with Page command<br />
  !insertmacro MUI_HEADER_TEXT &quot;$(TEXT_IO_TITLE)&quot; &quot;$(TEXT_IO_SUBTITLE)&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;ioDX-IW.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;ioDX-IW.ini&quot; &quot;Field 1&quot; &quot;U.S.(english)&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;ioDX-IW.ini&quot; &quot;Field 1&quot; &quot;UK(english)&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;ioDX-IW.ini&quot; &quot;Field 1&quot; &quot;French&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;ioDX-IW.ini&quot; &quot;Field 1&quot; &quot;German&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;ioDX-IW.ini&quot; &quot;Field 1&quot; &quot;Italian&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;ioDX-IW.ini&quot; &quot;Field 1&quot; &quot;Spanish&quot;<br />
<br />
${if} $R0 == 1<br />
StrCpy $INST_DIR &quot;content\examples\files\&quot;<br />
${endif}<br />
<br />
${if} $R0 == 1<br />
StrCpy $INST_DIR &quot;content\examples\files\english&quot;<br />
${endif}<br />
<br />
${if} $R0 == 1<br />
StrCpy $INST_DIR &quot;content\examples\files\french&quot;<br />
${endif}<br />
<br />
${if} $R0 == 1<br />
StrCpy $INST_DIR &quot;content\examples\files\german&quot;<br />
${endif}<br />
<br />
${if} $R0 == 1<br />
StrCpy $INST_DIR &quot;content\examples\files\italian&quot;<br />
${endif}<br />
<br />
${if} $R0 == 1<br />
StrCpy $INST_DIR &quot;content\examples\files\spanish&quot;<br />
${endif}<br />
FunctionEnd<br />
<br />
<br />
-I would then put $INST_DIR in the file commands, like so:<br />
<br />
&quot;$INSTDIR\$INST_DIR\example.bmp&quot;<br />
<br />
(or how ever I'm supposed to write the variable into the path).<br />
<br />
Would that work?<br />
<br />
<br />
<br />
-Or, in the function above, would I have to write<br />
<br />
${if} $R0 == U.S.(english)<br />
StrCpy $INST_DIR &quot;content\examples\files\&quot;<br />
${endif}<br />
<br />
and so on?<br />
<br />
In other words, the listbox state name instead of 1?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">John P.</div><div class="date">29th September 2004, 13:29</div></div><div class="posttext">Well - that didn't work.<br />
<br />
Tried the last thing there, with putting the listbox names instead of 1. <br />
<br />
The script compiles without errors or warnings, but if I for instance choose French in the listbox, the installer just puts everything into $INSTDIR, instead of &quot;$INSTDIR\$INST_DIR\&quot;.<br />
<br />
Can someone please help me out here?<br />
I really need to get this working. :( <br />
<br />
Again - I need to get the User input from the listbox and use it to make a variable I can use as part of the install path, so that each language can have it's own path.<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th September 2004, 14:03</div></div><div class="posttext">You're reading the states of all of the radio buttons into the same variable. Each time, you override the value before you check it. You should either read them into different variables or check right after you read.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">John P.</div><div class="date">29th September 2004, 14:08</div></div><div class="posttext">Thanks for the reply. :)<br />
<br />
But should I use <br />
${if} $R0 == 1<br />
<br />
, or <br />
<br />
${if} $R0 == U.S.(english)<br />
 <br />
<br />
(in other words '1' instead of the droplist name)?<br />
<br />
<br />
-and it's a droplist, not radiobuttons.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th September 2004, 14:16</div></div><div class="posttext">Oh, sorry. You're using a droplist, not radio buttons. The code should look something like this:!insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;ioDX-IW.ini&quot; &quot;Field 1&quot; &quot;STATE&quot;<br />
${if} $R0 == &quot;U.S.(english)&quot;<br />
${elseif} $R0 == &quot;French&quot;<br />
${elseif} $R0 == &quot;German&quot;<br />
${endif}The selected item will be the value of STATE.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">John P.</div><div class="date">29th September 2004, 14:19</div></div><div class="posttext">Oh - thanks. :)<br />
<br />
I'll try to work from that. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">John P.</div><div class="date">29th September 2004, 14:46</div></div><div class="posttext">Haven't tested what you gave me yet, but I have another question:<br />
<br />
How do I skip a Custom Page?<br />
<br />
-My installer can be re-opened, and when the User re-opens it, it will skip past the Welcome page, License page, and Directory page.<br />
<br />
This all works already.<br />
<br />
But when I try to use the same function for the Custom Page, it doesn't affect it. Even though the mentioned pages are skipped, the Custom Page still appears first.<br />
<br />
Here's how it looks now:<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE SkipPages<br />
Page custom InstallLanguage ;Custom page<br />
!insertmacro MUI_PAGE_WELCOME<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE SkipPages<br />
!insertmacro MUI_PAGE_LICENSE &quot;InternalReadme.rtf&quot;<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE SkipPages<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!define MUI_PAGE_CUSTOMFUNCTION_LEAVE checksections<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
<br />
This does not give any errors or warnings when compiling, and it works as intended with the &quot;normal&quot; pages, but doesn't do anything to the Custom Page.<br />
<br />
If I put another !define MUI_PAGE_CUSTOMFUNCTION_PRE SkipPages above the !insertmacro MUI_PAGE_WELCOME, then I do get an error; that it's already defined.<br />
<br />
<br />
So how do I skip a Custom Page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th September 2004, 14:49</div></div><div class="posttext">MUI_PAGE_CUSTOMFUNCTION_PRE only works for MUI pages. Since you create the page yourself, you should skip it yourself. You can skip it by simply not calling InstallOptions in the page creation function (InstallLanguage).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">John P.</div><div class="date">29th September 2004, 15:17</div></div><div class="posttext">OK, thanks - I think I know how.<br />
<br />
Oh, and the code you gave me above worked exactly as I wanted(with some adaptations), so thank you again. :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>