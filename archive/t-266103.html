<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Please help to create function StrToCodes, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Please help to create function StrToCodes NSIS Discussion" />
	
	<title> Please help to create function StrToCodes [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Please help to create function StrToCodes</div>
<hr />
<div class="pda"><a href="t-266103.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=266103">Please help to create function StrToCodes</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Raveren</div><div class="date">18th February 2007, 23:02</div></div><div class="posttext">Please help to create function StrToCodes<br />
<br />
That she found for instance word Qwerty after passing through this function became aea8baadaba6<br />
<br />
Q  W  E  R  T  Y  U  I  O  P  A  S  D  F  G  H  J  K  L  Z  X  C  V  B  N  M<br />
ae a8 ba ad ab a6 aa b6 b0 af be ac bb b9 b8 b7 b5 b4 b3 a5 a7 bc a9 bd b1 b2<br />
<br />
q  w  e  r  t  y  u  i  o  p  a  s  d  f  g  h  j  k  l  z  x  c  v  b  n  m<br />
8e 88 9a 8d 8b 86 8a 96 90 8f 9e 8c 9b 99 98 97 95 94 93 85 87 9c 89 9d 91 92<br />
<br />
1  2  3  4  5  6  7  8  9  0<br />
ce cd cc cb ca c9 c8 c7 c6 cf<br />
<br />
`  -  =  ~  !  @  #  $  %  ^  &amp;  *  (  )  _  +  {  }  |  [  ]  \  ;  '  :  &quot;  ,  .  /  &lt;  &gt;  ?<br />
9f d2 c2 81 de bf dc db da a1 d9 d5 d7 d6 a0 d4 84 82 83 a4 a2 a3 c4 d8 c5 dd d3 d1 d0 c3 c1 c0<br />
<br />
Sorry for bad English</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">19th February 2007, 05:08</div></div><div class="posttext">The tricky part of this is the conversion from a single character to ASCII. A function in the wiki does that; the rest was pretty straight-forward.<br />
<br />
The codes you want to convert the letters into are inverted ASCII (ASCII that has been subtracted from 255).<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">19th February 2007, 05:13</div></div><div class="posttext">The attached should work.  (I've not tested it very well, but from the little I did, it works.)<br />
<br />
It relies on outputing a &quot;translation file&quot; (basically a config file I use to &quot;look up&quot; each letter of the string.)  It relies on logiclib, ConfigReadS, and ConfigWriteS.<br />
<br />
One problem, however, is that I wasn't able to write the translation code for the backward quote (`).  Not sure whether or not this is a bug with NSIS.<br />
<br />
Here's the line that failed:<br />
<br />
${ConfigWriteS} &quot;${TranslatorFile}&quot; &quot;`=&quot; &quot;9f&quot; $1<br />
<br />
<br />
Maybe someone else would have some suggestions.<br />
<br />
Since it uses a file, speed might become an issue if you have to translate large sets of data.  (If you need to boost performance, you might try using the NSIS Array plugin instead of a file to use for the lookup table).<br />
<br />
I've wrapped it into an NSH file.  Usage is simple:<br />
1)  Include TextToCode.nsh in the top of your script<br />
2)  Add the command ${InitTranslator} to .OnInit<br />
3)  to translate text, use ${TextToCode} &quot;text&quot; $var (where $var is your output variable)<br />
<br />
See the attached sample.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">19th February 2007, 05:15</div></div><div class="posttext">hmm... I must have posted the same time as demiller9...<br />
<br />
I was thinking it looked like HEX codes, but they didn't seem to be the same HEX codes as a regular PC uses.  (Maybe I'm wrong?)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Raveren</div><div class="date">19th February 2007, 09:27</div></div><div class="posttext">Thanks <br />
<br />
Both of a variant approach, but at demiller9 the idle time (that that is necessary) <br />
<br />
Sorry for bad English =)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">19th February 2007, 13:55</div></div><div class="posttext">Comperio  wrote:I was thinking it looked like HEX codes, but they didn't seem to be the same HEX codes as a regular PC uses. It is standard hex ASCII that has been XOR'd with FF. I caught onto it when I looked at the codes for the digits 1-9. The Qwerty layout in the original message makes it harder to spot for the letters.<br />
<br />
I didn't check a backquote in my method until I read your post; my test program handles `, ', and &quot; OK.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">berglind</div><div class="date">8th January 2009, 10:30</div></div><div class="posttext">Originally posted by demiller9 <br />
The tricky part of this is the conversion from a single character to ASCII. A function in the wiki does that; the rest was pretty straight-forward.<br />
<br />
The codes you want to convert the letters into are inverted ASCII (ASCII that has been subtracted from 255).<br />
<br />
Don  <br />
<br />
My profound thanks to demiller for saving me tons of time :D Paying it forward, I used this as a base for a URLEncode function and these are the adjustments that I made:<br />
<br />
Add these two lines at the appropriate places:<br />
 !include &quot;WordFunc.nsh&quot;<br />
 !insertmacro WordFind<br />
<br />
And then this is URLEncode function, based on demiller's StrToCodes (with un-inverted ASCII :) )<br />
<br />
Function UrlEncode<br />
  Exch $0 ; save $0, get string<br />
  Push $1<br />
  Push $2<br />
<br />
  StrCpy $2 &quot;&quot;				; initialize the output codes<br />
  ${While} $0 != &quot;&quot;<br />
	StrCpy $1 $0 1			; get a single char<br />
	${If} $1 == &quot; &quot;         ; space becomes +<br />
        StrCpy $2 &quot;$2+&quot;<br />
    ${Else}<br />
        ${WordFind} ${SAFECHARS} $1 &quot;E+1{&quot; $R0<br />
        IfErrors convert copy ; error means the character was not found in the safechars string<br />
      convert:<br />
        Push $1<br />
	    Call CharToASCII		; convert a char to ascii value<br />
	    Pop $1<br />
	    IntFmt $1 &quot;%02x&quot; $1		; convert ascii to hex<br />
	    StrCpy $2 &quot;$2%$1&quot;		; append new code to previous codes<br />
	    goto continue<br />
      copy:<br />
        StrCpy $2 &quot;$2$1&quot;<br />
      continue:<br />
    ${Endif}<br />
	StrCpy $0 $0 &quot;&quot; 1		; remove first character<br />
  ${EndWhile}<br />
  Exch $2				; return the result<br />
  Exch 2<br />
  Pop $0				; restore registers<br />
  Pop $1<br />
FunctionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>