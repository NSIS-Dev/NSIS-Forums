<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problems on creating new page in NSIS with checkbox etc, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problems on creating new page in NSIS with checkbox etc NSIS Discussion" />
	
	<title> Problems on creating new page in NSIS with checkbox etc [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problems on creating new page in NSIS with checkbox etc</div>
<hr />
<div class="pda"><a href="t-372298.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=372298">Problems on creating new page in NSIS with checkbox etc</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">30th September 2013, 13:34</div></div><div class="posttext">I want to insert a new page in the installation which contains two checkbox client version and server version.on clicking client version nothing special happens as of now. But if server version selected then a browse option should come to select a folder(This is not a installation folder). I am finding some difficulties to do this. I have added two checkbox a text box and browse button.In the onchange of checkbox i make browse and textbox. <br />
<br />
<br />
But now the problem is <br />
I want only one checkbox to be checked at a time.<br />
<br />
When server version checked browse option should appear(which works now) ,but if it is unchecked again then that browse option should disappear.(which does not work because i was not able to write code for that)<br />
<br />
If i click next on this page and then come back to same page using back then all controls or checkbox i checked should be as it is. But now those browse options will disappear even if server version checkbox is selected(As i have not done proper coding for this also)<br />
<br />
So please help me to do all these things. Also help me if there any other method to do the same<br />
<br />
<br />
; Script generated by the HM NIS Edit Script Wizard.<br />
<br />
; HM NIS Edit Wizard helper defines<br />
!define PRODUCT_NAME &quot;My application&quot;<br />
!define PRODUCT_VERSION &quot;1.0&quot;<br />
<br />
Var Dialog<br />
Var Text<br />
Var Text_State<br />
Var Checkbox<br />
Var Checkbox1<br />
Var Checkbox_State<br />
Var Checkbox1_State<br />
var /GLOBAL SOURCETEXT<br />
var /global SOURCE<br />
var /global BROWSESOURCE<br />
; MUI 1.67 compatible ------<br />
!include &quot;MUI.nsh&quot;<br />
!include nsDialogs.nsh<br />
<br />
; MUI Settings<br />
!define MUI_ABORTWARNING<br />
!define MUI_ICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico&quot;<br />
!define MUI_UNICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico&quot;<br />
<br />
; Welcome page<br />
!insertmacro MUI_PAGE_WELCOME<br />
Page custom InstallPageCreate checkinstdir<br />
; Directory page<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
; Instfiles page<br />
!insertmacro MUI_PAGE_INSTFILES<br />
; Finish page<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
; Uninstaller pages<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
; Language files<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
; MUI end ------<br />
<br />
Name &quot;${PRODUCT_NAME} ${PRODUCT_VERSION}&quot;<br />
OutFile &quot;Setup.exe&quot;<br />
InstallDir &quot;$PROGRAMFILES\My application&quot;<br />
ShowInstDetails show<br />
ShowUnInstDetails show<br />
Var InstallPageDialog<br />
Var InstallPage.DirRequest<br />
Var InstallPage.BrowseButton<br />
Var mui.WelcomePage<br />
Var mui.WelcomePage1<br />
Var mui.WelcomePage.Image1<br />
Var mui.WelcomePage.Title<br />
Var mui.WelcomePage.Text<br />
Var ImageHandle<br />
Var mui.WelcomePage.Title.Font<br />
Var LINK<br />
Var LINK.Font<br />
Var clickinstall<br />
Var mui.WelcomePage.Image.Bitmap<br />
var checked<br />
var checked1<br />
Var CheckBox.Font<br />
var mui.WelcomePage1.Title1<br />
var mui.WelcomePage.Title.Font1<br />
Function InstallPageCreate<br />
<br />
    nsDialogs::Create 1044<br />
    Pop $mui.WelcomePage<br />
    nsDialogs::SetRTL $(^RTL)<br />
    SetCtlColors $mui.WelcomePage 0xffffff 0xffffff<br />
<br />
    ${NSD_CreateLabel} 120u 70u 140u 14u &quot;Choose the intallation method&quot;<br />
    Pop $clickinstall<br />
    SetCtlColors $clickinstall &quot;&quot; &quot;ffffff&quot;<br />
<br />
${NSD_CreateCheckbox} 120u 90u 100% 10u &quot;&amp;Client version&quot;<br />
Pop $CheckBox<br />
CreateFont $CheckBox.Font &quot;$(^Font)&quot; &quot;08&quot; &quot;500&quot;<br />
SetCtlColors $CheckBox &quot;&quot; &quot;FFFFFF&quot;<br />
SendMessage $CheckBox ${WM_SETFONT} $CheckBox.Font 0<br />
GetFunctionAddress $0 OnCheckbox1<br />
nsDialogs::OnClick $CheckBox $0<br />
<br />
${NSD_CreateCheckbox} 120u 100u 100% 10u &quot;&amp;Server version&quot;<br />
Pop $CheckBox1<br />
CreateFont $CheckBox.Font &quot;$(^Font)&quot; &quot;08&quot; &quot;500&quot;<br />
SetCtlColors $CheckBox1 &quot;&quot; &quot;FFFFFF&quot;<br />
SendMessage $CheckBox1 ${WM_SETFONT} $CheckBox.Font 0<br />
GetFunctionAddress $0 OnCheckbox2<br />
nsDialogs::OnClick $CheckBox1 $0<br />
<br />
${If} $Checkbox_State == ${BST_CHECKED}<br />
	${NSD_Check} $Checkbox<br />
${EndIf}<br />
${If} $Checkbox1_State == ${BST_CHECKED}<br />
	${NSD_Check} $Checkbox1<br />
${EndIf}<br />
<br />
nsDialogs::Show<br />
<br />
    ;Delete image from memory<br />
    ${NSD_FreeImage} $mui.WelcomePage.Image.Bitmap<br />
<br />
  FunctionEnd<br />
<br />
  Function OnCheckbox2<br />
 <br />
  StrCpy $SOURCE &quot;C:\&quot;<br />
<br />
<br />
	${NSD_CreateText} 120u 120u 80u 12u &quot;$SOURCE&quot;<br />
<br />
	pop $SOURCETEXT<br />
    ${NSD_CreateBrowseButton} 280u 120u 35u 14u &quot;Browse&quot;<br />
    Pop $InstallPage.BrowseButton<br />
    ${NSD_OnClick} $InstallPage.BrowseButton Browsesource<br />
   <br />
<br />
  FunctionEnd<br />
  Function OnCheckbox1<br />
  <br />
<br />
  FunctionEnd<br />
<br />
  Function checkinstdir<br />
       ${NSD_GetText} $Text $Text_State<br />
	${NSD_GetState} $Checkbox $Checkbox_State<br />
  ${If} $Checkbox_State == ${BST_CHECKED}<br />
  strcpy $checked 1<br />
  ${else}<br />
  strcpy $checked 0<br />
  ${Endif}<br />
<br />
  ${NSD_GetState} $Checkbox1 $Checkbox1_State<br />
  ${If} $Checkbox1_State == ${BST_CHECKED}<br />
  strcpy $checked1 1<br />
  ${else}<br />
  strcpy $checked1 0<br />
  ${Endif}<br />
  FunctionEnd<br />
<br />
  Function Browsesource<br />
  nsDialogs::SelectFolderDialog &quot;Select Source Folder&quot; &quot;c:\&quot;<br />
  pop $SOURCE<br />
  ${NSD_SetText} $SOURCETEXT $SOURCE<br />
  FunctionEnd<br />
<br />
<br />
<br />
Section &quot;MainSection&quot; SEC01<br />
SectionEnd<br />
<br />
<br />
<br />
Section -Post<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bnicer</div><div class="date">1st October 2013, 03:42</div></div><div class="posttext">What you're trying to do might not be possible.<br />
<br />
I don't think you can make the Browse button disappear without refreshing the page; to refresh the page, leave the page (Next or Back), and then to return to the page, use Back or Next.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">1st October 2013, 08:25</div></div><div class="posttext">You cannot create elements after the Show command. You need to create all components on the page together, and then hide some of them. In the onclick functions you can then unhide the required components and hide others:<br />
http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.14.17</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">1st October 2013, 09:02</div></div><div class="posttext">Hey I did something like this (https://skydrive.live.com/?cid=02b635f7d896b131&amp;id=2B635F7D896B131%21130&amp;authkey=!AM7QvKhL8NHq63o).<br />
<br />
It works almost perfectly.There may be changes required to improve code structure.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">1st October 2013, 09:05</div></div><div class="posttext">You cannot create elements after the Show command. You need to create all components on the page together, and then hide some of them. In the onclick functions you can then unhide the required components and hide others:<br />
http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.14.17<br />
<br />
Thank you for reply. I have done some changes(see here (https://skydrive.live.com/?cid=02b635f7d896b131&amp;id=2B635F7D896B131%21130&amp;authkey=!AM7QvKhL8NHq63o)) . Any suggestions from your side to improve it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bnicer</div><div class="date">1st October 2013, 11:52</div></div><div class="posttext">Any suggestions from your side to improve it?<br />
<br />
Very good, however if one one checkbox must be checked and both checkboxes also must not be checked at the same time, why nor use radio buttons?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">4th October 2013, 07:21</div></div><div class="posttext">Please check my code here (https://skydrive.live.com/?cid=02b635f7d896b131&amp;id=2B635F7D896B131%21130&amp;authkey=!AM7QvKhL8NHq63o). I am facing small problem. If a user click on browse button and in folder browse dialog if he clicks cancel instead of selecting path then control will be set to &quot;error&quot; . How can i handle this? I want user to select path compulsorily if he has selected server installation. How can i do it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">4th October 2013, 07:30</div></div><div class="posttext">Simply check for a proper path in the $SOURCE variable in your page's leave function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">4th October 2013, 09:19</div></div><div class="posttext">ok how can i display same custom page in the leave function? If i use a leave function for custom page i will give a message to user that path should be selected or some thing else and then i again want to show same custom page. How can i call custom page from the leave function?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">4th October 2013, 10:54</div></div><div class="posttext">Calling 'abort' in the leave function will make the user stay on that page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">4th October 2013, 14:23</div></div><div class="posttext">Calling 'abort' in the leave function will make the user stay on that page.<br />
<br />
Thank you. I was able to do it. Can i get windows user list in nsis? I want user to select any one of the windows user account from a list. The list must contain all windows user accounts of PC.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">5th October 2013, 00:26</div></div><div class="posttext">http://nsis.sourceforge.net/User_Management_using_API_calls#Enumerate_all_users</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">5th October 2013, 05:36</div></div><div class="posttext">I am already using NSD_SetImage to display a image on the custom page. It works properly,but only in my pc where the image exists in path. So to include in setup what should i do? Should i include image file by using 'File' option of nsis or is there any method to do it?<br />
<br />
But !define MUI_WELCOMEFINISHPAGE_BITMAP &quot;D:\Icons\Welcome.bmp&quot; in welcome page shows image properly in all pc. But how to include or load image in custom page?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>