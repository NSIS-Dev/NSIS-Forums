<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Read Input &amp; Insert to Registry, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Read Input &amp; Insert to Registry NSIS Discussion" />
	
	<title> Read Input &amp; Insert to Registry [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Read Input &amp; Insert to Registry</div>
<hr />
<div class="pda"><a href="t-201486.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=201486">Read Input &amp; Insert to Registry</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jshanley</div><div class="date">8th December 2004, 03:23</div></div><div class="posttext">Hi all,<br />
<br />
I'm really trying to wrap my head around NSIS, but I am having a difficult time with it.<br />
<br />
I have one thing I need the installer to do:<br />
<br />
a) Check the registry to see if an(y) email account already exists.  Email accounts are added sequentially by Outlook Express under the key:<br />
<br />
&quot;Software\Microsoft\Internet Account Manager\Accounts\00000001&quot; (or 000000002 etc) <br />
<br />
b) If 00000001 already exists, change the key &quot;SMTP Server&quot; to &quot;smtp.domainname.com&quot; and move on to 000000002 to see if that already exists.  If it does not exist, write a couple registry keys for email settings.<br />
<br />
c) If no email accounts exist, create the 00000001 entry and add subkeys, like:<br />
<br />
POP3 Server <br />
REG_SZ  <br />
mail.domain.com<br />
<br />
POP3 User Name <br />
REG_SZ <br />
userinput@domain.com<br />
<br />
POP3 Prompt for Password <br />
REG_DWORD<br />
0x0<br />
<br />
SMTP Server <br />
REG_SZ  <br />
mail.domain.com<br />
<br />
SMTP Display Name<br />
REG_SZ<br />
User Input Name<br />
<br />
SMTP Email Address <br />
REG_SZ <br />
userinput@domain.com<br />
<br />
<br />
I used InstallOptions to create a page that has fields for them to type this information in.  I am not sure how to &quot;grab&quot; this information and push it to the registry.  If for example the fields are <br />
<br />
Field 5: RealName<br />
Field 6: email address<br />
<br />
I have stuff like this in the function: <br />
<br />
GetDlgItem $1 $hwnd 1204 ; Get RealName Input box (1200 + field 5 - 1)<br />
<br />
But I'm not sure how to move stuff over to the registry.  I'm reading as much as I can as fast as I can, but it's driving me nuts. :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">8th December 2004, 09:07</div></div><div class="posttext">Mate you wanna check out Docs section 4.9.2.16 (http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2.16) for how to write to the Registry.<br />
<br />
To check if a key exists just use  ReadRegStr (http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2.12)  on it, and if it returns &quot;&quot; and sets the error flag, it's not a key (if it returns a value but still sets the error flag then it's just a key of DWORD type, so check for both).<br />
<br />
The way to check the error flag is this:<br />
<br />
<br />
ClearErrors  ; Resets the error flag<br />
; -- Now do the bit with the reading the RegStr<br />
IfErrors errorjump noerrorjump  ; If there are errors jump to the errorjump label, otherwise jump to the noerrorjump label, shown below:<br />
<br />
errorjump:<br />
MessageBox MB_OK &quot;Couldn't write to Registry!&quot;  ; or whatever<br />
<br />
noerrorjump:<br />
; Continue...<br />
<br />
<br />
Hope this helps, a bit random I know!<br />
<br />
-rob-</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>