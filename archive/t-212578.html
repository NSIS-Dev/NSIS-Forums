<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Need code in NSIS &quot;Uninstall Section&quot; to remove program in &quot;Add &amp; Remove Programs, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Need code in NSIS &quot;Uninstall Section&quot; to remove program in &quot;Add &amp; Remove Programs NSIS Discussion" />
	
	<title> Need code in NSIS &quot;Uninstall Section&quot; to remove program in &quot;Add &amp; Remove Programs [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Need code in NSIS &quot;Uninstall Section&quot; to remove program in &quot;Add &amp; Remove Programs</div>
<hr />
<div class="pda"><a href="t-212578.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=212578">Need code in NSIS &quot;Uninstall Section&quot; to remove program in &quot;Add &amp; Remove Programs</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bd2005</div><div class="date">8th April 2005, 03:58</div></div><div class="posttext">Greetings,<br />
<br />
NSIS is excellent btw.  Super great installer tool.<br />
<br />
This question is for WinXP platform only.<br />
<br />
My installer/uninstaller works great, but I need to ALSO uninstall another program located in Control Panel &quot;Add &amp; Remove Programs&quot; if it exists.<br />
<br />
How do I look for the program in Control Panel &quot;Add &amp; Remove Programs&quot; and initiate the &quot;Remove&quot; action from within NSIS Uninstall Section module.<br />
<br />
Thanks,<br />
BD</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pidgeot</div><div class="date">8th April 2005, 04:13</div></div><div class="posttext">If the registry key used by the other programs for uninstall information is static (the same on all machines), just read HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\&lt;program's_folder\UninstallString and execute the file referenced in that key. For example, if I wanted to remove NSIS, I'd do something like this:<br />
<br />
ReadRegStr $0 HKLM \SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\NSIS UninstallString<br />
ExecWait &quot;$0&quot;  <br />
<br />
However, if the uninstaller is not/cannot be automated, note that the application may not be uninstalled after all. If the other application MUST be removed, you can catch the user in a loop until the registry key no longer exists.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bd2005</div><div class="date">8th April 2005, 05:24</div></div><div class="posttext">Hey Pidgeot,<br />
<br />
Thks for the code, upon reviewing the Registry for this path, the program I want to uninstall isn't in this list, it's in &quot;...\CurrentVersion\Installer\UserData\S-1-5....1005\Products\A6......D76\InstallProperties\DisplayName&quot; UninstallString<br />
<br />
where DisplayName is the program I wish to uninstall, DisplayName property is what shows the Application Name in Control Panel to uninstall the program, of which, the uninstall here works fine, I need to force this uninstall automatically.<br />
<br />
my concern is the &quot;S-1-5..1005&quot; and &quot;A6..D76&quot; won't be the same on every computer to properly find this particular program to uninstall if I give this full path.<br />
<br />
Do you know how I can &quot;search&quot; for the DisplayName to match the desired program name via loop, then grab the UninstallString ?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>