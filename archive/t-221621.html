<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" GetVersion plugin, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  GetVersion plugin NSIS Discussion" />
	
	<title> GetVersion plugin [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  GetVersion plugin</div>
<hr />
<div class="pda"><a href="t-221621.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221621">GetVersion plugin</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th July 2005, 16:24</div></div><div class="posttext">A 4kB plugin to get Windows version info:<br />
name, type, version, server name, service pack name, and service pack build.<br />
<br />
http://nsis.sourceforge.net/wiki/File:GetVersion.zip<br />
<br />
Type is e.g. Home Edition<br />
<br />
Edit: I could add other version info stuff later if anyone needs it (i.e. non Windows version stuff).<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">16th July 2005, 17:51</div></div><div class="posttext">So... Stu is learning API, huh? ;)<br />
<br />
:D :up:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">16th July 2005, 18:10</div></div><div class="posttext">Great, but better call it &quot;GetOSversion&quot; to avoid confusion with get FileVersion data.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th July 2005, 18:56</div></div><div class="posttext">I didn't call it that because I may add other version stuff to it, e.g. IE version or perhaps Microsoft Office etc.<br />
<br />
Edit: Just added IEVersion which returns IE version and build.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th March 2006, 13:58</div></div><div class="posttext">New version with support for x64, Longhorn, Vista.<br />
Also added WindowsPlatformId and WindowsPlatformArchitecture functions.<br />
<br />
http://nsis.sourceforge.net/wiki/File:GetVersion.zip<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jamyn</div><div class="date">10th March 2006, 16:31</div></div><div class="posttext">Thanks for this; it is appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sissy</div><div class="date">11th March 2006, 09:51</div></div><div class="posttext">stu<br />
<br />
Great plugin just one slight problem it reports windows media center editon as XP which it is to a degree but would be nice if it could also detect this.<br />
<br />
thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th March 2006, 14:06</div></div><div class="posttext">Right I'll look into it.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th March 2006, 15:11</div></div><div class="posttext">Please try this out (WindowsType function).<br />
http://nsis.sourceforge.net/File:GetVersion.zip<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sissy</div><div class="date">12th March 2006, 12:19</div></div><div class="posttext">Hi Stu,<br />
<br />
Still reports as Windows XP.<br />
<br />
Found this, might give a heads up http://salloway.org.uk/mediacenter/2004/version.htm<br />
<br />
Looks like they read the ident key <br />
<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Media Center\Ident key<br />
<br />
and depending on the value returned determines the version and any patches.<br />
<br />
Hope this helps.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th March 2006, 13:12</div></div><div class="posttext">I did say WindowsType function not WindowsName :p<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">16th July 2006, 07:03</div></div><div class="posttext">hello,<br />
i was using a plugin for windows detection but it is outdated. so i turned to GetVersion.<br />
my software is only for NT platform (NT, 2000, XP, 2003, Vista). can i make a check for this with your plugin ?<br />
i want the installer to check the platform (9x or NT) and ... i'll do the rest... :)<br />
<br />
one more question. what is WindowsPlatformId from your plugin ?<br />
<br />
thanks,<br />
OJi.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th July 2006, 10:32</div></div><div class="posttext">1) GetVersion::WindowsName will return e.g. &quot;Windows 2000&quot;<br />
2) Each Windows has a different Platform ID, like 1 2 3 etc. You should be able to find something about this on Google.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th July 2006, 10:34</div></div><div class="posttext">I am going to rebuild the plugin just to return 2000 if /short is specified as a parameter.<br />
<br />
Edit: Now returns e.g. 2000 instead of Windows 2000.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">16th July 2006, 11:09</div></div><div class="posttext">thanks, i will try it.<br />
<br />
OJi.<br />
<br />
edit - the version from wiki is still from april. please post a reply when you upload the new version.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th July 2006, 11:18</div></div><div class="posttext">Uploaded.<br />
<br />
By the way, the DLL uses .NET because some of its features are only supported by .NET (i.e. Vista detection).<br />
So, you might want to test the DLL on a system without Microsoft .NET Framework installed.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">16th July 2006, 11:20</div></div><div class="posttext">i will. thanks again.<br />
<br />
OJi.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">{_trueparuex^}</div><div class="date">16th July 2006, 11:43</div></div><div class="posttext">Originally posted by Afrow UK <br />
Uploaded.<br />
<br />
By the way, the DLL uses .NET because some of its features are only supported by .NET (i.e. Vista detection).<br />
So, you might want to test the DLL on a system without Microsoft .NET Framework installed.<br />
<br />
-Stu <br />
I tried the plug-in in Windows 2000 pro without .NET and it works. Only thing is that WindowsServerName doesn't return anything, no errors nothing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th July 2006, 16:19</div></div><div class="posttext">What would have expected it to return?<br />
There may be a bug.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">{_trueparuex^}</div><div class="date">16th July 2006, 20:24</div></div><div class="posttext">Originally posted by Afrow UK <br />
What would have expected it to return?<br />
There may be a bug.<br />
<br />
-Stu  <br />
Not sure, but it should return Workstation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th July 2006, 21:57</div></div><div class="posttext">What is in &quot;HKLM\SYSTEM\CurrentControlSet\Control\ProductOptions\ProductType&quot;?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">{_trueparuex^}</div><div class="date">17th July 2006, 11:20</div></div><div class="posttext">It's &quot;WinNT&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">27th July 2006, 15:55</div></div><div class="posttext">FYI:<br />
I just downloaded your latest version and found that IE detection is returning 6.0 when I have 7.0 installed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th July 2006, 17:28</div></div><div class="posttext">I may remove that function. You can read the IE version from the registry. Infact there's a function in the NSIS documentation under Useful Scripts which reads from the registry. Does that work?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">27th July 2006, 17:42</div></div><div class="posttext">Yep, that works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th July 2006, 17:51</div></div><div class="posttext">The plugin function reads the version value from shdocvw.dll<br />
I guess they have left it as 6.0 or something.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">28th July 2006, 03:38</div></div><div class="posttext">Yep, right you are.  I just checked mine and it is version 6.0.2900.2919.<br />
<br />
edit:<br />
Just to let you know, I've OK with just reading the registry.  I only mentioned the problem because you had a feature that didn't work as designed.  ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th July 2006, 10:38</div></div><div class="posttext">Thanks :)<br />
I will remove the function soon.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hywkar</div><div class="date">14th July 2008, 13:44</div></div><div class="posttext">Is there an easy way to detect if the operating system is windows server 2000? I tried the latest release and on windows 2000 server it gives me &quot;Windows 2000 version 5.0 (Type : Professional, Server Name : )&quot;.<br />
<br />
<br />
<br />
 GetVersion::WindowsName<br />
 Pop $0<br />
 GetVersion::WindowsType<br />
 Pop $1<br />
 GetVersion::WindowsServerName<br />
 Pop $2<br />
 GetVersion::WindowsVersion<br />
 Pop $3<br />
<br />
 DetailPrint &quot;Windows $0 version $3 (Type : $1, Server Name : $2)&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MP_chefkoch</div><div class="date">14th July 2008, 16:16</div></div><div class="posttext">Hi Stuart,<br />
<br />
you posted that you maybe will include more products or version checks.<br />
<br />
What do you think about including a version check for .Net, which will work with dotNet 1, 2 and 3.<br />
<br />
In wiki is a script which is able to do that and it seems to work like a charme, but maybe it would be cool to have it in this plugin, so no additional scripts are needed.<br />
<br />
kind regards<br />
chefkoch</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">4th November 2008, 14:11</div></div><div class="posttext">Hey,<br />
<br />
Can you update the plugin for windows Server 2008 versions and (maybe) future windows 7 ?<br />
<br />
thanks,<br />
OJi.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xbarns</div><div class="date">6th January 2009, 15:31</div></div><div class="posttext">Hi Stuart,<br />
<br />
any plans of making this work with the unicode version of NSIS?<br />
<br />
I tried and only get nice little &quot;boxes&quot; and some numbers back :)<br />
<br />
regards<br />
xBarns</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark.ruys</div><div class="date">27th January 2009, 19:05</div></div><div class="posttext">Originally posted by xbarns <br />
Hi Stuart,<br />
<br />
any plans of making this work with the unicode version of NSIS?<br />
<br />
I tried and only get nice little &quot;boxes&quot; and some numbers back :)<br />
<br />
regards<br />
xBarns  <br />
<br />
I did build a Unicode GetVersion.dll to be used with Jim Park's excellent port. I encountered a problem however: generated installers seem to be running in XP-compatibility mode. As a result, GetVersion will report Windows XP SP2 on a Vista machine. I'll try to contact Jim to figure out how to fix it.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th January 2009, 20:09</div></div><div class="posttext">You need to use RequestExecutionLevel to avoid Vista's compatibility hacks. If it doesn't work, there might be a problem with the embedded manifest. Maybe it was converted to UTF-16 as well though it should stay UTF-8.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark.ruys</div><div class="date">28th January 2009, 07:58</div></div><div class="posttext">Originally posted by kichik <br />
You need to use RequestExecutionLevel to avoid Vista's compatibility hacks. If it doesn't work, there might be a problem with the embedded manifest. Maybe it was converted to UTF-16 as well though it should stay UTF-8.  <br />
<br />
The manifest is all right. For some reason the generated installer ran in Windows XP compatiblity mode. And not for me, but for &quot;all users&quot;: right-click icon, properties, compatibility, settings for all users. Ticking that one off, and GetVersion.dll returns Vista again.<br />
<br />
I rebuild GetVersion.dll and Processes.dll for Unicode. Now I can roll out our installer with Unicode language strings :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cowwoc</div><div class="date">31st January 2009, 02:27</div></div><div class="posttext">How about adding support for detecting Vista 64-bit and Windows 7?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">31st January 2009, 08:34</div></div><div class="posttext">you already have a header with 64 bit stuff.<br />
<br />
7 is not out yet so we can't be 100% sure what the version number is, probably 6.1.XXXX</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Miguel Ventura</div><div class="date">4th May 2009, 15:34</div></div><div class="posttext">Hi<br />
<br />
Could you please introduce a function to return the value from wServicePackMajor and/or wServicePackMinor to complement the existing WindowsServicePack which uses szCSDVersion? It's just that the string in szCSDVersion is localized and therefore harder to parse (you have to look for the number assuming that instead of &quot;Service Pack&quot; you can get something else).<br />
<br />
Thanks for the great plugin<br />
<br />
Best regards,<br />
Miguel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">4th May 2009, 16:07</div></div><div class="posttext">I'm afraid I do not have the tools available to build this plugin at this time (nor can I install them because I am on Vista here).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">9th June 2009, 14:38</div></div><div class="posttext">There is a new version of WinVer.nsh that does detect Windows 7.  I have the latest build, RC-1 on my laptop.  I am willing to test GetVersion on it, as I need to have routines in my installers that detect Windows 7.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">9th June 2009, 18:48</div></div><div class="posttext">where do i get exdll.h and other dependencies so i can build my own copy so i can try to add win7 items?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">9th June 2009, 19:03</div></div><div class="posttext">download the source @ http://sourceforge.net/project/showfiles.php?group_id=22049&amp;package_id=15374<br />
<br />
or browse the code directly:<br />
http://nsis.svn.sourceforge.net/viewvc/nsis/NSIS/trunk/Contrib/ExDLL/<br />
<br />
and <br />
<br />
http://nsis.svn.sourceforge.net/viewvc/nsis/NSIS/trunk/Source/exehead/api.h?revision=5917&amp;view=markup</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TJK</div><div class="date">25th June 2009, 14:29</div></div><div class="posttext">Hello<br />
<br />
I currently use GetVersion to successfully control the scripts behaviour dependent on the Windows version and architecture.<br />
<br />
I see that WinVer.nsh is updated to include the ability to detect Windows 7 and Windows Server 2008 R2 - but since I already use GetVersion I'd prefer to continue using it rather than to switch to WinVer.nsh.<br />
<br />
Will GetVersion be similarly updated to detect and report Windows 7 and Windows Server 2008 R2 and if so does anyone have any idea when - or is GetVersion no longer being updated?<br />
<br />
Thanks<br />
<br />
Tim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PadaKwaak</div><div class="date">24th July 2009, 01:00</div></div><div class="posttext">TJK, you could, for the while being, identify Windows 7 by checking both WindowsServerName and WindowsVersion.<br />
The WindowsVersion would report 6.1 for Windows7/Windows Server 2008 R2.<br />
The WindowsServerName would be blank for Windows 7 &amp; filled in for Windows Server 2008 R2.<br />
<br />
I have included the modifications for Windows 7/Windows Server 2008 R2 and compiled it with Visual C++ 2008 Express, which resulted in the DLL being 21kB! Here is the dll &amp; modified source: http://www.mediafire.com/?sharekey=9a5aa440977959f3e62ea590dc5e5dbbe04e75f6e8ebb871<br />
<br />
I haven't tested it for Vista &amp; Windows 7 yet.<br />
A friend of mine got the following error when he used my dll in Win7 x64 :( &quot;Could not load: C:\Users\ludwig\AppData\Local\Temp\nszCDEE.tmp\GetVersion.dll&quot;<br />
I guess it has to do with .NetFX.<br />
<br />
Regards<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th July 2009, 13:46</div></div><div class="posttext">I have updated the plugin.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TJK</div><div class="date">24th July 2009, 15:17</div></div><div class="posttext">Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Miguel Ventura</div><div class="date">20th August 2009, 17:19</div></div><div class="posttext">Stu please also add functions to get from wServicePackMajor and wServicePackMinor instead of the localized WindowsServicePack using szCSDVersion<br />
<br />
I've added those functions (I'm attaching them). I'm just not sharing the binary DLL 'cause it gets huge (100+KB) when I compile it here.<br />
<br />
Best regards,<br />
Miguel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st August 2009, 15:51</div></div><div class="posttext">Thanks, done.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ts1612</div><div class="date">14th September 2009, 13:44</div></div><div class="posttext">First of all thanks for the very great plugin ;) <br />
<br />
When you display the architecture you return just 32 or 64, but not the processor architecture like AMD64, IA64, EM64T, x64. But sometimes it would be important to know things exactly (e.g. if you want to auto install Net Framework 2.0 the installers of MS are depending on the architecture as the installer is different for IA64 and x64). <br />
<br />
I totally understand, that in most cases the result 32 or 64 is enough, but why not making an additional function GetVersion::WindowsProcessorArchitecture which shows the processor architectiure string.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">17th October 2009, 15:50</div></div><div class="posttext">Hey Stu,<br />
<br />
thank for this plugin. I've updated the download version information and the changelog on the download page.<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">th_mi</div><div class="date">20th October 2009, 12:33</div></div><div class="posttext">Unfortunately this plugin lacks of detecting the real windows version if the installer is started under compatibility settings.<br />
<br />
In this case &quot;GetVersionEx&quot; returns the values of the OS selected in the compatibility settings, not the real installed OS!<br />
<br />
See the MSDN:<br />
Link: http://msdn.microsoft.com/en-us/library/ms724451(VS.85).aspx<br />
<br />
&quot;If compatibility mode is in effect, the GetVersionEx function reports the operating system as it identifies itself, which may not be the operating system that is installed. For example, if compatibility mode is in effect, GetVersionEx reports the operating system that is selected for application compatibility.&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">20th October 2009, 14:28</div></div><div class="posttext">And this is a fight you will ALWAYS lose, you could check the version of system dll's etc, but in the end, if the OS wanted to, it could lie about those also, that's the whole point of forcing a compatibility setting</div></div><hr />


<div class="post"><div class="posttop"><div class="username">th_mi</div><div class="date">21st October 2009, 11:34</div></div><div class="posttext">Originally posted by Anders <br />
And this is a fight you will ALWAYS lose<br />
No! Microsoft itself give the advice to find out the version by checking the OS properties and the version number of i.e. kernel DLL. This is a very save way to find out the real OS.<br />
And I'm sure this possibility will never be disabled since it will be always necessary to get the real OS version, since Win2000, XP, Vista and Seven hape parts with annoying different behaviour which is handled differently.<br />
<br />
The article postet at Monday, February 26, 2007 is very interesting and points out reliable possibilities:<br />
<br />
http://17slon.com/blogs/gabr/2007_02_01_archive.html</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gummibrot@gmx.n</div><div class="date">19th May 2010, 10:57</div></div><div class="posttext">Hi there, <br />
<br />
I tried to use this promising plugin for my installer project, but when I do so, I'm getting some strange results from the functions. See attached file.<br />
<br />
I seems that the result string of GetVersion::WindowsType is translated into chinese or some other &quot;cryptic&quot; language thing.<br />
<br />
Installer is run in English. But I use unicode version of NSIS to be able to install in Japanese.<br />
All other strings I use are displayed correctly.<br />
<br />
My system setup:<br />
Windows XP Professional SP3, German<br />
<br />
Any ideas?<br />
<br />
Thanks,<br />
Jo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th May 2010, 11:05</div></div><div class="posttext">The plug-in is not Unicode. It needs rebuilding (among mods). I haven't got the time to do it at the moment.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">19th May 2010, 12:02</div></div><div class="posttext">you could try http://nsis.sourceforge.net/CallAnsiPlugin_plug-in (Does not work on every plugin, but you can always give it a shot)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th July 2010, 17:49</div></div><div class="posttext">Finally got around to building a Unicode version along with some other changes. Uploaded v1.2.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">11th July 2010, 13:16</div></div><div class="posttext">When I tried using version 1.2 of the GetVersion (ANSI) plugin on my Windows 7 Professional 64-bit system GetVersion::WindowsType reported &quot;Business&quot; instead of &quot;Professional&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th July 2010, 16:18</div></div><div class="posttext">It does that for me too. I am using the correct constant values defined in winnt.h so it must be right.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">11th July 2010, 17:20</div></div><div class="posttext">I think the plugin should be returning &quot;Professional&quot; when it is run on a Windows 7 Professional system.<br />
<br />
I found this on MSDN:<br />
<br />
The following table indicates the product types that were introduced in 6.1.0.0, and what they will map to if GetProductInfo is called with version 6.0.0.0 on a 6.1.0.0 system.<br />
New for 6.1.0.0            Value returned with 6.0.0.0<br />
PRODUCT_PROFESSIONAL       PRODUCT_BUSINESS<br />
PRODUCT_PROFESSIONAL_N     PRODUCT_BUSINESS_N<br />
PRODUCT_STARTER_N          PRODUCT_STARTER<br />
<br />
See  http://msdn.microsoft.com/en-us/library/ms724358(VS.85).aspx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th July 2010, 16:53</div></div><div class="posttext">Uploaded v1.3.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">12th July 2010, 18:29</div></div><div class="posttext">Thanks for the new version of the plugin.<br />
<br />
GetVersion::WindowsType now reports &quot;Professional&quot; when used on my Windows 7 Professional 64-bit system.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">23rd July 2010, 17:38</div></div><div class="posttext">Fixed Unicode build (Visual Studio's fault for not retaining UNICODE define when upgrading the vcproj from 2005 to 2010).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jksoft</div><div class="date">12th October 2010, 14:49</div></div><div class="posttext">I just downloaded the latest version of the GetVersion plugin from the NSIS website and there appears to be a bug.  When I do my GetVersion::WindowsType call, it is popping up a message box that says Professional in the title and Professional in the box itself.  It looks like some debug code may have been left in.  It is version 1.4.0.1.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jksoft</div><div class="date">12th October 2010, 14:50</div></div><div class="posttext">I guess since you have include the source, I could also recompile it but just wanted to make you aware.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th October 2010, 16:59</div></div><div class="posttext">Thanks, fixed.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BoscoBilly</div><div class="date">25th March 2011, 21:58</div></div><div class="posttext">My app needs to run in the compatability mode on win7 64.<br />
My NSIS installer mis-identifies the OS as Windows Vista 64 bit rather than Win7.<br />
Is this the same problem mentioned above, wherein CM will set an OS, not necessarily the installed OS, so that winver is mislead?<br />
Is there a way to detect the correct installed OS at this time?<br />
Thx.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">26th March 2011, 00:26</div></div><div class="posttext">Kernel32::CreateRemoteThreadEx is new in Win7, you could check for it by calling GetProcAddress with the system plugin:<br />
<br />
!include LogicLib.nsh<br />
<br />
System::Call 'Kernel32::LoadLibraryA(m &quot;Kernel32&quot;)i.s'<br />
System::Call 'Kernel32::GetProcAddress(is,m &quot;CreateRemoteThreadEx&quot;)i.r0'<br />
${If} $0 &lt;&gt; 0<br />
	MessageBox mb_ok Seven+<br />
${EndIf}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BoscoBilly</div><div class="date">26th March 2011, 00:37</div></div><div class="posttext">Thanks, Anders.<br />
I'll check this out.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sols_HeG</div><div class="date">1st August 2012, 08:42</div></div><div class="posttext">Hi there,<br />
<br />
are you still working on this PlugIn?<br />
I would like to check a Windows Server 2012<br />
<br />
Great PlugIn bytheway ;)<br />
<br />
Greetings from Munich<br />
heg</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st August 2012, 12:15</div></div><div class="posttext">I will upload the plug-in at some point but I would recommend that you can use this instead anyway... It's an updated version of WinVer.nsh which is bundled with NSIS: http://www.afrowsoft.co.uk/dl/WinVer.nsh<br />
<br />
${If} ${IsWin2008}<br />
...<br />
<br />
Edit: Anders has rightly pointed out that as Windows 8 is not out yet the version number could be different in the final product. This may not be likely but use this at your own risk!<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NgocHuyPAV</div><div class="date">11th August 2012, 04:06</div></div><div class="posttext">Thank Afrow UK. I used GetVersion 6 months ago. It's good! But GetVersion plugin doesn't support Win 8! Can you upgrade for GetVersion plugin? I'm look forward to hearing your answer! Thank you!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th August 2012, 11:45</div></div><div class="posttext">See the post above yours.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>