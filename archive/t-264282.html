<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" [Help]how to detect a program is running?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  [Help]how to detect a program is running? NSIS Discussion" />
	
	<title> [Help]how to detect a program is running? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  [Help]how to detect a program is running?</div>
<hr />
<div class="pda"><a href="t-264282.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=264282">[Help]how to detect a program is running?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">24th January 2007, 18:20</div></div><div class="posttext">Hi All,<br />
<br />
I have installed my application (named myApp.exe, it is windows Form application),however, when I try to unistall this application. How can I detect if this program is running, normally we will to do this:<br />
when uninstalling, if detecting this application is running, we should force to close it.(At least close the window, don't want users to use anymore). Then we delete this file right away, don't wait till reboot the computer.<br />
<br />
So how to detect program running in NSIS,if found,how to force to close it down so that we can delete the files right away!<br />
<br />
Please help me out so that i can meet the project deadline.<br />
Thank you very much.<br />
<br />
James</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th January 2007, 18:31</div></div><div class="posttext">A similar recent thread,<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=262969</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">24th January 2007, 18:53</div></div><div class="posttext">But it seems that they are using one plugin dll file, when can i download it to test?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th January 2007, 19:12</div></div><div class="posttext">Like every nsis plugin at wiki,<br />
http://nsis.sourceforge.net/Developer_Center</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">24th January 2007, 20:08</div></div><div class="posttext">Thank you , Red Wine.<br />
<br />
One more thing, I can detect the program running, how can I kill it (just force to close the window). Then i can delete the exe and dll files....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th January 2007, 20:17</div></div><div class="posttext">I think the idea of the author on the above thread (pop up a custom page or a message box and ask users to terminate the application before uninstall) is the right way to go.<br />
If you anyway wish to kill it, you may do it either by FindWindow and SendMessage or with NsProcess plugin,<br />
http://nsis.sourceforge.net/NsProcess_plugin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">24th January 2007, 21:17</div></div><div class="posttext">http://forums.winamp.com/showthread.php?s=&amp;threadid=259546<br />
humm - forget it... (Update)<br />
<br />
&quot;Processes::FindProcess&quot; / &quot;Processes::KillProcess&quot; do it same way, or &quot;fct&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">24th January 2007, 22:04</div></div><div class="posttext">Yeah. Thank you guys. I have don't this part.....Cheers.<br />
<br />
one more stuip question:<br />
how can i make one function then both install and uninstall can call it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th January 2007, 22:11</div></div><div class="posttext">There you are :)<br />
http://nsis.sourceforge.net/Macro_vs_Function</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">24th January 2007, 22:44</div></div><div class="posttext">Red Wine,<br />
<br />
you are the rock. Thank you very very much.......<br />
<br />
James</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th January 2007, 23:04</div></div><div class="posttext">Indeed :) I've been in Woodstock...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">25th January 2007, 08:19</div></div><div class="posttext">NsProcess based on the KillProcDLL (http://nsis.sourceforge.net/KillProcDLL_Manual), so MSDN warning touchs both plug-ins:<br />
The TerminateProcess function is used to unconditionally cause a process to exit. Use it only in extreme circumstances. The state of global data maintained by dynamic-link libraries (DLLs) may be compromised if TerminateProcess is used rather than ExitProcess.<br />
If your application has window Find-Close-Terminate (http://nsis.sourceforge.net/FCT_plug-in) would be better.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>