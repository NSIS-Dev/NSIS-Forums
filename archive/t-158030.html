<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Hide the MUI_PAGE_STARTMENU page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Hide the MUI_PAGE_STARTMENU page NSIS Discussion" />
	
	<title> Hide the MUI_PAGE_STARTMENU page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Hide the MUI_PAGE_STARTMENU page</div>
<hr />
<div class="pda"><a href="t-158030.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=158030">Hide the MUI_PAGE_STARTMENU page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">fabiochelly</div><div class="date">29th November 2003, 18:23</div></div><div class="posttext">Hi,<br />
<br />
I juste begin with NSIS.<br />
<br />
I have in my script an optional section named 'secStartMenuShortcuts' which creates the shortcuts for my application.<br />
<br />
I also have enabled the Start menu page (!define MUI_STARTMENUPAGE_NODISABLE)<br />
<br />
The problem is that I would like to show the StartMenu page only if the startmenu section has been enabled by the user.<br />
<br />
Does anyone know how to do it?<br />
<br />
Thanks,<br />
Fabio Chelly</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th November 2003, 19:08</div></div><div class="posttext">Define a pre function (MUI_PAGE_CUSTOMFUNCTION_PRE) and call Abort if the section is selected (SectionGetFlags or !include Sections.nsh, !insertmacro SectionFlagIsSet).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabiochelly</div><div class="date">30th November 2003, 09:35</div></div><div class="posttext">Thank you for the answer.<br />
The problem is that I don't know how to define a pre function with the modern UI.<br />
My call is like this:<br />
!insertmacro MUI_PAGE_STARTMENU Application $ICONS_GROUP<br />
<br />
Where do I define a pre function for this page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th November 2003, 09:58</div></div><div class="posttext">Right above the macro.<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE pre<br />
!insertmacro MUI_PAGE_STARTMENU &quot;start menu page id&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabiochelly</div><div class="date">30th November 2003, 10:23</div></div><div class="posttext">I get the following error:Error: resolving install function &quot;pre&quot; in function &quot;mui.StartmenuPre_58.5.12&quot;<br />
Note: uninstall functions must begin with &quot;un.&quot;, and install functions must notHere is my code:<br />
  Function MUI_PAGE_CUSTOMFUNCTION_PRE<br />
   MessageBox MB_YESNO &quot;Do you want to skip the startmenu page?&quot; IDNO no<br />
     Abort<br />
   no:<br />
  FunctionEnd<br />
<br />
<br />
  !insertmacro MUI_PAGE_COMPONENTS<br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  <br />
  !define MUI_PAGE_CUSTOMFUNCTION_PRE pre<br />
  !insertmacro MUI_PAGE_STARTMENU Application $ICONS_GROUP<br />
  <br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_UNPAGE_INSTFILES</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th November 2003, 10:29</div></div><div class="posttext">MUI_PAGE_CUSTOMFUNCTION_PRE is the name of the define, not the function. The value of the define should the name of the function. Simply change the function's name to 'pre' in the above example.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabiochelly</div><div class="date">30th November 2003, 10:53</div></div><div class="posttext">Thank you very much. The pre function works perfectly now.<br />
But now I have a problem with SectionFlasgIsSet: the following code doesn't work.  Function SkipStartMenu<br />
    !insertmacro SectionFlagIsSet SecShortcutStartMenu ${SF_SELECTED} IsSel IsNotSel<br />
    IsNotSel:<br />
      Abort<br />
    IsSel:<br />
  FunctionEndMaybe it doesn't work because 'SecShortcuts' is a section included in a parent section 'SecShortcuts'?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabiochelly</div><div class="date">30th November 2003, 12:05</div></div><div class="posttext">That's OK. In fact I didn't put the function AFTER my section definition.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">30th November 2003, 15:14</div></div><div class="posttext">hi!<br />
<br />
i've solved the same problem yesterday, with the attached function. parts of it are from another thread right in this forum.<br />
<br />
here's the code:<br />
Var SMP<br />
<br />
!define		MUI_PAGE_CUSTOMFUNCTION_PRE Startmenu<br />
!insertmacro	MUI_PAGE_STARTMENU smid $SMP<br />
<br />
Section $(sec_startmenu) s_s<br />
  ...<br />
SectionEnd<br />
<br />
Function Startmenu<br />
	StrCpy	$R1 &quot;1&quot;<br />
	SectionGetFlags ${s_s} $R0<br />
	IntOp	$R0 $R0 &amp; $R1 <br />
	StrCmp	$R0 $R1 +2 0 <br />
	Abort<br />
FunctionEnd <br />
<br />
it works great.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>