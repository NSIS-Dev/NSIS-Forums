<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Calling third-party dll using Next button on custom page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Calling third-party dll using Next button on custom page NSIS Discussion" />
	
	<title> Calling third-party dll using Next button on custom page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Calling third-party dll using Next button on custom page</div>
<hr />
<div class="pda"><a href="t-228787.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228787">Calling third-party dll using Next button on custom page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MishaWTW</div><div class="date">19th October 2005, 08:27</div></div><div class="posttext">Hi. I've created custom page with some edit controls and want to call function from my DLL when Next button is pressed. Then strange things happen. If there is no controls with NOTIFY flag on my page, but Next (which &quot;has&quot; NOTIFY always), installer freezes/crashes while calling the function. If I add some button with NOTIFY flag, it's all ok. It doesn't matter, if I use that added button, or no. <br />
NSIS 2.09<br />
<br />
There is my custom page leave function:<br />
<br />
Function leaveserver<br />
  ReadINIStr $1 &quot;$PLUGINSDIR\setup.ini&quot; &quot;Settings&quot; &quot;State&quot;<br />
  StrCmp $1 0 Exit<br />
  Abort<br />
  Exit:<br />
  Call CheckSQL  <br />
  StrCmp $1 0 +2 +1<br />
  Abort<br />
FunctionEnd<br />
<br />
...and CheckSQL func...<br />
<br />
Function CheckSQL<br />
  SetPluginUnload alwaysoff<br />
  SetOutPath $TEMP            <br />
  Delete $TEMP\InstallDll.dll<br />
  IfFileExists $TEMP\InstallDll.dll +2 +1 <br />
  File DLL\InstallDll.dll                  ; copy dll there<br />
  ReadINIStr $1 &quot;$PLUGINSDIR\setup.ini&quot; &quot;Field 5&quot; &quot;State&quot;     <br />
  ReadINIStr $2 &quot;$PLUGINSDIR\setup.ini&quot; &quot;Field 6&quot; &quot;State&quot;     <br />
  ReadINIStr $3 &quot;$PLUGINSDIR\setup.ini&quot; &quot;Field 1&quot; &quot;State&quot;       <br />
  System::Call '$TEMP\InstallDll::Mess(t,t,t) i(r1,r2,r3).r1'<br />
  SetPluginUnload manual<br />
  System::Free 0<br />
FunctionEnd<br />
<br />
Current workaround: Added button with NOTIFY flag, disabled and hidden below edit control.<br />
ps: Sorry for my buggy English.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th October 2005, 19:22</div></div><div class="posttext">Can you attach a complete minimal example and more information? I can't reproduce the problem. Maybe it also happens with some plug-ins that come with the default package?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>