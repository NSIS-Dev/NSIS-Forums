<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" SetRegView 32 doesn't seem to do what it's supposed to, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  SetRegView 32 doesn't seem to do what it's supposed to NSIS Discussion" />
	
	<title> SetRegView 32 doesn't seem to do what it's supposed to [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  SetRegView 32 doesn't seem to do what it's supposed to</div>
<hr />
<div class="pda"><a href="t-336485.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=336485">SetRegView 32 doesn't seem to do what it's supposed to</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">raoulvolfoni</div><div class="date">24th October 2011, 17:33</div></div><div class="posttext">Hi<br />
<br />
I'm making an installer for a 32bit app installable on Windows XP 32bit and Seven 32 or 64bit.<br />
<br />
Under a 64bit Windows Seven, this app needs to be run in &quot;Windows XP SP3 compatibility mode&quot; due to a third party lib problem.<br />
Also, I run the installer in &quot;admin&quot; exec level (RequestExecutionLevel admin) because I write in the HKLM path.<br />
<br />
So in my nsis script I added the following lines:<br />
SetRegView 32<br />
WriteRegStr HKLM &quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers&quot; $INSTDIR\MyApp.exe WINXPSP3<br />
SetRegView 64<br />
Which should avoid the Wow6432Node reflection and write directly into this specific key.<br />
But in Windows Seven x64 it doesn't: it still writes in HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers.<br />
<br />
Normally it shouldn't be a problem because, if I understand correctly, Windows should take care of the reflection. However, after installation, the compatibility mode for Windows XP SP3 isn't checked in MyApp.exe's properties.<br />
<br />
What am I doing wrong ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th October 2011, 17:44</div></div><div class="posttext">You've got it the wrong way around. SetRegView 64 will ensure NSIS writes to the 64-bit registry (i.e. NOT Wow6432Node).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">25th October 2011, 07:35</div></div><div class="posttext">To clarify: 32 bits applications should write to the Wow6432Node, NOT to native x64 registry. If you app is 64 bits however, then you can use setregview 64.<br />
<br />
<br />
Also: &quot;requestexecutionlevel admin&quot; is not sufficient to enforce admin access. You also need to use the userinfo plugin to verify admin access in .onInit. (Reason being: requestexecutionlevel does nothing on WinXP, and also does nothing on win7 if UAC is turned off.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">raoulvolfoni</div><div class="date">25th October 2011, 09:50</div></div><div class="posttext">You've got it the wrong way around. SetRegView 64 will ensure NSIS writes to the 64-bit registry (i.e. NOT Wow6432Node).<br />
<br />
Stu<br />
You're right, now it works as intended. I hadn't understood the principle of SetRegView.<br />
<br />
To clarify: 32 bits applications should write to the Wow6432Node, NOT to native x64 registry. If you app is 64 bits however, then you can use setregview 64.<br />
<br />
The problem is that, although it's a 32bit app, when I set this value in the Wow6432Node it isn't taken into account and my app's compatibility isn't set to Windows XP SP3.<br />
<br />
Also: &quot;requestexecutionlevel admin&quot; is not sufficient to enforce admin access. You also need to use the userinfo plugin to verify admin access in .onInit. (Reason being: requestexecutionlevel does nothing on WinXP, and also does nothing on win7 if UAC is turned off.)<br />
I'll be doing that.<br />
<br />
Thanks a lot for your help ! :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>