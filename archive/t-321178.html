<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" [Win7] Registry data writing - no rights, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  [Win7] Registry data writing - no rights NSIS Discussion" />
	
	<title> [Win7] Registry data writing - no rights [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  [Win7] Registry data writing - no rights</div>
<hr />
<div class="pda"><a href="t-321178.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=321178">[Win7] Registry data writing - no rights</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Pawel</div><div class="date">26th July 2010, 21:02</div></div><div class="posttext">Hello,<br />
I have problems with Registry and Win7 rights...<br />
<br />
I want to run special Windows folders by Total Commander (for example: Recycle Bin, Control Panel). To do this, I am writing proper data to registry. When user click the folder (for example: Recycle Bin) it will be open in my program - not in Windows Explorer.<br />
The problem is, I don't have rights to write in registry key: <br />
For example:<br />
Recycle Bin:<br />
Run Command:<br />
C:\TC.exe /O /S ::{645FF040-5081-101B-9F08-00AA002F954E}<br />
Want to add below command to this key (not exists):<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}\shell\open\command<br />
<br />
How can I set rights to this and write my data?<br />
I tried with this command, using Accesss Plugin (no effect):<br />
	AccessControl::GrantOnRegKey &quot;HKLM&quot; &quot;SOFTWARE\Classes\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}&quot; &quot;(S-1-5-32-545)&quot; &quot;FullAccess&quot;<br />
<br />
Is it possible to write data here? Why I cant write in this location?<br />
(Tested on admin account with UAC enabled, with installer with admin elevation)<br />
Thanks for any help...<br />
-Pawel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th July 2010, 22:32</div></div><div class="posttext">If you check the permissions you'll find only TrustedInstaller has read/write access and is the owner. To set yourself as owner you need to enable the SeTakeOwnershipPrivilege privilege for the current process user token. You should then be able to set access control. This page has a complete macro (which enables SeRestorePrivilege):<br />
http://nsis.sourceforge.net/EnumUsersReg<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pawel</div><div class="date">27th July 2010, 17:43</div></div><div class="posttext">Thanks Stu,<br />
Sounds complicated, but I hope I can make it work.<br />
I am sure, I will ask yet about something related to this :P<br />
-Pawel</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>