<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" SQL statement, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  SQL statement NSIS Discussion" />
	
	<title> SQL statement [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  SQL statement</div>
<hr />
<div class="pda"><a href="t-208968.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=208968">SQL statement</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">arfinator853</div><div class="date">27th February 2005, 04:24</div></div><div class="posttext">I need to execute a .SQL file and have it edit the database SAM in mysql.<br />
<br />
Here is my .nsi code to try to execute them:<br />
<br />
;Output File Name<br />
OutFile &quot;sfox.exe&quot;<br />
<br />
;The Default Installation Directory<br />
InstallDir &quot;C:\Documents and Settings\Hess Smith\Desktop\SAM&quot;<br />
<br />
!include &quot;MUI.nsh&quot;<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_PAGE_FINISH<br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
Section &quot;&quot;<br />
SetOutPath $INSTDIR<br />
;Put all of the .SQL files into a temp directory<br />
File &quot;C:\Documents and Settings\Hess Smith\Desktop\SFR\installer\sam2\installer files\sql\tables.sql&quot;<br />
<br />
;SQL Execute 1<br />
nsExec::ExecToStack 'cmd /C &quot;C:\Program Files\MySQL\MySQL Server 4.1\bin\mysql.exe&quot; -uroot -pstrege -hlocalhost -P3306 &lt; &quot;$INSTDIR\tables.sql&quot;'<br />
<br />
;SQL Execute 1<br />
Exec '&quot;C:\Program Files\MySQL\MySQL Server 4.1\bin\mysql.exe&quot; -uroot -pstrege -hlocalhost -P3306 &lt; &quot;$INSTDIR\tables.sql&quot;'<br />
SectionEnd<br />
<br />
Here is my tables.sql file that it downloads and executes.<br />
<br />
# Generation Time: Dec 07, 2002 at 10:54 PM<br />
# Server version: 3.23.52<br />
# PHP Version: 4.2.3<br />
# Database : `SAMDB`<br />
# --------------------------------------------------------<br />
<br />
#<br />
# Table structure for table `category`<br />
#<br />
use sam;<br />
CREATE TABLE category (<br />
  ID mediumint(9) NOT NULL auto_increment,<br />
  name varchar(100) NOT NULL default '',<br />
  parentID mediumint(9) NOT NULL default '0',<br />
  levelindex tinyint(4) NOT NULL default '0',<br />
  itemindex mediumint(9) NOT NULL default '0',<br />
  PRIMARY KEY  (ID),<br />
  UNIQUE KEY name (name)<br />
) TYPE=MyISAM;<br />
<br />
<br />
It pops up a command prompt and it appears that it is doing something, but it is moving so fast i can't read it.  Then it exits.  But it isnt affecting the database.<br />
<br />
Does anybody have any ideas?? :igor:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th February 2005, 12:00</div></div><div class="posttext">Use nsExec::ExecToLog and you'll get the output of your command-line program in the installation log window.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arfinator853</div><div class="date">10th March 2005, 19:48</div></div><div class="posttext">what do u mean by that?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th March 2005, 20:16</div></div><div class="posttext">Instead of using nsExec::ExecToStack, use nsExec::ExecToLog!!!<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sreedhar_kumar</div><div class="date">11th March 2005, 07:48</div></div><div class="posttext">Write &quot;pause&quot; in your Batch File at the End to prevent auto-closing of the DOS Window.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arfinator853</div><div class="date">11th March 2005, 18:19</div></div><div class="posttext">i haven't created a batch file.  Is that the problem?  How would I go about doing this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th March 2005, 19:38</div></div><div class="posttext">That can be a problem sometimes. Some command-line programs only work in a DOS environment (i.e. do not work under nsExec)<br />
<br />
Rather than creating a batch, just do:<br />
<br />
ReadEnvStr $R0 COMSPEC<br />
nsExec::Exec &quot;'$R0' /c '...'&quot;<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arfinator853</div><div class="date">12th March 2005, 04:39</div></div><div class="posttext">ReadEnvStr $R0 COMSPEC<br />
nsExec::Exec &quot;'$R0' /c '...'&quot; <br />
<br />
I'm sorry, but where would I go about using that code?  Im guessing that the path to my .sql file goes in place of the '...'.  But what is all of the other stuff?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mirx_05</div><div class="date">14th March 2005, 20:20</div></div><div class="posttext">Give this a try<br />
<br />
<br />
;Output File Name<br />
OutFile &quot;sfox.exe&quot;<br />
<br />
;The Default Installation Directory<br />
InstallDir &quot;C:Documents and SettingsHess SmithDesktopSAM&quot;<br />
<br />
!include &quot;MUI.nsh&quot;<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_PAGE_FINISH<br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
Section &quot;&quot;<br />
SetOutPath $INSTDIR<br />
;Put all of the .SQL files into a temp directory<br />
File &quot;C:Documents and SettingsHess SmithDesktopSFRinstallersam2installer filessql\tables.sql&quot;<br />
<br />
;SQL Execute 1<br />
;nsExec::ExecToStack 'cmd /C &quot;C:Program FilesMySQLMySQL Server 4.1binmysql.exe&quot; -uroot -pstrege -hlocalhost -P3306 &lt; &quot;$INSTDIR\tables.sql&quot;'<br />
;Instead of the line you have above, try this:<br />
;ComSpec: Stores the path and file name of the Windows 2000 command interpreter, Cmd.exe. The command interpreter is analogous to MS-DOS Command.com<br />
;Get value in a variable:<br />
ReadEnvStr $R0 COMSPEC<br />
<br />
;Use cmd /K instead of /C to leave the window open to view its output<br />
;C:\&gt;cmd /?<br />
;/C      Carries out the command specified by string and then terminates<br />
;/K      Carries out the command specified by string but remains<br />
nsExec::ExecToLog ''$R0' /K &quot;C:Program FilesMySQLMySQL Server 4.1binmysql.exe&quot; -uroot -pstrege -hlocalhost -P3306 &lt; &quot;$INSTDIR\tables.sql&quot;'<br />
<br />
;SQL Execute 1<br />
Exec '&quot;C:Program FilesMySQLMySQL Server 4.1binmysql.exe&quot; -uroot -pstrege -hlocalhost -P3306 &lt; &quot;$INSTDIR\tables.sql&quot;'<br />
SectionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>