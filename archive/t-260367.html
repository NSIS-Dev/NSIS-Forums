<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Intercepting/Replacing Reboot action from &quot;Finish&quot; page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Intercepting/Replacing Reboot action from &quot;Finish&quot; page NSIS Discussion" />
	
	<title> Intercepting/Replacing Reboot action from &quot;Finish&quot; page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Intercepting/Replacing Reboot action from &quot;Finish&quot; page</div>
<hr />
<div class="pda"><a href="t-260367.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=260367">Intercepting/Replacing Reboot action from &quot;Finish&quot; page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">TJK</div><div class="date">25th November 2006, 15:43</div></div><div class="posttext">I have an NSIS installer that is invoked by a Vendor .DLL called from an OEMSETUP.INF PnP installer.<br />
<br />
The PnP wizard waits for the NSIS program to complete and if the NSIS installer requires a reboot and the user selects to do so then the PnP wizard doesn't get to complete and concludes there was an error, which it reports to the user.<br />
<br />
If I could intercept the reboot action (presuming that it was selected on the &quot;Finish&quot; page by the user) and replace it with another action (thinking of running a separate .EXE in another thread which will do the reboot shortly after the NSIS installer closes) then the PnP Wizard would be happy (because it would have regained control after the NSIS installer finishes and before the reboot occurs) and the reboot would still occur.<br />
<br />
Only way I've thought of doing it ATM is to force SetRebootFlag=FALSE while noting it was TRUE in a user variable and then tailor the none rebooting &quot;Finish&quot; page so that it looks like a Rebooting page to the user but the options are processed by my script (in a leave function for the finish page) so it can launch the separate rebooting .EXE - but if there's a way to catch the normal NSIS reboot action and redirect it that might be easier.<br />
<br />
Hope I've managed to explain that reasonably clearly!<br />
<br />
Thanks in advance for any suggestions.<br />
<br />
Tim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th November 2006, 16:15</div></div><div class="posttext">If you have access to the script, SetRebootFlag would be the simplest method. If you don't, you can deny the reboot by handling WM_QUERYENDSESSION. In this case, the script will execute .onRebootFailed and exit cleanly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TJK</div><div class="date">2nd December 2006, 18:55</div></div><div class="posttext">Thanks kichik, I have the script so I'll use SetRebootFlag.<br />
<br />
Tim</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>