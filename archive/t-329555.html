<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" UAC plugin, installer window goes behind, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  UAC plugin, installer window goes behind NSIS Discussion" />
	
	<title> UAC plugin, installer window goes behind [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  UAC plugin, installer window goes behind</div>
<hr />
<div class="pda"><a href="t-329555.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=329555">UAC plugin, installer window goes behind</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pbeisel</div><div class="date">12th April 2011, 04:27</div></div><div class="posttext">using the nullsoft UAC plugin v0.2.2d.zip, i find that the installer window often launches behind other windows (like the browser that opened it).  <br />
<br />
any ideas how to force it front most?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">12th April 2011, 04:37</div></div><div class="posttext">You could try 2.3, I can't remember if it is fixed there or not.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pbeisel</div><div class="date">12th April 2011, 05:05</div></div><div class="posttext">I tried 2.3 but I think it didn't work on Vista (I should reverify this).  <br />
<br />
Nonetheless, was this a known bug and fixed at some point?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">12th April 2011, 06:41</div></div><div class="posttext">This is a known issue (somewhat), but like Anders said, he doesn't remember whether he already fixed it or not.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pbeisel</div><div class="date">12th April 2011, 16:24</div></div><div class="posttext">if a fix was made to bring the installer window frontmost, can you kindly tell me where in the code?  i will compare the two builds to confirm which version has the fix.  thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">12th April 2011, 17:17</div></div><div class="posttext">There is no simple fix you can just apply</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Highcoder</div><div class="date">12th April 2011, 17:33</div></div><div class="posttext">There is no simple fix you can just apply<br />
<br />
No? What about System::Call 'user32::SetForegroundWindow(i r0)' in .onGuiInit?<br />
<br />
EDIT: $0 (r0) should contain the Installer HWND</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">13th April 2011, 01:54</div></div><div class="posttext">SetForegroundWindow only works if your process has set foreground rights (During .onInit we have no window and so we lose the foreground &quot;lock&quot;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Highcoder</div><div class="date">13th April 2011, 07:10</div></div><div class="posttext">*facepalm* yes you are right. :-) (or not? i wrote .onGUIinit not .onInit)<br />
An if you put this in the &quot;show_function&quot; of the first window? <br />
Or create a (immediately leaved) custom page before the first internal page and put this in the leave_function? <br />
<br />
cheers</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">13th April 2011, 11:00</div></div><div class="posttext">Feel free to give it a try and find out. :-)<br />
<br />
I don't have this problem because I don't elevate in .onInit, but that opened up a whole other bag of trouble. Like, getting the outer instance to hide properly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Highcoder</div><div class="date">13th April 2011, 12:07</div></div><div class="posttext">I donÂ´t have to... user pbeisel have to try it. :-)<br />
I have no problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jlh</div><div class="date">13th April 2011, 20:54</div></div><div class="posttext">hi all,<br />
<br />
first, just wanted to thank everyone for nsis. i have worked with a bunch of installers over the years and my experience with nsis has been, by far, the best. thanks for the hard work and great product!<br />
<br />
at the moment, i am struggling with the uac plugin. i think my issue is similar to the one being discussed here. when running my installer, when i get to the elevate permissions step, the dialog doesn't show up on the screen -- instead, i just see a shield icon in the tray at the bottom of the screen. when i click the shield, then is see the dialog. after that, everything works correctly. but i am concerned the my customers won't see shield and will get stuck.  <br />
<br />
i am hoping there is just a problem with my installer script. does anyone know what might be causing this?<br />
<br />
i noticed that the dropbox installer (http://www.dropbox.com) appears to use nsis and the uac plugin and their elevate permissions dialog shows up right away as it should. <br />
<br />
anyone have any ideas?<br />
<br />
thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">14th April 2011, 05:57</div></div><div class="posttext">Where are you trying to elevate? .onInit? .onGuiInit? Somewhere else?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jlh</div><div class="date">14th April 2011, 15:34</div></div><div class="posttext">we are elevating in onInit()<br />
<br />
<br />
<br />
Function .onInit<br />
<br />
    UAC_Elevate:<br />
      !insertmacro UAC_RunElevated<br />
      StrCmp 1223 $0 UAC_ElevationAborted ; UAC dialog aborted by user?<br />
      StrCmp 0 $0 0 UAC_Err ; Error?<br />
      StrCmp 1 $1 0 UAC_Success ;Are we the real deal or just the wrapper?<br />
     Quit<br />
 <br />
    UAC_Err:<br />
      MessageBox mb_iconstop &quot;Unable to elevate, error $0&quot;<br />
      Abort<br />
 <br />
    UAC_ElevationAborted:<br />
      # elevation was aborted, run as normal?<br />
      MessageBox mb_iconstop &quot;The installer requires admin access.&quot;<br />
      Abort<br />
 <br />
    UAC_Success:<br />
<br />
      System::Call 'kernel32::CreateMutexA(i 0, i 0, t &quot;myMutex&quot;) i .r1 ?e'<br />
         Pop $R0<br />
     <br />
      StrCmp $R0 0 +3<br />
         MessageBox MB_OK|MB_ICONEXCLAMATION &quot;The installer is already running.&quot;<br />
         Abort<br />
<br />
      StrCmp 1 $3 +4 ;Admin?<br />
      StrCmp 3 $1 0 UAC_ElevationAborted ;Try again?<br />
      MessageBox mb_iconstop &quot;The installer requires admin access. Please try again.&quot;<br />
      goto UAC_Elevate<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">15th April 2011, 12:48</div></div><div class="posttext">What is the RequestExecutionLevel setting in your script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">15th April 2011, 13:05</div></div><div class="posttext">I don't think that should matter, as far as I know UAC_elevate will runas admin $EXEPATH regardless of the current level.<br />
<br />
I guess if noone else has a solution, you could always try elevating after the window has been created... &gt;_&gt;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">15th April 2011, 18:40</div></div><div class="posttext">Asking about RequestExecutionLevel is pointless, if you set it to admin, the plugin becomes pointless and has no effect</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">16th April 2011, 00:42</div></div><div class="posttext">using the nullsoft UAC plugin v0.2.2d.zip, i find that the installer window often launches behind other windows (like the browser that opened it).  <br />
<br />
any ideas how to force it front most?<br />
<br />
Doing the elevation in .onGuiInit rather than .onInit solved that issue for me ;)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>