<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Compare Paths?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Compare Paths? NSIS Discussion" />
	
	<title> Compare Paths? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Compare Paths?</div>
<hr />
<div class="pda"><a href="t-288200.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=288200">Compare Paths?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">9th March 2008, 12:13</div></div><div class="posttext">Any suggestions on the best way to determine that any two of these strings are equivalent paths?  I could just loop one char at a time removing redundant and trailing \'s if no one knows of anything better.  I'm also afraid there are other nuances that I might not have anticipated.  Like, I just thought while typing, what if shortened 8.3 compatible file names were in the path.  So maybe some method that relies on the OS a little more would be more &quot;aware&quot; of those nuances.<br />
<br />
&quot;C:\\Program Files\\blah blah&quot;<br />
&quot;C:\Program Files\blah blah\&quot;<br />
&quot;C:\\Program Files\\blah blah\&quot;<br />
&quot;C:\Program Files\blah blah&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">9th March 2008, 12:27</div></div><div class="posttext">GetFullPathName might be able to help out</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">10th March 2008, 14:59</div></div><div class="posttext">you could cheat and write a temporary file to the path.  If that file is present in the second path, then the two paths are the same.<br />
<br />
On the up side, that bypasses any manual handling of short vs long filenames, symbolic paths that may be the same, double backslashes, 'up' modifiers ( \..\ ), etc.<br />
On the down side, it's not a clean method and if you can't write to the path it won't work either.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Daniel James</div><div class="date">10th March 2008, 18:11</div></div><div class="posttext">Originally posted by Anders <br />
GetFullPathName might be able to help out <br />
That's a good idea ... depending on how GetFullPathName is actually implemented in NSIS.<br />
<br />
If it's just a wrapper around the GetFullPathNameA function in kernel32 (as I should hope) then it should do the job.<br />
<br />
Just call GetFullPathName on each of the two strings in question and then compare them with StrCmp, and they should compare as equal if the strings represent the same path.<br />
<br />
Not quite what I need ... I want to compare a string to see whether it contains the CLSID_PROGRAM_FILES directory or any subdirectory thereof, but I think this and some calls to GetParent will do it ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th March 2008, 18:59</div></div><div class="posttext">For that Daniel, can you not get the length of $PROGRAMFILES, copy that same number of characters from your path to be compared and then compare the result with $PROGRAMFILES?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">10th March 2008, 20:49</div></div><div class="posttext">(for the more generic case, there's also...)<br />
http://nsis.sourceforge.net/Repair_path_names_with_../</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Daniel James</div><div class="date">12th March 2008, 13:49</div></div><div class="posttext">Originally posted by Afrow UK <br />
For that Daniel, can you not get the length of $PROGRAMFILES, copy that same number of characters from your path to be compared and then compare the result with $PROGRAMFILES?<br />
<br />
Yes. Much neater. Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Daniel James</div><div class="date">12th March 2008, 13:52</div></div><div class="posttext">Originally posted by Animaether <br />
(for the more generic case, there's also...)<br />
http://nsis.sourceforge.net/Repair_path_names_with_../ <br />
My goodness that's a hairy piece of scripting! I think I'd much rather write a plugin to do that.<br />
<br />
Quite right, though, that you need to do something of the sort if the path is relative or leads to to a file or folder that doesn't (yet) exist.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th March 2008, 11:30</div></div><div class="posttext">If the path is relative, GetFullPathName before hand should sort that out I think.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Daniel James</div><div class="date">13th March 2008, 17:56</div></div><div class="posttext">Originally posted by Afrow UK <br />
If the path is relative, GetFullPathName before hand should sort that out I think.<br />
<br />
Yes, of course ...<br />
<br />
Sorry, there was a typo/thinko back there. I meant to write:<br />
...you need to do something of the sort if the path is relative and leads to to a file or folder that doesn't (yet) exist.<br />
<br />
GetFullPathname doesn't work on non-existent files (unfortunately).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th March 2008, 18:20</div></div><div class="posttext">Right so how about making that folder with the relative path, use GetFullPathName then perhaps remove it (if necessary).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">13th March 2008, 20:56</div></div><div class="posttext">Thanks everyone, very helpful.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>