<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Registry Data held in memory?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Registry Data held in memory? NSIS Discussion" />
	
	<title> Registry Data held in memory? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Registry Data held in memory?</div>
<hr />
<div class="pda"><a href="t-271015.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=271015">Registry Data held in memory?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">chivalri</div><div class="date">11th May 2007, 22:30</div></div><div class="posttext">ReadRegStr $R1 HKLM &quot;SOFTWARE\Microsoft\Microsoft SQL Native Client\CurrentVersion&quot; &quot;Version&quot; <br />
<br />
I have three sections that can be installed independent of one another that use SQL Express.  I check in each section to see if SQL Express is installed (I do not want to install it if it is already there) by using the above command.<br />
<br />
If I run the installer and select two or more of the sections that run this check, all three will download and run the SQL.<br />
<br />
If I only choose one section the rerun the installer and add another section, the check works and the SQL is not loaded.<br />
<br />
I ran a test.  I installed just one of the sections then put in code to halt the install.  I had opened regedit prior to starting the installer.  The regedit did not show the added key and value at the break.  I then closed and restarted regedit and the key was there.  <br />
<br />
I added a message box to display $R1 but it was blank all three times during the first run that SQL was not previously installed.  If SQL was there before I ran the SQLinstaller, $R1 displayed the Version number.<br />
<br />
How do I get my installer to notice that a new registry key has been added without requiring the installer to be closed and restarted?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">11th May 2007, 23:03</div></div><div class="posttext">Why not put the entire SQL Express check/install into one hidden section that is only run if any of the sections that require it need it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">12th May 2007, 00:53</div></div><div class="posttext">I've seen new data appear in RegEdit without closing and reopening it, but sometimes I need to hit F5 Refresh. Have you tried that?<br />
<br />
What OS are you running, maybe that makes some difference.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">12th May 2007, 08:49</div></div><div class="posttext">How do I get my installer to notice that a new registry key has been added without requiring the installer to be closed and restarted?<br />
There isn't such case, installer reads changed registry normally, check this code below,<br />
outfile 'regtest.exe'<br />
<br />
section -<br />
<br />
        ReadRegStr $0 HKCU &quot;Software\_Registry_Test&quot; &quot;test&quot;<br />
        MessageBox MB_OK &quot;$$0 == {$0}&quot;<br />
<br />
        IfErrors 0 +4<br />
<br />
        WriteRegStr HKCU &quot;Software\_Registry_Test&quot; &quot;test&quot; &quot;Registry updated&quot;<br />
        ReadRegStr $0 HKCU &quot;Software\_Registry_Test&quot; &quot;test&quot;<br />
        MessageBox MB_OK &quot;$$0 == {$0}&quot;<br />
        <br />
        DeleteRegKey HKCU &quot;Software\_Registry_Test&quot;<br />
<br />
sectionend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chivalri</div><div class="date">13th May 2007, 01:23</div></div><div class="posttext">DetailPrint &quot;Pausing installation while downloaded SQL Express installer runs.&quot; <br />
  ExecWait '$TEMP\SQLinstaller.exe /qb sapwd=password disablenetworkprotocols=0 securitymode=SQL INSTANCENAME=MSSQLSERVER ADDLOCAL=SQL_Engine'<br />
<br />
ReadRegStr $R1 HKLM &quot;SOFTWARE\Microsoft\Microsoft SQL Native Client\CurrentVersion&quot; &quot;Version&quot;<br />
<br />
<br />
If I run this, $R1 is blank.  Exit installer and check registry and this value is set.  What am I missing?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">13th May 2007, 02:16</div></div><div class="posttext">There's a good chance that the SQLInstaller.exe unpacks some files and then starts another exe. If it exits before the other exe finishes, your script will check the registry before the actual installer has created the entries, but they will be there when you check for them.<br />
<br />
Verify the SQLInstaller.exe spawns another process and exits before it finishes with something like ProcExp.exe (Process Explorer) that can be downloaded from SysInternals (http://www.microsoft.com/technet/sysinternals/ProcessesAndThreads/ProcessExplorer.mspx)<br />
<br />
Don</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>