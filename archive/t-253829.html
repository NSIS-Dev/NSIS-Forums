<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" HowTo: figure out where files put in $DOCUMENTS are located?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  HowTo: figure out where files put in $DOCUMENTS are located? NSIS Discussion" />
	
	<title> HowTo: figure out where files put in $DOCUMENTS are located? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  HowTo: figure out where files put in $DOCUMENTS are located?</div>
<hr />
<div class="pda"><a href="t-253829.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=253829">HowTo: figure out where files put in $DOCUMENTS are located?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">l_d_allan</div><div class="date">22nd August 2006, 16:10</div></div><div class="posttext">Is there a standard Win32-Api way (or MFC) to access data files that are installed in the subdirectory referenced by the nsis constant $DOCUMENTS ... that can be relied on to work with Win98-FirstEdition (and later), Win2000, and WinXp?<br />
<br />
I'm intending to use nsis 2.19 with something like:<br />
SetShellVarContext current<br />
CreateDirectory &quot;$DOCUMENTS\MyCompany\MyApp&quot;<br />
SetOutPath $DOCUMENTS\MyCompany\MyApp<br />
File $DOCUMENTS\MyCompany\MyApp\MyFile.data<br />
<br />
With WinXp, I'm aware of the environment variables USERPROFILE and HOMEPATH. I believe these are set as part of installation of WinXp. However, my impression is that they aren't available for older operating systems.<br />
<br />
I suppose MyApp.exe can build up the complete directory by checking registry entries and environment variables, but I wanted to check if there is a standard way of accomplishing this.<br />
<br />
Thanks,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">22nd August 2006, 22:52</div></div><div class="posttext">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/reference/functions/shgetspecialfolderpath.asp<br />
<br />
or<br />
<br />
http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/reference/functions/shgetspecialfolderlocation.asp</div></div><hr />


<div class="post"><div class="posttop"><div class="username">l_d_allan</div><div class="date">23rd August 2006, 10:47</div></div><div class="posttext">Thanks ...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>