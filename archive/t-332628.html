<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installer development using Windows 7, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installer development using Windows 7 NSIS Discussion" />
	
	<title> Installer development using Windows 7 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installer development using Windows 7</div>
<hr />
<div class="pda"><a href="t-332628.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=332628">Installer development using Windows 7</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Ron.Stordahl</div><div class="date">19th July 2011, 22:44</div></div><div class="posttext">I develop/maintain an installer for a ham radio application, BPQ32 (http://groups.yahoo.com/group/BPQ32/), using Windows XP, but now need to advance to Windows 7.  The first thing I notice after installing NSIS on Windows 7 64 bit is that unlike Windows XP, where upon right clicking a file with a .nsi extension Windows Explorer offers the option 'compile NSIS script, is that this does not occur in Explorer for Windows 7.  That was a very convenient feature and I will really miss it.<br />
<br />
Might this relate to the location used for the installer development files, which raises the question also is there a preferred location for them.  In Windows XP I had them in c:\program files\NSIS\BPQ32, which would be inappropriate for Windows 7.<br />
<br />
Is there by chance a good source to review for assistance for installer development in Windows 7?   I am sure UAC will be an issue, perhaps also differences needed for 64 bit installs.  I probably should have kept this post to a single topic!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">20th July 2011, 05:36</div></div><div class="posttext">1) Context menu should work in win7 as well. This problem has been reported before, http://forums.winamp.com/showthread.php?t=315798  Not sure how to fix it. Try installing at userlevel to a location that doesn't require admin access?<br />
2) UAC isn't an issue as long as you add the requestexecutionlevel command. If your installer needs admin access, use requestexecutionlevel admin AND use the userinfo plugin to verify admin access. If your installer doesn't need admin access, use requestexecutionlevel user.<br />
3) To differentiate between 32 and 64 bits OS use the macros in x64.nsh.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Collector9999</div><div class="date">23rd July 2011, 04:51</div></div><div class="posttext">I have Win7 x64, too. I never noticed it missing because I invoke the compile from my editor, not from the context menu. You can easily add it back with a simple registry entry. Edit the path to your NSIS installation if different.<br />
Windows Registry Editor Version 5.00<br />
<br />
[HKEY_CLASSES_ROOT\NSIS.Script\Shell\Compile]<br />
@=&quot;Compile with NSIS&quot;<br />
<br />
[HKEY_CLASSES_ROOT\NSIS.Script\Shell\Compile\Command]<br />
@=&quot;C:\\Program Files (x86)\\NSIS\\makensis.exe \&quot;%1\&quot;&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">24th July 2011, 18:10</div></div><div class="posttext">I have Win7 x64, too. I never noticed it missing because I invoke the compile from my editor, not from the context menu. You can easily add it back with a simple registry entry. Edit the path to your NSIS installation if different.<br />
Windows Registry Editor Version 5.00<br />
<br />
[HKEY_CLASSES_ROOT\NSIS.Script\Shell\Compile]<br />
@=&quot;Compile with NSIS&quot;<br />
<br />
[HKEY_CLASSES_ROOT\NSIS.Script\Shell\Compile\Command]<br />
@=&quot;C:\\Program Files (x86)\\NSIS\\makensis.exe \&quot;%1\&quot;&quot;<br />
<br />
it's so simple, it doesn't even work. wait, maybe that's for the same reason the installer failed to do the same? :stare:<br />
<br />
luckily, you can still use that stupid sendto menu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ron.Stordahl</div><div class="date">26th July 2011, 16:19</div></div><div class="posttext">The registry entries above show ..\makensis.exe but should actually be ..\makensisw.exe.  That is not the problem however.  The NSIS install made the same entries in Windows 7 just as it did in Windows XP, with the inclusion of &quot;x(86)&quot; in the path for Windows 7 of course.<br />
<br />
So there is something else wrong.  Hopefully someone who knows what is wrong will provide a solution.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ron.Stordahl</div><div class="date">26th July 2011, 16:36</div></div><div class="posttext">Following MSG's suggestion, I uninstalled NSIS and reinstalled in c:\NSIS.  I rebooted just to be sure afterwards.  The option to compile is still missing from the context menu in Windows Explorer.  You said &quot;Try installing at userlevel to a location that doesn't require admin access?&quot;, have I done what you suggested, or have I misunderstood this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">26th July 2011, 17:05</div></div><div class="posttext">If you have UAC enabled:<br />
- If you didn't get a UAC popup at any point then yes, you installed at userlevel.<br />
<br />
If you have UAC disabled:<br />
- If you're a member of the admins group you installed at admin level. You're a member of admins if you can, for example, create a new file in the Program Files directory.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ron.Stordahl</div><div class="date">26th July 2011, 19:11</div></div><div class="posttext">I have UAC enabled and I didn't get a UAC popup at any point while installing at c:\NSIS.  Windows Explorer does not have the desired context menu, however I can use the less convenient drag and drop method.  It would be nice if this convenient context menu feature could be enabled.<br />
<br />
An alternative is apparently to invoke the compile from an editor.  Which editor?  Does HM NIS Edit provide this feature?<br />
<br />
As to if my installer will require admin access, I need to install a DLL in c:\windows\system32 so I should think it would.<br />
<br />
You speak of perhaps my needing the macros in x64.nsh.  The program suite for which I am providing the installer is 32 bit only.  So will I need to use macros in x64.nsh at all?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">26th July 2011, 21:58</div></div><div class="posttext">could all this be caused by a conflict between 32bit and 64bit registry? unfortunately my regmon doesn't work, otherwise i'd take a look how the installer for notepad++ install itself to the context menu.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>