<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" RegDLL again, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  RegDLL again NSIS Discussion" />
	
	<title> RegDLL again [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  RegDLL again</div>
<hr />
<div class="pda"><a href="t-287604.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=287604">RegDLL again</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">EnCey</div><div class="date">26th February 2008, 08:03</div></div><div class="posttext">Hi again :)<br />
<br />
I've searched the forum and found the very useful RegDLL command to call the DllRegisterServer function.<br />
<br />
I'm trying to convert my msi Installter to NSIS and besides  the DllRegisterServer function it also registers a type library and COM Class Information.<br />
The Actions are called &quot;RegisterTypeLibrary&quot; and &quot;RegisterClassInfo&quot;. Now I'm wondering if there are more built-in functions for those msi-actions.<br />
<br />
I'm not sure if the InstallLib command is what I'm looking for to get the same result as my msi installer with the RegisterTypeLibrary action.<br />
<br />
Does anyone know what functions i should use?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">26th February 2008, 08:17</div></div><div class="posttext">See the manual,<br />
<br />
Appendix B: DLL/TLB Library Setup</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EnCey</div><div class="date">26th February 2008, 08:49</div></div><div class="posttext">So the installation of a library in NSIS is the same as a registration of a library in msi?<br />
I don't know the effect of a registration/installation of a dll, I just have to make the NSIS installer do the same as the msi, and that's why I have to ask such stupid questions ^^<br />
And what about the &quot;RegisterClassInfo&quot; action?<br />
<br />
Sorry, but as to that I'm a real beginner...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">26th February 2008, 09:51</div></div><div class="posttext">I guess the documentation is pretty clear on how one should use the header ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EnCey</div><div class="date">26th February 2008, 10:03</div></div><div class="posttext">I've never said the opposite :)<br />
I just wasn't sure if its the InstallLib function I was looking for, because I wanted the dll to be registered and not installed. (Because it is registerng what the msi installer does, and not installing)<br />
<br />
I think the REGDLL libtype is what I'm looking for.<br />
<br />
Unfortunately I get an exception that terminates the installer if I insert this in my script:<br />
<br />
!insertmacro InstallLib REGDLL NOTSHARED NOREBOOT_NOTPROTECTED ${WINCLIENT_FILES}\fsctoolmgr.dll $INSTDIR\fsctoolmgr.dll $INSTDIR<br />
<br />
RegDLL $INSTDIR\fsctoolmgr.dll</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th February 2008, 13:18</div></div><div class="posttext">What happens if you try to manually registry the dll with regsvr32?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EnCey</div><div class="date">26th February 2008, 13:35</div></div><div class="posttext">It works with regsvr32.<br />
It is definitely not a corrupted DLL, because the msi Installer works too.<br />
I've used dependency walker, and the DLL uses nothing special, just windows dlls.<br />
<br />
Is it possible that there are some wrong registry entries?<br />
I have installed and uninstalled the App with the msi installer, so perhaps it has left some reg entries ?<br />
<br />
Well and the msi installer registers the dll 3 times: in the Class, SelfReg and TypeLib tables. I have to create an NSIS installer that does exactly the same, so I use Installib and RegDLL.<br />
At the moment I've no idea what command I shall use for the 3rd table (Class), and maybe thats the reason. Some registry keys that deny the NSIS registration.<br />
<br />
msdn says the Class table is for registering dlls with COM-server related information, so if somebody has an idea how I can do the same in NSIS, please tell me ;)<br />
I've searched for hours and found nothing :/<br />
<br />
â‚¬dit: Oh that could be helpful:<br />
the (NSIS) installer creates registry entries (in CLSID and TypeLib), the exception occurs at the end of the installation progress - or it doesn't affect it. I can close the installer with the Finish button, it doesn't hang or so.  The app works fine, but I can't yet test if the dll registration part went well, although i think so because there are registry entries.<br />
<br />
Regards, EnCey</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EnCey</div><div class="date">27th February 2008, 07:42</div></div><div class="posttext">I found out that I can use<br />
!insertmacro InstallLib TLB ...<br />
!insertmacro InstallLib DLL ...<br />
<br />
without errors. But if i try to use REGDLL or REGDLLTLB the &quot;Select Debugger&quot; window appears after the installation (when the finish page is visible).<br />
Also I can't use the REGDLL command with this dll, but with another (that doesn't contain a type library). <br />
Does anyone know what I'm doing wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">20th March 2008, 16:47</div></div><div class="posttext">EnCey, did you find a solution for this?  What did you ultimately end up doing?<br />
<br />
I'm trying to do the same type of MSI to NSIS conversion and have some COM dll that I want to make sure are registered in the same way they were before.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EnCey</div><div class="date">20th March 2008, 17:36</div></div><div class="posttext">I'm using regsvr32 in my installer.<br />
The result is the same as with the msi, although the msi uses SelfReg, TypeLib and a third talbe (I've forgotten its name).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>