<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Search for File + Wildcard, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Search for File + Wildcard NSIS Discussion" />
	
	<title> Search for File + Wildcard [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Search for File + Wildcard</div>
<hr />
<div class="pda"><a href="t-189624.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=189624">Search for File + Wildcard</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">coopey247</div><div class="date">11th August 2004, 13:58</div></div><div class="posttext">How do you find a file by use of a wildcard.  I need to edit java settings in C:\Docs+Set\user\.java\properties131_**, where the ** can be anything from 01 - 25.  <br />
<br />
I know to use ReadEnvStr to get the users folder, but I need to open that properties file, no matter what the trailing numbers are.<br />
<br />
Thanks in advance.<br />
<br />
NSIS rules.<br />
<br />
Coop</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">11th August 2004, 14:05</div></div><div class="posttext">Has some functions in Archive that do exactly that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">coopey247</div><div class="date">11th August 2004, 14:10</div></div><div class="posttext">I searched and searched and couldn't find any.  There were plenty of functions that found the directory if you had the file name, but not the file name if you know the directory.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">11th August 2004, 14:27</div></div><div class="posttext">There were plenty of functions that found the directory if you had the file name, but not the file name if you know the directory.You can use the &quot;Search for a File&quot; or &quot;Search for File or Directory (Alternative)&quot; functions to search for directories too. Like I have in my program (using &quot;Search for File or Directory (Alternative)&quot;):Function YourFunction<br />
<br />
  Push &quot;properties131_??&quot;<br />
  Push &quot;C:\Docs+Set\user\.java&quot;<br />
  Push $0<br />
  GetFunctionAddress $0 &quot;Search&quot;<br />
  Exch $0<br />
  Push 0<br />
  Push 0<br />
  Call SearchFile<br />
<br />
FunctionEnd<br />
<br />
Function Search<br />
<br />
  # Your code for each folder, or for only one folder.<br />
<br />
  Push &quot;go&quot; ;or Push &quot;stop&quot; if you don't want to search anymore.<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">coopey247</div><div class="date">11th August 2004, 15:16</div></div><div class="posttext">Maybe I am just not reading them right, but I looked at both of the functions you referenced and both wanted a &quot;certain file&quot;.  I don't know the file name, I know part of the file name, I want to find the rest of it.<br />
<br />
Secondly, I dont understand the function you posted.  Say I wanted to simply delete the file, where would that one line of code go?<br />
<br />
Thanks deguix, I appreciate the help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">11th August 2004, 15:41</div></div><div class="posttext">Oh, you wanted to delete the file...... But that's even easier! Just use:<br />
<br />
<br />
Delete &quot;C:\Docs+Set\user\.java\properties131_*.*&quot;<br />
I thought you wanted to search a file or folder because of the quote:How do you find a file by use of a wildcard.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">coopey247</div><div class="date">11th August 2004, 18:56</div></div><div class="posttext">Sorry, I was just trying to use that as an example so I could see where to insert my code.  I want to open the file, and replace a string (I've already got code to do that).  I just wanted to see where in your example to do that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th August 2004, 19:12</div></div><div class="posttext">Just use FindFirst, FindNext etc<br />
<br />
E.g.<br />
FindFirst $R0 $R1 &quot;X:\path\to\files*.*&quot;<br />
Loop:<br />
Push $R0 ;store file handle<br />
 Push &quot;X:\path\to\$R1&quot; ;current found file<br />
 Push ...<br />
  Call Func<br />
Pop $R0<br />
ClearErrors<br />
FindNext $R0 $R1<br />
IfErrors 0 Loop<br />
FileClose $R0<br />
<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>