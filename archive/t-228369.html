<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" VARIABLE PROBLEM plz HELP, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  VARIABLE PROBLEM plz HELP NSIS Discussion" />
	
	<title> VARIABLE PROBLEM plz HELP [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  VARIABLE PROBLEM plz HELP</div>
<hr />
<div class="pda"><a href="t-228369.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228369">VARIABLE PROBLEM plz HELP</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jcao</div><div class="date">13th October 2005, 21:33</div></div><div class="posttext">Can anyone tell me how to allow variables within !system?<br />
<br />
currently the following line of script doesn't work:<br />
-------------------------------------------------------<br />
!system '&quot;&quot;${NSISDIR}\makensis.exe&quot; &quot;$parentDir\NSIS Install Scripts\CreateUIServerEXE.nsi&quot;&quot;'<br />
-------------------------------------------------------<br />
<br />
The error output is the following:<br />
-------------------------------------------------------<br />
Can't open script &quot;$parentDir\NSIS Install Scripts\CreateUIServerEXE.nsi&quot;<br />
!system: returned 1<br />
-------------------------------------------------------<br />
<br />
I have checked using Message boxes that the variable &quot;parentDir&quot; actually contains &quot;C:/installer&quot; however when inserted as an argument for !system, only the variable name appears! But, this is not true for the variable NSISDIR!<br />
<br />
If I change the line to NOT include variables then I get NO complaints from the compiler, however I need a variable path and NOT a static path.<br />
<br />
can anyone help? <br />
<br />
-JC</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th October 2005, 22:40</div></div><div class="posttext">!system is a compile-time instruction. Variables like $parentDir is for run-time. Hopefully you can now see the problem without me having to explain it.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jcao</div><div class="date">14th October 2005, 13:28</div></div><div class="posttext">-Gotcha, thanks!<br />
<br />
So, what would be the solution to my problem? I would like to use the windows command.exe to execute the makefile.exe and compile a certain script on a directory that varies. <br />
<br />
*Is there another way to compile the external *.nsi script within the current *.nsi script?<br />
<br />
-JC</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">14th October 2005, 13:54</div></div><div class="posttext">!system '&quot;&quot;${NSISDIR}\makensis.exe&quot; &quot;${parentDir}\NSIS Install Scripts\CreateUIServerEXE.nsi&quot;&quot;'<br />
<br />
<br />
Then when you invoke makensis, provide /DparentDir=c:\foo\bar as a command line argument.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jcao</div><div class="date">14th October 2005, 14:29</div></div><div class="posttext">That doesn't work because /DparentDir=$VARIABLE is not possible. What happens is that the name of the $VARIABLE [not the contents] will be displayed when executing the !system command :S<br />
The following code should demonstrate what I'm trying to do. However it doesn't work, !system will not make use of runtime variables and compiler time variables will NOT be set to runtime variables...<br />
<br />
;----------------- CREATE UISERVER.EXE<br />
<br />
        push $EXEDIR<br />
        call GetParentDir<br />
        pop $R0 ;parent directory now stored in $R0<br />
        var /global parentDir<br />
        strcpy $parentDir $R0<br />
        !system '&quot;&quot;${NSISDIR}\makensis.exe&quot; &quot;$parentDir\NSIS_Install_Scripts\CreateUIServerEXE.nsi&quot;&quot;'<br />
;----------------- END CREATION OF UISERVER.EXE</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">14th October 2005, 15:36</div></div><div class="posttext">You are mixing runtime and compiletime commands.<br />
$VARIABLE is only available at runtime.<br />
!system is only available at compiletime.<br />
If you really need $VARIABLE, use Exec, ExecWait or the nsExec plugin instead of !system.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jcao</div><div class="date">14th October 2005, 16:33</div></div><div class="posttext">exec and execwait didn't work for me either same problem as !system.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">14th October 2005, 17:07</div></div><div class="posttext">Works for me. See attached example of Exec working with $parentDir.<br />
<br />
p.s. You may have too many quotes in your command line. Try simplifying it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th October 2005, 17:39</div></div><div class="posttext">Do you want to compile this script at compile time or at run time!??<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jcao</div><div class="date">14th October 2005, 18:57</div></div><div class="posttext">It doesn't matter wether I compile the script at compile time or run time. I just want to create the UIServer.exe before I package it into an installer becaue currently the launcher is a *.bat file and I need it to be a *.exe file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th October 2005, 19:04</div></div><div class="posttext">Are you sure it doesn't matter? Run time is when the user runs your installer! I don't think the average user will have makensis (NSIS) installed on his computer!<br />
<br />
If you want it done on your system then you want it done on compile time with !system. If $parentDir is just the parent directory of the NSIS script location, then just use .. instead of $parentDir.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jcao</div><div class="date">14th October 2005, 19:12</div></div><div class="posttext">Nice! Afrow that worked finally!<br />
No more need for a function to find the $parentDir.<br />
<br />
thank you<br />
<br />
-JC</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">14th October 2005, 19:20</div></div><div class="posttext">You still seem to be confused about runtime vs compiletime.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>