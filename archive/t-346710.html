<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Select and download files from ftp folder, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Select and download files from ftp folder NSIS Discussion" />
	
	<title> Select and download files from ftp folder [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Select and download files from ftp folder</div>
<hr />
<div class="pda"><a href="t-346710.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=346710">Select and download files from ftp folder</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mrjohn</div><div class="date">1st August 2012, 09:45</div></div><div class="posttext">Hi !  I need to create one installer that connects to a ftp folder,gets a list of files there and then gives the option to download some of them.Is this possible with NSIS ?<br />
Thanks !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st August 2012, 12:23</div></div><div class="posttext">Either write a plug-in to do it, call an existing DLL using the System plug-in or execute an existing command line executable (search Google for a DLL/EXE to use).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrjohn</div><div class="date">1st August 2012, 13:22</div></div><div class="posttext">Thanks for the answer!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrjohn</div><div class="date">1st August 2012, 18:08</div></div><div class="posttext">For me it is hard to do that with NSIS,I don't know how to write plugin,I think i'll write a .NET app that will do the work,and I'll use it as an installer,the single problem is : there must be FRAMEWORK installed on the computer :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st August 2012, 20:13</div></div><div class="posttext">Did you search for a DLL or command line FTP client for Windows? You can use either through NSIS.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">2nd August 2012, 07:12</div></div><div class="posttext">In present times Framework is installed on most machines.<br />
If not then it is very easy to detect it, download and install using NSIS :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrjohn</div><div class="date">2nd August 2012, 07:42</div></div><div class="posttext">Hi ! I've searched for command line but I found lot of things:commercial,mounting ftp to drive,etc,not something clearly,I'll do as T.Slappy suggested,thanks !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">2nd August 2012, 08:03</div></div><div class="posttext">Err... Making your installer download and install .NET is not a better solution. For one thing, it requires a reboot. Second, it makes your installer much much more complex. Third, lots of people don't want to install .NET. Fourth, installation will take much longer.<br />
<br />
There are plenty of free commandline-based FTP tools out there.  http://www.ncftp.com/ncftp/ is my third google hit.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrjohn</div><div class="date">2nd August 2012, 09:13</div></div><div class="posttext">Thanks all of you'I don't want to annoy you,but for me the shortest road is the road I know,I tried ncftp but I couldn,'t connect to my ftp account with this tool,also I don't know how to add files into NSIS installer,it is too hard,i'll use .NET solution,thanks <br />
<br />
Err... Making your installer download and install .NET is not a better solution. For one thing, it requires a reboot. Second, it makes your installer much much more complex. Third, lots of people don't want to install .NET. Fourth, installation will take much longer.<br />
<br />
There are plenty of free commandline-based FTP tools out there.  http://www.ncftp.com/ncftp/ is my third google hit.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd August 2012, 10:48</div></div><div class="posttext">Actually a fresh .NET installation does not require a reboot. Regarding FTP, one tool that comes to mind is wget. It is free and there is a Windows port (Google it) and it supports FTP file/folder listings IIRC.<br />
<br />
Edit: cURL is another one.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrjohn</div><div class="date">2nd August 2012, 12:30</div></div><div class="posttext">Regarding FTP, one tool that comes to mind is wget<br />
Indeed wget works<br />
<br />
wget   --ftp-user=myuser --ftp-password=mypassw  ftp://mywebserver.com/update/<br />
<br />
it lists files from a folder creating a file like this :<br />
<br />
&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&gt;<br />
&lt;html&gt;<br />
&lt;head&gt;<br />
&lt;title&gt;Index of /update on mywebserver.com:21&lt;/title&gt;<br />
&lt;/head&gt;<br />
&lt;body&gt;<br />
&lt;h1&gt;Index of /update on mywebserver.com:21&lt;/h1&gt;<br />
&lt;hr&gt;<br />
&lt;pre&gt;<br />
  2012 Jul 30 15:28  File        &lt;a href=&quot;ftp://mywebserver.com:21/update/upd_C_1_0_5_97.exe&quot;&gt;upd_C_1_0_5_97.exe&lt;/a&gt;  (1198819 bytes)<br />
  2012 Aug 02 05:49  File        &lt;a href=&quot;ftp://mywebserver.com:21/update/upd_G_1_0_9_39.exe&quot;&gt;upd_G_1_0_9_39.exe&lt;/a&gt;  (1343629 bytes)<br />
  2012 Mar 13 06:31  File        &lt;a href=&quot;ftp://mywebserver.com:21/update/upd_H_1_0_0_18.exe&quot;&gt;upd_H_1_0_0_18.exe&lt;/a&gt;  (488752 bytes)<br />
  2012 Feb 13 03:09  File        &lt;a href=&quot;ftp://mywebserver.com:21/update/upd_M_1_0_20_15.exe&quot;&gt;upd_M_1_0_20_15.exe&lt;/a&gt;  (564734 bytes)<br />
  2012 Jul 31 02:13  File        &lt;a href=&quot;ftp://mywebserver.com:21/update/upd_S_1_0_2_57.exe&quot;&gt;upd_S_1_0_2_57.exe&lt;/a&gt;  (1249680 bytes)<br />
&lt;/pre&gt;<br />
&lt;/body&gt;<br />
&lt;/html&gt;<br />
<br />
now how to get files into NSIS to let user select what files wants to download ?<br />
Thanks !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">2nd August 2012, 16:30</div></div><div class="posttext">You'll probably have to download the file list and direct output to a file:<br />
SetOutPath $PLUGINSDIR<br />
File ftpclient.exe<br />
nsExec::Exec `&quot;$PLUGINSDIR\ftpclient.exe&quot; -param1 -param2 -etc &gt; &quot;$PLUGINSDIR\filelist.txt&quot;`<br />
<br />
And then parse that txt file using the macros listed in Appendix E of the manual: http://nsis.sourceforge.net/Docs/AppendixE.html<br />
<br />
You could output what you find to a listbox with checkboxes, or some similar control. Google finds http://forums.winamp.com/showthread.php?t=318260 , which links to http://nsis.sourceforge.net/EmbeddedLists_plug-in .<br />
You could of course also make a hundred hidden sections, then unhide &amp; rename the sections after you get the filelist. One section for each file. Then you could just use the components page, instead of bothering with a checkbox'ed listbox control.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrjohn</div><div class="date">3rd August 2012, 11:48</div></div><div class="posttext">Thanks  MSG  !!!  <br />
I've done,I've created sections (I have max 7 ) default hidden (name =&quot;&quot;) and I show them after getting the file list,I used  SectionSetText.... all works, but instead using wget to download the files that shows a command window I want to use something with a real progressbar so I tried Inetc plugin, but I can't download the file with it,also with wget I can,this is the command I use  : <br />
<br />
<br />
    inetc::get /caption &quot;download&quot; /popup &quot;ftp://mywebserver*******&quot; &quot;ftp://myuser@mywebserver.info:mypassw@mywebserver*******update/upd_H_1_0_0_18.exe&quot; &quot;$EXEDIR\setup.exe&quot;<br />
<br />
    Pop $0 # return value = exit code, &quot;OK&quot; if OK<br />
    MessageBox MB_OK &quot;Download Status: $0&quot;<br />
<br />
I got error : URL Parts Error<br />
<br />
Thanks !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd August 2012, 13:07</div></div><div class="posttext">Put /end on the end of your inetc line.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrjohn</div><div class="date">3rd August 2012, 13:22</div></div><div class="posttext">Done, but the same error<br />
<br />
thanks <br />
Put /end on the end of your inetc line.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd August 2012, 14:05</div></div><div class="posttext">Does it work without the /caption and /popup switches? If not then I would suspect your URL format is wrong as then I'd assume that error means InternetCrackUrl (http://msdn.microsoft.com/en-us/library/windows/desktop/aa384376%28v=vs.85%29.aspx) API failed.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrjohn</div><div class="date">3rd August 2012, 15:29</div></div><div class="posttext">Hi !<br />
 I tried something like this, rename user to<br />
  myuser <br />
  not<br />
  myuser@mywebserver.info<br />
<br />
user is defined in cpanel as myuser@mywebserver.info,tested also with browser,simple name  myuser doesnt work<br />
 <br />
<br />
So using simple  myuser  I can see the progressbar and then the message : Download Status:530:Login autenthication failed<br />
<br />
     inetc::get   &quot;ftp://myuser:mypass@mywebserver*******public_html/pft/_public_/update/upd_H_1_0_0_18.exe&quot; &quot;$EXEDIR\setup.exe&quot;<br />
<br />
puting back the user to   myuser@mywebserver.info got error : URL Parts Error<br />
<br />
Thanks!<br />
<br />
<br />
<br />
<br />
<br />
Does it work without the /caption and /popup switches? If not then I would suspect your URL format is wrong as then I'd assume that error means InternetCrackUrl (http://msdn.microsoft.com/en-us/library/windows/desktop/aa384376%28v=vs.85%29.aspx) API failed.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd August 2012, 16:23</div></div><div class="posttext">This worked for me:<br />
inetc::get &quot;ftp://myuser:mypass@mywebserver.com/public_html/pft/_public_/update/upd_H_1_0_0_18.exe&quot; &quot;$EXEDIR\setup.exe&quot; /endYou sure you put /end on correctly (as shown)?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrjohn</div><div class="date">3rd August 2012, 20:16</div></div><div class="posttext">not working,I think there must be a bug when user is defined as <br />
myuser@mywebserver.info<br />
not <br />
myuser<br />
<br />
Thanks<br />
<br />
<br />
<br />
This worked for me:<br />
inetc::get &quot;ftp://myuser:mypass@mywebserver.com/public_html/pft/_public_/update/upd_H_1_0_0_18.exe&quot; &quot;$EXEDIR\setup.exe&quot; /endYou sure you put /end on correctly (as shown)?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd August 2012, 23:58</div></div><div class="posttext">You can't have an @ in the username (or password). The FTP URI specification does not allow it.<br />
<br />
It has to be:<br />
ftp://&lt;user&gt;:&lt;pass&gt;@&lt;host&gt;/&lt;path&gt;<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrjohn</div><div class="date">4th August 2012, 06:51</div></div><div class="posttext">In wget I use it like this and it works :<br />
<br />
 nsExec::Exec '&quot;wget.exe&quot;  --ftp-user=myuser@mywebserver.info --ftp-password=mypassw ftp://mywebserver*******update/ '<br />
<br />
using in wget username myuser instead of myuser@mywebserver.info it doesn't work,so I think there is a bug in this plugin,also it is working with total commander,chrome,firefox,etc<br />
<br />
Thanks!<br />
<br />
<br />
You can't have an @ in the username (or password). The FTP URI specification does not allow it.<br />
<br />
It has to be:<br />
ftp://&lt;user&gt;:&lt;pass&gt;@&lt;host&gt;/&lt;path&gt;<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">4th August 2012, 10:59</div></div><div class="posttext">As I said it's the FTP URI specification that does not allow the @ in the username when the username is in the URI. The @ is used as the delimiter between the username and password therefore it cannot allow more than one. This is not a fault of the plug-in. Try it in IE (or any other browser) for example. The reason it works with wget is because you're not specifying the username in the FTP URI. If you are stuck with that username then you will have to use wget instead of inetc.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrjohn</div><div class="date">4th August 2012, 17:13</div></div><div class="posttext">Thanks Afrow, I'll use wget.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>