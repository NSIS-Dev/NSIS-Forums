<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installing as non-local admin?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installing as non-local admin? NSIS Discussion" />
	
	<title> Installing as non-local admin? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installing as non-local admin?</div>
<hr />
<div class="pda"><a href="t-344402.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=344402">Installing as non-local admin?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Jouydree</div><div class="date">24th April 2012, 11:37</div></div><div class="posttext">Hello All,<br />
<br />
years ago, I had written an extensive nsis script (including my own plugin dll) to install several applications. The install process requires administrative privileges and so far using the 'run as&quot; option of windows was ok for the clients.<br />
<br />
Now I am confronted with the wish of an important client to &quot;support Windows Domain Accounts&quot; and to enable the clients administrators to &quot;install as non-local admin&quot;. Unfortunately Windows is not the area of my greatest expertise.<br />
<br />
What my researches have unearthed so far, is that it all is about &quot;Active Directories&quot; and &quot;Group Policies&quot; and that either nsis does not support this or nobody has a need of it: The only similiar cases I found was an admin daily changing the administrator passwords and supplying his users with it on request, and someone including that password in the script itself). Another impression I got in my research was that it would be best to wrap the nsis installer executable in a MSI installer...<br />
<br />
Before I now start to learn MSI needlessly: Could somebody please point me in the right direction? Did I understand the client's wish correctly at all?<br />
<br />
Jouydree</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th April 2012, 16:13</div></div><div class="posttext">You should not have to change anything to your script to support domain account installations. As long as you have written your script correctly with RequestExecutionLevel admin and are checking the user is indeed an administrator (UserInfo plug-in) then that should be enough.<br />
<br />
I'm not sure what you're getting at in your post. Is the client unable to install under a domain account? Why are you looking into active directory and group policy? Do you need to change active directory entries or apply group policies?<br />
And what gave you the idea that you have to wrap into an MSI? You need to explain why. If you do not know why then your researchers aren't doing a very good job :)<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jouydree</div><div class="date">24th April 2012, 17:01</div></div><div class="posttext">Hello Afrow,<br />
<br />
firstly thank you for the quick reply! Secondly my researchers are all clones of myself, so I take all the blame. ;) I am sorry that the description of my problem is a little confused - that is probably part of the problem: I am confused.<br />
<br />
I do use RequestExecutionLevel admin and I do check with xtInfoPlugin::IsAdministrator on Windows NT, 2000, XP, Vista, and 7. This has never been any problem: Either the installer is run as admin or a polite MsgBox informs the user &quot;that unfortunatly we are compelled to request administrative privileges&quot;, asks to use &quot;run as...&quot;, and exits.<br />
<br />
Now the administrator or a client wrote us an email that he does &quot;not want to go from one employee's PC to the next employee's laptop and enter the administrators password&quot;, but that we should &quot;modify our installer in a way that it will work with Windows Domain accounts&quot; and allow him to install as &quot;a non-local Admin&quot; ...<br />
<br />
I was at a loss what was meant with &quot;work with Windows Domain accounts&quot; (and naturally shy to expose our utter ignorance in that area by asking him) and started researching. This is how I ended up with Active Directories and Group Policies. Hence my opening post. I've no idea in what direction to search or to act.<br />
<br />
Jouydree</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th April 2012, 19:36</div></div><div class="posttext">OK thanks for explaining. What you mean I think is remote installation. Installing using a domain user account is no problem but remote installations are. Remote installations require Microsoft Installer components which are part of the OS - NSIS does not use these components.<br />
<br />
Try searching the forums for &quot;remote installations&quot; but you may have to go with an MSI as you have already said. There are free MSI generators around (such as WiX) but if you can afford a commercial product I would recommend Advanced Installer. I was able to create MSI wrappers for NSIS installers using Advanced Installer quite easily in the past (but I have the paid version - not the free version).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jouydree</div><div class="date">24th April 2012, 20:07</div></div><div class="posttext">Hi Stu,<br />
<br />
thank you very much! At least I know now, in which direction to search and act! What a relief.<br />
<br />
Have a nice evening!<br />
Jouydree</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>