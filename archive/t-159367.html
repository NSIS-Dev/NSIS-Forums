<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Possible error in makensis,nsi, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Possible error in makensis,nsi NSIS Discussion" />
	
	<title> Possible error in makensis,nsi [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Possible error in makensis,nsi</div>
<hr />
<div class="pda"><a href="t-159367.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=159367">Possible error in makensis,nsi</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">psyke</div><div class="date">11th December 2003, 20:54</div></div><div class="posttext">Hello. :)<br />
<br />
I've been seeing this on my system for a while now (sorry I didn't point it out earlier. ;))<br />
<br />
It appears to me that the .nsi and .nsh file types aren't registered if NSIS is being installed and these associations weren't already setup up by an older (pre beta4) NSIS installer.<br />
<br />
Here's the relevant code (with extraneous bits snipped) from examples\makensis.nsi:  ReadRegStr $R0 HKCR &quot;.nsi&quot; &quot;&quot;<br />
  StrCmp $R0 &quot;NSISFile&quot; 0 no_nsioldassoc<br />
    DeleteRegKey HKCR &quot;NSISFile&quot;<br />
    Goto nsi<br />
  no_nsioldassoc:<br />
<br />
  StrCmp $R0 &quot;NSIS.Script&quot; 0 no_nsi<br />
    nsi:<br />
    &lt;SNIP!&gt;<br />
    no_nsiopen:<br />
    &lt;SNIP!&gt;<br />
  no_nsi:<br />
<br />
<br />
Now say this is being run on a system where .nsi isn't registered to open with anything.<br />
<br />
After the ReadRegStr, $R0 will contain &quot;&quot;, and the comparison to NSISFile will fail so we branch to no_nsioldassoc. Now the comparison to NSIS.Script fails and we go to no_nsi. And we're done registering .nsi on this system. ;)<br />
<br />
It seems odd to be checking for NSIS.Script before it's ever written (I guess you're trying to skip registering if it's already been done). But I'm not 100% certain what kinds of situations you're trying to account for so I'll have to leave the solution in your hands. For myself, I simply replaced the jump to no_nsioldassoc with a jump to nsi as a temporary workaround.<br />
<br />
<br />
My thanks to all contributors to NSIS, it's an incredibly remarkable piece of software! :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th December 2003, 21:04</div></div><div class="posttext">Thanks, fixed.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>