<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Port scan, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Port scan NSIS Discussion" />
	
	<title> Port scan [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Port scan</div>
<hr />
<div class="pda"><a href="t-201522.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=201522">Port scan</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bgosalci</div><div class="date">8th December 2004, 14:09</div></div><div class="posttext">Hi all, as I am installing an app that needs connection through TCP port I need to check whether the TCP port is already used. Is there a way to check whether the port number is used or not. Lets say I want to test whether the port 8443 is used by any other application, how would I do that through NSIS installer during installation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">8th December 2004, 14:36</div></div><div class="posttext">You'd probably need to launch a third-party tcp ping or tcptrace mate, using Exec, ExecWait, or nsExec::Exec (look those up in the docs for details). Far as I know there's no plugin written to do that stuff, feel free to write one yourself :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">8th December 2004, 17:31</div></div><div class="posttext">It's easy to get all used ports list, for example 'netstat -a' using nsExec or attached plug-in (re-worked not long ago :) ), but '|grep 8443' not works on most of Wins, so you will need to learn NSIS string and file functions to extract 8443 LISTENING string.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bgosalci</div><div class="date">9th December 2004, 15:11</div></div><div class="posttext">Ok how will I get the output of netstat -a command<br />
<br />
I have tried the following:<br />
<br />
ExecWait &quot;netstat -a&quot; $0<br />
<br />
This did not work</div></div><hr />


<div class="post"><div class="posttop"><div class="username">KenA</div><div class="date">9th December 2004, 15:37</div></div><div class="posttext">Originally posted by bgosalci <br />
Ok how will I get the output of netstat -a command<br />
<br />
I have tried the following:<br />
<br />
ExecWait &quot;netstat -a&quot; $0<br />
<br />
This did not work <br />
Hi, <br />
<br />
I would recommand the nsExec plug-in like so:<br />
<br />
nsExec::ExecToStack '&quot;netstat&quot; -a'<br />
Pop $0<br />
<br />
from the nsExec documentation: &quot;...ExecToStack will push up to ${NSIS_MAX_STRLEN} characters of output onto the stack after the return value.&quot;<br />
<br />
Hope this helps,<br />
<br />
KenA</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bgosalci</div><div class="date">9th December 2004, 15:58</div></div><div class="posttext">Thanks for reply but the value returned is = 0.<br />
<br />
if used with timeout the returned value is = error.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">KenA</div><div class="date">9th December 2004, 16:55</div></div><div class="posttext">Originally posted by bgosalci <br />
Thanks for reply but the value returned is = 0.<br />
<br />
if used with timeout the returned value is = error. <br />
My bad, here's what should work.<br />
<br />
nsExec::ExecToStack /TIMEOUT=5000 '&quot;netstat.exe&quot; -a'<br />
Pop $0 ; retrieve the error code<br />
StrCmp $0 &quot;0&quot; 0 not_ok<br />
Pop $0 ; retrieve the output.<br />
not_ok: ;error dealing code...<br />
...<br />
<br />
Should be better.:D <br />
<br />
KenA</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">9th December 2004, 18:05</div></div><div class="posttext">config.h(11):#define NSIS_MAX_STRLEN 1024<br />
but I see few screens of data on netstat, exec 2log looks better for me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bgosalci</div><div class="date">13th December 2004, 16:10</div></div><div class="posttext">I have found a utility that runs in Windows command line, which will do the work. If any one else needs this sort of utility than check the links.<br />
<br />
Download:<br />
http://www.microsoft.com/downloads/details.aspx?familyid=89811747-c74b-4638-a2d5-ac828bdc6983&amp;displaylang=en<br />
<br />
Info:<br />
http://support.microsoft.com/default.aspx?scid=kb;en-us;832919</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>