<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Exit code on embedded installers, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Exit code on embedded installers NSIS Discussion" />
	
	<title> Exit code on embedded installers [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Exit code on embedded installers</div>
<hr />
<div class="pda"><a href="t-335140.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=335140">Exit code on embedded installers</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">heldain</div><div class="date">23rd September 2011, 11:59</div></div><div class="posttext">Bad topic title I know.<br />
<br />
I'm running an installer from my NSIS installer/script via the following:<br />
<br />
Section &quot;app2&quot; Section2<br />
	<br />
	; Set Section properties<br />
	SetOverwrite on<br />
	SectionIn RO<br />
	<br />
	;Set Section Files and Shortcuts<br />
	SetOutPath &quot;$INSTDIR\Install\&quot;<br />
	File &quot;..\..\source\biginstaller\app2.exe&quot;<br />
	ExecWait &quot;$INSTDIR\Install\app2.exe&quot;<br />
		<br />
SectionEnd<br />
<br />
However I want to abort the whole script/installer if this installer fails to complete. I.e. if the exit code != 0.<br />
I did find a 'Useful Script' that mentions this, but I'm being intellectually challenged and cant find how to apply it, as the example seems to omit this section.<br />
<br />
http://nsis.sourceforge.net/Embedding_other_installers#Using_the_return_value_from_the_ExecWait<br />
 (http://nsis.sourceforge.net/Embedding_other_installers#Using_the_return_value_from_the_ExecWait).<br />
<br />
Suggestions please?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">23rd September 2011, 13:18</div></div><div class="posttext">There is an optional parameter to capture the exit code (http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1.4). The manual is your friend.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">heldain</div><div class="date">23rd September 2011, 13:24</div></div><div class="posttext">I saw that, however getting the exit code and handling it are different things. Its the handling that I'm struggling with.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">23rd September 2011, 13:35</div></div><div class="posttext">First of all you need to figure out what ExitCode the installer you run will return in for what situation.<br />
<br />
This depends on the individual installer and may not be answered in general.<br />
<br />
Then simply use a &quot;StrCmp $1 &lt;VAL&gt; &lt;GoIfEqual&gt; &lt;Otherwise&gt;&quot; to decide where to jump, depending on the ExitCode.<br />
<br />
ExecWait '&quot;$INSTDIR\Install\app2.exe&quot;' $1<br />
StrCmp $1 0 Success ; Jump to 'Success' if (and only if) ExitCode was '0'<br />
<br />
MessageBox MB_OK &quot;Failed to install. Setup will exit!&quot;<br />
Quit<br />
<br />
Success:<br />
MessageBox MB_OK &quot;Installed correctly&quot;<br />
<br />
For more complex things, you may want to have a look at ${switch} from LogicLib.nsh ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">23rd September 2011, 13:38</div></div><div class="posttext">Or, preferably, use the logiclib and do:<br />
${If} $1 == &quot;&lt;VAL&gt;&quot;<br />
;stuff<br />
${Else}<br />
;other stuff<br />
${EndIf}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">23rd September 2011, 13:38</div></div><div class="posttext">Include LogicLib.nsh and thenExecWait &quot;$INSTDIR\Install\app2.exe&quot; $0<br />
${If} $0 &lt;&gt; 0<br />
; app2 has failed, must cleanup and stop<br />
... <br />
${EndIf}orExecWait &quot;$INSTDIR\Install\app2.exe&quot; $0<br />
${If} $0 = 0<br />
; app2 success, continue remaining operations<br />
... <br />
${EndIf}<br />
<br />
(Edit: overlapping posts - MSG and I are suggesting the same thing.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">23rd September 2011, 13:39</div></div><div class="posttext">...wow, look at us being all helpful today. :P</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>