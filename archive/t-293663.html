<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" AddToPath doesn't always update, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  AddToPath doesn't always update NSIS Discussion" />
	
	<title> AddToPath doesn't always update [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  AddToPath doesn't always update</div>
<hr />
<div class="pda"><a href="t-293663.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=293663">AddToPath doesn't always update</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">26th June 2008, 20:13</div></div><div class="posttext">I have customers who complain of certain errors during the post installation experience.  The reason is the $INSTDIR did not get added to the path at the time of installation.<br />
<br />
I can have them manually add it by the control panel but the installation won't.  Usually they will need to reboot, reinstall, then the process works.<br />
<br />
Any ideas to why, because I can't think of any that make sense.  This happens to 1-4% of our users and all of them are solved the same way, but I can not think of a cause to WHY the path didn't add itself during the installation process.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vc6</div><div class="date">1st July 2008, 23:03</div></div><div class="posttext">I see that no one replied, which IMHO means that this is not realy an NSIS problem but an end-user system configuration issue.<br />
<br />
I vaguely remember a similar problem in the past, a problem that drove me crazy because nothing in the NSIS documentation could explain what I was seeing. At the end, I discovered that it was simply a matter of correctly identifying the home (install) DRIVE.<br />
<br />
The typical Windows system has C: as the home drive. But that's typical, not guaranteed. In your script make sure that you are not hardcoding C: but rather using $%HOMEDRIVE%.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jimpark</div><div class="date">2nd July 2008, 14:05</div></div><div class="posttext">We've had similar issues with AddToPath and discovered two different problems:<br />
<br />
1. The PATH variable can be very long which may exceed the 1024 characters allotted by NSIS for a string.  There is a BIG string version of NSIS which can handle up to 8192 characters which is enough to handle the PATH variable.<br />
<br />
2. The second problem is that the AddToPath function uses two different methods to get the PATH value.  The first method is via ReadEnvStr which reads the PATH variable from the current copy of the environment held by the running process.  This may not accurately reflect what's in the registry.  So the function may fail believing that the path already exists when in reality it only exists in the current copy of the environment held onto by the process.  It could be that the uninstall that was run moments before had actually removed the path from the registry but was not able to update the path variable of an existing process like a cmd.exe window.  The second read of the environment variable in the IsNT branch of the function uses the ReadRegStr to get the PATH, which only works on NT machines.  Our solution was to use the ReadRegStr always and remove the call to ReadEnvStr because we knew our users had machines that ran Windows 2000 and higher.<br />
<br />
I hope this helps.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">26th March 2009, 14:49</div></div><div class="posttext">I will have to look into #2 since my path is about 400 chars, but again it works on my PC, but sometimes it doesn't and not 100% sure why.  When that happens I have to reboot, reinstall, then it works.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>