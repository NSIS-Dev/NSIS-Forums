<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MUI- Header Image, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MUI- Header Image NSIS Discussion" />
	
	<title> MUI- Header Image [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MUI- Header Image</div>
<hr />
<div class="pda"><a href="t-210452.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=210452">MUI- Header Image</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">deepesh83</div><div class="date">15th March 2005, 07:38</div></div><div class="posttext">I am unable to display my own header bitmap in MUI pls. have alook at the script below and point out my mistake.<br />
<br />
<br />
;###################################################<br />
;UI START<br />
!include &quot;MUI.nsh&quot;<br />
<br />
;###################################################<br />
;GENRAL<br />
Name &quot;Graphics 2.0.84&quot;<br />
OutFile &quot;C:\Documents and Settings\me\Desktop\Installer\Scripts\Setup_Graphicsv2.0.83.Exe&quot;<br />
;DEFAULT INSTALL DIR<br />
InstallDir &quot;$PROGRAMFILES\Graphics&quot;<br />
;GET INSTALL DIR FEOM REGISTRY<br />
InstallDirRegKey HKCU &quot;Software\Graphics&quot; &quot;&quot;<br />
SetDateSave on<br />
SetDatablockOptimize on<br />
CRCCheck on<br />
  !define MUI_HEADERBITMAP &quot;C:\Documents and Settings\me\Desktop\Installer\Nsis\Contrib\Icons\Header.bmp&quot;<br />
<br />
;###################################################<br />
;VARIABLES<br />
Var MUI_TEMP<br />
Var STARTMENU_FOLDER<br />
<br />
;###################################################<br />
;INTERFACE SETTINGS<br />
!define MUI_ABORTWARNING<br />
!define MUI_WELCOMEPAGE_TEXT &quot;Quick Deployment Wizard will guide you through the installation of Graphics v 2.0.84.\r\n\r\n\r\n\n\n&quot;<br />
BRANDINGTEXT &quot;Visit www.deepesh.info for Free Quick Deployment Wizard&quot;<br />
<br />
;###################################################<br />
;PAGES<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_LICENSE &quot;C:\Documents and Settings\me\Desktop\Installer\Nsis\Contrib\Icons\Licence.rtf&quot;<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
;START MENU FOLDER PAGE CONFIG<br />
!define MUI_STARTMENUPAGE_REGISTRY_ROOT &quot;HKCU&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_KEY &quot;Software\Graphics&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME &quot;Start Menu Folder&quot;<br />
!insertmacro MUI_PAGE_STARTMENU Application $STARTMENU_FOLDER<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_UNPAGE_CONFIRM<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
  !define MUI_SPECIALBITMAP &quot;.\Contrib\Icons\Data.dat&quot;<br />
  !define MUI_PROGRESSBAR<br />
<br />
;###################################################<br />
;LANGUAGES<br />
;--------------- Remember the installer language -----------------------------------<br />
  !define MUI_LANGDLL_REGISTRY_ROOT &quot;HKCU&quot; <br />
  !define MUI_LANGDLL_REGISTRY_KEY &quot;Software\strPname&quot; <br />
  !define MUI_LANGDLL_REGISTRY_VALUENAME &quot;Installer Language&quot;<br />
;---------------  End of Remember the installer language Code -----------------------------------<br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
;-------------------------------- <br />
;------------- Reserve Files Extract Before Installation ---------<br />
<br />
 !insertmacro MUI_RESERVEFILE_LANGDLL<br />
<br />
;-------------End of Reserve Files Extract Before Installation ---------<br />
<br />
<br />
;###################################################<br />
;SPLASH SCREEN SETTINGS<br />
Function .onInit<br />
<br />
  !insertmacro MUI_LANGDLL_DISPLAY<br />
<br />
SetOutPath $INSTDIR<br />
FunctionEnd<br />
<br />
;###################################################<br />
;SPLASH SCREEN SETTINGS<br />
;-------------------------------- <br />
;Installer Sections<br />
<br />
Section &quot;ToInstall&quot;SecCopyUI <br />
SetOutPath &quot;$INSTDIR&quot;<br />
SetOutPath &quot;$SYSDIR\&quot;<br />
File /a &quot;C:\WINDOWS\system32\stdole2.tlb&quot;<br />
SetOutPath &quot;$INSTDIR&quot;<br />
SetOutPath &quot;$SYSDIR\&quot;<br />
File /a &quot;C:\Documents and Settings\me\Desktop\Installer\SHELLLNK.TLB&quot;<br />
SetOutPath &quot;$INSTDIR&quot;<br />
SetOutPath &quot;$SYSDIR\&quot;<br />
File /a &quot;C:\WINDOWS\system32\scrrun.dll&quot;<br />
SetOutPath &quot;$INSTDIR&quot;<br />
SetOutPath &quot;$SYSDIR\&quot;<br />
File /a &quot;C:\WINDOWS\system32\TLBINF32.DLL&quot;<br />
SetOutPath &quot;$INSTDIR&quot;<br />
SetOutPath &quot;$SYSDIR\&quot;<br />
File /a &quot;C:\WINDOWS\system32\Comdlg32.ocx&quot;<br />
SetOutPath &quot;$INSTDIR&quot;<br />
SetOutPath &quot;$SYSDIR\&quot;<br />
File /a &quot;C:\WINDOWS\system32\Tabctl32.ocx&quot;<br />
SetOutPath &quot;$INSTDIR&quot;<br />
SetOutPath &quot;$SYSDIR\&quot;<br />
File /a &quot;C:\WINDOWS\system32\Mscomctl.ocx&quot;<br />
SetOutPath &quot;$INSTDIR&quot;<br />
SetOutPath &quot;$SYSDIR\&quot;<br />
File /a &quot;C:\Documents and Settings\me\Desktop\Installer\Gifxc.ocx&quot;<br />
SetOutPath &quot;$INSTDIR&quot;<br />
SetOutPath &quot;$SYSDIR\&quot;<br />
File /a &quot;D:\Program Files\Graphics\explorer tree.ocx&quot;<br />
SetOutPath &quot;$INSTDIR&quot;<br />
<br />
;Save Install Folder<br />
<br />
WriteRegStr HKCU &quot;Software\strPname&quot; &quot;&quot; $INSTDIR<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Graphics&quot; &quot;DisplayName&quot; &quot;Graphics&quot;<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Graphics&quot; &quot;UninstallString&quot; '&quot;$INSTDIR\Uninstall.exe&quot;'<br />
!insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
CreateDirectory &quot;$SMPROGRAMS\$STARTMENU_FOLDER&quot;<br />
CreateShortCut &quot;$SMPROGRAMS\$STARTMENU_FOLDER\Gifxc.ocx.lnk&quot; &quot;$SYSDIR\Gifxc.ocx&quot;<br />
CreateShortCut &quot;$SMPROGRAMS\$STARTMENU_FOLDER\Uninstall.lnk&quot; &quot;$INSTDIR\Uninstall.exe&quot;<br />
!insertmacro MUI_STARTMENU_WRITE_END<br />
CreateShortCut &quot;$DESKTOP\.lnk&quot; &quot;&quot;<br />
RegDLL &quot;$SYSDIR\explorer tree.ocx&quot;<br />
;Write Uninstaller<br />
WriteUninstaller &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
;-------------------- Write Log File ------------ <br />
<br />
StrCpy $0 $INSTDIR\Install.log<br />
Push $0<br />
Call DumpLog<br />
<br />
;----------------- End of Write Log File ----------- <br />
<br />
SectionEnd<br />
;-------------------------------- <br />
<br />
;------------------ Function to Dump Log File -------------- <br />
!define LVM_GETITEMCOUNT 0x1004<br />
!define LVM_GETITEMTEXT 0x102D<br />
<br />
Function DumpLog<br />
  Exch $5<br />
  Push $0<br />
  Push $1<br />
  Push $2<br />
  Push $3<br />
  Push $4<br />
  Push $6<br />
<br />
  FindWindow $0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
  GetDlgItem $0 $0 1016<br />
  StrCmp $0 0 error<br />
  FileOpen $5 $5 &quot;w&quot;<br />
  StrCmp $5 0 error<br />
    SendMessage $0 ${LVM_GETITEMCOUNT} 0 0 $6<br />
    System::Alloc ${NSIS_MAX_STRLEN}<br />
    Pop $3<br />
    StrCpy $2 0<br />
    System::Call &quot;*(i, i, i, i, i, i, i, i, i) i \<br />
      (0, 0, 0, 0, 0, r3, ${NSIS_MAX_STRLEN}) .r1&quot;<br />
    loop: StrCmp $2 $6 done<br />
      System::Call &quot;User32::SendMessageA(i, i, i, i) i \<br />
        ($0, ${LVM_GETITEMTEXT}, $2, r1)&quot;<br />
      System::Call &quot;*$3(&amp;t${NSIS_MAX_STRLEN} .r4)&quot;<br />
      FileWrite $5 &quot;$4$\r$\n&quot;<br />
      IntOp $2 $2 + 1<br />
      Goto loop<br />
    done:<br />
      FileClose $5<br />
      System::Free $1<br />
      System::Free $3<br />
      Goto exit<br />
  error:<br />
    MessageBox MB_OK error<br />
  exit:<br />
    Pop $6<br />
    Pop $4<br />
    Pop $3<br />
    Pop $2<br />
    Pop $1<br />
    Pop $0<br />
    Exch $5<br />
FunctionEnd<br />
;--------------- End of Function to Dump Log File ----------------- <br />
;-------------------------------- <br />
<br />
;Uninstaller Section<br />
Section &quot;Uninstall&quot;<br />
Delete &quot;$SYSDIR\stdole2.tlb&quot;<br />
Delete &quot;$SYSDIR\scrrun.dll&quot;<br />
Delete &quot;$SYSDIR\TLBINF32.DLL&quot;<br />
Delete &quot;$SYSDIR\Comdlg32.ocx&quot;<br />
Delete &quot;$SYSDIR\Tabctl32.ocx&quot;<br />
Delete &quot;$SYSDIR\Mscomctl.ocx&quot;<br />
Delete &quot;$SYSDIR\Gifxc.ocx&quot;<br />
Delete $INSTDIR\Install.log<br />
!insertmacro MUI_STARTMENU_GETFOLDER Application $MUI_TEMP<br />
Delete &quot;$DESKTOP\.lnk&quot;<br />
Delete &quot;$SMPROGRAMS\$MUI_TEMP\Gifxc.ocx.lnk&quot;<br />
Delete &quot;$SMPROGRAMS\$MUI_TEMP\Uninstall.lnk&quot;<br />
StrCpy $MUI_TEMP &quot;$SMPROGRAMS\$MUI_TEMP&quot;<br />
RMDir &quot;$MUI_TEMP&quot;<br />
noshortcuts:<br />
Delete &quot;$INSTDIR\Uninstall.exe&quot;<br />
RMDir &quot;$INSTDIR&quot;<br />
DeleteRegKey /ifempty HKCU &quot;Software\strPname&quot;<br />
DeleteRegKey HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Graphics&quot;<br />
IfFileExists &quot;$INSTDIR&quot; 0 NoErrorMsg<br />
MessageBox MB_OK &quot;Note: $INSTDIR could not be removed, because it is not Empty, Please Delete Manually.&quot; IDOK 0<br />
NoErrorMsg:<br />
SectionEnd<br />
;--------------------------------<br />
;Uninstaller Functions<br />
<br />
Function un.onInit<br />
  ;Get language from registry<br />
  ReadRegStr $LANGUAGE HKCU &quot;Software\strPname&quot; &quot;Installer Language&quot;<br />
 FunctionEnd<br />
;-------------------------------------------------------------<br />
<br />
<br />
Deepesh Agarwal,<br />
http://www.freeware-alternative.uni.cc</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">15th March 2005, 09:57</div></div><div class="posttext">Include !define MUI_HEADERIMAGE in your script.<br />
And !define MUI_HEADERIMAGE_BITMAP &quot;C:\Documents and Settings\me\Desktop\Installer\Nsis\Contrib\Icons\Header.bmp&quot;<br />
instead !define MUI_HEADERBITMAP &quot;C:\Documents and Settings\me\Desktop\Installer\Nsis\Contrib\Icons\Header.bmp&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deepesh83</div><div class="date">16th March 2005, 10:02</div></div><div class="posttext">Thank You Glory_men it worked.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>