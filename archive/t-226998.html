<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Install Options: Prompt for variable, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Install Options: Prompt for variable NSIS Discussion" />
	
	<title> Install Options: Prompt for variable [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Install Options: Prompt for variable</div>
<hr />
<div class="pda"><a href="t-226998.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=226998">Install Options: Prompt for variable</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">JATO</div><div class="date">26th September 2005, 22:35</div></div><div class="posttext">Please Help! :)  I'm relatively new to NSIS site. I've searched the Forums and InstallOptions documentation to no avail.<br />
<br />
Trying to prompt the user for the name of a remote computer<br />
then use that &quot;CompName&quot; to build a path.<br />
<br />
I' ve looked thru InstallOptions and can't figure it out.<br />
I get that I need an INI file, that's fine... it's the instructions on how to get the custom page to display that are messing me up.<br />
<br />
Can anyone provide some sample scripts? (not the same in NSIS documentation)<br />
<br />
Here's what i'm trying to do...<br />
<br />
Text box to type in ComputerName (example: SCC40234)<br />
Hit NEXT<br />
the users input is pasted into a path like:<br />
\\SCC40234\c$\Windows\System32<br />
and then 2 files are copied over.<br />
<br />
DONE<br />
<br />
Like I said, the examples in InstallOptions are confusing me, I've been trying to write this script for a week and get nothing but errors.<br />
<br />
PLEAZ help! :cry:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">26th September 2005, 22:39</div></div><div class="posttext">In the INI file:<br />
<br />
[Settings]<br />
NumFields=1<br />
<br />
[Field 1]<br />
Type=text<br />
Value=<br />
State=Default Computer Name<br />
Left=<br />
Right=<br />
Top=<br />
Bottom=<br />
<br />
In installer script:<br />
<br />
Page Custom Pre Post<br />
...<br />
Function Pre<br />
  ; init dialog<br />
  Pop $R0 ; hwnd to window<br />
  ; show dialog<br />
FunctionEnd<br />
<br />
Function Post<br />
  ReadINIStr $R1 &lt;ini file&gt; &quot;Field 1&quot; &quot;State&quot;<br />
  ; $R1 has the value of the computer name entered by user<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JATO</div><div class="date">26th September 2005, 23:30</div></div><div class="posttext">I get a blank screen with a progress bar which has &quot;Install&quot; and &quot;Cancel&quot; buttons..but nothing else on it.<br />
If I hit Install.. then I can see that it is trying to copy the files from the path but it's missing the $R1 string so of course the copy fails. <br />
<br />
The custom page doesn't show up on the screen therefore NSID never pauses on the Custom page so the user can input the field<br />
Here's my entire code.. I'm keeping it simple for right now, 'til I figure out what I'm doing wrong.....<br />
<br />
<br />
Outfile Mapi.exe<br />
<br />
Function .onInit<br />
<br />
  InitPluginsDir<br />
  File /oname=c:\mapi.ini mapi.ini<br />
<br />
FunctionEnd<br />
<br />
<br />
Page Custom Pre Post<br />
<br />
<br />
Function Pre<br />
  ; init dialog<br />
  Pop $R0 ; hwnd to window<br />
  ; show dialog<br />
InstallOptions::dialog c:\mapi.ini<br />
FunctionEnd<br />
<br />
Function Post<br />
  ReadINIStr $R1 mapi.ini &quot;Field 1&quot; &quot;State&quot;<br />
  ; $R1 has the value of the computer name entered by user<br />
FunctionEnd<br />
<br />
Page instfiles<br />
<br />
Section Copy<br />
 CopyFiles $SYSDIR\mapi.dll \\$R1\C$\windows\system32\mapi.dll<br />
 CopyFiles $SYSDIR\mapisrvr.exe \\$R1\c$\windows\system32\mapisrvr.exe<br />
SectionEnd<br />
<br />
<br />
I guess I just don't understand How the custom page system works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">27th September 2005, 00:27</div></div><div class="posttext">Try doing:<br />
<br />
...<br />
Page Custom Pre Post<br />
Page instfiles<br />
...<br />
Function .onInit<br />
  InitPluginsDir<br />
  SetOutPath &quot;$PLUGINSDIR&quot;<br />
  File &quot;mapi.ini&quot;<br />
FunctionEnd<br />
...<br />
Function Pre<br />
  InstallOptions::dialog &quot;$PLUGINSDIR\mapi.ini&quot;<br />
FunctionEnd<br />
Function Post<br />
  ; R1 should have the company name entered<br />
  ReadINIStr $R1 &quot;$PLUGINSDIR\mapi.ini&quot; &quot;Field 1&quot; &quot;State&quot;<br />
...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JATO</div><div class="date">27th September 2005, 02:19</div></div><div class="posttext">OK.. I incoporated the code and NOW I get a dialog box..<br />
I used <br />
<br />
Right=-1<br />
Top=0<br />
Bottom=12<br />
<br />
<br />
BUT...<br />
the <br />
ReadINIStr $R1 &quot;$PLUGINSDIR\mapi.ini&quot; &quot;Field 1&quot; &quot;State&quot;<br />
Doesn't return the value of Field1<br />
<br />
If I use MessageBox MB_OK &quot;$R1&quot;  all I get is &quot;Success&quot;<br />
<br />
If I refer to $R1 in a file path I get...<br />
Copy to \\success\C$\windows\system32\mapi.dll<br />
Copy failed<br />
<br />
So I've made progress, I just can't tell why it is registering the field as &quot;sucess&quot; and not the actual value?<br />
<br />
InstallOptions says this...<br />
To get the input of the user, read the State value of a Field using ReadINIStr:<br />
<br />
ReadINIStr $R0 &quot;$PLUGINSDIR\test.ini&quot; &quot;Field 1&quot; &quot;State&quot;<br />
<br />
<br />
But obviosuly it's not that simple..there's something else to it..???</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th September 2005, 13:11</div></div><div class="posttext">Make sure you use ReadINIStr in the leave function not the creation function.<br />
<br />
Page Custom CreateFunc LeaveFunc<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JATO</div><div class="date">27th September 2005, 23:34</div></div><div class="posttext">Thanks Afrow :)<br />
<br />
after using  Create and Leave <br />
and then removing an extra POP command<br />
<br />
it's working fine now<br />
<br />
Thanks Goldy1604 for your quick responses as well. <br />
Sometimes I get such a quick response on these forums it's almost like Instant messaging. :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>