<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Change description font in component page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Change description font in component page NSIS Discussion" />
	
	<title> Change description font in component page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Change description font in component page</div>
<hr />
<div class="pda"><a href="t-258530.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258530">Change description font in component page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">nsisuser</div><div class="date">29th October 2006, 12:59</div></div><div class="posttext">I'm using UMUI for my installer and the default message in the description box is very hard to read (you know the one saying &quot;Position your mouse over a component to see its description&quot;).<br />
<br />
I tried to change the font using this code, but no luck -- it only changed the &quot;onmouseOver&quot; description text :<br />
<br />
Function &quot;ComponentShow&quot;<br />
FindWindow $0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
GetDlgItem $0 $0 1043<br />
CreateFont $1 &quot;Arial&quot; 8 0<br />
SendMessage $0 ${WM_SETFONT} $1 0<br />
SetCtlColors $0 000000 TRANSPARENT<br />
FunctionEnd<br />
 <br />
<br />
Anyone can help me with this ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">29th October 2006, 18:32</div></div><div class="posttext">Looks like MUI is doing funky things.  The only way to make this work cleanly that I've found is to specify a non-transparent background color;<br />
<br />
<br />
	FindWindow $0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
	GetDlgItem $0 $0 1043<br />
	CreateFont $1 &quot;Arial&quot; 12 400<br />
	SendMessage $0 ${WM_SETFONT} $1 0<br />
	SetCtlColors $0 0x000000 0xd4d0c8<br />
<br />
<br />
The problem is in the '0xd4d0c8'.  That color is defined somewhere on the system as being the background color for dialogs.  But I'll be darned if I can find where.  There's...<br />
HKCU\Control Panel\Colors<br />
...where matching values on my machine are for:<br />
- ButtonFace<br />
- InactiveTitleText<br />
- Menu<br />
- Scrollbar<br />
<br />
But none of those particularly strike me as being -the- color used by dialogs.  'll have to look further, or let somebody else butt in about how to get the dialog's color :)<br />
<br />
Edit:<br />
&quot;ButtonFace&quot; is the one of interest.<br />
<br />
Now the next problem is this.. the registry stores the values as &quot;intR intG intB&quot;.  How on Eerth to get a hex -value- out of that.  I can easily turn it into a hex string (splice the string into its three bits, convert each three bits from decimal to hexadecimal).<br />
<br />
However...<br />
<br />
<br />
StrCpy $2 &quot;0xff0000&quot;<br />
SetCtlColors &lt;handle&gt; $2<br />
<br />
<br />
does not result in the same effect as:<br />
<br />
<br />
SetCtlColors &lt;handle&gt; &quot;0xff0000&quot;<br />
<br />
<br />
I'm rather stuck on that part.  Anybody? %)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">30th October 2006, 00:24</div></div><div class="posttext">and I guess as much is noted in the manual:<br />
<br />
text_color and bg_color don't accept variables.<br />
<br />
<br />
Also tried trickery with /BRANDING , but the original problem occurs.<br />
<br />
So I'm afraid that as far as my tests go, you'll either..<br />
- have to live with the font 'as is'<br />
- use a resource hacker to force a bigger font (see MUI docs)<br />
- do use setctlcolors, but with a non-transparent background, which means<br />
-- force a particular background color, which may not be the user's system color for the backgrounds<br />
-- force your entire installer to be in a particular color, so that the above is rendered moot %)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">30th October 2006, 00:41</div></div><div class="posttext">Okay, here we go... just bypass MUI altogether.<br />
<br />
Note that you -cannot- use:<br />
!insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />
!insertmacro MUI_DESCRIPTION_TEXT &lt;section&gt; &lt;string&gt;<br />
!insertmacro MUI_FUNCTION_DESCRIPTION_END<br />
<br />
As using those will throw a duplicate function error...<br />
<br />
<br />
!include &quot;MUI.nsh&quot;<br />
!include &quot;LogicLib.nsh&quot;<br />
<br />
Name &quot;Modern UI Test&quot;<br />
OutFile &quot;Basic.exe&quot;<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW ChangeFont<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
!insertmacro MUI_PAGE_INSTFILES<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
Function ChangeFont<br />
	FindWindow $0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
	GetDlgItem $0 $0 1043<br />
	CreateFont $1 &quot;Times New Roman&quot; 12 400<br />
	SendMessage $0 ${WM_SETFONT} $1 0<br />
FunctionEnd<br />
<br />
Section &quot;Dummy Section 1&quot; SecDummy<br />
<br />
SectionEnd<br />
<br />
Section &quot;Dummy Section 2&quot; SecDummy2<br />
<br />
SectionEnd<br />
<br />
Function .onMouseOverSection<br />
    FindWindow $R0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
    GetDlgItem $R0 $R0 1043 ; description item<br />
	${If} $0 == -1<br />
      EnableWindow $R0 0<br />
      SendMessage $R0 ${WM_SETTEXT} 0 &quot;STR:Position your mouse over a component to see its description&quot;<br />
	${Else}<br />
		EnableWindow $R0 1<br />
		${If} $0 == 0<br />
			SendMessage $R0 ${WM_SETTEXT} 0 &quot;STR:first section description&quot;<br />
		${ElseIf} $0 == 1<br />
			SendMessage $R0 ${WM_SETTEXT} 0 &quot;STR:second section description&quot;<br />
		${EndIf}<br />
	${EndIf}<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsisuser</div><div class="date">30th October 2006, 11:59</div></div><div class="posttext">Thanks for this code. At least, I know how to access the default text &quot;Position your mouse...&quot; -- <br />
<br />
But there is one more question : How can I get rid of the &quot;engraved&quot; look of the default text ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th October 2006, 12:03</div></div><div class="posttext">EnableWindow $R0 0 gives it the engraved look, so just change it to 1 or try removing all EnableWindow instructions.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">30th October 2006, 12:30</div></div><div class="posttext">MUI starts with the default text engraved (disabled), so you have to enable it first (in the area where you change the font).  After that you can do away with the rest of the EnableWindow statements.<br />
<br />
<br />
!include &quot;MUI.nsh&quot;<br />
!include &quot;LogicLib.nsh&quot;<br />
<br />
Name &quot;Modern UI Test&quot;<br />
OutFile &quot;Basic.exe&quot;<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW ChangeFont<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
!insertmacro MUI_PAGE_INSTFILES<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
Function ChangeFont<br />
    FindWindow $0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
    GetDlgItem $0 $0 1043<br />
    CreateFont $1 &quot;Times New Roman&quot; 12 400<br />
    SendMessage $0 ${WM_SETFONT} $1 0<br />
    EnableWindow $0 1<br />
FunctionEnd<br />
<br />
Section &quot;Dummy Section 1&quot; SecDummy<br />
<br />
SectionEnd<br />
<br />
Section &quot;Dummy Section 2&quot; SecDummy2<br />
<br />
SectionEnd<br />
<br />
Function .onMouseOverSection<br />
    FindWindow $R0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
    GetDlgItem $R0 $R0 1043 ; description item<br />
    ${Select} $0<br />
		${Case} -1<br />
			SendMessage $R0 ${WM_SETTEXT} 0 &quot;STR:Position your mouse over a component to see its description&quot;<br />
		${Case} 0<br />
			SendMessage $R0 ${WM_SETTEXT} 0 &quot;STR:first section description&quot;<br />
		${Case} 1<br />
			SendMessage $R0 ${WM_SETTEXT} 0 &quot;STR:second section description&quot;<br />
    ${EndSelect}<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsisuser</div><div class="date">30th October 2006, 12:39</div></div><div class="posttext">Works like a charm. Thanks.<br />
<br />
Why is it that the &quot;disabled&quot; look is so awful in UMUI and looks OK in all other templates. Is there a way to change how the &quot;disabled font&quot; is rendered ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">30th October 2006, 12:55</div></div><div class="posttext">I'm not sure what it looks like in UltraModern UI - it doesn't look too great in MUI in the location it is, though.  It's just not a very good place to have a piece of disabled text :)<br />
<br />
I don't think there is a way to change what a disabled control looks like from within NSIS.  It should just render with the default disabled control 'look' (e.g. like a browser 'Back' label when you're on a fresh new page).  But you can always give it any color you'd like using the earlier code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsisuser</div><div class="date">30th October 2006, 15:44</div></div><div class="posttext">Thanks a lot for all the insights, Animaether. I was finally able to get nsis to do exactly what I wanted. <br />
<br />
For others who might be interested, here's the code I came up with in order to make the default description show in one color (light blue) and the section descriptions in another color (white)<br />
<br />
!include &quot;UMUI.nsh&quot;<br />
!include &quot;LogicLib.nsh&quot;<br />
<br />
Name &quot;Modern UI Test&quot;<br />
OutFile &quot;Font text.exe&quot;<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW ChangeFont<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
!insertmacro MUI_PAGE_INSTFILES<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
Function ChangeFont<br />
    FindWindow $0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
    GetDlgItem $0 $0 1043<br />
    CreateFont $1 &quot;Arial&quot; 8 400<br />
    SendMessage $0 ${WM_SETFONT} $1 0<br />
    EnableWindow $R0 1<br />
FunctionEnd<br />
<br />
<br />
Section &quot;Dummy Section 1&quot; SecDummy<br />
<br />
SectionEnd<br />
<br />
Section &quot;Dummy Section 2&quot; SecDummy2<br />
<br />
SectionEnd<br />
<br />
Function .onMouseOverSection<br />
    FindWindow $R0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
    GetDlgItem $R0 $R0 1043 ; description item<br />
    ${If} $0 == -1<br />
      CreateFont $1 &quot;Arial&quot; 9 700 ; create the font for the default description<br />
      SetCtlColors $R0 0xBDBED5 0x3d66ab ; set colors to : font light blue (0xBDBED5) - bg blue (0x3d66ab)<br />
      SendMessage $R0 ${WM_SETFONT} $1 0<br />
      SendMessage $R0 ${WM_SETTEXT} 0 &quot;STR:Position your mouse over a component to see its description&quot;<br />
    ${Else}<br />
        CreateFont $1 &quot;Arial&quot; 9 400 ; create the font for mouse over descriptions<br />
        SetCtlColors $R0 0xFFFFFF 0x3d66ab ; set colors to : font white (0xffffff) - bg blue (0x3d66ab)<br />
        SendMessage $R0 ${WM_SETFONT} $1 0<br />
        ; show description for each section<br />
        ${If} $0 == 0<br />
            SendMessage $R0 ${WM_SETTEXT} 0 &quot;STR:first section description&quot;<br />
        ${ElseIf} $0 == 1<br />
            SendMessage $R0 ${WM_SETTEXT} 0 &quot;STR:second section description&quot;<br />
        ${EndIf}<br />
    ${EndIf}<br />
FunctionEnd<br />
 <br />
<br />
Have a nice day !<br />
<br />
Chris</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>