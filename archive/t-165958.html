<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Need SetCurInstType Instruction Help, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Need SetCurInstType Instruction Help NSIS Discussion" />
	
	<title> Need SetCurInstType Instruction Help [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Need SetCurInstType Instruction Help</div>
<hr />
<div class="pda"><a href="t-165958.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=165958">Need SetCurInstType Instruction Help</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jnjosh1979</div><div class="date">21st January 2004, 16:53</div></div><div class="posttext">Hi.<br />
<br />
 I am having a problem with my SetCurInstType Instruction. It seems to be acting wierd. I am using NSIS2rc2 with the following code. I am trying to use 2 InstTypes and based on a variable which i set, install the correct section.<br />
<br />
Heres the code:<br />
        ;&lt;----at beginning of script-----&gt; <br />
        InstType &quot;Software Version A&quot;<br />
        InstType &quot;Software Version B&quot;<br />
<br />
        ;&lt;----section area of script-------&gt; <br />
        Section &quot;Program Files A&quot;<br />
           SectionIn 1<br />
           ;&lt;--blah code blah--&gt;<br />
        SectionEnd<br />
        <br />
        Section &quot;Program Files B&quot;<br />
           SectionIn 2<br />
           ;&lt;--blah code blah--&gt;<br />
        SectionEnd<br />
        <br />
        ;&lt;----in the .onInit function-------&gt; <br />
        ;// installing to software 'A'<br />
        StrCmp ${SOFTVER} &quot;A&quot; 0 LookAgain<br />
        SetCurInstType 1<br />
        goto CleanExit<br />
<br />
        LookAgain:<br />
          ;// installing to software 'B'<br />
          StrCmp ${SOFTVER} &quot;B&quot; 0 Error1<br />
          SetCurInstType 2<br />
	  goto CleanExit<br />
<br />
        Error1:<br />
          MessageBox MB_OK &quot;Hey, what are you doing! Go Home...&quot;<br />
        CleanExit:<br />
        ;&lt;-----------&gt; <br />
<br />
I have found an entry in the forum saying that SetCurInstType is a zero-based instruction unlike SectionIn, but when I use 0 and 1 rather than 1 and 2, it does the same thing.<br />
<br />
Please Help and Thanks in advance,<br />
Josh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">21st January 2004, 17:01</div></div><div class="posttext">Do you have a components page?<br />
<br />
SetCurInstType only works with a components page, otherwise just put the checks in a section.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stnchris</div><div class="date">18th February 2004, 19:43</div></div><div class="posttext">somewhat releated... <br />
<br />
If the installer has a components page, but is run in silent mode, the sections seem to ignore the value set by SetCurInstType. That is, GetCurInstType sees that the values have been set, but the Sections that are run are the ones for the zero-th install type.<br />
<br />
See attached .nsi that demonstrates the problem. In .onInit, it pops up a message box asking which install type to use. If you say 'no', it should switch to the second install type. <br />
<br />
In nonsilent mode, this works. In silent mode, the section for the first install type is run, even though GetCurInstType reports that the second install type has been set.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">18th February 2004, 22:38</div></div><div class="posttext">This behavior is documented and is a limitation of the current implementation of this instruction.<br />
<br />
A better implementation is already on the to-do list.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">OriginalSinner</div><div class="date">21st January 2005, 21:26</div></div><div class="posttext">Originally posted by Joost Verburg <br />
A better implementation is already on the to-do list.  <br />
<br />
Has this made it to the top of the todo list yet :)<br />
<br />
It would be useful to be able to Abort the Components page if the install type had already been set in the reg for example.<br />
<br />
I know it could be scripted but this means adding something to each section and when you have 40 sub/sections it makes the script a bit ugly.<br />
<br />
Just wondered if it was going to make it into a release anytime soon.<br />
<br />
Cheers,<br />
Phil</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st January 2005, 21:28</div></div><div class="posttext">It has already been removed from the TODO list. SetCurInstType works without the components page on the latest CVS version.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>