<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Is it possible, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Is it possible NSIS Discussion" />
	
	<title> Is it possible [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Is it possible</div>
<hr />
<div class="pda"><a href="t-145337.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=145337">Is it possible</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">10th August 2003, 17:15</div></div><div class="posttext">To have a link on the Welcome page<br />
<br />
like the Finish page<br />
<br />
!define MUI_FINISHPAGE_LINK &quot;My Website&quot;<br />
!define MUI_FINISHPAGE_LINK_LOCATION &quot;http://&quot;<br />
<br />
Because I have done it but its invisible, but when you click on it it shows.<br />
<br />
The background is grey unlike the one on the Finishpage<br />
<br />
I've done it by using a ini file, but like I said it's invisible untill pressed<br />
<br />
Is there any way to make it visible?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th August 2003, 18:44</div></div><div class="posttext">You need to move the welcome text label up.<br />
This can be done by writing to the right value on the show function of the page, or by editing IOSpecial.ini<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">10th August 2003, 18:59</div></div><div class="posttext">In the standard ioSpecial.ini file used by MUI, [Field 3] has Top=50/Bottom=185. Suspect your new field ([Field 4]?) with the link is being &quot;hidden&quot; by [Field 3]. As Afrow UK suggests, you could move the bottom edge of [Field 3] up a bit to let your new field be seen.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">10th August 2003, 19:48</div></div><div class="posttext">That worked fine,<br />
<br />
I changed  Field 3 Bottom=185 to 175 but it still has a grey back, is there any wat to change this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th August 2003, 20:04</div></div><div class="posttext">Maybe you could change the colour with GetDlgItem and SendMessage.<br />
I dunno?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">10th August 2003, 20:41</div></div><div class="posttext">How do I go about doing that?<br />
<br />
Do you have an example of script I could learn from<br />
<br />
Here's a quick picture of what I wish to change<br />
<br />
The problem (http://www.darksaber.freeserve.co.uk/temp/Image2.gif)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">10th August 2003, 22:31</div></div><div class="posttext">It's simple, to use in welcome show page function<br />
<br />
!define MUI_CUSTOMFUNCTION_WELCOME_SHOW &quot;myfunc&quot;<br />
<br />
Function &quot;myfunc&quot;<br />
FindWindow $0 &quot;#32770&quot; &quot;&quot; $MUI_HWND<br />
GetDlgItem $0 $0 1203 ; remember: 1200 + Field_number<br />
SetBkColor $0 0x00FFFFFF ; turn white the block<br />
FunctionEnd<br />
<br />
<br />
<br />
Oops! :D fixed :p</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th August 2003, 22:34</div></div><div class="posttext">Use WELCOME instead of FINISH.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">10th August 2003, 23:34</div></div><div class="posttext">Thanks for the code<br />
<br />
but it just doesn't seem to want to work<br />
<br />
I've tried it in my script and tried placing it in the System.nsh<br />
<br />
so I'm a littl stuck :cry:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th August 2003, 23:42</div></div><div class="posttext">Attach your script. Defined at the right position (see Modern UI Readme)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">10th August 2003, 23:51</div></div><div class="posttext">ok here it is<br />
<br />
Zip File (http://www.darksaber.freeserve.co.uk/temp/DSUCP4.zip)<br />
<br />
prehaps you could also have a look through just to check though it<br />
<br />
Thanks so much</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th August 2003, 00:28</div></div><div class="posttext">This isn't related to your current problem, but you have a few errors in the script.<br />
<br />
&quot;IntCmp $2 +1 +1 +1 +3&quot; is wrong<br />
<br />
You are comparing the number (integer) stored in $2 to +1, which is wrong to start with because &quot;+1&quot; isn't an integer (it's a string).<br />
If the value of $2 will be &quot;+1&quot; or similar, use StrCmp.<br />
<br />
Also, you've got some $\r$\r, and some $\n in message boxes.<br />
The correct way is $\r$\n for newline breaks.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th August 2003, 00:31</div></div><div class="posttext">As for the problem itself, this line is wrong:<br />
<br />
GetDlgItem $0 $0 1204 ; remember: 1200 + Field_number<br />
<br />
It should be<br />
<br />
GetDlgItem $0 $0 1203<br />
<br />
The number should be 1200 + field number - 1.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th August 2003, 00:31</div></div><div class="posttext">Btw, that backup macro would be useful.<br />
I never thought of using it that way.<br />
<br />
Is it from the Archive, or one of the forum topics?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th August 2003, 00:34</div></div><div class="posttext">There is a problem with your backup macro. It assumes that $INSTDIR is $PROGRAMFILES\LucasArts\XwingAlliance. You better use $INSTDIR instead because it could be changed by InstallDirRegKey and any other piece of code you might add in the future that tempers with $INSTDIR.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">11th August 2003, 01:37</div></div><div class="posttext">Ok I fixed $INSTDIR problem<br />
<br />
I'm not sure where I got the Backup Macro, I thought you helped me with that? :) not sure, it might have been from the archive, or I found it in a script somewhere.<br />
<br />
If you want to use it go ahead, it works fine :)<br />
<br />
Fixed GetDlgItem $0 $0 1203, but it din't make any differance still have a grey box, If can't solve it I'll remove it<br />
<br />
Afrow, I'm not too clear on<br />
 <br />
&quot;IntCmp $2 +1 +1 +1 +3&quot; is wrong <br />
<br />
You are comparing the number (integer) stored in $2 to +1, which is wrong to start with because &quot;+1&quot; isn't an integer (it's a string). <br />
If the value of $2 will be &quot;+1&quot; or similar, use StrCmp.<br />
<br />
THe number thing still confuses me :(<br />
<br />
Oh and I replaced the IntCmp with StrCmp, didn't channge the numbers, but it wouldn't complie<br />
<br />
What should the line look like please?<br />
<br />
Are there any other bugs that could be solved</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">11th August 2003, 02:19</div></div><div class="posttext">Another thing I wanted to ask<br />
<br />
instead of Checking the Reg for JoystickID with this code which is wrong anyhow<br />
<br />
ReadRegStr $2 HKLM &quot;SOFTWARE\LucasArts Entertainment Company LLC\X-Wing Alliance\v1.0&quot; &quot;JoystickID&quot;<br />
IntCmp $2 +1 +1 +1 +3<br />
MessageBox MB_ICONSTOP|MB_OK &quot;Warning:  X-Wing: Alliance is not installed.&quot;<br />
Abort<br />
<br />
How would I do it if I wanted to check for the existance of XwingAlliance.exe<br />
<br />
If the file is not there is quits, but if the file is there it continues to this code<br />
<br />
sysinfo::GetFileVersion &quot;$INSTDIR\XwingAlliance.exe&quot;<br />
Pop $0<br />
Push $0<br />
Push &quot;.&quot;<br />
Push &quot;&quot;<br />
Call StrReplace<br />
Pop $0<br />
IntCmp $0 2002 +3 0 +3<br />
MessageBox MB_ICONSTOP|MB_OK  &quot;WARNING:Blah.&quot;<br />
Abort</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">11th August 2003, 16:34</div></div><div class="posttext">Finally fixed the Grey block but I didn't use the code Lobo Lunar suppiled, I just couldn't get that to work<br />
<br />
Eventually I edited the System.nsh<br />
<br />
but a litle help with the above problem would be great<br />
<br />
Thanks<br />
<br />
-Tony</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th August 2003, 17:15</div></div><div class="posttext">Editing System.nsh is not a good solution.<br />
<br />
$MUI_HWND contains the HWND of the inner IO dialog, so you need something like this:<br />
<br />
GetDlgItem $0 $MUI_HWND 1203 <br />
SetBkColor $0 0xFFFFFF</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th August 2003, 17:21</div></div><div class="posttext">As for the &quot;+1&quot; thing, NSIS will treat +1 as 0. NSIS's atoi (string to number) function only treats the minus signal, not the plus sign. Therefore when it won't see any digits but only the plus sign it will convert no longer and will remain with the result 0. If you wish to compare to 1 you should do it like this:<br />
<br />
IntCmp $2 1 +1 +1 +3<br />
<br />
The relative jump numbers do accept the plus sign but it's not mandatory.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">11th August 2003, 18:07</div></div><div class="posttext">Yeah Joost, thats excatly what I did :)<br />
<br />
Ans sorry Kichik to waste your time but, I was going to remove the Check reg for JoystikID thing and replace it with something like:-<br />
<br />
If file exist = Xwingalliance.exe carry on with the install to check if its the correct version (which I have already done), but if it doesn't detect the existance of XWA.exe it quits<br />
<br />
The thing is I can only get as far as If file exists and abort, I'm not sure what the code should be any help would be great or a pointer to an example or prvious forum topic<br />
<br />
I have tried searching for something like this but with no result<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th August 2003, 18:27</div></div><div class="posttext">You should add it to your function, not to System.nsh.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">11th August 2003, 18:57</div></div><div class="posttext">I tried it again and I couldn't get it to work<br />
<br />
I even tried changing all of them to<br />
<br />
Function &quot;myfunc&quot;<br />
FindWindow $0 &quot;#32770&quot; &quot;&quot; $MUI_HWND<br />
GetDlgItem $0 $0 1201<br />
SetBkColor $0 0xFFFFFF<br />
GetDlgItem $0 $0 1202<br />
SetBkColor $0 0xFFFFFF<br />
GetDlgItem $0 $0 1200<br />
SetBkColor $0 0xFFFFFF<br />
GetDlgItem $0 $0 1203<br />
SetBkColor $0 0xFFFFFF<br />
FunctionEnd<br />
<br />
<br />
As it is set up in the System.nsh<br />
<br />
It still remained the same a litte gray box around it<br />
<br />
Could I ask why I shouldn't change the system.nsh?<br />
<br />
Is it to do with copyright and stuff with NSIS?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th August 2003, 19:21</div></div><div class="posttext">Copy the code of my post to your function. You should not use the FindWindow stuff.<br />
<br />
Changeing System.nsh is not a good idea because you will have to change it again when System.nsh will be updated and it's also not easy to maintain.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th August 2003, 20:05</div></div><div class="posttext">If you want to cancel the installation if the file doesn't exist you should check for it in the .onInit function. If it doesn't exist call Abort and the installation won't even start. It's recommended that you show a message box stating why the installer didn't start so the user won't get confused.<br />
<br />
To check if a file exists you should use IfFileExists.<br />
<br />
I hope I understood you right. If not, please say so.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">11th August 2003, 20:06</div></div><div class="posttext">Sorry I did'nt take push notice of your code thinking it the same as Lobo Lunar's<br />
<br />
Thanks it's now fixed.<br />
<br />
Plus I apologise again, I never thought about the System.nsh changing when updating<br />
<br />
This will teach me to take more notice of things when I ask for help<br />
<br />
Sorry I'm not worthy :)<br />
<br />
Now to my other problem about searching for the XwingAlliance.exe<br />
<br />
Please see above post<br />
<br />
Thanks Joost for being so patient :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th August 2003, 20:18</div></div><div class="posttext">Do you to search for it on the entire hard disk or just in $INSTDIR? If just in $INSTDIR then IfFileExists is what you need. If on the entire hard disk use this:<br />
<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=266</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">11th August 2003, 20:44</div></div><div class="posttext">No I only want it to look for it in $INSTDIR, This bit of code only looks for it then if found shows the message and aborts.<br />
<br />
Function .onInit<br />
IfFileExists &quot;$INSTDIR\XwingAlliance.exe&quot; 0 +3<br />
MessageBox MB_ICONSTOP|MB_OK &quot;Warning:  X-Wing: Alliance has not yet been installed on your computer.&quot;<br />
Abort<br />
Function<br />
<br />
Which is not what I would like it to do<br />
<br />
What I would like it to do is, if it is found in the $INSTDIR to continue with the setup, but if it's not found then it shows the message and aborts.<br />
<br />
I know it will probably have something to do with Goto, but thats where I'm stuck!<br />
<br />
The next thing it would do is to check the version ot see if it is the correct version, using this bit of code in the Function .onInit section which works fine.<br />
<br />
<br />
sysinfo::GetFileVersion &quot;$PROGRAMFILES\LucasArts\XwingAlliance\XwingAlliance.exe&quot;<br />
Pop $0<br />
Push $0<br />
Push &quot;.&quot;<br />
Push &quot;&quot;<br />
Call StrReplace<br />
Pop $0<br />
IntCmp $0 2002 +3 0 +3<br />
MessageBox MB_ICONSTOP|MB_OK &quot;WARNING: Incorrect Version blah blah blah.&quot;<br />
Abort<br />
<br />
Function StrReplace<br />
replace code and stuff blah blah<br />
FunctionEnd<br />
<br />
Oh yeah I did look at that code you suggested, but I don't think it would be any good as like you said it searches the whole HD.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th August 2003, 20:50</div></div><div class="posttext">Nothing with Goto, it's actually very simple. Just remove that 0 that comes before +3. What you've told IfFileExists to do is to jump +3 if it didn't find that file. The first number tells it where to jump if it did find, the second if it didn't. You've mixed them up, that's all.<br />
<br />
The second piece of code that checks the version can come right after the first piece. It should work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">11th August 2003, 21:17</div></div><div class="posttext">Jezz it was that simple, now i feel stupid :p<br />
<br />
Anyhow it works fine thanks :)<br />
<br />
Quick question<br />
<br />
Can you center MessageBox text?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th August 2003, 21:23</div></div><div class="posttext">There is no direct way. You can pad the text with spaces from both sizes, but you can never be sure it will work on all configurations.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th August 2003, 21:24</div></div><div class="posttext">You have a multi-line message box and want the text to be centered? I don't think that's a good idea (it doesn't look nice and isn't the Windows style).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">11th August 2003, 23:56</div></div><div class="posttext">Ok just wondered<br />
<br />
Anyhow last question, how do I go about changing the text colour of the Finish page link without editing the System.nsh?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th August 2003, 23:58</div></div><div class="posttext">Use the TxtColor setting (see InstallOptions Readme).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">12th August 2003, 01:33</div></div><div class="posttext">No I'm using the<br />
<br />
!define MUI_FINISHPAGE_LINK<br />
!define MUI_FINISHPAGE_LINK_LOCATION<br />
<br />
in my script, and since the colour is defined in the System.nsh file for the link how would I change it for my script to refer to changing the colour, do I have to create a new ini file, if so, how do I tell it to to change the link colour on the Finish page<br />
<br />
plus I'm already using the !define MUI_SPECIALINI for ini file for the link on the Welcome page</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th August 2003, 13:07</div></div><div class="posttext">You should simply write the desired TxtColor value into ioSpecial.ini in the pre function of the finish page. Look for MUI_CUSTOMFUNCTION_FINISH_PRE in the MUI readme for more information about the pre function of the finish page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">12th August 2003, 13:37</div></div><div class="posttext">I'll add a setting to the Modern UI. That's easier for you :)<br />
<br />
Edit: done :) Get the latest development version and use MUI_FINISHPAGE_LINK_COLOR. See Readme for details.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">12th August 2003, 23:13</div></div><div class="posttext">Thanks  so much this will help alot</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">13th August 2003, 02:30</div></div><div class="posttext">That was so easy, Thanks you :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>