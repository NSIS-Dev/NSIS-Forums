<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Process Functions Header, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Process Functions Header NSIS Discussion" />
	
	<title> Process Functions Header [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Process Functions Header</div>
<hr />
<div class="pda"><a href="t-290325.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=290325">Process Functions Header</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">wraithdu</div><div class="date">16th April 2008, 05:28</div></div><div class="posttext">I've written a header file with several process related functions I wanted to see in NSIS.  These were inspired by PortableApps.com where we use NSIS to script the portable launchers.  My goal was to accomplish everything using only the System plugin, so there are no external dependencies.  Only one alternate function requires a 3rd party plugin.  I hope some other people can find this useful as well.<br />
<br />
Download ProcFunc.nsh (http://nascent-project.org/wraithdu/files/NSIS/ProcFunc.nsh)<br />
<br />
${ProcessExists}<br />
Determines if a given process exists by name or PID, and returns the Process ID (PID).<br />
<br />
${GetProcPath}<br />
Determines first if a process exists, and returns the full path by name or PID.<br />
<br />
${GetProcName}<br />
If the process exists, returns the name by PID.<br />
<br />
${ProcessPathSearch}<br />
Searches all running process paths for a given search term, then passes that path and the process's PID to a user defined function for processing (works like the GetDrives macro). Use .::RETURN_ALL::. as the searchterm to return all running process paths.<br />
<br />
${ProcessWait}<br />
Will pause script execution until the given process exists or until timeout, by name. Will poll for the process every 500ms. Returns the process's PID, or -1 if timed out.<br />
WARNING: this function is CPU intensive on Windows Vista. I recommend using ${ProcessWait2} if the script will be in this state for an extended period of time.<br />
<br />
${ProcessWait2}<br />
Same as ${ProcessWait}, but requires the FindProcDLL plugin, polls every 250ms, and produces much lower CPU load on Windows Vista.<br />
<br />
${ProcessWaitClose}<br />
Will pause script execution until the given process no longer exists, by name or PID. Can specify a timeout value (how long to wait), or wait indefinitely. Returns the PID of the closing process if successful, -1 if timed out.<br />
<br />
${CloseProcess}<br />
Closes a process by name or PID by sending the WM_CLOSE message to all windows owned by the process. This is the MS recommended method for closing a process. It will give you the opportunity, for example, to save an unsaved txt file open in notepad. This command will return immediately after sending the messages, so it's advisable to check when the process actually closes, ie with ${ProcessWaitClose}. Returns the closed process's PID.<br />
<br />
${TerminateProcess}<br />
Forcibly closes a process by name or PID. Returns the terminated process's PID.<br />
<br />
${Execute}<br />
Runs a process, supports commandline arguments. Allows you to optionally specify a working directory and returns the process's PID if successful, 0 if it fails.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wraithdu</div><div class="date">16th April 2008, 15:24</div></div><div class="posttext">Oops, quick fix in my ${ProcessWait} timeout counter.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th April 2008, 22:59</div></div><div class="posttext">That looks very useful and should have its own Wiki page. See the following link on creating pages on the Wiki.<br />
<br />
http://nsis.sourceforge.net/Starting_a_new_page<br />
<br />
It'd be worth mentioning this would only work on Windows NT and above on the Wiki page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wraithdu</div><div class="date">20th January 2010, 19:59</div></div><div class="posttext">I've updated ProcFunc to include, among other internal changes,<br />
<br />
${GetProcessParent}<br />
If the process exists, returns the parent process's PID.<br />
<br />
Download ProcFunc.nsh (http://zer0dev.com/dld/download.php?id=27)<br />
<br />
Project thread (http://portableapps.com/node/12561) on PortableApps.  This page will be kept up to date more so than this one.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>