<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MUI installer initial directory &amp; other queries, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MUI installer initial directory &amp; other queries NSIS Discussion" />
	
	<title> MUI installer initial directory &amp; other queries [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MUI installer initial directory &amp; other queries</div>
<hr />
<div class="pda"><a href="t-150505.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=150505">MUI installer initial directory &amp; other queries</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">red-oct</div><div class="date">26th September 2003, 14:03</div></div><div class="posttext">Hi there, im new to all this. (a.k.a being a cabbage :igor: )<br />
Im using the MUI installer, What im trying to do is use the installer to copy a bunch of files to the users selected directory. <br />
<br />
The problem with this is that I want the installer to look in the directory it is in and copy the files from there to the chosen destination folder.<br />
<br />
What i have so far is:<br />
<br />
;Installer Sections<br />
<br />
Section &quot;jag.exe&quot; SecCopyUI<br />
<br />
  ;Add your stuff here<br />
<br />
  SectionIn RO<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  File &quot;C:\jag.exe&quot;<br />
  File &quot;C:\readme.txt&quot;<br />
<br />
So obviously the installer can only copy the files if they are in the C:\ root firectory. Could someone tell me what the command is for it to use the directory the installer is located in?<br />
<br />
Also for the MUI_FINISHPAGE I want to add an extra check box option in addition to &quot;Run program&quot;that will have &quot;View Readme&quot;. <br />
<br />
How do I do this? Yes I know that this must be blatantly obvious, but some simple steps on how to do so would be great please.<br />
<br />
Thanks in advance for trying to help a hopeless newbie.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th September 2003, 14:42</div></div><div class="posttext">* Add a directory page, use InstallDir and in the section, use SetOutPath.<br />
<br />
* A finish page 'Show Readme' option is available. Please see the Modern UI Readme.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">red-oct</div><div class="date">26th September 2003, 15:34</div></div><div class="posttext">Wow, thanks for the prompt reply!<br />
Okay let me see if im getting this right, but doesnt SetOutPath refer to the path that the user chooses for the installation files?<br />
This is the code I have:<br />
  ;Configuration<br />
<br />
  ;General<br />
  OutFile &quot;JAG-Installer.exe&quot;<br />
<br />
  ;Folder selection page<br />
  InstallDir &quot;$PROGRAMFILES\${MUI_PRODUCT}&quot;<br />
  <br />
  ;Remember install folder<br />
  InstallDirRegKey HKCU &quot;Software\${MUI_PRODUCT}&quot; &quot;&quot;<br />
<br />
Because I need the command that will tell the installer to look in the directory its being run for the files that it has to copy. If im wrong,would the code look like this?<br />
<br />
<br />
InstallDir &quot;SetOutPath&quot; <br />
<br />
Thanks for the help with the readme, I thought that I would have to manually insert a check box and what not in the ini file. That would have been a mission. Thanks for your help Joost</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th September 2003, 17:19</div></div><div class="posttext">To get the directory the installer resides in use $EXEDIR. This variable is a runtime variable, which means it will only have a value on runtime.<br />
<br />
SetOutPath is a command that sets $OUTDIR (and creates the directory if needed). $OUTDIR is the directory files will be extracted to using the File instruction, unless /oname was used and then the path specified there will be used. Therefore, InstallDir &quot;SetOutPath&quot; isn't what you're looking for. It will in fact result in an empty $INSTDIR.<br />
<br />
If you want to copy files from the installer's directory (for example, if the installer is on a CD along with some other files) use something like this:<br />
<br />
CopyFiles $EXEDIR\myFile.dat $INSTDIR<br />
<br />
This will copy myFile to the installation directory chosen by the user (if you used a directory page) or the default directory if the user chose not to change the installation directory or you didn't use a directory selection page.<br />
<br />
If you want to compress files from the directory the script is into the installer you don't have to use a full path. The working directory is automatically set to the directory in which the script is so you shouldn't worry about where it really is.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">red-oct</div><div class="date">27th September 2003, 03:17</div></div><div class="posttext">Thanks for that kichik. That was exactly what I was looking for. <br />
Unfortuntely this has now caused another problem in MUI_DIRECTORYPAGE. It no longer shows a proper value for space required. It shows 0.0 kb. <br />
<br />
Is there anyway to get it to read the entire directory that the install files are located, add up all the file sizes and display the total in the MUI_DIRECTORYPAGE for space required?<br />
<br />
Thanks again for the invaluable help kichik :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th September 2003, 10:27</div></div><div class="posttext">You can use AddSize (http://nsis.sourceforge.net/Docs/Chapter4.html#4.6.1.1) or SectionGet/SetSize (http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.13.7) if you're using the latest CVS version. AddSize is a compile command. You'd probably want to write an external program that would create an include file with AddSize in it, according to the size it will calculate. You can execute this program using !system and then include the file using !include.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">red-oct</div><div class="date">28th September 2003, 03:45</div></div><div class="posttext">Okay ive decided to go with the SetSize command, since I know the size of the files and they're not really going to change. <br />
Heres the question. What file is the present command for 'space required' located in? I had a look through the NSIS directory and subdirectories but couldn't find anything.<br />
<br />
Just wanted to know so that I could just replace the present space command with SetSpace.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th September 2003, 12:31</div></div><div class="posttext">SectionGetSize and SectionSetSize are both runtime commands. If the file sizes are not going to change AddSize will be much simpler. If you know the size of the files just add a line such as this to the appropriate section:<br />
<br />
AddSize 25984</div></div><hr />


<div class="post"><div class="posttop"><div class="username">red-oct</div><div class="date">28th September 2003, 13:13</div></div><div class="posttext">Where does it go though? Its for the MUI_DIRECTORY page so where do i add it in? Can I just add it into the main .nsi file?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th September 2003, 13:28</div></div><div class="posttext">It goes in a section. The directory page calculates the sum of all selected sections and displays that. Here's an example:<br />
<br />
Section &quot;Install bla&quot;<br />
AddSize 4531<br />
CopyFiles this.dat $INSTDIR<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">red-oct</div><div class="date">28th September 2003, 14:31</div></div><div class="posttext">You cannot imagine what a great help youve been kichik! If youre even in New Zealand give me a yell :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th September 2003, 14:45</div></div><div class="posttext">Will do :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>