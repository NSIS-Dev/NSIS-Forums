<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How Reactivate the menu close button (X) ?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How Reactivate the menu close button (X) ? NSIS Discussion" />
	
	<title> How Reactivate the menu close button (X) ? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How Reactivate the menu close button (X) ?</div>
<hr />
<div class="pda"><a href="t-304980.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=304980">How Reactivate the menu close button (X) ?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">LingoSag</div><div class="date">4th April 2009, 18:34</div></div><div class="posttext">Hi,<br />
<br />
By default NSIS disable the menu close button (X) at instfiles.<br />
<br />
But he not &quot;re-enable&quot; the same button after the installation completed.<br />
<br />
Is not a big problem with stadard Windows GUI,<br />
<br />
beacause we see clearly the state of the button.<br />
<br />
But, i use the SkinCrafter Skins and is not always<br />
<br />
easy to distinguish the actual state of the button.<br />
<br />
If the user click on the button the window dont close obviously.<br />
<br />
<br />
I try a post function for fix that,<br />
<br />
but NSIS &quot;re-disable&quot; the button.<br />
<br />
<br />
Another idea ?<br />
<br />
Tanks<br />
<br />
<br />
##########################################################################<br />
##########################################################################<br />
<br />
!include nsDialogs.nsh<br />
<br />
!include logiclib.nsh<br />
<br />
##########################################################################<br />
<br />
OutFile &quot;XTest.exe&quot;<br />
<br />
##########################################################################<br />
<br />
Caption &quot;Caption&quot;<br />
<br />
SubCaption 3 &quot; 33333&quot;<br />
<br />
SubCaption 4 &quot; 44444&quot;<br />
<br />
CompletedText &quot;CompletedText&quot;<br />
<br />
XPStyle on<br />
<br />
ShowInstDetails show<br />
<br />
##########################################################################<br />
<br />
Var MyDialog<br />
<br />
Var MyGroup<br />
<br />
##########################################################################<br />
<br />
Page custom MyCustomWelcome<br />
<br />
Page instfiles _PreInstfiles _ShowInstfiles _PostInstfiles<br />
<br />
##########################################################################<br />
<br />
Function MyCustomWelcome<br />
<br />
	nsDialogs::Create 1018<br />
	Pop $MyDialog<br />
<br />
	${If} $MyDialog == error<br />
	Abort<br />
	${EndIf}<br />
<br />
        ${NSD_CreateGroupBox} 0 0 398 208 &quot;My Custom Welcome Page&quot;<br />
        Pop $MyGroup<br />
	<br />
	SendMessage $HWNDPARENT ${WM_SETTEXT} 0 &quot;STR:My Welcome Caption&quot;<br />
	<br />
	nsDialogs::Show<br />
<br />
FunctionEnd<br />
<br />
##########################################################################<br />
<br />
Function _PreInstfiles<br />
<br />
Nop<br />
<br />
FunctionEnd<br />
<br />
##########################################################################<br />
<br />
Function _ShowInstfiles<br />
<br />
Nop<br />
<br />
FunctionEnd<br />
<br />
##########################################################################<br />
<br />
Function _PostInstfiles<br />
<br />
###########################<br />
<br />
push $0<br />
System::Call &quot;user32::GetSystemMenu(i $HWNDPARENT,i 0) i.s&quot;<br />
pop $0<br />
System::Call &quot;user32::EnableMenuItem(i $0,i 0xF060,i 0)&quot;<br />
pop $0<br />
<br />
###########################<br />
<br />
MessageBox MB_ICONQUESTION 'My Function _PostInstfiles Enable the menu close button (X) $\r$\rBut NSIS Disable it a another time : ('<br />
<br />
###########################<br />
<br />
FunctionEnd<br />
<br />
##########################################################################<br />
<br />
Section<br />
<br />
   DetailPrint &quot;A&quot;<br />
   DetailPrint &quot;B&quot;<br />
   DetailPrint &quot;XXXXXXXXXXXXXXXXXXXXXXXXX C&quot;<br />
<br />
   sleep 1000<br />
<br />
   DetailPrint &quot;XXXXXXXXXXXXXXXXXXXXXXXXX D&quot;<br />
   DetailPrint &quot;E&quot;<br />
   DetailPrint &quot;F&quot;<br />
<br />
   sleep 1000<br />
<br />
   DetailPrint &quot;XXXXXXXXXXXXXXXXXXXXXXXXX G&quot;<br />
   DetailPrint &quot;H&quot;<br />
   DetailPrint &quot;I&quot;<br />
<br />
   sleep 1000<br />
<br />
   DetailPrint &quot;XXXXXXXXXXXXXXXXXXXXXXXXX J&quot;<br />
   DetailPrint &quot;K&quot;<br />
   DetailPrint &quot;L&quot;<br />
<br />
   sleep 1000<br />
<br />
   DetailPrint &quot;XXXXXXXXXXXXXXXXXXXXXXXXX M&quot;<br />
   DetailPrint &quot;N&quot;<br />
   DetailPrint &quot;O&quot;<br />
<br />
SectionEnd<br />
<br />
####################################################################################################</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">4th April 2009, 18:58</div></div><div class="posttext">hm.. even if you do re-enable it outside of instfiles (say, on a following page), it doesn't do anything; it will just give a default beep sound.<br />
<br />
http://forums.winamp.com/showthread.php?threadid=270403&amp;highlight=close+AND+button<br />
<br />
Enabling the 'cancel' button before/after doesn't have any effect either - the [X] button is pretty much dead.<br />
<br />
Must be a simpler solution for this, but if push comes to shove, you may be able to write your own custom page to replace InstFiles; you won't get all the automatic DetailPrints, though.  On the other hand, you get to write -only- those details that you want to print, so there's up sides to that approach as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">4th April 2009, 19:06</div></div><div class="posttext">hmm.. okay, the scenario where you have another page after does work, as long as you use the /ENABLECANCEL flag<br />
<br />
Page custom MyCustomWelcome<br />
Page instfiles _PreInstfiles _ShowInstfiles _PostInstfiles<br />
Page custom MyCustomWelcome /ENABLECANCEL<br />
<br />
No luck on having it enabled at the end of InstFiles itself, though.  Do you need to keep that in view, or could you use autoclose?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LingoSag</div><div class="date">4th April 2009, 19:24</div></div><div class="posttext">May be with a litle timer ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">7th April 2009, 01:37</div></div><div class="posttext">doesn't look like it - an nsDialogs timer won't be created, it seems.. and I'm not too sure how you would invoke a system timer to call an NSIS function - I suppose using the System plugin and callbacks somehow.  There -is- also a plugin that delays an action.. I think it's called 'delay', but I can't seem to find it with google right now.. was an unfinished plugin, iirc.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LingoSag</div><div class="date">7th April 2009, 04:08</div></div><div class="posttext">Tank you for you interest<br />
<br />
SendMessage...../TIMEOUT=XXXX<br />
<br />
/TIMEOUT=XXXX is a mysterious argument we can use with SendMessage<br />
<br />
I don't know what is it.<br />
<br />
I don't know how use it.<br />
<br />
But i know that exist...<br />
<br />
It just a brainstorming possible solution...not more.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">7th April 2009, 04:57</div></div><div class="posttext">timeout just means that NSIS will wait that long for the SendMessage command to return a result; if it doesn't get a result within that time, it will consider the command to have failed and will continue with the script.  'fraid that's not what you'd be looking for</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>