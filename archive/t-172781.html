<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Newbie - Error Using NIS Edit 2.0, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Newbie - Error Using NIS Edit 2.0 NSIS Discussion" />
	
	<title> Newbie - Error Using NIS Edit 2.0 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Newbie - Error Using NIS Edit 2.0</div>
<hr />
<div class="pda"><a href="t-172781.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=172781">Newbie - Error Using NIS Edit 2.0</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">hatflyer</div><div class="date">10th March 2004, 02:57</div></div><div class="posttext">I barely know what I'm doing, but I tried to use the wizard to create a script file.  I clicked all the defaults, yet when compiled, I got the following errors:<br />
<br />
Invalid command: InstallOptions::initDialog<br />
Error in macro MUI_INSTALLOPTIONS_INITDIALOG on macroline 5<br />
Error in macro MUI_FUNCTION_WELCOMEPAGE on macroline 45<br />
Error in macro MUI_PAGE_WELCOME on macroline 23<br />
Error in script &quot;C:\Documents and Settings\Owner\Desktop\Untitled 03.nsi&quot; on line 21 -- aborting creation process<br />
<br />
Anyone know why this failed?<br />
<br />
Thanks,<br />
<br />
Matt</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">10th March 2004, 03:09</div></div><div class="posttext">If you want to know why, please attach the script to fix it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hatflyer</div><div class="date">10th March 2004, 03:58</div></div><div class="posttext">Here it is.  BTW, I have Winodws XP if it matters.<br />
<br />
; HM NIS Edit Wizard helper defines<br />
!define PRODUCT_NAME &quot;My application&quot;<br />
!define PRODUCT_VERSION &quot;1.0&quot;<br />
!define PRODUCT_PUBLISHER &quot;My company, Inc.&quot;<br />
!define PRODUCT_WEB_SITE &quot;http://www.mycompany.com&quot;<br />
!define PRODUCT_DIR_REGKEY &quot;Software\Microsoft\Windows\CurrentVersion\App Paths\AppMainExe.exe&quot;<br />
!define PRODUCT_UNINST_KEY &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}&quot;<br />
!define PRODUCT_UNINST_ROOT_KEY &quot;HKLM&quot;<br />
<br />
; MUI 1.67 compatible ------<br />
!include &quot;MUI.nsh&quot;<br />
<br />
; MUI Settings<br />
!define MUI_ABORTWARNING<br />
!define MUI_ICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico&quot;<br />
!define MUI_UNICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico&quot;<br />
<br />
; Welcome page<br />
!insertmacro MUI_PAGE_WELCOME<br />
; License page<br />
!insertmacro MUI_PAGE_LICENSE &quot;c:\path\to\licence\YourSoftwareLicence.txt&quot;<br />
; Directory page<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
; Instfiles page<br />
!insertmacro MUI_PAGE_INSTFILES<br />
; Finish page<br />
!define MUI_FINISHPAGE_RUN &quot;$INSTDIR\AppMainExe.exe&quot;<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
; Uninstaller pages<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
; Language files<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
; MUI end ------<br />
<br />
Name &quot;${PRODUCT_NAME} ${PRODUCT_VERSION}&quot;<br />
OutFile &quot;Setup.exe&quot;<br />
InstallDir &quot;$PROGRAMFILES\My application&quot;<br />
InstallDirRegKey HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot;<br />
ShowInstDetails show<br />
ShowUnInstDetails show<br />
<br />
Section &quot;MainSection&quot; SEC01<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  SetOverwrite ifnewer<br />
  File &quot;c:\path\to\file\AppMainExe.exe&quot;<br />
  CreateDirectory &quot;$SMPROGRAMS\My application&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\My application\My application.lnk&quot; &quot;$INSTDIR\AppMainExe.exe&quot;<br />
  CreateShortCut &quot;$DESKTOP\My application.lnk&quot; &quot;$INSTDIR\AppMainExe.exe&quot;<br />
  File &quot;c:\path\to\file\Example.file&quot;<br />
SectionEnd<br />
<br />
Section -AdditionalIcons<br />
  WriteIniStr &quot;$INSTDIR\${PRODUCT_NAME}.url&quot; &quot;InternetShortcut&quot; &quot;URL&quot; &quot;${PRODUCT_WEB_SITE}&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\My application\Website.lnk&quot; &quot;$INSTDIR\${PRODUCT_NAME}.url&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\My application\Uninstall.lnk&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
SectionEnd<br />
<br />
Section -Post<br />
  WriteUninstaller &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot; &quot;$INSTDIR\AppMainExe.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayName&quot; &quot;$(^Name)&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayIcon&quot; &quot;$INSTDIR\AppMainExe.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayVersion&quot; &quot;${PRODUCT_VERSION}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;URLInfoAbout&quot; &quot;${PRODUCT_WEB_SITE}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;Publisher&quot; &quot;${PRODUCT_PUBLISHER}&quot;<br />
SectionEnd<br />
<br />
<br />
Function un.onUninstSuccess<br />
  HideWindow<br />
  MessageBox MB_ICONINFORMATION|MB_OK &quot;$(^Name) was successfully removed from your computer.&quot;<br />
FunctionEnd<br />
<br />
Function un.onInit<br />
  MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 &quot;Are you sure you want to completely remove $(^Name) and all of its components?&quot; IDYES +2<br />
  Abort<br />
FunctionEnd<br />
<br />
Section Uninstall<br />
  Delete &quot;$INSTDIR\${PRODUCT_NAME}.url&quot;<br />
  Delete &quot;$INSTDIR\uninst.exe&quot;<br />
  Delete &quot;$INSTDIR\Example.file&quot;<br />
  Delete &quot;$INSTDIR\AppMainExe.exe&quot;<br />
<br />
  Delete &quot;$SMPROGRAMS\My application\Uninstall.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\My application\Website.lnk&quot;<br />
  Delete &quot;$DESKTOP\My application.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\My application\My application.lnk&quot;<br />
<br />
  RMDir &quot;$SMPROGRAMS\My application&quot;<br />
  RMDir &quot;$INSTDIR&quot;<br />
<br />
  DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot;<br />
  DeleteRegKey HKLM &quot;${PRODUCT_DIR_REGKEY}&quot;<br />
  SetAutoClose true<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shantanu_gadgil</div><div class="date">10th March 2004, 05:22</div></div><div class="posttext">The first user says... &quot;..I barely know what I am doing...&quot;<br />
<br />
This was exactly my point (in a previous post about how NSIS Modern is really difficult to learn)<br />
<br />
When I first used NSIS (~version 1.0 something), I thought...&quot;hey cool, an installation software which looks like a programming language&quot;. I didn't know the &quot;techinical&quot; word called &quot;script language&quot;.<br />
<br />
Anyway, from the classic version 1.98, there is such a huge difference , the user has to kinda re-learn the system... especially the MACROS thing :)<br />
<br />
We really :D really :D need to simplify the scripting method to make newbies feel comfortable !!!<br />
<br />
That is the idea right...convert everyone to the NSIS faith :D ;)<br />
<br />
If not simply the scripting, how about a UI designing software which will run in CONJUNCTION with the NSIS version, like (Innosetup+ISTool)<br />
<br />
I know SB 3.0 is under way !...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">10th March 2004, 05:57</div></div><div class="posttext">It looks like there might be something wrong with your NSIS installation.  I would try downloading it again and reinstalling.<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hatflyer</div><div class="date">10th March 2004, 21:26</div></div><div class="posttext">I think I solved it.  The referenced file was not in the right place.<br />
<br />
My other question is - I can generate the file that does indeed load the application on my computer.  But this program will be on a CD that others will use to install the software.  How do I deal with which drive (e.g. D, or E, or...) that the user will have the CD in so the installation can work?  Is that somehow automatically embeded?<br />
<br />
Thanks,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">10th March 2004, 23:04</div></div><div class="posttext">You can detect the drives using &quot;Detect Drives&quot; function, see it in my signature. You can use StrCpy $EXEDIR $EXEDIR 2 to compare with the function results.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hatflyer</div><div class="date">11th March 2004, 03:15</div></div><div class="posttext">I downloaded your sample script got an error: <br />
<br />
invalid script: never had OutFile command got an error: <br />
<br />
As I'm new to this, much of your sample went over my head.<br />
<br />
As I said, my installation program works from my desktop (thanks to the wizard help).  Is it really that much more work to have it work from a CD drive?  Could it be made easier to prompt for the drive name from the user?  I guess I'm having trouble seeing how your sample can be incorporated into my script.  This is what I have:<br />
<br />
; HM NIS Edit Wizard helper defines<br />
!define PRODUCT_NAME &quot;2 Brain Poker&quot;<br />
!define PRODUCT_VERSION &quot;2.0&quot;<br />
!define PRODUCT_PUBLISHER &quot;Schmitz, Inc.&quot;<br />
!define PRODUCT_WEB_SITE &quot;http://www.2brainpoker.com&quot;<br />
!define PRODUCT_DIR_REGKEY &quot;Software\Microsoft\Windows\CurrentVersion\App Paths\cards1.exe&quot;<br />
!define PRODUCT_UNINST_KEY &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}&quot;<br />
!define PRODUCT_UNINST_ROOT_KEY &quot;HKLM&quot;<br />
<br />
; MUI 1.67 compatible ------<br />
!include &quot;MUI.nsh&quot;<br />
<br />
; MUI Settings<br />
!define MUI_ABORTWARNING<br />
!define MUI_ICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico&quot;<br />
!define MUI_UNICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico&quot;<br />
<br />
; Welcome page<br />
!insertmacro MUI_PAGE_WELCOME<br />
; License page<br />
!insertmacro MUI_PAGE_LICENSE &quot;license.txt&quot;<br />
; Directory page<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
; Instfiles page<br />
!insertmacro MUI_PAGE_INSTFILES<br />
; Finish page<br />
!define MUI_FINISHPAGE_RUN &quot;$PROGRAMFILES\cards1.exe&quot;<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
; Uninstaller pages<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
; Language files<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
; MUI end ------<br />
<br />
Name &quot;${PRODUCT_NAME} ${PRODUCT_VERSION}&quot;<br />
OutFile &quot;Setup.exe&quot;<br />
InstallDir &quot;$PROGRAMFILES\2 Brain Poker&quot;<br />
InstallDirRegKey HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot;<br />
ShowInstDetails show<br />
ShowUnInstDetails show<br />
<br />
Section &quot;MainSection&quot; SEC01<br />
  SetOutPath &quot;$PROGRAMFILES&quot;<br />
  SetOverwrite ifnewer<br />
  File &quot;cards1.exe&quot;<br />
  CreateDirectory &quot;$SMPROGRAMS\2 Brain Poker&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\2 Brain Poker\2 Brain Poker.lnk&quot; &quot;$PROGRAMFILES\cards1.exe&quot;<br />
  CreateShortCut &quot;$DESKTOP\2 Brain Poker.lnk&quot; &quot;$PROGRAMFILES\cards1.exe&quot;<br />
  File &quot;hodds.txt&quot;<br />
  File &quot;d.txt&quot;<br />
  File &quot;hole.txt&quot;<br />
SectionEnd<br />
<br />
Section -AdditionalIcons<br />
  WriteIniStr &quot;$INSTDIR\${PRODUCT_NAME}.url&quot; &quot;InternetShortcut&quot; &quot;URL&quot; &quot;${PRODUCT_WEB_SITE}&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\2 Brain Poker\Website.lnk&quot; &quot;$INSTDIR\${PRODUCT_NAME}.url&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\2 Brain Poker\Uninstall.lnk&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
SectionEnd<br />
<br />
Section -Post<br />
  WriteUninstaller &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot; &quot;$PROGRAMFILES\cards1.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayName&quot; &quot;$(^Name)&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayIcon&quot; &quot;$PROGRAMFILES\cards1.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayVersion&quot; &quot;${PRODUCT_VERSION}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;URLInfoAbout&quot; &quot;${PRODUCT_WEB_SITE}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;Publisher&quot; &quot;${PRODUCT_PUBLISHER}&quot;<br />
SectionEnd<br />
<br />
<br />
Function un.onUninstSuccess<br />
  HideWindow<br />
  MessageBox MB_ICONINFORMATION|MB_OK &quot;$(^Name) was successfully removed from your computer.&quot;<br />
FunctionEnd<br />
<br />
Function un.onInit<br />
  MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 &quot;Are you sure you want to completely remove $(^Name) and all of its components?&quot; IDYES +2<br />
  Abort<br />
FunctionEnd<br />
<br />
Section Uninstall<br />
  Delete &quot;$INSTDIR\${PRODUCT_NAME}.url&quot;<br />
  Delete &quot;$INSTDIR\uninst.exe&quot;<br />
  Delete &quot;$PROGRAMFILES\hole.txt&quot;<br />
  Delete &quot;$PROGRAMFILES\d.txt&quot;<br />
  Delete &quot;$PROGRAMFILES\hodds.txt&quot;<br />
  Delete &quot;$PROGRAMFILES\cards1.exe&quot;<br />
<br />
  Delete &quot;$SMPROGRAMS\2 Brain Poker\Uninstall.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\2 Brain Poker\Website.lnk&quot;<br />
  Delete &quot;$DESKTOP\2 Brain Poker.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\2 Brain Poker\2 Brain Poker.lnk&quot;<br />
<br />
  RMDir &quot;$SMPROGRAMS\2 Brain Poker&quot;<br />
<br />
  DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot;<br />
  DeleteRegKey HKLM &quot;${PRODUCT_DIR_REGKEY}&quot;<br />
  SetAutoClose true<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hatflyer</div><div class="date">11th March 2004, 18:08</div></div><div class="posttext">Actually, it looks like the installation works from a CD drive automatically, without caring which CD drive it is.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pepeknamornik</div><div class="date">8th April 2011, 19:36</div></div><div class="posttext">Just 1hour ago i was lost... ...errors.. errors and errors from all script where i did copy+paste. ...investigation was needed. Main issue in my opinion are missing detail in tutorial. Macros are described but not explained. ...and it not so difficult. If you need to use macros please make sure you create nsh and save into Include folder. Your script have include File where macro is defined...thats all :)<br />
..of course, please make sure output file is defined.<br />
<br />
https://lh6.googleusercontent.com/_am7bVbatnh8/TZ9Ucq3kyBI/AAAAAAAAATc/D621ayOueV0/s1024/using-macro-nsis.jpg<br />
<br />
The first user says... &quot;..I barely know what I am doing...&quot;<br />
<br />
This was exactly my point (in a previous post about how NSIS Modern is really difficult to learn)<br />
<br />
When I first used NSIS (~version 1.0 something), I thought...&quot;hey cool, an installation software which looks like a programming language&quot;. I didn't know the &quot;techinical&quot; word called &quot;script language&quot;.<br />
<br />
Anyway, from the classic version 1.98, there is such a huge difference , the user has to kinda re-learn the system... especially the MACROS thing :)<br />
<br />
We really :D really :D need to simplify the scripting method to make newbies feel comfortable !!!<br />
<br />
That is the idea right...convert everyone to the NSIS faith :D ;)<br />
<br />
If not simply the scripting, how about a UI designing software which will run in CONJUNCTION with the NSIS version, like (Innosetup+ISTool)<br />
<br />
I know SB 3.0 is under way !...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">8th April 2011, 20:17</div></div><div class="posttext">pepeknamornik: Please don't reply to threads that were closed seven (!!) years ago.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>