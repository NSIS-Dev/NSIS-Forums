<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstall Delete $SMPrograms failing, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstall Delete $SMPrograms failing NSIS Discussion" />
	
	<title> Uninstall Delete $SMPrograms failing [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstall Delete $SMPrograms failing</div>
<hr />
<div class="pda"><a href="t-330325.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330325">Uninstall Delete $SMPrograms failing</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">WoodyOne4U</div><div class="date">4th May 2011, 21:31</div></div><div class="posttext">Ok... I've seen many threads on here that almost touch on this subject, or almost give an answer, but I'm still at a loss.  I am creating Start Menus just fine as follows:<br />
<br />
  CreateDirectory &quot;$SMPROGRAMS\Folder&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\Folder\File.lnk&quot; &quot;$INSTDIR\File.exe&quot;<br />
<br />
However, when I run the Uninstaller, it does everything just fine EXCEPT deleting these shortcuts and the Directory.  Here is my script:<br />
<br />
  Delete &quot;$SMPROGRAMS\Folder\*.*&quot;<br />
  RMDir /r &quot;$SMPROGRAMS\Folder&quot;<br />
<br />
I've also tried:<br />
<br />
  Delete &quot;$SMPROGRAMS\ESP Vision\File.lnk&quot;<br />
  RMDir /r &quot;$SMPROGRAMS\ESP Vision&quot;<br />
<br />
I don't think it is a privilege thing, since I am the only user on this computer, and I have administrative priviliges.  Oh, this is Win 7 32-bit, in case that matters.<br />
<br />
I've used almost identical scripting on another file that worked fine... albeit was on Win XP.  Any ideas to help?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">4th May 2011, 21:48</div></div><div class="posttext">Searched Google for &quot;shortcut delete nsis&quot; :):<br />
http://nsis.sourceforge.net/Shortcuts_removal_fails_on_Windows_Vista<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WoodyOne4U</div><div class="date">4th May 2011, 22:04</div></div><div class="posttext">Thanks... I didn't think about it being a Vista + Win 7 thing... When I googled, I only looked for Win 7.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EricTBoneJackson</div><div class="date">6th May 2011, 00:45</div></div><div class="posttext">I ran into this yesterday myself. I tried both the solutions on that wiki page (http://nsis.sourceforge.net/Shortcuts_removal_fails_on_Windows_Vista).<br />
<br />
The first one (RequestExecutionLevel user) worked great on my machine (Windows 7 Professional 64-bit). It failed miserably on my coworker's machine (also Win7 Pro 64). It installed only the shortcuts. No files, no registry keys, nothing but the shortcuts.<br />
<br />
What's worse is that it fails silently. That seems totally unforgivable for an installer package. Is there some flag I can set to prevent that? I'd rather the installer abort with flashing lights and sirens than look as if it installed our application when it didn't.<br />
<br />
The second option (RequestExecutionLevel admin) works on both our machines, but I don't know what's supposed to go in &quot;TODO&quot; section. I check that the user has admin rights. What if he doesn't? Do I just abort?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">6th May 2011, 05:53</div></div><div class="posttext">I check that the user has admin rights. What if he doesn't? Do I just abort?<br />
Yes, you can throw a MessageBox and then call Quit.<br />
<br />
As for it not working on your coworker's PC, you probably didn't have access rights to create the files and regkeys. At userlevel, you cannot write to $PROGRAMFILES or HKLM. You need to write to $LOCALAPPDATA and HKCU.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>