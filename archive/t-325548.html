<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Multiple language support in .onInit?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Multiple language support in .onInit? NSIS Discussion" />
	
	<title> Multiple language support in .onInit? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Multiple language support in .onInit?</div>
<hr />
<div class="pda"><a href="t-325548.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=325548">Multiple language support in .onInit?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">nahant</div><div class="date">5th January 2011, 07:38</div></div><div class="posttext">Hi,<br />
<br />
I'm working on an NSIS installer with multiple language support.<br />
The multiple language support of NSIS works nicely in normal case.<br />
<br />
However, when I try to add silent mode to the installer, multiple<br />
language support no longer works as most logic (like command line<br />
processing etc.) is now in .onInit().  That's expected as NSIS<br />
manual mentioned that language was initialized after .onInit().  But<br />
I really want to add multiple language support even for silent mode.<br />
Is there any workaround?  Is it possible to force language<br />
initialization before the end of .onInit()?<br />
<br />
Another possible solution is moving most initialization logic into<br />
later stage, after .onInit().  However, that will make the script<br />
hard to understand.  Has anyone here did the same thing before?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">11th October 2012, 06:55</div></div><div class="posttext">This is not a bug - this sis a NSIS feature.<br />
As it was mentioned several times (showthread.php?t=326317): languages are set AFTER .onInit function.<br />
<br />
But there is simple workaround for this: $LANGUAGE variable is filled with selected language ID already in .onInit so it can be used to determine the language together with ${Switch}:<br />
<br />
	; Show language selection dialog<br />
	!insertmacro MUI_LANGDLL_DISPLAY<br />
<br />
	${Switch} $LANGUAGE<br />
		${Case} 1033<br />
			; English<br />
			StrCpy $R0 &quot;${LoadingSession_LANG_ENGLISH}&quot;<br />
			StrCpy $R1 &quot;${PleaseWait_LANG_ENGLISH}&quot;<br />
		${Break}<br />
		${Case} 1051<br />
			; Slovak<br />
			StrCpy $R0 &quot;${LoadingSession_LANG_SLOVAK}&quot;<br />
			StrCpy $R1 &quot;${PleaseWait_LANG_SLOVAK}&quot;<br />
		${Break}<br />
<br />
		${Default}<br />
			; English - default language if no match is found<br />
			StrCpy $R0 &quot;${LoadingSession_LANG_ENGLISH}&quot;<br />
			StrCpy $R1 &quot;${PleaseWait_LANG_ENGLISH}&quot;<br />
	${EndSwitch}<br />
	<br />
	; $R0 and $R1 are filled with strings...<br />
	Banner::show /set 76 &quot;$R0&quot; &quot;$R1&quot;<br />
<br />
<br />
As you can see there are no LangString(s) but simple defined symbols:<br />
<br />
!define LoadingSession_LANG_ENGLISH			&quot;Loading data...&quot;<br />
!define PleaseWait_LANG_ENGLISH				&quot;Please wait...&quot;<br />
!define LoadingSession_LANG_SLOVAK			&quot;Načítavam informácie...&quot;<br />
!define PleaseWait_LANG_SLOVAK				&quot;Prosím čakajte...&quot;</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>