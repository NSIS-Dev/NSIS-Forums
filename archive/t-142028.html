<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" nsExec problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  nsExec problem NSIS Discussion" />
	
	<title> nsExec problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  nsExec problem</div>
<hr />
<div class="pda"><a href="t-142028.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=142028">nsExec problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">13th July 2003, 06:10</div></div><div class="posttext">I am trying to use nsExec but It doesn't work.      nsExec::ExecToLog /TIMEOUT=9999 &quot;$INSTDIR\grep.exe&quot; <br />
I tried with an without the timeout.<br />
<br />
I think that the problem is with grep.exe (http://www.delorie.com/djgpp/dl/ofc/simtel/v2gnu/grep24b.zip/bin/grep.exe) because when I run it from a batch it doesn't close the window and remains open (usually a batch closes the window).<br />
<br />
The log should reflect this:<br />
Usage: grep [OPTION]... PATTERN [FILE]...<br />
Try `grep --help' for more information.<br />
 but it doesn't <br />
<br />
I found this (http://forums.winamp.com/showthread.php?threadid=126972&amp;highlight=nsexec) thread with similar problems. I don't know if it's the same, since this grep.exe just makes a list, and they talk about getting live output or nsExec not getting the output until the program has finished. In my case, nsExec never grabs the output.<br />
<br />
I forgot to say that the return value is 1 (no errors, timeout, or whatever).<br />
<br />
note: why can't I write backslashes?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DOCa Cola</div><div class="date">13th July 2003, 07:27</div></div><div class="posttext">First of all the link says that the server is too busy, here is an alternate link. i will test grep.exe now...<br />
http://sunsite.utk.edu/ftp/usr-218-2/djgpp/v2gnu/grep24b.zip</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DOCa Cola</div><div class="date">13th July 2003, 07:35</div></div><div class="posttext">hm, right, isn't working for me either, thats strange....i don't think it has something to do with live output...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th July 2003, 15:41</div></div><div class="posttext">Will check out.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">13th July 2003, 20:57</div></div><div class="posttext">thanks kichik :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DOCa Cola</div><div class="date">13th July 2003, 21:08</div></div><div class="posttext">At this point, here another thing i noticed is that nsexec makes these boxes in front of the output of lame (mp3 encoder). in the dos box they aren't there...<br />
http://www.borgcore.de/outerspace/NSIS/lame.png</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th July 2003, 14:54</div></div><div class="posttext">Those are tabs  DOCa Cola. I'll see what I can do about it too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DOCa Cola</div><div class="date">14th July 2003, 14:57</div></div><div class="posttext">ah i see, thx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">16th July 2003, 20:32</div></div><div class="posttext">I found another grep.exe that works with NSIS. But now I have another problem :( As kichik said in another thread, stack items are only 1024Bytes, so when the program lauched through nsExec ExecToStack prints more than 1024 it gets lost :(<br />
<br />
I tried my best to redirect with &quot;&gt; t.txt&quot; but I am quite unlucky in this thread and couldn't make it work, either.<br />
<br />
I tried many variations of this:<br />
ExecWait `&quot;$INSTDIR\grep.exe&quot; -h -i &quot;$4&quot; &quot;$INSTDIR\$1&quot; &gt; &quot;$INSTDIR\t.txt&quot;`<br />
and none works :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th July 2003, 20:51</div></div><div class="posttext">To use redirection you have to use command.com/cmd.exe. Search the forum using the term &quot;COMSPEC&quot; for usage examples.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th July 2003, 20:55</div></div><div class="posttext">You can't log output using ExecWait let alone without using MS-DOS.<br />
<br />
Use the WriteToFile function and create a batch file with the above (you're) command-line.<br />
Then execute the batch using nsExec::Exec<br />
<br />
The logging feature is an MS-DOS feature.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th July 2003, 21:02</div></div><div class="posttext">Or do this (like Kichik said)<br />
<br />
ReadEnvStr $0 COMSPEC<br />
nsExec::Exec '$0 /c &quot;$INSTDIR\grep.exe&quot; -h -i &quot;$4&quot; &quot;$INSTDIR\$1&quot; &gt; &quot;$INSTDIR\t.txt&quot;'<br />
<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">17th July 2003, 08:28</div></div><div class="posttext">Great! many ideas to try now.<br />
Thanks :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DOCa Cola</div><div class="date">18th July 2003, 06:39</div></div><div class="posttext">Originally posted by kichik <br />
Those are tabs  DOCa Cola. I'll see what I can do about it too.  <br />
Hm, is there a way to replace the tab boxes with nothing or 'real' tabs with exectostring or something. i need this fix soon cause i am going to release an installer with that.<br />
<br />
DOCa Cola</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">19th July 2003, 14:09</div></div><div class="posttext">You can always find out what character is and use strcpy to strip it. It's bit of work, but works ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th July 2003, 14:11</div></div><div class="posttext">Sorry, missed your message the first time. If it's really urgent drop by the IRC channel and I'll compile a version of nsExec for you that will temporarily solve this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DOCa Cola</div><div class="date">22nd July 2003, 06:40</div></div><div class="posttext">Thx for taking on the Tab issue, but there is a small bug remaining<br />
http://www.borgcore.de/outerspace/NSIS/mmpack.png <br />
The first character of the executed program seems to be untouched by that (after &quot;decoding shellstr.mp3...&quot; the nsexec command with lame starts)<br />
<br />
DOCa Cola</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ramon18</div><div class="date">22nd July 2003, 09:45</div></div><div class="posttext">DOCa Cola, I will check this, but can you examine what char is it? TAB char left or another one? Can you please post the link to the tool you are using and an example of the parameters used so I can check it more quickly? thanks<br />
<br />
cya later,<br />
Ramon</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DOCa Cola</div><div class="date">22nd July 2003, 09:52</div></div><div class="posttext">hm, when i tried to paste this here it was translated as a new line<br />
---<br />
Decoding shellstr.mp3...<br />
<br />
input:<br />
---<br />
parameters in the previous screen<br />
http://www.borgcore.de/outerspace/NSIS/lame.png<br />
Note: as you can see, all boxes have been fixed but not the one at the beginning<br />
<br />
http://lame.sourceforge.net<br />
Download: http://mitiok.cjb.net/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">22nd July 2003, 10:19</div></div><div class="posttext">It's probably a carriage return to move the cursor to the start of the line, \r.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DOCa Cola</div><div class="date">8th August 2003, 13:28</div></div><div class="posttext">so..and how can i get rid of this?<br />
<br />
DOCa Cola</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DOCa Cola</div><div class="date">8th August 2003, 13:38</div></div><div class="posttext">Ok, here a ready to test simple installer using lame (all required files included)<br />
http://www.borgcore.de/outerspace/nsis/lameinst.zip<br />
hope it is easier now to determine the bug<br />
<br />
DOCa Cola</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th August 2003, 14:52</div></div><div class="posttext">In latest CVS version I have fixed:<br />
<br />
- Empty lines were not printed<br />
- CR or LF alone were not handled<br />
- Tab conversion removed the next char<br />
<br />
Thanks for the example, it was handy.<br />
<br />
nsExec.dll from latest CVS attached so you won't have to wait for the CVS delays.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DOCa Cola</div><div class="date">8th August 2003, 14:54</div></div><div class="posttext">thx!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DOCa Cola</div><div class="date">11th August 2003, 11:44</div></div><div class="posttext">- Empty lines were not printed<br />
<br />
oh, is there a way to surpress this feature optionally? i have another program i execute with nsexec::exectolog now just prints out to many empty lines into my log<br />
<br />
DOCa Cola</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th August 2003, 16:08</div></div><div class="posttext">There is no option to turn it off. Why would you want to do it? Does it print more empty lines than seen when executing the program without nsExec?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DOCa Cola</div><div class="date">11th August 2003, 16:13</div></div><div class="posttext">no the line size is correct in nsis, but the lines just exist to fill out the standard dos screen size, so there are a few empty lines not needed in nsis, it worked well without the printed empty lines. is it to complicated to make that optional? than i maybe could find another solution for that, but i thought such a feature might be helpful not to overload the nsis log with unnecessary empty lines.<br />
<br />
DOCa Cola</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th August 2003, 16:20</div></div><div class="posttext">It's not that complicated, but I am trying to finish something else right now. You can use Afrow's/Brainsucker's scripts for removing lines in log for now. You can also use some of the methods described here:<br />
<br />
http://www.experts-exchange.com/Programming/Programming_Platforms/Unix_Programming/Q_20640729.html<br />
<br />
Although mainly for *nix, there are ports of the applications discussed there to Windows.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DOCa Cola</div><div class="date">11th August 2003, 16:30</div></div><div class="posttext">yea, but i don't want to remove empty lines from a generated log file but from the output with showinstdetails. i can't see a solution how to solve this with such a program...ok, but anyway, i don't want to bother you, i will wait until you have time to add an option for that<br />
<br />
DOCa Cola</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th August 2003, 16:32</div></div><div class="posttext">The solution is in there. Get grep and use this:<br />
<br />
myprog.exe bla bla | grep.exe -v &quot;^$&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DOCa Cola</div><div class="date">11th August 2003, 16:36</div></div><div class="posttext">owww, i am too blind, sorry, the commands just overtook me and i thought he wants to remove empty lines from a file, thx for the help! great support here! thx! :)<br />
<br />
DOCa Cola</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DOCa Cola</div><div class="date">11th August 2003, 17:08</div></div><div class="posttext">ok..i have come to one problem that my program now sees grep as a command parameter and stopped working....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th August 2003, 17:13</div></div><div class="posttext">Right, forgot to mention you need the command line processor for this. You must use %COMSPEC% to make this work. Search for COMSPEC in the forum, there are lots of examples.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DOCa Cola</div><div class="date">11th August 2003, 17:27</div></div><div class="posttext">owww, i see, but this is getting way to complicated, the thing is that i not only have one line of nsexec::exectolog and i don't want to change 20 commands around 2 times, so until then i will use the older nsexec where the bug was existend :D <br />
thx!<br />
<br />
DOCa Cola</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th August 2003, 17:32</div></div><div class="posttext">It's just another line, it's not that complicated. You can also make a macro out of it to make it even simpler.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>