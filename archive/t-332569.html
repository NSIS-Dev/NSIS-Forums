<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with path when building on Windows 7, 64 bit, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with path when building on Windows 7, 64 bit NSIS Discussion" />
	
	<title> Problem with path when building on Windows 7, 64 bit [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with path when building on Windows 7, 64 bit</div>
<hr />
<div class="pda"><a href="t-332569.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=332569">Problem with path when building on Windows 7, 64 bit</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">indy31</div><div class="date">18th July 2011, 10:37</div></div><div class="posttext">In building my installer I have to include some files from a 32-bit library located in Program Files. Because my system is a Windows 7 64-bit it searches for the files in &quot;C:\Program Files&quot; instead of &quot;C:\Program Files (X86)&quot;.<br />
<br />
Currently we use the following code:!define common_files &quot;C:\Program Files\Common Files&quot;<br />
<br />
!insertmacro InstallLib REGDLL SHARED REBOOT_PROTECTED &quot;${common_files}\Microsoft Shared\DAO\dao360.dll&quot; &quot;$COMMONFILES\Microsoft Shared\DAO\dao360.dll&quot; &quot;$COMMONFILES\Microsoft Shared\DAO&quot;The code should be changed so it works for my 64-bit OS, as well for my colleagues on 32-bit XP.<br />
Is there a way to change the hard coded define 'common_files' to something dynamic?<br />
<br />
I tried to use $COMMONFILES but this is not defined during compilation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">18th July 2011, 12:13</div></div><div class="posttext">Try $%COMMONPROGRAMFILES(x86)%<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">indy31</div><div class="date">21st July 2011, 20:37</div></div><div class="posttext">Thanks, but COMMONPROGRAMFILES(x86) is an environment variable that I don't think is available on XP. So how to create an easy but universal script for compilation? During Installation there are the convenient NSIS Constants, but I didn't manage to get those working during compilation.  Any tips?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smurge</div><div class="date">21st July 2011, 21:18</div></div><div class="posttext">did you use &gt; $%COMMONPROGRAMFILES(x86)% &lt; as AfrowUK mentioned? <br />
<br />
this will get the compillertime path for the C:\Program Files (x86)\Common Files on 64bit OS and C:\Program Files\Common Files on 32bit OS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">indy31</div><div class="date">26th July 2011, 16:34</div></div><div class="posttext">Sorry for the delay, but I had to find a machine with XP installed. I resorted to running XP in a virtual machine.<br />
<br />
I was correct in assuming that &gt; $%COMMONPROGRAMFILES(x86)% &lt;  doesn't work on 32-bit XP, it is an undefined variable on that platform.<br />
What does work is the Environment variable &gt; $%COMMONPROGRAMFILES% &lt;. This will give me the desired effect for the compillertime path to C:\Program Files (x86)\Common Files on 64bit OS and C:\Program Files\Common Files on 32bit OS <br />
<br />
I still don't like it that Compile-time I have to resort to other methods for determining the Environment than during Run-time. An orthogonal command set would make it easier to learn programming NSIS and has the potential of reducing the NSIS code base.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>