<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Change nsis error of UAC plugin on XP when user check &quot;Protect my computer[...]&quot;, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Change nsis error of UAC plugin on XP when user check &quot;Protect my computer[...]&quot; NSIS Discussion" />
	
	<title> Change nsis error of UAC plugin on XP when user check &quot;Protect my computer[...]&quot; [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Change nsis error of UAC plugin on XP when user check &quot;Protect my computer[...]&quot;</div>
<hr />
<div class="pda"><a href="t-300641.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=300641">Change nsis error of UAC plugin on XP when user check &quot;Protect my computer[...]&quot;</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">BuilderBob</div><div class="date">4th December 2008, 14:32</div></div><div class="posttext">Hello,<br />
<br />
When using the UAC plugin on XP with non-admin user, user is prompted to choose between run as current user and run as admin. If user chooses to run as current user there's a checkbox &quot;Protect my computer and data from unauthorized program activity&quot;. With this checked, I get the error: &quot;NSIS Error&quot;, &quot;Error launching installer&quot;.<br />
<br />
Instead of this message I want to show user a friendly message that explains they must run as admin. Is this possible? Where is that error message come from, nsis internals or the UAC plugin?<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">4th December 2008, 20:29</div></div><div class="posttext">This message comes from nsis because checking that checkbox really locks down the process so it can't even access the temp folder (The same thing would happen if you right click on a nsis install that does not even use the UAC plugin and choose Run as...) I'm already hacking that dialog a bit (selecting other user as default and unchecking that checkbox) but I'm not going to hide it, if you really want to hide that thing, add code in MSRunAsDlgMod_ShellProc and recompile the plugin...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BuilderBob</div><div class="date">7th December 2008, 09:07</div></div><div class="posttext">Hi Anders, thank you for your reply.<br />
<br />
I am trying to display a friendly message instead of the &quot;NSIS Error&quot; message. I don't want to hide the elevation dialog. If users get a choice to keep running as a regular user they should at least know what the error is and why the installer isn't doing anything.<br />
<br />
So is the &quot;NSIS Error&quot; message comes from the UAC plugin code or nsis itself? I would feel comfortable compiling the UAC plugin but not so much the core of nsis.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BuilderBob</div><div class="date">7th December 2008, 10:43</div></div><div class="posttext">The error happens when ForkSelf calls ShellExecuteEx, so it probably comes from the newly run installer, and is probably an internal nsis error. Is there a way to display a different error message, or hide this one?<br />
<br />
EDIT: I also set the installer as silent.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">7th December 2008, 18:12</div></div><div class="posttext">You can hide the checkbox, not the whole dialog. That error has to happen, there is no way around it, to use a plugin, you need write access to $temp, and if that checkbox is checked, you will not get write access, its that easy. So, tell your users not to check it, or just hide the checkbox</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>