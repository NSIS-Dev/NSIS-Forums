<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Newbie need help, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Newbie need help NSIS Discussion" />
	
	<title> Newbie need help [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Newbie need help</div>
<hr />
<div class="pda"><a href="t-222053.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=222053">Newbie need help</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">landgrimtham</div><div class="date">21st July 2005, 07:52</div></div><div class="posttext">hi all a newbie here. and i need some help in solving this problem. Can anyone help me? The program keep prompting me &quot;no files found&quot;<br />
<br />
thanks all<br />
<br />
<br />
InstallDir: &quot;$PROGRAMFILES\EngWin&quot;<br />
Section: &quot;EngWin&quot;<br />
Call &quot;InstallVBDLLs&quot;<br />
SetOutPath: &quot;$(WinSysPathSysFile)&quot;<br />
File: &quot;RICHED32.DLL&quot; -&gt; no files found.<br />
Usage: File [/nonfatal] [/a] ([/r] filespec [...]|/oname=outfile one_file_only)<br />
Error in script &quot;C:\Documents and Settings\ptham.ATA\Desktop\IMPT DATELINE END OF SEP\testing.nsi&quot; on line 281 -- aborting creation process</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">21st July 2005, 08:38</div></div><div class="posttext">make sure the RICHED32.DLL is in the same directory as your script or specify a path to that file (i.e. File &quot;$SYSDIR\RICHED32.DLL&quot;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st July 2005, 12:05</div></div><div class="posttext">What's with all the SetOutPath &quot;$INSTDIR/Miscellaneous&quot; and Push $INSTDIR/Miscellaneous\Busy.bmp<br />
It's \ not / in Windows.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">landgrimtham</div><div class="date">22nd July 2005, 06:24</div></div><div class="posttext">thanks bro Yathosho <br />
<br />
the code works but now i have another problem while compiling. The upgradedll is giving me a problem. Can anyone help? <br />
<br />
<br />
!define: &quot;UPGRADEDLL_UNIQUE&quot;=&quot;2.9&quot;<br />
SetOverwrite: try<br />
StrCpy $R4 &quot;$SYSDIR\Asycfilt.dll&quot; () ()<br />
StrCpy $R5 &quot;$SYSDIR&quot; () ()<br />
IfFileExists: &quot;$R4&quot; ? 0 : upgradedll.copy_2.9<br />
ClearErrors<br />
GetDLLVersionLocal: error reading version info from &quot;.\Asycfilt.dll&quot;<br />
Error in macro UpgradeDLL on macroline 26<br />
!include: error in script: &quot;C:\Program Files\NSIS\Include\installVB.nsh&quot; on line 2<br />
Error in script &quot;C:\Documents and Settings\ptham\Desktop\IMPT DATELINE END OF SEP\testing.nsi&quot; on line 42 -- aborting creation process<br />
<br />
Here is the edited version of the nsi script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">landgrimtham</div><div class="date">22nd July 2005, 06:26</div></div><div class="posttext">Bro afrow UK,<br />
<br />
i'm trying to import the VB setup to a NISI script by using a program that *search 4 vbconvert* i have found here but it seems that i have some bugz that i need to squash before i can use it... :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">22nd July 2005, 13:01</div></div><div class="posttext">GetDLLVersionLocal is failing there. Perhaps Asycfilt.dll in use or something?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">landgrimtham</div><div class="date">25th July 2005, 05:12</div></div><div class="posttext">Originally posted by Afrow UK <br />
GetDLLVersionLocal is failing there. Perhaps Asycfilt.dll in use or something?<br />
<br />
-Stu  <br />
<br />
how do i check whether the dll is in use which i dont think it is. :igor:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">25th July 2005, 05:58</div></div><div class="posttext">usually if a file is 'in use', you can't rename it.  You might also get the error if for some reason you don't have permissions to the file. (Are you using the correct path to the DLL?)<br />
<br />
I'd first try to make sure that you can access the version info from the file Asycfilt.dll from Windows Explorer.  If you can and you know the paths are correct, then try to rename the file.  If you can't rename, the file is probably in use.  (If it does let you rename, remember to rename it back to what it was!)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">landgrimtham</div><div class="date">25th July 2005, 10:55</div></div><div class="posttext">Originally posted by Comperio <br />
usually if a file is 'in use', you can't rename it.  You might also get the error if for some reason you don't have permissions to the file. (Are you using the correct path to the DLL?)<br />
<br />
I'd first try to make sure that you can access the version info from the file Asycfilt.dll from Windows Explorer.  If you can and you know the paths are correct, then try to rename the file.  If you can't rename, the file is probably in use.  (If it does let you rename, remember to rename it back to what it was!)  <br />
<br />
Hi comperio,<br />
<br />
i have tried the method that u advice and try to rename the file and the file is not &quot;in used&quot; i can rename it whenever i please. So i went to the root problem which is the installvb file. <br />
<br />
i tried to directly point to the source but it return me this error when i compile.<br />
<br />
Call &quot;:upgradedll.file_2.9&quot;<br />
Rename: /REBOOTOK $R0-&gt;$R4<br />
GetTempFileName -&gt; $R0<br />
File: &quot;C:\Program Files\NSIS\Contrib\Library\RegTool\RegTool.bin&quot; -&gt; no files found.<br />
Usage: File [/nonfatal] [/a] ([/r] [/x filespec [...]] filespec [...] |<br />
   /oname=outfile one_file_only)<br />
Error in macro UpgradeDLL on macroline 62<br />
!include: error in script: &quot;C:\Program Files\NSIS\Include\installVB.nsh&quot; on line 2<br />
Error in script &quot;C:\Documents and Settings\ptham\Desktop\IMPT DATELINE END OF SEP\testing.nsi&quot; on line 42 -- aborting creation process<br />
<br />
is the error that i have be getting becoz of this error? :mad:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">landgrimtham</div><div class="date">26th July 2005, 04:18</div></div><div class="posttext">can it be becoz of my pc setting that is affecting my script? :cry:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">26th July 2005, 05:22</div></div><div class="posttext">You seem to be missing a lot of the pieces to make this work.  (Has this ever sucessfully compiled on this PC?) <br />
<br />
I looked at your 1st and 2nd attachments.  They don't quite tell the whole story.  In the main script, I can see that asside from the MUI, 3 other files are being included: upgradeDll.nsh, shareddll.nsh, and installvb.nsh.  <br />
<br />
I can see in the last file (installvb.nsh) that there are several calls being made to the macro named &quot;UpgradeDLL&quot; and to the function named &quot;AddSharedDLL&quot;.  My best guess would be that the problem lies somewhere on one of these two.<br />
<br />
Unfortunately, neither one of these are included in the files you've sent, so I assume that they live in one of the other 2 NSH files (shareddll.nsh or upgradedll.nsh).  I'd examine both to see what they are doing--perhaps it will shed some light on what else you might be missing.  <br />
<br />
Also: you never did mention whether or not you were able obtain the version info from the file Asycfilt.dll from within Windows explorer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">landgrimtham</div><div class="date">26th July 2005, 07:32</div></div><div class="posttext">Originally posted by Comperio <br />
You seem to be missing a lot of the pieces to make this work.  (Has this ever sucessfully compiled on this PC?) <br />
<br />
I looked at your 1st and 2nd attachments.  They don't quite tell the whole story.  In the main script, I can see that asside from the MUI, 3 other files are being included: upgradeDll.nsh, shareddll.nsh, and installvb.nsh.  <br />
<br />
I can see in the last file (installvb.nsh) that there are several calls being made to the macro named &quot;UpgradeDLL&quot; and to the function named &quot;AddSharedDLL&quot;.  My best guess would be that the problem lies somewhere on one of these two.<br />
<br />
Unfortunately, neither one of these are included in the files you've sent, so I assume that they live in one of the other 2 NSH files (shareddll.nsh or upgradedll.nsh).  I'd examine both to see what they are doing--perhaps it will shed some light on what else you might be missing.  <br />
<br />
Also: you never did mention whether or not you were able obtain the version info from the file Asycfilt.dll from within Windows explorer.  <br />
<br />
yeb u r absolutly correct. the problem lies with the installvb and the upgradedll. *havent met with problems on the sharedll yet* <br />
<br />
as for the version info. i assume that *4give me* i goto property and click on the version tab to check. if that is so then i did and i can check the version. Renaming is also no problem 4 me. :igor: <br />
<br />
thanks again 4 ur help!! :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">landgrimtham</div><div class="date">26th July 2005, 07:40</div></div><div class="posttext">Originally posted by Comperio <br />
You seem to be missing a lot of the pieces to make this work.  (Has this ever sucessfully compiled on this PC?) <br />
<br />
 <br />
<br />
no come to think of it it has not be successful. i have change pc twice and the 1st pc i'm able to compile successful using an older version of NSIS 1yr ago but now after changing pc i cant seem to get it working. I think my OS then was win98 while now i'm using win2k. does this cause a problem of the script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">27th July 2005, 05:23</div></div><div class="posttext">See if this helps:<br />
Since you install seems to be failing when installing the VB runtimes, I'd start with that.  <br />
<br />
Looking at your full script, it appears that the script is using some older macros for updating DLLs.  This could be part of where it's failing. You may find it easier to rewrite using the newer methods.  <br />
<br />
I'd suggest reviewing Appendix B of the NSIS help files.  It outlines how to use macros contained in library.nsh to install DLL.  And there's a section dedicated to VB6 runtimes.   <br />
<br />
Sorry I couldn't be more help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">landgrimtham</div><div class="date">27th July 2005, 08:28</div></div><div class="posttext">Originally posted by Comperio <br />
See if this helps:<br />
Since you install seems to be failing when installing the VB runtimes, I'd start with that.  <br />
<br />
Looking at your full script, it appears that the script is using some older macros for updating DLLs.  This could be part of where it's failing. You may find it easier to rewrite using the newer methods.  <br />
<br />
I'd suggest reviewing Appendix B of the NSIS help files.  It outlines how to use macros contained in library.nsh to install DLL.  And there's a section dedicated to VB6 runtimes.   <br />
<br />
Sorry I couldn't be more help.  <br />
<br />
thanks bro :up:</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>