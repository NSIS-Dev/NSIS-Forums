<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" start menu alignment, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  start menu alignment NSIS Discussion" />
	
	<title> start menu alignment [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  start menu alignment</div>
<hr />
<div class="pda"><a href="t-228143.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228143">start menu alignment</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">tlalit</div><div class="date">11th October 2005, 10:37</div></div><div class="posttext">Hi, <br />
I'm using the Modern UI Language files everything looks align in the right way (RTL) except for the alignment to right text in hebrew in the start menu, when I'm using mixed text (hebrew and english) it's show's in the wrong order (not align to the right), is there a way to fix that?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th October 2005, 12:11</div></div><div class="posttext">It works just fine for me. What OS are you using? Can you attach an example script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tlalit</div><div class="date">11th October 2005, 12:50</div></div><div class="posttext">the script is: <br />
strcpy $TM_UNINSTALLER_LINK &quot;úåñó outlook ùì çáøä&quot;<br />
!insertmacro MUI_STARTMENU_WRITE_BEGIN &quot;Application&quot;<br />
SetShellVarContext All<br />
CreateDirectory &quot;$SMPROGRAMS\$STARTMENU_FOLDER&quot;<br />
CreateShortCut &quot;$SMPROGRAMS\$STARTMENU_FOLDER\$TM_UNINSTALLER_LINK.lnk&quot; &quot;$INSTDIR\uninst-tmOutlookPlugin.exe&quot;<br />
SetShellVarContext Current<br />
!insertmacro MUI_STARTMENU_WRITE_END<br />
<br />
<br />
but when I open the start menu (after installation) it's not aligned, I'm using winXP (english)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th October 2005, 13:26</div></div><div class="posttext">Ah, the start menu... I thought you were talking about the start menu page in the installer itself.<br />
<br />
You can insert an RLE (Right-to-Left Embedding) sign at the beginning of the name. However, NSIS doesn't support Unicode natively, so the System plug-in would have to be used. Attached is an example that creates a shortcut with the RLE mark.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tlalit</div><div class="date">11th October 2005, 14:30</div></div><div class="posttext">can you please explain to me what each line of the &quot;System::Call&quot; do?<br />
I'm trying to merge it to my code, but I don't seem to get the desire result.<br />
<br />
Thanks,<br />
Tali</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th October 2005, 14:45</div></div><div class="posttext">I've added some comments to the example. Basically, the example creates a temporary shortcut and renames it to the desired name with the RLE mark. To rename, it creates a Unicode buffer, appends $SMPROGRAMS, the RLE mark and the desired shortcut name. It then passes this buffer to MoveFileW in order to rename the temporary shortcut to the desired name.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tlalit</div><div class="date">11th October 2005, 17:36</div></div><div class="posttext">can you please tell me what's wrong with this script?<br />
instead of CreateShortcut I wrote CreateDirectory <br />
(because I need to align the startMenu folderName<br />
!insertmacro MUI_PAGE_STARTMENU &quot;Application&quot; $STARTMENU_FOLDER)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th October 2005, 17:56</div></div><div class="posttext">Oish, what a stupid mistake. The RLE wasn't written when I added the comments because the comment of the line above ends with a backslash. That causes the line that appends the RLE to be appended to the line above and be considered as a comment. Simply remove the backslash from the end of the of line or add another character after it and it will work.<br />
<br />
I really must do something about this extended comment... :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tlalit</div><div class="date">16th October 2005, 12:57</div></div><div class="posttext">HI,<br />
<br />
first of all - Thanks for the quick answers...<br />
I manage doing the shortcuts, but now I have a problem with the directory ubder the SMPROGRAMS...<br />
I think I need to append the RLE to the $STARTMENU_FOLDER variable, because every time I'm adding a link under $SMPROGRAMS\$STARTMENU_FOLDER\ its not added to the RLE FolderName, so I'm having two folders under StartMenu - 1 - RLE (and empty) and the other is not RLE (with shortcuts).<br />
this is exapmle of the shortcut created under the wrong folder:<br />
<br />
CreateShortcut &quot;$SMPROGRAMS\$STARTMENU_FOLDER\temp.lnk&quot; &quot;$INSTDIR\uninst-tmOutlookPlugin.exe&quot;<br />
	System::Call &quot;*(&amp;w2048 '$SMPROGRAMS\$STARTMENU_FOLDER\') i .r0&quot;<br />
	System::Call &quot;kernel32::lstrcatW(i r0, *i 0x202b)&quot;<br />
	System::Call &quot;kernel32::lstrcatW(i r0, w '$TM_UNINSTALLER_LINK.lnk')&quot;<br />
	System::Call &quot;kernel32::DeleteFileW(i r0)&quot;<br />
	System::Call &quot;kernel32::MoveFileW(w '$SMPROGRAMS\$STARTMENU_FOLDER\temp.lnk', i r0)&quot;<br />
	System::Free $0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th October 2005, 13:07</div></div><div class="posttext">You can't use the RLE mark in $STARTMENU_FOLDER because NSIS doesn't support Unicode. It'd be simpler to first create everything and then adding the RLE mark. Instead of creating temp.lnk, create the correct structure, including all the folders and the links, and only then add the RLE mark where needed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tlalit</div><div class="date">16th October 2005, 18:35</div></div><div class="posttext">after making the RLE link I have new problem:<br />
when deleting the startMenu folder (uninstall section) there are leftovers of the link that was changed to be RLE, but all other links were remove.<br />
<br />
this is the code (it worked before):<br />
SetShellVarContext All<br />
!insertmacro MUI_STARTMENU_GETFOLDER &quot;Application&quot; $R0<br />
RMDir /r &quot;$SMPROGRAMS\$R0&quot;<br />
SetShellVarContext Current</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th October 2005, 18:40</div></div><div class="posttext">The name is different now, it contains the RLE mark. You'd need to a similar method to delete the files. The code that I've posted deletes the link before it renames the temporary one. You can use the exact same code, removing just the MoveFileW call.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tlalit</div><div class="date">17th October 2005, 09:09</div></div><div class="posttext">Thank you very much - it helped...<br />
have happy holidays.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>