<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with !define, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with !define NSIS Discussion" />
	
	<title> Problem with !define [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with !define</div>
<hr />
<div class="pda"><a href="t-209021.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=209021">Problem with !define</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">27th February 2005, 18:58</div></div><div class="posttext">Is there any way to pass this code?<br />
<br />
Name &quot;RegSearch&quot;<br />
OutFile &quot;RegSearch.exe&quot;<br />
<br />
!macro RegSearch _ROOTKEY<br />
	!define _ROOT ${_ROOTKEY}<br />
	Call RegSearch<br />
!macroend<br />
<br />
Function RegSearch<br />
	EnumRegKey $0 ${_ROOT} &quot;&quot; 1<br />
FunctionEnd<br />
<br />
Section<br />
	!insertmacro RegSearch HKLM<br />
	MessageBox MB_OK &quot;$0&quot;<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th February 2005, 12:02</div></div><div class="posttext">Are you saying that ${_ROOT} has no value in the RegSearch function call?<br />
<br />
Edit: Oh I see. Just use Push ${_ROOTKEY} and in your Function Pop it into a variable.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">28th February 2005, 15:25</div></div><div class="posttext">${_ROOT} can't be a variable<br />
<br />
It seems like functions compiles first and then macros and sections.<br />
<br />
I see only one solution, but it's not comfortably for the user:<br />
<br />
Function RegSearch<br />
	!define _ROOT HKLM<br />
	EnumRegKey $0 ${_ROOT} &quot;&quot; 1<br />
FunctionEnd<br />
<br />
May be there is another way.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th February 2005, 16:22</div></div><div class="posttext">The only suggestion that I can think of, is that you have multiple copies of the RegSearch functions with different names (i.e. RegSearch_HKLM) which is called like so:<br />
<br />
!macro RegSearch _ROOTKEY<br />
	Call RegSearch_${_ROOTKEY}<br />
!macroend<br />
<br />
<br />
You are right that the function is only compiled once, therefore you cannot change the value of ${_ROOT}.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kike_velez</div><div class="date">1st March 2005, 09:24</div></div><div class="posttext">WhatÂ´s about a change the order :) <br />
<br />
This compile for me:<br />
<br />
<br />
Name &quot;RegSearch&quot;<br />
OutFile &quot;RegSearch.exe&quot;<br />
<br />
!macro RegSearch _ROOTKEY<br />
	!define _ROOT ${_ROOTKEY}<br />
	Call RegSearch<br />
!macroend<br />
<br />
<br />
<br />
Section<br />
	!insertmacro RegSearch HKLM<br />
	MessageBox MB_OK &quot;$0&quot;<br />
SectionEnd<br />
<br />
Function RegSearch<br />
	EnumRegKey $0 ${_ROOT} &quot;&quot; 1<br />
FunctionEnd<br />
<br />
<br />
<br />
Best Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">1st March 2005, 10:48</div></div><div class="posttext">kike_velez and Afrow UK thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st March 2005, 18:48</div></div><div class="posttext">If you're trying to pass HKLM for all users and HKCU for current user, see SHCTX in the latest CVS version.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">23rd March 2005, 10:42</div></div><div class="posttext">Is it possible in future to change all root_key (HKCR|HKLM|HKCU|HKU|HKCC|HKDD|HKPD) at runtime?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th March 2005, 15:48</div></div><div class="posttext">I doubt it. It'll break backwards compatibility because it'll be converted into defines. You can submit a feature request, if one doesn't already exist, to keep the request from fading away in the forum.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>