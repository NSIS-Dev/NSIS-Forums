<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Desktop icon duplicated four times, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Desktop icon duplicated four times NSIS Discussion" />
	
	<title> Desktop icon duplicated four times [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Desktop icon duplicated four times</div>
<hr />
<div class="pda"><a href="t-190468.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=190468">Desktop icon duplicated four times</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Voxen2</div><div class="date">18th August 2004, 08:43</div></div><div class="posttext">Hi,<br />
<br />
When installing my application, the desktop icon is duplicated 4 times, i.e. I see 4 icons of my application on the desktop, all of them pointing to the same EXE.<br />
<br />
If I refresh the desktop with F5 then only one remains.<br />
<br />
This is the script command I use to create the desktop icon:<br />
CreateShortCut &quot;$DESKTOP\MyApp.lnk&quot; &quot;$INSTDIR\myapp.exe&quot;<br />
<br />
That never happened with previous versions of my software, however on the last install script I added the &quot;SetShellVarContext all&quot; in order to have the installation shared with all users. Is that related?<br />
<br />
What can I do?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">18th August 2004, 11:19</div></div><div class="posttext">To refresh the desktop, use the code below:<br />
<br />
!include WinMessages.nsh<br />
<br />
Function .onInit<br />
  SendMessage &quot;${HWND_BROADCAST}&quot; &quot;${WM_SETTINGCHANGE}&quot; &quot;&quot; &quot;&quot;<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Voxen2</div><div class="date">18th August 2004, 11:53</div></div><div class="posttext">Originally posted by deguix <br />
To refresh the desktop, use the code below: <br />
<br />
Thanks but this is a workaround to the problem. <br />
<br />
I'd like that it just doesn't happen (if possible).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">18th August 2004, 12:13</div></div><div class="posttext">This is probably a scripting problem.<br />
<br />
Remember: You can debug any part of the script using MessageBox command or using DumpState plugin. So even you can solve the problem here.<br />
<br />
Or you can attach your script if you want it fast or sure.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scully13</div><div class="date">18th August 2004, 14:09</div></div><div class="posttext">I've seen this happen when a shortcut with the same name already exists under the &quot;all users&quot; area and then you add the same shortcut under the &quot;current user&quot;. You can also get the problem to occur by creating the shortcuts through Windows so it appears to be a Windows issue. I've seen it happen other times but never really nailed down the cause. I guess you could check you script to make sure your not doing something like creating duplicate shortcuts.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Voxen2</div><div class="date">19th August 2004, 09:19</div></div><div class="posttext">I have only one call to:<br />
CreateShortCut &quot;$DESKTOP\MyApp.lnk&quot; &quot;$INSTDIR\myapp.exe&quot;<br />
<br />
If there is no solution I'll try the workaround proposed by deguix.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">19th August 2004, 13:24</div></div><div class="posttext">The following will assure only one instance.<br />
<br />
<br />
!include &quot;WinMessages.nsh&quot;<br />
...<br />
<br />
IfFileExists &quot;$DESKTOP\MyApp.lnk&quot; lblAlreadyExists<br />
CreateShortCut &quot;$DESKTOP\MyApp.lnk&quot; &quot;$INSTDIR\myapp.exe&quot;<br />
Goto LblDone<br />
lblAlreadyExists:<br />
; the following will replace the existing shortcut, hope it was yours. This insures your target is right.<br />
delete &quot;$DESKTOP\MyApp.lnk&quot;<br />
CreateShortCut &quot;$DESKTOP\MyApp.lnk&quot; &quot;$INSTDIR\myapp.exe&quot;<br />
; refresh incase incon changed since bloody windows caches them.<br />
SendMessage &quot;${HWND_BROADCAST}&quot; &quot;${WM_SETTINGCHANGE}&quot; &quot;&quot; &quot;&quot;<br />
lblDone:<br />
<br />
...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Voxen2</div><div class="date">19th August 2004, 21:09</div></div><div class="posttext">Thanks a lot, I'll try this.<br />
;)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>