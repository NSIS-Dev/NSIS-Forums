<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" RegDLL / CLSID, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  RegDLL / CLSID NSIS Discussion" />
	
	<title> RegDLL / CLSID [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  RegDLL / CLSID</div>
<hr />
<div class="pda"><a href="t-254491.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=254491">RegDLL / CLSID</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MichaS</div><div class="date">31st August 2006, 10:44</div></div><div class="posttext">Hello,<br />
<br />
can somebody please help me.<br />
<br />
I am installing a foo.dll inside of my Installer at a specific place. Now, I want to register this dll, so it gets an registry entry inside of &quot;HKCR // CLSID&quot;.<br />
<br />
When I am calling RegDLL $MYINSTALLDIR/foo.dll, I receive a registry entry at &quot;HKCR // CLSID&quot;. But this registry has path-information of the Installer.exe. But I want to have the path-info of the foo.dll inside of this registry entry.<br />
<br />
<br />
Thanx,<br />
Micha.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">31st August 2006, 15:31</div></div><div class="posttext">*First* install the DLL in the correct place, *then* register the DLL.<br />
<br />
Do not have to much time at this moment so the help that I can offer now is that I can succesfully register a DLL via my NSIS  script, so keep on trying and reading the manual, be persisten and you will succeed. <br />
<br />
Oh, and if possible use NSIS v2.18 or higher. There is an important fix regarding registering a DLL if you build your installer on a POSIX platform like Linux or FreeBSD.<br />
<br />
BTW An extract from your NSIS Script would make solving easier for others...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">31st August 2006, 15:35</div></div><div class="posttext">I see you still use RegDLL, this is the OLD way plz use:<br />
<br />
Example below where you have to figure out the ${WEREYOUFILELOCALYCOMESFROM} and $WHEREITGOESTO and &quot;myname.dll&quot; ofcourse... <br />
<br />
-------------------<br />
<br />
!insertmacro InstallLib REGDLLTLB NOTSHARED REBOOT_NOTPROTECTED &quot;${WEREYOUFILELOCALYCOMESFROM}myname.dll&quot; &quot;$WHEREITGOESTO\myname.dll&quot; &quot;$SYSDIR&quot;<br />
<br />
-------------------</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MichaS</div><div class="date">1st September 2006, 10:29</div></div><div class="posttext">Hey,<br />
<br />
Thanx for your help.<br />
But it won't work for me. I get the same result like with RegDLL. Let me explain.<br />
<br />
My compiled Installer is located at &quot;C:/Installer/Installer.exe&quot;<br />
<br />
<br />
In the script, I am calling:<br />
<br />
!insertmacro InstallLib REGDLLTLB NOTSHARED REBOOT_NOTPROTECTED &quot;localfolder\foo.dll&quot; &quot;destfolder\foo.dll&quot; &quot;destfolder&quot;<br />
<br />
When the Installer has been started and finished, I'll receive a new entry in the registry at <br />
<br />
HKCR // CLSID // Unique-GUIID <br />
-&gt; Here you'll find a path of the Installer, i.e., &quot;C:/Installer/Installer.exe&quot;. But I need the path of the dll, i.e., &quot;destfolder\foo.dll&quot;<br />
<br />
<br />
Any ideas?<br />
<br />
<br />
Thanx again,<br />
Micha.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st September 2006, 10:56</div></div><div class="posttext">Seems like a problem with the DLL itself. The Library macros write nothing to HKCR\CLSID. You should contact the author of this DLL or fix the path on your program's first run.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MichaS</div><div class="date">1st September 2006, 11:16</div></div><div class="posttext">Hm.<br />
<br />
Is it possible to receive the Unique-GUIID which InstallLib has created?<br />
<br />
<br />
Thanx.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st September 2006, 11:21</div></div><div class="posttext">InstallLib doesn't create a GUID for HKCR\CLSID. The GUID is used internally for something else, related to the RunOnce registry key. It's the DLL that sets this GUID in HKCR\CLSID.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">5th September 2006, 11:33</div></div><div class="posttext">The code in your DLL is not correctly written to determine the own DLL location when the DLL is registered. One way to solve this is do a ChangeDir to the destination Dir of the DLL first befor registering the DLL, this sometimes helps with DLL that are not correctly written.<br />
<br />
I can assure you the NSIS registering the DLL implementation is correct.<br />
<br />
Be persiten and think creative towards a solution and you will succeed.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>