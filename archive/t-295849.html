<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Can an NSIS installer read data appended to installer .exe after it was created?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Can an NSIS installer read data appended to installer .exe after it was created? NSIS Discussion" />
	
	<title> Can an NSIS installer read data appended to installer .exe after it was created? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Can an NSIS installer read data appended to installer .exe after it was created?</div>
<hr />
<div class="pda"><a href="t-295849.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=295849">Can an NSIS installer read data appended to installer .exe after it was created?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">12th August 2008, 17:14</div></div><div class="posttext">I would like to append a small chunk of data (less than 256 bytes) to the setup.exe file generated by the NSIS compiler (i.e. after the NSIS script has been compiled, possibly with compression).<br />
<br />
I know that this is possible, that the small chunk of data won't be CRC'ed, and that the modified setup.exe will run as if that small chunk of data was not appended.<br />
<br />
However, I am interested in being able to read it from within the NSIS script when the user runs the installer. Is this possible? If so, is there already a plugin (or even built-in API) that helps facilitate that?<br />
<br />
For example, can I use NSIS's FileSeek and FileRead to accomplish the above, although these operations are to be performed on the same setup.exe that does those two operations?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">12th August 2008, 17:53</div></div><div class="posttext">This wiki article (http://nsis.sourceforge.net/ReadCustomerData) might help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">12th August 2008, 17:56</div></div><div class="posttext">Originally posted by Comperio <br />
This wiki article (http://nsis.sourceforge.net/ReadCustomerData) might help. <br />
OMG - you are so good! That is exactly what I was looking for. Thank you very much, Comperio.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">23rd September 2008, 00:08</div></div><div class="posttext">Tips to anyone who might be looking to use the excellent article written by Andrey Tarantsov:<br />
<br />
http://nsis.sourceforge.net/ReadCustomerData <br />
<br />
It works very well. However, it works only if you don't compile the NSIS script with a compressor<br />
<br />
In my case the compressed result is not much smaller than the uncompressed so it makes no difference for me (I am happy :)).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">23rd September 2008, 02:34</div></div><div class="posttext">Originally posted by nsnb <br />
It works very well. However, it works only if you don't compile the NSIS script with a compressor<br />
Sorry, I have to take back what I just wrote above. My &quot;discovery&quot; documented above was due to a bug in my implementation of Function ReadCustomerData.<br />
<br />
Andrey Tarantsov uses a very robust method to search for CUSTDATA:<br />
loop:<br />
  FileSeek $1 $2 END<br />
  FileRead $1 $3 $4<br />
  StrCmp $3 $R1 found<br />
  IntOp $2 $2 + 1<br />
  IntCmp $2 0 loop loop<br />
<br />
But it is also very slow. This is because it keeps reading the file 1024 times to search for CUSTDATA...<br />
<br />
I thought of accelerating this by reading the last 1024 bytes in the file only once, then searching for the string in memory. It worked, but is not as robust as Trantsov's: in my implementation compression effects whether CUSTDATA is found. This is clearly my bug.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>