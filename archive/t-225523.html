<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with un.GUIEnd, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with un.GUIEnd NSIS Discussion" />
	
	<title> Problem with un.GUIEnd [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with un.GUIEnd</div>
<hr />
<div class="pda"><a href="t-225523.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=225523">Problem with un.GUIEnd</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">NukeyDoo</div><div class="date">9th September 2005, 12:19</div></div><div class="posttext">Hello,<br />
<br />
I have one tiny last little problem happening with my script. As the very last thing of my uninstall, I want to send the user to my website which will have a page asking why they decided to uninstall, so that I can use the feedback for improvements.<br />
<br />
When the Uninstall is complete, it should launch the page. It's working fine using this code:<br />
<br />
Section un.onGUIEnd<br />
<br />
  ExecShell &quot;open&quot; &quot;http://www.foobar.com/&quot;<br />
<br />
SectionEnd<br />
<br />
The only issues are, it's launching the page while the last gui (success) page is on the screen, even without the user clicking the final OK button. From reading the help file I was under the impression that it wouldn't launch until the actual window was closed?<br />
<br />
The other issue is when I remove my app using the add/remove programs applet (AR), the AR window is not refreshing to reflect the program was uninstalled from the AR list until the browser window is closed from the launching of my page, in fact you can't even set focus to the AR window with your mouse cursor until you close the browser window.<br />
<br />
Any ideas around these issues?<br />
<br />
<br />
TIA</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th September 2005, 12:30</div></div><div class="posttext">I can't reproduce the un.onGUIEnd problem. When I create a simple installer with just un.onGUIEnd, it's executed after the dialog closes. Are you sure there's no other code section that opens the website?<br />
<br />
As for the Add/Remove control panel freezing, see the following:<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=224925&amp;highlight=uninstall</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dubek1</div><div class="date">30th January 2006, 16:35</div></div><div class="posttext">I also experience NukeyDoo's problem. I must mention my installer is a MUI one, maybe that causes the problem?<br />
<br />
I tried putting the ExecShell command both in un.onGUIEnd and <br />
MUI_PAGE_CUSTOMFUNCTION_LEAVE of the MUI_UNPAGE_INSTFILES page (which is the last page in my installer). Both yielded the same (unwanted) result of executing the ExecShell *before* the user clicked &quot;Close&quot;.<br />
<br />
Thanks,<br />
Dov.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">30th January 2006, 17:41</div></div><div class="posttext">This also might happen if you used plug-in with /NOUNLOAD option and dll stays attached at the end of uninstall.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st January 2006, 17:27</div></div><div class="posttext">I still can't reproduce this. Please attach an example.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dubek1</div><div class="date">1st February 2006, 07:40</div></div><div class="posttext">Here's my script (attached).<br />
<br />
Maybe it's because the uninstaller has no finish page?<br />
<br />
Thanks a lot!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dandaman32</div><div class="date">1st February 2006, 20:29</div></div><div class="posttext">Use: Function un.onInstSuccess<br />
  HideWindow ; not sure if this is needed I'm a little rusty<br />
  ExecShell open &quot;http://feedback.example.com&quot;<br />
FunctionEnd<br />
<br />
Emphasis on function :weird: <br />
-dandaman32</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dubek1</div><div class="date">2nd February 2006, 07:19</div></div><div class="posttext">Thanks a lot for your help; now it works as intended. I guess the problem was that I wrote &quot;Section&quot; instead of &quot;Function&quot; (another classic RTFM case).<br />
<br />
So either un.onUninstSuccess or un.onGUIEnd works for me now (I'll use un.onUninstSuccess, to prevent the browser open if something went wrong).<br />
<br />
Again, thanks a lot!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>