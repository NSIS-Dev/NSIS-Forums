<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Optionally creating desktop shortcuts?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Optionally creating desktop shortcuts? NSIS Discussion" />
	
	<title> Optionally creating desktop shortcuts? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Optionally creating desktop shortcuts?</div>
<hr />
<div class="pda"><a href="t-289924.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289924">Optionally creating desktop shortcuts?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kook04</div><div class="date">9th April 2008, 18:26</div></div><div class="posttext">Is there an example of a script that lets the user check a checkbox during install that determines if desktop shortcuts get created?   I'd like to create these shortcuts, but only if the user wants them to be created.<br />
<br />
Thanks,<br />
<br />
Kennedy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th April 2008, 19:02</div></div><div class="posttext">Make a custom page or add a component to your components page (Section).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mikesch</div><div class="date">9th April 2008, 20:48</div></div><div class="posttext">Hi, <br />
<br />
I wrote this function for use as custom page.<br />
<br />
<br />
Function ShortcutPage<br />
<br />
  ; Prepare shortcut page with default values<br />
  !insertmacro MUI_HEADER_TEXT &quot;Additional Shortcuts&quot; &quot;Please select, whether additional shortcuts should be created.&quot;<br />
<br />
  ; Display shortcut page<br />
  !insertmacro INSTALLOPTIONS_DISPLAY_RETURN &quot;ShortcutPage.ini&quot;<br />
  pop $R0<br />
 <br />
  ${If} $R0 == &quot;cancel&quot;<br />
    Abort<br />
  ${EndIf}<br />
  <br />
  ; Get the selected options<br />
  ReadINIStr $R1 &quot;$PLUGINSDIR\ShortcutPage.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
  ReadINIStr $R2 &quot;$PLUGINSDIR\ShortcutPage.ini&quot; &quot;Field 4&quot; &quot;State&quot;<br />
<br />
  ${If} $R1 == &quot;1&quot;  ; Did user check create desktop shortcut?<br />
    CreateShortCut &quot;$DESKTOP\$(TEXT_DESKTOP_LINK)&quot; &quot;$INSTDIR\${PRODUCT_EXE}&quot;<br />
  ${EndIf}<br />
<br />
  ${If} $R2 == &quot;1&quot;  ; Did user check create quick launch shortcut?<br />
    CreateShortCut &quot;$QUICKLAUNCH\$(TEXT_DESKTOP_LINK)&quot; &quot;$INSTDIR\${PRODUCT_EXE}&quot;<br />
  ${EndIf}<br />
  <br />
FunctionEnd<br />
<br />
<br />
<br />
In your script you have to call this function like this:<br />
<br />
<br />
Page custom ShortcutPage<br />
<br />
<br />
You need the ShortcutPage.ini file with the following entry:<br />
<br />
[Settings]<br />
NumFields=4<br />
[Field 1]<br />
Type=label<br />
Text=Setup can create shortcuts on your Desktop and in the Quick Launch bar for easier access.<br />
Left=0<br />
Right=-1<br />
Top=5<br />
Bottom=25<br />
<br />
[Field 2]<br />
Type=label<br />
Text=Please select the shortcuts, which are to be created by the setup:<br />
Left=0<br />
Right=-1<br />
Top=35<br />
Bottom=45<br />
<br />
<br />
[Field 3]<br />
Type=checkbox<br />
Text=Yes, I would like to create the shortcut on the Desktop.<br />
Left=15<br />
Right=-1<br />
Top=55<br />
Bottom=65<br />
State=1<br />
<br />
[Field 4]<br />
Type=checkbox<br />
Text=Yes, I would like to create the shortcut in the &amp;Quick Launch bar.<br />
Left=15<br />
Right=-1<br />
Top=75<br />
Bottom=85<br />
State=1<br />
<br />
<br />
I hope this will help you to create your own custom page to create addional short cuts.<br />
<br />
Mikesch</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>