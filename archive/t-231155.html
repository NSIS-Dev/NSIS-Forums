<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" a problem with UpgradeDLL (macro), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  a problem with UpgradeDLL (macro) NSIS Discussion" />
	
	<title> a problem with UpgradeDLL (macro) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  a problem with UpgradeDLL (macro)</div>
<hr />
<div class="pda"><a href="t-231155.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=231155">a problem with UpgradeDLL (macro)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">rawy</div><div class="date">16th November 2005, 11:36</div></div><div class="posttext">Hello<br />
<br />
I use UpgradeDLL (Macro).<br />
<br />
When this macro is unregistered the old DLL and copy and registered the new DLL, I have a problem that my install program is not correctly finished and still in memory (see at windows task manager)<br />
<br />
Someone had the same problem?<br />
<br />
thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">16th November 2005, 15:06</div></div><div class="posttext">Please give an example script to test. <br />
<br />
The information you provide is a little to sparse for forum member to be of help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rawy</div><div class="date">16th November 2005, 16:43</div></div><div class="posttext">This is my script to call the UpgrageDLL:<br />
<br />
<br />
;-- 1. : Get the path of DLL used CLSID (if DLL is already registered) <br />
ReadRegStr $0 HKCR &quot;${AFS_CLSID}\InprocServer32&quot; &quot;&quot;<br />
;--2. if DLL is not already on PC<br />
StrCmp $0 &quot;&quot;  DLL_Install DLL_UpDate<br />
    DLL_Install:<br />
;-- register DLL (This steep is always OK)<br />
!insertmacro UpgradeDLL &quot;${Src_Dir}\MediaAFS.dll&quot; &quot;$INSTDIR\MediaAFS.dll&quot; &quot;$INSTDIR&quot;<br />
GoTo End_Reg_DLL<br />
   DLL_UpDate:<br />
<br />
;-- This call of macro make problem<br />
!insertmacro UpgradeDLL &quot;${Rep_Src}\MediaAFS.dll&quot; &quot;$0&quot; &quot;$INSTDIR&quot;<br />
    End_Reg_DLL:<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rawy</div><div class="date">17th November 2005, 11:11</div></div><div class="posttext">I add here a scrip test <br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rawy</div><div class="date">17th November 2005, 13:55</div></div><div class="posttext">Sorry I can not send the 2 DLL files because the zip file is &gt; 102400 bytes. I send her the script only.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th November 2005, 19:11</div></div><div class="posttext">Does regsvr32.exe keep runnign as well, when used to registry that DLL?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>