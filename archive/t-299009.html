<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Enable/Disable Sections based on prerequisites?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Enable/Disable Sections based on prerequisites? NSIS Discussion" />
	
	<title> Enable/Disable Sections based on prerequisites? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Enable/Disable Sections based on prerequisites?</div>
<hr />
<div class="pda"><a href="t-299009.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=299009">Enable/Disable Sections based on prerequisites?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bwacek</div><div class="date">22nd October 2008, 20:43</div></div><div class="posttext">Hello!<br />
<br />
I'm just learning NSIS, and so far I am enjoying the ride.  It seems pretty straightforward so far, but I've hit a problem that I can't find an answer to with searches in the forums and Google.<br />
<br />
Problem Background:<br />
I am writing a plugin for web browsers on Windows.  Usually Internet Explorer will be installed, but other browsers like Firefox, Chrome, Safari, and Opera will be installed as well.  The plugin has different installation locations based on which browser it's for, so I've set up different Sections for each browser type (all contained within a SectionGroup).  I also have the details of installation already completed for each browser type.<br />
<br />
Problem:<br />
I'm trying to add functionality to the installer that will enable/disable the proper section(s) if the user has the particular browser installed (basically just trying to make it an 'intelligent' installer).  For example, if the user has IE and Firefox installed, those plugin sections will be selected automatically, and ideally the others (Chrome, Safari, and Opera) would all be disabled/grayed out.<br />
<br />
I already have the actual tests for each browser completed, so I know if each browser is installed.  The problem is that when I try to add this code to the .onInit callback that it's not working.  In fact, for some reason it modifies the selection tree by moving the web browser sections to the same level as the SectionGroup.<br />
<br />
I've tried adding the testing code to the .onSelChange function too, but that makes things really messy as well.<br />
<br />
Here is some of the example code (just Firefox for easier reading).  IsFirefoxInstalled is initialized as part of the .onInit callback.<br />
<br />
<br />
!include Sections.nsh<br />
...<br />
# If the non-IE web browsers are installed, automatically select them.         <br />
# If not, disable the selection of that item.         <br />
${If} $IsFirefoxInstalled == &quot;1&quot;<br />
    !insertmacro SelectSection MozillaFirefox<br />
${Else}<br />
    !insertmacro UnselectSection MozillaFirefox<br />
${EndIf}<br />
<br />
<br />
Is NSIS capable of doing something like this?  If so, do I have the right idea, or am I going the wrong direction?  Why won't this work?<br />
<br />
Any help someone could provide would be greatly appreciated.<br />
<br />
Thanks!<br />
<br />
-Bill</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">22nd October 2008, 22:04</div></div><div class="posttext">you must specify the section id (Section NAME ID), also the .onInit function must come after your sections in the script.<br />
<br />
So it would look something like:<br />
<br />
!include Sections.nsh<br />
<br />
Section &quot;Firefox&quot; secfirefox<br />
...<br />
SectionEnd<br />
<br />
Function .OnInit<br />
${If} $IsFirefoxInstalled == &quot;1&quot;<br />
    !insertmacro SelectSection ${secfirefox}<br />
${Else}<br />
    !insertmacro UnselectSection ${secfirefox}<br />
${EndIf}<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bwacek</div><div class="date">23rd October 2008, 13:48</div></div><div class="posttext">With all of the information I was trying to give, I forgot to mention that I did have the Section Name in there:<br />
<br />
Section &quot;Mozilla Firefox&quot; MozillaFirefox  <br />
<br />
But, I noticed that you put the ${} around the section name.  I tried that and it worked exactly like I wanted it to.<br />
<br />
The confusing thing is that I don't understand why the compiler built the installer if I didn't treat the section name as a variable.  Shouldn't this have thrown an error during compilation?  If not, is there a rule of thumb as to when to use the ${} and when not to?<br />
<br />
I'm still a little confused, but I thank you very much for your help - you made my installer work exactly the way I wanted it to!<br />
<br />
-Bill</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>