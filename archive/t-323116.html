<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Validation check, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Validation check NSIS Discussion" />
	
	<title> Validation check [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Validation check</div>
<hr />
<div class="pda"><a href="t-323116.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=323116">Validation check</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">starfighter5</div><div class="date">13th October 2010, 16:10</div></div><div class="posttext">Hi all,<br />
<br />
I have an installer that I am creating that asks the user to input two text fields using an installoptions custom page.<br />
<br />
I am trying to get the installer to check if the fields are empty and then display an error message if either or both are empty.  I have managed to get this to work using the following code for one of the text fields but how can i get it to check both of them?<br />
<br />
;Page5<br />
Page custom page5 ValidateCustom<br />
Function page5<br />
!insertmacro MUI_HEADER_TEXT &quot;Folders&quot; &quot;Please share folders out and set share names here&quot;<br />
#Display the page<br />
!insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;page5&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_READ $1 &quot;page5&quot; &quot;Field 2&quot; &quot;State&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_READ $2 &quot;page5&quot; &quot;Field 3&quot; &quot;State&quot;<br />
FunctionEnd<br />
<br />
Function ValidateCustom<br />
  !insertmacro INSTALLOPTIONS_READ $1 &quot;page5&quot; &quot;Field 2&quot; &quot;State&quot;<br />
    !insertmacro INSTALLOPTIONS_READ $2 &quot;page5&quot; &quot;Field 3&quot; &quot;State&quot;<br />
  StrCmp $1 &quot;&quot; 0 +3<br />
    MessageBox MB_ICONEXCLAMATION|MB_OK &quot;Please enter your name.&quot;<br />
    Abort<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">13th October 2010, 16:19</div></div><div class="posttext">I highly recommend using LogicLib:<br />
http://nsis.sourceforge.net/LogicLib<br />
<br />
<br />
Function ValidateCustom<br />
  !insertmacro INSTALLOPTIONS_READ $1 &quot;page5&quot; &quot;Field 2&quot; &quot;State&quot;<br />
  !insertmacro INSTALLOPTIONS_READ $2 &quot;page5&quot; &quot;Field 3&quot; &quot;State&quot;<br />
  ${If} &quot;$1&quot; == &quot;&quot;<br />
  ${OrIf} &quot;$2&quot; == &quot;&quot;<br />
    MessageBox MB_ICONEXCLAMATION|MB_OK &quot;Please enter your name.&quot;<br />
    Abort<br />
  ${EndIf}<br />
FunctionEnd<br />
<br />
<br />
I also recommend switching from InstallOptions to nsDialogs:<br />
http://nsis.sourceforge.net/Docs/nsDialogs/Readme.html<br />
<br />
but that's another thread %)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">starfighter5</div><div class="date">13th October 2010, 16:45</div></div><div class="posttext">Thanks for that, having used your code thought it prompts me with the error message if there is anything in the boxes or not.<br />
<br />
am I missing something?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">13th October 2010, 17:27</div></div><div class="posttext">If you didn't get any warnings.. not that I can think of;<br />
<br />
<br />
OutFile &quot;$%temp%\temp.exe&quot;<br />
Section<br />
SectionEnd<br />
<br />
!include &quot;InstallOptions.nsh&quot;<br />
<br />
Function .onInit<br />
  !insertmacro INSTALLOPTIONS_EXTRACT &quot;page5&quot;<br />
FunctionEnd<br />
<br />
Page custom CustomPageFunction<br />
<br />
Function CustomPageFunction<br />
  !insertmacro INSTALLOPTIONS_DISPLAY &quot;page5&quot;<br />
  Call ValidateCustom<br />
FunctionEnd<br />
<br />
<br />
Function ValidateCustom<br />
  !insertmacro INSTALLOPTIONS_READ $1 &quot;page5&quot; &quot;Field 2&quot; &quot;State&quot;<br />
  !insertmacro INSTALLOPTIONS_READ $2 &quot;page5&quot; &quot;Field 3&quot; &quot;State&quot;<br />
  MessageBox MB_OK &quot;[$1][$2]&quot; /* to see what the values are */<br />
  ${If} &quot;$1&quot; == &quot;&quot;<br />
  ${OrIf} &quot;$2&quot; == &quot;&quot;<br />
    MessageBox MB_ICONEXCLAMATION|MB_OK &quot;Please enter your name.&quot;<br />
    Abort<br />
  ${EndIf}<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">starfighter5</div><div class="date">9th December 2010, 15:31</div></div><div class="posttext">I have finally managed to find some time to go back to this installer, I have this in place...<br />
<br />
;Page5<br />
Page custom page5<br />
Function page5<br />
!insertmacro MUI_HEADER_TEXT &quot;Folders&quot; &quot;Please fill in boxes&quot;<br />
#Display the page<br />
!insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;page5&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_READ $1 &quot;page5&quot; &quot;Field 2&quot; &quot;State&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_READ $2 &quot;page5&quot; &quot;Field 3&quot; &quot;State&quot;<br />
<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
;;;VALIDATION CHECK;;;;;;;;<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
${If} &quot;$1&quot; == &quot;&quot;<br />
  ${OrIf} &quot;$2&quot; == &quot;&quot;<br />
    MessageBox MB_ICONEXCLAMATION|MB_OK &quot;Please ensure both fields are filled in&quot;<br />
    Call page5<br />
  ${EndIf}<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
;;END OF VALIDATION CHECK;;<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
FunctionEnd<br />
<br />
Which works to a degree, problem is if I select 'Cancel' it brings the message 'Please ensure both fields are filled in.  It does this regardless of wether the fields are filled in or not.<br />
<br />
Anyone any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th December 2010, 15:42</div></div><div class="posttext">You must read the values from the INI file in the page leave function.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">starfighter5</div><div class="date">9th December 2010, 15:47</div></div><div class="posttext">Hi,<br />
<br />
I have taken the easy route out and used MinLen=1 in the .ini file.  This way I don't get the message displaying but it should be pretty obvious to the end user what they have done wrong.<br />
<br />
Now I just got to work out if I can use the same approach for radio buttons....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">starfighter5</div><div class="date">9th December 2010, 16:43</div></div><div class="posttext">Doesn't seem to be as simple with radio buttons!  I have three radio buttons on the one page.<br />
<br />
I just want the page to not allow the user to go to the next one without selecting a button.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th December 2010, 17:02</div></div><div class="posttext">Like I said you need to check the contents of the INI file in the page LEAVE function. You are doing your checks in the page CREATE function. The INI file is not updated until the leave function is called. I recommend switching to nsDialogs. It makes stuff like this much easier.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">starfighter5</div><div class="date">10th December 2010, 11:02</div></div><div class="posttext">Hi Stu,<br />
<br />
After some extensive reading I have now realised also that using nsDialogs would have been a better route to take!  Seen as I only have to resolve this last issue with the installer I am going to try and stick with InstallOptions for this project......<br />
<br />
I am struggling to find some examples or an explanation of a LEAVE function.<br />
<br />
Can you point me in the right direction of some reading material or explain it for me?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">10th December 2010, 11:11</div></div><div class="posttext">Check the testnotify script in the InstallOptions examples</div></div><hr />


<div class="post"><div class="posttop"><div class="username">starfighter5</div><div class="date">10th December 2010, 13:46</div></div><div class="posttext">Ok, using the example in http://nsis.sourceforge.net/Examples/InstallOptions/testnotify.nsi I have come up with this, only problem is it displays the Error message if anything is selected or not......<br />
<br />
;Page6<br />
Page custom page6 page6leave<br />
Function page6<br />
!insertmacro MUI_HEADER_TEXT &quot;Checkboxes&quot; &quot;Please select a checkbox&quot;<br />
#Display the page<br />
!insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;page6&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_READ $R1 &quot;page6&quot; &quot;Field 1&quot; &quot;State&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_READ $R2 &quot;page6&quot; &quot;Field 2&quot; &quot;State&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_READ $R3 &quot;page6&quot; &quot;Field 3&quot; &quot;State&quot;<br />
FunctionEnd<br />
<br />
Function page6leave<br />
 ReadINIStr $0 &quot;page6.ini&quot; &quot;Field 1&quot; &quot;State&quot;<br />
  StrCmp $0 1 done<br />
  ReadINIStr $0 &quot;page6.ini&quot; &quot;Field 2&quot; &quot;State&quot;<br />
  StrCmp $0 1 done<br />
  ReadINIStr $0 &quot;page6.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
  StrCmp $0 1 done<br />
    MessageBox MB_ICONEXCLAMATION|MB_OK &quot;You must select at least one install option!&quot;<br />
    Abort<br />
    done:<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">11th December 2010, 11:29</div></div><div class="posttext">Use the MUI_INSTALLOPTIONS_READ macro (like you did in function &quot;page5&quot;) instead of the ReadINIStr function.<br />
And you better use the LogicLib library, as said before.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>