<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" UpgradeDLL macro : fails to get version info for VB6 files, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  UpgradeDLL macro : fails to get version info for VB6 files NSIS Discussion" />
	
	<title> UpgradeDLL macro : fails to get version info for VB6 files [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  UpgradeDLL macro : fails to get version info for VB6 files</div>
<hr />
<div class="pda"><a href="t-153681.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=153681">UpgradeDLL macro : fails to get version info for VB6 files</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jimg</div><div class="date">23rd October 2003, 09:05</div></div><div class="posttext">Hi:<br />
I'm new to NSIS. Have installed MakeNSIS v2.0b3 &amp; have included the code from Appendix C in the Modern UI example to distribute a VB6 program. Have installed the latest UpgradeDLL macro &amp; modified the App. C example to use the temp directory accordingly. The compiler fails with the msg &quot;GetDLLVersionLocal: error reading version info from ...&quot; on whichever DLL file I put first in the list (file exists for program to reach GetDLLVersionLocal). The files I'm checking are newly loaded from MS VB6SP5 &amp; I'm compiling on a W2K system. Can't find any info on GetDLLVersionLocal in the NSIS files or a search of the forum. Any info or comment appreciated.<br />
Cheers,<br />
JimG</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jimg</div><div class="date">23rd October 2003, 10:36</div></div><div class="posttext">OK, probelm was that the files were in a different directory &amp; then I needed to use GetDllVersion, not GetDLLversionLocal. There is still an incompatibility with UpgradeDLL &amp; the version of NSIS because GetTempFile fails, with an error of &quot;too many parameters&quot;. I suspect that this is also easily fixed &amp; will check the source code tomorrow. Learning, learning ...<br />
Cheers,<br />
JimG</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd October 2003, 11:49</div></div><div class="posttext">The online GetTempFile is for the latest CVS version, in which GetTempFile does support more parameters. The new UpgradeDLL that uses this new GetTempFile prevents a possible faliure on Windows 9x where rename on reboot doesn't work across different drives.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mikegfrance</div><div class="date">24th February 2004, 11:25</div></div><div class="posttext">I have located this topic as I have exactly the same problem. Does anyone have a script that deals with the problem?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">24th February 2004, 11:37</div></div><div class="posttext">I think that all you need to do is update your copy of NSIS to the latest version.<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">24th February 2004, 11:51</div></div><div class="posttext">The first parameter is the location of the VB files on your system. Make sure that is correct.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mikegfrance</div><div class="date">24th February 2004, 15:46</div></div><div class="posttext">Sound advice guys. <br />
<br />
I found I was confusing when I could use things like $SYSDIR and when not - or rather - when I was describing the location of a file on my machine and when I was describing where it should go on the target machine. Running before I could walk.<br />
<br />
If anyone has a fight with a VB style installation in the future I am happy to share any scripts I have up and running - albeit they might as yet be imperfect.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">24th February 2004, 18:36</div></div><div class="posttext">See the Users Manual for a complete example of VB6 runtime installation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mikegfrance</div><div class="date">25th February 2004, 09:15</div></div><div class="posttext">With respect,<br />
<br />
The example only covers (albeit expertly) the simplest case. Adding DAO (for instance) adds to the number and type of DLL's to be added - with the DAO dll not being placed in the system directory. There are OCX files to consider as well...<br />
<br />
I have seen the ActiveE.exe sample script but have yet to combine that with the rest of a VB distribution.<br />
<br />
Lots to try.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">25th February 2004, 10:45</div></div><div class="posttext">I'm talking about the VB6 runtimes, which are required for every application.<br />
<br />
If you need other components or libraries you will also have to install them, but that is different for every application.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>