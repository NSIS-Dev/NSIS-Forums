<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Read a file Line by Line, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Read a file Line by Line NSIS Discussion" />
	
	<title> Read a file Line by Line [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Read a file Line by Line</div>
<hr />
<div class="pda"><a href="t-281308.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=281308">Read a file Line by Line</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">grobigou</div><div class="date">12th November 2007, 14:23</div></div><div class="posttext">Hello,<br />
<br />
I know this is a frequently question.<br />
I have searched through the forum, but nothing can help me to fix my issues, even This post (http://forums.winamp.com/showthread.php?s=&amp;threadid=95719).<br />
<br />
Actually, in the following code, I just want to open the oemxx.inf files (concerning the drivers) and, in each of those files, i'm looking for the word &quot;Deterministic&quot;.<br />
<br />
The aim is to delete those specifics oemxx.inf files.<br />
<br />
But, in my code, if I use the loop called &quot;Lecture&quot;, the varable $4 won't be the entire line, what is what I want, but it will be each letter of the file.<br />
I'm using the function &quot;StrStr&quot; which search a word in a sentence.<br />
<br />
And, if I just donc write the two lines &quot;Lecture:&quot; and &quot;Lecture&quot;, I mean I don't use the loop &quot;Lecture&quot;, this script will give me the entire line from all oemxx.inf files.<br />
<br />
How can I fix it, in order to be able to have all the lines of all the oemxx.inf files ???<br />
<br />
Thank you !<br />
<br />
Here is my code:<br />
<br />
!include &quot;MUI.nsh&quot;<br />
!define CHAINE &quot;Deterministic&quot;<br />
XPStyle on<br />
Name &quot;Ouverture INI deux boucles&quot;<br />
OutFile &quot;Ouverture INI deux boucles.exe&quot;<br />
<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
Section &quot;Recherche du mot clÃ©&quot;<br />
<br />
DetailPrint &quot;Les Devices sont installÃ©s dans $WINDIR\inf&quot;<br />
SetOutPath $WINDIR\inf<br />
StrCpy $9 0<br />
<br />
  Open:<br />
  FileOpen $3 &quot;$WINDIR\inf\oem$9.inf&quot; r<br />
  MessageBox MB_OK &quot;Ouverture de oem$9.inf - $1&quot;<br />
  IfErrors done1<br />
  <br />
  Lecture:<br />
  FileRead $3 $4<br />
  IfErrors suite<br />
  MessageBox MB_OK &quot;$$4 - $4&quot;<br />
  Push $4<br />
  Push ${CHAINE}<br />
  Call StrStr<br />
  Goto Lecture<br />
  <br />
  suite:<br />
  FileClose $3<br />
<br />
  IntOp $9 $9 + 1<br />
  Goto Open<br />
<br />
  done1:<br />
SectionEnd<br />
<br />
 Function StrStr<br />
 Exch $R1 ; st=tete,vieux$R1, $R1=pointeur<br />
   Exch   ; st=vieux$R1,tete<br />
   Exch $R2 ; st=vieux$R1,vieux$R2, $R2=tete<br />
   Push $R3<br />
   Push $R4<br />
   Push $R5<br />
   StrLen $R3 $R1<br />
   StrCpy $R4 0<br />
   loop:<br />
     StrCpy $R5 $R2 $R3 $R4<br />
     StrCmp $R5 $R1 done<br />
     StrCmp $R5 &quot;&quot; done<br />
     IntOp $R4 $R4 + 1<br />
     Goto loop<br />
<br />
 done:<br />
<br />
<br />
     StrCpy $R1 $R2 &quot;&quot; $R4<br />
     StrCmp $R5 ${CHAINE} +1 +3<br />
     MessageBox MB_OK &quot;Le fichier contient le mot recherchÃ©$\n$\nA la ligne : $R1&quot;<br />
     Goto Next<br />
     MessageBox MB_OK &quot;Le fichier ne contient pas le mot recherchÃ©&quot;<br />
          <br />
     Next:<br />
          <br />
     Pop $R5<br />
     Pop $R4<br />
     Pop $R3<br />
     Pop $R2<br />
     Exch $R1<br />
<br />
 FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th November 2007, 14:54</div></div><div class="posttext">If it is a single character then that usually means the file is not encoded in ASCII but possibly unicode.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>