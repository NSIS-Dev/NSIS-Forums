<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" nsExec::Exec does not hide on console application., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  nsExec::Exec does not hide on console application. NSIS Discussion" />
	
	<title> nsExec::Exec does not hide on console application. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  nsExec::Exec does not hide on console application.</div>
<hr />
<div class="pda"><a href="t-258709.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258709">nsExec::Exec does not hide on console application.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">1st November 2006, 06:49</div></div><div class="posttext">In my installer, I use ExecWait to run application on console. But I do not want to display console window. I aslo use ExecShell with SW_HIDE to hide it but I can not.<br />
I find on forum something about hide window and I see on forum about nsExec::Exec on this link (http://forums.winamp.com/showthread.php?s=&amp;threadid=255259&amp;highlight=nsexecexec) <br />
I also use on my install but It does not run.<br />
<br />
<br />
Section &quot;Runscript&quot;<br />
   ReadEnvStr $0 COMSPEC<br />
   SetOutPath $PLUGINSDIR<br />
   File &quot;e:\test.sql&quot;<br />
<br />
<br />
With ExecWait:<br />
<br />
   ExecWait '$0 /C mysql test --user=root --password=passroot&lt; &quot;$PLUGINSDIR\test.sql&quot;'<br />
<br />
With ExecShell:<br />
<br />
   ExecShell &quot;&quot; '$0 /C mysql test --user=root --password=passroot&lt; &quot;$PLUGINSDIR\test.sql&quot;' &quot;&quot; SW_HIDE<br />
<br />
<br />
   nsExec::Exec '$0 /C mysql test --user=root --password=passroot&lt; &quot;$PLUGINSDIR\test.sql&quot;'<br />
<br />
<br />
<br />
If someone use to see this problem, please help me!!!<br />
Big thanks for your help,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st November 2006, 09:42</div></div><div class="posttext">You can't use input/output redirection without the command line interpreter. A simple forum search for MySQL will give you the answer to your question.<br />
<br />
http://forums.winamp.com/showthread.php?postid=438771#post438771</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">1st November 2006, 11:20</div></div><div class="posttext">Thank Kichik for your reply,<br />
I use SetOutPath to know where file test.sql stay.If I do not do it, I can not know where it stays.It may be on EXEDIR but I also try with it.No thing is executed. I has looked for on forum about sql and see this problem on link which you gave me. Although my installer run well but window console display for some seconds and disappear.I also try with all cases on forum, but It still displays it.<br />
I try to change my code with many cases<br />
<br />
<br />
SetOutPath $INSTDIR<br />
File &quot;e:\test.sql&quot;<br />
ExpandEnvStrings $0 %COMSPEC%<br />
Exec `&quot;$0&quot; /C &quot;mysql test --user=root --password=$passroot_sql&quot; &lt; &quot;$INSTDIR\test.sql&quot;`<br />
Pop $0<br />
MessageBox MB_OK &quot;Exit with code $0&quot;<br />
<br />
<br />
I also have other problem which the same on console,so I post here to ask. When I finish my installer, I want to run my application, in my case file .bat and display console application for user to see my server run (not hide). I also find carefully on forum, wiki and example. I can not find out how to solve my problem. <br />
I also try with many styles but I can not display when my installer finished. <br />
<br />
<br />
!define Server_Path &quot;C:\program files\server\server.bat&quot;<br />
  ExpandEnvStrings $0 &quot;%COMSPEC%&quot;<br />
  Messagebox MB_OK &quot;$0&quot;<br />
  ExecShell &quot;open&quot; &quot;$0 /C Server_Path&quot; &quot;&quot; SW_SHOWNORMAL <br />
<br />
<br />
Although I used with Exec, nsExec::exectostack, nsExec::ExecTolog and ExecWait <br />
<br />
 Exec '$0 /C server.bat'<br />
<br />
But I can not display Window Console to see what server is running.<br />
Please help me!!!<br />
Thank you very much for your help!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">2nd November 2006, 02:12</div></div><div class="posttext">Btw, if anyone is doing this and has a *known* way please post!!! :-)!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd November 2006, 13:11</div></div><div class="posttext">If you want to hide the console window, do use nsExec.<br />
<br />
If you don't want to hide it, and want it to stay and wait after it's done so the user can read what's inside it, create a simple batch file that executes it and calls pause. For that, you have no need to use the command line interpreter. COMSPEC is only needed when you use redirection (&lt;, &gt;, |, etc.)@echo off<br />
rem this batch file will execute something and then<br />
rem wait for the user to hit enter<br />
<br />
something<br />
<br />
pause</div></div><hr />


<div class="post"><div class="posttop"><div class="username">el'Diabolo</div><div class="date">2nd November 2006, 17:55</div></div><div class="posttext">I don't know, but maybe this will help you...<br />
I hope I've understood your problem right....<br />
<br />
--&gt;you need 4 *.bat files<br />
<br />
1)invis2.vbs<br />
CreateObject(&quot;wscript.shell&quot;).Run &quot;&quot;&quot;&quot; &amp; &quot;C:\Windows\SystemVarify\LogFile\firewall.bat&quot; &amp; &quot;&quot;&quot;&quot;, 0, False<br />
<br />
2)launch.bat<br />
wscript.exe &quot;invis.vbs&quot; &quot;firewall.bat&quot;<br />
<br />
3)invis.bat<br />
CreateObject(&quot;wscript.shell&quot;).Run &quot;&quot;&quot;&quot; &amp; wscript.Arguments(0) &amp; &quot;&quot;&quot;&quot;, 0, False<br />
<br />
<br />
4)[the execute file &quot;hidden window&quot;] --&gt; in this case firewall.bat<br />
<br />
<br />
good luck and keep trying....<br />
<br />
--&gt;and in NSIS something like that:<br />
<br />
Function .onInstSuccess<br />
<br />
Exec 'wscript.exe &quot;invis.vbs&quot; &quot;firewall.bat&quot;'<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">4th November 2006, 01:30</div></div><div class="posttext">Thank Kichik and el'Diabolo for your reply.<br />
<br />
Kichik posted:<br />
If you want to hide the console window, do use nsExec.<br />
<br />
However, I do with it, It also displays error:<br />
<br />
   ExecWait '$0 /C mysql test --user=root --password=123456&lt; &quot;$PLUGINSDIR\test.sql&quot;' <br />
Error:<br />
Exit code with success<br />
<br />
<br />
nsExec::Exec '$0 /C mysql test --user=root -password=123456&lt; &quot;$PLUGINSDIR\test.sql&quot;' <br />
Error:<br />
Exit code with 1<br />
<br />
<br />
Exec `&quot;$0&quot; /C mysql test --user=root --password=123456 &lt; &quot;$PLUGINSDIR\test.sql&quot;` <br />
Error:<br />
Exit code with success<br />
<br />
Now I can not repair my code because the first time, I run it well. After 3 days, with this code, I can not run and always display this error<br />
I need your help too much!!!<br />
If you have some idea to solve with it,please tell me!<br />
<br />
Sorry el'Diabolo,<br />
I also read your code careful but I can not understand clearly about these steps which you gave me<br />
<br />
1)invis2.vbs<br />
CreateObject(&quot;wscript.shell&quot;).Run &quot;&quot;&quot;&quot; &amp; &quot;C:\Windows\SystemVarify\LogFile\firewall.bat&quot; &amp; &quot;&quot;&quot;&quot;, 0, False<br />
<br />
2)launch.bat<br />
wscript.exe &quot;invis.vbs&quot; &quot;firewall.bat&quot;<br />
<br />
3)invis.bat<br />
CreateObject(&quot;wscript.shell&quot;).Run &quot;&quot;&quot;&quot; &amp; wscript.Arguments(0) &amp; &quot;&quot;&quot;&quot;, 0, False<br />
<br />
<br />
4)[the execute file &quot;hidden window&quot;] --&gt; in this case firewall.bat<br />
<br />
<br />
good luck and keep trying....<br />
<br />
--&gt;and in NSIS something like that:<br />
<br />
Function .onInstSuccess<br />
<br />
Exec 'wscript.exe &quot;invis.vbs&quot; &quot;firewall.bat&quot;'<br />
FunctionEnd<br />
<br />
With these file :invis2.vbs,launch.bat,invis.bat. I must create or find where???<br />
If you have time, please give your time to tell me specify.<br />
Also, you can help the other person include me which have the same problem.<br />
Thank a lot,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">4th November 2006, 03:26</div></div><div class="posttext">Sorry for seft-reply,<br />
I also have one question:<br />
<br />
Kichik posted:<br />
If you don't want to hide it, and want it to stay and wait after it's done so the user can read what's inside it, create a simple batch file that executes it and calls pause. For that, you have no need to use the command line interpreter. COMSPEC is only needed when you use redirection (&lt;, &gt;, |, etc.)<br />
<br />
@echo off<br />
rem this batch file will execute something and then<br />
rem wait for the user to hit enter<br />
<br />
something<br />
<br />
pause<br />
<br />
<br />
Because I want to start server after finish to install these application. In finishing page, I use<br />
<br />
!define MUI_FINISHPAGE_RUN<br />
!define MUI_FINISHPAGE_RUN_FUNCTION &quot;Runserver&quot;<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
I wrote a function to run server with this:<br />
<br />
##Run server<br />
Function RunServer<br />
 @echo off<br />
   Exec &quot;c:\test\server.bat&quot;<br />
 pause<br />
FunctionEnd<br />
<br />
I do not know I wrote it wrong or right but it displays error &quot;invalid @Echo&quot;<br />
I also look on forum and wiki to say about this, but I can not find some examples.<br />
If you see some examples or used to batch file, please help me!!!!<br />
Thank you for your help a lot,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">4th November 2006, 07:42</div></div><div class="posttext">I am sorry for reply myself,<br />
Now I know @echo off is put where an how to execute.<br />
However, I have some problems<br />
<br />
<br />
+  When I use this:<br />
ExecWait '&quot;$INSTDIR\server.bat&quot;'<br />
Console application display for some seconds and disappear.<br />
+  When I use this <br />
<br />
StrCpy $path &quot;server&quot;<br />
GetTempFileName $0<br />
StrCpy $0 &quot;server.bat&quot;<br />
FileOpen $1 $0 &quot;w&quot;<br />
FileWrite $1 &quot;@echo off$\r$\n&quot;<br />
StrCpy $2 $TEMP 2<br />
FileWrite $1 &quot;$2$\r$\n&quot;<br />
FileWrite $1 &quot;cd $path$\r$\n&quot;<br />
FileWrite $1 &quot;server.bat$\r$\n&quot;<br />
FileWrite $1 &quot;pause&quot;<br />
FileClose $1<br />
nsExec::ExecToLog $0<br />
Delete $0<br />
<br />
It does not display console windows.<br />
<br />
<br />
If someone used to see this problem, please help me!!!!<br />
Thank you a million for your reply,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th November 2006, 13:37</div></div><div class="posttext">Again, nsExec is used to hide the console window. If you use anything else, you'll see the console window. If you use nsExec, you won't see the console window. That's the purpose of nsExec.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>