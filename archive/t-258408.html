<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" FileWrite throws arbitrary error, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  FileWrite throws arbitrary error NSIS Discussion" />
	
	<title> FileWrite throws arbitrary error [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  FileWrite throws arbitrary error</div>
<hr />
<div class="pda"><a href="t-258408.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258408">FileWrite throws arbitrary error</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">27th October 2006, 17:59</div></div><div class="posttext">I have opened a file like so:<br />
<br />
FileOpen $4 &quot;$EXEDIR\${NAME}.log&quot; w <br />
<br />
No problem there. But when I write a line to the file, it indeed writes the line, but throws an error flag.<br />
<br />
<br />
${time::GetLocalTime} $R0<br />
FileWrite $4 &quot;$R0 This is some note $\n&quot; <br />
<br />
So the open/append and writing works, but IfErrors is set for some reason. I tried IfErrors after &quot;time&quot;, but that wasn't it. Ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th October 2006, 18:05</div></div><div class="posttext">Are you sure it's not time::GetLocalTime that sets the error flag? You should always call ClearErrors before calling the instruction that you wish to test with IfErrors.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">27th October 2006, 21:50</div></div><div class="posttext">Yes. I am entirely sure. I broke the lines apart with IfErrors, and time did not throw a flag (and IfErrors performs ClearErrors)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th October 2006, 22:15</div></div><div class="posttext">Well, FileWrite only sets the error flag if the handle is invalid or WriteFile returns an error code. So, unless time corrupts $4 or something else sets the error flag, there's a disk error and that's very unlikely. Can you attach the script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">28th October 2006, 09:46</div></div><div class="posttext">Sure. But it is a long script. Btw, I opened the file using a function, and write to it outside of the function. I doubt that matters but who knows, I've managed to corrupt the stack with execdos.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th October 2006, 10:57</div></div><div class="posttext">I don't see any FileWrite accompanied with IfErrors in that script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">28th October 2006, 17:20</div></div><div class="posttext">Check procedure ReadINI.<br />
<br />
I wanted to put in FileWrites all throughout it, but it kept of throwing errors there. I removed all the FileWrites and substituted MessageBoxes.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th October 2006, 17:24</div></div><div class="posttext">I can't see in that script if you've really used ClearErrors and IfErrors correctly and there's something else. That's not the script that reproduces the problem. And if it is, then the problem is that you don't have ClearErrors before FileWrite.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>