<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" HideWindow Doesn't work!, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  HideWindow Doesn't work! NSIS Discussion" />
	
	<title> HideWindow Doesn't work! [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  HideWindow Doesn't work!</div>
<hr />
<div class="pda"><a href="t-296755.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=296755">HideWindow Doesn't work!</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Jennifer K</div><div class="date">1st September 2008, 12:10</div></div><div class="posttext">I wrote an installer based on the makensis.nsi example.<br />
<br />
Function PageLeaveReinstall was copied verbatim, unmodified (except for the registry path for &quot;UninstallString&quot;).<br />
<br />
But HideWindow inside that function doesn't work!<br />
<br />
Function PageLeaveReinstall<br />
<br />
  ${NSD_GetState} $R2 $R1<br />
<br />
  StrCmp $R0 &quot;1&quot; 0 +2<br />
    StrCmp $R1 &quot;1&quot; reinst_uninstall reinst_done<br />
<br />
  StrCmp $R0 &quot;2&quot; 0 +3<br />
    StrCmp $R1 &quot;1&quot; reinst_done reinst_uninstall<br />
<br />
  reinst_uninstall:<br />
  ReadRegStr $R1 HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\NSIS&quot; &quot;UninstallString&quot;<br />
<br />
  ;Run uninstaller<br />
  HideWindow<br />
<br />
    ClearErrors<br />
    ExecWait '$R1 _?=$INSTDIR'<br />
<br />
    IfErrors no_remove_uninstaller<br />
    IfFileExists &quot;$INSTDIR\makensis.exe&quot; no_remove_uninstaller<br />
<br />
      Delete $R1<br />
      RMDir $INSTDIR<br />
<br />
    no_remove_uninstaller:<br />
<br />
  StrCmp $R0 &quot;2&quot; 0 +2<br />
    Quit<br />
<br />
  BringToFront<br />
<br />
  reinst_done:<br />
<br />
FunctionEnd<br />
<br />
When I click the &quot;Uninstall before installing&quot; radio button, the uninstaller wizard comes up but if I drag it, the installer wizard becomes visible and I can click it and even see how it completes installation before the poor uninstaller even has a chance to start.<br />
<br />
Is this a known bug in nsis?<br />
<br />
Tx,<br />
Jen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jennifer K</div><div class="date">1st September 2008, 16:35</div></div><div class="posttext">First let me correct a mistake in my listing above. Instead of<br />
ExecWait '$R1 _?=$INSTDIR' <br />
I actually wrote<br />
ExecWait '$R1' <br />
and that was the problem.<br />
<br />
As soon as I fixed my code to be exactly what was in makensis.nsi:<br />
ExecWait '$R1 _?=$INSTDIR' <br />
It started behaving as I wanted: Install doesn't start running before Uninstall is complete.<br />
<br />
This is weird. I don't understand this _? thing: I read the entire 4.9.1.4 ExecWait documentation and didn't find any hint  as to what it does.<br />
<br />
What does _? do?<br />
<br />
Tx,<br />
Jen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">1st September 2008, 21:11</div></div><div class="posttext">It's all in help file (http://nsis.sourceforge.net/Docs/Chapter3.html#3.2.2):<br />
_?= sets $INSTDIR. It also stops the uninstaller from copying itself to the temporary directory and running from there. It can be used along with ExecWait to wait for the uninstaller to finish. It must be the last parameter used in the command line and must not contain any quotes, even if the path contains spaces.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jennifer K</div><div class="date">1st September 2008, 21:39</div></div><div class="posttext">Thanks! I did search the NSIS User Manual but couldn't find any mention of it. Apparently the CHM search and index capabilities are not that great.<br />
<br />
Now, the help file says that _?= sets $INSTDIR. This is understandable in a statement like<br />
ExecWait '$R1 _?=$INSTDIR' <br />
But what happens if I writeExecWait '$R1 _?=$MYBELOVEDVARIABLE' <br />
Will it also set $INSTDIR or will it set $MYBELOVEDVARIABLE?<br />
<br />
Also, where does the weird syntax '_?=' come from?<br />
Is it an assignment to special variable named '_?' ?<br />
Or is it simply an atomic construct to be used as is?<br />
<br />
Tx,<br />
Jen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th September 2008, 11:50</div></div><div class="posttext">The second will not set $MYBELOVEDVARIABLE. Think about it, the executed installer will not even know the command line came from $MYBELOVEDVARIABLE as it will be replaced with its content.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>