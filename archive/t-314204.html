<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" launch program at completion without admin permissions, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  launch program at completion without admin permissions NSIS Discussion" />
	
	<title> launch program at completion without admin permissions [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  launch program at completion without admin permissions</div>
<hr />
<div class="pda"><a href="t-314204.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=314204">launch program at completion without admin permissions</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Beiley</div><div class="date">28th October 2009, 00:33</div></div><div class="posttext">I'm using this to launch my app when the setup finishes:<br />
<br />
!define MUI_FINISHPAGE_RUN &quot;$INSTDIR\RemindMe.exe&quot;<br />
<br />
The problem is that my setup program is running with admin permission level (which I need), but it then launches my program with these elevated permission levels.  I want to launch my program with the permission levels manifested in the application (regular).<br />
<br />
I tried using MUI_FINISHPAGE_RUN_FUNCTION with Exec or ExecShell instead, but both of those also launched my app with admin permissions.<br />
<br />
Any ideas how to do this?<br />
<br />
Thanks,<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">28th October 2009, 01:56</div></div><div class="posttext">I use the UAC plugin to do this. Some of my installer runs with administrator privileges and some at the user's normal level; at the end the installer runs a program with the user's privileges.<br />
<br />
http://nsis.sourceforge.net/UAC_plug-in<br />
<br />
Be sure to read the UAC plugin's documentation and look at the example scripts before trying to use it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Beiley</div><div class="date">28th October 2009, 02:17</div></div><div class="posttext">I found/tried the SAFER plug-in.  This seems to work for me, but I had 2 questions/concerns:<br />
<br />
1) Since the SAFER.dll is dependent on CreateProcessAsUser() and that function isn't available until XP, how will this be able to work on OS's like 98?  Even if you use SAFER::SupportsSAFER it seems the DLL won't be able to load for even this call on 98?  I don't have easy access to 98 to test it.<br />
<br />
2) I have to specify a permission level (NORMAL/CONSTRAINED).  Is this starting my app exactly the same way as I have manifested in my app?<br />
<br />
Thanks,<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Beiley</div><div class="date">28th October 2009, 02:26</div></div><div class="posttext">Hi pengyou,<br />
<br />
Thanks for the pointer to UAC.  I'll check it out...<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">28th October 2009, 13:57</div></div><div class="posttext">Beiley: CreateProcessAsUser also exists on 2000, the SAFER api itself does not IIRC, but that is besides the point, the SAFER api was not updated for Vista and it will not do what you want on NT6+, so, if you want to enter a world of pain, use the UAC plugin, or if you want to take the easy way out, just disable the run checkbox</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Beiley</div><div class="date">28th October 2009, 15:56</div></div><div class="posttext">Thanks Anders.  I think I'll just leave it as is, and let my app launch as admin.  It works fine as admin too, but I just thought it cleaner to launch with normal permissions.<br />
<br />
Thanks again,<br />
Mark</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>