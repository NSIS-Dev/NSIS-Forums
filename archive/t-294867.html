<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait crashes on Vista, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait crashes on Vista NSIS Discussion" />
	
	<title> ExecWait crashes on Vista [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait crashes on Vista</div>
<hr />
<div class="pda"><a href="t-294867.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=294867">ExecWait crashes on Vista</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">simulation</div><div class="date">21st July 2008, 18:06</div></div><div class="posttext">Hi Guys,<br />
<br />
I'm looking for some advice on traking a crash problem on Vista only. <br />
<br />
Section4<br />
ExecWait '&quot;t:\batch\cgdcompile-02.cmd&quot;'<br />
SectionEnd<br />
<br />
My installer has 5 sections and it crashes consistantly on the 4th section when I run all the sections. If just run the forth section it runs fine.<br />
<br />
All I can think is that something I am doing in an earlier section is having an adverse effect on the Exec command. These is over 1000 lines in the script, so I am relucant to post it and I'm sure you won't want to read that lot :)<br />
<br />
When execwait is run the installer crashes and a CMD.EXE (without a window)is left as a process?<br />
<br />
I have tried exec, execwait, nsExec::ExecToLog etc.<br />
<br />
<br />
I can only think that XP is handling any memory issues better than Vista? Does anyone have any ideas as what could cause this situation or what I should be looking for?<br />
<br />
Any tips greatfully recieved.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">21st July 2008, 18:35</div></div><div class="posttext">I don't know if Exec/ExecWait was ever intended to call Batch files. I think it's for executables (.exe) in first case! Same applies to nsExec. This might be the cause of the problem, but I'm not sure. Just speculation...<br />
<br />
What if you do it like this:<br />
ExecWait '&quot;$SYSTEM\cmd.exe&quot; &quot;$INSTDIR\Batchfile.cmd&quot;'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">simulation</div><div class="date">21st July 2008, 20:27</div></div><div class="posttext">Thanks for the quick reply.<br />
<br />
I haven't tried that today, but I did have a similar issue a couple of months ago and it didn't help.<br />
<br />
I'll give it another go anyway, but hope to hear from anyone else.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st July 2008, 21:21</div></div><div class="posttext">You should use:<br />
<br />
ReadEnvStr $R0 COMSPEC<br />
nsExec::Exec `&quot;$R0&quot; /C &quot;$INSTDIR\file.bat&quot;`<br />
Pop $R0<br />
<br />
Also is it completely necessary to use a batch file? Most if not all of what can be done in a batch can be done in NSIS code removing the dependency on command prompt.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">simulation</div><div class="date">21st July 2008, 23:09</div></div><div class="posttext">This particular installer is used for automated testing which clears the installed product and installs a new clean version. It then starts a couple of batch files to copy additional test files and start the application many times  with different script files.<br />
<br />
The reason I wish to call a batch file is that it can be changed by follow workers who are not familiar with NSIS and wish to add additional tests or parts to the batch file without recompiling the installer.<br />
<br />
This method has has worked well for several years on XP until Vista came along and started playing up. The crashing is not consistent and can vary from PC to PC. We run tests overnight on 8 XP machines which never fail and 2 Vista machines which are giving me a headache.<br />
<br />
The batch file can also be used for tempoary changes commands like if %COMPUTERNAME%==FRED ..... which gives everyone a degree of flexability.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st July 2008, 23:45</div></div><div class="posttext">You could also try:<br />
<br />
ReadEnvStr $R0 COMSPEC<br />
ExecWait `&quot;$R0&quot; /C &quot;$INSTDIR\file.bat&quot;` $R0<br />
<br />
or possibly:<br />
<br />
ExecShell open $INSTDIR\file.bat<br />
<br />
Just some tips: Use nsExec::ExecToLog if you like the batch output in the install log window. Use the above nsExec code but with /K not /C to keep the batch window open after execution.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>