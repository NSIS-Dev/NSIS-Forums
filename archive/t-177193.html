<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Using a nsis installer with mIRC, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Using a nsis installer with mIRC NSIS Discussion" />
	
	<title> Using a nsis installer with mIRC [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Using a nsis installer with mIRC</div>
<hr />
<div class="pda"><a href="t-177193.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=177193">Using a nsis installer with mIRC</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">DarkAkuma</div><div class="date">19th April 2004, 06:57</div></div><div class="posttext">Anyone have any advice on using nsis with mIRC? More specificly, im using a nsis installer to install a mIRC script ini file, and want my installer to properly load the script into mIRC. I first tried useing WriteINIStr, but ran into a problem with the way values are stored within mIRC ini's. Alot of the values are store with a entry name like n1=, n23=, n745=, or whatever. I need it to see what the last n* entry name is in the [rfiles] section of the mirc.ini, and basicly make the entry for my srcipt use the next number up, like:<br />
<br />
if the last entry anme and value was:<br />
<br />
n21=SomeScript.ini<br />
<br />
id want mine to be:<br />
<br />
n22=MyScriptDir/MyScript.ini<br />
<br />
If im missing something, due to my little nsis experiance, that could help me. Or if theres a totaly different way to do this. Please help me out.<br />
<br />
I looked into SendMessage too, thinking i may be able to use that to preform a command in mirc to load the script. But i dont understand it to well, so i dont even know if im interperting it right or not.<br />
<br />
So anyone have any advice on getting my nsis installer to load my script into mirc after its installed? Preffered it to be done while mirc is closed, or both closed and open. Just while its open may complicate my install more then what im wanting. Not sure yet. Im tired, and burnt out right now. need sleep.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">19th April 2004, 09:11</div></div><div class="posttext">Create a loop that reads every key until it finds the last one.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">19th April 2004, 13:25</div></div><div class="posttext">isn't there a enum-function available? like with registry-keys?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">19th April 2004, 13:27</div></div><div class="posttext">Yes, but you'll have to use the System plug-in.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DarkAkuma</div><div class="date">19th April 2004, 20:44</div></div><div class="posttext">Any help on finding the codeing commands i need to know to use a loop, in the help file? Or the lines of code themselves to do it?<br />
<br />
Thats exactly what id do with mirc scripting if i ran into this problem, but when i looked through the nsis help files to find any info that might do that, i didnt find anything. =(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">19th April 2004, 21:09</div></div><div class="posttext">You can easily create a loop using a label and a Goto command.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DarkAkuma</div><div class="date">20th April 2004, 04:50</div></div><div class="posttext">Ok. I'm just not getting this. Only been useing nsis for about 2 days now, and how to do this just isnt makeing sence. As bad as the help file was for a tutorial with mirc, the help file for nsis is about 5 times worse. I just dont understand codeing until i see an example, or it used in a script. And ive done a bunch of searching, but cant find anything that will help me understand this.<br />
<br />
Can anyone help me out here, and give me the lines i need?<br />
<br />
To sum it up again. When my install is run, i need it to read mirc.ini, look at the [rfiles] section, and see what the last n1, n23, n65, type number is in that section, and write to the ini in that section, n plus the next number up like &quot;n45=MyScriptDir/MyScript.ini&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">20th April 2004, 11:01</div></div><div class="posttext">The NSIS Archive contains many script examples. Example of a loop:Var COUNT<br />
Var VALUE<br />
<br />
loop:<br />
<br />
  IntOp $COUNT $COUNT + 1<br />
  ReadIniStr $VALUE &quot;myini.ini&quot; &quot;section&quot; &quot;n$COUNT&quot;<br />
  StrCmp $VALUE &quot;&quot; done loop<br />
  <br />
done:<br />
<br />
  MessageBox MB_OK $COUNT</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DarkAkuma</div><div class="date">20th April 2004, 21:24</div></div><div class="posttext">Thanks. Finaly got it working. Even put in a Check to make sure the entry for my ini isnt allready there from previous versons of my script. Seems to be working as intended. Heres how i have it now. Let me know if anything is done wrong, or if theirs any redundancy.<br />
<br />
loop:<br />
<br />
  IntOp $COUNT $COUNT + 1<br />
  ReadIniStr $VALUE &quot;$INSTDIR\mirc.ini&quot; &quot;rfiles&quot; &quot;n$COUNT&quot;<br />
  StrCmp $VALUE &quot;MyScriptDir\MyScript.ini&quot; done2 loop2<br />
<br />
loop2:<br />
<br />
  StrCmp $VALUE &quot;&quot; done loop<br />
  <br />
done:<br />
  WriteINIStr &quot;$INSTDIR\mirc.ini&quot; &quot;rfiles&quot; &quot;n$COUNT&quot; &quot;MyScriptDir\MyScript.ini&quot;<br />
<br />
done2:</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>