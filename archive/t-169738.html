<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Plugin help needed, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Plugin help needed NSIS Discussion" />
	
	<title> Plugin help needed [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Plugin help needed</div>
<hr />
<div class="pda"><a href="t-169738.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=169738">Plugin help needed</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">17th February 2004, 11:43</div></div><div class="posttext">I'm working on a new plugin for NSIS and have a couple of questions.  <br />
<br />
First, is there a way to convert a handle into a string so it can be passed to NSIS and then back into a handle when needed?  I'm using c/c++ to program this plugin.<br />
<br />
Or alternatively is there a way to create a *global* variable that different instances of the dll can access, e.g. normal global vars don't work when you call the plugin the second time the variable is reinitialized.<br />
<br />
And finally, this is not really important but would be usefull none the less, is there a way for the plugin itself to specify that it should not be unloaded and then maybe have a special function which unloads the dll.<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">17th February 2004, 15:23</div></div><div class="posttext">okay, I'll try to help you:<br />
convert a handle into a string. Yeah, Nsis only accept Strings (Char) to be used in popstring. When I need to input a number, I inputed like string, for example &quot;512&quot;. Since &quot;512&quot; is a string, you can easy use it with popstring to use it in the code, then I use my_atoi function (you can get it in system plugin source code) to convert the string-&gt;number</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">17th February 2004, 16:48</div></div><div class="posttext">I think he is talking about C. You should read a tutorial that explains you how to work with pointers. A single Google search will help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">17th February 2004, 23:20</div></div><div class="posttext">I found the functions to pop/push integer to the stack in the system dll source code. :D <br />
<br />
However I found the the definition of a HANDLE is a 'pointer to void' and not a 'pointer to int'.  This does not make sence to me as a always assumed that void is just that 'nothing'. :weird: <br />
<br />
So any ideas of what I should use to convert a HANDLE to int or string and then back again?<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">17th February 2004, 23:50</div></div><div class="posttext">HANDLE to string try sprintf (http://www.cplusplus.com/ref/cstdio/sprintf.html) ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">18th February 2004, 01:56</div></div><div class="posttext">Thanks Lobo Lunar this line worked great sprintf(sThread, &quot;%u&quot;, hThread); However how do I convert that value back into HANDLE when I pop it again later in another call to the plugin.  Either from int or char?<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eccles</div><div class="date">18th February 2004, 13:34</div></div><div class="posttext">For a smaller .DLL, use wsprintf.<br />
<br />
To convert the other way, find and use my_atoi, as mentioned earlier.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th February 2004, 11:28</div></div><div class="posttext">It is possible to create global variables using shared DLL sections. There is an article on CodeProject I think.<br />
<br />
To force the DLL not to unload, load it yourself again using LoadLibrary. You'll probably have to add some more code than that, but it should be possible with some research.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>