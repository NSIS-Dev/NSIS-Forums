<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Variable output file, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Variable output file NSIS Discussion" />
	
	<title> Variable output file [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Variable output file</div>
<hr />
<div class="pda"><a href="t-93943.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=93943">Variable output file</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">toopriddy</div><div class="date">9th July 2002, 19:01</div></div><div class="posttext">I am working on a cross platform project and would like NSIS to generate an output file like d-builder-0.0.4.exe where the 0.0.4 is the current version number. This version number is in a file all by itself for me to compile into my code<br />
<br />
I have tried to come up with a script to make NSIS read this file to get the version number and create an output file with that version number in it<br />
<br />
like:<br />
<br />
FileOpen $8 ../version r<br />
FileRead $8 $9<br />
FileClose $8<br />
<br />
OutFile &quot;d-builder-$8.exe&quot;<br />
<br />
<br />
but File* commands have to be in a section and the OutFile is not valid in a section...<br />
<br />
Any suggestions?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">veekee</div><div class="date">9th July 2002, 19:09</div></div><div class="posttext">NSIS installation script uses defines !<br />
<br />
!define VER_MAJOR 1<br />
!define VER_MINOR 98<br />
nsis${VER_MAJOR}${VER_MINOR}_fr.exe<br />
<br />
:D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">9th July 2002, 22:01</div></div><div class="posttext">Originally posted by toopriddy <br />
<br />
FileOpen $8 ../version r<br />
FileRead $8 $9<br />
FileClose $8<br />
<br />
OutFile &quot;d-builder-$8.exe&quot;<br />
<br />
<br />
The FileRead does not occur when you compile the script, but when you run the installer.  The easiest way, is to write a stub installer that reads the file, and then calls makensis with the define values on the command line.  Then the script can read the define values to get the OutFile name.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">toopriddy</div><div class="date">10th July 2002, 18:41</div></div><div class="posttext">ok, i can live with that, but when i run the comand line version with the define in the command line... it still does not use the define (it will use the define if i explicitly put the define in the script, but that is not what i want)<br />
<br />
command line:<br />
&quot;C:\Program Files\NSIS\makensis.exe&quot; /V4 /CD d-builder.nsi /DDBUILDERVERSION=0.0.4<br />
<br />
<br />
script:<br />
<br />
Name &quot;Distributed Builder&quot;<br />
OutFile &quot;d-builder-${DBUILDERVERSION}.exe&quot;<br />
<br />
<br />
it notices my command line define, but does not substitute the variable for the value<br />
<br />
I tried just putting a !define DBUILDERVERSION &quot;0.0.4&quot; above the OutFile and it works fine, so the problem it just the command line define</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">10th July 2002, 21:23</div></div><div class="posttext">Uservariables and defines only get their value at runtime. When you compile, the variables will not have a value yet and that's why you can't use them in compiling commands like OutFile and File.<br />
<br />
-Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th July 2002, 22:11</div></div><div class="posttext">Your command line define doesn't work because you specify it after the name of the script to compile. Don't ask me why, but this is how it is...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>