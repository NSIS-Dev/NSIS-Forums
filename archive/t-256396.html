<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" batch file execution, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  batch file execution NSIS Discussion" />
	
	<title> batch file execution [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  batch file execution</div>
<hr />
<div class="pda"><a href="t-256396.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=256396">batch file execution</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Anselmus</div><div class="date">28th September 2006, 12:22</div></div><div class="posttext">hi folks,<br />
<br />
i'm new to nsis and desperatly trying to get my script running for the whole morning now.<br />
<br />
i'm trying to run a batch file with one parameter (\service.bat install).<br />
<br />
i tried ExecWait and ExecShell and every possible combination of quotation marks.<br />
<br />
i even created a new batchfile with no parameter to call the first one from within this second batch file. still it won't work. dos-box comes up for a few milliseconds and disappears.<br />
<br />
can someone help me out with thatone?<br />
<br />
thanks<br />
stephan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th September 2006, 12:25</div></div><div class="posttext">nsExec::Exec '&quot;$EXEDIR\BATCH.bat&quot; &quot;params&quot;'<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">28th September 2006, 13:06</div></div><div class="posttext">Console window means file found by system and started. Add Pause to you bat after every line to see output or use output redirection. ExecWait is better for debugging, but finally use nsExec (hides console).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anselmus</div><div class="date">28th September 2006, 13:48</div></div><div class="posttext">thanks for the fast reply. i tried it the way Afrow UK suggested. still it won't work... =(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anselmus</div><div class="date">28th September 2006, 14:25</div></div><div class="posttext">somehow there seems to be a problem with executing the second batch file i created (set_service.bat) which looks like this:<br />
<br />
@echo off<br />
CALL service.bat install<br />
ECHO end of set_service.bat<br />
PAUSE<br />
<br />
<br />
if i execute it manually (command line) or execute it by doubleclicking it works fine<br />
<br />
but with the the ExecWait Command it wont do it outputs that it cannot find service.bat, even though they are in the same directory...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th September 2006, 12:40</div></div><div class="posttext">Use SetOutPath to set the working directory.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anselmus</div><div class="date">4th October 2006, 15:57</div></div><div class="posttext">i tried this:<br />
<br />
<br />
SetOutPath &quot;$INSTDIR\AgroKONNEKTOR\bin&quot;<br />
nsExec::Exec '&quot;COMMAND&quot; &quot;$SYSDIR /Y /K $INSTDIR\AgroKONNEKTOR\bin\set_service.bat&quot;'<br />
<br />
<br />
and a lot of different versions, yet it wont run.<br />
<br />
gtx<br />
anselmus</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anselmus</div><div class="date">4th October 2006, 16:26</div></div><div class="posttext">cant anyone help me out with this? i'm getting mad on this one... :(<br />
<br />
to make my problem a beit clearer: i'm trying to run the service installer delivered with tomcat 5.5.17 (bin\service.bat) which requires to be run as: &quot;service install&quot; or &quot;service.bat install&quot;<br />
<br />
any suggestions are most welcome</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mr Inches</div><div class="date">5th October 2006, 12:00</div></div><div class="posttext">The command you are trying to run is no good. :(<br />
<br />
Try this code:<br />
<br />
SetOutPath &quot;$INSTDIR\AgroKONNEKTOR\bin&quot;<br />
nsExec::Exec &quot;CMD&quot; &quot;/C $INSTDIR\AgroKONNEKTOR\bin\set_service.bat&quot;<br />
<br />
The /C switch means 'run the following program under the new command shell, then exit the command shell and return to the program that launched you when it completes'.<br />
<br />
The /K switch means 'run the following program under the new command shell and then leave the command shell running after it completes until it is manually exited by typing &quot;exit&quot;' - (K)eep.<br />
<br />
There is no /Y switch supported by CMD.EXE or COMMAND.COM.<br />
<br />
Duncan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anselmus</div><div class="date">5th October 2006, 12:11</div></div><div class="posttext">hi duncan,<br />
<br />
thanks for the reply, but it does not work. dont ask my why.<br />
<br />
but i seem to have solved tho problem in a different way. now, i let nsis create the batch file instead of having a static batch file: it looks like this:<br />
<br />
    SetOutPath &quot;$INSTDIR\AgroKONNEKTOR\bin&quot;<br />
    StrCpy &quot;$1&quot; &quot;$INSTDIR&quot;<br />
    StrCpy $1 $1 2<br />
    MessageBox MB_OK &quot;$1&quot;<br />
    FileOpen &quot;$0&quot; &quot;set_service.bat&quot; &quot;w&quot;<br />
    ;FileWrite &quot;$0&quot; &quot;@ECHO OFF$\r$\n&quot;<br />
    FileWrite &quot;$0&quot; &quot;$1$\r$\n&quot;<br />
    FileWrite &quot;$0&quot; &quot;cd $INSTDIR\AgroKONNEKTOR\bin$\r$\n&quot;<br />
    FileWrite &quot;$0&quot; &quot;CALL service install$\r$\n&quot;<br />
    ;FileWrite &quot;$0&quot; &quot;pause&quot;<br />
    FileClose &quot;$0&quot;<br />
    MessageBox MB_OK &quot;wrote setter&quot;<br />
    ExecWait &quot;set_service.bat&quot;<br />
<br />
<br />
the message boxes and pause command are for debugging purposes</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aceld</div><div class="date">17th April 2008, 20:14</div></div><div class="posttext">I was stuck at the same situation, and your solution saved my life!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>