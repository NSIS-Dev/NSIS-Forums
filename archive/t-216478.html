<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Apply Windows Theme, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Apply Windows Theme NSIS Discussion" />
	
	<title> Apply Windows Theme [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Apply Windows Theme</div>
<hr />
<div class="pda"><a href="t-216478.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=216478">Apply Windows Theme</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">19th May 2005, 22:34</div></div><div class="posttext">i did a little research on msdn and google, but couldn't get any helpful information. what i'm trying to do is to install and apply a theme for windows xp (i.e. $WINDIR\Resources\Themes\Windows Classic.theme).<br />
<br />
when you do it over the registry, the theme won't be installed until next reboot. i'm not sure if one can install it using anything related to rundll32.exe shell32.dll,Control_RunDLL desk.cpl without pressing an extra button (OK or Apply) to apply it.<br />
<br />
there might be a system-call, but i couldn't find anything (this (http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/userex/themesinstaller.asp)  might be a hint).<br />
<br />
can anyone help me?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ZmAn3</div><div class="date">20th May 2005, 08:39</div></div><div class="posttext">i know this has to be possible style xp does it and ive seen a self extracting copy of windows 3000 theme somewhere at one point that did it too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">20th May 2005, 08:56</div></div><div class="posttext">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/userex/refentry.asp<br />
<br />
<br />
But I think easy to use:ExecShell &quot;open&quot; &quot;$WINDIR\Resources\Themes\Windows Classic.theme&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ZmAn3</div><div class="date">20th May 2005, 09:15</div></div><div class="posttext">Instructor,<br />
<br />
 that just brings up the dialog to change the theme it doesnt actually apply it</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">20th May 2005, 09:58</div></div><div class="posttext">that just brings up the dialog to change the theme it doesnt actually apply itI know. See link above.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">20th May 2005, 14:15</div></div><div class="posttext">is it SetWindowTheme to use or do you suggest using ExecShell and CloseThemeData?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">21st May 2005, 09:35</div></div><div class="posttext">Yathosho, you can use API or ExecShell.<br />
<br />
I tried to write a code, but have faced a problem with API - $1 is NULL:<br />
System::Call 'user32::GetDesktopWindow()i .r0'<br />
System::Call 'uxtheme::OpenThemeData(i r0, t L&quot;StartPanel&quot;)i .r1'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">21st May 2005, 12:37</div></div><div class="posttext">Try this:<br />
Name &quot;ChangeStyleXP&quot;<br />
OutFile &quot;ChangeStyleXP.exe&quot;<br />
<br />
!include &quot;FileFunc.nsh&quot;<br />
!insertmacro GetFileName<br />
<br />
!define BM_CLICK 0x00F5<br />
!define WM_CLOSE 0x0010<br />
<br />
Section<br />
	IfFileExists &quot;$WINDIR\Resources\Themes\Windows Classic.theme&quot; 0 error<br />
	ExecShell 'open' '$WINDIR\Resources\Themes\Windows Classic.theme'<br />
	FindWindow $0 '#32770' '' $HWNDPARENT<br />
	StrCpy $3 0<br />
<br />
	wait:<br />
	IntOp $3 $3 + 1<br />
	StrCmp $3 50 error<br />
	Sleep 100<br />
	System::Call 'user32::GetForegroundWindow()i .r1'<br />
	StrCmp $0 $1 wait<br />
<br />
	System::Call 'user32::GetWindowModuleFileName(i r1, t .r2, i ${NSIS_MAX_STRLEN})'<br />
	${GetFileName} '$2' $2<br />
	StrCmp $2 'comctl32.dll' 0 wait<br />
<br />
	HideWindow<br />
	GetDlgItem $2 $1 1<br />
	SendMessage $2 ${BM_CLICK} 0 0<br />
	MessageBox MB_OK &quot;Success&quot; IDOK quit<br />
<br />
	error:<br />
	MessageBox MB_OK &quot;Error&quot;<br />
<br />
	quit:<br />
	quit<br />
SectionEndScript use header (http://forums.winamp.com/attachment.php?s=&amp;postid=1647312)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ZmAn3</div><div class="date">22nd May 2005, 06:31</div></div><div class="posttext">now that works thanks ive been looking for that myself</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ZmAn3</div><div class="date">23rd May 2005, 01:03</div></div><div class="posttext">you should post that in the archive</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>