<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Weird behavior of ExecWait, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Weird behavior of ExecWait NSIS Discussion" />
	
	<title> Weird behavior of ExecWait [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Weird behavior of ExecWait</div>
<hr />
<div class="pda"><a href="t-220670.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=220670">Weird behavior of ExecWait</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">SneakySly</div><div class="date">4th July 2005, 21:59</div></div><div class="posttext">Hello,<br />
The software Im installing using NSIS consists in windows services. When installing, once the files are copied I call the following and all works very well:<br />
<br />
; Install the service<br />
ExecWait &quot;installutil MyService.exe&quot;<br />
<br />
; Start the service<br />
ExecWait &quot;net start $\&quot;My Windows Service$\&quot;&quot;<br />
<br />
Then comes the time of uninstalling, I want the uninstaller to stop the service and remove it from the windows services. So I do the following:<br />
<br />
ExecWait 'net stop $\&quot;My Windows Service$\&quot;'<br />
Sleep 1000<br />
<br />
; Uninstall the service<br />
ExecWait &quot;installutil MyService.exe /u&quot;<br />
Sleep 1000<br />
<br />
Doing so, the service stops as expected. However, it does not get uniinstalled using installutil as expected. NSIS seems just to skip this step the service is never removed from the list of services installed in Windows.<br />
<br />
Anyone got an idea why would this happen?<br />
Thanks for your help,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">5th July 2005, 07:04</div></div><div class="posttext">1. If we are talking about .net\framework installutil.exe, you can also use one of DOS plug-ins, nsExec (included to NSIS package, program files\nsis\contrib\nsexec) or ExecDos (http://nsis.sourceforge.net/wiki/ExecDos), this allow to hide dos window.<br />
2. If you don't see any output in the DOS window on ExecWait call, this means that executable not found. PATH env. var on my comp not includes framework folder, in uninstaller it is very usefull to set full path, for example<br />
ExecWait &quot;'$WINDIR\Microsoft.NET\Framework\v1.1.4322\installutil.exe' MyService.exe /u&quot;<br />
(or extract framework path from registry).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SneakySly</div><div class="date">5th July 2005, 22:19</div></div><div class="posttext">1. Thanks for the tip, it does look nicer and more professional without the DOS window.<br />
I used nsExec::ExecToLog instead, now all the output of the execution is in the details instead, pretty nice :).<br />
<br />
2. Using full paths, it worked well. Looks like you were right. What I had done is include the installutil.exe in the package so it could be called from the installation folder (wouldnt have to look for the .Net path). It works fine for installing the service, it just doesnt work when uninstalling (couldnt find the reason why).<br />
<br />
nsExec::ExecToLog &quot;installutil MyService.exe&quot;<br />
works all good <br />
<br />
ExecWait &quot;installutil MyService.exe /u&quot;<br />
wont work... So it looks like using the option &quot;/u&quot; screws up smtg and I couldnt figure out what.<br />
<br />
Anyways, thanks for the tip I guess I will just retrieve the .NET framework path and do it the right way.<br />
<br />
Regards,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DonChunior</div><div class="date">23rd June 2010, 15:03</div></div><div class="posttext">I know that the tread is from a long time ago, but I had exactely the same problem SneakySly.<br />
The reason for not working of ExecWait is following: The uninstaller is transparently copied to the system temporary directory for the uninstall. (http://nsis.sourceforge.net/Docs/Chapter4.html#4.6.2)<br />
<br />
Regards, DonChunior</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>