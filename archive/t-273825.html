<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Postscript Font Installer, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Postscript Font Installer NSIS Discussion" />
	
	<title> Postscript Font Installer [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Postscript Font Installer</div>
<hr />
<div class="pda"><a href="t-273825.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=273825">Postscript Font Installer</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">trukovg</div><div class="date">3rd July 2007, 21:15</div></div><div class="posttext">I am experiencing difficulty developing an installer for post script fonts (e.g .pfm font) for XP/2000. <br />
I have researched extensively online and the NSIS site, but only found reference to TTF and FON font installaters. <br />
<br />
Any tips or guidance would be greatly appreciated. <br />
THANK you in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th July 2007, 19:03</div></div><div class="posttext">The documentation for AddFontResource (http://msdn2.microsoft.com/en-us/library/ms534231.aspx) says it supports .pfm files. All of the functions available for TTF should work, except that you probably won't be able to get the font name automatically using the FontName plug-in.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">trukovg</div><div class="date">9th July 2007, 23:06</div></div><div class="posttext">Thank you very much for the instructions. I worked with the website you provided, but was not successful with installing the Type 1 font file. <br />
<br />
I tried to use the AddFontResource function based on examples I found, but it does not add the file to the Fonts directory as expected. <br />
<br />
Here is my code, in case you have a chance to take a look and advise on errors I made:<br />
--------------------------------<br />
Section &quot;Fonts&quot;<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  File &quot;$INSTDIR\MyFont.pfm&quot;<br />
  File &quot;$INSTDIR\MyFont.pfb&quot;<br />
<br />
CheckWinVer:<br />
  ReadRegStr $R0 HKLM &quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot; &quot;CurrentVersion&quot;<br />
  IfErrors WIN-x WIN-NT<br />
<br />
WIN-NT:<br />
  StrCpy $R1 &quot;Software\Microsoft\Windows NT\CurrentVersion\Fonts&quot;<br />
  goto Reg-Add<br />
<br />
WIN-x:<br />
  StrCpy $R1 &quot;Software\Microsoft\Windows\CurrentVersion\Fonts&quot;<br />
  goto Reg-Add<br />
<br />
Reg-Add:<br />
  ClearErrors<br />
  ReadRegStr $R0 HKLM &quot;$R1&quot; &quot;MyFont&quot;<br />
  IfErrors 0 End<br />
    System::Call &quot;GDI32::AddFontResourceA(t) i ('MyFont.pfm|MyFont.pfb') .s&quot;<br />
    WriteRegStr HKLM &quot;$R1&quot; &quot;My Font&quot; &quot;MyFont.pfm&quot;<br />
<br />
End:<br />
  SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0 /TIMEOUT=5000<br />
SectionEnd<br />
--------------------------------------------</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th July 2007, 10:28</div></div><div class="posttext">Have you tried extracting the fonts to the $FONTS directory instead of $INSTDIR? You pass a relative path, but install it to somewhere AddFontResource might not expect to find the fonts.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">trukovg</div><div class="date">13th July 2007, 14:46</div></div><div class="posttext">That worked. Thank you so much!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">18th November 2007, 17:56</div></div><div class="posttext">you can read the fontname from the .afm file, that many type1 fonts come with. same goes for type1 fonts in ascii format (.pfa) rather than binaries (.pfb).<br />
<br />
according to this website (http://www.myfonts.com/support/help_formats_win.html#type1), type1 installation require adobe type manager on windows version priorto windows 2000.<br />
<br />
also type1 fonts are registered under a different keyname:<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Type 1 Installer</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>