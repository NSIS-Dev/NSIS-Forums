<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Mb_okcancel, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Mb_okcancel NSIS Discussion" />
	
	<title> Mb_okcancel [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Mb_okcancel</div>
<hr />
<div class="pda"><a href="t-253356.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=253356">Mb_okcancel</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Potz</div><div class="date">15th August 2006, 20:03</div></div><div class="posttext">is there a way to click cancel and go back to the same GUI.  I thought it would do that with the code I have but it seems to be going to the next step regardless.  <br />
<br />
here is my code<br />
<br />
MessageBox MB_OKCANCEL &quot;If $0 is the correct IP Address click Ok, if not click Cancel and correct it.&quot; IDOK OK IDCANCEL CANCEL<br />
OK:<br />
   DetailPrint &quot;$0 is right&quot;<br />
   <br />
CANCEL:<br />
   DetailPrint &quot;$0 needs to be corrected&quot;<br />
   Abort</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">15th August 2006, 20:34</div></div><div class="posttext">See Page &amp; leave with Abort instruction</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">15th August 2006, 20:40</div></div><div class="posttext">Try to rename the labels. Maybe NSIS gets confused by using the words &quot;OK&quot; / &quot;Cancel&quot;<br />
<br />
In your code your missing a label after Detailprint &quot;$0 is right&quot;. This way the code after the label cancel is executed too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">16th August 2006, 02:53</div></div><div class="posttext">The name of the lables should have no bearing on the outcome. <br />
<br />
From your code, it sounds like you are asking this question after you are already installing files.  (I say this because DetailPrint only works during the page instfiles.)<br />
<br />
The better approach is to have all the required information BEFORE you start the install.  <br />
<br />
Take a look at the attached script for an example of one way you might deal with this.<br />
<br />
Another option might be to insert a custom &quot;confirmation page&quot; in which you summarize all the user's choices right before they click &quot;next&quot; to start the install.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Potz</div><div class="date">16th August 2006, 12:48</div></div><div class="posttext">thanks for the example, it is working for what I want it to do other than going back to my custom page if it is wrong so it is able to be changed to the correct IP address.  I'll put in the code for my page so you can see what it is doing exactly.<br />
<br />
Function ServerIP<br />
<br />
!insertmacro MUI_HEADER_TEXT &quot;Server IP Address Change&quot; &quot;This \<br />
is for Clients only, if this is a server you are \<br />
installing on then place localhost in the text area.&quot;<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;ServerIP.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;ServerIP.ini&quot;<br />
<br />
ReadINIStr $3 &quot;$PLUGINSDIR\ServerIP.ini&quot; &quot;Field 5&quot; &quot;State&quot;<br />
<br />
${If} $3 == 0<br />
ReadINIStr $0 &quot;$PLUGINSDIR\ServerIP.ini&quot; &quot;Field 2&quot; &quot;State&quot;<br />
<br />
    Push $0<br />
    MessageBox MB_OKCANCEL &quot;If $0 is the correct IP address, click 'OK', otherwise, click 'Cancel'&quot; IDOK OK IDCANCEL CANCEL<br />
<br />
    OK:<br />
    MessageBox MB_OK &quot;IP OK!&quot;<br />
    pop $0<br />
    Return<br />
<br />
    CANCEL:<br />
    MessageBox MB_OK &quot;IP BAADDD!&quot;<br />
    pop $0<br />
    abort<br />
    <br />
Push localhost #text to be replaced<br />
Push $0 #replace with<br />
Push all #replace all occurrences<br />
Push all #replace all occurrences<br />
Push &quot;$INSTDIR\WARN\Dashboard\dashboard.properties&quot; #file to replace in<br />
 Call AdvReplaceInFile<br />
 <br />
Push localhost #text to be replaced<br />
Push $0 #replace with<br />
Push all #replace all occurrences<br />
Push all #replace all occurrences<br />
Push &quot;$INSTDIR\WARN\Dashboard\dashboard.properties_RDR_SIM&quot; #file to replace in<br />
 Call AdvReplaceInFile<br />
 <br />
<br />
${EndIf}<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">16th August 2006, 16:00</div></div><div class="posttext">Couple things:<br />
1)  You should do your file extraction outside of your page's show function.  (Probably best to do it in .onInit).  Otherwise, you could slow down screen refreshes plus each time you extract, you would be replacing the page with a new copy (meaning that anything the user entered would be gone when they return to the page.)<br />
<br />
2) Second, the verifications should be done in the page's leave function.  If you then want to return back, you simply call the &quot;abort&quot; command in the leave function.  Or if you need to go back more than one page, you might check this out:<br />
http://nsis.sourceforge.net/Go_to_a_NSIS_page<br />
<br />
My example was written without MUI, but the concepts are the same--you should take a closer look to see how it's done.  You might also want to review the InstallOptions documentation and check out the InstallOptions examples in the ${NSISDIR}\Examples\Modern UI</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Potz</div><div class="date">16th August 2006, 16:34</div></div><div class="posttext">ok all I need to do is use abort.  Which I thought I am doing but it dosen't seem to be working.  Here is my code<br />
<br />
Function ServerIP<br />
<br />
!insertmacro MUI_HEADER_TEXT &quot;Server IP Address Change&quot; &quot;This \<br />
is for Clients only, if this is a server you are \<br />
installing on then place localhost in the text area.&quot;<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;ServerIP.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;ServerIP.ini&quot;<br />
<br />
ReadINIStr $3 &quot;$PLUGINSDIR\ServerIP.ini&quot; &quot;Field 5&quot; &quot;State&quot;<br />
<br />
${If} $3 == 0<br />
ReadINIStr $0 &quot;$PLUGINSDIR\ServerIP.ini&quot; &quot;Field 2&quot; &quot;State&quot;<br />
<br />
    Push $0<br />
    MessageBox MB_OKCANCEL &quot;If $0 is the correct IP address, click 'OK', otherwise, click 'Cancel'&quot; IDOK OK IDCANCEL CANCEL<br />
<br />
    OK:<br />
    StrCpy $9 &quot;0&quot;<br />
    MessageBox MB_OK &quot;IP OK!&quot;<br />
    pop $0<br />
    Push localhost #text to be replaced<br />
Push $0 #replace with<br />
Push all #replace all occurrences<br />
Push all #replace all occurrences<br />
Push &quot;$INSTDIR\WARN\Dashboard\dashboard.properties&quot; #file to replace in<br />
 Call AdvReplaceInFile<br />
<br />
Push localhost #text to be replaced<br />
Push $0 #replace with<br />
Push all #replace all occurrences<br />
Push all #replace all occurrences<br />
Push &quot;$INSTDIR\WARN\Dashboard\dashboard.properties_RDR_SIM&quot; #file to replace in<br />
 Call AdvReplaceInFile<br />
    Return<br />
<br />
    CANCEL:<br />
    StrCpy $9 &quot;1&quot;<br />
    MessageBox MB_OK &quot;IP BAADDD!&quot;<br />
    pop $0<br />
    abort<br />
<br />
${EndIf}<br />
${if} $9 == &quot;1&quot;<br />
<br />
${endif}<br />
<br />
FunctionEnd<br />
<br />
I changed it to where if they click ok then the text file is changed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th August 2006, 16:40</div></div><div class="posttext">You can't read from the INI file in the Show function.<br />
You must do it in the Leave function.<br />
<br />
Page Custom ShowFunc LeaveFunc.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Potz</div><div class="date">16th August 2006, 18:00</div></div><div class="posttext">Awesome it works now thanks everyone.  <br />
<br />
here is the working code for those who may be interested.<br />
<br />
<br />
;show IP address change gui---------------------------<br />
Function ServerIP<br />
<br />
!insertmacro MUI_HEADER_TEXT &quot;Server IP Address Change&quot; &quot;This \<br />
is for Clients only, if this is a server you are \<br />
installing on then place localhost in the text area.&quot;<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;ServerIP.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;ServerIP.ini&quot;<br />
<br />
<br />
<br />
FunctionEnd<br />
;-----------------------------------------------------<br />
<br />
;Change IP address------------------------------------<br />
Function LeaveServerIP<br />
<br />
ReadINIStr $3 &quot;$PLUGINSDIR\ServerIP.ini&quot; &quot;Field 5&quot; &quot;State&quot;<br />
<br />
${If} $3 == 0<br />
ReadINIStr $0 &quot;$PLUGINSDIR\ServerIP.ini&quot; &quot;Field 2&quot; &quot;State&quot;<br />
<br />
    Push $0<br />
    MessageBox MB_OKCANCEL &quot;If $0 is the correct IP address, click 'OK', otherwise, click 'Cancel'&quot; IDOK OK IDCANCEL CANCEL<br />
<br />
    OK:<br />
    StrCpy $9 &quot;0&quot;<br />
    pop $0<br />
    Push localhost #text to be replaced<br />
Push $0 #replace with<br />
Push all #replace all occurrences<br />
Push all #replace all occurrences<br />
Push &quot;$INSTDIR\WARN\Dashboard\dashboard.properties&quot; #file to replace in<br />
 Call AdvReplaceInFile<br />
<br />
Push localhost #text to be replaced<br />
Push $0 #replace with<br />
Push all #replace all occurrences<br />
Push all #replace all occurrences<br />
Push &quot;$INSTDIR\WARN\Dashboard\dashboard.properties_RDR_SIM&quot; #file to replace in<br />
 Call AdvReplaceInFile<br />
    Return<br />
<br />
    CANCEL:<br />
    StrCpy $9 &quot;1&quot;<br />
    pop $0<br />
    abort<br />
<br />
${EndIf}<br />
<br />
FunctionEnd<br />
;------------------------------------------------------</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>