<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Vista/Win7, and UAC control, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Vista/Win7, and UAC control NSIS Discussion" />
	
	<title> Vista/Win7, and UAC control [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Vista/Win7, and UAC control</div>
<hr />
<div class="pda"><a href="t-314234.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=314234">Vista/Win7, and UAC control</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Bill2</div><div class="date">29th October 2009, 09:32</div></div><div class="posttext">Hi from a french guy, (Hope you can understand what I want ...)<br />
<br />
I have a question, and I don't find anwser anywhere.<br />
<br />
I user RequestExecutionLevel=user, so the UAC is not launched when the installer starts.<br />
<br />
But with user lever, the soft can't be installed in &quot;program files&quot;<br />
<br />
If I use &quot;admin&quot; level, UAC prompt for password, and then NSIS can install my soft in Prg files<br />
<br />
But with this level, at the end of install, if the user choose to launch the soft, it is launched with admin rights, and not user right.<br />
<br />
And my soft save datas in user profile, so at the firt start after install, datas are saved in the admin profile, and the user don't find them when he wants to user the soft another day.<br />
<br />
Is there a way to install soft with UAC in program files, and then launch soft at the end of install with user rights ?<br />
<br />
Thanks for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">29th October 2009, 09:47</div></div><div class="posttext">the easy way: disable the run checkbox<br />
<br />
the hard way: use the UAC plugin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bill2</div><div class="date">29th October 2009, 09:51</div></div><div class="posttext">:)<br />
<br />
Well, I have a look at UAC plugin, but I don't like the fact that it is the install that prompt for the admin password ... It may be not appears as very safe for the user.<br />
<br />
So, I will use the first method.<br />
<br />
An other question: if I use a ExecShell function, does it run with admin rights, or user rights &quot;from the shell&quot; ?<br />
In the second cas, it could be a great things, no ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">29th October 2009, 11:22</div></div><div class="posttext">The program you execute with ExecShell will be run at the same level as the installer that executed it. Just like with Exec, ExecWait, nsExec or any other method of executing programs.<br />
<br />
(Expect for the CallAsUser function in the UAC plugin, but like Anders hinted that's a world of pain.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bill2</div><div class="date">29th October 2009, 11:44</div></div><div class="posttext">Right. I disable the finispage_run, and that' all!<br />
<br />
(And may be this issue can be fixed in a future version of NSIS, I saw in other post that I'm not the only one to have this problem ...)<br />
<br />
Thanks for you help :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">29th October 2009, 13:31</div></div><div class="posttext">I have found that the UAC plugin works very well. It lets my installer do some things as an administrator and some as a standard user. I had to spend some time experimenting with the UAC plugin but soon found it suits my needs very well.<br />
<br />
As far as I am concerned the &quot;world of pain&quot; mentioned elsewhere in connection with the UAC plugin is an exaggeration.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">29th October 2009, 13:49</div></div><div class="posttext">Of course it is an exaggeration, but for NSIS newbies it most definitely is pain. Also I'll add that most people using the UAC plugin are NOT using it the way they should. It's a more complex problem than most people think or realize.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">29th October 2009, 14:10</div></div><div class="posttext">It's a more complex problem than most people think or realize.I completely agree. After reading the documentation I thought I knew what I was doing but soon found that I was wrong - my installer was not doing what I expected it to do.<br />
<br />
Once I took the time to write a few simple test programs and looked at what happened when I ran them I was able to see where I had gone wrong.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>