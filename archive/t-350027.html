<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS error description, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS error description NSIS Discussion" />
	
	<title> NSIS error description [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS error description</div>
<hr />
<div class="pda"><a href="t-350027.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=350027">NSIS error description</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">13th October 2012, 12:08</div></div><div class="posttext">I am using NSIS for my application. I want to track the errors which are occurred during the installation of my application and i want it it write to a log(a error log) so that i can know the errors occurred during installation in my customers place. How can i do it in NSIS.. Please reply me soon<br />
Thank u</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">13th October 2012, 15:25</div></div><div class="posttext">Use the detailprint command to print debug information to the installation log. Then dump the log to a file in .onInstFailed / .onInstSucces / some other callback function.<br />
<br />
http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.14.3<br />
http://nsis.sourceforge.net/Dump_log_to_file</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Squirre1</div><div class="date">15th October 2012, 07:20</div></div><div class="posttext">I created a macro for realtime logging... I am not sure if the others would call it clean but I tend to love it.. <br />
<br />
!include LOGICLIB.nsh<br />
<br />
var NOW<br />
<br />
!macro logme logpath logtext output<br />
  ${If} ${output} == 's'<br />
    SetDetailsPrint both<br />
      DetailPrint &quot;${logtext}&quot;<br />
    SetDetailsPrint none<br />
  ${ElseIf} ${output} == 'l'<br />
    ${time::GetLocalTime} $NOW<br />
    nsislog::log &quot;${logpath}&quot; &quot;$NOW$\t${logtext}&quot;<br />
  ${ElseIf} ${output} == 'b'<br />
    ${time::GetLocalTime} $NOW<br />
    nsislog::log &quot;${logpath}&quot; &quot;$NOW$\t${logtext}&quot;<br />
    SetDetailsPrint both<br />
      DetailPrint &quot;${logtext}&quot;<br />
    SetDetailsPrint none<br />
  ${EndIf}<br />
!macroend<br />
<br />
    !insertmacro logme ${INSTLOG} &quot;This will log to the log file only&quot; l<br />
    !insertmacro logme ${INSTLOG} &quot;This will log to the screen only&quot; s<br />
    !insertmacro logme ${INSTLOG} &quot;This will log to both the screen and the log file&quot; l<br />
<br />
<br />
${INSTLOG} is just my path to the log file so just set that to whatever,<br />
<br />
this is a sample output:<br />
<br />
11.10.2012 16:06:05	*-----------------------------------------------------*<br />
11.10.2012 16:06:05	### Cisco AnyConnect Secure Mobility Client 3.1.00495 Installation Starting<br />
11.10.2012 16:06:05	### Build Verison: 1.0.0.1<br />
11.10.2012 16:06:05	### Runtime: 10/11/2012 16:6:5<br />
11.10.2012 16:06:05	### Switches: {none}<br />
11.10.2012 16:06:05	*-----------------------------------------------------*<br />
11.10.2012 16:06:05	Running Pre-installation Processes ... Please be Patient<br />
11.10.2012 16:06:05	Attempting to detect chassis type ... Please be Patient<br />
11.10.2012 16:06:05	- Processing detected chassis type: 080041002<br />
11.10.2012 16:06:05	- Processing detected chassis type: <br />
11.10.2012 16:06:05	- Processing detected chassis type: <br />
11.10.2012 16:06:23	Pre-installation Processes Complete<br />
11.10.2012 16:06:23	Extracting Files for Installation ... Please be Patient<br />
11.10.2012 16:06:24	Installing Cisco AnyConnect Secure Mobility Client 3.1.00495 Core Components ... Please be Patient<br />
11.10.2012 16:06:25	Installing Cisco AnyConnect Secure Mobility Client 3.1.00495 NAM Components ... Please be Patient<br />
11.10.2012 16:06:26	- Installer Returned Code: 1603<br />
11.10.2012 16:06:26	- Installation Error: 1603<br />
11.10.2012 16:06:30	Cleaning Up Temporary Files ... Please be Patient<br />
11.10.2012 16:06:30	*** Cisco AnyConnect Secure Mobility Client 3.1.00495 Installation Ended in Error ***<br />
11.10.2012 16:06:30	*-----------------------------------------------------*<br />
11.10.2012 16:06:30	*-----------------------------------------------------*<br />
11.10.2012 16:06:30	<br />
<br />
<br />
As you can tell, I use mine when wrapping applications, but an installer would be good just the same... I believe logiclib is all you need if I remember right...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th October 2012, 10:15</div></div><div class="posttext">You should use compile-time !if rather than a run-time ${If}. At the moment it is compiling the whole macro on compile when only a single branch of it needs to be compiled.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">15th October 2012, 10:33</div></div><div class="posttext">Can i get any example of using these dumping log to a file in .onInstFailed / .onInstSucces / some other callback function?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">15th October 2012, 11:01</div></div><div class="posttext">You can get info on the callback functions here: http://nsis.sourceforge.net/Docs/Chapter4.html#4.7.2<br />
You can find a logdumper example on the 'dump to log file' page I linked. (Pro tip: Read the 'how to use'.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">16th October 2012, 10:46</div></div><div class="posttext">Thank u all for your replies. Does dumb log to a file(http://nsis.sourceforge.net/Dump_log_to_file) gives only installation log(files copied during install) or errors occurred in installation also?<br />
I want to get error found during installation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">16th October 2012, 14:10</div></div><div class="posttext">It simply saves whatever is in the installation details window. Like I said, you'll need to use the detailprint command to put extra details / error information in there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">17th October 2012, 06:00</div></div><div class="posttext">Thank u MSG..Is there any method i can get error description for the error occurred.(For example during re install the some file is kept open in the installed path etc..).Can i get the error description and do error handling for that?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">17th October 2012, 08:56</div></div><div class="posttext">You'll have to do your own error handling. Use ${If} ${Errors} a lot, and add extra commands where necessary to get more info. Also make sure to detailprint return codes if you use external applications / win32 api commands.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">17th October 2012, 09:02</div></div><div class="posttext">Don't i get any error description from NSIS itself? For example a copying file can fail because of so many reasons.So how i can know what exactly the error is?Is there any error description? What about error flag? Does it set to different value for different error?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">17th October 2012, 10:28</div></div><div class="posttext">No, CopyFiles does not give specific error information. Both canceling and errors set the errorflag. If you want more specifics, you'll have to call the appropriate copying command directly through win32 API, using the system plugin.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">17th October 2012, 11:47</div></div><div class="posttext">What about using special builds?What does it do exactly?Can i get errors and its description by using it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">17th October 2012, 15:22</div></div><div class="posttext">No clue. Try the logging build.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">18th October 2012, 09:01</div></div><div class="posttext">thank u for your replies.I think i can't get error description from NSIS itself. But can i get in which line or where the error has occurred.Using iferrors in every case will make the coding more lengthy and difficult so i want to make it easy.So can i get errors occurred during error with line number or something else?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">18th October 2012, 13:05</div></div><div class="posttext">hey MSG you have also told to use Windows API,using system plugin to track errors.in this forum http://forums.winamp.com/showthread.php?s=&amp;threadid=283735 it is mentioned to use System::Call kernel32::WriteFile(...)?e. But can u tell what are the parameters to be passed to Writefile() function?Does kernel32::WriteFile(...)?e will write errors to a file?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">18th October 2012, 17:49</div></div><div class="posttext">No, no it will not. Kichik merely said that appending ?e to a function call through the system plugin will make it put the function's return code on the stack after calling.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">19th October 2012, 05:57</div></div><div class="posttext">thank u MSG..Do you have any example script where system plugin and writefile is used?Because it will help me more to understand it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">19th October 2012, 12:32</div></div><div class="posttext">Not myself. But if you google for 'nsis system:call writefile' you'll find some examples.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">19th October 2012, 13:13</div></div><div class="posttext">But... Why would you want to use WriteFile? I thought you wanted to copy files? <br />
<br />
http://msdn.microsoft.com/en-us/library/windows/desktop/aa365747%28v=vs.85%29.aspx<br />
http://msdn.microsoft.com/en-us/library/windows/desktop/aa363851%28v=vs.85%29.aspx</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>