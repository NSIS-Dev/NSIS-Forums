<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MUI_FINISHPAGE_RUN runs the application minimized., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MUI_FINISHPAGE_RUN runs the application minimized. NSIS Discussion" />
	
	<title> MUI_FINISHPAGE_RUN runs the application minimized. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MUI_FINISHPAGE_RUN runs the application minimized.</div>
<hr />
<div class="pda"><a href="t-234545.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=234545">MUI_FINISHPAGE_RUN runs the application minimized.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">lybra</div><div class="date">2nd January 2006, 15:24</div></div><div class="posttext">I have created an installer using the MUI. At the end of the installation, the user is given the option to run the application, using:<br />
<br />
---<br />
!define MUI_FINISHPAGE_RUN &quot;$INSTDIR\${MAINPRODUCT_EXE}&quot;<br />
---<br />
<br />
This works fine, however the application is run minimized. This is quite annoying; you now first have to select the application in the task bar before you can enter your login credentials. When I start the application by double-clicking the icon of the installed file, it runs normally and you can immediately start typing.<br />
<br />
I couldn't find any settings in the MUI manual that would cause the application to run minimized, and also no solutions on this forum. Does anyone have a suggestion?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">2nd January 2006, 17:15</div></div><div class="posttext">The only idea - your application stores current main window state in registry on exit and restores this on the next run :)<br />
Can you repeat situation in a short nsi script with any other application (like Notepad.exe)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lybra</div><div class="date">3rd January 2006, 08:19</div></div><div class="posttext">Hmm... that was indeed a simple test. Why didn't I come up with that?<br />
<br />
Anyway, I've tried it with Notepad and that works excellent. So it seems that our application is the cause of the problem. I'll tell the application developers to fix it. :)<br />
<br />
Thanks Takhir.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lybra</div><div class="date">3rd January 2006, 15:18</div></div><div class="posttext">I've done some more research and I may have found the cause for my problem.<br />
<br />
First of all, the application is not minimized, but just hidden in the background behind some other application.<br />
<br />
Second, the problem only occurs if I click on the Finish button immediately after the installation has completed. If I wait a little bit while the Finish Page shows, the problem does not occur.<br />
<br />
When the problem occurs, the following happens:<br />
After I click the Finish button, the installer starts to run our application and closes down. However, our application does not receive focus, but stays hidden behind one other application. A simple Alt+Tab will give it focus.<br />
<br />
My explanation (but I could be terribly wrong with this): During a short amount of time, our application has started, but without a GUI. Windows cannot give focus to it (since there is not yet any visible form), so another application receives focus. When the GUI of our application has started, it does not receive focus any more.<br />
<br />
This could also explain why the problem does not occur with Notepad: the loading time of (the GUI of) Notepad is very short (it starts in an instant), so Windows can immmediately give focus to it.<br />
<br />
However, I am still puzzled why this does not occur if I wait a little longer on the Finish Page.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>