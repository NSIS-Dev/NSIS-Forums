<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Create shortcut problrm in windows 8, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Create shortcut problrm in windows 8 NSIS Discussion" />
	
	<title> Create shortcut problrm in windows 8 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Create shortcut problrm in windows 8</div>
<hr />
<div class="pda"><a href="t-350653.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=350653">Create shortcut problrm in windows 8</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">26th October 2012, 07:18</div></div><div class="posttext">I am using NSIS to create my application.It is working fine in windows xp,vista and windows 7.<br />
but in windows 8 shortcut of my application in desktop is not creating.But in other OS it's creating shortcut in desktop properly.Why does it doesnt create shortcut in windows 8 OS?Is there any solution to solve this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">26th October 2012, 14:57</div></div><div class="posttext">I want to add some more details for above problem.I was trying to find out the error of creating shortcut.I did a small testing with CreateShortcuts.<br />
Below is a part of coding.<br />
<br />
!macro CreateShortcuts<br />
      Messagebox MB_OK &quot;$Desktop&quot;<br />
      CreateShortCut &quot;$Desktop\nvt.lnk&quot; &quot;$INSTDIR\Database2.mdb&quot;<br />
      CreateShortCut &quot;$INSTDIR\nvt.lnk&quot; &quot;$INSTDIR\Database2.mdb&quot;<br />
      copyfiles &quot;$Desktop\test\test.txt&quot; &quot;$Desktop&quot;  <br />
!macroend<br />
<br />
The Messagebox MB_OK &quot;$Desktop&quot; displays output as &quot;D:\Desktop&quot; which is proper in my case.<br />
But CreateShortCut &quot;$Desktop\nvt.lnk&quot; &quot;$INSTDIR\Database2.mdb&quot;   creates a shortcut in C:\Documents and Settings\winman\Desktop path only in windows 8.but in other OS(xp etc) the shortcut is created in D:\desktop<br />
here is some interesting thing<br />
copyfiles &quot;$Desktop\test\test.txt&quot; &quot;$Desktop&quot;  copies file from D:\Desktop\test\test.txt to D:\desktop in both windows 8 and other OS.<br />
So how this copyfiles and createshortcut behave differently for $Desktop at same time?<br />
So is the problem of creating shortcut is a problem with NSIS or something else.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">26th October 2012, 17:40</div></div><div class="posttext">NSIS uses the documented CSIDL_DESKTOPDIRECTORY constant to get the folder.<br />
<br />
Could you run http://pastebin.com/gztsZbyi and paste the output?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">26th October 2012, 18:14</div></div><div class="posttext">NSIS uses the normal COM shortcut interface to create the shortcut, I suspect Windows is trying to &quot;help&quot; by tweaking the PIDL stored in the shortcut...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">27th October 2012, 08:11</div></div><div class="posttext">Thank u Andres for replying me.. I tried running what u have told(http://pastebin.com/gztsZbyi). when i run this nsistest.exe is created in D:\Desktop in both windows 8 and windows xp. So what does it mean?Is it problem with createshortcut or something else?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">27th October 2012, 09:39</div></div><div class="posttext">winman: Please paste the install log here. Anders needs the text printed there with the detailprint commands.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">27th October 2012, 10:31</div></div><div class="posttext">this was the log of installation(for this http://pastebin.com/gztsZbyi )<br />
$Desktop=D:\Desktop<br />
shfolder(0)<br />
SHGetFolderPathA=D:\Desktop<br />
SHGetFolderPathW=D:\Desktop<br />
shell32(0)<br />
SHGetSpecialFolderLocation=D:\Desktop<br />
SHGetSpecialFolderPathA=D:\Desktop<br />
SHGetSpecialFolderPathW=D:\Desktop<br />
SHGetFolderPathA=D:\Desktop<br />
SHGetFolderPathW=D:\Desktop<br />
shfolder(0x10)<br />
SHGetFolderPathA=D:\Desktop<br />
SHGetFolderPathW=D:\Desktop<br />
shell32(0x10)<br />
SHGetSpecialFolderLocation=D:\Desktop<br />
SHGetSpecialFolderPathA=D:\Desktop<br />
SHGetSpecialFolderPathW=D:\Desktop<br />
SHGetFolderPathA=D:\Desktop<br />
SHGetFolderPathW=D:\Desktop<br />
SHGetKnownFolderPath=D:\Desktop<br />
Done (NSIS v2.46, Win 6.2.9200 SP=0 IsWow64=0)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">29th October 2012, 21:57</div></div><div class="posttext">Could you please run http://pastebin.com/PUFCS1gZ and paste the output?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">winman2004</div><div class="date">2nd November 2012, 06:55</div></div><div class="posttext">I tested http://pastebin.com/PUFCS1gZ  in windows 8 and output was<br />
Output folder: F:\Users\winman\AppData\Local\Temp<br />
$Desktop=D:\Desktop<br />
SHGetFolderPathA:SHGFP_TYPE_DEFAULT=F:\Users\winman\Desktop<br />
Saved 1=&quot;D:\Desktop\test_1.lnk&quot;|hr=0|exists=YES|lastop=0<br />
Saved 2=&quot;D:\Desktop\test_2.lnk&quot;|hr=0|exists=YES|lastop=0<br />
Saved 3=&quot;D:\Desktop\test_3.lnk&quot;|hr=0|exists=YES|lastop=0<br />
Saved 4=&quot;D:\Desktop\test_4.lnk&quot;|hr=0|exists=YES|lastop=0<br />
Create shortcut: D:\Desktop\test_0.lnk<br />
Saved normal, error=NO<br />
Done (NSIS v2.46, Win 6.2.9200 SP=0 IsWow64=0)<br />
<br />
Also i got nsistest.exe and shortcuts test_0,test_1,test_2,test_3,test_4. All in D:\desktop itself..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd November 2012, 07:18</div></div><div class="posttext">You should try adding requestexecutionlevel to your script and see if that fixes it...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>