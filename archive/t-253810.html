<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Reag Registry and then Execute a file, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Reag Registry and then Execute a file NSIS Discussion" />
	
	<title> Reag Registry and then Execute a file [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Reag Registry and then Execute a file</div>
<hr />
<div class="pda"><a href="t-253810.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=253810">Reag Registry and then Execute a file</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">OsmanY22</div><div class="date">22nd August 2006, 09:50</div></div><div class="posttext">Hi...<br />
<br />
i want to choose to setup java and/or OpenOffice. with &quot;!insertmacro MUI_PAGE_COMPONENTS&quot; i can show the sections. <br />
<br />
But i want to read from the registry at first if its allready ,example Java, installed. And when its installen, then continue with the other installation, example OpenOffice.<br />
But if java is not installed, then make the installation.<br />
<br />
Can someone helps me????<br />
<br />
This is a shortly version of my installer code:<br />
<br />
;--------------------------------<br />
;Include Ultra Modern UI<br />
<br />
  !include &quot;UMUI.nsh&quot;<br />
  !include &quot;zipdll.nsh&quot;<br />
<br />
;--------------------------------<br />
;General<br />
<br />
  ;Name and File<br />
  Name &quot;mediamid MediaServer&quot;<br />
  OutFile &quot;MediaServer-Setup_OC4J.exe&quot;<br />
  <br />
 ;Default installation folder<br />
  InstallDir &quot;$PROGRAMFILES\mediamid_MediaServer&quot;<br />
  <br />
  XPStyle on<br />
  CRCCheck on<br />
<br />
;--------------------------------<br />
;Functions<br />
<br />
;--------------------------------<br />
;Interface Settings<br />
    !define MUI_ABORTWARNING<br />
<br />
;--------------------------------<br />
;Pages <br />
    !insertmacro MUI_UNPAGE_CONFIRM<br />
    !insertmacro MUI_UNPAGE_COMPONENTS<br />
    !insertmacro MUI_UNPAGE_INSTFILES<br />
        !define MUI_WELCOMEPAGE_TITLE_3LINES<br />
        !define MUI_PAGE_CUSTOMFUNCTION_SHOW WelSetTime<br />
    !insertmacro MUI_PAGE_WELCOME<br />
    !insertmacro MUI_PAGE_LICENSE &quot;license.txt&quot;<br />
    !insertmacro MUI_PAGE_COMPONENTS<br />
    !insertmacro MUI_PAGE_DIRECTORY<br />
        !define MUI_PAGE_CUSTOMFUNCTION_SHOW IFSetTime<br />
    !insertmacro MUI_PAGE_INSTFILES<br />
        !define MUI_PAGE_CUSTOMFUNCTION_SHOW ISSetTime<br />
        !define MUI_PAGE_CUSTOMFUNCTION_PRE  SetCheckbox<br />
    !insertmacro MUI_PAGE_FINISH<br />
        !define MUI_PAGE_CUSTOMFUNCTION_SHOW ISSetTime<br />
    !insertmacro UMUI_PAGE_ABORT<br />
<br />
    ;--------------------<br />
    ;Nach der Installation wird WIndows-Dienst installiert<br />
Function SetCheckbox<br />
        !define MUI_FINISHPAGE_RUN &quot;$INSTDIR\wrapper\bin\Install_MediaServer.bat&quot;<br />
    !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 1&quot; &quot;Type&quot; &quot;Label&quot;<br />
    !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 1&quot; &quot;Text&quot; &quot;MediaServer wurde erfolgreich installiert!&quot;<br />
    <br />
    !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 2&quot; &quot;Type&quot; &quot;Label&quot;<br />
    !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 2&quot; &quot;Text&quot; &quot;Bitte wÃ¤hlen Sie aus, ob MediaServer als Windows-Dienst installiert werden soll.&quot;<br />
    ExecWait &quot;$INSTDIR\wrapper\bin\Install_MediaServer.bat&quot;<br />
    MessageBox MB_OK &quot;MediaServer wurde als Windows-Dienst installiert!&quot;<br />
 <br />
    <br />
FunctionEnd<br />
<br />
;--------------------------------<br />
;Ein Button beim license-Page<br />
LicenseForceSelection radiobuttons<br />
<br />
<br />
;--------------------------------<br />
;Installer Sections<br />
<br />
    Icon &quot;setup.ico&quot;<br />
    UninstallIcon &quot;uninstall.ico&quot;<br />
    WindowIcon off<br />
 <br />
<br />
<br />
        ;Variablendefinition um aus der Registry zu lesen<br />
    Var /GLOBAL OOHOME<br />
    Var /GLOBAL JAVAJDK<br />
    Var /GLOBAL JAVAJRE<br />
<br />
    ;Pfade aus der Registry herauslesen<br />
    ReadRegStr $OOHOME HKLM &quot;SOFTWARE\OpenOffice.org\OpenOffice.org\2.0\{7C35B9AB-2CE3-4C18-BE7C-5B97EA089EB3}&quot; &quot;INSTALLLOCATION&quot;<br />
    ReadRegStr $JAVAJDK HKLM &quot;SOFTWARE\JavaSoft\Java Development Kit\1.5.0_02&quot; &quot;JavaHome&quot;<br />
    ReadRegStr $JAVAJRE HKLM &quot;SOFTWARE\JavaSoft\Java Runtime Environment\1.5.0_02&quot; &quot;JavaHome&quot;<br />
  #  ReadRegStr $WASHOME HKLM '&quot;SOFTWARE\IBM\Application Client for WebSphere Application Server\6.0\FJ2ee\Install&quot;' &quot;InstallLocation&quot;<br />
<br />
<br />
;--------------------------------<br />
;Installer OpenOffice<br />
Section &quot;OpenOffice&quot; SecOpenOffice<br />
    !insertmacro UMUI_LEFT_SETTIME 9<br />
    SetOverwrite on<br />
    SetOutPath &quot;$INSTDIR&quot;<br />
    File &quot;OOo_2.0.3_Win32Intel_install_de.exe&quot;<br />
    ExecWait '&quot;$INSTDIR\OOo_2.0.3_Win32Intel_install_de.exe&quot; &quot;/Q&quot;'<br />
    Delete &quot;$INSTDIR\OOo_2.0.3_Win32Intel_install_de.exe&quot;<br />
    MessageBox MB_OK &quot;Die Installation von Open Office wurde beendet!&quot;<br />
    Sleep 2000<br />
    goto next<br />
    next:<br />
<br />
SectionEnd<br />
<br />
;--------------------------------<br />
;Installer Java<br />
Section &quot;Java 1.5.0_02&quot; SecJava<br />
    !insertmacro UMUI_LEFT_SETTIME 5      <br />
<br />
    SetOverwrite on<br />
    SetOutPath &quot;$INSTDIR&quot;<br />
  <br />
    File &quot;jdk-1_5_0_02-windows-i586-p.exe&quot;<br />
    ExecWait '&quot;$INSTDIR\jdk-1_5_0_02-windows-i586-p.exe&quot; &quot;/Q&quot;'<br />
    Delete &quot;$INSTDIR\jdk-1_5_0_02-windows-i586-p.exe&quot;<br />
    MessageBox MB_OK &quot;Die Installation von Java wurde beendet!&quot;<br />
    Sleep 1000<br />
    goto next2<br />
    next2:<br />
SectionEnd<br />
 <br />
<br />
<br />
<br />
;--------------------------------<br />
;Installer MediaServer<br />
Section &quot;Programmdateien&quot; SecMediaServer<br />
    ;Noch 2 Minuten<br />
    !insertmacro UMUI_LEFT_SETTIME 2  <br />
      <br />
<br />
    ;Muss ausgewÃ¤hlt sein<br />
    SectionIn RO<br />
    <br />
    ;Installation<br />
    SetOverwrite on<br />
    SetOutPath $INSTDIR<br />
   <br />
    File mediaserver.jar<br />
    File ms.properties<br />
    File ms_oc4j.bat<br />
#    File ms_was.bat<br />
    File log4j.xml<br />
    File build.xml<br />
Sectionend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th August 2006, 13:48</div></div><div class="posttext">Put the registry reading code in the section, compare the values to the expected values and jump to the end of the section, if Java shouldn't be installed.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>