<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" HTTP calls with NSIS, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  HTTP calls with NSIS NSIS Discussion" />
	
	<title> HTTP calls with NSIS [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  HTTP calls with NSIS</div>
<hr />
<div class="pda"><a href="t-185739.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=185739">HTTP calls with NSIS</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">cosmicperl</div><div class="date">7th July 2004, 02:46</div></div><div class="posttext">Hi,<br />
  I need to make HTTP Post or Get calls and read the results for writing to a file(s). I know about the module to download files from the net, but can I send a HTTP POST? Or can I send a HTPP Get?<br />
<br />
Thanks for any help, it's very much appreciated!<br />
<br />
Lyle<br />
<br />
:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fredtheman</div><div class="date">7th July 2004, 16:24</div></div><div class="posttext">Don't know about how to POST, but you can just add the parameters in the URL to do a GET, ie.<br />
<br />
::Download &quot;http://srv/myscript.php?item1=a&amp;item2=b<br />
<br />
Fred.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cosmicperl</div><div class="date">7th July 2004, 22:58</div></div><div class="posttext">Thanks Fred.<br />
<br />
Here is what I'm trying to acheive. I want to query a cgi script from a server before the files are installed. If the server returns a http error, or an error sent as a text file, I want the install to stop. If it returns a good text file I want to install to complete. Can I read the text that is returned from my script. The sample code for NSISdl only shows if the file was downloaded or not. I need to read from the file.<br />
<br />
Also For some of the install files, I want to parse in some data before they are wrtten to the installed folder. How can I do this?<br />
<br />
Sorry about all the questions.<br />
<br />
Lyle</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">7th July 2004, 23:41</div></div><div class="posttext">NSIS provides commands for file reading and writing, please see the users manual for details.<br />
<br />
You can modify strings using StrCpy, StrCmp, StrLen etc.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cosmicperl</div><div class="date">8th July 2004, 01:45</div></div><div class="posttext">Thank you Joost Verburg<br />
<br />
I've had a look at the manual, here is what I've come up with. I'm ued to perl, so hopefully I'll work this out.<br />
<br />
$R0 = &quot;inputfilename.txt&quot;<br />
$R1 = &quot;outputfilename.txt&quot;<br />
<br />
FileOpen $0 $R0 &quot;r&quot;<br />
FileOpen $1 $R1 &quot;w&quot;<br />
<br />
searchfile:<br />
FileRead $0 $R2<br />
IfErrors closefiles<br />
FileWrite $1 $R2<br />
StrCmp $R2 &quot;linetofind&quot; foundline searchfile<br />
<br />
foundline:<br />
FileWrite $1 &quot;ExtraData&quot;<br />
Goto searchfile<br />
<br />
closefiles:<br />
FileClose $0<br />
FileClose $1<br />
<br />
<br />
Would that work?<br />
<br />
<br />
I usually use markers in my files such as --marker-- then search for this in a file and replace with the actual data I want to use. It's easy to do in Perl, but I'm really not familiar with NSIS Script. Would my above code do something similar? Is there a search and replace function I've not noticed?<br />
<br />
<br />
Thanks for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cosmicperl</div><div class="date">20th July 2004, 11:30</div></div><div class="posttext">Good news.<br />
<br />
I've got it working, and furthermore I decided put the code I made into a function so that I can contribute to you all. <br />
<br />
It requires the StrFunc include, I've called it FileParse. Only one routine thus far, I'm sure people will want to add more (or I'll add more in the future). The routine is:-<br />
<br />
WriteWithSwap ResultVar OutPutFile InputFile StrToSearchFor StrToReplace<br />
<br />
Like with StrFunc you have to call it bare first. Then you give it an inputfile and output file, a string to grab and a string to replace it with. It's read the input file and write it to the output file parsing in the swap string. Are you with me?<br />
<br />
<br />
So how do I submit this include to NSIS?<br />
<br />
Lyle<br />
http://www.cosmicperl.com</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>