<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" nsis debian gnu/linux package?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  nsis debian gnu/linux package? NSIS Discussion" />
	
	<title> nsis debian gnu/linux package? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  nsis debian gnu/linux package?</div>
<hr />
<div class="pda"><a href="t-210020.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=210020">nsis debian gnu/linux package?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">10th March 2005, 12:47</div></div><div class="posttext">Hi, I've been preparing a package for the Debian GNU/Linux distribution. I was wondering if people think it would be a useful thing to never have to leave the comfort of your debian system, even when you want to build windows installers for free software.<br />
<br />
Also, a question or two about this:<br />
1. The .dll files in the Plugins directory are produced from the source code in the Contrib directory.<br />
2. Is there anything in the Contrib directory that the makensis program needs at runtime? I guess that the .c/.dsp/.dsw files don't need distributing though.<br />
3. Has anyone written a Makefile for the dlls in the Plugins dir?<br />
<br />
The current modifications include:<br />
<br />
1. loading nsisconf.nsh from /etc/nsisconf.nsh and ~/.nsisconf.nsh instead of the same dir as the executable<br />
2. Move the exe to /usr/bin<br />
3. Install docs and examples in /usr/share/doc/nsis<br />
4. Install the Plugins/Include/Contrib dirs in /usr/share/nsis<br />
<br />
Any comments on this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th March 2005, 18:10</div></div><div class="posttext">Nothing from the Contrib folder is used to build makensis itself.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">11th March 2005, 01:01</div></div><div class="posttext">I realise this, I was more thinking in terms of graphics and other kinds of things that people use often in their NSI scripts because they are accustomed to it being there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th March 2005, 10:16</div></div><div class="posttext">grep all the .nsi and .nsh files for ${NSISDIR}. There are more than a few usages of it, but most are referring the Include or Contrib folders.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">12th March 2005, 02:38</div></div><div class="posttext">Thanks for the tip. Seems no-one is interested, but I'm gonna do it anyway, because I hate Windows, but I still need to make Windows installers.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th March 2005, 10:39</div></div><div class="posttext">If you can make a package that installs in a standard directory structure on Linux, I'll be interested in including the changes.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">13th March 2005, 20:05</div></div><div class="posttext">Ok, excellent. I'm in the process of auditing the source tarball looking for how each dll/exe is built and writing Makefiles for that. After that, I'll request a sponsor for uploading to debian and clean up the modifications I made for submission to the project.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">14th March 2005, 05:39</div></div><div class="posttext">I don't know C++ very well, but debian's mingw g++ gives the following:<br />
<br />
pabs@chianamo:~/devel/debian/nsis-2.05/Contrib$ make -C BgImage/<br />
make: Entering directory `/home/pabs/devel/debian/nsis-2.05/Contrib/BgImage'<br />
i586-mingw32msvc-g++ -Wall -Os -shared -s -mwindows -o ../../Plugins/BgImage.dll BgImage.cpp -lwinmm<br />
In file included from BgImage.cpp:3:<br />
../ExDLL/exdll.h:76: error: declaration of `exec_flags*&lt;anonymous struct&gt;::exec_flags'<br />
../ExDLL/exdll.h:73: error: changes meaning of `exec_flags' from `typedef struct exec_flags exec_flags'<br />
<br />
For this construct (from exdll.h):<br />
<br />
typedef struct {<br />
  int autoclose;<br />
...<br />
} exec_flags;<br />
<br />
typedef struct {<br />
  exec_flags *exec_flags;<br />
...<br />
} extra_parameters;<br />
<br />
Is there a recommended way to fix this so the BgImage plugin (and others that use C++) can go into the debian install? That construct works fine in the AdvSplash/Banner plugins (both written in C).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrSlump</div><div class="date">14th March 2005, 09:03</div></div><div class="posttext">I'd sure love to have it<br />
<br />
We have one client that uses NSIS and wants to migrate his webserver to linux, and we have just installed a debian system, so it would be just in place :)))</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">14th March 2005, 10:33</div></div><div class="posttext">Excellent. Which, if any, plugins, include files or graphics do you use from the NSIDIR?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">14th March 2005, 11:38</div></div><div class="posttext">Plugin building status report:<br />
<br />
I can build the following plugins fine (with/without modifications) - these are all C plugins:<br />
<br />
Plugins/advsplash.dll <br />
<br />
Plugins/Banner.dll <br />
<br />
Plugins/Dialer.dll <br />
<br />
Plugins/LangDLL.dll <br />
<br />
Plugins/nsExec.dll <br />
<br />
Plugins/UserInfo.dll <br />
<br />
Plugins/splash.dll <br />
<br />
Plugins/StartMenu.dll <br />
<br />
Plugins/VPatch.dll<br />
<br />
These all have the problem with the exdll.h file that I posted above (all C++):<br />
 <br />
Plugins/InstallOptions.dll<br />
<br />
Plugins/TypeLib.dll <br />
<br />
Plugins/Math.dll <br />
<br />
Plugins/BgImage.dll<br />
<br />
Plugins/nsisdl.dll <br />
<br />
<br />
This one has a similar error in one of its own files (also C++):<br />
<br />
Plugins/System.dll<br />
<br />
<br />
Now onto binaries placed in Contrib in the source tarball.<br />
<br />
How should I contribute the Contrib changes? These are Makefiles, case changes and minor edits so far. diff against the unpacked source tarball? A zip of the modified Contrib directory?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrSlump</div><div class="date">14th March 2005, 16:57</div></div><div class="posttext">Could you put the debian dir you made anywhere?<br />
<br />
I'd like to download it and start tweaking with it :)<br />
<br />
thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th March 2005, 18:23</div></div><div class="posttext">As I'm already writing a SCons build system, I will not include any contributed Makefiles. Case changes will also be rejected as CVS doesn't support renames and I'd like to keep the change log easy to follow. Other patches can be submitted as CVS diffs in the patches tracker (http://sourceforge.net/tracker/?atid=373087&amp;group_id=22049&amp;func=browse).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">15th March 2005, 19:43</div></div><div class="posttext">Latest deb, orig.tar.gz, .diff.gz, build log etc will be available at http://bonedaddy.net/pabs3/debian/ until this gets into debian, or if I can't find a sponsor, I'll start uploading to mentors.debian.net I think.<br />
<br />
I got this file building: Contrib/Library/LibraryLocal/LibraryLocal.exe<br />
<br />
Unfortunately, not really sure where other binaries in Contrib are built from. Any ideas? I speak of these:<br />
Contrib/UIs/modern_nodesc.exe<br />
Contrib/UIs/default.exe<br />
Contrib/UIs/modern_smalldesc.exe<br />
Contrib/UIs/sdbarker_tiny.exe<br />
Contrib/UIs/modern_headerbmp.exe<br />
Contrib/UIs/modern_headerbmpr.exe<br />
Contrib/UIs/modern.exe<br />
Contrib/System/Resource.dll<br />
Contrib/Library/RegTool/RegTool.bin<br />
Contrib/NSIS Update/UI.exe<br />
Contrib/NSIS Update/ExtractDLL.dll</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th March 2005, 19:48</div></div><div class="posttext">Contrib\UIs\default.exe is built from Contrib\UIs\UI Holder. All of the other executables are modified versions of default.exe. Resource Hacker was used to modify them. Contrib\System\Resource.dll is not built from Source, it's just a DLL with some icons. Contrib\Library\RegTool\RegTool.bin is built from RegTool.nsi. The source code for Contrib\NSIS Update\ExtractDLL.dll is available on the Archive (http://nsis.sourceforge.net/archive/nsisweb.php?page=58&amp;instances=0,32).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">16th March 2005, 08:42</div></div><div class="posttext">Thanks for the info re binaries. Where do the icons for Contrib\System\Resource.dll come from? Any info on the modifications to default.exe?<br />
<br />
The case changes I spoke of are inside .c files, where some of the C sources are including files that don't exist if you have a case sensitive file system. I'll submit the patches (minus makefiles) to the tracker later today.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrSlump</div><div class="date">16th March 2005, 10:18</div></div><div class="posttext">I've already built a .deb :)<br />
<br />
Thanks for the work.<br />
<br />
btw, you should to put g++ as build-depend.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">16th March 2005, 13:18</div></div><div class="posttext">Well, it builds fine inside a pbuilder without adding g++ to the Build-Depends. Do you have build-essential installed?<br />
<br />
Also, I sent an update that fixes the problem I was having with ExDLL above, which means several more DLLs are now built.<br />
<br />
Here's my TODO before the RFS:<br />
<br />
<br />
Include the current directory in the search path for nsisconf.nsh and for files referenced by the Plugins code and elsewhere so that RegTool.bin can be created at build time.<br />
<br />
Install stuff referenced from the example files etc into /usr/share/nsis/Contrib<br />
<br />
Place copyrights from Contrib into debian/copyright</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">21st March 2005, 02:33</div></div><div class="posttext">Ok, I've uploaded to mentors.debian.net and am going to file an RFS later today.<br />
<br />
http://mentors.debian.net/debian/pool/main/n/nsis/<br />
http://bonedaddy.net/pabs3/debian<br />
http://bonedaddy.net/pabs3/debian/nsis_2.05-1_i386.deb<br />
http://bonedaddy.net/pabs3/debian/nsis_2.05-1_i386.build</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">30th March 2005, 12:55</div></div><div class="posttext">Found a sponsor and packaged 2.06. It may even get into sarge!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">31st March 2005, 09:23</div></div><div class="posttext">2.06 has been uploaded, and is in the new queue:<br />
http://ftp-master.debian.org/new.html</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">8th April 2005, 09:34</div></div><div class="posttext">nsis has been accepted into debian!<br />
<br />
http://packages.qa.debian.org/n/nsis.html<br />
<br />
If sarge freezes in more than 10 days time, it may even make it into sarge on some platforms.<br />
<br />
Unfortunately the mipsel and sparc builds failed due to problems in halibut (a segfault and a bus error), so it would be good if halibut in nsis was updated to the latest upstream release when nsis is next released.<br />
<br />
http://buildd.debian.org/build.php?pkg=nsis</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrSlump</div><div class="date">5th May 2005, 10:11</div></div><div class="posttext">Sarge got frozen!<br />
but nsis got into!<br />
<br />
congrats pabs</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>