<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Get all usernames under XP, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Get all usernames under XP NSIS Discussion" />
	
	<title> Get all usernames under XP [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Get all usernames under XP</div>
<hr />
<div class="pda"><a href="t-258087.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258087">Get all usernames under XP</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Defcon0</div><div class="date">22nd October 2006, 17:21</div></div><div class="posttext">Hello,<br />
I want to install a program for all users on my pc (also with limited users). <br />
For this I have the opportunity to install the config files to the All Users\Application Data - Directory.<br />
But this has a disadvantage: Everyone uses the same config.<br />
How can I install my program to every single user's<br />
C:\Docs and Settings\username\Application Data - Dir ?<br />
<br />
Is this possible ?<br />
<br />
Thanks in forward.<br />
<br />
Bye</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">23rd October 2006, 10:18</div></div><div class="posttext">Are you using $APPDATA to get at that application data dir?  If so, you just need to use:<br />
SetShellVarContext current<br />
before the line with $APPDATA to get the current user's application data dir.<br />
<br />
Don't forget to switch back to all users after that if you need it!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Defcon0</div><div class="date">23rd October 2006, 10:46</div></div><div class="posttext">I tried this before.<br />
Changing this Variable makes $APPDATA look like this <br />
C:\Docs and Settings\All Users\Application Data<br />
instead of this<br />
C:\Docs and Settings\username\Application Data<br />
<br />
But the consequence is that all Users on the PC use the same config.<br />
<br />
Is there a workaround ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">23rd October 2006, 12:30</div></div><div class="posttext">IMHO you should install the config under All Users. If a user starts your app for the very first time your has to copy the config files found in &quot;All Users&quot; to the current users.<br />
<br />
If this is not possible than write an small NSIS Script as your app start script. If the current user has no config then copy it, if the user already has the config skip copying and start your app.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Defcon0</div><div class="date">23rd October 2006, 12:54</div></div><div class="posttext">I made it the following. The Config isn't installed at all. I made my application write it completely by itself.<br />
So there's no problem anymore.<br />
<br />
Tahnks !!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>