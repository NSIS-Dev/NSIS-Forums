<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" BringToFront doesn't work on XP, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  BringToFront doesn't work on XP NSIS Discussion" />
	
	<title> BringToFront doesn't work on XP [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  BringToFront doesn't work on XP</div>
<hr />
<div class="pda"><a href="t-157907.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=157907">BringToFront doesn't work on XP</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Nils2000</div><div class="date">28th November 2003, 16:53</div></div><div class="posttext">Hi,<br />
<br />
BringToFront doesn't work on WinXP. It only makes the taskbar appear and the icon of the window blink.<br />
<br />
Has this to do with the documentation of the Win-API Function<br />
SetForegroundWindow ?<br />
Here's an extract:<br />
[...]<br />
Windows NT 5.0 and later: An application cannot force a window to the foreground while the user is working with another window. Instead, SetForegroundWindow will activate the window (see SetActiveWindow) and call theFlashWindowEx function to notify the user.<br />
[...]<br />
<br />
Thanks for any help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th November 2003, 17:02</div></div><div class="posttext">Yes, that's the bit of information that's related to it and explains it perfectly. There is no easy method I know about that you can use to override this. Frankly, I think that's a good thing. As a user, I hate it when Windows pop-up and require my attention while I'm doing something totally unrelated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nils2000</div><div class="date">28th November 2003, 17:14</div></div><div class="posttext">I totally agree with you to that. However, I wonder how some MS-Applications like Outlook manage to penetrate me when I'm synchronizing my eMail-Accounts. Well, I don't believe this is some undocumented functionality, of which MS-Applications take advantage ;-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th November 2003, 17:23</div></div><div class="posttext">Well... If you really want to do that, you can install a global hook which, on your command, will set the foreground window to your application. As a global hook will be injected into every process and therefore will be run under each of them, including the one that has the foreground window, you should be able to do that.<br />
<br />
Also, new windows which are shown using SW_SHOWNORMAL, should pop-up on front. Outlook and friends might just create the window every time to have it pop-up. If that is true, you can create a small window that will never really show on the screen, but get the foreground property and will therefore be able to set it to your window.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nils2000</div><div class="date">1st December 2003, 09:28</div></div><div class="posttext">In that special case I'ld really like to do that, because when installing software, one shouldn't work with other programms. I think this is stated somewhere on the first dialog of the installer. The problem occurs because there is another application, which is installed from the installer. This application pops up a Readme and the application folder which overlap the installer.<br />
<br />
Isn't there a new window created when I use MUI_INSTALLOPTIONS_DISPLAY ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st December 2003, 13:08</div></div><div class="posttext">Setup wizards say a lot of things ;) It usually isn't really nessacry to close all other programs.<br />
<br />
Is there no command line switch that will tell the second installer to not pop-up the readme and the folder?<br />
<br />
A new window is created for InstallOptions pages, but it's not a top level window.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th December 2003, 13:35</div></div><div class="posttext">I can't believe I forgot about this (the first part tells you how to do what you want to do):<br />
<br />
http://www.installsite.org/pages/en/isp_ext.htm</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nils2000</div><div class="date">11th December 2003, 17:31</div></div><div class="posttext">Thanks,<br />
I've tried it, but it didn't work :(<br />
<br />
So I've done a bit more research and found another method:<br />
			HWND theForegroundWnd = ::GetForegroundWindow();<br />
			::AttachThreadInput(::GetWindowThreadProcessId( theForegroundWnd, NULL), ::GetCurrentThreadId(), TRUE);<br />
			BOOL retVal = ::SetForegroundWindow( hwndParent );<br />
			::AttachThreadInput( ::GetWindowThreadProcessId( theForegroundWnd, NULL), ::GetCurrentThreadId(), FALSE);<br />
<br />
but it didn't work either. I've no clue. Somewhere I've read that MS has disabled both methods but I don't know if it's true.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th December 2003, 17:01</div></div><div class="posttext">Well, the AttachThreadInput trick works for Banner, but for threads in the same process. Maybe the combination of both will do the trick.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">12th December 2003, 19:09</div></div><div class="posttext">Originally posted by Nils2000 <br />
Thanks,<br />
I've tried it, but it didn't work :(<br />
<br />
So I've done a bit more research and found another method:<br />
			HWND theForegroundWnd = ::GetForegroundWindow();<br />
			::AttachThreadInput(::GetWindowThreadProcessId( theForegroundWnd, NULL), ::GetCurrentThreadId(), TRUE);<br />
			BOOL retVal = ::SetForegroundWindow( hwndParent );<br />
			::AttachThreadInput( ::GetWindowThreadProcessId( theForegroundWnd, NULL), ::GetCurrentThreadId(), FALSE);<br />
<br />
but it didn't work either. I've no clue. Somewhere I've read that MS has disabled both methods but I don't know if it's true. <br />
<br />
add: SetFocus(hwndParent ); after SetForegroundWindow... (i have not tested this, but found it in my own code from and old app :) )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nils2000</div><div class="date">15th December 2003, 09:06</div></div><div class="posttext">::SetFocus doesn't make a change with the AttachThread-method.<br />
<br />
@kichik:<br />
SystemParametersInfo(...) fails with error-code ERROR_ACCESS_DENIED, when it is used to set the parameter. Reading the parameter works fine. So I don't think a combination of both methods would make any change.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th December 2003, 13:58</div></div><div class="posttext">According to MSDN:The calling thread must be able to change the foreground window, otherwise the call fails.So make sure you call it when you still have focus. .onGUIInit or the first page's pre or show function would probably work best.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>