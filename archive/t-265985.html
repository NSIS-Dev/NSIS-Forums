<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Starting a Windows service, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Starting a Windows service NSIS Discussion" />
	
	<title> Starting a Windows service [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Starting a Windows service</div>
<hr />
<div class="pda"><a href="t-265985.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=265985">Starting a Windows service</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MidnightJava</div><div class="date">17th February 2007, 15:02</div></div><div class="posttext">I created a simple silent installation script to install a Windows service using the System plug-in created by dselkirk, found here:<br />
<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=345<br />
<br />
My script is pasted below. The executable file is a java launcher (created with NSIS) that runs a java program that listens for connections on a specified port.<br />
<br />
When I launch rcb_serv.exe (the output file of my service insallation script), the service is created but not yet started (as expected). When I start the service using the Windows service manager, the java program begins running as expected. However, the Windows service manager believes that the service did not start. It throws the error:<br />
<br />
Error 1053: The service did not respond to the start or control request in a timely fashion<br />
<br />
Am I supposed to do something else in the NSIS script to make the service manager happy? Or is my program supposed to do something to complete the handshake?<br />
<br />
Here's my script:<br />
<br />
; Service Installer<br />
;--------------<br />
 <br />
Name &quot;RCB_Service_Install&quot;<br />
Caption &quot;RCB Service Installer&quot;<br />
OutFile &quot;rcb_serv.exe&quot;<br />
 <br />
SilentInstall silent<br />
AutoCloseWindow true<br />
ShowInstDetails nevershow<br />
<br />
!include servicelib.nsh<br />
!define EXE_FILE &quot;rcb.exe&quot;<br />
 <br />
Section &quot;&quot;<br />
    <br />
  !insertmacro SERVICE &quot;create&quot; &quot;rcb_server&quot;\<br />
   &quot;path=c:\Documents and Settings\&lt;my user name&gt;\My Documents\RCB\rcb.exe;\<br />
   autostart=1;display=rcb_server;&quot;<br />
   <br />
   <br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th February 2007, 15:15</div></div><div class="posttext">You can't start any executable as a service. A server executable must act as a service, call specific API functions and respond to specific messages.<br />
<br />
See more at MSDN:<br />
<br />
http://msdn2.microsoft.com/en-us/library/ms687416.aspx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MidnightJava</div><div class="date">21st February 2007, 01:20</div></div><div class="posttext">Thanks, I figured that was the case. I did find this (http://wrapper.tanukisoftware.org/doc/english/introduction.html) nifty open source tool for wrapping java server apps as Windows services and Unix daemons. It took me five minutes to create a Windows service with it.<br />
.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>