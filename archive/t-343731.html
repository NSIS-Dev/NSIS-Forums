<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" File Command with \\?\ added to a variable path, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  File Command with \\?\ added to a variable path NSIS Discussion" />
	
	<title> File Command with \\?\ added to a variable path [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  File Command with \\?\ added to a variable path</div>
<hr />
<div class="pda"><a href="t-343731.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=343731">File Command with \\?\ added to a variable path</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dfranck</div><div class="date">2nd April 2012, 23:02</div></div><div class="posttext">I am trying to use the File command to add files to my installer.  Due to the location of the files on my system,  I run into the 255 char limit, thus requiring the need for \\?\ added to the front of my path.  I initially was using a relative path to the files I wanted included in my installer, but when the limit was reached I had to change direction.<br />
<br />
Does anyone have any good ideas, short of moving the files to a location with a shorter path in my directory tree, as to how I can use the File command with a variable path name.<br />
<br />
<br />
I have tried passing a variable as Filespec in hopes that the value of the variable would be used, but the macro seems to pass the variable name instead of the path stored in Filespec. <br />
<br />
!macro InstallFilesTo Path Filespec<br />
	SetOutPath &quot;${Path}&quot;<br />
	File /r &quot;${Filespec}&quot;<br />
!macroend<br />
<br />
I have tried many different approaches over the past few days, some syntax really questionable.... I am at a loss.  I have tried pretty much everything I have seen posted online thus far, but I believe my situation is unique, because the installer I am trying to write needs to be able to be compiled on many different user's systems.<br />
<br />
Any and all help is greatly appreciated.<br />
<br />
Thanks,<br />
Dan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">3rd April 2012, 22:44</div></div><div class="posttext">What actually happens when you do File &quot;\\?\c:\insane\path\myfile.ext&quot;? Our internal limit is probably 1024 but the MS C run time might be getting in the way. Windows is limited to MAX_PATH (256) for ansi apps so you must use the unicode fork for any chance of the \\?\ prefix working. Other solutions are: subst, UNC drive mapping or junctions/symlinks to get the path shorter...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dfranck</div><div class="date">4th April 2012, 15:20</div></div><div class="posttext">Anders, first off, thank you for your response.  When I use the absolute path,  File &quot;\\?\c:\insane\path\myfile.ext&quot;, the compiler and the resulting installer works great.  <br />
<br />
When I pass  &quot;\\?\c:\insane\path\myfile.ext&quot; in a $tempDir variable, the compiler gives File: &quot;$tempDir&quot; -&gt; no files found. message along with Error in script &quot;test.nsi&quot; on line 21 -- aborting creation process.<br />
<br />
I guess it doesn't make sense to me why I can use the absolute path when hard coded but not when passed in with a variable. <br />
<br />
i.e.<br />
<br />
File /r &quot;\\?\c:\insane\path\myfile.ext&quot;<br />
<br />
Var /GLOBAL tempDir<br />
StrCpy $tempDir &quot;\\?\c:\insane\path\myfile.ext&quot;<br />
File /r $tempDir<br />
<br />
<br />
I will take a look at the unicode fork and your other suggestions to see if I can get them to work for me before I say give and use a batch file to relocate the files, compile the installer, and then move the files back...or something along those lines.<br />
<br />
Thanks again for the help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">4th April 2012, 16:06</div></div><div class="posttext">File does not take variables! Use a define...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dfranck</div><div class="date">4th April 2012, 21:45</div></div><div class="posttext">Anders, here is my solution...thanks again for the help.<br />
<br />
I'm using a batch file where I <br />
<br />
SET &quot;INSANE_PATH=\\?\%LONG_PATH%&quot;<br />
<br />
&quot;%NSIS%\makensis.exe&quot; /DFILE_DIRECTORY=%INSANE_PATH% myInstaller.nsi &gt; myInstaller.log<br />
<br />
<br />
Then in my nsi script I just call<br />
<br />
File /r ${FILE_DIRECTORY}<br />
<br />
This does the trick... Thanks again for the advice.<br />
<br />
~Dan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">6th April 2012, 21:41</div></div><div class="posttext">this might help too<br />
http://forums.winamp.com/showthread.php?t=343779</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dfranck</div><div class="date">6th April 2012, 21:47</div></div><div class="posttext">Thanks Brummelchen, I'll talk a look</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>