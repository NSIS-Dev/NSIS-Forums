<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How I can work with COM?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How I can work with COM? NSIS Discussion" />
	
	<title> How I can work with COM? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How I can work with COM?</div>
<hr />
<div class="pda"><a href="t-253398.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=253398">How I can work with COM?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">16th August 2006, 09:43</div></div><div class="posttext">v := CreateOleObject(&lt;Some OLE Automation&gt;);<br />
v.&lt;Some Method&gt;;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">16th August 2006, 18:45</div></div><div class="posttext">How?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">16th August 2006, 20:11</div></div><div class="posttext">write a plugin or use the system plugin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">16th August 2006, 20:30</div></div><div class="posttext">How I can work with COM by using system plugin?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">17th August 2006, 04:48</div></div><div class="posttext">http://forums.winamp.com/showthread.php?postid=1445638#post1445638</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">17th August 2006, 08:25</div></div><div class="posttext">Thank you very much <br />
<br />
BUT how I can set input/get output BSTR parameter?<br />
<br />
Code below does not work:<br />
System::Call &quot;$0-&gt;8(t 'Some Text')&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">17th August 2006, 09:11</div></div><div class="posttext">Code below works:<br />
<br />
System::Call &quot;$0-&gt;8(w 'Some Text')&quot;<br />
<br />
BUT my string has many #0#0#...#0 in the end.<br />
How I can input string correctly?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">17th August 2006, 19:39</div></div><div class="posttext">use SysAllocString/SysFreeString when you are working with BSTR's</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">18th August 2006, 07:27</div></div><div class="posttext">String again has many #0#0#...#0 in the end<br />
<br />
System::Call &quot;oleaut32::SysAllocString(w 'Some Text') w .r1&quot;<br />
System::Call &quot;$0-&gt;8(w r1)&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th August 2006, 11:55</div></div><div class="posttext">You should treat the value returned by SysAllocString as a pointer (`i`). This way, no conversion will be done by System and the string won't be touched. If it still contains those characters, you can be sure it's because of the functions used and not because of BSTR mistreatment.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>