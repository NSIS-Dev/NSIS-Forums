<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Detection of MSDE at user's computer, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Detection of MSDE at user's computer NSIS Discussion" />
	
	<title> Detection of MSDE at user's computer [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Detection of MSDE at user's computer</div>
<hr />
<div class="pda"><a href="t-261052.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=261052">Detection of MSDE at user's computer</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">4th December 2006, 11:42</div></div><div class="posttext">Hello Everybody,<br />
<br />
Warm greetings from India!<br />
<br />
I'm making an installer to install MSDE 2000. Its working fine (thanks for the help esp. to Bruno). Now I'm doing some refinement to it. How can I detect whether MSDE is installed in the user's computer or not. For the time being version/instance checking is not required...just want to check MSDE of any version is installed or not before I start MSDE Installation from NSIS Installer.<br />
<br />
With regards,<br />
<br />
p.s.:I've gone through materials on this forum related to this issue, but unable to decipher any simple and short solution to it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">4th December 2006, 12:56</div></div><div class="posttext">Did you try from NSIS manual 4.9.4.10 IfFileExists,<br />
or E.1.2 Locate, or get values from regisrty?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">5th December 2006, 11:56</div></div><div class="posttext">Yes, for the time being I'm using IfFileExists to detect MSDE in user's computer. But this method is not proper as the MSDE may be installed into any other location other then the default location. I'm giving the code, for others :<br />
<br />
${If} ${FileExists} &quot;$PROGRAMFILES\Microsoft SQL Server\80\Tools\Binn\sqlmangr.exe&quot;<br />
    MessageBox MB_ICONEXCLAMATION|MB_OK &quot;MSDE already installed!$\nSetup is terminating the installation process.&quot;<br />
   Quit<br />
${Endif}<br />
<br />
But friends, this is not the actual solution! I'm looking for some way to trap it from the registry. Precisely, if there is a way to read from the control panel's 'Add/Remove program lists. Is someone listening?!<br />
<br />
With regards,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">5th December 2006, 12:31</div></div><div class="posttext">Hi Swapan Das!<br />
<br />
I found an article. They mention a registry key. Maybe you can have a look in the registry of your installation and see what's in there.<br />
<br />
HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer (\Setup)<br />
<br />
[1] http://www.betav.com/Files/Content/Whitepapers/msde_files/msde.htm<br />
<br />
Have a nice day!<br />
<br />
Cheers<br />
<br />
Bruno</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">5th December 2006, 12:43</div></div><div class="posttext">I see...<br />
You may want to read the NSIS manual at 4.9.2 Registry, INI, File Instructions.<br />
ex<br />
ReadRegStr $R0 HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\&lt;MSDE Record&gt;&quot; &quot;UninstallString&quot;<br />
StrCmp $R0 '' _notInstalled</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">5th December 2006, 12:50</div></div><div class="posttext">Huh, there's a wiki article about SQL Server. It might be useful for you.<br />
<br />
http://nsis.sourceforge.net/How_to_tell_what_version_of_SQLServer_is_installed<br />
<br />
Cheers<br />
<br />
Bruno</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">8th December 2006, 07:30</div></div><div class="posttext">Dear Friends!<br />
<br />
Thanks a lot for all the help. After going through this issue while considering all the suggestions from all of you, I came with one solution.<br />
<br />
If anyone is interested, can try my this tested code:<br />
<br />
   ReadRegStr $R0 HKLM \<br />
   &quot;SOFTWARE\Microsoft\MSSQLServer\Setup&quot; SQLPath ;ProductCode<br />
   ${If} $R0 == &quot;&quot;<br />
     ;MessageBox MB_ICONEXCLAMATION|MB_OK &quot;SQL Server not detected, press any key to install&quot;<br />
   ${Else}<br />
     MessageBox MB_ICONEXCLAMATION|MB_OK &quot;SQL Server/MSDE already installed!$\nSQL Path:$R0$\nSetup is terminating the installation process.&quot;<br />
     Quit<br />
   ${EndIf}<br />
<br />
<br />
With regards,<br />
Swapan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">8th December 2006, 10:09</div></div><div class="posttext">cool :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">8th December 2006, 10:35</div></div><div class="posttext">I've also posted a separate post for this at:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=261330</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">8th December 2006, 11:06</div></div><div class="posttext">Hi Swapan!<br />
<br />
Thank you very much for this posting!<br />
<br />
Could you create a wiki page on nsis.sf.net? There is a special section which deals with software detection. It would be nice to have this one there!<br />
<br />
Cheers<br />
<br />
Bruno</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">8th December 2006, 11:14</div></div><div class="posttext">Thanks Bruno!<br />
<br />
I'll definitely do it. But give me some time as I'm pre-occupied with many tasks at office. You know office job!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">8th December 2006, 11:27</div></div><div class="posttext">No worries! It's just great to collect those information in a central place so everyone has easy access... :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TypoBound</div><div class="date">9th December 2006, 13:40</div></div><div class="posttext">I found it handier to look for the instance instead. If it doesn't exist, I then check for the SQL service. I can then poll that to see if my database already exists or prompt for install.<br />
<br />
In any case, you don't have to worry about where it is installed by looking for services. I use the same approach for IIS. If I don't find the service I throw up a prompt to install and execute sysocmgr on yes or abort virtual web page install on no. At least for me this has made a very clean approach for handling missing prerequisits.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>