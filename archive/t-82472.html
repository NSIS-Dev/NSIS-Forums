<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to get a directory deleted *after* executing a file?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to get a directory deleted *after* executing a file? NSIS Discussion" />
	
	<title> How to get a directory deleted *after* executing a file? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to get a directory deleted *after* executing a file?</div>
<hr />
<div class="pda"><a href="t-82472.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=82472">How to get a directory deleted *after* executing a file?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">japheth</div><div class="date">26th March 2002, 19:24</div></div><div class="posttext">Okay, I want to do the following: Install a bunch of files to a certain directory, and then at the end of the install it executes a file that compiles certain files and copies others.  After the executable is done that, I want to remove the directories that the executable copied/compiled the files from.  However I tried using the following nsi script:<br />
<br />
# [Installer Attributes]<br />
Name &quot;Norse Mini Mod&quot;<br />
OutFile &quot;norseinstaller.exe&quot;<br />
Caption &quot;Norse Mini Mod Setup&quot;<br />
BrandingText &quot;&quot;<br />
<br />
<br />
<br />
# [Additional Installer Settings ]<br />
ShowInstDetails show<br />
AutoCloseWindow false<br />
SilentInstall normal<br />
CRCCheck on<br />
SetCompress auto<br />
SetDatablockOptimize on<br />
SetOverwrite on<br />
<br />
# [Background Gradient]<br />
BGGradient 808000 804040 FFFFFF<br />
<br />
# [Files]<br />
Section &quot;default&quot;<br />
SetOutPath $INSTDIR<br />
File /r &quot;C:\Program Files\Black Isle\BGII - SoA\norsemod&quot;<br />
File &quot;C:\Program Files\Black Isle\BGII - SOA\NorseSetup.exe&quot;<br />
SectionEnd<br />
<br />
# [Directory Selection]<br />
InstallDir &quot;$PROGRAMFILES\Black Isle\BGII - SOA&quot;<br />
<br />
# [Registry Get]<br />
InstallDirRegKey HKLM \<br />
                 &quot;Software\Microsoft\Windows\CurrentVersion\App Paths\BG2Main.Exe&quot; \<br />
                 &quot;Path&quot;<br />
<br />
<br />
DirShow show<br />
DirText &quot;Select your default BGII - SoA directory.&quot;<br />
<br />
;called when the installer is nearly finished initializing<br />
Function .onInit<br />
<br />
;message box<br />
MessageBox MB_YESNO &quot;This will install the Norse Mini Mod. Continue?&quot; IDYES NoAbort<br />
Abort<br />
NoAbort:<br />
FunctionEnd<br />
<br />
;called when the user hits the 'cancel' button<br />
Function .onUserAbort<br />
MessageBox MB_YESNO &quot;Abort install?&quot; IDYES NoCancelAbort<br />
Abort<br />
NoCancelAbort:<br />
FunctionEnd<br />
<br />
;called when the install was successful<br />
Function .onInstSuccess<br />
CreateDirectory &quot;$INSTDIR\backup&quot;<br />
Exec &quot;$INSTDIR\NorseSetup.exe norsemod/norsemod.tp2 --tlkout dialog.tlk&quot;<br />
RMDir /r &quot;$INSTDIR\norsemod&quot;<br />
Delete &quot;$INSTDIR\norsesetup.debug&quot;<br />
<br />
FunctionEnd<br />
<br />
<br />
<br />
#eof!<br />
<br />
And it runs the executable at the end, howvever it deletes the directory before the executable can compile/copy the files to the appropriate directories...<br />
<br />
Any thoughts on how to do this?<br />
<br />
Thanx in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">26th March 2002, 20:37</div></div><div class="posttext">japbeth,<br />
<br />
use ExecWait instead of Exec to execute the decompressor. Then it will wait for the decompressor to finish and shut down and then the script will continue and remove the dir. Maybe you should also include a delete command to delete the files in this dir first otherwise it will not be possible to remove the dir. It's only a suggestion, because I don't know what the decompressor will do with the source files. Maybe it will already delete them, hey, I don't know...<br />
<br />
So anyway, just use ExecWait...<br />
<br />
Good luck, greetz,<br />
-Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sdbarker</div><div class="date">26th March 2002, 21:13</div></div><div class="posttext">And why clear the branding text if you have nothing else to put there and didn't modify the source?<br />
<br />
That just seems mean to me.<br />
<br />
-Scott</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pomflain</div><div class="date">26th March 2002, 23:09</div></div><div class="posttext">Originally posted by japheth <br />
File /r &quot;C:\Program Files\Black Isle\BGII - SoA\norsemod&quot;<br />
File &quot;C:\Program Files\Black Isle\BGII - SOA\NorseSetup.exe&quot;<br />
<br />
<br />
<br />
I'd make sure on all instructions similar to this that you change them to something like File /r '&quot;C:\Program Files\Black Isle\BGII - SoA\norsemod&quot;'<br />
<br />
Don't think there should be any problems,  but with the spaces in the path you might end up with it delimiting the path incorrectly in some commands.  I think that NSIS will straighten things up for you internally,  but better to double check anyway.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>