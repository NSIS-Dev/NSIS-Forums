<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Game patch file checking, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Game patch file checking NSIS Discussion" />
	
	<title> Game patch file checking [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Game patch file checking</div>
<hr />
<div class="pda"><a href="t-162815.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=162815">Game patch file checking</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">tonefox2</div><div class="date">2nd January 2004, 03:44</div></div><div class="posttext">OK, kichick has helped me to start off on IRC the other day..<br />
<br />
Now, I am stuck at a task that I am not sure if NSIS is capable of.<br />
<br />
I am making a patch for one of my games. I have a demo version of the game, and then I have the full registered version of the game.<br />
<br />
I am makin a universal patch for the game that updates all previous versions to the latest.<br />
<br />
Here's my problem.<br />
<br />
I want the installer to check to see if the user has the demo version installed or the full registered version installed. If they have the demo installed, I want the installer to DISALLOW installation of the patch; and if they do have the full registered version installed, then the installer will continue to patch the game. My reason for this is so that people can't download the demo, and then patch it to get a free full version.<br />
<br />
Anyways, kichik said I could do this with the IfFileExists function.<br />
<br />
Here's what I want it to do. IfFileExists can check all of the user's disk drives for the file &quot;Final Furlong Demo.exe&quot; or &quot;Final Furlong.exe&quot; and then do the corresponding action, either abort installation or continue.<br />
<br />
Is this possible with NSIS or not?<br />
<br />
Much thanks goes out to kichik who helped me get started!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">2nd January 2004, 05:56</div></div><div class="posttext">You can't do that with IfFileExists command.  To acheive that you will have to use these commands: FindFirst, FindNext and FindClose.<br />
<br />
Good luck.<br />
<br />
Vytautas<br />
<br />
P.S.  Can you just check to see if the specified file is a demo or not by comparing the file's CRC or something?  E.G. Is the game executable for a demo version different from a full version and if so then if you compare the CRC of the demo to the users version and they match then don't install the patch. ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tonefox2</div><div class="date">2nd January 2004, 08:37</div></div><div class="posttext">OK,<br />
<br />
I'm sorry. I forget to say that I am making a patch for the FULL REGISTERED version ONLY. If a person wants to update their version of the demo, they can download a WinZip file for free, since it is the demo.<br />
<br />
Can you please outline how I would go about using FindFirst, FindNext, FindClose functions? Maybe a lil example that has to do with my situation?<br />
<br />
Sorry, but the NSIS User Guide doesn't explain HOW to use the functions well.<br />
<br />
Thanks for the help!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd January 2004, 12:21</div></div><div class="posttext">You search for a file using FindFirst, FindNext and FindNext like this (http://nsis.sourceforge.net/archive/viewpage.php?pageid=266). But that's (edit)not(/edit) what you want. You don't want to search the entire hard disk, that would be pointless and time consuming. You want the user to direct you to the directory where the game is installed (in the directory page) and not let the user pass to the next page if that directory doesn't contain &quot;Final Furlong.exe&quot;. This you do with IfFileExists. The place you should check in is .onVerifyInstDir or the leave function of the directory page. See Examples\waplugin.nsi for an example usage of .onVerifyInstDir and Examples\LobicLib.nsi for an example of a leave function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tonefox2</div><div class="date">2nd January 2004, 20:15</div></div><div class="posttext">OK,<br />
<br />
Thanks kichik.<br />
<br />
I went to the link you provided, and copied the COMPLETE EXAMPLE. Changed it to look for my game's EXE.<br />
<br />
However, it's not working. For testing, I removed all versions of the game from my computer before running the patch. It didn't seem like it looked for my game's EXE, and it installed with no problems.<br />
<br />
What is the problem?<br />
<br />
Also, if you find any other problems, make sure and point them out, because I remember seeing a lot more bugs post installation after I ran the test patch.<br />
<br />
edited by kichik: attach large scripts next time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tonefox2</div><div class="date">3rd January 2004, 04:42</div></div><div class="posttext">I want to thank sgt-d for helping me with this..<br />
<br />
The installer now correctly checks to see if the person has the full version of my game installed. If it doesn't it exits.<br />
<br />
sgt-d, you da man!:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgt-d</div><div class="date">3rd January 2004, 05:35</div></div><div class="posttext">w00t w00t!<br />
<br />
glad to hear you got it working!<br />
<br />
:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd January 2004, 12:00</div></div><div class="posttext">Do not copy and paste large scripts, attach them. This helps the forum stay clean and easy to read. The forum provides a vast database of questions and answers regarding NSIS, so it's important it stays clean and easy to read so users may easily find the answer they are looking for.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>