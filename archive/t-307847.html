<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" focus issue of application after installation, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  focus issue of application after installation NSIS Discussion" />
	
	<title> focus issue of application after installation [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  focus issue of application after installation</div>
<hr />
<div class="pda"><a href="t-307847.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=307847">focus issue of application after installation</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">shahil</div><div class="date">1st July 2009, 10:13</div></div><div class="posttext">the issue is that when the user selects to run the application when the installation is complete, the application runs but the focus does not remain on the application.<br />
<br />
can anybody please tell that is this NSIS issue or its my application issue.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Netsurfer24</div><div class="date">21st October 2010, 11:09</div></div><div class="posttext">*push*<br />
<br />
I have the same question.<br />
I am using the Modern UI and on the finish page MUI_FINISHPAGE_RUN to run my installed application.<br />
<br />
This works so far without any problems but as shahil already wrote, the focus is not set to the application window.<br />
<br />
Is there anything to do to change this behaviour?<br />
<br />
Thanks,<br />
Gunther</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st October 2010, 12:23</div></div><div class="posttext">You need to use FindWindow followed by user32::SetForegroundWindow. You need to set up a RUN function and use Exec in there.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">21st October 2010, 13:56</div></div><div class="posttext">I sounds to me like the issue could be that whatever you are starting up is slow to create its window and the installer window closes fast, in that case, the app would lose the &quot;right&quot; to be foreground.<br />
<br />
Just using a RUN function and a 2 second sleep after the exec might fix it</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Netsurfer24</div><div class="date">21st October 2010, 14:00</div></div><div class="posttext">Stu,<br />
<br />
thanks for your reply. I forgot to mention that I am already using a RUN function as I am using the UAC plugin and therefor the application should be started by the user who originated the setup.<br />
<br />
Currently my function looks as follows:<br />
<br />
Function ExecAppFile    <br />
    !insertmacro UAC_AsUser_ExecShell 'open' '$INSTDIR\opencpn.exe' '' '$INSTDIR' ''<br />
	FindWindow $0 '#32770' '' 0<br />
	System::Call &quot;user32::SetForegroundWindow(i r0) i.&quot;<br />
FunctionEnd<br />
<br />
So in &quot;normal&quot; cases you only need the UAC_AsUser_ExecShell macro and the application gets automatically the focus.<br />
<br />
But in some cases my application starts with a message box before the application window exists. The window title is localized (by the application) so I don't know it. And as there is also no window parent I cannot use it, too.<br />
<br />
The only thing I know for sure in this case is the name of the process.<br />
Is there any way to bring the message box to the front?<br />
<br />
Thanks,<br />
Gunther</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">21st October 2010, 15:28</div></div><div class="posttext">Try using just &quot;Sleep 3000&quot; no findwindow etc</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Netsurfer24</div><div class="date">21st October 2010, 15:47</div></div><div class="posttext">Anders,<br />
<br />
I could have come to this conclusion myself as actually adding a sleep command seems to be the &quot;universal&quot; solution for all my problems .... ;)<br />
Try using just &quot;Sleep 3000&quot; no findwindow etc<br />
I tried it with 2000 and it worked.<br />
<br />
But all these ugly sleep commands are a bit unpleasent, especially as e.g. the time needed by the application to launch may differ from user/ system to user/ system.<br />
<br />
Do you think that a loop checking for the process being started could be an alternative?<br />
<br />
Thanks,<br />
Gunther</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st October 2010, 16:22</div></div><div class="posttext">I'd use a loop until IsWindow returns true and shorten the Sleep.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Netsurfer24</div><div class="date">21st October 2010, 17:11</div></div><div class="posttext">Stu,<br />
<br />
my problem is how to get the handle of the message box?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">21st October 2010, 17:36</div></div><div class="posttext">Ugly hack:<br />
Exec '&quot;calc.exe&quot;'<br />
loop:<br />
    System::Call user32::GetForegroundWindow()i.r0<br />
    Sleep 200<br />
    IntCmpU $0 $hwndparent loop</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Netsurfer24</div><div class="date">21st October 2010, 17:44</div></div><div class="posttext">Ugly or not - better than just the sleep command in any case! ;)<br />
Thanks Anders - works! :up:<br />
<br />
Gunther</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>