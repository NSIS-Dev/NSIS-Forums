<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" simple installer problems, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  simple installer problems NSIS Discussion" />
	
	<title> simple installer problems [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  simple installer problems</div>
<hr />
<div class="pda"><a href="t-356579.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=356579">simple installer problems</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">NateS</div><div class="date">1st March 2013, 18:30</div></div><div class="posttext">Hey guys, I have made an installer for a little app and deployed it to users. It works great for me on Win7 x64, where UAC is disabled and I'm admin. However, I'm getting reports that running it does nothing on Win7 x64. Other users say they have to run it with admin privileges.<br />
<br />
Can someone please take a quick look at my installer and tell me if I need to add anything to make it work with different Windows security configurations, etc? Here it is:<br />
http://paste2.org/p/3021946<br />
<br />
Also I should note that (after installation) when my app runs it needs to be able to write files to the installation directory. Will this be a problem if someone installs it to Program Files as a user that isn't an admin? It is really important that my app do this, I can't just change it to write in the user directory. Will I have to have my app always run as admin? How do I do that?<br />
<br />
I hate to have to ask for help, but it really isn't clear to me what I need to do for various Windows setups and I can't possibly test them all myself. Thanks in advance! :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">1st March 2013, 19:34</div></div><div class="posttext">You can use the access control plugin but it is not a good idea!<br />
<br />
InstallDir &quot;$PROGRAMFILES\Spine&quot;<br />
InstallDirRegKey HKCU &quot;Software\Spine&quot; &quot;&quot;<br />
RequestExecutionLevel user<br />
<br />
Those 3 lines are a problem, use &quot;RequestExecutionLevel admin&quot;+HKLM+$PROGRAMFILES OR &quot;RequestExecutionLevel user&quot;+HKCU+$LocalAppData\Programs</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NateS</div><div class="date">1st March 2013, 20:18</div></div><div class="posttext">I don't understand your suggestion. This syntax doesn't compile:<br />
&quot;RequestExecutionLevel admin&quot;+$PROGRAMFILES <br />
<br />
I only use HKCU, so I don't think I need HKLM. Ooooh! I just noticed I had &quot;user&quot; and not &quot;admin&quot;! That should help!<br />
<br />
What about when my program runs? Can it write to Program Files just fine? If not, what can I do?<br />
<br />
Should I change the default installation from Program Files to something else, like $LocalAppData\Programs? This seems weird, as I think Program Files is the default for all installers I've ever seen.<br />
<br />
Edit: why is the access control plugin a bad idea?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Highcoder</div><div class="date">1st March 2013, 23:12</div></div><div class="posttext">Should I change the default installation from Program Files to something else, like $LocalAppData\Programs? This seems weird, as I think Program Files is the default for all installers I've ever seen.<br />
<br />
 Edit: why is the access control plugin a bad idea?<br />
<br />
It depends... Why your app needs to write to your installdir? Config files? Logs?<br />
<br />
For unterstanding: Such things like Logs and settings should not be written to $Programfiles because this is a protected folder. You could normally write to it with admin rights only. This is the folder for the program itself. installed by admin and readable/executable for users. Stuff like Settings Logs (generated and used by the user) etc. should be stored to %localappdata% or %appdata%. They are intended for userdata.<br />
Under XP 99% of all users had admin rights. So many programmers did not pay attention because it worked anyway. That was the reason for most Compatibility issues of the programs later at the beginning of Windows Vista.<br />
<br />
So there are 3 ways to fix that:<br />
The lazy way: Dont install to $programfiles. Install to $LocalAppData. You dont have to redesign your app.<br />
The right way as mentioned by Microsoft: Redesign your app. Seperate programfiles and userdata.<br />
The dirty hack (not recomended as Anders said): grant write access for users to $PROGRAMFILES\Spine with access control plugin. But this is a bad idea because malware can now easily modify your exe and dll files to do bad stuff. <br />
<br />
Now itÂ´s your choice ;)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>