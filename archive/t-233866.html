<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Set Focus to a Field, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Set Focus to a Field NSIS Discussion" />
	
	<title> Set Focus to a Field [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Set Focus to a Field</div>
<hr />
<div class="pda"><a href="t-233866.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=233866">Set Focus to a Field</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MikeSchinkel</div><div class="date">23rd December 2005, 13:02</div></div><div class="posttext">I'm trying to use the function on the wiki Set Focus to a Control (http://nsis.sourceforge.net/Set_Focus_to_a_Control) but there is only an abstract function call syntax and no tangible working example and I'm having a hard time figuring out how to call it. <br />
<br />
Can someone please help and give me a real simple example that would set the focus to the first text field in a custom dialog? Better yet, add it to the wiki too?<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">23rd December 2005, 15:27</div></div><div class="posttext">It is quite simple really.<br />
<br />
Page Custom ShowCustom1<br />
<br />
Var HWND<br />
<br />
Function .onInit<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;ioFile.ini&quot;<br />
FunctionEnd<br />
<br />
Function ShowCustom1<br />
<br />
  !insertmacro MUI_HEADERTEXT &quot;blah&quot; &quot;blah&quot;<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;ioFile.ini&quot;<br />
  Pop $HWND ;HWND (handle) of dialog<br />
<br />
    Push &quot;$PLUGINSDIR\ioFile.ini&quot; ;Page .ini file where the field can be found.<br />
    Push &quot;$HWND&quot; ;Page handle you got when reserving the page.<br />
    Push &quot;1&quot; ;Field number to set focus.<br />
    Call SetFocus<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_SHOW<br />
<br />
FunctionEnd<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">********</div><div class="date">23rd January 2007, 19:32</div></div><div class="posttext">From version 2.24 InstallOptions has native FOCUS flag</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">23rd January 2007, 20:22</div></div><div class="posttext">NSIS version 2.24 is still to be released :)<br />
<br />
InstallOptions will be v2.45 then.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">darshanaltekar</div><div class="date">20th March 2007, 05:46</div></div><div class="posttext">SetFocus is not working can anyone tell me why?<br />
<br />
<br />
Page custom organisation_id_pre organisation_id_leave<br />
<br />
function organisation_id_pre<br />
  strcmp $ALREADY_INSTALLED &quot;YES&quot; 0 +2<br />
    abort<br />
  !insertmacro MUI_HEADER_TEXT &quot;Required Information&quot; &quot;Please enter following required information&quot;<br />
  InstallOptions::Dialog &quot;$PLUGINSDIR\Organisation_id.ini&quot;<br />
  Pop $HWND_org_id<br />
functionend<br />
<br />
<br />
<br />
function organisation_id_leave<br />
  ReadINIStr $0 &quot;$PLUGINSDIR\Organisation_id.ini&quot; 'Field 2' &quot;State&quot; ;l$ip_addr  &quot;$PLUGINSDIR\Organisation_id.ini&quot; 'Field 4' &quot;State&quot;<br />
  ReadINIStr $1 &quot;$PLUGINSDIR\Organisation_id.ini&quot; 'Field 3' &quot;State&quot;<br />
  ReadINIStr $2 &quot;$PLUGINSDIR\Organisation_id.ini&quot; 'Field 4' &quot;State&quot;<br />
  ReadINIStr $3 &quot;$PLUGINSDIR\Organisation_id.ini&quot; 'Field 5' &quot;State&quot;<br />
<br />
  ${If} $0 &gt; '255'<br />
  messagebox mb_ok &quot;IP address not valid from IP field 1&quot;<br />
  Push &quot;$PLUGINSDIR\Organisation_id.ini&quot; ;Page .ini file where the field can be found.<br />
  Push &quot;$HWND_org_id&quot; ;Page handle you got when reserving the page.<br />
  Push &quot;2&quot; ;Field number to set focus.<br />
  Call SetFocus<br />
 !insertmacro MUI_INSTALLOPTIONS_SHOW<br />
;    WriteINIStr &quot;$PLUGINSDIR\Organisation_id.ini&quot; 'Field 2' 'Flags' 'FOCUS'<br />
;    FlushINI $TEMP\something.ini<br />
;    !insertmacro MUI_INSTALLOPTIONS_READ $R1 &quot;$PLUGINSDIR\Organisation_id.ini&quot; &quot;Field 2&quot; &quot;HWND&quot;<br />
;    SendMessage $R1 ${WM_SETFOCUS} 0 0<br />
;    SendMessage $R1 ${WM_SETTEXT} 0 &quot;STR:8080&quot;<br />
 ; abort<br />
  ${EndIf}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th March 2007, 20:36</div></div><div class="posttext">Don't call MUI_INSTALLOPTIONS_SHOW in the leave function. That should only be called in the page callback function (organistaion_id_pre in your case).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">darshanaltekar</div><div class="date">21st March 2007, 11:03</div></div><div class="posttext">If i dont display the page again how the chages will get reflect in UI ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st March 2007, 20:56</div></div><div class="posttext">If you call Abort, the page isn't left. If you call InstallOptions again, you just create another page with the old settings and will create trouble when the pages are destroyed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">darshanaltekar</div><div class="date">22nd March 2007, 13:01</div></div><div class="posttext">Then what i should i do to reflect the changes</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd March 2007, 08:35</div></div><div class="posttext">As I said, call Abort.Function leave<br />
Abort # in case leaving the page should be stopped...<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrtech</div><div class="date">20th July 2007, 18:32</div></div><div class="posttext">I was able to use this thread to set focus to a known field number, but how do I focus the next button?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th July 2007, 18:40</div></div><div class="posttext">!include WinMessages.nsh<br />
#...<br />
GetDlgItem $0 $HWNDPARENT 1<br />
SendMessage $HWNDPARENT ${WM_NEXTDLGCTL} $0 1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrtech</div><div class="date">20th July 2007, 19:05</div></div><div class="posttext">tried a few things, but where in this logic would that go, i've commented out what I have my hacky SetFocus to remove focus from the text object that I have in there:<br />
<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;eula.ini&quot;<br />
<br />
  Pop $HWND ;HWND of dialog<br />
<br />
  ; this removes the focus from the text field on my custom<br />
  ; form so that pressing enter continues the install flow.<br />
  ;Push &quot;eula.ini&quot;found.<br />
  ;Push &quot;$HWND&quot;<br />
  ;Push &quot;7&quot; ; this is a custom label<br />
  ;Call SetFocus<br />
<br />
  Call SetOtherGoodies ; <br />
<br />
  ; Now show the dialog<br />
  !insertmacro MUI_INSTALLOPTIONS_SHOW</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th July 2007, 19:10</div></div><div class="posttext">Ah, you want the focus to go there right away. I don't think that'd be possible without modifying InstallOptions. But why do it? Since the next button is the default button, it'd still go to the next page when you hit enter.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrtech</div><div class="date">20th July 2007, 19:12</div></div><div class="posttext">that's just it, it doesn't I have call just after the Pop to:<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $DLGITEM &quot;eula.ini&quot; &quot;Field 4&quot; &quot;HWND&quot;<br />
  SetCtlColors $DLGITEM 0x000000 0xFFFFFF<br />
<br />
Field 4 is my text box, focus is put there and pressing enter doesn't work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th July 2007, 19:14</div></div><div class="posttext">Have you tried using the FOCUS flag instead?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrtech</div><div class="date">20th July 2007, 19:18</div></div><div class="posttext">that's another one, where does the focus flag go for the next button?  been trying to do searches here in the forums for about 15-20 minutes, but no examples of where to use the focus flags, etc.  pardon my moronic ways...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th July 2007, 19:20</div></div><div class="posttext">Not for the Next button, for the control you want focus for. Without any settings, the first control should receive focus and the Next button should still be the default button, so pressing enter should still go to the next page.<br />
<br />
There is no setting to set focus to the Next button, because there shouldn't be any need to do that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrtech</div><div class="date">20th July 2007, 19:29</div></div><div class="posttext">how do I set the focus flag to one of my controls?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th July 2007, 19:32</div></div><div class="posttext">Just add Flags=FOCUS in the INI file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrtech</div><div class="date">20th July 2007, 19:38</div></div><div class="posttext">ok, I had tried that on the label and link controls just to get the focus off of the text control, but I have to see what's up. thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th July 2007, 19:43</div></div><div class="posttext">It won't work on those controls. It knows which controls can receive focus and will ignore the flag if they can't. But weren't you saying you wanted the focus on the Next button rather than off it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrtech</div><div class="date">20th July 2007, 19:46</div></div><div class="posttext">yeah, but if I can get the focus off the text control (as I have done with the SetFocus function) then the Next button will behave like the default button and continue when pressing enter.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th July 2007, 19:48</div></div><div class="posttext">It should behave that way with or without focus.<br />
<br />
How about you attach an example? I'm starting to get confused about what exactly happens and what exactly you want.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrtech</div><div class="date">20th July 2007, 20:41</div></div><div class="posttext">here's a stripped version of what I'm trying to do, thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th July 2007, 20:43</div></div><div class="posttext">What's the BackButton plug-in?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrtech</div><div class="date">20th July 2007, 20:47</div></div><div class="posttext">oops just remove that puppy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th July 2007, 20:54</div></div><div class="posttext">Ah, you didn't mention it's a multiline text field. It might have the same bug as with the richedit control where it eats up Enter and Escape even though it doesn't have the ES_WANTRETURN style. Instead of leaving them be, it acts on the dialog manager's behalf and sends WM_COMMAND to IDOK or WM_CLOSE to its parent dialog. But its parent dialog is just a internal dialog which doesn't handle this. Unlike richedit, edit controls don't have EN_MSGFILTER so if it's really the case, it'd require subclassing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrtech</div><div class="date">20th July 2007, 20:56</div></div><div class="posttext">ok, I'll stick with my SetFocus hack for now, thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th September 2007, 20:48</div></div><div class="posttext">Raymond Chen (http://blogs.msdn.com/oldnewthing/archive/2007/08/20/4470527.aspx) confirms this is the same bug as with the Rich Edit control. His post also links to another post stating the solution, similar to what Sunjammer used for the RichEdit. I need to think how this can be implemented for nsDialogs as you obviously do want the controls eat the Enter key in some cases.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>