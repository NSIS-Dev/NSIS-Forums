<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to check if a soft is installed?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to check if a soft is installed? NSIS Discussion" />
	
	<title> How to check if a soft is installed? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to check if a soft is installed?</div>
<hr />
<div class="pda"><a href="t-212558.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=212558">How to check if a soft is installed?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">oldfox</div><div class="date">7th April 2005, 23:54</div></div><div class="posttext">Hi all, I just discovered that wonderfull NSIS!!<br />
Powerful, but complicated :)<br />
<br />
So, I am trying to look if a software is installed, and if it is, to read its path in the registery.<br />
<br />
I know I can find this in the registery<br />
<br />
HKEY_LOCAL_MACHINE\SOFTWARE\ActiveState\ActiveTcl\8.4.8.0 --&gt; (default) REG_SZ C:\thepath<br />
<br />
But I didn't manage to find it and then read it ...<br />
<br />
Im pretty unfamiliar with registery function of NSIS and even with the registery by itself...<br />
<br />
<br />
This <br />
http://nsis.sourceforge.net/archive/nsisweb.php?page=875&amp;instances=0,11,770<br />
<br />
seems interesting (if I succeed to install it :D ), but I don't know exactly what to put in args to find my key and then read it.<br />
<br />
Thx for your help!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfox</div><div class="date">8th April 2005, 00:32</div></div><div class="posttext">After some tests, <br />
IfKeyExists &quot;HKLM&quot; &quot;SOFTWARE&quot; &quot;ActiveState&quot; <br />
<br />
Seems to be working, but I still can't test deeper to check the subdirectories. <br />
<br />
(IfKeyExists &quot;HKLM&quot; &quot;SOFTWARE&quot; &quot;ActiveState\ActiveTcl\8.4.8.0&quot;) doesn't works.<br />
<br />
<br />
<br />
And I still can't access that RG_SZ with the path :'(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">8th April 2005, 01:46</div></div><div class="posttext">I've not tested it, but just looking at the macro code at http://nsis.sourceforge.net/archive/nsisweb.php?page=875&amp;instances=0,11,770, it appears that you should be calling the macro this way:<br />
<br />
<br />
!insertmacro IfKeyExists &quot;HKLM&quot; &quot;SOFTWARE\ActiveState\ActiveTcl&quot; &quot;8.4.8.0&quot;<br />
pop $R0<br />
<br />
<br />
$R0 should then contain 1 if the reg key exists.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">8th April 2005, 01:46</div></div><div class="posttext">IfKeyExists?? never heard of that one and i can't find it in the docs. anyway, that question was asked so often (and is surely listed in the faq (http://nsis.sourceforge.net/support/faq/)) that you should find the when answer searching this forum.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfox</div><div class="date">8th April 2005, 09:45</div></div><div class="posttext">!insertmacro IfKeyExists &quot;HKLM&quot; &quot;SOFTWARE\ActiveState\ActiveTcl&quot; &quot;8.4.8.0&quot;<br />
pop $R0<br />
<br />
Doesn't work : it don't find the key any more :(<br />
<br />
How can I do ?<br />
<br />
<br />
<br />
<br />
I have another little problem : how to code a if {} else {} section?<br />
<br />
I don't find explanations in the documentation and my try isn't working :<br />
<br />
<br />
StrCmp $R0 &quot;1&quot; Iftest NIftest<br />
NIftest:<br />
	MessageBox MB_OK &quot;Didn't find it $R0&quot;<br />
Iftest:<br />
MessageBox MB_OK '&quot;Finded!! Pas besoin installer $R0&quot;'<br />
		<br />
<br />
<br />
When it don't find it, it also execute the &quot;Finded&quot; code :'(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">8th April 2005, 21:01</div></div><div class="posttext">Do you have permissions to that part of the registry?<br />
<br />
You've got me curious now, too, so when I get some free time later tonight, I can try to setup a quick test.<br />
<br />
The If-then code should be included in the LogicLib header.  (There's an example of its usage in the examples folder included with NSIS setup.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">9th April 2005, 01:42</div></div><div class="posttext">OK, it seems to work for me.<br />
<br />
Since I didn't have the software, I manually edited my registry to create the proper keys.  Then, I built a very simply install using the exact same code from Vytautas at the archive site listed above.  It worked exactly like I expected it to.<br />
<br />
I zipped the REG file I used along with the same script (attached).  Feel free to look it over.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">9th April 2005, 01:43</div></div><div class="posttext">Oops! Forgot the attachment.  I'll try that again...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>