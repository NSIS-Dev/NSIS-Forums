<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Open folder/program, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Open folder/program NSIS Discussion" />
	
	<title> Open folder/program [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Open folder/program</div>
<hr />
<div class="pda"><a href="t-207391.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=207391">Open folder/program</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MechMykl</div><div class="date">10th February 2005, 02:16</div></div><div class="posttext">This may have been asked before and the search came up with to much and being specific wont find anything probably, how would I:<br />
<br />
add a check box to execute a program on close<br />
<br />
and<br />
<br />
add a check bow to open a folder<br />
<br />
please provide exact code if you can, im kinda new at this ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bnicer</div><div class="date">10th February 2005, 04:57</div></div><div class="posttext">See if this helps:<br />
<br />
  !define MUI_FINISHPAGE_SHOWREADME &quot;$INSTDIR\index.htm&quot;<br />
  !define MUI_FINISHPAGE_SHOWREADME_TEXT &quot;&amp;Start ${PRODUCT_NAME}&quot;<br />
  ;!define MUI_FINISHPAGE_SHOWREADME_NOTCHECKED<br />
<br />
or, for a function:<br />
<br />
  !define MUI_FINISHPAGE_SHOWREADME_FUNCTION &quot;post_install&quot;<br />
  !define MUI_FINISHPAGE_SHOWREADME_TEXT &quot;&amp;Start ${PRODUCT_NAME}&quot;<br />
  ;!define MUI_FINISHPAGE_SHOWREADME_NOTCHECKED<br />
<br />
For both:<br />
<br />
  !insertmacro MUI_PAGE_FINISH<br />
<br />
A function would be:<br />
<br />
  Function post_install<br />
    ExecShell open &quot;$INSTDIR\help\readme.rtf&quot;<br />
  FunctionEnd<br />
<br />
Good luck!<br />
<br />
ps:<br />
<br />
This thread might have an answer regarding 2 checkboxes:<br />
<br />
install options : page custom like a welcome page (http://forums.winamp.com/showthread.php?s=&amp;threadid=205674&amp;highlight=checkbox)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MechMYkl</div><div class="date">11th February 2005, 02:52</div></div><div class="posttext">;NSIS Modern User Interface<br />
;Start Menu Folder Selection Example Script<br />
;Written by Joost Verburg<br />
<br />
;--------------------------------<br />
;Include Modern UI<br />
<br />
  !include &quot;MUI.nsh&quot;<br />
<br />
;--------------------------------<br />
;General<br />
<br />
  ;Name and file<br />
  Name &quot;The Fro Icon Pack&quot;<br />
  OutFile &quot;The Fro Icon Pack.exe&quot;<br />
<br />
  ;Default installation folder<br />
  InstallDir &quot;$PROGRAMFILES\HQubed\The Fro Icon Pack&quot;<br />
  <br />
  ;Get installation folder from registry if available<br />
  InstallDirRegKey HKCU &quot;Software\The Fro Icon Pack&quot; &quot;&quot;<br />
<br />
;--------------------------------<br />
;Interface Settings<br />
<br />
  Var MUI_TEMP<br />
  Var STARTMENU_FOLDER<br />
  !define MUI_HEADERIMAGE<br />
  !define MUI_ABORTWARNING<br />
<br />
;--------------------------------<br />
;Pages<br />
<br />
  !insertmacro MUI_PAGE_WELCOME<br />
  !insertmacro MUI_PAGE_LICENSE &quot;C:\Documents and Settings\Michael\My Documents\Web <br />
<br />
Pages\Projects\Installers\The Fro Icon Pack\assets\License.txt&quot;<br />
  !define MUI_STARTMENUPAGE_REGISTRY_ROOT &quot;HKCU&quot; <br />
  !define MUI_STARTMENUPAGE_REGISTRY_KEY &quot;Software\The Fro Icon Pack&quot; <br />
  !define MUI_STARTMENUPAGE_REGISTRY_VALUENAME &quot;Start Menu Folder&quot;<br />
  !insertmacro MUI_PAGE_STARTMENU Application $STARTMENU_FOLDER<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_PAGE_FINISH<br />
  !insertmacro MUI_UNPAGE_WELCOME<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_UNPAGE_INSTFILES<br />
  !insertmacro MUI_UNPAGE_FINISH<br />
<br />
;--------------------------------<br />
;Languages<br />
 <br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
;--------------------------------<br />
;Installer Sections<br />
<br />
Section &quot;The Fro Icon Pack&quot; SecBF<br />
  <br />
  SetOutPath &quot;$INSTDIR\&quot;<br />
<br />
File /r &quot;C:\Documents and Settings\Michael\My Documents\Web Pages\Projects\Installers\The Fro <br />
<br />
Icon Pack\files\&quot;<br />
  <br />
  ;Store installation folder<br />
  WriteRegStr HKCU &quot;$PROGRAMFILES\HQubed\The Fro Icon Pack&quot; &quot;&quot; $INSTDIR<br />
  <br />
  ;Create uninstaller<br />
  WriteUninstaller &quot;$INSTDIR\Uninstall.exe&quot;<br />
  <br />
  !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
    <br />
    ;Create shortcuts<br />
    CreateDirectory &quot;$SMPROGRAMS\HQubed\The Fro Icon Pack&quot;<br />
    CreateShortCut &quot;$SMPROGRAMS\HQubed\The Fro Icon Pack\Uninstall.lnk&quot; &quot;$INSTDIR\Uninstall.exe&quot;<br />
  <br />
  !insertmacro MUI_STARTMENU_WRITE_END<br />
<br />
SectionEnd<br />
<br />
;--------------------------------<br />
;Descriptions<br />
<br />
  ;Language strings<br />
  LangString DESC_SecBF ${LANG_ENGLISH} &quot;The first version of The Fro Icon Pack, includes many <br />
<br />
different authors praised icons.&quot;<br />
<br />
  ;Assign language strings to sections<br />
  !insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />
    !insertmacro MUI_DESCRIPTION_TEXT ${SecBF} $(DESC_SecBF)<br />
  !insertmacro MUI_FUNCTION_DESCRIPTION_END<br />
 <br />
;--------------------------------<br />
;Uninstaller Section<br />
<br />
Section &quot;Uninstall&quot;<br />
<br />
  ;ADD YOUR OWN FILES HERE...<br />
<br />
  Delete &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
  RMDir &quot;$INSTDIR&quot;<br />
  <br />
  !insertmacro MUI_STARTMENU_GETFOLDER Application $MUI_TEMP<br />
    <br />
  Delete &quot;$SMPROGRAMS\$MUI_TEMP\Uninstall.lnk&quot;<br />
  <br />
  ;Delete empty start menu parent diretories<br />
  StrCpy $MUI_TEMP &quot;$SMPROGRAMS\$MUI_TEMP&quot;<br />
 <br />
  startMenuDeleteLoop:<br />
	ClearErrors<br />
    RMDir $MUI_TEMP<br />
    GetFullPathName $MUI_TEMP &quot;$MUI_TEMP\..&quot;<br />
    <br />
    IfErrors startMenuDeleteLoopDone<br />
  <br />
    StrCmp $MUI_TEMP $SMPROGRAMS startMenuDeleteLoopDone startMenuDeleteLoop<br />
  startMenuDeleteLoopDone:<br />
<br />
  DeleteRegKey /ifempty HKCU &quot;Software\The Fro Icon Pack&quot;<br />
<br />
SectionEnd<br />
<br />
Sorry its long, where would I put it? And I notice there are a few header errors ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MechMykl</div><div class="date">11th February 2005, 03:01</div></div><div class="posttext">One more thing, how can i delete all of the files i installed<br />
<br />
C:\Program Files\HQubed\The Fro Icon Pack<br />
<br />
I want to delete the folder &quot;The Fro Icon Pack&quot; and all of its contents and delete<br />
<br />
&quot;The Fro Icon Pack&quot; but not HQubed (in either) on the start menu, ty in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th February 2005, 11:24</div></div><div class="posttext">You put it where the MUI readme says you should put it, which is:Page Settings apply to a single page and should be set before inserting a page macro. If you have multiple pages of one type and you want to set a setting for all them, put the setting before each page macro.To delete a directory use RMDir.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MechMykl</div><div class="date">12th February 2005, 04:46</div></div><div class="posttext">This is ticking me off to no end, and im sorry this is probably gonna get anoying<br />
<br />
<br />
;--------------------------------<br />
;Uninstaller Section<br />
<br />
Section &quot;Uninstall&quot;<br />
<br />
  ;ADD YOUR OWN FILES HERE...<br />
  RMDir &quot;$INSTDIR\&quot;<br />
  Delete    &quot;$INSTDIR\Uninstall.exe&quot;<br />
  <br />
  !insertmacro MUI_STARTMENU_GETFOLDER Application $MUI_TEMP<br />
    <br />
  Delete &quot;$SMPROGRAMS\$MUI_TEMP\Uninstall.lnk&quot;<br />
  <br />
  ;Delete empty start menu parent diretories<br />
  StrCpy $MUI_TEMP &quot;$SMPROGRAMS\$MUI_TEMP&quot;<br />
 <br />
  startMenuDeleteLoop:<br />
	ClearErrors<br />
    RMDir $MUI_TEMP<br />
    GetFullPathName $MUI_TEMP &quot;$MUI_TEMP\..&quot;<br />
    <br />
    IfErrors startMenuDeleteLoopDone<br />
  <br />
    StrCmp $MUI_TEMP $SMPROGRAMS startMenuDeleteLoopDone startMenuDeleteLoop<br />
  startMenuDeleteLoopDone:<br />
<br />
  DeleteRegKey /ifempty HKCU &quot;Software\The Fro Icon Pack&quot;<br />
<br />
SectionEnd<br />
<br />
How to i delete the start menu folder ...\The Fro Icon Pack (but not its parent)<br />
<br />
And what is the code for the rm dir thing.<br />
<br />
Once I get this I shouldnt have any more questions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th February 2005, 10:59</div></div><div class="posttext">The code you've got there is correct, assuming it's an exact copy from the start menu example. If it doesn't work, you've probably got a problem in the code that writes the start menu path to the registry at installation time. Attach (don't just paste it in the message, it's hard to read) the entire script so the problem can be spotted.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MechMykl</div><div class="date">12th February 2005, 20:48</div></div><div class="posttext">--Attached</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>