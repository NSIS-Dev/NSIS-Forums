<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How can I DISABLE a windows service?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How can I DISABLE a windows service? NSIS Discussion" />
	
	<title> How can I DISABLE a windows service? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How can I DISABLE a windows service?</div>
<hr />
<div class="pda"><a href="t-206681.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=206681">How can I DISABLE a windows service?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Chilli24</div><div class="date">2nd February 2005, 16:53</div></div><div class="posttext">Hi, I have a question.<br />
How can I DISABLE a windows service?<br />
what instructions should I use?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd February 2005, 17:23</div></div><div class="posttext">Use the services plugin from here:<br />
http://nsis.sourceforge.net/archive/download.php<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Chilli24</div><div class="date">2nd February 2005, 21:50</div></div><div class="posttext">Thanks for your reply but that doesn't help me very much. I need to DISABLE a service not to pause or stop it.<br />
Any ideea how I can do that?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd February 2005, 12:09</div></div><div class="posttext">Tried...<br />
services::SendServiceCommand 'disable' 'MyServiceName'<br />
...?<br />
<br />
If that doesn't work, use this (DOS command):<br />
http://www.computerhope.com/disable.htm#03<br />
<br />
You can call it like so:<br />
ReadEnvStr $R0 COMSPEC<br />
nsExec::Exec &quot;'$R0' /C '&lt;command&gt;'&quot;<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Chilli24</div><div class="date">3rd February 2005, 12:26</div></div><div class="posttext">I've tried both examples. None of them worked. Here is the code:<br />
Example 1:<br />
<br />
Section &quot;disable help&quot;<br />
  services::SendServiceCommand 'disable' 'helpsvc'<br />
SectionEnd<br />
; here the compiler says invalid command<br />
<br />
Example 2:<br />
<br />
Section &quot;disable help&quot;<br />
  ReadEnvStr $R0 COMSPEC<br />
  nsExec::ExecToLog &quot;'$R0' /C 'disable helpsvc'&quot;<br />
SectionEnd<br />
; no errors but it does nothing<br />
<br />
Am I doing something wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Chilli24</div><div class="date">3rd February 2005, 17:10</div></div><div class="posttext">I found the answer. Here is the code to disable Help and Support service for example:<br />
<br />
nsExec::ExecToLog 'sc config helpsvc start= &quot;disabled&quot;'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th February 2005, 20:23</div></div><div class="posttext">Look at the bottom of the following page:<br />
<br />
http://www.experts-exchange.com/Programming/Programming_Languages/MFC/Q_20806097.html<br />
<br />
It shouldn't be hard to compile that as a plug-in. You can also compile it as a regular DLL and call it with the System plug-in.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Chilli24</div><div class="date">4th February 2005, 23:05</div></div><div class="posttext">I wasn't able to compile that as a dll file. It gave me some errors. I've created a different dll but I'm not sure is perfectly build though. I've also read the &quot;Calling an external DLL using the System.dll plugin&quot; article but I didn't quite understand how to call from inside .nsi the function from my dll file.<br />
If someone has time to help I would appreciate that.<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th February 2005, 23:26</div></div><div class="posttext">The DLL you've attached doesn't have any exported functions, so there's nothing to call.<br />
<br />
Open up Contrib\ExDLL\exdll.dsw and add the code in exdll.c. Compile it in release mode and you should your plug-in ready for usage in the Plugins folder. To use it, use this in your script:ExDLL::ExportedFunctionName parameters</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Chilli24</div><div class="date">4th February 2005, 23:48</div></div><div class="posttext">Thanks. I will try this. But, do you think that the dll file is good for what I need? Do you think the function ReconfigureSampleService is correctly build?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>