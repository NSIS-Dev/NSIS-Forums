<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Can't make windows go away, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Can't make windows go away NSIS Discussion" />
	
	<title> Can't make windows go away [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Can't make windows go away</div>
<hr />
<div class="pda"><a href="t-274015.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=274015">Can't make windows go away</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MidnightJava</div><div class="date">7th July 2007, 22:15</div></div><div class="posttext">I'm using kichik's WinList program to obtain window classes and window names for all the windows in my app, so I can provide a shortcut to stop execution of the app. When I launch the executable that does this, the app GUI and tray icon go away, but most of the windows that I tried to close are still shown to be alive in WinList, and the corresponding Windows process is therefore still running.<br />
<br />
I've tried WM_CLOSE, WM_QUIT, and WM_DESTROY, but most of he windows remain. My script is below, and I've attached before and after screen captures (to this post and the next one), to show you what I see in WinList before and after executing the script.<br />
<br />
Does anyone have any idea how I can make these windows go away?<br />
<br />
; Stop RCB Client<br />
;--------------<br />
 <br />
Name &quot;StopRCB&quot;<br />
Caption &quot;Stop RCB Client&quot;<br />
OutFile &quot;stopRCBClient.exe&quot;<br />
 <br />
SilentInstall silent<br />
AutoCloseWindow true<br />
ShowInstDetails neverShow<br />
<br />
!include WinMessages.nsh<br />
#Module | Window Class from WinList<br />
#tray.dll | JDIC Tray<br />
!define TRAY_WNDCLASS &quot;JDIC_Tray&quot;<br />
!define TRAY_WNDTITLE &quot;Tray Window&quot;<br />
#awt.dll | SunAwtDialog<br />
!define ICON_WNDCLASS &quot;SunAwtDialog&quot;<br />
!define ICON_WNDTITLE &quot;JDIC Tray Icon&quot;<br />
#awt.dll | SunAwtToolkit<br />
!define TK_WNDCLASS &quot;SunAwtToolkit&quot;<br />
!define TK_WNDTITLE &quot;theAwtToolkitWindow&quot;<br />
#awt.dll | IME<br />
!define IME_WNDCLASS &quot;IME&quot;<br />
!define IME_WNDTITLE &quot;Default IME&quot;<br />
#msctfime.ime | MSCTFIME UI<br />
!define MSCT_WNDCLASS &quot;MSCTFIME UI&quot;<br />
!define MSCT_WNDTITLE &quot;M&quot;<br />
#awt.dll SunAwtFRame<br />
!define GUI_WNDCLASS &quot;SunAwtFrame&quot;<br />
!define GUI_WNDTITLE &quot;RCB Control Panel&quot;<br />
 <br />
Section &quot;&quot;<br />
  Call stopClient<br />
SectionEnd<br />
 <br />
Function stopClient<br />
    Var /GLOBAL window_found<br />
    strCpy $window_found &quot;false&quot;<br />
  checkTrayWindow:<br />
    FindWindow $0 &quot;${TRAY_WNDCLASS}&quot; &quot;${TRAY_WNDTITLE}&quot;<br />
    StrCmp $0 0 checkIconWindow<br />
    DetailPrint &quot;Closing tray window&quot;<br />
    SendMessage $0 ${WM_CLOSE} 0 0<br />
    SendMessage $0 ${WM_QUIT} 0 0<br />
    SendMessage $0 ${WM_DESTROY} 0 0<br />
    strCpy $window_found &quot;true&quot;<br />
  checkIconWindow:<br />
    FindWindow $0 &quot;${ICON_WNDCLASS}&quot; &quot;${ICON_WNDTITLE}&quot;<br />
    StrCmp $0 0 checkTKWindow<br />
    DetailPrint &quot;Closing icon window&quot;<br />
    SendMessage $0 ${WM_CLOSE} 0 0<br />
    SendMessage $0 ${WM_QUIT} 0 0<br />
    SendMessage $0 ${WM_DESTROY} 0 0<br />
    strCpy $window_found &quot;true&quot;<br />
  checkTKWindow:<br />
    FindWindow $0 &quot;${TK_WNDCLASS}&quot; &quot;${TK_WNDTITLE}&quot;<br />
    StrCmp $0 0 checkIMEWindow<br />
    DetailPrint &quot;Closing toolkit window&quot;<br />
    SendMessage $0 ${WM_CLOSE} 0 0<br />
    SendMessage $0 ${WM_QUIT} 0 0<br />
    SendMessage $0 ${WM_DESTROY} 0 0<br />
    strCpy $window_found &quot;true&quot;<br />
  checkIMEWindow:<br />
    FindWindow $0 &quot;${IME_WNDCLASS}&quot; &quot;${IME_WNDTITLE}&quot;<br />
    StrCmp $0 0 checkMSCTWindow<br />
    DetailPrint &quot;Closing IME window&quot;<br />
    SendMessage $0 ${WM_CLOSE} 0 0<br />
    SendMessage $0 ${WM_QUIT} 0 0<br />
    SendMessage $0 ${WM_DESTROY} 0 0<br />
    strCpy $window_found &quot;true&quot;<br />
  checkMSCTWindow:<br />
    FindWindow $0 &quot;${MSCT_WNDCLASS}&quot; &quot;${MSCT_WNDTITLE}&quot;<br />
    StrCmp $0 0 checkGUI<br />
    DetailPrint &quot;Closing MSCT window&quot;<br />
    SendMessage $0 ${WM_CLOSE} 0 0<br />
    SendMessage $0 ${WM_QUIT} 0 0<br />
    SendMessage $0 ${WM_DESTROY} 0 0<br />
    strCpy $window_found &quot;true&quot;<br />
  checkGUI:<br />
    FindWindow $0 &quot;${GUI_WNDCLASS}&quot; &quot;${GUI_WNDTITLE}&quot;<br />
    StrCmp $0 0 checkGUI2<br />
    DetailPrint &quot;closing GUI window&quot;<br />
    SendMessage $0 ${WM_CLOSE} 0 0<br />
    SendMessage $0 ${WM_QUIT} 0 0<br />
    SendMessage $0 ${WM_DESTROY} 0 0<br />
    strCpy $window_found &quot;true&quot;<br />
  checkGUI2:<br />
    FindWindow $0 &quot;${GUI_WNDCLASS}&quot; &quot;&quot;<br />
    StrCmp $0 0 done<br />
    DetailPrint &quot;closing GUI2 window&quot;<br />
    SendMessage $0 ${WM_CLOSE} 0 0<br />
    SendMessage $0 ${WM_QUIT} 0 0<br />
    SendMessage $0 ${WM_DESTROY} 0 0<br />
    strCpy $window_found &quot;true&quot;<br />
  done:<br />
    strCmp $window_found &quot;false&quot; 0 exit <br />
    MessageBox MB_OK|MB_TOPMOST &quot;The RCB Client window could not be found. If you think$\r\<br />
                                 this is an error, look for a process named javaw and stop$\r\<br />
                                 it. But be aware that other Java processes may also be$\r\<br />
                                 named javaw.&quot;<br />
  exit:<br />
    return<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MidnightJava</div><div class="date">7th July 2007, 22:16</div></div><div class="posttext">Here's the &quot;after&quot; screen capture</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">7th July 2007, 22:37</div></div><div class="posttext">Try one of the available plugins, FCT for instance,<br />
<br />
http://nsis.sourceforge.net/FCT_plug-in</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th July 2007, 22:49</div></div><div class="posttext">I released WinList? Where?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">7th July 2007, 23:25</div></div><div class="posttext">Maybe there's another kichik...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MidnightJava</div><div class="date">8th July 2007, 00:56</div></div><div class="posttext">Originally posted by kichik <br />
I released WinList? Where?  <br />
<br />
I got it from this thread. Isn't that you?<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=128743&amp;highlight=running+kichik</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th July 2007, 01:13</div></div><div class="posttext">That is me. I was just under the impression I wrote it for my own use and never released it. I was a bit shocked to see that screenshot which looked exactly like winlist. Nice to see it's useful for something :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MidnightJava</div><div class="date">8th July 2007, 04:23</div></div><div class="posttext">Yes, kichik, it came in quite handy for me, since I'm trying to kill a Java app, and I didn't know what the window class and title would be as assigned by the JVM. So thanks for sharing it.<br />
<br />
And Red Wine, thanks for the tip on FCT. It works perfectly. And I only had to check for one of the windows out of the whole lot, and it killed the process as desired.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">8th July 2007, 17:58</div></div><div class="posttext">Obviously there's only one kichik! That's cool ;)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>