<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Checking for DOT NET Framework, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Checking for DOT NET Framework NSIS Discussion" />
	
	<title> Checking for DOT NET Framework [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Checking for DOT NET Framework</div>
<hr />
<div class="pda"><a href="t-278000.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=278000">Checking for DOT NET Framework</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jason_lakewhitn</div><div class="date">27th September 2007, 22:06</div></div><div class="posttext">;Check if DOT NET Installed<br />
;This is an extremly simple function for checking for<br />
;the Dot Net Framework.<br />
;It will abort the installation, so I advised to set it<br />
;as one of the very first things to execute.<br />
Function DotNetExists<br />
  Push $0<br />
  ReadRegStr $0 HKLM &quot;SOFTWARE\Microsoft\.NETFramework&quot; &quot;InstallRoot&quot;<br />
  ;Here are some IfFileExists statement in which we just 'fall' through.<br />
  IfFileExists $0v3.5.* 0 +3<br />
  StrCpy $0 &quot;v3.5&quot;          #This step is by no means needed. It is here just for<br />
  Goto DotNetHere           #the ability to 'DetailPrint' before leaving the function.<br />
  IfFileExists $0v3.0.* 0 +3<br />
  StrCpy $0 &quot;v3.0&quot;<br />
  Goto DotNetHere<br />
  IfFileExists $0v2.0.* 0 +3<br />
  StrCpy $0 &quot;v2.0&quot;<br />
  Goto DotNetHere<br />
  IfFileExists $0v1.1.4322 DotNetHereButNotVersion 0 #Here I use a build version to look for.<br />
  IfFileExists $0v1.0.*    DotNetHereButNotVersion DotNetNotHere #We found a version but too old or didn't find anything.<br />
  <br />
  /* A really short version.<br />
  IfFileExists $0v3.5.* DotNetHere 0<br />
  IfFileExists $0v3.0.* DotNetHere 0<br />
  IfFileExists $0v2.0.* DotNetHere 0<br />
  IfFileExists $0v1.1.* DotNetHere 0<br />
  IfFileExists $0v1.0.* DotNetHere DotNetNotHere<br />
  */<br />
  <br />
  <br />
  ;Depending on what you want to tell the user, the next area can be as large/small as needed.<br />
  <br />
  DotNetHereButNotVersion:<br />
    DetailPrint &quot;Found the DOT NET Framework but is&quot;<br />
    DetailPrint &quot;to old of a version.&quot;<br />
    DetailPrint &quot;Please install version 2.0 or higher.&quot;<br />
    MessageBox MB_OK &quot;Found the DOT NET Framework but is$\nto old of a version.$\nPlease install version 2.0 or higher.&quot;<br />
    Pop $0<br />
    Abort<br />
  <br />
  DotNetNotHere:<br />
    DetailPrint &quot;No versions of the DOT NET Framework were found!&quot;<br />
    DetailPrint &quot;Please install version 2.0 or higher.&quot;<br />
    Pop $0<br />
    Abort<br />
    <br />
  DotNetHere:<br />
    DetailPrint &quot;Found Version: $0 of the Dot NET Framework&quot;<br />
    Pop $0<br />
FunctionEnd<br />
<br />
<br />
Hope this helps.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th September 2007, 22:35</div></div><div class="posttext">Or use this with VersionCompare:<br />
System::Call `mscoree::GetCORVersion(w .R0, i ${NSIS_MAX_STRLEN}, *i) ?u`<br />
<br />
($R0 = v2.0.50727)<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>