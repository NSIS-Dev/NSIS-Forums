<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Strange vista bug, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Strange vista bug NSIS Discussion" />
	
	<title> Strange vista bug [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Strange vista bug</div>
<hr />
<div class="pda"><a href="t-277636.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277636">Strange vista bug</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">colm</div><div class="date">20th September 2007, 16:03</div></div><div class="posttext">Hi,<br />
<br />
I've got an app which installs and then runs itself.<br />
<br />
On XP it always works fine.<br />
<br />
<br />
<br />
On Vista, when the installer tries to run the app (using exec), the application runs, but without arguments.<br />
<br />
If I don't have it run automatically after installation, and instead double click on the start menu link it works fine.<br />
<br />
If I uninstall, and reinstall, it runs with arguments on installation.<br />
<br />
If I uninstall, and install *another* slightly different build the app runs without arguments again.<br />
<br />
<br />
Any suggestions?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st September 2007, 11:16</div></div><div class="posttext">It would be nice if you showed us your execute instruction.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">colm</div><div class="date">21st September 2007, 11:19</div></div><div class="posttext">Just<br />
<br />
Exec &quot;xulrunner.exe application.ini&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st September 2007, 11:30</div></div><div class="posttext">Try a full path:<br />
Exec `&quot;$INSTDIR\xulrunner.exe&quot; &quot;application.ini&quot;`<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">colm</div><div class="date">21st September 2007, 11:33</div></div><div class="posttext">I tried that. I also tried:<br />
<br />
* Using all permutations of quotes, folder references, starting folders.<br />
* Running it from the start menu link<br />
* Using nsExec, UAC...<br />
* Creating a separate exe which I run first, which then runs it.<br />
<br />
Same thing each time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st September 2007, 18:30</div></div><div class="posttext">If UAC is not the problem, I'm with Afrow on the paths. Try using full paths for both the executable and the INI.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">colm</div><div class="date">21st September 2007, 19:07</div></div><div class="posttext">I tried full paths on both.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st September 2007, 19:12</div></div><div class="posttext">Then it's UAC. When you say you've tried UAC, do you mean Anders' UAC plug-in?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">21st September 2007, 20:39</div></div><div class="posttext">Could it be a current directory issue? (even with full paths)<br />
<br />
When you say UAC, are you talking about using &quot;RequestExecutionLevel admin&quot; in the script, or the UAC plugin?<br />
<br />
My UAC plugin tries to be smart and add quotes if it thinks it is needed, this might be messing things up. If you can confirm that you are using UAC::Exec and it fails, I will try to look into it (but if a plain exec in a elevated installer instance fails, I'm not sure if there is anything my plugin can do about it)<br />
<br />
The fact that a different build breaks even if you did the startmenu thing to make it work for another install leads me to believe that Vista might store a hash or something of your program along with some kind of compatibility setting. What if you just replace the exe(no uninstall/reinstall) after you &quot;fixed&quot; it by running it from the start menu?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">colm</div><div class="date">22nd September 2007, 19:39</div></div><div class="posttext">&gt;Then it's UAC. When you say you've tried UAC, do you mean<br />
&gt;Anders' UAC plug-in?<br />
<br />
Yep. If it's definitely UAC, do you know how I might fix it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">22nd September 2007, 19:46</div></div><div class="posttext">I hate repeating myself, but, when you say UAC, are you talking about the UAC plugin ( http://nsis.sourceforge.net/UAC_plug-in ) or just UAC in general?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">colm</div><div class="date">22nd September 2007, 19:48</div></div><div class="posttext">Yep as in yes I used the UAC plugin (which didn't do anything different, although I may have been misusing it).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">22nd September 2007, 20:09</div></div><div class="posttext">could you upload your script (or a minimal version with the same problem)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobertStrong</div><div class="date">1st October 2007, 07:53</div></div><div class="posttext">This is due to a bug in Mozilla<br />
<br />
https://bugzilla.mozilla.org/show_bug.cgi?id=386826</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>