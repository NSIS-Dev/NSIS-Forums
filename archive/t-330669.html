<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" &quot;Error opening file for writing:&quot;, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  &quot;Error opening file for writing:&quot; NSIS Discussion" />
	
	<title> &quot;Error opening file for writing:&quot; [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  &quot;Error opening file for writing:&quot;</div>
<hr />
<div class="pda"><a href="t-330669.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330669">&quot;Error opening file for writing:&quot;</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">grap3_ap3</div><div class="date">17th May 2011, 14:56</div></div><div class="posttext">Hello, <br />
<br />
I have searched for the answer to this problem and have had NO luck so far. Please forgive me if I have overlooked the solution, but I am officially at a loss and don't understand the breakdown- I'm hoping someone here can shed some light on the problem. <br />
<br />
I have created an installer that was working flawlessly. However, I have started working on creating my User Guide which will have screen shots of the install which has me doing a fresh install on my test machine. I get the installer compiled and run it, which starts off fine. The problem comes when it starts writing files to disk. Apparently there is something causing (a breakdown with permissions presumably) because I get the following: <br />
<br />
Error opening file for writing:<br />
<br />
C:\Program Files\MyCompany\MyApp\settings<br />
<br />
Click Abort to stop the installation, <br />
Retry to try again, or<br />
Ignore to skip this file.<br />
<br />
When I skip the file, it gives the same error for the next (and each subsequent file) in the instructions. <br />
<br />
HOW can this be overcome? What have I done wrong in building my script? Please help me understand the error, how to overcome it, and how to prevent these problems in the future. <br />
<br />
Any input or advice is appreciated. <br />
<br />
Here is my file: <br />
<br />
; MyApp_installer.nsi<br />
;<br />
; This script is used to install My Application version 1.5.5<br />
<br />
;--------------------------------<br />
; includes<br />
; banner<br />
!include &quot;WinMessages.nsh&quot;<br />
<br />
; The name of the installer<br />
Name &quot;MyApp 1.5x&quot;<br />
<br />
; The file to write<br />
OutFile &quot;myApp1_5_5_setup.exe&quot;<br />
<br />
; Define License file<br />
LicenseData &quot;eula.txt&quot;<br />
<br />
; The default installation directory<br />
InstallDir $PROGRAMFILES\MyCompany\MyApp<br />
<br />
; Registry key to check for directory (so if you install again, it will <br />
; overwrite the old one automatically)<br />
InstallDirRegKey HKLM &quot;Software\MyApp&quot; &quot;Install_Dir&quot;<br />
<br />
; Request application privileges for Windows Vista<br />
RequestExecutionLevel admin<br />
<br />
;--------------------------------<br />
<br />
; Pages<br />
<br />
;!insertmacro MUI_PAGE_LICENSE &quot;eula.txt&quot; <br />
Page License<br />
Page components<br />
Page directory<br />
Page instfiles<br />
<br />
UninstPage uninstConfirm<br />
UninstPage instfiles<br />
<br />
;--------------------------------<br />
<br />
; The stuff to install<br />
Section &quot;MyApp Binary/Configs&quot; ;No components page, name is not important<br />
<br />
  SectionIn RO<br />
  ; Set output path to the installation directory.<br />
  SetOutPath $INSTDIR<br />
<br />
 ; Put file there<br />
 File eula.txt<br />
 File settings<br />
 File start_MyApp.bat<br />
 File stop_MyApp.bat<br />
 File MyApp.exe<br />
 File ServiceConfig.exe<br />
 File /r 'MyApp Libs'<br />
 File /r 'ServiceConfig Libs'<br />
 ; Write the uninstall keys for Windows<br />
 WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\MyApp&quot; &quot;DisplayName&quot; &quot;MyApp&quot;<br />
 WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\MyApp&quot; &quot;UninstallString&quot; '&quot;$INSTDIR\uninstall.exe&quot;'<br />
 WriteRegDWORD HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\MyApp&quot; &quot;NoModify&quot; 1<br />
 WriteRegDWORD HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\MyApp&quot; &quot;NoRepair&quot; 1<br />
 WriteUninstaller &quot;uninstall.exe&quot;<br />
<br />
 CreateDirectory &quot;$SMPROGRAMS\MyCompany\MyApp&quot;<br />
 CreateShortCut &quot;$SMPROGRAMS\MyCompany\MyApp\ServiceConfig.lnk&quot; &quot;$INSTDIR\ServiceConfig.exe&quot; &quot;&quot; &quot;$INSTDIR\ServiceConfig.exe&quot; 0<br />
 CreateShortCut &quot;$SMPROGRAMS\MyCompany\MyApp\start_MyApp.lnk&quot; &quot;$INSTDIR\start_MyApp.bat&quot; &quot;&quot; &quot;$INSTDIR\start_MyApp.bat&quot; 0<br />
 CreateShortCut &quot;$SMPROGRAMS\MyCompany\MyApp\stop_MyApp.lnk&quot; &quot;$INSTDIR\stop_MyApp.bat&quot; &quot;&quot; &quot;$INSTDIR\stop_MyApp.bat&quot; 0<br />
 CreateShortCut &quot;$SMPROGRAMS\MyCompany\MyApp\Uninstall.lnk&quot; &quot;$INSTDIR\uninstall.exe&quot; &quot;&quot; &quot;$INSTDIR\uninstall.exe&quot; 0<br />
SectionEnd ; end the section<br />
<br />
Section &quot;Install as service&quot;<br />
  nsSCM::Install /NOUNLOAD &quot;MyApp&quot; &quot;MyApp&quot; 16 2 $INSTDIR\MyApp.exe &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot;<br />
  Pop $0 ; return error/success<br />
SectionEnd<br />
<br />
Section &quot;Uninstall&quot;<br />
  ;stop and remove service<br />
  nsSCM::Stop &quot;MyApp&quot;<br />
  nsSCM::Remove &quot;MyApp&quot;<br />
<br />
; Remove registry keys<br />
  DeleteRegKey HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\MyApp&quot; <br />
  DeleteRegKey HKLM SOFTWARE\MyApp<br />
<br />
; Remove files and uninstaller<br />
 Delete $INSTDIR\uninstall.exe<br />
 Delete $INSTDIR\settings<br />
 Delete $INSTDIR\start_MyApp.bat<br />
 Delete $INSTDIR\stop_MyApp.bat<br />
 Delete $INSTDIR\MyApp.exe<br />
 Delete $INSTDIR\ServiceConfig.exe<br />
 Delete $INSTDIR\eula.txt<br />
 Delete &quot;$INSTDIR\MyApp Libs\*.*&quot;<br />
 Delete &quot;$INSTDIR\ServiceConfig Libs\*.*&quot;<br />
<br />
; Remove shortcuts, if any<br />
  Delete &quot;$SMPROGRAMS\MyCompany\MyApp\*.*&quot;<br />
<br />
; Remove directories used<br />
  RMDir &quot;$INSTDIR\MyApp Libs\&quot;<br />
  RMDir &quot;$INSTDIR\ServiceConfig Libs\*.*&quot;<br />
  RMDir &quot;$INSTDIR&quot;<br />
  RMDir &quot;$SMPROGRAMS\MyCompany\MyApp\&quot;<br />
<br />
SectionEnd<br />
<br />
Section &quot;Start MyApp Service&quot;<br />
<br />
Exec '&quot;$INSTDIR\start_MyApp.bat&quot;'<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">17th May 2011, 19:20</div></div><div class="posttext">Did you shut down your application before you tried re-running the installer?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grap3_ap3</div><div class="date">17th May 2011, 19:48</div></div><div class="posttext">Indeed I did. <br />
<br />
Uninstalled the existing install which stops the service and deletes all the files. I have confirmed that this file does not exist before running the installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">17th May 2011, 20:33</div></div><div class="posttext">For one, you need to verify that you have admin access in the .onInit function. Requestexecutionlevel does nothing on older OSes or if UAC is turned off.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grap3_ap3</div><div class="date">18th May 2011, 14:57</div></div><div class="posttext">Thanks for the input, I will work on making that change. However, the admin access is only necessary because of creating and running the service AND being allowed to dilate a &quot;privileged&quot; port. The files should all be able to be accessed and written by users so I'm not sure that this change will make much difference in resolving my issue.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>