<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Change user account question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Change user account question NSIS Discussion" />
	
	<title> Change user account question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Change user account question</div>
<hr />
<div class="pda"><a href="t-139492.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=139492">Change user account question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dsteenburg</div><div class="date">19th June 2003, 05:33</div></div><div class="posttext">As part of my installation process, I am creating a new user account (postgres) in Windows 2K and would like to be able to change over to this new account to complete the installation process.  <br />
<br />
I've been through the archive but haven't seen anything like this.  Can it be done, or is it easiest to do a reboot and have the user log on to the new account?  <br />
<br />
If the latter is the better way to go, are there any examples of how to do this.  I have seen a lot of discussion in the archives about different pieces of this but I'm having trouble putting the pieces together, and am hoping there might be an example script that could help me see the process as a whole.  <br />
<br />
Thanks.<br />
<br />
Dave</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dsteenburg</div><div class="date">20th June 2003, 02:14</div></div><div class="posttext">Since I've had no nibbles, perhaps I should give more detail.  <br />
<br />
My strategy has been to use a &quot;resume upon reboot&quot; approach.  It does resume after reboot, but it starts all the way back at the beginning of the installation instead of jumping to the second part of the installation.  (Thus looping again through the reboot process.)  I'm not sure if it is my code that is at fault or simply where I am positioning it in the script.  <br />
<br />
At present I have positioned the code right after the configuration, language and data part of the script--just before the installation sections.  The pseudo-code goes like this.  <br />
<br />
Section 1<br />
Call function to see if there is a &quot;Step&quot; key in HKLM\Software\MySoftware<br />
If yes go to .ResumeFromReboot<br />
SectionEnd<br />
<br />
Section 2<br />
Do first part of installation<br />
Write to runonce registry key<br />
Write a &quot;Step&quot; key in HKLM\Software\MyProgram<br />
Reboot<br />
SectionEnd<br />
<br />
Section 3<br />
.ResumeFromReboot<br />
Do rest of installation stuff<br />
SectionEnd<br />
<br />
Is this structurally how it would be done, or am I on the wrong track?  <br />
<br />
Dave</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">20th June 2003, 11:07</div></div><div class="posttext">So you want a certain user to be logged in after you have restarted the system?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dsteenburg</div><div class="date">20th June 2003, 14:24</div></div><div class="posttext">Yep, that's my main purpose.  That way I can install and implement a PostgreSQL database more simply.  I don't know if I need to go all the way through a reboot to do it or whether there are some system calls I can make that can just do an automatic logoff and logon as 'postgres'. <br />
<br />
Dave</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">20th June 2003, 14:34</div></div><div class="posttext">Search the MSDN (http://msdn.microsoft.com) for Win32 API calls.<br />
<br />
If Windows supports it, you can call the API's using the System plug-in or (when it's complicated) write your own NSIS plug-in.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dsteenburg</div><div class="date">20th June 2003, 16:42</div></div><div class="posttext">For the logging off part I found Brainsucker showed how to do the System call-- found it at <br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=108930<br />
<br />
but when I run his example I get the message that 'System::Fullcall' is an invalid command.  Has the System plug-in changed?  I am new to using API calls so I am not sure where to go next.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">20th June 2003, 16:47</div></div><div class="posttext">Logging off is not that difficult, but I don't know how to automatically login a certain user. If you can't find an API call, maybe it's not possible.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th June 2003, 12:46</div></div><div class="posttext">The new syntax is:<br />
<br />
System::Call &quot;User32::ExitWindowsEx(i ${EWX_LOGOFF}, i 0) i .s&quot;<br />
Pop $0<br />
DetailPrint &quot;result - $0&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dsteenburg</div><div class="date">25th June 2003, 15:16</div></div><div class="posttext">Excellent! Thank you.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>