<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" deny all operating systems except for a few, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  deny all operating systems except for a few NSIS Discussion" />
	
	<title> deny all operating systems except for a few [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  deny all operating systems except for a few</div>
<hr />
<div class="pda"><a href="t-260847.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=260847">deny all operating systems except for a few</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">1st December 2006, 15:30</div></div><div class="posttext">Hello,<br />
<br />
I recently wrote asking how do I deny OS's.  However, after talking with a few people and more scenarios occurred to us.  All these what-ifs.<br />
<br />
So I would like the installer to FAIL for EVERY OS, but ALLOW a few...<br />
<br />
my pseudo code is as follows:  (this is be rather phpish/crap)<br />
<br />
Function .onInit<br />
<br />
switch ($operatingSystem)<br />
{<br />
  case &quot;Windows 2000&quot;;   // all editions<br />
  goto success;<br />
  break;<br />
  <br />
  case &quot;Windows XP&quot;      // only pro version<br />
  GetVersion::WindowsType<br />
  if $R0 == &quot;Home&quot; <br />
     goto failure;<br />
  else;<br />
     goto success;<br />
  break;<br />
  case &quot;Windows 2003&quot;;   // all editions <br />
   goto success;<br />
   break;<br />
 default:<br />
  goto failure;<br />
<br />
...<br />
<br />
function failure<br />
msgbox &quot;your $os is not supported.  please call 1-800-555-5555 for additional support.&quot;<br />
<br />
... pretty much 95,98,me should fail...so should vista all editions, and i dont know but XP 64-bit should fail too.  <br />
<br />
thanks for any help you can offer me :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">solwolf</div><div class="date">1st December 2006, 16:01</div></div><div class="posttext">dunno what api you were using to figure out the windows but i know HKEY_Local_Machine\Software\Microsoft\Windows NT\CurrentVersion shows the operating system on XP and win2000<br />
<br />
-Solwolf<br />
<br />
**also i dunno why you would restrict Home Edition from XP it is the same program with less security features.  program wise i don't see a difference of how it would run different.<br />
<br />
i could understand not supporting 95,98,ME but i don't see why you can't just note where you download the software that it is ONLY tested and developed in the Windows 2k XP enviornment.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">1st December 2006, 16:21</div></div><div class="posttext">Well because my manager hates XP Home.  So I told him I would do so.  Currently the way I have it, i allow all but deny a few.  we now want it deny all allow a few.<br />
<br />
Pretty much 2000 is fully supported, XP Pro is, not home, not media center, not tablet, not CE, and not 64 bit<br />
<br />
and all of vista is denied.<br />
<br />
i am just following instructions from the above.<br />
<br />
i am not sure if this works, it hasnt been tested yet<br />
<br />
${If} ${IsWinXP}<br />
   # use afrow's plug-in here<br />
   GetVersion::WindowsType<br />
   Pop $R0<br />
   StrCmp $R0 &quot;Home&quot; xp_home_error go_away<br />
${EndIf}<br />
<br />
xp_home_error:<br />
    MessageBox MB_OK|MB_ICONSTOP &quot;Windows XP Home Edition is not supported &quot; IDOK<br />
    Quit<br />
    <br />
${If} ${IsWin95}<br />
    MessageBox MB_OK|MB_ICONSTOP &quot;Windows 95 is not supported &quot; IDOK<br />
    Quit<br />
${EndIf}<br />
<br />
${If} ${IsWin98}<br />
    MessageBox MB_OK|MB_ICONSTOP &quot;Windows 98 is not supported&quot; IDOK<br />
    Quit<br />
${EndIf}<br />
<br />
${If} ${IsWinMe}<br />
    MessageBox MB_OK|MB_ICONSTOP &quot;Windows Millennium Edition is not supported &quot; IDOK<br />
    Quit<br />
${EndIf}<br />
<br />
${If} ${IsWinNT4}<br />
    MessageBox MB_OK|MB_ICONSTOP &quot;Windows NT is not supported &quot; IDOK<br />
    Quit<br />
${EndIf}<br />
<br />
<br />
but i want to reverse the idea.  this way i can allow operating systems one at a time as we support them.  and some obscure one wont get through.<br />
<br />
i am unsure how i can go by doing this</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">12th January 2007, 21:28</div></div><div class="posttext">The way I was tackling this was all wrong.<br />
I still rather deny all OS's but allow a few easily.<br />
<br />
I like to do soemthing like this<br />
<br />
  GetVersion::WindowsName<br />
  Pop $R0<br />
  StrCmp $R0 &quot;XP&quot; allow<br />
  StrCmp $R0 &quot;2000&quot; allow<br />
  StrCmp $R0 &quot;Server 2003&quot; allow<br />
...<br />
  else  deny<br />
<br />
i dont see any ways like how i would do it in C to get this done.<br />
<br />
the problem is, my prior code seemed not work work.<br />
<br />
;${If} ${IsWinXP}<br />
;   # use afrow's plug-in here<br />
;   GetVersion::WindowsType<br />
;   Pop $R0<br />
;   StrCmp $R0 &quot;Home&quot; xp_home_error go_away<br />
;${EndIf}<br />
<br />
;xp_home_error:<br />
;    MessageBox MB_OK|MB_ICONSTOP &quot;Windows XP Home Edition is not supported&quot; IDOK<br />
;    Quit<br />
    <br />
;${If} ${IsWin95}<br />
;    MessageBox MB_OK|MB_ICONSTOP &quot;Windows 95 is not supported&quot; IDOK<br />
;    Quit<br />
;${EndIf}<br />
<br />
;${If} ${IsWin98}<br />
;    MessageBox MB_OK|MB_ICONSTOP &quot;Windows 98 is not supported&quot; IDOK<br />
;    Quit<br />
;${EndIf}<br />
<br />
;${If} ${IsWinMe}<br />
;    MessageBox MB_OK|MB_ICONSTOP &quot;Windows Millennium Edition is not supported&quot; IDOK<br />
;    Quit<br />
;${EndIf}<br />
<br />
;${If} ${IsWinNT4}<br />
;    MessageBox MB_OK|MB_ICONSTOP &quot;Windows NT is not supported&quot; IDOK<br />
;    Quit<br />
;${EndIf}<br />
<br />
;go_away:<br />
<br />
and go away simply went with the rest of the prog.<br />
<br />
what is happening is, win2k it seems is being detected as XP Home so it gets the error and quits.<br />
<br />
i thought it would be easier to deny all but allow a few so some weird versions of windows cant slip through.<br />
<br />
any ideas how to improve/change this??  i know ive asked this in hte past but i really am desperate in getting help right now onm htis!  thanks so much!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>