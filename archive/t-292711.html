<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstall: a  folder not found error message., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstall: a  folder not found error message. NSIS Discussion" />
	
	<title> Uninstall: a  folder not found error message. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstall: a  folder not found error message.</div>
<hr />
<div class="pda"><a href="t-292711.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=292711">Uninstall: a  folder not found error message.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">NEHOG</div><div class="date">4th June 2008, 14:01</div></div><div class="posttext">When my uninstaller runs, sometimes (not always) we see the message:<br />
<br />
---------------------------<br />
Settings<br />
---------------------------<br />
C:\Documents and Settings\All Users\Application Data\Product Name\Settings refers to a location that is unavailable. It could be on a hard drive on this computer, or on a network. Check to make sure that the disk is properly inserted, or that you are connected to the Internet or your network, and then try again. If it still cannot be located, the information might have been moved to a different location.<br />
---------------------------<br />
OK <br />
---------------------------<br />
 <br />
<br />
The uninstaller code that generates this error is:<br />
<br />
  rmdir /r /REBOOTOK &quot;$9\Application Data\${PRODUCT_NAME}&quot;<br />
<br />
where $9 contains the data: &quot;C:\Documents and Settings\All Users\Application Data\&quot;, and of course ${PRODUCT_NAME} contains the string &quot;Product Name&quot; (really it contains the name of the product, but for posting purposes...) <br />
<br />
And, yes, this is the only line deleting the folder in question. <br />
<br />
Anyone have thoughts or suggestions?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">{_trueparuex^}</div><div class="date">4th June 2008, 17:45</div></div><div class="posttext">That message is not coming from NSIS, it's coming from the operating system (from Windows Vista apparently).<br />
<br />
I have no idea what's causing it, but google gives tons of results if you search the message (http://www.google.com/search?q=%22It+could+be+on+a+hard+drive+on+this+computer%2C+or+on+a+network.%22).<br />
<br />
PaR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NEHOG</div><div class="date">4th June 2008, 20:46</div></div><div class="posttext">Originally posted by {_trueparuex^} <br />
That message is not coming from NSIS, it's coming from the operating system (from Windows Vista apparently).<br />
<br />
I have no idea what's causing it, but google gives tons of results if you search the message (http://www.google.com/search?q=%22It+could+be+on+a+hard+drive+on+this+computer%2C+or+on+a+network.%22).<br />
<br />
PaR  <br />
<br />
Yes, it is a Windows message, I wonder if there is some way to tell NSIS to do things silently (ignore the error). BTW, we are getting this on XP (probably would get it on Vista too, but our first discovery of the message was XP based.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">4th June 2008, 21:28</div></div><div class="posttext">I wonder why you do not use $APPDATA instead.<br />
$APPDATA<br />
<br />
The application data directory. Detection of the current user path requires Internet Explorer 4 and above. Detection of the all users path requires Internet Explorer 5 and above. The context of this constant (All Users or Current user) depends on the SetShellVarContext setting. The default is the current user.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NEHOG</div><div class="date">5th June 2008, 20:23</div></div><div class="posttext">Originally posted by Red Wine <br />
I wonder why you do not use $APPDATA instead.  <br />
<br />
I'm not sure I see the method to find or set the location as being significant. When in the 'All Users' context, $APPDATA would return the string that I described in the original post.<br />
<br />
Perhaps I'm missing something? (Yes, we are installing for 'All Users'...)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">5th June 2008, 20:32</div></div><div class="posttext">rmdir /r /REBOOTOK &quot;$9\Application Data\${PRODUCT_NAME}&quot;<br />
<br />
where $9 contains the data: &quot;C:\Documents and Settings\All Users\Application Data\&quot;, and of course ${PRODUCT_NAME} contains the string &quot;Product Name&quot; (really it contains the name of the product, but for posting purposes...)<br />
Expanding the code as it is described here the result is:<br />
rmdir /r /REBOOTOK &quot;C:\Documents and Settings\All Users\Application Data\Application Data\${PRODUCT_NAME}&quot; which seems wrong to me.<br />
Section Uninstall<br />
SetShellVarContext All<br />
rmdir /r /REBOOTOK &quot;$APPDATA\${PRODUCT_NAME}&quot;</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>