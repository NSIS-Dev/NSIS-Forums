<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Custom page with a bitmap link, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Custom page with a bitmap link NSIS Discussion" />
	
	<title> Custom page with a bitmap link [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Custom page with a bitmap link</div>
<hr />
<div class="pda"><a href="t-223307.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=223307">Custom page with a bitmap link</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">3rd August 2005, 23:38</div></div><div class="posttext">I have a custom page and am trying to make one of the Bitmaps into a link.  This has not worked with the IOEx the way it is (either only the link is above the bitmap, in which case the bitmap is hidden, or the bitmap is above the link and the link doesn't work).  Because of this, I've went in to the IOEx code and been playing around.  Right now, I've added a new flag to Bitmap called IMAGELINK that will change the cursor to a hand when it is over the image.  I took a little pointer from this thread (http://forums.winamp.com/showthread.php?s=&amp;threadid=196181&amp;highlight=image+link).  This is what I've got:<br />
<br />
CreateWindowEx(...<br />
...<br />
case FIELD_BITMAP:<br />
...<br />
if (pField-&gt;nFlags &amp; FLAG_IMAGELINK) <br />
{<br />
  SetWindowLong(pField-&gt;hwnd,GWL_STYLE,GetWindowLong(pField-&gt;hwnd,GWL_STYLE)|SS_NOTIFY);<br />
  SetClassLong(pField-&gt;hwnd,GCL_HCURSOR,(long)LoadCursor(NULL,MAKEINTRESOURCE(32649)));<br />
}<br />
...<br />
<br />
The problem is that this is setting the cursor for the entire class type, which are mostly STATIC (I have one DropList), so every label, image, etc. that uses this class type has the cursor changed to a hand.  Is there any way to only change it for those images I want using this flag?  Would it be better to make a new type and then have a Callback Proc like the link field does?<br />
<br />
Thanks in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">4th August 2005, 01:53</div></div><div class="posttext">Well, I seem to be extremely good at figuring out my problems after asking for help...<br />
<br />
Anyways, I was able to fix this by creating a new flag FLAG_IMAGELINK.  I then added the following in IOEx to get the Bitmap to have the hand over it.<br />
<br />
...<br />
if ( pField-&gt;nFlags &amp; FLAG_IMAGELINK ) pField-&gt;nParentIdx = SetWindowLong(hwCtrl,GWL_WNDPROC,(long)StaticIMAGELINKWindowProc);<br />
<br />
<br />
int WINAPI StaticIMAGELINKWindowProc(HWND hWin, UINT uMsg, LPARAM wParam, WPARAM lParam)<br />
{<br />
  int StaticField = FindControlIdx(GetDlgCtrlID(hWin));<br />
  if (StaticField &lt; 0)<br />
    return 0;<br />
  FieldType *pField = pFields + StaticField;<br />
<br />
  switch(uMsg)<br />
  {<br />
    case WM_NCHITTEST:<br />
	  break;<br />
	/*case WM_PAINT:<br />
		break;*/<br />
	case WM_GETDLGCODE:<br />
		break;<br />
    case WM_SETCURSOR:<br />
    {<br />
      if ((HWND)wParam == hWin &amp;&amp; LOWORD(lParam) == HTCLIENT)<br />
      {<br />
        HCURSOR hCur = LoadCursor(NULL, IDC_HAND);<br />
        if (hCur)<br />
        {<br />
          SetCursor(hCur);<br />
          return 1; // halt further processing<br />
        }<br />
      }<br />
    }<br />
  }<br />
  return CallWindowProc((WNDPROC)pField-&gt;nParentIdx, hWin, uMsg, wParam, lParam);<br />
}<br />
<br />
That's at the end of the case FIELD_BITMAP from above.<br />
<br />
Second question: How should I edit the message WM_NCHITTEST in order to get clicking to only work after the left click has been released and not when it's pressed down?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">4th August 2005, 10:42</div></div><div class="posttext">I did put the feature on the latest version launched yesterday. I added a new value name for &quot;Field #&quot; INI sections called NotifyIcon. With this, you can change the cursor of the mouse when it's over a control which has the &quot;ONCLICK&quot; notification flag.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>