<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait doesn't wait with for VirtualServer2005-Install, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait doesn't wait with for VirtualServer2005-Install NSIS Discussion" />
	
	<title> ExecWait doesn't wait with for VirtualServer2005-Install [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait doesn't wait with for VirtualServer2005-Install</div>
<hr />
<div class="pda"><a href="t-333913.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=333913">ExecWait doesn't wait with for VirtualServer2005-Install</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mezcalin</div><div class="date">22nd August 2011, 10:30</div></div><div class="posttext">Hi<br />
<br />
I have to make an installer that includes some other installer an driver.<br />
With the first command execWait works fine:<br />
ExecWait '&quot;$OUTDIR\VirtualServer2005\VMRCplus-1.8.0-x86\setup.exe&quot;'<br />
<br />
But it doesn't wait for the installer for Microsoft Virtual Server 2005 R2 SP1:<br />
ExecWait '&quot;$OUTDIR\VirtualServer2005\virtualserver-2005-r2-sp1-setup-win32.exe&quot;'<br />
<br />
Please help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">22nd August 2011, 11:22</div></div><div class="posttext">http://nsis.sourceforge.net/When_I_use_ExecWait,_it_doesn't_wait</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mezcalin</div><div class="date">22nd August 2011, 13:53</div></div><div class="posttext">sorry, doesn't work.<br />
<br />
ExecWait '&quot;$OUTDIR\VirtualServer2005\virtualserver-2005-r2-sp1-setup-win32.exe&quot; /wait'<br />
nor<br />
ExecWait '&quot;$OUTDIR\VirtualServer2005\virtualserver-2005-r2-sp1-setup-win32.exe&quot; /clone_wait'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">22nd August 2011, 14:07</div></div><div class="posttext">If you can't find the commandline parameter for that particular installer that tells it to not quit the initial process until its child processes are finished, you'll have to launch the exe while waiting for its child processes yourself:<br />
http://nsis.sourceforge.net/ExecWait_and_waiting_for_child_processes_with_Job_Objects</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mezcalin</div><div class="date">22nd August 2011, 14:19</div></div><div class="posttext">I already tried this one.<br />
I included the macro in my script and try the example first.<br />
But my installer won't continue. I don't know why.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Roger_wgnr</div><div class="date">23rd August 2011, 08:06</div></div><div class="posttext">Run the install from a command promt with a /? or -? this will display a list of available command line switches for the installer.<br />
<br />
Look through the list to find the option to wait for all processes to complete before exiting and use that switch in your ExecWait statement.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mezcalin</div><div class="date">23rd August 2011, 15:30</div></div><div class="posttext">The installer from Microsoft extracted a .msi-file in my temp-folder. So now I got the .msi-file und tried to execute this one.<br />
Works fine in the command prompt. But it does not work with ExecWait.<br />
I tried this command<br />
ExecWait '&quot;start /wait msiexec.exe /i $OUTDIR\VirtualServer2005\Virtual_Server_2005_Install_32.msi&quot;'<br />
but nothing happened.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">msroboto</div><div class="date">23rd August 2011, 17:52</div></div><div class="posttext">These are the possible options to msiexec<br />
<br />
Windows ® Installer. V 5.0.7601.17514 <br />
<br />
msiexec /Option &lt;Required Parameter&gt; [Optional Parameter]<br />
<br />
Install Options<br />
	&lt;/package | /i&gt; &lt;Product.msi&gt;<br />
		Installs or configures a product<br />
	/a &lt;Product.msi&gt;<br />
		Administrative install - Installs a product on the network<br />
	/j&lt;u|m&gt; &lt;Product.msi&gt; [/t &lt;Transform List&gt;] [/g &lt;Language ID&gt;]<br />
		Advertises a product - m to all users, u to current user<br />
	&lt;/uninstall | /x&gt; &lt;Product.msi | ProductCode&gt;<br />
		Uninstalls the product<br />
Display Options<br />
	/quiet<br />
		Quiet mode, no user interaction<br />
	/passive<br />
		Unattended mode - progress bar only<br />
	/q[n|b|r|f]<br />
		Sets user interface level<br />
		n - No UI<br />
		b - Basic UI<br />
		r - Reduced UI<br />
		f - Full UI (default)<br />
	/help<br />
		Help information<br />
Restart Options<br />
	/norestart<br />
		Do not restart after the installation is complete<br />
	/promptrestart<br />
		Prompts the user for restart if necessary<br />
	/forcerestart<br />
		Always restart the computer after installation<br />
Logging Options<br />
	/l[i|w|e|a|r|u|c|m|o|p|v|x|+|!|*] &lt;LogFile&gt;<br />
		i - Status messages<br />
		w - Nonfatal warnings<br />
		e - All error messages<br />
		a - Start up of actions<br />
		r - Action-specific records<br />
		u - User requests<br />
		c - Initial UI parameters<br />
		m - Out-of-memory or fatal exit information<br />
		o - Out-of-disk-space messages<br />
		p - Terminal properties<br />
		v - Verbose output<br />
		x - Extra debugging information<br />
		+ - Append to existing log file<br />
		! - Flush each line to the log<br />
		* - Log all information, except for v and x options<br />
	/log &lt;LogFile&gt;<br />
		Equivalent of /l* &lt;LogFile&gt;<br />
Update Options<br />
	/update &lt;Update1.msp&gt;[;Update2.msp]<br />
		Applies update(s)<br />
	/uninstall &lt;PatchCodeGuid&gt;[;Update2.msp] /package &lt;Product.msi | ProductCode&gt;<br />
		Remove update(s) for a product<br />
Repair Options<br />
	/f[p|e|c|m|s|o|d|a|u|v] &lt;Product.msi | ProductCode&gt;<br />
		Repairs a product<br />
		p - only if file is missing<br />
		o - if file is missing or an older version is installed (default)<br />
		e - if file is missing or an equal or older version is installed<br />
		d - if file is missing or a different version is installed<br />
		c - if file is missing or checksum does not match the calculated value<br />
		a - forces all files to be reinstalled<br />
		u - all required user-specific registry entries (default)<br />
		m - all required computer-specific registry entries (default)<br />
		s - all existing shortcuts (default)<br />
		v - runs from source and recaches local package<br />
Setting Public Properties<br />
	[PROPERTY=PropertyValue]<br />
<br />
Consult the Windows ® Installer SDK for additional documentation on the<br />
command line syntax.<br />
<br />
Copyright © Microsoft Corporation. All rights reserved.<br />
Portions of this software are based in part on the work of the Independent JPEG Group.<br />
<br />
<br />
this is my command<br />
 ExecWait '&quot;msiexec&quot; /i &quot;$INSTDIR\myfile.msi&quot; /qn+ ALLUSERS=1 /passive'<br />
<br />
I don't know if this will help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mezcalin</div><div class="date">24th August 2011, 09:36</div></div><div class="posttext">Thanks for help. The command below works fine.<br />
ExecWait '&quot;msiexec&quot; /i &quot;$INSTDIR\VirtualServer2005\Virtual_Server_2005_Install_32.msi&quot; ALLUSERS=1'</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>