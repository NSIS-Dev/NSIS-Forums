<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Finding an executable. ${Locate}, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Finding an executable. ${Locate} NSIS Discussion" />
	
	<title> Finding an executable. ${Locate} [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Finding an executable. ${Locate}</div>
<hr />
<div class="pda"><a href="t-272894.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=272894">Finding an executable. ${Locate}</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">lordnuada</div><div class="date">15th June 2007, 23:49</div></div><div class="posttext">Good afternoon,<br />
<br />
The task I'm trying to accomplish cannot be as difficult as it seems.  It's just an installer that looks for a file name, anywhere on the System, and makes thats the default install path.  I looked at the InstallDirRegKey function and it doesn't work for me, as there is no key.  <br />
<br />
Trying to get the ${Locate} thing work for me is failing me every way i can think of. I am not a professional programmer, but I do hobby stuff.  Unfourtantley I can't find a single good example of the Locate function/macro being used that is complete code, just often Peusydo Code.  Can somebody please, just show me an example or link me to an example where a there is a script that searches for a file, then changes the $INSTDIR to match that?  I also want to append a directory to the returned path.  For example, it should return (example: C:\programname\file.exe) i want to add \Data\Reports to that, so the default install string would be C:\programname\Data\Reports.  Does anybody have any examples of that, that work.  Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">16th June 2007, 00:09</div></div><div class="posttext">&quot;Anywhere on the System&quot; could be a long delay on script execution.<br />
<br />
1st use ${GetDrives} (see the examples in nsis documentation) and then ${Locate} the file on the discovered drives, (also pretty plain examples in documentation).<br />
<br />
You should add all the above in function .onInit if you want to change the $INSTDIR.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lordnuada</div><div class="date">16th June 2007, 00:27</div></div><div class="posttext">Originally posted by Red Wine <br />
&quot;Anywhere on the System&quot; could be a long delay on script execution.<br />
<br />
1st use ${GetDrives} (see the examples in nsis documentation) and then ${Locate} the file on the discovered drives, (also pretty plain examples in documentation).<br />
<br />
You should add all the above in function .onInit if you want to change the $INSTDIR.  <br />
<br />
The examples are NOT good in the documentation, i have been going off them for about 2 hours.  Thats why I'm here asking.  I have found how to search for a file and get it into a variable name, but i still cant find how to append something too it.  <br />
<br />
${Locate} &quot;C:\&quot; &quot;/L=FD /M=Program.exe &quot; &quot;FoundRB&quot;<br />
IfErrors 0 +2<br />
MessageBox MB_OK &quot;Error&quot; IDOK +2<br />
MessageBox MB_OK &quot;$$R0=$R0&quot;<br />
<br />
Function FoundRB <br />
	StrCpy $R0 $R8<br />
    ****StrCpy $R0 $R0 &quot;\Data\Reports\&quot;<br />
	StrCpy $0 StopLocate<br />
<br />
	Push $0<br />
FunctionEnd<br />
<br />
<br />
<br />
I can get it to find the file, but i want to take that 'found path' and add \data\reports onto it, but StrCpy instructions don't show how to append or merge or add, or combine or whatever you want to call sticking 2 strings together. I have tried every variation I could think of (as shown above with (****))  Nothing works.<br />
<br />
So that way, when the $R0 variable gets returned, it will be  c:\programlocation\Data\Reports as the install path.  Also, i tried even getting the .onInit to work and it gives nothing but errors about trying to use ${Locate} in it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">16th June 2007, 00:44</div></div><div class="posttext">Append text to a register:<br />
StrCpy $R0 &quot;$R0\Data\Reports\&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lordnuada</div><div class="date">16th June 2007, 00:46</div></div><div class="posttext">Originally posted by demiller9 <br />
Append text to a register:<br />
StrCpy $R0 &quot;$R0\Data\Reports\&quot;  <br />
<br />
<br />
Yes, thank you that worked.  I had just figured that out before checking back here :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lordnuada</div><div class="date">16th June 2007, 01:02</div></div><div class="posttext">I have got this working now, however it only searches C:\ <br />
<br />
Function .onInit<br />
${Locate} &quot;C:\&quot; &quot;/L=FD /M=program.exe &quot; &quot;FoundRB&quot;<br />
StrCpy $INSTDIR $R0<br />
FunctionEnd<br />
<br />
Function FoundRB <br />
	StrCpy $R0 $R8<br />
	StrCpy $R0 &quot;$R0\Data\Reports\&quot;<br />
	StrCpy $0 StopLocate<br />
	Push $0<br />
FunctionEnd<br />
<br />
The one thing I notice is, however, it appears to be 'frozen' at the start (as it is searching the HDD). Is there a way to pop up a quick box , or text line , stating 'Searching for Installed Product'.. or something of that type.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">16th June 2007, 10:04</div></div><div class="posttext">${Locate} &quot;C:\&quot; is not good enough, you'd need a combination with the function ${GetDrives} if you want to search on every HDD available.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lordnuada</div><div class="date">20th June 2007, 22:47</div></div><div class="posttext">Originally posted by Red Wine <br />
${Locate} &quot;C:\&quot; is not good enough, you'd need a combination with the function ${GetDrives} if you want to search on every HDD available.  <br />
<br />
I have looked at the ${GetDrives} examples, and I don't see how I can embed the variables into the ${Locate} method?  Could you give a brief example?<br />
<br />
Thanks,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th June 2007, 23:03</div></div><div class="posttext">It's not too hard. GetDrives has a callback function (basically a function that it calls lol) and in that function you can call Locate, like shown in this thread:<br />
http://forums.winamp.com/showthread.php?threadid=264471<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lordnuada</div><div class="date">20th June 2007, 23:24</div></div><div class="posttext">Originally posted by Afrow UK <br />
It's not too hard. GetDrives has a callback function (basically a function that it calls lol) and in that function you can call Locate, like shown in this thread:<br />
http://forums.winamp.com/showthread.php?threadid=264471<br />
<br />
Stu <br />
<br />
Thanks for the help. Since I'm doing this from the .onInit section, it just make the section too cumbersome, I will just have it search C: and if it's not there they can always click browse :)<br />
<br />
Thanks again for all your help.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>