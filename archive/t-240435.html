<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Function  InternetConnect from NSIS Documentation doesn't work!, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Function  InternetConnect from NSIS Documentation doesn't work! NSIS Discussion" />
	
	<title> Function  InternetConnect from NSIS Documentation doesn't work! [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Function  InternetConnect from NSIS Documentation doesn't work!</div>
<hr />
<div class="pda"><a href="t-240435.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=240435">Function  InternetConnect from NSIS Documentation doesn't work!</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">java.jago</div><div class="date">10th March 2006, 13:32</div></div><div class="posttext">Hi,<br />
<br />
Function  InternetConnect from NSIS Documentation doesn't work!<br />
<br />
The problem is: the function thinks I am connected to the internet - althought I am definetily not!<br />
<br />
Does anybody know a solution (perhaps demonstrated with a short script) how to determine if the user is online - and if he isn't ask him in a loop to do so ?<br />
<br />
Cheers,<br />
jago</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th March 2006, 14:33</div></div><div class="posttext">The documentation doesn't contain any function named InternetConnect. Are you talking about ConnectInternet from the Dialer plug-in's documentation?<br />
<br />
That function uses wininet's InternetAttemptConnect (http://windowssdk.msdn.microsoft.com/library/en-us/wininet/wininet/internetattemptconnect.asp). It seems this function settles for an active Ethernet connection and only fires up the dialer, if only a modem is connected to the system. You can find more discussion about this at:<br />
<br />
http://groups.google.com/group/microsoft.public.inetsdk.programming.wininet/browse_thread/thread/41756cc91b5c7806/5c19c40bd1692c2e?lnk=st&amp;q=InternetAttemptConnect&amp;rnum=18#5c19c40bd1692c2e<br />
<br />
Checking for an internet connection isn't simple, especially with many connection methods floating around and firewalls that can block your pings. Your best test will be to mimic the actual process you want to perform, in a smaller form. For example, if you want to download a big file from your website, download a very small file from the same server for testing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jamyn</div><div class="date">10th March 2006, 14:35</div></div><div class="posttext">I think the example from the documentation does not take into account that you can have a private IP, and still not be &quot;online&quot; (to the internet). <br />
<br />
This (http://nsis.sourceforge.net/IP_plug-in) is a little big, but it may do the job.  Basically, you could check to see if they have one of four types of IPs:<br />
<br />
1) a loopback IP (127.0.0.1): not online.<br />
2) no-dhcp ip: 169.254.x.x: not online.<br />
3) a private IP (192.168.x or whatever): maybe online.<br />
4) a normal IP (64.28.x.x): online<br />
<br />
So in cases 1 and 2, they are not online.  In case 3, they are possibly online - you could try pinging google.com for a reply, maybe.  And in case 4, they are online.<br />
<br />
It's a little bulky for what you're trying to do, though.  Maybe there is a simpler solution.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sag47</div><div class="date">4th January 2007, 19:47</div></div><div class="posttext">Here is a fixed function for InternetConnect in the Dialer documentation.  It is actually better than the example provided because it allows the user to retry to connect.  I've attached a script example using it as well.<br />
<br />
I used it to program an updater for my software UHARC CMD.<br />
Get it at http://www.pages.drexel.edu/~sag47/uharc<br />
<br />
I provide the source with it and it includes a ton of NSIS script examples that can help you write your own software.<br />
SAM<br />
<br />
I believe this is what you are looking for.<br />
<br />
Function InternetConnect<br />
  Start:<br />
; Check for internet Connection<br />
    Push $R0<br />
    Dialer::GetConnectedState<br />
    Pop $R0<br />
    StrCmp $R0 &quot;online&quot; connected<br />
      MessageBox MB_RETRYCANCEL|MB_TOPMOST|MB_SETFOREGROUND|MB_ICONEXCLAMATION &quot;Can't connect to internet!&quot; idRetry Start<br />
      Quit ;Remove to make error not fatal<br />
    connected:<br />
    Pop $R0<br />
FunctionEnd<br />
<br />
Keywords:<br />
Detect internet connection<br />
Detect internet<br />
Detect connection<br />
check for internet connection<br />
check for internet<br />
check for connection<br />
dialer plugin<br />
dialer<br />
dialer internetconnect<br />
dialer internetconnect function<br />
getconnectedstate<br />
dialer::getconnectedstate<br />
nsisdl plugin<br />
nsisdl check internet first</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>