<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to call uninstall of redistribute of VC++ on NSIS, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to call uninstall of redistribute of VC++ on NSIS NSIS Discussion" />
	
	<title> How to call uninstall of redistribute of VC++ on NSIS [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to call uninstall of redistribute of VC++ on NSIS</div>
<hr />
<div class="pda"><a href="t-258664.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258664">How to call uninstall of redistribute of VC++ on NSIS</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">31st October 2006, 09:39</div></div><div class="posttext">Please help me!<br />
I have to install vcredist_x86.exe instead of .net framework.<br />
When I create uninstall, I can not know exactly HKLM of vcredist_x86.exe .<br />
I also use regshot to find them but the end I can not<br />
This is one of uninstall content of regshot file which I get it.<br />
<br />
<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\AuthorizedCDFPrefix: &quot;&quot;<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\Comments: &quot;&quot;<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\Contact: &quot;&quot;<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\DisplayVersion: &quot;8.0.50727.42&quot;<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\HelpLink: &quot;&quot;<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\HelpTelephone: &quot;&quot;<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\InstallDate: &quot;20061031&quot;<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\InstallLocation: &quot;&quot;<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\InstallSource: &quot;C:\DOCUME~1\DUONGP~1\LOCALS~1\Temp\IXP000.TMP\&quot;<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\ModifyPath: &quot;MsiExec.exe /X{A49F249F-0C91-497F-86DF-B2585E8E76B7}&quot;<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\NoModify: 0x00000001<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\NoRepair: 0x00000001<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\Publisher: &quot;Microsoft Corporation&quot;<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\Readme: &quot;&quot;<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\Size: &quot;&quot;<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\EstimatedSize: 0x00001448<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\UninstallString: &quot;MsiExec.exe /X{A49F249F-0C91-497F-86DF-B2585E8E76B7}&quot;<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\URLInfoAbout: &quot;&quot;<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\URLUpdateInfo: &quot;&quot;<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\VersionMajor: 0x00000008<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\VersionMinor: 0x00000000<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\WindowsInstaller: 0x00000001<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\Version: 0x0800C627<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\Language: 0x00000000<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\DisplayName: &quot;Microsoft Visual C++ 2005 Redistributable&quot;<br />
<br />
<br />
In my code I also use:<br />
<br />
Function un.onInit<br />
!insertmacro MUI_UNGETLANGUAGE<br />
  ReadRegStr $R0 HKLM \<br />
  &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\unvcredist_x86&quot; \<br />
  &quot;UninstallString&quot;<br />
  StrCmp $R0 &quot;&quot; end  done<br />
  done:<br />
  ExecWait '$R0_?=$INSDIR'<br />
  IfErrors end<br />
  end:<br />
FunctionEnd<br />
<br />
<br />
The name of uninstall on VCREDIST_X86, I do not know, so i can not call them, so I only use this unvcredist_x86. I hope it is true.Uninstall vcredist_x86 is not uninstalled when I uninstall my program.<br />
Please help me!!<br />
Thank a million!!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st October 2006, 10:13</div></div><div class="posttext">You shouldn't start deleting files and registry keys from your installer. If you've used their installer to install, you should use their uninstaller to uninstall.<br />
<br />
The key name under Uninstall is {A49F249F-0C91-497F-86DF-B2585E8E76B7}, as you can easily see from the RegShot log you've posted. You should execute the string there as is. It's not a NSIS uninstaller, so _?= won't work.<br />
<br />
Note that these files are used by many applications and not just by yours. You should be absolutely sure that uninstalling this will not cause other programs to suddenly stop functioning. I don't think the uninstaller keeps a reference count and only uninstalls the files once all programs using it are uninstalled. Even if it did, I'm sure there are other programs that skip executing vcredist_x86.exe, if they find the files they need.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">31st October 2006, 11:00</div></div><div class="posttext">Thank Kichik for your quickly reply,<br />
My application is coded on VC++, so I need vcredist_x86 to redistribute these DLL which VC++ to support.Consequently, If I uninstall vcredist_x86, I am sure the other program is not influently.<br />
I used to think the same way which you give, and I do it but I can not run and display some error and run my uninstall and vcredist_x86 is not uninstalled<br />
<br />
Function un.onInit<br />
!insertmacro MUI_UNGETLANGUAGE<br />
  ReadRegStr $R0 HKLM \<br />
  &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}&quot; \<br />
  &quot;UninstallString&quot;<br />
  StrCmp $R0 &quot;&quot; end  done<br />
  done:<br />
  ExecWait '$R0=$INSDIR'<br />
  IfErrors end<br />
  end:<br />
FunctionEnd<br />
<br />
I think I have problems with ExecWait. Actually, I do not know how to call their uninstaller.<br />
If someone know, please help me!!<br />
Thank alot,<br />
I also enclose file error when I use above command</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st October 2006, 11:31</div></div><div class="posttext">How can you be so sure it won't influence other programs? Other programs are built with VC++ as well.<br />
<br />
As I said in the last reply, remove _?=. It's not a NSIS uninstaller.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">1st November 2006, 01:23</div></div><div class="posttext">Thank kichik a lot,<br />
<br />
 Kichik posted<br />
How can you be so sure it won't influence other programs? Other programs are built with VC++ as well.<br />
<br />
As I said in the last reply, remove _?=. It's not a NSIS uninstaller.<br />
 <br />
<br />
I am sure about it because I use to install vcredist_x86.exe in my computer which It does not install .net framework, my application work well. When I uninstall vcredist_x86 on Control Panel --&gt;Add/Remove Program.., the other application still run well. At that time, my application is uninstalled.<br />
I understand your idea but I do not know how to call uninstall vcredist_x86 :(<br />
Command remove _?= I see on Wiki linkthis link (http://nsis.sourceforge.net/Auto-uninstall_old_before_installing_new) which it shows me how to uninstall program on computer.<br />
I only want to know how to uninstall VC redistribute if we do not know exactly place which uninstall file is put.<br />
Normally,If I want to uninstall programs, I can find folder which store file uninstall or on Control Panel. <br />
Although on Control Panel, redistribute is displayed but I do not know place which file uninstall is set on which folder in my computer.<br />
Thank you for your help,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st November 2006, 09:27</div></div><div class="posttext">The link you've posted is only for NSIS uninstallers. You are not dealing with a NSIS uninstaller here. Remove _?= and simply ExecEait $R0.<br />
<br />
As for the redistributable not being used by other programs, that might be the case on your computer. But what happens if you install two programs that require the redistributables? I'm not talking about your specific case. You have to think about the general case.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">1st November 2006, 11:32</div></div><div class="posttext">Thank Kichik for your reply,<br />
I think your idea may be right on the other case. Because I think when I set up program for user, I must uninstall all applications which I install on that computer. So, I am trying to find a method which I can uninstall vcredist_x86. I think when I call uninstall vcredist_x86,if it supports for the other program on that computer, It will display information and abort this process. At that time, I do not need to uninstall it and finish my uninstall.<br />
My problem here is I do not know how to call uninstall of vcredist_x86.Actually, I do not know vcredist_x86 's uninstall is stayed where???So I could not call it.<br />
I hope Your idea can help me solve this problem!!!!<br />
Thank a lot,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st November 2006, 11:34</div></div><div class="posttext">Just useExecWait $R0No _?=, no nothing. Just that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">1st November 2006, 11:35</div></div><div class="posttext">If you don't want to use the Microsoft installer you can put the run-times in the application folder along with Microsoft.VC80.CRT.manifest with the following contents:<br />
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;<br />
&lt;!-- Copyright Â© 1981-2001 Microsoft Corporation --&gt;<br />
&lt;assembly xmlns=&quot;urn:schemas-microsoft-com:asm.v1&quot; manifestVersion=&quot;1.0&quot;&gt;<br />
    &lt;noInheritable/&gt;<br />
    &lt;assemblyIdentity <br />
        type=&quot;win32&quot; <br />
        name=&quot;Microsoft.VC80.CRT&quot; <br />
        version=&quot;8.0.50608.0&quot; <br />
        processorArchitecture=&quot;x86&quot; <br />
        publicKeyToken=&quot;1fc8b3b9a1e18e3b&quot;<br />
    /&gt;<br />
    &lt;file name=&quot;msvcr80.dll&quot;/&gt;<br />
    &lt;file name=&quot;msvcp80.dll&quot;/&gt;<br />
    &lt;file name=&quot;msvcm80.dll&quot;/&gt;<br />
&lt;/assembly&gt;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">1st November 2006, 11:50</div></div><div class="posttext">Thank Kichik and Joost Verburg a lot,<br />
I have one more question.<br />
May I ask this question wrong forum but it has just appeared on my mind.<br />
If I used vcredist_x86 (my framework at that time version 2.0) on my installer, in the future, dotnetfx appear version 3.0. The user install vcredist_x86 with new version (overwrite the old version), what happen with my application?<br />
May my application run with it???<br />
Sorry, this is a thought which I have just had.<br />
If you can answer me, I thank your idea too much.<br />
Once again,<br />
Thank alot for your hellp,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">1st November 2006, 16:19</div></div><div class="posttext">The CRT is unrelated to the .NET framework. You also won't have any version conflicts, the manifests handle all these things.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">2nd November 2006, 01:40</div></div><div class="posttext">Thank Joost Verburg for your reply,</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>