<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" closing the Temp window, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  closing the Temp window NSIS Discussion" />
	
	<title> closing the Temp window [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  closing the Temp window</div>
<hr />
<div class="pda"><a href="t-204123.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=204123">closing the Temp window</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">7th January 2005, 01:45</div></div><div class="posttext">I am tring to close the 'Temp' Window which is launched 'free of charge' ;) after completion from a 3rd party installer.  For some reason the below code does not do the trick....<br />
some syntax error ?<br />
many thanks<br />
<br />
!include WinMessages.nsh<br />
<br />
Function closeTempWindow<br />
FindWindow $0 &quot;&quot; &quot;Temp&quot;<br />
 IntCmp $0 0 done<br />
 IsWindow $0 0 done<br />
 System::Call 'user32::PostMessageA(i,i,i,i) i($0,${WM_CLOSE},0,0)'<br />
done:<br />
FunctiionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">7th January 2005, 07:16</div></div><div class="posttext">Works on Win98 SE without any changes :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">7th January 2005, 08:43</div></div><div class="posttext">Isn't PostMessage the one which just sends the message to a queue? Immediate execution (while possible) isn't guaranteed...perhaps you could try using SendMessage instead?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">7th January 2005, 12:53</div></div><div class="posttext">MyComputer window caption may include full path (or may not ? ), so window search may be a bit more complex - all top level &quot;CabinetWClass&quot; windows with &quot;Temp&quot; sustring in the caption.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">7th January 2005, 15:41</div></div><div class="posttext">From MSDN:<br />
<br />
The PostMessage function places (posts) a message in the message queue associated with the thread that created the specified window and returns without waiting for the thread to process the message.<br />
<br />
Since the NSIS is the parent thread, you just can SendMessage to do the same task :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">7th January 2005, 22:20</div></div><div class="posttext">Neither PostMessage or SendMessage work. And the nsi from Tahkir did not work either :(  I am using Win2k and the full Temp folder path is: C:\Documents and Settings\VirtualPC User\Local Settings\Temp<br />
For some odd reason this was working several months ago..maybe it works with an earlier version of NSIS.<br />
odd :(<br />
g</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>