<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Custom page not shown with LZMA, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Custom page not shown with LZMA NSIS Discussion" />
	
	<title> Custom page not shown with LZMA [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Custom page not shown with LZMA</div>
<hr />
<div class="pda"><a href="t-234861.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=234861">Custom page not shown with LZMA</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">fabiochelly</div><div class="date">6th January 2006, 09:42</div></div><div class="posttext">I have a custom page that I want to display with InstallOptions just after the MUI_PAGE_DIRECTORY page.<br />
<br />
When I compress my setup with ZLIB, everything works fine.<br />
But when I use LZMA /SOLID, the page is not displayed (in fact the MUI_PAGE_DIRECTORY page is shown twice).<br />
<br />
I suppose it is because the ini file is not extracted at this time of the setup.<br />
<br />
Is there a way to correct this problem?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th January 2006, 09:49</div></div><div class="posttext">Please include an example. It's impossible to know what the problem is without any details.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabiochelly</div><div class="date">6th January 2006, 09:57</div></div><div class="posttext">In fact my custom page is shown after 10 seconds !<br />
But before that the InstDir page is shown a second time (the buttons next and cancel change).<br />
<br />
Here is my code:<br />
<br />
SetCompressor /SOLID lzma<br />
<br />
!include &quot;MUI.nsh&quot;<br />
!include &quot;logiclib.nsh&quot;<br />
!include &quot;TextFunc.nsh&quot;<br />
!include &quot;WordFunc.nsh&quot;<br />
<br />
!define PRODUCT_NAME &quot;Etebac Engine&quot;<br />
!define PRODUCT_VERSION &quot;2.0&quot;<br />
!define MUI_COMPONENTSPAGE_NODESC<br />
<br />
Name &quot;${PRODUCT_NAME}&quot;<br />
BrandingText &quot;Copyright © 2005-2006 Test and Go&quot;<br />
OutFile &quot;EtebacEngineSetup.exe&quot;<br />
<br />
InstallDir &quot;c:\TGJSERVER\&quot;<br />
<br />
ReserveFile &quot;ip.ini&quot;<br />
<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
Page custom OtherParams<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_UNPAGE_CONFIRM<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
!insertmacro MUI_LANGUAGE &quot;French&quot;<br />
<br />
Function OtherParams<br />
  !insertmacro MUI_HEADER_TEXT &quot;Personnalisation des fichiers&quot; &quot;Saisissez le port COM du modem&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;ip.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;ip.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $PORT_COM &quot;ip.ini&quot; &quot;Field 2&quot; &quot;State&quot; ;Port COM du modem<br />
  !insertmacro MUI_HEADER_TEXT &quot;Personnalisation des fichiers&quot; &quot;Remplacement des paramètres&quot;<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th January 2006, 11:25</div></div><div class="posttext">Is that a complete example? The extraction of ip.ini shouldn't take long unless you have more files in there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabiochelly</div><div class="date">6th January 2006, 11:27</div></div><div class="posttext">Yes of course, it's just the important part of my setup.<br />
In fact, I have more than 30 MB of files in my setup.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th January 2006, 11:45</div></div><div class="posttext">Then you need to at least include the entire script. You've removed crucial parts of the example.<br />
<br />
Without seeing the entire script, I can only guess you have File commands before the ReserveFile command in the script. Move ReserveFile above all File commands and use the MUI_RESERVEFILE_INSTALLOPTIONS macro as well. It would also probably be a good idea to extract the INI file only once in .onInit.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabiochelly</div><div class="date">6th January 2006, 12:23</div></div><div class="posttext">Thank you, it works fine once I have added the macro MUI_RESERVEFILE_INSTALLOPTIONS</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>