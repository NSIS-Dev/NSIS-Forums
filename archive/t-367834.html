<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Restoring window focus after Banner::destroy, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Restoring window focus after Banner::destroy NSIS Discussion" />
	
	<title> Restoring window focus after Banner::destroy [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Restoring window focus after Banner::destroy</div>
<hr />
<div class="pda"><a href="t-367834.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=367834">Restoring window focus after Banner::destroy</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">hanky</div><div class="date">1st August 2013, 15:44</div></div><div class="posttext">Hi!<br />
<br />
I want to use Banner::show function to replace the standard &quot;Please wait while Setup...&quot; string.<br />
But how do I properly close that banner?<br />
After I call Banner::destroy my installer window loses it's focus. How can I fix that?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">1st August 2013, 17:38</div></div><div class="posttext">BringToFront. Note however that Banner utilizes that dialog but it's not a replacement. Using Banner will not change the string displayed on installer start. If that's what you're trying to do, you'll have to reshack dialog 111.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hanky</div><div class="date">1st August 2013, 20:52</div></div><div class="posttext">BringToFront. Note however that Banner utilizes that dialog but it's not a replacement. Using Banner will not change the string displayed on installer start. If that's what you're trying to do, you'll have to reshack dialog 111.<br />
I've managed to replace standard text on the banner, but my goal is to keep the installer on top after it.<br />
BringToFront doesn't help. When I call it, the installer just begin to blink in the task bar. It doesn't move to front.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">1st August 2013, 22:02</div></div><div class="posttext">It's the &quot;prevent applications from stealing focus&quot; Windows feature; I tend to forget about it since I always have it disabled. You should be able to beat it with this:<br />
System::Call &quot;User32::SetWindowPos(i $HWNDPARENT, i -1, i 0, i 0, i 0, i 0, i 3) i.&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hanky</div><div class="date">2nd August 2013, 08:44</div></div><div class="posttext">BringToFront. Note however that Banner utilizes that dialog but it's not a replacement. Using Banner will not change the string displayed on installer start. If that's what you're trying to do, you'll have to reshack dialog 111.<br />
And what about using reshack?<br />
I've found and replaced the &quot;Please wait while Setup...&quot; string in the Contrib\UIs\modern.exe.<br />
But where can I found the &quot;verifying installer&quot; string? Is recompiling NSIS the only way to change it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">2nd August 2013, 09:52</div></div><div class="posttext">That one is in Stubs\zlib (or whichever you're using); you can hex edit it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hanky</div><div class="date">2nd August 2013, 09:59</div></div><div class="posttext">That one is in Stubs\zlib (or whichever you're using); you can hex edit it.<br />
Thank you, I've found the string I need. But is it possible to insert cyrillic symbols into that file? When I patch it, I see symbols in wrong encoding during installation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">2nd August 2013, 22:15</div></div><div class="posttext">I would guess that proper locale isn't set for non-unicode programs on your test system, but in that case the whole installer would fail to display cyrillic symbols. You could replace the string with spaces, or turn crc checking off; not very beautiful solutions, I know.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">2nd August 2013, 23:54</div></div><div class="posttext">I tried and succeeded in getting a Russian Cyrillic string to display properly (проверка установки = verifying installer if google translate is correct). I attached the edited zlib - if it doesn't work for you, then it's the system locale; if it does, then you didn't edit right.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hanky</div><div class="date">5th August 2013, 12:30</div></div><div class="posttext">It seems that we use different NSIS version.<br />
I've tried your file, it displays proper string, but after it the installer crashes.<br />
<br />
Also I've tried to copy your string into my file but it didn't help. In my file one letter takes two bytes and in yours it takes one byte.<br />
50735</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">5th August 2013, 17:12</div></div><div class="posttext">I just assumed it was 2.46. Which version is it? It's obviously unicode but I can't match it with any build. Anyway, I edited your zlib, see if it makes a difference.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">5th August 2013, 23:00</div></div><div class="posttext">The above will not work, but this one will.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hanky</div><div class="date">6th August 2013, 09:29</div></div><div class="posttext">The above will not work, but this one will.<br />
Thank you very much. This file works.<br />
But could you explain which encoding did you use?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">6th August 2013, 15:25</div></div><div class="posttext">Unicode (UTF-16LE). The latin subset of unicode has the same codes as ansi, except they're 2 bytes, so when seen in hex editor, it looks like a 'regular' string interlaced with zeros. This gave you and me the wrong idea that you can just replace the latin ascii with cyrillic, but it doesn't work that way. The easiest way I guess to get the properly encoded string is to write it in notepad, save as unicode and open in hex editor; discard the first 2 bytes and the rest is your string.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hanky</div><div class="date">9th August 2013, 09:52</div></div><div class="posttext">Thank you!<br />
Now I can edit those files myself :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">9th August 2013, 15:36</div></div><div class="posttext">The latin subset of unicode has the same codes as ansi, except they're 2 bytes, so when seen in hex editor, it looks like a 'regular' string interlaced with zeros.<br />
<br />
Only the first 127 codepage entries (old school ASCII) are the same...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>