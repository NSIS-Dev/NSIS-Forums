<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" bugreport and feature request for directory-page selection dialog, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  bugreport and feature request for directory-page selection dialog NSIS Discussion" />
	
	<title> bugreport and feature request for directory-page selection dialog [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  bugreport and feature request for directory-page selection dialog</div>
<hr />
<div class="pda"><a href="t-168370.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=168370">bugreport and feature request for directory-page selection dialog</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">6th February 2004, 21:33</div></div><div class="posttext">found a bug, i'll try to describe:<br />
if i browse for a folder, e.g. &quot;C:\Program Files\xyz&quot;, the folder is valid, and i select it, in the field stands &quot;C:\Program Files\xyz\xyz&quot;, and this directory is saved in $INSTDIR.<br />
i'm using the MUI and have defined &quot;MUI_DIRECTORYPAGE_VERIFYONLEAVE&quot;.<br />
this is my verify-function:<br />
Function .onVerifyInstDir<br />
	IfFileExists &quot;$INSTDIR\xyz.exe&quot; done 0<br />
	Abort<br />
	done:<br />
FunctionEnd<br />
plz fix that as fast as u can.<br />
<br />
and i'd like to have a setting for the selection-dialog, to disable the &quot;create new folder&quot;-button.<br />
if u can include this, i'd be very happy.<br />
<br />
thx.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th February 2004, 21:42</div></div><div class="posttext">I don't get it... What's the problem? Do you have a problem with your application name being appended on the selected directory in the browse dialog? Read the documentation about InstallDir, add a backslash at the end of the default directory.<br />
<br />
Why are you using both .onVerifyInstDir and MUI_DIRECTORYPAGE_VERIFYONLEAVE? If MUI_DIRECTORYPAGE_VERIFYONLEAVE is used, .onVerifyInstDir has no effect.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th February 2004, 22:40</div></div><div class="posttext">Your post made me look again at the code and I found a problem there after all. Since RC1 it always appended the application name even if the selected folder name was identical to the application name.<br />
<br />
I don't know if that's what you meant or not, but thanks anyway.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">7th February 2004, 10:56</div></div><div class="posttext">hmm, ok, but how do i use MUI_DIRECTORYPAGE_VERIFYONLEAVE?<br />
is this the right syntax:<br />
!define MUI_DIRECTORYPAGE_VERIFYONLEAVE &quot;MyVerifyFunction&quot;<br />
?<br />
<br />
and what's about this:<br />
and i'd like to have a setting for the selection-dialog, to disable the &quot;create new folder&quot;-button.<br />
is that possible?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">7th February 2004, 11:03</div></div><div class="posttext">hmm, the directory-selection is still not working correctly:<br />
<br />
My default directory looks like that:<br />
&quot;$PROGRAMFILES\EA GAMES\Battlefield 1942&quot;<br />
now, this is shown correctly at first at the directorypage.<br />
then, i search for another path. because no other directory on my system contains the &quot;bf1942.exe&quot;, the default-directory is just, what i've to select.<br />
ok, i select it (D:\Programme\EA GAMES\Battlefield 1942) and press &quot;OK&quot;.<br />
now, at the directory-page there stands:<br />
&quot;D:\Programme\EA GAMES\Battlefield 1942\Battlefield 1942&quot;<br />
but this directory doesn't exist on my system!!!<br />
that's just what i ment with the bug.<br />
and it's still in the latest cvs.<br />
<br />
edit:<br />
if i select &quot;D:\Programme\EA GAMES&quot;, the directory is shown as &quot;D:\Programme\EA GAMES\Battlefield 1942&quot;.<br />
seems as the directory-page always enhances the path with &quot;Battlefield 1942&quot;.<br />
then, that's the bug.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th February 2004, 11:06</div></div><div class="posttext">You shouldn't define any value for MUI_DIRECTORYPAGE_VERIFYONLEAVE, you just define it without any value. When using it, use GetInstDirError in the leave function as instructed in the MUI readme.<br />
<br />
You can't remove the new folder button.<br />
<br />
There is no compiled version in CVS with the fix yet. You should recompile the latest CVS source code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">7th February 2004, 11:09</div></div><div class="posttext">.onVerifyInstDir still works with defined MUI_DIRECTORYPAGE_VERIFYONLEAVE.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th February 2004, 11:16</div></div><div class="posttext">If MUI_DIRECTORYPAGE_VERIFYONLEAVE is used, .onVerifyInstDir has no effect.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">7th February 2004, 11:34</div></div><div class="posttext">but i tested it, and it HAS effect.<br />
i'm sorry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th February 2004, 11:41</div></div><div class="posttext">It is called, but it doesn't disable the next button (on the directory page). Hence, it has no effect.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">7th February 2004, 11:47</div></div><div class="posttext">yes, it doesn't disable the next-button, but it disables the ok-button in the selection-dialog, if &quot;abort&quot; is called in this function. that is what the mui-function doesn't do.<br />
my function looks like that:<br />
Function .onVerifyInstDir<br />
	IfFileExists &quot;$INSTDIR\bf1942.exe&quot; +2 0<br />
	Abort<br />
FunctionEnd<br />
it has the effect that if u select any directory, that doesn't contain &quot;bf1942.exe&quot;, the ok-button is disabled.<br />
it HAS effect :)<br />
<br />
edit: i'm in irc now, for further discussing.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>