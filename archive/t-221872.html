<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Build NSIS problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Build NSIS problem NSIS Discussion" />
	
	<title> Build NSIS problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Build NSIS problem</div>
<hr />
<div class="pda"><a href="t-221872.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221872">Build NSIS problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">19th July 2005, 15:35</div></div><div class="posttext">I have download source from CVS and installed Python and SCons, but when I open a console in source and type scons<br />
 I got a error: scons<br />
 not a command. What wrong for me?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th July 2005, 19:07</div></div><div class="posttext">Make sure scons.bat is in the path.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">20th July 2005, 01:21</div></div><div class="posttext">I had add to path environment but got another error:<br />
<br />
scons: *** No SConstruct file found.<br />
File &quot;G:\Python24\scons\SCons\Script\Main.py&quot;, line 891, in _main<br />
<br />
I make sure SConscript is in currently path.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st July 2005, 18:10</div></div><div class="posttext">Change the working directory to the directory where you put the NSIS source code. Make sure it contains a SConstruct file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">22nd July 2005, 03:03</div></div><div class="posttext">Thanks kichik, I can rebuild NSIS.<br />
These is another problem: I changed #define NSIS_MAX_STRLEN 1024 to #define NSIS_MAX_STRLEN 8192 and building NSIS, when I using this makensis.exe to compile a NSIS script I have found that all components missing only leave one. Is it a bug?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd July 2005, 09:30</div></div><div class="posttext">I don't understand. What component is missing?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">23rd July 2005, 01:34</div></div><div class="posttext">I have 3 section, if #define NSIS_MAX_STRLEN 1024, when build makensis.exe and then compile script, and running the installer, all section display in component page. But if #define NSIS_MAX_STRLEN 8192, the component page only display section 1.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd July 2005, 08:57</div></div><div class="posttext">You must have forgot to install the stubs. The compiler created section structs with 8192 bytes for the name, but the stub reads them as 1024 and so misses the real two last sections. Don't copy anything from the build folder. Use 'scons PREFIX=&quot;C:\...&quot; install' or 'scons dist' as instructed in Appendix G.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">27th July 2005, 06:12</div></div><div class="posttext">I have the same problem but different :weird:. I have followed the steps above but when it starts to compile it throws many errors. It says it is using mstoolkit but all I have is visual studio 6 pro edition. Then it has several commands following that, that have six or seven commands calling the resources (gdi32 and others) and after each command (there are about seven), it says 'bad command or filename' which is the error shown when the system can't find the program being called. Then there are several more errors, then it shows a dialog saying: 'this program has executed an invalid instruction. Click ok to end this program' or similar message. Any thoughts?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th July 2005, 18:59</div></div><div class="posttext">How exactly does it say it's using MSTOOLKIT? It shouldn't be using it unless you pass MSTOOLKIT=yes on the command line.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">freeberm</div><div class="date">28th July 2005, 19:37</div></div><div class="posttext">I have another build issue...<br />
<br />
I downloaded the source for 2.08, downloaded python 2.4 and the latest version of SCons.  When I attempt a build I get the following errors (seems like I am missing a header file?):<br />
-------------------------<br />
scons: Building targets ...<br />
cl /nologo /O1 /W3 /c Contrib\AdvSplash\advsplash.c /Fobuild\release\AdvSplash\a<br />
dvsplash.obj<br />
advsplash.c<br />
Contrib\AdvSplash\advsplash.c(214) : error C2065: 'LWA_ALPHA' : undeclared ident<br />
ifier<br />
Contrib\AdvSplash\advsplash.c(214) : error C2065: 'LWA_COLORKEY' : undeclared id<br />
entifier<br />
Contrib\AdvSplash\advsplash.c(244) : error C2065: 'WS_EX_LAYERED' : undeclared i<br />
dentifier<br />
Contrib\AdvSplash\advsplash.c(270) : error C2065: 'DWORD_PTR' : undeclared ident<br />
ifier<br />
Contrib\AdvSplash\advsplash.c(270) : error C2146: syntax error : missing ')' bef<br />
ore identifier 'myWnd'<br />
Contrib\AdvSplash\advsplash.c(270) : error C2198: 'timeSetEvent' : too few actua<br />
l parameters<br />
Contrib\AdvSplash\advsplash.c(270) : error C2059: syntax error : ')'<br />
scons: *** [build\release\AdvSplash\advsplash.obj] Error 2<br />
scons: building terminated because of errors.<br />
-------------------------<br />
<br />
If I attempt to skip the advsplash.c file, I get more errors further down the line on other files (another missing header file?):<br />
-------------------<br />
   Creating library build\release\Library\TypeLib\TypeLib.lib and object build\r<br />
elease\Library\TypeLib\TypeLib.exp<br />
cl /nologo /O1 /W3 /TP /c Contrib\MakeLangId\MakeLangId.cpp /Fobuild\release\Mak<br />
eLangId\MakeLangId.obj<br />
MakeLangId.cpp<br />
Contrib\MakeLangId\MakeLangId.cpp(13) : error C2065: 'LANG_INVARIANT' : undeclar<br />
ed identifier<br />
Contrib\MakeLangId\MakeLangId.cpp(29) : error C2065: 'LANG_DIVEHI' : undeclared<br />
identifier<br />
Contrib\MakeLangId\MakeLangId.cpp(37) : error C2065: 'LANG_GALICIAN' : undeclare<br />
d identifier<br />
Contrib\MakeLangId\MakeLangId.cpp(54) : error C2065: 'LANG_KYRGYZ' : undeclared<br />
identifier<br />
Contrib\MakeLangId\MakeLangId.cpp(62) : error C2065: 'LANG_MONGOLIAN' : undeclar<br />
ed identifier<br />
Contrib\MakeLangId\MakeLangId.cpp(79) : error C2065: 'LANG_SYRIAC' : undeclared<br />
identifier<br />
scons: *** [build\release\MakeLangId\MakeLangId.obj] Error 2<br />
scons: building terminated because of errors.<br />
--------------------<br />
<br />
Any thoughts?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th July 2005, 20:04</div></div><div class="posttext">You're missing the latest Platform SDK (http://www.microsoft.com/downloads/details.aspx?FamilyId=A55B6B43-E24F-4EA3-A93E-40C0EC4F68E5&amp;displaylang=en).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">freeberm</div><div class="date">28th July 2005, 20:26</div></div><div class="posttext">It doesn't look like I can install that since I am still using visual studio 6.0.<br />
<br />
Thanks for your help... I'll just have to do without the LogSet option for now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">28th July 2005, 22:16</div></div><div class="posttext">You can use the Platform SDK with Visual Studio 6.0.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">freeberm</div><div class="date">28th July 2005, 23:10</div></div><div class="posttext">According to the Microsoft site:<br />
This SDK does not support working with Microsoft Visual C/C++Â®, 6.0 as support for VC 6.0 has ended. The last SDK that will work with VC 6.0 is the February 2003 Edition, you can order a CD on the fulfillment site. Side by side installations are not supported.<br />
-------------------<br />
They at least claim that you can't with the current version.  Are you sure installing that won't screw things up?<br />
<br />
<br />
BTW... thanks for the reply Joost!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th July 2005, 11:30</div></div><div class="posttext">Wow, that's nice of them. You can use the Visual C++ (http://msdn.microsoft.com/visualc/vctoolkit2003/) toolkit instead. You'll still be able to work with Visual C++ 6 after installing it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">freeberm</div><div class="date">29th July 2005, 13:04</div></div><div class="posttext">Thanks for finding this kichik!  This site (forum, tools, and WinAmp for that matter...) rocks!<br />
<br />
-------------------<br />
I have Visual Studio or Visual C++. Do I need the Visual C++ Toolkit?<br />
The Visual C++ Toolkit will work fine alongside installed versions of Visual Studio and Visual C++. If you already use Visual Studio .NET 2003, you do not need the Visual C++ Toolkit, unless you want to see the included samples. Everything else included in the Toolkit is included with Visual Studio .NET 2003.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">freeberm</div><div class="date">29th July 2005, 14:15</div></div><div class="posttext">Slight problem still...<br />
<br />
I installed the VC++ toolkit without any conflicts.  However it still doesn't work.<br />
<br />
If I try to use the command 'scons MSTOOLKIT=yes' then I get an error that it can't find the platform SDK.  This is due to the check in the mstoolkit.py file:<br />
-------------------<br />
	# look for platform sdk<br />
	if os.environ.has_key('MSSdk'):<br />
		PlatformSDKDir = os.path.normpath(os.environ['MSSdk'])<br />
	else:<br />
		try:<br />
			PlatformSDKDir = SCons.Util.RegGetValue(SCons.Util.HKEY_LOCAL_MACHINE, r'SOFTWARE\Microsoft\MicrosoftSDK\Directories\Install Dir')[0]<br />
			PlatformSDKDir = str(PlatformSDKDir)<br />
		except SCons.Util.RegError:<br />
			try:<br />
				PlatformSDKDir = SCons.Util.RegGetValue(SCons.Util.HKEY_LOCAL_MACHINE, r'SOFTWARE\Microsoft\MicrosoftSDK\InstalledSDKs\8F9E5EF3-A9A5-491B-A889-C58EFFECE8B3\Install Dir')[0]<br />
				PlatformSDKDir = str(PlatformSDKDir)<br />
			except SCons.Util.RegError:<br />
				raise SCons.Errors.InternalError, &quot;The Platform SDK directory was not found in the registry or in the `MSSdk` environment variable.&quot;<br />
------------------------<br />
<br />
So I tried to fool the file by adding an environmental variable MSSdk that points to the C++ Toolkit installation, and I am back to the original errors.<br />
<br />
Are you sure that this is due to the missing platform SDK?  And if so, I guess the VC++ Toolkit isn't enough.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th July 2005, 14:18</div></div><div class="posttext">The VC Toolkit doesn't replace the Platform SDK, only VC 6. You still need the Platform SDK.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">freeberm</div><div class="date">29th July 2005, 21:51</div></div><div class="posttext">So I went to another machine, installed Python, SCONS, and the 2003 platform SDK.  I tried 'scons MSTOOLKIT=yes' and got an error saying it couldn't fine VC++ toolkit.  So I installed that and tried again.  Now it seems to pick up the toolkit, but I am back to the same errors I started with.  Are you sure there isn't something missing from the source?  One of the files even seems to have a syntax error according to the error messages... (see attached file)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th July 2005, 09:14</div></div><div class="posttext">I'm sure nothing is missing from the source. Those errors are caused because of outdated header files. The updated header files are in the Platform SDK. Do you have the MSSDK environment variable defined properly? Notice that it fails to find basic libraries like gdi32, user32, etc. It seems something with the Platform SDK isn't configured or detected properly. Can you attach config.log?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">freeberm</div><div class="date">1st August 2005, 14:41</div></div><div class="posttext">Thank you for all of your help Kichik.  After I manually created a MSSdk environmental variable, it appears to compile correctly.<br />
<br />
Sorry for all of the trouble... should have checked that myself after the install.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">2nd August 2005, 01:57</div></div><div class="posttext">This will probably make things even more bad. I have windows millenium edition (tumble-weed passes by). I have visited the microsoft site and found out that the ms toolkit and the platform sdk require windows xp (more tumble-weed passes by). Looks like I will have to stick with the binary for forever and a day.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd August 2005, 20:55</div></div><div class="posttext">Or upgrade to a real OS ;)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>