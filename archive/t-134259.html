<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installing Office (MS Word) Templates, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installing Office (MS Word) Templates NSIS Discussion" />
	
	<title> Installing Office (MS Word) Templates [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installing Office (MS Word) Templates</div>
<hr />
<div class="pda"><a href="t-134259.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=134259">Installing Office (MS Word) Templates</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pcraider</div><div class="date">4th May 2003, 17:10</div></div><div class="posttext">I have a few MS Word templates (.dot files) which I need to distribute.  I would like to install these into the user's template folder so that when they click on &quot;New&quot; within Word these will appear for them to choose.  I can access the templates path using VBScript, but being a newbie to NSIS I'm unsure how to do this with an NSIS script...<br />
<br />
Is there a simple way to determine the user's template folder and copy the files there?  Seems like a fairly easy task, but I'm having some problems figuring out the best way.<br />
<br />
Thank you in advance for your help!<br />
<br />
-pcraider</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">4th May 2003, 17:23</div></div><div class="posttext">First. Detect the hole path for the templetes directory.<br />
This you can use it with &quot;ReadRegStr&quot; instruction.<br />
In the Registry this is its root of Office<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pcraider</div><div class="date">6th May 2003, 12:42</div></div><div class="posttext">I checked the registry key, but there doesn't appear to be any &quot;templates&quot; path listed there.  Is there any way to use/translate VBScript into an NSIS script?  The code I was able to write to access the templates path is as follows:<br />
<br />
   Dim o <br />
   Dim sPath<br />
   Set o = CreateObject(&quot;Word.Application&quot;)<br />
   sPath = o.Templates(1).FullName<br />
   sPath = Mid(sPath, 1, InStrRev(sPath, &quot;\&quot;) - 1)<br />
   o.Quit<br />
   Set o = Nothing<br />
<br />
Where sPath is the path to the templates folder.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">6th May 2003, 12:43</div></div><div class="posttext">You can't convert this VBScript code to NSIS. It must be somewhere in the registry, try to search using Google.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pcraider</div><div class="date">6th May 2003, 12:51</div></div><div class="posttext">I wish it were that straight-foward.  In everything I've found, it appears the templates folder location is varied based on OS/Office version, etc.  (e.g. WD2000: General Questions and Answers About the Location of Word 2000 Templates (http://support.microsoft.com/default.aspx?scid=http://support.microsoft.com:80/support/kb/articles/q210/8/84.asp&amp;NoWebContent=1))<br />
<br />
Also, it is possible the user has customized the path to their templates folder (in which case this DOES appear in the registry).  I really can't believe it is this difficult to deploy custom templates...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">6th May 2003, 13:03</div></div><div class="posttext">To get the shell folders, check http://nsis.sourceforge.net/archive/viewpage.php?pageid=6</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pcraider</div><div class="date">6th May 2003, 13:07</div></div><div class="posttext">Joost,<br />
<br />
Thank you... that may work!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JeanThomsen</div><div class="date">26th May 2003, 12:53</div></div><div class="posttext">I'm by no means no expert in NSIS, but i have been doing the following:<br />
<br />
I think it's much easier to use the Workgrouptemplates setting - this item is designed for using templates besides the ones included with office - and it's much easier to copy to, since u can have them in your own directory<br />
<br />
HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Common\General<br />
<br />
but again the problem is that according to which version of office is used, the \10.0\ changes... This is how i did it in my template installer (Where i copy the templates to a specified directory)<br />
<br />
The problem is i have to use a setting for each version of office that might be installed on my end-users<br />
<br />
If any of you guys in this forum know how to make it simpler, please let me know...<br />
<br />
If only the Office WorkgroupDir RegSetting was working as a shellfolder! <br />
<br />
Here's a part of my installerscript:<br />
<br />
;Setup workgroup templatedir for Office<br />
EnumRegKey $1 HKCU &quot;Software\Microsoft\Office\8.0&quot; 1<br />
   IfErrors Found1<br />
   Goto NextKey1<br />
Found1:<br />
   WriteRegStr HKCU &quot;Software\Microsoft\Office\8.0\Common\General&quot; &quot;SharedTemplates&quot; &quot;c:\OwnTemplates\&quot;<br />
   WriteRegStr HKCU &quot;Software\Microsoft\Office\8.0\Common\FileNew\SharedTemplates&quot; &quot;&quot; &quot;c:\OwnTemplates\&quot;<br />
   Goto EndOffPaths<br />
Nextkey1:  <br />
   EnumRegKey $1 HKCU &quot;Software\Microsoft\Office\9.0&quot; 1<br />
   IfErrors Found2<br />
   Goto NextKey2<br />
Found2:<br />
   WriteRegStr HKCU &quot;Software\Microsoft\Office\9.0\Common\General&quot; &quot;SharedTemplates&quot; &quot;c:\OwnTemplates\&quot;<br />
   Goto EndOffPaths<br />
Nextkey2:  <br />
   EnumRegKey $1 HKCU &quot;Software\Microsoft\Office\10.0&quot; 1<br />
   IfErrors Found3<br />
   Goto NextKey3<br />
Found3:<br />
   WriteRegStr HKCU &quot;Software\Microsoft\Office\10.0\Common\General&quot; &quot;SharedTemplates&quot; &quot;c:\OwnTemplates\&quot;<br />
   WriteRegStr HKCU &quot;Software\Microsoft\Office\10.0\Word\Security&quot; &quot;Level&quot; &quot;1&quot;<br />
   Goto EndOffPaths<br />
Nextkey3:  <br />
   EnumRegKey $1 HKCU &quot;Software\Microsoft\Office\11.0&quot; 1<br />
   IfErrors Found4<br />
   Goto EndOffPaths<br />
Found4:<br />
   WriteRegStr HKCU &quot;Software\Microsoft\Office\11.0Common\General&quot; &quot;SharedTemplates&quot; &quot;c:\OwnTemplates\&quot;<br />
;  WriteRegStr HKCU &quot;Software\Microsoft\Office\10.0\Word\Security&quot; &quot;Level&quot; &quot;1&quot;<br />
   Goto EndOffPaths<br />
EndOffPaths:<br />
<br />
<br />
The above script part is for Word only ! I have script part for Excel as well, and for copying .DOT files to have them autostart in Word/Excel (For macro functions in templates for instance):hang:</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>