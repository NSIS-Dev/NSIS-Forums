<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Close page window automaticly and safely?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Close page window automaticly and safely? NSIS Discussion" />
	
	<title> Close page window automaticly and safely? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Close page window automaticly and safely?</div>
<hr />
<div class="pda"><a href="t-285484.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=285484">Close page window automaticly and safely?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">lovespy108</div><div class="date">23rd January 2008, 01:00</div></div><div class="posttext">Var AlreadySetup<br />
Var Modify<br />
<br />
!macro MAINTENANCE<br />
  page custom ModifyShow ModifyLeave<br />
!macroend<br />
<br />
!insertmacro MAINTENANCE     //my own macro<br />
!insertmacro MUI_PAGE_WELCOME<br />
<br />
Function .onInit<br />
 ...<br />
 IfFileExists &quot;$INSTDIR\myApplication.exe&quot; 0 +3<br />
   StrCpy $AlreadySetup 1<br />
   goto End<br />
 ...<br />
 End:<br />
FunctionEnd<br />
<br />
Function ModifyShow<br />
<br />
 ${If} $AlreadySetup == 1<br />
   InstallOptions::initDialog /NOUNLOAD &quot;$R0\modify.ini&quot; <br />
   InstallOptions::show<br />
 ${EndIf}<br />
<br />
FunctionEnd<br />
<br />
Function ModifyLeave<br />
<br />
   ReadINIStr $Modify &quot;$R0\modify.ini&quot; &quot;Field 2&quot; &quot;State&quot;<br />
 ${If} $Modify == 0<br />
   ExecShell &quot;open&quot;  &quot;$INSTDIR\uninst.exe&quot;<br />
   ************************************************<br />
   my problem is at here?????????<br />
   ************************************************<br />
 ${Else}<br />
   Call RunOrNot          //call my own function<br />
 ${EndIf}<br />
<br />
FunctionEnd<br />
----------------------------------------------------------<br />
How to realize the following purpose?<br />
-After it executed [ExecShell...] ,I want that the custom page window can close automaticly and safely.Then the setup is finished at here.<br />
----------------------------------------------------------<br />
<br />
Thanks very much for help!!!:up: :up: :up: :up:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">23rd January 2008, 01:09</div></div><div class="posttext">simply call Quit?<br />
<br />
<br />
4.9.4.17 Quit<br />
Causes the installer to exit as soon as possible. After Quit is called, the installer will exit (no callback functions will get a chance to run).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lovespy108</div><div class="date">23rd January 2008, 01:18</div></div><div class="posttext">Thank you! It can work so well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">23rd January 2008, 01:47</div></div><div class="posttext">just make sure you don't have any cleanup code in any callbacks that would normally run when the installer finishes.  If you do, you'll have to either duplicate that cleanup code, or use a different method instead.  E.g. in an installer I maintain, a 'skip' variable is set to true and each page calls Abort if that variable is true - thereby skipping that page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lovespy108</div><div class="date">23rd January 2008, 02:58</div></div><div class="posttext">Yes.I did that like your method.I found that way occasionally.@_@^_^:p</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>