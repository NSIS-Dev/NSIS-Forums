<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Can you use variables in File statements, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Can you use variables in File statements NSIS Discussion" />
	
	<title> Can you use variables in File statements [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Can you use variables in File statements</div>
<hr />
<div class="pda"><a href="t-52505.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=52505">Can you use variables in File statements</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">brainz</div><div class="date">14th June 2001, 10:42</div></div><div class="posttext">A quick question ....<br />
<br />
I'm trying to use variables as a part of the name of files that are to be installed<br />
<br />
So let us change example1.nsi as follows:<br />
<br />
; The name of the installer<br />
Name &quot;Example1&quot;<br />
<br />
; The file to write<br />
OutFile &quot;example1.exe&quot;<br />
<br />
; The default installation directory<br />
InstallDir $PROGRAMFILES\Example1<br />
<br />
; The text to prompt the user to enter a directory<br />
DirText &quot;This will install the very simple example1 on your computer. Choose a directory&quot;<br />
<br />
; The stuff to install<br />
Section &quot;ThisNameIsIgnoredSoWhyBother?&quot;<br />
  ; Set output path to the installation directory.<br />
  SetOutPath $INSTDIR<br />
  ;Set $1 to be the location of the files to install<br />
  StrCpy $1 c:\WINNT<br />
  <br />
  ; Put file there<br />
  File $1\notepad.exe<br />
  <br />
SectionEnd ; end the section<br />
<br />
; eof<br />
<br />
When I do the compile step, I get the following :<br />
<br />
File: &quot;$1\notepad.exe&quot; -&gt; no files found.<br />
Usage: File (/r filespec [...]|/oname=outfile one_file_only)<br />
<br />
Am I missing something, or is my syntax wrong, or are variables not allowed in the File statement ?<br />
<br />
Any help gratefully accepted ...<br />
<br />
TIA<br />
<br />
tim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Edgewize</div><div class="date">14th June 2001, 11:57</div></div><div class="posttext">The argument to the File command is the local path to the file when you are building the installer, not the path that will be used when the user runs it.  You could try using the /ONAME=&quot;blah&quot; flag for File (see the HTML documentation for NSIS) but it may not work across directories.  What you really want is to use the SetOutPath command:<br />
<br />
SetOutPath $1<br />
File &quot;c:\windows\notepad.exe&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainz</div><div class="date">14th June 2001, 14:31</div></div><div class="posttext">Not sure that you understand why I want to use a variable. I understand totally that the argument to File is the local path when the installer is collecting the files to build the install ...<br />
<br />
Suppose I have a long list of files that get installed (&gt;10), and for each new build in the development environment, we put them in a new directory, identified by a new build number, so current release compiled code ends up in <br />
<br />
c:\files\devt\app\v1.2\release<br />
<br />
and then for my next release it ends up in <br />
<br />
c:\files\devt\app\v1.3\release <br />
<br />
Suppose I keep the nsi script in  c:\files\devt\app, then I will have to modify &gt;10 lines which say<br />
<br />
     v1.2\release\filename1<br />
     v1.2\release\filename2<br />
     v1.2\release\filename3<br />
     v1.2\release\filename4 ...<br />
<br />
Whereas if I could use a variable, in the code I could use <br />
<br />
     StrCpy $1 v1.3\release<br />
<br />
and <br />
<br />
     File $1\filename1<br />
     File $1\filename2<br />
     File $1\filename3<br />
     File $1\filename4 ...<br />
<br />
I am trying to reduce the chance of a developer getting a release wrong by ensuring that the script has to be changed in the minimum number of places. I guess a better solution is to put the .nsi file in <br />
<br />
      c:\files\devt\app\v1.2\release <br />
<br />
and then use <br />
<br />
      File filename1<br />
      File filename2<br />
      File filename3<br />
      File filename4 ...<br />
<br />
which is what I will probably do ... but from a code control perspective I'd like to be able to do the above ...<br />
<br />
(Note I'm clear that none of this affects where the file ultimately gets installed by the installer that is built !!)<br />
<br />
Also from the documentation, it suggests that you might be able to do this, under Variables it says <br />
<br />
&quot;The following are variables that are usable in Instructions&quot;<br />
<br />
and under &quot;Instructions - General purpose, basic instructions&quot; we find File.<br />
<br />
To me this suggest that you might be able to do it.<br />
<br />
Perhaps this is a bug, perhaps not ... depends on your view...<br />
<br />
Don't take any of this the wrong way Edge, I think NSIS is a great piece of software, and the comments I make are just things I notice that I think are worth comment ...<br />
<br />
Keep up the great work ...<br />
<br />
thanks<br />
<br />
tim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Edgewize</div><div class="date">14th June 2001, 18:07</div></div><div class="posttext">Doh, I understand.  The *local* directory name is a variable.  I get it now :D<br />
<br />
Try the !cd change-local-directory-during-the-compile command.  I don't think that variables are expanded while compiling, only while the installer is running, but you could use<br />
<br />
!cd &quot;c:\files\devt\app\v1.2\release&quot;<br />
<br />
before the File commands, and it should work just fine.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>