<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Vista and axtiveX registration, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Vista and axtiveX registration NSIS Discussion" />
	
	<title> Vista and axtiveX registration [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Vista and axtiveX registration</div>
<hr />
<div class="pda"><a href="t-265694.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=265694">Vista and axtiveX registration</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">lars1106</div><div class="date">13th February 2007, 07:52</div></div><div class="posttext">Hi all<br />
Been searching the forum in vain for a solution to the problem below, which I discovered while testing the Installer on Vista.<br />
It doesnÂ´t register the ActiveX control properly.<br />
<br />
Here is the source section which creates problems, I hope someone can help out, as I am absolutely not a programmer:<br />
<br />
;Register ActiveX?s and DLL?s<br />
  UnRegDLL &quot;$INSTDIR\teechart5.ocx&quot;<br />
  Sleep 1000<br />
  RegDLL &quot;$INSTDIR\teechart5.ocx&quot;<br />
  Sleep 1000<br />
   <br />
<br />
The whole script wo. files section is attaced.<br />
Thanks in advance for any assistance.<br />
<br />
Lars</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lars1106</div><div class="date">13th February 2007, 07:54</div></div><div class="posttext">Ps.. the problem is solved manually by creating a CMD on the desktop as run as administrator. But then the whole idea by using an installer falls away, right</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lars1106</div><div class="date">13th February 2007, 07:56</div></div><div class="posttext">FIle attached</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">13th February 2007, 08:47</div></div><div class="posttext">try RequestExecutionLevel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lars1106</div><div class="date">13th February 2007, 09:05</div></div><div class="posttext">Hi Anders,<br />
Sorry I do not quite understand you, as to where I put this statement in the script. I looked a bit in MSDN and technet, but got just more confused :-(<br />
Can you give an example of use<br />
<br />
/Lars</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">13th February 2007, 14:35</div></div><div class="posttext">1) add to your script the line:<br />
<br />
RequestExecutionLevel admin<br />
<br />
using &quot;RequestExecutionLevel&quot; Should however not really be needed since Vista &quot;Sees&quot; it is an installer and sets the Executonlevel accordingly.<br />
<br />
2)<br />
Try not to use RegDLL anymore it's the OLD way.<br />
Use: InstallLib<br />
<br />
e.g. <br />
<br />
!insertmacro InstallLib REGDLLTLB NOTSHARED REBOOT_NOTPROTECTED &quot;${whereverethefilercomesfrom}\yourocx.dll&quot; &quot;$MYINSTFOLDER\yourocx.dll&quot; &quot;$SYSDIR&quot;<br />
<br />
Good luck with your TeeChart library installer!<br />
<br />
PLUGGING: Consider using the Delphi Source version, you do not need to install any OCX then... ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tsn</div><div class="date">22nd February 2007, 10:09</div></div><div class="posttext">I am using a cab file which will be downloading the dll from the inf file into the local pc and registers it as i have given RegisterServer = yes.<br />
<br />
But this does not allow me to perform in VISTA because of UAC.<br />
<br />
Is there any other way that i can register the dll without disabling UAC?<br />
<br />
Can someone help me out in this..<br />
<br />
Thanks for all of your help!!<br />
<br />
Sample content of inf file<br />
-----------------------<br />
; needed DLL<br />
[sysTest.dll]<br />
file-win32-x86=thiscab<br />
FileVersion=6,0,8972,0<br />
DestDir=11<br />
RegisterServer=yes<br />
----------------------<br />
<br />
Regards<br />
NST</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">22nd February 2007, 13:35</div></div><div class="posttext">Yes, see above... to register a DLL you NEED ofcourse certain rights.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>