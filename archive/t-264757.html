<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Deleting changed files in Vista, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Deleting changed files in Vista NSIS Discussion" />
	
	<title> Deleting changed files in Vista [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Deleting changed files in Vista</div>
<hr />
<div class="pda"><a href="t-264757.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=264757">Deleting changed files in Vista</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">reprobate</div><div class="date">31st January 2007, 17:19</div></div><div class="posttext">We're installing some files into \ProgramData that are subsequently changed by the application. The installer runs as admin, hence the files are owned by Administrator.<br />
<br />
When we run the uninstaller, the directory entry for these files is not removed. No error the Delete instruction.<br />
<br />
Files that were not modified are deleted ok. Files that were not installed but were subsequently created by the app are deleted ok. It's only the data files that are installed, then modified, that are a problem.<br />
<br />
Windows Explorer doesn't see the files, or the install directory, for that matter. But my cheap old explorer replacement finds them alright, as does Windows GetFileAttributes. If you try to open the file, you get a NOT FOUND error, so it seems it's just a directory entry problem.<br />
<br />
Rebooting, even if you specify Delete /REBOOT, does not do the trick.<br />
<br />
Anyone have a clue as to what is going on? Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">31st January 2007, 20:36</div></div><div class="posttext">Do not install to ProgramData yourself but use API's of OS to get the folder to use. Because of Vista's virtualization the files will land up in the ProgramData then.<br />
<br />
Best is first learn about Vista and Virtualization for backwards compatibility.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>