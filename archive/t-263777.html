<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installer request ;), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installer request ;) NSIS Discussion" />
	
	<title> Installer request ;) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installer request ;)</div>
<hr />
<div class="pda"><a href="t-263777.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=263777">Installer request ;)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">AGU</div><div class="date">16th January 2007, 13:49</div></div><div class="posttext">I don't know if it's asked to much, nevertheless I'm asking if someone is willing/wants to write me a little installer script for my BBCodeWriter (http://www.autohotkey.com/forum/topic6161.html) Autohotkey script. Feel free to tell me if it's asked too much. :)<br />
<br />
I already made a little one, but it's very limited. One thing is, it adds entries to startmenu although I uncheck the specified checkbox during install. On the other hand I always wanted an uninstaller for the script but don't know how to do it. <br />
Is it possible to write an uninstall entry to the control panel - software - add/remove? <br />
And last but not least, is it possible to ask the user during install if he/she would like to install it for all users or only for the currently registered user?<br />
<br />
This is how far I came with v.2.14 and my limited knowledge:<br />
!define TITLE &quot;AHK BBCodeWriter&quot;<br />
!define VERSION 6.6<br />
<br />
;#######################################<br />
;Include Modern UI<br />
  !include &quot;MUI.nsh&quot;<br />
;#######################################<br />
<br />
<br />
;#######################################<br />
; General<br />
<br />
; Installer Name<br />
Name &quot;AHK BBCodeWriter&quot;<br />
<br />
; The file to write<br />
OutFile &quot;Setup BBCodeWriter.exe&quot;<br />
<br />
; The default installation directory<br />
InstallDir C:\Tools\BBCode<br />
;#######################################<br />
<br />
<br />
;#######################################<br />
;Interface Settings<br />
  !define MUI_ICON    ${NSISDIR}\Contrib\Graphics\Icons\box-install.ico<br />
  !define MUI_UNICON  ${NSISDIR}\Contrib\Graphics\Icons\box-uninstall.ico<br />
  <br />
  !define MUI_HEADERIMAGE<br />
  !define MUI_HEADERIMAGE_BITMAP ${NSISDIR}\Contrib\Graphics\Header\win.bmp<br />
  !define MUI_HEADERIMAGE_UNBITMAP ${NSISDIR}\Contrib\Graphics\Header\win.bmp<br />
  <br />
  !define MUI_ABORTWARNING<br />
;#######################################<br />
<br />
<br />
;#######################################<br />
; Variables<br />
  Var STARTMENU_FOLDER<br />
;#######################################<br />
<br />
<br />
;#######################################<br />
; Pages <br />
  !define MUI_PAGE_HEADER_TEXT        &quot;${TITLE} v${VERSION}&quot;<br />
  !define MUI_PAGE_HEADER_SUBTEXT     &quot;An offline BBCode Editor written in Autohotkey&quot;<br />
<br />
  !define MUI_WELCOMEPAGE_TITLE       &quot;${TITLE} v${VERSION}&quot; <br />
  !insertmacro MUI_PAGE_WELCOME<br />
  <br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  <br />
  !insertmacro MUI_PAGE_STARTMENU Application $STARTMENU_FOLDER<br />
  <br />
  !define MUI_FINISHPAGE_RUN $INSTDIR\BBCodeWriter.exe<br />
  !insertmacro MUI_PAGE_FINISH<br />
;#######################################<br />
<br />
<br />
;#######################################<br />
;Languages<br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
  !insertmacro MUI_LANGUAGE &quot;German&quot;<br />
;#######################################<br />
<br />
<br />
;#######################################<br />
; Sections<br />
Section<br />
  ; Set output path to the installation directory.<br />
  SetOutPath $INSTDIR<br />
  <br />
  ; Put files in InstallDir<br />
  File /r Files\*.*  <br />
  <br />
  !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
  <br />
    ; Create Shortcuts<br />
    CreateDirectory &quot;$SMPROGRAMS\${TITLE}&quot;<br />
    CreateShortCut  &quot;$SMPROGRAMS\${TITLE}\${TITLE}.lnk&quot; &quot;$INSTDIR\BBCodeWriter.exe&quot;<br />
    <br />
  !insertmacro MUI_STARTMENU_WRITE_END<br />
SectionEnd<br />
;#######################################</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">16th January 2007, 17:03</div></div><div class="posttext">I guess you may manage that installer easily with  NSIS Quick Setup Script Generator (http://nsis.sourceforge.net/NSIS_Quick_Setup_Script_Generator)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">16th January 2007, 17:17</div></div><div class="posttext">One thing is, it adds entries to startmenu although I uncheck the specified checkbox during install.<br />
you should change the order of the installer pages.<br />
your code for startmenu entries is in a &quot;section&quot;, meaning it will be executed on page instfiles. your checkbox to choose if actually any shortcuts should be created is a page AFTER this.<br />
you should flip the two pages:<br />
<br />
!insertmacro MUI_PAGE_INSTFILES  <br />
!insertmacro MUI_PAGE_STARTMENU Application $STARTMENU_FOLDER<br />
<br />
On the other hand I always wanted an uninstaller for the script but don't know how to do it.<br />
see the user manual :)<br />
<br />
Is it possible to write an uninstall entry to the control panel - software - add/remove?<br />
yes, quite simple - a small topic in the user manual :)<br />
<br />
[quopte]And last but not least, is it possible to ask the user during install if he/she would like to install it for all users or only for the currently registered user?[/quote]<br />
search the forums/wiki.<br />
<br />
there are several solutions for this one in here.<br />
<br />
small hint: installoptions page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AGU</div><div class="date">17th January 2007, 11:24</div></div><div class="posttext">Thx Guys,<br />
<br />
looks like &quot;NSIS Quick Setup Script Generator&quot; is exactly what I was looking for. :)<br />
<br />
Nevertheless thanks to Comm@nder21 for pointing out what is wrong in my script. I will have a look at it.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>