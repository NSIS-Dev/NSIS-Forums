<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Display Animated GIF images for Custom Pages, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Display Animated GIF images for Custom Pages NSIS Discussion" />
	
	<title> Display Animated GIF images for Custom Pages [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Display Animated GIF images for Custom Pages</div>
<hr />
<div class="pda"><a href="t-245291.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=245291">Display Animated GIF images for Custom Pages</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">baskaran.vishnu</div><div class="date">3rd May 2006, 12:03</div></div><div class="posttext">Hi,<br />
<br />
I am having difficulties to display an animated GIF Image for a custom page,<br />
<br />
At the moment, based on the design of my custom page, clicking the Next Button installs a hidden based application. During that process, I would like to show to an Animated GIF indicating installation in progress.<br />
<br />
I am currently using a Bannner Image using the EBanner plugins. The banner works excellent. However, this plugin does not support animated GIFs.<br />
<br />
I have tried using another plugin, AnimGif, however, I am having difficulties running this plugin for my custom page.<br />
<br />
I would be grateful for any advice or references on this issue.<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zeeh3</div><div class="date">4th May 2006, 02:02</div></div><div class="posttext">Attach your script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baskaran.vishnu</div><div class="date">4th May 2006, 10:18</div></div><div class="posttext">Hi,<br />
<br />
I have posted the Scripts as shown below;<br />
<br />
/* Start Scripts */<br />
<br />
/*Initialized code for the custom page at the beginning of the scripts */<br />
#Custom Page Intialization<br />
Page custom ShowMSQLCheckPage CheckMSQLPage<br />
<br />
# Extract the Custom INI file <br />
!insertmacro MUI_INSTALLOPTIONS_EXTRACT_AS &quot;DispForms\Check MSQL.ini&quot; &quot;CheckMSQL&quot;<br />
<br />
/* Initialize a GIF image to the Plugins Directory */<br />
Function .onInit<br />
   InitPluginsDir<br />
   File /oname=$PLUGINSDIR\sample.gif &quot;C:\sample.gif&quot;<br />
<br />
   !insertmacro MUI_INSTALLOPTIONS_EXTRACT_AS &quot;DispForms\Check MSQL.ini&quot; &quot;CheckMSQL&quot;<br />
FunctionEnd<br />
<br />
<br />
/* Custom Page Functions */<br />
Function ShowMSQLCheckPage <br />
<br />
   # Display the page.<br />
   !insertmacro  <br />
   !insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;CheckMSQL&quot;<br />
   Pop $R0 # HWND<br />
   GetDlgItem $R1 $R0 1200 ; 1200 + Field # - 1<br />
   GetDlgItem $R2 $R0 1201 ; 1200 + Field # - 1<br />
<br />
   SetCtlColors $R0 3D66AB 3D66AB<br />
   SetCtlColors $R1 FFFFFF 3D66AB<br />
   SetCtlColors $R2 FFFFFF 3D66AB<br />
<br />
   !insertmacro MUI_INSTALLOPTIONS_SHOW<br />
continue:<br />
<br />
Return<br />
FunctionEnd<br />
<br />
Function CheckMSQLPage<br />
         <br />
         newadvsplash::show /NOUNLOAD 2000 600 400 -1 /BANNER /NOCANCEL &quot;$PLUGINSDIR\sample.gif&quot;<br />
         newadvsplash::hwnd /NOUNLOAD<br />
         Pop $0<br />
         AnimGif::play /NOUNLOAD /hwnd=$0 /bgcol=0xffffff &quot;$PLUGINSDIR\sample.gif&quot;<br />
<br />
         sleep 5000<br />
         newadvsplash::wait     ; waits or exits immediately if 'show' already finished<br />
         newadvsplash::stop<br />
         AnimGif::stop<br />
         <br />
FunctionEnd<br />
<br />
/* End of Scripts */<br />
<br />
From the codes above, the custom page calls on two functions to show the Main page(With some Text Display from the custom ini file) followed by the action to show the animated GIF Image when user clicks on the 'Next' button of the custom page. I can't seem to get the GIF Image displayed based on this condition. In  fact the Installer hangs and I have to forcefully exit the Installer.exe file.<br />
<br />
The weird thing is that when I remove '/Banner' from the newadvsplash::show command line, the Flash Image is displayed but the GIF Image does not seem to show its animation movement. It seems as if the AnimGif::play command doesn't execute.<br />
<br />
Besides that, if I execute the newadvsplash::show (with '/Banner'),newadvsplash::hwnd and AnimGif::play commands in Function .onInit, the Animated Image with its splash screen feature is displayed during startup of the Installer.exe. It's as if that these functions work in the Function .oninit but not in custom based functions<br />
<br />
I am using the AnimGif.dll along with the newadvsplash.dll plugins to run this method.<br />
<br />
Would appreciate any help on this.<br />
<br />
Thanks<br />
<br />
(PS: I have attached the sample.gif Animated Image as a reference)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baskaran.vishnu</div><div class="date">5th May 2006, 08:56</div></div><div class="posttext">Hi,<br />
<br />
If you need any added details based on the scripts above, please inform me. I would help in any way possible.<br />
<br />
I would truly appreciate it if anyone could assist me with the problem above.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">14th May 2006, 11:17</div></div><div class="posttext">Please test attached dll version.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hbatista</div><div class="date">3rd April 2007, 18:49</div></div><div class="posttext">Hi, reviving this old thread...<br />
I'm also trying to use the  newadvsplash plugin to display animated GIF banners when navigating between pages, i.e. pressing the 'Next' button displays an animated 'please wait' banner, and the next page hides the banner.<br />
<br />
The plugin version that's on the wiki didn't work, but the special version in the last reply does work!<br />
But... there's still a problem... it only works the first time! Any second calls to newadvsplash::show freeze the installer.<br />
<br />
Please help...<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">3rd April 2007, 20:05</div></div><div class="posttext">Not freezes in my tests using May 14, 2006 version. Script attached. I'll compare sources and add lost&amp;found version to wiki tomorrow :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hbatista</div><div class="date">4th April 2007, 10:17</div></div><div class="posttext">Thanks Takhir, I tried your script and it does indeed work.<br />
<br />
But in attachment is a little example I cooked up that has the freezing problem.<br />
It has two InstallOptions pages, and simulates a slow operation at the beginning of them where I'd like to show a banner, on the first page it works, on the second it freezes.<br />
<br />
Can you take a look at it?<br />
Thank you very much for your help!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">4th April 2007, 12:53</div></div><div class="posttext">SetPluginUnload manual<br />
helped me in your test. Is alwaysoff a default? But this is my fault too.. AnimGif not makes a full clean up on serial 'show' requests, and may hang. This is why I used 'stop' with unload.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hbatista</div><div class="date">4th April 2007, 14:57</div></div><div class="posttext">Tried using 'SetPluginUnload manual' but still no luck here ('manual' is the default anyway) :(<br />
<br />
I'm using stop with unload too, but it doesn't seem to help...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">4th April 2007, 15:07</div></div><div class="posttext">script and binaries attatched - opens second page and second gif. I put new version to wiki (http://nsis.sourceforge.net/File:NewAdvSplash.zip) but it has a minimum changes compare to version linked above.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hbatista</div><div class="date">4th April 2007, 16:08</div></div><div class="posttext">OK, I see now what causes it to freeze, SetPluginUnload has nothing to do with it, your version worked because you changed the 'delay' value from 120000 to 1200 ms.<br />
It appears the plugin does not like to have 'stop' called before the delay value expires.<br />
I have to use a big value because I just want the banner to show for as much time as is necessary, not just a fixed delay...<br />
<br />
Thanks for your patience<br />
<br />
ps: by the way, the new version you uploaded to the wiki appears to be the same as the old one...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hbatista</div><div class="date">4th April 2007, 18:28</div></div><div class="posttext">Got it working!<br />
Fiddled a bit with the source code, the wiki version does not seem to be the most recent (e.g. it doesn't have the '/BANNER' parsing code), but modified it anyway.<br />
<br />
The problem seems to be that because the thread never ended ('stop' doesn't wait), it never unregistered the window class. So on the second call to 'show', the register failed. I added an unregister in the 'stop' method and the thing is now working.<br />
<br />
In attach there's the modified source, modified lines have an '//hbatista' comment. Takhir, can you integrate this into the official plugin version?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">5th April 2007, 07:38</div></div><div class="posttext">Thanks for your help, hbatista!<br />
RegisterClass really works in the application scope, not dll load/unload :). I added your code to wiki.<br />
Few comments.<br />
1. /BANNER mode presents in code beginning 06-25-2005, may be if-else parsing looks a bit ugly, but it works - sets modal = false.<br />
2. 04-04-2007 wiki version sets hParent=NULL for banner mode only, I guess this is a corect way.<br />
Please test wiki version. Just for possible proxy issues - latest files in zip should have Apr. 5 date.<br />
And thank you again!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hbatista</div><div class="date">5th April 2007, 09:33</div></div><div class="posttext">Thanks Takhir,<br />
for some reason when I click the most recent version of the wiki file, the zip I get has files with date 2006-03-04...<br />
when clicking the revisions I get the expected file dates.<br />
<br />
Will try later, maybe it's some cache thing?...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hbatista</div><div class="date">5th April 2007, 10:24</div></div><div class="posttext">Duh... browser cache... :)<br />
Tried it, it's working fine!<br />
<br />
Thanks again!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zbd</div><div class="date">18th July 2007, 02:57</div></div><div class="posttext">I'm having some trouble using the AnimGif plugin.<br />
<br />
I've managed to get the image onto my custom page, however, it isn't displaying properly, it kind of flashes bits here and there.<br />
<br />
Has anyone else experienced this?<br />
I've tried a couple of different gifs.<br />
I've also tried a few versions of the plugin.<br />
<br />
Here's some of the code I'm using.<br />
<br />
<br />
AnimGif::play /NOUNLOAD /VALIGN=CENTER /HWND=$HWNDPARENT &quot;$EXEDIR\sample.gif&quot;<br />
<br />
!insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;searching&quot;<br />
<br />
Sleep 2000<br />
Sleep 2000<br />
AnimGif::stop     ; terminates all<br />
Sleep 1000<br />
<br />
<br />
If I'm doing everything else properly, it may be that i'm using a WANSIS skin, it may be causing some problems.<br />
<br />
Any pointers much appreciated.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>