<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" system: second release - final, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  system: second release - final NSIS Discussion" />
	
	<title> system: second release - final [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  system: second release - final</div>
<hr />
<div class="pda"><a href="t-112243.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=112243">system: second release - final</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">31st October 2002, 11:27</div></div><div class="posttext">Ok. I've completed examples, but documentation is still in bad condition (any help will be apreciated :). <br />
<br />
Examples included: Indirect message boxes (with custom icons etc), Int64 ops, Disk space etc, Structures, GetFileSysTime, and ... SPLASH :) callbacks are working ;)<br />
<br />
Changes from prerelease version:<br />
1. Inline input into structures bug fixed.<br />
2. Zero values for structure special options bug fixed.<br />
3. &amp;lN for structures - automatic size detection - added.<br />
4. Automatic callback queue clear up (so no /CALLBACK required for System::Free now).<br />
5. System::Store - store/restore registers and pop/push registers.<br />
6. '\' is no more an escape character for inline input. If you need to place the<br />
same quotes into input as you used for separation of input expression just use <br />
these characters in doubled way. For example (t &quot;just an &quot;&quot;Example&quot;&quot;!&quot;).<br />
<br />
P.S. I've created an additional dir in contrib/system since there are many source files and it's hard to find textual contribs otherwise. Sorry to makensis.nsi updater :) <br />
P.P.S. Examples/System.nsi contains examples :)<br />
P.P.P.S. I'm to busy to adopt vc6 project file now, sorry...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">31st October 2002, 20:55</div></div><div class="posttext">There is a small update required since you changed file/directory paths:<br />
<br />
system.nsi: replace<br />
!include &quot;${NSISDIR}\Contrib\System\Additionals\sysfunc.nsh&quot;<br />
with<br />
!include &quot;${NSISDIR}\Contrib\System\sysfunc.nsh&quot;<br />
<br />
SysFunc.nsh: replace<br />
!include &quot;${NSISDIR}\Contrib\System\Additionals\System.nsh&quot;<br />
with<br />
!include &quot;${NSISDIR}\Contrib\System\System.nsh&quot;<br />
<br />
sorry ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">1st November 2002, 09:43</div></div><div class="posttext">Thanks, fixed :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th November 2002, 19:45</div></div><div class="posttext">The compiled System.nsi example doesn't delete Resource.dll. Seems like System.dll doesn't release it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">17th November 2002, 10:21</div></div><div class="posttext">I downloaded this file and the latest CVS but it won't compile. Anyway, what I wanted to know is if that &quot;int64&quot; means that I can use integers of 64 bits in nsis. if the answer is yes: how?<br />
<br />
thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">17th November 2002, 23:37</div></div><div class="posttext">Kichik: added FreeLibrary call to systemMessageBox, thanx. Modified examples attached. Also resource.dll link updated - now compiles fine.<br />
<br />
btw: NSIS never deletes System plugin too :) May be it should delete all used plugins at final (i found my Temp dir fillled with 8 mb of system.dll in different nsis folders ;) ?<br />
<br />
noon: see Int64Op function. Search for the 'Int64Op' string files located at Contrib\System folder: system.txt and system.nsi.<br />
<br />
P.S. System is already included into NSIS distribution (at least CVS version).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">18th November 2002, 00:57</div></div><div class="posttext">Sorry Kichik, sourceforge was done, so I've noted your changes too late. Here is combined version of our changes... ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">18th November 2002, 15:30</div></div><div class="posttext">&quot;could be a hard barrier for non Win32 programmers&quot;<br />
ok, I am not a win32 programmer. Could you tell me what do I need to change to work with integers of 64bits? I want to add, divide and write to files.<br />
<br />
Thanks<br />
:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th November 2002, 15:35</div></div><div class="posttext">From System.nsi:<br />
<br />
StrCpy $2 &quot;12312312&quot;<br />
StrCpy $3 &quot;12345678903&quot;<br />
System::Int64Op $2 &quot;*&quot; $3<br />
Pop $4<br />
<br />
$4 will contain 12312312 * 12345678903 after this piece of code.<br />
<br />
Instead of IntOp you use System::Int64Op and Pop, that's all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">18th November 2002, 17:43</div></div><div class="posttext">Thanks I think it works.<br />
<br />
btw, not using the intop64 takes 16 seconds an installation to work, and using it takes 52. is this normal?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">19th November 2002, 12:20</div></div><div class="posttext">SUUUCK! I've typed two pages of answer :)) and that damn IE eated it all after I pressed Backspace by the case. sux.<br />
<br />
Ok. Short answer: Calls to external plugins and int64 arithmetic are time consuming oops. check for unload option, in case of many system:: calls this could be the reason.<br />
<br />
at script start should be:<br />
<br />
setpluginunload manual<br />
<br />
at script end should be (at line which will be executed last or so):<br />
<br />
setpluginunload alwaysoff<br />
System::Free 0   ; actually does nothing</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">19th November 2002, 19:57</div></div><div class="posttext">well, I didn't understand fully. But I will add this &quot;setpluginunload manual&quot; in the very beginning, and this &quot;setpluginunload alwaysoff&quot; at the very end (I forget the other line as it does nothing).<br />
<br />
As I have sections and functions, do I need to put this in every section or function, or just in the first line of the first section and the last line for the last section (as functionas are called from sections)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th November 2002, 20:47</div></div><div class="posttext">Right before you use System.dll for the first time and the second one right before you use it for the last time.<br />
<br />
It takes longer because NSIS has to load the DLL everytime, and that takes some time. If you tell it not to unload the DLL it will be a bit shorter.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">19th November 2002, 21:58</div></div><div class="posttext">(I forget the other line as it does nothing).  <br />
<br />
;) It does nothing but you shouldn't forget it :) The system plugin couldn't free the zero, so it will do nothing, but the NSIS don't know this. By the other hand we are turning plugin unload back (always off state), so the plugin will be finally unloaded and deleted successfully after instalation end.<br />
<br />
Kichik described the other way (it is right too): you could find the last use of system plugin and set this option (plugin unload) right before it.<br />
<br />
2 Kichik: may be we should find easier way to do this? ;) This could be some statement which will compile into the same call (the same compiled entry) to unexistant function of plugin but with unload turned on (so no exehead size consumption)...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">23rd November 2002, 00:13</div></div><div class="posttext">and...<br />
<br />
is IntCmp implemented for 64bits?<br />
(I need it and can't find a work around:D )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd November 2002, 10:08</div></div><div class="posttext">If you just want to see if they are equal you can use IntOp64 &lt;#1&gt; - &lt;#2&gt; and compare the result to &quot;0&quot;. If you want a bit more, you can compare the first char to &quot;-&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">23rd November 2002, 10:45</div></div><div class="posttext">Kichiks way will work too, but ... RTFM (system.txt ;)<br />
<br />
----------------------------------<br />
System::Int64Op ARG1 OP1<br />
System::Int64Op ARG1 OP2 ARG2<br />
----------------------------------<br />
        Performs operation on ARG1 and ARG2 (or on ARG1 only at single argument operator cases) and returns result on stack. Here are the OP2s: +, -, *, / DIV, % MOD, | OR, &amp; AND, ^ XOR, || LOGIC-OR, &amp;&amp; LOGIC-AND, &lt; BELOW, &gt; ABOVE, = EQUAL. <br />
There are only 2 OP1s: ~ (BITWISE-NOT) and ! (LOGIC-NOT).<br />
<br />
So, use:<br />
<br />
System::Int64Op 234563524532 &lt; 7236487463264<br />
Pop $0<br />
Strcmp $0 0 labelFirstIsNotSmaller labelFirstIsSmaller</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">23rd November 2002, 16:25</div></div><div class="posttext">yes! very smart :winamp:</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>