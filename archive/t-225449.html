<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Adding tasks to windows Task Scheduler, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Adding tasks to windows Task Scheduler NSIS Discussion" />
	
	<title> Adding tasks to windows Task Scheduler [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Adding tasks to windows Task Scheduler</div>
<hr />
<div class="pda"><a href="t-225449.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=225449">Adding tasks to windows Task Scheduler</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Habi</div><div class="date">8th September 2005, 13:29</div></div><div class="posttext">Hello all,<br />
<br />
is there a way to add a task to the windows &quot;Scheduled Tasks&quot; via NSIS?<br />
<br />
regards<br />
<br />
Timo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th September 2005, 14:07</div></div><div class="posttext">Search for Scheduled Tasks<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=147686&amp;highlight=scheduled+task<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th September 2005, 18:38</div></div><div class="posttext">I've created a Wiki page (http://nsis.sourceforge.net/wiki/Scheduled_Tasks) as this questions comes up once in a while. Feel free to beef it up.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">menard</div><div class="date">3rd January 2007, 23:35</div></div><div class="posttext">Thank you for providing the plugin for scheduled tasks.  One question I had was what would you need to add to the uninstall portion of the script to remove the scheduled task.<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th January 2007, 21:11</div></div><div class="posttext">Instead of calling NewWorkItem with the task name, call Delete with the task name. The function ordinal of Delete is 7.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">menard</div><div class="date">7th February 2007, 00:55</div></div><div class="posttext">On the wiki page it provides information for placing a username / password for the account running the scheduled task.  Many of the systems that I wish to install on do not have a password associated with the account, which causes issues in the implementation.<br />
<br />
The only workaround is to check the &quot;Run Only if Logged On&quot; flag within the scheduled task window.  Can you provide the snippit that would check this flag similar to <br />
<br />
; ITask-&gt;SetAccountInformation<br />
  System::Call '$R2-&gt;30(w r7, w r8)'<br />
 <br />
Thank you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th February 2007, 13:06</div></div><div class="posttext">Are you sure it's possible to run tasks for users with no password? According to MSDN, NULL is only allowed for the local system account and, as you said, when using TASK_FLAG_RUN_ONLY_IF_LOGGED_ON. It says nothing on empty passwords, so if those don't work, they might simply not be supported.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">menard</div><div class="date">9th February 2007, 13:38</div></div><div class="posttext">Thanks for your response.<br />
<br />
The scenario that you provide is correct.  In essence I'd like to understand how to check the flag TASK_FLAG_RUN_ONLY_IF_LOGGED_ON and install under the local system account with null password.  I've gone so far as to download c++ and the Platform SDK as the wiki suggests when using system calls, but I'm at a loss on how to identify the index for the TASK_FLAG_RUN_ONLY_IF_LOGGED_ON.<br />
<br />
I appreciate your help,<br />
<br />
Clark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th February 2007, 14:04</div></div><div class="posttext">It's defined in MSTask.h. TASK_FLAG_RUN_ONLY_IF_LOGGED_ON        is 0x2000.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">menard</div><div class="date">13th February 2007, 14:12</div></div><div class="posttext">Following is the additional lines I added to my CreateTask function to check the Run Only if Logged On box.<br />
<br />
   ; ITask-&gt;SetFlags()<br />
     System::Call '$R2-&gt;28(i 0x2000)'<br />
<br />
I'd like to thank kichik for all his help!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>