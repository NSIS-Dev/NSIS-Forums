<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Unicode build question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Unicode build question NSIS Discussion" />
	
	<title> Unicode build question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Unicode build question</div>
<hr />
<div class="pda"><a href="t-322963.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322963">Unicode build question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">noisebar</div><div class="date">6th October 2010, 23:36</div></div><div class="posttext">In our NSIS script, there is a step to check that the installation directory selected contains only ANSI characters because the Amardillo DRM we are using does not support Unicode.  We do this check using the following statement:<br />
<br />
System::Call 'kernel32.dll::WideCharToMultiByte(i 437, i ${WC_NO_BEST_FIT_CHARS}, w r1, i -1, i r5, i 2048, n, n) i .r2'<br />
<br />
This statement used to work.  It'll convert what's selected in the text box to ANSI.  But now it converts the text into unreadable gibberish after I upgraded to the latest version of NSIS.<br />
<br />
I'm very not familiar with NSIS because I just took over this project not long ago.  Can somebody shed some light?<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">7th October 2010, 01:59</div></div><div class="posttext">The issue was solved on IRC and was not actually in this posted line but on the next line when the &quot;t&quot; system.dll type was used to extract the ansi string. The m type must be used for ansi strings since t can be ansi or unicode (Older unicode builds probably mapped t to the wrong string type)<br />
<br />
(Also, n,n is not really correct, n is not a type, use i)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>