<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to disable RemoveButton for non-Admin users, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to disable RemoveButton for non-Admin users NSIS Discussion" />
	
	<title> How to disable RemoveButton for non-Admin users [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to disable RemoveButton for non-Admin users</div>
<hr />
<div class="pda"><a href="t-280855.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=280855">How to disable RemoveButton for non-Admin users</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">AxelMock</div><div class="date">6th November 2007, 09:53</div></div><div class="posttext">Hi,<br />
<br />
I have a nicely working NSIS installer for a network driver, running on all platforms W2K and above.<br />
The described problem occurs only on non-Vista platforms, since Vista has a smarter handling of Install/Uninstall.<br />
<br />
It has registry entries under <br />
HKLM\Software\Microsoft\Windows\Uninstall\&lt;My Product&gt;<br />
:<br />
:<br />
NoRepair = 1<br />
NoModify = 1<br />
:<br />
:<br />
<br />
It just shows the Remove button.<br />
Now testing department found out that when opening Control Panel|Add/remove Programs as NON-admin user the &quot;Remove&quot; button is visible (and trying to start the uninstall as non-Admin directly leads to a proprammed message saying that you need to have admin prvileges for this) BUT with an Installshield based installation the Remove button for non-Admin users is disabled/hidden.<br />
<br />
Since the uninstaller is NOT running when you open Add/Remove Programs this seems to be some setting in the registry....<br />
<br />
I've compared the registry entries of the InstallShield App and tried to copy some entries, switching back and forth from non-Admin to Admin, but didn't find it.<br />
<br />
OK. Setting NoRemove to 1 removes the Remove Button, but also for the Admin....<br />
<br />
Does anyone know how to do this? Or shed a light on how it is done.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th November 2007, 13:03</div></div><div class="posttext">This may depend on where you put the Uninstall registry information, i.e. under current user (HKCU) or all users (HKLM). There may be more to it than that but that would be my initial guess.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AxelMock</div><div class="date">6th November 2007, 13:26</div></div><div class="posttext">Originally posted by Afrow UK <br />
This may depend on where you put the Uninstall registry information, i.e. under current user (HKCU) or all users (HKLM).<br />
 <br />
<br />
OK, I need to be more precise: The compared InstallShield installer has it's Uninstall information in the same reg-tree<br />
HKLM.... except for using a GUID instead of a Name (Company_Product).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>