<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Question Function of NSIS ?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Question Function of NSIS ? NSIS Discussion" />
	
	<title> Question Function of NSIS ? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Question Function of NSIS ?</div>
<hr />
<div class="pda"><a href="t-303127.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=303127">Question Function of NSIS ?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dong</div><div class="date">15th February 2009, 14:39</div></div><div class="posttext">In NSIS, I begins and opens a new function, Can this function pass parmeter for variable as languge pascal, C++... ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">15th February 2009, 16:19</div></div><div class="posttext">For functions, you usually use the stack to pass information.  Or, if you use macros, the values can be passed as parameters.<br />
<br />
There are several examples of these methods throughout the samples included with NSIS.<br />
<br />
Or try using the search option in this forum.  Here's one such article that might help:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=300144</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">15th February 2009, 16:45</div></div><div class="posttext">and, of course, the wiki...<br />
http://nsis.sourceforge.net/Macro_vs_Function</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">15th February 2009, 16:56</div></div><div class="posttext">You may of course write your own custom C or Pascal code, compile it as a NSIS Plugin DLL and then call the plugin functions from your NSIS code. There are NSIS Plugin API's available for C as well as for Delphi/Pascal...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dong</div><div class="date">18th February 2009, 13:29</div></div><div class="posttext">I read documents about function to pass information or to pass parameter for function what you sent me but i don't understand and I don't write source code, i want you help me write source code. I have 2 question want to question, distribute 2 case. This my example simple about delete key.<br />
case:<br />
1. I want to write function all delete fonts Tahoma.ttf and Tahomabd.ttf as DeleteRegValue but i can't delete them, can you help me ? My soure code or you see attach file AllDeleteFont.nsi, If i want to debug (or see)  variable environment, i can see content variable environment, can i ? as $Pathkey, $fontkey, $0, $1,... ? what do i do ?<br />
<br />
<br />
Var PathKey<br />
Var FontKey<br />
<br />
Function AllDeleteRegValue<br />
#All delete fonts Tahoma.ttf and Tahomabd.ttf into registry  <br />
  <br />
  <br />
  StrCpy $0 0<br />
  loop:  #All delete Tahoma.ttf and Tahomabd.ttf<br />
     ClearErrors<br />
     EnumRegValue $1 HKLM PathKey $0<br />
     IfErrors done<br />
     IntOp $0 $0 + 1<br />
  <br />
     # Copy font names: Tahoma.ttf (or Tahomabd.ttf) into $2 and compare $2 if equal Tahoma.ttf is delete them<br />
     StrCpy $2 $1 &quot;&quot; -StrLen(FontKey) #<br />
     StrCmp $2 FontKey 0 +3<br />
       DeleteRegValue HKLM PathKey $1<br />
       StrCpy $0 0       <br />
       goto +2<br />
<br />
;    # Copy font names: Tahoma.ttf (or Tahomabd.ttf) into $2 and compare $2 if equal Tahoma.ttf is delete them<br />
;    StrCpy $3 $1 &quot;&quot; -12 #  <br />
;    StrCmp $2 &quot;Tahomabd.ttf&quot; 0 +3<br />
;       DeleteRegValue HKLM &quot;Software\Microsoft\Windows\CurrentVersion\SharedDlls&quot; $1<br />
;        StrCpy $0 0       <br />
;     goto +1<br />
   goto loop <br />
<br />
done:<br />
<br />
#All delete fonts Tahoma.ttf and Tahomabd.ttf into registry  <br />
FunctionEnd<br />
<br />
Section<br />
   <br />
   StrCpy $FontKey &quot;Tahoma.ttf&quot;   <br />
   StrCpy $PathKey &quot;Software\Microsoft\Windows\CurrentVersion\SharedDlls&quot;<br />
   Call AllDeleteRegValue<br />
<br />
   StrCpy $FontKey &quot;Tahomabd.ttf&quot;   <br />
   Call AllDeleteRegValue<br />
<br />
SectionEnd<br />
<br />
+++++++++++++++++++++++<br />
<br />
Case 2:<br />
2. If i want to write function AllDeleteRegValue as DeleteRegValue to pass parameter. <br />
 <br />
AllDeleteRegValue HKLM &quot;Software\My Company\My Software&quot; &quot;Tahoma.ttf&quot;<br />
<br />
In Section i write, can i write them ? can you help me ?<br />
<br />
Function AllDeleteRegValue (PathKey, FontKey)<br />
  ... Command<br />
FunctionEnd<br />
<br />
Section<br />
  <br />
     AllDeleteRegValue HKLM &quot;Software\My Company\My Software&quot; &quot;Tahoma.ttf&quot;<br />
     AllDeleteRegValue HKLM &quot;Software\My Company\My Software&quot; &quot;Tahomabd.ttf&quot;<br />
<br />
SectionEnd<br />
<br />
I can't send attach file because i don't see button attach file, I will copy content file, the name file AllDeleteFont.nsi<br />
<br />
# All delete fonts<br />
<br />
<br />
Name &quot;All Delete Fonts&quot;<br />
Caption &quot;All Delete Fonts&quot;     <br />
OutFile &quot;AllDeleteFonts.exe&quot;<br />
<br />
Var PathKey<br />
Var FontKey<br />
<br />
Function AllDeleteRegValue<br />
#All delete fonts Tahoma.ttf and Tahomabd.ttf into registry  <br />
  <br />
  <br />
  StrCpy $0 0<br />
  loop:  #All delete Tahoma.ttf and Tahomabd.ttf<br />
     ClearErrors<br />
     EnumRegValue $1 HKLM PathKey $0<br />
     IfErrors done<br />
     IntOp $0 $0 + 1<br />
  <br />
     # Copy font names: Tahoma.ttf (or Tahomabd.ttf) into $2 and compare $2 if equal Tahoma.ttf is delete them<br />
     StrCpy $2 $1 &quot;&quot; -StrLen(FontKey) #<br />
     StrCmp $2 FontKey 0 +3<br />
       DeleteRegValue HKLM PathKey $1<br />
       StrCpy $0 0       <br />
       goto +2<br />
<br />
;    # Copy font names: Tahoma.ttf (or Tahomabd.ttf) into $2 and compare $2 if equal Tahoma.ttf is delete them<br />
;    StrCpy $3 $1 &quot;&quot; -12 #  <br />
;    StrCmp $2 &quot;Tahomabd.ttf&quot; 0 +3<br />
;       DeleteRegValue HKLM &quot;Software\Microsoft\Windows\CurrentVersion\SharedDlls&quot; $1<br />
;       StrCpy $0 0       <br />
;     goto +1<br />
   goto loop <br />
<br />
done:<br />
<br />
#All delete fonts Tahoma.ttf and Tahomabd.ttf into registry  <br />
FunctionEnd<br />
<br />
Section<br />
   <br />
   StrCpy $FontKey &quot;Tahoma.ttf&quot;   <br />
   StrCpy $PathKey &quot;Software\Microsoft\Windows\CurrentVersion\SharedDlls&quot;<br />
   Call AllDeleteRegValue<br />
<br />
   StrCpy $FontKey &quot;Tahomabd.ttf&quot;   <br />
   Call AllDeleteRegValue<br />
<br />
SectionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>