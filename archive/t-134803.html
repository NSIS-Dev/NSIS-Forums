<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Screen Saver, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Screen Saver NSIS Discussion" />
	
	<title> Screen Saver [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Screen Saver</div>
<hr />
<div class="pda"><a href="t-134803.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=134803">Screen Saver</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">KHolmes</div><div class="date">9th May 2003, 02:49</div></div><div class="posttext">Hello I am trying to make an installer that would install my screen saver on any system.. Win 98 Windows 2000 NT XP etc..<br />
<br />
I just used the Basic.nsi and added this line that I found on another post on this board<br />
<br />
ExecWait 'rundll32.exe desk.cpl,InstallScreenSaver &quot;$INSTDIR\myscreensaver.scr&quot;'<br />
<br />
Compiles good when I run the file it says installing etc.. then the screen saver control panel comes up. I see my screen saver in the list I click it hit apply then finish the installation. When I go back to my screen saver control panel my screen saver is no longer there.<br />
The post that I copied that code from said that the command was the same as right clicking on the scr and then clicking install<br />
I am running on Windows XP<br />
<br />
Any help would greatly be appreciated</div></div><hr />


<div class="post"><div class="posttop"><div class="username">firefly2442</div><div class="date">9th May 2003, 04:00</div></div><div class="posttext">I believe the .scr file needs to be installed to the windows directory.  Try automatically installing the file there and see if it works, that way the person doesn't have to choose where to install it. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">KHolmes</div><div class="date">11th May 2003, 03:37</div></div><div class="posttext">Shouldn't this automatically make the screen saver the default?<br />
WriteRegStr HKCU &quot;Control Panel\Desktop&quot; &quot;SCRNSAVE.EXE&quot; &quot;C:\WINDOWS\test.SCR&quot;<br />
<br />
When it executes it removes the SCRNSAVE.EXE value from the registry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gwobbel</div><div class="date">28th March 2007, 15:28</div></div><div class="posttext">I've been reading several threads on the forum about setting the current screen saver. <br />
<br />
When I tried:<br />
<br />
WriteRegStr HKCU &quot;Control Panel\Desktop&quot; &quot;SCRNSAVE.EXE&quot; &quot;$WINDIR\LongScreensaverName.scr&quot;<br />
<br />
<br />
it didn't work. I found that the screen saver registry entry needed to be a dos 8.3 filename:<br />
<br />
<br />
Var /GLOBAL &quot;DOS83&quot;<br />
GetFullPathName /SHORT $DOS83 &quot;$WINDIR\LongScreensaverName.scr&quot;<br />
WriteRegStr HKCU &quot;Control Panel\Desktop&quot; &quot;SCRNSAVE.EXE&quot; $DOS83</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">29th March 2007, 02:14</div></div><div class="posttext">My screensavers are in $SYSDIR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">30th March 2007, 00:59</div></div><div class="posttext">WriteRegStr HKCU &quot;Control Panel\Desktop&quot; &quot;SCRNSAVE.EXE&quot; &quot;$WINDIR\LongScreensaverName.scr&quot;<br />
<br />
Only works with short names as mentioned - but it works - see example above.<br />
<br />
&gt;&gt; My screensavers are in $SYSDIR<br />
<br />
common used - but windir also works - it depends of the saver itself.<br />
eg. 3planesoft only uses sysdir, nufsoft can use both</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>