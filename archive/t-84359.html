<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" I'd like to export .reg files with NSIS, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  I'd like to export .reg files with NSIS NSIS Discussion" />
	
	<title> I'd like to export .reg files with NSIS [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  I'd like to export .reg files with NSIS</div>
<hr />
<div class="pda"><a href="t-84359.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=84359">I'd like to export .reg files with NSIS</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">10th April 2002, 23:23</div></div><div class="posttext">I am in need of a function which creates REG files from a branch with all sub-branches, like exporting using regedit.exe. <br />
<br />
And  another  to import them (althought it can be<br />
done  with  &quot;Exec  &quot;REGEDIT.EXE  /S  FILE.REG&quot;&quot;. <br />
<br />
<br />
To delete whole branches is easy with this trick:<br />
<br />
import this:<br />
<br />
REGEDIT4<br />
<br />
[-HKEY_CURRENT_USER\Software\Microsoft]<br />
<br />
<br />
I hope some NSIS developer listen to my pray :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">11th April 2002, 07:08</div></div><div class="posttext">Exporting .reg files...<br />
Is possible but quite complicated in NSIS. Search trees in the registry is not the favorite thing I would do... Isn't this possible using regedit itself? Or search the internet for some small utility that will do this job. I'm sure someone already programmed it...<br />
<br />
Good luck,<br />
-Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pomflain</div><div class="date">11th April 2002, 12:30</div></div><div class="posttext">Originally posted by n0On3 <br />
I am in need of a function which creates REG files from a branch with all sub-branches, like exporting using regedit.exe. <br />
<br />
And  another  to import them (althought it can be<br />
done  with  &quot;Exec  &quot;REGEDIT.EXE  /S  FILE.REG&quot;&quot;. <br />
<br />
<br />
To delete whole branches is easy with this trick:<br />
<br />
import this:<br />
<br />
REGEDIT4<br />
<br />
[-HKEY_CURRENT_USER\Software\Microsoft]<br />
<br />
<br />
I hope some NSIS developer listen to my pray :) <br />
<br />
It's staring you right in the face...<br />
<br />
ExecShell &quot;&quot; FILE.REG<br />
<br />
Since the .reg file is file associated in the registry to open with regedit,  it will try to import the file.  It will prompt you for this,  you click Yes,  it imports the data in the file to the registry (provided you have the proper permissions,  of course).<br />
<br />
For deleting the branch,  though,  I wouldn't try using the method you mentioned above.  You should just use DeleteRegKey,  that's what it's there for.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">12th April 2002, 18:08</div></div><div class="posttext">for Pomflain, I didn't know that DeleteRegKey exist, and now I find surprising that NSIS can delete whole branches and can not save them. Anyway, I just wanted to explicit what functions could be added in NSIS regarding the registry, the purpose of the message is to add ExportRegKey as a function :D<br />
<br />
==================<br />
<br />
for Smile2Me, before coming here and post the idea I found another program to export from registry -and this is how I am working now- but it's slow, big and not very versatile.<br />
<br />
After working with that program for one or two months I decided to post this idea in this forum because I think it's worth the implementation.<br />
<br />
Considering the enormous possibilites of NSIS, and that is already working with the Registry I thought it wouldn't be that difficult to implement and would provide more functionality to *the* installation program :cool:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">12th April 2002, 18:38</div></div><div class="posttext">My advise: Write a small dll that does the job. It's possible in NSIS but really tricky with a lot of if structures. That simply works better in Delphi/C++<br />
<br />
-Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pomflain</div><div class="date">12th April 2002, 20:32</div></div><div class="posttext">Originally posted by n0On3 <br />
for Pomflain, I didn't know that DeleteRegKey exist, and now I find surprising that NSIS can delete whole branches and can not save them. Anyway, I just wanted to explicit what functions could be added in NSIS regarding the registry, the purpose of the message is to add ExportRegKey as a function :D<br />
<br />
<br />
Well essentially the registry functions are just wrappers for the WIN32 API registry calls.  I.E. ReadRegX -&gt; RegOpenKeyEx -&gt; RegQueryValueEx.  So as far as a DeleteRegKey,  there isn't one.  The way you delete a registry tree is the following.  You call RegEnumKey and RegEnumValue (EnumRegKey and EnumRegValue in NSIS) to enumerate over the keys in the tree and then RegDeleteValue and RegDeleteKey (DeleteRegValue and DeleteRegKey in NSIS).  So you could do the exact same thing in NSIS,  exact same programmatically.  If you REALLY wanted to have a function to import values from a file,  RegLoadKey can do it,  but it's limited to creating values in HKEY_USERS or HKEY_LOCAL_MACHINE,  no ROOT.<br />
<br />
So now back to the original issue.  For importing,  I'd just do like I said about the ShellExecute of regedit to import the file.  If that isn't a viable option and you are importing into HKU or HKLM then you can write a wrapper for RegLoad to import that file.<br />
<br />
If you are still having trouble with things and these solutions don't work,  I can write you up some .nsi or C code for the source to make these things work,  they really aren't as complicated as they might seem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">13th April 2002, 12:55</div></div><div class="posttext">Originally posted by Pomflain <br />
<br />
<br />
So as far as a DeleteRegKey,  there isn't one.<br />
<br />
<br />
If you REALLY wanted to have a function to import values from a file,  RegLoadKey can do it,  but it's limited to creating values in HKEY_USERS or HKEY_LOCAL_MACHINE,  no ROOT.<br />
<br />
So now back to the original issue.  For importing, <br />
<br />
<br />
I don't understand you. In the first sentence, are you saying that there's no DeleteRegKey? because, of course, there is, at least in v1.96. If you didn't say that I didn't understand a thing.<br />
<br />
<br />
Well, I don't &quot;REALLY wanted to have a function to import values from a file&quot;. What I miss in NSIS is a function to EXPORT to a regfile (you can read this in the thread title). In my first post you can read the command I am using to import: 'Exec &quot;REGEDIT.EXE /S FILE.REG&quot;'<br />
and it works, so what I need is to export.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">13th April 2002, 15:23</div></div><div class="posttext">As mentioned earlier, it's possible to write some script or function that reads trees of the registry and generates code similar to what regedit produces when exporting to .reg. But actually, this is quite messy in NSIS, because you will need a lot of loops, labels and StrCmp's. So either use the program you were already using or search for some source or program it yourself into a dll file.<br />
<br />
<br />
http://www.google.nl/search?hl=nl&amp;q=export+registry+code&amp;lr= might be helpfull.<br />
<br />
<br />
Good luck,<br />
-Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pomflain</div><div class="date">14th April 2002, 06:11</div></div><div class="posttext">Yeah I meant importing a key,  not deleting.  I typed the wrong thing.  Like I said it's really not all that complicated and doesn't require a whole bunch of loops.  I already have a script that does something similar,  but it doesn't export to a .reg file,  it backs up a registry tree so that it can then be restored back to its original state if the program is uninstalled.  If you want me to write you up some NSI scripting code or write you win32 to put into a custome installer or dll,  all you have to do is ask.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">15th April 2002, 20:31</div></div><div class="posttext">for Pomflain,<br />
<br />
I'd be glad to use your script which backs up and restores registry tree.<br />
<br />
I am using NSIS to run another program which makes use of the registry. I use this program on several computers from a CompactFlash drive, and the program makes changes in the registry every time it runs; so I need to import the regfile, run the program, and on exit save the registry tree. <br />
<br />
The thing is that the program I am using now is very bogus and sometimes forgets data.<br />
<br />
See you next time :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">15th April 2002, 20:56</div></div><div class="posttext">Originally posted by Smile2Me <br />
As mentioned earlier, it's possible to write some script or function that reads trees of the registry and generates code similar to what regedit produces when exporting to .reg. But actually, this is quite messy in NSIS, because you will need a lot of loops, labels and StrCmp's. So either use the program you were already using or search for some source or program it yourself into a dll file.<br />
<br />
Good luck,<br />
-Hendri. <br />
<br />
what's faster, the source/dll option, or the NSIS' loops?<br />
<br />
Anyway, I think it's messier to use to programs for just one work. :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">24th April 2002, 21:48</div></div><div class="posttext">I think that a DLL would be faster.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>