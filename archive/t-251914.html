<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installing to two paths, help (script inside), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installing to two paths, help (script inside) NSIS Discussion" />
	
	<title> Installing to two paths, help (script inside) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installing to two paths, help (script inside)</div>
<hr />
<div class="pda"><a href="t-251914.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=251914">Installing to two paths, help (script inside)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Jarjar</div><div class="date">25th July 2006, 15:13</div></div><div class="posttext">What I want to do:<br />
- Install my application to the path the user chooses (default $PROGRAMFILES\...)<br />
- Install a Winamp plugin...<br />
&amp;nbsp;&amp;nbsp;- Winamp path should be autodetected (from registry uninst value) but still editable by the user<br />
&amp;nbsp;&amp;nbsp;- If a Winamp installation is not detected the user shall be given the choice to not install Winamp plugin OR select the path manually.<br />
<br />
What I have:<br />
See attached file.<br />
<br />
What's wrong with what I have:<br />
- Doesn't autodetect Winamp path (duh, since there's no code for that yet :))<br />
<br />
- When you click &quot;Browse&quot; to locate the Winamp folder, the text in between of the window titlebar and the treeview says &quot;Select the folder to install &lt;app name&gt; in&quot;; which is of course wrong, it should say something along the lines of &quot;Select the path to your Winamp installation:&quot;.<br />
<br />
- When you select the Winamp folder NSIS as a &quot;\&lt;appname&gt;&quot; to the end of the path.<br />
<br />
Help would be appreciated. I'm not too great with NSIS, I might add, so be gentle. ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jarjar</div><div class="date">25th July 2006, 15:14</div></div><div class="posttext">Hmm, seems like the attachment got away when I previewed the post.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">26th July 2006, 09:27</div></div><div class="posttext">1. see example script &quot;winamp plugin&quot; at &lt;nsis&gt;\examples\<br />
2. (i believe you're using MUI) see MUI readme -&gt; page settings -&gt; components page<br />
3. just use $INSTDIR\&lt;appname&gt; in all the file commands or do a SetOutPath &quot;$INSTDIR\&lt;appname&gt;&quot; before copying any files.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jarjar</div><div class="date">26th July 2006, 13:43</div></div><div class="posttext">OK, I'm getting somewhere now.<br />
<br />
Only thing left is to ONLY display the page where you select the winamp directory (the second MUI_PAGE_DIRECTORY) if you've chosen to install the plugin on the components page.<br />
If you choose not to install the plugin, you shouldn't be bothered with choosing where to not install it...<br />
How would I do that? I've tried everything that has entered my mind without any luck.<br />
<br />
Some snippets:<br />
<br />
var WINAMPFOLDER<br />
<br />
Function .onInit<br />
   StrCpy $WINAMPFOLDER &quot;$PROGRAMFILES\Winamp&quot; ; Default folder<br />
FunctionEnd<br />
<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
!insertmacro MUI_PAGE_DIRECTORY ; Main directory<br />
<br />
!define MUI_DIRECTORYPAGE_VARIABLE $WINAMPFOLDER<br />
!insertmacro MUI_PAGE_DIRECTORY ; Winamp directory<br />
; The above two lines should only execute when the user chooses in install the plugin. How?<br />
<br />
<br />
Edit: I just noticed, the older problem when you click &quot;Browse&quot; in the second directory window still persists, in other words, the text is all wrong (not the MUI_DIRECTORYPAGE_TEXT_TOP, but the text in the browse dialog). <br />
Also, it still forces an \&lt;appname&gt; to the end of the path you choose.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th July 2006, 13:49</div></div><div class="posttext">To skip a page, call Abort in its PRE function. To check if a section is selected, use:<br />
<br />
Section &quot;my section&quot; MySection<br />
...<br />
Section<br />
<br />
...<br />
<br />
SectionGetFlags ${MySection} $R0<br />
IntOp $R0 $R0 &amp; ${SF_SELECTED}<br />
StrCmp $R0 ${SF_SELECTED} ...<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">26th July 2006, 23:48</div></div><div class="posttext">To prevent the appending filename, put a backslash at the end of the path:<br />
<br />
StrCpy $WINAMPFOLDER &quot;$PROGRAMFILES\Winamp\&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jarjar</div><div class="date">27th July 2006, 16:46</div></div><div class="posttext">Thanks for the help everybody!<br />
I rewrote the script based on nsis.sourceforge.net/wiki/Two_installations_in_one_installer (thanks Afrow UK ;)).<br />
That plus some reading around means that everything is now exactly like I want it to be.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>