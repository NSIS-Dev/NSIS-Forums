<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" nsDialogs read-only text box, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  nsDialogs read-only text box NSIS Discussion" />
	
	<title> nsDialogs read-only text box [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  nsDialogs read-only text box</div>
<hr />
<div class="pda"><a href="t-290291.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=290291">nsDialogs read-only text box</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">balexis</div><div class="date">15th April 2008, 19:35</div></div><div class="posttext">Hi,<br />
I am trying to create a custom page using nsDialogs that displays a text box containing a clickable URL , but that is not editable by the user.<br />
<br />
Currently I am doing this : <br />
Function MirrorPageFunc<br />
         nsDialogs::Create /NOUNLOAD 1018<br />
	Pop $Dialog<br />
<br />
	${If} $Dialog == error<br />
		Abort<br />
	${EndIf}<br />
<br />
	${NSD_CreateLabel} 0 0 100% 12u &quot;Test&quot;<br />
	Pop $Label<br />
<br />
	${NSD_CreateText} 0 13u 100% -13u &quot;Test : www.google.ca&quot;<br />
	Pop $Text<br />
<br />
	nsDialogs::Show<br />
FunctionEnd<br />
<br />
Actually, I am trying to reproduce the dialog I included as an attachment to this post. AKAIK, the installer that provides that dialog is not built with NSIS, but I'm hopeful it can be done using NSIS.<br />
<br />
Does anyone have a clue ?<br />
<br />
Thanks<br />
Alexis</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">15th April 2008, 21:29</div></div><div class="posttext">and you can't use a customized license page instead of nsDialogs?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th April 2008, 21:54</div></div><div class="posttext">You have to create a rich text control.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">balexis</div><div class="date">16th April 2008, 15:56</div></div><div class="posttext">Anders : I already use the license page at the beginning of my installer. The page I need to display must be at the end of the installation.<br />
<br />
Afro : Indeed this seems to be what I am looking for. If I understand the doc correctly, there is no existing macro to create such a control, but I can do it directly, bypassing the lib entirely.<br />
<br />
I couldn't find any example on how to do so, though. Do you have any pointer for me ?<br />
<br />
Thanks to both of you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">balexis</div><div class="date">17th April 2008, 00:53</div></div><div class="posttext">Alright, I read all day to get somewhere. Only thing that does not work : clicking on a URL does not do anything.<br />
<br />
Here is my code :<br />
Var Dialog<br />
Var Label<br />
Var Text<br />
Var CONTROL<br />
<br />
!define SF_RTF 2<br />
!define EM_STREAMIN 1097<br />
!define EM_EXLIMITTEXT 1077<br />
<br />
Function MirrorPageFunc<br />
     	nsDialogs::Create /NOUNLOAD 1018<br />
	Pop $Dialog<br />
<br />
	${If} $Dialog == error<br />
		Abort<br />
	${EndIf}<br />
<br />
        nsDialogs::CreateControl /NOUNLOAD &quot;RichEdit20A&quot; ${ES_READONLY}|${WS_VISIBLE}|${WS_CHILD}|${WS_TABSTOP}|${WS_VSCROLL}|${ES_MULTILINE}|${ES_WANTRETURN} ${WS_EX_STATICEDGE} 0 10u 100% 90u ''<br />
        Pop $CONTROL<br />
       <br />
        FileOpen $4 &quot;1.rtf&quot; r<br />
<br />
        StrCpy $0 $CONTROL<br />
<br />
        SendMessage $CONTROL ${EM_EXLIMITTEXT} 0 0x7fffffff<br />
        ; set EM_AUTOURLDETECT to detect URL automatically<br />
        SendMessage $CONTROL 1115 1 0<br />
<br />
        System::Get /NoUnload &quot;(i, i .R0, i .R1, i .R2) iss&quot;<br />
        Pop $2<br />
        System::Call /NoUnload &quot;*(i 0, i 0, k r2) i .r3&quot;<br />
<br />
        System::Call /NoUnload &quot;user32::SendMessage(i r0, i ${EM_STREAMIN}, i ${SF_RTF}, i r3) i.s&quot;<br />
<br />
        loop:<br />
        	Pop $0<br />
         	StrCmp $0 &quot;callback1&quot; 0 done<br />
          	System::Call /NoUnload &quot;kernel32::ReadFile(i $4, i $R0, i $R1, i $R2, i 0)&quot;<br />
<br />
           	Push 0 # callback's return value<br />
            	System::Call /NoUnload &quot;$2&quot;<br />
             	goto loop<br />
        done:<br />
        System::Free $2<br />
        System::Free $3<br />
        FileClose $4<br />
<br />
        nsDialogs::Show<br />
FunctionEnd<br />
<br />
The RTF file only contains a string :<br />
http://www.google.ca<br />
I can see the string being blued and underlined, and the mouse cursor changes from the regular arrow to a hand with a little pointing finger. However, clicking does nothing.<br />
<br />
Any hints ? <br />
<br />
Alexis</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">17th April 2008, 01:26</div></div><div class="posttext">There is nothing stopping you from using more than one licensepage.<br />
<br />
Also checkout http://nsis.sourceforge.net/Readme_Page_Based_on_MUI_License_Page<br />
<br />
If you still want to use nsDialogs, you must do:<br />
<br />
SendMessage(hwLicense,EM_SETEVENTMASK,0,ENM_LINK|ENM_KEYEVENTS);<br />
<br />
then handle WM_NOTIFY ( see http://nsis.svn.sourceforge.net/viewvc/nsis/NSIS/trunk/Source/exehead/Ui.c?revision=5429&amp;view=markup (search for EN_LINK) )<br />
<br />
I'm not sure if it's possible to do with the current nsDialog, can't remember exactly how it handles WM_NOTIFY</div></div><hr />


<div class="post"><div class="posttop"><div class="username">balexis</div><div class="date">17th April 2008, 14:14</div></div><div class="posttext">Anders, thanks for your help.<br />
<br />
I just realized how much you could customize a License page, this is really great and pretty much easier than to create an entirely custom page from CreateControl.<br />
<br />
One last question for you and I'll be all set : I can't seem to set two different values (one for each License page) for the MUI_TEXT_LICENSE_TITLE define. As soon as I set it, it is displayed in both license pages. It is the only define that behaves this way. See code here :<br />
<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!insertmacro MUI_PAGE_INSTFILES<br />
; Show first default License page<br />
!insertmacro MUI_PAGE_LICENSE 1.rtf<br />
<br />
; Code to modify our custom license page<br />
!define MUI_LICENSEPAGE_TEXT_TOP &quot;&quot;<br />
!define MUI_LICENSEPAGE_TEXT_BOTTOM &quot;&quot;<br />
!define MUI_LICENSEPAGE_BUTTON &quot;Next&quot;<br />
!define MUI_TEXT_LICENSE_SUBTITLE &quot;&quot;<br />
!define MUI_TEXT_LICENSE_TITLE &quot;Something&quot;<br />
LicenseText &quot; &quot;<br />
!insertmacro MUI_PAGE_LICENSE 1.rtf<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
The first license page is displayed with all the default text, except for the &quot;Something&quot; string appearing instead of the default &quot;License Agreement&quot; string.<br />
<br />
Bug or expected behavior ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">17th April 2008, 15:26</div></div><div class="posttext">!define MUI_PAGE_HEADER_TEXT &quot;foo&quot;<br />
!define MUI_PAGE_HEADER_SUBTEXT &quot;bar&quot;<br />
!insertmacro MUI_PAGE_LICENSE &quot;${__FILE__}&quot;<br />
<br />
OR you can use a show callback function and call the MUI_HEADER_TEXT macro</div></div><hr />


<div class="post"><div class="posttop"><div class="username">balexis</div><div class="date">17th April 2008, 15:32</div></div><div class="posttext">This is excellent! <br />
<br />
Thank you very much Anders, you have been very helpful.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>