<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait on .msi file for silent install, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait on .msi file for silent install NSIS Discussion" />
	
	<title> ExecWait on .msi file for silent install [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait on .msi file for silent install</div>
<hr />
<div class="pda"><a href="t-281373.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=281373">ExecWait on .msi file for silent install</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">galevsky</div><div class="date">13th November 2007, 16:44</div></div><div class="posttext">Any idea why my function doesn't work with Acrobat Reader v7.0.9 installer ?<br />
<br />
I use a function<br />
<br />
<br />
###################<br />
# InstallQuietMSI #<br />
###################<br />
# MSI Installer launcher in quiet mode<br />
#<br />
# Inputs:<br />
#        - Stack Top -<br />
#        0: installer executable<br />
#        1: installer path<br />
#<br />
# Returns:<br />
#         - Stack Top -<br />
#         0: installation returned code<br />
##<br />
Function InstallQuietMSI<br />
         Exch $R0<br />
         Exch<br />
         Exch $R1<br />
         Push $0<br />
         setOutPath &quot;$SYSDIR&quot;<br />
         MessageBox MB_OK 'MSI: &quot;$R1\$R0&quot; /quiet /norestart'<br />
         ExecWait '&quot;$R1\$R0&quot; /quiet /norestart' $0<br />
         MessageBox MB_OK &quot;RC: $0&quot;<br />
         Exch $0<br />
         Exch 2<br />
         Pop $R1<br />
         Pop $R0<br />
FunctionEnd<br />
<br />
<br />
At runtime, trying to install both jre_v1.5 and Acrobat Reader v7.0.9:<br />
<br />
&gt; Execute: &quot;ressources\tools\Adobe\en\adobe.msi&quot; /qb<br />
(the returned code $0 is not set at all (contains previous value))<br />
&gt; Execute: &quot;ressources\tools\JRE\jre-1_5_0_11-windows-i586-p.exe&quot; /qb<br />
(the returned code is 0, everything run well and install is process)<br />
<br />
<br />
I tried to do that in a shell window (from the dir containing the setup.exe):<br />
<br />
&gt; C:\Documents and Settings\galevsky\Desktop\validation\&quot;ressources\tools\Adobe\fr\adobe.msi&quot; /quiet<br />
<br />
and it works pretty good. The adobe.msi file (with a Data1.cab one) was picked up into INSTDIR\Setup Files\ of Acrobat Reader v7.<br />
<br />
So, what is wrong ? Is there any strange behaviour with ExecWait ? I tried a &quot;msiexec&quot; /i path\adobe.msi but same behaviour happened... <br />
<br />
Thks for your help,<br />
<br />
<br />
Gal'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th November 2007, 19:24</div></div><div class="posttext">If it's a .msi then you should execute it with msiexec.exe or ExecShell.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galevsky</div><div class="date">13th November 2007, 19:58</div></div><div class="posttext">msiexec is not better but I will try ExecShell...<br />
<br />
Gal'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th November 2007, 20:50</div></div><div class="posttext">You won't be able to get an exit code with ExecShell, so you'd need to use msiexec.exe for that.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galevsky</div><div class="date">13th November 2007, 21:23</div></div><div class="posttext">I just do:<br />
<br />
&gt; Execute: msiexec /i &quot;ressources\tools\Mysql\mysql_server_v5.0.45.msi&quot; and it fails on RC=1619 !!!<br />
<br />
I am sure the path is good....<br />
<br />
Gal'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th November 2007, 21:28</div></div><div class="posttext">Firstly it's resources and not ressources, but either way try not to use relative paths. That would be executed relative to what path is set with SetOutPath. Use a full path to be safe.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galevsky</div><div class="date">13th November 2007, 21:31</div></div><div class="posttext">I read that this error comes from rights problem, so I decided to <br />
<br />
&gt; CopyFile &quot;path\mysql_server_v5.0.45.msi&quot; &quot;$TEMP\mysql_server_v5.0.45.msi&quot;  <br />
&gt; Execute: msiexec /i &quot;$TEMP\mysql_server_v5.0.45.msi&quot; <br />
<br />
... but failed also. Same error. :(<br />
<br />
Gal'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th November 2007, 21:32</div></div><div class="posttext">1619 is ERROR_INSTALL_PACKAGE_OPEN_FAILED which suggests what Afrow has already said - msiexec.exe can't find the MSI file form the path you gave it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galevsky</div><div class="date">13th November 2007, 21:34</div></div><div class="posttext">Originally posted by Afrow UK <br />
Firstly it's resources and not ressources, but either way try not to use relative paths. That would be executed relative to what path is set with SetOutPath. Use a full path to be safe.<br />
<br />
Stu  <br />
<br />
Yep mixing both french and eng. I am having a try with absolute path...<br />
<br />
Thks ;)<br />
<br />
<br />
Gal'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galevsky</div><div class="date">13th November 2007, 21:35</div></div><div class="posttext">Same error....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th November 2007, 21:43</div></div><div class="posttext">1619's text is:# This installation package could not be opened.  Verify that<br />
# the package exists and that you can access it, or contact<br />
# the application vendor to verify that this is a valid<br />
# Windows Installer package.So if the path really is valid, it might be a corrupted MSI. Does it work when you double click it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galevsky</div><div class="date">13th November 2007, 21:54</div></div><div class="posttext">Oups, I made a type during the try with the absolute path: absolute path fix my problem with mysql.msi. I will now check for acrobat_reader.msi.<br />
<br />
Gal'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galevsky</div><div class="date">13th November 2007, 22:23</div></div><div class="posttext">Fixed !!!!!!<br />
<br />
Many thanks, guys, the key is using absolute path.<br />
<br />
Gal'</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>