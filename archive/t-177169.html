<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" InstallOptions checkboxes, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  InstallOptions checkboxes NSIS Discussion" />
	
	<title> InstallOptions checkboxes [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  InstallOptions checkboxes</div>
<hr />
<div class="pda"><a href="t-177169.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=177169">InstallOptions checkboxes</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bradharding</div><div class="date">19th April 2004, 02:43</div></div><div class="posttext">Hi,<br />
<br />
I'm having some problems with using the InstallOptions plugin. I am using Modern UI and have created my own custom finish page. It has some text, and a checkbox allowing the user to choose to open the program straight away, just as the default finish page does. In that page's ini file I have:<br />
<br />
[Field 2]<br />
Type=CheckBox<br />
Left=0<br />
Right=-1<br />
Top=25<br />
Bottom=46<br />
Text=I want to run the program now.<br />
State=1<br />
In my program's nsi file, I have the finish page's leave function as:<br />
<br />
Function LeaveFinishPage<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;Finish Page.ini&quot; &quot;Field 2&quot; &quot;State&quot;<br />
  StrCmp $R0 &quot;1&quot; 0 +2<br />
    ExecShell &quot;open&quot; &quot;program.exe&quot;<br />
FunctionEnd<br />
The page itself comes up fine. The problem is, sometimes the program will not open when the installer is closed, even if the user doesn't touch the checkbox (which, of course, is on to begin with). I can't seem to find a pattern as to when this happens. Quite simply, sometimes it'll work, sometimes it won't.<br />
<br />
I've thought maybe I need to push and/or pop $R0 before and/or after, but it hasn't made a difference (don't really understand the push/pop commands, anyway).<br />
<br />
Am I missing something? I've looked in Modern.nsh, and it's done there in the same way.<br />
<br />
Regards,<br />
Brad.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">19th April 2004, 03:13</div></div><div class="posttext">Try this before showing the page:<br />
<br />
!insertmacro MUI_INSTALLOPTIONS_WRITE &quot;Finish Page.ini&quot; &quot;Field 2&quot; &quot;State&quot; &quot;0&quot;<br />
<br />
So will prevent that to happen.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bradharding</div><div class="date">19th April 2004, 03:22</div></div><div class="posttext">Thanks for your help! :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>