<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Reading from a file, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Reading from a file NSIS Discussion" />
	
	<title> Reading from a file [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Reading from a file</div>
<hr />
<div class="pda"><a href="t-180280.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=180280">Reading from a file</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">wlzard</div><div class="date">17th May 2004, 13:08</div></div><div class="posttext">I'm having trouble reading from a file. I need to read a string from a file and then set it to a text field. I have no problems doing the text field but reading the file is causing me serious problems.<br />
<br />
Here is a small section of the file I need to read:<br />
<br />
&quot;SteamAppData&quot;<br />
{<br />
	&quot;RememberPassword&quot;		&quot;1&quot;<br />
	&quot;AutoLoginUser&quot;		&quot;anaddress@somewhere.com&quot;<br />
	&quot;anotheraddress@nowhere.com&quot;<br />
	{<br />
		&quot;User&quot;		&quot;anaddress@somewhere.com&quot;<br />
		&quot;AccountCreated&quot;		&quot;1&quot;<br />
		&quot;ShowNotifyTrayHintDialog&quot;	&quot;0&quot;<br />
		&quot;ShowExitDialog&quot;		&quot;1&quot;<br />
		&quot;ShowExitLogoutDialog&quot;		&quot;1&quot;<br />
<br />
I need to read the &quot;AutoLoginUser&quot; line. i.e I need to set &quot;anaddress@somewhere.com&quot; to a variable.<br />
<br />
Any help would be greatly appreciated.<br />
<br />
<br />
Thanks for reading.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wlzard</div><div class="date">19th May 2004, 07:48</div></div><div class="posttext">Was my question too hard? Did I not give enough info? Or has it been answered else where?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">19th May 2004, 10:02</div></div><div class="posttext">You can use FileOpen to open the file for reading. Then you can read every line using FileRead.<br />
<br />
If it's a line you don't want to change (check the line using string function like StrCmp and Cpy), add the line to a variable, otherwise add the changed value.<br />
<br />
Then close the file, open it for writing and write everything back.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wlzard</div><div class="date">19th May 2004, 14:00</div></div><div class="posttext">Thanks for the help<br />
<br />
I do not wish to modify the file at all, just open, read, and close.<br />
<br />
However how do I capture one part of the line. Is there a StringTokenizer or anything like that I need to use?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">19th May 2004, 16:19</div></div><div class="posttext">That's even easier. There is a StrTok function available in the StrFunc header file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wlzard</div><div class="date">20th May 2004, 09:30</div></div><div class="posttext">thanks, great help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wlzard</div><div class="date">20th May 2004, 11:17</div></div><div class="posttext">Sorry to be a pain but the StrFunc wont work. I've done<br />
<br />
!include &quot;StrFunc.nsh&quot;<br />
<br />
But when I try to use any of the methods it just gives me errors. I even went as far as using the examples and they still don't work.<br />
<br />
Section<br />
<br />
  ${StrStr} $3 &quot;This is just an example&quot; &quot;just&quot;<br />
	<br />
SectionEnd<br />
<br />
I get this error:<br />
Section: &quot;&quot;<br />
!insertmacro: FUNCTION_STRING_StrStr<br />
!insertmacro: macro &quot;FUNCTION_STRING_StrStr&quot; requires 0 parameter(s), passed 3!<br />
Error in script &quot;stdin&quot; on line 99 -- aborting creation process<br />
<br />
<br />
What am I doing wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wlzard</div><div class="date">20th May 2004, 11:38</div></div><div class="posttext">I apologize for the tripple post but I've come up with a different way of doing it (since I couldn't get StrFunc working. I did the following:<br />
<br />
FileOpen $1 $INSTDIR\config\SteamAppData.vdf r<br />
FileRead $1 $2<br />
FileRead $1 $2<br />
FileRead $1 $2<br />
FileRead $1 $2<br />
	<br />
StrCpy $7 $2 80 19<br />
<br />
FileClose $1<br />
<br />
It almost works. $7 = anaddress@somewhere.com&quot;<br />
<br />
but I need the &quot; to be taken of the end. Is this possible? Or is it still better to use StrFunc?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">20th May 2004, 12:12</div></div><div class="posttext">They work fine, you only have to initialize them first (see StrFunc.txt).<br />
<br />
You can trim a trailing character using StrLen and StrCpy.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wlzard</div><div class="date">20th May 2004, 12:21</div></div><div class="posttext">Oops I forgot to initialize them. Thanks for that I'll remember it for next time.<br />
<br />
However in the mean time I worked something else out. It might not be elegant but it works<br />
<br />
FileOpen $1 $INSTDIR\config\SteamAppData.vdf r<br />
	FileRead $1 $2<br />
	FileRead $1 $2<br />
	FileRead $1 $2<br />
	FileRead $1 $2<br />
	<br />
	StrCpy $7 $2 80 19<br />
	<br />
	loop:<br />
		IntOp $8 $8 + 1<br />
		StrCpy $9 $7 $8<br />
		StrCmp $7 $9 trimIt loop<br />
	<br />
	trimIt:<br />
		IntOp $8 $8 - 2<br />
		StrCpy $6 $7 $8<br />
<br />
	FileClose $1<br />
<br />
<br />
Thanks for all your help</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>