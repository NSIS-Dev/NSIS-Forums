<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" InstallLib problem/query/issue, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  InstallLib problem/query/issue NSIS Discussion" />
	
	<title> InstallLib problem/query/issue [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  InstallLib problem/query/issue</div>
<hr />
<div class="pda"><a href="t-261565.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=261565">InstallLib problem/query/issue</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">cpeel2300</div><div class="date">11th December 2006, 15:54</div></div><div class="posttext">Hi all - long time NSIS user, first time poster...<br />
<br />
I have query regarding the InstallLib macro which is causing me some problems.  I have an installer which simply copies and registers a number of ActiveX DLLs, TLBs and various other bits and pieces.<br />
<br />
Everything works fine if no applications have any of the DLLs locked, however things seem to go wrong if even one of the DLLs is in use.  I've only just noticed this as I've just put together version 3.0 of the installer and new DLLs which can't already be on the user's PC were being copied but weren't being registered.<br />
<br />
I'm no NSIS guru so taking a look at Library.nsh didn't really help but it seems that the macro simply adds _all_ files to the NSIS.Library.RegTool.v2 registry key once any one of them fails.<br />
<br />
Is this by design?  It's causing me a lot of problems as I'm happy for the user to have to reboot if DLL's A, B and C are already installed and in use but it's frustrating to make them reboot when new DLLs X and Y are installed and can't have already been in use.<br />
<br />
Would really appreciate some help on this one!<br />
<br />
Thanks in advance<br />
<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th December 2006, 18:37</div></div><div class="posttext">It's by design, in case the DLL files depend on each other. If B depends on A but A is to be replaced at reboot, B might fail registering due to the old version of A. So, when the reboot flag is set, which means some DLL should be replaced at reboot, the Library macros set all DLL files to be registered at reboot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cpeel2300</div><div class="date">13th December 2006, 18:05</div></div><div class="posttext">Thanks for the reply!<br />
<br />
Is there any way to avoid this?  I appreciate it's a bit unusual but it would really help me out.  I'm no good as NSIS macro programming but am happy to give it a try if someone can point me in the right direction.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th December 2006, 19:47</div></div><div class="posttext">You can remove the IfReboot check in Library.nsh. You were able to understand what happens there, changing it is just one small step forward.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cpeel2300</div><div class="date">15th December 2006, 10:06</div></div><div class="posttext">Thanks - will take a look at the macro and see how I get on :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">15th December 2006, 12:54</div></div><div class="posttext">For some DLL's to unload it is an option to kill explorer shell, uninstall the DLL and restart the explorer shell again, tricky but possible. No reboot needed for install of some ActiveX dll's this way.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BuilderBob</div><div class="date">25th August 2008, 13:11</div></div><div class="posttext">Hi people, I've just wasted 3 hours on this :). If the reboot flag is on for whatever reason, dll will be registered at startup. It messed up my manual &quot;Rename-&gt;Delete renamed file on reboot-&gt;Copy new file and register&quot; from my old thread (http://forums.winamp.com/showthread.php?s=&amp;threadid=292661).<br />
<br />
I rename a busy dll and then delete it. This sets the reboot flag, so when I call InstallLib it will do it on reboot even if it doesn't have to.<br />
<br />
Can you please document it? It was fun reading and adding debug messages inside Library.nsh, but I could have checked my facebook instead ;).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>