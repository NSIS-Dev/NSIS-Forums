<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to set language in .onInit function?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to set language in .onInit function? NSIS Discussion" />
	
	<title> How to set language in .onInit function? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to set language in .onInit function?</div>
<hr />
<div class="pda"><a href="t-301723.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=301723">How to set language in .onInit function?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Castalia</div><div class="date">5th January 2009, 13:16</div></div><div class="posttext">If already installed, there should be a language id in the registry. We can use &quot;!insertmacro MUI_UNGETLANGUAGE&quot; in un.onInit function. But how to set the right language in .onInit function?<br />
<br />
I want to display a messagebox in .onInit function to confirm uninstall if it's already installed. Of course, I want the messagebox in multi-language like:<br />
<br />
MessageBox MB_OKCANCEL|MB_ICONQUESTION|MB_DEFBUTTON2 &quot;$(UninstallConfirm)&quot; IDOK uninst<br />
<br />
But how to set the right language? MUI_UNGETLANGUAGE has no effect in .onInit function. And I try to use StrCpy set $LANGUAGE var and there was also no effect.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">5th January 2009, 14:20</div></div><div class="posttext">If you're using MUI_UNGETLANGUAGE, I presume you're also using..<br />
<br />
MUI_LANGDLL_REGISTRY_ROOT root<br />
MUI_LANGDLL_REGISTRY_KEY key<br />
MUI_LANGDLL_REGISTRY_VALUENAME value_name<br />
<br />
In the installer to store that setting.<br />
<br />
Instead of letting MUI read the value, you could read it yourself.<br />
<br />
However, MUI should already be using the language stored in that registry key automatically... if it doesn't for that messagebox at .onInit, then I suppose you will indeed have to go with manually reading out the value and applying the appropriate language before the messagebox is displayed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">5th January 2009, 14:35</div></div><div class="posttext">from the helpfile If you change the language in the .onInit function, note that language strings in .onInit will still use the detected language based on the user's default Windows language, because the language is initialized after .onInit.<br />
<br />
you can use .onGuiInit (but why is the uninstall confirm page not enough?)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Castalia</div><div class="date">5th January 2009, 14:55</div></div><div class="posttext">Thanks for reply.<br />
<br />
Yes, I read the language manually but this is not the problem, the problem is even I set the $LANGUAGE, MessageBox also not display the right language:<br />
<br />
<br />
Function .onInit<br />
  StrCpy $LANGUAGE ${LANG_SIMPCHINESE}<br />
  MessageBox MB_OKCANCEL|MB_ICONQUESTION|MB_DEFBUTTON2 &quot;$(UninstallConfirm)&quot; IDOK uninst<br />
FunctionEnd<br />
<br />
<br />
It's english, and my system is english.<br />
<br />
The uninstall confirm page is displayed when uninstall is processing. But I need to confirm if uninstall when user run install.exe for twice(when he already installed), not run uninstall.exe, thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th January 2009, 14:59</div></div><div class="posttext">Use un.onGUIInit (!define MUI_CUSTOMFUNCTION_UNGUIINIT un.myOnGUIInit). Languages are not initialised until after .onInit.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Castalia</div><div class="date">5th January 2009, 15:22</div></div><div class="posttext">Thanks for all! .onGuiInit and un.onGUIInit is good, I've done, thanks.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>