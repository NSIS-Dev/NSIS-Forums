<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Auto-run the installed app, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Auto-run the installed app NSIS Discussion" />
	
	<title> Auto-run the installed app [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Auto-run the installed app</div>
<hr />
<div class="pda"><a href="t-304377.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=304377">Auto-run the installed app</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Quildra</div><div class="date">19th March 2009, 16:25</div></div><div class="posttext">Hello all,<br />
I'm having a slight problem with the end of my installer. I have been asked to make the program we are installing auto run once the installation has finished. <br />
<br />
At the minute I have a dummy section which ends thus:<br />
<br />
; Pop up dialog to kill the movie player when the downlaod is done. <br />
HideWindow MessageBox MB_OK &quot;Your Learn To Play Experiance is now ready. Press OK to begin.&quot; <br />
sleep 500 <br />
FindWindow $dialogeHWND &quot;#32770&quot; &quot;&quot; $HWNDPARENT <br />
DetailPrint $dialogeHWND <br />
Call repositionDialoge <br />
KillProcDLL::KillProc &quot;projector.exe&quot; <br />
; Run the program <br />
ExecShell open &quot;LTP\Program.exe&quot; <br />
sleep 1000 <br />
Delete Install.ini <br />
Delete LTP_Movie.exe <br />
SectionEnd<br />
<br />
<br />
However my program is shutting itself down straight away. I have a feeling this is to do with the way I am running the program from the installs as if I navigate to the install path and run it from there it runs fine.<br />
<br />
Any help would be greatly appreciated</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">19th March 2009, 16:35</div></div><div class="posttext">SetOutPath will set the working directory, so you should probably set it to the LTP folder. Also, you should specify the full path to the exe in ExecShell (Just plain Exec is fine for .exe files, no need to use ExecShell)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Quildra</div><div class="date">19th March 2009, 16:37</div></div><div class="posttext">The output path has been set at the beginning of the script.<br />
however I shall quickly try this and see.<br />
<br />
*Edit*<br />
Nope no luck using <br />
Exec '&quot;$OUTDIR\LTP\XylophoneP.exe&quot;'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Quildra</div><div class="date">19th March 2009, 18:09</div></div><div class="posttext">After some investigation it appears as though my exe is being moved away from its data which causes the file to auto exit.<br />
So my next question is does either exec or execshell move the application</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">19th March 2009, 18:49</div></div><div class="posttext">of course it does not move the file</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Quildra</div><div class="date">19th March 2009, 18:55</div></div><div class="posttext">Well the executable is sat right next to my data folder, the executable runs when I run it manually. I've debugged my application and when run from the installer it cannot find a required file in the data folder. So it seems the logical explanations are that either the application has been moved, the wrong application is being run or the data has moved.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">19th March 2009, 19:32</div></div><div class="posttext">wrong working / current directory?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Quildra</div><div class="date">19th March 2009, 19:36</div></div><div class="posttext">Everything extracts to the correct dir which is $OUTDIR\LTP <br />
and the documentation states that exec and execshell both use the current $OUTDIR as their working directory. so i don't think so. I've gotten around the problem for the moment by using:<br />
ExecShell open LTP\Short<br />
which is a shortcut to the file and that runs it correctly. however I would like to get to the real issue and not have to use the shortcut</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">19th March 2009, 20:00</div></div><div class="posttext">check with process explorer to see the working directory. And process monitor or filemon to see which directory your application is looking in</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Quildra</div><div class="date">20th March 2009, 11:28</div></div><div class="posttext">Process Monitor reports that it is looking in the same folder as the installer is located in.<br />
However the application should only look in the folder it resides in.<br />
Process Explorer is reporting that it has been executed from LTP\ so Im still at a bit of a dead end</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Quildra</div><div class="date">20th March 2009, 11:36</div></div><div class="posttext">Just to keep the thread updated so please excuse the double post.<br />
On a whim I added the following lines<br />
<br />
SetOutPath $EXEDIR\LTP<br />
; Run the program<br />
ExecShell open Program.exe<br />
 <br />
<br />
the EXEDIR is there purely for debug purposes btw.<br />
<br />
And it now works... yay.<br />
<br />
my next question is can I use syntax like <br />
<br />
SetOutPath $OUTDIR\LTP<br />
<br />
<br />
if so I think that will solve my problem well enough</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">20th March 2009, 12:35</div></div><div class="posttext">You say it's been executed from LTP\ And you say you don't want that so why are you still talking about SetOutPath $OUTDIR\LTP??<br />
<br />
If you install the .exe to $instdir\myapp.exe, all you need is SetOutPath $instdir</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Quildra</div><div class="date">20th March 2009, 12:55</div></div><div class="posttext">I didn't say I didn't want it run from the \LTP folder.<br />
I set the outdir to $exedir\LTP as an experiment to see if it for some unknown reason effected the directory my program was using as its root. And I set the root to $EXEDIR as other files are used in that root and then the application itself and its data is extracted to .\LTP<br />
<br />
I'm just more curious as to why the SetOutPath function affects the root of my application.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">20th March 2009, 13:05</div></div><div class="posttext">because setoutpath changes the current aka working directory, a child process will inherit this working folder unless you specify a new working folder when calling CreateProcess (so, the nsis way to specify it is to use setoutpath before calling Exec)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Quildra</div><div class="date">20th March 2009, 13:08</div></div><div class="posttext">Ah that makes sense now then.<br />
Thank you for your help</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>