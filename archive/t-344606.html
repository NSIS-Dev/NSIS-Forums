<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Construct section id name during runtime, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Construct section id name during runtime NSIS Discussion" />
	
	<title> Construct section id name during runtime [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Construct section id name during runtime</div>
<hr />
<div class="pda"><a href="t-344606.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=344606">Construct section id name during runtime</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">BreezeUADN</div><div class="date">3rd May 2012, 10:11</div></div><div class="posttext">Greetings<br />
<br />
short version:<br />
Section &quot;sec&quot; Sec1 <br />
SectionEnd<br />
MessageBox MB_OK &quot;${Sec1}&quot; works<br />
(&quot;Sec1&quot; in $2)<br />
MessageBox MB_OK &quot;${$2}&quot; - want that to work<br />
<br />
long version:<br />
Well, I know it's illogical (even silly maybe) to do that sort of thing but maybe there is a workaround, or alternative solution for such a problem:<br />
<br />
0) I have several sections with id's like <br />
Section &quot;-Client&quot; SECCLNT_Sec1<br />
Section &quot;-Client&quot; SECCLNT_Sec2<br />
...<br />
Section &quot;-Server&quot; SECSRVR_Sec1<br />
Section &quot;-Server&quot; SECSRVR_Sec2<br />
...<br />
Section &quot;-Common&quot; SECCMN_Sec1<br />
... and so on<br />
so, after setup executable is compiled a section can be found either by it's displayable name (via SectionGetText + iteration through em all) or simply by id.<br />
<br />
1) I have an XML like<br />
&lt;root&gt;<br />
  &lt;module&gt;Sec1&lt;/module&gt;<br />
  &lt;module&gt;Sec2&lt;/module&gt;<br />
  ...<br />
&lt;/root&gt;<br />
<br />
The problem:<br />
When a section is defined I could simply access it via id (int), like<br />
SectionGetText ${Sec1} $R1 (gets displayable section text)<br />
or MessageBox MB_OK ${Sec1} (prints int id)<br />
but<br />
Is there a way to somehow push (read from XML at runtime) &quot;Sec1&quot; name into ${}?<br />
example:<br />
${xml::GetText} $2 $3 ... (&quot;Sec1&quot; in $2)<br />
and then something like (SECCLNT_Sec1 is defined above)<br />
SectionGetText &quot;SECCLNT_$2&quot; $R1 (compiles without warnings/errors but ofc. doesn't work since it requires a variable, not a text...)<br />
<br />
p.s. there is a few solutions I can think of but none are pretty, + I can't rely on section names since they all are the same, the only way to solve this is to store section id's inside of XML as an attributes, but then that XML becomes unreliable...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">3rd May 2012, 11:13</div></div><div class="posttext">You could use names like Section &quot;Client:C1&quot; SECCLNT_Sec1 and parse and store these in a .ini in .onInit so you can get index from name. Then just set the display names to whatever you want before you get to the UI.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BreezeUADN</div><div class="date">3rd May 2012, 11:42</div></div><div class="posttext">Ahhh, really - read a name from an xml, iterate through sections looking for that name, when found - do the work and then just rename... Thanks Anders that's a brilliant idea!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">3rd May 2012, 12:29</div></div><div class="posttext">Reading from XML was not part of my plan, I would just write to a .ini in .onInit:<br />
<br />
[secmappings]<br />
C1=2<br />
C2=3<br />
...<br />
<br />
Then read the .ini when you need to know the index of C1...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BreezeUADN</div><div class="date">3rd May 2012, 14:05</div></div><div class="posttext">That would be more convenient yes, but (it's a bit complicated) unfortunately the script is flexible - most of it is generated dynamically: base nsi + generated nsh include with sections part and other stuff - that part changes all the time and could be transferred between PC's (uses sys. env. vars for paths) and because of that I should generate [secmappings] with that nsh part every time section tree changes. Then I'll have 2 files instead of one, and here comes the problem - someone could move only 1 file (i.e. mess up somehow) and my section indexes won't match section names anymore - so in this case indexes are unreliable as I mentioned in p.s. above... On top of that there comes the &quot;license&quot; (sort of) - XML file - that should contain this data anyways. Only &quot;module&quot; names inside, from which section names could be generated...<br />
(err, prob my grammar skills is not good enough to make the phrases look &quot;normal&quot;, sorry)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>