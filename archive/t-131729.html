<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" File not extracted to pluginsdir everytime?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  File not extracted to pluginsdir everytime? NSIS Discussion" />
	
	<title> File not extracted to pluginsdir everytime? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  File not extracted to pluginsdir everytime?</div>
<hr />
<div class="pda"><a href="t-131729.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=131729">File not extracted to pluginsdir everytime?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">14th April 2003, 19:38</div></div><div class="posttext">I have a text file which I extract to the plugins dir when my installer starts up in the .onInit function as show here,<br />
<br />
File &quot;/oname=$PLUGINSDIR\ReleaseNotes.txt&quot; &quot;MyReleaseNotes.txt&quot;<br />
<br />
I have a custom page at the end of my installer in which the user can select to view this text file or not.  However sometimes the text file does not open.  I get an error message telling me the text file does not exist.<br />
<br />
Interstingly enough, I have another similar call in .onInit that DOES work everytime.  It's a bitmap which I display on the same final custom page.<br />
<br />
File &quot;/oname=$PLUGINSDIR\StartFinishImage.bmp&quot; &quot;MyBitmap.bmp&quot; <br />
<br />
The only difference between the two files is there type and name but the syntax shold still be the same shouldn't it?  Any suggestions, I figure I'm just forgetting to do something?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th April 2003, 07:57</div></div><div class="posttext">Have you initialized the plugins directory using InitPluginsDir or by calling a plug-in function? $PLUGINSDIR is empty until you use InitPluginsDir or a plug-in function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">15th April 2003, 17:48</div></div><div class="posttext">Yes I've got &quot;InitPluginsDir&quot; right before I extract the files to $PLUGINSDIR.  I've also tried extracting the file to the current users temp directory.  I'm reading the files that I'm packaging for the installer off of a network drive.  I was wondering if that might be causing problems but I can't see how.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">15th April 2003, 17:53</div></div><div class="posttext">That should make no difference.<br />
<br />
Are you using the latest development version (get the CVS files using NSIS Update)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">15th April 2003, 18:27</div></div><div class="posttext">Just got the latest version.  No difference.  The one thing I have noticed is that when I run my installer on the machine that I build the installer on most of the time the ReleaseNotes.txt file will be displayed.  <br />
<br />
When I go to run it on another machine most of the time it is not displayed although there is the rare occasion where it is displayed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th April 2003, 18:40</div></div><div class="posttext">Can you please attach the script? If you can't, can you please make a smaller example script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">15th April 2003, 18:54</div></div><div class="posttext">Here's the script.  I did cut alot of stuff out because it is quote large so if a function, variable constant definition is missing please ignore that.<br />
<br />
I've included the function's I use where ReleaseNotes.txt is inovlved.  I unpack the file to the pluginsdir in .onInit and use it in the FinshPage custom page function. Anything you guys might be able to suggest would be greatly appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">15th April 2003, 19:39</div></div><div class="posttext">The header bitmap and the Welcome/Finish page is also files the Modern UI extracts to the plugins directory.<br />
<br />
Maybe they do exist but the other code is the problem.<br />
<br />
Replace<br />
<br />
Exec &quot;notepad.exe $PLUGINSDIR\ReleaseNotes.txt&quot;<br />
<br />
by<br />
<br />
ExecShell &quot;open&quot; &quot;$PLUGINSDIR\ReleaseNotes.txt&quot;<br />
<br />
Maybe that helps.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">15th April 2003, 20:17</div></div><div class="posttext">Using ExecShell didn't seem to make a difference.  I'm pretty sure there is something wrong elsewhere though.  If I check the acutal contents of the plugins directory the release notes file is there but for some reason when I try to open it from the installer it says it can't find it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">15th April 2003, 20:19</div></div><div class="posttext">If the header bitmap etc. work fine, there is nothing wrong with the Plugins directory.<br />
<br />
Please check the contents of the plugins directory after launching the installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">15th April 2003, 21:01</div></div><div class="posttext">The pluginsdir directory looks alright.  The bitmap that I use on my final custom dialog is there and so is the release notes file I want to view but any attemps to view it using notepad/wordpad fail.  I'll get a message saying the file cannot be found and yet if I attempt to load the file from a command prompt window say as, <br />
<br />
&quot;wordpad &lt;plugins directory&gt;\ReleaseNotes.txt&quot; it works.  Very odd.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">15th April 2003, 21:26</div></div><div class="posttext">So even ExecShell &quot;open&quot; &quot;$PLUGINSDIR\ReleaseNotes.txt&quot; does not work?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">15th April 2003, 21:40</div></div><div class="posttext">Correction, it does work but it depends on where I make the &quot;Execshell&quot; call.<br />
<br />
If I call &quot;Execshell&quot; to open the release notes file prior to the &quot;FinshPage&quot; function for my custom dialog it is displayed.  If I make the &quot;Execshell&quot; call after the following two lines in my &quot;FinishPage&quot; function<br />
<br />
!insertmacro MUI_HEADER_TEXT &quot;Installation complete Page&quot; <br />
                             &quot;Please Select items you wish to run  <br />
                              after installation is complete&quot;<br />
<br />
!insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;FinishDialog.ini&quot;<br />
<br />
it doesn't work.  As if access to the relase notes file is restricted after this final dialog is displayed.  If I make the call to &quot;Execshell&quot; before these two lines it does work.<br />
<br />
On a hunch I tried switching the &quot;FinishDialog&quot; so it appears as my second last dialog in the installer.  This works as well.  I can access my release notes file everytime by running &quot;ExecShell&quot;.<br />
<br />
There appears to be some problem after the installer displays my last dialog.  At this point the plugins directory doesn't seem to be accessible.  At what point does the plugins directory get deleted?  Is it after .onInstSuccess?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">16th April 2003, 05:49</div></div><div class="posttext">It is deleted after .onInstSuccess.<br />
At least that's how it appears in the source code.<br />
Question- why are you putting your release notes in the plugins directory instead of in the installation directory. Isn't the latter the logical location?<br />
It's possible that its a timing issue, i.e., the time it takes for the installer to exit is faster than the time it takes for notepad to pop up with the text file.<br />
Try putting in a sleep for a couple of seconds and see what that does.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">16th April 2003, 13:42</div></div><div class="posttext">So you are calling it when your installers quits? In that case, I think the installer is faster than the text editor :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th April 2003, 13:44</div></div><div class="posttext">You are right iceman_k, $PLUGINSDIR is deleted when the installer exits, and like Joost said the installer is faster than your text editor. Sleep won't help much here, you can never know how long it'll take the text editor to start up. The best way would be copying the file to a place where it won't get deleted.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">16th April 2003, 13:47</div></div><div class="posttext">I think the Release Notes are also useful for the user at a later time. So why not put 'em in your installation folder?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">16th April 2003, 18:07</div></div><div class="posttext">Thanks for the the suggestions everyone.  <br />
<br />
I did extract the file to a different location so there wouldn't be any trouble with it getting deleted from the plugins directory.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>