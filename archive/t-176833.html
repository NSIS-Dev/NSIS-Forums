<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS screensaver install, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS screensaver install NSIS Discussion" />
	
	<title> NSIS screensaver install [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS screensaver install</div>
<hr />
<div class="pda"><a href="t-176833.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=176833">NSIS screensaver install</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Spaz007</div><div class="date">16th April 2004, 07:21</div></div><div class="posttext">I'm building a screensaver for a project for my software engineering course and I want to put it in an installer. Here is the problem. After the installer copies everything over to the SYS32 dir it doesn't run correctly. It will run right only after I right click on the .SCR file and click on install. Then it runs great without any problems. Is there a way to make the NSIS installer call that install function?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">magoo2002de</div><div class="date">16th April 2004, 11:20</div></div><div class="posttext">Hello Spaz007!<br />
I look at my Registry. So I think you have to call the rundll32.exe like:<br />
rundll32.exe desk.cpl,InstallScreenSaver FullPathAndFilenameOfYourScreensaver<br />
NOT TESTED!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Spaz007</div><div class="date">16th April 2004, 19:11</div></div><div class="posttext">It didn't work but your help has given me a couple ideas on maybe how to do it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goofee691</div><div class="date">11th October 2004, 18:52</div></div><div class="posttext">ok i have recently made a install for a screensaver first what version of windows are u useing cuz you may want to use $sysdir rather than useing system32<br />
<br />
secondly run the screensaver at the end of the installer im not sure if this is required but i did it so more settings could be made im not sure how i did it but i will post the script in maybe 3 days just have to find it</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">12th October 2004, 08:42</div></div><div class="posttext">There are another modern tricks, but this works too (from Win95 to 2000 and XP)<br />
<br />
  SetOutPath $SYSDIR<br />
  File &quot;${NAME_OF_YOUR}.scr&quot;<br />
<br />
; Set screensaver and make it active, DOS (short) name may require<br />
<br />
WriteINIStr &quot;$WINDIR\system.ini&quot; &quot;boot&quot; &quot;SCRNSAVE.EXE&quot; &quot;$SYSDIR\DOS_NAME_OF_YOUR.SCR&quot;<br />
  System::Call 'user32.dll::SystemParametersInfo (17, 1, 0, 2)'</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>