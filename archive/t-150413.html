<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstall if Installed, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstall if Installed NSIS Discussion" />
	
	<title> Uninstall if Installed [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstall if Installed</div>
<hr />
<div class="pda"><a href="t-150413.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=150413">Uninstall if Installed</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">25th September 2003, 21:18</div></div><div class="posttext">I'm guessing this is a typical question, but I was unable to find it posted.  I want to make my installer uninstall the previous installation if, indeed, it does exist.  Is this an automatic thing, or do I need to manually add this to the script?  If manual, what do I use to check it's existance.  It seems to uninstall, I would just:<br />
<br />
  Delete &quot;$INSTDIR\Uninst.exe&quot;<br />
  DeleteRegKey HKEY_LOCAL_MACHINE &quot;SOFTWARE\AppName&quot;<br />
  DeleteRegKey HKEY_LOCAL_MACHINE &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\AppName&quot;<br />
  RMDir &quot;$INSTDIR&quot;<br />
<br />
thanks again...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">25th September 2003, 21:50</div></div><div class="posttext">See the archive function &quot;Auto-uninstall old before installing new (http://nsis.sourceforge.net/archive/viewpage.php?pageid=326)&quot;. It will help you much.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">26th September 2003, 21:23</div></div><div class="posttext">Thanks Deguix!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">26th September 2003, 23:09</div></div><div class="posttext">OK, well I tried that and got some sort of uninstall initiation error (or somthing of the sort).  So I found the following code and tried it:<br />
<br />
Function .onInit <br />
check: <br />
ReadRegStr $1 HKLM \<br />
&quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PROGRAM_NAME}&quot; \<br />
&quot;UninstallString&quot; <br />
StrCmp $1 &quot;&quot; done cont<br />
<br />
cont:<br />
HideWindow <br />
MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION &quot;${PROGRAM_NAME} \<br />
is already installed.$\n$\r$\n$\r \ <br />
Click 'OK' to remove the previous version or 'Cancel' to abandon \<br />
this upgrade.&quot; IDOK uninst <br />
Abort <br />
uninst: <br />
ClearErrors <br />
Exec '$1' <br />
; IfErrors cont <br />
uninst_wait: <br />
Sleep 500 <br />
FindWindow $0 &quot;&quot; &quot;${PROGRAM_NAME} Uninstall &quot; <br />
IsWindow $0 uninst_wait &quot;&quot; <br />
uninst_finish: <br />
Sleep 500 <br />
FindWindow $0 &quot;&quot; &quot;${PROGRAM_NAME} Uninstall: Completed&quot; <br />
; StrCmp $0 &quot;&quot; show_error <br />
IsWindow $0 uninst_finish &quot;&quot; <br />
done: <br />
BringToFront <br />
FunctionEnd <br />
<br />
This &quot;kind of&quot; worked, but not really.  The first window comes up asking if I want to uninstall, and I click OK.  After clicking OK, the second window comes up, but doesn't wait for me to say uninstall, but rather the install window comes up.  I can pull the uninstall window from the task bar, but that's not too intuitive.  Anything I can do to make this better?  Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">27th September 2003, 23:56</div></div><div class="posttext">I do not recommend you to use that code, it isn't really a good method.<br />
<br />
Use the code in the archive page and make sure your code is correct. You should also check http://nsis.sourceforge.net/site/index.php?id=19&amp;backPID=15&amp;tx_faq_faq=14</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ursus76</div><div class="date">31st January 2004, 01:48</div></div><div class="posttext">Use the code in the archive page and make sure your code is correct. You should also check http://nsis.sourceforge.net/site/index.php?id=19&amp;backPID=15&amp;tx_faq_faq=14  <br />
<br />
If I use the faq's script(ExecWait '&quot;$INSTDIR\uninstall.exe&quot; _?=$INSTDIR') , then my application's folder can't be totally cleaned up.<br />
<br />
If I use this (ExecWait ExecWait '&quot;$INSTDIR\uninst.exe&quot;'), then the uninstaller won't wait for the installer as faq says.<br />
<br />
Also, if the user deletes the uninstaller.exe, then none of above will happen.<br />
<br />
Any suggestion for this?<br />
<br />
Thanks a lot!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">31st January 2004, 11:39</div></div><div class="posttext">Why would it not clean up the install dir?<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">31st January 2004, 13:25</div></div><div class="posttext">You should clean up the uninstaller and the application folder after running the uninstaller.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st January 2004, 13:46</div></div><div class="posttext">Or simply copy the uninstaller to the temporary directory yourself and execute it with the same command line arguments.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>