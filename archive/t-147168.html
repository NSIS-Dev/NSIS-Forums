<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Custom Page after abort ?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Custom Page after abort ? NSIS Discussion" />
	
	<title> Custom Page after abort ? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Custom Page after abort ?</div>
<hr />
<div class="pda"><a href="t-147168.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=147168">Custom Page after abort ?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">IceCork</div><div class="date">26th August 2003, 22:52</div></div><div class="posttext">Could someone please tell me if it's posible (if so how ?) to call a custom page after an abort message box. I'd like to have a page that basically says Setup aborted, nothing was installed and no changes were made to the system. While the below code appears to work I'm fairly certain that it is not the correct way to go about it.<br />
<br />
Function .onUserAbort<br />
<br />
MessageBox MB_YESNO &quot;The program is not completely installed on your computer.$\r$\nDo you want to abort setup ?&quot; IDYES NoCancelAbort<br />
 Abort<br />
 NoCancelAbort:<br />
!insertmacro MUI_HEADER_TEXT &quot;Setup Aborted&quot; &quot; &quot;<br />
!insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;abort.ini&quot;<br />
Pop $R0<br />
GetDlgItem $R1 $R0 1200<br />
CreateFont $R2 &quot;MS Sans Serif&quot; 8 700 <br />
!insertmacro MUI_INSTALLOPTIONS_SHOW<br />
Quit<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th August 2003, 00:26</div></div><div class="posttext">That is the only way.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">27th August 2003, 00:41</div></div><div class="posttext">Give me more details, when you click YES in that MessageBox, what occurs?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">IceCork</div><div class="date">27th August 2003, 06:01</div></div><div class="posttext">After pressing Yes the custom page is displayed, however after pressing the OK button (to exit the custom page)an error message box quickly appears saying something about a corrupted installer. I don't know what the error box says exactly because it closes too quickly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th August 2003, 17:09</div></div><div class="posttext">This is probably because the abort flag is set after the user clicks the cancel button.<br />
<br />
Therefore you can't use this at all, unless someone adds code to allow for this.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th August 2003, 17:15</div></div><div class="posttext">InstallOptions can not be called outside of a page creator function. Afrow, you should know that already ;)<br />
<br />
The best way I can think of right would be not to use Abort, skip the rest of the installation and change the finish page to show the desired message.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th August 2003, 17:20</div></div><div class="posttext">bah :)<br />
<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">27th August 2003, 21:34</div></div><div class="posttext">And if you remove the Quit command of the code, what occurs?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th August 2003, 21:36</div></div><div class="posttext">Doesn't matter. InstallOptions should not be used outside of a page's creator function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">IceCork</div><div class="date">28th August 2003, 01:32</div></div><div class="posttext">Thanks for the help. Kichik I'm not sure if I understand what you've suggested. If I change the Finish page won't that page (with the abort messages) be shown at the succesfull completion of the install as well ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th August 2003, 10:45</div></div><div class="posttext">No, you only change it if the installation was aborted.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>