<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" nsPerl, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  nsPerl NSIS Discussion" />
	
	<title> nsPerl [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  nsPerl</div>
<hr />
<div class="pda"><a href="t-292781.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=292781">nsPerl</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ElDodgero</div><div class="date">5th June 2008, 22:34</div></div><div class="posttext">Just wanted to note: certain parts of nsPerl do *not* work as advertised.<br />
<br />
Mainly the NS_getvar and NS_setvar functions exported to perl. They're there, they're exported to it, but they don't work when called from a script file (they work when called using an inline perl function, though)<br />
<br />
I have managed to get around the issue in a horrible, ugly, kludgy way, like so:<br />
<br />
1) in the NSI script, open a file, say for instance, $TEMP\vars.pl<br />
2) write to the file like so: &quot;$$FOO = '$FOO';$\n1;$\n&quot;<br />
3) close the file<br />
4) call the script, which has been written specifically to require this file, at which point it's read these variables in by way of  the require file.<br />
<br />
You could alter the approach but it remains kludgy. For instance, you could just write variable to a file separated by a character the strings don't use and open, read and parse it in Perl. You could theoretically call the perlscript with a system call from an exec line to rundll32 on perl58.dll, and pass in the variables as arguments to the script. ut that's nightmarishly confuzzling. Theoretically, you could even write these data into the registry, and use the Perl Win32::Registry module to read them back out. I'd suggest writing them to the environment, but I'm not sure the perlscript would have the same environment as the installer exe and I haven't tested it.<br />
<br />
Needless to say, however you do it, if you plan to use nsPerl, which is a great idea but a little bit broken, keep this in mind.<br />
<br />
For the record, while I was able to get the 'ok' or 'error' string back from a perl script exec call as documented, the second return value was NOT, as advertised, the last value instanced in perl if ok or the error message if error. Instead, it was just 1. All the time. Nothing but 1. So don't count on that either. Validate that your script ran worked correctly some other way. It's tough to test this stuff without proper IPC, but it *can* be done. Slowly.<br />
<br />
Anyway, when I am done I will have something very cool indeed: effectively, a sort of 3d model patch program (for Alias Wavefront OBJects) built into an installer, allowing derived meshes to be distributed without any of the original, preserving the distributor from both packaging headaches AND copyright messes!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>