<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Check filedate, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Check filedate NSIS Discussion" />
	
	<title> Check filedate [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Check filedate</div>
<hr />
<div class="pda"><a href="t-244731.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=244731">Check filedate</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">RitchieRich</div><div class="date">27th April 2006, 08:08</div></div><div class="posttext">Hey people,<br />
<br />
I want to make an 'installer' for an database (access ADP)<br />
I want the installer to check the date from the current ADP on the clients computer..<br />
If this date is older than the date from the file in my 'update' directory (on the network) , I want the installer to copy it to the clients computer, else.. just start access with the given database..<br />
Any sugegstions how to check?<br />
<br />
Thanks<br />
<br />
Richard</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">27th April 2006, 08:27</div></div><div class="posttext">Do you want to extract the new file from the installer to the client or just copy it from one net location to another?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RitchieRich</div><div class="date">27th April 2006, 09:40</div></div><div class="posttext">Hey Red Wine,<br />
<br />
Thanks for ur reply.<br />
<br />
From one location to another..<br />
What I was thinking; one option is to read a value (version or something) from a INI file in my 'update' directory and compare it to the INI file on the clients PC...<br />
If it matches.. the installer does 'not run' and if it does not match the installer copy's the ADP file from my network directory to the clients PC..<br />
Perhaps anyone have a sample script how to perform this??<br />
<br />
thanks<br />
<br />
Richard</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">27th April 2006, 09:58</div></div><div class="posttext">Hmm, while we're talking here for a db file, is it possible users update the db constantly? they'll loose their records if you're goin to update the file based on an ini string that you added once you've first installed that file. If the db is for read access only, then your thinking about ini should work unless the client for some reason had remove the ini. If you have access to registry will be better. Read the NSIS documentation on how you would manage the readini/writeini and readreg/writereg instructions.<br />
regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RitchieRich</div><div class="date">27th April 2006, 10:02</div></div><div class="posttext">Hey Red Wine,<br />
<br />
The access db is a frontend only.. the data is stored on a SQL Server...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">27th April 2006, 10:12</div></div><div class="posttext">So if you have access to client's registry I'd suggest a reg record check / compare /update.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RitchieRich</div><div class="date">27th April 2006, 10:14</div></div><div class="posttext">Ok.. I have the following ;<br />
<br />
ReadINIStr $1 &quot;W:\DB Updates\Fieldservice.ini&quot; &quot;VERSIONCODE&quot; &quot;VERSION&quot;<br />
ReadINIStr $2 &quot;C:\Program Files\fieldservice\Fieldservice.ini&quot; &quot;VERSIONCODE&quot; &quot;VERSION&quot;<br />
<br />
How can I compare the 2 values.. ?<br />
If the values MATCH then the installer must quit silently and open a specific file (my database file) , if it DOES NOT MATCH, the installer needs to copy a file from one location to another...<br />
<br />
Thanks<br />
<br />
Richard</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">27th April 2006, 10:23</div></div><div class="posttext">suggestion: use always numeric values, then IntCmp &quot;value1&quot; &quot;value2&quot; and select your action according to the result. See documentation for IntCmp :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RitchieRich</div><div class="date">27th April 2006, 10:27</div></div><div class="posttext">Will do..<br />
thanks!!<br />
<br />
Rgds,<br />
Richard</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RitchieRich</div><div class="date">27th April 2006, 10:29</div></div><div class="posttext">btw: any suggestions for a 'silent' abort?<br />
So that the user wont have to click 'cancel' ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">27th April 2006, 10:36</div></div><div class="posttext">when you get as comparison result that there is not need for any further action just Quit :-)<br />
You can do the whole check .onInit and quit before gui comes up.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RitchieRich</div><div class="date">27th April 2006, 12:06</div></div><div class="posttext">Great tips!!<br />
Thanx.. got it up and running now :-)<br />
<br />
Richard</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">27th April 2006, 12:33</div></div><div class="posttext">now that you have figured the entire procedure allow me to say that for my opinion this solution is weak while everyone could edit or remove an ini even by accident. I think you sould try to transform the procedure in registry entries :-)<br />
regards</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>