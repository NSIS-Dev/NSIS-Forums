<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Frustrating problem with uninstaller, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Frustrating problem with uninstaller NSIS Discussion" />
	
	<title> Frustrating problem with uninstaller [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Frustrating problem with uninstaller</div>
<hr />
<div class="pda"><a href="t-253988.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=253988">Frustrating problem with uninstaller</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Baafen</div><div class="date">24th August 2006, 09:19</div></div><div class="posttext">Im trying to make so only the installed files gets uninstalled.CODE (http://nsis.sourceforge.net/Uninstall_only_installed_files) <br />
But something makes the uninstaller freeze then only one file is left. The uninstall.log.<br />
<br />
Here (http://img247.imageshack.us/img247/779/uninstallerproblemqo2.jpg)  is a image that shows were the uninstallers stops/freeze.<br />
Its show that its trying to remove fgd/counter-strike but that  folder is removed. The only file left is uninstall.log.<br />
<br />
And here (http://img247.imageshack.us/img247/9068/notuninstalledmw6.jpg)  are a image of the only file left. (in the red circle). Files with a balck line over are not going to be uninstalled.<br />
I took this screen after I had stoped the uninstaller by CTRL+ALT+DEL.<br />
<br />
I have two ideas why it doesent work but I dont know how to solve it.<br />
<br />
1. The uninstall.log is in use by the uninstaller so it cant delete it<br />
<br />
2. The code for the uninstaller just loop and loop and never stops.<br />
<br />
And I dont think it has something to do with that the uninstaller copy its self to temp. And the installdir sems  to be right.<br />
<br />
So what can be wrong with the code?<br />
<br />
I have attached the nsi so you can take a look at it.<br />
<br />
// Sorry for my bad english</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">25th August 2006, 05:04</div></div><div class="posttext">Just looking at your code, I think you are getting into an endless loop at the very end just before you delete the log file.<br />
<br />
Just swap the last 2 lines so that this:<br />
StrCmp $R1 0 LoopDone<br />
IntOp $R1 $R1 - 1<br />
becomes this:IntOp $R1 $R1 - 1<br />
StrCmp $R1 0 LoopDone.<br />
<br />
The original problem happens when $R1 gets assinged a value of zero and then starts the loop again.  When $R1 is zero, $R2 will never be able to equal $R1 and therefore you get into an endless loop.  By checking the value of $R1 AFTER you change it's value, you can exit the loop at the proper time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Baafen</div><div class="date">25th August 2006, 08:20</div></div><div class="posttext">Thanks but just before I was going to bed I got it to work.<br />
So the problem is solved :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>