<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" IF-condition gives back error  macro &quot;_If&quot; requires 4 parameter(s), passed 3!, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  IF-condition gives back error  macro &quot;_If&quot; requires 4 parameter(s), passed 3! NSIS Discussion" />
	
	<title> IF-condition gives back error  macro &quot;_If&quot; requires 4 parameter(s), passed 3! [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  IF-condition gives back error  macro &quot;_If&quot; requires 4 parameter(s), passed 3!</div>
<hr />
<div class="pda"><a href="t-361280.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=361280">IF-condition gives back error  macro &quot;_If&quot; requires 4 parameter(s), passed 3!</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Dendro</div><div class="date">13th May 2013, 18:16</div></div><div class="posttext">Hi all,<br />
<br />
I try to compile an NSIS script for a software I'd like to deploy. It is an addition to an allready installed software, so I want to determine the installation path via registry. The information is stored in different places for x64 and x86 machines, so I need to use an If clause.<br />
<br />
I was googleing around for several hours and didn't find a working solution. Also I couldn't find a solution on the forums (even by using the suggestions mentioned in the &quot;How to find the answer (READ ME FIRST)&quot;-Thread ;)). But I am sure that you can help me :)<br />
<br />
I found several ways to check if the system is x64 when looking for a solution, like using winver.nsh or many other possibilities.<br />
<br />
Here i'd like to show you my initial script which I guess will work as well as winver.nsh. I guess I did something wrong concerning the IF condition:<br />
<br />
<br />
<br />
Function .onInit<br />
  ClearErrors<br />
  !include 'LogicLib.nsh'<br />
  ; Check if x64 via determining if wow6432node key exists<br />
  EnumRegKey $0 HKLM &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node&quot; 0<br />
  ${If} 0 keyexist<br />
	InstallDirRegKey HKLM &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\BLA&quot; &quot;InstallPath&quot;<br />
  ${Else}<br />
    InstallDirRegKey HKLM &quot;HKEY_LOCAL_MACHINE\SOFTWARE\BLA&quot; &quot;InstallPath&quot;<br />
  ${EndIf}<br />
FunctionEnd<br />
<br />
<br />
So far so good.<br />
When trying to compile I get this error:<br />
<br />
Function: &quot;.onInit&quot;<br />
ClearErrors<br />
EnumRegKey $0 HKLM\HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\(default)<br />
!insertmacro: _If<br />
!insertmacro: macro &quot;_If&quot; requires 4 parameter(s), passed 3!<br />
Error in script &quot;E:\Fischi\Downloads\WORKDIR\trp_101_with_REG_nsis_DH_mui.nsi&quot; on line 25 -- aborting creation process<br />
<br />
<br />
Please please tell me what I am doing wrong!<br />
<br />
Thanks in advance,<br />
Dendro.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th May 2013, 20:07</div></div><div class="posttext">Your If usage is incorrect. Look at LogicLib.nsh for usage.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Dendro</div><div class="date">14th May 2013, 09:43</div></div><div class="posttext">Hello Stu,<br />
<br />
Thank you for your reply. I had a look at logiclib.nsh and was surprised that these are just textfiles that you can read with any text editor. <br />
<br />
I read through the file and found some hints on the page that was linked within logiclib.nsh.<br />
<br />
So I tried the following but got the same error again:<br />
<br />
<br />
${If} ${keyexist}==0<br />
<br />
<br />
<br />
${If} &quot;${keyexist}&quot;==0<br />
<br />
<br />
<br />
${If} &quot;${keyexist}&quot;==$0<br />
<br />
<br />
Could you help me more precise since I couldn't find any kind of &quot;real&quot; documentation in logiclib.nsh but just some abstract definitions of the statements?<br />
<br />
Thanks once more,<br />
Dendro</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">14th May 2013, 09:53</div></div><div class="posttext">Add some spaces to operator:<br />
<br />
${If} $0 == &quot;some key name&quot;<br />
<br />
If there is no other key in registry the $0 will be filled with empty string:<br />
<br />
${If} $0 == &quot;&quot;<br />
<br />
and the error flag is set.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Dendro</div><div class="date">14th May 2013, 10:25</div></div><div class="posttext">Hi Slappy,<br />
<br />
This works for me, thanks. But now it tells me that I can't use InstallDirRegKey inside a function. So I will have to figure out another solution, but that's ok. There should be other possibilities.<br />
<br />
Thank you two for your help!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th May 2013, 11:30</div></div><div class="posttext">Use ReadRegStr $INSTDIR ... instead of InstallDirRegKey.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>