<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" String manipulation outside of sections or functions ?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  String manipulation outside of sections or functions ? NSIS Discussion" />
	
	<title> String manipulation outside of sections or functions ? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  String manipulation outside of sections or functions ?</div>
<hr />
<div class="pda"><a href="t-274102.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=274102">String manipulation outside of sections or functions ?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Rudif</div><div class="date">9th July 2007, 13:01</div></div><div class="posttext">Working with NSIS 2.21, I am trying to inject the FileVersion into the generated installer. <br />
<br />
If I add code like this<br />
<br />
&lt;code&gt;<br />
    !ifndef CHANGELIST<br />
    !define CHANGELIST 0   ; expect string like 98765<br />
    !endif<br />
<br />
    !ifndef FILEVERSIONDOT<br />
    !define FILEVERSIONDOT 0.0.0.0   ; expect string like 9.87.65<br />
    !endif<br />
<br />
    !ifndef FILEVERSIONCOMMA<br />
    !define FILEVERSIONCOMMA 0,0,0,0  ; expect string like 9,87,65<br />
    !endif<br />
<br />
    VIProductVersion &quot;${FILEVERSIONDOT}&quot;<br />
    VIAddVersionKey /LANG=${LANG_ENGLISH} &quot;ProductName&quot; &quot;MauiInstallExamples${PLT}&quot;<br />
    VIAddVersionKey /LANG=${LANG_ENGLISH} &quot;Comments&quot; &quot;CHANGELIST ${CHANGELIST}&quot;<br />
    VIAddVersionKey /LANG=${LANG_ENGLISH} &quot;CompanyName&quot; &quot;LeCroy Corp&quot;<br />
    VIAddVersionKey /LANG=${LANG_ENGLISH} &quot;FileVersion&quot; &quot;${FILEVERSIONCOMMA}&quot;<br />
&lt;/code&gt;<br />
<br />
early on in my .nsi script, before any section or function,<br />
it does what I want, provided that I generate strings FILEVERSIONCOMMA and FILEVERSIONDOT from CHANGELIST number with some external program, and that I inject them into the .nsi script with &quot;/D&lt;string&gt;&quot; arguments to makensis.<br />
<br />
Questions : could I generate strings FILEVERSIONCOMMA and FILEVERSIONDOT in my .nsi script, and how?<br />
<br />
My understanding is that VIProductVersion and VIAddVersionKey can only be used outside sections and functions, and that commands like IntOp and StrCpy can not be used outside sections and functions.<br />
<br />
<br />
TIA<br />
Rudif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th July 2007, 16:07</div></div><div class="posttext">You could call the external with !system, let it create a header with the required definitions and !include that header in your script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Rudif</div><div class="date">23rd July 2007, 21:38</div></div><div class="posttext">Hi Red Wine<br />
<br />
Using !system looks like a slightly cleaner alternative than injecting /DFILEVERSIONCOMMA and /DFILEVERSIONDOT, although both should work.<br />
<br />
You seem to confirm implicitly that there is no way to generate strings FILEVERSIONCOMMA and FILEVERSIONDOT from CHANGELIST in the main .nsi script itself, at the time of building the installer. Is this correct ?<br />
<br />
Thanks<br />
Rudif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">23rd July 2007, 23:34</div></div><div class="posttext">http://nsis.sourceforge.net/Invoking_NSIS_run-time_commands_on_compile-time<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>