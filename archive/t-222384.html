<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Modifying my finish page., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Modifying my finish page. NSIS Discussion" />
	
	<title> Modifying my finish page. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Modifying my finish page.</div>
<hr />
<div class="pda"><a href="t-222384.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=222384">Modifying my finish page.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mgillespie</div><div class="date">24th July 2005, 20:02</div></div><div class="posttext">I need to modify my finish page.  I having some problems thou..<br />
<br />
at the start of my script, I define that I want to call a custom pre page, before showing the finish page.<br />
<br />
  !define MUI_WELCOMEFINISHPAGE_CUSTOMFUNCTION_INIT PreFinishPage    !insertmacro MUI_PAGE_FINISH<br />
<br />
I then have my PreFinishPage function to modify the iospecial.ini file to add my extras..<br />
<br />
Function PreFinishPage    StrCmp $INSTALL_SERVICE &quot;1&quot; +1 gotoend    !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Settings&quot; &quot;NumFields&quot; &quot;4&quot;    !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Type&quot;   &quot;CheckBox&quot;    !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Text&quot;   &quot;$(OpenConfigPage)&quot;    !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Left&quot;   &quot;120&quot;    !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Right&quot;  &quot;315&quot;    !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Top&quot;    &quot;125&quot;    !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Bottom&quot; &quot;135&quot;    !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;State&quot; &quot;1&quot;    !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 3&quot; &quot;Bottom&quot; &quot;135&quot;  gotoend:  FunctionEnd<br />
<br />
The problem is, the checkbox ONLY appears when I move the mouse over it (repaint problem), and it's background is ugly grey.  The repaint problem, I think, is because field 3 of the iospecial.ini is too big (bottom = 185), which I why I try to attempt to shorten it in my code.<br />
<br />
If I open the temp plugin folder during install.  I can see it's added my extra field, (field 4), but field 3 bottom is still the 185 value..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th July 2005, 00:43</div></div><div class="posttext">Maybe Modern UI is overwriting your value. Try searching Contrib\Modern UI\System.nsh for 185 and (temporarily) replace it.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">25th July 2005, 12:25</div></div><div class="posttext">Try to modify ini-file in PRE function (!define MUI_PAGE_CUSTOMFUNCTION_PRE PreFinishPage).<br />
From docs:<br />
MUI_WELCOMEFINISHPAGE_CUSTOMFUNCTION_INIT function<br />
<br />
This Init function is called before the InstallOptions INI file for the page is written, so you can use it to initialize any variables used in the page settings.<br />
I think this the reason of that data do not changed (135 is replaced on 185).<br />
And what for to add new fields? You can use MUI_FINISHPAGE_RUN checkbox.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mgillespie</div><div class="date">26th July 2005, 19:00</div></div><div class="posttext">Thanks, using MUI_PAGE_CUSTOMFUNCTION_PRE fixed the appearing item (redraw) problem.<br />
<br />
I just have the grey border problem to fix now....<br />
<br />
See attached screenshot.<br />
<br />
(PS I am adding more end page items, so I cannot just use the build in MUI_FINISHPAGE_RUN, I am getting it working for 1 to start with, adding the others later...)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th July 2005, 21:24</div></div><div class="posttext">Set its background using SetCtlColors in the show callback function of the page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tang</div><div class="date">4th August 2006, 09:45</div></div><div class="posttext">About :!define MUI_PAGE_CUSTOMFUNCTION_PRE PreSetIni<br />
i had DBPassword.ini file modified in my preSetIni function  but it doesen't work ,Why? And i also  do it as below:<br />
  Function .onInit    <br />
  InitPluginsDir<br />
  File /oname=$PLUGINSDIR\DBPassword.ini &quot;DBPassword.ini&quot;<br />
  File /oname=$PLUGINSDIR\location.ini &quot;location.ini&quot;<br />
FunctionEnd<br />
...<br />
pls help me! thx in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mayPol</div><div class="date">13th September 2006, 08:59</div></div><div class="posttext">Originally posted by mgillespie <br />
Thanks, using MUI_PAGE_CUSTOMFUNCTION_PRE fixed the appearing item (redraw) problem.<br />
 <br />
<br />
Hi,<br />
I have the appearing problem too even though I use the MUI_PAGE_CUSTOMFUNCTION_PRE. In my case I have a link, which defined as follow:<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE FinishPre<br />
!define MUI_FINISHPAGE_LINK &quot;&quot;<br />
!define MUI_FINISHPAGE_LINK_LOCATION &quot;&quot;<br />
<br />
Function FinishPre<br />
!insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;State&quot; &quot;http://www.google.com&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Text&quot; &quot;Click to Brows&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Left&quot; &quot;121&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Right&quot; &quot;316&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Top&quot; &quot;109&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Bottom&quot; &quot;120&quot;<br />
FunctionEnd<br />
<br />
When I look in the &quot;ioSpecial.ini&quot;, it is updated, so why the link cannot be seen?<br />
<br />
Thanks,<br />
May</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th September 2006, 10:36</div></div><div class="posttext">You must also set NumFields in [Settings].!insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Settings&quot; &quot;NumFields&quot; 4</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Theresias</div><div class="date">27th May 2007, 05:13</div></div><div class="posttext">Thanks for the &quot;tutorial&quot;, but I do have one question. At which point should I check the button/checkbox state (i.e. to start my 2nd program)? I was trying &quot;.onInstSuccess&quot;, but that seems to be too late...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th May 2007, 20:49</div></div><div class="posttext">Add a section at the end after all other sections with no name.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Theresias</div><div class="date">28th May 2007, 02:29</div></div><div class="posttext">Sorry, but that doesn't seem to do it. For testing purposes I was just popping up a message box and that did happen before the finishpage.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th May 2007, 12:23</div></div><div class="posttext">Oh I see, for the finish page.<br />
Use:<br />
!define MUI_PAGE_CUSTOMFUNCTION_LEAVE FinishPageLeave<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
Function FinishPageLeave<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;State&quot;<br />
  StrCmp $R0 0 +2<br />
    Exec ...<br />
FunctionEnd<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Theresias</div><div class="date">28th May 2007, 14:56</div></div><div class="posttext">Nice, that did it - thanks!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>