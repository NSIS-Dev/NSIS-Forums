<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Start Menu Icons only made if I rename the start menu folder. Why?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Start Menu Icons only made if I rename the start menu folder. Why? NSIS Discussion" />
	
	<title> Start Menu Icons only made if I rename the start menu folder. Why? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Start Menu Icons only made if I rename the start menu folder. Why?</div>
<hr />
<div class="pda"><a href="t-223846.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=223846">Start Menu Icons only made if I rename the start menu folder. Why?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jeff_hanna</div><div class="date">12th August 2005, 15:24</div></div><div class="posttext">If I use the &quot;Choose Start Menu Folder&quot; option page my start menu icons will never show up unless I specifically change the name of the start menu folder on that page. If I leave it at the installer provided default the start menu folder will be made but no shortcuts will be created within it.<br />
<br />
I've attached a sample .nsi file that shows the problem:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">12th August 2005, 15:27</div></div><div class="posttext">NSI is missing...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jeff_hanna</div><div class="date">12th August 2005, 15:27</div></div><div class="posttext">Here's the file. It didn't get attached to my original post for some reason.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th August 2005, 15:50</div></div><div class="posttext">Page defines go before inserting the MUI_PAGE macro's:<br />
<br />
!define MUI_STARTMENUPAGE_NODISABLE<br />
!define MUI_STARTMENUPAGE_DEFAULTFOLDER &quot;Test&quot;<br />
#!define MUI_STARTMENUPAGE_REGISTRY_ROOT &quot;${PRODUCT_UNINST_ROOT_KEY}&quot;<br />
#!define MUI_STARTMENUPAGE_REGISTRY_KEY &quot;${PRODUCT_UNINST_KEY}&quot;<br />
#!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME &quot;${PRODUCT_STARTMENU_REGVAL}&quot;<br />
!insertmacro MUI_PAGE_STARTMENU Application $STARTMENU_FOLDER<br />
<br />
<br />
The reason it's not working currently is because the default start menu folder is set to the Name of your installer which is:<br />
Name &quot;${PRODUCT_NAME} ${PRODUCT_VERSION}&quot;<br />
${PRODUCT_NAME} is &quot;Start Menu Test&quot; and ${PRODUCT_VERSION} is &quot;&quot;, therefore your name will be &quot;Start Menu Test &quot;.<br />
Now with that folder name in the path, it won't work because e.g.<br />
$SMPROGRAMS\Start Menu Test \shortcut.lnk is an invalid path (got that space in there before the \) hence why it is not working.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jeff_hanna</div><div class="date">12th August 2005, 16:38</div></div><div class="posttext">Excellent! Thanks, Stu.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jeff_hanna</div><div class="date">12th August 2005, 19:04</div></div><div class="posttext">I still get a space in the name if the one of the uninstall defines is uncommented.<br />
<br />
<br />
!define PRODUCT_NAME &quot;Start Menu Test&quot;<br />
!define PRODUCT_VERSION &quot;&quot;<br />
!define PRODUCT_PUBLISHER &quot;&quot;<br />
!define PRODUCT_WEB_SITE &quot;http://www.mythicentertainment.com/&quot;<br />
!define PRODUCT_UNINST_KEY &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}&quot;<br />
!define PRODUCT_UNINST_ROOT_KEY &quot;HKLM&quot;<br />
!define PRODUCT_STARTMENU_REGVAL &quot;NSIS:StartMenuDir&quot;<br />
<br />
; MUI 1.67 compatible ------<br />
!include &quot;MUI.nsh&quot;<br />
!include &quot;Sections.nsh&quot;<br />
<br />
; MUI Settings<br />
!define MUI_ABORTWARNING<br />
!define MUI_ICON &quot;${NSISDIR}\Contrib\Graphics\Icons\orange-install.ico&quot;<br />
!define MUI_WELCOMEFINISHPAGE_BITMAP &quot;${NSISDIR}\Contrib\Graphics\Wizard\orange.bmp&quot;<br />
!define MUI_HEADERIMAGE<br />
!define MUI_HEADERIMAGE_RIGHT<br />
!define MUI_HEADERIMAGE_BITMAP &quot;${NSISDIR}\Contrib\Graphics\Header\orange-r.bmp&quot;<br />
!define MUI_HEADERIMAGE_UNBITMAP &quot;${NSISDIR}\Contrib\Graphics\Header\orange-uninstall-r.bmp&quot;<br />
!define MUI_COMPONENTSPAGE_SMALLDESC<br />
<br />
!define MUI_STARTMENUPAGE_NODISABLE<br />
!define MUI_STARTMENUPAGE_DEFAULTFOLDER &quot;Start Menu Test&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_ROOT &quot;${PRODUCT_UNINST_ROOT_KEY}&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_KEY &quot;${PRODUCT_UNINST_KEY}&quot;<br />
#!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME &quot;${PRODUCT_STARTMENU_REGVAL}&quot;<br />
<br />
; Welcome page<br />
!insertmacro MUI_PAGE_WELCOME<br />
<br />
; Components page<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
<br />
; Start menu page<br />
var STARTMENU_FOLDER<br />
!insertmacro MUI_PAGE_STARTMENU Application $STARTMENU_FOLDER<br />
<br />
;etc...<br />
<br />
<br />
If I uncomment '#!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME &quot;${PRODUCT_STARTMENU_REGVAL}&quot;' I get a space at the end of the name. If I leave that define commented then the uninstaller doesn't remove the start menu folder.<br />
<br />
How do I get this to work and have an uninstaller for my app?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jeff_hanna</div><div class="date">12th August 2005, 19:39</div></div><div class="posttext">Never mind. Found it. I still had a &quot;${PRODUCT_VERSION}&quot; in the Post section WriteRegStr. The unistall code was reading that and putting that spurious space at the end of the directory name.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>