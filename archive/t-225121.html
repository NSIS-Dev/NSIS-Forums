<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Remembering Components using loops, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Remembering Components using loops NSIS Discussion" />
	
	<title> Remembering Components using loops [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Remembering Components using loops</div>
<hr />
<div class="pda"><a href="t-225121.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=225121">Remembering Components using loops</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">khookhy</div><div class="date">2nd September 2005, 23:21</div></div><div class="posttext">I have around 80 components in my installer and it wouldn't be very practical to store each section's flags in the registry manually especially since they are changed very frequently. So I was wondering if it's possible to store/retreive flags using a short loop that applies to all sections in general... I tried using<br />
GetDlgItem $0 $HWND_PARENT 120x (with x increasing upon each loop but no luck... and it wouldn't work for retreiving). I would appreciate any help offered. Thank you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">khookhy</div><div class="date">3rd September 2005, 00:51</div></div><div class="posttext">wops... now I see that I can't use GetDlgItem as stated above for the components page. That explains it. Ideas anyone ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">3rd September 2005, 00:57</div></div><div class="posttext">Is Function .onSelChange enough to get the components flags using SectionGetFlags? It requires the components checkmarks selection to change. I think it may be not what you are looking for. That's because you said &quot;short loops&quot; so maybe it's time related.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">khookhy</div><div class="date">3rd September 2005, 01:19</div></div><div class="posttext">ah good idea... but is there a way to get the id of the section that has been altered ? If so then I can use the following .onSelChange<br />
<br />
SectionGetFlags ${SECID} $R0<br />
WriteRegStr HKCU &quot;blablabla&quot; ${SECID} $R0<br />
<br />
Yet this doesn't solve the problem of loading the remembered flags .onInit</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">3rd September 2005, 01:35</div></div><div class="posttext">You need to use a variable or an array to store the previous flags of all component items. Then, you can compare them all later to see which was or not changed.<br />
There is a plug-in called &quot;NSIS Array&quot; that store array items. You can download it from here (http://nsis.sourceforge.net/wiki/File:NSISArray.zip).<br />
<br />
To change the selection of a component item (section or section group), you can use &quot;SectionSetFlags&quot; instruction. For the initialization of the flags to the implemented correctly, you should use the &quot;PreFunction&quot; of the &quot;components&quot; page. I'm not sure if that instruction works when used with the function &quot;.onInit&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">khookhy</div><div class="date">3rd September 2005, 01:48</div></div><div class="posttext">I'm not familiar with the NSISArray plugin and I read it can store a maximum limit of using 8 arrays at any one time... I would rather try something else (if available)<br />
<br />
I am aware that I need to use SectionSetFlags in the PreComponents function, yet I don't want to have to manually add it for each section because sections change much too often.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">3rd September 2005, 02:21</div></div><div class="posttext">No, you just need 1 array. You can store there up to 128 items in there (if you choose to use the line: !define ArrayPlugin 128), and this is more than enough for you. Then you could make a loop to process all the items inside and, at the same time, compare with the results of SectionGetFlags.<br />
<br />
I'm not familiar with NSIS Array either, so we're tied :(...<br />
<br />
I am aware that I need to use SectionSetFlags in the PreComponents function, yet I don't want to have to manually add it for each section because sections change much too often.That's why I told you the solution above, you don't need to use an instruction for every single section. Just make a loop incrementing the section index.<br />
<br />
EDIT:<br />
<br />
If you don't like the plug-in, there are alternatives:<br />
- &quot;Array&quot; header example for UseFunc (look at my signature) which is a little slower than using a plug-in directly, but can support an unlimited amount of items until the variable gets to the NSIS string length maximum (1024, or 8192 with special builds). Uses Math plug-in.<br />
- Afrow UK's &quot;Array&quot; header using INI files (here (http://nsis.sourceforge.net/wiki/File:Array.zip)). This is very slow, but can have an unlimited number of items. So unlimited, the only limitation is the hard drive free space.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">khookhy</div><div class="date">3rd September 2005, 02:29</div></div><div class="posttext">I see, cheers for that :) I'm gonna check out the NSISArray examples and give it a go, however, if anyone can supply the proper code for this then please do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">khookhy</div><div class="date">3rd September 2005, 14:55</div></div><div class="posttext">I can't seem to get this... am I supposed to be storing the section names in the array or their flags ? :S</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">3rd September 2005, 17:13</div></div><div class="posttext">Well, you need to store the flags of every section because you need to compare them later so to discover which section changed...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">khookhy</div><div class="date">3rd September 2005, 21:45</div></div><div class="posttext">Sorry for asking a bit too much, but won't arrays be cleared the next time the installer is executed ? Either way, I tried using your UseFunc header and got confused at what code to use .onSelChange... Sorry I'm a n00b :/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">khookhy</div><div class="date">5th September 2005, 00:27</div></div><div class="posttext">After further trails, I found out it can't be done how you said. To compare the flags of the altered section .onSelChange you need to know which section has been altered .onSelChange and that I wasn't able to achieve unless I add each section's flags to the array and that isn't what I'm after. Perhaps I'm way off, but if you think it can be done please tell me how. Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">5th September 2005, 04:52</div></div><div class="posttext">Sorry, you wanted to store the flags in the registry. WriteRegDWORD and ReadRegDWORD are used for writing to and reading from registry, respectively, with numbers. Just treat the items in the registry like in an array: value names should be consecutive or it will be difficult to make a loop.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NHOCSUNG</div><div class="date">19th September 2005, 21:14</div></div><div class="posttext">hi everybody i'm been doing this header for very long time, this is modification of LogicLib, it sound it like &quot;Give Me Section Flags I modify for you&quot;... something like that, my Eng no good so i can't talk much, i needed more suggests form you guys...<br />
<br />
example:<br />
  ${IfSection} 1 &quot;1,0,17,1&quot;<br />
    Delete &quot;Program_1.exe<br />
  ${EndIfSection}<br />
<br />
  Strcpy $R0 &quot;1,0,17,1&quot;  ;Section Old Flags<br />
  Strcpy $R1 &quot;0,1,17,1&quot;  ;Section New or Current Flags<br />
  ;$0 -&gt; $4 being used<br />
<br />
  ${IfSection} ${FlagIsSelected} 2 $R0<br />
    Delete &quot;temp.tmp&quot;<br />
    ${UnlessSection} ${FlagIsSelected} 2 $R1<br />
      Delete &quot;Program_2.exe&quot;<br />
    ${EndUnlessSection}<br />
  ${EndIfSection}<br />
<br />
same with exam above<br />
<br />
  ${Section} 2 $R0 $R1<br />
    ${Repair}<br />
      Delete &quot;temp.tmp&quot;<br />
    ${Remove}<br />
      Delete &quot;Program_2.exe&quot;<br />
  ${SectionEnd}<br />
<br />
Can you give me example using Array to get Flags.<br />
If you can't don't worry i firgure that out</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">19th September 2005, 21:31</div></div><div class="posttext">I don't have an opinion, but you should put contributions also in the NSIS Wiki, or your contrib might be lost here in the forums, along with other contrib...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">20th September 2005, 07:25</div></div><div class="posttext">RememberComponents (http://nsis.sourceforge.net/wiki/RememberComponents) -script for remembering installed and uninstalled components.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NHOCSUNG</div><div class="date">20th September 2005, 17:43</div></div><div class="posttext">I know how to get Sections Flag, what i need to know is how store section flag into Array's variable...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th September 2005, 18:15</div></div><div class="posttext">http://nsis.sourceforge.net/wiki/Arrays_in_NSIS<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NHOCSUNG</div><div class="date">21st September 2005, 16:46</div></div><div class="posttext">thanks Afrow UK</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>