<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstaller Help, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstaller Help NSIS Discussion" />
	
	<title> Uninstaller Help [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstaller Help</div>
<hr />
<div class="pda"><a href="t-273620.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=273620">Uninstaller Help</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">inbox4sumit</div><div class="date">29th June 2007, 20:13</div></div><div class="posttext">Hello<br />
<br />
Inside .onInit function, I check if a previous version exists. If it does then I call the uninstaller using ExecWait. Something like below:<br />
<br />
MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />
&quot;${PRODUCT_NAME} is already installed. $\n$\nClick `OK` to<br />
remove this version or `Cancel` to abort.&quot;\<br />
ID_OK uninst<br />
Abort<br />
<br />
uninst:<br />
   ExecWait '&quot;$INSTDIR\Uninstall.exe&quot; _?=$INSTDIR'<br />
<br />
; Continue with Installation Steps<br />
      :<br />
      :<br />
<br />
<br />
The problem is that since I'm NOT running the ExecWait in silent-mode and the user can press &quot;Cancel&quot; instead of &quot;Uninstall&quot;, when the uninstall confirm page (MUI_UNPAGE_CONFIRM) shows up. The uninstaller will exit and I'll still move onto my installation steps. How do I catch &quot;Cancel&quot; so that I can abort the installation?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th June 2007, 20:16</div></div><div class="posttext">Pass a variable to ExecWait and it'll return the error level of the uninstaller. If it's not zero, the uninstaller failed. ExecWait '&quot;$INSTDIR\Uninstall.exe&quot; _?=$INSTDIR' $0For more on error levels, see the documentation.<br />
<br />
http://nsis.sourceforge.net/Docs/AppendixD.html#D.1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">inbox4sumit</div><div class="date">29th June 2007, 20:17</div></div><div class="posttext">I did that, but I don't get anything back. Do I have to have some code in my uninstaller to send return code?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th June 2007, 20:19</div></div><div class="posttext">No. If the return code is zero, the user didn't hit the Cancel button. As the linked documentation says, it'll return 1 if the user hit the Cancel button.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">inbox4sumit</div><div class="date">29th June 2007, 20:22</div></div><div class="posttext">Thanks for your help. Tried again. It worked this time. Must be doing soemthing wrong earlier when referencing the return value.<br />
<br />
Thanks</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>