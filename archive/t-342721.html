<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installer that use the regsvr32.exe to register a dll, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installer that use the regsvr32.exe to register a dll NSIS Discussion" />
	
	<title> Installer that use the regsvr32.exe to register a dll [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installer that use the regsvr32.exe to register a dll</div>
<hr />
<div class="pda"><a href="t-342721.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=342721">Installer that use the regsvr32.exe to register a dll</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">noemig</div><div class="date">29th February 2012, 04:11</div></div><div class="posttext">Hello,<br />
<br />
I am creating an nsi file to install some dlls but I need also to register them using regsvr32.exe<br />
<br />
How can I do this? <br />
<br />
Thanks<br />
<br />
noemig</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">29th February 2012, 07:10</div></div><div class="posttext">Try doing a google search for 'nsis regsvr32.exe' . If you had tried, you would've found your answer in a matter of seconds.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">29th February 2012, 10:22</div></div><div class="posttext">Or just use RegDll.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">noemig</div><div class="date">29th February 2012, 13:37</div></div><div class="posttext">Thank you Stu,<br />
<br />
I have found the answer already.<br />
<br />
Have a nice day.<br />
<br />
noemig</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anderci</div><div class="date">26th January 2013, 19:27</div></div><div class="posttext">I have created several VB6 Applications that I make available on my website as 'FreeWare'.<br />
I recently started using NSIS to create install packages.  I copy all of the support files into the $INSTDIR , that, for WinVistaAndBeyond, has its own subfolder in the folder structure: C:Users\Public\... This is to reduce the chance that my applications would have minimal effect on and be minimally effected by other applications on the PC.<br />
<br />
For each application I have been using RegDLL &quot;$INSTDIR\RICHTX32.OCX&quot; to register each .OCX file used by that application.  This seems to work fine when I have installed several of my applications, each in their own $INSTDIR.<br />
<br />
The problem arises when I uninstall any of the applications using UnRegDLL &quot;$INSTDIR\RICHTX32.OCX&quot; .  This causes all of the applications to have their own copies of the .OCX files to be UnRegistered.<br />
<br />
I have not noticed a difference running in a PowerUser Login or 'RunAsAdministrator'.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">27th January 2013, 00:14</div></div><div class="posttext">http://nsis.sourceforge.net/Docs/AppendixB.html#B.2<br />
allows you to install it shared but then it has to be in a shared location.<br />
<br />
Other options:<br />
A) Use reg free COM (XP+, not sure if it works in VB6)<br />
B) Fake reg free COM by calling the Co* functions from VB</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PoRtAbLe_StEaLtH</div><div class="date">27th January 2013, 08:06</div></div><div class="posttext">Or just use RegDll.<br />
<br />
Stu<br />
<br />
Just becareful under x64bit.<br />
<br />
ie. registering shell / unreg shell with RegDLL would leave behind trash in the registry, and leave libraries loaded.<br />
<br />
Using `regsvr32.exe` worked correctly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anderci</div><div class="date">4th February 2013, 16:40</div></div><div class="posttext">Thank you for your responses.  <br />
<br />
I have been trying to absorb them.  I am definitely using VB6 and so far the only error messages from a fresh install of my freeware applications refer to unregistered .OCX files.  <br />
<br />
My understanding of the terminology in AppendixB faltered with the mention of Libraries.  I do want my 'support files' to be NOTSHARED .  That is why I copy (File...) them into each application's $INSTDIR .  I am trying to continue with this approach to avoid application entanglements.  <br />
<br />
I do not know what reg free COM is.<br />
<br />
I started with regsvr32.exe and am happy to return to it.  On some forum I was warned away from it because some PCs may not support it.  I do not see a NOTSHARED option with it. e.g.:<br />
  ExecWait 'regsvr32.exe &quot;$INSTDIR\RICHTX32.OCX&quot; /S'<br />
<br />
Thank you for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">4th February 2013, 17:13</div></div><div class="posttext">regsvr32 will normally register the file globally (In HKLM) and a shared install is usually not possible.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anderci</div><div class="date">4th February 2013, 19:06</div></div><div class="posttext">Do you mean &quot;a shared install is usually not possible. &quot;  or<br />
&quot; a NOTshared install is usually not possible. &quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anderci</div><div class="date">4th February 2013, 19:29</div></div><div class="posttext">Is reg free COM also known as  'Visual Studio 6 Installer' ?  The website indicates that it, as of 4 July 2012, works with VB6 Pro.<br />
<br />
Is it a separate alternative to NSIS ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">5th February 2013, 07:30</div></div><div class="posttext">Reg free COM means you don't register the dll/ocx in the registry at all, you put the information in the .exe manifest</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anderci</div><div class="date">5th February 2013, 14:14</div></div><div class="posttext">Thank you for your response.  It is a relief not to have to go into 'Visual Studio 6 Installer'.<br />
<br />
I googled  .exe manifest Reg free COM vb6  and was somewhat overwhelmed. I may understand some of it.  I think the information in the QueryMgr.vbp file e.g.:<br />
<br />
Object={831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0; MSCOMCTL.OCX<br />
Object={38911DA0-E448-11D0-84A3-00DD01104159}#1.2#0; RICHTX32.OCX<br />
<br />
ExeName32=&quot;QueryMgr.exe&quot;<br />
<br />
MajorVer=2<br />
MinorVer=4<br />
RevisionVer=12<br />
<br />
must be copied into a QueryMgr.exe.manifest file in XML format to look like:<br />
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;yes&quot;?&gt;<br />
&lt;assembly manifestVersion=&quot;1.0&quot; xmlns=&quot;urn:schemas-microsoft-com:asm.v1&quot;&gt;<br />
  &lt;assemblyIdentity type=&quot;win32&quot; name=&quot;QueryMgr.exe&quot; version=&quot;2.4.12&quot; /&gt;<br />
  &lt;dependency&gt;<br />
    &lt;dependentAssembly&gt;<br />
      &lt;assemblyIdentity type=&quot;win32&quot; name=&quot;MSCOMCTL.OCX&quot; version=&quot;2.0&quot; /&gt;<br />
      &lt;assemblyIdentity type=&quot;win32&quot; name=&quot;RICHTX32.OCX&quot; version=&quot;1.2&quot; /&gt;<br />
    &lt;/dependentAssembly&gt;<br />
  &lt;/dependency&gt;<br />
&lt;/assembly&gt;<br />
<br />
And this XML file QueryMgr.exe.manifest incorporated in the NSIS installation into the $INSTDIR with the required support files (MSCOMCTL.OCX, ...)<br />
<br />
I saw mention of several tools to create the manifest file, but could not track them down with certainty.  The most significant maintenance task, once created, would be the executable application version.<br />
<br />
Your guidance is appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">5th February 2013, 17:06</div></div><div class="posttext">&quot;&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;QueryMgr.exe&quot; version=&quot;2.4.12&quot; /&gt;&quot; I bet the version here does not have to match anything...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anderci</div><div class="date">5th February 2013, 19:58</div></div><div class="posttext">My first try did not work:  <br />
E:\Program FiIes\Clark_Anderson\QueryMgr\QueryMgr.exe<br />
(X)   E:\Program Files\Clark_Anderson\QueryMgr\QueryMgr.exe<br />
      This application has failed to start because the application configuration is incorrect. Reinstalling the application may fix this problem.<br />
              [ OK ]<br />
Here is the content of my QueryMgr.exe.manifest file:<br />
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;yes&quot;?&gt;<br />
&lt;assembly manifestVersion=&quot;1.0&quot; xmlns=&quot;urn:schemas-microsoft-com:asm.v1&quot;&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;QueryMgr.exe&quot; version=&quot;2.04&quot; /&gt;<br />
&lt;dependency&gt;<br />
&lt;dependentAssembly&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;MSCOMCTL.OCX&quot; version=&quot;2.0&quot; /&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;MSCOMCT2.OCX&quot; version=&quot;2.0&quot; /&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;COMCT332.OCX&quot; version=&quot;1.1&quot; /&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;RICHTX32.OCX&quot; version=&quot;1.2&quot; /&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;COMDLG32.OCX&quot; version=&quot;1.2&quot; /&gt;<br />
&lt;/dependentAssembly&gt;<br />
&lt;/dependency&gt;<br />
&lt;/assembly&gt;<br />
<br />
I have tried to attach my Query_Manager.nsi file.<br />
Here is that section:<br />
Section &quot;System Files - WinSysDir&quot;<br />
  SectionIn 1 2<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  File &quot;C:\WINDOWS\system32\stdole2.tlb&quot;<br />
  File &quot;D:\Program Files\Microsoft Office\Office\MSACC9.OLB&quot;<br />
  File &quot;C:\Program Files\Common Files\Microsoft Shared\DAO\dao360.dll&quot;<br />
  File &quot;D:\Program Files\Microsoft Office\Office\EXCEL9.OLB&quot;<br />
  File &quot;d:\Program Files\Microsoft Visual Studio\VB98\VB6EXT.OLB&quot;<br />
  File &quot;C:\WINDOWS\system32\msstdfmt.dll&quot;<br />
  File &quot;C:\WINDOWS\system32\MSCOMCTL.OCX&quot;<br />
  File &quot;C:\WINDOWS\system32\MSCOMCT2.OCX&quot;<br />
  File &quot;C:\WINDOWS\system32\RICHTX32.OCX&quot;<br />
  File &quot;C:\WINDOWS\system32\COMDLG32.OCX&quot;<br />
  File &quot;D:\Program Files\InstallShield\InstallShield Express 2.12\redist\MSVCRT40.DLL&quot;<br />
  File &quot;D:\Program Files\InstallShield\InstallShield Express 2.12\redist\COMCAT.DLL&quot;<br />
  File &quot;D:\Program Files\InstallShield\InstallShield Express 2.12\redist\RICHED32.DLL&quot;<br />
  File &quot;D:\Devlpmnt\LANG\VB6\QueryMgr\QueryMgr.exe.manifest&quot;<br />
<br />
;  File &quot;C:\WINDOWS\system32\threed32.ocx&quot;<br />
;  ;Register RICHTX32.OCX<br />
;  ExecWait 'regsvr32.exe &quot;$INSTDIR\RICHTX32.OCX&quot; /S'<br />
;  ;Register COMDLG32.OCX<br />
;  ExecWait 'regsvr32.exe &quot;$INSTDIR\COMDLG32.OCX&quot; /S'<br />
<br />
SectionEnd<br />
<br />
<br />
I do not know where I have gone wrong.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">5th February 2013, 22:12</div></div><div class="posttext">There is a tool that will give you more information about manifest errors, &quot;sxstrace&quot; or something like that? I'm sure you can find it if you look on the MSDN blogs...<br />
<br />
Edit:<br />
http://blogs.msdn.com/b/junfeng/archive/2006/04/14/576314.aspx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anderci</div><div class="date">6th February 2013, 04:43</div></div><div class="posttext">SxStrace is not on my developement WinXP PC.  After reading over the link you provided, I modified the manifest file:<br />
<br />
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;yes&quot;?&gt;<br />
&lt;assembly manifestVersion=&quot;1.0&quot; xmlns=&quot;urn:schemas-microsoft-com:asm.v1&quot;&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;QueryMgr.exe&quot; version=&quot;2.04&quot; /&gt;<br />
&lt;dependency&gt;<br />
&lt;dependentAssembly&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;MSCOMCTL.OCX&quot; version=&quot;6.1.97.82&quot; /&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;MSCOMCT2.OCX&quot; version=&quot;6.1.97.82&quot; /&gt;<br />
&lt;!-- &lt;assemblyIdentity type=&quot;win32&quot; name=&quot;COMCT332.OCX&quot; version=&quot;1.1&quot; /&gt;  --&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;RICHTX32.OCX&quot; version=&quot;6.1.97.82&quot; /&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;COMDLG32.OCX&quot; version=&quot;6.1.97.82&quot; /&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;stdole2.tlb&quot; version=&quot;5.1.2600.5512&quot; /&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;MSACC9.OLB&quot; version=&quot;9.0.0.2719&quot; /&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;EXCEL9.OLB&quot; version=&quot;9.0.0.2719&quot; /&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;VB6EXT.OLB&quot; version=&quot;5.0.81.69&quot; /&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;Comcat.dll&quot; version=&quot;4.71.1441.1&quot; /&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;dao360.dll&quot; version=&quot;3.60.9512.0&quot; /&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;MSVCRT40.DLL&quot; version=&quot;4.10.0.6038&quot; /&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;Riched32.dll&quot; version=&quot;4.0.993.4&quot; /&gt;<br />
&lt;assemblyIdentity type=&quot;win32&quot; name=&quot;MSSTDFMT.DLL&quot; version=&quot;6.1.97.82&quot; /&gt;<br />
&lt;/dependentAssembly&gt;<br />
&lt;/dependency&gt;<br />
&lt;/assembly&gt;<br />
<br />
I listed all of the support files included in the install .nis file.  I also used the version numbers displayed by Windows Explorer file properties for each support file.<br />
<br />
After installing with the updated manifest on a borrowed WinVista laptop PC, I tried starting the program from its Desktop shortcut.  It failed (RICHTX32.OCX not registered).<br />
<br />
 1) I opened cmd window as Administrator and changed directory to $INSTDIR<br />
 2) I attempted to start sxstrace trace -logfile:sxstrace.etl (it displayed usage information?)<br />
 3) I ran querymgr from this command line: It worked! querymgr started up and ran<br />
 4) I attempted to parse: sxstrace parse -logfile:sxstrace.etl -outfile:sxstrace.txt (it, again, displayed usage information)<br />
 5) I successfully started querymgr from its desktop shortcut: Success!<br />
<br />
This behavior is puzzling.  The sxstrace program seemed not to be working.  Usually when a command line program displays usage information, it is because it failed to start.  I could find none of the 'log' files.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">6th February 2013, 06:55</div></div><div class="posttext">I think sxstrace works better on Vista+ but this is not really a NSIS issue, maybe you could ask on the MSDN forums or Stackoverflow?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anderci</div><div class="date">11th February 2013, 17:48</div></div><div class="posttext">Reporting back in:<br />
In the manifest &lt;assemblyIdentity ... version=... /&gt; version accuracy is important!<br />
Also in the manifest, each dependent file must have the<br />
 &lt;dependency&gt;<br />
  &lt;dependentAssembly&gt;<br />
   &lt;assemblyIdentity ... /&gt;<br />
  &lt;/dependentAssembly&gt;<br />
 &lt;/dependency&gt;<br />
for each dependent file (.dll, ...)  All of the examples I saw involved a single dependency.<br />
<br />
More later.  I still have not had 100% success with at least one WinVista PC.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anderci</div><div class="date">17th February 2013, 12:32</div></div><div class="posttext">Also, a manifest must be provided for each dependency file listed in the primary manifest.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anderci</div><div class="date">21st February 2013, 15:12</div></div><div class="posttext">To Wrap Up:<br />
I finally had success with all 4 Apps in the WinVista PC!<br />
<br />
The last program to succeed uses the DTPicker control.<br />
<br />
The NSIS script needed to copy both the MSCOMCT2.OCX and MSCAL.OCX from C:\WINDOWS\system32 .  I had initially tried copying MSCAL.OCX from D:\Program Files\Microsoft Office\Office: --&gt; That small mistake ~worked by first RunAsAdministrator, then Run as anybody. (The Mysterious Trick I have seen mentioned).  Maybe this 'Trick' causes a 'self-registration' of MSCAL.OCX ?<br />
<br />
The _.exe.manifest needed MSCAL.OCX as well as MSCOMCT2.OCX...<br />
<br />
I also added the MS Windows Calendar... to the components for my Application.<br />
<br />
I have not found any clear 'requirement' for MSCAL.OCX.  Mysterious?<br />
<br />
Thank you for your help!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>