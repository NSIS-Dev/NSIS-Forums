<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installer freezes after SHNotifyChange, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installer freezes after SHNotifyChange NSIS Discussion" />
	
	<title> Installer freezes after SHNotifyChange [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installer freezes after SHNotifyChange</div>
<hr />
<div class="pda"><a href="t-266201.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=266201">Installer freezes after SHNotifyChange</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Brett Embery</div><div class="date">20th February 2007, 03:26</div></div><div class="posttext">Hello all,<br />
<br />
My first post to the forum :) I've done a search about this and came up with not too much information or similar problems..<br />
<br />
I've been having some problems with (it seems) SHNotifyChange locking the installer on some systems. The installer will successfully install all required files, shortcuts and file associations, until shell refresh where the installer's user interface locks up or spins waiting.<br />
<br />
I am unable to reproduce it on mine, so I am unable to confirm my suspects, however we've had many people report it. (see attached screen shot)<br />
<br />
The code I'm interested in is :<br />
<br />
&lt;snip&gt;<br />
<br />
;Call RefreshShellIcons <br />
!define SHCNE_ASSOCCHANGED 0x08000000<br />
!define SHCNF_IDLIST 0<br />
<br />
Function RefreshShellIcons<br />
  ; By jerome tremblay - april 2003<br />
  System::Call 'shell32.dll::SHChangeNotify(i, i, i, i) v \<br />
  (${SHCNE_ASSOCCHANGED}, ${SHCNF_IDLIST}, 0, 0)'<br />
FunctionEnd<br />
<br />
	;Refresh the shell icons after changing file associations<br />
	Call RefreshShellIcons<br />
<br />
	;Force Desktop Refresh<br />
	; magic numbers :<br />
	;	65535	=	HWND_BROADCAST<br />
	;	26	=	WM_SETTINGCHANGE<br />
	SendMessage 65535 26 0 0<br />
&lt;/snip&gt;<br />
<br />
Has anyone had similar problems ?<br />
Are there any known issues with shell notification ?<br />
<br />
Would love to hear any feedback/suggestions.<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">20th February 2007, 06:01</div></div><div class="posttext">try using 0x2000 (SHCNF_FLUSHNOWAIT) as the flags for SHChangeNotify</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>