<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Vista: Making installed app run in XP compatibility mode, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Vista: Making installed app run in XP compatibility mode NSIS Discussion" />
	
	<title> Vista: Making installed app run in XP compatibility mode [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Vista: Making installed app run in XP compatibility mode</div>
<hr />
<div class="pda"><a href="t-260715.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=260715">Vista: Making installed app run in XP compatibility mode</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">theTallGuy</div><div class="date">30th November 2006, 00:17</div></div><div class="posttext">I've been testing my installer under Vista lately, and discovered that the installed app doesn't play well with Vista's Aero (glass) UI.  (The installer, amazingly, works great without modification.  Great work, everyone!)<br />
<br />
I would like to somehow mark the app to run in XP compatibility mode, which will force the app into Vista Basic UI (non-glass) mode. In other words, I would like to do the equivalent of right-clicking on the app's .exe file, choosing Properties then Compatibility, and selecting XP compatibility.<br />
<br />
Does anyone know how to do this?  Or, better yet, avoid this hassle completely?  (I was hoping there would be some setting in the Vista manifest to do this, but I can't find it if there is.)  Changing the software to be glass-friendly is, unfortunately, not an option giving our release schedule.<br />
<br />
Thanks in advance for any help you can offer!<br />
tTG</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">30th November 2006, 10:38</div></div><div class="posttext">Would you be so kind as to post a screenshot of what you think is not working with AeroGlass and NSIS in Vista?<br />
<br />
In the mean time, you could change the message send to a dialog window in .onInit see :<br />
http://www.installationexcellence.com/articles/VistaWithDelphi/Index.html<br />
<br />
for some hints which API calls.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">theTallGuy</div><div class="date">30th November 2006, 16:54</div></div><div class="posttext">Thanks for the link, but the app problem is trickier than that, as certain features need to tie in to the underlying graphics system, and for some reason, they don't work quite correctly with Glass.<br />
<br />
I'm sure the problem can be solved, but as we're trying to finish our release candidate by tomorrow, there's no time to break the underlying system.  For the moment, the workaround will have to do.  We'll solve the Vista issues in the next release when we have more time.<br />
<br />
Just to be clear, I'm looking for a way to modify the app's compatibility from the installer.  (The problem is *NOT* that the installer has issues with Glass.)  I've found one way, which is really, er, a kludge; it involves setting an special environment variable that causes any apps run to work in XP compatibility mode.  (I didn't even know that Windows cared about what's in environment variables!)  For the curious, you can read about it here: <br />
<br />
http://support.microsoft.com/default.aspx/kb/286705<br />
<br />
But I would prefer a way that only affects my own app.  I'm hoping that someone in this forum knows a way to modify an app's compatibility properties, either via plugin or by executing a command-line utility.<br />
<br />
Thanks!<br />
tTG</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th November 2006, 18:29</div></div><div class="posttext">A quick Google search for &quot;disable dwm&quot; came up with a related MSDN article (http://msdn2.microsoft.com/en-us/library/aa969538.aspx). It doesn't say that'd it cancel everything, but you can control at least some of it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">theTallGuy</div><div class="date">1st December 2006, 20:03</div></div><div class="posttext">Thanks, Kichik!  I'll pass this on to the developers for when we change the code to truly support Vista.<br />
<br />
In the meantime, I'm guessing that there isn't any way to set the OS compatibility properties for an app from NSIS other than by the environment string approach.  Sigh.  Sometimes these new Windows version are really hard on what remains of my hair... :)<br />
<br />
Thanks to everyone who responded and tried to help!<br />
<br />
tTG</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd December 2006, 09:28</div></div><div class="posttext">As far as I remember, when you select compatibility mode for a program, it writes something about it in the registry. You could make that change while running regmon in the background to see what you need to write in the registry to set it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">theTallGuy</div><div class="date">5th December 2006, 05:46</div></div><div class="posttext">RegMon did the trick!  For those of you who want to force an app to run in XP compatibility mode, just set the following registry key:<br />
<br />
HKCU &quot;Software\Microsoft\Windows <br />
NT\CurrentVersion\AppCompatFlags\Layers&quot; &quot;[full application path goes here]&quot; &quot;WINXPSP2&quot;<br />
<br />
This will hold us until we can do a real fix.  <br />
<br />
Thanks, Kichik!<br />
<br />
tTG</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbach</div><div class="date">12th December 2007, 10:03</div></div><div class="posttext">Thanks theTallGuy/Kichik. I had the same problem. Now, using the key provided by theTallGuy, I am able to solve this problem. Thanks a lot!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">12th December 2007, 16:47</div></div><div class="posttext">In some cases you may want to make that change in HKLM if you want it applied to All Users, I have only used it in XP but should work the same way under Vista.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>