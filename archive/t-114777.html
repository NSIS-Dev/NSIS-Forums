<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Windows Messaging, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Windows Messaging NSIS Discussion" />
	
	<title> Windows Messaging [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Windows Messaging</div>
<hr />
<div class="pda"><a href="t-114777.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=114777">Windows Messaging</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Mottel</div><div class="date">19th November 2002, 05:17</div></div><div class="posttext">I found this piece of code elsewhere (http://forums.winamp.com/showthread.php?threadid=107947)  on this forum.  (Commenting added by me, based on KiCHiK's WinMessages.NSH.)<br />
<br />
Function CloseWinamp <br />
  Push $0 <br />
  loop: <br />
    FindWindow $0 &quot;Winamp v1.x&quot; <br />
    IntCmp $0 0 done <br />
    SendMessage $0 &quot;000E&quot; 0 0  ; WM_GETTEXTLENGTH  ????<br />
    SendMessage $0 &quot;0002&quot; 0 0  ; WM_DESTROY<br />
    SendMessage $0 &quot;0082&quot; 0 0  ; WM_NCDESTROY<br />
    ;or thisone SendMessage $0 &quot;16&quot; 0 0  ; WM_CLOSE<br />
    Sleep 100 <br />
  Goto loop <br />
done: <br />
  Pop $0 <br />
FunctionEnd <br />
<br />
I've been trying to understand it, but, not knowing how reliable the source is, I may be wasting my time.  (If I am, could someone please let me know.)<br />
<br />
What's puzzling me is the sequence of messages.  Is the author just trying out a lot of alternatives in a &quot;hit and miss&quot; attempt to find one that works, or is this a recommended series of messages deliberately sent in a sequence in order to close a window gently?  Experimentation reveals that WM_CLOSE (0x10) and WM_DESTROY (0x2) work on their own.  The others don't.<br />
<br />
Also:<br />
(a) Is &quot;close&quot; preferrable to &quot;destroy&quot;?<br />
(b) What is the difference between WM_DESTROY and WM_NCDESTROY?<br />
(c) Why is WM_GETTEXTLENGTH relevant here????</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th November 2002, 16:25</div></div><div class="posttext">To close Winamp 2 you need only WM_CLOSE. WM_CLOSE is usually better than WM_DESTROY but it really depends on how the application was programed.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>