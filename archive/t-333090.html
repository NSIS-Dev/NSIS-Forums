<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Multiple InstallOptions DirRequests, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Multiple InstallOptions DirRequests NSIS Discussion" />
	
	<title> Multiple InstallOptions DirRequests [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Multiple InstallOptions DirRequests</div>
<hr />
<div class="pda"><a href="t-333090.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=333090">Multiple InstallOptions DirRequests</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">LOVENSIS</div><div class="date">2nd August 2011, 03:32</div></div><div class="posttext">I would like to show three DirRequest options in a row for multiple save locations in a backup location, does anyone know of a way that I can show them?<br />
<br />
Thank you in advance!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">2nd August 2011, 06:39</div></div><div class="posttext">First of all, InstallOptions has been deprecated, please use nsDialogs instead: http://nsis.sourceforge.net/Docs/nsDialogs/Readme.html<br />
<br />
To answer your question, you can just declare three different dirrequests in a row, as far as I know. What exactly goes wrong when you try it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LOVENSIS</div><div class="date">2nd August 2011, 13:17</div></div><div class="posttext">It shows a single option but I want three in a row, I am using an ini file which works for the first one and not the second, I know I am calling the right location but it shows the first and not the second, both are called in the nsis code.<br />
<br />
Thank you for your reply and I will try nsDialogs.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">2nd August 2011, 16:18</div></div><div class="posttext">Well we can't really help you unless you link to some code. Like, your ini file for example. But yeah, screw ini files, nsDialogs is the way to go.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LOVENSIS</div><div class="date">2nd August 2011, 22:39</div></div><div class="posttext">Sorry I didn't reply but I tried nsDialogs and it is working very well except that it will not accept ReadINIStr at all but it is working perfectly on everything else, any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LOVENSIS</div><div class="date">3rd August 2011, 02:33</div></div><div class="posttext">Here is the code I am using (at least trying to!):<br />
<br />
Function BrowseButton<br />
<br />
	nsDialogs::SelectFolderDialog &quot;Please select your first backup save location&quot; &quot;$DRIVELETTER:\&quot;<br />
<br />
	Pop $BrowseResult<br />
	<br />
	${NSD_SetText} $DirRequest $BrowseResult<br />
<br />
FunctionEnd<br />
<br />
Function BrowseButton1<br />
<br />
	nsDialogs::SelectFolderDialog &quot;Please select your second backup save location&quot; &quot;$DRIVELETTER:\&quot;<br />
<br />
	Pop $BrowseResult1<br />
	<br />
	${NSD_SetText} $DirRequest1 $BrowseResult1<br />
<br />
FunctionEnd<br />
<br />
Function BrowseButton2<br />
<br />
	nsDialogs::SelectFolderDialog &quot;Please select your third backup save location&quot; &quot;$DRIVELETTER:\&quot;<br />
<br />
	Pop $BrowseResult2<br />
	<br />
	${NSD_SetText} $DirRequest2 $BrowseResult2<br />
<br />
FunctionEnd<br />
<br />
<br />
Function nsDialogsPage<br />
	nsDialogs::Create 1018<br />
	Pop $Dialog<br />
	<br />
;Start of problem code.<br />
	ReadINIStr $R0 &quot;$EXEDIR\MozillaThunderbirdBackup.ini&quot; &quot;MozillaThunderbirdBackup&quot; &quot;DirRequestINI&quot;<br />
	${NSD_GetText} $R0 $1<br />
	${NSD_SetText} $DirRequest $1<br />
	ReadINIStr $DirRequestINI1 &quot;$EXEDIR\MozillaThunderbirdBackup.ini&quot; &quot;MozillaThunderbirdBackup&quot; &quot;DirRequestINI1&quot;<br />
	${NSD_SetText} $DirRequest1 $DirRequestINI1<br />
	ReadINIStr $DirRequestINI2 &quot;$EXEDIR\MozillaThunderbirdBackup.ini&quot; &quot;MozillaThunderbirdBackup&quot; &quot;DirRequestINI2&quot;<br />
	${NSD_SetText} $DirRequest2 $DirRequestINI2<br />
<br />
;End of problem code.<br />
;Comment below.<br />
<br />
	${If} $Dialog == error<br />
		Abort<br />
	${EndIf}<br />
<br />
	${NSD_CreateBrowseButton} 273u 90u 5% 13u &quot;...&quot;<br />
	Pop $BrowseButton<br />
	${NSD_OnClick} $BrowseButton BrowseButton<br />
	<br />
	<br />
	${NSD_CreateDirRequest} 10u 90u 87% 13u &quot;Please select your first backup save location.&quot;<br />
	Pop $DirRequest<br />
	<br />
	${NSD_CreateBrowseButton} 273u 104u 5% 13u &quot;...&quot;<br />
	Pop $BrowseButton1<br />
	${NSD_OnClick} $BrowseButton1 BrowseButton1<br />
<br />
<br />
	<br />
	${NSD_CreateDirRequest} 10u 104u 87% 13u &quot;Please select your second backup save location.&quot;<br />
	Pop $DirRequest1<br />
<br />
	${NSD_CreateBrowseButton} 273u 118u 5% 13u &quot;...&quot;<br />
	Pop $BrowseButton2<br />
	${NSD_OnClick} $BrowseButton2 BrowseButton2<br />
<br />
	${NSD_SetText} $DirRequest2 $DirRequestINI2<br />
<br />
	<br />
	${NSD_CreateDirRequest} 10u 118u 87% 13u &quot;Please select your third backup save location.&quot;<br />
	Pop $DirRequest2<br />
<br />
	<br />
<br />
<br />
	<br />
	nsDialogs::Show<br />
<br />
FunctionEnd<br />
<br />
<br />
Comment: I am just trying to get it to read from the INI file and fill the directory path but it will not fill the directory path, it is working with the same &quot;fill&quot; method on the browse buttons so it is probably the &quot;ReadINIStr&quot; part but the NSIS compiler isn't showing any errors and I can't figure out what is going wrong.<br />
<br />
And the identical ReadINIStr format and code is working perfectly elsewhere.<br />
<br />
<br />
And the top few paragraphs (it is supposed to be a Thunderbird backup program):<br />
<br />
;=== Includes<br />
!include MUI2.nsh<br />
!include FileFunc.nsh<br />
!insertmacro GetTime<br />
!include GetParent.nsh<br />
!include InstallOptions.nsh<br />
!include LogicLib.nsh<br />
!include nsDialogs.nsh<br />
<br />
<br />
;=== Icon &amp; Style ===<br />
!define MUI_ICON &quot;MozillaThunderbirdBackup.ico&quot;<br />
!define MUI_HEADERIMAGE<br />
!define MUI_HEADERIMAGE_BITMAP backupheader.bmp<br />
!define ReadINIStrNS &quot;!insertmacro ReadINIStrNS&quot;<br />
<br />
BrandingText &quot;Mozilla Thunderbird Backup - Your Email, Anywhere&quot;<br />
InstallButtonText &quot;Backup Now&quot; <br />
ShowInstDetails show<br />
SubCaption 3 &quot; | Backing Up Files&quot;<br />
<br />
;=== Variables<br />
Var BACKUPFILENAME<br />
Var BACKUPDIRECTORY<br />
Var USE7ZFORMAT<br />
Var USEMAXCOMPRESSION<br />
Var SHOWBACKUPDETAILS<br />
Var DRIVELETTER<br />
Var EXECSTRING<br />
Var BACKUPEVERYTHING<br />
Var BACKUPEMAIL<br />
Var BACKUPEXCLUDINGMAIL<br />
Var FINISHTEXT<br />
Var FINISHTITLE<br />
Var BACKUPEXTENSION<br />
Var BACKUPTYPE<br />
Var MOZILLATHUNDERBIRDROOTPATH<br />
Var Dialog<br />
Var DirRequest<br />
Var BrowseButton<br />
Var BrowseResult<br />
Var DirRequest1<br />
Var BrowseButton1<br />
Var BrowseResult1<br />
Var DirRequest2<br />
Var BrowseButton2<br />
Var BrowseResult2<br />
Var DirRequestINI<br />
Var DirRequestINI1<br />
Var DirRequestINI2<br />
<br />
<br />
<br />
;=== Pages<br />
!define MUI_WELCOMEFINISHPAGE_BITMAP welcomefinish.bmp<br />
!define MUI_WELCOMEPAGE_TITLE &quot;Mozilla Thunderbird Backup&quot;<br />
!define MUI_WELCOMEPAGE_TEXT `$(welcome)`<br />
;!define MUI_WELCOMEPAGE_TEXT &quot;rather long description that stretched the post in width&quot;<br />
!insertmacro MUI_PAGE_WELCOME<br />
Page custom ShowBackupWindow LeaveBackupWindow &quot; | $(settingsheader)&quot; <br />
Page custom nsDialogsPage<br />
Page instfiles<br />
!define MUI_FINISHPAGE_TITLE &quot;$FINISHTITLE&quot;<br />
!define MUI_FINISHPAGE_TEXT &quot;$FINISHTEXT&quot;<br />
!insertmacro MUI_PAGE_FINISH<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_INSTFILES<br />
<br />
<br />
This is just the current state of the code and I am trying everything I can think of.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LOVENSIS</div><div class="date">3rd August 2011, 02:34</div></div><div class="posttext">As is obvious I was trying a temporary identifier, ${NSD_GetText} etc.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LOVENSIS</div><div class="date">3rd August 2011, 02:36</div></div><div class="posttext">These are the INI file contents:<br />
<br />
[MozillaThunderbirdBackup]<br />
Use7zFormat=1<br />
UseMaxCompression=1<br />
ShowBackupDetails=1<br />
BackupEmail=0<br />
BackupExcludingMail=0<br />
BackupEverything=1<br />
DirRequestINI=C:\Users\Family\Desktop<br />
DirRequestINI1=C:\Users\Family\Desktop<br />
DirRequestINI2=C:\Users\Family\Desktop</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">3rd August 2011, 05:46</div></div><div class="posttext">I did say &quot;link&quot; to some code. Please don't paste such a mess...<br />
<br />
<br />
You can't NSD_SetText etc if the control doesn't exist. First create the controls, then set their properties/text.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LOVENSIS</div><div class="date">3rd August 2011, 15:46</div></div><div class="posttext">Sorry, NSD_SetText is for the browse buttons and is working very well but the rest isn't.<br />
<br />
I am attaching the complete code.<br />
<br />
Thanks again and sorry!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">3rd August 2011, 16:41</div></div><div class="posttext">I already told you, you're trying to SetText before the element is created.<br />
<br />
Please follow the tutorial in the nsDialogs readme: http://nsis.sourceforge.net/Docs/nsDialogs/Readme.html</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LOVENSIS</div><div class="date">3rd August 2011, 18:38</div></div><div class="posttext">It worked!! Thank you, I don't know if I should create a new topic but now I am having a problem with getting the selected option from a DropList in nsDialogs, the code is below:<br />
<br />
	${NSD_CreateDropList} 20u 20u 13% 13u &quot;...&quot;<br />
	Pop $ZipOptions<br />
	<br />
	SendMessage $ZipOptions ${CB_ADDSTRING} 0 &quot;STR:7z&quot;<br />
<br />
	SendMessage $ZipOptions ${CB_ADDSTRING} 0 &quot;STR:GZip&quot;<br />
<br />
	SendMessage $ZipOptions ${CB_ADDSTRING} 0 &quot;STR:BZip2&quot;<br />
	<br />
	SendMessage $ZipOptions ${CB_ADDSTRING} 0 &quot;STR:Tar&quot;<br />
	<br />
	SendMessage $ZipOptions ${CB_ADDSTRING} 0 &quot;STR:ISO&quot;<br />
	<br />
	SendMessage $ZipOptions ${CB_ADDSTRING} 0 &quot;STR:UDF&quot;<br />
	<br />
	${NSD_GetText} $SaveFormat $ZipOptions<br />
<br />
<br />
<br />
And further down:<br />
<br />
<br />
${StrCase} &quot;$SaveFormat2&quot; &quot;$SaveFormat&quot; &quot;L&quot;<br />
	<br />
	;'CompileEXECString:<br />
	StrCpy $EXECSTRING `a -w&quot;$TEMP&quot;`<br />
	<br />
	StrCmp $USE7ZFORMAT &quot;1&quot; &quot;&quot; &quot;UseZipFormat&quot;<br />
		StrCpy $EXECSTRING `$EXECSTRING -t$SaveFormat2`<br />
		StrCpy $BACKUPEXTENSION &quot;$SaveFormat2&quot;<br />
		Goto CheckCompressionType<br />
<br />
<br />
I am trying to have it set the compression method for 7-Zip, and it is not getting the text before the StrCase part, do you know what the problem is?<br />
<br />
--LOVENSIS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd August 2011, 19:15</div></div><div class="posttext">Your order of parameters for GetText is wrong. To avoid confusion, I recommend appending the control variable names with the control type, e.g. DropListZipOptions.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LOVENSIS</div><div class="date">4th August 2011, 03:28</div></div><div class="posttext">Thank you, but it didn't help.<br />
<br />
Now I am also having a problem with WriteINIStr :blah:<br />
<br />
Here is the code for that:<br />
<br />
	nsDialogs::OnChange $DirRequest LeavensDialogsPage<br />
	nsDialogs::OnChange $DirRequest1 LeavensDialogsPage<br />
	nsDialogs::OnChange $DirRequest2 LeavensDialogsPage<br />
<br />
	nsDialogs::Show<br />
<br />
FunctionEnd<br />
<br />
Function LeavensDialogsPage<br />
<br />
	WriteINIStr $EXEDIR\MozillaThunderbirdBackup.ini &quot;MozillaThunderbirdBackup&quot; &quot;DirRequestINI&quot; &quot;$DirRequestINISave&quot;<br />
	WriteINIStr $EXEDIR\MozillaThunderbirdBackup.ini &quot;MozillaThunderbirdBackup&quot; &quot;DirRequestINI1&quot; &quot;$DirRequestINISave1&quot;<br />
	WriteINIStr $EXEDIR\MozillaThunderbirdBackup.ini &quot;MozillaThunderbirdBackup&quot; &quot;DirRequestINI2&quot; &quot;$DirRequestINISave2&quot;<br />
	WriteINIStr $EXEDIR\MozillaThunderbirdBackup.ini &quot;MozillaThunderbirdBackup&quot; &quot;SaveFormat&quot; &quot;$SaveFormat&quot;<br />
<br />
<br />
<br />
FunctionEnd<br />
<br />
<br />
I was trying onChange for that but have tested it and it is writing to the ini file but it won't do it from DirRequestINISave is all of my code bad?<br />
<br />
Thanks for all of your time!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>