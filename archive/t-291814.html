<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" $SMPROGRAMS not in correct place??, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  $SMPROGRAMS not in correct place?? NSIS Discussion" />
	
	<title> $SMPROGRAMS not in correct place?? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  $SMPROGRAMS not in correct place??</div>
<hr />
<div class="pda"><a href="t-291814.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291814">$SMPROGRAMS not in correct place??</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">xplct0</div><div class="date">15th May 2008, 00:50</div></div><div class="posttext">Hey, I'm new to nsis, and I've been having an issue that I'm not sure how to elegantly resolve.<br />
<br />
After install I'm creating a shortcut to our application via:<br />
createShortCut '$SMPROGRAMS\Company\Game.lnk' '$INSTDIR\Game.exe'<br />
<br />
Taking a quick look at the value of $SMPROGRAMS, I see the following:<br />
C:\Users\david.DOMAIN\AppData\Roaming\Microsoft\Windows\Start Menu\Programs<br />
<br />
However, this isn't where the shortcut gets created.  It actually is sitting in the hidden folder:<br />
C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Company<br />
<br />
So now my question comes on uninstallation.  If I use the same syntax, ie:<br />
 Delete '$SMPROGRAMS\Company\*'<br />
 RMDir '$SMPROGRAMS\Company'<br />
The startmenu-program files entry doesn't actually get cleared out.  The only way for me to get around this, right now, is to literally enter the location of the shortcut and the shortcut's folder...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">15th May 2008, 17:14</div></div><div class="posttext">say it with me now, Vista Sucks, Vista Sucks...<br />
<br />
http://nsis.sourceforge.net/Shortcuts_removal_fails_on_Windows_Vista</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xplct0</div><div class="date">17th May 2008, 00:21</div></div><div class="posttext">Hey, thanks for the help.  That fixed the issue.  I'm actually very unfamiliar with the whole privlages system windows has established.  Without going into much detail, could you maybe explain to me what the issue was? (I understand the concept of logging in under different credentials)<br />
<br />
Also, as a curiosity, I now manually need to create a directory to contain my shortcut.  What is the reason behind this?<br />
<br />
createShortCut '$SMPROGRAMS\COMPANY\Shortcut.lnk' '$INSTDIR\Executable.exe'<br />
<br />
The above line used to create a folder, COMPANY, for me.  And now that I've added: RequestExecutionLevel admin, I now need to CreateDirectory '$SMPROGRAMS\COMPANY', first.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>