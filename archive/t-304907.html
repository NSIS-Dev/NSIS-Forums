<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Big Problem - installer runs only correct if i run it TWICE !!!, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Big Problem - installer runs only correct if i run it TWICE !!! NSIS Discussion" />
	
	<title> Big Problem - installer runs only correct if i run it TWICE !!! [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Big Problem - installer runs only correct if i run it TWICE !!!</div>
<hr />
<div class="pda"><a href="t-304907.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=304907">Big Problem - installer runs only correct if i run it TWICE !!!</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">congahonga</div><div class="date">2nd April 2009, 12:25</div></div><div class="posttext">Hello all,<br />
<br />
I got a big problem with an Installer for a special software.<br />
<br />
It only works correct if the same installer ist executed TWICE, without changing anything.<br />
<br />
I try to describe the situation. On remark before: The software, i am writing an installer for, is OLD, and very complex. We can't change anything, we can only automated the written install process, that is now written on a paper and needs some hours if done by hand.<br />
<br />
Situation:<br />
The installer first unzips a big zip-file, containing the whole system, using Nsisz::Extract.<br />
<br />
Then installer creats a database by using 4 existing exe-Files, that have several parameters. This exe-Files consists of encapsuleted sql-code, using a C++ Sql library. This is not the problem. Database is well created by these command, either by a batch file, or by the installer-programm.<br />
<br />
Then the created Database (on MSSQL-DB-Server) is filled with same base-date, using another existing exe-command, like above. It can handle several parameters, and the path and name of some text-files that contains the base-info.<br />
<br />
This is the command, with some parameters and Data Text-file.<br />
setsu.exe $2 -s StandardUser -m GKN-2 -d operational -f StandardUser_operational_GKN-2_UDMA.sdo<br />
<br />
-f is the text-file name<br />
<br />
(by the way: I must use this command, can't write it directly per sql-statements. This is the project-demand)<br />
<br />
And now, THIS IS THE PROBLEM ! When i run the NSIS installer - that I wrote - the first time, the Database is correct generated, BUT the base-info, coming out of the text-files isn't putted in. The tables are empty !<br />
<br />
If I run the UNCHANGED installer another time, the <br />
info out of the text-files is correctly putted in the Database ! It doesn't matter if I overwrite the database, or not ! <br />
<br />
This is a very strange behaviour. Unfortunately it is very difficult to get a log from the exe-files, because Execwait doesn't show the shells.<br />
<br />
During the installationprocess itt is the first time, I try to read info from files, all commands before are only parameters, pathes and registry keys.<br />
<br />
My question is: Could it be, that the unzipped textfiles, are in the first run of the installer &quot;locked&quot;, so that they can't be read. Or that they are not completly there, even they are visible either in windows explorer, or dir-command ?<br />
<br />
Does anyone have an idea, why the textfile data is only written in the database if the installer is run TWICE ?<br />
<br />
I would be happy for ANY Tipps...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">2nd April 2009, 13:20</div></div><div class="posttext">no idea, specifically, but you could use ExecDos instead of ExecWait:<br />
http://nsis.sourceforge.net/ExecDos_plug-in<br />
That will allow you to output the program's stdout (what it would print to screen) to the install detail window, to a file, to the stack for reading, etc.<br />
<br />
The program's output may give a clue, at least.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">congahonga</div><div class="date">2nd April 2009, 13:24</div></div><div class="posttext">and 2 in second run !<br />
<br />
Strange !<br />
<br />
What means -128 ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">2nd April 2009, 14:02</div></div><div class="posttext">well I meant the output it would normally print to screen (i.e. when you run it in DOS); ExecDos can redirect that to a file.  That should have more details.<br />
<br />
What you're referring to are exit codes, and you'd have to check the documentation for / developers of 'setsu.exe' to see what the exit code values mean.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">congahonga</div><div class="date">7th April 2009, 08:48</div></div><div class="posttext">I think, the exit-code is from ExecDos...<br />
Because if I exec a file, which is not there, or make some other things, it occurs to the same exit-codes.<br />
<br />
So they must come from ExecDos, needn't they ?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>