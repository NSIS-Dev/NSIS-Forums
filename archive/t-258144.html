<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Install for all users, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Install for all users NSIS Discussion" />
	
	<title> Install for all users [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Install for all users</div>
<hr />
<div class="pda"><a href="t-258144.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258144">Install for all users</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">f1nn</div><div class="date">23rd October 2006, 16:05</div></div><div class="posttext">Hi I am having a problem and hope someone can help me see  what I am doing wrong. My script uses the UserInfo section example to get the users admin rights. If the user has full admin rights I set setShellVarContext in the same section to ALL. This seems to work OK and install properly. The uninstall is were the problem shows. The folders and files uninstall OK except for the desktop Icon which remains after everything else is gone. I may  be doing something wrong but dont understand what as I have used the help files and believe I am using setShellVarContext OK so examples may help. Many thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CrushBug</div><div class="date">23rd October 2006, 17:56</div></div><div class="posttext">Try setting setShellVarContext to both options and call the delete after each one. That should take care of the icon being created either way.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">f1nn</div><div class="date">24th October 2006, 11:56</div></div><div class="posttext">Hi Thanks for the reply. I am not sure how to call the delete. What I am doing is getting the user as admin by using the userinfo plug in section and in the same section using <br />
Pop $1<br />
StrCmp $1 &quot;Admin&quot; 0 +3<br />
;MessageBox MB_OK 'User &quot;$0&quot; is in the Administrators group'<br />
Goto Alluser<br />
Alluser:<br />
       SetShellVarContext all<br />
<br />
How do I go about deleting this and were, or am i not using this properly at all. an example would maybe help me to see how to use this properly. I have looked at the example in the NSIS help file but not sure if I ma using this in the correct way. Many thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CrushBug</div><div class="date">24th October 2006, 18:03</div></div><div class="posttext">I use something like this<br />
<br />
SetShellVarContext current<br />
Delete &quot;$DESKTOP\Here Is My Shortcut.lnk&quot;<br />
SetShellVarContext all<br />
Delete &quot;$DESKTOP\Here Is My Shortcut.lnk&quot;<br />
<br />
and this gets the links for both.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">f1nn</div><div class="date">26th October 2006, 11:48</div></div><div class="posttext">Many thanks for the reply this has solved the problem, I have also found that you can use <br />
setShellVarContext all<br />
and then in the uninstall section do the same again</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>