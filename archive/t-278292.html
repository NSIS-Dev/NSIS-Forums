<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Pass variables between nsh files, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Pass variables between nsh files NSIS Discussion" />
	
	<title> Pass variables between nsh files [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Pass variables between nsh files</div>
<hr />
<div class="pda"><a href="t-278292.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=278292">Pass variables between nsh files</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">clk_it</div><div class="date">4th October 2007, 15:08</div></div><div class="posttext">Hi,<br />
I'm using the same things in all my installers,<br />
so I created a script that is used in my nsi files.<br />
<br />
Some code of my Installer.nsi:<br />
<br />
*******<br />
!include &quot;Common_Lib.nsh&quot; &lt;&lt;THIS IS MY COMMON FILE<br />
...<br />
!define APP_VERSION &quot;1.17.0.0&quot;<br />
!define APP_TITLE &quot;ArgonWare 3&quot;<br />
...<br />
Var FIREBIRD_FULL_TARGETDIR<br />
Var FIREBIRD_FULL_ODBC_TARGETDIR<br />
Var FIREBIRD_TARGETDIR<br />
...<br />
Function xx<br />
!insertmacro FB_1_5_Installa_Server $FIREBIRD_TARGETDIR $FIREBIRD_FULL_TARGETDIR $ODBC_NAME $DATABASE_FILE<br />
FunctionEnd<br />
Function xxx<br />
  !insertmacro CREA_CHIAVI_REGISTRO_INSTALLAZIONE $APP_TITLE $APP_VERSION<br />
FunctionEnd<br />
*******<br />
<br />
Some code of my Common_Lib.nsh<br />
<br />
*******<br />
!macro FB_1_5_Installa_Server FIREBIRD_TARGETDIR FIREBIRD_FULL_TARGETDIR ODBC_NAME DATABASE_FILE<br />
        ExecWait '&quot;$INSTDIR\xxxx.exe&quot; xxx /DIR=\&quot;${FIREBIRD_TARGETDIR}\&quot;'<br />
....<br />
!macroend<br />
<br />
!macro CREA_CHIAVI_REGISTRO_INSTALLAZIONE APP_TITLE APP_VERSION<br />
....<br />
  WriteRegStr HKLM &quot;SOFTWARE\XXX\${APP_TITLE}&quot; &quot;Install_Dir&quot; &quot;$INSTDIR&quot;<br />
....<br />
!macroend<br />
*******<br />
<br />
The first macro (FB_1_5_Installa_Server) works fine,<br />
arguments are passed correctly and all goes ok.<br />
The second macro gives errors on compling:<br />
Warning: unknown variable/constant &quot;APP_TITLE&quot; detected, ignoring (macro:CREA_CHIAVI_REGISTRO_INSTALLAZIONE)<br />
<br />
Why this?<br />
What is the difference between the 2 macro?<br />
<br />
Thanks for the help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th October 2007, 15:12</div></div><div class="posttext">That happens because you pass it $APP_TITLE and $APP_VERSION when you call it from your script (Installer.nsi).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">clk_it</div><div class="date">4th October 2007, 15:17</div></div><div class="posttext">Sorry, I don't understand.<br />
I'm using the same system for the 2 macros.<br />
<br />
The only difference is that in the nsi,<br />
app_title and app_version are !defined, and not variables<br />
<br />
But I'm passing the value as argument, not the variable.<br />
<br />
What I must change?<br />
<br />
thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th October 2007, 15:25</div></div><div class="posttext">The problem is not in any way related to the NSH file or the macros in it. The problem is that you passed $APP_TITLE instead of ${APP_TITLE} in Installer.nsi.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">clk_it</div><div class="date">4th October 2007, 15:28</div></div><div class="posttext">Ok, It's correct.<br />
<br />
Now I have another problem:<br />
if I write:<br />
!insertmacro CREA_CHIAVI_REGISTRO_INSTALLAZIONE ${APP_TITLE} ${APP_VERSION}<br />
<br />
The compiler tells me:<br />
macro ... requires 2 parameters, passed 3.<br />
<br />
Where is the third parameter?<br />
<br />
If I remove the second parameter, compiler tells OK.<br />
<br />
??<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th October 2007, 15:31</div></div><div class="posttext">The third parameter is in the defines themselves. You must quote both so the space in the define won't count as another parameter.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">clk_it</div><div class="date">4th October 2007, 16:01</div></div><div class="posttext">Compiled and tested!<br />
<br />
All OK!<br />
<br />
Many thanks for the help.<br />
<br />
Claudio</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>