<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Yet another problem with 2nd location directory page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Yet another problem with 2nd location directory page NSIS Discussion" />
	
	<title> Yet another problem with 2nd location directory page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Yet another problem with 2nd location directory page</div>
<hr />
<div class="pda"><a href="t-306591.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=306591">Yet another problem with 2nd location directory page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kamikaze09</div><div class="date">21st May 2009, 09:35</div></div><div class="posttext">Hello all,<br />
<br />
I'm a bit new with NSIS. I'm having some trobule with my nsi script and trying to set a 2nd directory page to install program data.<br />
<br />
I attach my original nsi script (with only 1 directory page, the typical), I also attach the new code where I try to code the second directory.<br />
<br />
I've followed the example : http://nsis.sourceforge.net/Setting_Default_Location_for_2nd_(Data)_Directory_Page<br />
and I've also searched the forum but there is no code for a newbie like me.<br />
<br />
When I compile my code it says that :<br />
<br />
install function &quot;DirectoryShow&quot; not reference - zeroing code <br />
install function &quot;DirectoryLeave&quot; not reference - zeroing code<br />
<br />
I'm sure that I'm missing something stupid, but I need some help.<br />
<br />
Could anyone point me what i'm doing wrong?<br />
<br />
Thank you all in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st May 2009, 12:24</div></div><div class="posttext">That page is very outdated. You no longer use !define MUI_DIRECTORYPAGE, and the MUI_CUSTOMFUNCTION_DIRECTORY_* defines are no longer valid. Check the MUI2 documentation on custom functions.<br />
<br />
Edit: Also note that the defines have to be placed before the !insertmacro of the page that they need to apply to.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kamikaze09</div><div class="date">21st May 2009, 15:57</div></div><div class="posttext">Hello Afrow<br />
<br />
Thank you very much for your fast response.<br />
<br />
I've done some corrections to my code:<br />
<br />
- I started using mui2.nsh<br />
- I deleted the: !define MUI_DIRECTORYPAGE since it is not longer needed<br />
- I changed all MUI_CUSTOMFUNTION_DIRECTORY_* to:<br />
<br />
<br />
!define MUI_DIRECTORY_CUSTOMFUNCTION_PRE FucntionPre<br />
!define MUI_DIRECTORY_CUSTOMFUNCTION_SHOW FucntionShow<br />
!define MUI_DIRECTORY_CUSTOMFUNCTION_LEAVE FucntionLeave<br />
<br />
<br />
(that is what I understand from the manual http://nsis.sourceforge.net/Docs/Modern%20UI/Readme.html )<br />
<br />
After that i do this:<br />
<br />
<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_LICENSE<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
Page custom DIRECTORY   &lt;---- This is wrong but i dont know how to write it<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
<br />
<br />
And later, i have the 3 functions<br />
<br />
Function FucntionPre<br />
....<br />
FunctionEnd<br />
<br />
Function FucntionLeave<br />
....<br />
FunctionEnd<br />
<br />
<br />
<br />
Function FucntionShow<br />
  StrCmp $9 &quot;0&quot; AppDirectoryPage<br />
  StrCmp $9 &quot;1&quot; DataDirectoryPage<br />
 <br />
AppDirectoryPage:<br />
  StrCpy $9 &quot;1&quot;<br />
  !insertmacro MUI_INNERDIALOG_TEXT 1041 &quot;Destination Folder&quot;<br />
  !insertmacro MUI_INNERDIALOG_TEXT 1019 &quot;$PROGRAMFILES\${MUI_PRODUCT}\&quot;<br />
  !insertmacro MUI_INNERDIALOG_TEXT 1006 &quot;Setup will install ${MUI_PRODUCT} in the following folder.$\r$\n$\r$\nTo install in a different folder, click Browse and select another folder. Click Next to continue.&quot;<br />
  Goto EndDirectoryShow<br />
 ....				<br />
FunctionEnd<br />
<br />
<br />
However MUI_INNERDIALOG_TEXT is not found.<br />
<br />
I've been working on this all day but no way to understand it how to make it work, and there is no example at all in the new MUI2 tutorial about this, neither in the forum. <br />
<br />
I would be very pleased if you or someone could help me with the code. I'm absolutely desperated.<br />
<br />
Thank you very much in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st May 2009, 17:04</div></div><div class="posttext">As with all other MUI pages, it's !insertmacro MUI_PAGE_DIRECTORY. To have more than one page, you insert it twice then use !define MUI_DIRECTORYPAGE_VARIABLE for the second one to specify a custom variable to use instead of INSTDIR for it.<br />
<br />
All this is in the MUI2 readme if you read it.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kamikaze09</div><div class="date">23rd May 2009, 20:52</div></div><div class="posttext">Hello Afrow UK,<br />
<br />
I've tested what you told me and now it is working fine. Now i  do not have the code right here, but i will write it here on monday and maybe it will be useful to someone.<br />
<br />
Thank you very much for your help</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>