<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Questions about VB deployment &amp; shared files, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Questions about VB deployment &amp; shared files NSIS Discussion" />
	
	<title> Questions about VB deployment &amp; shared files [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Questions about VB deployment &amp; shared files</div>
<hr />
<div class="pda"><a href="t-71598.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=71598">Questions about VB deployment &amp; shared files</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">malachii</div><div class="date">11th January 2002, 18:31</div></div><div class="posttext">Hello Folks...<br />
<br />
I've noticed a few threads discussing VB deployment with the NSIS installer. I know keeping track of all the DLLs is a pain, but I'm not worried about that. I'm worried about the &quot;correct way to install VB DLLs&quot;.<br />
<br />
There are two ways to go about doing this so far as I know. You can run the VB runtime distributable form microsoft, or you can do it yourself in your own NSIS script (manually).<br />
<br />
The microsoft runtime distributable includes the basic VB dependencies, but not the tons, and tons of others like the tabbed dialog OCX, XML, etc... For that reason I'm more keen on doing the install myself in an NSIS script, since I have to handle all those others correctly anyhow.<br />
<br />
So what is the process for those files? Here's my best guess. By the way, I'm not sure what a &quot;shared dll&quot; is technically. I know there is some registry tweaking involved for &quot;reference counting&quot; of some sort. The NSIS docs have a script to do that, but again, I'm not sure on the process.<br />
<br />
The following process I assume is correct for the XML, TabbedDialog, and VB Runtime DLLs....<br />
<br />
1. Copy the correct files into the system32 directory (using IfNewer)<br />
2. Register the files you copied into the system32<br />
3. Perform that &quot;shared dll&quot; voodoo on them all.<br />
<br />
During the UNinstall you would... (not sure about this)<br />
<br />
1. Perform the &quot;shared dll&quot; voodoo, and if the share count reaches 0, unregister and delete the DLL?<br />
<br />
Also LAST question.<br />
<br />
How does NSIS handle shared DLLs that are currently IN USE by the system (locked), like the OLDAUT dlls often are?<br />
<br />
Thanks!<br />
<br />
Mal.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">11th January 2002, 19:25</div></div><div class="posttext">The OLEAUT ones: you can use /REBOOTOK to replace them (once you find you can't replace them). A while ago I found that it was smaller to use the microsoft distro than to use your own script and compress the files, but that was before bzip2, so perhaps it's now smaller to use that solution instead. If you look for a VB post by me, you'll probably find a script which more or less covers what you want (but not reference counting) - and it doesn't use the new GetDLLVer commands yet, so it doesn't work anymore. Perhaps you'd better start from scratch -:(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">malachii</div><div class="date">11th January 2002, 20:34</div></div><div class="posttext">The docs say that /REBOOTOK is only for DELETE and RENAME commands. How do I COPY with /REBOOTOK, and what does it do? Does it perform this action after reboot instead? <br />
<br />
If I can get around this problem of locked OLEAUT files, then all should be well... I think.<br />
<br />
Thanks again,<br />
<br />
Mal.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">12th January 2002, 09:35</div></div><div class="posttext">Forgot to say:<br />
Copy the DLL file to a temporary folder first, and then use Rename /REBOOTOK to replace the old one once the computer reboots. Note that with these OLEAUT &amp; OLEPRO files, you must check the version first! Installing an old version over a new one is fairly dramatic for your user (programs will stop working)!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">12th January 2002, 10:21</div></div><div class="posttext">You can rename across directories?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">12th January 2002, 16:01</div></div><div class="posttext">Yes, I believe you can (normally, you can rename accross drives too), as the Windows Move command is used IIRC.<br />
However, I'm not sure if the /REBOOTOK and accross directory is a good idea. Perhaps it's better to put them both in the System dir and then rename, because I think /REBOOTOK cannot rename across drives and if the temp dir is not on the same drive as Windows...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>