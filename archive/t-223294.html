<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ServiceLib.nsh - Can't create a network service, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ServiceLib.nsh - Can't create a network service NSIS Discussion" />
	
	<title> ServiceLib.nsh - Can't create a network service [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ServiceLib.nsh - Can't create a network service</div>
<hr />
<div class="pda"><a href="t-223294.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=223294">ServiceLib.nsh - Can't create a network service</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jeff_hanna</div><div class="date">3rd August 2005, 21:30</div></div><div class="posttext">I've searched through the forums and read the (very slow to respond) WIKI pages. I see that there are many topics regarding Windows services. Unfortunately none of them provide answers to the problems I am having.<br />
<br />
servicelib.nsh doesn't seem to change the service from Local System account to a domain account when I specify a user and a password. The command executes cleanly and successfully, but when I open the Services applet and go to the Log On tab the service is set to &quot;Local System account&quot; and the account, password, and confirm password fields are blank.<br />
<br />
Additionally, the display variable in the parameters doesn't seem to be respected. The display name of the service is the same as the service name.<br />
<br />
The line I am using is:<br />
<br />
!insertmacro SERVICE &quot;create&quot; &quot;Backburner_Srv_200&quot; &quot;path=$ServerPath;interact=0;type=2;user=.\user;password=pass;display=Backburner Server&quot;<br />
<br />
Note: It seems there is a typo in the library's comments type=2 sets the service to auto start while type=3 sets it to manual start. This is the opposite of what is in the comments.<br />
<br />
Any help with this would be greatly appreciated. Creating a network service with a proper user and password is the last hurdle I need to overcome to complete my project.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th August 2005, 22:17</div></div><div class="posttext">Originally posted by jeff_hanna <br />
Note: It seems there is a typo in the library's comments type=2 sets the service to auto start while type=3 sets it to manual start. This is the opposite of what is in the comments.Which ServiceLib.nsh is that? The one on the Wiki (http://nsis.sourceforge.net/wiki/NSIS_Service_Lib) mentions nothing about a `type` argument. Is it newer than the Wiki version?<br />
<br />
As for your questions, I have no idea.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jeff_hanna</div><div class="date">5th August 2005, 14:49</div></div><div class="posttext">Originally posted by kichik <br />
Which ServiceLib.nsh is that? The one on the Wiki (http://nsis.sourceforge.net/wiki/NSIS_Service_Lib) mentions nothing about a `type` argument. Is it newer than the Wiki version? <br />
<br />
Yes, it is. The library linked on the WIKI page is out of date. See this discussion (http://forums.winamp.com/showthread.php?s=&amp;threadid=150873) for a link to dselkirk's latest release of the library.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th August 2005, 14:56</div></div><div class="posttext">That's weird... Both are labeled version 1.2 and the one on the Wiki has a newer date.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jeff_hanna</div><div class="date">5th August 2005, 15:30</div></div><div class="posttext">Shrug, yeah it is weird. I started with the one on the WIKI and then found that discussion. The linked file in that discussion has more features and was created as a revision to the first release. The author didn't update the version number or mod date in the file, though. It still shows v1.0<br />
<br />
Anyway, I fixed the display name issue. It seems that the parameters must be seperated with a ; and also end with ;. I didn't have the trailing ; in my line.<br />
<br />
Still can't get user/password info &amp; network service stuff to work, though.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">5th August 2005, 17:29</div></div><div class="posttext">Hmmm... he doesn't answer in the forums since the end of 2003. Maybe contacting him by e-mail about problems?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jeff_hanna</div><div class="date">5th August 2005, 18:54</div></div><div class="posttext">I tried that a few days ago, dequix. There was no response. I guess at this time we should consider ServiceLib.nsh to be unsupported.<br />
<br />
I found a workaround, though. So things are ok for me. From everything I found about the windows API call CreateService() and the ServiceLib.nsh file it appears as if the create method inside of ServiceLib.nsh is working as expected. Windows (XP) just doesn't seem to respect the user name and switch the service to a network service.<br />
<br />
I found that if I use the DOS command SC immediately after creating the service I can use the config method within SC to set the user/password and WinXP will understand to switch the service to a network service. The command in my installer is:<br />
<br />
nsExec::Exec &quot;sc config backburner_srv_200 obj= .\&lt;usr&gt; password= &lt;pwd&gt;&quot;<br />
<br />
Where &lt;usr&gt; and &lt;pwd&gt; contain the actuall information for my network. If anyone else uses this and they are on a domain then .\&lt;usr&gt; should be changed to &lt;domain&gt;\&lt;usr&gt;<br />
<br />
It's not as clean as having it all happen with ServiceLib.nsh, but it works and is transparent to the user.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sdelmas</div><div class="date">30th August 2005, 23:42</div></div><div class="posttext">Did you find a solution to your problem? I have changed the ServiceLib module to fix this (and other issues). If you still need this, I can give you a copy of my file.<br />
<br />
Sven</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>