<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstall Deletes Uninstaller when invoked from Add/Remove Programs but not from..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstall Deletes Uninstaller when invoked from Add/Remove Programs but not from... NSIS Discussion" />
	
	<title> Uninstall Deletes Uninstaller when invoked from Add/Remove Programs but not from... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstall Deletes Uninstaller when invoked from Add/Remove Programs but not from...</div>
<hr />
<div class="pda"><a href="t-295407.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=295407">Uninstall Deletes Uninstaller when invoked from Add/Remove Programs but not from...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ronca</div><div class="date">1st August 2008, 23:05</div></div><div class="posttext">Newbie. First NSIS script ever. Based on makensis.nsi. It was a no-brainer. Just copy makensis.nsi and modify the product name, file names, etc.<br />
<br />
However. Something strange and I don't know how to troubleshoot this: When I invoke the Uninstaller from Add/Remove Programs (Windows XP control panel), it uninstalls EVERYTHING, including the uninstaller itself, and deletes my programs directory in C:\Program Files. This is what I expect and this is what I want!<br />
<br />
However, if I invoke the Uninstaller from the Install program itself (you know, it smartly detects whether it is already installed and offers to either re-install or uninstall), it uninstalls everything, EXCEPt for the uninstaller! which means that my programs directory in C:\Program Files is not deleted...<br />
<br />
Is this by design? or is this a bug?<br />
<br />
If this is by design, what is the rational behind this difference in behavior based on how the Uninstaller was invoked?<br />
<br />
If this is a bug (in my script), how do I troubleshoot this?<br />
<br />
Thanks,<br />
Ron</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">3rd August 2008, 06:15</div></div><div class="posttext">I have to say, it sounds odd.  One thing that comes to mind is the command to create the uninstaller is in the main installer.  Could it be the uninstaller you are seeing is actually the one the installation is creating?<br />
<br />
The other thing is the when you run the uninstaller, it copies itself to the TEMP folder and runs from there. By doing this, it should delete the original uninstaller from C:\program files.<br />
<br />
But, if you are instead running something else to uninstall (or have use the &quot;_?=&quot; switch) from your installation, then that temp file copy thing may not be happening.  (I assume you are just launching the uninstaller directly, but thought I'd mention it just in case.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vc6</div><div class="date">4th August 2008, 15:27</div></div><div class="posttext">Originally posted by ronca <br />
Is this by design? or is this a bug?<br />
Ron, I checked for you the makensis.nsi example (the most recent one) and sure enough in Function PageLeaveReinstall there is:<br />
<br />
    ExecWait '$R1 _?=$INSTDIR'<br />
<br />
    IfErrors no_remove_uninstaller<br />
    IfFileExists &quot;$INSTDIR\makensis.exe&quot; no_remove_uninstaller<br />
<br />
So, your problem appears to be caused by the &quot;_?=&quot; switch as suggested by Comperio. Read the FAQ:<br />
<br />
When I use ExecWait uninstaller.exe it doesn't wait for the uninstaller. Why?<br />
NSIS uninstaller copies itself to the temporary directory, runs the temporary uninstaller create and then exits. This is done so it will be able to delete itself. To force the uninstaller not to do this use:<br />
<br />
    ExecWait '&quot;$INSTDIR\uninstall.exe&quot; _?=$INSTDIR'<br />
<br />
Now the question that comes to mind is why did the makensis.nsi example writer choose to NOT WAIT for the uninstaller...<br />
<br />
HTH,<br />
Victor</div></div><hr />


<div class="post"><div class="posttop"><div class="username">KrisAster</div><div class="date">4th August 2008, 19:54</div></div><div class="posttext">It also might be something as simple as the directory is still open while the uninstall is running.  It could potentially be held open by your script, or by windows explorer navigated to that directory.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>