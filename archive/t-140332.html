<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" GetWindowsVersion updated for WinSE stopped working..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  GetWindowsVersion updated for WinSE stopped working... NSIS Discussion" />
	
	<title> GetWindowsVersion updated for WinSE stopped working... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  GetWindowsVersion updated for WinSE stopped working...</div>
<hr />
<div class="pda"><a href="t-140332.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=140332">GetWindowsVersion updated for WinSE stopped working...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Lilla</div><div class="date">27th June 2003, 20:25</div></div><div class="posttext">GetWindowsVersion updated for WinSE stopped working...<br />
<br />
In the archive there is function<br />
GetWindowsVersion updated for Windows SE<br />
<br />
I am running Win98SE and am using this function. This function stopped working when I updated via CVS yesterday. Before that it worked just fine. Now it returns an empty string instead of '98 SE' as it should do.<br />
<br />
GetWindowsVersion from Appendix B works just fine, so the problem is only with the modified version that is in the archive.<br />
<br />
Does the modified version of GetWindowsVersion need to be updated to be compatible with the latest CVS? <br />
<br />
If so, that is fine, I can change my code to use the standard version of GetWindowsVersion, which I may do in any event.<br />
<br />
Or, is this a development problem that needs to be corrected so the modified version of GetWindowsVersion in the Archive will work again? <br />
<br />
Thank you,<br />
Lilla</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th June 2003, 20:45</div></div><div class="posttext">Try now with the ClearErrors I have added to the function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lilla</div><div class="date">27th June 2003, 20:51</div></div><div class="posttext">Thanks, will do!<br />
<br />
Lilla</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lilla</div><div class="date">27th June 2003, 21:07</div></div><div class="posttext">Kichik. Sorry, with ClearErrors I see no change. Still reports empty string instead of '98 SE'<br />
<br />
Lilla</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th June 2003, 21:56</div></div><div class="posttext">I am sorry, but I don't have the time right now to test this. Try adding a few message boxes along the way and check this out, especially around the lbl_win32_98 part. If you don't get it by tomorrow I'll try again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lilla</div><div class="date">27th June 2003, 22:26</div></div><div class="posttext">Ok, I'll give it a try, I'll post back with my results.<br />
<br />
Lilla</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lilla</div><div class="date">27th June 2003, 23:44</div></div><div class="posttext">OK, here's what I figured out.<br />
<br />
Regarding GetWindowsVersion in Appendix B.<br />
<br />
ClearErrors<br />
This line should be added to the function.<br />
I *just* updated via CVS and this line is not there.<br />
<br />
Observations:<br />
this function uses HKLM (not HKCU)<br />
this function works.<br />
<br />
---------------------------------------------<br />
<br />
Regarding GetWindowsVersion updated for Windows 98 SE in the Archive<br />
<br />
ClearErrors - Kichik added this line today.<br />
<br />
observations: <br />
this function uses HKCU (vs HKLM used by function in Appendix B)<br />
this function does NOT work<br />
<br />
I changed HKCU to HKLM and now this function works!<br />
So, it appears then that this change needs to be made to the Archive, or at least a comment that if you are using NSIS v2 beta 4 you need to change HKCU to HKLM.<br />
<br />
-------------<br />
<br />
Hope this helps,<br />
Lilla</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th June 2003, 11:52</div></div><div class="posttext">Good catch.<br />
<br />
There shouldn't be any difference between HKLM and HCKU through the different versions of NSIS, and there isn't. Everything else that relates to this still works for me. The code on the Archive though does say HKLM. It's possible that someone else has already updated though, it's owned by anonymous...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lilla</div><div class="date">28th June 2003, 18:06</div></div><div class="posttext">Thanks much.  I thought that I had confirmed that the archived version used HKCU instead of HKLM, but retracing my steps it looks now that it was HKLM all along (not HKCU as I said it was). It was HKCU in my code, but that was evidently a problem that I introduced. <br />
<br />
In any event, it was good that we discoving the missing ClearErrors.<br />
<br />
Lilla</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>