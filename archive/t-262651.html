<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" $AppDATA in Vista for standard user, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  $AppDATA in Vista for standard user NSIS Discussion" />
	
	<title> $AppDATA in Vista for standard user [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  $AppDATA in Vista for standard user</div>
<hr />
<div class="pda"><a href="t-262651.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=262651">$AppDATA in Vista for standard user</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">fatcat007</div><div class="date">29th December 2006, 05:06</div></div><div class="posttext">Hi, please help<br />
<br />
Im trying to retreive the $appdata for a standard user in Vista. Every time the installer returns the admin user appdata.<br />
<br />
The following works fine in WinXP but not in Vista if the user is standard user.<br />
------<br />
MessageBox MB_OK &quot;APPDATA=$APPDATA&quot;<br />
ReadRegStr $1 HKCU &quot;Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders&quot; &quot;AppData&quot;<br />
MessageBox MB_OK &quot;HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders $\n $1&quot;<br />
ReadEnvStr $0 USERPROFILE<br />
MessageBox MB_OK &quot;ReadEnvStr USERPROFILE=$0&quot;<br />
System::Call &quot;advapi32::GetUserName(t .r0, *i ${NSIS_MAX_STRLEN} r1) i.r2&quot;<br />
MessageBox MB_OK &quot;user Name from System Call=$0&quot;<br />
------<br />
Is there a way in NSIS to retreive the APPDATA of standard user in Vista?<br />
<br />
Thank you for a quick reply</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th December 2006, 10:42</div></div><div class="posttext">That's probably because the installer got elevated into the administrator's level. You could use `RequestExecutionLevel user`, but then you won't have any administrator privileges.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fatcat007</div><div class="date">29th December 2006, 14:19</div></div><div class="posttext">I have tried all the RequestExecutionLevel level one by one... still the same. Even if the installer needs admin rights why Vista keep sending another user profile instead of the current one. <br />
Is there another way in NSIS to retreive the APPDATA of standard user in Vista?<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th December 2006, 10:08</div></div><div class="posttext">Reading the registry value for HKCU should work. Doesn't it? Could you post the result of the script for each of the RequestExecutionLevel values?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>