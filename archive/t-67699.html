<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS 1.8b, needs testing and love, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS 1.8b, needs testing and love NSIS Discussion" />
	
	<title> NSIS 1.8b, needs testing and love [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS 1.8b, needs testing and love</div>
<hr />
<div class="pda"><a href="t-67699.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=67699">NSIS 1.8b, needs testing and love</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">justin</div><div class="date">5th December 2001, 04:50</div></div><div class="posttext">Hello all.. a couple of days ago I put together NSIS 1.8b, which consists primarily of a few architectural changes as well as some added features.<br />
<br />
These architectural changes let us be more flexible in calls and gotos. To be more specific, you can now get the address of a label or function, and call or goto that address. The address can be stored in a user variable, so you can now do things like callback functions. <br />
<br />
Anyway, I had to change a lot to make this possible, so things need a lot of testing. I've given it some, and all the obvious bugs have been removed, but any help or reassurance would be appreciated.<br />
<br />
I've also just updated it more with 1.8b2, which is on http://firehose.net/free/nsis/. 1.8b2 adds even more functionality relating to relative jumps, as well as getting the current code address.<br />
<br />
(edit) Also, I updated it so that labels beginning with a `.' are global. Fun.<br />
<br />
<br />
-Justin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DuaneJeffers</div><div class="date">5th December 2001, 09:10</div></div><div class="posttext">Holy Crap!!!!!!<br />
<br />
Awesome!!!!<br />
-Duane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndiG</div><div class="date">5th December 2001, 13:18</div></div><div class="posttext">Justin,<br />
<br />
I have a small backup installer that does nothing more than creating another installer script and building it.<br />
<br />
It would be nice if this &quot;generator&quot; installer could be output to $temp\gen.exe but trying something like that doesn't compile (at least in 1.7).<br />
<br />
If this can be fixed without bloating things it would be nice.<br />
<br />
Thanks, Andi</div></div><hr />


<div class="post"><div class="posttop"><div class="username">liquidmotion</div><div class="date">5th December 2001, 21:34</div></div><div class="posttext">suh-weet.<br />
<br />
now i guess i have to update slate blue...whahhhh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">justin</div><div class="date">5th December 2001, 22:35</div></div><div class="posttext">Originally posted by AndiG <br />
Justin,<br />
<br />
I have a small backup installer that does nothing more than creating another installer script and building it.<br />
<br />
It would be nice if this &quot;generator&quot; installer could be output to $temp\gen.exe but trying something like that doesn't compile (at least in 1.7).<br />
<br />
If this can be fixed without bloating things it would be nice.<br />
<br />
Thanks, Andi <br />
<br />
You could have the generating installer write the OutFile command to the script manually, ala:<br />
<br />
<br />
SetOutPath $INSTDIR<br />
File myfile.nsi<br />
FileOpen $R0 $INSTDIR\myfile.nsi a<br />
FileWrite $R0 &quot;$\r$\nOutFile $TEMP\gen.exe$\r$\n&quot;<br />
FileClose $R0<br />
ExecWait ...<br />
<br />
<br />
Get my drift? Or maybe I misunderstood you...<br />
<br />
-Justin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndiG</div><div class="date">6th December 2001, 07:29</div></div><div class="posttext">Slight misunderstanding: I'm not interested in the generating installer itself (it is writing the final one to a fiel as you assumed), that one should be build in the temp directory like:<br />
<br />
Name &quot;Find Files&quot;<br />
OutFile &quot;%temp%\Find Files.exe&quot;<br />
Caption &quot;Find Files&quot;<br />
<br />
&quot;Failed to obtain setup.exe from the script&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nels</div><div class="date">6th December 2001, 16:15</div></div><div class="posttext">It seems you forgot to add &quot;config.h&quot; in &quot;exehead\resource.h&quot; which is needed by the &quot;NSIS_CONFIG_XPSTYLE_SUPPORT&quot; stuff.<br />
<br />
Also in &quot;zlib\infutil.h&quot;, the definition of &quot;UPDIN&quot; is not accepted by gcc (again :D). It needs a cast for &quot;z-&gt;total_in+=p-(cast)z-&gt;next_in;&quot;. I didn't know which type you used, so change &quot;cast&quot; by what you need.<br />
<br />
At last, VC seems to reconstruct the &quot;exehead\resouce.rc&quot; because it deleted the windows.h include, the little tweaks for the windows and added &quot;afxres.h&quot; again (I really don't know why it adds this).<br />
<br />
Nels</div></div><hr />


<div class="post"><div class="posttop"><div class="username">FreeNsisTweaker</div><div class="date">6th December 2001, 18:56</div></div><div class="posttext">I've got an idea for a feature-change:<br />
Is it possible to make it so that the use can choose to create a uninstaller or not? Maybe the UninstallExeName can be included in a section, which the user can disable. This isn't possible yet and that's a pitty I think.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eccles</div><div class="date">7th December 2001, 22:17</div></div><div class="posttext">Effin ell Justin...  you've been busy!  Macros?  You'll be giving us classes next ;)<br />
<br />
It's handy being able to modify variables like $EXEDIR and $CMDLINE - will help simplify one of my functions..<br />
<br />
Bug - (in the uninstaller only) when finished, the progress bar has not reached 100%.<br />
<br />
Idea - Allow labels to be Called directly - sort of having local functions?<br />
<br />
-- <br />
Dave</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nels</div><div class="date">8th December 2001, 02:18</div></div><div class="posttext">I tried to compile NSIS 1.8b3 with -&gt; no problem ;)<br />
<br />
In fact, only one but it's more a windres issue : it defines WS_POPUP,  WS_BORDER and WS_SYSMENU by default, so it causes problem with the child windows. I'll contact the mingw (gcc for win32) team to discuss this.<br />
<br />
I attached the gcc Makefiles if somebody wants to try it. These are my first makefiles so please be cool with me :D<br />
<br />
Nels</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nels</div><div class="date">8th December 2001, 02:20</div></div><div class="posttext">Here are the makefiles</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nels</div><div class="date">8th December 2001, 02:45</div></div><div class="posttext">Sorry, it's me again.<br />
Forget about the windres issue. It's now corrected (in binutils 2.11.92). It means that NSIS compiles with gcc with NO problem ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">justin</div><div class="date">8th December 2001, 02:58</div></div><div class="posttext">Heh try them with nsis 1.8b4 :)<br />
<br />
Cool.. These makefiles don't work for me (some weird error with make), maybe I'm using too old of a cygwin/ming... My make version is 3.77. The error I get is <br />
<br />
', needed by `all'.  Stop.target `exehead<br />
<br />
<br />
Strange. Anyway, mind if I distro these makefiles (once they seem to work) in the distro? :)<br />
<br />
-Justin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nels</div><div class="date">8th December 2001, 03:14</div></div><div class="posttext">I used make 3.79 which is included in the main package.<br />
<br />
Here is a small howto:<br />
1/ Go to http://sourceforge.net/projects/mingw and download 'MinGW-[version].tar.gz' (actual version is 1.1, here is the direct link http://prdownloads.sourceforge.net/mingw/MinGW-1.1.tar.gz).<br />
2/ Decompress the downloaded file where you want.<br />
3/ Add the [install_dir]\bin in you path.<br />
4/ Go to the NSIS source directory.<br />
5/ Type 'make'.<br />
6/ You now have you 'makensis.exe'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">justin</div><div class="date">8th December 2001, 09:14</div></div><div class="posttext">Cool, after getting mingw32 (I was using stock cygwin before), and updating to the latest binutils, it works. :) I tuned the makefile a bit, too, but we're still at 49kb with gcc vs. 34kb with vc++. Maybe I can find a way of merging the .bss section with the .data section like VC++ does, and save another few kb. If that. Anyway, here are my update makefiles. Nels, can I distribute them with 1.80? :)<br />
<br />
-Justin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">crish</div><div class="date">8th December 2001, 10:28</div></div><div class="posttext">i get the following error on uninstall with 1.8b<br />
<br />
install corrupted : invalid opcode<br />
<br />
(uninstall code was ok in 1.6x)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">8th December 2001, 10:37</div></div><div class="posttext">crish, are you using the new WriteUninstaller command? Because the old UninstallExeName was 'superceded'. No idea what that word exactly means, but things have changed :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">F. Heidenreich</div><div class="date">8th December 2001, 10:59</div></div><div class="posttext">I get the 'install corrupted : invalid opcode' error too, on uninstalling NSIS 1.8b2.<br />
Koen, notice that this error occurs on uninstall, not on compiling the script.<br />
But with 1.8b3 all went fine :)<br />
<br />
~ Florian</div></div><hr />


<div class="post"><div class="posttop"><div class="username">crish</div><div class="date">8th December 2001, 11:11</div></div><div class="posttext">i get the same error on the example2 script<br />
<br />
on the nsis site, i found that its ok since b2<br />
<br />
but i will try the b3</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nels</div><div class="date">8th December 2001, 11:26</div></div><div class="posttext">Originally posted by justin <br />
Cool, after getting mingw32 (I was using stock cygwin before), and updating to the latest binutils, it works. :) I tuned the makefile a bit, too, but we're still at 49kb with gcc vs. 34kb with vc++. Maybe I can find a way of merging the .bss section with the .data section like VC++ does, and save another few kb. If that. Anyway, here are my update makefiles. Nels, can I distribute them with 1.80? :)<br />
<br />
-Justin <br />
<br />
Of course you can include them, that's why I sent them ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pjw62</div><div class="date">8th December 2001, 19:46</div></div><div class="posttext">Originally posted by justin <br />
Cool, after getting mingw32 (I was using stock cygwin before), and updating to the latest binutils, it works. :) I tuned the makefile a bit, too, but we're still at 49kb with gcc vs. 34kb with vc++. Maybe I can find a way of merging the .bss section with the .data section like VC++ does, and save another few kb. If that. Anyway, here are my update makefiles. Nels, can I distribute them with 1.80? :)<br />
<br />
-Justin <br />
<br />
just out of interest, you can get exactly midway with Borland's compiler - 41.5kb..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th December 2001, 21:29</div></div><div class="posttext">1.80 can now be found at firehose.net :)<br />
<br />
http://www.firehose.net/free/nsis</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">11th December 2001, 19:17</div></div><div class="posttext">Justin,<br />
<br />
two problems have been found in NSIS version 1.80<br />
please take a look at:<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=68347 <br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=68242<br />
<br />
thx, greetz, Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th December 2001, 19:54</div></div><div class="posttext">And this one http://forums.winamp.com/showthread.php?s=&amp;threadid=68275</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>