<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstalling runtime without adding it twice, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstalling runtime without adding it twice NSIS Discussion" />
	
	<title> Uninstalling runtime without adding it twice [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstalling runtime without adding it twice</div>
<hr />
<div class="pda"><a href="t-260552.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=260552">Uninstalling runtime without adding it twice</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jaredsullivan</div><div class="date">28th November 2006, 02:13</div></div><div class="posttext">Hi,<br />
<br />
I would like to do the following <br />
<br />
[install section]<br />
dotnetfx3.exe /q<br />
<br />
[uninstall section]<br />
dotnetfx3.exe /q /uninstall<br />
<br />
But, NSIS seems to add the file twice.  Turns a 50MB install into a 100MB install.<br />
<br />
Thanks<br />
Jared</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">28th November 2006, 04:20</div></div><div class="posttext">Hi Jared!<br />
<br />
NSIS adds the dotnetfx3.exe to your installer and to your uninstaller.<br />
<br />
I think you could avoid adding the dotnetfx3.exe to your uninstaller by invoking the uninstaller of the .NET installation.<br />
<br />
I can't tell you how it looks like because I haven't got a Windows installation but have a look in the registry. You'll certainly find something like <br />
<br />
msiexec.exe /uninstall {productcode}<br />
<br />
in there. <br />
<br />
Then use ExecWait to wait to finish the uninstall.<br />
<br />
You'll find a lot of parameters to tweak the behaviour of the Windows Installer.<br />
<br />
http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/standard_installer_command_line_options.asp<br />
<br />
(Registry key: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall...)<br />
<br />
Have a nice day!<br />
<br />
Cheers<br />
<br />
Bruno</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">29th November 2006, 11:26</div></div><div class="posttext">This would be another idea:<br />
<br />
http://nsis.sourceforge.net/CombinedUnInstaller</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>