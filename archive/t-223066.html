<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Registry plugin, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Registry plugin NSIS Discussion" />
	
	<title> Registry plugin [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Registry plugin</div>
<hr />
<div class="pda"><a href="t-223066.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=223066">Registry plugin</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">1st August 2005, 11:25</div></div><div class="posttext">Features:<br />
<br />
- Powerful registry search:<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-fast algorithm<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-principle of turn in stack (first in -&gt; last out)<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;  i.e. search from first registry key to last<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-search for key, value and/or string in any root<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-search with name and/or type<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-search with banner support<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;-search with subkeys or not<br />
- Read value of any type<br />
- Write value of any type<br />
- Create key<br />
- Delete key&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; (same as DeleteRegKey)<br />
- Delete value&amp;nbsp;&amp;nbsp;&amp;nbsp;  (same as DeleteRegValue)<br />
<br />
<br />
Some performance info:<br />
<br />
Search in all HKEY_LOCAL_MACHINE where 60351 keys, 84714 values, 84714 strings<br />
<br />
Search only NOT existed value:&amp;nbsp;&amp;nbsp;&amp;nbsp; (/K=0 /V=1 /S=0 /N=`#Not Existed#`)<br />
&amp;nbsp;&amp;nbsp;With /B=0: 0 min 9 sec 580 ms<br />
&amp;nbsp;&amp;nbsp;With /B=1: 0 min 16 sec 300 ms<br />
&amp;nbsp;&amp;nbsp;With /B=2: 1 min 19 sec 486 ms<br />
<br />
Search any keys, values, strings:&amp;nbsp; (/K=1 /V=1 /S=1 /N=``)<br />
&amp;nbsp;&amp;nbsp;With /B=0: 2 min 46 sec 664 ms<br />
&amp;nbsp;&amp;nbsp;With /B=1: 2 min 56 sec 974 ms<br />
&amp;nbsp;&amp;nbsp;With /B=2: 6 min 2 sec 668 ms</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">2nd August 2005, 00:00</div></div><div class="posttext">Hey Instructor, nice work.<br />
<br />
I had started experimenting doing something similiar with the system plugin.  But yours looks much better!<br />
<br />
Any chance you'll be adding support to import/export REG files?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">2nd August 2005, 09:17</div></div><div class="posttext">Hi, Comperio.<br />
<br />
Import/export simply doing with API RegSaveKey, RegRestoreKey and RegReplaceKey, BUT:<br />
<br />
<br />
[MSDN]<br />
Remarks<br />
<br />
There are two different registry hive file formats. Registry hives created on current operating systems typically cannot be loaded by earlier ones.<br />
<br />
<br />
RegRestoreKey<br />
<br />
[MSDN]<br />
Requirements<br />
  Windows NT/2000/XP: Included in Windows NT 3.1 and later. <br />
  Windows 95/98/Me: Unsupported. <br />
  Header: Declared in Winreg.h; include Windows.h. <br />
  Library: Use Advapi32.lib. <br />
  Unicode: Implemented as Unicode and ANSI versions.<br />
<br />
<br />
So, probably there is only way to save multi-OS compatibility - write manually REG parser. I'll think that I can do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">4th August 2005, 05:26</div></div><div class="posttext">hmmm. I see your point.  But, if you can do it, I think importing/exporting REG files would be a very cool feature.<br />
<br />
And something you might consider:<br />
Most of the time, (at least for me anyway), reg files would be used as a means to backup and restore on the same system.  So I don't think it's too important that a reg file created on a 9x computer is compatible with a XP computer.  (Personally, if I were going to import reg files as part of an install, then I'd probably have 2 files--one for XP and  one for 2K).<br />
<br />
But that's just me... Someone else may have a different view...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">4th August 2005, 20:12</div></div><div class="posttext">http://forums.winamp.com/showthread.php?s=&amp;threadid=223376</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">5th August 2005, 18:19</div></div><div class="posttext">Changes:<br />
-Merged with REGEDIT4 plugin, probably this will be more comfortable for user.<br />
&amp;nbsp;Increase plugin size to 13Kb, but you can simply recompile it, only with functions you need (see defines at the beginning of registry.c).<br />
<br />
-Fixed: registry::DeleteKey in NT systems didn't delete subkeys<br />
<br />
-Fixed: problem with compiling &quot;RegistryTest.nsi&quot; when nxs (http://nsis.sourceforge.net/wiki/Banner_with_Cancel_button) plugin isn't exist<br />
<br />
-Now registry::RestoreKey checks if file exist<br />
<br />
<br />
&quot;Registry&quot; plugin v1.1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">18th August 2005, 00:23</div></div><div class="posttext">Changes:<br />
-Fixed: Double calling GlobalFree in some case, that can cause crash<br />
 (registry::Find, registry::Close)<br />
<br />
-Fixed: REG_RESOURCE_LIST, REG_NONE readed as string, instead of binary<br />
 (registry::Find, registry::Read)<br />
<br />
-Added: Converts string to hex values<br />
 (registry::StrToHex)<br />
<br />
-Added: Converts hex values to string<br />
 (registry::HexToStr)<br />
<br />
-Full registry value types support, added:<br />
REG_FULL_RESOURCE_DESCRIPTOR<br />
REG_RESOURCE_REQUIREMENTS_LIST<br />
REG_QWORD<br />
<br />
<br />
BTW:<br />
While testing plugin in Microsoft XP I was found errors in REGEDIT with /a switch:<br />
-National characters incorrect exports from registry in hex format<br />
 (first hex digit: c-&gt;1 d-&gt;2 e-&gt;3 f-&gt;4)<br />
-Special escape sequence &quot;\n&quot; is not replaced with &quot;\\n&quot;<br />
<br />
<br />
&quot;Registry&quot; plugin v1.2</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">18th August 2005, 14:16</div></div><div class="posttext">Short question cause urgent<br />
<br />
can i find all entries &quot;defaulticon&quot; with it ?<br />
And can i export them ?<br />
<br />
###<br />
well that works, but i have empty entries<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.nsc\DefaultIcon]<br />
@=''<br />
it has to be<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.nsc\DefaultIcon]<br />
@=&quot;dxmasf.dll,-502&quot;<br />
<br />
not all are empty<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Scripting Host\Script Extensions\.JS\DefaultIcon]<br />
@='%SystemRoot%\System32\wscript.exe,3'<br />
<br />
<br />
Name &quot;DefaultIcon&quot;<br />
OutFile &quot;DefaultIcon.exe&quot;<br />
<br />
Section <br />
SectionEnd<br />
<br />
Function .onInit<br />
  IfFileExists &quot;DefaultIcon.reg&quot; 0 noreg<br />
    Delete DefaultIcon.reg<br />
  noreg:<br />
<br />
  FileOpen $R1 &quot;DefaultIcon.reg&quot; w<br />
  FileWrite $R1 &quot;REGEDIT4&quot;<br />
  FileWriteByte $R1 &quot;13&quot;<br />
  FileWriteByte $R1 &quot;10&quot;<br />
  FileWriteByte $R1 &quot;13&quot;<br />
  FileWriteByte $R1 &quot;10&quot;<br />
<br />
  registry::Open /NOUNLOAD &quot;HKEY_LOCAL_MACHINE&quot; &quot;/K=1 /V=1 /S=1 /B=1 /N='DefaultIcon'&quot; .r0<br />
  StrCmp $0 -1 end<br />
<br />
  loop:<br />
    registry::Find /NOUNLOAD .r1 .r2 .r3 .r4<br />
    IfErrors end<br />
    StrCmp $1 &quot;&quot; end<br />
    StrCmp $2 &quot;&quot; end<br />
    ;StrCmp $3 &quot;&quot; loop<br />
    ;StrCmp $4 &quot;&quot; loop<br />
<br />
    FileWrite $R1 &quot;[HKEY_LOCAL_MACHINE\$1\$2]&quot;<br />
    FileWriteByte $R1 &quot;13&quot;<br />
    FileWriteByte $R1 &quot;10&quot;<br />
    FileWrite $R1 &quot;@='$3'&quot;<br />
    FileWriteByte $R1 &quot;13&quot;<br />
    FileWriteByte $R1 &quot;10&quot;<br />
    FileWriteByte $R1 &quot;13&quot;<br />
    FileWriteByte $R1 &quot;10&quot;<br />
<br />
  Goto loop<br />
<br />
  end:<br />
  registry::Close<br />
<br />
FileClose $R1<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">18th August 2005, 15:13</div></div><div class="posttext">Ok, i did it this way..<br />
<br />
Name &quot;DefaultIcon&quot;<br />
OutFile &quot;DefaultIcon.exe&quot;<br />
AutoCloseWindow true<br />
<br />
Section <br />
SectionEnd<br />
<br />
Function .onInit<br />
  IfFileExists &quot;DefaultIcon.reg&quot; 0 noreg<br />
    Delete DefaultIcon.reg<br />
  noreg:<br />
<br />
  FileOpen $R1 &quot;DefaultIcon.reg&quot; w<br />
  FileWrite $R1 &quot;REGEDIT4&quot;<br />
  FileWriteByte $R1 &quot;13&quot;<br />
  FileWriteByte $R1 &quot;10&quot;<br />
  FileWriteByte $R1 &quot;13&quot;<br />
  FileWriteByte $R1 &quot;10&quot;<br />
<br />
  registry::Open /NOUNLOAD &quot;HKEY_LOCAL_MACHINE&quot; &quot;/K=1 /V=1 /S=1 /B=1 /N='DefaultIcon'&quot; .r0<br />
  StrCmp $0 -1 end<br />
<br />
  loop:<br />
    registry::Find /NOUNLOAD .r1 .r2 .r3 .r4<br />
    IfErrors end<br />
    StrCmp $1 &quot;&quot; end<br />
    StrCmp $2 &quot;&quot; end<br />
    ;StrCmp $3 &quot;&quot; loop<br />
    ;StrCmp $4 &quot;&quot; loop<br />
<br />
    ReadRegStr $R2 HKLM &quot;$1\$2&quot; &quot;&quot;<br />
<br />
    ;MessageBox MB_OKCANCEL &quot;'$1\$2'$\n'$R2'$\n'$3''&quot; IDCANCEL end<br />
<br />
    FileWrite $R1 &quot;[HKEY_LOCAL_MACHINE\$1\$2]&quot;<br />
    FileWriteByte $R1 &quot;13&quot;<br />
    FileWriteByte $R1 &quot;10&quot;<br />
<br />
    StrCmp $3 &quot;&quot; write_reg1<br />
      FileWrite $R1 &quot;@='$3'&quot;<br />
      Goto write_reg2<br />
    write_reg1:<br />
      FileWrite $R1 &quot;@='$R2'&quot;<br />
    write_reg2:<br />
    FileWriteByte $R1 &quot;13&quot;<br />
    FileWriteByte $R1 &quot;10&quot;<br />
    FileWriteByte $R1 &quot;13&quot;<br />
    FileWriteByte $R1 &quot;10&quot;<br />
<br />
  Goto loop<br />
<br />
  end:<br />
  registry::Close<br />
<br />
FileClose $R1<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">18th August 2005, 17:23</div></div><div class="posttext">well that works, but i have empty entriesThis because &quot;DefaultIcon&quot; it is key (REG_KEY) and when key is found value and string are empty.<br />
not all are emptyDo you use v1.2? In previos versions in NT systems strings not always updated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">19th August 2005, 12:33</div></div><div class="posttext">Changes:<br />
-Fixed: Cross-calling functions. Now posible for example:<br />
&amp;nbsp;&amp;nbsp;registry::Open /NOUNLOAD ...<br />
&amp;nbsp;&amp;nbsp;registry::Find /NOUNLOAD ...<br />
&amp;nbsp;&amp;nbsp;registry::Read /NOUNLOAD ...<br />
&amp;nbsp;&amp;nbsp;registry::Write /NOUNLOAD ...<br />
&amp;nbsp;&amp;nbsp;registry::Close<br />
<br />
-Fixed: registry::Read, when reading not existed value, returns &quot;INVALID&quot; registry type instead of &quot;&quot; (all output variables must be empty)<br />
<br />
-Fixed: REG_LINK readed as string instead of binary<br />
<br />
-Now posible to find default values (any type) or/and empty strings (REG_SZ, REG_EXPAND_SZ). Options with /N=&quot;&quot; searches for empty names and without /N= for all names<br />
<br />
<br />
&quot;Registry&quot; plugin v1.3</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">19th August 2005, 23:22</div></div><div class="posttext">well - see - &quot;defaulticon&quot; can be in the path<br />
[...\DefaultIcon]<br />
and as an entry.<br />
&quot;DefaultIcon&quot;=<br />
<br />
And the example below has it both in the path...<br />
but only one of it is read out<br />
<br />
yes, was 1.2 and 1.3 shows same behaviour.<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.nsc\DefaultIcon]<br />
@=''[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Scripting Host\Script Extensions\.JS\DefaultIcon]<br />
@='%SystemRoot%\System32\wscript.exe,3'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">19th August 2005, 23:50</div></div><div class="posttext">Try &quot;Search and write founded in text file&quot; example in RegistryTest.nsi with your registry::Open parameters and check output file.<br />
<br />
<br />
I have tested it with options you wrote before [&quot;HKEY_LOCAL_MACHINE&quot; &quot;/K=1 /V=1 /S=1 /B=1 /N='DefaultIcon'&quot;] and all fine.<br />
<br />
<br />
<br />
Tested on XP and all fine. Founded &quot;.JS&quot; key, &quot;DefaultIcon&quot; is value - check your script:<br />
<br />
REG_SZ:&quot;SOFTWARE\Microsoft\Windows Scripting Host\Script Extensions\.JS&quot; &quot;DefaultIcon&quot;=&quot;%SystemRoot%\System32\wscript.exe,3&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">21st August 2005, 04:14</div></div><div class="posttext">its not &quot;JS&quot;-problem, its here<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.nsc\DefaultIcon]<br />
@=''<br />
has to be<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.nsc\DefaultIcon]<br />
@=&quot;dxmasf.dll,-502&quot;<br />
on some reason it is empty - try the first script above and test it pls (not the second)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">21st August 2005, 07:37</div></div><div class="posttext">Why you didn't test &quot;Search and write founded in text file&quot;? With it no problem there is something in your script. Like I said before if you find registry key then string is EMPTY, registry::Find can't find registry key and they default string at the same time. You need to read it.<br />
Try this:<br />
<br />
Name &quot;DefaultIcon&quot;<br />
OutFile &quot;DefaultIcon.exe&quot;<br />
AutoCloseWindow true<br />
<br />
!include &quot;WordFunc.nsh&quot;<br />
!insertmacro WordReplace<br />
<br />
Section<br />
	StrCpy $R0 HKEY_LOCAL_MACHINE<br />
	FileOpen $R1 &quot;DefaultIcon.reg&quot; w<br />
	FileWrite $R1 &quot;REGEDIT4$\r$\n$\r$\n&quot;<br />
<br />
	registry::Open /NOUNLOAD &quot;$R0&quot; &quot;/K=1 /V=0 /S=0 /B=1 /N='DefaultIcon'&quot; .r0<br />
	StrCmp $0 -1 end<br />
<br />
	loop:<br />
	registry::Find /NOUNLOAD .r0 .r1 .r2 .r3<br />
	StrCmp $3 &quot;&quot; end<br />
<br />
	registry::Read /NOUNLOAD &quot;$R0\$0\$1&quot; &quot;&quot; .r4 .r5 .r6 .r7<br />
	StrCmp $6 &quot;&quot; loop<br />
<br />
	${WordReplace} &quot;$6&quot; &quot;\&quot; &quot;\\&quot; &quot;+&quot; $6<br />
	${WordReplace} &quot;$6&quot; '&quot;' '\&quot;' &quot;+&quot; $6<br />
	FileWrite $R1 '[$R0\$0\$1]$\r$\n'<br />
	FileWrite $R1 '@=&quot;$6&quot;$\r$\n$\r$\n'<br />
	Goto loop<br />
<br />
	end:<br />
	registry::Close<br />
	FileClose $R1<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">21st August 2005, 12:02</div></div><div class="posttext">You dit not realize that your find-routine sometimes <br />
returnes a value and sometimes not on same condition...<br />
<br />
i search all<br />
/K=1  - Search Keys (default)<br />
/V=1  - Search Values (default)<br />
/S=1  - Search Strings (default)<br />
<br />
so if it returnes all values 3 cant be emtpy<br />
<br />
.r1  - $1=&quot;path&quot;<br />
.r2  - $2=&quot;value&quot; or &quot;key&quot;<br />
.r3  - $3=&quot;string&quot;<br />
.r4  - $4=&quot;TYPE&quot;<br />
<br />
but the string is empty, however<br />
<br />
please work on that</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">21st August 2005, 12:21</div></div><div class="posttext">Brummelchen attach &quot;DefaultIcon.reg&quot; with my previos post or generated file &quot;Search and write founded in text file&quot;. Now I don't realy understand what you want :(<br />
<br />
PS<br />
I'll say again: if $4=&quot;REG_KEY&quot; then $3=&quot;&quot; this is by design!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">21st August 2005, 23:39</div></div><div class="posttext">This because &quot;DefaultIcon&quot; it is key (REG_KEY) and <br />
when key is found value and string are empty.<br />
<br />
And thats what i say - it does not make any sense...<br />
.. to get the key and not its value although it can be performed.<br />
<br />
###<br />
<br />
ok, let's see...<br />
[path] ist without my search string ???<br />
[value] or [key] is somehow what ?<br />
<br />
eg HKLM [path\key}<br />
[string]=<br />
<br />
???<br />
<br />
dont make either any sense to me... :/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">22nd August 2005, 07:38</div></div><div class="posttext">Honestly, I'm not like to talk with people which listen only itself. Of course its not about you, Brummelchen.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">22nd August 2005, 19:56</div></div><div class="posttext">its not personal but you dont get this point<br />
<br />
script + result<br />
<br />
and as you can see your function mostly returns nothing and in some cases its value.<br />
[path]<br />
[key]=[value]<br />
<br />
thats the combination...<br />
<br />
maybe your point of view is from the applikation - mine is from the registry.<br />
<br />
Name &quot;DefaultIcon&quot;<br />
OutFile &quot;DefaultIcon.exe&quot;<br />
<br />
Section<br />
SectionEnd<br />
<br />
Function .onInit<br />
  IfFileExists &quot;DefaultIcon.reg&quot; 0 noreg<br />
    Delete DefaultIcon.reg<br />
  noreg:<br />
<br />
  FileOpen $R1 &quot;DefaultIcon.reg&quot; w<br />
  FileWrite $R1 &quot;REGEDIT4&quot;<br />
  FileWriteByte $R1 &quot;13&quot;<br />
  FileWriteByte $R1 &quot;10&quot;<br />
  FileWriteByte $R1 &quot;13&quot;<br />
  FileWriteByte $R1 &quot;10&quot;<br />
<br />
  registry::Open /NOUNLOAD &quot;HKEY_LOCAL_MACHINE&quot; &quot;/K=1 /V=1 /S=1 /B=1 /N='DefaultIcon'&quot; .r0<br />
  StrCmp $0 -1 end<br />
<br />
  loop:<br />
    registry::Find /NOUNLOAD .r1 .r2 .r3 .r4<br />
    IfErrors end<br />
    StrCmp $1 &quot;&quot; end<br />
    StrCmp $2 &quot;&quot; end<br />
    ;StrCmp $3 &quot;&quot; loop<br />
    ;StrCmp $4 &quot;&quot; loop<br />
<br />
    FileWrite $R1 &quot;[HKEY_LOCAL_MACHINE\$1\$2]&quot;<br />
    FileWriteByte $R1 &quot;13&quot;<br />
    FileWriteByte $R1 &quot;10&quot;<br />
    FileWrite $R1 &quot;@='$3'&quot;<br />
    FileWriteByte $R1 &quot;13&quot;<br />
    FileWriteByte $R1 &quot;10&quot;<br />
    FileWriteByte $R1 &quot;13&quot;<br />
    FileWriteByte $R1 &quot;10&quot;<br />
<br />
  Goto loop<br />
<br />
  end:<br />
  registry::Close<br />
<br />
FileClose $R1<br />
FunctionEnd<br />
Result<br />
REGEDIT4<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.nsc\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.tico\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ACDSee.AIS\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ACLFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\acwfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Agent.Character.2\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Agent.Character2.2\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AIFFFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\anifile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\appfixfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ASFFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ASXFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\atpr\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AudioCD\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AUFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AVIFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AWFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\batfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Briefcase\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CATFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\cdafile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CERFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\certificate_wab_auto_file\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ChannelFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ChannelShortcut\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ChatFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\chm.file\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\clpfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\cmdfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\comfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CRLFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CSSfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\curfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\dbfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Directory\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\dllfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\DocShortcut\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\dqyfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Dreamweaver.Template\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Drive\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\dunfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\DVD\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ELMFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\emffile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Excel.Addin\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Excel.Backup\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Excel.Chart.8\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Excel.CSV\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Excel.Dialog\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Excel.DIF\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Excel.Macrosheet\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Excel.Sheet.8\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Excel.SLK\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Excel.Template\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Excel.VBAModule\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Excel.Workspace\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Excel.XLL\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Excelhtmlfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Excelhtmltemplate\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\excelmhtmlfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Excelxmlss\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\exefile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\FFAFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\FFLFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\FFTFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\FFXFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\fndfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Folder\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\fonfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\FoxitReader.Document\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ftp\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\giffile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\gopher\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\hlpfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\hlsw\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\HLSW Server List\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\htafile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\htfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\htmlfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\HTTfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\HTTP\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\https\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\iclfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\icmfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\icofile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\IDApro.Database32\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\inffile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\inifile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\InternetShortcut\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\iqyfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\irc\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ITS FILE\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\IVFfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\jpegfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\JSEFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\JSFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\LEXFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\LWVFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\m3ufile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Macromedia.DesignNotes\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\MacromediaFlashPaper.MacromediaFlashPaper\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\mailto\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\MaxthonSkin\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\MediaCatalogMGC\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\MediaCatalogMML\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\MediaCatalogMMW\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\MediaPackageFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\mhtmlfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Microsoft Internet Mail Message\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Microsoft Internet News Message\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\MIDFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\MMS\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\MMST\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\MMSU\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\mp3file\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\mpegfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\MPlayer\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\msbackupfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\MSBD\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\MSCFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\MSDASC\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\MSDASQL\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Msi.Package\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Msi.Patch\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\MSInfo.Document\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\MsRcIncident\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\msstylesfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NBBACKUPType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NBCOMPRESSType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NBJOBType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Nero Cover Designer.Document\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Nero Cover Designer.Template\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroAACType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroAudioType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroCDCoverType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroCDExtraType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroCDROMBootType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroCDROMEFIBootType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroCDROMHybridType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroCDROMType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroCopyType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroCueSheetType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroDVDVideoType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroErrorType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroHDBackupType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroHDBVideoType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroHFSType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroImageType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NerominiDVDType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroMixedModeType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroMP3Type\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroSuperVideoType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroUDFISOType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroUDFType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroVideoType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NeroWMAType\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\news\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\nntp\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NSIS.Header\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\NSIS.Script\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ODBC.FileDSN\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\odccubefile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\odcdatabasefile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ODCfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\odcnewfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\odctablefile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\OPCFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\oqyfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\otffile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\P7RFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\pbkfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\pfmfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\PFXFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\PingPlotter.SaveFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\PIPFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\pjpegfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\pnffile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\pngfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\prffile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ratfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\RDP.File\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\regfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\rlogin\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\rnkfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\rqyfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\rtffile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\SafeFiles.1\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\SavedDsQuery\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\scriptletfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ShellScrap\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ShockwaveFlash.ShockwaveFlash\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\snews\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\SoundRec\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\SPCFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\spsfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\STFFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\STLFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\telnet\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\themefile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\tibfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\TIFImage.Document\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\tisfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\tn3270\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Trust.PolicyPackage\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Trust.PolicyPackage.1\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ttcfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ttffile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\TuneUp.Utilities.2004.Unlock.Code\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\TuneUp.Utilities.2006.Unlock.Code\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\txtfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\unreal\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Unreal.Link\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Unreal.Map\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Unreal.Module\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ut2004\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\UT2004.Link\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\UT2004.Map\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\UT2004.Module\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\UXDCFILE\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\VBEFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\VBSFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\vcard_wab_auto_file\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\wab_auto_file\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WAXFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\webpnpFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Winamp.Playlist\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Winamp.SkinZip\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WinImage\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WinImageIso\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WinRAR\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WinRAR.7Z\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WinRAR.ACE\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WinRAR.REV\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WinRAR.XPI\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WinRAR.ZIP\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\wmafile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WMDFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\wmffile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WMP.DVR-MSFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WMP.WMDBFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WMSFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WMVFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WMZFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Word.Backup.8\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Word.Document.8\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Word.RTF.8\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Word.Template.8\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Word.Wizard.8\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\wordhtmlfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\wordhtmltemplate\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\wordmhtmlfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Wordpad.Document.1\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\wordxmlfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WPLFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\wrifile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WSFFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WSHFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\WVXFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\x-internet-signup\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\xbmfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\XEV.FailSafeApp\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\XEV.GenericApp\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\XEV.OriginalApp\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\xmlfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\xslfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\zapfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ZPAVIFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ZPMPEGFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ZPMPGFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ZPWMAFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ZPWMVFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ZPZPLFile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Applications\wmplayer.exe\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{00020803-0000-0000-C000-000000000046}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{00020810-0000-0000-C000-000000000046}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{00020811-0000-0000-C000-000000000046}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{00020820-0000-0000-C000-000000000046}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{00020821-0000-0000-C000-000000000046}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{00020900-0000-0000-C000-000000000046}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{00020901-0000-0000-C000-000000000046}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{00020906-0000-0000-C000-000000000046}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{00020907-0000-0000-C000-000000000046}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{00022601-0000-0000-C000-000000000046}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{00022602-0000-0000-C000-000000000046}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{00022603-0000-0000-C000-000000000046}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{0002CE02-0000-0000-C000-000000000046}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{00030000-0000-0000-C000-000000000046}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{00030001-0000-0000-C000-000000000046}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{00030002-0000-0000-C000-000000000046}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{008FD5DD-6DBB-48e3-991B-2D3ED658516A}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{0CD7A5C0-9F37-11CE-AE65-08002B2E1262}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{0DF44EAA-FF21-4412-828E-260A8728E7F1}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{148BD520-A2AB-11CE-B11F-00AA00530503}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{148BD52A-A2AB-11CE-B11F-00AA00530503}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{14E8BBD8-1D1C-4D56-A4DA-D20B75EB814E}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{1CDB2949-8F65-4355-8456-263E7C208A5D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{1f4de370-d627-11d1-ba4f-00a0c91eedba}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{208D2C60-3AEA-1069-A2D7-08002B30309D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{21EC2020-3AEA-1069-A2DD-08002B30309D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{2227A280-3AEA-1069-A2DE-08002B30309D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{233A9692-667E-11d1-9DFB-006097D50408}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{233A9694-667E-11d1-9DFB-006097D50408}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{25336920-03F9-11CF-8FD0-00AA00686F13}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{2559a1f0-21d7-11d4-bdaf-00c04f60b9f0}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{2559a1f1-21d7-11d4-bdaf-00c04f60b9f0}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{2559a1f2-21d7-11d4-bdaf-00c04f60b9f0}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{2559a1f3-21d7-11d4-bdaf-00c04f60b9f0}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{2559a1f4-21d7-11d4-bdaf-00c04f60b9f0}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{2559a1f5-21d7-11d4-bdaf-00c04f60b9f0}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{2559a1f7-21d7-11d4-bdaf-00c04f60b9f0}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{2728520d-1ec8-4c68-a551-316b684c4ea7}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{2E17C0EF-2851-459b-A3C8-27A41D4BC9F7}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{3050F3D9-98B5-11CF-BB82-00AA00BDCE0B}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{3050f4d8-98B5-11CF-BB82-00AA00BDCE0B}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{30D02401-6A81-11d0-8274-00C04FD5AE38}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{3c5c43a3-9ce9-4a9b-9699-2ac0cf6cc4bf}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{3DAB30ED-8132-40bf-A8BA-7B5057F0CD10}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{450D8FBA-AD25-11D0-98A8-0800361B1103}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{46E31370-3F7A-11CE-BED6-00AA00611080}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{48123bc4-99d9-11d1-a6b3-00c04fd91555}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{4C599241-6926-101B-9992-00000B65C6F9}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{4c892621-6757-4fe0-ad8c-a6301be7fba2}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{5512D110-5CC6-11CF-8D67-00AA00BDCE1D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{5512D112-5CC6-11CF-8D67-00AA00BDCE1D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{5512D114-5CC6-11CF-8D67-00AA00BDCE1D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{5512D116-5CC6-11CF-8D67-00AA00BDCE1D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{5512D118-5CC6-11CF-8D67-00AA00BDCE1D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{5512D11A-5CC6-11CF-8D67-00AA00BDCE1D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{5512D11C-5CC6-11CF-8D67-00AA00BDCE1D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{5512D11E-5CC6-11CF-8D67-00AA00BDCE1D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{5512D122-5CC6-11CF-8D67-00AA00BDCE1D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{5512D124-5CC6-11CF-8D67-00AA00BDCE1D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{56197BB9-FBA0-4CFB-802B-129A9674D7C1}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{5a3d988e-820d-4aaf-ba87-440081768a17}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{5A79987F-5D0A-425C-B70D-E49AD5B6BF23}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{5ef4af3a-f726-11d0-b8a2-00c04fc309a4}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{63da6ec0-2e98-11cf-8d82-444553540000}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{65014010-9F62-11d1-A651-00600811D5CE}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{67cf8cbd-e5c0-44f7-9de5-e1d599d626d8}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{692F0339-CBAA-47e6-B5B5-3B84DB604E87}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{6DFD7C5C-2451-11d3-A299-00C04F8EF6AF}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{6E182020-F460-11CE-9BCD-00AA00608E01}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{7007ACC7-3202-11D1-AAD2-00805FC1270E}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{7325c922-bb81-47b0-8b2f-a5f8605e242f}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{73FDDC80-AEA9-101A-98A7-00AA00374959}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{750fdf0f-2a26-11d1-a3ea-080036587f03}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{79176FB0-B7F2-11CE-97EF-00AA006D2776}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{7A9D77BD-5403-11d2-8785-2E0420524153}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{7BD29E00-76C1-11CF-9DD0-00A0C9034933}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{7CBCC347-0EDA-40D1-B30B-ECB5BD6C8E11}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{8369AB20-56C9-11D0-94E8-00AA0059CE02}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{85BBD920-42A0-1069-A2E4-08002B30309D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{871C5380-42A0-1069-A2EA-08002B30309D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{88C6C381-2E85-11D0-94DE-444553540000}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{8BD21D10-EC42-11CE-9E0D-00AA006002F3}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{8BD21D20-EC42-11CE-9E0D-00AA006002F3}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{8BD21D30-EC42-11CE-9E0D-00AA006002F3}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{8BD21D40-EC42-11CE-9E0D-00AA006002F3}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{8BD21D50-EC42-11CE-9E0D-00AA006002F3}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{8BD21D60-EC42-11CE-9E0D-00AA006002F3}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{8E6E6079-0CB7-11d2-8F10-0000F87ABD16}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{978C9E23-D4B0-11CE-BF2D-00AA003F40D0}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{992CFFA0-F557-101A-88EC-00DD010CCC48}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{9B0EFD60-F7B0-11D0-BAEF-00C04FC308C9}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{9DB7A13C-F208-4981-8353-73CC61AE2783}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{9E56BE60-C50F-11CF-9A2C-00A0C90A90CE}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{9E56BE61-C50F-11CF-9A2C-00A0C90A90CE}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{A9B48EAC-3ED8-11d2-8216-00C04FB687DA}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{ADB9F5A4-E73E-49b8-99B6-2FA317EF9DBC}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{AFDB1F70-2A4C-11d2-9039-00C04F8EEB3E}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{B005E690-678D-11d1-B758-00A0C90564FE}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{B12AE898-D056-4378-A844-6D393FE37956}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{B50F5260-0C21-11D2-AB56-00A0C9082678}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{B7BBD408-F09C-4aa8-B65E-A00B8FE0F0B9}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{B96D2802-4B41-4bc7-A6A4-55C5A12268CA}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{BD84B380-8CA2-1069-AB1D-08000948F534}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{BDEADF00-C265-11d0-BCED-00A0C90AB50F}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{C4EE31F3-4768-11D2-BE5C-00A0C9A83DA1}\DefaultIcon]<br />
@='%SystemRoot%\system32\SHELL32.dll,-135'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{C62A69F0-16DC-11CE-9E98-00AA00574A4F}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{c79d1575-b8c6-4862-a284-788836518b97}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{CE682BA0-C554-43f7-99C6-2F00FE46C8BC}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{D20EA4E1-3957-11d2-A40B-0C5020524152}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{D20EA4E1-3957-11d2-A40B-0C5020524153}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{D4480A50-BA28-11d1-8E75-00C04FA31A86}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{D6277990-4C6A-11CF-8D87-00AA0060F5BF}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{D7053240-CE69-11CD-A777-00DD01143C57}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{DFD181E0-5E2F-11CE-A449-00AA004A803D}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{e17d4fc0-5564-11d1-83f2-00a0c90dc849}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{E211B736-43FD-11D1-9EFB-0000F8757FCD}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{EAE50EB0-4A62-11CE-BED6-00AA00611080}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{ecabaebd-7f19-11d2-978E-0000f8757e2a}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{ECF03A32-103D-11d2-854D-006008059367}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{EFA24E61-B078-11d0-89E4-00C04FC9E26E}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{EFA24E62-B078-11d0-89E4-00C04FC9E26E}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{EFA24E63-B078-11d0-89E4-00C04FC9E26E}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{effc2928-37b1-11d2-a3c1-00c04fb1782a}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{f5078f28-c551-11d3-89b9-0000f81fe221}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{F5078F40-C551-11D3-89B9-0000F81FE221}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{F5175861-2688-11d0-9C5E-00AA00A45957}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{FB0C9C8A-6C50-11D1-9F1D-0000F8757FCD}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{FBF23B42-E3F0-101B-8488-00AA003E56F8}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{FF393560-C2A7-11CF-BFF4-444553540000}\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\SystemFileAssociations\.doc\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\SystemFileAssociations\.rtf\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\SystemFileAssociations\.wri\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\SystemFileAssociations\audio\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\SystemFileAssociations\system\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\SystemFileAssociations\text\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\SystemFileAssociations\video\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Clients\StartMenuInternet\IEXPLORE.EXE\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Scripting Host\Script Extensions\.JS\DefaultIcon]<br />
@='%SystemRoot%\System32\wscript.exe,3'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Scripting Host\Script Extensions\.VBS\DefaultIcon]<br />
@='%SystemRoot%\System32\wscript.exe,2'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{42042206-2D85-11D3-8CFF-005004838597}\Old Icon\htmlfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{42042206-2D85-11D3-8CFF-005004838597}\Old Icon\mhtmlfile\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Clients\Contacts\Address Book\Protocols\certificate_wab_auto_file\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Clients\Contacts\Address Book\Protocols\ldap\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Clients\Contacts\Address Book\Protocols\vcard_wab_auto_file\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Clients\Mail\Becky! ver.2 deutsch\Protocols\mailto\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Clients\Mail\Outlook Express\Protocols\mailto\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Clients\News\Outlook Express\Protocols\news\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Clients\News\Outlook Express\Protocols\nntp\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Clients\News\Outlook Express\Protocols\snews\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Multimedia\WMPlayer\Devices\AudioCD\DefaultIcon]<br />
@='C:\WINDOWS\system32\shell32.dll,40'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Multimedia\WMPlayer\Devices\DVD\DefaultIcon]<br />
@='shell32.dll,40'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Outlook Express\Outlook NewsReader\Protocols\news\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Outlook Express\Outlook NewsReader\Protocols\nntp\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Outlook Express\Outlook NewsReader\Protocols\snews\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\PublishingWizard\InternetPhotoPrinting\DefaultIcon]<br />
@='shell32.dll,-251'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\ContentTypeHandlers\MusicFilesContentHandler\DefaultIcon]<br />
@='%SystemRoot%\system32\SHELL32.dll,-225'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\ContentTypeHandlers\PicturesContentHandler\DefaultIcon]<br />
@='shimgvw.dll,3'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\ContentTypeHandlers\VideoFilesContentHandler\DefaultIcon]<br />
@='%SystemRoot%\system32\SHELL32.dll,-224'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\Handlers\MSCDBurningOnArrival\DefaultIcon]<br />
@='%SystemRoot%\system32\SHELL32.dll,-5'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\Handlers\MSOpenFolder\DefaultIcon]<br />
@='%SystemRoot%\system32\SHELL32.dll,-5'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\Handlers\MSPlayCDAudioOnArrival\DefaultIcon]<br />
@='%ProgramFiles%\Windows Media Player\wmplayer.exe,0'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\Handlers\MSPlayDVDMovieOnArrival\DefaultIcon]<br />
@='%ProgramFiles%\Windows Media Player\wmplayer.exe,0'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\Handlers\MSPlayMediaOnArrival\DefaultIcon]<br />
@='C:\Programme\Windows Media Player\wmplayer.exe,0'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\Handlers\MSPrintPicturesOnArrival\DefaultIcon]<br />
@='%SystemRoot%\system32\SHELL32.dll,-17'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\Handlers\MSPromptEachTime\DefaultIcon]<br />
@='%SystemRoot%\system32\SHELL32.dll,-3'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\Handlers\MSPromptEachTimeNoContent\DefaultIcon]<br />
@='%SystemRoot%\system32\SHELL32.dll,-3'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\Handlers\MSRipCDAudioOnArrival\DefaultIcon]<br />
@='%ProgramFiles%\Windows Media Player\wmplayer.exe,0'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\Handlers\MSShowPicturesOnArrival\DefaultIcon]<br />
@='%SystemRoot%\system32\SHELL32.dll,-249'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\Handlers\MSTakeNoAction\DefaultIcon]<br />
@='%SystemRoot%\system32\SHELL32.dll,-338'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\Handlers\MSWiaEventHandler\DefaultIcon]<br />
@='%systemroot%\System32\wiaacmgr.exe,-2'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\Handlers\MSWMDMHandler\DefaultIcon]<br />
@='%ProgramFiles%\Windows Media Player\wmplayer.exe,0'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\Handlers\MSWMPBurnCDOnArrival\DefaultIcon]<br />
@='%ProgramFiles%\Windows Media Player\wmplayer.exe,0'<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FindExtensions\Static\ShellSearch\0\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FindExtensions\Static\ShellSearch\1\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FindExtensions\Static\ShellSearch\2\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FindExtensions\Static\SrExt\0\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FindExtensions\Static\WabFind\0\DefaultIcon]<br />
@=''<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FindExtensions\Static\WebSearch\0\DefaultIcon]<br />
@=''</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">23rd August 2005, 10:39</div></div><div class="posttext">Registry keys always have default values and you ask why when plugin found key it not return default value. I answer<br />
API RegEnumKeyEx isn't return default value, so it must be readed MANUALY. Its not readed by plugin, because it'll reduce plugin perfomance.<br />
<br />
If our purpose save all default values of keys &quot;DefaultIcon&quot; in file in REGEDIT4 format then options is &quot;/K=1 /V=0 /S=0&quot; not &quot;/K=1 /V=1 /S=1&quot;, because first we search for key &quot;DefaultIcon&quot;, when we have found it we read default value in this key and then save key and string in file.<br />
<br />
For example:<br />
Our script found key ($0=&quot;SOFTWARE\Classes\.nsc&quot;, $1=&quot;DefaultIcon&quot;, $2=&quot;&quot;, $3=&quot;REG_KEY&quot;) then we read default value of this key ($4=&quot;$0\$1&quot;, $5=&quot;&quot;, $6=&quot;dxmasf.dll,-502&quot;, $7=&quot;REG_SZ&quot;)<br />
<br />
Please test the script below and you'll see that all working ok.<br />
<br />
<br />
Name &quot;DefaultIcon&quot;<br />
OutFile &quot;DefaultIcon.exe&quot;<br />
AutoCloseWindow true<br />
<br />
!include &quot;WordFunc.nsh&quot;<br />
!insertmacro WordReplace<br />
<br />
Section<br />
	StrCpy $R0 HKEY_LOCAL_MACHINE<br />
	FileOpen $R1 &quot;DefaultIcon.reg&quot; w<br />
	FileWrite $R1 &quot;REGEDIT4$\r$\n$\r$\n&quot;<br />
<br />
	registry::Open /NOUNLOAD &quot;$R0&quot; &quot;/K=1 /V=0 /S=0 /B=1 /N='DefaultIcon'&quot; .r0<br />
	StrCmp $0 -1 end<br />
<br />
	loop:<br />
	registry::Find /NOUNLOAD .r0 .r1 .r2 .r3<br />
	StrCmp $3 &quot;&quot; end<br />
<br />
	registry::Read /NOUNLOAD &quot;$R0\$0\$1&quot; &quot;&quot; .r4 .r5 .r6 .r7<br />
	StrCmp $6 &quot;&quot; loop<br />
<br />
	${WordReplace} &quot;$6&quot; &quot;\&quot; &quot;\\&quot; &quot;+&quot; $6<br />
	${WordReplace} &quot;$6&quot; '&quot;' '\&quot;' &quot;+&quot; $6<br />
	FileWrite $R1 '[$R0\$0\$1]$\r$\n'<br />
	FileWrite $R1 '@=&quot;$6&quot;$\r$\n$\r$\n'<br />
	Goto loop<br />
<br />
	end:<br />
	registry::Close<br />
	FileClose $R1<br />
SectionEnd<br />
Script used header (http://forums.winamp.com/attachment.php?s=&amp;postid=1734108)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">29th August 2005, 07:41</div></div><div class="posttext">Changes:<br />
-Fixed: registry::Find and registry::Read does not swap 2 bytes in REG_DWORD_BIG_ENDIAN number<br />
-Fixed: registry::SaveKey saves REG_DWORD_BIG_ENDIAN not as binary<br />
-Added missing types to write:<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;REG_DWORD_BIG_ENDIAN<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;REG_NONE<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;REG_LINK<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;REG_RESOURCE_LIST<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;REG_FULL_RESOURCE_DESCRIPTOR<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;REG_RESOURCE_REQUIREMENTS_LIST<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;REG_QWORD<br />
-Source updated to use new StackFunc.h (v1.4)<br />
<br />
<br />
&quot;Registry&quot; plugin v1.4</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">29th August 2005, 17:40</div></div><div class="posttext">Im a bit confused, pls tell me<br />
Name &quot;DefaultIcon&quot;<br />
OutFile &quot;DefaultIcon.exe&quot;<br />
AutoCloseWindow true<br />
<br />
Section <br />
SectionEnd<br />
<br />
Function .onInit<br />
  IfFileExists &quot;DefaultIcon.reg&quot; 0 noreg<br />
    Delete DefaultIcon.reg<br />
  noreg:<br />
<br />
  FileOpen $R1 &quot;DefaultIcon.reg&quot; w<br />
  FileWrite $R1 &quot;REGEDIT4&quot;<br />
  FileWriteByte $R1 &quot;13&quot;<br />
  FileWriteByte $R1 &quot;10&quot;<br />
  FileWriteByte $R1 &quot;13&quot;<br />
  FileWriteByte $R1 &quot;10&quot;<br />
<br />
  registry::Open /NOUNLOAD &quot;HKEY_LOCAL_MACHINE&quot; &quot;/K=1 /V=1 /S=1 /B=1 /N='DefaultIcon'&quot; .r0<br />
  StrCmp $0 -1 end<br />
<br />
  loop:<br />
    registry::Find /NOUNLOAD .r1 .r2 .r3 .r4<br />
    ;IfErrors end<br />
    StrCmp $1 &quot;&quot; end<br />
    StrCmp $2 &quot;&quot; end<br />
    ;StrCmp $3 &quot;&quot; loop<br />
    ;StrCmp $4 &quot;&quot; loop<br />
<br />
    ReadRegStr $R2 HKLM &quot;$1\$2&quot; &quot;&quot;<br />
<br />
    ;MessageBox MB_OKCANCEL &quot;'$1\$2'$\n'$R2'$\n'$3''&quot; IDCANCEL end<br />
<br />
    FileWrite $R1 &quot;[HKEY_LOCAL_MACHINE\$1\$2]&quot;<br />
    FileWriteByte $R1 &quot;13&quot;<br />
    FileWriteByte $R1 &quot;10&quot;<br />
<br />
    StrCmp $3 &quot;&quot; write_reg1<br />
      FileWrite $R1 &quot;@='$3'&quot;<br />
      Goto write_reg2<br />
    write_reg1:<br />
      FileWrite $R1 &quot;@='$R2'&quot;<br />
    write_reg2:<br />
    FileWriteByte $R1 &quot;13&quot;<br />
    FileWriteByte $R1 &quot;10&quot;<br />
    FileWriteByte $R1 &quot;13&quot;<br />
    FileWriteByte $R1 &quot;10&quot;<br />
<br />
  Goto loop<br />
<br />
  end:<br />
  registry::Close<br />
<br />
FileClose $R1<br />
FunctionEnd<br />
<br />
With<br />
IfErrors end<br />
the reg-file is about 2k, w/o 55k.<br />
so what error happend ? thx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">30th August 2005, 08:28</div></div><div class="posttext">Registry plugin doesn't change IfErrors flag, I see what it changed by ReadRegStr, when it try to read unexisted value. You can use ClearErrors after it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">31st August 2005, 11:57</div></div><div class="posttext">sure, i see - the following ReadRegStr causes that and it is not cleared.<br />
<br />
thx, never thought this way.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">3rd September 2005, 09:34</div></div><div class="posttext">Changes:<br />
-GlobalAlloc replaced with static variables<br />
-registry::Write create key if necessary.<br />
-Fixed: When reading long binary data odd number appeared (1023 + NULL character). Now string length: 1022 + NULL character.<br />
-New: registry::ReadExtra, registry::WriteExtra<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;now possible to read and/or write registry string up to 64Kb (65536) (thanks for idea Iceman_K, RegBin plugin (http://nsis.sourceforge.net/wiki/Write_arbitrary_sized%2C_runtime_assigned_binary_data_to_Registry))<br />
<br />
<br />
&quot;Registry&quot; plugin v1.5</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">12th September 2005, 14:44</div></div><div class="posttext">Changes:<br />
-registry::CreateKey reduce number of parameters (registry::CreateKey &quot;[fullpath]&quot; .r0)<br />
-Fixed: registry::Write accepted only uppercase registry type<br />
<br />
<br />
&quot;Registry&quot; plugin v1.6</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">26th November 2005, 09:49</div></div><div class="posttext">New: registry::CopyValue<br />
New: registry::MoveValue<br />
New: registry::CopyKey<br />
New: registry::MoveKey<br />
New: registry::KeyExists<br />
<br />
<br />
&quot;Registry&quot; plugin v1.7</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">14th December 2005, 08:21</div></div><div class="posttext">Fixed: mixed MAX_STRLEN and MAX_PATH defines, maximum registry string length was 256+32 (appeared in v1.7)<br />
Updated: StrFunc.h to v1.4<br />
<br />
<br />
&quot;Registry&quot; plugin v1.8</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">21st December 2005, 00:13</div></div><div class="posttext">New: registry::DeleteKeyEmpty delete empty key (if no values and subkeys in it)<br />
<br />
<br />
&quot;Registry&quot; plugin v1.9</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">6th January 2006, 22:34</div></div><div class="posttext">If anyone can test this version of the registry plugin for Pocket PC?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">XPero</div><div class="date">7th January 2006, 01:12</div></div><div class="posttext">Can you please add support for version 5 of Windows Registry?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">8th January 2006, 03:24</div></div><div class="posttext">For what you need Windows Registry 5?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">XPero</div><div class="date">8th January 2006, 14:04</div></div><div class="posttext">For exporting reg keys data containing paths. For example, if the Data of a REG_SZ is &quot;E:\My Things\My Thing.myext&quot;, the exported reg key won't work with your Registry Plugin. At least, it didnt for me. The hex conversion isn't right.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">8th January 2006, 18:29</div></div><div class="posttext">Registry plugin was successfully tested with all my registry in Windows 95/Me/XP. There few paths in it :)<br />
the exported reg key won't work with your Registry PluginWhat the plugin call, what the errorlevel, what the output file, what your key contents when you exporting it with the regedit.exe?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">XPero</div><div class="date">8th January 2006, 20:15</div></div><div class="posttext">I will post later next week (busy at the moment) the reg file created by your plugin and the one created using Regedit.exe so you can compare them.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">8th January 2006, 20:21</div></div><div class="posttext">OK. And I hope you use the latest version.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">XPero</div><div class="date">13th January 2006, 07:50</div></div><div class="posttext">Works now with latest version. Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">11th February 2006, 10:22</div></div><div class="posttext">New: &quot;PPC-Registry&quot; plugin - registry plugin for Pocket PC. All thanks to Thomas Bednarz (Smart Solutions AG)<br />
<br />
Changed: registry::Read reduce number of parameters<br />
<br />
Fixed: registry::SaveKey does not convert short roots to long (HKLM-&gt;HKEY_LOCAL_MACHINE)<br />
<br />
Updated: &quot;ConvFunc.h&quot; to v1.5<br />
<br />
Updated: &quot;StrFunc.h&quot; to v1.6<br />
<br />
Changed: Now plugin used header &quot;Registry.nsh&quot; (&quot;PPC-Registry.nsh&quot;) for custom user variables and<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;better compile errors check.<br />
<br />
Update from previous versions:<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- Insert line in script:<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;!include &quot;Registry.nsh&quot;<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- Replace:<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;registry::Open -&gt; ${registry::Open} ...<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- Replace:<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;.r0 -&gt; $0, .r1 -&gt; $1 ... .R0 -&gt; $R0, .R1 -&gt; $R1 ...<br />
<br />
<br />
&quot;Registry&quot; plugin v2.0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">20th February 2006, 23:41</div></div><div class="posttext">This reg_multi_sz is not working<br />
<br />
HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Session Manager:PendingFileRenameOperations<br />
<br />
variable only contains the first line - values are seperated by an empty line eg:<br />
<br />
\??\C:\DOKUME~1\user\LOKALE~1\Temp\~nsu.tmp\Au_.exe<br />
<br />
\??\C:\DOKUME~1\user\LOKALE~1\Temp\~nsu.tmp\Au_.exe<br />
<br />
\??\C:\DOKUME~1\user\LOKALE~1\Temp\nse274.tmp\registry.dll</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">21st February 2006, 07:08</div></div><div class="posttext">&quot;PendingFileRenameOperations&quot; value has two NULL characters normally this means that value ended (one NULL character - end of line)<br />
<br />
&quot;PendingFileRenameOperations&quot;=hex(7):5c,3f,3f,5c,43,3a,5c,57,49,4e,4e,54,5c,73,\<br />
  79,73,74,65,6d,33,32,5c,73,70,6f,6f,6c,5c,44,52,49,56,45,52,53,5c,43,4f,4c,\<br />
  4f,52,5c,4e,65,77,00,00,5c,3f,3f,5c,43,3a,5c,44,4f,43,55,4d,45,7e,31,5c,73,\<br />
  61,61,5c,4c,4f,43,41,4c,53,7e,31,5c,54,65,6d,70,5c,6e,73,61,31,42,38,42,2e,\<br />
  74,6d,70,5c,52,65,67,69,73,74,72,79,2e,64,6c,6c,00,00,5c,3f,3f,5c,43,3a,5c ...<br />
<br />
I'll see what I can do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">21st February 2006, 07:57</div></div><div class="posttext">Fixed: registry::Read interpret empty line of REG_MULTI_SZ value as end of value.<br />
Updated: &quot;ConvFunc.h&quot; to v1.6<br />
<br />
<br />
&quot;Registry&quot; plugin v2.1<br />
<br />
[deleted]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">21st February 2006, 09:43</div></div><div class="posttext">Thank you much :) top da man ^^<br />
<br />
erks, sorry - nearly.<br />
<br />
when i empty that key manually this remains<br />
<br />
&quot;PendingFileRenameOperations&quot;=hex(7):00<br />
<br />
registry::read shows me a blank value.<br />
<br />
maybe you can fix this too ?<br />
<br />
<br />
some nasty code to avoid it:<br />
  ;pending operations ?<br />
  ClearErrors<br />
    ${registry::Read} &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager&quot; &quot;PendingFileRenameOperations&quot; $R9 $R8<br />
  StrCmp $R9 &quot;&quot; no_pending<br />
    StrLen $R8 $R9<br />
    StrCmp $R8 1 no_pending<br />
    ${registry::Unload}<br />
    ;your action here<br />
      Quit<br />
  no_pending:<br />
    ${registry::Unload}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">21st February 2006, 10:03</div></div><div class="posttext">Please download v2.1 again, I forgot one thing in fix.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">21st February 2006, 10:16</div></div><div class="posttext">somethings really going bad now - the installer quits on starting the plugin and remains the temp folder</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">21st February 2006, 10:27</div></div><div class="posttext">I'm looking at it now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">21st February 2006, 10:51</div></div><div class="posttext">Fixed: registry::Read REG_MULTI_SZ value problems ( take two :) ).<br />
<br />
<br />
&quot;Registry&quot; plugin v2.2</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">21st February 2006, 10:57</div></div><div class="posttext">crash - fixed<br />
<br />
zero value - not fixed<br />
&quot;PendingFileRenameOperations&quot;=hex(7):00<br />
(i get my message)<br />
<br />
but no worry so far i use my nasty code above as long it cannot be fixed</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">21st February 2006, 11:09</div></div><div class="posttext">zero value - not fixed<br />
&quot;PendingFileRenameOperations&quot;=hex(7):00<br />
(i get my message)REG_MULTI_SZ value requeres two NULL characters at the end (howbeit plugin read any REG_MULTI_SZ value).<br />
&quot;PendingFileRenameOperations&quot;=hex(7):00,00</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">21st February 2006, 11:21</div></div><div class="posttext">well - here it has only one zero ;)<br />
can you code it that if reg_multi_sz starts with zero it returns empty ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">21st February 2006, 11:39</div></div><div class="posttext">Done. Reuploaded.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">21st February 2006, 12:38</div></div><div class="posttext">perfect http://people.freenet.de/brummelchen2003a/smilies/icon_applaus.gif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">3rd March 2006, 07:47</div></div><div class="posttext">-deleted-<br />
<br />
P.S. I will try later</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WebMatze</div><div class="date">3rd March 2006, 07:56</div></div><div class="posttext">Zip is damaged... :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">3rd March 2006, 16:50</div></div><div class="posttext">No, try again</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">3rd March 2006, 21:01</div></div><div class="posttext">Fixed: registry::WriteExtra append REG_MULTI_SZ value only after new line.<br />
<br />
<br />
&quot;Registry&quot; plugin v2.3</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">10th April 2006, 19:10</div></div><div class="posttext">Fixed: improved PPC-registry plugin code, many bugs fixed (thanks Peter Beedell)<br />
<br />
<br />
&quot;Registry&quot; plugin v2.4</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rmccue</div><div class="date">20th April 2006, 03:52</div></div><div class="posttext">Is it possible to allow the appending of registry keys to an already created file and exporting more than one key at a time?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">20th April 2006, 07:56</div></div><div class="posttext">Is it possible to allow the appending of registry keys to an already created file and exporting more than one key at a time? Probably I can add this possibility.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rxs2k5</div><div class="date">20th April 2006, 08:25</div></div><div class="posttext">Instructor excellent plugin, thanks for your contributions.<br />
<br />
This could at least worked out a bit to find the correct keys to change a setoutpath<br />
<br />
btw <br />
<br />
Section /o &quot;Search and write founded in text file&quot; SearchAndWriteInFile<br />
	GetTempFileName $R0<br />
	FileOpen $R1 $R0 w<br />
	FileWrite $R1 'HKEY_CURRENT_CONFIG$\r$\n$\r$\n'<br />
<br />
	${registry::Open} &quot;HKEY_CURRENT_CONFIG&quot; &quot;/B=1&quot; $0<br />
	StrCmp $0 -1 0 loop<br />
	MessageBox MB_OK &quot;Error&quot; IDOK close<br />
<br />
	loop:<br />
	${registry::Find} $1 $2 $3 $4<br />
<br />
	StrCmp $4 '' close<br />
	StrCmp $4 'REG_KEY' 0 +3<br />
	FileWrite $R1 '$4:&quot;$1\$2&quot;$\r$\n'<br />
	goto +2<br />
	FileWrite $R1 '$4:&quot;$1&quot; &quot;$2&quot;=&quot;$3&quot;$\r$\n'<br />
	goto loop<br />
<br />
	close:<br />
	${registry::Close}<br />
	${registry::Unload}<br />
	FileClose $R1<br />
<br />
	Exec '&quot;notepad.exe&quot; &quot;$R0&quot;'<br />
SectionEnd<br />
<br />
<br />
In the example u provided, about the search and write found, how can I able to make it search and write the searched registry into a filename.ini</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">20th April 2006, 08:57</div></div><div class="posttext">Like this?Section /o &quot;Search and write founded in text file&quot; SearchAndWriteInFile<br />
	StrCpy $R0 HKEY_CURRENT_CONFIG<br />
<br />
	${registry::Open} &quot;$R0&quot; &quot;/K=0 /B=1&quot; $0<br />
	StrCmp $0 -1 0 loop<br />
	MessageBox MB_OK &quot;Error&quot; IDOK close<br />
<br />
	loop:<br />
	${registry::Find} $1 $2 $3 $4<br />
<br />
	StrCmp $4 '' close<br />
	WriteINIStr 'C:\filename.ini' '$R0\$1\$2' '$2' '$3'<br />
	goto loop<br />
<br />
	close:<br />
	${registry::Close}<br />
	${registry::Unload}<br />
	FileClose $R1<br />
<br />
	Exec '&quot;notepad.exe&quot; &quot;C:\filename.ini&quot;'<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rxs2k5</div><div class="date">20th April 2006, 09:36</div></div><div class="posttext">nice nice thanks <br />
but how do I extent the search beside this<br />
HKEY_CURRENT_CONFIG<br />
<br />
like <br />
<br />
HKEY_LOCAL_MACHINE &quot; name of software &quot; &quot;the value&quot; &quot;data&quot;<br />
HKEY CURRENT USERS &quot; Name of software &quot; &quot; the value&quot; &quot;data&quot;<br />
<br />
Section /o &quot;Search and write founded in text file&quot; SearchAndWriteInFile<br />
	StrCpy $R0 HKEY_CURRENT_CONFIG<br />
<br />
	${registry::Open} &quot;$R0&quot; &quot;/K=0 /B=1&quot; $0<br />
	StrCmp $0 -1 0 loop<br />
	MessageBox MB_OK &quot;Error&quot; IDOK close<br />
<br />
	loop:<br />
	${registry::Find} $1 $2 $3 $4<br />
<br />
	StrCmp $4 '' close<br />
	WriteINIStr 'C:\filename.ini' '$R0\$1\$2' '$2' '$3'<br />
	goto loop<br />
<br />
	close:<br />
	${registry::Close}<br />
	${registry::Unload}<br />
	FileClose $R1<br />
<br />
	Exec '&quot;notepad.exe&quot; &quot;C:\filename.ini&quot;'<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">20th April 2006, 10:01</div></div><div class="posttext">but how do I extent the search beside this<br />
HKEY_CURRENT_CONFIG<br />
<br />
like <br />
<br />
HKEY_LOCAL_MACHINE &quot; name of software &quot; &quot;the value&quot; &quot;data&quot;<br />
HKEY CURRENT USERS &quot; Name of software &quot; &quot; the value&quot; &quot;data&quot;Don't understand. What your situation (what you trying to do)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rxs2k5</div><div class="date">20th April 2006, 11:19</div></div><div class="posttext">Section /o &quot;Search and write founded in text file&quot; SearchAndWriteInFile<br />
StrCpy $R0 HKEY_CURRENT_User<br />
StrCpy $R1 HKEY_Local_ Machine<br />
<br />
${registry::Open} &quot;$R0&quot; &quot;/K=0 /B=1&quot; $0<br />
StrCmp $0 -1 0 loop<br />
MessageBox MB_OK &quot;Error&quot; IDOK close<br />
<br />
loop:<br />
${registry::Find} $1 $2 $3 $4<br />
<br />
StrCmp $4 '' close<br />
WriteINIStr 'C:\filename.ini' '$R0\$1\$2' '$2' '$3'<br />
goto loop<br />
<br />
close:<br />
${registry::Close}<br />
${registry::Unload}<br />
FileClose $R1<br />
<br />
Exec '&quot;notepad.exe&quot; &quot;C:\filename.ini&quot;'<br />
SectionEnd<br />
1.<br />
If u look at the example above the HKEY_CURRENT_User which will be written into the filename.ini takes a long time to search since it will scan the entire registry on HKEY_CURRENT_User is there anyway to define it to search the material much faster and direct.<br />
<br />
2. HKEY_CURRENT_User &quot;Software\blah&quot; &quot;search string value&quot; &quot; string value data &quot; is this possible to direct a search rather than a full scan of the HKEY_CURRENT_User.<br />
<br />
3. this will be read by ReadINIStr afterwards when the search is being done since ReadINIStr requires section_name entry_name. Is there a possibility that your registry plugin can arrange this to fit into the search in ReadINIStr like this<br />
ReadINIStr $0 $Temp\filename.ini example1 cool on the later part.<br />
<br />
<br />
thanks again for replying</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">20th April 2006, 11:35</div></div><div class="posttext">is this possible to direct a search rather than a full scan of the HKEY_CURRENT_UserDirect search for what? For key &quot;blah&quot;?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rxs2k5</div><div class="date">20th April 2006, 11:39</div></div><div class="posttext">yes</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">20th April 2006, 11:48</div></div><div class="posttext">I'll answer little later</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rxs2k5</div><div class="date">20th April 2006, 11:58</div></div><div class="posttext">ok I will be waiting when ur ready</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">20th April 2006, 14:00</div></div><div class="posttext">ok. I need to understand what you trying to do.<br />
1. You know that registry key name is &quot;blah&quot;<br />
2. You know that this key located somewhere in the &quot;HKEY_CURRENT_USER\Software&quot; (it can be &quot;HKEY_CURRENT_USER\Software\123\blah&quot; or &quot;HKEY_CURRENT_USER\Software\Microsoft\blah&quot; ...)<br />
3. You need to find all this variants and write them to the ini file<br />
Is this correct?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rxs2k5</div><div class="date">20th April 2006, 14:44</div></div><div class="posttext">yes !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">20th April 2006, 15:15</div></div><div class="posttext">Section /o &quot;Search and write founded in text file&quot; SearchAndWriteInFile<br />
	StrCpy $R0 &quot;HKEY_CURRENT_USER&quot;  #Root<br />
	StrCpy $R1 &quot;Software&quot;           #Subkey &quot;Key1\Ke2\Key3&quot;<br />
	StrCpy $R2 0<br />
<br />
	${registry::Open} &quot;$R0\$R1&quot; &quot;/K=1 V=0 /S=0 /N='blah' /B=1&quot; $0<br />
	StrCmp $0 -1 0 loop<br />
	MessageBox MB_OK &quot;Error&quot; IDOK close<br />
<br />
	loop:<br />
	${registry::Find} $1 $2 $3 $4<br />
<br />
	StrCmp $4 '' close<br />
	WriteINIStr 'C:\filename.ini' 'Example1' '$R2' '$R0\$1\$2'<br />
	IntOp $R2 $R2 + 1<br />
	goto loop<br />
<br />
	close:<br />
	${registry::Close}<br />
	${registry::Unload}<br />
<br />
	Exec '&quot;notepad.exe&quot; &quot;C:\filename.ini&quot;'<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">20th April 2006, 19:26</div></div><div class="posttext">Added: &amp;nbsp;&amp;nbsp;&amp;nbsp;registry::SaveKey option /A=[0|1], /A=1 append data to the file<br />
Changed: registry::RestoreKey some clean-up<br />
<br />
<br />
&quot;Registry&quot; plugin v2.5</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">20th April 2006, 20:19</div></div><div class="posttext">Fast fix: registry::Open does not reset variables (more then one call)<br />
<br />
<br />
&quot;Registry&quot; plugin v2.6</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Deuce199</div><div class="date">10th May 2006, 20:07</div></div><div class="posttext">I am using a search function in my registry program using your plugin. I am now using your append switch of savekey to append the found keys to a reg file and it works like a charm. This is my problem:<br />
<br />
Say I search for Key1 in HKEY_Local_MAchine, so it find key1 and writes it to the reg file, i then have it loop back and search again. The problem is it will refind the first instance of key1 and keep going, never getting past that key, because it does not remember it did that. How or can you add function that will cause the search to continue from the point it stopped to write the information to a file. So it would continue from the first instance of key1 and go to the next instance? Is that possible?<br />
<br />
Thanks,<br />
 Deuce199</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">11th May 2006, 09:35</div></div><div class="posttext">registry::Find and registry::SaveKey uses the same stack I'll try to separate them.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">14th May 2006, 21:27</div></div><div class="posttext">With v2.7:<br />
Name &quot;Output&quot;<br />
OutFile &quot;Output.exe&quot;<br />
<br />
!include &quot;Registry.nsh&quot;<br />
<br />
Section<br />
	StrCpy $R0 &quot;HKEY_LOCAL_MACHINE&quot;   #Root<br />
	StrCpy $R1 &quot;SOFTWARE\Microsoft&quot;   #Subkey<br />
<br />
	${registry::Open} &quot;$R0\$R1&quot; &quot;/K=1 V=0 /S=0 /N='Key1' /B=1&quot; $0<br />
	StrCmp $0 -1 0 loop<br />
	MessageBox MB_OK &quot;Error&quot; IDOK close<br />
<br />
	loop:<br />
	${registry::Find} $1 $2 $3 $4<br />
<br />
	StrCmp $4 '' close<br />
	${registry::SaveKey} &quot;$R0\$1\$2&quot; &quot;C:\keys.reg&quot; &quot;/A=1 /B=1&quot; $0<br />
	goto loop<br />
<br />
	close:<br />
	${registry::Close}<br />
	${registry::Unload}<br />
<br />
	Exec '&quot;notepad.exe&quot; C:\keys.reg'<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">14th May 2006, 21:31</div></div><div class="posttext">Fixed: separate registry::Find and registry::SaveKey stacks. Now possible use them<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; together.<br />
<br />
<br />
&quot;Registry&quot; plugin v2.7</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">17th May 2006, 00:59</div></div><div class="posttext">Updated: &quot;StackFunc.h&quot; to v1.8<br />
Added: handles for search<br />
<br />
<br />
&quot;Registry&quot; plugin v2.8</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">17th May 2006, 17:45</div></div><div class="posttext">Cool! Awesome plugin, and getting even better, <br />
thanks Instructor.<br />
BTW a more detailed documentation would be great :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">28th May 2006, 09:14</div></div><div class="posttext">Updated: &quot;StrFunc.h&quot; to v1.7<br />
Updated: &quot;StackFunc.h&quot; to v1.9<br />
Updated: &quot;ConvFunc.h&quot; to v1.7<br />
<br />
<br />
&quot;Registry&quot; plugin v2.9</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">3rd July 2006, 16:44</div></div><div class="posttext">Added: registry::Open options <br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;/NS=[name]&quot; - sensitive search for a part of name<br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;/NI=[name]&quot; - insensitive search for a part of name<br />
<br />
<br />
&quot;Registry&quot; plugin v3.0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Deuce199</div><div class="date">17th August 2006, 19:52</div></div><div class="posttext">Instructor,<br />
<br />
First thanks for the help, I am sorry it took so long to get back to you. <br />
<br />
Second, I am having the same problem, What I need is for my search algorithm to search the registry for a specific keyword. If found save the key to a reg file, then from that point, the regkey it just wrote, continue to search the rest of the registry for that keyword. If another is found then save, start from that point and continue, and so on until it hits the end of the registry. <br />
<br />
Here is my search function:<br />
<br />
<br />
!define RegSearch `!insertmacro RegSearch`<br />
<br />
!macro RegSearch rootKey searchWord<br />
	<br />
    ${registry::Open} &quot;${rootKey}&quot; &quot;/K=1 /V=0 /S=0 /B=0 /N='${searchWord}'&quot; $0<br />
	StrCmp $0 0 0 +2<br />
	MessageBox MB_OK &quot;Error&quot; IDOK +9<br />
    ${registry::Find} &quot;$0&quot; $1 $2 $3 $4<br />
    StrCmp $4 '' +7<br />
    StrCmp $4 'REG_KEY' 0 +4<br />
    StrCpy $REGKEY &quot;${rootKey}\$1\$2\$3&quot;<br />
    ${Registry::SaveKey} &quot;$REGKEY&quot; &quot;${SETDIR}\Settings.reg&quot; &quot;/A=1 /G=1&quot; $R0<br />
	StrCpy $RC &quot;1&quot;<br />
    goto -7<br />
    <br />
    ${registry::Close} &quot;$0&quot;<br />
    ${registry::Unload}<br />
!macroend<br />
<br />
<br />
After the 'StrCpy $RC &quot;1&quot;' line it should jump back to the registry::find line and continue to search the registry for the next key. <br />
<br />
What it is doing it going back to the beginning of the opened root key and starting again, So it hits the already saved key and appends it to the regfile. <br />
<br />
Basically it creates a loop that creates a file that will keep writing the same info over and over again, until I kill it in the task manager.<br />
<br />
Is it possible for me to do this with your plugin? If so, how should I change the code above to make it work?<br />
<br />
thanks for all your help with this.<br />
<br />
Deuce</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">18th August 2006, 10:13</div></div><div class="posttext">You use relative jumps through macros.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Deuce199</div><div class="date">18th August 2006, 12:25</div></div><div class="posttext">How would I go about coding something like that? <br />
<br />
Right now, That is my macro. I call that macro from within my main prog script. It is my regsearch function pretty much.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">18th August 2006, 23:41</div></div><div class="posttext">Something like this:<br />
Function RegSearch<br />
	!define RegSearch `!insertmacro RegSearchCall`<br />
<br />
	!macro RegSearchCall rootKey searchWord<br />
		Push `${rootKey}`<br />
		Push `${searchWord}`<br />
		Call RegSearch<br />
	!macroend<br />
<br />
	Exch $R1<br />
	Exch<br />
	Exch $R0<br />
	Exch<br />
	Push $0<br />
	Push $1<br />
	Push $2<br />
	Push $3<br />
	Push $4<br />
	Push $5<br />
<br />
	${registry::Open} &quot;$R0&quot; &quot;/K=1 /V=0 /S=0 /B=0 /N='$R1'&quot; $0<br />
	StrCmp $0 0 0 +2<br />
	MessageBox MB_OK &quot;Error&quot; IDOK end<br />
<br />
	find:<br />
	${registry::Find} &quot;$0&quot; $1 $2 $3 $4<br />
	StrCmp $4 '' end<br />
	StrCpy $REGKEY &quot;$R0\$1\$2\$3&quot;<br />
	${registry::SaveKey} &quot;$REGKEY&quot; &quot;${SETDIR}\Settings.reg&quot; &quot;/A=1 /G=1&quot; $5<br />
	StrCpy $RC &quot;1&quot;<br />
	goto find<br />
<br />
	end:<br />
	${registry::Close} &quot;$0&quot;<br />
	${registry::Unload}<br />
<br />
	Pop $5<br />
	Pop $4<br />
	Pop $3<br />
	Pop $2<br />
	Pop $1<br />
	Pop $0<br />
	Pop $R1<br />
	Pop $R0<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Deuce199</div><div class="date">12th September 2006, 20:34</div></div><div class="posttext">I noticed while using your plugin in some of my code, that after the registry plugin is copied to the temp directory, it still is there even after the program is shutdown. <br />
<br />
My point is, after running the program ten times say, I have ten temp folders all containing the registry.dll file. They add up after a time.<br />
<br />
Is this something that can be fixed?<br />
<br />
Thanks, Deuce.<br />
<br />
PS. thanks for the help on the above function, I am still trying to find the time to try it out.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">10th November 2006, 11:49</div></div><div class="posttext">Hi Deuce199!<br />
<br />
It seems that you don't execute the 'unload'-function by the time you've finished using the plugin.<br />
<br />
Have a look at the excellent readme.txt for further information.<br />
<br />
<br />
; **** Unload plugin ****<br />
<br />
${registry::Unload}<br />
<br />
<br />
Cheers<br />
<br />
Bruno</div></div><hr />


<div class="post"><div class="posttop"><div class="username">makutaku</div><div class="date">4th December 2006, 00:52</div></div><div class="posttext">Both Registry.dll and PPC-Registry.dll were copied to NSIS plugin directory, but when I try to use them in my nsi file I get compilation errors: <br />
<br />
When I call either  Registry::Open or  PC-Registry::CeRapiInit<br />
both generate an invalid command error. <br />
<br />
I am able to use other plugins, such as nsislog.dll, so I don't undesrtand what's different with Registry.dll and PPC-Registry.dll.  Does anybody know what I am missing ?  Do I need to include anything in my nsi code to use these plugins?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">4th December 2006, 04:03</div></div><div class="posttext">You have to:<br />
 [list=1]<br />
 Get the DLLs moved to the plugins folder (which sounds like you have)<br />
 Move REGISTRY.NSH to the include folder<br />
 Add !Include 'REGISTRY.NSH' to the top of your script.<br />
 Make your calls using the built-in defines rather than regular plugin calls. (Example: Use ${registry::Open}, not Registry::Open)<br />
[/list=1] <br />
See the README.TXT file included with the plugin along with the included sample script. :cool:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">makutaku</div><div class="date">4th December 2006, 17:56</div></div><div class="posttext">Thank you very much !   It's working now !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ossi01</div><div class="date">7th February 2007, 08:11</div></div><div class="posttext">Hi,<br />
<br />
whe i create a new Key in HKLM\Software with Regedit.exe than i cant read this key with ${registry::Read} (returns empty String) or ${registry::Exist} (returns -1). Also ${registry::Find} doesnt enumerate this new Key.<br />
This only happens on Windows XP x64 or Vista x64.<br />
<br />
What can i do?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">3rd April 2007, 19:57</div></div><div class="posttext">seems like i have same issue. cause under 64 bit windows, the rigstry keys go to win6432node ....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">4th April 2007, 03:08</div></div><div class="posttext">Have a look at  this thread (http://forums.winamp.com/showthread.php?threadid=264834)...<br />
<br />
edit<br />
also look at my comments in this thread (http://forums.winamp.com/showthread.php?s=&amp;threadid=268880)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ehtyar</div><div class="date">18th May 2007, 06:37</div></div><div class="posttext">Hi all.<br />
I've been using this plugin to help create portable applications (most portable apps use this plugin). A problem is that if you have many and/or very large registry keys, not all of the data is inserted into the registry before the application starts. I modified the source code myself to fix this problem by adding a call to WaitForSingleObject on the handle returned by CreateProcess in the _RestoreKey function thus:<br />
if (CreateProcess(NULL, szBuf, NULL, NULL, FALSE, 0, NULL, NULL, &amp;si, &amp;pi))<br />
{<br />
WaitForSingleObject(pi.hProcess, INFINITE);<br />
CloseHandle(pi.hProcess);<br />
<br />
but it crashed my compiler (msvc6) when i tried to build it. If anyone wouldn't mind rebuilding this project with that modification, I'd really appreciate it.<br />
<br />
Thanks very much, Ehtyar.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">18th May 2007, 20:45</div></div><div class="posttext">Ehtyar</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">18th May 2007, 20:47</div></div><div class="posttext">Changed: small optimization.<br />
<br />
<br />
&quot;Registry&quot; plugin v3.1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ehtyar</div><div class="date">18th May 2007, 21:40</div></div><div class="posttext">Oh thank you so much instructor, it works perfectly. I'm sorry i could not accomplish that without bugging you, i guess i need to check for updates :S.<br />
<br />
Thanks again, Ehtyar.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">10th July 2007, 14:22</div></div><div class="posttext">Fixed: possible memory overflow (changed lstrcpy to lstrcpyn).<br />
<br />
<br />
&quot;Registry&quot; plugin v3.2</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wraithdu</div><div class="date">20th August 2007, 05:06</div></div><div class="posttext">I was curious which functions in your plugin should be followed by a Sleep command, and for how long?  I've noticed that some like RestoreKey perform more reliably with a Sleep 50 or 100.<br />
<br />
So basically, which functions execute and continue on the script immediately (without waiting for the actual registry operation to finish), and which wait for the registry operation to finish before moving on in the script?<br />
<br />
Great plugin, thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wraithdu</div><div class="date">21st August 2007, 03:02</div></div><div class="posttext">I found a bug in v3.2 (big one unfortunately).<br />
<br />
The ${registry::SaveKey} function is saving keys in HKCU as<br />
<br />
[HKCU\&lt;whatever&gt;]<br />
<br />
in the REG file.  Obviously this will not import back into the registry.  I checked back to v3.1 and this bug was not present.<br />
<br />
HKLM seems to work fine and is expanded to HKEY_LOCAL_MACHINE.  I'm not sure if other short names are affected or not.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">21st August 2007, 13:57</div></div><div class="posttext">Fixed: registry::SaveKey short root name didn't translated to a long name.<br />
<br />
<br />
&quot;Registry&quot; plugin v3.3</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wraithdu</div><div class="date">21st August 2007, 15:44</div></div><div class="posttext">Thanks for the quick update!<br />
<br />
Any comment on my post above about using Sleep times with your plugin?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">21st August 2007, 19:22</div></div><div class="posttext">wraithdu<br />
No comments. I don't understand your post.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wraithdu</div><div class="date">21st August 2007, 19:43</div></div><div class="posttext">Sorry, I'll try to be more clear.<br />
<br />
I use NSIS to make portable app launchers.  I've been in the habit of placing a 'Sleep 50' or 'Sleep 100' command after a call to your registry plugin to allow the the operation to finish before moving on in my script.<br />
<br />
The best example is what is described above by Ehtyr.  It seems the RestoreKey function does not wait for the registry information to be fully imported before moving on in the script and launching the application.  He modified the DLL to fix this problem.  I have just added some Sleep time.<br />
<br />
So my question is, what other functions in your plugin behave in the same way (ie do not wait for the registry operation to finish)?  Should I then keep adding the Sleep commands to compensate for this?  And would it be possible to modify all the registry commands as Ehtyr did?<br />
<br />
I hope that makes more sense.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">22nd August 2007, 02:59</div></div><div class="posttext">So my question is, what other functions in your plugin behave in the same way (ie do not wait for the registry operation to finish)?registry::RestoreKey is the only one.<br />
<br />
To import all registry information before continue, you could use the following code:<br />
ExecWait 'regedit /s &quot;[file]&quot;' $var</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Quib</div><div class="date">26th August 2007, 21:40</div></div><div class="posttext">So, just confirming, all registry operations except restore wait for the operation to complete before continuing? If so, this is awesome, I get to cut a ton of sleeps out of my scripts!<br />
<br />
Also, thank you so much for this plugin Instructor, it's wonderful.<br />
<br />
QM</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">26th August 2007, 21:43</div></div><div class="posttext">So, just confirming, all registry operations except restore wait for the operation to complete before continuing?Yes</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JCD29</div><div class="date">26th September 2007, 13:56</div></div><div class="posttext">just a question : if I want to find a value in a specified root , after the method find, i have to compare the $var2 with the value I want to find ? is it exact...<br />
i want to use your &quot;wonderful&quot; source code given above to test... I did this kind of algorith in my installer to check the presence of key in the registry base but it was long; with this one it is &quot;SUPER&quot;.....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JCD29</div><div class="date">26th September 2007, 14:25</div></div><div class="posttext">is it possible to have a error code return in $4 for the method find... if error so , doesn't find if not so seems to be good....<br />
thks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JCD29</div><div class="date">26th September 2007, 15:51</div></div><div class="posttext">an other question :<br />
in the method you described above, <br />
can we use the method read and ifkeyexist before the method close andunload ? <br />
<br />
I try and it doesn't work.... i search a value in a root by using the find method and just after i wanted to use the values returned by the find method to read a value in a fullpath <br />
<br />
call ${registry::Open}.... /B=0 $0<br />
call : ${registry::Find} &quot;$0&quot; $1 $2 $3 $4<br />
...ok i found the value..<br />
call {registry::read} &quot;$1&quot; &quot;$2&quot; $R0 $R1..<br />
call ${registry::close}<br />
<br />
but read doesn't work...<br />
<br />
can you help me..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">didava</div><div class="date">31st January 2008, 14:52</div></div><div class="posttext">Hi<br />
<br />
How do you delete the HKLM\SYSTEM\WPA\key- (WXP-Pro)<br />
<br />
I can one a make program with Nsis <br />
<br />
What do you use or do to delete these extra keys<br />
<br />
HKEY_LOCAL_MACHINE\SYSTEM\WPA\Key-XXXXXXXXXXXXXXXXXXXXX<br />
<br />
Doing it the normal right click and delete it kicks out and says you can't do that BEEP )(&amp;(^^%$%$###<br />
<br />
Don't need the bloody extra ones<br />
<br />
I even tried to change the permission still no go!!!!!!<br />
<br />
plz example show me</div></div><hr />


<div class="post"><div class="posttop"><div class="username">didava</div><div class="date">1st February 2008, 06:57</div></div><div class="posttext">plz example show me</div></div><hr />


<div class="post"><div class="posttop"><div class="username">didava</div><div class="date">1st February 2008, 09:57</div></div><div class="posttext">Can you Help!?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">didava</div><div class="date">1st February 2008, 18:41</div></div><div class="posttext">Hi<br />
<br />
How do you delete the HKLM\SYSTEM\WPA\key- (WXP-Pro)<br />
<br />
I can one a make program with Nsis<br />
<br />
What do you use or do to delete these extra keys<br />
<br />
HKEY_LOCAL_MACHINE\SYSTEM\WPA\Key-XXXXXXXXXXXXXXXXXXXXX<br />
<br />
Doing it the normal right click and delete it kicks out and says you can't do that BEEP )(&amp;(^^%$%$###<br />
<br />
Don't need the bloody extra ones<br />
<br />
I even tried to change the permission still no go!!!!!!<br />
<br />
plz example show me</div></div><hr />


<div class="post"><div class="posttop"><div class="username">didava</div><div class="date">3rd February 2008, 18:34</div></div><div class="posttext">what ??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rahulsubramanya</div><div class="date">10th March 2008, 12:06</div></div><div class="posttext">Hi,<br />
<br />
I am a newbie to NSIS. Currently I am in a situation where my installer need to identify a software whether already installed or not and If installed, uninstal it and continue with my installer.<br />
This software is under .../Uninstall of registry and it does not have a fixed key. The key depends on its GUID and package. But, there is one string called &quot;Display string&quot; which is constant and based on which we can search for. Can I search this string and get the key from registry and then get the UninstallString with help of key.<br />
<br />
I tried with out using Registry.dll, but looks like not possible.<br />
<br />
I tried using Registry.dll but unable to get it working I am gettting compilation error in registry.nsh at this line<br />
	registry::_Open /NOUNLOAD `${_PATH}` `${_OPTIONS}`<br />
<br />
I am using registry like this<br />
${registry::Open} &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall&quot; &quot;/K=0 /V=1 /S=1&quot; $0<br />
<br />
The error is &quot;Error in macro registry::open on macroline 1&quot;<br />
<br />
Help much appreciated<br />
<br />
Cheers<br />
Rahul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">10th March 2008, 17:41</div></div><div class="posttext">rahulsubramanya<br />
Probably there is something with the nsh file codepage. It must be not in Unicode (or maybe you are using Unicode build).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rahulsubramanya</div><div class="date">10th March 2008, 17:43</div></div><div class="posttext">Hi,<br />
Thanks for the reply<br />
How to check these compatibities? Any readme file tells this? or any source code?<br />
<br />
Can I build my self?<br />
<br />
Cheers<br />
Rahul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">10th March 2008, 17:49</div></div><div class="posttext">:) OK<br />
Are you using Unicode build (http://forums.winamp.com/showthread.php?s=&amp;threadid=277381)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">10th March 2008, 18:52</div></div><div class="posttext">Fixed: ${registry::WriteExtra} with REG_MULTI_SZ (thanks David Irwin).<br />
<br />
Added: now plugin can be compiled with GCC.<br />
<br />
<br />
&quot;Registry&quot; plugin v3.4</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grobigou</div><div class="date">16th April 2008, 11:37</div></div><div class="posttext">Hello<br />
<br />
I don't if you also have the same problem, but with the version 3.4 of the registry plugin, the program I have made does not work anymore. It's craching every time I try to launch it.<br />
If I put the version 3.3 of the plugin back, my program works fine.<br />
Does anyone have the same issue ?<br />
<br />
Antoine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">16th April 2008, 14:27</div></div><div class="posttext">What code cause crashing?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grobigou</div><div class="date">17th April 2008, 10:21</div></div><div class="posttext">Hello !<br />
<br />
Here is the code.<br />
It is like a cleaner for the registry<br />
It is looking for some value and delete them.<br />
<br />
; Un nettoyeur de Registre pour la HLU<br />
; C'est le BON<br />
; 4 itÃ©rations pour Safenet, une seule pour les autres<br />
; V1.0 : safenet, ireike, cosine, ipsecdrv et ipsecmon<br />
; V1.1 : safenet, ireike, cosine, ipsecdrv, ipsecmon et ipsec dial client<br />
; V1.2 : Av ec le nouvel environnement<br />
;--------------------------------<br />
<br />
; Ne fonctionne pas avec la V3.4 de Registry<br />
; Donc c'est la v3.3 qu'il faut mettre pour le moment<br />
<br />
!include &quot;UMUI.nsh&quot;<br />
!include &quot;Registry.nsh&quot;<br />
!include &quot;Sections.nsh&quot;<br />
VAR Reg<br />
VAR Chemin<br />
VAR Motclef<br />
VAR Iteration<br />
VAR Go<br />
<br />
XPStyle on<br />
<br />
; The name of the installer<br />
Name &quot;Registry Cleaner v1.2&quot;<br />
<br />
; The file to write<br />
OutFile &quot;Registry.Cleaner.v1.2.exe&quot;<br />
BrandingText &quot;NSIS - CrÃ©Ã© par Antoine SOUBIGOU&quot;<br />
<br />
;--------------------------------<br />
; Show details<br />
ShowInstDetails show<br />
<br />
;--------------------------------<br />
;Interface Settings<br />
  !define MUI_ABORTWARNING<br />
 ; !define MUI_HEADERIMAGE<br />
  ;!define MUI_HEADERIMAGE_BITMAP &quot;${NSISDIR}\Contrib\Graphics\Header\orange.bmp&quot; ; optional<br />
<br />
<br />
;--------------------------------<br />
;--------------------------------<br />
;--------------------------------<br />
; Pages<br />
;--------------------------------<br />
;--------------------------------<br />
;--------------------------------<br />
<br />
; D:\Program Files\NSIS\Contrib\Modern UI\ioSpecial.ini<br />
; Fichier modifiÃ© pour voir tout le titre<br />
; ligne 1235 pour espacer les lignes<br />
<br />
  !insertmacro MUI_PAGE_COMPONENTS<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_PAGE_FINISH<br />
  <br />
  <br />
;--------------------------------<br />
;Languages<br />
<br />
  !insertmacro MUI_LANGUAGE &quot;French&quot;<br />
;  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
;--------------------------------<br />
;--------------------------------<br />
; Installation de drivers cartes 3G<br />
;--------------------------------<br />
;--------------------------------<br />
<br />
Section &quot;Suppression des rÃ©pertoires&quot; Info1<br />
<br />
        ; Cette option permet de griser une case pour obliger l'installation<br />
        SectionIn RO<br />
        ReadRegStr $9 HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\&quot; &quot;ProgramFilesDir&quot;<br />
        DetailPrint &quot;Suppression des rÃ©pertoires sous $9&quot;<br />
        RMDir /r &quot;$9\Cosine Communication&quot;<br />
        RMDir /r &quot;$9\Safenet&quot;<br />
<br />
SectionEnd<br />
<br />
Section &quot;Recherche des mots clef dans le Registre&quot; Info2<br />
<br />
        StrCpy $Go &quot;1&quot;<br />
        ; Cette option permet de griser une case pour obliger l'installation<br />
        SectionIn RO<br />
        <br />
        GetTempFileName $R0<br />
        FileOpen $R1 $R0 w<br />
        <br />
        ; On Commencera avec le mot Safenet<br />
        StrCpy $Motclef &quot;safenet&quot;<br />
        ; On fera la vÃ©rification sur Safenet QUATRE fois ! ... On l'initialise Ã_ 1<br />
        StrCpy $Iteration &quot;1&quot;<br />
        <br />
        Depart:<br />
        FileWrite $R1 'Liste des clÃ©s de registre incluant la chaÃ®ne $Motclef$\r$\n'<br />
        ; Si on est sur safenet, Alors on a une chaine de caractÃ¨res diffÃ©rente<br />
        StrCmp $Motclef &quot;safenet&quot; +1 +3<br />
        DetailPrint &quot;Lancement du nettoyage de $Motclef dans la base de Registre..... ItÃ©ration $Iteration sur 4.....&quot;<br />
        Goto Suite<br />
        DetailPrint &quot;Lancement du nettoyage de $Motclef dans la base de Registre.....&quot;<br />
        <br />
 	Suite:<br />
        FileWrite $R1 '$\r$\nHKEY_CLASSES_ROOT$\r$\n$\r$\n'<br />
	StrCpy $Chemin &quot;HKCR&quot;<br />
	StrCpy $Reg &quot;1&quot;<br />
	${registry::Open} &quot;HKEY_CLASSES_ROOT&quot; &quot;/K=1 /V=1 /S=1 /B=1 /NI='$Motclef'&quot; $0<br />
	; Si c'est bon, on commence la loop, sinon on arrete tout<br />
	StrCmp $0 0 +1 loop<br />
	MessageBox MB_OK &quot;Error&quot; IDOK close<br />
<br />
        Coin2:<br />
        FileWrite $R1 '$\r$\nHKEY_CURRENT_USER$\r$\n$\r$\n'<br />
	StrCpy $Chemin &quot;HKCU&quot;<br />
        StrCpy $Reg &quot;2&quot;<br />
	${registry::Open} &quot;HKEY_CURRENT_USER&quot; &quot;/K=1 /V=1 /S=1 /B=1 /NI='$Motclef'&quot; $0<br />
	StrCmp $0 0 0 loop<br />
	MessageBox MB_OK &quot;Error&quot; IDOK close<br />
<br />
        Coin3:<br />
        FileWrite $R1 '$\r$\nHKEY_LOCAL_MACHINE$\r$\n$\r$\n'<br />
	StrCpy $Chemin &quot;HKLM&quot;<br />
	StrCpy $Reg &quot;3&quot;<br />
	${registry::Open} &quot;HKEY_LOCAL_MACHINE&quot; &quot;/K=1 /V=1 /S=1 /B=1 /NI='$Motclef'&quot; $0<br />
	StrCmp $0 0 0 loop<br />
	MessageBox MB_OK &quot;Error&quot; IDOK close<br />
<br />
        Coin4:<br />
        FileWrite $R1 '$\r$\nHKEY_USERS$\r$\n$\r$\n'<br />
	StrCpy $Chemin &quot;HKU&quot;<br />
	StrCpy $Reg &quot;4&quot;<br />
	${registry::Open} &quot;HKEY_USERS&quot; &quot;/K=1 /V=1 /S=1 /B=1 /NI='$Motclef'&quot; $0<br />
	StrCmp $0 0 0 loop<br />
	MessageBox MB_OK &quot;Error&quot; IDOK close<br />
<br />
        Coin5:<br />
        FileWrite $R1 '$\r$\nHKEY_CURRENT_CONFIG$\r$\n$\r$\n'<br />
	StrCpy $Chemin &quot;HKCC&quot;<br />
	StrCpy $Reg &quot;5&quot;<br />
	${registry::Open} &quot;HKEY_CURRENT_CONFIG&quot; &quot;/K=1 /V=1 /S=1 /B=1 /NI='$Motclef'&quot; $0<br />
	StrCmp $0 0 0 loop<br />
	MessageBox MB_OK &quot;Error&quot; IDOK close<br />
	<br />
	loop:<br />
	${registry::Find} &quot;$0&quot; $1 $2 $3 $4<br />
	StrCmp $4 '' check<br />
	StrCmp $Chemin 'HKCR' HKCRloop +1<br />
	StrCmp $Chemin 'HKCU' HKCUloop +1<br />
	StrCmp $Chemin 'HKLM' HKLMloop +1<br />
	StrCmp $Chemin 'HKU' HKUloop +1<br />
	StrCmp $Chemin 'HKCC' HKCCloop<br />
<br />
        HKCRloop:<br />
	StrCmp $4 'REG_KEY' 0 Value1<br />
	StrCmp $Go &quot;0&quot; +4<br />
        DeleteRegKey HKCR &quot;$1\$2&quot;<br />
        DetailPrint &quot;Key HKCR\$1\$2 detected&quot;<br />
        FileWrite $R1 'Delete Key : &quot;$Chemin - $1\$2&quot; $\r$\n'<br />
	goto loop<br />
        Value1:<br />
        StrCmp $Go &quot;0&quot; +4<br />
	DeleteRegValue HKCR &quot;$1&quot; &quot;$2&quot;<br />
	DetailPrint &quot;Value HKCR\$1 '$2' detected&quot;<br />
        FileWrite $R1 'Delete Value. Chemin : &quot;$Chemin\$1&quot; et la valeur : &quot;$2&quot; $\r$\n'<br />
	goto loop<br />
	<br />
        HKCUloop:<br />
	StrCmp $4 'REG_KEY' 0 Value2<br />
	StrCmp $Go &quot;0&quot; +4<br />
	DeleteRegKey HKCU &quot;$1\$2&quot;<br />
        DetailPrint &quot;Key HKCU\$1\$2 detected&quot;<br />
        FileWrite $R1 'Delete Key : &quot;$Chemin - $1\$2&quot; $\r$\n'<br />
	goto loop<br />
        Value2:<br />
        StrCmp $Go &quot;0&quot; +4<br />
	DeleteRegValue HKCU &quot;$1&quot; &quot;$2&quot;<br />
	DetailPrint &quot;Value HKCU\$1 '$2' detected&quot;<br />
        FileWrite $R1 'Delete Value. Chemin : &quot;$Chemin\$1&quot; et la valeur : &quot;$2&quot; $\r$\n'<br />
	goto loop<br />
	<br />
	HKLMloop:<br />
	StrCmp $4 'REG_KEY' 0 Value3<br />
	StrCmp $Go &quot;0&quot; +4<br />
	DeleteRegKey HKLM &quot;$1\$2&quot;<br />
        DetailPrint &quot;Key HKLM\$1\$2 detected&quot;<br />
        FileWrite $R1 'Delete Key : &quot;$Chemin - $1\$2&quot; $\r$\n'<br />
	goto loop<br />
        Value3:<br />
        StrCmp $Go &quot;0&quot; +4<br />
	DeleteRegValue HKLM &quot;$1&quot; &quot;$2&quot;<br />
	DetailPrint &quot;Value HKLM\$1 '$2' detected&quot;<br />
        FileWrite $R1 'Delete Value. Chemin : &quot;$Chemin\$1&quot; et la valeur : &quot;$2&quot; $\r$\n'<br />
	goto loop<br />
	<br />
	HKUloop:<br />
	StrCmp $4 'REG_KEY' 0 Value4<br />
	StrCmp $Go &quot;0&quot; +4<br />
	DeleteRegKey HKU &quot;$1\$2&quot;<br />
        DetailPrint &quot;Key HKU\$1\$2 detected&quot;<br />
        FileWrite $R1 'Delete Key : &quot;$Chemin - $1\$2&quot; $\r$\n'<br />
	goto loop<br />
        Value4:<br />
        StrCmp $Go &quot;0&quot; +4<br />
	DeleteRegValue HKU &quot;$1&quot; &quot;$2&quot;<br />
	DetailPrint &quot;Value HKU\$1 '$2' detected&quot;<br />
        FileWrite $R1 'Delete Value. Chemin : &quot;$Chemin\$1&quot; et la valeur : &quot;$2&quot; $\r$\n'<br />
	goto loop<br />
	<br />
	HKCCloop:<br />
	StrCmp $4 'REG_KEY' 0 Value5<br />
	StrCmp $Go &quot;0&quot; +4<br />
	DeleteRegKey HKCC &quot;$1\$2&quot;<br />
        DetailPrint &quot;Key HKCC\$1\$2 detected&quot;<br />
        FileWrite $R1 'Delete Key : &quot;$Chemin - $1\$2&quot; $\r$\n'<br />
	goto loop<br />
        Value5:<br />
        StrCmp $Go &quot;0&quot; +4<br />
	DeleteRegValue HKCC &quot;$1&quot; &quot;$2&quot;<br />
        DetailPrint &quot;Value HKCC\$1 '$2' detected&quot;<br />
        FileWrite $R1 'Delete Value. Chemin : &quot;$Chemin\$1&quot; et la valeur : &quot;$2&quot; $\r$\n'<br />
	goto loop<br />
	<br />
	Check:<br />
	StrCmp $Reg &quot;1&quot; +5<br />
	StrCmp $Reg &quot;2&quot; +5<br />
	StrCmp $Reg &quot;3&quot; +5<br />
        StrCmp $Reg &quot;4&quot; +5<br />
	StrCmp $Reg &quot;5&quot; check2<br />
        goto Coin2<br />
        goto Coin3<br />
        goto Coin4<br />
        goto Coin5<br />
<br />
        Check2:<br />
        StrCmp $Motclef &quot;safenet&quot; Safenetiteration<br />
        StrCmp $Motclef &quot;ireike&quot; Ireikechange<br />
        StrCmp $Motclef &quot;cosine&quot; Cosinechange<br />
        StrCmp $Motclef &quot;ipsecdrv&quot; Ipsecdrvchange<br />
        StrCmp $Motclef &quot;ipsecmon&quot; Ipsecmonchange<br />
        StrCmp $Motclef &quot;ipsec dial client&quot; Iteration<br />
        Safenetiteration:<br />
        StrCmp $Iteration &quot;2&quot; Iteration<br />
        StrCmp $Iteration &quot;3&quot; Iteration<br />
        StrCmp $Iteration &quot;4&quot; close<br />
        StrCpy $Motclef &quot;ireike&quot;<br />
        Goto Depart<br />
        Ireikechange:<br />
        StrCpy $Motclef &quot;cosine&quot;<br />
        Goto Depart<br />
        Cosinechange:<br />
        StrCpy $Motclef &quot;ipsecdrv&quot;<br />
        Goto Depart<br />
        Ipsecdrvchange:<br />
        StrCpy $Motclef &quot;ipsecmon&quot;<br />
        Goto Depart<br />
        Ipsecmonchange:<br />
        StrCpy $Motclef &quot;ipsec dial client&quot;<br />
        Goto Depart<br />
        Iteration:<br />
        IntOp $Iteration $Iteration + 1<br />
        StrCpy $Motclef &quot;safenet&quot;<br />
        Goto Depart<br />
<br />
	close:<br />
	${registry::Close} &quot;$0&quot;<br />
	${registry::Unload}<br />
	<br />
        FileClose $R1<br />
        DetailPrint &quot;Le fichier de LOG se trouve Ã_ $R0&quot;<br />
<br />
        ;Exec '&quot;notepad.exe&quot; &quot;$R0&quot;'<br />
<br />
        MessageBox MB_YESNO &quot;Pour finaliser le nettoyage, voulez vous redÃ©marrer votre Ordinateur ?\<br />
                                 $\n$\nSi OUI, fermer toutes vos applications et cliquez sur OUI .\<br />
                                 $\nSi NON, vous pourrez redÃ©marrer votre ordinateur manuellement&quot;\<br />
                                 IDNO Fin IDYES Redemarre<br />
        Redemarre:<br />
        Reboot<br />
        Fin:<br />
SectionEnd<br />
<br />
<br />
;Descriptions<br />
  ;Language strings<br />
  LangString DESC_Info1 ${LANG_FRENCH} &quot;Cette section supprime les rÃ©pertoires 'SafeNet' et 'Cosine Communication' du rÃ©pertoire 'Program Files'&quot;<br />
;  LangString DESC_efface ${LANG_ENGLISH} &quot;This mandatory section erase all the mobile card drivers saved under the temp folder&quot;<br />
  LangString DESC_Info2 ${LANG_FRENCH} &quot;Cette section supprime, de la base de registre, toutes clefs ou valeurs comprenant les mots Safenet, ipsecdrv, ipsecmon, cosine et ireike&quot;<br />
;  LangString DESC_copie ${LANG_ENGLISH} &quot;This mandatory section save all the mobile card drivers under a temp folder&quot;<br />
  !insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />
  !insertmacro MUI_DESCRIPTION_TEXT ${Info1} $(DESC_Info1)<br />
  !insertmacro MUI_DESCRIPTION_TEXT ${Info2} $(DESC_Info2)<br />
  !insertmacro MUI_FUNCTION_DESCRIPTION_END<br />
  <br />
  <br />
Function .onInit<br />
	Call admin<br />
	MessageBox MB_YESNO &quot;Vous Ãªtes sur le point de lancer un nettoyage de votre base de registre. $\nVeuillez SVP vous assurer que tout kit de connexion et SafeNet sont effectivement fermÃ©s ou dÃ©sinstallÃ©s\<br />
        $\n$\nYou are about to clean you registry data base. $\nPlease ensure that any connection kit or SafeNet is completely closed or uninstalled&quot; IDYES gogogo<br />
	Abort<br />
	gogogo:<br />
FunctionEnd<br />
<br />
; Une fonction Admin pour empecher l'installation en Single User<br />
Function admin<br />
	ClearErrors<br />
	UserInfo::GetName<br />
	ifErrors Win9x<br />
	Pop $0<br />
	UserInfo::GetAccountType<br />
	Pop $1<br />
	UserInfo::GetOriginalAccountType<br />
	Pop $2<br />
	StrCmp $1 &quot;Admin&quot; 0 +3<br />
	Goto done<br />
	StrCmp $1 &quot;User&quot; 0 +3<br />
		MessageBox MB_OK 'Administrator Rights requiered'<br />
		Abort<br />
	StrCmp $1 &quot;Guest&quot; 0 +3<br />
		MessageBox MB_OK 'Administrator Rights requiered'<br />
		Abort<br />
	MessageBox MB_OK &quot;Unknown error&quot;<br />
	Abort<br />
<br />
	Win9x:<br />
		MessageBox MB_OK &quot;Error! This DLL can't run under Windows 9x!&quot;<br />
	done:<br />
FunctionEnd<br />
<br />
I hope it can help you !<br />
<br />
Antoine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">17th April 2008, 21:36</div></div><div class="posttext">Fixed: search with /NI option.<br />
<br />
<br />
&quot;Registry&quot; plugin v3.5</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rixor</div><div class="date">5th May 2008, 21:07</div></div><div class="posttext">Hello Instructor,<br />
<br />
Forgive me if this was answered somewhere, but I never saw it explicitly detailed in this thread: Does your plugin work for the Unicode branch of NSIS (after converting the NSH to Unicode format)?<br />
<br />
The reason I ask is because I am having trouble using the CopyValue function. It doesn't seem to be working, and when I check the error code with a message box (just like you do in the example), I get a square instead of a number (check the attachment).<br />
<br />
The lines that use the function are as follows:<br />
<br />
${registry::CopyValue} &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Texas Instruments\CCS_C:|CCStudio_v3.3|&quot; &quot;CC_APP&quot; &quot;HKEY_LOCAL_MACHINE\SOFTWARE\FireSync5\CCS_Backup\CCS_C:|CCStudio_v3.3|&quot; &quot;CC_APP&quot; $R0<br />
	MessageBox MB_OK &quot;registry::CopyValue$\n$\n\<br />
			Errorlevel: [$R0]&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrdamm</div><div class="date">28th June 2008, 02:22</div></div><div class="posttext">Hello folks.<br />
<br />
Can anyone explain how to use WriteRegMultiStr to write a registry value of data type REG_MULTI_SZ?<br />
<br />
For example, I have these registry entries taken from a .REG file. How can I use the values using WriteRegMultiStr?<br />
<br />
<br />
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\MUI\UILanguages\pt-BR]<br />
&quot;en-US&quot;=hex(7):00,00,00,00</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">30th June 2008, 06:46</div></div><div class="posttext">mrdamm<br />
${registry::Write} &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\MUI\UILanguages\pt-BR&quot; &quot;en-US&quot; &quot;&quot; &quot;REG_MULTI_SZ&quot; $0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vc6</div><div class="date">1st July 2008, 19:34</div></div><div class="posttext">The documentation for Registry Export (save to the file in REGEDIT4 format) includes:<br />
<br />
	/D=[0|1|2]<br />
	/D=0  - Don't delete any keys (default)<br />
	/D=1  - Delete only root key before restoring<br />
	/D=2  - Delete keys before restoring<br />
<br />
I understand option /D=0 in the context of ${registry::SaveKey}, but what does /D=2 mean in this context? <br />
<br />
AFAIK ${registry::SaveKey} does not have any restore side effect, so what does &quot;Delete keys before restoring&quot; mean?<br />
<br />
Thanks,<br />
Victor<br />
<br />
P.S. BTW, ${registry::RestoreKey} doesn't work for me for some reason.<br />
     ExecWait 'regedit /s &quot;$INSTDIR\${regedit4file}&quot;' works very well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrdamm</div><div class="date">9th July 2008, 23:56</div></div><div class="posttext">Originally posted by Instructor <br />
${registry::Write} &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\MUI\UILanguages\pt-BR&quot; &quot;en-US&quot; &quot;&quot; &quot;REG_MULTI_SZ&quot; $0<br />
<br />
Hey, wait. Am I doing something wrong or what? I tried to compile the program with MakeNSISW and it stops compiling when the compiler reaches the code provided by you.<br />
In fact, all codes that I use in the script, regarded to registry entries are like the following:<br />
<br />
    WriteRegDWORD HKEY_LOCAL_MACHINE SYSTEM\CurrentControlSet\Control\MUI\UILanguages\pt-BR LCID 1046<br />
    WriteRegStr HKEY_LOCAL_MACHINE SYSTEM\CurrentControlSet\Control\MUI\UILanguages\pt-BR DefaultFallback en-US<br />
    WriteRegDWORD HKEY_LOCAL_MACHINE SYSTEM\CurrentControlSet\Control\MUI\UILanguages\pt-BR Type 274<br />
    WriteRegStr HKLM &quot;${REGKEY}\Components&quot; &quot;Registry Section&quot; 1<br />
<br />
Any clues?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ovatsus</div><div class="date">29th August 2008, 19:41</div></div><div class="posttext">Unfortunately the plugin doesn't work correctly when reading REG_MULTI_SZ values on 64-bit. It always goes to the Wow6432 node, even after SetRegView 64. Can you please help?<br />
<br />
Best Regards,<br />
Gustavo Guerra</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mtconleyuk</div><div class="date">12th November 2008, 11:58</div></div><div class="posttext">You might consider adding a <br />
<br />
!ifndef REGISTRY_LIB<br />
 [...]<br />
!endif ; REGISTRY_LIB<br />
<br />
around the contents of registry.nsh to allow scripts to include it more than once (e.g., in two different .nsi files, one of which is included in the other). See LogicLib.nsh for an example.<br />
<br />
Otherwise, great library!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mtconleyuk</div><div class="date">12th November 2008, 12:01</div></div><div class="posttext">... Obviously, there has to be a !define REGISTRY_LIB in there, too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">groove1963</div><div class="date">15th January 2009, 17:45</div></div><div class="posttext">Hi,<br />
<br />
I have a strange problem with a &quot;registry::find&quot; in an installer which at the moment only seems to occur when the installer is used on an iMac (running Windows XP).<br />
<br />
The &quot;registry::find&quot; is using 100% CPU, memory consumption is going up to 1 GB, then back down to about 15 MB, but the call never returns to the main code.<br />
<br />
The parameters of the failing call to &quot;registry::find&quot; are:<br />
<br />
 2190896<br />
 SOFTWARE\Microsoft\Cryptography\Defaults\Provider Types\Type 024 Name microsoft enhanced rsa and aes cryptographic provider (prototype)<br />
 REG_SZ<br />
<br />
<br />
Here is the code fragment using the registry find (it is scanning the registry for USB 2.0 high speed controllers):<br />
<br />
	${registry::Open} &quot;HKEY_LOCAL_MACHINE&quot; &quot;/K=0 /V=1 /S=1 /NI='enhanced' /T=REG_SZ&quot; $0	<br />
	${registry::Find} $0 $1 $2 $3 $4<br />
	${While} $4 != &quot;&quot;<br />
		${StrCase} $3 &quot;$3&quot; &quot;L&quot;<br />
		${StrLoc} $5 $3 &quot;controller&quot; &quot;&gt;&quot;<br />
		${If} $5 != &quot;&quot;<br />
			${StrLoc} $5 $3 &quot;usb&quot; &quot;&gt;&quot;<br />
			${If} $5 != &quot;&quot;<br />
				StrCpy $UsbEnhancedController $3<br />
				${ExitWhile}<br />
			${EndIf}<br />
		${EndIf}<br />
		${registry::Find} $0 $1 $2 $3 $4<br />
	${EndWhile}<br />
	<br />
	${registry::Close} $0<br />
	${registry::Unload}<br />
<br />
<br />
Any suggestions?<br />
<br />
- Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">16th January 2009, 14:24</div></div><div class="posttext">groove1963<br />
Try &quot;RegistryTest.nsi&quot; and &quot;Search and write founded in text file&quot; with &quot;HKEY_LOCAL_MACHINE&quot;. It may help to find where is the problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mguenette</div><div class="date">6th February 2009, 14:18</div></div><div class="posttext">I have a situation where I have to read and write a binary registry value a more than 1024 caracters.<br />
Is there a way to do this???<br />
Please.<br />
<br />
Thanks.<br />
<br />
The plugin is great by the way!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">6th February 2009, 15:04</div></div><div class="posttext">If the plugin is coded correctly, you could use the large nsis string build ( http://nsis.sourceforge.net/Special_Builds ) if not, you might have to use some external tool, regedit.exe or reg.exe or something custom.<br />
<br />
NOTE: you are NOT really supposed to store large things in the registry ( &gt; 1024b ) <br />
<br />
from MSDN:<br />
&quot;Generally, data consisting of more than one or two kilobytes (K) should be stored as a file and referred to by using a key in the registry rather than being stored as a value. Instead of duplicating large pieces of data in the registry, an application should save the data as a file and refer to the file. Executable binary code should never be stored in the registry.&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mguenette</div><div class="date">6th February 2009, 15:24</div></div><div class="posttext">I Know I'm not supposed to do that, but a software that we use does that and I'm want to implement an automation to configure that application.<br />
<br />
Any other ideas???</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">6th February 2009, 15:36</div></div><div class="posttext">I already said, try the large string build, if the plugin can't handle that, you must use a external tool</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mguenette</div><div class="date">6th February 2009, 15:43</div></div><div class="posttext">Guess I will be using an external tool then.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">7th February 2009, 14:23</div></div><div class="posttext">so you tested, and the large string build does not work? if so, its a bug in the registry plugin...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">8th February 2009, 14:07</div></div><div class="posttext">mguenette<br />
See ${registry::ReadExtra} and ${registry::WriteExtra}.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">8th February 2009, 17:01</div></div><div class="posttext">I am trying to build the registry plugin (v3.5) using VC2005 on XP and I get the following link errors:   Creating library .\Release/registry.lib and object .\Release/registry.exp<br />
registry.obj : error LNK2019: unresolved external symbol ___security_cookie referenced in function _xitoaA<br />
registry.obj : error LNK2019: unresolved external symbol @__security_check_cookie@4 referenced in function _xitoaA<br />
registry.obj : error LNK2019: unresolved external symbol _memset referenced in function _xitoaA<br />
registry.obj : error LNK2019: unresolved external symbol _memcpy referenced in function __WriteExtra<br />
<br />
If I change the default project setting (as came with the plugin) to *not* ignore all default libraries (i.e. remove /NODEFAULTLIB), then it builds OK.<br />
<br />
However, it seems to me that removing /NODEFAULTLIB will create problems down the road (see http://forums.winamp.com/showthread.php?threadid=302413 ).<br />
<br />
What is the proper way to build Registry Plugin v3.5? What am I missing?<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">8th February 2009, 17:05</div></div><div class="posttext">The post you are already linking to tells you what to do:<br />
<br />
&quot;So I manually defined the entry point and disabled &quot;Buffer Security Check&quot; (/GS-).&quot;<br />
<br />
&quot;Got rid of the last errors by setting &quot;Basic Runtime Checks&quot; to &quot;Default&quot; in the project properties.&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">8th February 2009, 17:29</div></div><div class="posttext">Originally posted by Anders <br />
The post you are already linking to tells you what to do:<br />
<br />
&quot;So I manually defined the entry point and disabled &quot;Buffer Security Check&quot; (/GS-).&quot;<br />
<br />
&quot;Got rid of the last errors by setting &quot;Basic Runtime Checks&quot; to &quot;Default&quot; in the project properties.&quot; <br />
Sorry, I failed to mention that I already verified that &quot;Basic Runtime Checks&quot; is set to &quot;Default&quot;.<br />
<br />
With &quot;Buffer Security Check&quot; disabled (/GS-), I still receive the following errors (yes, DllMain is set as the entry point):<br />
registry.obj : error LNK2019: unresolved external symbol _memset referenced in function _xitoaA<br />
registry.obj : error LNK2019: unresolved external symbol _memcpy referenced in function __WriteExtra<br />
<br />
<br />
Other ideas?<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">8th February 2009, 21:03</div></div><div class="posttext">Originally posted by nsnb <br />
<br />
With &quot;Buffer Security Check&quot; disabled (/GS-), I still receive the following errors (yes, DllMain is set as the entry point):<br />
<br />
Other ideas?I solved the problem. :)<br />
<br />
I simply downloaded the NSIS source code and copied memset.c and memcpy.c from the SCons\Config directory. The plugin now builds perfectly. I can now proceed to modifying it. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Niko49</div><div class="date">9th February 2009, 10:54</div></div><div class="posttext">Hello everybody,<br />
<br />
I tested the plugin's with WIN CE 5.0. <br />
<br />
It can read and open key register but not write.<br />
<br />
Has you seen this problem on this OS?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">10th February 2009, 19:31</div></div><div class="posttext">Originally posted by Niko49 <br />
I tested the plugin's with WIN CE 5.0. <br />
<br />
It can read and open key register but not write.<br />
<br />
Has you seen this problem on this OS? <br />
I haven't tried NSIS on WinCE but you may want to look at the numerous #ifdef POCKETPC in registry.c - some code is compiled conditionally and registry::RestoreKey, for example, is disabled for POCKETPC.<br />
<br />
BTW, I have added one function to the plugin, named registry::SaveValue. You can find it in the following thread:<br />
<br />
 http://forums.winamp.com/showthread.php?postid=2484404#post2484404<br />
<br />
It would be nice if Instructor could add it officially to his plugin. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Niko49</div><div class="date">12th February 2009, 12:24</div></div><div class="posttext">I use &quot;Registry NSIS plugin v3.5 for Pocket PC&quot;<br />
<br />
Yes please Instructor, add it officially to his plugin!!!!<br />
<br />
I prefer use the plugin official.<br />
<br />
Thank you a lot!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">groove1963</div><div class="date">3rd March 2009, 19:09</div></div><div class="posttext">Originally posted by Instructor <br />
groove1963<br />
Try &quot;RegistryTest.nsi&quot; and &quot;Search and write founded in text file&quot; with &quot;HKEY_LOCAL_MACHINE&quot;. It may help to find where is the problem. <br />
<br />
Finally found time for some more testing, I was able to narrow down the problem (tested with latest versiion of the NSIS registry plugin).<br />
<br />
This is my test program - scans the HKLM path for entries containing the string &quot;enhanced&quot;:<br />
<br />
<br />
!include Library.nsh<br />
!include &quot;Registry.nsh&quot;<br />
<br />
Name &quot;MyRegistryTest&quot;<br />
OutFile &quot;MyRegistryTest.exe&quot;<br />
InstallDir $PROGRAMFILES\MyRegistryTest<br />
<br />
RequestExecutionLevel admin<br />
AllowRootDirInstall false<br />
<br />
ShowInstDetails show<br />
<br />
Section MySection<br />
<br />
	${registry::Open} &quot;HKEY_LOCAL_MACHINE&quot; &quot;/B=1 /K=0 /V=1 /S=1 /NI='enhanced' /T=REG_SZ&quot; $0	<br />
<br />
	StrCmp $0 0 0 loop<br />
	MessageBox MB_OK &quot;Error&quot; IDOK close<br />
<br />
	loop:<br />
		${registry::Find} &quot;$0&quot; $1 $2 $3 $4<br />
<br />
		StrCmp $4 '' close<br />
		DetailPrint &quot;$1 $2 $3 $4&quot;<br />
		goto loop<br />
<br />
	close:<br />
		${registry::Close} &quot;$0&quot;<br />
		${registry::Unload}<br />
<br />
SectionEnd<br />
<br />
<br />
Works fine on my development machine and on a couple of other machines.<br />
<br />
If I add the key below to the registry (taken from the registry of a machine where my installer gets stuck), then registry::Find will go to an infinite internal loop using 100% CPU:<br />
<br />
<br />
Windows Registry Editor Version 5.00<br />
<br />
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceClasses\{6994AD04-93EF-11D0-A3CC-00A0C9223196}]<br />
<br />
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceClasses\{6994AD04-93EF-11D0-A3CC-00A0C9223196}\##?#HDAUDIO#FUNC_01&amp;VEN_10EC&amp;DEV_0885&amp;SUBSYS_106B3E00&amp;REV_1001#4&amp;1D21CA73&amp;0&amp;0001#{6994ad04-93ef-11d0-a3cc-00a0c9223196}\#DigitalInputWave\Device Parameters\Mixer\0\Controls\0]<br />
&quot;Control Type&quot;=dword:70010001<br />
&quot;Multiple Items&quot;=dword:00000001<br />
&quot;Item0&quot;=dword:00000001<br />
<br />
<br />
I suspect that it is the length or depth of the registry path, because if I shorten some parts of the registry entry, the registry::Find works again.<br />
<br />
(test program and registry file attached as a zip file)<br />
<br />
Any suggestions?<br />
<br />
Best regards<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">4th March 2009, 08:10</div></div><div class="posttext">Added: ${SaveKey} &quot;/N=[name]&quot; option to save only specified value.<br />
<br />
Fixed: processing 260 characters path.<br />
<br />
<br />
&quot;Registry&quot; plugin v3.6</div></div><hr />


<div class="post"><div class="posttop"><div class="username">groove1963</div><div class="date">9th March 2009, 06:47</div></div><div class="posttext">Hello &quot;Instructor&quot;,<br />
<br />
I just tested the 3.6 version you posted a couple of days ago. <br />
<br />
Fixed: processing 260 characters path.<br />
&quot;Registry&quot; plugin v3.6<br />
<br />
Unfortunately, the problem described in my posting is not fixed - although the errors are now a bit different:<br />
<br />
When I now search with the example code and registry entry posted above, I get an access violation &quot;... encountered a problem and needs to close&quot;, error description is:<br />
<br />
AppName: myregistrytest.exe	 AppVer: 0.0.0.0	 ModName: user32.dll<br />
ModVer: 5.1.2600.5512	 Offset: 00008d4e<br />
<br />
By the way, when testing this, I made one test run with /N instead of /NI to make a case sensitive search. In this test run, the code did not crash but now again got stuck in the infinite loop on the long registry key described above.<br />
<br />
Any suggestions?<br />
<br />
Regards<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">9th March 2009, 20:18</div></div><div class="posttext">groove1963<br />
Problem isn't reproduced.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">groove1963</div><div class="date">17th March 2009, 11:18</div></div><div class="posttext">Problem isn't reproduced<br />
<br />
Well, the test program I posted which does nothing except the registry search crashes when I build it with the 3.6 version. When build with the 3.5 version it gets stuck in an infinite loop as described before when, so there seems to be some problem related to the registry plugin.<br />
<br />
Can you give me any hint how I could help to narrow down the problem if you cannot reproduce it?<br />
<br />
Regards<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">groove1963</div><div class="date">23rd March 2009, 09:28</div></div><div class="posttext">Did some more testing today, same behaviour with the 3.6 DLL after upgrading to NSIS 2.44 (I was using 2.37 before):<br />
<br />
<br />
 Access violation with the /NI search<br />
 Infinite loop on the {6994AD04-93EF-11D0-A3CC-00A0C9223196} registry key quoted above with the /N or /NS search<br />
<br />
<br />
Then I did another test with the large string build of NSIS 2.44, same behaviour, no difference.<br />
<br />
Then I coded a test scan of HKLM without using the search option:<br />
<br />
<br />
	${registry::Open} &quot;HKEY_LOCAL_MACHINE&quot; &quot;/B=1 /T=REG_SZ&quot; $0	<br />
	<br />
	StrCmp $0 0 0 loop<br />
	MessageBox MB_OK &quot;Error&quot; IDOK close<br />
<br />
	loop:<br />
		${registry::Find} &quot;$0&quot; $1 $2 $3 $4<br />
		StrCmp $4 '' close<br />
		goto loop<br />
<br />
	close:<br />
		${registry::Close} &quot;$0&quot;<br />
		${registry::Unload}<br />
<br />
<br />
This got stuck again in an infinite loop on the {6994AD04-93EF-11D0-A3CC-00A0C9223196} registry key (like the /N or /NS searches).<br />
<br />
I have downloaded the 3.6 version another time to make sure I was really using the right version, same results.<br />
<br />
Unfortunately no version is visible in the DLL attributes and the 3.5 and 3.6 versions DLL size is 16.384. However the source comment in the header of the registry.c file included in the 3.6 version says &quot;v3.4&quot; ...<br />
<br />
Any suggestions? If I don't find a solution for this quickly, I'll have to hand-code a plugin to search for this specific registry string :(<br />
<br />
Regards<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">23rd March 2009, 13:21</div></div><div class="posttext">See &quot;registry.zip\Desktop\Readme.txt&quot; version it must be 3.6.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">groove1963</div><div class="date">23rd March 2009, 14:54</div></div><div class="posttext">See &quot;registry.zip\Desktop\Readme.txt&quot; version it must be 3.6.<br />
<br />
OK, just checked this, the text in the readme.txt was 3.4.<br />
<br />
I checked the download date of the file, was after the 3.6 fix, so I cleared the browser cache, re-downloaded the 3.6 version, now the readme.txt is 3.6 ...<br />
<br />
... and the bug is fixed! Thanks a lot!<br />
<br />
Best regards<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RajaW</div><div class="date">8th September 2009, 19:23</div></div><div class="posttext">Thank you for writing this plugin. I have found it very useful. I seem so have found a small bug. The registry::Read function does not appear to work on Windows 7 (RTM) for GUID keys under the Uninstall section. <br />
<br />
Example:<br />
<br />
<br />
${registry::Read} &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{B7643B11-A60E-4A33-A465-263FEB32113A}&quot; &quot;UninstallString&quot; $R0 $R1<br />
MessageBox MB_OK 'registry::Read$\n$\n\<br />
 			$$R0    &quot;string&quot; =[$R0]$\n\<br />
 			$$R1    &quot;type&quot;   =[$R1]$\n'<br />
<br />
<br />
I used the code from your example provided. The above code  does work properly on Windows Server 2003. The above code pulls blank values on Windows 7. The data retrieved on Windows Server 2003 is:<br />
<br />
string = MsiExec.exe /X{B7643B11-A60E-4A33-A465-263FEB32113A}<br />
type = REG_EXPAND_SZ<br />
<br />
I hope this helps.<br />
<br />
Kind regards,<br />
-=Raj=-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glab</div><div class="date">14th September 2009, 23:40</div></div><div class="posttext">I also have an issue with Windows 7 (64 bit).<br />
<br />
The following operation results in an unsuccessful open.<br />
<br />
<br />
  ;Open registry for search<br />
  ${registry::Open} &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData&quot; &quot;/K=0 /V=0 /S=1 /N='Application X' /T=REG_SZ&quot; $0<br />
<br />
  ;If open successful, find the entry we are interested in.<br />
  StrCmp $0 0 0 find<br />
  <br />
  ;If open unsuccessful, abort with error<br />
  Goto error<br />
<br />
<br />
Through RegEdit I have checked the registry entry I am attempting to open and confirmed its existence. The issue only appears with the 64 bit version of windows 7, this works for the 32 bit version of Windows 7.<br />
<br />
Having 'Application X' installed under C:\Program Files\ instead of C:\Program Files (x86)\ doesn't solve the problem in opening its registry entry.<br />
<br />
Thoughts?<br />
<br />
Thanks and regards.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ChocJunkie</div><div class="date">26th October 2009, 13:28</div></div><div class="posttext">Hi <br />
<br />
I'm kind of struggeling using the RestoreKey functionality. I'm using:${registry::RestoreKey} &quot;$PLUGINSDIR\myReg.reg&quot; $0 The variable $0 contains '0' after the execution, but the registry key doesn't show up in the registry editor.<br />
If I'm executing the file by hand, the registry value shows up.<br />
<br />
Any ideas?<br />
<br />
Thanks :)<br />
<br />
CJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brewster333</div><div class="date">26th October 2009, 16:47</div></div><div class="posttext">Hello! I need to delete keys from HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USB key. Standard NSIS function can't do this. May be this plugin helps me?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">26th October 2009, 16:57</div></div><div class="posttext">Originally posted by Brewster333 <br />
Hello! I need to delete keys from HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USB key. Standard NSIS function can't do this.  <br />
Yes it can. You probably need administrative priviledges.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brewster333</div><div class="date">26th October 2009, 17:28</div></div><div class="posttext">Originally posted by MSG <br />
Yes it can. You probably need administrative priviledges.  <br />
<br />
I've test it (on Windows Vista). But user with administrative rights can't delete nodes in HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USB\. Using RegSetKeySecurity (WinAPI) is needed to do this I suppose...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ChocJunkie</div><div class="date">27th October 2009, 11:52</div></div><div class="posttext">No ideas about my problem?<br />
<br />
--- EDIT ---<br />
<br />
I've found accidently found the problem.<br />
<br />
I'm executing RestoreKey, logging a related status message and deleting the file used by the plug-in. If I don't delete the file or Sleep some ms, everything works fine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ChocJunkie</div><div class="date">29th October 2009, 11:16</div></div><div class="posttext">I came to notice no flag/constant indicates if the header file has already been included.<br />
What's about include the !ifndef...!define comands in the plugin? Or does no one else need it?<br />
<br />
CJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gringoloco023</div><div class="date">14th December 2009, 12:13</div></div><div class="posttext">Would there be any chance to get an update of Registry.dll what works with Unicode NSIS ?<br />
<br />
Thanx !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">carillan</div><div class="date">16th December 2009, 16:16</div></div><div class="posttext">I'm trying to create a REG_MULTI_SZ key with several values, but i have no way to give it more than one value. How should I give the values? I've tried separating with &quot;\n&quot; and &quot;\0&quot; but it didn't work.<br />
<br />
I use this instruction:<br />
${registry::Write} &quot;HKCU\${COMPANY_REGKEY}\Settings&quot; &quot;Name&quot; &quot;Generic Value&quot; &quot;REG_MULTI_SZ&quot; $R0<br />
Thaks in advance!<br />
carillan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gringoloco023</div><div class="date">19th December 2009, 14:19</div></div><div class="posttext">I've included some scripts which should do the job !<br />
<br />
The reader I've used myself and works fine, but you'll have to make some modifications to store the value into a string !<br />
<br />
The writer I haven't tried jet !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ChocJunkie</div><div class="date">5th January 2010, 08:05</div></div><div class="posttext">Has the 64bit problem been solved? Or are there any ideas for a workaround?<br />
<br />
CJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gringoloco023</div><div class="date">30th January 2010, 23:41</div></div><div class="posttext">I recompiled it my self in the end !<br />
<br />
Although I tested it thoroughly, there could still be some minor issues.<br />
Let me know if there is any behavior difference compared with the ansi version.<br />
<br />
portableapps.com/node/21879<br />
<br />
By the way: MULTI_SZ needs '$\n'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mj_blue</div><div class="date">20th December 2010, 09:47</div></div><div class="posttext">Hi,<br />
<br />
I am trying to clean up the registry from some previous bad installations and have about 30 entries registry keys called:<br />
<br />
HKEY_LOCAL_MACHINE\SOFTWARE\MozillaPlugins\@antixlabs.com/npagp,version={VERSION}<br />
<br />
where version varies.<br />
<br />
I wanted to loop through and delete all these but currently when I do this it seems to find 9 entries and then find returns blank entry. If I run it again it find more entries until another blank entry is returned.<br />
<br />
My code is below, am I doing something wrong?<br />
<br />
${registry::Open} &quot;HKLM\SOFTWARE\MozillaPlugins&quot; '/K=1 /V=0 /S=0 /NS=&quot;@antixlabs&quot;' $0<br />
	StrCmp $0 0 0 loopkey<br />
	MessageBox MB_OK &quot;Error&quot; IDOK closemozillakeyfind<br />
	goto closemozillakeyfind<br />
<br />
	loopkey:<br />
	${registry::Find} &quot;$0&quot; $1 $2 $3 $4<br />
	StrCmp $4 '' closemozillakeyfind 0<br />
        ${registry::DeleteKey} &quot;HKEY_LOCAL_MACHINE\$1\$2&quot; $R1<br />
        goto loopkey<br />
<br />
        closemozillakeyfind:<br />
	${registry::Close} &quot;$0&quot;<br />
	${registry::Unload}<br />
<br />
Thanks for any help in this<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sentromed</div><div class="date">6th February 2011, 12:02</div></div><div class="posttext">Instructor,<br />
<br />
Please add support of &quot;SetRegView 64&quot; or something similar to it. I used v3.6.<br />
I am running 32-bit installer on 64-bit Windows system. My issue is that value is wirtten to &quot;Software\Wow6432Node\&quot; instead of &quot;Software\&quot;<br />
<br />
Thanks,<br />
Valery.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th February 2011, 23:11</div></div><div class="posttext">This plug-in needs updating.For NSIS plug-ins, the extra_parameters-&gt;g_exec_flags-&gt;alter_reg_view field will be set to KEY_WOW64_64KEY if the calling script used SetRegView 64. The plug-in would need to use this field accordingly. I do not know if the Registry plug-in does this, but if not it needs to be modified to do so.Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">isawen</div><div class="date">31st July 2011, 22:14</div></div><div class="posttext">Did any of you used this plugin with the Unicode version of NSIS?<br />
I don't know why but it doesn't work. Could someone give me a clue in this?<br />
<br />
Thanks,<br />
Isawen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gringoloco023</div><div class="date">1st August 2011, 10:14</div></div><div class="posttext">... to use in Unicode Nsis<br />
<br />
On the following web page their are a few converted plug-ins, including the Registry one: <br />
http://portableapps.com/node/21879</div></div><hr />


<div class="post"><div class="posttop"><div class="username">isawen</div><div class="date">1st August 2011, 16:50</div></div><div class="posttext">... to use in Unicode Nsis<br />
<br />
On the following web page their are a few converted plug-ins, including the Registry one: <br />
http://portableapps.com/node/21879<br />
<br />
Thanks gringoloco023, you did a good job with it. <br />
At a first try the plugin methods are working. Is there any drawback in this unicode plugin?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gringoloco023</div><div class="date">2nd August 2011, 08:32</div></div><div class="posttext">I done a basic test on every function after I converted it.<br />
<br />
That said, we only used it in the portableapps.com launchers.<br />
The launchers basically only use the following functions:<br />
<br />
 CopyKey<br />
 MoveKey<br />
 SaveKey<br />
 RestoreKey<br />
<br />
And that on Windows XP to Windows 7 and Wine.<br />
<br />
So using any other function you'd wanna be a little bit more carefull, but it should be fine.<br />
<br />
regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">7th August 2011, 13:02</div></div><div class="posttext">Added: full unicode support on NSIS Unicode.<br />
Added: support for SetRegView 64.<br />
Added: export key contents to the file in unicode &quot;Windows Registry Editor Version 5.00&quot; format.<br />
<br />
<br />
Registry plugin v4.0 (http://nsis.sourceforge.net/Registry_plug-in)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vicokoby</div><div class="date">11th August 2011, 23:26</div></div><div class="posttext">The version 4 convert string to hex different to version 3.5, this is a bug?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">12th August 2011, 20:06</div></div><div class="posttext">Added: separate functions:<br />
<br />
 ${registry::StrToHexA} - convert string to ansi hex values;<br />
 ${registry::StrToHexW} - convert string to unicode hex values.<br />
For backward compatibility: ${registry::StrToHex} is the same as ${registry::StrToHexA}.<br />
<br />
Added: separate functions:<br />
<br />
 ${registry::HexToStrA} - convert ansi hex values to string;<br />
 ${registry::HexToStrW} - convert unicode hex values to string.<br />
For backward compatibility: ${registry::HexToStr} is the same as ${registry::HexToStrA}.<br />
<br />
<br />
Registry plugin v4.1 (http://nsis.sourceforge.net/Registry_plug-in)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vicokoby</div><div class="date">12th August 2011, 21:11</div></div><div class="posttext">Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vicokoby</div><div class="date">13th August 2011, 19:04</div></div><div class="posttext">The Version 4 always need elevation?, The gringoloco modified version allow make changes in hkcu root key without elevation, the new version 4.x not allow make changes in any key without elevation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">14th August 2011, 08:44</div></div><div class="posttext">vicokoby<br />
Note:<br />
${registry::RestoreKey} simply exec regedit:  regedit /s &quot;[file]&quot;gringoloco023 wrote own &quot;registry::RestoreKey&quot; implementation without regedit execution.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gringoloco023</div><div class="date">14th August 2011, 10:08</div></div><div class="posttext">gringoloco023 wrote own &quot;registry::RestoreKey&quot; implementation without regedit execution. <br />
<br />
We had a few reasons for that.<br />
In the ANSI days we never used ${registry::RestoreKey} cause it doesn't wait for regedit to finish it's job and somehow (I can't remember now) it was preferable to use Reg.exe.<br />
Like this: <br />
 nsExec::ExecToStack `&quot;$SYSDIR\reg.exe&quot; import &quot;${_FILE}&quot;`<br />
<br />
The main reason I rewrote the ${registry::RestoreKey} was that Wine has a bug in regedit / Reg.exe with Windows Registry Editor Version 5.00 files. It crashes Wine.<br />
<br />
Still, I'm not really certain that vicokoby was refering to the ${registry::RestoreKey} function.<br />
<br />
Ps. : Do not be to impressed by the code, it was basically my first C project ;).<br />
<br />
Edit: another bug we found was, when trying to MoveKey from HKLM to HKCU without the needed privileges, MoveKey returned an error, but copied the whole key to HKCU anyway while not being able to delete the HKLM key.<br />
We made a quick fix for it in our launcher code. see: http://portableapps.hg.sourceforge.net/hgweb/portableapps/launcher/rev/162fff2d5a0f#l1.130<br />
<br />
regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DraGula0</div><div class="date">26th August 2011, 10:25</div></div><div class="posttext">Hello !<br />
This script is amazing for registry manipulation.<br />
<br />
But on the research I can not process the results.<br />
 I would find keys &quot;Desktop Integration&quot; in many places (in the hive Key Users), and then modify a String value that can be found here &quot;\Desktop Integration \ 1 \ URL&quot;<br />
 How can I get the result of &quot;Desktop Integration&quot; and then add the key &quot;1&quot; to finally fulfill my pre-field &quot;URL&quot;?<br />
 Is it possible?<br />
<br />
 Thank you ... I'm lost!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">highend</div><div class="date">16th September 2011, 01:17</div></div><div class="posttext">@gringoloco023<br />
<br />
So your modified version of the registry plugin automatically waits until a command (savekey, restorekey, etc.) is fully executed (and I don't have to use sleep commands after such a command)?<br />
<br />
Apart from that, thanks for providing it, I just stumbled upon the issue (with the original plugin) that I can't use restorekey with RequestExecutionLevel user. It won't import a .reg file even if it contains only hkcu entries and because I use NSIS to make portable setups this is a big showstopper...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">11th October 2011, 13:37</div></div><div class="posttext">Delete</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ChristianGeek</div><div class="date">18th October 2011, 04:06</div></div><div class="posttext">I'm attempting the following but just getting blank strings for the value and type:<br />
<br />
${registry::Read} &quot;HKLM\SOFTWARE\Microsoft\Cryptography&quot; &quot;MachineGuid&quot; $MACHGUID $1<br />
<br />
However the following returns 0, indicating the key exists:<br />
<br />
${registry::KeyExists} &quot;HKLM\SOFTWARE\Microsoft\Cryptography&quot; $2<br />
<br />
Is this key not readable for some reason?<br />
<br />
TIA.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">David Pi</div><div class="date">17th November 2011, 16:39</div></div><div class="posttext">Hi Instructor! I love your plugin! Would you add support of 64-bit keys? 'SetRegView 64' don't work. I need to use ${registry::movekey} on some 64-bit keys.<br />
<br />
Thanks!<br />
<br />
Regards,<br />
David Pi<br />
<br />
Add: I've just download the version 4.1. And found it works perfect with 'SetRegView 64'. I've been using an old version before. Sorry for this post!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">8th January 2012, 23:20</div></div><div class="posttext">solved</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PoRtAbLe_StEaLtH</div><div class="date">8th August 2012, 11:55</div></div><div class="posttext">Hi Instructor! I love your plugin! Would you add support of 64-bit keys? 'SetRegView 64' don't work. I need to use ${registry::movekey} on some 64-bit keys.<br />
<br />
Thanks!<br />
<br />
Regards,<br />
David Pi<br />
<br />
Add: I've just download the version 4.1. And found it works perfect with 'SetRegView 64'. I've been using an old version before. Sorry for this post!<br />
<br />
<br />
thank you.. i hadn't noticed there was a newer version...<br />
works great under 64-bit..<br />
<br />
however.. now it's incompatible with XP?<br />
i have to make two separate launchers for my portableapps :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th August 2012, 12:21</div></div><div class="posttext">What have you found that suggests that it isn't compatible with XP? The flag that is set by SetRegView 64 is ignored on non 64-bit OS's.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PoRtAbLe_StEaLtH</div><div class="date">8th August 2012, 13:06</div></div><div class="posttext">What have you found that suggests that it isn't compatible with XP? The flag that is set by SetRegView 64 is ignored on non 64-bit OS's.<br />
<br />
Stu<br />
<br />
i was just logging in to edit my comment..<br />
it's not the registry plugin..<br />
it was my fault..<br />
the portableapp was already installed on the host machine i was testing and didn't realize.<br />
<br />
Sorry about that..<br />
<br />
Setregview 64 works great with 4.1.. :)<br />
no complaints here.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PoRtAbLe_StEaLtH</div><div class="date">8th January 2013, 05:41</div></div><div class="posttext">anyone know why i can't save hex from the registry?<br />
<br />
[HKEY_CURRENT_USER\Software\App\Preferences]<br />
&quot;Language&quot;=&quot;en_US&quot;<br />
&quot;Preferences&quot;=hex:01<br />
&quot;Version&quot;=hex:03,00,00,00<br />
&quot;Window&quot;=hex(7):62,00,72,00,69,00,64,00,67,00,65,00,3a,00,6c,00,69,00,62,00,\<br />
  72,00,61,00,72,00,79,00,3a,00,2f,00,00,00,62,00,72,00,69,00,64,00,67,00,65,\<br />
  00,3a,00,66,00,73,00,3a,00,66,00,69,00,6c,00,65,00,3a,00,2f,00,2f,00,2f,00,\<br />
  3a,00,3a,00,7b,00,32,00,30,00,44,00,30,00,34,00,46,00,45,00,30,00,2d,00,33,\<br />
  00,41,00,45,00,41,00,2d,00,31,00,30,00,36,00,39,00,2d,00,41,00,32,00,44,00,\<br />
  38,00,2d,00,30,00,38,00,30,00,30,00,32,00,42,00,33,00,30,00,33,00,30,00,39,\<br />
  00,44,00,7d,00,00,00,62,00,72,00,69,00,64,00,67,00,65,00,3a,00,66,00,73,00,\<br />
  3a,00,66,00,69,00,6c,00,65,00,3a,00,2f,00,2f,00,2f,00,43,00,3a,00,2f,00,55,\<br />
  00,73,00,65,00,72,00,73,00,2f,00,44,00,4a,00,25,00,32,00,30,00,52,00,55,00,\<br />
  44,00,45,00,42,00,4f,00,59,00,53,00,45,00,53,00,00,00,62,00,72,00,69,00,64,\<br />
  00,67,00,65,00,3a,00,73,00,70,00,65,00,63,00,69,00,61,00,6c,00,3a,00,64,00,\<br />
  65,00,73,00,6b,00,74,00,6f,00,70,00,00,00,62,00,72,00,69,00,64,00,67,00,65,\<br />
  00,3a,00,66,00,73,00,3a,00,66,00,69,00,6c,00,65,00,3a,00,2f,00,2f,00,2f,00,\<br />
  43,00,3a,00,2f,00,55,00,73,00,65,00,72,00,73,00,2f,00,44,00,4a,00,25,00,32,\<br />
  00,30,00,52,00,55,00,44,00,45,00,42,00,4f,00,59,00,53,00,45,00,53,00,2f,00,\<br />
  44,00,6f,00,63,00,75,00,6d,00,65,00,6e,00,74,00,73,00,00,00,62,00,72,00,69,\<br />
  00,64,00,67,00,65,00,3a,00,66,00,73,00,3a,00,66,00,69,00,6c,00,65,00,3a,00,\<br />
  2f,00,2f,00,2f,00,43,00,3a,00,2f,00,55,00,73,00,65,00,72,00,73,00,2f,00,44,\<br />
  00,4a,00,25,00,32,00,30,00,52,00,55,00,44,00,45,00,42,00,4f,00,59,00,53,00,\<br />
  45,00,53,00,2f,00,50,00,69,00,63,00,74,00,75,00,72,00,65,00,73,00,00,00,00,\<br />
  00<br />
<br />
<br />
but there is more in the registry..<br />
no matter what i try. .. it refuses to save the rest..?<br />
<br />
is this a glitch or am i missing something?<br />
<br />
What's werid.. is if i import first.. it saves correctly..<br />
<br />
<br />
By the way.. here's my code:<br />
	StrCpy $R0 0 <br />
	${Do}<br />
		EnumRegKey $R1 `${_ROOT}` `${_KEY}` $R0<br />
		;MessageBox MB_OK `DEBUG: $R1`<br />
		${If} $R1 != &quot;&quot;<br />
			registry::_SaveKey /NOUNLOAD `${_ROOT}\${_KEY}\$R1` `$SETTINGSDIRECTORY\${APPNAME}.reg` `/A=1`<br />
			Pop $0<br />
			IntOp $R0 $R0 + 1<br />
		${EndIf}<br />
	${LoopWhile} $R1 != &quot;&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">8th January 2013, 06:59</div></div><div class="posttext">Maybe related to NSIS_MAX_STRLEN?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PoRtAbLe_StEaLtH</div><div class="date">8th January 2013, 07:09</div></div><div class="posttext">Maybe related to NSIS_MAX_STRLEN?<br />
<br />
thank you.. im starting to believe this is the case.<br />
<br />
i believe it's due to &quot;null terminating strings&quot;.<br />
<br />
As you can see in the example above..<br />
Each Value has multiple &quot;null terminating strings&quot;.<br />
NSIS stops at the first &quot;null&quot;.<br />
<br />
is it possible to bypass this restriction ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PoRtAbLe_StEaLtH</div><div class="date">8th January 2013, 14:04</div></div><div class="posttext">just tried RegOpen:<br />
<br />
	${registry::Open} &quot;HKCU\SOFTWARE\App\Preferences&quot; &quot;/K=0 /V=1 /S=1&quot; $0<br />
	StrCmp $0 0 0 loop<br />
	MessageBox MB_OK &quot;Error&quot; IDOK close<br />
<br />
	loop:<br />
	${registry::Find} &quot;$0&quot; $1 $2 $3 $4<br />
<br />
	MessageBox MB_OKCANCEL '$$1    &quot;path&quot;   =[$1]$\n\<br />
				$$2    &quot;value&quot; =[$2]$\n\<br />
				$$3    &quot;string&quot; =[$3]$\n\<br />
				$$4    &quot;type&quot;   =[$4]$\n\<br />
								$\n\<br />
				Find next?' IDOK loop<br />
	close:<br />
<br />
http://i46.tinypic.com/10pr1b8.png<br />
the first value is read correctly..<br />
but the rest are shown as [] for value, string, and type.<br />
<br />
<br />
from my research.. MULTI_SZ seems to be very hard for NSIS to handle.<br />
I've found reading &amp; writing MULTI_SZ routines.. <br />
but those are for specific keys.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PoRtAbLe_StEaLtH</div><div class="date">12th January 2013, 07:17</div></div><div class="posttext">unbelievably.. using MS-DOS is the solution for MULTI_SZ that exceed MaxLengthStr<br />
<br />
To export/save:<br />
ExpandEnvStrings `$0` %COMSPEC%<br />
nsExec::Exec `&quot;$0&quot; /c reg export &quot;HKCU\Software\App\Preferences&quot; &quot;$SETTINGSDIRECTORY\settings.reg&quot;`<br />
<br />
To import file:<br />
ExpandEnvStrings `$0` %COMSPEC%<br />
nsExec::Exec `&quot;$0&quot; /c reg import &quot;$SETTINGSDIRECTORY\settings.reg&quot;`<br />
<br />
To import specific values:<br />
@reg.exe add &quot;HKCU\Software\App\Preferences&quot; /v &quot;MySoftware&quot; /d &quot;Software1&quot;\0&quot;Software2&quot;\0&quot;Software3&quot;\0 /t REG_MULTI_SZ /f</div></div><hr />


<div class="post"><div class="posttop"><div class="username">highend</div><div class="date">25th October 2013, 11:09</div></div><div class="posttext">Is there any chance that the bug (at least I call it a bug...) that it's unable to import .reg files to HKEY_CURRENT_USER without elevation will get fixed?<br />
<br />
Apart from that it's a perfect addon!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>