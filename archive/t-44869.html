<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" nsi file for a VB app., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  nsi file for a VB app. NSIS Discussion" />
	
	<title> nsi file for a VB app. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  nsi file for a VB app.</div>
<hr />
<div class="pda"><a href="t-44869.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=44869">nsi file for a VB app.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">emoreau</div><div class="date">18th March 2001, 17:44</div></div><div class="posttext">Does anybody built a facility to convert a setup.lst file into a a .nsi file for a vb applications?<br />
<br />
Any difficulties in installing VB app with SuperPiMP?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">buzzc4</div><div class="date">18th March 2001, 21:12</div></div><div class="posttext">I'm using it for vb, just gotta include the runtimes and stuff.  Works pretty damn good.  Only 1 exe to distro, no more lst/ini/exe/cab.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">emoreau</div><div class="date">18th March 2001, 21:20</div></div><div class="posttext">Do you copy all of your LST into the nsi file?<br />
<br />
Can you give a sample of a complete NSI file?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">buzzc4</div><div class="date">18th March 2001, 22:11</div></div><div class="posttext">Not really.  I recreated the nsi from scratch.  Just use the File command for all your files and mkdir as you need to.  Also its optional but you can regdll your .dll's and .ocx's, so your program wont have to do it on launch.  Thats about it. You can check out the sample .nsi files the installer includes</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rfb</div><div class="date">23rd March 2001, 16:53</div></div><div class="posttext">I have to wonder about newer version of OCX's that I might install, should I just set it to Overwrite, then register?<br />
<br />
-ryan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">prodangle</div><div class="date">8th October 2001, 16:27</div></div><div class="posttext">Originally posted by rfb <br />
I have to wonder about newer version of OCX's that I might install, should I just set it to Overwrite, then register?<br />
<br />
-ryan <br />
I think this might go down as the longest awaited reply ever...<br />
<br />
take a look at http://forums.winamp.com/showthread.php?threadid=58619</div></div><hr />


<div class="post"><div class="posttop"><div class="username">liquidmotion</div><div class="date">8th October 2001, 20:05</div></div><div class="posttext">i might be able to incorporate this into my nsis gui.  sound like a good idea?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">8th October 2001, 20:13</div></div><div class="posttext">Mmm I'm still using the Microsoft distribution of the VB6 runtimes instead of a native NSIS install. Maybe I should make a VB6-Runtime install? With all the correct RegDLL/version checking/etc?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Repzilon</div><div class="date">8th October 2001, 21:19</div></div><div class="posttext">I did a native NSIS install for VB5 runtime libraries. I used SetOverwrite ifnewer instead and before I execute the script, I make sure that I have the latest versions. Here it is :<br />
<br />
Section &quot;Runtime Visual Basic 5.0 SP3&quot;<br />
	SectionIn 23<br />
	SetOverwrite ifnewer<br />
	SetCompress Auto<br />
	SetDateSave On<br />
	SetOutPath &quot;$SYSDIR&quot;<br />
	File &quot;C:\Windows\Bureau\mdinote-setup\Asycfilt.dll&quot;<br />
	File &quot;C:\Windows\Bureau\mdinote-setup\Comcat.dll&quot;<br />
	File &quot;C:\Windows\Bureau\mdinote-setup\Ctl3d32.dll&quot;<br />
	File &quot;C:\Windows\Bureau\mdinote-setup\Msvbvm50.dll&quot;<br />
	File &quot;C:\Windows\Bureau\mdinote-setup\Oleaut32.dll&quot;<br />
	File &quot;C:\Windows\Bureau\mdinote-setup\Olepro32.dll&quot;<br />
	File &quot;C:\Windows\Bureau\mdinote-setup\Vb5fr.dll&quot;<br />
	RegDLL &quot;$SYSDIR\Comcat.dll&quot;<br />
	RegDLL &quot;$SYSDIR\msvbvm50.dll&quot;<br />
	RegDLL &quot;$SYSDIR\oleaut32.dll&quot;<br />
	RegDLL &quot;$SYSDIR\olepro32.dll&quot;<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">9th October 2001, 17:45</div></div><div class="posttext">But does that work if the OLE files need to be updated?<br />
I created the following yesterday (I have a few notes to make, scroll down):<br />
<br />
<br />
Section &quot;Visual Basic 6 Runtimes&quot;<br />
  ;OLEAUT32.DLL is always in use! Most of the time, a reboot is needed.<br />
  SetOverwrite on <br />
  SetOutPath $SYSDIR <br />
  CompareDLLVersions /STOREFROM OLEAUT32.NEW $SYSDIR\OLEAUT32.DLL oleaut32_1newer oleaut32_2newer <br />
  goto oleaut32_2newer<br />
  oleaut32_1newer: <br />
  File OLEAUT32.NEW<br />
  Rename OLEAUT32.NEW OLEAUT32.DLL<br />
  IfErrors 0 oleaut32_noreboot<br />
  Rename /REBOOTOK OLEAUT32.NEW OLEAUT32.DLL<br />
  MessageBox MB_OK &quot;Reboot needed&quot;<br />
  oleaut32_noreboot:<br />
  RegDLL &quot;$SYSDIR\OLEAUT32.DLL&quot;<br />
  oleaut32_2newer:<br />
<br />
; do I need this?<br />
  ;OLEPRO32.DLL is always in use! Most of the time, a reboot is needed.<br />
  CompareDLLVersions /STOREFROM OLEPRO32.NEW $SYSDIR\OLEPRO32.DLL olepro32_1newer olepro32_2newer <br />
  goto olepro32_2newer<br />
  olepro32_1newer: <br />
  File OLEPRO32.NEW<br />
  Rename OLEPRO32.NEW OLEPRO32.DLL<br />
  IfErrors 0 olepro32_noreboot<br />
  Rename /REBOOTOK OLEPRO32.NEW OLEPRO32.DLL<br />
  MessageBox MB_OK &quot;Reboot needed&quot;<br />
  olepro32_noreboot:<br />
  RegDLL &quot;$SYSDIR\OLEPRO32.DLL&quot;<br />
  olepro32_2newer:<br />
<br />
  ;ASYCFILT.DLL<br />
  CompareDLLVersions /STOREFROM ASYCFILT.DLL $SYSDIR\ASYCFILT.DLL asycfilt_1newer asycfilt_2newer<br />
  goto asycfilt_2newer<br />
  asycfilt_1newer: <br />
  File ASYCFILT.DLL<br />
  asycfilt_2newer:<br />
<br />
  ;STDOLE2.TLB<br />
  CompareDLLVersions /STOREFROM STDOLE2.TLB $SYSDIR\STDOLE2.TLB stdole_1newer stdole_2newer<br />
  goto stdole_2newer<br />
  stdole_1newer: <br />
  File STDOLE2.TLB<br />
  stdole_2newer:<br />
<br />
  ;MSVBVM60.DLL<br />
  CompareDLLVersions /STOREFROM MSVBVM60.DLL $SYSDIR\MSVBVM60.DLL MSVBVM60_1newer MSVBVM60_2newer<br />
  goto MSVBVM60_2newer<br />
  MSVBVM60_1newer: <br />
  File MSVBVM60.DLL<br />
  MSVBVM60_2newer:<br />
<br />
  ;COMCAT.DLL<br />
  CompareDLLVersions /STOREFROM COMCAT.DLL $SYSDIR\COMCAT.DLL COMCAT_1newer COMCAT_2newer<br />
  goto COMCAT_2newer<br />
  COMCAT_1newer: <br />
  File COMCAT.DLL<br />
  COMCAT_2newer:<br />
<br />
  ;an OCX registration example<br />
  CompareDLLVersions /STOREFROM comdlg32.ocx $SYSDIR\comdlg32.ocx comdlg32_1newer comdlg32_2newer <br />
  goto comdlg32_2newer<br />
  comdlg32_1newer: <br />
  File comdlg32.ocx <br />
  RegDLL &quot;$SYSDIR\comdlg32.ocx&quot; <br />
  comdlg32_2newer: <br />
SectionEnd<br />
<br />
A few notes:<br />
1) Do you actually need all those files? My application only needs MSVBVM60.DLL and OLEAUT32.DLL, but I'm afraid to leave out the rest.<br />
2) This NSIS installer is bigger than the Microsoft distribution. If you use the Microsoft one with the /Q flag, you're saving 150 KB. So I'm probably sticking with that.<br />
<br />
If anyone can tell me if you can leave out some of these files, that'd help.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>