<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" executing dos commands, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  executing dos commands NSIS Discussion" />
	
	<title> executing dos commands [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  executing dos commands</div>
<hr />
<div class="pda"><a href="t-179975.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=179975">executing dos commands</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mancini</div><div class="date">14th May 2004, 19:52</div></div><div class="posttext">i have a problem with executing native dos shell comands like &quot;echo&quot;<br />
<br />
&quot;echo text &gt; $INSTDIR\location.txt&quot; written in the shell/command line of windows results in the creation of a file that contains &quot;text&quot;<br />
<br />
while trying to have similar result from with a nsis script i tried<br />
<br />
  Exec &quot;echo $INSTDIR &gt; $INSTDIR\location.txt&quot;<br />
<br />
  Exec '&quot;echo&quot; $INSTDIR &gt; $INSTDIR\location.txt'<br />
<br />
even<br />
<br />
  Exec '&quot;command.com&quot; echo $INSTDIR &gt; $INSTDIR\location.txt'<br />
<br />
and the file is never created<br />
<br />
can anyone help ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">treehousetim</div><div class="date">14th May 2004, 20:01</div></div><div class="posttext">if all you're trying to do is put the instdir variable into a file, try using the file functions.<br />
<br />
FileOpen $0 &quot;filename&quot; w<br />
FileWrite $0 &quot;$INSTDIR&quot;<br />
FileClose $0<br />
<br />
-Tim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Drako12</div><div class="date">14th May 2004, 20:56</div></div><div class="posttext">can anyone help me with this, i didnt want to make a topic with almost the same name<br />
<br />
im making a script to run cmd.exe then runas.exe with some parameters, the problem is, the runas.exe program asks for the admin password, how can to write the pass in the script and hit enter?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th May 2004, 21:16</div></div><div class="posttext">You'll have to use Windows API (System plug-in) to similate key events (SendKeys).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">15th May 2004, 03:04</div></div><div class="posttext">Can't him do that using SendMessage, Joost? Or that is the only one way to do that?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">17th May 2004, 13:36</div></div><div class="posttext">Joost, please explane how &quot;to similate key events (SendKeys)&quot;. User has handle for running DOS (console) process, how to send key?<br />
<br />
BTW, with Windows API it is possible to create DOS application (run runas.exe with parameters) with redirected IO using pipes, this case application waits for WriteFile() output (with password, for example), such plug-in might be usefull.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">17th May 2004, 14:03</div></div><div class="posttext">If you can get it to work using the console you can always call the console with a command using Exec.<br />
<br />
I have no time to write complete Windows API examples, sorry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">s793016</div><div class="date">17th May 2004, 15:35</div></div><div class="posttext">Sorry, my English is very very poor.<br />
<br />
If your &quot;runas.exe&quot; is a dos program and it totally only need input this 2 things just like this:<br />
<br />
Username:<br />
Password:<br />
<br />
then you can make a text file (ex: QUOTE.TXT) with 3 line like this:<br />
<br />
line 1:somebody this is username string<br />
line 2:12345678 this is password string<br />
line 3: this line have nothing here.  You must keep this blank line here for input [Enter] key<br />
<br />
<br />
after that, use a I/O redirect to input those for you.<br />
<br />
<br />
...<br />
exec '&quot;$Sysdir\cmd.exe&quot; &quot;fullpath\runas.exe&quot; &lt; &quot;fullpath\Quote.txt&quot;'<br />
...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">17th May 2004, 17:08</div></div><div class="posttext">s793016<br />
 <br />
 I/O redirection with &lt; and &gt; works fine on Linux, and on some of Wins too, but unfortunately, not on all :-(( This is why I had to to use correct rediriction with pipes in my applications.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">17th May 2004, 18:18</div></div><div class="posttext">the way to exec a dos command like echo:<br />
<br />
cmd.exe /K echo Hello World<br />
<br />
/C - Carries out the command specified by string and then terminates<br />
/K - Carries out the command specified by string but remains<br />
<br />
and u would have to use command.com on 9x ofcourse</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Drako12</div><div class="date">17th May 2004, 18:23</div></div><div class="posttext">Originally posted by Takhir <br />
s793016<br />
 <br />
 I/O redirection with &lt; and &gt; works fine on Linux, and on some of Wins too, but unfortunately, not on all :-(( This is why I had to to use correct rediriction with pipes in my applications.  <br />
<br />
can you explain to me how you did it? please.. =)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Drako12</div><div class="date">17th May 2004, 18:52</div></div><div class="posttext">Originally posted by Anders <br />
the way to exec a dos command like echo:<br />
<br />
cmd.exe /K echo Hello World<br />
<br />
/C - Carries out the command specified by string and then terminates<br />
/K - Carries out the command specified by string but remains<br />
<br />
and u would have to use command.com on 9x ofcourse  <br />
<br />
it doenst work<br />
<br />
tried <br />
<br />
runas /user:localhost\user &quot;program&quot; /K password</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">17th May 2004, 19:36</div></div><div class="posttext">a bit of code.<br />
<br />
   ((pthreadParams)ptp)-&gt;rq(hInputWrite, hOutputRead, ((pthreadParams)ptp)-&gt;param);<br />
<br />
is a call to program, which handles child process i/o (like lgOutput() sub).<br />
More info u can find in MSDN.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Drako12</div><div class="date">17th May 2004, 20:11</div></div><div class="posttext">Originally posted by Takhir <br />
a bit of code.<br />
<br />
   ((pthreadParams)ptp)-&gt;rq(hInputWrite, hOutputRead, ((pthreadParams)ptp)-&gt;param);<br />
<br />
is a call to program, which handles child process i/o (like lgOutput() sub).<br />
More info u can find in MSDN.  <br />
<br />
i wish i knew more... i really cant understand your program..<br />
<br />
isnt there a easier way to do what i want? how that API thing works?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">17th May 2004, 23:34</div></div><div class="posttext">If you want to use redirection, these examples from the &quot;Help w/ mysql script&quot; thread might help:<br />
<br />
http://forums.winamp.com/showthread.php?postid=1300365#post1300365<br />
<br />
http://forums.winamp.com/showthread.php?postid=1300410#post1300410<br />
<br />
http://forums.winamp.com/showthread.php?postid=1302664#post1302664</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">18th May 2004, 07:02</div></div><div class="posttext">Drako12: Please note - C code is attached to previous post as io.txt file.<br />
And BTW instead of using FileOpen, Write, Close (treehousetim post) it might be better to include password file to package and to use it from tmp folder (don't copy to $INSTALL).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Drako12</div><div class="date">18th May 2004, 18:25</div></div><div class="posttext">Originally posted by pengyou <br />
If you want to use redirection, these examples from the &quot;Help w/ mysql script&quot; thread might help:<br />
<br />
http://forums.winamp.com/showthread.php?postid=1300365#post1300365<br />
<br />
http://forums.winamp.com/showthread.php?postid=1300410#post1300410<br />
<br />
http://forums.winamp.com/showthread.php?postid=1302664#post1302664  <br />
<br />
<br />
i tried with a file something like this<br />
<br />
runas /user:localhost\user &quot;program&quot; &lt; C:\x.txt<br />
<br />
<br />
where x has the password<br />
but i get an error , it says &quot;RUNAS cannot accept this input&quot; or something like that</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Drako12</div><div class="date">18th May 2004, 18:33</div></div><div class="posttext">Originally posted by Takhir <br />
Drako12: Please note - C code is attached to previous post as io.txt file.<br />
And BTW instead of using FileOpen, Write, Close (treehousetim post) it might be better to include password file to package and to use it from tmp folder (don't copy to $INSTALL).  <br />
<br />
<br />
i understand C, but i cant understand what you program does =/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">26th May 2004, 14:48</div></div><div class="posttext">If you only need to ask for a password from the DOS api take a look here, its works fine:<br />
<br />
http://www.ericphelps.com/batch/userin/index.htm<br />
<br />
Now my next question, I use Exec for running a DOS command, is it somehow possible to avoid that the DOS box opens and closes? thanxs<br />
<br />
cheers,<br />
alej</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">26th May 2004, 17:12</div></div><div class="posttext">NSIS ExecShell (as I can see in exec.c) is implemented using ShellExecute API call. ShellExecute supports more &quot;show modes&quot;, then you can see in NSIS docs, try one of them: SW_HIDE (0)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">27th May 2004, 12:45</div></div><div class="posttext">Cool it works! But in which docu does this mode appear, not on the NSIS User Manual. Are there any other docus? thanxs!<br />
<br />
cheers,<br />
alej</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">27th May 2004, 13:02</div></div><div class="posttext">MSDN knowledge base :)<br />
<br />
http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/reference/functions/shellexecute.asp<br />
<br />
and MS VS  WINUSER.H</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">27th May 2004, 13:04</div></div><div class="posttext">ups did not know that it was microsofts shellexecute! thanxs!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">28th May 2004, 10:48</div></div><div class="posttext">I had few free minutes and wrote my first NSIS plugin for console applications :)<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=181442</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">4th June 2004, 15:49</div></div><div class="posttext">Is it possible to execute dos commands using ExecShell? I tried the following:<br />
<br />
ExecShell open &quot;net use ...&quot; SW_HIDE<br />
and<br />
ExecShell open &quot;cmd.exe net use ...&quot; SW_HIDE<br />
<br />
it doesn't give any error but it doesn't execute it. Exec works fine but I don't want that the dos box appears upon execution and the 'hide' option is not available for exec right? thanxs</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">4th June 2004, 16:08</div></div><div class="posttext">System::Call 'kernel32.dll::WinExec(t &quot;net use...&quot;, i 0) i.r0'<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=182096</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">4th June 2004, 16:17</div></div><div class="posttext">Voil√°!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>