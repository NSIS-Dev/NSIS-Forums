<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" newbie question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  newbie question NSIS Discussion" />
	
	<title> newbie question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  newbie question</div>
<hr />
<div class="pda"><a href="t-286364.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=286364">newbie question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">EvilTwin1</div><div class="date">5th February 2008, 23:43</div></div><div class="posttext">1. this is my first try with nsis so please keep your answers simple^^<br />
<br />
everytime i try to use &quot;!insertmacro MUI_PAGE_INSTFILES&quot; i get an errormessage while compiling<br />
if i put a &quot;;&quot; before it compiling works fine<br />
<br />
here is my script<br />
<br />
SetCompressor  lzma<br />
Var hmci<br />
!include g2mod.nsh<br />
<br />
; MUI 1.67 compatible ------<br />
!include &quot;MUI.nsh&quot;<br />
<br />
; MUI Settings<br />
!define MUI_ABORTWARNING<br />
!define MUI_ICON &quot;install\System\Namenlos.ico&quot;<br />
!define MUI_UNICON &quot;install\System\Namenlos.ico&quot;<br />
<br />
; Language Selection Dialog Settings<br />
!define MUI_LANGDLL_REGISTRY_ROOT &quot;${PRODUCT_UNINST_ROOT_KEY}&quot;<br />
!define MUI_LANGDLL_REGISTRY_KEY &quot;${PRODUCT_UNINST_KEY}&quot;<br />
!define MUI_LANGDLL_REGISTRY_VALUENAME &quot;NSIS:Language&quot;<br />
<br />
; Welcome page<br />
!insertmacro MUI_PAGE_WELCOME<br />
; License page<br />
!define MUI_LICENSEPAGE_CHECKBOX<br />
!insertmacro MUI_PAGE_LICENSE &quot;licence.rtf&quot;<br />
; Components page<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
; Directory page<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
; Instfiles page<br />
!insertmacro MUI_PAGE_INSTFILES<br />
; Finish page<br />
!define MUI_FINISHPAGE_RUN &quot;$INSTDIR\System\GothicStarter.exe&quot;<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
; Uninstaller pages<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
; Language files<br />
!insertmacro MUI_LANGUAGE &quot;German&quot;<br />
<br />
; MUI end ------<br />
<br />
<br />
<br />
<br />
<br />
;--------------------------------<br />
Name &quot;Die SchÃ¶pfung&quot;<br />
OutFile &quot;DieSchoepfung.exe&quot;<br />
InstallDir &quot;$PROGRAMFILES\JoWooD\Gothic II\&quot;<br />
;LicenseData &quot;licence.rtf&quot;<br />
;LicenseBkColor 0xFFFFFF<br />
<br />
;Insttype &quot;Komplett&quot;<br />
;Insttype &quot;Minimal&quot;<br />
<br />
<br />
;Page license<br />
;Page components<br />
;Page directory<br />
;Page instfiles<br />
;UninstPage uninstConfirm<br />
;UninstPage instfiles<br />
<br />
<br />
Function .onInit<br />
<br />
<br />
;--------------------------------<br />
  ; $INSTDIR bereits gÃ¼ltig?<br />
  IfFileExists &quot;$INSTDIR\System\Gothic2.exe&quot; done<br />
<br />
  ; Sonst Add-ON Installation suchen (Registrierung)<br />
  Call g2mod_GetInstallLocation<br />
  Pop $R0<br />
  StrCmp $R0 &quot;&quot; done<br />
  ; Ãœbernehmen<br />
  StrCpy $INSTDIR $R0<br />
<br />
  done:<br />
  Pop $R0<br />
;--------------------------------<br />
<br />
<br />
  InitPluginsDir<br />
  SetOutPath $PLUGINSDIR<br />
  File &quot;Installer_loop.mp3&quot;<br />
  System::Call 'msvfw32.dll::MCIWndCreate(i 0, i 0,i 0x0070, t &quot;$PLUGINSDIR\Installer_loop.mp3&quot;) i .r0'<br />
  StrCpy $hmci $0<br />
  SendMessage $hmci 0x0490 0 0 $0<br />
  IntCmp $0 0 nosup<br />
  ShowWindow $hmci SW_HIDE<br />
  SendMessage $hmci 0x0465 0 &quot;STR:play repeat&quot;<br />
  nosup:<br />
;--------------------------------<br />
    ;User defined skin<br />
    SetOutPath $TEMP<br />
    File /oname=ds-style.skf &quot;ds-style.skf&quot;<br />
    NSIS_SkinCrafter_Plugin::skin /NOUNLOAD $TEMP\ds-style.skf<br />
    ;Delete $TEMP\ds-style.skf<br />
FunctionEnd<br />
;--------------------------------<br />
<br />
Function .onGUIEnd<br />
	NSIS_SkinCrafter_Plugin::destroy<br />
FunctionEnd<br />
;--------------------------------<br />
<br />
Function un.onGUIEnd<br />
	NSIS_SkinCrafter_Plugin::destroy<br />
FunctionEnd<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
Section &quot;SchÃ¶pfung Mod&quot; main<br />
SectionIn RO<br />
<br />
;Icon und INI in System kopieren<br />
  SetOutPath &quot;$INSTDIR\System&quot;<br />
  File      &quot;.\install\System\schoepfung.ini&quot;<br />
  File      &quot;.\install\System\Namenlos.ico&quot;<br />
  <br />
;.mod in modvdf kopieren<br />
  SetOutPath &quot;$INSTDIR\Data\modvdf&quot;<br />
  File      &quot;.\install\Data\modvdf\schoepfung.mod&quot;<br />
  <br />
;gothic starter kopieren<br />
  SetOutPath &quot;$INSTDIR\System&quot;<br />
  File      &quot;.\install\System\GothicStarter.exe&quot;<br />
  File      &quot;.\install\System\GothicGame.ini&quot;<br />
  <br />
;Uninstaller<br />
  WriteUninstaller &quot;$INSTDIR\DS-Uninstall.exe&quot;<br />
  <br />
;Save Ordner<br />
 CreateDirectory &quot;$INSTDIR\saves_schoepfung\current&quot;<br />
SectionEnd<br />
<br />
<br />
Section &quot;Speech&quot; speech<br />
  ;blubbb<br />
SectionEnd<br />
<br />
<br />
<br />
Section &quot;Shortcuts&quot; links<br />
  CreateShortCut &quot;$DESKTOP\Die SchÃ¶pfung.lnk&quot; &quot;$INSTDIR\System\GothicStarter.exe&quot; &quot;&quot; &quot;$INSTDIR\System\Namenlos.ico&quot; 0<br />
SectionEnd<br />
<br />
<br />
<br />
<br />
<br />
;Component Descriptions<br />
LangString DESC_main ${LANG_GERMAN} &quot;Grunddateien der Mod Die SchÃ¶pfung&quot;<br />
LangString DESC_speech ${LANG_GERMAN} &quot;Synchronisation der Dialoge&quot;<br />
LangString DESC_links ${LANG_GERMAN} &quot;VerknÃ¼pfung auf dem Desktop und im StartmenÃ¼&quot;<br />
<br />
LangString DESC_haupt ${LANG_ENGLISH} &quot;base files of the mod&quot;<br />
LangString DESC_speech ${LANG_ENGLISH} &quot;audio files for the dialogs&quot;<br />
LangString DESC_links ${LANG_ENGLISH} &quot;shortcuts on the desktop and in the starup menue&quot;<br />
<br />
!insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />
!insertmacro MUI_DESCRIPTION_TEXT ${main} $(DESC_main)<br />
!insertmacro MUI_DESCRIPTION_TEXT ${speech} $(DESC_speech)<br />
!insertmacro MUI_DESCRIPTION_TEXT ${links} $(DESC_links)<br />
!insertmacro MUI_FUNCTION_DESCRIPTION_END<br />
<br />
<br />
<br />
<br />
<br />
Function un.onUninstSuccess<br />
  HideWindow<br />
  MessageBox MB_ICONINFORMATION|MB_OK &quot;Die SchÃ¶pfung wurde erfolgreich deinstalliert.&quot;<br />
FunctionEnd<br />
<br />
Function un.onInit<br />
  MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 &quot;MÃ¶chten Sie Die SchÃ¶pfung deinstallieren?&quot; IDYES +2<br />
  Abort<br />
  NSIS_SkinCrafter_Plugin::skin /NOUNLOAD $TEMP\ds-style.skf<br />
FunctionEnd<br />
<br />
Section &quot;Uninstall&quot;<br />
<br />
Delete &quot;$INSTDIR\System\schoepfung.ini&quot;<br />
Delete &quot;$INSTDIR\System\Namenlos.ico&quot;<br />
Delete &quot;$INSTDIR\Data\modvdf\schoepfung.mod&quot;<br />
Delete &quot;$INSTDIR\DS-Uninstall.exe&quot;<br />
<br />
RMDir &quot;$INSTDIR\saves_schoepfung\current&quot;<br />
RMDir &quot;$INSTDIR\saves_schoepfung&quot;<br />
RMDir /r &quot;$INSTDIR\Data\modvdf&quot;<br />
Delete &quot;$DESKTOP\Die SchÃ¶pfung.lnk&quot;<br />
SectionEnd<br />
<br />
<br />
and sorry for the bad english :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">6th February 2008, 04:22</div></div><div class="posttext">What's the error?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EvilTwin1</div><div class="date">6th February 2008, 23:10</div></div><div class="posttext">http://bildupload.sro.at/a/images/3-error.jpg</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">6th February 2008, 23:30</div></div><div class="posttext">!define MUI_LANGDLL_REGISTRY_ROOT can't have quotes, only HKLM or HKCU or a define that resolves to one of those</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EvilTwin1</div><div class="date">6th February 2008, 23:35</div></div><div class="posttext">thx but the error with !insertmacro MUI_PAGE_INSTFILES is still there</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EvilTwin1</div><div class="date">7th February 2008, 21:12</div></div><div class="posttext">nobody an idea<br />
i thougt copying files is a real basic thing :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th February 2008, 22:25</div></div><div class="posttext">What are your values for PRODUCT_UNINST_ROOT_KEY and PRODUCT_UNINST_KEY?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EvilTwin1</div><div class="date">8th February 2008, 00:20</div></div><div class="posttext">there are none :D<br />
i copyed it from some demo code^^<br />
as i said i just started with nsis</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">8th February 2008, 01:22</div></div><div class="posttext">well, you need to define them, or remove:<br />
!define MUI_LANGDLL_REGISTRY_ROOT &quot;${PRODUCT_UNINST_ROOT_KEY}&quot;<br />
!define MUI_LANGDLL_REGISTRY_KEY &quot;${PRODUCT_UNINST_KEY}&quot;<br />
!define MUI_LANGDLL_REGISTRY_VALUENAME &quot;NSIS:Language&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EvilTwin1</div><div class="date">8th February 2008, 02:34</div></div><div class="posttext">thx<br />
now everything works fine :)<br />
<br />
one last question:<br />
is it possible to display a big window in the back while installing whre some pictures can be shown like in many professional setups?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thek</div><div class="date">8th February 2008, 09:12</div></div><div class="posttext">There is a Plugin which allows you to display background images  (use of Option BANNER )<br />
NewAdvSlpash (http://nsis.sourceforge.net/NewAdvSplash_plug-in)<br />
<br />
To get a Background Window you can use the option<br />
BGGradient (http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.5)<br />
<br />
I don't know how this two features works together, so you have to try it on your one.<br />
<br />
nobs</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">8th February 2008, 09:16</div></div><div class="posttext">In my opinion, these installers with a full-screen background are kinda old-school and don't look professional nowadays...<br />
<br />
if you still want it, take a look at the BgImage plug-in that comes with NSIS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EvilTwin1</div><div class="date">8th February 2008, 22:44</div></div><div class="posttext">i think the bgimage plugin is what i was looking for :)<br />
but in the text here (http://nsis.sourceforge.net/Docs/BgImage/BgImage.txt) was said not to use the SetBg command in the oninit function<br />
where else? i want the window to open at the beginning<br />
(i tried it anyway and as expected it didnt work :D  )<br />
<br />
next question is it possible to change the image after a few seconds<br />
<br />
edit:<br />
<br />
now i added following lines to the script<br />
<br />
Function .onGUIInit<br />
        InitPluginsDir<br />
        SetOutPath $PLUGINSDIR<br />
        File &quot;background.bmp&quot;<br />
	BgImage::setBg /NOUNLOAD /FILLSCREEN &quot;$PLUGINSDIR\background.bmp&quot;<br />
	BgImage::Redraw /NOUNLOAD<br />
FunctionEnd <br />
<br />
but the compiler always say the Function .onGUIInit already exits<br />
but in the whole script this is the only function named .onGUIInit</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">9th February 2008, 02:05</div></div><div class="posttext">the MUI already uses that function, read the MUI docs and figure out the right MUI_* define to use</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EvilTwin1</div><div class="date">12th February 2008, 16:15</div></div><div class="posttext">the bgimage works thx<br />
but what about changing the image after a period of time?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th February 2008, 16:25</div></div><div class="posttext">You'd need to write a plug-in to run asynchronously to do it.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EvilTwin1</div><div class="date">12th February 2008, 16:26</div></div><div class="posttext">ok<br />
then i am happy with changing it the traditional way :D</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>