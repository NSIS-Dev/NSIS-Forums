<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MUI 2  setting of variable for MUI_PAGE_STARTMENU, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MUI 2  setting of variable for MUI_PAGE_STARTMENU NSIS Discussion" />
	
	<title> MUI 2  setting of variable for MUI_PAGE_STARTMENU [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MUI 2  setting of variable for MUI_PAGE_STARTMENU</div>
<hr />
<div class="pda"><a href="t-334785.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=334785">MUI 2  setting of variable for MUI_PAGE_STARTMENU</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">thek</div><div class="date">15th September 2011, 17:04</div></div><div class="posttext">Hello<br />
I'm using MUI2 for my installer<br />
I would like to check if the user selects a already existing Start menu folder and If so, I want to abort the installation or force the user to select another<br />
(reason, the old version of our tool used another installer)<br />
<br />
The problem: the Variable $Startmenufolder is not initialized in the &quot;OnLeave&quot; function<br />
what can I do get the selected folder?<br />
samplecode<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE &quot;Show_hide_page&quot;<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW &quot;change_header_text_to_white&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_ROOT &quot;HKLM&quot; <br />
!define MUI_STARTMENUPAGE_REGISTRY_KEY &quot;Software\YY\XX_${SHORT_VERSION}&quot; <br />
!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME &quot;Start Menu Folder&quot;<br />
!define MUI_PAGE_CUSTOMFUNCTION_LEAVE &quot;check_if_XX_Installed_Startmenu&quot;<br />
!insertmacro MUI_PAGE_STARTMENU &quot;the_Startmenu&quot; $StartMenuFolder<br />
<br />
...<br />
Function check_if_XX_Installed_Startmenu<br />
    MessageBox MB_OK &quot;$StartMenuFolder&quot;    ;<br />
    ${if} ${FileExists} &quot;$SMPROGRAMS\$StartMenuFolder&quot;<br />
        MessageBox MB_OK|MB_ICONEXCLAMATION &quot;XX is already installed in the Startmenu folder '$StartMenuFolder'.$\r$\nPlease select another folder or uninstall the old Version first.&quot;<br />
        Abort<br />
    ${Endif}<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">15th September 2011, 20:08</div></div><div class="posttext">Use this workaround:<br />
<br />
Function SMPageLeave<br />
<br />
${NSD_GetText} $mui.StartMenuPage.Location $0<br />
MessageBox mb_ok $0<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thek</div><div class="date">16th September 2011, 07:19</div></div><div class="posttext">Thanks that works fine!<br />
<br />
I found another solution (http://forums.winamp.com/showthread.php?t=278719), but yours is &quot;nicer&quot;</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>