<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installer Self-deletion, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installer Self-deletion NSIS Discussion" />
	
	<title> Installer Self-deletion [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installer Self-deletion</div>
<hr />
<div class="pda"><a href="t-55223.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=55223">Installer Self-deletion</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Kreft</div><div class="date">19th July 2001, 15:41</div></div><div class="posttext">is it possible to make the installer remove itself once it has been run?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Gonzotek</div><div class="date">19th July 2001, 16:49</div></div><div class="posttext">Yes...sort of.<br />
<br />
You'll need to write an .nsi script(install.nsi) that writes the location it is being run from to a registry string.<br />
<br />
Then write a seperate .nsi script(delete.nsi) that will read from the registry the directory that install.nsi put there.  Put the result in a user variable ($1). You'll need to play around with SLEEP to see how long it takes for install.nsi to close. Then DELETE $1.<br />
<br />
Compile delete.nsi and then you can include it in your main installer (install.nsi).  If you extract it to temp and run it just before you come to the end of the installation.  Install.exe should quit after launching delete.exe from temp, then delete.exe should delete the installer.  you are left with a ~32k delete.exe in the temp directory, which will of course eventually get overwritten.  Anyone know of an easier way to do this?<br />
<br />
I could post example code, but the documentation should cover everything you need for this.<br />
-=Gonzotek=-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Edgewize</div><div class="date">19th July 2001, 19:33</div></div><div class="posttext">Simple:<br />
<br />
Delete /REBOOTOK installer.exe<br />
<br />
The only trick is that you have to know the path and file name of your own installer ... that's a tricky bit I can't figure out yet.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kreft</div><div class="date">19th July 2001, 20:42</div></div><div class="posttext">that should give me enough info to do what i want... but i would very appreciative if this were made a little simpler by simply adding a 'melt on run' option</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Edgewize</div><div class="date">20th July 2001, 06:39</div></div><div class="posttext">I still don't understand why anyone would *want* a 'melt-on-run' option?<br />
<br />
Every time I come up with a reason for it, I just as quickly come up with a reason why it is a bad idea.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kreft</div><div class="date">20th July 2001, 09:06</div></div><div class="posttext">Upgrades and selfextractors.. like if it is just a pretty package for a movie or something large that you wouldnt want to hang on to..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">prodangle</div><div class="date">20th July 2001, 16:11</div></div><div class="posttext">if i download something and run it I expect it to still be there - someone might want to still have it after a re-install, or install the stuff on other machines.  If the user wants the installer gone they can easily delete it themselves.  taking that amount of control away from the user is a bit scary - it definetly scares me shitless anyway.  One thing I can think of right away installs like that - the Back Orifice server...  I dont think Justin wanted NSIS to be used for wrecking folks computers ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">prodangle</div><div class="date">20th July 2001, 16:15</div></div><div class="posttext">if i download something and run it I expect it to still be there - someone might want to still have it after a re-install, or install the stuff on other machines.  If the user wants the installer gone they can easily delete it themselves.  taking that amount of control away from the user is a bit scary - it definetly scares me shitless anyway.  One thing I can think of right away installs like that - the Back Orifice server...  I dont think Justin wants NSIS to be used for wrecking folks computers so we're probably unlikely to see a /melt-on-run switch</div></div><hr />


<div class="post"><div class="posttop"><div class="username">prodangle</div><div class="date">20th July 2001, 16:17</div></div><div class="posttext">man, these forums are knackered (or maybe its my connection)  that's my excuse for posting that twice anyway (like throwing up a third post makes up for it :confused: )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saivert</div><div class="date">5th August 2001, 08:03</div></div><div class="posttext">What you are talking about here is what MS might have done.<br />
If they didn't want you to fickle with any update installer they could do a &quot;melt-on-run&quot; with the installer.<br />
Ofcourse the correct instruction for this is (as per 1.44 of NSIS):<br />
  Function .onInstSuccess<br />
    Delete $EXEPATH\installer.exe /REBOOTOK<br />
  ; Now if the installation fails we still can run the installer again.<br />
  FunctionEnd<br />
Ofcourse if the installer was renamed this wouldn't work.<br />
For that we would need a GetModuleFileName() Win32 API instruction wrapper (GetModuleFilename $0-9) or a $EXEFILE variable. Maybe even a DeleteInstaller macro. Nah!...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>