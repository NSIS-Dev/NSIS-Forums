<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstaller could not load DLL, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstaller could not load DLL NSIS Discussion" />
	
	<title> Uninstaller could not load DLL [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstaller could not load DLL</div>
<hr />
<div class="pda"><a href="t-295883.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=295883">Uninstaller could not load DLL</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">DarthDmitry</div><div class="date">13th August 2008, 10:44</div></div><div class="posttext">Folks,<br />
<br />
I used the InstDrv plugin to operate my driver, but it doesn't uninstall it for some purpose and doesn't throw up any error.<br />
<br />
So I decided to add to the plug-in my own function. Here is its code:<br />
<br />
<br />
NSISFunction(RemoveDevice)<br />
{<br />
	BOOL		NeedReboot = false;<br />
	char		resultBuf[200];<br />
	DWORD		Flags, result;<br />
<br />
    EXDLL_INIT();<br />
<br />
    popstring(paramBuf); //DriverPackageInfPath<br />
<br />
    if (strcmp(paramBuf, &quot;&quot;) == 0)<br />
    {<br />
        pushstring(&quot;Invalid Driver Path!&quot;);<br />
        return;<br />
    }<br />
<br />
	Flags = SUOI_FORCEDELETE; <br />
	if( SetupUninstallOEMInf(paramBuf, Flags, NULL) )<br />
	{<br />
		wsprintf(resultBuf, &quot;The work is done!!!\n&quot;);<br />
	}<br />
	else<br />
	{<br />
		result = GetLastError();<br />
		wsprintf(resultBuf, &quot;UNINSTALL Error ocured!!! Error code: %08X\n&quot;, result);<br />
	}<br />
<br />
	pushstring(resultBuf);<br />
}<br />
<br />
<br />
But when I use it function I get in unistaller's DetailPrint:<br />
&quot;Could not load: D:\TEMP\nsf88.tmp\InstDrv.dll&quot;<br />
<br />
Does anyone know why it happens? <br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DarthDmitry</div><div class="date">13th August 2008, 11:09</div></div><div class="posttext">I looked through the following topic<br />
&quot;Could not load: XXXX.dll error in log (possibly XP SP3 related)&quot; <br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=291913 <br />
<br />
it says, that DLL loading error could be caused by missed DLL dependencies. But in my case my function use the same libraries as InstDrv, but for all that when I call InstDrv's native function all is OK. =(</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>