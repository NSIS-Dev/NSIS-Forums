<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" super noob question about VB runtime libraries, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  super noob question about VB runtime libraries NSIS Discussion" />
	
	<title> super noob question about VB runtime libraries [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  super noob question about VB runtime libraries</div>
<hr />
<div class="pda"><a href="t-267690.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267690">super noob question about VB runtime libraries</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Zerodyme</div><div class="date">13th March 2007, 12:20</div></div><div class="posttext">hi, im new in this of creating installers and have just found NSIS. i have a few questions:<br />
<br />
1) i've read lost of topics about installin VB runtime librearies and have read the manual, but cant find if the function:<br />
<br />
!insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;msvbvm60.dll&quot; &quot;$SYSDIR\msvbvm60.dll&quot; &quot;$SYSDIR&quot;<br />
<br />
rewrite the dll if its version is older. how can i prevent a dll file to not being rewritten?<br />
<br />
2)how can i see if the dll has been registered or decremeanted correctly? since i have installed Visual Studio in my PC i dont know if it is going to work in another computer, and i dont want to risk its files<br />
<br />
3)how can i register my application to appear in &quot;Control Panel&gt;Install/Uninstall programs&quot;?<br />
<br />
thanks in advance and sorry if they are answered already and i missed the post.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Davion</div><div class="date">13th March 2007, 17:02</div></div><div class="posttext">Hi Zerodyme,<br />
<br />
I'm using the example code to install the VB6 Runtime in my installer too and it works fine.<br />
<br />
If there's an error there will be a message in the log screen, so you should show it. If you don't show the log screen be patient and write a log to the hdd ;)<br />
<br />
on 3)<br />
<br />
to have your App in the Software List you have to write RegKeys for it.<br />
<br />
Have a look on &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall&quot;<br />
<br />
you'll find there many entries from which you can figure out how to set the entries you need.<br />
<br />
Greetz Dave</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zerodyme</div><div class="date">14th March 2007, 08:54</div></div><div class="posttext">Thanks a lot Dave! third point works fine now :) about point 1 and 2 i explain: the example install 7 files<br />
<br />
msvbvm60.dll<br />
oleaut32.dll<br />
olepro32.dll<br />
oleaut32.dll<br />
comcat.dll<br />
asycfilt.dll<br />
stdole2.tlb<br />
<br />
but using the visual studio installer and seeing the SETUP.LST file, it appears much more files. do i have to have to use the &quot;!insertmacro InstallLib&quot; function for all of them or just copy those files with &quot;FILE&quot; function? the files in question are:<br />
<br />
hh.exe<br />
itircl.dll<br />
itss.dll<br />
hhctrl.ocx<br />
RDO20ES.DLL<br />
RDOCURS.DLL<br />
MSRDO20.DLL<br />
MSCMCES.DLL<br />
MSCOMCTL.OCX<br />
CMDLGES.DLL<br />
comdlg32.ocx<br />
MSCOMES.DLL<br />
MSCOMM32.OCX<br />
VB5DB.DLL<br />
MSREPL35.DLL<br />
MSRD2X35.DLL<br />
expsrv.dll<br />
vbajet32.dll<br />
MSJINT35.DLL<br />
MSJTER35.DLL<br />
MSJET35.DLL<br />
dao350.dll<br />
STDFTES.DLL<br />
msstdfmt.dll</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Davion</div><div class="date">14th March 2007, 11:03</div></div><div class="posttext">ok, now I understand what's with this.<br />
<br />
The example in the Docs is for the pure VB6 Runtime, but if you have Components like the MS Common Controls you will need more, thats right.<br />
<br />
Not all of those runtime files have to be registered, so you should try or google first which of them need to.<br />
<br />
do i have to have to use the &quot;!insertmacro InstallLib&quot; function for all of them or just copy those files with &quot;FILE&quot; function? <br />
<br />
You may use the FILE function for the Systemfiles that don't need a registration 	<br />
e.g. the hh.exe and in the other Case the InstallLib macro.<br />
<br />
But I would say you should use the InstallLib for all the DLL and OCX files using either the option &quot;DLL&quot; for those not to reg or &quot;REGDLL&quot; for those which need to be registered.<br />
<br />
Of course, the non DLL or OCX Files should be installed with the Files Function always.<br />
<br />
I hope this helps<br />
<br />
greetz Dave<br />
<br />
btw: I hope you excuse my mistakes in the above posts, my english has become a bit rusty ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zerodyme</div><div class="date">15th March 2007, 08:40</div></div><div class="posttext">no prob about your english, im also a non english speaker and make a lot of mistakes! :D about the files mentioned, i tried to google if the files must be registered or not, im still searching. but also saw the SETUP.LST file of the VB6 installer and in some files it says &quot;DLLSelfRegister&quot; and in others nop. so i suppose those files must use REGDLLL parameter, but i need confirmation. thanks a lot for your patience</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Davion</div><div class="date">15th March 2007, 08:54</div></div><div class="posttext">What about writing a batch file which tries to register the files?<br />
<br />
If there is no need to register a DLL or OCX there will be a message that the entry point isn't found.<br />
<br />
Create a new txt-File with<br />
<br />
regsvr32 &quot;itircl.dll&quot;<br />
pause<br />
regsvr32 &quot;tss.dll&quot;<br />
pause<br />
.<br />
.<br />
.<br />
<br />
and so on.<br />
<br />
If they are in the System32 or the WinDir you don't need the full path I think.<br />
<br />
If a file cant be registered there will be an errormessage otherwise there will be a message like &quot;Registering of xyz hast succeeded&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zerodyme</div><div class="date">15th March 2007, 09:55</div></div><div class="posttext">thanks a lot! i tried what you told me and yes, the ones in the SETUP.LST with &quot;DLLSelfRegister&quot; could be registered using<br />
 <br />
regsvr32 &quot;itircl.dll&quot; <br />
<br />
the ones without it couldnt be registered. now i have a tip of which files must be registered and how to test it, thank you Dave!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>