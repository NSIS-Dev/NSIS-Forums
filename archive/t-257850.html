<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecShell does not run!, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecShell does not run! NSIS Discussion" />
	
	<title> ExecShell does not run! [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecShell does not run!</div>
<hr />
<div class="pda"><a href="t-257850.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257850">ExecShell does not run!</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">19th October 2006, 02:36</div></div><div class="posttext">I want to redistribute environment to run my application. When I use ExecShell, it does not execute.I do not know why,somebody can help me!<br />
My code here:<br />
<br />
SetOutPath &quot;$INSTDIR&quot;<br />
SetOverwrite ifnewer<br />
Fle &quot;e:\client\install\vcredist_x86.exe&quot;<br />
ExecShell '&quot;$INSTDIR\vcredist_x86.exe&quot;' 'SW_HIDE'<br />
<br />
Thank you,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">19th October 2006, 02:44</div></div><div class="posttext">I think I forgot something and I also add some option<br />
<br />
SetOutPath &quot;$INSTDIR&quot;<br />
SetOverwrite ifnewer<br />
Fle &quot;e:\client\install\vcredist_x86.exe&quot;<br />
ExecShell &quot;open&quot; '&quot;$INSTDIR\vcredist_x86.exe&quot;' SW_HIDE<br />
<br />
It runs but display an error:<br />
&quot;Command line operation syntax error.Type command /?for help&quot;<br />
But I make right ExecShell in help file, I may make some mistakes in some places.<br />
Can you help me!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">niteflyer</div><div class="date">19th October 2006, 10:50</div></div><div class="posttext">ExecShell &quot;open&quot; '&quot;$INSTDIR\vcredist_x86.exe&quot;' '' SW_HIDE<br />
<br />
If you want to specify the &quot;showmode&quot; you have to pass [parameters] as well (here: empty list). see<br />
http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1.3</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">19th October 2006, 11:37</div></div><div class="posttext">Thank niteflyer a lot,<br />
I do it the same way you help but It can not run vcredist_x86.exe, only announce an error the same below.I do not know why. Can you tell me another way ?<br />
My code here:<br />
Function .onInit<br />
  ; check for .NET<br />
 !insertmacro MUI_LANGDLL_DISPLAY<br />
  Call IsDotNETInstalled<br />
    Pop $R3<br />
    StrCmp $R3 0 not_found found<br />
    found:<br />
        goto end<br />
    not_found:<br />
         MessageBox MB_OKCANCEL &quot;We need to create an environment to run this program&quot; IDOK installNET IDCANCEL 0<br />
installNET:<br />
    SetOutPath &quot;$INSTDIR&quot;<br />
    SetOverwrite ifnewer<br />
    File &quot;e:\client\install\vcredist_x86.exe&quot;<br />
    ExecShell &quot;open&quot; '&quot;$INSTDIR\vcredist_x86.exe&quot;' '' SW_HIDE<br />
<br />
    end:<br />
FunctionEnd<br />
<br />
Please help me!!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">niteflyer</div><div class="date">19th October 2006, 11:57</div></div><div class="posttext">I am not familiar with vcredist. Does it require parameters ? I have no idea, why my suggestion does not work.<br />
Did you try<br />
ExecShell &quot;open&quot; '&quot;$INSTDIR\vcredist_x86.exe&quot;'<br />
just to figure out if the SW-parameter is the baddie? <br />
<br />
And I dont remember if ExecShell waits for completion of vcredist; I guess you want to wait, if you are doing this onInit ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">niteflyer</div><div class="date">19th October 2006, 12:00</div></div><div class="posttext">or try<br />
ExecShell &quot;open&quot; &quot;$INSTDIR\vcredist_x86.exe&quot; &quot;&quot; SW_HIDE</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">20th October 2006, 02:26</div></div><div class="posttext">Thank niteflyer,<br />
Now, It run well but I want to SW_HIDE it when I run it. Because users do not know about &quot;redistribute&quot; of Visual Studio 2005. Consequently, I want it run on SW_HIDE. I must use ExecShell to hide it. <br />
Your command can run it but it does not hide the screen redistribute VC++.<br />
ExecShell &quot;open&quot; &quot;$INSTDIR\vcredist_x86.exe&quot; &quot;&quot; SW_HIDE<br />
Can you help me please!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">niteflyer</div><div class="date">20th October 2006, 10:17</div></div><div class="posttext">Could it be that vcredist unhides itself or spawns another (visible) process ? If so, you should use FindWindow and SendMessage to hide the new window when it gets visible; not nice but I have no more ideas.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">20th October 2006, 10:23</div></div><div class="posttext">Thank you niteflyer for your idea,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ranahimal</div><div class="date">29th November 2006, 15:24</div></div><div class="posttext">Hi!<br />
Can anybody help me how to integrate VCRedist.exe into my Application setup.<br />
How to integrate it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">30th November 2006, 01:22</div></div><div class="posttext">Hi ranahimal,<br />
<br />
ranahimal said:<br />
Can u help me?<br />
Hi!<br />
Can anybody help me how to integrate VCRedist.exe into my Application setup.<br />
How to integrate it?<br />
<br />
I do not understand clearly what you want to say? Can you tell specific your opinion?<br />
At that time, I hope I can help you!<br />
Have a nice day!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">1st December 2006, 15:22</div></div><div class="posttext">If you run VCRedist_x86.exe with a &quot;/?&quot; switch, you'll see the parameter for silent mode is &quot;/Q&quot;.<br />
<br />
So, instead of using ExecShell, you should be using just Exec like this:<br />
<br />
Exec '&quot;$INSTDIR\VCRedist_x86.exe&quot; /Q'<br />
<br />
<br />
edit:<br />
I changed references of VCRedist.exe to VCRedist_x86.exe to match the original post.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">1st December 2006, 16:39</div></div><div class="posttext">I think that should be ExecWait instead of Exec.<br />
<br />
I created a small installer yesterday just to check this out. What I've used is<br />
<br />
!include &quot;LogicLib.nsh&quot;<br />
!define UNINSTALL_KEY &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall&quot;<br />
!define APP_KEY &quot;{A49F249F-0C91-497F-86DF-B2585E8E76B7}&quot;<br />
Section -VCRedistributable<br />
	ReadRegStr $R0 HKLM &quot;${UNINSTALL_KEY}\${APP_KEY}\&quot; &quot;DisplayName&quot;<br />
	${If} ${Errors}<br />
		# reg value doesn't exist (ie, needs installed)<br />
		InitPluginsDir<br />
		SetOutPath &quot;$PLUGINSDIR&quot;<br />
		File &quot;WindowsInstaller-KB893803-v2-x86.exe&quot;<br />
		File &quot;VCRedist_x86.exe&quot;<br />
		ExecWait '&quot;$PLUGINSDIR\WindowsInstaller-KB893803-v2-x86.exe&quot;  /quiet /norestart'<br />
		ExecWait '&quot;$PLUGINSDIR\VCRedist_x86.exe&quot;  /Q'<br />
	${EndIf}<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NinjaHippie</div><div class="date">13th December 2007, 11:00</div></div><div class="posttext">Here's the script you need to do the VC Redist silent install properly:<br />
http://blogs.msdn.com/astebner/archive/2007/02/07/update-regarding-silent-install-of-the-vc-8-0-runtime-vcredist-packages.aspx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NinjaHippie</div><div class="date">13th December 2007, 11:02</div></div><div class="posttext">Lol, what happened to my URL? Anyway, here's the text from that page:<br />
<br />
Update regarding silent install of the VC 8.0 runtime (vcredist) packages<br />
<br />
A while back, I posted this item on my blog that describes options for silent installation of the Visual C++ 8.0 runtime redistributable setup packages.  When I investigated this issue and wrote that blog post, I based the command line parameters on the versions of vcredist_x86.exe, vcredist_x64.exe and vcredist_ia64.exe that are included in the directory %ProgramFiles%\Microsoft Visual Studio 8\SDK\v2.0\Bootstrapper\Packages when installing Visual Studio 2005.<br />
<br />
However, a customer recently alerted me to an issue that I wasn't aware of previously.  The standalone versions of the VC runtime redistributable packages that are available for download via the web are packaged differently, and so the command lines that I previously documented for silent installation will not work with those versions of the packages.  Essentially, the standalone versions are wrapped in a second self-extracting EXE that displays a EULA before allowing extraction and execution of the main setup package, whereas the packages included as part of Visual Studio 2005 directly launch setup and are not doubly wrapped.<br />
<br />
Therefore, here are some amended silent install instructions for the VC 8.0 runtime redistributable packages.  If you are using the packages included as a part of Visual Studio 2005, you can continue to use the silent install switches from my previous blog post.<br />
<br />
However, if you have downloaded the standalone VC 8.0 redistributable packages, you will need to modify the command lines slightly.  The following command lines can be used to install the original release of the standalone VC 8.0 redistributable packages:<br />
<br />
    * For x86: vcredist_x86.exe /q:a /c:&quot;VCREDI~1.EXE /q:a /c:&quot;&quot;msiexec /i vcredist.msi /qn&quot;&quot; &quot;<br />
    * For x64: vcredist_x64.exe /q:a /c:&quot;VCREDI~2.EXE /q:a /c:&quot;&quot;msiexec /i vcredist.msi /qn&quot;&quot; &quot;<br />
    * For ia64: vcredist_ia64.exe /q:a /c:&quot;VCREDI~3.EXE /q:a /c:&quot;&quot;msiexec /i vcredist.msi /qn&quot;&quot; &quot;<br />
<br />
The following command lines can be used to install the Visual Studio 2005 SP1 release of the standalone VC 8.0 redistributable packages:<br />
<br />
    * For x86: vcredist_x86.exe /q:a /c:&quot;VCREDI~3.EXE /q:a /c:&quot;&quot;msiexec /i vcredist.msi /qn&quot;&quot; &quot;<br />
    * For x64: vcredist_x64.exe /q:a /c:&quot;VCREDI~2.EXE /q:a /c:&quot;&quot;msiexec /i vcredist.msi /qn&quot;&quot; &quot;<br />
    * For ia64: vcredist_ia64.exe /q:a /c:&quot;VCREDI~1.EXE /q:a /c:&quot;&quot;msiexec /i vcredist.msi /qn&quot;&quot; &quot;<br />
<br />
If you would like to install the VC runtime packages in unattended mode (which will show a small progress bar but not require any user interaction), you can change the /qn switch above to /qb.  If you would like the progress bar to not show a cancel button, then you can change the /qn switch above to /qb!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th December 2007, 17:13</div></div><div class="posttext">Your URL is here: http://blogs.msdn.com/astebner/archive/2007/02/07/update-regarding-silent-install-of-the-vc-8-0-runtime-vcredist-packages.aspx</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>