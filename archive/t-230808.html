<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" use system::call and visual basic dll, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  use system::call and visual basic dll NSIS Discussion" />
	
	<title> use system::call and visual basic dll [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  use system::call and visual basic dll</div>
<hr />
<div class="pda"><a href="t-230808.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=230808">use system::call and visual basic dll</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">oliver007</div><div class="date">12th November 2005, 13:58</div></div><div class="posttext">hi there,<br />
<br />
this is my first here so hello all :)<br />
<br />
I just started using nsis installer, wow ! that is really great !!!<br />
I've been able to make quick and small installer !!! I've never seen tool so fine before !<br />
<br />
anyway there is something I cannot resolve:<br />
use system:call with one of my dll.<br />
<br />
here is the code:<br />
<br />
	;Call Function in Dll<br />
	SetPluginUnload alwaysoff<br />
	System::Call '$PROGRAMFILES\ExcelTool\TestDll::LoadTool(t 'go')'<br />
	SetPluginUnload manual<br />
	System::Free 0<br />
<br />
What I want is to call a function in my dll:<br />
Public Function LoadTool(sCommand As String)<br />
   If sCommand = &quot;go&quot; Then MsgBox &quot;Working!&quot;<br />
End Function<br />
<br />
Any idea is welcome :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">12th November 2005, 14:14</div></div><div class="posttext">You not described the problem in your post. May be<br />
System::Call '$PROGRAMFILES\ExcelTool\TestDll::LoadTool(t &quot;go&quot;)'<br />
And did you checked TestDll entry point (for example using VS &quot;Dependency Walker&quot;? BTW, is it TestDll, TestDll.Dll or Test.Dlls?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oliver007</div><div class="date">12th November 2005, 15:14</div></div><div class="posttext">hi takhi,<br />
<br />
my dll name is TestDll.dll<br />
<br />
the problem come from here for sure:<br />
System::Call '$PROGRAMFILES\ExcelTool\TestDll::LoadTool(t &quot;go&quot;)'<br />
<br />
I'm looking for code about entry point in vb but cannot find any piece of code :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">12th November 2005, 16:32</div></div><div class="posttext">Currently I have not VB installed, but in MS VS you probably can create new dll-type VB project, may be with simple project template. You can also search internet for VB code samples.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">15th November 2005, 00:29</div></div><div class="posttext">I have tried (unsuccessfully) making a VB dll and there were only four exported functions that I didn't add. So now I only use c/c++ for my dlls.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>