<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ShowModelessHTMLDialog - crash on close, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ShowModelessHTMLDialog - crash on close NSIS Discussion" />
	
	<title> ShowModelessHTMLDialog - crash on close [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ShowModelessHTMLDialog - crash on close</div>
<hr />
<div class="pda"><a href="t-297728.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=297728">ShowModelessHTMLDialog - crash on close</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Ivan Andreevich</div><div class="date">22nd September 2008, 23:56</div></div><div class="posttext">I've never worked with NSIS (or with Windows API for that matter) before the current project, so bear with me. <br />
<br />
I have an NSIS installer which displays an HTML file in a dialog, created via ShowModelessHTMLDialog (http://msdn.microsoft.com/en-us/library/aa741862(VS.85).aspx) in a custom plugin, while another file is downloaded via NSISdl in the main window.<br />
<br />
The problem is that if I close this modeless dialog, the application &quot;..has encountered a problem and needs to close&quot;. Meanwhile, the background download completes while the error message is up, by the way. So there is no other side-effects other than this crash message in the app. <br />
<br />
If I use ShowHTMLDialog (http://msdn.microsoft.com/en-us/library/aa741858(VS.85).aspx) instead, there is no crash on close. However, that's not what I need, since the background download will not start until the window is closed, and that defeats the purpose. <br />
<br />
I also tried calling my function, and creating the modeless dialog outside of NSIS as a separate EXE. In that case, no crash occurs. <br />
<br />
This leads me to believe that something NSIS-related is going on here. Any idea about what could be happening?<br />
<br />
Thanks,<br />
Ivan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ivan Andreevich</div><div class="date">25th September 2008, 01:05</div></div><div class="posttext">So far, I've switched to using IWebBrowser2 interface and just running an external IE window, customized to my needs. It works without crashing, but it's obviously not the same thing. It might work for what I need, not entirely sure. <br />
<br />
However, I think that the crash I am experiencing with the ShowModelessHTMLDialog could actually be an NSIS bug.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>