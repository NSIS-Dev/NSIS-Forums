<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with LineFind and attributs, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with LineFind and attributs NSIS Discussion" />
	
	<title> Problem with LineFind and attributs [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with LineFind and attributs</div>
<hr />
<div class="pda"><a href="t-234618.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=234618">Problem with LineFind and attributs</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">xilay</div><div class="date">3rd January 2006, 13:10</div></div><div class="posttext">Hello,<br />
<br />
I hope you'll understand my problem with my poor english...<br />
<br />
Well, I use ${LineFind} to replace some lines of a file.<br />
All is ok.<br />
But I can't write or even read the file when I'm not on the server where I used my setup.<br />
To use the file, I must go on the server and change the safety (I'm not sure it's the good word in english) of the file (all rights for everybody).<br />
<br />
Of course, before use LineFind, I can read the file when I'm not on the server.<br />
<br />
I hope my explanations are enough clear.<br />
<br />
If you have an idea, thanks for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd January 2006, 18:23</div></div><div class="posttext">I don't know why, but it opens the file for writing and writes something to it. It also has code that copies over a file, but I'm not sure the it's the same file. Instructor will know best, he wrote the function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">3rd January 2006, 22:15</div></div><div class="posttext">As I understand you are trying to modify/read the text file that is located on the server? If you have access rights &quot;only read&quot; and use call like:<br />
${LineFind} &quot;\\server\data\a.log&quot; &quot;&quot; &quot;1:-1&quot; &quot;LineFindCallback&quot;then will be error because function trying to modify &quot;\\server\data\a.log&quot;. Just use local disk for the output file (if you have full access :) ).${LineFind} &quot;\\server\data\a.log&quot; &quot;C:\a.log&quot; &quot;1:-1&quot; &quot;LineFindCallback&quot; If you want only read LineFind have option &quot;/NUL&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xilay</div><div class="date">4th January 2006, 13:21</div></div><div class="posttext">Ok, my english is really poor. :( <br />
<br />
I can modify the file with the setup.<br />
When the installation is finished, if I want to read the modified file when I'm not on the server, I can't, attributs of the file are diff√©rent before and after the setup.<br />
<br />
Before the setup write the file, I have full access to the file, after, I can't read it...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">4th January 2006, 20:33</div></div><div class="posttext">LineFind creates a file with normal attributes in any way. I now trying to find the solution.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">4th January 2006, 20:52</div></div><div class="posttext">If you have access rights &quot;only read&quot; and use call like [the code shown on Instructor's post] then will be error because function trying to modify &quot;\\server\data\a.log&quot;.<br />
<br />
I think you should use ${LineRead} if you just want to read a line of the file.<br />
<br />
My opinion is that a function called &quot;LineFind&quot; should only find if a line exists, and not even read it (there is the &quot;LineRead&quot; function for that), nor to write the line of the selection chosen (maybe a new function for this?). But still, either the function name is wrong or are its features. I would suggest the function name to be &quot;LineSelect&quot; because it is actually selecting which lines should be written to another file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">4th January 2006, 21:11</div></div><div class="posttext">:) I long time thought about what name give to function and was choosing between several not exhaustive names. I like your variant &quot;LineSelect&quot; unfotunately it doesn't come to me when I thought.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">4th January 2006, 22:25</div></div><div class="posttext">I think you should use ${LineRead} if you just want to read a line of the file.My mistake. You really wanted to replace lines in the file. Maybe you could use the ${GetFileAttributes} to get the file attributes then set it back again with the SetFileAttributes NSIS instruction. It even outputs the result compatible with the attribute input parameter of the instruction.<br />
<br />
Now about making ${LineSelect} to have this functionality as well: I actually think you should either mention to use ${GetFileAttributes} w/ SetFileAttributes to put them inside the function.<br />
<br />
Maybe it would be even better to create other types of functions just to, for example, specificly replace a file, then you could make sure of the attributes of the file being replaced and calling this function from other functions and simplifying even more code. A drawback would be including every single function by hand or by creating a header file, and the amount of calls. That's what I simplified on UseFunc, but nobody actually wanted something to be improved on it, so I just about abandoned it (still sometimes working on it). I know my contrib is not the best, but some comment for improvement would suffice.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">4th January 2006, 23:19</div></div><div class="posttext">Maybe you could use the ${GetFileAttributes} to get the file attributes then set it back again with the SetFileAttributes NSIS instruction.attribute1|attribute2|... of SetFileAttributes sets on compile-time.<br />
Maybe it would be even better to create other types of functions just to, for example, specificly replace a file, then you could make sure of the attributes of the file being replaced and calling this function from other functions and simplifying even more code.I think it is better to write an example for user how to do some concrete things using basic functions rather than increase size of the installer by calling another function internally... but some comment for improvement would suffice.Why in usefunc.zip so many empty directories? :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xilay</div><div class="date">5th January 2006, 09:31</div></div><div class="posttext">I don't think it's the best way, but this is my solution.<br />
I use CopyFiles, in fact, I edit a temporary file and copy it with the good name.<br />
I can't read the temporary file but I can do it with the copy...<br />
<br />
Don't know why:weird: <br />
<br />
Thanks for your helps</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">5th January 2006, 10:33</div></div><div class="posttext">attribute1|attribute2|... of SetFileAttributes sets on compile-time.^^ Idea for run-time function right there.<br />
<br />
Why in usefunc.zip so many empty directories?The zip file is designed to be extracted to NSIS dir.... Greaaat comment, thx ;).<br />
<br />
EDIT:<br />
I think it is better to write an example for user how to do some concrete things using basic functions rather than increase size of the installer by calling another function internally.Not always. Macro is still better than giving examples because they do not add anything than just putting code right on except by compilation time. I would  still recommend both the automatic method (function macro w/ calls done to other functions) and the manual method (function macro w/ all the code optimized).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">5th January 2006, 21:13</div></div><div class="posttext">I will experiment with the attributes and LineFind, and you can try this:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=234814</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>