<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" File/path last character evaluation, concatenation, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  File/path last character evaluation, concatenation NSIS Discussion" />
	
	<title> File/path last character evaluation, concatenation [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  File/path last character evaluation, concatenation</div>
<hr />
<div class="pda"><a href="t-316082.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=316082">File/path last character evaluation, concatenation</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Lodester</div><div class="date">7th January 2010, 20:52</div></div><div class="posttext">Learning lots every day about NSIS, so far I've got to say I'm pretty impressed. Especially very happy to see the divestment from .ini files (InstallOptions) in deference to native scripting (nsDialogs and in general).<br />
<br />
Anyway, I know I'm doing some things inefficiently, as all beginnners do, but I have what I think is a simple question and I've not seen the magic header command or custom function/macro that makes this more 'elegant' , but its gotta be out there (?)<br />
<br />
I have to evaluate a path from a text control to normalize it for use, in two ways:<br />
1) If the path supplied did not have a trailing slash, append one.<br />
2) In either case, append a subdirectory to the string<br />
So there are two outputs I'm looking for, shown here as $1 and $5, respectively<br />
<br />
StrCpy $1 &quot;C:\somepath\&quot;     ;from input may or may not have trailing backslash<br />
StrLen $2 $1<br />
IntOp $3 $2 - 1<br />
StrCpy $4 $1 &quot;&quot; $3 ; now i know the last char in $4<br />
${If} $4 != &quot;\&quot;  <br />
      StrCpy $5 &quot;$1\SubDir\&quot;     ;Append Dir (case 2) &quot;C:\somepath\Subdir\&quot;<br />
      StrCpy $1 &quot;$1\&quot;            ;normalize input (case 1) &quot;C:\somepath\&quot;<br />
${Else}<br />
       StrCpy $0 &quot;SubDir\&quot;       ;workaround(?) for concat of strings to avoid C:\somepath\\SubDir\<br />
       StrCpy $5 &quot;$bkuppath_state$0&quot;    ;C:\somepath\Subdir\<br />
<br />
<br />
<br />
This works, but it seems a bit...verbose. And looking ahead i see needing to evaluate this condition a lot.<br />
<br />
Is there a better way? Teach me, i am in the throes of NSIS scripting consumption, and i need nourishment.<br />
<br />
Thanks in advance for help!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">meaningoflights</div><div class="date">8th January 2010, 11:20</div></div><div class="posttext">Just put your code in a function so it accepts a path and return it with just one trailing slash.<br />
<br />
Reading your Q is inspiring and written in a such a friendly colloquial tone that I think you'll get a better response from some major dude or forum king. Be sure to check back when others get a chance to see it and think it thru...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">11th January 2010, 08:44</div></div><div class="posttext">Your best bet is either a function or a macro. Functions cannot accept parameters, however. Macros accept parameters, but every call is saved separately in your installer, so the overall exe size would increase (very) slightly.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>