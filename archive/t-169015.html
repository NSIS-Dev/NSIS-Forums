<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" .nsi Key?????, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  .nsi Key????? NSIS Discussion" />
	
	<title> .nsi Key????? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  .nsi Key?????</div>
<hr />
<div class="pda"><a href="t-169015.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=169015">.nsi Key?????</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">VegetaSan</div><div class="date">11th February 2004, 20:55</div></div><div class="posttext">.nsi files will open with NotePad where can I find that key in the register<br />
<br />
In wich of these map and where <br />
<br />
-HKEY_CLASSES_ROOT<br />
-HKEY_CURRENT_USER<br />
-HKEY_LOCAL_MACHINE<br />
-HKEY_USER<br />
-HKEY_CURRENT_CONFIG<br />
<br />
??? I allready looked but I cant find it<br />
<br />
But I did found HKEY_CLASSES_ROOT\.nsi<br />
<br />
But there is nothing in there. I have opend it with NotePad and it was not usefull????</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th February 2004, 20:56</div></div><div class="posttext">.nsi is linked to NSIS.Script</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VegetaSan</div><div class="date">11th February 2004, 21:19</div></div><div class="posttext">I found it :) .....  But still a question :(<br />
<br />
I want to have change the key in this map <br />
<br />
HKEY_USERS\S-1-5-21-1614895754-839522115-682003330-1003\Software\Microsoft\Windows\CurrentVersion\Explorer \FileExts\.ogm\OpenWithList<br />
<br />
The Key Old Key : <br />
<br />
Windows Registry Editor Version 5.00<br />
<br />
[HKEY_USERS\S-1-5-21-1614895754-839522115-682003330-1003\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ogm]<br />
&quot;Progid&quot;=&quot;mplayerXP.OGMFile&quot;<br />
<br />
[HKEY_USERS\S-1-5-21-1614895754-839522115-682003330-1003\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ogm\OpenWithList]<br />
&quot;a&quot;=&quot;wmplayer.exe&quot;<br />
&quot;MRUList&quot;=&quot;acdeb&quot;<br />
&quot;b&quot;=&quot;iexplorer.exe&quot;<br />
&quot;c&quot;=&quot;wmplayer.exe&quot;<br />
&quot;d&quot;=&quot;VirtualDubMod.exe&quot;<br />
&quot;e&quot;=&quot;VirtualDubMod.exe&quot;<br />
&quot;f&quot;=&quot;wmplayer.exe&quot;<br />
<br />
[HKEY_USERS\S-1-5-21-1614895754-839522115-682003330-1003\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ogm\OpenWithProgids]<br />
&quot;ogm_auto_file&quot;=hex(0):<br />
&quot;Ogg File (*.ogg)&quot;=hex(0):<br />
&quot;OptionsFile&quot;=hex(0):<br />
&quot;mplayerXP.OGMFile&quot;=hex(0):<br />
&quot;mplayercXP.OGMFile&quot;=hex(0):<br />
<br />
<br />
The Key I want : <br />
<br />
Windows Registry Editor Version 5.00<br />
<br />
[HKEY_USERS\S-1-5-21-1614895754-839522115-682003330-1003\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ogm]<br />
&quot;Progid&quot;=&quot;mplayerXP.OGMFile&quot;<br />
<br />
[HKEY_USERS\S-1-5-21-1614895754-839522115-682003330-1003\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ogm\OpenWithList]<br />
&quot;a&quot;=&quot;mplayercXP.exe&quot;<br />
&quot;MRUList&quot;=&quot;cadeb&quot;<br />
&quot;b&quot;=&quot;mplayercXP.exe&quot;<br />
&quot;c&quot;=&quot;mplayercXP.exe&quot;<br />
&quot;d&quot;=&quot;mplayercXP.exe&quot;<br />
&quot;e&quot;=&quot;mplayercXP.exe&quot;<br />
<br />
[HKEY_USERS\S-1-5-21-1614895754-839522115-682003330-1003\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ogm\OpenWithProgids]<br />
&quot;ogm_auto_file&quot;=hex(0):<br />
&quot;Ogg File (*.ogg)&quot;=hex(0):<br />
&quot;OptionsFile&quot;=hex(0):<br />
&quot;mplayerXP.OGMFile&quot;=hex(0):<br />
&quot;mplayercXP.OGMFile&quot;=hex(0):<br />
<br />
Could somebody tell me how to change the key<br />
THANKS, VegetaSan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainmanp7</div><div class="date">11th February 2004, 21:25</div></div><div class="posttext">this is not where you want to change<br />
what will open with explorer and such<br />
<br />
This key<br />
HKEY_USERS\S-1-5-21-1614895754-839522115-682003330-1003<br />
<br />
Changes per every machine<br />
<br />
You want a differn't registry  key<br />
<br />
That's not the key your looking to change<br />
<br />
or rather should not be looking to change.<br />
<br />
You want a differn't registry key :)<br />
&quot;You don't want a small Coke you want a Large Coke.&quot;<br />
<br />
can you give us a mre detailed example of what your trying to accomplish ?<br />
This would help us better to help you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VegetaSan</div><div class="date">11th February 2004, 21:38</div></div><div class="posttext">Oke, I want the key in this map<br />
<br />
HKEY_USER\<br />
S-1-5-21-1614895754-839522115-682003330-1003\a-S mpcXP\ogm.reg<br />
<br />
I want to name the key &quot;ogm.reg&quot;<br />
<br />
and I want to set a key in that map that contains register information to the .ogm extension to open with &quot;mplayercXP.exe&quot;<br />
insted of &quot;wmplayer.exe&quot;<br />
<br />
<br />
How Do I do that <br />
<br />
Thanks, :)VegetaSan:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainmanp7</div><div class="date">11th February 2004, 22:56</div></div><div class="posttext">you don't do it that way<br />
you do it in the .exe<br />
extention filed located in Hkey Classes Root<br />
That's where the extentions exsist for the mapping of a type<br />
of extention<br />
<br />
so if i had say<br />
.aif Extention and i needed it to open with media player<br />
<br />
.aif<br />
--[OpenWithList]<br />
----|wmplayer.exe<br />
--[OpenWithProgIds]<br />
---&gt;AIFFFile REG_NONE <br />
--[PersistentHandler]<br />
--&gt;{098f2470-bae0-11cd-b579-08002b30bfeb}<br />
<br />
or like this in the same registry area<br />
Windows Registry Editor Version 5.00<br />
<br />
[HKEY_CLASSES_ROOT\.ai]<br />
&quot;Content Type&quot;=&quot;application/postscript&quot;<br />
@=&quot;PaintShopPro8.Image&quot;<br />
<br />
this makes the extention .ai open with PaintShopPro8<br />
<br />
So write the section to the HKEY_CLASSES_ROOT area<br />
and not the current user area<br />
<br />
this way one type of extention can be opend by your installed application :)<br />
<br />
but to get the current users infro from the registry and jump to the correct key at hand like the first proposed thing you asked about - as far as I know there is no complete way of Auto detecting the current ZONE<br />
the special number of the current logged on user based in NSIS and windows<br />
like $wininstall routine for installing directly to windows<br />
<br />
as for the area that you were first writing to that area can also be um lets say Restricted and especially if the user is not administrator. and somtimes even if he or she is not Administrator<br />
<br />
so writing to the top key is the safest bet of getting that extention installed and mapped to the program :)<br />
<br />
I know how to do it in other programming languages<br />
such as vb6 and C++ and others but the functionality as far as I know is not built into nsis as of yet.<br />
<br />
I hope this helps ?<br />
Mabey someone else can shed more light on this...<br />
<br />
P.s. as for <br />
&quot;Could somebody tell me how to change the key&quot;<br />
writing back over the key changes it :)<br />
<br />
Does this help ? <br />
:igor:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VegetaSan</div><div class="date">12th February 2004, 06:33</div></div><div class="posttext">But how do you insert a key with the nsis installer?<br />
<br />
to HKEY_CLASSES_ROOT\.ogm<br />
<br />
??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zarged</div><div class="date">12th February 2004, 09:00</div></div><div class="posttext">WriteRegStr HKCR &quot;.irc\Shell\open\command&quot; &quot;&quot; &quot;mirc.exe&quot;<br />
Sets default key to mirc.exe<br />
WriteRegStr HKCR &quot;.irc\Shell\open\command&quot; &quot;BackupCommand&quot; &quot;Pirch.exe&quot;<br />
Sets the &quot;BackupCommand&quot; key to &quot;Pirch.exe&quot;<br />
<br />
There are detailed instructions in the documentation as well as plenty of examples in the Examples directory too :)<br />
There is also a function written which does this work for you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VegetaSan</div><div class="date">12th February 2004, 16:52</div></div><div class="posttext">I have checked the .ogm in HKEY_CLASSES_ROOT<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.ogm\ShellEx\open\command]<br />
@=&quot;mplayercXP.exe&quot;<br />
&quot;C:\\Program Files\\a-S Media Player ClassicXP\\mplayercXP.exe&quot;=&quot;mplayercXP.exe&quot;<br />
<br />
What is wrong with this?? :( It should be right!<br />
<br />
If you see any errors in this piece of the Key please tell meI have checked the .ogm in HKEY_CLASSES_ROOT<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.ogm\ShellEx\open\command]<br />
@=&quot;mplayercXP.exe&quot;<br />
&quot;C:\\Program Files\\a-S Media Player ClassicXP\\mplayercXP.exe&quot;=&quot;mplayercXP.exe&quot;<br />
<br />
What is wrong with this?? :( It should be right!<br />
<br />
If you see any errors in this piece of the Key please tell me</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VegetaSan</div><div class="date">12th February 2004, 16:55</div></div><div class="posttext">sorry I have pasted it two times !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainmanp7</div><div class="date">12th February 2004, 17:11</div></div><div class="posttext">ok I had to do some registry stuff with my installer<br />
and I ran into a regitry portion of my install that I can show you as a Example and it works ;)<br />
<br />
WriteRegStr HKLM &quot;SOFTWARE\Apache Group&quot; &quot;&quot; &quot;&quot;<br />
WriteRegStr HKLM &quot;SOFTWARE\Apache Group\Apache&quot; &quot;&quot; &quot;&quot;<br />
WriteRegStr HKLM &quot;SOFTWARE\Apache Group\Apache\2.0.48&quot; &quot;&quot; &quot;&quot;<br />
WriteRegStr HKLM &quot;SOFTWARE\Apache Group\Apache\2.0.48&quot; &quot;ServerRoot&quot; &quot;$INSTDIR\Apache Group\Apache2\&quot;<br />
WriteRegDWORD HKLM &quot;SOFTWARE\Apache Group\Apache\2.0.48&quot; &quot;Shared&quot; &quot;1&quot;<br />
<br />
By writing the key it actually creates the key<br />
I think this can be done Automagicly as well :weird:<br />
<br />
that's nsis registry coding<br />
not the .reg exported stuff:igor: <br />
<br />
From the code your showing me is a Registry export file .reg<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.ogm\ShellEx\open\command]<br />
@=&quot;mplayercXP.exe&quot;<br />
&quot;C:\\Program Files\\a-S Media Player ClassicXP\\mplayercXP.exe&quot;=&quot;mplayercXP.exe&quot;<br />
<br />
show us the Nsis code <br />
<br />
Let me know if this helps :)<br />
<br />
Don't always take the answer as the final solution because there may be more then 1 solution :)<br />
try looking at<br />
AUFile in HKLM<br />
Somtimes more things need to be done to solve the solution<br />
so if we can't show you an example ,we try to lead you in the right direction hopefully.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VegetaSan</div><div class="date">12th February 2004, 20:36</div></div><div class="posttext">Could you be more specified .......<br />
A Kinda like this<br />
<br />
WriteRegStr HKLM &quot;SOFTWARE\YOUR GROEP NAME&quot; &quot;&quot; &quot;&quot;<br />
<br />
Thanks, VegetaSan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VegetaSan</div><div class="date">12th February 2004, 20:49</div></div><div class="posttext">Oke I got that part, but now I want to insert a key to this map that contains register information to set .ogm files to open with &quot;mplayercXP.exe&quot;<br />
<br />
How do I do that?? <br />
<br />
THX, VegetaSan</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>