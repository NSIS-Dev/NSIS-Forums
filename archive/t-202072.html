<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" function does not work in section? (ReplaceOnLine), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  function does not work in section? (ReplaceOnLine) NSIS Discussion" />
	
	<title> function does not work in section? (ReplaceOnLine) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  function does not work in section? (ReplaceOnLine)</div>
<hr />
<div class="pda"><a href="t-202072.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=202072">function does not work in section? (ReplaceOnLine)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">rpnfan</div><div class="date">14th December 2004, 17:04</div></div><div class="posttext">I want to use some of the sample scripts/functions and tried to use the function ReplaceOnLine to change text in a specific line of a text file. But when I try that I get the following error message:<br />
<br />
Call &quot;ReplaceOnLine&quot;<br />
Error: command Function not valid in section<br />
Error in macro ReplaceOnLine on macroline 7<br />
Error in script &quot;F:\Programme\NSIS\Examples\mini.nsi&quot; on line 113 -- aborting creation process<br />
<br />
I have created a mini example (see attached files) to show the problem.<br />
<br />
Short overlook:<br />
<br />
1) definition of the function (padded in a macro for easier usage)<br />
<br />
2) using the function in a section<br />
<br />
results in the error message above<br />
<br />
Looking forward for any pointers. I guess I'm using the function wrong, but don't have a clue what goes wrong. Other functions show the same problem.<br />
<br />
Best regards<br />
Peter</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">14th December 2004, 17:38</div></div><div class="posttext">exclude the Function ReplaceOnLine from your macro.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rpnfan</div><div class="date">14th December 2004, 21:36</div></div><div class="posttext">Thank you very much for your answer. That was an easy error - &quot;Wald vor lauter Bäumen und so...&quot; ;-)<br />
<br />
Then my next question arises: What's the difference between a macro and a user function? When should I use which type?<br />
<br />
Thank you for your help.<br />
<br />
Grüße<br />
Peter</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th December 2004, 11:20</div></div><div class="posttext">A Function is like a routine or procedure that you can call multiple times. The Function code is only stored in your install once.<br />
<br />
A macro is compile-time. It can contain anything from run-time commands (like StrCpy) to compile-time commands (like !define) When you insert a macro using !insertmacro, it simply creates a copy of the code in your macro and places it where you have inserted the macro. This allows us to insert multiple copies of complicated code with a few lines of !insermacro.<br />
<br />
E.g.<br />
!macro StrCpy Var<br />
 StrCpy ${Var} &quot;blah&quot;<br />
!macroend<br />
Function UseBlah<br />
!insermacro StrCpy $R0<br />
!insermacro StrCpy $R1<br />
FunctionEnd<br />
<br />
Would be the same as:<br />
Function UseBlah<br />
 StrCpy $R0 &quot;blah&quot;<br />
 StrCpy $R1 &quot;blah&quot;<br />
FunctionEnd<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>