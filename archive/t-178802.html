<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Get IP address for IIS Service, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Get IP address for IIS Service NSIS Discussion" />
	
	<title> Get IP address for IIS Service [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Get IP address for IIS Service</div>
<hr />
<div class="pda"><a href="t-178802.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=178802">Get IP address for IIS Service</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">rwap</div><div class="date">3rd May 2004, 13:43</div></div><div class="posttext">I am using NSIS to install a perl program on an IIS server.<br />
<br />
However, although on my machine, I use the standard http://127.0.0.1/ to access the website on my IIS server, a friend who wants to use the program has a different setting as he is running a separate server on his intranet.<br />
<br />
I cannot find a means of finding this IP address in the registry which is a pain.<br />
<br />
So, I guess I need to prompt the user to enter the IP address on installing the program (unless anyone has a better idea).<br />
<br />
Does anyone know of a reliable code to enter an IP address?  I have searched the archive, but to no avail.<br />
<br />
Also, I have created a simple .ini file to display the prompt, but cannot get it to display:<br />
<br />
<br />
( in main section I have included)<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_LICENSE &quot;E:\license.txt&quot;<br />
<br />
; Need to read IP address <br />
Page custom SetIP &quot;ValidateIP&quot; &quot;Set your IP Address&quot;<br />
<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
(and then later on included)<br />
<br />
.<br />
.<br />
.<br />
.<br />
.<br />
Function SetIP<br />
<br />
  ;Display the InstallOptions dialog<br />
  InstallOptions::dialog &quot;$PLUGINSDIR\IP.ini&quot;<br />
<br />
  !insertmacro MUI_HEADER_TEXT &quot;Select IP Address&quot; &quot;Enter the IP Address of your server\n(Default 127.0.0.1)&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;$PLUGINSDIR\IP.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $varCustomerIP &quot;$PLUGINSDIR\IP.ini&quot; &quot;Field 1&quot; &quot;State&quot;<br />
  ; Temporary fix<br />
	StrCpy $varCustomerIP &quot;127.0.0.1&quot;		<br />
	<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evilO</div><div class="date">3rd May 2004, 14:51</div></div><div class="posttext">Hi rwap :)<br />
<br />
To check your IP adress you could use this code written by 'Smile2Me': <br />
<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=60<br />
<br />
<br />
<br />
About the dialog that does not display:<br />
<br />
Have you extracted your INI file into the plugins directory ? Otherwise add this bit of code in the '.onInit' function, after the instruction 'InitPluginsdir'.<br />
<br />
<br />
!insertmacro MUI_INSTALLOPTIONS_EXTRACT_AS &quot;$YOU_PATH\\IP.ini&quot;      &quot;IP.ini&quot;<br />
<br />
<br />
<br />
evilO/Olive<br />
<br />
PS: welcome to the forums !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rwap</div><div class="date">3rd May 2004, 23:42</div></div><div class="posttext">Thanks for the pointers.<br />
<br />
Alas, I had already tried the script by Smile2Me which you suggested, and once I converted it to run properly (ie. did not use test data), it does not return anything on my machine !!<br />
<br />
I have however now got my page displaying asking the user to enter the IP address of their server.  I just now need to come up with some code to validate the string returned !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">4th May 2004, 10:44</div></div><div class="posttext">Use the NSIS string functions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evilO</div><div class="date">4th May 2004, 13:22</div></div><div class="posttext">once I converted it to run properly (ie. did not use test data) <br />
<br />
Of course in your case you'll have to slightly modify the code, and you won't need the function 'GetNextIP'.<br />
<br />
it does not return anything on my machine !! <br />
<br />
Err, how come? :confused: Which function did you try to use? I do use a modified version of this code, it's working fine!<br />
<br />
evilO/Olive</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>