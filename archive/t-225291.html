<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS CreateShortCut DESKTOP, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS CreateShortCut DESKTOP NSIS Discussion" />
	
	<title> NSIS CreateShortCut DESKTOP [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS CreateShortCut DESKTOP</div>
<hr />
<div class="pda"><a href="t-225291.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=225291">NSIS CreateShortCut DESKTOP</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">lonnie</div><div class="date">5th September 2005, 22:05</div></div><div class="posttext">Hello All,<br />
<br />
I am trying to set up a NSIS script for an application and have 2 problems that I hope you will help me with.<br />
<br />
1. I want to create a desktop shortcut to an application, but also I need to be able to change the working directory to the directory that the application is currently located in from the shortcut.<br />
<br />
   I am currently using a batch file but think that I sould be able to somehow specify the working directory from the NSIS shortcut command, right?<br />
<br />
   Also, my desktop and quick launch shortcuts are not being created for some reason as well.<br />
<br />
2. This is a similar problem as above but from the start menu items.<br />
<br />
Thanks,<br />
Lonnie</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">5th September 2005, 23:04</div></div><div class="posttext">It would be helpful to post the script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lonnie</div><div class="date">5th September 2005, 23:20</div></div><div class="posttext">Thanks for replying, but in re-reading the docs I was able to solve the problem....<br />
<br />
Thanks again,<br />
lonnie</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bigbooty</div><div class="date">12th September 2005, 23:46</div></div><div class="posttext">Thanks for sharing!<br />
<br />
:- bb</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ChrisNewland</div><div class="date">6th January 2008, 09:15</div></div><div class="posttext">Hi Lonnie,<br />
<br />
I had the same problem and it would have been nice if you'd told us where you found the answer so that others can benefit from it.<br />
<br />
I found a solution too which is detailed at http://www.seas.gwu.edu/~simhaweb/java/lectures/appendix/installer/install.html<br />
<br />
The relevant part is:<br />
<br />
How does a java application find all the classes that it uses? (Setting the working directory)<br />
<br />
In almost all operating systems, a call can be made to an executable file from anywhere. Suppose you have MyApplication.exe placed in C:\TestExe\. To run MyApplication.exe, you typically would go to the TestExe directory and then call:<br />
<br />
C:\TextExe\&gt; MyApplication<br />
<br />
However, we could be in a folder like C:\Another_Folder\Inside_yet_another_folder\ and still be able to execute MyApplication.exe. How? Like this:<br />
<br />
C:\Another_Folder\Inside_yet_another_folder\&gt; C:\TestExe\MyApplication<br />
<br />
This kind of example works in Unix as well (of course, the directories wouldn't be starting with &quot;C:&quot;. What is different about these two program calls. The working directory of each application is different. In the first example, the working directory is C:\TestExe because that is where we launched the application from. In the second example the working directory is C:\Another_Folder\Inside_yet_another_folder . The working directory is the directory from which the application is launched. As you have seen, it doesn't necessarily have to be the directory where the program is installed.<br />
<br />
Go to your start menu, and under programs, find a shortcut. Right-click on this shortcut and now in the new window, look at the text box labelled &quot;Start In:&quot;. That is the working directory of that application.<br />
<br />
How do we make sure that the working directory in our shortcuts are where we want them to be? There is no parameter to set for that in the CreateShortcut function in NSIS. Look back to the first example where we created start menu shortcuts. Notice that we have set an Outpath for copying files. This Outpath is ALSO set as the working directory for every shortcut that is created after that SetOutPath command. If you would like to change the working directory of a shortcut, then simply change the OutPath to what you would like, create the shortcut, and then, if you want, change the OutPath back.<br />
<br />
Hope that helps.<br />
<br />
-Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wahooney</div><div class="date">13th March 2008, 23:56</div></div><div class="posttext">I just bumped into this problem myself, but lo I have a solution, here is an example:<br />
CreateDirectory &quot;$SMPROGRAMS\$StartMenuGroup&quot;<br />
SetOutPath $INSTDIR<br />
CreateShortcut &quot;$SMPROGRAMS\$StartMenuGroup\$(^Name).lnk&quot; $INSTDIR\App.exe<br />
SetOutPath $SMPROGRAMS\$StartMenuGroup<br />
CreateShortcut &quot;$SMPROGRAMS\$StartMenuGroup\Uninstall $(^Name).lnk&quot; $INSTDIR\uninst.exe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th March 2008, 11:41</div></div><div class="posttext">It says under CreateShortCut (http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.3.4):<br />
<br />
$OUTDIR is used for the working directory. You can change it by using SetOutPath before creating the Shortcut.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>