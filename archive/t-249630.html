<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Invalid filehandle 123, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Invalid filehandle 123 NSIS Discussion" />
	
	<title> Invalid filehandle 123 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Invalid filehandle 123</div>
<hr />
<div class="pda"><a href="t-249630.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=249630">Invalid filehandle 123</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">25th June 2006, 19:14</div></div><div class="posttext">whenever i'm running my script, i'm getting the error-message  &quot;Invalid file handle 123&quot;.<br />
<br />
i've modified the line 65 of FontReg.nsh (http://nsis.sourceforge.net/Register_Fonts)  to<br />
<br />
CopyFiles '${FontFile}' '$FONT_DIR\${FontFileName}'.<br />
<br />
i checked the input-file for the macro and don't see why this shall not work. any clues?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">26th June 2006, 04:34</div></div><div class="posttext">Is ${FontFileName} an actual file name?  <br />
<br />
The reason I ask is that I thought CopyFiles needed a file name and a folder name as parameters.  The way I'm reading your example, it looks as if you supplied 2 file names.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th June 2006, 09:57</div></div><div class="posttext">The destination parameter for CopyFiles requires the full path to the file name to be copied as.<br />
Having a folder name works, but if that folder doesn't exist it will create the file of that folder name instead.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">27th June 2006, 18:31</div></div><div class="posttext">thanks for the response, seems like it was a tiny &quot; that caused the mistake :rolleyes:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">28th June 2006, 19:30</div></div><div class="posttext">unfortunately, the errors still occurs. the reason why i replaced that line from FontReg.nsh is, that the font i want to install is stored in a variable.<br />
<br />
in order to find the mistake, i replaced the variable with &quot;path/to/font.ttf&quot; and the error-message changes to &quot;MappedFile error: 1006&quot;.<br />
<br />
i've added a messagebox displaying..<br />
<br />
${FontFile}: &quot;C:\MyDir\myfont.ttf&quot;<br />
$FONT_DIR: C:\MyDir\myfont.ttf<br />
${FontFileName}: myfont.ttf&quot;<br />
<br />
..please mind the quotes!<br />
<br />
i don't understand why they get messed up like this and why i still get this error replacing the variable with a path to my font. any clues?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">29th June 2006, 17:27</div></div><div class="posttext">it's all working now, problem was in the a later fontname macro</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">29th July 2006, 23:47</div></div><div class="posttext">once again i'm getting MappedFile error: 1006 when using the following script<br />
  GetTempFileName $TempFile<br />
  ReadEnvStr $R1 COMSPEC<br />
  nsExec::Exec '&quot;$R1&quot; /C dir &quot;$Input\*.ttf&quot; /a-d /b /s /on&gt;$TempFile&quot;'<br />
  <br />
  StrCpy $FONT_DIR $FONTS<br />
  StrCpy &quot;$Counter&quot; &quot;1&quot;<br />
<br />
 Loop:<br />
  ${LineRead} &quot;$TempFile&quot; &quot;$Counter&quot; &quot;$Line&quot; ;${LineRead} &quot;[File]&quot; &quot;[LineNumber]&quot; $var<br />
  IfErrors PostEnd<br />
<br />
  Push $Line<br />
  Call TrimNewlines<br />
  Pop $Line<br />
<br />
  Push $Line<br />
  Call GetName<br />
  Pop $File<br />
  <br />
  IfFileExists &quot;$Line&quot; 0 +3<br />
  MessageBox MB_OK &quot;Yay!&quot;<br />
  Goto +3<br />
  MessageBox MB_OK &quot;Nay!&quot;<br />
  Quit<br />
<br />
  !insertmacro InstallTTF &quot;$Line&quot;<br />
  SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0 /TIMEOUT=5000<br />
  <br />
  IntOp $Counter $Counter + 1<br />
  Goto Loop<br />
<br />
what i don't understand about it, IfFileExists is always reporting &quot;Yay!&quot;, but only one font from the $TempFile is being installed. once it's reading line 2 i get that error. what am i doing wrong?!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th July 2006, 00:24</div></div><div class="posttext">Why are you using the dir command to list the font files? Why not use FindFirst, FindNext etc. It would be much easier.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">30th July 2006, 00:28</div></div><div class="posttext">good point. i actually used this from another script of mine where i needed a sorted list (a-z) :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th July 2006, 00:39</div></div><div class="posttext">It may be safer to use an array (NSISArray) to sort it, but dir exists on all systems to my knowledge. It's still a bit unprofessional though I'd say, as you're relying on another executable for the installer to function correctly.<br />
<br />
Here's another thing:<br />
You're using GetName and Popping $File from it, yet you're using $Line afterwards. Surely you should be using $File?<br />
<br />
Congrats if this is fixed. I'm drunk :p<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">30th July 2006, 01:58</div></div><div class="posttext">it's working, had to change the FontName function</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>