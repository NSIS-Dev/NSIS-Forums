<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Startmenu Items creation, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Startmenu Items creation NSIS Discussion" />
	
	<title> Startmenu Items creation [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Startmenu Items creation</div>
<hr />
<div class="pda"><a href="t-327471.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=327471">Startmenu Items creation</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">sunilkumar.bm</div><div class="date">17th February 2011, 11:32</div></div><div class="posttext">Dear All<br />
I'm new to NSIS and has been using it from the past one week.<br />
I encountered a problem while installing the software created using NSIS.<br />
As you know $SMPROGRAMS is the variable containing path to StartMenu\All Programs folder.<br />
My code is somewhat like this<br />
<br />
CreateDirectory &quot;$SMPROGRAMS\TestProject&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\TestProject\Uninstall.lnk&quot; &quot;$INSTDIR\Uninstall.exe&quot; &quot;&quot; &quot;$INSTDIR\Uninstall.exe&quot; 0<br />
  CreateShortCut &quot;$SMPROGRAMS\TestProject\TestProject.lnk&quot; &quot;$INSTDIR\TestProject.exe&quot; &quot;&quot; &quot;$INSTDIR\TestProject.exe&quot; 0<br />
 <br />
<br />
While installing the application, if the user selects the default directory which is StartMenu\All Programs, there isn't any problem. But when he/she selects some other directory like StartMenu\All Programs\Accessories, the script is unable to get the complete path, it still remains StartMenu\All Programs. Is there any way to get the select path<br />
<br />
For example $INSTDIR, by default contains C:\program files, but when the user selects a different path, $INSTDIR will be changed to the selected path.<br />
<br />
<br />
Regards<br />
Sunil Kumar B M</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">17th February 2011, 13:24</div></div><div class="posttext">Are you using the start menu page? If so then obviously you don't use the $SMPROGRAMS constant (it's called a constant for a reason). The examples show you how to use your own variable.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>