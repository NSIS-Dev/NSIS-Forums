<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Defining order of Shortcut menu item appearence, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Defining order of Shortcut menu item appearence NSIS Discussion" />
	
	<title> Defining order of Shortcut menu item appearence [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Defining order of Shortcut menu item appearence</div>
<hr />
<div class="pda"><a href="t-114720.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=114720">Defining order of Shortcut menu item appearence</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kishore</div><div class="date">18th November 2002, 22:18</div></div><div class="posttext">Hi,<br />
<br />
I'm using NSIS version 1.98 on Windows 2000 to create installation program for my application. While creating shortcuts using CreateShortCut' directive in the script, I'm not able to define the order in which they appear on the Windows start menu. These short cuts appear in random order on different machine. In otherwords, following directive in .nsi file:<br />
<br />
CreateShortCut &quot;$SMPROGRAMS\Test\S1.lnk&quot; &quot;notepad s1.txt&quot; <br />
CreateShortCut &quot;$SMPROGRAMS\Test\S2.lnk&quot; &quot;notepad s2.txt&quot; CreateShortCut &quot;$SMPROGRAMS\Test\S3.lnk&quot; &quot;notepad s3.txt&quot;<br />
CreateShortCut &quot;$SMPROGRAMS\Test\S4.lnk&quot; &quot;notepad s4.txt&quot;<br />
<br />
The above directives cause the short cut menus to appear in random order as shown below. Also, this order is different on different machines.<br />
<br />
Start -&gt; Test -&gt; S3<br />
              -&gt; S1<br />
              -&gt; S4<br />
              -&gt; S4<br />
<br />
Can anyone please let me know how I could define the order in which they appear on the Windows start menu.<br />
<br />
Thanks,<br />
<br />
Kishore.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">19th November 2002, 02:45</div></div><div class="posttext">In Win98SE there's a registry branch (HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder\Start Menu) where windows stores items' positions. You can define as you like, export the branch you want, and then import that  branch during installation with thi line: ExecWait &quot;REGEDIT.EXE /S 1.REG&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kishore</div><div class="date">19th November 2002, 14:53</div></div><div class="posttext">Originally posted by n0On3 <br />
In Win98SE there's a registry branch (HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder\Start Menu) where windows stores items' positions. You can define as you like, export the branch you want, and then import that  branch during installation with thi line: ExecWait &quot;REGEDIT.EXE /S 1.REG&quot; <br />
<br />
Thanks a lot for the reply. Since, I'm new to both windows and NSIS, It will be very helpful if you can give me the detailed steps for the example I had initially posted with the question.<br />
<br />
Thanks,<br />
<br />
Kishore.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kishore</div><div class="date">19th November 2002, 15:54</div></div><div class="posttext">Originally posted by n0On3 <br />
In Win98SE there's a registry branch (HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder\Start Menu) where windows stores items' positions. You can define as you like, export the branch you want, and then import that  branch during installation with thi line: ExecWait &quot;REGEDIT.EXE /S 1.REG&quot; <br />
<br />
Hello n0On3,<br />
<br />
Following is the snippet of the nsi script used in my installation.<br />
<br />
;Script Begin <br />
<br />
CreateShortCut &quot;$SMPROGRAMS\Test\S1.lnk&quot; &quot;notepad s1.txt&quot; <br />
CreateShortCut &quot;$SMPROGRAMS\Test\S2.lnk&quot; &quot;notepad s2.txt&quot; CreateShortCut &quot;$SMPROGRAMS\Test\S3.lnk&quot; &quot;notepad s3.txt&quot; <br />
CreateShortCut &quot;$SMPROGRAMS\Test\S4.lnk&quot; &quot;notepad s4.txt&quot; <br />
  ExecWait 'RegEdit /s /e &quot;$INSTDIR\1.reg&quot; &quot;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder\Start Menu&quot;'<br />
<br />
ExecWait 'RegEdit /s &quot;$INSTDIR\1.reg&quot;'<br />
<br />
;Script End<br />
<br />
But, the order still seems to be random. Is this what I'm supposed to do ? Please let me know.<br />
<br />
Thanks,<br />
<br />
Kishore.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">virtlink</div><div class="date">19th November 2002, 18:13</div></div><div class="posttext">You can't set the order of the items in the Start-Menu. However, if you have Windows ME or higher, you can, as a user, sort the items by name.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">19th November 2002, 19:32</div></div><div class="posttext">virtlink, well you can't set the order, but you can import the branch where windows saves the order, methinks.<br />
<br />
<br />
I don't know why you use the &quot;/e&quot; switch.<br />
<br />
before using this: ExecWait 'RegEdit /s &quot;$INSTDIR\1.reg&quot;' <br />
<br />
you have to create '1.reg' with the information you want. To do it, create the start menu group the way you want it to be installed, and launch regedit go to that branch I gave you look for your start groug and export the branch of that group to that 1.reg file.<br />
<br />
If you have any trouble you can post your working script to check it with my computer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dëëjayz</div><div class="date">11th September 2003, 22:08</div></div><div class="posttext">This solution is working on windows 2000, but doesn't seem to work on XP... Any clue to do the same on XP? haven't test on Win Nt4, but will do the test soon.<br />
<br />
Thank you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">12th September 2003, 10:45</div></div><div class="posttext">You can use Registry Shot to find what really changes in the registry when changing the order of items.<br />
<br />
You'll have to do it by yourself, because I don't have a wxp around. <br />
<br />
good luck :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dëëjayz</div><div class="date">12th September 2003, 16:05</div></div><div class="posttext">Thanks!<br />
<br />
BTW&lt; the file you sent was not working.. old version I guess!<br />
<br />
Here a more recent file of regshot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">virtlink</div><div class="date">12th September 2003, 16:09</div></div><div class="posttext">Yeah, the n0On's version didn't accept Windows XP as a valid OS, since it doesn't support NT systems, and recognizes XP as one.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dëëjayz</div><div class="date">12th September 2003, 20:52</div></div><div class="posttext">Okay, I've done a switch between XP, 2000 and NT 4.0 for the ordering items... Something like this:<br />
<br />
  Call GetWindowsVersion<br />
  Pop $R0<br />
  StrCmp $R0 &quot;2000&quot; 0 +2<br />
  ExecWait 'RegEdit /s &quot;$PLUGINSDIR\2000 Client.reg&quot;'<br />
  StrCmp $R0 &quot;XP&quot; 0 +2<br />
  ExecWait 'RegEdit /s &quot;$PLUGINSDIR\XP Client.reg&quot;'<br />
  StrCmp $R0 &quot;NT 4.0&quot; 0 +2<br />
  ExecWait 'RegEdit /s &quot;$PLUGINSDIR\NT 4.0 Client.reg&quot;'<br />
<br />
Does work fine, but for the current user... If I logoff and logon another user, doesn't get the menu items ordered correctly... I've tried to edit the reg file by changing the HKCU for HKLM, but none of these windows version will work... Only work in current user who've done the installation.<br />
<br />
Is there any way to make it applied to another user?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">12th September 2003, 23:51</div></div><div class="posttext">hehe, it seems I have to update my computer, the OS, and regshot too. :rolleyes:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dëëjayz</div><div class="date">15th September 2003, 14:36</div></div><div class="posttext">Isn't a good opportunity? ;) eheheh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Andrikos</div><div class="date">18th June 2004, 13:11</div></div><div class="posttext">This is my solution for right sort order:<br />
<br />
CreateShortCut &quot;$SMPROGRAMS\...<br />
Sleep 10<br />
CreateShortCut &quot;$SMPROGRAMS\...<br />
Sleep 10<br />
CreateShortCut &quot;$SMPROGRAMS\...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">18th June 2004, 13:25</div></div><div class="posttext">Try:<br />
<br />
4.9.7.3 SetShellVarContext current|all<br />
<br />
before your createshortcut calls for setting the appropriate location.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>