<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Exec executes in one PC and not in another, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Exec executes in one PC and not in another NSIS Discussion" />
	
	<title> Exec executes in one PC and not in another [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Exec executes in one PC and not in another</div>
<hr />
<div class="pda"><a href="t-177472.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=177472">Exec executes in one PC and not in another</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">21st April 2004, 08:34</div></div><div class="posttext">Hi,<br />
<br />
I am using the Exec command to run a .cmd file. If I run the script in a winXP client it runs, but if I try to execute it on a win2k server it doesn't work. But it doesn't give any error, that is, for the details of the installation it appears as executed. However I know the script doesn't even start because it generates a log file which is not generated. Any ideas? Thanxs!<br />
<br />
cheers,<br />
alej</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">21st April 2004, 09:50</div></div><div class="posttext">Try using ExecShell with the open command.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">21st April 2004, 10:38</div></div><div class="posttext">Thanxs, but it also doesn't work :cry: any ideas other ideas???<br />
<br />
cheers,<br />
alej</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">21st April 2004, 12:30</div></div><div class="posttext">If it helps, this is my command:<br />
<br />
ExecShell open &quot;$PROGRAMFILES\MyFolder\temp\myProgram.cmd&quot; SW_SHOWNORMAL</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">21st April 2004, 12:38</div></div><div class="posttext">If &quot;.cmd&quot; (?) file requires console, try to use AllocConsole() API call in your NSIS script. Correct input/output redirection may be found in MSDN articles (CreatePipe(), DuplicateHandle(), CreateProcess()), but this is not easy way for script. And if this is what you need - &quot;.cmd&quot; text may help to understand problem :))</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">21st April 2004, 12:43</div></div><div class="posttext">So complicated??? I just want to run a batch file, there's no way to use 'Exec'? But it works in my lap-top.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">21st April 2004, 12:49</div></div><div class="posttext">Try <br />
<br />
System::Call &quot;kernel32.lib::AllocConsole()&quot;<br />
<br />
first :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">21st April 2004, 12:52</div></div><div class="posttext">sorry, kernel32.dll</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">21st April 2004, 12:55</div></div><div class="posttext">I am a bit lost with that expression, I am new to NSIS :-[<br />
could you please tell me what it does? Thnaxs!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">21st April 2004, 13:06</div></div><div class="posttext">This allocates console for parent application, and child application gets correct i/o handles. But My explanation is not based on any facts - give me your script and I'll run it on my W2K Server.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">21st April 2004, 13:12</div></div><div class="posttext">But how should I use the expression, I mean how do I indicate my batch file? My batch file gives some SQL commands, so you can't really execute it, but you can just do any batch file with an 'echo' to try.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">21st April 2004, 13:19</div></div><div class="posttext">System::Call &quot;kernel32.lib::AllocConsole()&quot;<br />
ExecShell open &quot;$PROGRAMFILES\MyFolder\temp\myProgram.cmd&quot; SW_SHOWNORMAL<br />
<br />
First call just creates conditions for next console app. execution. But (again) - there may absolutely another reasons of you batch crash, for example shell script specifics on various platforms.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">21st April 2004, 13:33</div></div><div class="posttext">no improvement! :-[</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">21st April 2004, 13:46</div></div><div class="posttext">It could be a permissions issue. Windows Server is very strict on who can install or execute scripting files. This batch file, you say it contains SQL which you are executing, do you have the correct permissions to access the SQL Server/Oracle Server etc?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">21st April 2004, 13:50</div></div><div class="posttext">It runs as Administrator!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">21st April 2004, 13:50</div></div><div class="posttext">It is probably a system related problem not related to this command.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">21st April 2004, 13:53</div></div><div class="posttext">ufff, then its not possible to run this batch file any other way?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">21st April 2004, 13:55</div></div><div class="posttext">Does the batch file work when you start it manually?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">21st April 2004, 13:56</div></div><div class="posttext">yes, in both machines.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">21st April 2004, 14:03</div></div><div class="posttext">Try to put quotes around the path:<br />
<br />
'&quot;file&quot;'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">21st April 2004, 14:04</div></div><div class="posttext">I got it....the script in the batch is failing (I entered a pause), but I dont know why because manually it runs. But its not NSIS problem anymore. So it looks like Exec runs on this system ;-) Thanxs for all.<br />
<br />
cheers,<br />
alej</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">21st April 2004, 14:13</div></div><div class="posttext">You could try the following.<br />
<br />
Admin Tools<br />
Local Secuity Policies<br />
User Rights Assignment<br />
and add the admin to either of the following:<br />
log on as batch job, or Act as part of the OS.<br />
<br />
I'd only try this, it would at least let you know if it's a permissions thing. I found odd behaviour like this since I found the shell I was opening was just a shell with no privileges.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">21st April 2004, 14:36</div></div><div class="posttext">nothing! doesn't work....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">21st April 2004, 15:41</div></div><div class="posttext">I know whats going on, but still need some help. The ShellExec is not getting the proper path. If I do<br />
<br />
SetOutPath $PROGRAMFILES\MyFolder\temp<br />
<br />
on a XP client and a win2k client the path remains, but in the server it points to c:!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">21st April 2004, 16:31</div></div><div class="posttext">Does that folder exist?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">almoes</div><div class="date">21st April 2004, 16:34</div></div><div class="posttext">Yes it exists and I checked tones of times the spelling of it. Anyway I tested in another win2k server and works fine. I really wonder what environment thing is different. Anyway, programming a 'cd path' in the batch file it works. Just to let say that there's something that doesn't always behave the same for 'SetOutPath'.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>