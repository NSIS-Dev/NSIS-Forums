<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Show register screen at the end of installation, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Show register screen at the end of installation NSIS Discussion" />
	
	<title> Show register screen at the end of installation [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Show register screen at the end of installation</div>
<hr />
<div class="pda"><a href="t-319509.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=319509">Show register screen at the end of installation</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">adum</div><div class="date">28th May 2010, 16:13</div></div><div class="posttext">Hello folks,<br />
<br />
What I need is show a screen (something like a big MessageBox) to user when he finish the installation.<br />
<br />
This screen will contain an image (banner) on the top, a text asking for register on website, and a button &quot;register now&quot; on the bottom.<br />
<br />
I'm thinking to call a MessageBox on &quot;.onGUIEnd&quot;, but i'm not sure if is possible add an image and resize to make it bigger, maybe the same size of an insall screens.<br />
<br />
Someone can help me on this one? ;)<br />
<br />
Thanks in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th May 2010, 16:14</div></div><div class="posttext">nsDialogs<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">28th May 2010, 16:44</div></div><div class="posttext">Why not send the user directly on a web page ? (use ExecShell)<br />
If that's too intrusive, you can have a checkbox on the last page &quot;Register online&quot; which sends the user to the web page</div></div><hr />


<div class="post"><div class="posttop"><div class="username">adum</div><div class="date">28th May 2010, 17:03</div></div><div class="posttext">Thanks for quick replys guys!<br />
<br />
nsDialogs<br />
<br />
Stu<br />
Got it. <br />
But one question: Using nsDialogs, is it possible remove the &quot;footer&quot; that contain &quot;Next&quot;, &quot;Finish&quot;, and other buttons? I really need a clean page.<br />
<br />
<br />
Why not send the user directly on a web page ? (use ExecShell)<br />
If that's too intrusive, you can have a checkbox on the last page &quot;Register online&quot; which sends the user to the web page<br />
<br />
I'm already thought on it, but my client prefer this way =/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th May 2010, 17:18</div></div><div class="posttext">You can hide the buttons, the branding text and the horizontal ruler (static) controls using ShowWindow &amp; ${SW_HIDE} (the control id's are in modern.exe; use Resource Hacker). If you want to then make the custom page fill the entire window you will have to resize the custom page rect (which is also in modern.exe) using SetWindowPos. All the controls are in modern.exe dialog 105.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">adum</div><div class="date">31st May 2010, 14:46</div></div><div class="posttext">You can hide the buttons, the branding text and the horizontal ruler (static) controls using ShowWindow &amp; ${SW_HIDE} (the control id's are in modern.exe; use Resource Hacker). If you want to then make the custom page fill the entire window you will have to resize the custom page rect (which is also in modern.exe) using SetWindowPos. All the controls are in modern.exe dialog 105.<br />
<br />
Stu<br />
<br />
Thanks for your help Stu, but I'm still having some issues to hide the controls.<br />
I found the buttons id's, but i'm not sure how to use ShowWindow command.<br />
For example, the id of Cancel button is 2. I will call ShowWindow on pre function, corrent?<br />
I need to execute any other command before it? <br />
And what is the correct syntax of ShowWindow? ShowWindow &quot;2&quot; ${SW_HIDE}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">31st May 2010, 15:14</div></div><div class="posttext">Thanks for your help Stu, but I'm still having some issues to hide the controls.<br />
I found the buttons id's, but i'm not sure how to use ShowWindow command.<br />
For example, the id of Cancel button is 2. I will call ShowWindow on pre function, corrent?<br />
I need to execute any other command before it? <br />
And what is the correct syntax of ShowWindow? ShowWindow &quot;2&quot; ${SW_HIDE}<br />
<br />
As you can read in the ShowWindow manual entry:<br />
http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.14.17<br />
...ShowWindow requires the control's HWND, not a control id, as a parameter.<br />
<br />
<br />
You can use the GetDlgItem command to get a HWND from an ID: http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.14.6</div></div><hr />


<div class="post"><div class="posttop"><div class="username">adum</div><div class="date">9th June 2010, 18:59</div></div><div class="posttext">Thanks a lot guys, this works.. But unfortunately it will be useless, because the customer ask to add a checkbox on the last screen... oO<br />
<br />
This is a bit easier, if don't has a detail:<br />
Some steps before, the user selects the store where he bought the disk, and depending the store, the checkbox will be showed or not.<br />
<br />
Is it possible control the !define's on runtime? Depending the store selected (using something like StrCmp), checkbox will be showed or not?<br />
<br />
If not, what I think to do now is hide this checkbox using ShowWindow &amp; ${SW_HIDE}, but I can't find the finish screen to get checkbox ID. Where the finish screen is located?<br />
<br />
Thanks one more time =]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th June 2010, 21:14</div></div><div class="posttext">Look in Contrib\Modern UI 2\Pages\Finish.nsh. The finish page is made with nsDialogs and there will be a dedicated variable containing its handle.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">adum</div><div class="date">10th June 2010, 15:26</div></div><div class="posttext">Nice, I find it. But how can I recover the variable to manipulate on my script?<br />
<br />
I'm trying to do something like this:<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE PreFinishFunction<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
Function PreFinishFunction<br />
    StrCmp $STORE &quot;StoreName&quot; hide show ;check if checkbox will show or not<br />
    hide:<br />
    ShowWindow $mui.Finishpage.Run ${SW_HIDE}<br />
    show:<br />
FunctionEnd<br />
<br />
<br />
But mui.Finishpage.Run was unknown. Any idea?<br />
<br />
Aditionally, when the checkbox is hided, i need to uncheck it or hide is enough? Case I need to uncheck, how can I do this? Using SendMessage?<br />
<br />
Thanks one more time =]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th June 2010, 17:10</div></div><div class="posttext">Use a SHOW function not a PRE.<br />
<br />
Edit: nsDialogs has a macro to check/uncheck. You need to do it yes.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">adum</div><div class="date">10th June 2010, 18:37</div></div><div class="posttext">ok, i have changed to SHOW function.<br />
I have one more issue. Problably the last one.. ^^<br />
<br />
How can I &quot;get&quot; the checkbox ? <br />
To use NSD_Uncheck and ShowWindow I need the HWND. I know how to get it when I have the control ID, but in this case I haven't the id =/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th June 2010, 19:28</div></div><div class="posttext">You seem to have ignored or misunderstood what I said. $mui.FinishPage.Run DOES contain the handle to the check box. Also you can't expect it to work in a pre function (MUI_PAGE_CUSTOMFUNCTION_PRE) because that is before the page is created. You want MUI_PAGE_CUSTOMFUNCTION_SHOW.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">adum</div><div class="date">10th June 2010, 20:12</div></div><div class="posttext">Now i'm feeling a noob.. lol<br />
Maybe I'm not so specific in my question. I have understood why use SHOW function, not PRE. <br />
My issue is the follow: when I call ShowWindow to hide checkbox, the parameter I need to pass is mui.FinishPage.Run, correct? THis way: ShowWindow $mui.Finishpage.Run ${SW_HIDE}<br />
<br />
But when I compile the script, it show me a warning, probably because this var is for finish.nsh, not mine: <br />
Unknow variable/constant mui.FinishPage.Run<br />
<br />
I need to do anything before use it? Need to retrieve it? <br />
<br />
Sorry to annoy you so much, but i'm very confused at this point..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th June 2010, 22:50</div></div><div class="posttext">Variables in NSIS are global. Perhaps you are using MUI not MUI2?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">adum</div><div class="date">11th June 2010, 15:47</div></div><div class="posttext">Oh crap... In fact I'm using MUI (not MUI2)...<br />
<br />
Is it possible do this on MUI? I'm using some ini files, and will be a pain change all my scripts(it's more than one I need to do this change)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th June 2010, 16:00</div></div><div class="posttext">Read the section &quot;To upgrade a Modern UI 1.8 script, you should&quot; in the MUI2 readme.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">adum</div><div class="date">14th June 2010, 14:38</div></div><div class="posttext">Finally it works<br />
<br />
Thanks a lot for your help guys, specially you Stu =]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th June 2010, 15:47</div></div><div class="posttext">No problem :)<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>