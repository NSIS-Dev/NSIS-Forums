<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Compiling NSIS 2.01 on Solaris, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Compiling NSIS 2.01 on Solaris NSIS Discussion" />
	
	<title> Compiling NSIS 2.01 on Solaris [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Compiling NSIS 2.01 on Solaris</div>
<hr />
<div class="pda"><a href="t-195250.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=195250">Compiling NSIS 2.01 on Solaris</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">NichDieMama</div><div class="date">1st October 2004, 09:18</div></div><div class="posttext">Hi!<br />
<br />
Has anyone successfully compiled NSIS 2.01 on Solaris? I did compile it on Linux, but on Solaris I got lots of errors:<br />
<br />
ld: Software Generation Utilities - Solaris Link Editors: 5.9-1.375<br />
gmake -C exehead<br />
ld: Software Generation Utilities - Solaris Link Editors: 5.9-1.375<br />
gmake[1]: Entering directory `/hox/user/dspilker/src/NSIS/NSIS/Source/exehead'<br />
gmake[1]: Nothing to be done for `all'.<br />
gmake[1]: Leaving directory `/hox/user/dspilker/src/NSIS/NSIS/Source/exehead'<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o 7zGuids.o 7zip/7zGuids.cpp<br />
gcc -Wall -O3 -DCOMPRESS_MF_BT  -c -o bzlib.o bzip2/bzlib.c<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o CRC.o 7zip/Common/CRC.cpp<br />
gcc -Wall -O3 -DCOMPRESS_MF_BT  -c -o crc32.o crc32.c<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o DialogTemplate.o DialogTemplate.cpp<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o Alloc.o 7zip/Common/Alloc.cpp<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o makenssi.o makenssi.cpp<br />
In file included from build.h:8,<br />
                 from makenssi.cpp:43:<br />
strlist.h: In method `void MMapFile::release()':<br />
strlist.h:767: ANSI C++ forbids implicit conversion from `void *' in argument passing<br />
strlist.h: In method `void MMapFile::release(void *, int)':<br />
strlist.h:780: ANSI C++ forbids implicit conversion from `void *' in argument passing<br />
strlist.h: In method `void MMapFile::flush(int)':<br />
strlist.h:790: ANSI C++ forbids implicit conversion from `void *' in argument passing<br />
In file included from build.h:30,<br />
                 from makenssi.cpp:43:<br />
clzma.h: In method `HANDLE CLZMA::CreateEvent(void *, int, int, char *)':<br />
clzma.h:64: implicit declaration of function `int pthread_cond_init(...)'<br />
clzma.h:69: implicit declaration of function `int pthread_mutex_init(...)'<br />
clzma.h: In method `BOOL CLZMA::SetEvent(long unsigned int)':<br />
clzma.h:81: implicit declaration of function `int pthread_mutex_lock(...)'<br />
clzma.h:84: implicit declaration of function `int pthread_cond_signal(...)'<br />
clzma.h:85: implicit declaration of function `int pthread_mutex_unlock(...)'<br />
clzma.h: In method `BOOL CLZMA::CloseHandle(long unsigned int)':<br />
clzma.h:103: implicit declaration of function `int pthread_cond_destroy(...)'<br />
clzma.h:105: implicit declaration of function `int pthread_mutex_destroy(...)'<br />
clzma.h: In method `DWORD CLZMA::WaitForSingleObject(long unsigned int, long unsigned int)':<br />
clzma.h:118: `PTHREAD_MUTEX_INITIALIZER' undeclared (first use this function)<br />
clzma.h:118: (Each undeclared identifier is reported only once<br />
clzma.h:118: for each function it appears in.)<br />
clzma.h:119: implicit declaration of function `int pthread_cond_wait(...)'<br />
clzma.h: In method `int CLZMA::End()':<br />
clzma.h:245: implicit declaration of function `int pthread_join(...)'<br />
clzma.h: In method `int CLZMA::Compress(int)':<br />
clzma.h:319: implicit declaration of function `int pthread_create(...)'<br />
gmake: *** [makenssi.o] Error 1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st October 2004, 12:19</div></div><div class="posttext">For the pthread errors, add #include &lt;pthread.h&gt; on the top of clzma.h.<br />
<br />
I have tried to reproduce the other error on three different solaris computers, but none showed that error. Can you attach (don't copy and paste, it might be very large) the output of `man munmap`?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NichDieMama</div><div class="date">1st October 2004, 13:06</div></div><div class="posttext">Hi! <br />
<br />
Thanks for your quick reply. I did that include and came to the munmap problem. I had a look at mmap.h and casted the first argument to caddr_t which seems to work fine. I attached my 'man munmap' nevertheless plus mmap.h. Now I am running into a problem in script.cpp:<br />
<br />
ld: Software Generation Utilities - Solaris Link Editors: 5.9-1.375<br />
gmake -C exehead<br />
ld: Software Generation Utilities - Solaris Link Editors: 5.9-1.375<br />
gmake[1]: Entering directory `/hox/user/dspilker/src/NSIS/NSIS/Source/exehead'<br />
gmake[1]: Nothing to be done for `all'.<br />
gmake[1]: Leaving directory `/hox/user/dspilker/src/NSIS/NSIS/Source/exehead'<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o 7zGuids.o 7zip/7zGuids.cpp<br />
gcc -Wall -O3 -DCOMPRESS_MF_BT  -c -o blocksort.o bzip2/blocksort.c<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o build.o build.cpp<br />
gcc -Wall -O3 -DCOMPRESS_MF_BT  -c -o bzlib.o bzip2/bzlib.c<br />
gcc -Wall -O3 -DCOMPRESS_MF_BT  -c -o compress.o bzip2/compress.c<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o CRC.o 7zip/Common/CRC.cpp<br />
gcc -Wall -O3 -DCOMPRESS_MF_BT  -c -o crc32.o crc32.c<br />
gcc -Wall -O3 -DCOMPRESS_MF_BT  -c -o deflate.o zlib/deflate.c<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o DialogTemplate.o DialogTemplate.cpp<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o exedata.o exedata.cpp<br />
gcc -Wall -O3 -DCOMPRESS_MF_BT  -c -o huffman.o bzip2/huffman.c<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o lang.o lang.cpp<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o LZInWindow.o 7zip/7zip/Compress/LZ/LZInWindow.cpp<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o LZMAEncoder.o 7zip/7zip/Compress/LZMA/LZMAEncoder.cpp<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o Alloc.o 7zip/Common/Alloc.cpp<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o makenssi.o makenssi.cpp<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o OutBuffer.o 7zip/7zip/Common/OutBuffer.cpp<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o Plugins.o Plugins.cpp<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o RangeCoderBit.o 7zip/7zip/Compress/RangeCoder/RangeCoderBit.cpp<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o ResourceEditor.o ResourceEditor.cpp<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o ResourceVersionInfo.o ResourceVersionInfo.cpp<br />
g++ -Wall -O3 -DCOMPRESS_MF_BT  -c -o script.o script.cpp<br />
script.cpp: In method `char * CEXEBuild::set_timestamp_predefine(char *)':<br />
script.cpp:87: implicit declaration of function `int ctime_r(...)'<br />
gmake: *** [script.o] Error 1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st October 2004, 13:21</div></div><div class="posttext">ctime_r is defined in time.h which is already included. ctime_r conforms with POSIX.1 (1996), so it's a pretty basic function that should be in any POSIX compliant platform. But I guess I could convert it to ctime which is defined in ANSI-C. Try replacing that block of code with:definedlist.add(&quot;__TIMESTAMP__&quot;,ctime(&amp;st.st_mtime));As for munmap, is there any define that can be checked so caddr_t can be used?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NichDieMama</div><div class="date">1st October 2004, 17:19</div></div><div class="posttext">Hi!<br />
<br />
Thanks! Your code did it. Since I am a Java programmer I do not have that much clue about C or C++ programming. The functions with the caddr_t argument are defined in the else part of an #if (_POSIX_C_SOURCE &gt; 2) || defined(_XPG4_2). I am not sure which values are hold by those variables.<br />
<br />
I had to remove the -Wl option in LDFLAGS to make the linker happy. But when running makensis, it core dumped. Any ideas? Could you compile and link it successfully? Which gcc version are you using?<br />
<br />
MakeNSIS v2.01 - Copyright 1999-2004 Nullsoft, Inc.<br />
<br />
Portions Copyright (C) 1995-1998 Jean-loup Gailly and Mark Adler (zlib).<br />
Portions Copyright (C) 1996-2002 Julian R Seward (bzip2).<br />
Portions Copyright (C) 1999-2003 Igor Pavlov (lzma).<br />
<br />
Contributors: nnop@newmail.ru, Ryan Geiss, Andras Varga, Drew Davidson, Peter Windridge, Dave Laundon, Robert Rainwater, Yaroslav Faybishenko, Jeff Doozan, Amir Szekely, Ximon Eighteen, et al.<br />
<br />
Processing config:<br />
Processing plugin dlls: &quot;/hox/user/appbuild/opt/thirdparty/nullsoft/nsis/Plugins/*.dll&quot;<br />
Segmentation Fault (core dumped)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st October 2004, 17:30</div></div><div class="posttext">Looks like the big endian problem... Are you using Sparc? According to this (http://mindprod.com/jgloss/endian.html) page, Sparc has a little endian mode. Try looking for little endian switch for gcc.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NichDieMama</div><div class="date">2nd October 2004, 14:57</div></div><div class="posttext">Hi!<br />
<br />
My gcc does not support -mlittle-endian for Sparc CPUs. I tried -D__LITTLE_ENDIAN__ and/or -D__LITTLE_ENDIAN_DATA__ which showed not effect. I also tried -m32 and -m64 which also didn't help. Further ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd October 2004, 15:01</div></div><div class="posttext">Are you running on 32 or 64 bit Sparc?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>