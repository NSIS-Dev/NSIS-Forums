<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to prevent C:\ install, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to prevent C:\ install NSIS Discussion" />
	
	<title> How to prevent C:\ install [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to prevent C:\ install</div>
<hr />
<div class="pda"><a href="t-205391.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=205391">How to prevent C:\ install</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">SoundScape_2910</div><div class="date">19th January 2005, 22:43</div></div><div class="posttext">Hello,<br />
<br />
I am trying to create an installer where the user is not allowed to install the product on C drive if he belong to a group other than &quot;Administrator&quot;. I use the plugin UserInfo to determine that. At first, I used AllowRootDirInstall = FALSE to prevent that, but even if &quot;C:\Program Files&quot; is selected, nothing happens. Installer continues normally without prompting user to change directory. How can I achieve that? Is there any command or something like that I can use? Any help is much appreciated!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Gosev</div><div class="date">19th January 2005, 22:56</div></div><div class="posttext">Originally posted by SoundScape_2910 <br />
Hello,<br />
At first, I used AllowRootDirInstall = FALSE to prevent that, but even if &quot;C:\Program Files&quot; is selected, nothing happens. Installer continues normally without prompting user to change directory. How can I achieve that? Is there any command or something like that I can use? Any help is much appreciated!  <br />
<br />
I think AllowRootDirInstall prevents you from writing on the roots of any the hard drives, it doesn't prevent you from writing on C: <br />
<br />
What I'd do is just do a check on the first character of the $INSTDIR string (using StrCpy to get the first char) : if that character is &quot;C&quot;, ask the user to select another path.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th January 2005, 15:06</div></div><div class="posttext">!define MUI_PAGE_CUSTOMFUNCTION_LEAVE &quot;checkINSTDIR&quot;<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
<br />
Function checkINSTDIR<br />
Push $R0<br />
StrCpy $R0 $INSTDIR &quot;&quot; 2<br />
StrCmp $R0 &quot;C:&quot; 0 NoAbort<br />
 MessageBox MB_OK|MB_ICONEXCLAMATION &quot;Not on C: dude!&quot;<br />
 Pop $R0<br />
 Abort<br />
NoAbort:<br />
Pop $R0<br />
FunctionEnd<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">20th January 2005, 17:15</div></div><div class="posttext">Had a similar problem with a user installing our software to their desktop.  When they uninstalled my script just deleted the installation directory which of course deleted everything on their desktop.  Pretty funny.  Well.. for me at least.  Not so much for them.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SoundScape_2910</div><div class="date">20th January 2005, 22:29</div></div><div class="posttext">Afrow UK,<br />
<br />
MessageBox MB_OK|MB_ICONEXCLAMATION &quot;Not on C: dude!&quot;<br />
<br />
LOL!!! Thanks for the code, I'll try it out. <br />
<br />
Thanks you all, take care.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">21st January 2005, 07:40</div></div><div class="posttext">2 rsegal<br />
.. and this is why I had to add installation folder check out and to create safe subfolder for suspicious situations in one of my programs (while we had only few such reports for 2.5 mln downloads).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>