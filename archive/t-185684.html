<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait + IfErrors + exitcode, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait + IfErrors + exitcode NSIS Discussion" />
	
	<title> ExecWait + IfErrors + exitcode [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait + IfErrors + exitcode</div>
<hr />
<div class="pda"><a href="t-185684.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=185684">ExecWait + IfErrors + exitcode</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">cmgdok</div><div class="date">6th July 2004, 17:45</div></div><div class="posttext">I'm using NSIS 2.0 on Windows 2000. In my install script, I have the following code:<br />
<br />
 ClearErrors<br />
 ExecWait '&quot;$INSTDIR\installmon.exe&quot; ME C:\CAPTURE'<br />
 IfErrors abort_installmon<br />
 goto done<br />
abort_installmon:<br />
  Abort &quot;Unable to use installmon&quot;<br />
done:<br />
  .....<br />
<br />
In my installmon source code, I have standard console win32 application where it calls exit(3) right after displaying a MessageBox with an error message.   <br />
<br />
MessageBox( hWnd, L&quot;unable to run&quot;, L&quot;Installer&quot;, MB_OK );<br />
            exit(3);<br />
<br />
What am I missing to get ExecWait working?  <br />
<br />
Thanks,<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">6th July 2004, 18:57</div></div><div class="posttext">What is exactly the problem? Doesn't it start anything? Is the command line input not recieved?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cmgdok</div><div class="date">6th July 2004, 20:18</div></div><div class="posttext">My command performs exit(3) ( displays the dialog just prior to that but IfErrors doesn't jump to abort_installmon and run Abort to quit the installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">6th July 2004, 20:37</div></div><div class="posttext">Try to add a variable that gets the error code and post the value of that variable.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cmgdok</div><div class="date">6th July 2004, 21:08</div></div><div class="posttext">ExecWait '&quot;$INSTDIR\installmon.exe&quot; CAP C:\CAPTURE' $INST_ERR<br />
   IfErrors abort_installme<br />
   StrCmp $INST_ERR 1 abort_installmon<br />
   MessageBox MB_OK|MB_ICONSTOP &quot;This is the end of the line! $INST_ERR&quot;<br />
 abort_installme:<br />
   MessageBox MB_OK|MB_ICONSTOP &quot;I should be here!&quot;<br />
 abort_installmon:<br />
   MessageBox MB_OK|MB_ICONSTOP &quot;I am crashing!&quot;<br />
   Abort ;<br />
<br />
the abort_installme code is never run but the abort_installmon code is run now that I've added the <br />
<br />
<br />
StrCmp $INST_ERR 1 label<br />
<br />
<br />
That has allowed me to work around ExecWait and IfErrors lack of interaction.<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">6th July 2004, 22:20</div></div><div class="posttext">The IfErrors command is to handle any errors that NSIS may get while trying to run your external EXE, e.g., if it could not spawn the process, or if the EXE was not found, etc.<br />
<br />
It will not handle the return code of your program- it cannot automatically assume that a non-zero return value is an error.<br />
What you have done now is the correct way to trap your program specific errors.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">6th July 2004, 23:11</div></div><div class="posttext">If the error code is nonzero and there is no variable set to recieve the error code the error flag should be set.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">7th July 2004, 03:17</div></div><div class="posttext">Of course you are correct.<br />
Note to self: RTFM. :o</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>