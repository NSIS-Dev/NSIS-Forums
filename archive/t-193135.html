<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Library.nsh, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Library.nsh NSIS Discussion" />
	
	<title> Library.nsh [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Library.nsh</div>
<hr />
<div class="pda"><a href="t-193135.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=193135">Library.nsh</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">fenrisW0lf</div><div class="date">10th September 2004, 21:47</div></div><div class="posttext">Hi all I am having this problem with my install script.<br />
<br />
This is the error:<br />
<br />
!define: &quot;LIBRARY_VERSION_HIGH&quot; already defined!<br />
!include: error in script: &quot;C:\Program Files\NSIS\Contrib\Library\LibraryLocal\LibraryLocal.nsh&quot; on line 1<br />
Error in macro InstallLib on macroline 84<br />
Error in script &quot;C:\Temp\iRing\iRing2.nsi&quot; on line 319 -- aborting creation process<br />
<br />
<br />
I have nsis 2.0 installed and I recently downloaded the development  Snapshot (http://nsis.sourceforge.net/nightly/nsis.zip) and copied those files over my nsis 2.0 install so that I could use the  installlib function.<br />
<br />
Here is my script, it is a little messy as I am just learning how to use it(sorry if it is long).<br />
<br />
This is the script:<br />
<br />
[snip, attached below]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th September 2004, 21:58</div></div><div class="posttext">The error and the script do not match. Line 319 contains a comment. Please attach scripts next time, it's very hard to read it this way.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th September 2004, 21:59</div></div><div class="posttext">script from original message</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th September 2004, 22:37</div></div><div class="posttext">Does it work with the attached Library.nsh?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fenrisW0lf</div><div class="date">11th September 2004, 14:44</div></div><div class="posttext">First off, my appologies for inserting the script instead of attaching it. kichik thanks for the replies!<br />
<br />
Now, I downloaded the library.nsh and put it into the include folder. When I tried compling the script I get a different error now:<br />
<br />
<br />
!define: &quot;LIBRARY_DEFINE_UPGRADE_LABEL&quot; already defined!<br />
Error in macro InstallLib on macroline 150<br />
Error in script &quot;C:\Temp\iRing\iRing2.nsi&quot; on line 208 -- aborting creation process<br />
<br />
<br />
There are no variables like that in my script. So I suspect that it is located in the library.nsh file but I am probably wrong. If this helps, before I added the sections called &quot;-Install Common Components&quot; and &quot;-un.Install Common Components&quot;. The script worked well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fenrisW0lf</div><div class="date">11th September 2004, 14:49</div></div><div class="posttext">OK, I found something interesting. I commented out the sections &quot;-Install Common Components&quot; and &quot;-un.Install Common Components&quot;. I compiled the script again and it stopped on this line with the error:<br />
<br />
Error:<br />
<br />
!define: &quot;LIBRARY_DEFINE_UPGRADE_LABEL&quot; already defined!<br />
Error in macro InstallLib on macroline 150<br />
Error in script &quot;C:\Temp\iRing\iRing2.nsi&quot; on line 175 -- aborting creation process<br />
<br />
<br />
<br />
<br />
The line:<br />
<br />
!insertmacro InstallLib TLB    $ALREADY_INSTALLED REBOOT_PROTECTED    &quot;iRing\vb6sp6Runtimes\stdole2.tlb&quot;  &quot;$SYSDIR\stdole2.tlb&quot;  &quot;$SYSDIR&quot;<br />
<br />
<br />
So I commented out the above line and it compiled. Could it be having a problem with the *.tlb file?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th September 2004, 14:56</div></div><div class="posttext">It's probably not just one line, but a combination of some.<br />
<br />
I've fixed the LIBRARY_DEFINE_UPGRADE_LABEL error. If you're still having problems with it, attach the entire script and paste the error so I can see exactly which lines cause this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fenrisW0lf</div><div class="date">11th September 2004, 16:29</div></div><div class="posttext">It worked. You're awesome! This has got to be one of the best installers around!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>