<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS in context menu, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS in context menu NSIS Discussion" />
	
	<title> NSIS in context menu [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS in context menu</div>
<hr />
<div class="pda"><a href="t-315798.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=315798">NSIS in context menu</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">28th December 2009, 21:45</div></div><div class="posttext">any chance to get the context menu entries to compile scripts working on Windows 7 x64? it's all properly set in the registry, but they don't show up (tried with and without holding shift-key).<br />
<br />
the registry on 64bit windows is properly confusing!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">29th December 2009, 18:38</div></div><div class="posttext">It works for me on Windows 7 RC 64-bit (see attached screenshot)<br />
<br />
Where did you install NSIS?<br />
<br />
I did not use &quot;C:\Program Files (x86)\NSIS&quot; because I wanted to avoid UAC problems when using a standard account to compile the NSIS examples.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">29th December 2009, 18:47</div></div><div class="posttext">as it's a 32-bit application, i installed it to Program Files (x86). i was running the RC before, now i'm using the final - didn't work in any of them.<br />
<br />
as a workaround i'm now using open with makensisw, that's good enough for now :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Geoff73</div><div class="date">13th January 2010, 09:48</div></div><div class="posttext">I'm on Windows 7 and associated the .nsi extension to another program. Lost Context Menu (&quot;Compile with...&quot;) and can't get it back (uninstall/reinstall NSIS makes no difference). Not a disaster because I have now associated it with 'makensisw.exe' so compile works with double-click, but annoying. Has anyone solved this problem?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anandharaja</div><div class="date">22nd January 2010, 14:16</div></div><div class="posttext">hello<br />
<br />
i found the solution u need to delete the registry entry.<br />
&quot;*HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts*&quot; find the .nsi extention there and delete the entry. its work for me</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">23rd January 2010, 12:29</div></div><div class="posttext">feeling lazy?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th February 2010, 16:14</div></div><div class="posttext">What's in that key?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">6th February 2010, 20:55</div></div><div class="posttext">Explorer adds things there on its own (When you use openwith etc)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th February 2010, 23:46</div></div><div class="posttext">Then deleting it affects the user's choice, doesn't it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">12th September 2011, 18:22</div></div><div class="posttext">microsoft's documentation (http://msdn.microsoft.com/en-us/library/cc144171(v=vs.85).aspx) is anything but good, but i read myself a bit into the issue.<br />
<br />
i've attached two registry files and a script that does the same as those files. there are two methods to create the context menu entries, but only one of them (hkcr) works properly in the script (maybe i'm just tired?)<br />
<br />
for reason unknown, i could only add menu entries for all files (*) rather than just scripts (.nsi) - all working examples i found on the net were made for all files as well, but i can't imagine why microsoft would want people to that. again, if you can fix this, please do.<br />
<br />
other than that, this works nicely!<br />
<br />
for reference:<br />
msdn (http://msdn.microsoft.com/en-us/library/cc144171(v=vs.85).aspx)<br />
msdn forums (http://social.msdn.microsoft.com/Forums/en/windowsuidevelopment/thread/3ee4702a-f75a-4790-9332-e50f241efd6f)<br />
working example (http://io-repo.blogspot.com/2011/05/cascading-context-menus-via-static.html)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">12th September 2011, 21:33</div></div><div class="posttext">screenshot<br />
<br />
http://forums.winamp.com/attachment.php?attachmentid=49137&amp;stc=1&amp;d=1315859600</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th September 2011, 09:51</div></div><div class="posttext">Still no idea why it's not working for you. It works fine for me and I even added my own options for my nsL Assembler. Running 7 x64.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">13th September 2011, 09:57</div></div><div class="posttext">the script above works for me (and i prefer a cascaded menus), just what the nsis installer does isn't working.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th September 2011, 13:04</div></div><div class="posttext">The NSIS installer has always worked for me and I have installed NSIS on 3 separate machines running fresh installs of Windows 7. Is yours a fresh install of SP1?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">13th September 2011, 13:24</div></div><div class="posttext">The NSIS installer has always worked for me and I have installed NSIS on 3 separate machines running fresh installs of Windows 7. Is yours a fresh install of SP1?<br />
<br />
Stu<br />
<br />
as mentioned above, i had this on a fresh windows 7 (pro x64), but i'm sure i installed it again since being on sp1 level. also happened previously when i ran a fresh install of windows 7 rc.<br />
<br />
all registry keys are properly written by the nsis installers and i don't have problems with other products (7zip, dropbox, notepad++, runwithparameters etc.) that add themselves to the context menu. it even works for my own installers that add entries in the same fashion as nsis does!<br />
<br />
ps: dropbox and 7zip are using cascaded menus (IContextMenu (http://msdn.microsoft.com/en-us/library/bb776095(v=vs.85).aspx) i presume) and might not count</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">13th September 2011, 16:53</div></div><div class="posttext">I don't know who made http://nsis.sourceforge.net/Windows_7_Cascading_Context_Menu but please fix it so that it only binds to .nsi, not to * before posting to the wiki...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">13th September 2011, 19:55</div></div><div class="posttext">I don't know who made http://nsis.sourceforge.net/Windows_7_Cascading_Context_Menu but please fix it so that it only binds to .nsi, not to * before posting to the wiki...<br />
<br />
the only working examples i found on the internet (and also the default entries in windows 7) work for *, Directory, DesktopBackground, DeviceDisplayObject and such, not for specific files<br />
<br />
the only file-specific example i found did not work on my computer. now i wonder if that's related to my initial problem, so you might want to test the attached script. just make sure to adjust the paths first. also, only use this if you know how to revert the changes afterwards!<br />
<br />
since i'm not the only one with this problem, i think it should be resolved. also, you might want to consider using cascaded menus on windows 7 in future versions - once working for a single file type.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">13th September 2011, 21:35</div></div><div class="posttext">http://forums.winamp.com/attachment.php?attachmentid=49139&amp;d=1315946012<br />
<br />
49139<br />
<br />
Just for .nsi and I did it in HKCU just for fun</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">13th September 2011, 22:58</div></div><div class="posttext">can you post your script please or put it on that wikipage?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">13th September 2011, 23:19</div></div><div class="posttext">can you post your script please or put it on that wikipage?<br />
<br />
I don't have a script, I just edited the registry (I have already deleted the keys) I did not do anything special. As long as your .nsi default value is NSIS.Script I don't see why it should not work. Maybe you should try Process Monitor and look at what explorer is looking for to find your problem...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">14th September 2011, 12:14</div></div><div class="posttext">i have no problems with windows 7 32-bit running in a vm, updated the wiki page</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>