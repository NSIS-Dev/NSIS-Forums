<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Add, Remove, Repair from Install executable, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Add, Remove, Repair from Install executable NSIS Discussion" />
	
	<title> Add, Remove, Repair from Install executable [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Add, Remove, Repair from Install executable</div>
<hr />
<div class="pda"><a href="t-241048.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=241048">Add, Remove, Repair from Install executable</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kelek</div><div class="date">16th March 2006, 21:20</div></div><div class="posttext">One of the nice things about InstallShield is it's ability to detect, when executing the installation executable, if a previous installation exists, and then bring you to the add/remove/repair selection.  If there is no existing installation, it continues as normal.  <br />
<br />
So for example, lets say I run the installation for program X.  Right after it's installed, I can re-run the installation program to uninstall program X, without having to go through Control Panel, or the Start Menu Program Groups, etc.<br />
<br />
Is there any way to do this with NSIS?  I've looked into Thrash's add/remove programs, but that just customizes the menu from the Add/Remove programs in control panel and for the uninstall script.<br />
<br />
This involves 'branching' into two different sets of pages, depending on if it detected an installation.  As far as I know, that's not possible, since you can't use function calls to customize the page layout.<br />
<br />
I thought about doing stuff in .onInit, but I think it sets the page layout before doing .onInit, so it won't matter.  Any ideas?<br />
<br />
Another idea, which seems a bit complex, would be to have an installation package which automatically packages two different installation packages.  Then, if it detects the installation, it runs one, and if it doesn't, it runs the other.  However, this would result in a 2x size bloat/overhead in file size.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">16th March 2006, 21:32</div></div><div class="posttext">I found this (http://nsis.sourceforge.net/Component_Manager) a few days ago. I think it may help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kelek</div><div class="date">16th March 2006, 21:55</div></div><div class="posttext">I found this too, but unfortunately it's under the GPL.  Is there any version of this that is under the NSIS 'as-is' license, including commercial?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">16th March 2006, 21:59</div></div><div class="posttext">What about detecting your app in .onInit and then displaying a confirmation MessageBox that executes the UninstallString and exits if the user chooses to uninstall?<br />
<br />
Or you should be able to have a custom page to handle the confirmation, which would get skipped if your app isn't detected--isn't that functionally the same as what InstallShield can do?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">16th March 2006, 22:46</div></div><div class="posttext">Why not just detecting if a previous version is installed in .onInit and then display a custom page.  From this custom page, have the add/remove/repair options.  When next is selected, launch something else (or another custom page(s)).  When a previous version isn't detected, just use Abort in the Pre functions of your custom pages.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kelek</div><div class="date">17th March 2006, 03:41</div></div><div class="posttext">The other problem is that I'm not sure how to have radio button functionality in a custom page.  Sections.nsh support for radio buttons only applies to normal sections, not sections within a custom page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">17th March 2006, 03:54</div></div><div class="posttext">Use the &quot;group&quot; flag to group radio buttons together.  <br />
<br />
Hint: I've found that it's usually a good idea to have the radio buttons as the last 3 options on the page to make the group work properly.<br />
<br />
See the InstallOptions doc for more info.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kelek</div><div class="date">17th March 2006, 03:59</div></div><div class="posttext">By the way, thanks for the tips.  I have a custom page where I skip all of the !insertmacro stuff for the page if it doesn't detect an installation, and an empty custom page seems to get skipped, which is good.  I also rediscovered that there's a type RadioButton for .ini files.  Thanks!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>