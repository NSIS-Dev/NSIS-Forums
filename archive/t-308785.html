<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Selection section through the installation type, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Selection section through the installation type NSIS Discussion" />
	
	<title> Selection section through the installation type [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Selection section through the installation type</div>
<hr />
<div class="pda"><a href="t-308785.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=308785">Selection section through the installation type</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Goingoin</div><div class="date">23rd July 2009, 05:55</div></div><div class="posttext">Hello,<br />
<br />
I ask your help because after several tries, I am completely lost.<br />
<br />
In my script, I have 2 type of facility that is &quot;XP&quot; and &quot;VISTA&quot;.<br />
I also have several section.<br />
<br />
Below the code:<br />
<br />
! ifndef NOINSTTYPES<br />
     InstType &quot;XP&quot;<br />
     InstType &quot;VISTA&quot;<br />
! endif<br />
<br />
     SectionGroup &quot;Internet Explorer 8&quot; SECGRP0003<br />
         Section / o XP SEC0015<br />
             SetOutPath $ INSTDIR \ ie8XP<br />
             SetOverwrite on<br />
             File / r &quot;.......&quot;<br />
             SetOutPath $ INSTDIR<br />
             File &quot;.......&quot;<br />
             WriteRegStr HKLM &quot;$ (regKey) \ Components&quot; XP 1<br />
         SectionEnd<br />
<br />
         Section / o VISTA SEC0016<br />
             SetOutPath $ INSTDIR \ ie8VISTA<br />
             SetOverwrite on<br />
             File / r &quot;.....&quot;<br />
             SetOutPath $ INSTDIR<br />
             File &quot;.....&quot;<br />
             WriteRegStr HKLM &quot;$ (regKey) \ Components&quot; VISTA 1<br />
         SectionEnd<br />
     SectionGroupEnd<br />
<br />
# Installer functions<br />
Function .onInit<br />
# Installation choices<br />
#Windows XP<br />
    !insertmacro SetSectionInInstType &quot;${SEC0000}&quot; &quot;${INSTTYPE_1}&quot;<br />
    !insertmacro SetSectionInInstType &quot;${SEC0001}&quot; &quot;${INSTTYPE_1}&quot;<br />
    !insertmacro SetSectionInInstType &quot;${SEC0002}&quot; &quot;${INSTTYPE_1}&quot;<br />
    !insertmacro SetSectionInInstType &quot;${SEC0004}&quot; &quot;${INSTTYPE_1}&quot;<br />
    !insertmacro ClearSectionInInstType &quot;${SEC0003}&quot; &quot;${INSTTYPE_1}&quot;<br />
    !insertmacro ClearSectionInInstType &quot;${SEC0016}&quot; &quot;${INSTTYPE_1}&quot;<br />
    <br />
#Windows VISTA<br />
    !insertmacro SetSectionInInstType &quot;${SEC0000}&quot; &quot;${INSTTYPE_2}&quot;<br />
    !insertmacro SetSectionInInstType &quot;${SEC0003}&quot; &quot;${INSTTYPE_2}&quot;<br />
    !insertmacro SetSectionInInstType &quot;${SEC0004}&quot; &quot;${INSTTYPE_2}&quot;<br />
    !insertmacro ClearSectionInInstType &quot;${SEC0001}&quot; &quot;${INSTTYPE_2}&quot;<br />
    !insertmacro ClearSectionInInstType &quot;${SEC0002}&quot; &quot;${INSTTYPE_2}&quot;<br />
    !insertmacro ClearSectionInInstType &quot;${SEC0006}&quot; &quot;${INSTTYPE_2}&quot;<br />
    !insertmacro ClearSectionInInstType &quot;${SEC0008}&quot; &quot;${INSTTYPE_2}&quot;<br />
    !insertmacro ClearSectionInInstType &quot;${SEC0013}&quot; &quot;${INSTTYPE_2}&quot;<br />
    !insertmacro ClearSectionInInstType &quot;${SEC0014}&quot; &quot;${INSTTYPE_2}&quot;<br />
    !insertmacro ClearSectionInInstType &quot;${SEC0015}&quot; &quot;${INSTTYPE_2}&quot;<br />
    InitPluginsDir<br />
FunctionEnd<br />
<br />
<br />
I wish that when I select the XP installation type:<br />
      - The &quot;SEC0015&quot; does not appear in the type of installation &quot;vista&quot; (gray)<br />
      - Does not check the default installation type of &quot;XP&quot;. (leaves the possibility to check or not)<br />
<br />
Thank you in advance for your help.<br />
<br />
Goingoin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">23rd July 2009, 13:43</div></div><div class="posttext">Hello,<br />
to select or unselect sections depending on insttypes use the SectionIn command.<br />
to grey out a section use the SetSectionFlag macro (see also this post http://forums.winamp.com/showthread.php?s=&amp;threadid=308791 [308791])<br />
Regards<br />
  Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Goingoin</div><div class="date">24th July 2009, 06:19</div></div><div class="posttext">Hello,<br />
<br />
Thank you for your answer.<br />
In fact, I want when I select the installation type &quot;XP&quot; manually, I can check or uncheck the SEC0015 against by I do not want to see SEC0016 as it is for the installation type &quot;VISTA&quot; (and therefore that section SEC0016 is dimmed or even better yet does not appear)<br />
<br />
I created this macro, but it does not work :<br />
<br />
!macro SSISelect SECTION_NAME WANTED_INSTTYPE<br />
    Push $0<br />
    Push $1<br />
        IntOp $0 ${SF_SELECTED} | ${SF_RO}<br />
        SectionGetInstTypes $1 $0<br />
        IntOp $0 $0 | ${WANTED_INSTTYPE}<br />
        SectionSetInstTypes $1 $0<br />
        ${if} ${WANTED_INSTTYPE} = &quot;VISTA&quot;<br />
         SectionSetFlags ${SECTION_NAME} $0<br />
        ${EndIf} <br />
    Pop $1<br />
    Pop $0<br />
!macroend <br />
<br />
Sorry, I'm french and my English is pathetic.<br />
<br />
Thank you for your reply<br />
<br />
Goingoin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Goingoin</div><div class="date">27th July 2009, 10:37</div></div><div class="posttext">An idea Plz ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Goingoin</div><div class="date">29th July 2009, 07:34</div></div><div class="posttext">Hello,<br />
I tried what you told me, for it is against any dimmed.<br />
<br />
I would like ca that is dimmed during installation 2<br />
<br />
An idea?<br />
<br />
Goingoin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th July 2009, 00:36</div></div><div class="posttext">Can't quite understand what you are after but with InstType you must use SectionIn within a Section to put that section into the install type.<br />
<br />
http://nsis.sourceforge.net/Docs/Chapter4.html#4.6.1.4<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Goingoin</div><div class="date">30th July 2009, 05:44</div></div><div class="posttext">Hello,<br />
<br />
Attached photos of the installation.<br />
I want to check or uncheck when installing &quot;XP&quot; section &quot;Internet Explorer 8&quot; &quot;XP&quot; and &quot;VISTA&quot; is grayed out or does not appear.<br />
<br />
And vice versa for VISTA.<br />
<br />
http://ggoingoin.free.fr/Images/Segala/XP.JPG<br />
<br />
http://ggoingoin.free.fr/Images/Segala/Vista.JPG</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th July 2009, 12:16</div></div><div class="posttext">Ah right that is making sense now :) Have a look at Examples\one-section.nsi.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Goingoin</div><div class="date">31st July 2009, 05:45</div></div><div class="posttext">Hello,<br />
<br />
It's good I solved my problem<br />
<br />
So I rewrote it. OnInit which is like this now:<br />
<br />
    ${IfNot} ${IsWinXP}<br />
        !insertmacro SelectSection ${SEC0000}<br />
        !insertmacro SelectSection ${SEC0003}<br />
        !insertmacro SelectSection ${SEC0004}<br />
        !insertmacro SetSectionFlag ${SEC0006} ${SF_RO}<br />
        !insertmacro UnselectSection ${SEC0006}<br />
        SectionSetText &quot;${SEC0006}&quot; &quot;&quot;<br />
        !insertmacro SetSectionFlag ${SEC0008} ${SF_RO}<br />
        !insertmacro UnselectSection ${SEC0008}<br />
        SectionSetText &quot;${SEC0008}&quot; &quot;&quot;<br />
        !insertmacro SetSectionFlag ${SEC0013} ${SF_RO}<br />
        !insertmacro UnselectSection ${SEC0013}<br />
        SectionSetText &quot;${SEC0013}&quot; &quot;&quot;<br />
        !insertmacro SetSectionFlag ${SEC0014} ${SF_RO}<br />
        !insertmacro UnselectSection ${SEC0014}<br />
        SectionSetText &quot;${SEC0014}&quot; &quot;&quot;<br />
        !insertmacro SetSectionFlag ${SEC0015} ${SF_RO}<br />
        !insertmacro UnselectSection ${SEC0015}<br />
        SectionSetText &quot;${SEC0015}&quot; &quot;&quot; <br />
    ${Else}<br />
        !insertmacro SelectSection ${SEC0000}<br />
        !insertmacro SelectSection ${SEC0001}<br />
        !insertmacro SelectSection ${SEC0002}<br />
        !insertmacro SelectSection ${SEC0004}<br />
        !insertmacro SetSectionFlag ${SEC0016} ${SF_RO}<br />
        !insertmacro UnselectSection ${SEC0016}<br />
        SectionSetText &quot;${SEC0016}&quot; &quot;&quot;      <br />
    ${EndIf}<br />
<br />
I delete most of the installation type &quot;XP&quot; or &quot;vista&quot; and I put this ( !include WinVer.nsh) in the code so that it can choose its own version of the operating system.<br />
<br />
Thank you for your help.<br />
<br />
Goingoin</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>