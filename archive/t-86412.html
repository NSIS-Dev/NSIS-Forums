<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" XPStyle &amp; stripping of useless dialogs and bitmaps, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  XPStyle &amp; stripping of useless dialogs and bitmaps NSIS Discussion" />
	
	<title> XPStyle &amp; stripping of useless dialogs and bitmaps [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  XPStyle &amp; stripping of useless dialogs and bitmaps</div>
<hr />
<div class="pda"><a href="t-86412.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=86412">XPStyle &amp; stripping of useless dialogs and bitmaps</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th April 2002, 09:59</div></div><div class="posttext">Hi!<br />
<br />
Since justin didn't want to do it, I did it my self. So here it is, script compile time directive to add WinXP style support and stripping of useless dialogs and bitmaps when using silent mode.<br />
<br />
XPStyle disable|enable<br />
<br />
XPStyle is disabled by default.<br />
<br />
Attached are the changed source files and a new version of my EditPlus syntax file.<br />
<br />
I only have one problem with it, when I strip the useless resources manually with a program like Resource Hacker (http://www.rpi.net.au/~ajohnson/resourcehacker/) it reduces about 3 KBs from the header but when I do it with my code it only reduces a KB. Does anyone know what I am doing wrong? The stripping code is in build.cpp.<br />
<br />
If I have some more time I will convert more compile time #define's to script compile time directives.<br />
<br />
Enjoy,<br />
   KiCHiK<br />
<br />
BTW, the road from here to full color icons is short... ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DuaneJeffers</div><div class="date">3rd May 2002, 02:44</div></div><div class="posttext">Cool, Good work.<br />
<br />
-Duane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd May 2002, 13:33</div></div><div class="posttext">Bug found...<br />
<br />
This patch will ouput corrupted installer if !packhdr is used.<br />
Sorry about this, I will release a fix with the next patch that will include support for full color icons as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd May 2002, 14:41</div></div><div class="posttext">Ok, now this really sucks... It turns out that UpdateResource only works on NT. :(<br />
<br />
I will try to do it without those functions...<br />
<br />
I will let you know.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DuaneJeffers</div><div class="date">5th May 2002, 06:29</div></div><div class="posttext">Well, if it is only going to work on XP, then the NT problem shouldn't matter because the kernel was built on NT.<br />
<br />
-Duane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pjw62</div><div class="date">5th May 2002, 11:13</div></div><div class="posttext">to manipulate resources in PE exe images, you need to use the declarations in winnt.h.<br />
<br />
This is how I wrote the resource offset finding code. To update resources is slightly more complicated as you need to update the offsets in the resource table as well as actually delete the data, so window can still find the resources in the exe file. Although I kept it all inline, to find so many resources, you would probably need to process recursively.<br />
<br />
It is a good idea though, so I might be able to offer a small bit of help.<br />
<br />
Peter.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th May 2002, 20:27</div></div><div class="posttext">We can always use Geeworks Win32 Resource Library (http://www.geeworks.com/rsrc/)! It is only 3000$ :igor: ! Oops... My bad :( it is only 2999$ :p<br />
<br />
Well, I guess I will have to write some resource updating functions myself. I have in my hands a Delphi source code of some sort of resource editing program someone sent as an answer in a news-group somewhere in the deep cyberspace :D<br />
<br />
If anyone can help, or know an open source resource editing proggie I will really appreciate it because I don't really have the time right now. If no one can help I will have some free time, two months, in about two months.<br />
<br />
Ta ta, cheers<br />
  KiCHiK</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TheSh@dow</div><div class="date">6th May 2002, 20:17</div></div><div class="posttext">Hi<br />
<br />
if ya want NSIS with win xp buttons &amp; progress bars here is a little prog i made<br />
http://home.iprimus.com.au/shaun_l/Files/NSIS_WinXp.zip (450kb)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th May 2002, 20:37</div></div><div class="posttext">Hi Shadow,<br />
<br />
Thanks for your help! But what I want is more than just XP style, I want to be able to edit all of NSIS's resources. Is the source code for this program available? Are you using UpdateResource or did you implement resource editing functions according to the PE structure? Did you write it with C or another language?<br />
<br />
TIA<br />
   KiCHiK</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TheSh@dow</div><div class="date">6th May 2002, 20:53</div></div><div class="posttext">Hi<br />
<br />
i made it with Resource Hacker &amp; upx <br />
it just extracts the files to a temp folder <br />
then auto updates the tmp.dat and gives the updated file to makensisw<br />
i am still learning to program :P<br />
i got a demo program that came with delphi 6 to view &amp; i think to edit pe files u want it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th May 2002, 16:16</div></div><div class="posttext">Thanks Shadow!<br />
<br />
Well, using Resource Hacker inside NSIS will be kind of messy...<br />
<br />
I will be happy if you can send the demo to me so I will have a better starting point. All I will have to do is to translate from Delphi to C, and that will be easier than doing it all from scratch.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TheSh@dow</div><div class="date">7th May 2002, 19:15</div></div><div class="posttext">Hi<br />
<br />
i dident mean the Resource Hacker is in the output .exe file,<br />
it just adds the WinXP.manifest into the header file before NSIS compiler adds the compressed file, scripts and all the stuff it dose <br />
<br />
<br />
oh yea here is the source code</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>