<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS 'ifnewer', media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS 'ifnewer' NSIS Discussion" />
	
	<title> NSIS 'ifnewer' [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS 'ifnewer'</div>
<hr />
<div class="pda"><a href="t-320678.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=320678">NSIS 'ifnewer'</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">nedloh</div><div class="date">9th July 2010, 20:33</div></div><div class="posttext">The product I work on at one point used installshield and now uses NSIS.<br />
<br />
I have an issue though, when trying to install a new version of the product over an old version, if the old version is old enough to have been installed with installshield, then certain files fail to get overwritten, which causes major problems in the product.<br />
<br />
I lay no blame on NSIS but I am wondering how the NSIS ifnewer option is handled? How does it check if it's newer?<br />
<br />
If it goes by the last modified date and time, then someone else must be wrong because even when the last modified date is a full year old this problem has been reported.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">9th July 2010, 22:20</div></div><div class="posttext">Perhaps InstallShield is 'repairing' the old files and replacing your new ones with cached versions of the originals. That is a feature of InstallShield, perhaps the biggest reason I switched from InstallShield to NSIS.<br />
<br />
You might want to wipe out the InstallShield cache (I found it in $Windir\Installer\xxxx.msi)<br />
<br />
Here's the code I have in one of my installers. You'll have to look up the GUID for your own installer and modify this code to delete the keys/files for your own installer.ClearErrors<br />
ReadRegStr $R0 HKLM &quot;${Uninstall_KEY}\InstallShield_{BE1DC3D5-CF2A-4165-B7FF-8228BE17F47B}&quot; &quot;DisplayVersion&quot;<br />
${Unless} ${Errors}<br />
  DetailPrint &quot;Cleaning ARP entry&quot;<br />
  # delete the old InstallShield ARP entry<br />
  DeleteRegKey HKLM &quot;${Installer_CLASSES_KEY}\5D3CD1EBA2FC56147BFF2882EB714FB7&quot;<br />
  DeleteRegKey HKLM &quot;${Installer_CLASSES_Features}\5D3CD1EBA2FC56147BFF2882EB714FB7&quot;<br />
  DeleteRegKey HKLM &quot;${Uninstall_KEY}\InstallShield_{BE1DC3D5-CF2A-4165-B7FF-8228BE17F47B}&quot;<br />
  DeleteRegKey HKLM &quot;${Uninstall_KEY}\InstallShield Uninstall Information\{BE1DC3D5-CF2A-4165-B7FF-8228BE17F47B}&quot;<br />
  DeleteRegKey HKLM &quot;${Uninstall_KEY}\{BE1DC3D5-CF2A-4165-B7FF-8228BE17F47B}&quot;<br />
  ReadRegStr $R0 HKLM &quot;${Installer_KEY_PRD}\5D3CD1EBA2FC56147BFF2882EB714FB7\InstallProperties&quot; &quot;LocalPackage&quot;<br />
  Delete $R0			; C:\Winnt\Installer\xxxxx.msi<br />
  StrCpy $R0 &quot;$WINDIR\Installer\{BE1DC3D5-CF2A-4165-B7FF-8228BE17F47B}&quot;<br />
  RmDir /r $R0<br />
  DeleteRegKey HKLM &quot;${Installer_KEY_PRD}\5D3CD1EBA2FC56147BFF2882EB714FB7&quot;<br />
  DeleteRegKey HKLM &quot;${Installer_KEY_UPG}\E48C006C5E337CB49B506DC4ACAD1D84&quot;<br />
  DeleteRegValue HKLM &quot;${Installer_KEY_Fld}&quot; &quot;$R0\&quot;<br />
${EndUnless}<br />
Notice that the two different GUIDS are related to each other: the one beginning &quot;BE1DC3D5-CF2A-&quot; and the one &quot;5D3CD1EBA2FC&quot; are the same basic values with the sections between dashes written in reverse when they leave out the dashes.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>