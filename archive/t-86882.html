<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Hiding ExecWait windows, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Hiding ExecWait windows NSIS Discussion" />
	
	<title> Hiding ExecWait windows [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Hiding ExecWait windows</div>
<hr />
<div class="pda"><a href="t-86882.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=86882">Hiding ExecWait windows</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bmatzelle1</div><div class="date">6th May 2002, 17:05</div></div><div class="posttext">My installer uses ExecWait quite a bit and some of the programs that it executes take a lot of time to execute, thus the console window sits in the foreground for long periods of time.  Is there a possiblity that one of the following things could be added to the installer to make ExecWait a little cleaner:<br />
<br />
* Hide the console window<br />
* Minimize the console or place it behind the installer window<br />
* Fire up a nice message box with a message that explains to the user what it is doing during the wait like &quot;Starting MySQL Daemon ...&quot;<br />
<br />
Warm regards,<br />
<br />
Brent<br />
<br />
By the way, this issue has been brought up before with no results: http://forums.winamp.com/showthread.php?s=&amp;threadid=77705</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th May 2002, 18:28</div></div><div class="posttext">What you can do is excute the program with Exec and not ExecWait and then find its window with FindWindow. Then you should call BringToFront to bring the installer back to front, show some install options dialog that says installing whatever or just printing it in the details, and finally enter into a loop waiting for the window to close (using FindWindow and waiting for it to return zero).<br />
<br />
To just hide it you can create a shortcut for it and execute it with ExecWait.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bmatzelle1</div><div class="date">7th May 2002, 03:03</div></div><div class="posttext">I tried your solution but it still is unsatisfactory.  To the user the console still flashes to screen before going to the background and the installer seems like it is frozen (to an ordinary user) while the command is running.  I believe that the solution to this problem will require some enhancements to the ExecWait code base.  <br />
<br />
Justin, could you please look into this, or point me in the right direction so I can add something like this myself?  <br />
<br />
Thanks and warm regards,<br />
<br />
Brent</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">7th May 2002, 15:58</div></div><div class="posttext">If you are running DOS commands, you need to create a dll extension to execute the program and pump the output to the program and not to a console window.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th May 2002, 16:05</div></div><div class="posttext">rainwater's idea seems better than mine :up: <br />
<br />
How aobut this:<br />
<br />
DetailPrint &quot;Executing whatever, please hold...&quot;<br />
SetDetailsPrint none<br />
GetTempFileName $R1<br />
StrCpy $R1 &quot;$R1.lnk&quot;<br />
CreateShortcut $R1 &quot;whatever dos command you want&quot; &quot;paramaters&quot; &quot;&quot; &quot;&quot; SW_SHOWMINIMIZED<br />
Exec $R1<br />
loop:<br />
   Sleep 200<br />
   FindWindow $R2 &quot;ConsoleWindowClass&quot; &quot;window name&quot;<br />
   ; NOTE: Make sure it is the same class name in Win9x too<br />
   StrCmp $R2 &quot;0&quot; 0 loop<br />
Delete $R1<br />
SetDetailsPrint both<br />
DetailPrint &quot;Done!&quot;<br />
<br />
<br />
If you still don't like it, you can always write your own DLL that creats a new thread which displays some message box and then destroy the thread when the operation is done.<br />
<br />
KiCHiK</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bmatzelle1</div><div class="date">7th May 2002, 19:19</div></div><div class="posttext">Create an extension every time I want to prevent a console window from showing up?  There has to be a better way.<br />
<br />
Brent</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th May 2002, 19:27</div></div><div class="posttext">If you want it just to hide use my code, if you want a more elegant solution use rainwater's solution.<br />
BTW you won't have to create an extension for every console window, just one that will get the message to display and the command to run using the stack.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Fightin_Foo</div><div class="date">23rd November 2007, 22:22</div></div><div class="posttext">I am in a similiar situation, did you ever get the problem solved bmatzelle1?  Can anyone tell me how or point me to a place that says how to create the dll like rainwater suggested?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd November 2007, 22:29</div></div><div class="posttext">Use nsExec.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Fightin_Foo</div><div class="date">23rd November 2007, 22:44</div></div><div class="posttext">I've tried to use nsExec before, but it seems that it gives no indication that the script has been run.  Did it display something and I just missed it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd November 2007, 23:44</div></div><div class="posttext">No, it doesn't display anything. That's the whole point - it hides the command window. See Docs\nsExec and Examples\nsExec for more details on what it returns to the script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">21st December 2007, 07:18</div></div><div class="posttext">Is there a way to display ExecWait's &quot;DOS Box&quot; (console) output in installation details? I know that I can redirect output to file like &quot;hello.exe &gt; hello.txt&quot; and then display that .txt. Any other way? Thank you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st December 2007, 09:43</div></div><div class="posttext">nsExec::ExecToLog.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">21st December 2007, 10:26</div></div><div class="posttext">Yay! :-) Thank you very much!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>