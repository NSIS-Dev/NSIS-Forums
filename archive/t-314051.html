<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Macro overloading, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Macro overloading NSIS Discussion" />
	
	<title> Macro overloading [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Macro overloading</div>
<hr />
<div class="pda"><a href="t-314051.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=314051">Macro overloading</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ChocJunkie</div><div class="date">21st October 2009, 10:16</div></div><div class="posttext">Hey,<br />
<br />
Is there a possibility to overload macros like e.g. overloading methods in Java?<br />
<br />
I would like to have something like this:!macro myMacro param1<br />
!macro myMacro param1 param2<br />
!macro myMacro param1 param2 param3This way I dont have to use &quot;&quot; for the second and/or third parameter.<br />
<br />
Thanks :)<br />
<br />
CJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zinthose</div><div class="date">21st October 2009, 15:17</div></div><div class="posttext">Not that I've found.  But, here is a little macro trick I whipped together that simulates it nicely.<br />
<br />
!macro _DoStuff _Params<br />
    !searchparse /noerrors `${_Params}` '' _Param1 `|` _Param2 `|` _Param3<br />
    DetailPrint &quot;###### Param Test ####&quot;<br />
    DetailPrint &quot;  P1 = ${_Param1}&quot;<br />
    DetailPrint &quot;  P2 = ${_Param2}&quot;<br />
    DetailPrint &quot;  P3 = ${_Param3}&quot;<br />
    DetailPrint &quot;&quot;<br />
    !undef _Param1<br />
    !undef _Param2<br />
    !undef _Param3<br />
!macroend<br />
!define DoStuff `!insertmacro _DoStuff`<br />
<br />
Section Test<br />
    ${DoStuff} &quot;Hello|There|World&quot;<br />
    ${DoStuff} &quot;Hello||World&quot;<br />
    ${DoStuff} &quot;Hello|World&quot;<br />
    ${DoStuff} &quot;Hello World&quot;<br />
    ${DoStuff} &quot;||Hello World&quot;<br />
SectionEnd<br />
<br />
Output is:<br />
###### Param Test ####<br />
  P1 = Hello<br />
  P2 = There<br />
  P3 = World<br />
<br />
###### Param Test ####<br />
  P1 = Hello<br />
  P2 = <br />
  P3 = World<br />
<br />
###### Param Test ####<br />
  P1 = Hello<br />
  P2 = World<br />
  P3 = <br />
<br />
###### Param Test ####<br />
  P1 = Hello World<br />
  P2 = <br />
  P3 = <br />
<br />
###### Param Test ####<br />
  P1 = <br />
  P2 = <br />
  P3 = Hello World<br />
<br />
Completed</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zinthose</div><div class="date">21st October 2009, 21:37</div></div><div class="posttext">Evolution of previous post:<br />
<br />
OutFile Test.exe<br />
<br />
## Macro Helper Macros<br />
    !define MacroParams &quot;!insertmacro _MacroParams&quot;<br />
    !macro _MacroParams _ParamNames _Values<br />
        !searchreplace _TMP `${_ParamNames}` &quot;|&quot; &quot; '|' &quot;<br />
        !searchparse /noerrors `${_Values}` '' ${_TMP}<br />
        !undef _TMP<br />
    !macroend<br />
    <br />
    !define MacroClean &quot;!insertmacro _MacroClean&quot;<br />
    !macro _MacroClean _ParamNames<br />
        !searchparse /ignorecase /noerrors `${_ParamNames}` '' _TMP2 &quot;|&quot; _TMP<br />
        !undef _TMP2<br />
        !if `_TMP` != &quot;&quot;<br />
            !searchparse /ignorecase /noerrors `${_TMP}` '' _TMP2 &quot;|&quot; _TMP<br />
            !undef _TMP2<br />
        !endif<br />
        !if `_TMP` != &quot;&quot;<br />
            !searchparse /ignorecase /noerrors `${_TMP}` '' _TMP2 &quot;|&quot; _TMP<br />
            !undef _TMP2<br />
        !endif<br />
        !if `_TMP` != &quot;&quot;<br />
            !searchparse /ignorecase /noerrors `${_TMP}` '' _TMP2 &quot;|&quot; _TMP<br />
            !undef _TMP2<br />
        !endif<br />
        !if `_TMP` != &quot;&quot;<br />
            !searchparse /ignorecase /noerrors `${_TMP}` '' _TMP2 &quot;|&quot; _TMP<br />
            !undef _TMP2<br />
        !endif<br />
        !if `_TMP` != &quot;&quot;<br />
            !searchparse /ignorecase /noerrors `${_TMP}` '' _TMP2 &quot;|&quot; _TMP<br />
            !undef _TMP2<br />
        !endif<br />
        !if `_TMP` != &quot;&quot;<br />
            !searchparse /ignorecase /noerrors `${_TMP}` '' _TMP2 &quot;|&quot; _TMP<br />
            !undef _TMP2<br />
        !endif<br />
        !if `_TMP` != &quot;&quot;<br />
            !searchparse /ignorecase /noerrors `${_TMP}` '' _TMP2 &quot;|&quot; _TMP<br />
            !undef _TMP2<br />
        !endif<br />
        !if `_TMP` != &quot;&quot;<br />
            !searchparse /ignorecase /noerrors `${_TMP}` '' _TMP2 &quot;|&quot; _TMP<br />
            !undef _TMP2<br />
        !endif<br />
        !if `_TMP` != &quot;&quot;<br />
            !searchparse /ignorecase /noerrors `${_TMP}` '' _TMP2 &quot;|&quot; _TMP<br />
            !undef _TMP2<br />
        !endif<br />
        !if `_TMP` != &quot;&quot;<br />
            !searchparse /ignorecase /noerrors `${_TMP}` '' _TMP2 &quot;|&quot; _TMP<br />
            !undef _TMP2<br />
        !endif<br />
        !if `_TMP` != &quot;&quot;<br />
            !searchparse /ignorecase /noerrors `${_TMP}` '' _TMP2 &quot;|&quot; _TMP<br />
            !undef _TMP2<br />
        !endif<br />
        !if `_TMP` != &quot;&quot;<br />
            !searchparse /ignorecase /noerrors `${_TMP}` '' _TMP2 &quot;|&quot; _TMP<br />
            !undef _TMP2<br />
        !endif<br />
        !if `_TMP` != &quot;&quot;<br />
            !searchparse /ignorecase /noerrors `${_TMP}` '' _TMP2 &quot;|&quot; _TMP<br />
            !undef _TMP2<br />
        !endif<br />
        !undef _TMP<br />
    !macroend<br />
<br />
<br />
## User Defined MAcro<br />
    !macro _DoStuff _Params<br />
        ${MacroParams} &quot;_Param1|_Param2|_Param3&quot; `${_Params}`<br />
        <br />
        DetailPrint &quot;###### Param Test ######&quot;<br />
        DetailPrint &quot;  P1 = ${_Param1}&quot;<br />
        DetailPrint &quot;  P2 = ${_Param2}&quot;<br />
        DetailPrint &quot;  P3 = ${_Param3}&quot;<br />
        DetailPrint &quot;&quot;<br />
        <br />
        ${MacroClean} &quot;_Param1|_Param2|_Param3&quot;<br />
    !macroend<br />
!define DoStuff `!insertmacro _DoStuff`<br />
<br />
## Example<br />
    Section Example<br />
    <br />
        ${DoStuff} &quot;Hello|There|World&quot;<br />
        ${DoStuff} &quot;Hello||World&quot;<br />
        ${DoStuff} &quot;Hello|World&quot;<br />
        ${DoStuff} &quot;Hello World&quot;<br />
        ${DoStuff} &quot;||Hello World&quot;<br />
        <br />
    SectionEnd<br />
<br />
Still more to do but I have to quit for tinkering for awhile.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zinthose</div><div class="date">22nd October 2009, 03:17</div></div><div class="posttext">Aight, enough tinkering for tonight.<br />
<br />
I turned it into an include header and cleaned it up a bit.<br />
<br />
Play around with it and let me know if you have any issues or suggestions.<br />
<br />
MightyMacro.nsh<br />
/* EXAMPLE<br />
	!include MightyMacro.nsh<br />
	<br />
	OutFile MightyMacroDemo.exe<br />
	<br />
	## User Defined Macro Example<br />
		!macro _HelloWorld _Values<br />
			!define _Parameters &quot;_Index|_Param1|_Param2|_Param3&quot;<br />
			${MacroParams} ${_Parameters} `${_Values}`<br />
			<br />
			DetailPrint &quot;###### Param Test ${_Index} ######&quot;<br />
			DetailPrint &quot;  _Values = ${_Values}&quot;<br />
			DetailPrint &quot;  _Param1 = ${_Param1}&quot;<br />
			DetailPrint &quot;  _Param2 = ${_Param2}&quot;<br />
			DetailPrint &quot;  _Param3 = ${_Param3}&quot;<br />
			DetailPrint &quot;&quot;<br />
			<br />
			${MacroClean} ${_Parameters}<br />
			!undef _Parameters<br />
		!macroend<br />
		!define HelloWorld `!insertmacro _HelloWorld`<br />
<br />
	## Execution Example<br />
		Section Example<br />
		<br />
			${HelloWorld} &quot;1|Hello|There|World&quot;<br />
			${HelloWorld} &quot;2|Hello||World&quot;<br />
			${HelloWorld} &quot;3|Hello|World&quot;<br />
			${HelloWorld} &quot;4|Hello World&quot;<br />
			${HelloWorld} &quot;5|||Hello World&quot;<br />
			<br />
		SectionEnd<br />
*/<br />
<br />
!ifndef __MightyMacro__<br />
!define __MightyMacro__<br />
<br />
!ifndef MightyMacroDelimiter<br />
	!define MightyMacroDelimiter &quot;|&quot;<br />
!endif<br />
<br />
## Macro Parameter Helper<br />
    !define MacroParams &quot;!insertmacro _MacroParams&quot;<br />
    !macro _MacroParams _ParamNames _Values<br />
        !searchreplace _TMP `${_ParamNames}` &quot;${MightyMacroDelimiter}&quot; &quot; '${MightyMacroDelimiter}' &quot;<br />
        !searchparse /noerrors `${_Values}` '' ${_TMP}<br />
        !undef _TMP<br />
    !macroend<br />
<br />
## Macro used to undefine trailing parameter names within the _MacroClean Macro<br />
	!macro _MacroClean_<br />
		!if `${_ParamNames}` != &quot;&quot;<br />
			!searchparse /ignorecase /noerrors `${_ParamNames}` '' _TMP &quot;${MightyMacroDelimiter}&quot; _ParamNames<br />
			!ifdef &quot;${_TMP}&quot;<br />
				!undef ${_TMP}<br />
				!undef _TMP<br />
			!endif<br />
		!endif<br />
	!macroend<br />
	<br />
## MacroClean - Use to cleanup the defined parameters temporarily created <br />
    !define MacroClean &quot;!insertmacro _MacroClean&quot;<br />
    !macro _MacroClean _ParamNames<br />
		## Macro used to undefine trailing parameter names<br />
			!define _MacroClean_ &quot;!insertmacro _MacroClean_&quot;<br />
			<br />
		## Undefine Parameter names  [20 parameters &quot;Should&quot; be adiquate<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			${_MacroClean_}<br />
			<br />
			<br />
			<br />
		## One last check, then issue a warning if more paramters are found.<br />
			!if `${_ParamNames}` != &quot;&quot;<br />
				!warning &quot;Parrent macro has more than 20 parameters! This may cause define errors!&quot;<br />
			!endif<br />
			<br />
		## Final Cleanup<br />
			!undef _MacroClean_<br />
			!undef _ParamNames<br />
		<br />
    !macroend<br />
!endif<br />
<br />
Sample Output of Demo<br />
###### Param Test 1 ######<br />
  _Values = 1|Hello|There|World<br />
  _Param1 = Hello<br />
  _Param2 = There<br />
  _Param3 = World<br />
<br />
###### Param Test 2 ######<br />
  _Values = 2|Hello||World<br />
  _Param1 = Hello<br />
  _Param2 = <br />
  _Param3 = World<br />
<br />
###### Param Test 3 ######<br />
  _Values = 3|Hello|World<br />
  _Param1 = Hello<br />
  _Param2 = World<br />
  _Param3 = <br />
<br />
###### Param Test 4 ######<br />
  _Values = 4|Hello World<br />
  _Param1 = Hello World<br />
  _Param2 = <br />
  _Param3 = <br />
<br />
###### Param Test 5 ######<br />
  _Values = 5|||Hello World<br />
  _Param1 = <br />
  _Param2 = <br />
  _Param3 = Hello World<br />
<br />
Completed<br />
<br />
<br />
I also placed this on the Wiki:<br />
http://nsis.sourceforge.net/MightyMacro</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ChocJunkie</div><div class="date">22nd October 2009, 07:34</div></div><div class="posttext">Thanks for your great work! :)<br />
For now, I've solved my problem differntly, so that I will have a detailed look on your solution later.<br />
<br />
Thanks again!! :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>