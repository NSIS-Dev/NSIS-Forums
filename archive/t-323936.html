<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to get FQDN using NSIS Script, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to get FQDN using NSIS Script NSIS Discussion" />
	
	<title> How to get FQDN using NSIS Script [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to get FQDN using NSIS Script</div>
<hr />
<div class="pda"><a href="t-323936.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=323936">How to get FQDN using NSIS Script</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">nsisadmin</div><div class="date">10th November 2010, 14:46</div></div><div class="posttext">Currently we are using &quot;Internet::GetLocalHostIP ${ip_addr}&quot; to get the local host IP and using the IP for registering the application.<br />
 <br />
                    But to handle hosts with multiple NIC card, we are planing to use the FQDN(Fully Qualified Domain Name) instead of the ip address.<br />
 <br />
                    Is there any way to get the FQDN of the localhost using NSI script? Any other known workaround? <br />
 <br />
 - Bhupen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsisadmin</div><div class="date">10th November 2010, 17:42</div></div><div class="posttext">may be we can get the fqdn by appending domain name after hostname. how to get the hostname? any available plugin?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zinthose</div><div class="date">10th November 2010, 17:55</div></div><div class="posttext">I believe you want to use the getnameinfo win32 api call for this.<br />
<br />
http://msdn.microsoft.com/en-us/library/ms738532%28VS.85%29.aspx (http://msdn.microsoft.com/en-us/library/ms738532%28VS.85%29.aspx)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zinthose</div><div class="date">10th November 2010, 20:06</div></div><div class="posttext">... Ignore the Other Zinthose he is a newb..  use this instead.!ifndef GetFQDN<br />
    !ifmacrondef _GetFQDN<br />
        !define GetFQDN &quot;!insertmacro _GetFQDN&quot;<br />
        !macro _GetFQDN _RetVar<br />
            !ifdef __UNINSTALL__<br />
                Call un.GetFQDN<br />
            !else<br />
                Call GetFQDN<br />
            !endif<br />
            !if ${_RetVar} != s<br />
                Pop ${_RetVar}<br />
            !endif<br />
        !macroend<br />
        !ifdef __UNINSTALL__<br />
            !define Uninst_ &quot;un.&quot;<br />
        !else<br />
            !define Uninst_ &quot;&quot;<br />
        !endif<br />
        Function ${Uninst_}GetFQDN<br />
            !undef Uninst_<br />
            ## This Function uses the GetNetworkParams Win32 API function.<br />
            ##    Additional details are available at:<br />
            ##    http://msdn.microsoft.com/en-us/library/aa365968%28VS.85%29.aspx<br />
            ClearErrors<br />
            <br />
            Push $1<br />
            Push $0<br />
            Push $2<br />
            <br />
            ## Get the required buffer size<br />
                System::Call &quot;*(&amp;i4 0)i .r0&quot;<br />
                System::Call 'Iphlpapi::GetNetworkParams(i 0, i r0)i.r1'<br />
                StrCmp $1 111 BufferOkay<br />
                    SetErrors<br />
                    StrCpy $1 &quot;&quot;<br />
                    Goto CleanUp_End<br />
                BufferOkay:<br />
            <br />
            ## Allocate Buffer<br />
                System::Call '*$0(i .r1)'<br />
                System::Alloc $1<br />
                Pop $2<br />
                <br />
            ## Populate Buffer with Data<br />
                System::Call 'Iphlpapi::GetNetworkParams(i $2, *i $1)i.r1'<br />
                StrCmp $1 0 DataOkay<br />
                    SetErrors<br />
                    StrCpy $1 &quot;&quot;<br />
                    Goto CleanUp<br />
                DataOkay:<br />
            <br />
            ## Success, lets build the FQDN from the data<br />
                System::Call '*$2(&amp;t132 .r3,&amp;t132 .r4)'<br />
                StrCpy $1 &quot;$3.$4&quot;<br />
                <br />
            CleanUp:<br />
                System::Free $2<br />
            CleanUp_End:<br />
                System::Free $0<br />
                Pop $2<br />
                Pop $0<br />
                Exch $1<br />
        FunctionEnd<br />
    !endif<br />
!endif<br />
<br />
Section<br />
    ${GetFQDN} $0<br />
    DetailPrint $0<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zinthose</div><div class="date">11th November 2010, 14:05</div></div><div class="posttext">http://nsis.sourceforge.net/Fully_Qualified_Domain_Name</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsisadmin</div><div class="date">15th November 2010, 05:34</div></div><div class="posttext">Thanks Zinthose. The wiki was of great help.<br />
<br />
I need to use few of the IpConfig plugin APIs(like GetHostName, GetPrimaryDNSSuffix, GetAllNetworkAdaptersIDs, GetEnabledNetworkAdaptersIDs, GetNetworkAdapterIPAddresses etc.). But looks like IpConfig plugin is not working properly(I am trying with windows XP). <br />
<br />
Please help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zinthose</div><div class="date">15th November 2010, 22:28</div></div><div class="posttext">Looks like you already found the IPConfig Plugin Forum Topic (http://forums.winamp.com/showthread.php?s=&amp;threadid=307666)<br />
<br />
Listen To MSG he has the answer ;-)<br />
<br />
The dll should be in NSIS\Plugins, not $INSTDIR\plugin.<br />
<br />
Just to clarify that is the NSIS\Plugins dir were you have NSIS installed.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>