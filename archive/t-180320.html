<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Plugin Creation, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Plugin Creation NSIS Discussion" />
	
	<title> Plugin Creation [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Plugin Creation</div>
<hr />
<div class="pda"><a href="t-180320.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=180320">Plugin Creation</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jherrera1976</div><div class="date">17th May 2004, 19:48</div></div><div class="posttext">Hello,<br />
<br />
I'm trying to create a new nsis plugin to check a serial number and return a true or false value, I have made the DLL as a pluging, copied to the plugin dir, the function is being executed, but the parameters passed are not arriving to the dll.<br />
<br />
I'm not using VC++ or even c++, so I guess that I need to access the stack in some other way, but I can't find any info about this.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">18th May 2004, 00:12</div></div><div class="posttext">There is an example of how to create NSIS plugins including functions for accessing the stack in the NSIS distribution, see ExDLL folder.<br />
<br />
If the language you are using is not found there you should still have a look at the functions there and try to convert them to your programming language.<br />
<br />
Vytautas ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">18th May 2004, 16:14</div></div><div class="posttext">What language are you working on? Did you try using system plugin for this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">19th May 2004, 03:44</div></div><div class="posttext">Lobo Lunar, System plugin can do much but we (people from forums) don't know every trick inside it. Its readme has information but not as clear as it should be to be totally understood. I think brainsucker HAS to make a new readme for it. This request has been made since System plugin has been created, however he didn't work on it until now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jherrera1976</div><div class="date">20th May 2004, 15:01</div></div><div class="posttext">I'm using a language called Clarion, is a 4gl language. The main problem is how should I access the stack, somebody at the IRC told me to read about System::Store, that's what I should use? And if that is ok, once I have a result on my dll, where do I store that result? On which stack?<br />
<br />
Another question is, I want to use that DLL to validate a Serial Number, If NSIS is using the assembler stack is pretty easy for any programmer to run a debugger on the installer and check for the return value (no matter how complicated is the algorithm for the serial number) and return the correct number, is there any one out there how has solved this in a very secure way?<br />
<br />
Thank you all for your answers</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th May 2004, 19:56</div></div><div class="posttext">As specified in ExDLL.c and ExDLL.h, the fourth and last parameter for the plug-in function, on the stack, is a pointer to the NSIS stack head. The NSIS stack head is a pointer to stack_t structure which is defined in ExDLL.h. Translate that into your programming language and you'll be able to play with the NSIS stack.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jherrera1976</div><div class="date">21st May 2004, 13:27</div></div><div class="posttext">Ok, just one question, I can't fully understand the following structure:<br />
<br />
typedef struct _stack_t {<br />
  struct _stack_t *next;<br />
  char text[1]; // this should be the length of string_size<br />
} stack_t;<br />
<br />
the char part is ok, but I don't know what is the _stack_t, what is *next?<br />
<br />
It is a pointer to something else? It is a pointer to another structure?<br />
<br />
Thank you very much</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st May 2004, 13:32</div></div><div class="posttext">next is a pointer to another stack_t. _stack_t is the name of the structure. See the popstring and pushstring functions for examples of how to use this structure.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jherrera1976</div><div class="date">21st May 2004, 13:33</div></div><div class="posttext">I think I have it know, it is a pointer to the same structure to get the following value, right?<br />
<br />
thx, I will post my code when I finish to everyone else in case is helpfull to others in the same situation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jherrera1976</div><div class="date">21st May 2004, 13:38</div></div><div class="posttext">thx man, your help and the rest of the people here is tremendous, I thougth that our community (clarion news groups) was the only one with helping people ;)<br />
<br />
again, thx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jherrera1976</div><div class="date">24th May 2004, 14:02</div></div><div class="posttext">Well, I have the plugin working now, do you want me to post the use of the stack an all the necessary stuff directly here? Or should I put the files on other places?<br />
<br />
The generated plugin with all the runtimes linked in is, at least 270Kb, I know, it is big but there is no way to make it smaller<br />
<br />
Just le me know what do you want me to do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">24th May 2004, 14:44</div></div><div class="posttext">Well... is a DLL; you can try UPX :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jherrera1976</div><div class="date">24th May 2004, 15:07</div></div><div class="posttext">very good! it is 112kb now, not so small as the ones made with vc++ but... :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">24th May 2004, 22:23</div></div><div class="posttext">You can get rid of Debug stuff, and you can include LIBCTINY.LIB in your project (you can search for it on the net).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>