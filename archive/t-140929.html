<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to 'Quit' from a custom page's leave function!?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to 'Quit' from a custom page's leave function!? NSIS Discussion" />
	
	<title> How to 'Quit' from a custom page's leave function!? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to 'Quit' from a custom page's leave function!?</div>
<hr />
<div class="pda"><a href="t-140929.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=140929">How to 'Quit' from a custom page's leave function!?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">psyke</div><div class="date">3rd July 2003, 03:49</div></div><div class="posttext">Hello,<br />
<br />
I am using the latest nightly snapshot of NSIS and have run into something. I want to kill or 'Quit' an installer from a custom page's leave function.<br />
<br />
However, as far as I can see, the 'Quit' statement when executed from a custom page's leave function does NOT exit the installer. Instead, it behaves as if I had written 'Abort' instead. I.e. it causes the installer to remain on the current page.<br />
<br />
Is this the correct behaviour for the 'Quit' statement in this context? If so, how can I force the installer to exit from a custom page's leave function?<br />
<br />
Thanks in advance. :)<br />
<br />
(BTW to reproduce the issue I am describing you can download the attached modification of Contrib\InstallOptions\test.nsi - only lines 70 and 71 are new, the rest is the original script.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psyke</div><div class="date">3rd July 2003, 03:55</div></div><div class="posttext">Just a sort of mini follow-up...<br />
<br />
Actually what I really want to do is have the custom page's leave function call another function which causes the installer to exit. The problem is exactly as described earlier though, the installer won't quit.<br />
<br />
The leave functio calls the quitting function just fine, but the isntaller doesn't quit and instead just sits on the current page.<br />
<br />
Once again, I've attached a straightforward modification of  Contrib\InstallOptions\test.nsi.<br />
<br />
Thanks again. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">3rd July 2003, 10:45</div></div><div class="posttext">Why not have the leave function set an exit code in a register (or on the stack) then the function that creates the custom page can check to see if the installer should quit?<br />
<br />
Here is a modified version of your script that I hope does what you want.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psyke</div><div class="date">3rd July 2003, 12:32</div></div><div class="posttext">pengyou: Thank you, your suggestion does achieve what I want. :) I will use this approach unless a more direct solution emerges.<br />
<br />
Ideally I would like to be able to use 'Quit' directly (the documentation for the command and the documenatation for page callbacks does not indicate that Quit cannot be used in a custom page's leave function) or something along those lines.<br />
<br />
I find it interesting that 'Quit' behaves as expected when used in a page creation function and then differently in the leave function.<br />
<br />
Thanks again for your suggestion pengyou. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">3rd July 2003, 12:51</div></div><div class="posttext">Glad I was able to help!<br />
<br />
Custom page &quot;leave&quot; functions only appeared a few months ago and are a big improvement. I find them very useful when validating user input, even if there are a few limitations (so far I've not come across anything major).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psyke</div><div class="date">3rd July 2003, 13:29</div></div><div class="posttext">I agree pengyou, NSIS has become so much better over the past few months that it almost cannot be believed. :D<br />
<br />
I've been toying with my installer and I got it to commit suicide... It was a little more complex than I thought though because the Suicide/Quit function is being called from *several* points in the script. So I needed to add some flags to check if it was called from the custom page's leave function, in which case it sets an exit code which is then checked in the custom page's create function. This stuff doesn't happen of course for all other calls to the Suicide/Quit function.<br />
<br />
However, the Suicide/Quit function is *supposed* to be a cleanup function: do some things, then terminate the installer with extreme prejudice - I don't want control to return from the Suicide/Quit function under any circumstances - this is why I added a 'Quit' statement to it on the first place.<br />
<br />
So is it possible to 'Quit' or somehow terminate an installer from a function called from a custom page's leave function? ;) <br />
<br />
(An example of what I'm trying to do is in the attachment to the second post in this thread. The 'Suicide' function *has* to be called from the custom page's leave function, and the 'Suicide' function has to Quit the installer, it cannot return control. :|)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th July 2003, 14:23</div></div><div class="posttext">Quit should work from custom page's leave function. I'll check it out.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psyke</div><div class="date">4th July 2003, 15:10</div></div><div class="posttext">Thank you Kichik, it's nice to know that 'Quit' is supposed quit the installer even from a custom page's leave function.<br />
<br />
I greatly appreciate that you are willing to look into this matter, I can't imagine what the demands on your time must be like.<br />
<br />
Thanks again. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ramon18</div><div class="date">8th July 2003, 11:22</div></div><div class="posttext">Hi,<br />
<br />
This problem is fixed now, check CVS later<br />
<br />
Ramon</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psyke</div><div class="date">9th July 2003, 19:47</div></div><div class="posttext">Thanks Ramon, I got the latest snapshot and it's working great now. :D<br />
<br />
Once again, many thanks. :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>