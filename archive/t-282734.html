<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Repair option in Add/Remove Programs, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Repair option in Add/Remove Programs NSIS Discussion" />
	
	<title> Repair option in Add/Remove Programs [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Repair option in Add/Remove Programs</div>
<hr />
<div class="pda"><a href="t-282734.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=282734">Repair option in Add/Remove Programs</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">inmedius</div><div class="date">6th December 2007, 14:38</div></div><div class="posttext">Hi All,<br />
<br />
I have searched the forums and followed examples from the wiki with no luck. <br />
<br />
I am currently in the process of switching our installers from one Manufacturer to NSIS. One of the features that is used a lot is the option to Repair your installation simply by running the installer again. So for example when the user goes in to Add/Remove Programs and selects the program then selects the addition information there is an option in that dialog to repair the install.<br />
<br />
I have set the registry settings and the path to the location of the extracted installer. <br />
<br />
Any help in getting this working would be much appreciated.<br />
<br />
Thanks<br />
<br />
David</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th December 2007, 23:37</div></div><div class="posttext">Component Manager (http://nsis.sourceforge.net/Component_Manager) should be able to do that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">inmedius</div><div class="date">10th December 2007, 14:45</div></div><div class="posttext">Hi<br />
<br />
Thanks for your reply but this is not quite what I am looking for. <br />
<br />
If you go into the Control Panel and open 'Add/Remove Programs' you get a list of all programs installed on your machine. If you select an item you get an option on the left hand side to see support information. When that box appears there is an option to 'Repair' the product. All this genreally does is, is to run the installer in silent mode and to repair any broken or missing files.<br />
<br />
I don't necessarily need an option in the installer to repair I just need a way of running the installer.<br />
<br />
Thanks again for your help<br />
<br />
David</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th December 2007, 09:25</div></div><div class="posttext">Then all you are looking for is in the documentation:<br />
<br />
http://nsis.sourceforge.net/Docs/AppendixD.html#D.2<br />
<br />
ModifyPath is the string to set.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">inmedius</div><div class="date">11th December 2007, 10:31</div></div><div class="posttext">Hi kichik<br />
<br />
I have set the ModifyPath and the NoRepair option to 0 and still the installer does not launch.<br />
<br />
I have attached my script file, If you could have a look that would be much appreciated. <br />
<br />
Thanks again for your help<br />
<br />
David<br />
<br />
I am using NSIS v2.31</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th December 2007, 11:52</div></div><div class="posttext">I'd guess CopyFiles failed. Use a full path instead of just the installer's name. The working directory depends on the user and you can't trust it to be the installer's directory. The user might also rename the installer.<br />
<br />
Use $EXEPATH instead.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">inmedius</div><div class="date">11th December 2007, 15:03</div></div><div class="posttext">Hi <br />
<br />
I have changed that value now and double checked that the Installer has been copied to the location specified. I have attached a screen shot of what I am trying to achieve. Simply when I press the 'Repair' button I want to launch the installer. <br />
<br />
If I change the NoModify to 0 and NoRepair to 1 I get the Change button appear and the installer loads as expected.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">inmedius</div><div class="date">11th December 2007, 15:12</div></div><div class="posttext">Hi sorry forgot attachment.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th December 2007, 17:26</div></div><div class="posttext">I don't understand from your last post whether you got it working or not.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">inmedius</div><div class="date">12th December 2007, 17:47</div></div><div class="posttext">Sorry if I was un clear, I have not managed to get this working using the 'Repair' button.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th December 2007, 17:55</div></div><div class="posttext">Seems like it's a MSI only feature. Only MSI installers show this button in the information dialog.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">inmedius</div><div class="date">13th December 2007, 09:52</div></div><div class="posttext">OK. This should realy be documented in the documentstion. <br />
<br />
Thanks for all your help much appreciated.<br />
<br />
David</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>