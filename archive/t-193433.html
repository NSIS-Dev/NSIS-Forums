<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to locate path for drv.sys file in NSIS., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to locate path for drv.sys file in NSIS. NSIS Discussion" />
	
	<title> How to locate path for drv.sys file in NSIS. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to locate path for drv.sys file in NSIS.</div>
<hr />
<div class="pda"><a href="t-193433.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=193433">How to locate path for drv.sys file in NSIS.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">VCR</div><div class="date">13th September 2004, 16:38</div></div><div class="posttext">Hi all,<br />
<br />
I need one urgent help.<br />
<br />
I am installing one driver using NSIS installer on the Win-XP system.  My whole installer is working fine, but in the process of installation the system device manager (New Hardware found wizard) asks for 'drv.sys' file location to complete the installation. But before this only the required 'drv.sys' file is made available in &quot;$WINDIR\System32\drivers&quot; folder through the NSIS script.<br />
Can any one suggest me how to set the path in the NSIS script or any alternative solution so that the installer should not ask for the drv.sys file location and pick it automatically from &quot;$WINDIR\System32\drivers&quot; during installation.<br />
Kindly anyone reply.<br />
Thanks in advance.<br />
<br />
Regards<br />
VCR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">13th September 2004, 20:53</div></div><div class="posttext">Did you try IfFileExists?<br />
<br />
Also for the system path try $SYSDIR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th September 2004, 21:07</div></div><div class="posttext">You can set the working directory using SetOutPath. The Archive contains some pages about setting the path (use the one with the System.dll call). But I think you somehow need to register your driver, not set the path variable or the working directory.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VCR</div><div class="date">14th September 2004, 05:09</div></div><div class="posttext">I have already done the SetOutPath &quot;$WINDIR\System32\drivers&quot;, but its not working.<br />
<br />
I am doing the following registry entry: <br />
<br />
............................<br />
WriteRegStr HKLM SOFTWARE\Driver &quot;Install_Directory&quot; &quot;$INSTDIR&quot;<br />
<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Driver&quot; &quot;DisplayName&quot; &quot;MyDrv(1)&quot;<br />
<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Driver&quot; &quot;UninstallString&quot; &quot;$INSTDIR\Driver_Uninst.exe&quot;<br />
<br />
WriteUninstaller &quot;Driver_Uninst.exe&quot;<br />
............................<br />
<br />
Is there any registry entry I am missing... Plz tell if any other entry I have to make, so that the System Device Manager can find the drv.sys file from the &quot;$WINDIR\System32\drivers&quot; directory.<br />
<br />
Waiting for reply.<br />
<br />
Thanks in advance...<br />
<br />
VCR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">14th September 2004, 15:18</div></div><div class="posttext">Did you try:<br />
<br />
SetOutPath &quot;$SYSDIR\drivers&quot;<br />
File &quot;C:\path\of\file\in\your\harddrive\drv.sys&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VCR</div><div class="date">21st September 2004, 14:23</div></div><div class="posttext">Hi all,<br />
<br />
Thanks for your replies.<br />
I tried the above options, but it does not work for me.<br />
I did<br />
SetOutPath &quot;$SYSDIR\drivers&quot;<br />
File &quot;C:\path\of\file\in\your\harddrive\drv.sys&quot;<br />
<br />
But still the windows pops up asking for the file 'drv.sys' under the caption &quot;Files Needed&quot;<br />
It says &quot;The file 'drv.sys' on [Unknown] is needed.<br />
Type the pathwhere the file is located, and then click OK&quot;<br />
Canm anybody tell what the problem is, or is there any NSIS function to solve it or where the problem could be traced.<br />
As I have told the drv.sys file is already been copied to the &quot;$SYSDIR\drivers&quot;.<br />
Please help me in solving this as I need it badly.<br />
<br />
Kind Regards,<br />
VCR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">21st September 2004, 14:52</div></div><div class="posttext">Can you be sure that the driver is in the &quot;driver&quot; folder after NSIS closes?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VCR</div><div class="date">21st September 2004, 15:09</div></div><div class="posttext">Hi,<br />
Yes, after the installation also (exit from NSIS)<br />
the driver file is in the \system32\drivers folder. <br />
In fact I locate the same file(\system32\drivers\drv.sys) when prompted for loaction and installation suceeds.<br />
But still NSIS did not pick it automatically.<br />
<br />
-VCR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">21st September 2004, 15:31</div></div><div class="posttext">huh?<br />
<br />
Yes, after the installation also (exit from NSIS)<br />
the driver file is in the \system32\drivers folder.<br />
<br />
<br />
But still NSIS did not pick it automatically.<br />
<br />
mmm...<br />
Let's try something like this<br />
<br />
section -InstallDriver<br />
SetOutPath &quot;$SYSDIR\drivers&quot;<br />
File &quot;$SYSDIR\drivers\drv.sys&quot;<br />
;RegDLL &quot;$SYSDIR\drivers\drv.sys&quot;<br />
sectionend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Venu</div><div class="date">22nd September 2004, 14:30</div></div><div class="posttext">Hi,<br />
<br />
I tried all the above options, but its not working at all...  Even then the Found new hardware wizard for location the &quot;drv.sys&quot; file is prompted.<br />
<br />
Plz help me out....<br />
<br />
Regards<br />
VCR</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>