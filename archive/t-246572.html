<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Install for All Users, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Install for All Users NSIS Discussion" />
	
	<title> Install for All Users [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Install for All Users</div>
<hr />
<div class="pda"><a href="t-246572.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246572">Install for All Users</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mindwarp</div><div class="date">20th May 2006, 11:03</div></div><div class="posttext">Hi,<br />
<br />
What do I have to do to my script to Install it for all users?<br />
<br />
Also, I've noticed that NSIS writes to the registry HKLM. My program has to write to HKCU.<br />
<br />
I've found that with a limited user account on XP and W2003 my program cannot write to HKLM. However my program can not write to 'Program Files' so I guess the Installer must have special rights?<br />
<br />
Thanks in advance,<br />
<br />
Juls.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">20th May 2006, 12:55</div></div><div class="posttext">See NSIS documentation 4.9.7.6 SetShellVarContext<br />
and feel free to change the script from HKLM to HKCU<br />
according to your needs.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mindwarp</div><div class="date">21st May 2006, 09:08</div></div><div class="posttext">Hi,<br />
<br />
Thanks...<br />
<br />
Which section would SetShellVarContext go in ?<br />
<br />
Also... I've tried my setup on a XP Limited user account and it doesn't have access to 'program Files', what should I do in this scenario?<br />
<br />
Thanks...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">21st May 2006, 12:30</div></div><div class="posttext">Which section would SetShellVarContext go in ?<br />
I could not explain better than NSIS manual. Did you read the documentation carefully?<br />
<br />
Also... I've tried my setup on a XP Limited user account and it doesn't have access to 'program Files', what should I do in this scenario?<br />
This scenario depends on several &quot;your setup&quot; parameters, e.g. if you attempt to start/stop/alter services, or if you mess with drivers, network config, etc etc etc, it is obvious that a limited user has not access, so you should do a check for admin account and inform users that they need admin rights to continue. I'd suggest try to make a simple setup, just to install some files and write InstallDirRegKey and uninstall info under HKCU, run it on guest account and see what happens.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>