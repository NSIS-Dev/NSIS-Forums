<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Add an icon in Finish page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Add an icon in Finish page NSIS Discussion" />
	
	<title> Add an icon in Finish page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Add an icon in Finish page</div>
<hr />
<div class="pda"><a href="t-158627.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=158627">Add an icon in Finish page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">JonCan</div><div class="date">5th December 2003, 11:26</div></div><div class="posttext">Hi everybody!<br />
<br />
I want to add an exclamation icon to the Finish page, and i have 2 questions :<br />
<br />
1. Are there any parameters to select an exclamation icon in the ioSpecial.ini, like MB_ICONEXCLAMATION for messagebox ?<br />
<br />
2. How can i do to implement this icon in the Finish page, but not in the Welcome page, using the custome ioSpecial.ini ? Maybe a possibility to disable/enable or visible/notvisible it..?<br />
<br />
Thank you!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">5th December 2003, 16:25</div></div><div class="posttext">Write to the Finish page INI file in the pre function and set the icon in the show function using the System plug-in and Windows API.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JonCan</div><div class="date">5th December 2003, 20:56</div></div><div class="posttext">Thanks..but I don't really know how to use all that stuff, so i try something else : to let the icon blank for welcome page, and activate the icon by giving it the &quot;text&quot; value of my exclamation icon.<br />
And now i have another problem, i want to change the background color of an element, i try this code, but it doesn't work :<br />
<br />
  !define MUI_SPECIALINI &quot;Welcome_Finish.ini&quot;<br />
  !define MUI_CUSTOMFUNCTION_FINISH_PRE FinishCustom<br />
  ...<br />
  Function FinishCustom<br />
	Pop $R0 <br />
	GetDlgItem $R1 $R0 1203 <br />
	SetBkColor $R1 0x000000 <br />
	Pop $R1 <br />
  FunctionEnd<br />
  ...<br />
<br />
The background of my field 4 is still grey..What's wrong?<br />
Thanks for your help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JonCan</div><div class="date">5th December 2003, 21:35</div></div><div class="posttext">I try this and it's ok! :<br />
<br />
!define MUI_SPECIALINI &quot;Welcome_Finish.ini&quot; <br />
!define MUI_CUSTOMFUNCTION_FINISH_SHOW FinishCustom <br />
... <br />
Function FinishCustom<br />
FindWindow $R0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT <br />
GetDlgItem $R1 $R0 1203<br />
SetBkColor $R1 0xFFFFFFFF<br />
FunctionEnd<br />
... <br />
<br />
:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JonCan</div><div class="date">5th December 2003, 22:14</div></div><div class="posttext">Another probleme...<br />
<br />
I can't modify the INI :<br />
<br />
!define MUI_SPECIALINI &quot;Welcome_Finish.ini&quot; <br />
!define MUI_CUSTOMFUNCTION_FINISH_SHOW FinishCustom <br />
... <br />
Function FinishCustom<br />
!insertmacro MUI_INSTALLOPTIONS_WRITE &quot;Welcome_Finish.ini&quot; &quot;Field 4&quot; &quot;Text&quot; &quot;Hello&quot; ;This doesn't work<br />
FindWindow $R0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT <br />
GetDlgItem $R1 $R0 1203 <br />
SetBkColor $R1 0xFFFFFFFF <br />
FunctionEnd <br />
...<br />
<br />
any idea? thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JonCan</div><div class="date">5th December 2003, 22:49</div></div><div class="posttext">:rolleyes: me again...<br />
<br />
I notice that my special INI file for Welcome and Finish page doesn't work well (the field i've add doesn't appear) when i use the MUI_FINISHPAGE_SHOWREADME<br />
<br />
not easy to be a newbie :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th December 2003, 13:13</div></div><div class="posttext">You've mixed up the callbacks. You should write to the INI in the pre function, not the show function:In the Pre function of the Welcome page and the Finish page, you can write to the InstallOptions INI file of the page (ioSpecial.ini)And to get the HWND of the Welcome/Finish page you use $MUI_HWND in the show function, not the pre function:In the Show function of Welcome page and the Finish page, $MUI_HWND contains the HWND of the inner dialogBoth are said assuming you're using NSIS 2.0 b4 or a later version.<br />
<br />
BTW, Joost was talking about the System plug-in as a method to get the system's exclamation mark instead of a set one you bring with the installer. The System plug-in can call Win32 API functions that can get you this icon. But I think you should first get the basic, with your own icon working and only then, if you want, get the system's exclamation mark.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JonCan</div><div class="date">6th December 2003, 15:02</div></div><div class="posttext">Thanks for you answer, but it sill not working..:(<br />
<br />
Now my code is :<br />
<br />
  !define MUI_SPECIALINI &quot;Welcome_Finish.ini&quot;<br />
  !define MUI_CUSTOMFUNCTION_FINISH_PRE FinishCustomSetText<br />
  !define MUI_CUSTOMFUNCTION_FINISH_SHOW FinishCustomSetColor<br />
...<br />
Function FinishCustomSetText<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;Welcome_Finish.ini&quot; &quot;Field 5&quot; &quot;Text&quot; &quot;Hello&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;Welcome_Finish.ini&quot; &quot;Field 5&quot; &quot;Text&quot;<br />
  MessageBox MB_OK &quot;$R0&quot;<br />
FunctionEnd<br />
<br />
Function FinishCustomSetColor<br />
  FindWindow $R0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
  GetDlgItem $R1 $R0 1203 ;GetDlgItem $R1 $R0 1203<br />
  SetBkColor $R1 0xFFFFFF<br />
  GetDlgItem $R2 $R0 1204 ;GetDlgItem $R2 $R0 1204<br />
  SetBkColor $R2 0xFFFFFF<br />
FunctionEnd<br />
<br />
<br />
The FinishCustomSetColor function is OK. It works. (Notice that $MUI_HWND doesn't work).<br />
But the FinishCustomSetText function doesn't work, it's strange, because my messagebox print me the good value (&quot;Hello&quot;), but my Label element in my Finish page doesn't change, it doesn't print hello, the text value is not modified.<br />
I don't undertsand.<br />
And i have always the same problem when i define the MUI_FINISHPAGE_SHOWREADME value: all my added fields in my ini are not visible.<br />
<br />
Thanks for your help!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th December 2003, 15:17</div></div><div class="posttext">You still need to write to ioSpecial.ini as MUI_SPECIALINI just changes the source. As for $MUI_HWND, it works fine for me and it is the best way to go because under certain circumstances FindWindow will not find the window you expect it to find. It probably isn't working for you because you're using 2.0b3. In 2.0b3 you should use ${MUI_TEMP1}:MUI_CUSTOMFUNCTION_FINISH_SHOW - ${MUI_TEMP1} contains HWND of Finish dialog</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JonCan</div><div class="date">6th December 2003, 15:40</div></div><div class="posttext">Yes! Thanks Kichik! it works!<br />
In fact i don't really know which version i have, my compiler shows<br />
 &quot;NSIS v2.0b4 (CVS) fr&quot; and my NSIS.exe shows &quot;NSIS v2.02 beta 2 fr&quot;... so.. don't know! maybe a mix!<br />
<br />
Last thing : what can I do about the MUI_FINISHPAGE_SHOWREADME problem ? when i define the MUI_FINISHPAGE_SHOWREADME value all the fields i've added in my ini are not visible.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th December 2003, 16:20</div></div><div class="posttext">Mixing up versions is not a good idea... The MUI depends on new features in makensis.exe and so do other parts of the NSIS package. You should get NSIS 2.0b4, read the MUI readme again, update your script according to it (MUI_CUSTOMFUNCTION_FINISH_PRE -&gt; MUI_PAGE_CUSTOMFUNCTION_PRE, MUI_SPECIALINI -&gt; MUI_WELCOMEFINISHPAGE_INI, etc.). The mix up is probably the cause to the trouble with MUI_FINISHPAGE_SHOWREADME.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>