<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" new variables {__YEAR__} {__MONTH__} {__DAY__}, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  new variables {__YEAR__} {__MONTH__} {__DAY__} NSIS Discussion" />
	
	<title> new variables {__YEAR__} {__MONTH__} {__DAY__} [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  new variables {__YEAR__} {__MONTH__} {__DAY__}</div>
<hr />
<div class="pda"><a href="t-195384.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=195384">new variables {__YEAR__} {__MONTH__} {__DAY__}</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">edUT</div><div class="date">2nd October 2004, 17:47</div></div><div class="posttext">I made a custom version of MakeNsis.exe 201 to solve a reversioning problem.<br />
I added 3 predefined variables. <br />
<br />
!define ${PRODUCT_VERSION} &quot;${__YEAR__}.${__MONTH__}.${__DAY__}&quot; <br />
;-&gt; 4.10.02 <br />
<br />
In the script.cpp, 2 modified functions: <br />
<br />
void CEXEBuild::set_date_time_predefines()<br />
{<br />
  time_t etime;<br />
  struct tm * ltime;<br />
  char datebuf[128];<br />
  char timebuf[128];<br />
  char yearbuf[128];<br />
  char monthbuf[128];<br />
  char daybuf[128];<br />
<br />
  time(&amp;etime);<br />
  ltime = localtime(&amp;etime);<br />
#ifdef _WIN32<br />
  SYSTEMTIME stime;<br />
  stime.wYear = ltime-&gt;tm_year+1900;<br />
  stime.wMonth = ltime-&gt;tm_mon + 1;<br />
  stime.wDay = ltime-&gt;tm_mday;<br />
  stime.wHour= ltime-&gt;tm_hour;<br />
  stime.wMinute= ltime-&gt;tm_min;<br />
  stime.wSecond= ltime-&gt;tm_sec;<br />
  stime.wMilliseconds= 0;<br />
  GetDateFormat(LOCALE_USER_DEFAULT, DATE_SHORTDATE, &amp;stime, NULL, datebuf, sizeof(datebuf));<br />
  definedlist.add(&quot;__DATE__&quot;,(char *)datebuf);<br />
  GetTimeFormat(LOCALE_USER_DEFAULT, 0, &amp;stime, NULL, timebuf, sizeof(timebuf));<br />
  definedlist.add(&quot;__TIME__&quot;,(char *)timebuf);<br />
  GetDateFormat(LOCALE_USER_DEFAULT, 0, &amp;stime, &quot;y&quot;, yearbuf, sizeof(yearbuf));<br />
  definedlist.add(&quot;__YEAR__&quot;,(char *)yearbuf);<br />
  GetDateFormat(LOCALE_USER_DEFAULT, 0, &amp;stime, &quot;MM&quot;, monthbuf, sizeof(monthbuf));<br />
  definedlist.add(&quot;__MONTH__&quot;,(char *)monthbuf);<br />
  GetDateFormat(LOCALE_USER_DEFAULT, 0, &amp;stime, &quot;dd&quot;, daybuf, sizeof(daybuf));<br />
  definedlist.add(&quot;__DAY__&quot;,(char *)daybuf);<br />
#else<br />
  my_strftime(datebuf, sizeof(datebuf), &quot;%x&quot;, ltime);<br />
  definedlist.add(&quot;__DATE__&quot;,(char *)datebuf);<br />
  my_strftime(timebuf, sizeof(timebuf), &quot;%X&quot;, ltime);<br />
  definedlist.add(&quot;__TIME__&quot;,(char *)timebuf);<br />
  my_strftime(yearbuf, sizeof(yearbuf), &quot;%y&quot;, ltime);<br />
  definedlist.add(&quot;__YEAR__&quot;,(char *)yearbuf);<br />
  my_strftime(monthbuf, sizeof(monthbuf), &quot;%m&quot;, ltime);<br />
  definedlist.add(&quot;__MONTH__&quot;,(char *)monthbuf);<br />
  my_strftime(daybuf, sizeof(daybuf), &quot;%d&quot;, ltime);<br />
  definedlist.add(&quot;__DAY__&quot;,(char *)daybuf);<br />
#endif<br />
}<br />
<br />
void CEXEBuild::del_date_time_predefines()<br />
{<br />
  definedlist.del(&quot;__DATE__&quot;);<br />
  definedlist.del(&quot;__TIME__&quot;);<br />
  definedlist.del(&quot;__YEAR__&quot;);<br />
  definedlist.del(&quot;__MONTH__&quot;);<br />
  definedlist.del(&quot;__DAY__&quot;);<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">edUT</div><div class="date">2nd October 2004, 22:28</div></div><div class="posttext">i would cool if you can include this in the next release</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">3rd October 2004, 02:42</div></div><div class="posttext">Some times we like &quot;${__YEAR__}.${__MONTH__}.${__DAY__}&quot; but not &quot;${__YEAR__}-${__MONTH__}-${__DAY__}&quot;  it's usefull. Hope include in the next release. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th October 2004, 14:39</div></div><div class="posttext">I think it would be best to make a define switch, or a new command that allows the user to select his own format. That'd also allow to get different times in different places in the script.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>