<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Language selection dialog localization, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Language selection dialog localization NSIS Discussion" />
	
	<title> Language selection dialog localization [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Language selection dialog localization</div>
<hr />
<div class="pda"><a href="t-155832.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=155832">Language selection dialog localization</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">BARRIER</div><div class="date">11th November 2003, 06:47</div></div><div class="posttext">Hello, <br />
<br />
What is the mechanism to have <br />
<br />
MUI_LANGDLL_INFO<br />
MUI_LANGDLL_DISPLAY<br />
<br />
localized ?<br />
<br />
I've tried to put localization strings in french and english nsh files, but got an error (already defined).<br />
<br />
Currently, I use a tricky strcompare  in onInit function to do it...<br />
<br />
Thanks,<br />
<br />
BB</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th November 2003, 16:37</div></div><div class="posttext">Use a LangString (see users manual).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BARRIER</div><div class="date">11th November 2003, 16:51</div></div><div class="posttext">Hello,<br />
<br />
I realize I've not properly explained my question.<br />
<br />
I wanted to know how i can add these entries in language files, to have automatic localization.<br />
<br />
BB</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th November 2003, 17:35</div></div><div class="posttext">You would have to modify System.nsh.<br />
<br />
Why do you want to use localised text when the user has not even selected a language yet?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BARRIER</div><div class="date">11th November 2003, 18:08</div></div><div class="posttext">Hello,<br />
<br />
I simply want the language selection dialog to use the machine language.<br />
<br />
For instance, on a french machine, the language selection dialog will be displayed in french, and the user can then select English to install with the english language.<br />
<br />
Curently, I use this code, which properly works. (only two languages, French and English):<br />
<br />
Function .onInit<br />
  StrCmp $LANGUAGE ${LANG_FRENCH} french english<br />
  french:<br />
    StrCpy $R0 &quot;Choisissez la langue du programme d'installation&quot;<br />
    StrCpy $R1 &quot;Langue d'installation&quot;<br />
    Goto end<br />
  english:<br />
    StrCpy $R0 &quot;Please select the language of the installer&quot;<br />
    StrCpy $R1 &quot;Install language&quot;<br />
  end:<br />
  !Define MUI_LANGDLL_WINDOWTITLE $R1<br />
  !Define MUI_LANGDLL_INFO $R0<br />
  !insertmacro MUI_LANGDLL_DISPLAY<br />
FunctionEnd<br />
<br />
BB</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th November 2003, 18:36</div></div><div class="posttext">This is way easier:<br />
LangString LangDialog_Title ${LANG_ENGLISH}&quot; &quot;Installer Language&quot;<br />
LangString LangDialog_Title ${LANG_FRENCH}&quot; &quot;Langue d'installation&quot;<br />
<br />
LangString LangDialog_Text ${LANG_ENGLISH}&quot; &quot;Please select the installer language.&quot;<br />
LangString LangDialog_Text ${LANG_FRENCH}&quot; &quot;Choisissez la langue du programme d'installation.&quot;<br />
<br />
!define MUI_LANGDLL_WINDOWTITLE &quot;$(LangDialog_Title)&quot;<br />
!define MUI_LANGDLL_INFO &quot;$(LangDialog_Text)&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BARRIER</div><div class="date">11th November 2003, 18:51</div></div><div class="posttext">Hello,<br />
<br />
Thank you.  <br />
<br />
I had already tried this, but put it before the language declarations.<br />
<br />
It works now.<br />
<br />
BB</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BARRIER</div><div class="date">12th November 2003, 07:23</div></div><div class="posttext">Hello,<br />
<br />
After sucessfully localized the title and the text of the  language selection dialog with your active and useful support, it remained to localize the &quot;Cancel&quot; button.<br />
<br />
It needed to make a minor change to LangDLL, but I wanted this change absolutely don't need any change in the parameter chain of LangDLL and, of course, in any other NSIS file (1). <br />
<br />
To do this (2) I added the cancel button text at the end of the MUI_LANGDLL_WINDOWTITLE like this : <br />
&quot;Installer Language|$(^CancelBtn)&quot;<br />
(which is not an innovation as Microsoft uses commonly this character as strings separator).<br />
<br />
In the langdialog procedure, I check the &quot;|&quot; character and, if present, load the remaining text in a g_BtnText variable.<br />
<br />
In the dialogproc procedure, if g_btnText length is not null,  I send the text to the control SetDlgItemText(hwndDlg, IDCANCEL, g_btntext);<br />
<br />
BB<br />
<br />
(1) In fact, there is another change to do, help have to mention the availability of the Cancel button customization !<br />
<br />
(2) In Delphi port of LangDLL. Unfortunately, I dont program in C, but i can give the code to anyone want to report the change in the original c code for the NSIS &quot;non english speaking&quot; community.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">conando</div><div class="date">12th November 2003, 07:50</div></div><div class="posttext">I would vote for having this in the &quot;official&quot; NSIS dist as well! I come from a background of using Wise Installation System on my &quot;9-to-5 job&quot; and it's capable of this as well! (and I used it in all our products)<br />
<br />
Cheers,<br />
-SÃ¶ren<br />
<br />
OT: Btw. while Wise is/was already way better (imho) than InstallShield (because it's installers worked very similar to the NSIS ones) it's great to see that NSIS is even much better than Wise! :-)<br />
And for free! I don't know why Wise &amp; InstallShield keep selling products at all *g* (besides some hm very &quot;obscure&quot;/very big installers in the corporate world where I'm not sure if NSIS could handle them properly - forgive me I'm a newbie ;o)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BARRIER</div><div class="date">12th November 2003, 08:15</div></div><div class="posttext">Hey Conando,<br />
<br />
Just another remark to your message, regarding support, which is usually far better here !<br />
<br />
In the free software community, it is very current to have a developement team answer in less than one hour, a bug fix in less than one day, and a lot workaround from users if the fix is more tricky need more time to implement.<br />
<br />
BB</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">12th November 2003, 11:39</div></div><div class="posttext">Thanks for your comments BARRIER.<br />
<br />
With this modifications it only supports a bit of localization. I think the version is the NSIS distribtion should be updated when there is full support.<br />
<br />
I think the best solution would be displaying texts and button texts in the langauge that is currently selected. <br />
<br />
If you can add an option to send texts for every langauge and let LangDLL change the texts when the selection changes, that would be great.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BARRIER</div><div class="date">12th November 2003, 11:51</div></div><div class="posttext">Hello,<br />
<br />
Effectively, it should be great, but i only program in Delphi. So, if a C developer want translate the code in C to append to the genuine file...<br />
<br />
It also needs to integrate the translated strings in language files to avoid the users to explicitely declare the strings.<br />
<br />
BB</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">12th November 2003, 11:53</div></div><div class="posttext">If someone adds this feature, I'll let the Modern UI support it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BARRIER</div><div class="date">12th November 2003, 12:23</div></div><div class="posttext">Hello Joost,<br />
<br />
As the dialog procedure belongs to a DLL, we are in a totally independant process a<br />
, we have only access to the data passed during the command line and NSIS only pass in the command line ONE language string for the title and ONE language string for the text. <br />
<br />
So, as paradox, it will be quite easy to modify the code in the DLL (process a CBN_SELENDOK WM_COMMAND message), buit we have no different strings to display.<br />
<br />
To do so, it will be needed to adopt the process used to pass the language names and codes to the DLL also for the text parameters,  but it will not be longer compatible with existing scripts, which is probably not acceptable or rewrite a completely new DLL with a callback which is very tricky (and bug prone !) to do and also need a change in the NSIS GUI systeme code.<br />
<br />
It is a limitation due to DLLs and it is also present in otehre installers (IS, Wise, MS).<br />
<br />
BB</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">12th November 2003, 12:57</div></div><div class="posttext">You can modify LangDLL to accept these texts as parameters for every language.<br />
<br />
You don't have to break the current syntax. For example, you can check whether the first parameter (currently the window title) = LANGTEXT and then not get the standard texts but texts for every language.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>