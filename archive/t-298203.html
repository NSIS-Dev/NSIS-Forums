<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Administrative folder appears on Vista, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Administrative folder appears on Vista NSIS Discussion" />
	
	<title> Administrative folder appears on Vista [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Administrative folder appears on Vista</div>
<hr />
<div class="pda"><a href="t-298203.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=298203">Administrative folder appears on Vista</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">TapeWyrm</div><div class="date">4th October 2008, 08:38</div></div><div class="posttext">I'm experiencing a weird issue.  I have 2 installer scripts, and one works perfectly when uninstalling, while the other always makes the Administrative Tools appear in the Start Menu after uninstalling.  It's supposed to be hidden and it's not a permanent thing, it goes away after some time or when I switch users.  The weird thing is that both installers have similar uninstall sections and yet only one produces this behaviour.  I've experienced this on both Vista x86 and x64, but I -think- XP (I have no way to confirm right now) is unaffected.<br />
<br />
Has anyone else run into this?<br />
<br />
Here's the uninstall snippet from the offending script:<br />
<br />
  Delete &quot;$INSTDIR\uninst.exe&quot;<br />
  <br />
  RMDir /r &quot;$SMPROGRAMS\Gorgon\Gorgon Examples&quot;<br />
  RMDir &quot;$SMPROGRAMS\Gorgon&quot;<br />
  <br />
  RMDir /r &quot;$INSTDIR\Resources&quot;<br />
  RMDir /r &quot;$INSTDIR\PlugIns&quot;<br />
  RMDir /r &quot;$INSTDIR\Examples&quot;<br />
  RMDir &quot;$INSTDIR&quot;<br />
<br />
  DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot;<br />
  SetAutoClose true</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th October 2008, 10:48</div></div><div class="posttext">What exactly are you deleting in the registry? Try adding a call to RefreshShellIcons (http://nsis.sourceforge.net/Docs/AppendixE.html#E.1.21) after deleting the shortcuts, it might help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TapeWyrm</div><div class="date">4th October 2008, 18:40</div></div><div class="posttext">The call to RefreshShellIcons worked like a charm.  Thanks.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>