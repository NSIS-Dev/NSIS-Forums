<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Variable $SYSDIR seems not to work, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Variable $SYSDIR seems not to work NSIS Discussion" />
	
	<title> Variable $SYSDIR seems not to work [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Variable $SYSDIR seems not to work</div>
<hr />
<div class="pda"><a href="t-109214.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=109214">Variable $SYSDIR seems not to work</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jaimosky</div><div class="date">10th October 2002, 09:58</div></div><div class="posttext">Hi!<br />
I am quite new with NSIS, I have written a script to install a OCX component in the computer (Windows 2000, SP3).<br />
I want to use the macro UpgradeDLL as follows:<br />
<br />
  Push &quot;$SYSDIR\mscomctl.ocx&quot;<br />
  !define DLL_NAME mscomctl.ocx<br />
  !insertmacro UpgradeDLL<br />
<br />
It seems not to work correctly. I get the following error by compiling<br />
   File: &quot;mscomctl.ocx&quot; -&gt; no files found<br />
   Usage: File (/r filespec [...]|/oname=outfile one_file_only)<br />
   Error in macro UpgradeDLL on macroline 18<br />
<br />
but if instead I used the path hardcoded it works:<br />
<br />
  Push &quot;C:\winnt\system32\mscomctl.ocx&quot;<br />
  !define DLL_NAME &quot;C:\winnt\system32\mscomctl.ocx&quot;<br />
  !insertmacro UpgradeDLL<br />
<br />
I tried to find an answer in the html help files but it doesnÂ´t say anything about fixing this problem.<br />
Thanks for your time.<br />
Jaime.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th October 2002, 12:09</div></div><div class="posttext">You need to define DLL_NAME as the full path to the DLL on your system so NSIS will know how to find it. What you push is the path where it should be installed in the user's machine, which should be $SYSDIR\mscomctl.ocx.<br />
<br />
Push &quot;$SYSDIR\\mscomctl.ocx&quot; <br />
!define DLL_NAME &quot;C:\\winnt\\system32\\mscomctl.ocx&quot; <br />
!insertmacro UpgradeDLL</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jaimosky</div><div class="date">10th October 2002, 12:16</div></div><div class="posttext">Thankyou, it works fine now.<br />
Jaimosky</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>