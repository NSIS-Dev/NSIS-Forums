<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" StartMenu shortcuts, find previous installation/folder, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  StartMenu shortcuts, find previous installation/folder NSIS Discussion" />
	
	<title> StartMenu shortcuts, find previous installation/folder [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  StartMenu shortcuts, find previous installation/folder</div>
<hr />
<div class="pda"><a href="t-306979.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=306979">StartMenu shortcuts, find previous installation/folder</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Perky Jacket</div><div class="date">1st June 2009, 13:39</div></div><div class="posttext">Hello there!<br />
<br />
I know the basics with NSIS and simple setups aren't that problem but now I have to write a little more complex setup so I hope you can help me.<br />
<br />
1. I've included the components page and let the user decide there to install shortcuts. I wrote a sectiongroup called ShortCuts and in this group two sections called &quot;Startmenu&quot; and &quot;Desktop&quot;.<br />
<br />
I want that the page to choose the startmenu folder comes only if the user had checked &quot;Startmenu&quot; before at the components page.<br />
<br />
Is it possible? If yes how do I implant it?<br />
<br />
2. The application (it's an modification for a game) which is going to be installed with my setup needs an already existing folder (the installed game what the modification is for). <br />
<br />
How can I make my setup to search automaticaly the destination folder and if it's not found to let the user search manualy and makes the &quot;next&quot; button only available if it's found?<br />
<br />
3. I want that the setup detect any previous installations of the application. If the same setup runs again after installation it should be give the two options of uninstalling the app or repair the app. If the user runs a newer setup (with a newer version of the app) it should detect the previous version (and show it to the user) and should give the option to patch it (maybe radio buttons or a checkbox) or to abort the installation.<br />
<br />
How can I manage this?<br />
<br />
I know it's just not a short question and maybe there are already answers here in the forum but I don't know which search words fits at best. Tried some but don't find help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st June 2009, 15:06</div></div><div class="posttext">1. You can skip a page by calling Abort in its pre function. Use LogicLib to determine if a section is selected (search for SectionIsSelected).<br />
<br />
2. You should find out if the game has its installation folder stored in the registry somewhere which you can read using ReadRegStr $INSTDIR ...<br />
<br />
3. The NSIS installation has a dialog which has two radio buttons to 'Uninstall' and 'Add/Reinstall components' if the same version of NSIS is being reinstalled or 'Uninstall' and 'Do not uninstall' if a different version of NSIS is being installed. You can look at the nsDialogs code in Examples\makensis.nsi. That is probably a more extensive example than you need but the basic nsDialogs code should be the same.<br />
<br />
To determine if your product is already installed you will have to either store some information in the registry (like under the Uninstall registry) or you simply determine if your install folder already exists (checking the registry would be best). Again you can skip the page by calling Abort.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Perky Jacket</div><div class="date">5th June 2009, 00:00</div></div><div class="posttext">Thanks for the answers. Need a few days to handle with question/answer #3. But you first two answers helped a lot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th June 2009, 12:16</div></div><div class="posttext">In addition to #2 if you do find a suitable registry entry, you can just add InstallDirRegKey to your script as opposed to explicitly setting $INSTDIR.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>