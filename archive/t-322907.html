<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Repeat automatically install of files for INI configured # of times, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Repeat automatically install of files for INI configured # of times NSIS Discussion" />
	
	<title> Repeat automatically install of files for INI configured # of times [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Repeat automatically install of files for INI configured # of times</div>
<hr />
<div class="pda"><a href="t-322907.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322907">Repeat automatically install of files for INI configured # of times</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mabian</div><div class="date">4th October 2010, 13:57</div></div><div class="posttext">Hello,<br />
<br />
this is a tricky thing I've been asked to do, and I don't even know if it's possible in NSIS:<br />
<br />
The installer should ask for an install path, and then install a file under the given folder but with different name suffixes.<br />
<br />
For example, test.exe should become test_a.exe, test_e.exe, ...,  test_z.exe.<br />
<br />
(Actually it's even hader because I must install different group of files, but for simplicity let's suppose one file only, the main problem should be the same)<br />
<br />
Easy till here, now comes the difficult part:<br />
<br />
The &quot;a&quot;, &quot;e&quot;, .. &quot;z&quot; strings should be taken from an ini file which is in the same folder as the setup program, for example containing something like<br />
<br />
<br />
suffix_1=a<br />
suffix_2=e<br />
.<br />
.<br />
suffix_&lt;n&gt;=z<br />
<br />
<br />
The number of copies is not known at NSIS compile time, but is found in the INI file.<br />
<br />
I searched for loop constructs in NSIS but couldn't find any, do you think the above stuff can be done?<br />
<br />
Thank you,<br />
   Mario</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">4th October 2010, 14:05</div></div><div class="posttext">yep.. totally doable..<br />
<br />
I think you'll be well on your way once you've found the loop constructs, so...<br />
http://nsis.sourceforge.net/LogicLib</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mabian</div><div class="date">4th October 2010, 14:13</div></div><div class="posttext">Totally amazing then!<br />
<br />
Indeed, it should be much easier with this library extension.<br />
<br />
Digging....<br />
<br />
Thank you so much,<br />
    Mario</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mabian</div><div class="date">4th October 2010, 15:09</div></div><div class="posttext">Getting even harder now ...<br />
<br />
can I also have a number (and name) of sections (that is, components) dependant on the content of the external ini file?<br />
<br />
It doesn't seem you can declare a dynamic number of sections.<br />
<br />
Any suggestions or details?<br />
<br />
Thanks,<br />
   Mario</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">4th October 2010, 15:53</div></div><div class="posttext">nope - no dynamic section numbering support.. you could, however, add as many as you could possibly foresee, defaulting to blank titles (thus they're hidden) and unselected (/SO), then fill in the titles dynamically (showing those that are needed), and use the section flags bits to see which the users ends up actually selecting.<br />
( see also LogicLib.nsh and Sections.nsh )<br />
<br />
Sections can be accessed numerically, so another Loop would allow you to iterate over them at runtime.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mabian</div><div class="date">5th October 2010, 14:26</div></div><div class="posttext">Thank you very much again!<br />
<br />
I have now defined 30 sections, and can show only the ones used by the ini file. Great.<br />
<br />
Now the problem is that each section should install content dependant on the Section Text (set by SectionSetText within the init handler).<br />
<br />
Is it possible to access the section index text from within the section without knowing the section index itself?<br />
<br />
Thank you,<br />
   Mario</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">5th October 2010, 15:32</div></div><div class="posttext">Given the dynamic allocation, not really (I think).<br />
<br />
However.. I'm not sure why you'd need to?<br />
<br />
Basically, the Sections are functioning just as placeholders so you can show them on the Components page to the user, letting the user check/uncheck sections as needed.<br />
<br />
After that, e.g. in InstFiles, you'd just have a function that...<br />
1. loops over the dynamic sections by index<br />
2. checks if the section is selected<br />
3. gets that section's text<br />
4. decides on the action to take based on that text (presumably)<br />
<br />
Note that unless that action is dynamic as well, I'm not sure you'd need dynamic sections?  I.e. if there are 10 possible sections with corresponding actions to take and you only need to show/hide them based on that ini file, you could just as well hardcode those sections with their actions within them, and only use the SectionSetText and section selection code to hide/unhide / preselect them?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mabian</div><div class="date">5th October 2010, 15:43</div></div><div class="posttext">Actually, all the sections should do the same thing, but the names of the files installed and other operations depend on the section name (taken from the ini file).<br />
<br />
But, if I can inject a that does the loop and calls a custom install function for each named section then I would be done.<br />
<br />
I have searched around, but cannot find a way to inject my function in the standard instfiles page. Do I have to make a custom page replacing the standard instfiles or am I missing something?<br />
Thanks,<br />
   Mario</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mabian</div><div class="date">5th October 2010, 16:08</div></div><div class="posttext">Mmm just found the standard page callbacks, and maybe another method to get the job done...<br />
<br />
- Mario</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">5th October 2010, 17:54</div></div><div class="posttext">ahh okay, understood.<br />
<br />
As for where to place the code - I'd say add...<br />
<br />
Section &quot;-Parse dynamic sections&quot; <br />
[code here]<br />
SectionEnd<br />
<br />
...somewhere - presumably either just before or just after your dynamic sections (order doesn't matter much.. could be right in the middle, really, just isn't logical).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mabian</div><div class="date">6th October 2010, 13:28</div></div><div class="posttext">Again, thanks a lot.<br />
<br />
I can now concentrate on the code for the single section, the skeleton is done and seems to work fairly well.<br />
<br />
This is the first setup I do in NSIS (what a start!), I'm not sure I could do something like this in InnoSetup. NSIS is apparently a bit more hardcore (you have do do more things manually), but this is also the key to get advanced features quicker.<br />
<br />
- Mario</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">6th October 2010, 14:27</div></div><div class="posttext">NSIS is indeed -very- powerful, but also very hands-on.  There's really only two alternatives (besides InnoSetup)..<br />
A. Windows Installer-based installers.. in which case, look to WiX.  Not too particularly powerful but it does let you do things in Microsoft-approved manners, lets your company slap a &quot;Designed for Windows *&quot; sticker on the box (presuming you also qualify for the other rules in that), lets SysAdmins deploy your installer and muck around with it using group policies, etc.  I think its biggest advantage at this time is 64bit interaction support.<br />
B. Writing your own custom installer software.  Not pretty ;)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>