<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Get Return Value of vb-script, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Get Return Value of vb-script NSIS Discussion" />
	
	<title> Get Return Value of vb-script [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Get Return Value of vb-script</div>
<hr />
<div class="pda"><a href="t-319127.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=319127">Get Return Value of vb-script</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MrRichards</div><div class="date">12th May 2010, 15:19</div></div><div class="posttext">Hello,<br />
I wrote an vbs file that contains something like that:<br />
<br />
if (statement)<br />
   Wscript.quit(1) /*error*<br />
else<br />
   Wscript.quit(0) /*no error*<br />
<br />
Now I want to run the script with Nsis:<br />
ExecShell &quot;open&quot; &quot;test.vbs&quot;<br />
<br />
The script is running and when I put a MsgBox before the quits I can see the script itself is running well, but the return value NSIS gets is always 0, though it should be 1 sometimes too.<br />
Is there a way to let my script return an error for NSIS?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th May 2010, 15:42</div></div><div class="posttext">You have to use ExecWait on cscript (ExecWait's optional parameter is to receive an exit code).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jiake</div><div class="date">17th May 2010, 07:05</div></div><div class="posttext">I suggest that you write a REG_DWORD value using VBS at the end of the VBS file according the the returned value, may be 0x00000000 or 0x00000001. After it exit, you can firstly read this value by NSIS, and then delete it.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>