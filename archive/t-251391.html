<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Urgent: Disable Next, Back and Cancel Button issue, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Urgent: Disable Next, Back and Cancel Button issue NSIS Discussion" />
	
	<title> Urgent: Disable Next, Back and Cancel Button issue [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Urgent: Disable Next, Back and Cancel Button issue</div>
<hr />
<div class="pda"><a href="t-251391.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=251391">Urgent: Disable Next, Back and Cancel Button issue</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">baskaran.vishnu</div><div class="date">18th July 2006, 14:22</div></div><div class="posttext">Hi,<br />
<br />
I would like to enquire on the following problem I am facing (the details are a bit long, would appreciate your time reading it);<br />
<br />
I have a custom function that installs MSDE MSSQL database engine for the user. Since the process takes a certain amount of time, I need to disable the 'Next', 'Back' and 'Cancel' buttons during the installation process. <br />
<br />
At the moment, I am using ExecWait to call the Setup.exe which would perform the installation process for MSDE. At the same time, using the ebanner plugin, I would display a banner indicating to the user that MSDE is currently being installed. Once MSDE has been installed, the banner would be removed and user would be directed to the following custom page.  <br />
<br />
Although with the banner on, if user clicks on the 'Next' or 'Cancel' button several times, user would be directed to a few skipped custom pages or a message box will be displayed confirming cancellation of the installation process. This happens once MSDE has been installed.<br />
<br />
To prevent this, I have used one of the examples from previous NSIS forum threads to disable the 'Next', 'Back' and 'Cancel' button during installation. <br />
<br />
The code is something like this;<br />
<br />
/* Disable the Back, Next and Cancel buttons */<br />
   GetDlgItem $R1 $HWNDPARENT 1<br />
   EnableWindow $R1 0<br />
<br />
   GetDlgItem $R2 $HWNDPARENT 2<br />
   EnableWindow $R2 0<br />
<br />
   GetDlgItem $R3 $HWNDPARENT 3<br />
   EnableWindow $R3 0<br />
<br />
Once Installation of MSDE is complete,<br />
<br />
  /* Re-Enable the Back, Next and Cancel buttons (after installation) */<br />
           GetDlgItem $R1 $HWNDPARENT 1<br />
           EnableWindow $R1 1<br />
<br />
           GetDlgItem $R2 $HWNDPARENT 2<br />
           EnableWindow $R2 1<br />
<br />
           GetDlgItem $R3 $HWNDPARENT 3<br />
           EnableWindow $R3 1<br />
FunctionEnd<br />
<br />
<br />
Based on the codes above, during MSDE installation, these 'Next’,’ Back', and 'Cancel' buttons would be grayed out (disable). Once MSDE is installed, these buttons are re-enabled and user would be automatically directed to the following custom page. <br />
<br />
However, during installation of MSDE, even if I click on any of these buttons, I would still get a response after MSDE is installed. This would be a BIG problem for me because if the user clicks on the grayed 'Next' button several times during MSDE installation, he would be skipped a few custom pages after installation of MSDE.<br />
<br />
Is there anyway to really make sure that these 'Next’,’ Back', and 'Cancel' buttons are disabled and even if user clicks on them, there would be no return response after the MSDE installation process?<br />
<br />
Truly grateful for any assistance on this issue.<br />
<br />
Thanks a million!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galil</div><div class="date">18th July 2006, 15:00</div></div><div class="posttext">You could simply use HideWindow/BringToFront to hide the installer window entirely during the process, and show only banner.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">18th July 2006, 15:50</div></div><div class="posttext">You could try the ExecDos plugin with asynchronous execution.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baskaran.vishnu</div><div class="date">24th July 2006, 07:55</div></div><div class="posttext">Hi,<br />
<br />
Thanks Galil and Afrow for your replies.<br />
<br />
Based on the excerpts from Galil;<br />
<br />
&quot;You could simply use HideWindow/BringToFront to hide the installer window entirely during the process, and show only banner.&quot; <br />
<br />
I have tried to Hide the window, invoke the e-banner and then Bring to Front the installer window once the specific process has completed. However, when I hide the window, the Banner gets hidden as well.<br />
<br />
The following is a sample code I have tried applying;<br />
<br />
Function InstallMSDE<br />
<br />
   HideWindow<br />
   ebanner:show /NONUNLOAD /HALIGN=CENTRE /VALIGN=CENTRE /FIT=WIDTH &quot;$PLUGINSDIR\MSDEBanner.gif&quot;<br />
  <br />
  SetOutPath &quot;$TEMP\MSDE&quot;<br />
  ExecWait 'setup.exe /qn INSTANCENAME=&quot;testsvr&quot;' $0<br />
  <br />
  BringToFront<br />
  ebanner:stop<br />
FunctionEnd<br />
<br />
<br />
I have even tried invoking the banner before the HideWindow command, the results are the same, both the banner and the installer window gets hidden. <br />
<br />
I have previously considered using newadvsplash plugin, but the timer must be fixed and with MSDE installation timing not being  consistent, I am not able to use the newadvsplash plugin. The AnimGif plugin did also get my consideration. However, I can't seem to get the plugin to work in my custom page function (It works in Func. OnInit)<br />
<br />
Therefore, I feel at the moment, the e-banner seems ok for me. But based on the problem I highlighted in my initial posting and based on using the HideWindow command as an option, I can't seem to resolve my problem at the moment. <br />
<br />
I have to simulate the ExecDos plugin as suggested by Afrow (I did read the plugin info, I am not sure if this would actually disable the Next,Back or Cancel buttons for good)<br />
<br />
<br />
I would be extremely grateful for any support. Is there a way to Hide the Window using the HideWindow command and at the same time enable display of the e-banner while MSDE is being installed?<br />
<br />
<br />
Thanks again!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baskaran.vishnu</div><div class="date">24th July 2006, 12:44</div></div><div class="posttext">Hi, <br />
<br />
Based from my recent postings regarding this topic, I may have found an alternative to the disabling of the 'Next', 'Back' and 'Cancel' buttons.<br />
<br />
At the moment, When I disable these buttons and perform some process (with a banner displayed indicating a currently ongoing process), users who click on the disabled (grayed out) 'Next', 'Back' or 'Cancel' would have the handles to these buttons saved and executed after the specific process has been executed. Hence, I were to click a disabled 'Next' 3 times, the installer would jump three pages after a specific process is complete, which is a problem here (Refer to my first posting in this topic for a full description).<br />
<br />
A simplified sample example code is as shown below;<br />
<br />
Page custom ShowMSDEPage InstallMSDEPage<br />
<br />
Function ShowMSDEPage<br />
  !insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;MSDEPage&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_SHOW<br />
FunctionEnd<br />
<br />
Function InstallMSDE<br />
  /* Disable the Next Back and Cancel buttons */<br />
  GetDlgItem $R1 $HWNDPARENT 1<br />
  EnableWindow $R1 0<br />
 <br />
  GetDlgItem $R2 $HWNDPARENT 2<br />
  EnableWindow $R2 0<br />
<br />
  GetDlgItem $R3 $HWNDPARENT 3<br />
  EnableWindow $R3 0<br />
<br />
  ebanner:<br />
  SetOutPath &quot;$TEMP/MSDE&quot;<br />
  ExecWait 'setup.exe /qn INSTANCENAME=&quot;TESTSVR&quot;' $0<br />
<br />
FunctionEnd<br />
<br />
From the codes above, during the execution of setup.exe, the Next, Back and Cancel buttons of the custom page is disabled. However, clicking on any of these disabled buttons saves and later executes these handles upon completion of the setup.exe process. <br />
<br />
An alternative to this problem is to add a message box after the operation of setup.exe, indicating a successful MSDE Installation.  In doing this, all the saved 'Next, Back / Cancel' handles are reset and the message box is displayed. Once user clicks OK to the message box, the subsequent custom page automatically loads, without executing the clicked Next, Back or Cancel handle buttons.<br />
<br />
At the moment, having a message box after the execution a specific process prevents the handle of a disabled 'Next, Back or Cancel' buttons of instead being executed in the event user clicks on these disabled buttons.<br />
<br />
I hope this might be helpful to others, though it is not a concrete solution.<br />
<br />
If there are any other possible solutions, I am truly grateful for them.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galil</div><div class="date">24th July 2006, 12:52</div></div><div class="posttext">Well, I used Banner, not EBanner. Sorry to hear it didn't work out. I guess it's called EmbeddedBanner for a reason...<br />
<br />
What about using ShowWindow instead of EnableWindow?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baskaran.vishnu</div><div class="date">24th July 2006, 13:15</div></div><div class="posttext">Hi,<br />
<br />
Thanks for your advice,<br />
<br />
I have tried replacing the EnableWindow command with the ShowWindow command, but the results are still the same.<br />
<br />
On the banner, I am only aware of the EBanner plugin. I have never come accross the Banner plugin or anything of equivalent.<br />
<br />
Is there anyway I could get the Banner plugin or any example on how to use it?<br />
<br />
Thanks very much</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CancerFace</div><div class="date">24th July 2006, 13:25</div></div><div class="posttext">Sure you can, just check in Docs\Banner. It comes with the NSIS distribution<br />
:)<br />
<br />
CF</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baskaran.vishnu</div><div class="date">25th July 2006, 02:32</div></div><div class="posttext">Hi,<br />
<br />
Thanks for the tip on the Docs\Banner.<br />
<br />
Now, if use it with the HideWindow command, the banner remains until MSDE is installed, with the main Installer window hidden. It works good. I will propose this to upper management and get their feedback.<br />
<br />
Thanks again !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Fippy</div><div class="date">14th September 2006, 23:20</div></div><div class="posttext">I can't seem to disable the CANCEL button on a custom page.<br />
In my custom page entry function, I have this:<br />
<br />
!insertmacro MUI_HEADER_TEXT &quot;Firefox Plugin installation&quot; &quot;&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;iFirefox.ini&quot;<br />
GetDlgItem $R1 $HWNDPARENT 1	; disable BACK button<br />
EnableWindow $R1 0<br />
GetDlgItem $R3 $HWNDPARENT 3	; disable CANCEL button<br />
EnableWindow $R3 0<br />
<br />
This greys out the BACK button but not the CANCEL button. Any ideas what I am doing wrong?<br />
<br />
Also, is there any way to physically remove BACK and CANCEL buttons from both Custom and Finish pages? I think things look a lot neater for the user when inactive buttons aren't even shown.<br />
<br />
Thanks!<br />
Fippy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baskaran.vishnu</div><div class="date">15th September 2006, 07:53</div></div><div class="posttext">Hi Fippy,<br />
<br />
<br />
Firstly, to disable the Cancel button, it should be <br />
GetDlgItem $R2 $HWNDPARENT 2 ; disable CANCEL button<br />
EnableWindow $R2 0<br />
<br />
The $HWNDPARENT 3 points to the Back button.<br />
<br />
Secondly, I am not sure if you should use '!insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;iFirefox.ini&quot;' (I've tried to simulate your codes at my site but i won't work)<br />
<br />
Try this instead;<br />
<br />
Inside the Function .onInit, add this line of code;<br />
<br />
Function .onInit<br />
 <br />
!insertmacro MUI_INSTALLOPTIONS_EXTRACT_AS &quot;iFirefox.ini&quot; &quot;FireFoxCustom&quot;<br />
<br />
FunctionEnd<br />
<br />
What the above line of code ('!insertmacro MUI_INSTALLOPTIONS_EXTRACT_AS') does is it attaches a constant  ('FireFoxCustom') to your iFirefox.ini file. <br />
<br />
(Note, the path of 'iFirefox.ini' should be valid, in this condition, i assume its located at the same path of your installer scripts file)<br />
<br />
<br />
Now inside your custom function, use this line of code after the '!insertmacro MUI_HEADER_TEXT' command;<br />
<br />
!insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;FireFoxCustom&quot;<br />
<br />
Do not use the !insertmacro MUI_INSTALLOPTIONS_DISPLAY command. <br />
<br />
Try using your the codes;<br />
GetDlgItem $R2 $HWNDPARENT 2 ; disable CANCEL button<br />
EnableWindow $R2 0<br />
<br />
to disable the Cancel button. Also remember to use the '!insertmacro MUI_INSTALLOPTIONS_SHOW' command at the end of the function to display your custom page.<br />
<br />
Let me know if it works or not.<br />
<br />
Hope the above helps.<br />
<br />
PS: I am not sure nor am I aware of any feature that could physically remove the Next, Back and Cancel buttons from the custom page. Perhaps other members within the NSIS forum community might provide some advice on this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Fippy</div><div class="date">15th September 2006, 14:51</div></div><div class="posttext">Aha, that seems to work now!<br />
<br />
I also had to change my exit function accordingly:<br />
<br />
!insertmacro MUI_INSTALLOPTIONS_READ $0 &quot;iFirefox.ini&quot; &quot;Field 2&quot; &quot;State&quot;<br />
to<br />
!insertmacro MUI_INSTALLOPTIONS_READ $0 &quot;FirefoxCustom&quot; &quot;Field 2&quot; &quot;State&quot;<br />
<br />
I didn't realise that you could refer to the ini files by an alias. Thanks for the help, much appreciated!<br />
<br />
Fippy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">robotmp3</div><div class="date">14th November 2006, 10:32</div></div><div class="posttext">I have similar problem.<br />
<br />
I need start a process and in custom page disable all buttons and show animated gif until my new process runs, then I need to get exit code from this process and enable next button. But I don't understand, how can I do it?<br />
If I start process with ExecWait in EnterPage of custom page, then I can't show my gif, and if I show gif first, then I can't start my process -&gt; only on LeavePage, but if I click next button (but buttons are disabled)<br />
Any ideas?<br />
<br />
Function EnterPage<br />
        InstallOptions::initDialog /NOUNLOAD &quot;$PLUGINSDIR\EnterPage.ini&quot;<br />
	Pop $hwnd<br />
	GetDlgItem $0 $HWNDPARENT 1 ; disable NEXT button<br />
        EnableWindow $0 0<br />
        GetDlgItem $0 $HWNDPARENT 2 ; disable CANCEL button<br />
        EnableWindow $0 0<br />
        GetDlgItem $0 $HWNDPARENT 3 ; disable BACK button<br />
        EnableWindow $0 0<br />
<br />
<br />
	SetOutPath '$PLUGINSDIR'<br />
        File progress.gif<br />
        AnimGif:: play /NOUNLOAD '$PLUGINSDIR\progress.gif'<br />
<br />
        ;probably start process        <br />
        ;if done -&gt; enable buttons<br />
        GetDlgItem $0 $HWNDPARENT 1<br />
        EnableWindow $0 1<br />
	GetDlgItem $0 $HWNDPARENT 2 ; enable CANCEL button<br />
        EnableWindow $0 1<br />
        <br />
        InstallOptions::show  ;???<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">14th November 2006, 11:30</div></div><div class="posttext">Hi robotmp3!<br />
<br />
How about HideWindow and showing one of the Banners while you're ExecWait-ing for the process?<br />
<br />
This might be a solution!<br />
<br />
Have a nice day!<br />
<br />
Cheers<br />
<br />
Bruno</div></div><hr />


<div class="post"><div class="posttop"><div class="username">robotmp3</div><div class="date">14th November 2006, 12:01</div></div><div class="posttext">Hi Bruno,<br />
<br />
A lot of thanks for your answer!<br />
But I don't know, how can I hide my installer (with HideWindow) and at the same time show another window? Can you give me hint?<br />
<br />
Have nice day too :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>