<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" CreateShortcut Bug?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  CreateShortcut Bug? NSIS Discussion" />
	
	<title> CreateShortcut Bug? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  CreateShortcut Bug?</div>
<hr />
<div class="pda"><a href="t-51174.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=51174">CreateShortcut Bug?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">30th May 2001, 04:49</div></div><div class="posttext">Hi,<br />
<br />
Have a look at this code:<br />
<br />
CreateDirectory $SMPROGRAMS\Program<br />
CreateShortcut $SMPROGRAMS\Program\Program.lnk $INSTDIR\PROGRAM.EXE<br />
CreateShortcut &quot;$SMPROGRAMS\Uninstall Program.lnk&quot; $INSTDIR\REMOVE.EXE<br />
<br />
Now, have a look at this code, which puts the icons in the folder containing the installer:<br />
<br />
SetOutPath $SMPROGRAMS\Program<br />
CreateShortcut Program.lnk $INSTDIR\PROGRAM.EXE<br />
CreateShortcut &quot;Uninstall Program.lnk&quot; $INSTDIR\REMOVE.EXE<br />
<br />
Does anyone else think that this code should also work? It definitely seems more efficient and more logical, because it would then work more like the File command. You specify the OutPath, and then not have to specify an absolute path with CreateShortcut.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yazno</div><div class="date">30th May 2001, 06:40</div></div><div class="posttext">hi,<br />
<br />
yeah, you are right, it should, but it doesn't :)<br />
<br />
that would be a lot better to understand (not only for newbies) and it would fit to the logic of the other commands like &quot;File&quot;.<br />
<br />
cu yzo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saivert</div><div class="date">30th May 2001, 09:57</div></div><div class="posttext">I think you guys have missed the point with SetOutPath.<br />
SetOutPath when used together with CreateShortcut sets the Working dircetory for the shortcut since that parameter disappered some versions ago. But you ar absolutely right that It could be used with the filename for the shortcut, reimplementing the Working directory as a parameter again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yazno</div><div class="date">30th May 2001, 10:16</div></div><div class="posttext">hi,<br />
<br />
yeah sure, createshortcut uses the outpath as working dir since version 1.0i, but that is IMHO the wrong logic.<br />
<br />
it should point to the path where the Shortcut has to be created and the working dir should be set with a parameter.<br />
<br />
well, i guess that is a question of taste.<br />
<br />
cu yzo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">30th May 2001, 11:07</div></div><div class="posttext">I wasn't aware of SetOutPath setting the working directory for CreateShortcut.<br />
<br />
But personally, I don't think I'll ever need the working directory to be anything other than $INSTDIR.<br />
<br />
I think NSIS should automatically set the working directory to the folder of the file the shortcut refers to, unless otherwise advised.<br />
<br />
Example:<br />
<br />
CreateShortcut $INSTDIR\PROGRAM.EXE<br />
Sets the working directory to $INSTDIR.<br />
<br />
CreateShortcut C:\WINDOWS\NOTEPAD.EXE<br />
Sets the working directory to C:\WINDOWS.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>