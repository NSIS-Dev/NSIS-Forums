<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Background Image Problems, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Background Image Problems NSIS Discussion" />
	
	<title> Background Image Problems [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Background Image Problems</div>
<hr />
<div class="pda"><a href="t-291816.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291816">Background Image Problems</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">youngbucks</div><div class="date">15th May 2008, 01:58</div></div><div class="posttext">Ok im having a porblem with my installer. The background image script i put into the installer worked for only a short time now when i startup the installer the BImage doesnt show for the license page and directory page,only leading up to the installation page it shows and it worked before. It gives no errors when i compile it so its weird why it wont work, maybe someone can help. Here is the current one im testing:<br />
<br />
XPStyle on<br />
<br />
# !define DEBUG<br />
!macro GetReturnValue<br />
!ifdef DEBUG<br />
	Pop $R9<br />
	StrCmp $R9 success +2<br />
		DetailPrint &quot;Error: $R9&quot;<br />
!endif<br />
!macroend<br />
<br />
Function .onGUIInit<br />
	InitPluginsDir<br />
	File /oname=$PLUGINSDIR\1.bmp &quot;${NSISDIR}\Contrib\Graphics\Wizard\B.bmp&quot;<br />
<br />
!ifdef DEBUG<br />
	BgImage::SetReturn /NOUNLOAD on<br />
!endif<br />
<br />
	BgImage::SetBg /NOUNLOAD /GRADIENT 0<br />
	!insertmacro GetReturnValue<br />
	BgImage::AddImage /NOUNLOAD /FILLSCREEN $PLUGINSDIR\1.bmp <br />
	!insertmacro GetReturnValue<br />
	BgImage::Redraw /NOUNLOAD<br />
	<br />
FunctionEnd<br />
<br />
ShowInstDetails show<br />
<br />
Section<br />
	BgImage::AddImage /NOUNLOAD $PLUGINSDIR\1.bmp <br />
	!insertmacro GetReturnValue<br />
	BgImage::Redraw /NOUNLOAD<br />
SectionEnd<br />
<br />
Function .onGUIEnd<br />
	BgImage::Destroy<br />
FunctionEnd<br />
<br />
<br />
I think i accidentally edited a small part of it once by accident but i look at this i don't see what could be the problem. help please:(<br />
<br />
BTW: Im using nullsoft installer v2.37</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th May 2008, 18:22</div></div><div class="posttext">Script seems fine, but it's not the complete script so I can't tell what else is getting in the way.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">youngbucks</div><div class="date">15th May 2008, 19:55</div></div><div class="posttext">Here is the complete original script of the BImage plugin:<br />
<br />
Name &quot;BgImage.dll test&quot;<br />
<br />
OutFile &quot;BgImage Test.exe&quot;<br />
<br />
XPStyle on<br />
<br />
!define DEBUG<br />
!macro GetReturnValue<br />
!ifdef DEBUG<br />
	Pop $R9<br />
	StrCmp $R9 success +2<br />
		DetailPrint &quot;Error: $R9&quot;<br />
!endif<br />
!macroend<br />
<br />
Function .onGUIInit<br />
	# the plugins dir is automatically deleted when the installer exits<br />
	InitPluginsDir<br />
	# lets extract some bitmaps...<br />
	File /oname=$PLUGINSDIR\1.bmp &quot;${NSISDIR}\Contrib\Graphics\Wizard\llama.bmp&quot;<br />
	File /oname=$PLUGINSDIR\2.bmp &quot;${NSISDIR}\Contrib\Graphics\Checks\modern.bmp&quot;<br />
<br />
!ifdef DEBUG<br />
	# turn return values on if in debug mode<br />
	BgImage::SetReturn /NOUNLOAD on<br />
!endif<br />
<br />
	# set the initial background for images to be drawn on<br />
	# we will use a gradient from drak green to dark red<br />
	BgImage::SetBg /NOUNLOAD /GRADIENT 0 0x80 0 0x80 0 0<br />
	!insertmacro GetReturnValue<br />
	# add an image @ (150,0)<br />
	BgImage::AddImage /NOUNLOAD $PLUGINSDIR\2.bmp 150 0<br />
	!insertmacro GetReturnValue<br />
	# add the same image only transparent (magenta wiped) @ (150,16)<br />
	BgImage::AddImage /NOUNLOAD /TRANSPARENT 255 0 255 $PLUGINSDIR\2.bmp 150 16<br />
	!insertmacro GetReturnValue<br />
	# create the font for the following text<br />
	CreateFont $R0 &quot;Comic Sans MS&quot; 50 700<br />
	# add a blue shadow for the text<br />
	BgImage::AddText /NOUNLOAD &quot;Testing 1... 2... 3...&quot; $R0 0 0 255 48 48 798 198<br />
	!insertmacro GetReturnValue<br />
	# add a green shadow for the text<br />
	BgImage::AddText /NOUNLOAD &quot;Testing 1... 2... 3...&quot; $R0 0 255 0 52 52 802 202<br />
	!insertmacro GetReturnValue<br />
	# add the text<br />
	BgImage::AddText /NOUNLOAD &quot;Testing 1... 2... 3...&quot; $R0 255 0 0 50 50 800 200<br />
	!insertmacro GetReturnValue<br />
	# show our creation to the world!<br />
	BgImage::Redraw /NOUNLOAD<br />
	# Refresh doesn't return any value<br />
	<br />
FunctionEnd<br />
<br />
ShowInstDetails show<br />
<br />
Section<br />
	# play some sounds<br />
	FindFirst $0 $1 $WINDIR\Media\*.wav<br />
	StrCmp $0 &quot;&quot; skipSound<br />
		moreSounds:<br />
		StrCmp $1 &quot;&quot; noMoreSounds<br />
			BgImage::Sound /NOUNLOAD /WAIT $WINDIR\Media\$1<br />
			# Sound doesn't return any value either<br />
			MessageBox MB_YESNO &quot;Another sound?&quot; IDNO noMoreSounds<br />
				FindNext $0 $1<br />
				Goto moreSounds<br />
<br />
	noMoreSounds:<br />
		FindClose $0<br />
	skipSound:<br />
<br />
	# change the background image to Mike, tiled<br />
	BgImage::SetBg /NOUNLOAD /TILED $PLUGINSDIR\1.bmp<br />
	!insertmacro GetReturnValue<br />
	# we have to redraw to reflect the changes<br />
	BgImage::Redraw /NOUNLOAD<br />
<br />
	MessageBox MB_OK &quot;Mike the llama&quot;<br />
<br />
	# clear everything<br />
	BgImage::Clear /NOUNLOAD<br />
	# Clear doesn't return any value<br />
	# set another gradient<br />
	BgImage::SetBg /NOUNLOAD /GRADIENT 0xFF 0xFA 0xBA 0xAA 0xA5 0x65<br />
	!insertmacro GetReturnValue<br />
	# add some text<br />
	BgImage::AddText /NOUNLOAD &quot;A Desert for Mike&quot; $R0 0 0 0 50 50 800 150<br />
	!insertmacro GetReturnValue<br />
	# add mike as an image<br />
	BgImage::AddImage /NOUNLOAD $PLUGINSDIR\1.bmp 50 150<br />
	!insertmacro GetReturnValue<br />
	# again, we have to call redraw to reflect changes<br />
	BgImage::Redraw /NOUNLOAD<br />
SectionEnd<br />
<br />
Function .onGUIEnd<br />
	# Destroy must not have /NOUNLOAD so NSIS will be able to unload<br />
	# and delete BgImage before it exits<br />
	BgImage::Destroy<br />
	# Destroy doesn't return any value<br />
FunctionEnd<br />
<br />
As for the full script for the installer of the program in workign on:<br />
<br />
Name &quot;Cryptonite: Dual Segas&quot;<br />
Caption &quot;Cryptonite: Dual Segas&quot;<br />
Icon &quot;${NSISDIR}\Contrib\Graphics\Icons\nsis1-install.ico&quot;<br />
OutFile &quot;Install.exe&quot;<br />
InstallDir $DESKTOP\Cryptonite<br />
LicenseText &quot;Please read these Terms carefully before accessing or using the software&quot;<br />
LicenseData &quot;TOU.txt&quot;<br />
<br />
Page license<br />
Page directory<br />
Page instfiles<br />
<br />
UninstPage uninstConfirm<br />
UninstPage instfiles<br />
<br />
#Splash Screen<br />
Function .onInit<br />
  SetOutPath $TEMP<br />
  File /oname=spltmp.bmp &quot;my_splash.bmp&quot;<br />
<br />
; optional<br />
; File /oname=spltmp.wav &quot;my_splashshit.wav&quot;<br />
<br />
  advsplash::show 1000 2000 2000 -1 $TEMP\spltmp<br />
<br />
  Pop $0 ; $0 has '1' if the user closed the splash screen early,<br />
         ; '0' if everything closed normally, and '-1' if some error occurred.<br />
<br />
  Delete $TEMP\spltmp.bmp<br />
;  Delete $TEMP\spltmp.wav<br />
<br />
FunctionEnd<br />
<br />
RequestExecutionLevel admin<br />
<br />
;--------------------------------<br />
<br />
#Installation Section Starts Here<br />
<br />
!define MUI_PRODUCT &quot;Cryptonite: Dual Segas&quot;<br />
!define MUI_FILE &quot;savefile&quot;<br />
!define MUI_VERSION &quot;1.0.0&quot;<br />
!define MUI_BRANDINGTEXT &quot;Cryptonite: Dual Segas&quot;<br />
CRCCheck On<br />
<br />
Section &quot;Installation F (required)&quot;<br />
<br />
SetOutPath $INSTDIR<br />
<br />
SectionIn RO<br />
<br />
File Install2.nsi<br />
File Segas.exe<br />
File DXT10.DLL<br />
File Setup.ini<br />
File Av.VDF<br />
<br />
<br />
WriteRegStr HKLM SOFTWARE\NSIS_Cryptonite &quot;Install_Dir&quot; &quot;$INSTDIR&quot;<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Cryptonite&quot; &quot;DisplayName&quot; &quot;Dual Segas&quot;<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Cryptonite&quot; &quot;UninstallString&quot; '&quot;$INSTDIR\uninstall.exe&quot;'<br />
WriteRegStr HKLM SOFTWARE\Cryptonite\Dual Segas &quot;$INSTDIR&quot;<br />
WriteUninstaller &quot;uninstall.exe&quot;<br />
<br />
SectionEnd<br />
<br />
; Uninstaller<br />
<br />
UninstallText &quot;This will uninstall Segas. Hit next to continue.&quot;<br />
UninstallIcon &quot;${NSISDIR}\Contrib\Graphics\Icons\nsis1-uninstall.ico&quot;<br />
<br />
Section &quot;Uninstall&quot;<br />
<br />
  DeleteRegKey HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Cryptonite&quot;<br />
  DeleteRegKey HKLM &quot;SOFTWARE\SOFTWARE\Cryptonite\Dual Segas&quot;<br />
  Delete &quot;$INSTDIR\install2.nsi&quot;<br />
  RMDir /r &quot;$INSTDIR\*.*&quot;<br />
  RMDir &quot;$INSTDIR\&quot;<br />
<br />
  IfFileExists &quot;$INSTDIR&quot; 0 NoErrorMsg<br />
  MessageBox MB_OK &quot;Note: $INSTDIR could not be removed!&quot; IDOK 0 ; skipped if file doesn't exist<br />
  NoErrorMsg:<br />
<br />
<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th May 2008, 21:36</div></div><div class="posttext">That's the original example script which doesn't have a license page or a directory selection page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">youngbucks</div><div class="date">15th May 2008, 21:51</div></div><div class="posttext">Yes thats the original example script but even when i add both license page and directory it does the same thing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th May 2008, 22:28</div></div><div class="posttext">Attach (do not copy &amp; paste) the complete example which fails for you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">youngbucks</div><div class="date">16th May 2008, 00:02</div></div><div class="posttext">Here is my script that i cant get to work. You have to add a image with the name &quot;B&quot;, extension bmp to ${NSISDIR}\Contrib\Graphics\Wizard to get it to compile. The size of the background image i work with is 1280*960 and it only works perfectly without &quot;/FILLSCREEN&quot; when the resolution is 1280*960. When i change the resolution its outve place and when i add &quot;/FILLSCREEN&quot; the screen goes black and it says &quot;Cannot load bitmap&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th May 2008, 11:48</div></div><div class="posttext">/FILLSCREEN is only valid for BgImage::SetBg and not for BgImage::AddImage. In your script, black comes from the BgImage::SetBg call and the error comes from using /FILLSCREEN in the BgImage::AddImage.<br />
<br />
You should attach the script that gives you trouble and the one that's working next time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">youngbucks</div><div class="date">16th May 2008, 17:46</div></div><div class="posttext">Ok ill remember next time and thanks for the help i fixed the problem now :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>