<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installer only works on my machine., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installer only works on my machine. NSIS Discussion" />
	
	<title> Installer only works on my machine. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installer only works on my machine.</div>
<hr />
<div class="pda"><a href="t-324743.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=324743">Installer only works on my machine.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">acid_rain</div><div class="date">9th December 2010, 22:24</div></div><div class="posttext">So, I was writing an installer for a custom Counter-Strike: Source GUI (very simple). The installer works fine on my machine, but doesn't work for anyone else... I mean no one. I can't understand what the problem is. The process shows up in the task-manager, and it's using a TON of resources, but the installer never shows on the desktop. Here's the code..<br />
<br />
;Steam folder finder for dod source....<br />
;It will detect the Vista install path and if not found move to XP... if no luck still will display a message of a manual install<br />
;Next is the Steam folder finder Functions.<br />
;Looking for Vista or XP install path... querying the registry now...<br />
InstallDirRegKey HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\stall\Steam App 300&quot; &quot;InstallLocation&quot;<br />
InstallDirRegKey HKCU &quot;Software\Valve\Steam&quot; &quot;ModInstallPath&quot;<br />
<br />
Function  .onInit<br />
;If Windows Vista is there, read this and go to ok next or not finding Vista go to WinXP next...<br />
ReadRegStr $R0 HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Steam App 300&quot; &quot;InstallLocation&quot;<br />
IfErrors winXP ok<br />
winXP:<br />
;Vista seems not to be there. Will now read a XP registry key and go to ok or noXP next... manual install message...<br />
ReadRegStr $R0 HKCU &quot;Software\Valve\Steam&quot; &quot;ModInstallPath&quot;<br />
IfErrors noXP ok<br />
noXP:<br />
IfErrors notok ok<br />
notok:<br />
;notok means we may have a retail version or a screwed up registry, lets display a huge instruction message for the user to manually install...<br />
MessageBox MB_YESNO|MB_ICONEXCLAMATION &quot;INSTALLER HELP SCREEN: Installer can't automatically find the cstrike folder address. $\r$\rIT'S OK TO CONTINUE... it just means you will have to find it manually... $\r$\r1. Press Yes, then Next... $\r$\r2. Select your options from the Components screen. Press Next... $\r$\r3. Press Browse in the Choose Install Location screen and navigate to the cstrike folder...$\r$\rHere is a sample of a typical cstrike folder address...$\r$\rC:\Program Files\Steam\steamapps\YOUR_EMAIL_ADDRESS\counter-strike source\cstrike $\r$\rRemember... the last folder must be the cstrike folder! See the readme for this same info. $\r$\r4. Press Install ... then Finish in the popup after that. DONE!&quot; IDYES done<br />
Abort<br />
ok:<br />
Loop:<br />
StrLen $R1 $R0<br />
StrCpy $R2 $R0 $R1 -1<br />
StrCpy $R0 $R0 -1<br />
StrCmp &quot;\&quot; $R2 fin loop<br />
fin:<br />
StrCpy $INSTDIR $R0<br />
StrCpy $INSTDIR &quot;$INSTDIR\counter-strike source\cstrike&quot; ;Change this for other mods like... \counter-strike source\cstrike<br />
done:<br />
FunctionEnd<br />
;END of the Steam folder finder Function<br />
; Script generated by the HM NIS Edit Script Wizard.<br />
<br />
; HM NIS Edit Wizard helper defines<br />
!define PRODUCT_NAME &quot;n00bfest.com GUI&quot;<br />
!define PRODUCT_VERSION &quot;1.4&quot;<br />
!define PRODUCT_PUBLISHER &quot;acid_rain&quot;<br />
!define PRODUCT_WEB_SITE &quot;http://www.n00bfest.com&quot;<br />
!define PRODUCT_UNINST_KEY &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}&quot;<br />
!define PRODUCT_UNINST_ROOT_KEY &quot;HKLM&quot;<br />
<br />
; MUI 1.67 compatible ------<br />
!include &quot;MUI.nsh&quot;<br />
<br />
; MUI Settings<br />
!define MUI_ABORTWARNING<br />
!define MUI_ICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico&quot;<br />
!define MUI_UNICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico&quot;<br />
<br />
; Welcome page<br />
!insertmacro MUI_PAGE_WELCOME<br />
; Directory page<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
; Instfiles page<br />
!insertmacro MUI_PAGE_INSTFILES<br />
; Finish page<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
; Uninstaller pages<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
; Language files<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
; MUI end ------<br />
<br />
Name &quot;${PRODUCT_NAME} ${PRODUCT_VERSION}&quot;<br />
OutFile &quot;n00bfest.com GUI v1.4.exe&quot;<br />
InstallDir &quot;$INSTDIR&quot;<br />
ShowInstDetails show<br />
ShowUnInstDetails show<br />
<br />
Section &quot;n00bfest.com GUI 1.4&quot; SEC01<br />
  SetOutPath &quot;$INSTDIR\materials\console&quot;<br />
  SetOverwrite try<br />
  File &quot;materials\console\background01.vtf&quot;<br />
  File &quot;materials\console\background01_widescreen.vtf&quot;<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  File &quot;n00bfest GUI  README.txt&quot;<br />
  File &quot;n00bfest.com GUI CHANGELOG.txt&quot;<br />
  SetOutPath &quot;$INSTDIR\resource&quot;<br />
  File &quot;resource\ClientScheme.res&quot;<br />
  File &quot;resource\GameMenu.res&quot;<br />
  File &quot;resource\gameui_english.txt&quot;<br />
  SetOutPath &quot;$INSTDIR\resource\ui&quot;<br />
  File &quot;resource\ui\BaseChat.res&quot;<br />
  File &quot;resource\ui\ScoreBoard.res&quot;<br />
  File &quot;resource\ui\Teammenu.res&quot;<br />
  SetOutPath &quot;$INSTDIR\scripts&quot;<br />
  File &quot;scripts\hudanimations.txt&quot;<br />
  File &quot;scripts\HudLayout.res&quot;<br />
  File &quot;scripts\kb_act.lst&quot;<br />
  File &quot;scripts\titles.txt&quot;<br />
SectionEnd<br />
<br />
Section -AdditionalIcons<br />
  SetOutPath $INSTDIR<br />
  CreateDirectory &quot;$SMPROGRAMS\n00bfest.com GUI&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\n00bfest.com GUI\Uninstall.lnk&quot; &quot;$INSTDIR\uninst n00bfest GUI.exe&quot;<br />
SectionEnd<br />
<br />
Section -Post<br />
  WriteUninstaller &quot;$INSTDIR\uninst n00bfest GUI.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayName&quot; &quot;$(^Name)&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\uninst n00bfest GUI.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayVersion&quot; &quot;${PRODUCT_VERSION}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;URLInfoAbout&quot; &quot;${PRODUCT_WEB_SITE}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;Publisher&quot; &quot;${PRODUCT_PUBLISHER}&quot;<br />
SectionEnd<br />
<br />
<br />
Function un.onUninstSuccess<br />
  HideWindow<br />
  MessageBox MB_ICONINFORMATION|MB_OK &quot;$(^Name) was successfully removed from your computer.&quot;<br />
FunctionEnd<br />
<br />
Function un.onInit<br />
  MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 &quot;Are you sure you want to completely remove $(^Name) and all of its components?&quot; IDYES +2<br />
  Abort<br />
FunctionEnd<br />
<br />
Section Uninstall<br />
  Delete &quot;$INSTDIR\uninst.exe&quot;<br />
  Delete &quot;$INSTDIR\scripts\titles.txt&quot;<br />
  Delete &quot;$INSTDIR\scripts\kb_act.lst&quot;<br />
  Delete &quot;$INSTDIR\scripts\HudLayout.res&quot;<br />
  Delete &quot;$INSTDIR\scripts\hudanimations.txt&quot;<br />
  Delete &quot;$INSTDIR\resource\ui\Teammenu.res&quot;<br />
  Delete &quot;$INSTDIR\resource\ui\ScoreBoard.res&quot;<br />
  Delete &quot;$INSTDIR\resource\ui\BaseChat.res&quot;<br />
  Delete &quot;$INSTDIR\resource\gameui_english.txt&quot;<br />
  Delete &quot;$INSTDIR\resource\GameMenu.res&quot;<br />
  Delete &quot;$INSTDIR\resource\ClientScheme.res&quot;<br />
  Delete &quot;$INSTDIR\n00bfest.com GUI CHANGELOG.txt&quot;<br />
  Delete &quot;$INSTDIR\n00bfest GUI  README.txt&quot;<br />
  Delete &quot;$INSTDIR\materials\console\background01_widescreen.vtf&quot;<br />
  Delete &quot;$INSTDIR\materials\console\background01.vtf&quot;<br />
<br />
  Delete &quot;$SMPROGRAMS\n00bfest.com GUI\Uninstall.lnk&quot;<br />
<br />
  RMDir &quot;$SMPROGRAMS\n00bfest.com GUI&quot;<br />
  RMDir &quot;$INSTDIR\scripts&quot;<br />
  RMDir &quot;$INSTDIR\resource\ui&quot;<br />
  RMDir &quot;$INSTDIR\resource&quot;<br />
  RMDir &quot;$INSTDIR\materials\console&quot;<br />
  RMDir &quot;$INSTDIR&quot;<br />
<br />
  DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot;<br />
  SetAutoClose true<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">10th December 2010, 05:52</div></div><div class="posttext">Please do not paste huge amounts of code like that. Use pastebin, or an attachment.<br />
<br />
Also, if your installer hangs, it's likely that it's stuck in a loop. And since you have a loop right there in .onInit...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">10th December 2010, 06:43</div></div><div class="posttext">There is problem in your LOOP code:<br />
I put MessageBox right afther the Loop: label and I have nothing in $R1 and $R0 - it is a empty string(s)<br />
<br />
<br />
Loop:<br />
MessageBox MB_OK &quot;$R1 $R0&quot;<br />
<br />
So Modify the code before this Loop: label<br />
<br />
Btw you have InstallDirRegKey specified multiple times - thats wasting a space</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>