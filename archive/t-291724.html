<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Proper DIR for downloaded file, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Proper DIR for downloaded file NSIS Discussion" />
	
	<title> Proper DIR for downloaded file [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Proper DIR for downloaded file</div>
<hr />
<div class="pda"><a href="t-291724.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291724">Proper DIR for downloaded file</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ruk888</div><div class="date">13th May 2008, 01:04</div></div><div class="posttext">Hello, Bit of a noob here, so I apologize in advance for anything stupid I may ask :) <br />
<br />
<br />
I'm using NSIS to create an updater. Basically sends user to a webpage if update is detected.<br />
<br />
I'd like this app to be for all users. I'm installing it to Program Files, but because it downloads a file for comparison,   that file needs to be placed in a directory writable for all users.<br />
<br />
I was going to go with $TEMP, but am not sure if that is the best practice. I also considered having the program create a folder in $APPDATA when run, but that would leave folders/files upon uninstall. <br />
<br />
Also if $TEMP is the proper location, should it be &quot;$TEMP\my.ini or &quot;$TEMP\MyProg\my.ini<br />
<br />
I appreciate any help offered. Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">13th May 2008, 04:47</div></div><div class="posttext">SetShellVarContext all + $APPDATA<br />
<br />
or <br />
<br />
use the accesscontrol plugin to give write access for everyone to the .ini $programfiles</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ruk888</div><div class="date">13th May 2008, 06:08</div></div><div class="posttext">Thanks for the response.<br />
<br />
SetShellVarContext all + $APPDATA is writing to common app data correct? If so, the docs state IE5+ is required. Thats something I may want to avoid.<br />
<br />
Is there something dangerous or a problem with using $TEMP? <br />
<br />
Again, thanks for the help. Its greatly appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">13th May 2008, 06:28</div></div><div class="posttext">$temp is per user, you said writeable for all users</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ruk888</div><div class="date">13th May 2008, 07:17</div></div><div class="posttext">I saw in the Docs &quot;$TEMP The system temporary directory (usually C:\Windows\Temp but detected at runtime).&quot; and thought this was a common area.<br />
<br />
Ok, so I can use common app data to make sure everything is uninstalled but only if IE5+ is present.<br />
<br />
Or I can use $TEMP, or $APPDATA (IE4+ needed to detect $APPDATA) and possibly leave a folder and a file behind on uninstall.<br />
<br />
I'm not keen on making a dir in Program files writable to all users, seems risky.<br />
<br />
Is there some other option I'm overlooking? I don't like the idea of leaving a file behind, but opening a security hole bothers me more.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">13th May 2008, 07:40</div></div><div class="posttext">you don't have to give write access to the whole dir, just the .ini. But why do all users need access to the file you download? Why not just download to $temp, check version and tell the user to upgrade or whatever if needed. Or, download to $temp, extract whatever info you need from that file and save it in the HKLM part of the registry</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ruk888</div><div class="date">13th May 2008, 08:34</div></div><div class="posttext">I think you described what I am doing. Here's the code I'm using.<br />
<br />
InetLoad::load  &quot;http://someserver.com/New_Version.ini&quot; &quot;$TEMP\New_Version.ini&quot;<br />
<br />
ReadINIStr $4 &quot;$EXEDIR\Old_Version.ini&quot; Version version<br />
ReadINIStr $5 &quot;$TEMP\New_Version.ini&quot; Version version<br />
${VersionCompare} $4 $5 $R0<br />
;then do something based on returned value<br />
<br />
I just want to make sure that what I am doing is correct. The only problem is see here is that New_Version.ini will not be uninstalled if the App is removed.<br />
<br />
Again, thanks for your time and patience</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">13th May 2008, 10:29</div></div><div class="posttext">leaving a small text file behind in $temp is not a big deal, but you could put it in $pluginsdir instead and it will get auto deleted, or delete it from $temp after you use ReadInistr</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ruk888</div><div class="date">13th May 2008, 12:47</div></div><div class="posttext">Thanks Anders. The $PLUGINSDIR sounds ideal.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>