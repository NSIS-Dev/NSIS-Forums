<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" 3problems...desktop/finsh/startmenu, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  3problems...desktop/finsh/startmenu NSIS Discussion" />
	
	<title> 3problems...desktop/finsh/startmenu [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  3problems...desktop/finsh/startmenu</div>
<hr />
<div class="pda"><a href="t-209817.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=209817">3problems...desktop/finsh/startmenu</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">aj kwak</div><div class="date">8th March 2005, 10:47</div></div><div class="posttext">Hello,<br />
<br />
I have some question/problems :<br />
<br />
1)In my installer i have a desktop-icon, but i want that the user can choose for a desktop icon or not.<br />
<br />
2)After the installation (so after the MUI_PAGE_FINISH) i have make a messagebox with the option to reboot or not. But i want on the finish page the option reboot or reboot later.<br />
I have set these defines (above !insertmacro MUI_PAGE_FINISH)<br />
<br />
;!define MUI_FINISHPAGE_TEXT_REBOOT &quot;U kunt momenteel... &quot;<br />
<br />
;!define MUI_FINISHPAGE_TEXT_REBOOTNOW &quot;HETSTARTEN&quot;<br />
<br />
;!define MUI_FINISHPAGE_TEXT_REBOOTLATER &quot;LATER HERSTARTEN&quot;<br />
<br />
but i doesn't work.<br />
<br />
3)last problem. The user can choose another name for the name in the startmenu, but after the installation the default is used.<br />
<br />
this is my code i made/used<br />
Var STARTMENU_FOLDER<br />
!insertmacro MUI_PAGE_STARTMENU Application $STARTMENU_FOLDER<br />
<br />
!insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
  CreateShortCut &quot;$STARTMENU.lnk&quot; &quot;$ANOTHER_DIR\:mad: application:mad: \readme.txt&quot;<br />
  CreateDirectory &quot;$SMPROGRAMS\Application&quot;<br />
!insertmacro MUI_STARTMENU_WRITE_END<br />
<br />
:mad:  I know there is the fould, but i couldn't find to make it dynamic... :-(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th March 2005, 14:18</div></div><div class="posttext">1. Either use a Section to create the Shortcut, or add a check-box on finish page...<br />
!define MUI_FINISHPAGE_RUN<br />
!define MUI_FINISHPAGE_RUN_TEXT &quot;Create desktop shortcut?&quot;<br />
!define MUI_FINISHPAGE_RUN_FUNCTION &quot;createShortcut&quot;<br />
<br />
2. You're using the $STARTMENU variable in your CreateShortcut call, but it should be $STARTMENU_FOLDER.<br />
<br />
3. I think you need to set the reboot flag to display the reboot message. Use SetRebootFlag true<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">8th March 2005, 14:19</div></div><div class="posttext">1) How about making a special section, just for this.<br />
2) Wow! Those are the string texts, not actually the instructions, read the docs about the instructions 4.9.11.1 Reboot<br />
3) Ah! see here:<br />
<br />
 CreateShortCut &quot;$STARTMENU.lnk&quot; &quot;$ANOTHER_DIR\ application \readme.txt&quot;<br />
CreateDirectory &quot;$SMPROGRAMS\Application&quot;<br />
<br />
Did you use your Var $STARTMENU_FOLDER</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aj kwak</div><div class="date">9th March 2005, 14:41</div></div><div class="posttext">if i do this :<br />
<br />
Hello,<br />
<br />
I wouldn't work to change the name in the start-menu with the installer...<br />
<br />
this is my code en the way of thinking...<br />
<br />
var STARTMENU_FOLDER<br />
!insertmacro MUI_PAGE_STARTMENU Application <br />
$STARTMENU_FOLDER<br />
<br />
So, i think i must use ${STARTMENU_FOLDER} and then<br />
${STARTMENU_FOLDER} comes brown(=variabele)<br />
(on the net i find maney examples withoud {} with i user version 2.05)<br />
<br />
but then i get this fould :<br />
<br />
warning: unknown variable/constant &quot;{STARTMENU_FOLDER}&quot; detected, ignoring (macro:MUI_FUNCTION_STARTMENUPAGE:8)<br />
Usage: StrCpy $(user_var: output) str [maxlen] [startoffset]<br />
Error in macro MUI_FUNCTION_STARTMENUPAGE on macroline 12<br />
Error in macro MUI_PAGE_STARTMENU on macroline 34<br />
Error in script &quot;D:\stage\deel1\installers\installer8\installer8.nsi&quot; on line 107 -- aborting creation process<br />
<br />
:confused: Someone???</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th March 2005, 15:37</div></div><div class="posttext">No curley braces...<br />
<br />
!define MyDefine &quot;blah&quot; =&gt; ${MyDefine}<br />
Var MyVar =&gt; $MyVar<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Poulpos</div><div class="date">10th March 2005, 16:19</div></div><div class="posttext">Hi !<br />
<br />
Concerning the StartMenu Folder, I'm using this :<br />
<br />
;Define ---------------<br />
!define PRODUCT_NAME &quot;Your Program&quot;<br />
!define PRODUCT_UNINST_ROOT_KEY HKCU<br />
!define PRODUCT_UNINST_KEY &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}&quot;<br />
!define PRODUCT_STARTMENU_REGVAL &quot;NSIS:StartMenuDir&quot;<br />
<br />
; Items from StartUp Menu ---------------<br />
var ICONS_GROUP<br />
!define MUI_STARTMENUPAGE_NODISABLE<br />
!define MUI_STARTMENUPAGE_DEFAULTFOLDER &quot;${PRODUCT_NAME}&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_ROOT &quot;${PRODUCT_UNINST_ROOT_KEY}&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_KEY &quot;${PRODUCT_UNINST_KEY}&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME &quot;${PRODUCT_STARTMENU_REGVAL}&quot;<br />
<br />
; Installer Pages ---------------<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!insertmacro MUI_PAGE_STARTMENU Application $ICONS_GROUP<br />
!insertmacro MUI_PAGE_INSTFILES<br />
<br />
; MUI end of defines ---------------<br />
InstallDirRegKey ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot;<br />
<br />
; Sections with Stuff to install ---------------<br />
Section &quot;Just name it&quot; Blah<br />
  CreateDirectory &quot;$SMPROGRAMS\$ICONS_GROUP&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\$ICONS_GROUP\Your Prog.lnk&quot; &quot;$INSTDIR\Your Prog.exe&quot;<br />
SectionEnd<br />
<br />
Section -Post<br />
  WriteUninstaller &quot;$INSTDIR\Uninstall ${PRODUCT_NAME}.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot; &quot;$INSTDIR\Your Prog.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\Uninstall ${PRODUCT_NAME}.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;InstallLocation&quot; &quot;$INSTDIR&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;${PRODUCT_STARTMENU_REGVAL}&quot; &quot;$ICONS_GROUP&quot;<br />
SectionEnd<br />
<br />
; Uninstaller Section ---------------<br />
Section &quot;un.Uninstall Your Prog&quot; un.Blah<br />
  ReadRegStr $ICONS_GROUP ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;${PRODUCT_STARTMENU_REGVAL}&quot;<br />
  Delete &quot;$INSTDIR\Your prog.exe<br />
  Delete &quot;$SMPROGRAMS\$ICONS_GROUP\Uninstall Your Prog.lnk&quot;<br />
  RMDir &quot;$SMPROGRAMS\$ICONS_GROUP\&quot;<br />
  RMDir &quot;$INSTDIR&quot;<br />
  DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot;<br />
  DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_DIR_REGKEY}&quot;<br />
  DeleteRegKey /ifempty ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_ROOT_REGKEY}&quot;<br />
SectionEnd<br />
<br />
<br />
It gives the advantage to always work, and to use variables, so you just have to change the defines to have it work with any of your applications...<br />
<br />
See you.<br />
Poulpos<br />
poulpos@caramail.com</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>