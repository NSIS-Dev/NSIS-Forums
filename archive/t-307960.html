<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Locking Multiple option sections, or skipping a page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Locking Multiple option sections, or skipping a page NSIS Discussion" />
	
	<title> Locking Multiple option sections, or skipping a page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Locking Multiple option sections, or skipping a page</div>
<hr />
<div class="pda"><a href="t-307960.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=307960">Locking Multiple option sections, or skipping a page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">phungus420</div><div class="date">4th July 2009, 06:39</div></div><div class="posttext">I've finally got my installer to work properly.  But I'm left with a minor issue, that is mostly aesthetic, but I need to fix it.<br />
<br />
When the installer starts there are multiple options, installing the main program, and creating shortcuts.  Now the main install is locked.  But I'd also like to lock the Start Menu shortcut option because even if it is unchecked the Start menu folder selection page still pops up (but it doesn't do anything if unchecked).  How can I lock section2 as well as section1?  All the examples I can find are to lock a single section, which I have done, I would like to lock both.<br />
<br />
Alternatively It'd be just as good (if not better), to have the Start Menu Folder Selection screen just not open up if the user doesn't check the Start Menu shortcut.  Unfortunately I can't figure out, or find any tutorials on how to lock out a macro if a user option is not selected.<br />
<br />
Peace.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">phungus420</div><div class="date">4th July 2009, 07:47</div></div><div class="posttext">Well I tried this:<br />
<br />
  Function onInitDirectoryPage1<br />
    StrCpy $CurrentPage &quot;DirectoryPage1&quot;<br />
    ;Section 1 selected?<br />
    SectionGetFlags ${Section1} $0<br />
    IntOp $R0 $0 &amp; ${SF_SELECTED}<br />
    IntCmp $R0 ${SF_SELECTED} checkRegEntry<br />
      Abort ;skip page<br />
    checkRegEntry:<br />
      StrCmp $INSTDIR &quot;&quot; 0 checkDefaultLocation<br />
        StrCpy $INSTDIR1 &quot;&quot; ;we know nothing<br />
        Return<br />
      checkDefaultLocation:<br />
          StrCpy $INSTDIR1 &quot;$INSTDIR&quot; ;found it!<br />
<br />
      SectionGetFlags ${Section2} $R0 <br />
      IntOp $R0 $R0 &amp; ${SF_SELECTED} <br />
      IntCmp $R0 ${SF_SELECTED} show <br />
 <br />
      Abort <br />
 <br />
      show: <br />
        !insertmacro MUI_PAGE_STARTMENU Application $StartMenuFolder<br />
    FunctionEnd<br />
<br />
And it fails to compile either because:<br />
<br />
1)I leave !insertmacro MUI_PAGE_STARTMENU Application $StartMenuFolder in the beggining list of components.  It complains that it's already defined<br />
2)I remove it from the original list, and it complains because when it gets to the start menu stuff, it can't run the !insertmacro MUI_STARTMENU_WRITE_BEGIN Application part of the code.<br />
<br />
Anyone know how to disable/enable the MUI_STARTMENU_WRITE_BEGIN page based on a section selection?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">phungus420</div><div class="date">4th July 2009, 10:48</div></div><div class="posttext">Figured it out.  Had to create a new custom page so I could have multiple MUI_PAGE_CUSTOMFUNCTION_PRE entries.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>