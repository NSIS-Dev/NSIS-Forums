<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MSSQL Plugin, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MSSQL Plugin NSIS Discussion" />
	
	<title> MSSQL Plugin [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MSSQL Plugin</div>
<hr />
<div class="pda"><a href="t-267710.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267710">MSSQL Plugin</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">13th March 2007, 18:31</div></div><div class="posttext">A new plugin to execute SQL commands, parse results and handle errors. Useful to create SQL devices, backup devices before program installation, check or modify SQL configuration, ...<br />
<br />
http://nsis.sourceforge.net/MSSQL_OLEDB_plug-in<br />
<br />
nsis.sourceforge.net/MSSQL_OLEDB_plug-in</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TheShadowHawk</div><div class="date">21st May 2007, 05:46</div></div><div class="posttext">Looks good. but can updates be accomplished with this?  <br />
<br />
Also when executing MSSQL_OLEDB::SQL_Execute which takes a string query can there be several statements in the string?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TheShadowHawk</div><div class="date">21st May 2007, 06:35</div></div><div class="posttext">I'll answer my own issue. Updates will work as long as you just execute a single query at a time. Putting multiple queries wont work. Silly me forgot that simple principle. :P</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st May 2007, 09:34</div></div><div class="posttext">Very nice :D<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jplatter</div><div class="date">21st May 2007, 19:35</div></div><div class="posttext">Is there any trick to getting the plugin to work with files. I am having trouble making this work:<br />
<br />
MSSQL_OLEDB::SQL_ExecuteScript /NOUNLOAD &quot;$INSTDIR\filename.sql&quot;<br />
<br />
It never completes. I call this after the file is installed to the hard drive so it should exist. I also use File filename.sql command in the beginning of the function. I have tested the sql file using the sqlcmd at the command line and it works without any errors.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">22nd May 2007, 22:45</div></div><div class="posttext">The script must consist of a single SQL statement.<br />
You cannot execute more than a command at a time<br />
The sample script given with the plugin is working correctly?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jplatter</div><div class="date">22nd May 2007, 23:01</div></div><div class="posttext">Ok. So if I understand correctly, when the plugin executes a script file &quot;somefile.sql&quot; there can only be one command in the file?<br />
<br />
I understand that using the Execute command it can only be one, but I thought with the ExecuteScript command the file that is referenced could have more than one command.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">22nd May 2007, 23:10</div></div><div class="posttext">The problem is how to handle multiple result sets.<br />
I whould have to parse the script file, execute the first command and prepare the result set. let the user get the rows of the first result set or handle the error and then execute the second command and so on.<br />
It's just a bit too complex for an installation utility.<br />
I could assume a file with a command per line. but this will limit the length of the single command that can be executed.<br />
But the problem of the multiple result sets will remain.<br />
Regards<br />
  Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th June 2007, 12:49</div></div><div class="posttext">Where did the actual plugin go from that page?<br />
The Zip file only contains an executable.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">is99</div><div class="date">7th June 2007, 12:51</div></div><div class="posttext">Where is the plugin? There is only exe example on that page</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">8th June 2007, 10:00</div></div><div class="posttext">Hi there,<br />
I fixed the zip file. Now it should be ok.<br />
sorry for the inconvenience.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">is99</div><div class="date">8th June 2007, 11:45</div></div><div class="posttext">Thank you very much</div></div><hr />


<div class="post"><div class="posttop"><div class="username">is99</div><div class="date">9th June 2007, 12:56</div></div><div class="posttext">Tell me what if I don't want to use SQL username and password and instead to use Windows securety? What do I need to do in MSSQL_OLEDB::SQL_Logon ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">10th June 2007, 22:42</div></div><div class="posttext">leave username and password blank (empty strings). it will use integrated authentication</div></div><hr />


<div class="post"><div class="posttop"><div class="username">is99</div><div class="date">11th June 2007, 08:09</div></div><div class="posttext">I was trying to logon to SQL 2005 and was not able.<br />
While using SQLCMD I wasable to connect wihout any problem.<br />
<br />
Do you have any idea what can be the problem? Is this plugin suppose to work with SQL 2005? Are there any special things that suppose to be installedon this PC in order for this plugin to work?<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">11th June 2007, 09:36</div></div><div class="posttext">The plugin use SQLOLEDB driver, and has been tested against SQL2000 and SQL2005.<br />
Integrated security logon has been tested against sql2005 and works.<br />
the syntax to use is:<br />
MSSQL_OLEDB::SQL_Logon /NOUNLOAD &quot;$SQLSERVER&quot; &quot;&quot; &quot;&quot;<br />
<br />
You must provide username and password as empty strings (you cannot omit the parameters)<br />
The variable $SQLSERVER is the name of the sql box.<br />
<br />
The SQL OLEDB driver is usually part of the operating system from windows XP and above. The SQL client installs it also and the MDAC package from microsoft does the same.<br />
<br />
Hope this helps</div></div><hr />


<div class="post"><div class="posttop"><div class="username">njpride</div><div class="date">12th June 2007, 10:36</div></div><div class="posttext">First, great! Really useful, thanks for all your effort!<br />
<br />
Now to my issue, if I try to logon to a server at localhost\instanceName it doesn't login however if I try machineName\instanceName it does connect without any problems.<br />
<br />
Any idea how to get around this? Using other tools I can connect via the localhost.<br />
<br />
Thanks<br />
<br />
------<br />
:rolleyes: Seems to have been some interference between keyboard and chair.<br />
<br />
Right way to do it : &quot;(local)\instanceName&quot;<br />
Another way that works but is pointless! Look up the machine name in registry and use that.<br />
<br />
Thanks for being a sounding board :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">12th June 2007, 12:51</div></div><div class="posttext">You can also try 127.0.0.1\instanceName</div></div><hr />


<div class="post"><div class="posttop"><div class="username">foxmt</div><div class="date">24th July 2007, 10:58</div></div><div class="posttext">Hi<br />
<br />
I'm using actually something like this, and it works:<br />
ExecWait &quot;osql -U$SQL_User -P$SQL_Password -S$SQL_Server -d$SQL_DataBase -i$TEMP\sem2400.sql&quot;<br />
<br />
I want to use &quot;MSSQL OLEDB plug-in&quot;, because I like attach method ;). That's greater than my vbs method.<br />
But I don't find how to do this.<br />
<br />
I'm trying this:<br />
<br />
MSSQL_OLEDB::SQL_Logon /NOUNLOAD &quot;$SQL_Server&quot; &quot;$SQL_User&quot; &quot;$SQL_Password&quot;<br />
MSSQL_OLEDB::SQL_Execute /NOUNLOAD &quot;sp_attach_single_file_db [$SQL_DataBase],[$INSTDIR\DATA\Semaphore_Data.MDF]&quot;<br />
(it works)<br />
MSSQL_OLEDB::SQL_Execute /NOUNLOAD &quot;USE $SQL_DataBase&quot;<br />
MSSQL_OLEDB::SQL_ExecuteScript /NOUNLOAD &quot;$TEMP\sem2002.sql&quot;<br />
(it don't works)<br />
<br />
When i'm lauching my nsis excutable, it blocked and crash nsis executable. I think ExecuteScript can only use SQL file ,if &quot;USE DATABASE&quot; is defined under it.<br />
<br />
Do you know something to do with ExecuteScript action?<br />
<br />
Best Regards<br />
<br />
Sorry for my english.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">foxmt</div><div class="date">31st July 2007, 11:06</div></div><div class="posttext">UP pls :confused:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">31st July 2007, 12:41</div></div><div class="posttext">As already mentioned, the SQL script can only contain one query instruction.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">11th September 2007, 10:50</div></div><div class="posttext">New Plugin Version Released (1.4)<br />
Added support for SQL Scripts in Unicode format</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">29th September 2008, 23:28</div></div><div class="posttext">This plugin seems to be able to handle whatever you throw at it in the sql script now (other than GO commands).  Is that the case?  For instance, I did something like this:<br />
<br />
<br />
OutFile TestSQL.exe<br />
<br />
Section &quot;TestSQL&quot;<br />
  detailprint &quot;Log on to SQL server&quot;<br />
  MSSQL_OLEDB::SQL_Logon /NOUNLOAD &quot;machine1&quot; &quot;&quot; &quot;&quot;<br />
  pop $0<br />
  detailprint $0<br />
  pop $0<br />
  detailprint $0<br />
  MSSQL_OLEDB::SQL_Execute /NOUNLOAD &quot;use DB1&quot;<br />
  pop $0<br />
  detailprint $0<br />
  pop $0<br />
  detailprint $0<br />
  MSSQL_OLEDB::SQL_ExecuteScript /NOUNLOAD &quot;Script.SQL&quot;<br />
  pop $0<br />
  detailprint $0<br />
  pop $0<br />
  detailprint $0<br />
  MSSQL_OLEDB::SQL_GetError /NOUNLOAD<br />
  pop $0<br />
  detailprint $0<br />
  pop $0<br />
  detailprint $0<br />
  MSSQL_OLEDB::SQL_Logout<br />
<br />
SectionEnd<br />
<br />
<br />
In Script.SQL, I did something like this:<br />
<br />
<br />
<br />
CREATE TABLE [dbo].[myTable](<br />
	[col1] [int] IDENTITY(1,1) NOT NULL,<br />
	[col2] [int] NOT NULL,<br />
	[col3] [varchar](20) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,<br />
	[col4] [bit] NOT NULL,<br />
	[col5] [varchar](20) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,<br />
	[col6] [bit] NOT NULL,<br />
 CONSTRAINT [PK_myTable] PRIMARY KEY CLUSTERED <br />
(<br />
	[col1] ASC<br />
)WITH (IGNORE_DUP_KEY = OFF) ON [PRIMARY]<br />
) ON [PRIMARY];<br />
<br />
ALTER TABLE [dbo].[myTable]  WITH CHECK ADD  CONSTRAINT [FK_myForeignKey] FOREIGN KEY([col2])<br />
REFERENCES [dbo].[myOtherTable] ([col2]);<br />
<br />
INSERT INTO [dbo].[myTable](<br />
	col2,col3,col4,col6)<br />
SELECT 999,101010,1,0;<br />
<br />
INSERT INTO [dbo].[myTable](<br />
	col2,col3,col4,col6)<br />
SELECT 1000,101010,1,0;<br />
<br />
INSERT INTO [dbo].[myTable](<br />
	col2,col3,col4,col6)<br />
SELECT 888,100000,1,0;<br />
<br />
INSERT INTO [dbo].[myTable](<br />
	col2,col3,col4,col6)<br />
SELECT 889,100000,1,0;<br />
<br />
UPDATE myTable SET col6 = 1 WHERE col3 = 101010;<br />
<br />
UPDATE myTable SET col4 = 0 WHERE col3 = 100000;<br />
<br />
<br />
And everything succeeded.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">1st October 2008, 15:36</div></div><div class="posttext">Anybody?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">9th October 2008, 11:04</div></div><div class="posttext">The script will execute, but you will miss the result sets and/or the errors that will be raised by statements before the last one.<br />
So it is better to have a single statement per file (better control of what happens)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">minghung</div><div class="date">9th February 2009, 06:20</div></div><div class="posttext">Dear sgiusto, <br />
Why the size of script file must be smaller than 60kb ?<br />
Can I modify the default size in source file ?<br />
Thanks.:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">2nd April 2009, 21:57</div></div><div class="posttext">For the ones that asked, I managed to compile the plugin for the Unicode version of NSIS.<br />
I attach a pre-release version, please test it since I do not have any unicode system ad hand.<br />
Scripts are supportet in unicode format only.<br />
Regards<br />
  Stefano<br />
<br />
PS: this version coforms with the new plugin api. No need to use /UNLOAD any more.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">13th April 2009, 13:22</div></div><div class="posttext">Hello,<br />
I just released version 2.0 of the plugin.<br />
<br />
You can find it here:<br />
http://nsis.sourceforge.net/MSSQL_OLEDB_plug-in <br />
<br />
Major improvements are:<br />
* Support for new plugin API (no more need to use /NOUNLOAD switch)<br />
* Unicode version (unicode scripts are handled ONLY by unicode version)<br />
* Unlimited script-file size<br />
<br />
Regards<br />
  Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">frodelan</div><div class="date">11th June 2009, 09:43</div></div><div class="posttext">Hello.<br />
I'm using MSSQL_OLEDB plugin. I do a logon, execute and logout in a page. Everything is working ok. Then I press next, and then back. When I then enter my SQL Page, only a logon is done and then the installer crash. Is there a special task I have to do if I would like to have the back button enabled?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">16th June 2009, 13:33</div></div><div class="posttext">Hello,<br />
upon plugin initilization some static structures are allocated. Pushing the back button may cause the plugin to try to use some structure that is no more in memory (due to logout)<br />
Can you post some example code so I can try it?<br />
regards<br />
  Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nzali</div><div class="date">28th July 2009, 12:19</div></div><div class="posttext">I actually have the same problem. I'm attaching my script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">28th July 2009, 17:30</div></div><div class="posttext">Hello,<br />
I compiled your script (changing only the sql server name and credentials) and everything worked.<br />
Can you explain in more detail the problems you are experiencing?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nzali</div><div class="date">29th July 2009, 07:50</div></div><div class="posttext">Hello,<br />
<br />
The problem is when you've hit the back button after the DB name page. This is what I did...I entered the db name and click next and it works fine...takes me to the components page. But when I go back to the DB page from the components page and enter the DB name again then the installer crashes.<br />
<br />
Why does it crash?<br />
<br />
Also, try entering a DB name that doesn't exist in your server and click next. There'll be a pop-up message. Click 'No' on that pop-up. Try to enter the DB name again and click Next. The installer crashes.<br />
<br />
I hope I've explained clearly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">31st July 2009, 08:31</div></div><div class="posttext">That's a bug.<br />
I am working on that already. I will release a fixed version soon.<br />
The bug is that when you close the connection to the db not all the variables are cleared (but they are released). So when to connect again you will try to use some unallocated memory.<br />
Regards<br />
  Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">1st August 2009, 22:37</div></div><div class="posttext">Plugin version 2.0.1 released.<br />
Fixed the allocation bug.<br />
Fixed documentation too (windows versions compatibility)<br />
Regards<br />
  Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cornhoulio</div><div class="date">6th October 2009, 08:12</div></div><div class="posttext">Hi,<br />
<br />
I installed the plugin and compiled the MSSQL_OLEDBTest.nsi without errors.<br />
If I try the installer on a machine with SQL Server 2000 the installer crashs during logon without any message.<br />
The logon credentials are correct.<br />
I tried it on 3 different machines.<br />
<br />
Do I miss something. <br />
<br />
cornhoulio</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">7th October 2009, 20:54</div></div><div class="posttext">Hello,<br />
what is the size of installer?<br />
are the plugins placed in the tmp directory at execution time?<br />
do you fill in the right values in the dialog asking for server name and credentials?<br />
  Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cornhoulio</div><div class="date">8th October 2009, 11:40</div></div><div class="posttext">Hi Stefano,<br />
<br />
the size of MyApp.exe is 125kb.<br />
I can't see the plugin dll in the temp dir of the installer.<br />
I have to correct my statement. The installer crashes after the screen choose installation location.<br />
My own script crashes during log on.<br />
<br />
cornhoulio</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">8th October 2009, 20:41</div></div><div class="posttext">Try the attached installer, on my pc works fine<br />
Regards<br />
  Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cornhoulio</div><div class="date">9th October 2009, 08:48</div></div><div class="posttext">Hi Stefano,<br />
<br />
your installer works also fine for me.<br />
But I still unable to build my own installer with this plugin.<br />
I am using NSIS 2.35. I copied all files from the plugin zip archive to my NSIS install directory.<br />
What is wrong?<br />
<br />
cornhoulio</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">9th October 2009, 20:08</div></div><div class="posttext">I think you should upgrade to version 2.42 at least, since the plugin is written for the new plugin-api<br />
<br />
Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lodester</div><div class="date">3rd January 2010, 09:48</div></div><div class="posttext">I'm trying to run a simple test of this in a function, it blows up right after login.  <br />
<br />
Running the test nsi in the .zip seems to work fine, so I guess I'm doing something wrong/unexpected. I'm just learning NSIS so that seems pretty likely :)<br />
<br />
Here's what I have in the function<br />
<br />
              MSSQL_OLEDB::SQL_Logon &quot;$sqlsvr&quot; &quot;&quot; ;&quot;$8&quot;<br />
                pop $0<br />
                messagebox MB_OK $0   ; returns 0<br />
                pop $0<br />
                messagebox MB_OK $0   ; returns 'Login Successful'<br />
                MSSQL_OLEDB::SQL_GetError<br />
                Pop $0<br />
                messagebox MB_OK $0   ; returns 0<br />
                Pop $0<br />
                messagebox MB_OK $0   ; returns 'SQL State: 0x00e143d8 - Native: 0 - Message:'<br />
                MSSQL_OLEDB::SQL_Execute &quot;select @@Version&quot;<br />
                Pop $0<br />
                messagebox MB_OK $0<br />
                Pop $0<br />
                messagebox MB_OK $0<br />
                MSSQL_OLEDB::SQL_GetError<br />
                Pop $0<br />
                messagebox MB_OK $0<br />
                Pop $0<br />
                messagebox MB_OK $0<br />
                MSSQL_OLEDB::SQL_GetRow<br />
                Pop $0<br />
                messagebox MB_OK $0<br />
                Pop $0<br />
                messagebox MB_OK $0<br />
                MSSQL_OLEDB::SQL_GetError<br />
                Pop $0<br />
                messagebox MB_OK $0<br />
                Pop $0<br />
                messagebox MB_OK $0<br />
                MSSQL_OLEDB::SQL_Logout [B]<br />
<br />
The installer crashes after the MB_OK click with the SQL State: error.<br />
<br />
Unhandled exception at 0x00b41be4 in Mongoose.exe: 0xC0000005: Access violation reading location 0x00000000.<br />
<br />
The debug break pointer is on MSSQL_OLEDB.dll:<br />
00B41BE4  mov         eax,dword ptr [ebp] <br />
<br />
This happens consistently whether I'm executing a sql file or just a command. SQLOLEDB works fine, and i see nothing in a trace to indicate a problem with SQL. Nothing suspicious in the event logs otherwise.<br />
<br />
I tried redirecting the last popped $0 back to a label, but no dice.<br />
<br />
running under:<br />
Windows 2003 SP2, SQL 2005 SP3.<br />
NSIS version 2.46<br />
<br />
If anyone has any other ideas for SQL providers in NSIS I'd be greatful; i have an install proejct that needs to use a ton of it.<br />
<br />
Thanks in advance for any help.<br />
<br />
Update: Adding /NOUNLOAD to all of the MSSQL_OLEDB calls seemes to have resolved the issue.<br />
I thought /NOUNLOAD wasn't needed anymore?<br />
In any case, its working but if anyone has any other ideas or tips for using NSIS with SQL I'd love to hear them.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">3rd January 2010, 21:10</div></div><div class="posttext">Are you using latest version (2.0.1) of the plugin?<br />
It seems you are using an older version, please check file version of MSSQL_OLEDB.DLL in $PROGRAMFILES\nsis\plugins folder.<br />
I use the plugin for a lot of stuff related to sql server and have no problems.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lodester</div><div class="date">4th January 2010, 02:40</div></div><div class="posttext">It appears that was my problem, or at least partially<br />
<br />
The version of MSSQL_OLDEB in Mssql_oledb2.zip on the wiki is 2.0.0 (Aug 1 2009), you mentioned 2.0.1 ? <br />
Where do i get that version? <br />
<br />
Also, you might consider taking the old .zip off the wiki or making the distinction between the all-caps MSSQL_OLEDB.zip (version 1.4.0) and Mssql_oledb2.zip (2.0.0) more clear.<br />
<br />
It's stuff like this that makes me want to run back in to the cold, uncaring arms of InstallShield......okay not really, but this wiki-and-forum based mess is pretty horrific. <br />
<br />
Finding a plugin [that works] is hard enough, finding the right file in the right thread instead of the barely distinguishable files attached all over the wiki (some have multiple wiki pages with multiple versions of files!!) is a train wreck. Get what you pay for i guess? <br />
<br />
Sorry for ranting. I do very much appreciate your work, sgiusto. Cheers to you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">4th January 2010, 10:54</div></div><div class="posttext">Thank you for ranting!<br />
I updated the plugin page. Now the download section should be easier to understand.<br />
The dll in the zip file is version 2.0.1. I updated only the 'product version' field in the resource file and not the 'file version' field. <br />
Please check if 'product version' is 2.0.1.<br />
I will fix this in a future release.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dgrinberg</div><div class="date">8th February 2010, 02:54</div></div><div class="posttext">I really like the MSSQL_OLEDB plugin, I use it to build the application DB from SQL scripts.<br />
<br />
However my application is quite large and has heaps of stored procedures. I dont really want to put each stored proc in its own file - it's too much of a maintenance overhead.<br />
<br />
What I have dont instead is: <br />
1. get NSIS to open the file<br />
2. iterate through the file line by line, creating an SQL string<br />
3. When the loop hits a &quot;GO&quot;, run the script then continue iterating<br />
<br />
See here for an example:<br />
http://ontheperiphery.veraida.com/content/nsis-mssqloledb-running-sql-script-file-multiple-commands<br />
<br />
This seems to have worked quite well for me.  I dont know if this is the preferred method, but as a few people has asked about it I thought I's share!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">9th February 2010, 20:42</div></div><div class="posttext">I use similar approach.<br />
I store each long statement in a separate file, then I parse a text file like this:<br />
X &lt;path to script to execute&gt;<br />
I &lt;short sql statement to be executed&gt;<br />
X &lt;path to other script&gt;<br />
I &lt;sql command&gt;<br />
I &lt;sql command&gt;<br />
....<br />
<br />
<br />
Each version of the application has its own text file with scripts specific to that version:<br />
20091012.txt<br />
20100101.txt<br />
and so on.<br />
<br />
So a fresh installation will execute all the scripts, an update will execute scripts from previous version up to current.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mongi</div><div class="date">11th February 2010, 15:00</div></div><div class="posttext">Hello.<br />
<br />
Did anybody try to run this plugin using Unicode build of nsis? I've tried to make it work for 2 days but failed due to installer crush on ExecuteScript function. All other functions work almost well, but when I call &quot;ExecuteScript&quot; I just get AV exception.<br />
<br />
The same project runs perfectly under ANSI build.<br />
<br />
It's good that source code is included, but not all files are present, so I couldn't fix this bug:<br />
You're allocating memory:<br />
line 356:  Command=(TCHAR *)HeapAlloc(heap,0,fileLen+1);<br />
and then you insert last '\0'<br />
line 376:  Command[pos]=_T('\0');<br />
but in Unicode it inserts 2(!) chars and you run out of borders of &quot;fileLen+1&quot;. The best practice is to allocate +10 bytes(or to use +sizeof(TCHAR)) to avoid such &quot;bugs&quot;.<br />
<br />
Sample installer fails also.<br />
<br />
P.S. Why you are so stingy when allocating<br />
line 208: TCHAR command[1024];<br />
for SQL query? 1024 is not enough for good script of procedure creation. Why it's not mentioned in wiki about this hidden restriction which causes 100% AV on large queries?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">11th February 2010, 20:33</div></div><div class="posttext">Hello,<br />
I will check and correct this issue, when I checked the test installer in unicode I didn't got any error...<br />
I will add the 1024 limit to the documentation. If you need longer commands I suggest to use ExecuteScript (if it works... :D )<br />
I provide the whole source code with the plugin. The files you are missing are prolly part of nsis sources.<br />
<br />
Regards<br />
  Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mongi</div><div class="date">11th February 2010, 21:12</div></div><div class="posttext">Thanks for fast reply. <br />
<br />
This kind of errors may happen and may not depending on variety of conditions, starting from complier and ending up with irregular sun activity. ;) <br />
I use this config:<br />
NSIS v.2.45.1-Unicode<br />
UMSSQL_OLEDB 2.0.1.0 <br />
Testing on Windows 7 and Windows Server 2003Moreover, on Win2k3 installer had three types of behavior:<br />
1) autoclose on error without any messages (~80%)<br />
2) proposal to start debagger(~19%)<br />
3) &quot;as supposed to run&quot; (~1%, 1 or 2 lucky cases)<br />
If you need longer commands I suggest to use ExecuteScriptI tried to, but failed. I began a search for solution towards &quot;Execute&quot; and was very disappointed, when it couldn't stand my 16KB SQL script :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chivalri</div><div class="date">10th May 2010, 19:45</div></div><div class="posttext">I have been using this plug in for two years and have been very pleased with the results.  My installer setups up our customer with SQL 2005 Express and then loads the database. <br />
<br />
Recently, more of our customers have started using SQL 2008 Express.  I have also decided that as most of our customers are now using Server 2008 and Windows 7, I need to switch to installing SQL 2008 Express as 2005 generates Known Comparability messages that in turn create tech support calls.<br />
<br />
I have run into a problem with this plug in when trying to access a SQL 2008 Express server.  It fails with this message.<br />
<br />
Could not connect to SQL Server : SQL State: 0x80004005 - Native: 0 - Message: [DBNETLIB][ConnectionOpen (Invalid Instance()).]Invalid connection.<br />
<br />
The same code works fine with SQL 2005 and MSDE. <br />
<br />
Has anyone else been having this issue?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">10th May 2010, 21:00</div></div><div class="posttext">Hello,<br />
I ran the example given with the plugin against a windows 7 ultimate 64bit with SQL 2008 express using SQL security and got no problems.<br />
<br />
I am using the plugin to deploy my application with sql2008 without problems.<br />
<br />
From the error code you posted it seems you have some kind of problem with a named instance.<br />
Hope this helps<br />
  Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jck77</div><div class="date">27th May 2010, 19:02</div></div><div class="posttext">Hello, I tried it with a SQLServer 2008 (default instance) and was not able to connect to SQLServer. (No problem with SQLServer 2005 upgraded to 2008...)<br />
Does any body have the same problem? Does anybody know how to workaround or if a fix is needed in the plugin? (Or if I'm missing any special configuration of the plugin needed for SQLServer 2008...)<br />
<br />
Many thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">28th May 2010, 20:37</div></div><div class="posttext">Hello,<br />
what error code is returned upon failure?<br />
please read my previous post. I use sql 2008 without any problem.<br />
Regards<br />
  Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">swordd</div><div class="date">19th February 2011, 13:18</div></div><div class="posttext">Hello there,<br />
<br />
i use your plugin in my installer and most of the time it works really great.<br />
Thanks for your great work!<br />
<br />
My installer installs a local MS SQL Server 2008 Express R2 during setup.<br />
Later in the installation process i use your plugin to do a connection test<br />
against the (already restarted and fully running) DB using named pipes. <br />
<br />
MSSQL_OLEDB::SQL_Logon &quot;127.0.0.1\InstanceName&quot; &quot;user&quot; &quot;password&quot;<br />
<br />
On a small number of machines im getting a sql timeout from your plugin when doing this.<br />
I've made a loop around the logon part and let the user repeat the connection test. <br />
Sometimes it works on the third or fourth attempt.<br />
<br />
What timeout do you use internally in your plugin for the logon cmd?<br />
Is there a way to increase the timeout?<br />
Is it maybe possible that you expose the timeout parameter in your plugin?<br />
<br />
Regards<br />
Swordd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dgrinberg</div><div class="date">21st February 2011, 04:52</div></div><div class="posttext">Hi,<br />
<br />
I have been using this plugin for a couple of years and I am really happy with the results thus far.<br />
<br />
However, I have been getting some issues similar to the previous post. <br />
<br />
My installer creates a new named instance of SQLServer 2005 Express, connects and runs scripts to create the applications database.<br />
<br />
This had been all working fine, until a client tried installing it on a box with SQLServer 2008.  It is now timing out, trying to connect to the database.<br />
<br />
I have not yet tried a loop, as per the previous post.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">21st February 2011, 21:15</div></div><div class="posttext">Hello,<br />
connection timeout could be set before opening the connection, I will consider adding such a feature in future.<br />
A little research on google show that connection timeout problems with sql2008 are no so infrequent. Changing the timeout value could not fix the problem.<br />
Are you using SQL Express, Standard, Enterprise?<br />
Are you using default instance or named instance?<br />
What is your default protocol?<br />
Is the sql box local or remote?<br />
My tests are negative so far (the connections are working as expected).<br />
Give me some more details, so I can make more focused tests.<br />
Regards<br />
  Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dgrinberg</div><div class="date">21st February 2011, 22:37</div></div><div class="posttext">Hi Stefano,<br />
<br />
In my situation, the answers to your questions are as follows:<br />
* SQLExpress<br />
* Named Instance<br />
* Shared Memory (but network protocols are all switched on)<br />
* Local Box<br />
<br />
Some other details<br />
* oSQL worked fine<br />
* ODBC connection (using SQL Native Client) testd successfully<br />
<br />
I am also doing some more testing to see if there is some specific combination that sets this off.  I will post as soon as I have more information.<br />
<br />
As an aside, could the OLEDB driver be simply interchanged with SQL Native client?<br />
If so, could that be made parameter?<br />
<br />
David</div></div><hr />


<div class="post"><div class="posttop"><div class="username">swordd</div><div class="date">22nd February 2011, 08:22</div></div><div class="posttext">Hello,<br />
Are you using SQL Express, Standard, Enterprise?<br />
Are you using default instance or named instance?<br />
What is your default protocol?<br />
Is the sql box local or remote?<br />
Stefano<br />
<br />
- SQL Server 2008 Express R2<br />
- named instance<br />
- default protocol is named pipe (IP also switched on)<br />
- sql box is local<br />
<br />
i tried various sql tools (osql, ems,...) no timeout problems there.<br />
As a workaround i wrote a simple commandline tool in .Net to do all my database related stuff now. I call it from the installer with execwait and some params. <br />
Works like a charme.<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">22nd February 2011, 09:22</div></div><div class="posttext">As a workaround i wrote a simple commandline tool in .Net to do all my database related stuff now. I call it from the installer with execwait and some params. <br />
Works like a charme.<br />
Rather off-topic, but: Note that your users may not all have .NET installed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">swordd</div><div class="date">22nd February 2011, 09:54</div></div><div class="posttext">Rather off-topic, but: Note that your users may not all have .NET installed.<br />
<br />
thx for that hint :rolleyes: my installer takes care of that part anyway because the app is .net based.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">loyalp</div><div class="date">1st April 2011, 18:34</div></div><div class="posttext">Hi there,<br />
<br />
I am also experiencing this logon timeout issue on 2008 R2 Server.<br />
<br />
I'm using Standard Edition with a default instance, on a local box.  It has failed with both Mixed Mode authentication and Windows Authentication only.<br />
<br />
Let me know if you need any more information to help diagnose the issue.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">isawen</div><div class="date">24th August 2011, 11:33</div></div><div class="posttext">First, great! Really useful, thanks for all your effort!<br />
<br />
Now to my issue, if I try to logon to a server at localhost\instanceName it doesn't login however if I try machineName\instanceName it does connect without any problems.<br />
<br />
Any idea how to get around this? Using other tools I can connect via the localhost.<br />
<br />
Thanks<br />
<br />
------<br />
:rolleyes: Seems to have been some interference between keyboard and chair.<br />
<br />
Right way to do it : &quot;(local)\instanceName&quot;<br />
Another way that works but is pointless! Look up the machine name in registry and use that.<br />
<br />
Thanks for being a sounding board :D<br />
<br />
<br />
I'm encountering the same problem. On my Windows XP SP3 VMWare Virtual Machine with only SQL Server 2008 Express installed and .NET 3.5 the plugin example fails to log-in on localhost\sqlexpress.<br />
<br />
What could be the real reason for such log-in fail message?<br />
&quot;SQL State: 0x80004005 - Native: 0 - Message: [DBNETLIB][ConnectionOpen (Connect()).]SQL Server does not exist or access denied.&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SRINIVAS_hp</div><div class="date">6th November 2012, 12:03</div></div><div class="posttext">Try the attached installer, on my pc works fine<br />
Regards<br />
  Stefano<br />
<br />
Not able to login with different windows user id. How to give different windows useid</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SRINIVAS_hp</div><div class="date">7th November 2012, 05:58</div></div><div class="posttext">[QUOTE=SRINIVAS_hp;2896183]Not able to login with different windows user id. How to give different windows useid[/QUOTE<br />
<br />
LogOn how i can give different user id info.?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SRINIVAS_hp</div><div class="date">7th November 2012, 07:10</div></div><div class="posttext">in windows,<br />
i have logged in as say user, &quot;ABC&quot;<br />
But &quot;ABC&quot; user does not have the permission to access sql agent. SO i have to give another user say &quot;def&quot;,<br />
Like ${OLEDB}::SQL_Logon &quot;$SQLSERVER&quot; &quot;def&quot; &quot;$SQLPASSWORD&quot;.<br />
<br />
But i am getting <br />
<br />
Loggin on to SQL server RAJATSSRS.qa.englab.local\GRYSQL2008<br />
1<br />
Error initializing OLEDB Connection (Initialize)<br />
0<br />
SQL State: 0x80040e4d - Native: 0 - Message: Login failed for user 'englab\rnair'. <br />
<br />
But it works with &quot;sa&quot; user.<br />
<br />
Kindly help me in solving this issue</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>