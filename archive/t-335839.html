<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to have the user select what type of install?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to have the user select what type of install? NSIS Discussion" />
	
	<title> How to have the user select what type of install? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to have the user select what type of install?</div>
<hr />
<div class="pda"><a href="t-335839.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=335839">How to have the user select what type of install?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">hobbes487</div><div class="date">11th October 2011, 17:43</div></div><div class="posttext">I have an application that has client and server components to it.  I want the user to be able to choose which one to install and depending on what they choose, different actions will be taken. i.e. Install different files, call other apps, etc.  I have an nsis script working that will install the server components, but I need to add a choice and a way to only install certain things.  Any help would be great or at least point me to an example that does something like this.<br />
<br />
Here is my current script:<br />
<br />
;--------------------------------<br />
;Includes<br />
<br />
  !include &quot;MUI2.nsh&quot;<br />
  !include &quot;InstallOptions.nsh&quot;<br />
  !include &quot;fileassoc.nsh&quot;<br />
  !include &quot;LogicLib.nsh&quot;<br />
  !include &quot;x64.nsh&quot;<br />
<br />
;--------------------------------<br />
;General<br />
<br />
  ;Name and file<br />
  Name &quot;Open Source Automation&quot;<br />
  OutFile &quot;OSA Setup v0.3.2.exe&quot;<br />
<br />
  ;Default installation folder<br />
  InstallDir &quot;C:\OSA&quot;<br />
  <br />
;--------------------------------<br />
;Interface Settings<br />
<br />
  !define MUI_ABORTWARNING  <br />
<br />
  CRCCheck on<br />
  XPStyle on <br />
  <br />
  ShowInstDetails show<br />
  <br />
  BrandingText &quot;OSA Installer&quot;<br />
  <br />
  <br />
<br />
;--------------------------------<br />
;Pages<br />
<br />
  !insertmacro MUI_PAGE_LICENSE &quot;License.txt&quot;<br />
  #!insertmacro MUI_PAGE_COMPONENTS<br />
  <br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  <br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_UNPAGE_INSTFILES<br />
  <br />
;--------------------------------<br />
;Languages<br />
 <br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
;--------------------------------<br />
;Installer Sections<br />
 <br />
; These are the programs that are needed by OSA.<br />
Section -Prerequisites<br />
  SetOutPath $INSTDIR<br />
  IfFileExists &quot;$WINDIR\Microsoft.NET\Framework\v4.0*&quot; NETFrameworkInstalled 0<br />
    File &quot;dotNetFx40_Full_setup.exe&quot;<br />
    ExecWait &quot;$INSTDIR\dotNetFx40_Full_setup.exe&quot;<br />
    Goto endNet<br />
  NETFrameworkInstalled:<br />
    DetailPrint &quot;Microsoft .NET Framework is already installed!&quot;<br />
  endNet:<br />
  ${If} ${RunningX64}<br />
    ReadRegStr $0 HKLM &quot;SOFTWARE\Microsoft\VisualStudio\10.0\VC\VCRedist\x64&quot; 'Installed'<br />
    ${If} $0 == 1<br />
      DetailPrint &quot;VC++ 2011 Redist. already installed&quot;<br />
    ${Else}<br />
    DetailPrint $0<br />
      File &quot;vcredist_x64.exe&quot;<br />
      ExecWait &quot;$INSTDIR\vcredist_x64.exe&quot;<br />
      Delete &quot;$INSTDIR\vcredist_x64.exe&quot;<br />
      Goto endVC  <br />
    ${EndIf}<br />
  ${Else}<br />
    ReadRegStr $0 HKLM &quot;SOFTWARE\Microsoft\VisualStudio\10.0\VC\VCRedist\x86&quot; 'Installed'<br />
    ${If} $0 == 1<br />
      DetailPrint &quot;VC++ 2011 Redist. already installed&quot;<br />
    ${Else}<br />
    DetailPrint $0<br />
      File &quot;vcredist_x86.exe&quot;<br />
      ExecWait &quot;$INSTDIR\vcredist_x86.exe&quot;<br />
      Delete &quot;$INSTDIR\vcredist_x86.exe&quot;<br />
      Goto endVC  <br />
    ${EndIf}<br />
  ${EndIf}<br />
  endVC:<br />
  IfFileExists &quot;$PROGRAMFILES\MySQL&quot; MySqlInstalled 0<br />
    MessageBox MB_YESNO &quot;Install MySql?&quot; /SD IDYES IDNO endMysql<br />
    File &quot;mysql-essential-5.1.50-win32.msi&quot;<br />
    ;File &quot;mysql-workbench-gpl-5.2.34.2-win32.msi&quot;<br />
    ExecWait 'msiexec /q /log $INSTDIR\MySQLINstall.log /i mysql-essential-5.1.50-win32.msi installdir=&quot;$PROGRAMFILES\MySql&quot;'<br />
    ExecWait 'msiexec /q /log $INSTDIR\MySQLWKINstall.log /i mysql-workbench-gpl-5.2.34.2-win32.msi'<br />
    SetOutPath &quot;$PROGRAMFILES\MySql&quot;<br />
    File &quot;my.ini&quot;<br />
    ExecWait '&quot;$PROGRAMFILES\MySql\bin\mysqld.exe&quot; --install MySQL --defaults-file=&quot;$PROGRAMFILES\MySql\my.ini&quot;'<br />
    ExecWait '&quot;$PROGRAMFILES\MySql\bin\MySQLInstanceConfig.exe&quot; -i -q &quot;-lc:mysql_install_log.txt&quot; ServerType=DEVELOPMENT DatabaseType=MIXED ConnectionUsage=DSS Port=3306 RootPassword=password'<br />
    ExecWait &quot;net start MySql&quot;<br />
    ExecWait '&quot;$PROGRAMFILES\MySql\bin\mysql&quot; -uroot -ppassword --execute &quot;CREATE USER `root`@`%` IDENTIFIED BY $\'password$\'&quot;;'<br />
    ExecWait '&quot;$PROGRAMFILES\MySql\bin\mysql&quot; -uroot -ppassword --execute &quot;GRANT ALL ON *.* TO `root`@`%`&quot;;'<br />
    Goto endMysql<br />
  MySqlInstalled:<br />
    DetailPrint &quot;MySql is already installed!&quot;<br />
  endMysql: <br />
  Delete &quot;$INSTDIR\dotNetFx40_Full_setup.exe&quot;<br />
  Delete &quot;$INSTDIR\mysql-essential-5.1.50-win32.msi&quot;<br />
  ;Delete &quot;$INSTDIR\mysql-workbench-gpl-5.2.34.2-win32.msi&quot;<br />
SectionEnd<br />
<br />
Section &quot;Open Source Automation Engine&quot; SecDummy<br />
  ${If} ${RunningX64} <br />
     SetRegView 64 <br />
  ${EndIf}<br />
  <br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  <br />
  File &quot;..\DB\0.2.0-0.3.0.sql&quot;<br />
  File &quot;..\DB\0.3.0-0.3.1.sql&quot;<br />
<br />
  File &quot;..\output\ICSharpCode.SharpZipLib.dll&quot;<br />
  File &quot;MySql.Data.dll&quot;<br />
  File &quot;..\output\OSAE Manager.exe&quot;<br />
  File &quot;..\output\OSAE Manager.exe.config&quot;<br />
  File &quot;..\output\lib\OSAE.api.dll&quot;<br />
  File &quot;..\output\OSAE.GUI.exe&quot;<br />
  File &quot;..\output\OSAEService.exe&quot;<br />
  File &quot;..\output\OSAEService.exe.config&quot;<br />
  File &quot;..\output\PluginDescriptionEditor.exe&quot;<br />
  File &quot;..\output\PluginInstaller.exe&quot;<br />
  File &quot;..\output\HostView.dll&quot;<br />
  File &quot;..\DB\osae.sql&quot;<br />
  ;File &quot;..\output\vr.exe&quot;<br />
  CreateDirectory &quot;Sounds&quot;<br />
  CreateDirectory &quot;Logs&quot;<br />
  CreateDirectory &quot;Images&quot;<br />
  CreateDirectory &quot;AddIns&quot;<br />
  CreateDirectory &quot;wwwroot&quot;<br />
  CreateDirectory &quot;AddInSideAdapters&quot;<br />
  CreateDirectory &quot;AddInViews&quot;<br />
  CreateDirectory &quot;contracts&quot;<br />
  CreateDirectory &quot;HostSideAdapters&quot;<br />
  CreateDirectory &quot;lib&quot;<br />
  <br />
  SetOutPath &quot;$INSTDIR\lib&quot;<br />
  File &quot;..\output\lib\OSAE.api.dll&quot;<br />
  File &quot;MySql.Data.dll&quot;<br />
  <br />
  SetOutPath &quot;$INSTDIR\AddInSideAdapters&quot;<br />
  File &quot;..\output\AddInSideAdapters\Template.dll&quot;<br />
  <br />
  SetOutPath &quot;$INSTDIR\AddInViews&quot;<br />
  File &quot;..\output\AddInViews\AddInView.dll&quot;<br />
  <br />
  SetOutPath &quot;$INSTDIR\contracts&quot;<br />
  File &quot;..\output\contracts\OpenSourceAutomation.Contract.dll&quot;<br />
  <br />
  SetOutPath &quot;$INSTDIR\HostSideAdapters&quot;<br />
  File &quot;..\output\HostSideAdapters\Template.dll&quot;<br />
  <br />
  SetOutPath &quot;$INSTDIR\wwwroot&quot;<br />
  File &quot;..\output\wwwroot\*.*&quot;<br />
  CreateDirectory &quot;includes&quot;<br />
  CreateDirectory &quot;mobile&quot;<br />
  CreateDirectory &quot;images&quot;<br />
  <br />
  SetOutPath &quot;$INSTDIR\wwwroot\includes&quot;<br />
  File &quot;..\output\wwwroot\includes\*.*&quot;<br />
  SetOutPath &quot;$INSTDIR\wwwroot\images&quot;<br />
  File &quot;..\output\Images\*.jpg&quot;<br />
  File &quot;..\output\Images\*.png&quot;<br />
  SetOutPath &quot;$INSTDIR\wwwroot\mobile&quot;<br />
  File &quot;..\output\wwwroot\mobile\*.*&quot;<br />
  <br />
  CreateDirectory &quot;includes&quot;<br />
  CreateDirectory &quot;css&quot;<br />
  CreateDirectory &quot;js&quot;<br />
  SetOutPath &quot;$INSTDIR\wwwroot\mobile\includes&quot;<br />
  File &quot;..\output\wwwroot\mobile\includes\*.*&quot;<br />
  SetOutPath &quot;$INSTDIR\wwwroot\mobile\js&quot;<br />
  File &quot;..\output\wwwroot\mobile\js\*.*&quot;<br />
  SetOutPath &quot;$INSTDIR\wwwroot\mobile\css&quot;<br />
  File &quot;..\output\wwwroot\mobile\css\*.*&quot;<br />
  <br />
  CreateDirectory &quot;images&quot;<br />
  SetOutPath &quot;$INSTDIR\wwwroot\mobile\css\images&quot;<br />
  File &quot;..\output\wwwroot\mobile\css\images\*.*&quot;<br />
  <br />
  SetOutPath &quot;$INSTDIR\Logs&quot;<br />
  <br />
  SetOutPath &quot;$INSTDIR\Images&quot;<br />
  File &quot;..\output\Images\*.jpg&quot;<br />
  File &quot;..\output\Images\*.png&quot; <br />
  <br />
  SetOutPath &quot;$INSTDIR\AddIns&quot;<br />
  CreateDirectory &quot;Bluetooth&quot;<br />
  CreateDirectory &quot;Email&quot;<br />
  CreateDirectory &quot;Jabber&quot;<br />
  CreateDirectory &quot;Network Monitor&quot;<br />
  CreateDirectory &quot;Script Processor&quot;<br />
  CreateDirectory &quot;Speech&quot;<br />
  CreateDirectory &quot;Weather&quot;<br />
  CreateDirectory &quot;Web Server&quot;<br />
  <br />
  SetOutPath &quot;$INSTDIR\AddIns\Bluetooth&quot;<br />
  File &quot;..\output\AddIns\Bluetooth\Bluetooth.osapd&quot;<br />
  File &quot;..\output\AddIns\Bluetooth\OSAE.Bluetooth.dll&quot;<br />
  File &quot;..\output\AddIns\Bluetooth\InTheHand.Net.Personal.dll&quot;<br />
    <br />
  SetOutPath &quot;$INSTDIR\AddIns\Email&quot;<br />
  File &quot;..\output\AddIns\Email\Email.osapd&quot;<br />
  File &quot;..\output\AddIns\Email\OSAE.Email.dll&quot;<br />
  <br />
  SetOutPath &quot;$INSTDIR\AddIns\Jabber&quot;<br />
  File &quot;..\output\AddIns\Jabber\Jabber.osapd&quot;<br />
  File &quot;..\output\AddIns\Jabber\OSAE.Jabber.dll&quot;<br />
  File &quot;..\output\AddIns\Jabber\agsXMPP.dll&quot;<br />
    <br />
  SetOutPath &quot;$INSTDIR\AddIns\Network Monitor&quot;<br />
  File &quot;..\output\AddIns\Network Monitor\Network Monitor.osapd&quot;<br />
  File &quot;..\output\AddIns\Network Monitor\OSAE.NetworkMonitor.dll&quot;<br />
  <br />
  SetOutPath &quot;$INSTDIR\AddIns\Script Processor&quot;<br />
  File &quot;..\output\AddIns\Script Processor\Script Processor.osapd&quot;<br />
  File &quot;..\output\AddIns\Script Processor\OSAE.ScriptProcessor.dll&quot;<br />
  <br />
  SetOutPath &quot;$INSTDIR\AddIns\Speech&quot;<br />
  File &quot;..\output\AddIns\Speech\Speech.osapd&quot;<br />
  File &quot;..\output\AddIns\Speech\OSAE.Speech.dll&quot;<br />
  <br />
  SetOutPath &quot;$INSTDIR\AddIns\Weather&quot;<br />
  File &quot;..\output\AddIns\Weather\Weather.osapd&quot;<br />
  File &quot;..\output\AddIns\Weather\OSAE.Weather.dll&quot;  <br />
<br />
  SetOutPath &quot;$INSTDIR\AddIns\Web Server&quot;<br />
  File &quot;..\output\AddIns\Web Server\Web Server.osapd&quot;<br />
  File &quot;..\output\AddIns\Web Server\OSAE.WebServer.dll&quot;  <br />
  File &quot;..\output\AddIns\Web Server\HttpServer.dll&quot;<br />
<br />
  SetOutPath &quot;C:\&quot;<br />
  CreateDirectory &quot;PHP&quot;<br />
  SetOutPath &quot;C:\PHP&quot;<br />
  CreateDirectory &quot;ext&quot;<br />
  File &quot;php-cgi.exe&quot;<br />
  File &quot;php5.dll&quot;<br />
  File &quot;php.ini&quot;<br />
  SetOutPath &quot;C:\PHP\ext&quot;<br />
  File &quot;php_mysql.dll&quot;<br />
<br />
  # Start Menu Shortcuts<br />
  #SetShellVarContext all<br />
  createShortCut &quot;$SMPROGRAMS\OSA\Manager.lnk&quot; &quot;$INSTDIR\OSAE Manager.exe&quot;<br />
  createShortCut &quot;$SMPROGRAMS\OSA\Uninstall.lnk&quot; &quot;$INSTDIR\uninstall.exe&quot;<br />
  createShortCut &quot;$SMPROGRAMS\OSA\OSAE.GUI.lnk&quot; &quot;$INSTDIR\OSAE.GUI.exe&quot;<br />
<br />
  #SetShellVarContext all<br />
  #ShellLink::SetRunAsAdministrator &quot;$SMPROGRAMS\OSA\Manager.lnk&quot;<br />
  #Pop $0<br />
  <br />
  SimpleSC::InstallService &quot;OSAE&quot; &quot;OSAE Service&quot; &quot;16&quot; &quot;2&quot; &quot;$INSTDIR\OSAEService.exe&quot; &quot;&quot; &quot;&quot; &quot;&quot;<br />
  Pop $0 ; returns an errorcode (&lt;&gt;0) otherwise success (0)<br />
<br />
  WriteRegStr HKLM &quot;SOFTWARE\OSAE\DBSETTINGS&quot; &quot;INSTALLDIR&quot; &quot;$INSTDIR&quot;<br />
  <br />
  !insertmacro APP_ASSOCIATE &quot;osapd&quot; &quot;OSA.osapd&quot; &quot;Plugin Description&quot; &quot;$INSTDIR\PluginDescriptionEditor.exe,0&quot; &quot;Open&quot; &quot;$INSTDIR\PluginDescriptionEditor.exe $\&quot;%1$\&quot;&quot;  <br />
  !insertmacro APP_ASSOCIATE &quot;osapp&quot; &quot;OSA.osapp&quot; &quot;Plugin Package&quot; &quot;$INSTDIR\PluginInstaller.exe,0&quot; &quot;Open&quot; &quot;$INSTDIR\PluginInstaller.exe $\&quot;%1$\&quot;&quot; <br />
  !insertmacro UPDATEFILEASSOC    <br />
  <br />
  AccessControl::GrantOnFile \<br />
    &quot;$INSTDIR&quot; &quot;(BU)&quot; &quot;GenericRead + GenericWrite&quot;<br />
    <br />
   writeUninstaller $INSTDIR\uninstall.exe<br />
SectionEnd<br />
<br />
Section GAC<br />
  SetOutPath $INSTDIR<br />
  File &quot;DBInstall\GAC\bin\Debug\GAC.exe&quot;<br />
  ExecWait &quot;$INSTDIR\GAC.exe&quot;<br />
  Goto endGAC<br />
  endGAC:<br />
  Delete &quot;$INSTDIR\GAC.exe&quot;<br />
SectionEnd<br />
<br />
Section DBInstall<br />
  SetOutPath $INSTDIR<br />
  File &quot;DBInstall\DBInstall\bin\Debug\DBInstall.exe&quot;<br />
  ExecWait &quot;$INSTDIR\DBInstall.exe $INSTDIR&quot;<br />
  Goto endDBInstall<br />
  endDBInstall:   <br />
  Delete &quot;$INSTDIR\DBInstall.exe&quot;<br />
SectionEnd<br />
<br />
;--------------------------------<br />
;Uninstaller Section<br />
<br />
Section &quot;Uninstall&quot;<br />
<br />
  Delete &quot;$INSTDIR\Uninstall.exe&quot;<br />
  Delete &quot;$SMPROGRAMS\OSA\Manager.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\OSA\Uninstall.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\OSA\OSAE.GUI.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\OSA\DevTools.lnk&quot;<br />
  RMDir /r &quot;$SMPROGRAMS\OSA&quot;<br />
  !insertmacro APP_UNASSOCIATE &quot;osapd&quot; &quot;OSA.osapd&quot;<br />
  !insertmacro APP_UNASSOCIATE &quot;osapp&quot; &quot;OSA.osapp&quot;<br />
  Delete $INSTDIR\*.*<br />
  RMDir /r $INSTDIR<br />
  SimpleSC::RemoveService &quot;OSAE&quot;<br />
  Pop $0<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">11th October 2011, 17:54</div></div><div class="posttext">Use InstType with /NOCUSTOM flag.<br />
<br />
Make two InstTypes, e.g. &quot;Server&quot; and &quot;Client&quot;, and then use SectionIn to assign your sections accordingly.<br />
<br />
For details look at the scripting reference manual :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">12th October 2011, 07:07</div></div><div class="posttext">(In the future, please don't paste huge amounts of code like that. Use an attachment or pastebin.)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>