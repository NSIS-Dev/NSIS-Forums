<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Single installer file(all files and dlls should go in a single installer file), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Single installer file(all files and dlls should go in a single installer file) NSIS Discussion" />
	
	<title> Single installer file(all files and dlls should go in a single installer file) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Single installer file(all files and dlls should go in a single installer file)</div>
<hr />
<div class="pda"><a href="t-301083.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=301083">Single installer file(all files and dlls should go in a single installer file)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mmsajid</div><div class="date">15th December 2008, 11:52</div></div><div class="posttext">Hi,<br />
<br />
I required to invoke a dll in my script and I can able to do that by using the below code.But it requires the dll to be in the same level as of the exe, i.e same folder should contain the dlls to be invoked and the .exe.<br />
<br />
Which should not be the case, as normally we should have only single exe. <br />
<br />
Can any body suggest how can I achieve this.<br />
<br />
---------------------------------------------<br />
  InitPluginsDir<br />
  SetOutPath $PLUGINSDIR<br />
  File CLR.dll<br />
  File One.dll<br />
  File Two.dll<br />
<br />
Section <br />
   CLR::Call /NOUNLOAD &quot;One.dll&quot; &quot;OneNamespace.OneClass&quot; &quot;.OneMethod&quot;<br />
  pop $0<br />
  messagebox mb_ok $0<br />
  CLR::Destroy<br />
  ...<br />
  ...<br />
<br />
SectionEnd<br />
-------------------------------------------<br />
Regards,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">15th December 2008, 12:10</div></div><div class="posttext">There's no need for you to include / extract the plugin file yourself, NSIS will take care of that on the first call.<br />
( You do for the .NET assembly dlls, of course )<br />
<br />
After that, instead of &quot;One.dll&quot;, try &quot;$PLUGINSDIR\One.dll&quot; as the parameter for CLR?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mmsajid</div><div class="date">15th December 2008, 12:29</div></div><div class="posttext">Thanks Animaether,<br />
<br />
I tried as suggested, but throws below error.<br />
------------------------------<br />
Error calling .NET DLL method<br />
<br />
The given path's format is not supported.<br />
------------------------------<br />
<br />
But I tried setting the path to $ExeDir and it works fine.<br />
But it copies the dlls to the place where the executable is present.<br />
<br />
I can delete the dlls after the installation but I think it is not the good way of doing it.<br />
<br />
Iam sure there should be a better way for acheiving this.<br />
Any suggestions will be appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">15th December 2008, 15:04</div></div><div class="posttext">*eyes the CLR plugin*<br />
quaint<br />
<br />
I just tried with the code from:<br />
http://forums.winamp.com/showthread.php?postid=2402816#post2402816<br />
( ignore the VB code - just download the attachment )<br />
<br />
Does that sample code + the DLL work for you?<br />
If it does - try substituting the &quot;TestCLRDLL.dll&quot; with your &quot;One.dll&quot;, along with the actual .NET methods called.  Does that still work?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th December 2008, 16:12</div></div><div class="posttext">What is the . in front of your method name for?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mmsajid</div><div class="date">17th December 2008, 09:41</div></div><div class="posttext">Hi Stu,<br />
<br />
That was just a typo mistake. But it does not work even if we remove the dot(.).<br />
<br />
Thanks,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">claesabrandt</div><div class="date">13th January 2009, 13:41</div></div><div class="posttext">mmsajid, I guess you are having problems calling .NET methods in other .NET dlls from your first .NET dll. The only way to do this is to wrap your installer in another installer. The first installer places the .NET dlls besides the second setup exe. The second setup makes the .NET calls. Now the DLL files can be found from the second installer while you will only be distributing one setup file.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>