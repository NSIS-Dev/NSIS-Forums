<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Re: Windows Command Prompt Access from installer script, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Re: Windows Command Prompt Access from installer script NSIS Discussion" />
	
	<title> Re: Windows Command Prompt Access from installer script [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Re: Windows Command Prompt Access from installer script</div>
<hr />
<div class="pda"><a href="t-314241.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=314241">Re: Windows Command Prompt Access from installer script</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jpo</div><div class="date">29th October 2009, 18:50</div></div><div class="posttext">Is it possible to access the windows command prompt from an NSIS installer script file? In my installer script, I'd like to perform the following actions:<br />
<br />
1. ping a server X<br />
1a. if the ping is successful, place the server name X in a registry value<br />
1b. if the ping is unsuccessful, place the server name Y in a registry value<br />
<br />
I know how to write registry values (WriteRegStr). Unfortunately, I don't see how I could access and interpret a Windows command prompt &quot;dialogue&quot;. While accessing the command prompt would be more intuitive to me, just being able to ping and interpret the results would be sufficient for my project.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">29th October 2009, 20:13</div></div><div class="posttext">Ping may be filtered in customer' network. IMHO better way is a short HTTP request. For example requesting HTTP headers only (or some short file from server). NSISdl included to distribution, but http://nsis.sourceforge.net/Inetc_plug-in has more features.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpo</div><div class="date">29th October 2009, 21:12</div></div><div class="posttext">Takhir,<br />
<br />
Are you suggesting an FTP request instead of a ping to the desired server? The &quot;server X&quot; is just a file server, so I don't know if it could do web requests, etc. <br />
<br />
Assuming that you mean an FTP request, my only concern would be that the installer script would not know the appropriate user name/password to access the server. If the script doesn't know that information, will your suggestion still work?<br />
<br />
Thanks again for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">30th October 2009, 09:15</div></div><div class="posttext">Originally posted by jpo <br />
Takhir,<br />
<br />
Are you suggesting an FTP request instead of a ping to the desired server? The &quot;server X&quot; is just a file server, so I don't know if it could do web requests, etc. <br />
<br />
Assuming that you mean an FTP request, my only concern would be that the installer script would not know the appropriate user name/password to access the server. If the script doesn't know that information, will your suggestion still work?<br />
<br />
Thanks again for your help.  <br />
Well you could of course just make a guest account on the FTP server, one without any priviledges so that even if someone hacked the login from your installer it shouldn't cause any problems. Theoretically.<br />
<br />
To answer your ping question, take a look at the nsExec plugin (ExecToLog function).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpo</div><div class="date">30th October 2009, 15:11</div></div><div class="posttext">MSG,<br />
<br />
Thanks for the info. Here's what I ended up doing:<br />
<br />
Name &quot;Test&quot;<br />
OutFile &quot;Test.exe&quot;<br />
<br />
Section &quot;&quot;<br />
<br />
	; returns 1 (error) if ping returned &quot;could not find host&quot; or &quot;request timed out&quot;<br />
	nsExec::ExecToLog 'ping 192.0.0.1 -n 2 -w 200'<br />
	 Pop $0 ;return value<br />
	 IntCmp $0 0 PingDone<br />
	<br />
	MessageBox MB_OK &quot;Defaulting to external address&quot;<br />
	goto Done<br />
	<br />
	 PingDone:<br />
	MessageBox MB_OK &quot;Defaulting to internal address&quot;<br />
<br />
<br />
	Done:<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">30th October 2009, 15:40</div></div><div class="posttext">Err... You're supposed to supply a path to write to, when you use the ExecToLog function. Because it, you know, outputs to a log file. If you just want to pop the return value from ping, use nsExec::Exec.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpo</div><div class="date">30th October 2009, 15:43</div></div><div class="posttext">OK, thanks for the clarification.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">31st October 2009, 07:34</div></div><div class="posttext">jpo, I had in mind http access. But Inetc supports ftp as well. If login/password is not set in URL, you will get answer from server &quot;530&quot; (Anonymous access not allowed)... Or &quot;550&quot; (File not found). &quot;Connection error&quot; if no access to server. But ftp port may be closed as well.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>