<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" WMI query/logic not working, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  WMI query/logic not working NSIS Discussion" />
	
	<title> WMI query/logic not working [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  WMI query/logic not working</div>
<hr />
<div class="pda"><a href="t-347346.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=347346">WMI query/logic not working</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Squirre1</div><div class="date">24th August 2012, 19:31</div></div><div class="posttext">I am using the WMI header:<br />
http://nsis.sourceforge.net/WMI_header<br />
<br />
    ${WMIGetInfo} root\CIMV2 Win32_SystemEnclosure ChassisTypes fnc_Laptop_Test<br />
<br />
  Function fnc_Laptop_Test<br />
    ${If} $INSTALL_VPN != &quot;&quot;<br />
      goto _func-end<br />
    ${EndIf}<br />
<br />
    !insertmacro logme ${INSTLOG} &quot;- Processing detected chassis type: $R2&quot; l<br />
<br />
    ${If} $R2 == &quot;{1}&quot;<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Other&quot; l<br />
    ${ElseIf} $R2 == &quot;{2}&quot;<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Unknown&quot; l<br />
    ${ElseIf} $R2 == &quot;{3}&quot;<br />
        StrCpy $INSTALL_VPN 0<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Desktop&quot; l<br />
        !insertmacro logme ${INSTLOG} &quot;- Desktop Detected&quot; l<br />
    ${ElseIf} $R2 == &quot;{4}&quot;<br />
        StrCpy $INSTALL_VPN 0<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Low Profile Desktop&quot; l<br />
        !insertmacro logme ${INSTLOG} &quot;- Desktop Detected&quot; l<br />
    ${ElseIf} $R2 == &quot;{5}&quot;<br />
        StrCpy $INSTALL_VPN 0<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Pizza Box&quot; l<br />
        !insertmacro logme ${INSTLOG} &quot;- Desktop Detected&quot; l<br />
    ${ElseIf} $R2 == &quot;{6}&quot;<br />
        StrCpy $INSTALL_VPN 0<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Mini Tower&quot; l<br />
        !insertmacro logme ${INSTLOG} &quot;- Desktop Detected&quot; l<br />
    ${ElseIf} $R2 == &quot;{7}&quot;<br />
        StrCpy $INSTALL_VPN 0<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Tower&quot; l<br />
        !insertmacro logme ${INSTLOG} &quot;- Desktop Detected&quot; l<br />
    ${ElseIf} $R2 == &quot;{8}&quot;<br />
        StrCpy $INSTALL_VPN 1<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Portable&quot; l<br />
        !insertmacro logme ${INSTLOG} &quot;- Laptop Detected&quot; l<br />
    ${ElseIf} $R2 == &quot;{9}&quot;<br />
        StrCpy $INSTALL_VPN 1<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Laptop&quot; l<br />
        !insertmacro logme ${INSTLOG} &quot;- Laptop Detected&quot; l<br />
    ${ElseIf} $R2 == &quot;{10}&quot;<br />
        StrCpy $INSTALL_VPN 1<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Notebook&quot; l<br />
        !insertmacro logme ${INSTLOG} &quot;- Laptop Detected&quot; l<br />
    ${ElseIf} $R2 == &quot;{11}&quot;<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Hand Held&quot; l<br />
    ${ElseIf} $R2 == &quot;{12}&quot;<br />
        StrCpy $INSTALL_VPN 1<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Docking Station&quot; l<br />
        !insertmacro logme ${INSTLOG} &quot;- Laptop Detected&quot; l<br />
    ${ElseIf} $R2 == &quot;{13}&quot;<br />
        StrCpy $INSTALL_VPN 0<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: All in One&quot; l<br />
        !insertmacro logme ${INSTLOG} &quot;- Desktop Detected&quot; l<br />
    ${ElseIf} $R2 == &quot;{14}&quot;<br />
        StrCpy $INSTALL_VPN 1<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Sub Notebook&quot; l<br />
        !insertmacro logme ${INSTLOG} &quot;- Laptop Detected&quot; l<br />
    ${ElseIf} $R2 == &quot;{15}&quot;<br />
        StrCpy $INSTALL_VPN 0<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Space-Saving&quot; l<br />
        !insertmacro logme ${INSTLOG} &quot;- Desktop Detected&quot; l<br />
    ${ElseIf} $R2 == &quot;{16}&quot;<br />
        StrCpy $INSTALL_VPN 0<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Lunch Box&quot; l<br />
        !insertmacro logme ${INSTLOG} &quot;- Desktop Detected&quot; l<br />
    ${ElseIf} $R2 == &quot;{17}&quot;<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Main System Chassis&quot; l<br />
    ${ElseIf} $R2 == &quot;{18}&quot;<br />
        StrCpy $INSTALL_VPN 1<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Expansion Chassis&quot; l<br />
        !insertmacro logme ${INSTLOG} &quot;- Laptop Detected&quot; l<br />
    ${ElseIf} $R2 == &quot;{19}&quot;<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Sub Chassis&quot; l<br />
    ${ElseIf} $R2 == &quot;{20}&quot;<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Bus Expansion Chassis&quot; l<br />
    ${ElseIf} $R2 == &quot;{21}&quot;<br />
        StrCpy $INSTALL_VPN 1<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Peripheral Chassis&quot; l<br />
        !insertmacro logme ${INSTLOG} &quot;- Laptop Detected&quot; l<br />
    ${ElseIf} $R2 == &quot;{22}&quot;<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Storage Chassis&quot; l<br />
    ${ElseIf} $R2 == &quot;{23}&quot;<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Rack Mount Chassis&quot; l<br />
    ${ElseIf} $R2 == &quot;{24}&quot;<br />
        !insertmacro logme ${INSTLOG} &quot;- Chassis Type: Sealed-Case PC&quot; l<br />
    ${EndIf}<br />
<br />
    _func-end:<br />
  FunctionEnd<br />
<br />
<br />
I get in my log file for ex., Processing detected chassis type: {1}<br />
<br />
Which means $R2 == &quot;{1}&quot;<br />
<br />
But it is not processing the logic for that variable... I am not sure if it is returning some type of ascii that is not making it truly = to {1}. I do see in the WMI.nsh file they are stripping CRLF's...<br />
<br />
${TrimNewLines} &quot;$1&quot; $1<br />
<br />
This is the next like, I am not sure 110% what it is doing, but almost looks like it is adding back in a new line..<br />
<br />
${Explode_WMI}  $R1  &quot;$\n&quot; &quot;$1&quot;<br />
<br />
Any Help would be appreciated...<br />
<br />
Thanks,<br />
<br />
Squirre1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th August 2012, 22:29</div></div><div class="posttext">Put it in a MessageBox surrounded by some extra characters to be sure there are no new lines in the string.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Squirre1</div><div class="date">25th August 2012, 01:22</div></div><div class="posttext">Good call afrow, I was trying to do a char to ascii earlier after trimming the { } off of it... my output looks like it has a tab in it...<br />
<br />
&quot;R2 = before$R2after&quot;<br />
<br />
R2 = before{1}        after<br />
<br />
Looks like I have a trim out a tab somehow.. Ill take ideas but should have a solution when you next read this...<br />
<br />
Thanks,<br />
<br />
Squirre1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Squirre1</div><div class="date">25th August 2012, 02:00</div></div><div class="posttext">Since I am only worried about parsing the digits out, I just did this filter and it dumped everything else...<br />
<br />
    ${StrFilter} $R2 &quot;1&quot; &quot;&quot; &quot;&quot; $R2<br />
<br />
Thanks again,<br />
<br />
Squirre1</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>