<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Application Error when running installer through &quot;runas&quot;, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Application Error when running installer through &quot;runas&quot; NSIS Discussion" />
	
	<title> Application Error when running installer through &quot;runas&quot; [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Application Error when running installer through &quot;runas&quot;</div>
<hr />
<div class="pda"><a href="t-229483.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=229483">Application Error when running installer through &quot;runas&quot;</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">tlalit</div><div class="date">27th October 2005, 16:21</div></div><div class="posttext">Hi, I'm using NSIS 2.07 and trying to run the &quot;C:\Program Files\NSIS\Examples\Modern UI\Basic.exe&quot; on WinXp SP2, <br />
my problem is this: <br />
when a &quot;Power User&quot; on the computer is running the installer through the &quot;runas&quot; option and choosing the &quot;current user&quot; (default) and checking the &quot;protect my computer...&quot; checkbox and clicking &quot;ok&quot; - the result is Application Error - &quot;the application failed to initialize properly (0xc0000022). click on ok to terminate the application&quot;<br />
can you please tell me what's the problem?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th October 2005, 21:01</div></div><div class="posttext">This option severely limits the executed application. Almost every privilege is denied including even the user's default temporary directory (%USERPROFILE%\Local Settings\Temp). Even the dialog itself mentions possible problems.This option can prevent computer viruses from harming your computer or personal data, but selecting it might cause the program to function improperly.However, for me, the installer still starts-up and works, assuming the temporary folder problem is resolved.<br />
<br />
As Basic.nsi doesn't create any other processes, the error you got suggests the installer didn't even start. I guess it failed loading some DLL because of the denied privileges. Do other applications start when ran in the same method?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">4th May 2009, 21:25</div></div><div class="posttext">Out of curiosity... Is there any way to detect the user having chosen this option?  Google's giving me tons of generic results that aren't very helpful.<br />
<br />
When executed locally via this 'run as -&gt; protect my computer' method, the installer simply fails to run.  When executed across the network, that same &quot;the application failed to initialize properly&quot; prompt pops up.<br />
Would be more user-friendly to tell the user that the installer does not support the 'protect my computer' bits.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">4th May 2009, 21:57</div></div><div class="posttext">Originally posted by Animaether <br />
Out of curiosity... Is there any way to detect the user having chosen this option?  Google's giving me tons of generic results that aren't very helpful.<br />
<br />
When executed locally via this 'run as -&gt; protect my computer' method, the installer simply fails to run.  When executed across the network, that same &quot;the application failed to initialize properly&quot; prompt pops up.<br />
Would be more user-friendly to tell the user that the installer does not support the 'protect my computer' bits.  <br />
<br />
those are two different problems, the &quot;protect my computer&quot; checkbox is pointless to try to detect because $pluginsdir is in $temp, and we can't write to $temp, so there is no way for us to do things (If you really wanted to find out, you would have to write a native win32 (not in nsis) app that checks the process token, see http://blogs.msdn.com/aaron_margosis/archive/2004/09/10/227727.aspx for more, but then you would have to wrap the nsis installer in this detector app)<br />
<br />
The network error is a different problem, when using run-as and running as a different user, you will not have access to the same share's etc since that is per logon session IIRC the same would probably apply when using the protect checkbox (would depend on the ACL for the actual share maybe)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>