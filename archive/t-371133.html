<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecShell, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecShell NSIS Discussion" />
	
	<title> ExecShell [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecShell</div>
<hr />
<div class="pda"><a href="t-371133.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=371133">ExecShell</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Sky1234</div><div class="date">15th September 2013, 07:12</div></div><div class="posttext">Am quite new to nsis just having a little problem getting the syntax correct for execshell - if someone could take a quick look would be awesome<br />
<br />
I basically need to run 7za as admin so that it can extract an archive in the $EXEDIR to programfiles (The archive is super-large [&gt;4gb] so i cant just bundle it with installer - unless i used torrentdownloader or something)<br />
<br />
 ExecShell &quot;open&quot; &quot;7za.exe x $EXEDIR\Archieve.7z -pSECRETKEY -aoa -o$INSTDIR'&quot; [[SW_SHOWMAXIMIZED]]<br />
<br />
Obviously i replaced the password and archive name. Should be easy to fix - I got nsExec::Exec working but it wont work in program files as it needs to spawn 7za with admin rights.<br />
<br />
Am just not sure where/how to use runas to run it as admin<br />
Many thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">15th September 2013, 15:44</div></div><div class="posttext">ExecShell &quot;runas&quot; &quot;c:\path\to\app.exe&quot; 'param1 &quot;space param&quot; param3'<br />
<br />
but I would not recommend doing this:<br />
<br />
 The runas verb is broken if UAC is turned off<br />
 If you require elevation the whole installer should be elevated (RequestExecutionLevel)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sky1234</div><div class="date">16th September 2013, 09:11</div></div><div class="posttext">I have a requestexecutionlevel: admin flag in there but the child 7za process it spawns doesnt get admin privilidges and so cant unzip to C:/programfiles from $EXEDIR  - If you have a workaround please tell :).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">16th September 2013, 15:46</div></div><div class="posttext">Even if you use nsexec? Can you verify all of this by using Process Explorer (Enable the integrity column) and check both your installer and the child process...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sky1234</div><div class="date">23rd September 2013, 08:26</div></div><div class="posttext">Using NSExec the archive extracts from $EXEDIR to $INSTALLDIR whenever its outside Program Files, as soon as It tries to extract to program files it fails.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sky1234</div><div class="date">23rd September 2013, 11:33</div></div><div class="posttext">nevermind found the issue.<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">23rd September 2013, 15:00</div></div><div class="posttext">I notice that 7za.exe is the standard choice for dealing with pass-protected archives. I just wanted to share an alternative: 7-zip32.dll (http://www.csdinc.co.jp/archiver/lib/7-zip32.html). Unlike Pavlov's 7za.dll/7zxa.dll, this one can be employed in NSIS. It's Japanese with poorly translated documentation so here's a snippet that might save someone's valuable time:<br />
<br />
File /oname=$PLUGINSDIR\7-zip32.dll 7-zip32.dll<br />
System::Call &quot;$PLUGINSDIR\7-zip32::SevenZip(i 0, t 'x $\&quot;$Archive$\&quot; -o$\&quot;$Destination$\&quot; -p$Pass -y -hide', i 0, i 0) i.R0&quot;<br />
StrCmp $R0 0 Success</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>