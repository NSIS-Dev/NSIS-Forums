<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Error message - copy file in use, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Error message - copy file in use NSIS Discussion" />
	
	<title> Error message - copy file in use [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Error message - copy file in use</div>
<hr />
<div class="pda"><a href="t-336254.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=336254">Error message - copy file in use</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Aaskilde</div><div class="date">19th October 2011, 10:09</div></div><div class="posttext">Hey,<br />
<br />
I have created a installer there are copying some files to a directory for a server there can be running. If the server is running i get the error message: &quot;Error opening file for writing&quot;.<br />
<br />
Is there a way that i can get a message in example: &quot;The file xxxx is in use, please shutdown the server and run the installer again&quot; then they can cancel shutdown the server and run the installation. <br />
<br />
-Aaskilde</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">19th October 2011, 10:13</div></div><div class="posttext">You cannot overwrite a file that is locked by another process (in your case, a server application). You must disable the process first. You can use for example the lockedlist plugin to check whether a file is locked. You can use this to (let the user) kill the application before you attempt to install.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Aaskilde</div><div class="date">19th October 2011, 11:02</div></div><div class="posttext">Ya okay that could be an idea i need to find out if they may execute the process when the installer asks.<br />
<br />
But what if i just want a messagebox up instead of the error messages there is when the file is in use? Then with that messagebox you can cancel the install.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">19th October 2011, 11:33</div></div><div class="posttext">You could try to delete the file, and if that sets the error flag you can be relatively sure that you won't be able to overwrite it either. Then you can throw your own messagebox error.<br />
<br />
(Strictly speaking it is possible to have overwrite ('modify') privileges while not having 'delete' privileges. If NSIS first opens the file before attempting the overwrite, modify rights would be sufficient. I doubt that's how it's done, but I'm not sure.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th October 2011, 11:42</div></div><div class="posttext">Another option is to replace on reboot:<br />
http://nsis.sourceforge.net/Install_on_reboot<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Aaskilde</div><div class="date">20th October 2011, 08:10</div></div><div class="posttext">Okay the server that is using that file i need to overwrite is running on some of our users computers and if we can get passed it should not be restarted.<br />
<br />
I was wondering if you could make something like this:<br />
<br />
section &quot;Messagebox1&quot;<br />
<br />
$INSTDIR<br />
<br />
Messagebox MB_OK &quot;The file xxxx is in use by the server. Please shut down the server and install again.&quot; <br />
ok: Quit<br />
<br />
sectionend<br />
<br />
But is there maybe a command i can put in the section that checks if the file is in use?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th October 2011, 10:32</div></div><div class="posttext">As MSG said, try deleting the file. If that fails then you can show a message box. If you want to check earlier on (i.e. in .onInit) without deleting the file you can try appending to the file with FileOpen which should also fail.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>