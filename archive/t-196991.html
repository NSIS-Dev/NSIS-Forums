<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MSIBanner - newest plugin, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MSIBanner - newest plugin NSIS Discussion" />
	
	<title> MSIBanner - newest plugin [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MSIBanner - newest plugin</div>
<hr />
<div class="pda"><a href="t-196991.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=196991">MSIBanner - newest plugin</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">21st October 2004, 16:37</div></div><div class="posttext">This is my new plugin, MSIBanner.<br />
<br />
It prompts a banner like the MSI installations (Windows Installer).<br />
<br />
Please test it :)<br />
<br />
TODO:<br />
1. Remove the parameter /NOUNLOAD<br />
2. Put a progress bar.<br />
<br />
Thanks!<br />
<br />
:D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">22nd October 2004, 15:55</div></div><div class="posttext">Update MSIBanner....<br />
<br />
What's new:<br />
1. Rewrite Update function.<br />
2. Added the progress bar.<br />
<br />
See example.<br />
<br />
TODO:<br />
1. Remove the /NOUNLOAD parameter.<br />
2. (maybe) add colors to the progress bar.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">23rd October 2004, 22:16</div></div><div class="posttext">It will put at the archive in a few hours... <br />
<br />
any last suggestions?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd October 2004, 23:33</div></div><div class="posttext">It has the same problem as old Banner. The installer shows on the background.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">24th October 2004, 02:13</div></div><div class="posttext">ok, add it into my TODO list... :)<br />
<br />
Archive page (http://nsis.sourceforge.net/archive/nsisweb.php?page=635).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">19th January 2005, 04:59</div></div><div class="posttext">Originally posted by kichik <br />
It has the same problem as old Banner. The installer shows on the background.  <br />
<br />
Not anymore ;)<br />
<br />
plus added a static text control which shows the current &quot;%&quot; number.<br />
<br />
Archive page (http://nsis.sourceforge.net/archive/viewpage.php?pageid=528)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">19th January 2005, 07:12</div></div><div class="posttext">Win2K (Server, SP2, Rus), NSIS 2.04, goes to background. After banner destroyed, installer window becomes visisble on the top for a short time and after this goes to BG (100% repeatable on my Win2K). I run it 4 times, and one of them caused installer crash (bad pointer) on the banner destroy step.<br />
Looking from my corner % at the end of progress bar looks ugly. And I not found any progress bar positioning parameter, to reach it's end (100% without jumps from 20 to 100) developer should add 20 Update script lines :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">19th January 2005, 14:23</div></div><div class="posttext">Hi Takhir:<br />
I don't know why in win2k goes to the background...maybe is the API I'm using that is not available in win2k (doubtfull, but I'll check)...<br />
On this moment is the only place where I can place the &quot;%&quot;.<br />
And... Detroy function will close the counter, so you don't need to add the 20 lines... :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">19th January 2005, 16:01</div></div><div class="posttext">Originally posted by Lobo Lunar <br />
And... Detroy function will close the counter, so you don't need to add the 20 lines... :D<br />
<br />
For example installer checks 3 questions while banner window is visible, and developer (I :D ) want to show 3 steps: 30%, 60% and 100%. May be I misunderstood something, but current implementation with 3 /UPDATEs will show 5 and 10, and after this user will see jump to 100%. Or I should add 6 /UPDATEs on every step ;) to emulate correct check out progress?<br />
And finally most of users can live with &quot;background&quot;, installer crash is a real problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">19th January 2005, 16:19</div></div><div class="posttext">Test script attached. I run it on slow comp with Win98, no crashes, but background gradient flushes on installer start (after banner). This not happens if Destroy line is commented, but this case Installer loses keyboard focus.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">23rd January 2005, 23:02</div></div><div class="posttext">I tested the script in my XP and seemes to be ok.... weird :igor:<br />
<br />
Anyway, before uploading the big one... I update again the plugin<br />
<br />
what's new:<br />
1.- Added reset function: Which will reset the global increment and the position of the progress bar.<br />
<br />
2. Added Move function: Which the progress bar moves and adds the inputed value to the global increment.<br />
<br />
3. Added Pos function: Which the progress bar moves into position inputed, becoming the current global increment.<br />
<br />
See the example :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">25th January 2005, 11:14</div></div><div class="posttext">Attached image shows another possible place for percent value. Win2K test still is a good idea ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">25th January 2005, 14:11</div></div><div class="posttext">Hi Takhir<br />
<br />
I'm thinking to subclass the progress bar to put the % value inside of it...<br />
<br />
Now, I don't know why you have issues in 2k... I already tested in XP and WinME and seems that everything is ok...<br />
<br />
I'll try to find a 2k machine to tested my self :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">25th January 2005, 20:42</div></div><div class="posttext">for some reason I am getting  fatal errors....since I got the new MSIBanner<br />
I am on Win 2000<br />
says it is generating an error log...do you know where the log is located...<br />
It does compile properly...and your script example works fine<br />
Strangely, resaving the nsi as a new file name made it work...<br />
Then, I made some changes and recompiled...and started getting the fatal errors again<br />
:(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">25th January 2005, 20:48</div></div><div class="posttext">FYI, I am using variables in the text string like:<br />
msibanner::update /NOUNLOAD &quot;Checking for ${FILENAME}.ini&quot;<br />
or<br />
msibanner::move 15 /NOUNLOAD &quot;Checking for ${FILENAME}.ini&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">25th January 2005, 21:11</div></div><div class="posttext">another note:<br />
sometimes it compiles properly and runs....properly<br />
if I try to launch the file manually, I get the fatal errors again</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">25th January 2005, 21:27</div></div><div class="posttext">went back to the previous MSIBANNER which does not produce the erros<br />
do you have the latest MSIBANNER BEFORE the new changes were made ?<br />
not sure if I have it<br />
<br />
many thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">25th January 2005, 21:34</div></div><div class="posttext">send the changes your made.... :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">25th January 2005, 21:56</div></div><div class="posttext">thanks Lobo :)<br />
http://www.siren.cc/Univision/fonovisa/Library/nsis/MSIBANNER_error.zip<br />
the main nsi is !Fonovisav5<br />
the plugins are from the nsis plugin folder<br />
I have made some alterations trying to find the bug...but basically get the same fatal error even though it compiles properly</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">26th January 2005, 14:35</div></div><div class="posttext">Hi grahama!<br />
<br />
I read your code :)<br />
<br />
Seems that when the plugin read this line:<br />
<br />
MSIBanner::UPDATE /NOUNLOAD 'User= &quot;$R1&quot;  AccountType= &quot;$R2&quot;  IsUserAdmin= &quot;$R0&quot;'<br />
<br />
can't continue.... watch the loop thing :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JimInNH</div><div class="date">26th January 2005, 15:15</div></div><div class="posttext">I am relatively new to the NSIS installer.  I am trying to use your MSIBanner plugin to show progress.<br />
<br />
I put code in a function that controls a custom page.  That code is  the same as your demonstration and the function is attached.<br />
<br />
What I see is the msibanner dialog come up but it never gets any increments.  At the very end it goes to 100% in one step and goes away, i guess on MSIBanner::destroy.<br />
<br />
Are there any other steps that must happen?  Is MsiBanner designed to be used in another way?<br />
<br />
Thanks,<br />
Jim McGlaughlin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">26th January 2005, 20:45</div></div><div class="posttext">Did you use Update, pos nor move functions?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JimInNH</div><div class="date">26th January 2005, 22:17</div></div><div class="posttext">Here is the function:<br />
<br />
;====================================================================<br />
Function CustomInstallPageXXXX<br />
<br />
    !insertmacro MUI_HEADER_TEXT &quot;Installation Progress&quot; &quot;Line 2&quot;<br />
    !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;Progress.ini&quot;<br />
<br />
  <br />
    ; Call MSIBanner show funtion to create both dialog and dialog title:<br />
    MSIBanner::Show /NOUNLOAD &quot;${PROGNAME} Installer - Progress Monitor&quot;<br />
    <br />
    ; Call MSIBanner Update function so, the text &amp; the progress bar will be...mmm, updated :p<br />
    MSIBanner::Update /NOUNLOAD &quot;Reading known stuff from your PC&quot;<br />
    ; Sleep a while, since we don't real reading let's see for a sec. the text ;)<br />
    Sleep 100<br />
    MSIBanner::Update /NOUNLOAD &quot;Reading unknown stuff 1 from your PC&quot;<br />
    Sleep 100<br />
    MSIBanner::Update /NOUNLOAD &quot;Reading unknown stuff 2 from your PC&quot;<br />
    Sleep 100<br />
    MSIBanner::Update /NOUNLOAD &quot;Reading unknown stuff 3 from your PC&quot;<br />
    Sleep 100<br />
<br />
    ; Let's reset the progress bar...<br />
    MSIBanner::Reset /NOUNLOAD &quot;Reseting values...&quot;<br />
    <br />
    MSIBanner::Move /NOUNLOAD 20 &quot;Countdown to destruction 5&quot;<br />
    Sleep 100<br />
    MSIBanner::Move /NOUNLOAD 20 &quot;Countdown to destruction 4&quot;<br />
    Sleep 100<br />
    MSIBanner::Move /NOUNLOAD 20 &quot;Countdown to destruction 3&quot;<br />
    Sleep 100<br />
    MSIBanner::Move /NOUNLOAD 20 &quot;Countdown to destruction 2&quot;<br />
    Sleep 100<br />
    MSIBanner::Move /NOUNLOAD 20 &quot;Countdown to destruction 1&quot;<br />
    Sleep 100<br />
<br />
<br />
    MSIBanner::Reset /NOUNLOAD &quot;Re-counting again....&quot;<br />
    ; And... let's move the progress bar manually :)<br />
    Sleep 400<br />
    MSIBanner::Pos /NOUNLOAD 10 &quot;Reading hardaware&quot;<br />
    Sleep 400<br />
    MSIBanner::Pos /NOUNLOAD 25 &quot;Reading memory&quot;<br />
    Sleep 400<br />
    MSIBanner::Pos /NOUNLOAD 45 &quot;Reading mouse&quot;<br />
    Sleep 400<br />
    MSIBanner::Pos /NOUNLOAD 60 &quot;Reading software&quot;<br />
    Sleep 400<br />
    MSIBanner::Pos /NOUNLOAD 40 &quot;wait... forgot keyboard&quot;<br />
    Sleep 1000<br />
    MSIBanner::Pos /NOUNLOAD 70 &quot;Reading CPU&quot;<br />
    Sleep 400<br />
    MSIBanner::Pos /NOUNLOAD 90 &quot;Finish ing global scoops...&quot;<br />
    Sleep 400<br />
    ; last call and the progress bar will increase more:<br />
    MSIBanner::Pos /NOUNLOAD 100 &quot;Cleaning....&quot;<br />
<br />
;    MessageBox MB_OK &quot;end of custom install&quot;<br />
    <br />
    MSIBanner::Destroy<br />
  <br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">26th January 2005, 23:23</div></div><div class="posttext">Sleep 1000 is equal to 1 sec... but 400 or 100? you do the math :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">27th January 2005, 03:28</div></div><div class="posttext">many thanks Lobo for looking thru my code :)<br />
that  is a great help<br />
<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JimInNH</div><div class="date">27th January 2005, 14:21</div></div><div class="posttext">&quot;Sleep 1000 is equal to 1 sec... but 400 or 100? you do the math &quot;<br />
<br />
For a test I did not want to wait a full second between events.  Is 1000 the minimum?  I sent it to 400 milliseconds to speed up the test.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">27th January 2005, 14:25</div></div><div class="posttext">No, is not the minimun, but the increasing of the progress bar is very quick, which also depends on the users machines. That's why I recommend one sec. of delay.... at least to see the bar info :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">1st February 2005, 15:06</div></div><div class="posttext">Updated:<br />
-Added getHWND. Which will get the handle(hwnd) of the dialog of MSIBanner.<br />
-Added two more example files.<br />
-I think the erros went out :)<br />
<br />
Test it :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JimInNH</div><div class="date">1st February 2005, 18:10</div></div><div class="posttext">Thank you, Thank you, Thank you!<br />
<br />
I am now able to launch MSIBanner in .oninit and hide the window immediately.  Then in a later custom page I can show it and update it.<br />
<br />
Thanks, I needed that.  Today is/was my deadline for getting and installer done and this avoids an unpleasant work around.<br />
<br />
This forum is great.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">1st February 2005, 22:20</div></div><div class="posttext">seems to work perfectly Lobo :)<br />
no more crashes <br />
way to go :)<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">1st February 2005, 22:33</div></div><div class="posttext">Really? :D<br />
<br />
So, will be later on the web archive plus in my server... :)<br />
<br />
Thanks to you all for testing it.... ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">2nd February 2005, 11:20</div></div><div class="posttext">Yes, no more crashes :)<br />
But installer after banner still goes to background on Win2K :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">2nd February 2005, 18:15</div></div><div class="posttext">Is there any documentation for this?  (I think it would be helpful for us all to know exactly what functions are available to test.)<br />
<br />
Great work on this, by the way!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">2nd February 2005, 21:17</div></div><div class="posttext">erm... see examples? :|</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">3rd February 2005, 01:21</div></div><div class="posttext">I just thought that perhaps you had more undocumented properties/procedures you'd like to have tested, but from the sounds of it, what's in the examples is all there is.<br />
<br />
In response to Takhir:<br />
<br />
But installer after banner still goes to background on Win2K<br />
<br />
I've compiled all the included examples on my Win2K computer using NSIS 2.04 and did not see the same symptoms--the installer always stays in front.  Were those tests done with the included  example scripts or something different?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">3rd February 2005, 07:35</div></div><div class="posttext">This happens on my comp with all (3) included nsi examples. Win2K Server Rus, SP2, NSIS 2.04. Pentium II 400, 256 MB :)<br />
I see installer page for a short time (~0.5 sec) in the foreground, but after this page goes to background, while it's task bar item continue flashing (focus not lost?).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">3rd February 2005, 16:31</div></div><div class="posttext">hmmm, Strange...<br />
My PC is Win2k Pro w/ SP4.  Do you think the SP might be the problem?  <br />
<br />
(I'd test it, but unfortunately, I don't have any spare Win2k computers...)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">3rd February 2005, 17:46</div></div><div class="posttext">This may be slow comp... <br />
BTW KichiK also wrote about background problem (4-th post of this thread).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">3rd February 2005, 20:19</div></div><div class="posttext">BTW KichiK also wrote about background problem<br />
<br />
Yes, but was before adding the feature ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">4th February 2005, 04:28</div></div><div class="posttext">I was experimenting with the banner on an XP pro computer and Win2K.  I seem to get fairly consistant errors whenever I use a silent installer with the banner and a message box displaying with the .onInstSuccess callback.  <br />
<br />
Here's a simplified example script:<br />
<br />
!define PRODUCT &quot;MSIBanner&quot;<br />
<br />
Name ${PRODUCT}<br />
OutFile &quot;${PRODUCT}2.exe&quot;<br />
ShowInstDetails show<br />
;XPStyle on<br />
<br />
Function .onInit<br />
SetSilent silent<br />
MSIBanner::Show /NOUNLOAD &quot;NSIS Installer - ${PRODUCT}&quot;<br />
MSIBanner::Move /NOUNLOAD 20 &quot;Countdown to destruction 5&quot;<br />
MSIBanner::Pos /NOUNLOAD 100 &quot;Cleaning....&quot;<br />
FunctionEnd<br />
<br />
Function .onInstSuccess<br />
   MessagebOX MB_OK &quot;DONE!&quot;<br />
FunctionEnd<br />
<br />
Section -default<br />
MSIBanner::Destroy<br />
DetailPrint &quot;Works great!&quot;<br />
SectionEnd<br />
<br />
<br />
If I remove the calls to MSIBanner, it seems to work fine.  It also seems to be ok if I REM the SetSilent line. (Example error is attached.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">4th February 2005, 14:33</div></div><div class="posttext">Of course... there aren't windows or dialogs which the banner attached to it...<br />
<br />
The MSIBanner isn't a standalone one ;) <br />
Needs a parent window.<br />
<br />
BIG EDIT:<br />
Just test the code ... and I don't get any errors:<br />
<br />
!define PRODUCT &quot;MSIBanner&quot;<br />
<br />
Name ${PRODUCT}<br />
OutFile &quot;${PRODUCT}2.exe&quot;<br />
ShowInstDetails show<br />
;XPStyle on<br />
<br />
Function .onInit<br />
SetSilent silent<br />
MSIBanner::Show /NOUNLOAD &quot;NSIS Installer - ${PRODUCT}&quot;<br />
Sleep 1000<br />
MSIBanner::Move /NOUNLOAD 20 &quot;Countdown to destruction 5&quot;<br />
Sleep 1000<br />
MSIBanner::Pos /NOUNLOAD 100 &quot;Cleaning....&quot;<br />
Sleep 1000<br />
FunctionEnd<br />
<br />
Function .onInstSuccess<br />
   MessagebOX MB_OK &quot;DONE!&quot;<br />
FunctionEnd<br />
<br />
Section -default<br />
MSIBanner::Destroy<br />
DetailPrint &quot;Works great!&quot;<br />
SectionEnd<br />
<br />
Be sure to have the lastest version of the MSIBanner... <br />
WOW! Works even in silent mode :up:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">4th February 2005, 20:45</div></div><div class="posttext">Your explanation makes perfect sense!  (And once you do it right, it works like a charm!)<br />
;)<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">14th February 2005, 15:33</div></div><div class="posttext">2 new questions:<br />
I have situations where I launch applications during an install.  The applications I use a banner page that displays while the app is initializing. The problem is that the banner of the other apps covers MSI Banner's window.<br />
<br />
Is it possible to force the MSI Banner to the top of all other windows?  Or is it posible to set the position of MSI Banner on the screen?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th February 2005, 16:41</div></div><div class="posttext">Try using BringToFront to bring the installer to the top.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">14th February 2005, 20:28</div></div><div class="posttext">Is it possible to force the MSI Banner to the top of all other windows?<br />
<br />
Do what Stu said :D<br />
<br />
Or is it posible to set the position of MSI Banner on the screen?<br />
<br />
Maybe on next release ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">14th February 2005, 20:31</div></div><div class="posttext">Thanks guys!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">30th July 2006, 10:47</div></div><div class="posttext">could you make it support InstallColors and InstProgressFlags in future?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">30th July 2006, 12:52</div></div><div class="posttext">Originally posted by Joel <br />
The MSIBanner isn't a standalone one ;) <br />
Needs a parent window. <br />
<br />
i take it that's why the attached example doesn't work?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>