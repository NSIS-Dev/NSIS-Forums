<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Use of conditional compilation !if with &amp;&amp;, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Use of conditional compilation !if with &amp;&amp; NSIS Discussion" />
	
	<title> Use of conditional compilation !if with &amp;&amp; [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Use of conditional compilation !if with &amp;&amp;</div>
<hr />
<div class="pda"><a href="t-266654.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=266654">Use of conditional compilation !if with &amp;&amp;</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">gus38</div><div class="date">26th February 2007, 14:16</div></div><div class="posttext">Hello,<br />
<br />
I'm trying to use the conditional compilation !if with boolean comparison &amp;&amp; but it seems not working well.<br />
<br />
My code :<br />
!define SECTIONDEF 0x0001 <br />
<br />
!insertmacro CreateSection SECTIONDEF &quot;SECTIONNAME&quot; &quot;SECIDX&quot;<br />
<br />
!macro CreateSection SecDef SecText SecIdx<br />
!echo &quot;secname = ${${SecDef}}&quot;<br />
  !if ${${SecDef}} &amp;&amp; 0x0008<br />
    Section &quot;!${SecText}&quot; ${SecIdx}  ; comparison true<br />
  !else<br />
    Section &quot;${SecText}&quot; ${SecIdx}   ; comparison false<br />
  !endif<br />
  SectionIn RO 1 2<br />
!macroend<br />
<br />
I change the value of SECTIONDEF, but it always pass thru the true section code.<br />
<br />
Do you have any idea ?<br />
<br />
Thank you and sorry for my bad english</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th February 2007, 19:44</div></div><div class="posttext">What exactly are you trying to do? Double ampersand is a boolean operator not a binary operator. Your test only tells if both defines are not empty.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gus38</div><div class="date">27th February 2007, 20:38</div></div><div class="posttext">Yes, thank you. :up: <br />
I saw after posting this thread that it was only a boolean operator.:D<br />
I have submitted a feature request on Sourceforge for a binary operator &quot;&amp;&quot;, in order to test only a bit on a define value.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th February 2007, 20:56</div></div><div class="posttext">Thought that was you... You already have !define /math for that. It doesn't have bitwise AND, OR and XOR operators but I've added that for the next version.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gus38</div><div class="date">27th February 2007, 22:19</div></div><div class="posttext">Just a precision : for !define with /math option, the value of define is the result of the operation ?<br />
<br />
In my case, I'd like to check if some bits are present on a define value to create the section.<br />
For example, if bit 1 and 4 of SECTIONDEF(=9) are set, I will declare my section like this : <br />
 Section &quot;!SECTEXT&quot;<br />
 SectionIn 1<br />
<br />
This is in order to make different packages with only one common file with NSIS code and different headers file to define the behavior of sections (including the common file).<br />
<br />
I hope you understand what I mean.<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th February 2007, 22:22</div></div><div class="posttext">Then do:!define /math result ${somedef} &amp; 0x008<br />
!if ${result} != 0<br />
#...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gus38</div><div class="date">27th February 2007, 22:52</div></div><div class="posttext">But I can't define two time &quot;result&quot;, and I'd like to check different bit on different case.<br />
<br />
I can use different define name, but if I use it in macro, it will create a lot of define.<br />
<br />
The code I'd like to do :<br />
!macro CreateSection SecDef SecText SecIdx<br />
!if ${${SecDef}} == 0<br />
  Section &quot;-${SecText}&quot; ${SecIdx}<br />
!else<br />
  !if ${${SecDef}} &amp; 0x0008<br />
    Section &quot;!${SecText}&quot; ${SecIdx}<br />
  !else<br />
    Section &quot;${SecText}&quot; ${SecIdx}<br />
  !endif<br />
  !if ${${SecDef}} &amp; 0x0001<br />
    SectionIn 1<br />
  !endif<br />
  !if ${${SecDef}} &amp; 0x0002<br />
    SectionIn 2<br />
  !endif<br />
  !if ${${SecDef}} &amp; 0x0004<br />
    SectionIn RO<br />
  !endif<br />
!endif<br />
!macroend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st March 2007, 19:04</div></div><div class="posttext">Then !undef result right after you use it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gus38</div><div class="date">1st March 2007, 19:57</div></div><div class="posttext">I forgot it.<br />
Thanks</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>