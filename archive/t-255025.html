<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait without the Dos Window, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait without the Dos Window NSIS Discussion" />
	
	<title> ExecWait without the Dos Window [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait without the Dos Window</div>
<hr />
<div class="pda"><a href="t-255025.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=255025">ExecWait without the Dos Window</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bambou51</div><div class="date">7th September 2006, 07:54</div></div><div class="posttext">I was using nsexec::ExecToStack to run command lines during my setup, then in the next step I was pushing variables into the stack and calling functions, and I was getting the output of the command line within the function I called:<br />
For example in the following script, I get the output of the <br />
&quot;iisreset /stop&quot; command in my messagebox.<br />
I know that if I were using $2 for example to store my string I  would have avoid this problem, but is there a way to force ExecToStack to wait until the execution is done ?<br />
I know I can provide it with a timeout but sometimes it will take a few seconds somteimes 1 minute and I don't want to wait for the worth case scenario.<br />
<br />
<br />
Function func1<br />
Pop $0<br />
MessageBox MB_OK &quot;$0&quot;<br />
FunctionEnd<br />
<br />
nsExec::ExecToStack 'iisreset /stop'<br />
StrCpy $0 &quot;some text&quot;<br />
Call func1<br />
<br />
<br />
Then if I replace nsExec::ExecToStack with ExecWait, it is doing exactely what I need, but a Dos window is displayed. Is it possible to hide it ?<br />
Do you have any suggestions ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">7th September 2006, 20:17</div></div><div class="posttext">If ExecWait is working for you, try ExecDos::exec.  I have used that command to run all sorts of command line things with no dos window pop up.  You will need the plug in of course, you can get it here:  http://nsis.sourceforge.net/ExecDos_plug-in<br />
<br />
Hope this helps.<br />
Jnuw</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">8th September 2006, 07:57</div></div><div class="posttext">nsExec waits started (a) process to exit. The only confusing situation is third process (b) executed by process (a) started from nsExec :) ExecWait might wait console window to close. Try ExecCmd plug-in, or use comSpec http://forums.winamp.com/showthread.php?s=&amp;threadid=154414&amp;highlight=comspec in the command line.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>