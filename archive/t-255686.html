<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" nsExec, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  nsExec NSIS Discussion" />
	
	<title> nsExec [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  nsExec</div>
<hr />
<div class="pda"><a href="t-255686.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=255686">nsExec</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">rajiv naravane</div><div class="date">17th September 2006, 18:44</div></div><div class="posttext">Documentation says :<br />
nsExec will execute command-line based programs and capture the output without opening a dos box.<br />
This is really a nice feature.<br />
Question is, does it behave like ExecWait and waits till the program terminates or there is error executing the program?<br />
Do I need to specify any timeout option to make it behave like ExecWait()<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd September 2006, 10:05</div></div><div class="posttext">Yes, it waits.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rajiv naravane</div><div class="date">22nd September 2006, 14:47</div></div><div class="posttext">Thanks, Kichik. A follow up question: As part of the installation, I need to stop, remove, uninstall and reinstall one or more Windows services on Windows 2000 and Windows 2003 server platforms.<br />
Currently I am using ExecWait 'net start' etc. If the service can not be stopped (and it could happens in production environment) and goes into error state, is ExecWait() going to hang? Would nsExec with timeout parameters be a better option? With nsExec I can retry and eventually pop up a dialog box indicating error -- What do you think? <br />
I have seen some plugins as well which use C APIs to talk to ServiceControl manager? Is this approach any better than 'net start' etc commands when it comes to handling errors -- That's the most important thing for me. <br />
Thanks for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd September 2006, 14:53</div></div><div class="posttext">The plug-ins (http://nsis.sourceforge.net/How_do_I_start/stop/create/remove/check_a_service) are built especially for handling services, so I'd imagine they have better error handling then ExecWait or nsExec for this specific case. Besides, using API is always better than a command line utility which may not have the same interface in future versions, on different languages or might not even exist in older versions of Windows.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rajiv naravane</div><div class="date">22nd September 2006, 14:57</div></div><div class="posttext">Would ExecWait() hang, though or it recovers gracefully? Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd September 2006, 14:58</div></div><div class="posttext">It'll wait until the process it executed returns. If the process hangs, it'll hang.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rajiv naravane</div><div class="date">22nd September 2006, 15:02</div></div><div class="posttext">I guess then, I have two choices to recover gracefully from errors:<br />
Use nsExec with timeout, parse its output and retry or show error dialog.<br />
Go for the plugin approach.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>