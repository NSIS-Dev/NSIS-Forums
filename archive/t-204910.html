<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" lzma compression no worky?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  lzma compression no worky? NSIS Discussion" />
	
	<title> lzma compression no worky? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  lzma compression no worky?</div>
<hr />
<div class="pda"><a href="t-204910.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=204910">lzma compression no worky?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">14th January 2005, 19:08</div></div><div class="posttext">I've got an installer I've been making recently that uses lzma compression.  Only recently every time I try to make said installer I get the following result from makensis trying to build the script...<br />
<br />
Error: deflateToFile: deflate() failed(-4 input/output error) Error - aborting creation process<br />
<br />
Wha happen?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">17th January 2005, 20:38</div></div><div class="posttext">No thoughts?  Anyone? I'm curious because this problem is fairly important for me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">17th January 2005, 23:01</div></div><div class="posttext">out of space on the drive that contains the temp dir?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">18th January 2005, 14:48</div></div><div class="posttext">Doubt it but not a bad guess.  I've got about 2GB worth of free space on the drive I'm using.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th January 2005, 18:10</div></div><div class="posttext">There was a problem with clzma.cpp that caused it to return LZMA_IO_ERROR (the error you're seeing) instead of LZMA_THREAD_ERROR. I've attached the new fixed version. If you have a compiler, please recompile with it and let me know if the error is still LZMA_IO_ERROR.<br />
<br />
Now, time for some details. Which version of NSIS are you using? Have you compiled makensis.exe on your own? Does it happen only with that specific installer or with others too? Do you get a similar error with bzip2 or zlib compression?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">18th January 2005, 21:31</div></div><div class="posttext">Compiled it.  Tried it.  Works.  You're the King kichik.  In responses to your questions...<br />
<br />
-The version I'm using is daily snapshot 2.04 build 22.  I believe I installed it on January 6th.  <br />
<br />
-Never compile makensis except for testing the file you attached.  I usually just run the daily snapshot installer.<br />
<br />
-I haven't tried many other installers with it.  I don't have any other installers I can test with.  The only minor tests I've done is to eliminate all the files except for license files to be included in the installer so there's only script code and that works fine. <br />
<br />
-The problem only occurs with lzma.  bzip2 and zlib seem to work fine, they've never failed for me so I've always been happy to have them as alternatives.<br />
<br />
Once again kichik thanks very much!  If you need any more details I am at your disposal.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th January 2005, 19:20</div></div><div class="posttext">Well... Hmm... It wasn't supposed to fix it. Recompiling probably just hid the problem. Does the problem still go away if you recompile with the old version of clzma.cpp? You can test it with the examples that come with NSIS. makensis.nsi uses lzma too and contains more than one file. It should be a good example.<br />
<br />
BTW, Build 22 is 2.04 :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th January 2005, 20:31</div></div><div class="posttext">Heh, seems I've been updating build numbers for nothing. It's not even used if it's not the same major, minor and revision version. It will be zero for 2.05 :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">21st January 2005, 19:26</div></div><div class="posttext">Originally posted by kichik <br />
Well... Hmm... It wasn't supposed to fix it. Recompiling probably just hid the problem. Does the problem still go away if you recompile with the old version of clzma.cpp? You can test it with the examples that come with NSIS. makensis.nsi uses lzma too and contains more than one file. It should be a good example.<br />
<br />
BTW, Build 22 is 2.04 :)  <br />
<br />
Conveniently rebuilding using the non modified clzma.cpp does work as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st January 2005, 20:07</div></div><div class="posttext">That's weird... Does the original makensis.exe work now too?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">21st January 2005, 22:13</div></div><div class="posttext">It appears to be working off and on now with the original now.  I don't know what to say.  So far I've had more luck using the rebuilt source.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st January 2005, 22:36</div></div><div class="posttext">Maybe there really is an IO error. Does it happen on other computers?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">21st January 2005, 23:38</div></div><div class="posttext">I'll be trying that next week, we'll see.  Thanks for all your help kichik.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">27th January 2005, 19:14</div></div><div class="posttext">Seems to be working fine on other machines.  Could be the error was valid.  Anyways I'm happy I've got some alternatives if anything goes wrong again.  Thanks for your help kichik.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th January 2005, 20:05</div></div><div class="posttext">If it doesn't happen on other machines, it might be the memory - lzma uses a lot of it. Try testing your memory with memtest86.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">2nd February 2005, 03:22</div></div><div class="posttext">So I open up my work computer to take a look that everythings working properly and it turns out some of the capacitors on the motherboard are starting to melt.  That's the best way I can think of to describe it.  There is some sort of substance being emitted from the capacitors.  <br />
<br />
Anyways after discovering that I switched to a new (and conveniently faster) machine and am back making installers with good old lzma compression.  Just like the good times again.  I don't think memory was the problem, likely it was some kind of issue with the motherboard.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd February 2005, 18:52</div></div><div class="posttext">Right, melted capacitors are a no-go with lzma. I'll have to remember that :)<br />
<br />
Congratulations on your new computer :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">HGOwen</div><div class="date">5th February 2005, 10:29</div></div><div class="posttext">The capacitors havent melted.<br />
<br />
Theyre cheapo capacitors from Taiwan and use a Water based Electrotyte.<br />
<br />
The Electrotyte is incomplete, and thus they release Hydrogen in use. This makes them bulge and eventually pop.<br />
<br />
EDIT: Spelling</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">7th February 2005, 18:11</div></div><div class="posttext">Thanks for the exaplanation HG, that's pretty much what I saw.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">peterob</div><div class="date">8th February 2005, 08:11</div></div><div class="posttext">Off-topic - dodgy caps<br />
<br />
Replace the caps and the board will work perfectly again. I've recovered upwards of 50 boards that way.<br />
<br />
The caps that go, in my experience, are usually the 6.3V, 1000 microfarad ones, those that haven't popped will in time.<br />
<br />
You've got nothing to lose, anyway.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">8th February 2005, 17:15</div></div><div class="posttext">That's true but I ain't no electrical engineer and the boards not mine, it's my companies.  It's a good idea for sure but I don't know if it'll happen.  Thanks for the idea though.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>