<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to install .net from CD rather than internet, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to install .net from CD rather than internet NSIS Discussion" />
	
	<title> How to install .net from CD rather than internet [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to install .net from CD rather than internet</div>
<hr />
<div class="pda"><a href="t-292417.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=292417">How to install .net from CD rather than internet</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">28th May 2008, 16:58</div></div><div class="posttext">I am working on an installer and now we have a requirement to have .net 2.0 as a prerequisite.  <br />
<br />
However, the program is designed for non-networkable machines.  As such, I'd like to include the binary on the software cd and have the installer detect if it is needed.  <br />
<br />
It will determine if it is needed or not.  Then will say it is strongly recommended, install y/n.  <br />
<br />
then install from cd, after, continue nsis installation.<br />
<br />
is this possible?  better ideas?<br />
<br />
thanks and regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th May 2008, 21:35</div></div><div class="posttext">Sure.<br />
<br />
To check if v2 is installed or not:<br />
System::Call `mscoree::GetCORVersion(w .R0, i ${NSIS_MAX_STRLEN}, *i) ?u`<br />
StrCpy $R0 $R0 1 1<br />
You should compare if $R0 &lt; 2 using ${If} or IntCmp.<br />
<br />
To install,<br />
<br />
ExecWait `&quot;$EXEDIR\DOTNET\dotnetfx.exe&quot; /q:a /c:&quot;install.exe /noaspupgrade /q&quot;` $R0<br />
<br />
$R0 will be 0 on success.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">28th May 2008, 21:44</div></div><div class="posttext">Can you please specify what the rest of the parameters and flags are doing in the execwait...<br />
<br />
Mainly /q: a /c: &quot;install.exe&quot; ...<br />
<br />
so i can put this in the oninit function, show dialogue, if yes install .net, if no, just proceed with rest of install?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th May 2008, 22:19</div></div><div class="posttext">1. Look it up on Google.<br />
2. Use MessageBox.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">29th May 2008, 14:39</div></div><div class="posttext">Is it possible not to use extracting to C drive?  Perhaps use an msi file directly instead?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">29th May 2008, 17:55</div></div><div class="posttext">You don't need to extract anything. Just run the dotnetfx.exe directly from the CD. That path you specify in your ExecWait instruction defines that. If you have your main setup on the root of the CD then $EXEDIR will give that root (i.e. D:\).<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>