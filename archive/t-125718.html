<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Setting Environment Variables, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Setting Environment Variables NSIS Discussion" />
	
	<title> Setting Environment Variables [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Setting Environment Variables</div>
<hr />
<div class="pda"><a href="t-125718.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=125718">Setting Environment Variables</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">vrunda</div><div class="date">20th February 2003, 04:38</div></div><div class="posttext">hello,<br />
 I am new to the NSIS installer.During installation i need to set values for environment variables,like (classpath for java etc)<br />
 How do i do this,<br />
thanks in advance<br />
-vrunda</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th February 2003, 05:02</div></div><div class="posttext">This should do the trick:<br />
<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=91<br />
<br />
Unless you want to temporarily set it for just the current process and sub-processes you will run from the installer and then you'll need:<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=124089&amp;highlight=environment</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vrunda</div><div class="date">20th February 2003, 09:20</div></div><div class="posttext">hello,<br />
 could not make it work,i need to set the variable values for system variables,<br />
with the following code<br />
 StrCpy $1 &quot;value&quot;<br />
 WriteRegStr HKU &quot;Environment&quot; &quot;variable&quot; $1<br />
 i am not able to set the values for the variable.but with same code i can set the value for current user variables.<br />
  how do i do this,<br />
is any simple way out to this,other than .dll etc?<br />
thanks <br />
-Vrunda</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th February 2003, 12:59</div></div><div class="posttext">Oops, sorry... Wrong link.<br />
<br />
Here is the right one:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=100735&amp;highlight=writeenvstr</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vrunda</div><div class="date">21st February 2003, 05:54</div></div><div class="posttext">hello,<br />
 thanks for the reply,but could not open the code link :( FYI i am working on windows 2000 platform.<br />
 Why i am not able to set the variable values for all users(like other system variables) with the code<br />
 StrCpy $1 &quot;value&quot; <br />
 WriteRegStr HKU &quot;Environment&quot; &quot;variable&quot; $1<br />
How do i do this?<br />
thanks in advance<br />
-Vrunda</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st February 2003, 10:25</div></div><div class="posttext">HKU is not the right place to write it. I have created a new archive page that explains it all:<br />
http://nsis.sourceforge.net/archive/nsisweb.php?page=156&amp;instances=0,11<br />
<br />
Have a look at the ALL_USERS define I have added, that's what you need.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vrunda</div><div class="date">22nd February 2003, 06:51</div></div><div class="posttext">hello<br />
 not working on NT platform.<br />
The code in the .nsi file is<br />
<br />
!verbose 3<br />
!include functions.nsh<br />
!verbose 4<br />
<br />
Section<br />
	Push &quot;JAVA_HOME&quot;<br />
	Push &quot;c:\jdk&quot;<br />
	Call WriteEnvStr<br />
SectionEnd<br />
<br />
Section uninstall<br />
  # remove the variable  <br />
  Call un.DeleteEnvStr<br />
SectionEnd<br />
<br />
 and the <br />
.nsh file has the functions in the code given by you.<br />
no error is generated,and still the value is not set. :(<br />
How do i do this.<br />
thanks in advance<br />
-Vrunda</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd February 2003, 10:49</div></div><div class="posttext">According to this code the environment variable will be written into HKCU\Environment. You didn't define ALL_USERS before including functions.nsh. Are you sure it's not in HKCU\Environment? If it's not, attach your script and I will create a testing script for you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vrunda</div><div class="date">28th February 2003, 11:46</div></div><div class="posttext">hello,<br />
 sorry for the delay in reply.Was a bit busy in some other issues. the .nsi file code goes like this<br />
<br />
;The name of the installer<br />
Name &quot;TEMP&quot;<br />
<br />
;The file to write<br />
OutFile &quot;Temp.exe&quot;<br />
<br />
InstallDir $WINDIR\Temp2<br />
<br />
<br />
;Texts on the dialogs<br />
<br />
InstType Typical<br />
!define ALL_USERS<br />
<br />
!verbose 3<br />
!include &quot;functions.nsh&quot; ;includes the script provided by you<br />
!verbose 4<br />
<br />
Section &quot;Add to path&quot;<br />
  PUSH &quot;USERDIR&quot;<br />
  PUSH &quot;c:/temp1&quot;<br />
  Call WriteEnvStr  <br />
SectionEnd<br />
  Waiting for your reply<br />
thanks in advance<br />
-Vrunda Divekar</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th February 2003, 11:55</div></div><div class="posttext">Please try the latest NSIS, version 2.0b2. There was a bug with the defines.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th February 2003, 22:28</div></div><div class="posttext">Please get the latest code too as there was a &quot;Control\&quot; missing in the registry path. Together with NSIS 2.0b2 it should really work this time ;) I have tested it yet again and it worked.<br />
<br />
http://nsis.sourceforge.net/archive/nsisweb.php?page=156&amp;instances=0,11</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vrunda</div><div class="date">1st March 2003, 04:39</div></div><div class="posttext">hello,<br />
 The new code you have given works well :) thanks very much<br />
thanks and regards<br />
-Vrunda</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>