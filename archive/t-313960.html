<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with $SYSDIR  in VISTA, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with $SYSDIR  in VISTA NSIS Discussion" />
	
	<title> Problem with $SYSDIR  in VISTA [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with $SYSDIR  in VISTA</div>
<hr />
<div class="pda"><a href="t-313960.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=313960">Problem with $SYSDIR  in VISTA</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ron@weronet.com</div><div class="date">18th October 2009, 10:56</div></div><div class="posttext">Hi Forum,<br />
I have a problem with $SYSDIR.<br />
If I install on XP every think works but when install on Vista I have a Problem with the â€œProgramme Dir.â€<br />
<br />
After installing, the programme-tree looks like<br />
<br />
Programme<br />
..Common Files<br />
..Crystal Decisions<br />
...microsoft shared<br />
..myprogramm<br />
Programme<br />
..Gemeinsame Dateien<br />
...Crystal Decisions<br />
...Microsoft Shared   <br />
<br />
The installation adds the second programm-dir exact as I write it down.<br />
<br />
If I copy myprogramm from <br />
<br />
Programme\<br />
..Common Files<br />
..myprogramm <br />
to<br />
Programme\ <br />
..Gemeinsame Dateien<br />
..myprogramm <br />
<br />
it works.<br />
<br />
Is it a language problem? Or a wrong  !define?<br />
<br />
<br />
This is a part of my definition <br />
<br />
<br />
<br />
!define LOCALSYS32DIR &quot;C:\WINDOWS\SYSTEM32&quot; ;Location of SYSTEM32 on machine building script<br />
!define VFPFILESDIR &quot;C:\Programme\Gemeinsame Dateien\Microsoft Shared\VFP&quot; ;Location of VFP runtime files on machine building script<br />
<br />
<br />
Var ALREADY_INSTALLED<br />
<br />
Section &quot;libvfp&quot;<br />
SetOutPath &quot;${VFPFILESDIR}&quot;<br />
  StrCpy $ALREADY_INSTALLED &quot;&quot;<br />
  !insertmacro InstallLib DLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;${LOCALSYS32DIR}\msvcr70.dll&quot; &quot;$SYSDIR\msvcr70.dll&quot; $SYSDIR<br />
;  !insertmacro InstallLib DLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;$SYSDIR\msvcr70.dll&quot; &quot;$SYSDIR\msvcr70.dll&quot; $SYSDIR<br />
  !insertmacro InstallLib DLL    $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;${VFPFILESDIR}\vfp7rdeu.dll&quot; &quot;$COMMONFILES\Microsoft Shared\VFP\vfp7rdeu.dll&quot; &quot;$COMMONFILES\Microsoft Shared\VFP&quot;<br />
  !insertmacro InstallLib DLL    $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;${VFPFILESDIR}\vfp7renu.dll&quot; &quot;$COMMONFILES\Microsoft Shared\VFP\vfp7renu.dll&quot; &quot;$COMMONFILES\Microsoft Shared\VFP&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;${VFPFILESDIR}\vfp7t.dll&quot; &quot;$COMMONFILES\Microsoft Shared\VFP\vfp7t.dll&quot; &quot;$COMMONFILES\Microsoft Shared\VFP&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;${VFPFILESDIR}\vfp7r.dll&quot; &quot;$COMMONFILES\Microsoft Shared\VFP\vfp7r.dll&quot; &quot;$COMMONFILES\Microsoft Shared\VFP&quot;<br />
sectionEnd<br />
<br />
!define CRYSTALDIR &quot;C:\Programme\Gemeinsame Dateien\Crystal Decisions\2.0\bin&quot;<br />
!define CRYSTALSLRECDIR &quot;C:\Programme\Gemeinsame Dateien\Crystal Decisions\2.0\crystalreportviewers\ActiveXViewer&quot;<br />
<br />
<br />
Section &quot;libcryst&quot;<br />
  SetOutPath &quot;${CRYSTALDIR}&quot;<br />
  StrCpy $ALREADY_INSTALLED &quot;&quot;<br />
  !insertmacro InstallLib DLL    $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;${CRYSTALDIR}\crdb_ado.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin\crdb_ado.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin&quot;<br />
  !insertmacro InstallLib DLL    $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;${CRYSTALDIR}\crdb_ado_res_de.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin\crdb_ado_res_de.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin&quot;<br />
  !insertmacro InstallLib DLL    $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;${CRYSTALDIR}\crdb_dao.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin\crdb_dao.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin&quot;<br />
  !insertmacro InstallLib DLL    $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;${CRYSTALDIR}\crdb_odbc.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin\crdb_odbc.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin&quot;<br />
  !insertmacro InstallLib DLL    $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;${CRYSTALDIR}\crdb_olap.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin\crdb_olap.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin&quot;<br />
  !insertmacro InstallLib DLL    $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;${CRYSTALDIR}\crheapalloc.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin\crheapalloc.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin&quot;<br />
  !insertmacro InstallLib DLL    $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;${CRYSTALDIR}\crqe_res_de.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin\crqe_res_de.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin&quot;<br />
  !insertmacro InstallLib DLL    $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;${CRYSTALDIR}\querybuilder.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin\querybuilder.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin&quot;<br />
  !insertmacro InstallLib DLL    $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;${CRYSTALDIR}\querybuilder_res_DE.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin\querybuilder_res_DE.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;${CRYSTALDIR}\crtslv.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin\crtslv.dll&quot; &quot;$COMMONFILES\Crystal Decisions\2.0\bin&quot;<br />
sectionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>