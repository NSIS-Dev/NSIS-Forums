<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to make MyApp that install with NSIS list in system restore point?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to make MyApp that install with NSIS list in system restore point? NSIS Discussion" />
	
	<title> How to make MyApp that install with NSIS list in system restore point? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to make MyApp that install with NSIS list in system restore point?</div>
<hr />
<div class="pda"><a href="t-69086.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=69086">How to make MyApp that install with NSIS list in system restore point?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Didin17</div><div class="date">18th December 2001, 05:02</div></div><div class="posttext">How to make MyApp that install with NSIS list in system restore point, like in Win ME or Win XP<br />
<br />
I'm sorry about my English.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DuaneJeffers</div><div class="date">18th December 2001, 06:03</div></div><div class="posttext">From my knowledge of WinME/XP, the system restore function is built in to the Windows Kernel and it just checks to see and restore to a better version. System Restore doesn't check programs and things. (I had an experience with this. When I was done, I was using NSIS v 1.1j ... When I was supposed to have NSIS Version 1.44. And I had no MS Word, so anything can happen).<br />
<br />
-Duane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">prodangle</div><div class="date">23rd December 2001, 15:21</div></div><div class="posttext">With System restore, windows simply reverts back to the state the system was in the last time a restore point was created, so you'd have to create a restore point just after installing your app.  As for creating a restore point, I have no idea how - but I imagine if there was a way it would add a good 15 minutes onto the programs installation time.  If that's going to happen - you'd be as well to use Microsoft's own installer.  I imagine it would handle the system restore stuff a lot better and wouldn't miss anything out.  Otherwise, you could simply show a messagebox asking whether the user would like to create a restore point, and if so run<br />
<br />
%SystemRoot%\System32\restore\rstrui.exe<br />
<br />
I believe this will be at a differant location for win me<br />
<br />
First you'd obviously have to check that the OS the person is using supports system restore, and whether or not it is turned on (I always turn system restore off).  You could use the OS detection script found in functions.htm for the first bit, and check the following reg key to see whether it is turned on or not<br />
<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore\DisableSR: 0x00000001<br />
<br />
My advice would be don't bother though.  If your application isn't so clunky that it might actually do damage to the operating system, then a simple uninstall should be good enough :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>