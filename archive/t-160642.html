<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Using NSIS to reinstall missing dependencies when starting up?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Using NSIS to reinstall missing dependencies when starting up? NSIS Discussion" />
	
	<title> Using NSIS to reinstall missing dependencies when starting up? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Using NSIS to reinstall missing dependencies when starting up?</div>
<hr />
<div class="pda"><a href="t-160642.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=160642">Using NSIS to reinstall missing dependencies when starting up?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">janedoe2003</div><div class="date">18th December 2003, 21:36</div></div><div class="posttext">Hi,<br />
<br />
I went through the tutorial and FAQ on NSIS' site, and read the few threads here that dealt with VB... but I didn't find what I'm looking for, namely how to check that all the app's OCX's are still there when running Main(), and fetch and reinstall them from the Net if any dependency has been replaced by a different version since the original install.<br />
<br />
Based on documents I read here and there, DependencyWalker's help file among them, checking an EXE's dependencies is error-prone, but at the very least, I'd like to write a routine that goes through the usual suspects in Main() before going any further.<br />
<br />
How do you VB guys handle this issue, to avoid the dreaded Errs 429 or (God forbid) 50003?<br />
<br />
Thank you<br />
JD.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">18th December 2003, 21:40</div></div><div class="posttext">The UpgradeDLL macro only installs the files if an older version is currently installed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th December 2003, 21:44</div></div><div class="posttext">As for the dependency check, I think you'd better ask this in a VB forum instead of here. NSIS is not an installer just for VB so you might find the answer faster in a VB oriented forum.<br />
<br />
As for downloading and installing a new version, you can do that using the NSISdl plug-in (see Contrib\NSISdl) and the UpgradeDLL macro (see docs). You'd also probably need to process the command line a bit using $CMDLINE and some functions that are available in the Archive for this purpose.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">18th December 2003, 21:54</div></div><div class="posttext">It's quite easy to detect which files are required by your VB application.<br />
<br />
You always have to install the VB runtime files (see NSIS documentation for details) and other controls or DLLs you are using for your project (see controls and references in the VB IDE).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>