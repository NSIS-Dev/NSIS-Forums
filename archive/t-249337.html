<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Executing function from dll with parameters, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Executing function from dll with parameters NSIS Discussion" />
	
	<title> Executing function from dll with parameters [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Executing function from dll with parameters</div>
<hr />
<div class="pda"><a href="t-249337.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=249337">Executing function from dll with parameters</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bigbluestranger</div><div class="date">22nd June 2006, 10:20</div></div><div class="posttext">Hi,<br />
I have a following problem:<br />
<br />
I'm creating install program and I use some functions from external dll library.If one of my function in dll library has no parameters it works correctly.<br />
But I have to use function with parameter:<br />
void foo(int i)<br />
{<br />
....<br />
};<br />
I do not really know how to call this function from my nsi file(nullsoft installer script).<br />
Please help me.<br />
I'v tried this ways:<br />
<br />
VComInstaller::SetMUXPORTNAMERegistryKey 2<br />
VComInstaller::SetMUXPORTNAMERegistryKey $2<br />
VComInstaller::SetMUXPORTNAMERegistryKey &quot;2&quot;<br />
<br />
It doesn't work :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bigbluestranger</div><div class="date">22nd June 2006, 10:33</div></div><div class="posttext">I've tried do it this way too:<br />
<br />
StrCpy $0 2<br />
  System::Call ' VComInstaller::SetMUXPORTNAMERegistryKey(i r0)'<br />
<br />
Without good result ;-(.<br />
It doesn't call my function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mr Inches</div><div class="date">22nd June 2006, 12:02</div></div><div class="posttext">The first version will only work with plug-ins, so your library needs to be expecting parameters to be passed to it by NSIS.<br />
<br />
The ExDLL header file (Contrib\ExDLL\ExDLL.h) details how parameters are passed to a plugin and how a plugin can access the stack or NSIS variables. Your library needs to be in the $PLUGINSDIR to work this way too.<br />
<br />
The second form only works the other way, if your library is NOT a plug-in and expects to be called like a normal DLL.<br />
<br />
Duncan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bigbluestranger</div><div class="date">22nd June 2006, 12:13</div></div><div class="posttext">I haven't this file ;-( ExDLL.h<br />
Could You print it or send me marcin.bukowski@NOSPAMgmail.com<br />
<br />
Please remove NOSPAM from my email.<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bigbluestranger</div><div class="date">22nd June 2006, 12:17</div></div><div class="posttext">I found http://www.koders.com/c/fid1ABD22E817073E095477590CB55BFC9C6E8CE6B1.aspx<br />
but it says me nothing.<br />
Please give me short example.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">22nd June 2006, 12:17</div></div><div class="posttext">It's in the NSIS source distribution which is on the Wiki.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bigbluestranger</div><div class="date">22nd June 2006, 12:31</div></div><div class="posttext">I have this version but in my Contrib folder are only <br />
5 subfolders and ExDLL doesn't exist.<br />
Additionally i've done search for ExDLL.h file and it doesn't exist too. ;-(<br />
<br />
So where is the problem?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bigbluestranger</div><div class="date">22nd June 2006, 12:34</div></div><div class="posttext">OK, I found this file, but I don't understand how to call my function with parameters.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">22nd June 2006, 13:42</div></div><div class="posttext">You use the stack to pass it data, using popstring(buff).<br />
You need to use atoi to convert it to an integer if necessary (or use my_atoi which you can find on Google).<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>