<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Unable to read a regisgtry key, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Unable to read a regisgtry key NSIS Discussion" />
	
	<title> Unable to read a regisgtry key [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Unable to read a regisgtry key</div>
<hr />
<div class="pda"><a href="t-349179.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=349179">Unable to read a regisgtry key</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">githomas</div><div class="date">26th September 2012, 18:47</div></div><div class="posttext">I'm new to using NSIS.  I've written some Word 2010 templates and I want to write a script that will read the registry key to determine the location of the User's personal template folder, copy the new templates to this folder.  I do not need an uninstaller,  I do not need anything installed in Program files, no entries in the start menu, and no entries in the control panel.   I've started by trying to read the registry key using the following code<br />
<br />
# name testinstaller<br />
outFile &quot;testinstaller.exe&quot;<br />
!Define PerTempKey &quot;Software\Microsoft\Office\14.0\Word\Security\Trusted Locations\Location0&quot;<br />
Var PerTempFolder<br />
 # default section start<br />
section<br />
readRegStr $PerTempFolder  HKCU  PerTempKey  &quot;Path&quot;<br />
messagebox MB_OK $PerTempFolder<br />
sectionEnd<br />
<br />
The registry key is not returned.  I know the key has a value,  because I can see it in regedit.    Using HM NIS Edite 2.0.3, the code compiles but generates an execution error, <br />
WIN32 Code 740.  Requires elevation.  I'm not sure what this means.  I tried adding the command RequestExecutionLevel admin, but this did not resolve my problem.<br />
<br />
Any help would be appreciated.<br />
Gail</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">27th September 2012, 06:13</div></div><div class="posttext">You probably need to setregview 64. http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.7.6<br />
<br />
No idea what NIS Edit might be doing wrong - never used the thing. Note however that requestexecutionlevel admin does nothing at all if UAC is turned off in Windows.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>