<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Can NSIS hide a command window?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Can NSIS hide a command window? NSIS Discussion" />
	
	<title> Can NSIS hide a command window? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Can NSIS hide a command window?</div>
<hr />
<div class="pda"><a href="t-127900.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=127900">Can NSIS hide a command window?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">sauroneru</div><div class="date">10th March 2003, 07:04</div></div><div class="posttext">I just found NSIS this weekend, and I love it.  I have a strange problem that I was wondering if anyone could figure out.  I have .exe files made from Matlab, which are 16 bit .exe's that open a command window then a GUI when executed.  All I want to do is have Windows hide this command window.  The name changes on different systems and on different calls, but it's always a DOS window, and I know nothing about finding HWNDs and hiding them.  Here is NSIS code that at least runs one of these programs (though it still opens up a separate command window):<br />
<br />
Name &quot;Help&quot;<br />
OutFile &quot;bar.exe&quot;<br />
<br />
Section &quot;foo&quot;<br />
  SetOutPath &quot;c:\Program Files\Foo&quot;<br />
  ExecWait foo.exe<br />
SectionEnd<br />
Pretty simple, I'm just wondering if there's a way to use NSIS's FindWindow and HideWindow commands for this extra popup.  I tried this in C, and it usually works, but only when I know and enter the correct window title.  I like and understand NSIS, and just thought I'd ask some experts :).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sauroneru</div><div class="date">10th March 2003, 07:52</div></div><div class="posttext">I had no idea there's been so much discussion on this before.  I had just given up trying to find a solution :).  So, now I'm using<br />
SetOutPath &quot;c:\Program Files\foo&quot;<br />
  nsExec::Exec &quot;cmd /C foo.exe&quot;<br />
And I only have one question left.  I want to make the working directory the program's installation directory (there are 2 exe's here, one for the install program, and this one).  I assume this would include:<br />
<br />
; Get the install directory created by the installer exe<br />
ReadRegStr HKLM SOFTWARE\Foo &quot;Install_Dir&quot; $x<br />
<br />
But I don't know what other steps are needed to make this the working directory for nsExec.  And I love NSIS, but I've learned all I can for one weekend and need help :).<br />
<br />
Actually, this exe file will be installed in the install directory, so would it automatically start with the correct working directory?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">10th March 2003, 11:07</div></div><div class="posttext">You can use variables in command parameters. As in your example the command should look like<br />
<br />
SetOutPath &quot;$x&quot;<br />
<br />
or <br />
<br />
SetOutPath &quot;$INSTDIR&quot; <br />
<br />
as a global variable. This variable is set if you used the directory page</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th March 2003, 14:18</div></div><div class="posttext">In version 2.0b2 and above SetOutPath sets the working directory.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cybereka</div><div class="date">13th March 2003, 11:45</div></div><div class="posttext">Hai,<br />
I was searching for this thing only but i need my installer to wait to complete the exe and so i am using ExecWait. So can i have any such way to hide the cmd windows that pops out due to this call. This will help me alot. Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th March 2003, 13:26</div></div><div class="posttext">nsExec waits for the program to finish.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cybereka</div><div class="date">14th March 2003, 05:59</div></div><div class="posttext">Thank u for ur timely help. Thank u all</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumuri</div><div class="date">25th July 2004, 11:20</div></div><div class="posttext">hello<br />
<br />
excuse me, when i type <br />
<br />
 nsExec::Exec &quot;cmd /C ftp.exe&quot;<br />
<br />
where ftp.exe is the d√©fault ftp manager of windows(c:\windows\system32\)<br />
it doesn't work<br />
<br />
EDIT : i understand, nsiexe wait for the programm to end but he never end</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>