<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with uninstalling before installing, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with uninstalling before installing NSIS Discussion" />
	
	<title> Problem with uninstalling before installing [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with uninstalling before installing</div>
<hr />
<div class="pda"><a href="t-205586.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=205586">Problem with uninstalling before installing</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">SoundScape_2910</div><div class="date">22nd January 2005, 01:18</div></div><div class="posttext">Hi,<br />
<br />
I have an installer which checks whether a product is already installed or not prior to installing. I have included the following code to achieve that:<br />
<br />
ReadRegStr $Path HKCU &quot;SOFTWARE\Product\ &quot;InstallPath&quot;<br />
HideWindow<br />
ClearErrors<br />
ExecWait $Path\uninst.exe<br />
BringToFront<br />
<br />
Problem is the following: The user has the option to uninstall product or proceed without uninstallation. As soon as he hits the &quot;Uninstall&quot; button, the installer window hides and shows up immediately along with the message box of the uninstaller. In other words, the installer does not wait until uninstaller finishes but becomes visible when it is not supposed to be. Any ideas to overcome this problem?<br />
<br />
Thanks in advance! :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">22nd January 2005, 03:20</div></div><div class="posttext">the uninstaller copies itself to the temp dir, execs the exe in temp and exits (so it can delete itself). u can manually copy the uninst.exe to temp then exec it with a special command line argument ( &quot;uninst.exe _?=$instdir&quot; if i remember correctly)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">23rd January 2005, 15:43</div></div><div class="posttext">just have a look at the nsis script ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">25th January 2005, 13:46</div></div><div class="posttext">this command <br />
<br />
'uninst.exe _?=$instdir'<br />
<br />
does not work athome :(<br />
see ya</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">25th January 2005, 14:09</div></div><div class="posttext">HideWindow<br />
	ClearErrors<br />
	ExecWait '$INSTDIR\setup_KTV_tmp.exe _?=$INSTDIR'<br />
	IfErrors error<br />
	Quit<br />
	BringToFront<br />
<br />
seems to work...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th January 2005, 14:24</div></div><div class="posttext">It will only work if the uninstaller is a NSIS uninstaller. According to the behavior specified, it doesn't like it is. The following page contains information about how to make other installers wait:<br />
<br />
http://unattended.sourceforge.net/installers.php</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SoundScape_2910</div><div class="date">6th February 2005, 22:59</div></div><div class="posttext">Thanks to everyone who took the time to help me out. Using the &quot;uninst.exe _?=$instdir&quot; command, the problem was solved. Installer window does hide until uninstaller finishes. But another problem surfaced. I have more than one partition in my system and I have set drive C in such a way that a simple user is not allowed to write on it. When I tested my installer using a restricted account, the above command didn't work, i.e. installer window didn't hide. My guess is that since it is not allowed to erite on C, the uninstaller could not be extracted to the TEMP directory. My question is this: is there a way to determine at runtime what the write permissions are for a specific drive or partition? What if a system has only one drive, one partition and a part of it is restricted to a simple user? For example, folders &quot;Program Files&quot; and &quot;Windows&quot; are restricted and all other parts of drive are not. Also, is there a way to determine how many drives/partitions a system has?<br />
<br />
Many thanks in advance. I am waiting for your input on these matters.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th February 2005, 19:35</div></div><div class="posttext">The temporary directory is verified. If it's not writable, the installer won't start. There must be another problem.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>