<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installing into a selected user account, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installing into a selected user account NSIS Discussion" />
	
	<title> Installing into a selected user account [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installing into a selected user account</div>
<hr />
<div class="pda"><a href="t-300096.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=300096">Installing into a selected user account</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">NB-Dexter</div><div class="date">19th November 2008, 14:59</div></div><div class="posttext">I want to allow the user to select a user account for installation.  So far, I can escalate the current user to admin, show a list of all available users, and pre-select the current user account.  My problem is getting the SetShellVarContext to reflect the selected user account when it is set to &quot;current&quot;.  I need access to HKCU and LOCALAPPDATA for that user.<br />
<br />
I've looked at multiuser.nsh but it doesn't seem to do what I want.<br />
<br />
Any advice would be appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">19th November 2008, 19:24</div></div><div class="posttext">Why not just have the user run the installer, no need to elevate or anything, that's how most setups do this. <br />
<br />
If you want to do it the hard way, you must load the users profile and redirect HKCU with RegOverridePredefKey (windows2000 and later, call with the system plugin). There is no way to override the folder constants in nsis, the best you can do is to get the path with SHGetFolderPath and use that path and not $localappdata, but to do this, you need the users token, and to get the token, the user needs to provide the password IIRC. Do you really want the user to first enter admin credentials and then credentials for a second user?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NB-Dexter</div><div class="date">19th November 2008, 20:14</div></div><div class="posttext">Originally posted by Anders <br />
Why not just have the user run the installer, no need to elevate or anything, that's how most setups do this. <br />
<br />
I had a request for this functionality so I was researching the possibility.  You're right, it is the hard way.  I'll just require them to run the installer from the user account they want it installed into.<br />
<br />
Thanks for the reply.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>