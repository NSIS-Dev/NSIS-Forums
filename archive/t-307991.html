<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Jump to installer section after computer restart, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Jump to installer section after computer restart NSIS Discussion" />
	
	<title> Jump to installer section after computer restart [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Jump to installer section after computer restart</div>
<hr />
<div class="pda"><a href="t-307991.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=307991">Jump to installer section after computer restart</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kporter20</div><div class="date">5th July 2009, 08:56</div></div><div class="posttext">Hi, as part of an installer I am creating I need to install Windows Installer 4.5 as a pre-requisite to SQL Express 2008. <br />
<br />
Windows Installer 4.5 requires a reboot for system changes to take effect and the SQL 2008 installer will fail to start if there is a reboot pending. <br />
<br />
I have been able to get my installer to restart after the computer restart but I need it to resume with the next selected section of the installer. Currently, it displays the Welcome page and I have to click through and select components again.<br />
<br />
I have stored the installer path in the RunOnce registry key as follows:<br />
<br />
;--------------------------------<br />
;Installer Sections<br />
Section &quot;Windows Installer 4.5&quot;<br />
  StrCpy $PRODUCTNAME &quot;Internet Tracker&quot;<br />
  SetOutPath $INSTDIR<br />
  SetShellVarContext all<br />
  <br />
  ; store where the installer should resume from<br />
  System::Call 'kernel32::GetModuleFileNameA(i 0, t .R0, i 1024) i r1'<br />
<br />
  ; $R0 will contain the installer filename<br />
  WriteRegStr HKLM Software\Microsoft\Windows\CurrentVersion\Run &quot;SetupContinue&quot; '&quot;$R0&quot;'<br />
  <br />
  ; install Windows Installer 4.5 and force reboot<br />
  File &quot;WindowsXP-KB942288-v3-x86.exe&quot;<br />
  ExecWait &quot;WindowsXP-KB942288-v3-x86.exe /passive /forcerestart&quot;<br />
  Delete &quot;WindowsXP-KB942288-v3-x86.exe&quot;<br />
SectionEnd<br />
<br />
I then have another section for .NET and this is where I need the installer to resume from.<br />
<br />
Any help and examples on how to do this would be greatly appreciated.<br />
<br />
Thanks<br />
<br />
Kevin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th July 2009, 14:17</div></div><div class="posttext">You'll need to re-run your installer after the reboot with a command line switch. You can use GetParameters and GetOptions to detect it (see manual). You'll then need to call Abort in all page pre functions (or use RelGotoPage on Wiki) and ensure all sections prior to the one to run are unselected (use the UnselectSection macro in Sections.nsh) or jumped over (using an ${If}/${Unless}...${EndIf} or StrCmp and a label).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kporter20</div><div class="date">6th July 2009, 14:41</div></div><div class="posttext">Thanks. :)<br />
<br />
I will give it a try later and post back if I have any problems.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>