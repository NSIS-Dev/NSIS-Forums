<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Folder/File plugin needed, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Folder/File plugin needed NSIS Discussion" />
	
	<title> Folder/File plugin needed [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Folder/File plugin needed</div>
<hr />
<div class="pda"><a href="t-235492.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=235492">Folder/File plugin needed</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">14th January 2006, 23:40</div></div><div class="posttext">I'm looking for a way to get a count of the number of files/folders in a directory without having to manually loop through the directory and count them.<br />
<br />
Unfortunately, writing plugins isn't one of my strong points.  I know that with VBScript, I can use folders.count or files.count property (with the help of  scripting.fileSystemObject).  <br />
<br />
I'd like to be able to do the same from NSIS--either directly or via a plugin/system call.<br />
<br />
Any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">15th January 2006, 00:04</div></div><div class="posttext">I'm looking for a way to get a count of the number of files/folders in a directory without having to manually loop through the directory and count them.There is already a plug-in to do this:<br />
<br />
http://nsis.sourceforge.net/Locate_plugin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">15th January 2006, 00:31</div></div><div class="posttext">Thanks for the reply.  <br />
<br />
I saw this plugin (which is also included with NSIS 2.12).<br />
<br />
However, I don't see that any of its fuctions return an actual COUNT (sum) of the number of files or folder in a directory. The only way I can see getting a count with the locate plugin is to setup a loop to manually count the number of items.  While this would work, it would make things a bit slower, especially if there were a lot of files/folders in a directory.  That's why I was hoping for a plugin that would just eturn the answer in one step.  <br />
<br />
Here are a few examples I found that might help to better illustrate:<br />
http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cdo/html/7489c53c-b20b-41eb-b15d-49d449b36287.asp<br />
http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=184761&amp;SiteID=1<br />
<br />
EDIT:<br />
Never Mind!  I found what I was looking for.  In the locate::GetSize plugin call, there is a way to get the count.  (I didn't see it before because the name doesn't really match the function.)  Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th January 2006, 00:50</div></div><div class="posttext">I agree. Name is a bit strange for the function itself...<br />
But I suppose as long as the function works :)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">15th January 2006, 02:38</div></div><div class="posttext">In the locate::GetSize plugin call, there is a way to get the count. (I didn't see it before because the name doesn't really match the function.)Sorry I didn't mention the exact function. In fact I use the stand-alone version of the GetSize function because its plug-in is much smaller:<br />
<br />
http://forums.winamp.com/showthread.php?threadid=224452</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">15th January 2006, 07:20</div></div><div class="posttext">I saw this plugin (which is also included with NSIS 2.12). &quot;Locate&quot; plugin is not included in NSIS<br />
I didn't see it before because the name doesn't really match the function.&quot;GetSize&quot; chief task is the get size of the folder and filial task to get number of files and directories.In fact I use the stand-alone version of the GetSize function because its plug-in is much smallerBetter recompile &quot;Locate&quot; plugin with only &quot;#define GETSIZE&quot; and you will have the latest version and the small size.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">15th January 2006, 11:58</div></div><div class="posttext">Better recompile &quot;Locate&quot; plugin with only &quot;#define GETSIZE&quot; and you will have the latest version and the small size.Thanks for the suggestion.<br />
<br />
The GetSize plugin does exactly what I want so I did not bother upgrading to the newer Locate plugin (if I remember correctly the GetSize plugin appeared before the Locate plugin was updated to include the GetSize function).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>