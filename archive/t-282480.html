<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Updater thingy, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Updater thingy NSIS Discussion" />
	
	<title> Updater thingy [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Updater thingy</div>
<hr />
<div class="pda"><a href="t-282480.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=282480">Updater thingy</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">glepaxor</div><div class="date">1st December 2007, 22:04</div></div><div class="posttext">Hi.<br />
<br />
Ive been browsing this forum a while but havent found an answer clear enough. The question is, how to turn NSIS to updater application thing.<br />
<br />
Im using the InetLoad plugin to get the file from web, but I would like to know is there a plugin or something to get data from a file on web. <br />
Example, in my a server, theres a txt file, that contains a string &quot;Version=3&quot; and NSIS would check it out and recognise it to be version 3, then compare it to a local txt file that says &quot;Version=2&quot;, and starts to download the new file from the web with InetLoad.<br />
<br />
<br />
Any advice appreciated :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">1st December 2007, 22:46</div></div><div class="posttext">why don't you use the same method (InetLoad) to get the text file? you can use ReadIniStr  (http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2.10) or ConfigRead (http://nsis.sourceforge.net/Docs/AppendixE.html#E.2.9) afterwards.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glepaxor</div><div class="date">1st December 2007, 23:25</div></div><div class="posttext">Originally posted by Yathosho <br />
why don't you use the same method (InetLoad) to get the text file? you can use ReadIniStr  (http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2.10) or ConfigRead (http://nsis.sourceforge.net/Docs/AppendixE.html#E.2.9) afterwards.  <br />
<br />
Can you please tell more specifically what do I do with those? You could give a sample code, maybe? I am new to NSIS :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">2nd December 2007, 07:51</div></div><div class="posttext">why dont you NSISdl to download the update after checking if a new version is available</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glepaxor</div><div class="date">2nd December 2007, 08:21</div></div><div class="posttext">Originally posted by fabian.rap.more <br />
why dont you NSISdl to download the update after checking if a new version is available  <br />
<br />
I could, but I dont know how to make NSIS check for a new version...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">2nd December 2007, 09:42</div></div><div class="posttext">Section update<br />
NSISdl::download_quiet &quot;http://www.mysite.com/update.txt&quot; &quot;$EXEDIR\update.txt&quot;<br />
pop $0<br />
FileOpen $1 &quot;$EXEDIR\update.txt&quot; r<br />
FileOpen $R1 &quot;$EXEDIR\current.txt&quot; r<br />
<br />
FileRead $1 $2<br />
FileRead $R1 $R2<br />
StrCpy $2 $2 -2<br />
StrCpy $R2 $R2 -2<br />
<br />
StrCmp $2 $R2 old new<br />
<br />
new:<br />
MessageBox MB_ICONQUESTION|MB_YESNO &quot;A new update is available. Would you like to download it now?&quot; IDYES download<br />
goto done<br />
<br />
old:<br />
MessageBox MB_ICONINFORMATION|MB_OK &quot;Your software is up to date&quot;<br />
goto done<br />
<br />
download:<br />
FileRead $1 $2<br />
StrLen $7 $2<br />
StrCpy $2 $2 $7 9<br />
InetLoad::load /POPUP &quot;Software Update&quot; &quot;$2&quot; &quot;$TEMP\update.exe&quot;<br />
;PLACE THE REST OF YOUR CODE HERE LIKE WHAT TO DO AFTER DOWNLOADING THE UPDATE<br />
goto done<br />
<br />
done:<br />
FileClose $1<br />
FileClose $R1<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">2nd December 2007, 09:44</div></div><div class="posttext">the file update.txt would have to look like this:<br />
<br />
<br />
Version=3<br />
Location=http://mysite.com/update.exe<br />
<br />
<br />
the file current.txt would have to look like this:<br />
<br />
<br />
Version=2</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glepaxor</div><div class="date">2nd December 2007, 11:10</div></div><div class="posttext">Seems great, but it always says theres a new version available, even if update.txt says 4 and current.txt says 4...<br />
The update downloading does work. Any ideas?? Thanks, though.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">2nd December 2007, 11:20</div></div><div class="posttext">Delete the following line:<br />
<br />
<br />
StrCpy $R2 $R2 -2</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glepaxor</div><div class="date">2nd December 2007, 12:21</div></div><div class="posttext">Still doesnt work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">2nd December 2007, 12:26</div></div><div class="posttext">Section update<br />
NSISdl::download_quiet &quot;http://www.mysite.com/update.txt&quot; &quot;$EXEDIR\update.txt&quot;<br />
pop $0<br />
FileOpen $1 &quot;$EXEDIR\update.txt&quot; r<br />
FileOpen $R1 &quot;$EXEDIR\current.txt&quot; r<br />
<br />
FileRead $1 $2<br />
FileRead $R1 $R2<br />
StrCpy $2 $2 -2<br />
<br />
StrCmp $2 $R2 old new<br />
<br />
new:<br />
MessageBox MB_ICONQUESTION|MB_YESNO &quot;A new update is available. Would you like to download it now?&quot; IDYES download<br />
goto done<br />
<br />
old:<br />
MessageBox MB_ICONINFORMATION|MB_OK &quot;Your software is up to date&quot;<br />
goto done<br />
<br />
download:<br />
FileRead $1 $2<br />
StrLen $7 $2<br />
StrCpy $2 $2 $7 9<br />
InetLoad::load /POPUP &quot;Software Update&quot; &quot;$2&quot; &quot;$TEMP\update.exe&quot;<br />
;PLACE THE REST OF YOUR CODE HERE LIKE WHAT TO DO AFTER DOWNLOADING THE UPDATE<br />
goto done<br />
<br />
done:<br />
FileClose $1<br />
FileClose $R1<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">2nd December 2007, 12:29</div></div><div class="posttext">this code works 4 me though</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glepaxor</div><div class="date">2nd December 2007, 12:47</div></div><div class="posttext">Now it started working! Thank you very very much!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">2nd December 2007, 13:00</div></div><div class="posttext">:up: happy 2 help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd December 2007, 14:22</div></div><div class="posttext">It may be a good idea to use ReadINIStr as opposed to FileRead so that you can have variable length values.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">2nd December 2007, 15:22</div></div><div class="posttext">could u explain how????</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd December 2007, 16:13</div></div><div class="posttext">Have you looked at ReadINIStr in the manual?<br />
Also there is no point using NSISdl and InetLoad when you can do both downloads with InetLoad if you use /silent &quot;&quot; as one of the parameters (rather than NSISdl::download_quiet).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">2nd December 2007, 17:09</div></div><div class="posttext">yeah..........good point. thanks alot man</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>