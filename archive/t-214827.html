<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Hide Files and My Documents $?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Hide Files and My Documents $? NSIS Discussion" />
	
	<title> Hide Files and My Documents $? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Hide Files and My Documents $?</div>
<hr />
<div class="pda"><a href="t-214827.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=214827">Hide Files and My Documents $?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MechMykl</div><div class="date">3rd May 2005, 21:19</div></div><div class="posttext">Hey, im making an installer where I need the ability to make the folder a hidden one when nsis creates it, and, is there a $ type code for mydocumets? because with xp its C:\Doc and Settings...<br />
<br />
Thanks for your help in advance<br />
~Mechy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd May 2005, 21:52</div></div><div class="posttext">1. http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.3.12<br />
2. $DOCUMENTS<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MechMykl</div><div class="date">3rd May 2005, 22:35</div></div><div class="posttext">Hey, thanks for the $ code, but i cant get the thing for the hidden, help plz :)<br />
<br />
    ;Create shortcuts<br />
    CreateShortCut &quot;$SMPROGRAMS\Startup\HQubed Webcam.lnk |HIDDEN&quot; &quot;$INSTDIR\booruWebCam.exe /run /minimized&quot;<br />
<br />
Oh, and after booruwebcam.exe&quot; /run /minimized<br />
will it work the way it is? as the /run is supposed to be outside of the quote....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MechMykl</div><div class="date">4th May 2005, 01:51</div></div><div class="posttext">Ok, so I cant edit that post, anyway.<br />
<br />
I need an example of how to use the hidden thing. Also, with the above post, will creating a shortcut allow me to have the /run and /minimized after it? Because usually they go after the &quot; in an actual shortcut.<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">4th May 2005, 03:34</div></div><div class="posttext">Read the link above:<br />
The hidden attribute is set with the SetFileAttributes command, not with the CreateShortcut command. You'll probably want to create the shortcut first and then set the file attributes on it.  <br />
<br />
Here's an example which also illustrates the usage of the run minimized command:<br />
<br />
SetOutPath &quot;$SMPROGRAMS\Startup&quot;<br />
CreateShortcut &quot;HQubed Webcam.lnk&quot; &quot;$INSTDIR\booruWebCam.exe&quot; &quot;&quot; &quot;&quot; 0 SW_SHOWMINIMIZED &quot;&quot; &quot;Sample Description&quot;<br />
SetFileAttributes &quot;$SMPROGRAMS\HQubed Webcam.lnk&quot; hidden</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MechMykl</div><div class="date">5th May 2005, 22:06</div></div><div class="posttext">Hey, thanks alot, the shortcut is now hidden but I have 2 more questions/problems.<br />
<br />
I need to make my installation folder hidden also, is this possible? If so I could use the code :)<br />
<br />
Secondly, the shortcuts current target is<br />
<br />
&quot;C:\Program Files\Michael\Webcam\booruWebCam.exe&quot;<br />
<br />
but I need to make it like this<br />
<br />
&quot;C:\Program Files\Michael\Webcam\booruWebCam.exe&quot; /run /minimized<br />
<br />
and I cant put the /run /minimized in OR out of the quotes in NSIS, is there a way to do this that I dont know about?<br />
<br />
I've attached the installer, thanks in advace.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th May 2005, 22:45</div></div><div class="posttext">1.<br />
CreateShortcut &quot;HQubed Webcam.lnk&quot; '&quot;$INSTDIR\booruWebCam.exe&quot;  /run /minimized' &quot;&quot; &quot;&quot; 0 SW_SHOWMINIMIZED &quot;&quot; &quot;Sample Description&quot;<br />
2.<br />
SetFileAttributes $INSTDIR hidden<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th May 2005, 18:18</div></div><div class="posttext">Put the SetFileAttributes $INSTDIR hidden code in Function .onInstSuccess<br />
<br />
Function .onInstSuccess<br />
 SetFileAttributes $INSTDIR hidden<br />
FunctionEnd<br />
<br />
Or you could put it in a last hidden section.<br />
<br />
Section<br />
 SetFileAttributes $INSTDIR hidden<br />
Section<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MechMykl</div><div class="date">7th May 2005, 00:47</div></div><div class="posttext">Thanks sooo much, but theres a problem with the shortcut...<br />
<br />
This installers attached (updated)<br />
And the acutal exe's at hqubed.com/stuff/hcamai.exe<br />
<br />
Check the target of the shortcut, can it be fixed?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">7th May 2005, 03:15</div></div><div class="posttext">I don't see an attachment...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MechMykl</div><div class="date">7th May 2005, 16:35</div></div><div class="posttext">Yes you do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th May 2005, 19:11</div></div><div class="posttext">CreateShortcut &quot;$SMPROGRAMS\Startup\HQubed Webcam.lnk&quot; '&quot;$INSTDIR\booruWebCam.exe&quot; /run /minimized' &quot;&quot; &quot;&quot; 0 SW_SHOWMINIMIZED &quot;&quot; &quot;Sample Description&quot;<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MechMykl</div><div class="date">7th May 2005, 19:29</div></div><div class="posttext">Yea, like i said, when I do that the shortcut target in startup says this<br />
<br />
&quot;C:\&quot;C:\Documents and Settings\Michael\My Documents\HQubed Webcam\booruWebCam.exe&quot; \run \minimized&quot;<br />
<br />
If there's no way to get it to say<br />
<br />
&quot;C:\Documents and Settings\Michael\My Documents\HQubed Webcam\booruWebCam.exe&quot; /run /minimized<br />
<br />
then i'll have to make a shortcut to it myself</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th May 2005, 20:40</div></div><div class="posttext">What does the message box say (put it in code):<br />
MessageBox MB_OK $SMPROGRAMS<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MechMykl</div><div class="date">7th May 2005, 21:35</div></div><div class="posttext">not sure what you mean</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th May 2005, 22:56</div></div><div class="posttext">Put<br />
MessageBox MB_OK $SMPROGRAMS<br />
under your CreateShortcut compile and run the installer!!!<br />
<br />
-Stu :o</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MechMykl</div><div class="date">7th May 2005, 23:23</div></div><div class="posttext">C:\Documents and Settings\Michael\Start Menu\Programs</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th May 2005, 23:58</div></div><div class="posttext">Attach your script again.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MechMykl</div><div class="date">8th May 2005, 23:50</div></div><div class="posttext">Hey, was gone till 6 for mothers day, here it is.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MechMykl</div><div class="date">13th May 2005, 21:03</div></div><div class="posttext">*bump*<br />
If you cant help, tell me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th May 2005, 21:35</div></div><div class="posttext">I couldn't find anything significantly wrong with the script that could cause this, but you don't have to create the Startup folder because there's no way a user cannot have it.<br />
Secondly, it may not always be called Startup (apparently) so you should use $SMSTARTUP not &quot;$SMPROGRAMS\Startup&quot;<br />
<br />
The SetOutPath call you're using will set the &quot;Start in&quot; path for the proceeding shortcuts. Idealy then you should use SetOutPath $INSTDIR.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MechMykl</div><div class="date">15th May 2005, 06:18</div></div><div class="posttext">Ok, I took your advice and fixed the code, but it seems the shortcut just cant be done... Thanks for all of your help though, www.projects.hqubed.com ; it'll be up there soon.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>