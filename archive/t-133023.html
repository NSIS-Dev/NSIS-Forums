<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Need help with BGImage, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Need help with BGImage NSIS Discussion" />
	
	<title> Need help with BGImage [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Need help with BGImage</div>
<hr />
<div class="pda"><a href="t-133023.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=133023">Need help with BGImage</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Tolwyn</div><div class="date">24th April 2003, 22:17</div></div><div class="posttext">The example is fine, but I don't know how to actually utilize this for a script that is NOT an example.<br />
<br />
The script snippet I'm using is:<br />
<br />
;--------------------------------<br />
;BGIMAGE<br />
Section<br />
	# the plugins dir is automatically deleted when the installer exits<br />
	InitPluginsDir<br />
	File /oname=$PLUGINSDIR\bgimage.bmp &quot;c:\foo\bgimage.bmp&quot;<br />
	BgImage::Init /NOUNLOAD /FILLSCREEN $PLUGINSDIR\bgimage.bmp<br />
<br />
	BgImage::Destroy<br />
SectionEnd<br />
;--------------------------------<br />
<br />
Of course, compiling this with a working script does not produce the BGImage. It'd be great if more information were present. Building this from following the instructions exactly in the readme does not work, either.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th April 2003, 22:27</div></div><div class="posttext">You should initialize it when you want it to show (.onGUIInit for example) and destroy it when you want to stop showing it (.onInstSuccess/Fail which currently does not work for a very weird and unknown reason - destroy it at the end of the last section, or a hidden section). The example shows it longer than the second it flashes on your screen because it pops a few message boxes that stalls the code execution and thus &quot;avoids&quot; the destroy function for as long as you don't dismiss the message boxes.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">24th April 2003, 22:28</div></div><div class="posttext">Put it in the .onInit function.<br />
<br />
edit: that should be .onGUIInit</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th April 2003, 22:29</div></div><div class="posttext">Don't put it in .onInit. As the readme states:<br />
<br />
Do not use in .onInit!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">24th April 2003, 22:30</div></div><div class="posttext">Yeah that's true. I mean not a init &amp; destroy right after each other in a section :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tolwyn</div><div class="date">24th April 2003, 22:33</div></div><div class="posttext">See... this is the kind of thing that bothers me.<br />
There's no way I would have known any of that information.<br />
<br />
The instructions explicitly state:<br />
<br />
SetImage [/FILLSCREEN] path_to_bitmap<br />
   Sets a new image to the current timage window<br />
   Use /FILLSCREEN to make the image fill the screen<br />
   Do not use in .onInit!<br />
<br />
So, I still don't understand how to get this to work, I'm sorry. I'm sorry I'm expected to understand every little detail about this program! :rolleyes: <br />
<br />
So, I'm confused.<br />
<br />
The most frustrating thing about this is that there are no real examples. Everyone just showcases their little feature, but only tells 20% of the whole story.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tolwyn</div><div class="date">24th April 2003, 22:36</div></div><div class="posttext">So what do I need to do, explicitly, to get the bgimage to display when they double click the EXE, and to go away when it's finished installing?<br />
<br />
I'm looking for actual syntax here.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tolwyn</div><div class="date">24th April 2003, 22:43</div></div><div class="posttext">I give up on this &quot;feature.&quot;<br />
<br />
Since the instructions put this  whole thing into a section, I can't put a function inside a section. Trying to create a function .onGUIInit yields this error:<br />
<br />
Error: Function named &quot;.onGUIInit&quot; already exists.<br />
Error in macro MUI_FUNCTIONS_GUIINIT on macroline 6<br />
Error in macro MUI_BASIC on macroline 8<br />
Error in macro MUI_SYSTEM on macroline 16<br />
Error in macro MUI_LANGUAGEFILE_BEGIN on macroline 7<br />
!include: error in script: &quot;C:\Program Files\NSIS\Contrib\Modern UI\Language files\English.nsh&quot; on line 9<br />
Error in macro MUI_LANGUAGE on macroline 6<br />
Error in script &quot;C:\Tolwyn\build\7jg77_current.nsi&quot; on line 87 -- aborting creation process</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">24th April 2003, 22:50</div></div><div class="posttext">You should first understand the basics of a NSIS script. What a function, a callback function, a section etc. is. There is a good tutorial in the documentation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">24th April 2003, 22:51</div></div><div class="posttext">If you are using the Modern UI, you should define a custom function, because the Modern UI inserts this function.<br />
<br />
A copy from the documentation:!define MUI_CUSTOMFUNCTION_ONGUIINIT myGuiInit<br />
<br />
Function myGUIInit<br />
  ...your own code...<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tolwyn</div><div class="date">24th April 2003, 22:58</div></div><div class="posttext">Thanks, Joost.<br />
That's part of the problem, though.<br />
I do understand the basics of NSIS Script editing. I would say that I have an AVERAGE working knowledge.<br />
<br />
I think you may be too close to the documentation to have a real objective eye on how utterly futile some of it is. It takes a concept, and simply just redfines it; or in another way, states what the concept is, not really what it's for, what it does, and how to use it.<br />
<br />
It's extremely confusing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">24th April 2003, 23:28</div></div><div class="posttext">I do understand your problem. But we simply don't have enough time to write more turorials, examples etc. It's already a lot of work to maintain the current documentation.<br />
<br />
We are still looking for more people who want to help writing turorials and stuff.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tolwyn</div><div class="date">24th April 2003, 23:36</div></div><div class="posttext">Ok. I did what you said. Toward the top of my script, I have:<br />
<br />
!define MUI_CUSTOMFUNCTION_ONGUIINIT myGuiInit<br />
<br />
Then I have:<br />
;BGIMAGE <br />
Function myGuiInit<br />
# the plugins dir is automatically deleted when the installer exits <br />
InitPluginsDir <br />
File /oname=$PLUGINSDIR\bgimage.bmp &quot;c:\foo\bgimage.bmp&quot; <br />
BgImage::Init /NOUNLOAD /FILLSCREEN $PLUGINSDIR\bgimage.bmp <br />
FunctionEnd<br />
<br />
Then I have:<br />
<br />
Function .onInstSuccess<br />
BgImage::Destroy<br />
FunctionEnd<br />
Function .onInstFail<br />
BgImage::Destroy<br />
FunctionEnd<br />
<br />
When compiling the script, I get:<br />
<br />
2 warnings:<br />
  install function &quot;myGuiInit&quot; not referenced - zeroing code (14-23) out<br />
<br />
  install function &quot;.onInstFail&quot; not referenced - zeroing code (29-33) out</div></div><hr />


<div class="post"><div class="posttop"><div class="username">virtlink</div><div class="date">25th April 2003, 09:53</div></div><div class="posttext">Function .onInstSuccess <br />
BgImage::Destroy <br />
FunctionEnd<br />
<br />
Function .onInstFailed<br />
BgImage::Destroy <br />
FunctionEnd <br />
<br />
<br />
And, did you use the defines BEFORE the MUI_LANGUAGE macro's:?<br />
Modern UI Documentation<br />
Add the defines before the MUI_LANGUAGE macro's.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">25th April 2003, 12:54</div></div><div class="posttext">Yep, should be the order of commands.<br />
<br />
The Readme explains the right order. All defines should be before the MUI_LANGUAGE macro's.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th April 2003, 14:40</div></div><div class="posttext">(.onInstSuccess/Fail which currently does not work for a very weird and unknown reason - destroy it at the end of the last section, or a hidden section)<br />
<br />
Do NOT use it in .onInstSuccess/Failed. Destroy BgImage at the end of the last section as the example does.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tolwyn</div><div class="date">25th April 2003, 16:51</div></div><div class="posttext">Ok. I'll keep hacking (literally) away at it.<br />
I feel I'm closer now. Thanks for all the help and putting up with my exasperation.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>