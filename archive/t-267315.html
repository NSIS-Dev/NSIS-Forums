<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" restricted folders (vista), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  restricted folders (vista) NSIS Discussion" />
	
	<title> restricted folders (vista) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  restricted folders (vista)</div>
<hr />
<div class="pda"><a href="t-267315.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267315">restricted folders (vista)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bnicer</div><div class="date">7th March 2007, 13:46</div></div><div class="posttext">Hi all,<br />
<br />
Some install folders might often be inaccessible when you are not an administrator -- Program Files, etc.<br />
<br />
I've found you can avoid trouble by not installing into a special folder.<br />
<br />
1) What is the situation in Vista? Can an ordinary user, not an admin, install to C:\myprogram? (not a special folder -- but maybe restricted?)<br />
<br />
2) (Vista) Are the icon group folders (under $SMPROGRAMS) restricted if you're a non-admin?<br />
<br />
Finally, (all Windows versions), is it possible to prevent the user from selecting an install path that will fail in advance?<br />
<br />
You have to wait for the installer to return an access is denied message during the install process, right?<br />
<br />
Some of these questions, I realize, would be unnecessary if I installed Vista, but I'm wary of taking the plunge. One day I will close my eyes and jump. Until I do, help?<br />
<br />
Thx.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">8th March 2007, 13:40</div></div><div class="posttext">TIP:<br />
Search google for &quot;Vista Virtualization&quot; and you see how MS solved the issue supporting legacy &quot;Misbehaving&quot; installers.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">8th March 2007, 16:18</div></div><div class="posttext">Use RequestExecutionLevel admin in your build script and you shouldn't have to worry...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bnicer</div><div class="date">8th March 2007, 18:45</div></div><div class="posttext">Reading up on Vista Virtualization, I get the impression most conflicts between the user and the administrator have been laid to rest.<br />
<br />
Thank you for the assurances.<br />
<br />
What holds me back from getting Vista has more to do with spending too much time on XP in my case.<br />
<br />
So, I'm not saying this hasn't been helpful. It has.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">9th March 2007, 09:51</div></div><div class="posttext">Vista Virtualization does not apply to applications with a manifest (RequestExecutionLevel)<br />
<br />
Also, Vista autodetects NSIS installers even with no manifest, not sure if virtualization is turned off then (You could check this with Process Explorer)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">10th March 2007, 06:46</div></div><div class="posttext">But, since virtualiztion only gets used if the user can't write to the original location, it's probably a moot point if the installation is auto-detected by Vista and prompts the user for elevated privleges.<br />
<br />
Vista's install detection is based on a &quot;best guess&quot; approach based on a number of things, including unique EXE signitures, name of the EXE itself, and certain keywords in the EXE's properties--not exactly failsafe, in my opinion. That's why suggest using RequestedExecutionLevel.  This adds a manifest to the installer (compiled EXE) and thus leaves no question as to what level of execution to allow the setup to run at.  (And, as bnicer points out, it also disables virtualization, which is also a plus.)<br />
<br />
And FWIW, virtualiztion is disabled on native 64-bit code and in any services (32 or 64-bit).  Not that any of this pertains directly to NSIS, but it might...)<br />
<br />
Here's (http://technet2.microsoft.com/WindowsVista/en/library/00d04415-2b2f-422c-b70e-b18ff918c2811033.mspx?mfr=true) the best starting reference for UAC in Vista that I've found in case anyone's curious...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>