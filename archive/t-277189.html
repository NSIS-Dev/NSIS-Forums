<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" two tutorials please?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  two tutorials please? NSIS Discussion" />
	
	<title> two tutorials please? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  two tutorials please?</div>
<hr />
<div class="pda"><a href="t-277189.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277189">two tutorials please?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">tictox</div><div class="date">11th September 2007, 11:11</div></div><div class="posttext">Hi Im still a novice nsis user , and have relied on the HM NIS EDIT wizard , to generate my intial install scripts , I normally edit them there after , by adding other files to the installer and paths etc.. I have looked at the documentation that came with nsis but i find most of the examples extremley un-informative to a new learner , eg..<br />
<br />
i what to install another app that handles sync with outlook express with my application named redemption, so i manged to get this going with this script:<br />
<br />
Section SECOUTLOOK<br />
ExecWait '&quot;$INSTDIR\Install.exe&quot;'<br />
SectionEnd<br />
<br />
but the splash screen is very ugly, and i have read redemptions site saying it is possible to mark the redemption dll as self registering .. so i searched the nsis documetation for a means to do this, and the best i found was InstallLib macro as this dll is reffered to as a library on the site .. <br />
<br />
so nsis documentation gives me:<br />
<br />
libtype shared install localfile destfile tempbasedir<br />
<br />
so libtype i presume is:<br />
REGDLLTLB/as per choices available this seems to be what i would need.<br />
<br />
shared:<br />
I think it is shared so documentation states i need:<br />
$VARNAME/is this the exact variable name needed or can it be anything?? what do i set this value to?? <br />
<br />
IM also keen to learn about the registry writing that is been performed ..<br />
<br />
!define PRODUCT_DIR_REGKEY &quot;Software\Microsoft\Windows\CurrentVersion\App Paths\pps.exe&quot;<br />
!define PRODUCT_UNINST_KEY &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}&quot;<br />
//<br />
//<br />
other content here......<br />
//<br />
//<br />
followed by some post writing:<br />
<br />
Section -Post<br />
  WriteUninstaller &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot; &quot;$INSTDIR\pps.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayName&quot; &quot;$(^Name)&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayIcon&quot; &quot;$INSTDIR\pps_final.ico&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayVersion&quot; &quot;${PRODUCT_VERSION}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;URLInfoAbout&quot; &quot;${PRODUCT_WEB_SITE}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;Publisher&quot; &quot;${PRODUCT_PUBLISHER}&quot;<br />
SectionEnd<br />
<br />
why is there no break down of this build been generated??<br />
and what each item is, and what its purpose is??<br />
<br />
Im going to end my rant here , if some experienced nsis users/moderators read this .. please give me links to better tutorials, i hate somebody just telling me how to do it, whats the point of that .. it need explanations for the AI to become my own logic i can apply.<br />
<br />
If there is no other documentation and someone has the time to explain the above two scenarios .. it would be appriciated<br />
<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th September 2007, 11:07</div></div><div class="posttext">InstallLib can install DLL files that might be in use and handle everything automatically. If you need to install a DLL to your application's directory that'd be used only by your application, RegDLL would be enough. If InstallLib is what you need, REGDLL and non-shared is probably what you're looking for. Most DLL files don't contain type-libraries (TLB) and it sounds like your DLL is only for your program so it's not shared.<br />
<br />
I don't understand your second question. What do you want to write to the registry? Just a string? You can use WriteRegStr for that. It's in the documentation and the Wiki, forums and web contain hundreds of usage examples.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>