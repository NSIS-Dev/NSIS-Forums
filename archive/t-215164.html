<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ifFileExists - compile time, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ifFileExists - compile time NSIS Discussion" />
	
	<title> ifFileExists - compile time [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ifFileExists - compile time</div>
<hr />
<div class="pda"><a href="t-215164.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=215164">ifFileExists - compile time</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">6th May 2005, 20:52</div></div><div class="posttext">Here's what I'm trying to do and am not sure if it's actually possible:<br />
<br />
;compileTime<br />
IfFileExists onLocalMachine<br />
  Do<br />
    ;Runtime<br />
    Unregister dll<br />
    Copy dll from local to dest<br />
    Register dll   <br />
  Done<br />
Endif<br />
<br />
In other words, I want to ignore a section of code if a certain file doesn't exist at compile time.<br />
<br />
Thanks,<br />
Eric</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">6th May 2005, 21:11</div></div><div class="posttext">I think I know the answer to this.  Tell me if I'm wrong:<br />
<br />
IfFileExists is compile time<br />
FindFirst is run time<br />
<br />
If that's the case, I'm square.  I'm going to code based on this assumption.<br />
<br />
Thanks,<br />
Eric</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">6th May 2005, 21:20</div></div><div class="posttext">Looks to me like I'm wrong based on the documentation for DLL/TLB Library Setup.  IfFileExists is looking on the destination machine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th May 2005, 21:42</div></div><div class="posttext">Doing a forum search usually helps.<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=211262&amp;highlight=IfFileExists+compile+time<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">6th May 2005, 22:44</div></div><div class="posttext">I tried, but I guess you are better at searching this forum.  So, I tried to do basically what they're doing and failed.  Any help on what I'm doing wrong?<br />
<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
;Backgound Colors<br />
BGGradient 800080 000000 FFFFFF<br />
BrandingText &quot; &quot;<br />
<br />
Name &quot;Test&quot;<br />
<br />
;Output File Name<br />
OutFile &quot;test.exe&quot;<br />
<br />
;The Default Installation Directory<br />
InstallDir &quot;D:\NoWhereLand&quot;<br />
<br />
Section &quot;Install&quot;<br />
<br />
  !system 'IF EXIST &quot;D:\myFile.txt&quot; ECHO !define MyVar'<br />
<br />
  !ifdef MyVar<br />
    MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />
    &quot;file exists $\n$\nClick `OK` to continue \<br />
    or `Cancel` to abort.&quot; \<br />
    IDOK +1<br />
<br />
  !endif<br />
<br />
  MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />
  &quot;finished $\n$\nClick `OK` to continue \<br />
  or `Cancel` to abort.&quot; \<br />
  IDOK +1<br />
<br />
SectionEnd<br />
<br />
Section &quot;Shortcuts&quot;<br />
  ;Add Shortcuts<br />
SectionEnd<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
<br />
Thanks,<br />
Eric</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">6th May 2005, 22:52</div></div><div class="posttext">Nevermind, I see what I missed:<br />
<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
;Backgound Colors<br />
BGGradient 800080 000000 FFFFFF<br />
BrandingText &quot; &quot;<br />
<br />
Name &quot;Test&quot;<br />
<br />
;Output File Name<br />
OutFile &quot;test.exe&quot;<br />
<br />
;The Default Installation Directory<br />
InstallDir &quot;D:\NoWhereLand&quot;<br />
<br />
Section &quot;Install&quot;<br />
<br />
  !system 'IF EXIST &quot;D:\myFile.txt&quot; ECHO !define MyVar&gt;&quot;%TEMP%\Temp$$$.nsh&quot;'<br />
  !include &quot;$%TEMP%\Temp$$$.nsh&quot;<br />
  !system 'DEL &quot;%TEMP%\Temp$$$.nsh&quot;'<br />
<br />
<br />
  !ifdef MyVar<br />
    MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />
    &quot;file exists $\n$\nClick `OK` to continue \<br />
    or `Cancel` to abort.&quot; \<br />
    IDOK +1<br />
<br />
  !endif<br />
<br />
  MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />
  &quot;finished $\n$\nClick `OK` to continue \<br />
  or `Cancel` to abort.&quot; \<br />
  IDOK +1<br />
<br />
SectionEnd<br />
<br />
Section &quot;Shortcuts&quot;<br />
  ;Add Shortcuts<br />
SectionEnd<br />
<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th May 2005, 22:52</div></div><div class="posttext">You're missing about 80% of the code.<br />
<br />
!system 'IF EXIST &quot;C:\NsisBuilds\MaybeFileMaybeNot\file.txt&quot; ECHO !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;Menu.ini&quot; &quot;Field 3&quot; &quot;Flags&quot; &quot;DISABLED&quot;&gt;&quot;%TEMP%\Temp$$$.nsh&quot;'<br />
!include &quot;$%TEMP%\Temp$$$.nsh&quot;<br />
!system 'DEL &quot;%TEMP%\Temp$$$.nsh&quot;'<br />
<br />
<br />
It's writing a define to a temp file and then !including that temp file (and then deleting it).<br />
You're missing those 3 main parts.<br />
<br />
Edit: You just updated your post when I posted :)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">9th May 2005, 20:17</div></div><div class="posttext">Is there a way to modularize this?  I tried, but it doesn't seem to work.  Anyone see what I'm doing wrong?<br />
<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
;Backgound Colors<br />
BGGradient 800080 000000 FFFFFF<br />
BrandingText &quot; &quot;<br />
<br />
Name &quot;Test&quot;<br />
<br />
;Output File Name<br />
OutFile &quot;test2.exe&quot;<br />
<br />
;The Default Installation Directory<br />
InstallDir &quot;D:\NoWhereLand&quot;<br />
<br />
Section &quot;Install&quot;<br />
<br />
  StrCpy $8 'D:\myFile.txt'<br />
  call checkFileExists<br />
<br />
  !ifdef MyVar<br />
    MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />
    &quot;D:\myFile.txt file exists $\n$\nClick `OK` to continue \<br />
    or `Cancel` to abort.&quot; \<br />
    IDOK +1<br />
  !endif<br />
  !ifndef MyVar<br />
    MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />
    &quot;myFile.txt file doesn't exist $\n$\nClick `OK` to continue \<br />
    or `Cancel` to abort.&quot; \<br />
    IDOK +1<br />
  !endif<br />
<br />
  StrCpy $8 'D:\noFile.txt'<br />
  call checkFileExists<br />
<br />
  !ifdef MyVar<br />
    MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />
    &quot;D:\noFile.txt file exists $\n$\nClick `OK` to continue \<br />
    or `Cancel` to abort.&quot; \<br />
    IDOK +1<br />
  !endif<br />
  !ifndef MyVar<br />
    MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />
    &quot;noFile.txt file doesn't exist $\n$\nClick `OK` to continue \<br />
    or `Cancel` to abort.&quot; \<br />
    IDOK +1<br />
  !endif<br />
<br />
<br />
SectionEnd<br />
<br />
Section &quot;Shortcuts&quot;<br />
  ;Add Shortcuts<br />
SectionEnd<br />
<br />
Function checkFileExists<br />
<br />
  !ifdef MyVar<br />
    !undef MyVar<br />
  !endif<br />
<br />
  !system 'ECHO ;$8 FileCheck&gt;&quot;%TEMP%\Temp$$$.nsh&quot;'<br />
  !system 'IF EXIST &quot;$8&quot; ECHO !define MyVar&gt;&quot;%TEMP%\Temp$$$.nsh&quot;'<br />
  !include &quot;$%TEMP%\Temp$$$.nsh&quot;<br />
  !system 'DEL &quot;%TEMP%\Temp$$$.nsh&quot;'<br />
<br />
<br />
FunctionEnd<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">9th May 2005, 22:52</div></div><div class="posttext">All NSIS variables $0-$9 ... are run-time.<br />
Name &quot;Test&quot;<br />
OutFile &quot;Test.exe&quot;<br />
<br />
Section &quot;Install&quot;<br />
	!ifdef MyVar<br />
	!undef MyVar<br />
	!endif<br />
<br />
	!system 'IF EXIST &quot;D:\myFile.txt&quot; IF EXIST &quot;D:\noFile.txt&quot; ECHO !define MyVar&gt;&gt;&quot;%TEMP%\Temp$$$.nsh&quot;'<br />
	!include &quot;$%TEMP%\Temp$$$.nsh&quot;<br />
	!system 'DEL &quot;%TEMP%\Temp$$$.nsh&quot;'<br />
<br />
	!ifdef MyVar<br />
	MessageBox MB_OK '&quot;D:\myFile.txt&quot; and &quot;D:\noFile.txt&quot; were exist at compile-time'<br />
	!endif<br />
<br />
	!ifndef MyVar<br />
	MessageBox MB_OK '&quot;D:\myFile.txt&quot; and &quot;D:\noFile.txt&quot; were not exist at compile-time'<br />
	!endif<br />
SectionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>