<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to display a custom page instead of MUI_PAGE_DIRECTORY depending on sections, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to display a custom page instead of MUI_PAGE_DIRECTORY depending on sections NSIS Discussion" />
	
	<title> How to display a custom page instead of MUI_PAGE_DIRECTORY depending on sections [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to display a custom page instead of MUI_PAGE_DIRECTORY depending on sections</div>
<hr />
<div class="pda"><a href="t-366488.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=366488">How to display a custom page instead of MUI_PAGE_DIRECTORY depending on sections</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">vinzx</div><div class="date">16th July 2013, 10:56</div></div><div class="posttext">Hello everybody,<br />
<br />
I am new with nsis script, and i am meeting a problem :)<br />
<br />
My Script has two sections, what i would like to do is during the installation, if all my sections are selected display MUI_PAGE_DIRECTORY<br />
if there is only my  second section selected, display MyCustom page.<br />
<br />
!insertmacro MUI_PAGE_WELCOME       <br />
!insertmacro MUI_PAGE_COMPONENTS   <br />
<br />
!insertmacro MUI_PAGE_DIRECTORY    <br />
or Page custom nsDialogsPage (depend on my section 1)<br />
<br />
!insertmacro MUI_PAGE_INSTFILES    <br />
!insertmacro MUI_PAGE_FINISH       <br />
<br />
This following function is that i have tried:<br />
<br />
Function DependenciesOnTomcatInst<br />
 ${If} ${SectionIsSelected} ${sec1}<br />
!insertmacro MUI_PAGE_DIRECTORY     ;Sélection du répertoire d'installation<br />
 ${IfNot} ${SectionIsSelected} ${sec1}<br />
 Page custom nsDialogsPage<br />
 ${endif}<br />
FunctionEnd<br />
<br />
All Ideas will be welcome, thank you by advance, and sorry for my English i am not fluent :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">16th July 2013, 12:19</div></div><div class="posttext">!define MUI_PAGE_CUSTOMFUNCTION_PRE DirPage_Pre<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
Page Custom nsDialogsPage<br />
<br />
Then do the section check in the DirPage_Pre and nsDialogsPage functions. If you call Abort, the page will be skipped.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vinzx</div><div class="date">16th July 2013, 12:46</div></div><div class="posttext">Thank you very much aerDNA! i will try to do it now!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vinzx</div><div class="date">16th July 2013, 13:28</div></div><div class="posttext">It works perfectely thanks again  aerDNA!  :up:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kolpotoru</div><div class="date">7th August 2013, 06:35</div></div><div class="posttext">I have a similar question i have two Installation Type Typical &amp; <br />
Portable and when typical installation is selected the default <br />
installation dir will be $PROGRAMFILES\My Program &amp; if portable<br />
installation type is selected then default installation dir will be <br />
$EXEDIR\My Program please help. I am attaching the script Please Help.<br />
<br />
<br />
; Define your application name<br />
!define APPNAME &quot;My App&quot;<br />
!define APPNAMEANDVERSION &quot;My App 1.1.2&quot;<br />
<br />
RequestExecutionLevel none<br />
<br />
; Main Install settings<br />
Name &quot;${APPNAMEANDVERSION}&quot;<br />
InstallDir &quot;$PROGRAMFILES\My App&quot;<br />
InstallDirRegKey HKLM &quot;Software\${APPNAME}&quot; &quot;&quot;<br />
OutFile &quot;MyAppSetup1.1.2.exe&quot;<br />
<br />
; Modern interface settings<br />
!include &quot;MUI.nsh&quot;<br />
<br />
!define MUI_ABORTWARNING<br />
!define MUI_FINISHPAGE_RUN &quot;$INSTDIR\MyApp.exe&quot;<br />
!define MUI_FINISHPAGE_SHOWREADME &quot;$INSTDIR\readme.txt&quot;<br />
!define MUI_FINISHPAGE_SHOWREADME_NOTCHECKED<br />
<br />
;Uncomment the following two lines if you wish to recompile the Venis Install Script<br />
!define MUI_HEADERIMAGE<br />
<br />
<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_LICENSE &quot;license.txt&quot;<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
!insertmacro MUI_UNPAGE_CONFIRM<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
; Set languages (first is default language)<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
!insertmacro MUI_LANGUAGE &quot;Danish&quot;<br />
!insertmacro MUI_LANGUAGE &quot;German&quot;<br />
!insertmacro MUI_LANGUAGE &quot;Italian&quot;<br />
!insertmacro MUI_LANGUAGE &quot;Spanish&quot;<br />
!insertmacro MUI_RESERVEFILE_LANGDLL<br />
<br />
InstType /NOCUSTOM<br />
<br />
InstType &quot;Typical&quot;<br />
InstType &quot;Portable&quot;<br />
<br />
;Function .onInit<br />
<br />
;  !insertmacro MUI_LANGDLL_DISPLAY<br />
<br />
;FunctionEnd<br />
<br />
Section &quot;My App&quot; Section1<br />
<br />
	; Set Section properties<br />
	SectionIn 1 RO<br />
	SetOverwrite on<br />
<br />
	; Set Section Files and Shortcuts<br />
	SetOutPath &quot;$INSTDIR\languages\&quot;<br />
	File /r &quot;..\languages\*.*&quot; ; Packaged languages<br />
	<br />
	SetOutPath &quot;$INSTDIR\&quot;<br />
	File &quot;..\MyApp.exe&quot;<br />
	File &quot;..\readme.txt&quot;<br />
	File &quot;..\license.txt&quot;<br />
	<br />
	CreateDirectory &quot;$SMPROGRAMS\My App&quot;<br />
	CreateShortCut &quot;$SMPROGRAMS\My App\My App.lnk&quot; &quot;$INSTDIR\MyApp.exe&quot;<br />
	CreateShortCut &quot;$SMPROGRAMS\My App\Uninstall.lnk&quot; &quot;$INSTDIR\uninstall.exe&quot;<br />
<br />
SectionEnd<br />
<br />
Section &quot;Portable&quot; Section2<br />
	; Set Section properties<br />
	SectionIn 2 RO<br />
	SetOverwrite on<br />
<br />
	; Set Section Files and Shortcuts<br />
	SetOutPath &quot;$INSTDIR\languages\&quot;<br />
	File /r &quot;..\languages\*.*&quot; ; Packaged languages<br />
	<br />
	SetOutPath &quot;$INSTDIR\&quot;<br />
	File &quot;..\MyApp.exe&quot;<br />
	File &quot;..\readme.txt&quot;<br />
	File &quot;..\license.txt&quot;<br />
SectionEnd<br />
<br />
Section &quot;Desktop Shortcut&quot; Section3<br />
	; Set Section properties<br />
	SectionIn 1<br />
	SetOverwrite on<br />
<br />
	; Set Section Files and Shortcuts<br />
	CreateShortCut &quot;$DESKTOP\My App.lnk&quot; &quot;$INSTDIR\MyApp.exe&quot;<br />
<br />
SectionEnd<br />
<br />
Section &quot;Quicklaunch Shortcut&quot; Section4<br />
<br />
	; Set Section properties<br />
	SectionIn 1<br />
	SetOverwrite on<br />
<br />
	; Set Section Files and Shortcuts<br />
	CreateShortCut &quot;$QUICKLAUNCH\My App.lnk&quot; &quot;$INSTDIR\MyApp.exe&quot;<br />
<br />
SectionEnd<br />
<br />
Section &quot;Source&quot; Section5<br />
<br />
	; Set Section properties<br />
	SectionIn 1<br />
	SetOverwrite on<br />
<br />
	; Set Section Files and Shortcuts<br />
	SetOutPath &quot;$INSTDIR\src\&quot;<br />
	File &quot;MyApp.dsp&quot;<br />
	File &quot;MyAppAbout.cpp&quot;<br />
	File &quot;MyAppAbout.h&quot;<br />
	File &quot;license.txt&quot;<br />
	File &quot;MyApp.dsw&quot;<br />
	File &quot;MyApp.ico&quot;<br />
	File &quot;MyApp.nsi&quot;<br />
	File &quot;MyApp.rc&quot;<br />
	File &quot;MyAppapp.cpp&quot;<br />
	File &quot;MyAppapp.h&quot;<br />
	File &quot;MyAppfrm.cpp&quot;<br />
	File &quot;MyAppfrm.h&quot;<br />
	File &quot;MyApplistbox.cpp&quot;<br />
	File &quot;MyApplistbox.h&quot;<br />
	File &quot;MyAppprefdlg.cpp&quot;<br />
	File &quot;MyAppprefdlg.h&quot;<br />
	File &quot;MyAppsecuritydlg.cpp&quot;<br />
	File &quot;MyAppsecuritydlg.h&quot;<br />
	;File &quot;resource.h&quot;<br />
	File &quot;readme.txt&quot;<br />
	File &quot;todo.txt&quot;<br />
	File &quot;wxHyperlinksCtrl.cpp&quot;<br />
	File &quot;wxHyperlinksCtrl.h&quot;<br />
<br />
SectionEnd<br />
<br />
<br />
Section &quot;-Add Uninstaller&quot; Section6  ;hidden section<br />
<br />
	; Set Section properties<br />
	SectionIn 1<br />
<br />
	WriteRegStr HKLM &quot;Software\${APPNAME}&quot; &quot;&quot; &quot;$INSTDIR&quot;<br />
	WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}&quot; &quot;DisplayName&quot; &quot;${APPNAME}&quot;<br />
	WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\uninstall.exe&quot;<br />
	WriteUninstaller &quot;$INSTDIR\uninstall.exe&quot;<br />
<br />
SectionEnd<br />
<br />
; Modern install component descriptions<br />
!insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />
	!insertmacro MUI_DESCRIPTION_TEXT ${Section1} &quot;My App core application.&quot;<br />
	!insertmacro MUI_DESCRIPTION_TEXT ${Section2} &quot;My App Portable.&quot;<br />
    !insertmacro MUI_DESCRIPTION_TEXT ${Section3} &quot;My App desktop shortcut.&quot;<br />
	!insertmacro MUI_DESCRIPTION_TEXT ${Section4} &quot;My App quicklaunch shortcut.&quot;<br />
	!insertmacro MUI_DESCRIPTION_TEXT ${Section5} &quot;My App source.&quot;<br />
	!insertmacro MUI_DESCRIPTION_TEXT ${Section6} &quot;My App uninstaller.&quot;<br />
!insertmacro MUI_FUNCTION_DESCRIPTION_END<br />
<br />
<br />
Function un.onInit<br />
<br />
  !insertmacro MUI_UNGETLANGUAGE<br />
  <br />
FunctionEnd<br />
<br />
;Uninstall section<br />
Section Uninstall<br />
<br />
	;Remove from registry...<br />
	DeleteRegKey HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}&quot;<br />
	DeleteRegKey HKLM &quot;SOFTWARE\${APPNAME}&quot;<br />
<br />
	; Delete self<br />
	Delete &quot;$INSTDIR\uninstall.exe&quot;<br />
<br />
	; Delete Shortcuts<br />
	Delete &quot;$SMPROGRAMS\My App\My App.lnk&quot;<br />
	Delete &quot;$SMPROGRAMS\My App\Uninstall.lnk&quot;<br />
	Delete &quot;$DESKTOP\My App.lnk&quot;<br />
	Delete &quot;$QUICKLAUNCH\My App.lnk&quot;<br />
<br />
	; Clean up My App<br />
	Delete &quot;$INSTDIR\MyApp.exe&quot;<br />
<br />
	; Clean up Source<br />
	Delete &quot;$INSTDIR\src\MyApp.dsp&quot;<br />
	Delete &quot;$INSTDIR\src\MyAppAbout.cpp&quot;<br />
	Delete &quot;$INSTDIR\src\MyAppAbout.h&quot;<br />
	Delete &quot;$INSTDIR\src\license.txt&quot;<br />
	Delete &quot;$INSTDIR\src\MyApp.dsw&quot;<br />
	Delete &quot;$INSTDIR\src\MyApp.ico&quot;<br />
	Delete &quot;$INSTDIR\src\MyApp.nsi&quot;<br />
	Delete &quot;$INSTDIR\src\MyApp.rc&quot;<br />
	Delete &quot;$INSTDIR\src\MyAppapp.cpp&quot;<br />
	Delete &quot;$INSTDIR\src\MyAppapp.h&quot;<br />
	Delete &quot;$INSTDIR\src\MyAppfrm.cpp&quot;<br />
	Delete &quot;$INSTDIR\src\MyAppfrm.h&quot;<br />
	Delete &quot;$INSTDIR\src\MyApplistbox.cpp&quot;<br />
	Delete &quot;$INSTDIR\src\MyApplistbox.h&quot;<br />
	Delete &quot;$INSTDIR\src\MyAppprefdlg.cpp&quot;<br />
	Delete &quot;$INSTDIR\src\MyAppprefdlg.h&quot;<br />
	Delete &quot;$INSTDIR\src\readme.txt&quot;<br />
	Delete &quot;$INSTDIR\src\resource.h&quot;<br />
	Delete &quot;$INSTDIR\src\todo.txt&quot;<br />
	Delete &quot;$INSTDIR\src\wxHyperlinksCtrl.cpp&quot;<br />
	Delete &quot;$INSTDIR\src\wxHyperlinksCtrl.h&quot;<br />
<br />
	; Remove remaining directories<br />
	RMDir &quot;$SMPROGRAMS\My App&quot;<br />
	RMDir &quot;$INSTDIR\src\&quot;<br />
	RMDir &quot;$INSTDIR\&quot;<br />
<br />
SectionEnd<br />
<br />
BrandingText &quot;My App&quot;<br />
<br />
; eof</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">7th August 2013, 15:17</div></div><div class="posttext">I have a similar question i have two Installation Type Typical &amp; <br />
Portable and when typical installation is selected the default <br />
installation dir will be $PROGRAMFILES\My Program &amp; if portable<br />
installation type is selected then default installation dir will be <br />
$EXEDIR\My Program please help. I am attaching the script Please Help.<br />
<br />
<br />
I don't see anything about a custom page so I don't see how this is a similar question, anyway, add a PRE callback to the directory page or a LEAVE callback to the component page where you set $instdir based on the users selection...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kolpotoru</div><div class="date">8th August 2013, 04:45</div></div><div class="posttext">Please give some example.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">8th August 2013, 05:48</div></div><div class="posttext">Please give some example.<br />
<br />
Please attempt to figure it out on your own first, try reading about the page instruction in the manual...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>