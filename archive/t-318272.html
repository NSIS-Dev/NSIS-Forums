<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Need curly buttons, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Need curly buttons NSIS Discussion" />
	
	<title> Need curly buttons [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Need curly buttons</div>
<hr />
<div class="pda"><a href="t-318272.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318272">Need curly buttons</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Alfaromeo</div><div class="date">10th April 2010, 06:20</div></div><div class="posttext">Using UMUI . I need oval shaped buttons instead of rectangle. Please advise</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Alfaromeo</div><div class="date">13th April 2010, 07:48</div></div><div class="posttext">Anybody can help . basically any runtime API I can use to change the shape of the buttons .Needed urgently.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">13th April 2010, 13:13</div></div><div class="posttext">I don't think there's any particularly easy way to do this without defining your own controls in e.g. visual studio, then exporting them as a DLL, and then adding them to your dialogs with nsDialogs.<br />
I could be mistaken, though.<br />
<br />
The only semi-easy way I can think of is to build up your UI out of bitmaps and using nsDialogs' onClick event to detect a click on a bitmap and optionally toggle that bitmap (to show the user that they clicked).<br />
That way you could define any shape of button you want.. although they would still fall into the rectangular layouts of bitmaps (like early HTML maps).  This -could- be refined by using the System plugin with getWindowRect and getCursorPos to determine where in the bitmap a user clicked.  Not sure how easy it would be to read out a mask bitmap to correlate the clicked position to a control's shape, though.<br />
<br />
Below is an example showing a toggle button behavior.  For a regular button you'd change the bitmap, sleep for a fraction of a second, and then change it back. ( There's no mouseDown / mouseUp events in nsDialogs  )<br />
<br />
!addincludedir &quot;.&quot;<br />
!addplugindir &quot;.&quot;<br />
<br />
!include &quot;LogicLib.nsh&quot;<br />
!include &quot;MUI2.nsh&quot;<br />
!include &quot;winMessages.nsh&quot;<br />
!include &quot;nsDialogs.nsh&quot;<br />
<br />
OutFile &quot;test.exe&quot;<br />
<br />
Section<br />
SectionEnd<br />
<br />
Var dialog<br />
Var hwnd<br />
Var null<br />
<br />
Var hwnd_listbox<br />
Var hwnd_bitmap<br />
Var res_bmp<br />
<br />
Page Custom customPage<br />
Function customPage<br />
    nsDialogs::Create 1018<br />
    Pop $dialog<br />
<br />
    /* Unpack bitmap files in advance */<br />
    InitPluginsDir<br />
    SetOutPath &quot;$PluginsDir&quot;<br />
        File &quot;a.bmp&quot;<br />
        File &quot;b.bmp&quot;<br />
<br />
    ${NSD_CreateBitmap} 25% 0 190 171 &quot;&quot;<br />
        Pop $hwnd_bitmap<br />
	    ${NSD_SetImage} $hwnd_bitmap &quot;$PluginsDir\a.bmp&quot; $res_bmp<br />
	    nsDialogs::SetUserData $hwnd_bitmap &quot;a.bmp&quot;<br />
        ${NSD_OnClick} $hwnd_bitmap custompage.bitmap.onclick<br />
        <br />
<br />
    nsDialogs::Show<br />
    ${NSD_FreeImage} $res_bmp<br />
FunctionEnd<br />
<br />
Function custompage.bitmap.onclick<br />
    Pop $hwnd<br />
    <br />
	/* Get control's rect on screen */<br />
	System::Call &quot;*(i, i, i, i) i .r1&quot;<br />
	System::Call &quot;User32::GetWindowRect(i, i) i ($hwnd, r1) .r2&quot;<br />
	System::Call &quot;*$1(i, i, i, i) i (.r2, .r3, .r4, .r5)&quot;<br />
<br />
	/* Get mouse cursor's position on screen */<br />
	System::Call &quot;*(l, l) i .r6&quot;<br />
	System::Call &quot;User32::GetCursorPos(i) i (r6) .r7&quot;<br />
	System::Call &quot;*$6(i, i) i (.r7, .r8)&quot;<br />
<br />
	/* Derive mouse cursor position relative to control */<br />
	IntOp $0 $7 - $2<br />
	IntOp $1 $8 - $3<br />
<br />
	/* Do something with that cursor position information here, perhaps */<br />
/* 	MessageBox MB_OK &quot;Cursor position relative to control: $0x$1&quot;   */<br />
<br />
    nsDialogs::GetUserData $hwnd_bitmap &quot;a.bmp&quot;<br />
    Pop $0<br />
<br />
    ${Select} $0<br />
    ${Case} &quot;a.bmp&quot;<br />
        StrCpy $1 &quot;b.bmp&quot;<br />
	${Default}<br />
	    StrCpy $1 &quot;a.bmp&quot;<br />
	${EndSelect}<br />
<br />
    ${NSD_FreeImage} $res_bmp<br />
    ${NSD_SetImage} $hwnd_bitmap &quot;$PluginsDir\$1&quot; $res_bmp<br />
    nsDialogs::SetUserData $hwnd_bitmap &quot;$1&quot;<br />
FunctionEnd<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">13th April 2010, 13:37</div></div><div class="posttext">You might want to have a look at the SkinCrafter plugin:<br />
http://www.skincrafter.com/products/nsis-plugin<br />
<br />
Never used it, but it looks like it might do what you want. (You probably have to create your own skin)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Alfaromeo</div><div class="date">14th April 2010, 11:57</div></div><div class="posttext">Excellent piece of code by Animather to demonstrate owner drawn buttons in NSIS .<br />
But for now I 'm going to stick with Skincrafter plugin as it reduces much coding work for me.Also I saw a 60 % increase in the size of the installer by including this plugin. Can anything be done about this ?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>