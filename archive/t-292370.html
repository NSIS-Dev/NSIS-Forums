<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to start function running immediately?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to start function running immediately? NSIS Discussion" />
	
	<title> How to start function running immediately? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to start function running immediately?</div>
<hr />
<div class="pda"><a href="t-292370.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=292370">How to start function running immediately?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">27th May 2008, 15:49</div></div><div class="posttext">Hello.<br />
<br />
I have the following part of code<br />
...<br />
Page custom ShowDownloadingPage PressButton<br />
!insertmacro MUI_PAGE_INSTFILES<br />
...<br />
...<br />
...<br />
Function ShowDownloadingPage<br />
    !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;DLPage.ini&quot;<br />
FunctionEnd<br />
<br />
Function PressButton<br />
    inetc::get /TIMEOUT 10000 /RESUME &quot;One more time?&quot; &quot;http://mydomain/myfile&quot; &quot;$TEMP\\myfile&quot;<br />
    Pop $0<br />
FunctionEnd<br />
<br />
Unfortunately downloading starts only if I press &quot;Install&quot; button on my own page.<br />
My question is how to start it when I press &quot;Next&quot; button on the previous (MUI_PAGE_STARTMENU) page?<br />
<br />
Thank you for your answers.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">27th May 2008, 16:50</div></div><div class="posttext">Doesn't work like this?<br />
<br />
Start the download right after setting up the custom page.<br />
<br />
...<br />
<br />
page custom SetCustom<br />
<br />
...<br />
<br />
Function SetCustom<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;my_page.ini&quot;<br />
  inetc::get /TIMEOUT 10000 /RESUME &quot;One more time?&quot; &quot;http://mydomain/myfile&quot; &quot;$TEMP\myfile&quot; <br />
FunctionEnd<br />
<br />
...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">27th May 2008, 17:27</div></div><div class="posttext">Thank you, LoRd_MuldeR, for your answer.<br />
<br />
Unfortunately, it doesn't work so and I still need to press button for downloading. In addition progress bar of the inetc downloading is not shown.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">27th May 2008, 17:38</div></div><div class="posttext">Maybe the inetc plugin simply was not designed to work on custom pages. Why you can't use it on the normal &quot;instfiles&quot; page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th May 2008, 17:40</div></div><div class="posttext">InstallOptions pauses execution of code. You will have to use it on the install files page.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">27th May 2008, 18:03</div></div><div class="posttext">Thank you for your answers. <br />
<br />
Originally posted by LoRd_MuldeR <br />
Maybe the inetc plugin simply was not designed to work on custom pages. Why you can't use it on the normal &quot;instfiles&quot; page? Well, it works fine and I don't think it depends of inetc as all other functions wouldn't work too if &quot;Install&quot; button is not pressed.<br />
<br />
Originally posted by Afrow UK <br />
InstallOptions pauses execution of code. You will have to use it on the install files page. Actually, I use my own page for checking regisrty and depending of results I start or don't start installing. I can't use downloading on the installation page at all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th May 2008, 19:08</div></div><div class="posttext">Like I said, InstallOptions will pause code execution until you leave the page.<br />
<br />
You can't run InstallOptions and inetc asynchronously without modifying one or the other plug-ins. For example, I (and takhir) modifed the ExecDos to run a program asynchronously allowing someone to display information on their custom page. You would need to modify inetc to allow this.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">27th May 2008, 19:46</div></div><div class="posttext">Apologies if I misunderstood the point here :)<br />
<br />
I assume that your start menu page is just before the custom page, am I right?<br />
<br />
If so, why you need the custom page? You could add the required for download code in start menu leave function.<br />
<br />
If the custom page is mandatory then use nsDialogs.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">28th May 2008, 07:55</div></div><div class="posttext">Thank you again for your answers<br />
<br />
Originally posted by Afrow UK <br />
Like I said, InstallOptions will pause code execution until you leave the page.<br />
<br />
You can't run InstallOptions and inetc asynchronously without modifying one or the other plug-ins. For example, I (and takhir) modifed the ExecDos to run a program asynchronously allowing someone to display information on their custom page. You would need to modify inetc to allow this. Modify sources you mean? I'm not so good for this :) But will try as a last resort...<br />
<br />
Originally posted by Red Wine<br />
Apologies if I misunderstood the point here<br />
I assume that your start menu page is just before the custom page, am I right?<br />
If so, why you need the custom page? You could add the required for download code in start menu leave function.<br />
If the custom page is mandatory then use nsDialogs.You are right and my page goes exactly after start menu page. I need my page to show downloading progress and couldn't find any other ay to display it. As I said before I can't do this on the installation page as I need to dowbload files and check registry before and depending of check start or don't installation.<br />
<br />
Maybe stupid question but is nsDialogs compatible with Modern UI?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">28th May 2008, 18:59</div></div><div class="posttext">Originally posted by oldfriend <br />
You are right and my page goes exactly after start menu page. I need my page to show downloading progress and couldn't find any other ay to display it. As I said before I can't do this on the installation page as I need to dowbload files and check registry before and depending of check start or don't installation.<br />
<br />
Maybe stupid question but is nsDialogs compatible with Modern UI?  <br />
While you're using inetc, you don't need a page, it is able to load in a function with /POPUP parameter, you will find more info in the inetc docs.<br />
<br />
Absolutely compatible, preferable with MUI2.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">29th May 2008, 10:56</div></div><div class="posttext">Thank you very much, Red Wine. Seems like I need inetc with /BANNER option instead of custom page and connected problems))</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">2nd June 2008, 14:15</div></div><div class="posttext">Had to look into the sources of inetc and modified /BANNER mode, so that instead of it the window with the same size is displayed with the progress bar and text (sure parent window is hidden at that moment).<br />
<br />
Thanks to all. The problem is solved.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>