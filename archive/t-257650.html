<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Patching NSIS-Setups on-the-fly when downloading?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Patching NSIS-Setups on-the-fly when downloading? NSIS Discussion" />
	
	<title> Patching NSIS-Setups on-the-fly when downloading? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Patching NSIS-Setups on-the-fly when downloading?</div>
<hr />
<div class="pda"><a href="t-257650.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257650">Patching NSIS-Setups on-the-fly when downloading?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mstap</div><div class="date">16th October 2006, 10:50</div></div><div class="posttext">Hello everyone,<br />
<br />
I'm currently programming a software portal for our customers and I'd like to pre-patch the setup with their own serial number.<br />
<br />
To realize that, I've put a long string into the according field in the INI-file, let's say &quot;serial=4444444444444444444444&quot;. Also, I've turned compression off for this file to be able to recognize it again in my download-program. When downloading the file, the script searches for the string mentioned above and replaces it with the serial number (fully transparent of course, the customer thinks he's downloading a normal executable file - mod_rewrite rocks ;)).<br />
<br />
That all works, but now comes the problem: the CRC-checksum does not match of course.<br />
<br />
My question: Is there the possibility to disable CRC-checksums for only one file or is there a method to re-build the checksum on the fly (where is it located in the executable and what area is used to generate it?) or are there other methods for replacing parts of the installer (constants or defined or whatever you'd like to call it) automatically?<br />
<br />
Thanks in advance,<br />
Michael</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th October 2006, 11:06</div></div><div class="posttext">Write the serial number to the end of the file. That part is ignored by the CRC check. To read it back, use GetModuleFileName (http://nsis.sourceforge.net/Get_installer_filename), FileOpen, FileSeek, FileRead and FileClose.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mstap</div><div class="date">16th October 2006, 13:57</div></div><div class="posttext">Hi kichik,<br />
<br />
Thanks for your tip. I found http://nsis.sourceforge.net/ReadCustomerData and it works perfectly :).<br />
<br />
Thanks,<br />
Michael</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">17th October 2006, 10:40</div></div><div class="posttext">A better way is to add an extra field to Version resource information, because even if you sign your application with an MS  authenticate certificate you still can modify a value on the fly without breaking the finished application.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th October 2006, 10:58</div></div><div class="posttext">CRC is done on the resource section as well, including the version information.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">17th October 2006, 11:24</div></div><div class="posttext">Yes, CRC does, I forgot :( Since I do not use it. OK appending to the end is better sollution I see...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>