<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" CreateShortCut bug - $WORKDIR is needed, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  CreateShortCut bug - $WORKDIR is needed NSIS Discussion" />
	
	<title> CreateShortCut bug - $WORKDIR is needed [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  CreateShortCut bug - $WORKDIR is needed</div>
<hr />
<div class="pda"><a href="t-51701.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=51701">CreateShortCut bug - $WORKDIR is needed</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">django</div><div class="date">5th June 2001, 06:18</div></div><div class="posttext">Hi:<br />
<br />
Have a look at this scripts which setup start menu links:<br />
...<br />
SetOutPath $SMPROGRAMS\MyApp<br />
CreateShortCut &quot;$SMPROGRAMS\MyApp\MyApp.lnk&quot; &quot;$INSTDIR\MyApp.exe&quot;<br />
...<br />
<br />
After installation, MyApp.exe may not work from the Start menu, since the working directory is pointing to $SMPROGRAMS, that was the $OUTDIR, not the $INSTDIR.<br />
<br />
IMHO this is a not healthy logic, because most app will not be happy to work in $SMPROGRAMS.<br />
<br />
So it maybe helpful to set a $WORKDIR for CreateShortCut instruction to do it right.<br />
<br />
P.S. Interestingly, this instruction do things right when creating desktop shortcuts, the working directory was set to $INSTDIR...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yazno</div><div class="date">5th June 2001, 09:38</div></div><div class="posttext">hi<br />
<br />
If you use SetOutPath in adiition with CreateShortCut then SetOutPath sets the workingdirectory, nothing else.<br />
<br />
Simply set it to $INSTDIR and everything should work fine.<br />
<br />
try it like this<br />
<br />
<br />
SetOutPath - ;($INSTDIR)<br />
CreateShortCut &quot;$SMPROGRAMS\MyApp\MyApp.lnk&quot; &quot;$INSTDIR\MyApp.exe&quot;<br />
<br />
<br />
cu yzo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">django</div><div class="date">6th June 2001, 07:48</div></div><div class="posttext">thanks yazno, <br />
<br />
but I'm afraid that the CreateShortCut behaves not as what you described, I tried your suggested code, but the installer just outputs alotof error msg like this:<br />
--------------------------------------------------------------------------------<br />
  Error creating shortcut: C:\Windows\Start Menu\Programs\MyApp\MyApp.lnk<br />
--------------------------------------------------------------------------------<br />
<br />
I found if without issue this line first: <br />
 SetOutPath $SMPROGRAMS<br />
all the following $SMPROGRAMS\*.lnk shortcuts always failed,<br />
but with this line, MyApp.exe shortcut's working directory will also be the $SMPROGRAMS.<br />
do we have a dilemma here?<br />
 <br />
Pardon me for mentioning this again, the following desktop shortcut script works:<br />
--------------------------------------------------------------------------------<br />
  SetOutPath $INSTDIR<br />
  CreateShortCut &quot;$DESKTOP\MyApp.lnk&quot; &quot;$INSTDIR\MyApp\MyApp.exe&quot;<br />
--------------------------------------------------------------------------------<br />
the exe working directory was set to $INSTDIR accurately, but the same logic above won't apply to $SMPROGRAMS shortcut setting.<br />
<br />
maybe it's the time to re-think why the CreateShortCut instruction behave this way... :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yazno</div><div class="date">6th June 2001, 08:33</div></div><div class="posttext">hi,<br />
<br />
no need to re-think this.<br />
<br />
you have to create the MyApp directory in the $SMPROGRAMS folder _before_ creating the Shortcut!<br />
<br />
sorry, i thought you knew that.<br />
<br />
so this should work:<br />
<br />
SetOutPath -<br />
CreateDirectory $SMPROGRAMS\MyApp<br />
CreateShortCut &quot;$SMPROGRAMS\MyApp\MyApp.lnk&quot; &quot;$INSTDIR\MyApp.exe&quot;<br />
<br />
<br />
cu yzo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">7th June 2001, 09:15</div></div><div class="posttext">My point, exactly. (http://forums.winamp.com/showthread.php?threadid=51174)<br />
<br />
For some reason, on certain systems, the directory needs to be created. I think this is a bug, most definitely, since on some systems this isn't required.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>