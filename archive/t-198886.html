<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Using MSDOS-Commandline commands in NSIS, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Using MSDOS-Commandline commands in NSIS NSIS Discussion" />
	
	<title> Using MSDOS-Commandline commands in NSIS [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Using MSDOS-Commandline commands in NSIS</div>
<hr />
<div class="pda"><a href="t-198886.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198886">Using MSDOS-Commandline commands in NSIS</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bgosalci</div><div class="date">10th November 2004, 15:31</div></div><div class="posttext">I would like to know how could I execute MSDOS commands in .nsi script. Is it possible to do this or not, if no what can I use instead to achieve the same results.<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">10th November 2004, 16:11</div></div><div class="posttext">Take a look in the documentation for Exec, ExecShell and ExecWait.  I would gather one of those functions should be able to do what you want.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bgosalci</div><div class="date">10th November 2004, 16:23</div></div><div class="posttext">Exec or ExecWait: Executes the specified program and continue immediately. Note that the file specified must exist on the target system, not the compiling system. $OUTDIR is used for the working directory.<br />
<br />
Eg.<br />
<br />
ExecWait 'MSDE 2000A\setup.exe SAPWD=pas INSTANCENAME=MyInstance TARGETDIR=&quot;$INSTDIR\MSDE 2000A\&quot; /qn'<br />
<br />
Exec command executes programs .exe or any other extension.<br />
What i would like to know is how could I execute this command in NSIS script:<br />
<br />
,%CATALINA_HOME%\bin\tomcat.exe -install My-Tomcat %JAVA_HOME%\jre\bin\server\jvm.dll -Djava.class.path=%CATALINA_HOME%\bin\bootstrap.jar;%JAVA_HOME%\lib\tools.jar -Djava.endorsed.dirs=%CATALINA_HOME%\common\endorsed -Dcatalina.home=%CATALINA_HOME% -server -Xms128m -Xmx512m -Xrs -start org.apache.catalina.startup.BootstrapService -params start -stop org.apache.catalina.startup.BootstrapService -params stop -out %CATALINA_HOME%\logs\stdout.log -err %CATALINA_HOME%\logs\stderr.log,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th November 2004, 17:49</div></div><div class="posttext">Why not make a batch file and execute that?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">10th November 2004, 17:54</div></div><div class="posttext">nsExec plug-in also can hide DOS window and redirects output to log file or stack. Please read NSIS/Contrib/nsExec/nsExec.txt for command line format. You will need to replace %% parameters with NSIS script variables.<br />
I see very long command lines (line) in your post and this may even increase with real paths instead of %%, please note - Windows defines MAX_PATH = 260 characters.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bgosalci</div><div class="date">10th November 2004, 18:21</div></div><div class="posttext">How would I execute the following commandline command using nsExec::Exec:<br />
<br />
'osql -E -SserverName\LA \<br />
RESTORE DATABASE MyDatabase \<br />
FROM DISK = 'C:\LA\MSDE 2000A\Backup\MyDatabase ' \<br />
WITH RECOVERY, \<br />
MOVE &quot;MyDatabase_Data&quot; TO &quot;C:\LA\MSDE 2000A\MSSQL$LA\Data\MyDatabase.mdf&quot;, \<br />
MOVE &quot;MyDatabase_Log&quot; TO &quot;C:\LA\MSDE 2000A\MSSQL$LA\Data\MyDatabase.ldf&quot; \<br />
GO'<br />
<br />
Is it simply executed as follows:<br />
<br />
nsExec::Exec 'osql -E -SserverName\LA \<br />
RESTORE DATABASE MyDatabase \<br />
FROM DISK = 'C:\LA\MSDE 2000A\Backup\MyDatabase ' \<br />
WITH RECOVERY, \<br />
MOVE &quot;MyDatabase_Data&quot; TO &quot;C:\LA\MSDE 2000A\MSSQL$LA\Data\MyDatabase.mdf&quot;, \<br />
MOVE &quot;MyDatabase_Log&quot; TO &quot;C:\LA\MSDE 2000A\MSSQL$LA\Data\MyDatabase.ldf&quot; \<br />
GO'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th November 2004, 19:39</div></div><div class="posttext">Yes, but will it always be C:\LA\... on the user's system?<br />
If it isn't then you should substitute it for a variable which will contain the path either entered by the user or for example read from the registry.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bgosalci</div><div class="date">10th November 2004, 22:49</div></div><div class="posttext">OK, so the correct way of using nsExec::Exec command will be, as follows:<br />
<br />
nsExec::Exec 'osql -E -S$ServerName\LA \<br />
RESTORE DATABASE MyDatabase \<br />
FROM DISK = $InstDir\MSDE 2000A\Backup\MyDatabase ' \<br />
WITH RECOVERY, \<br />
MOVE &quot;MyDatabase_Data&quot; TO &quot;$InstDir\MSDE 2000A\MSSQL$LA\Data\MyDatabase.mdf&quot;, \<br />
MOVE &quot;MyDatabase_Log&quot; TO &quot;$InstDir\MSDE 2000A\MSSQL$LA\Data\MyDatabase.ldf&quot; \<br />
GO'<br />
<br />
Yer or No<br />
<br />
And by the way thank you very match to all, for all the help.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>