<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Type an UNC-Path in the Directorypage, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Type an UNC-Path in the Directorypage NSIS Discussion" />
	
	<title> Type an UNC-Path in the Directorypage [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Type an UNC-Path in the Directorypage</div>
<hr />
<div class="pda"><a href="t-302695.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=302695">Type an UNC-Path in the Directorypage</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Ralph_DE</div><div class="date">2nd February 2009, 15:48</div></div><div class="posttext">Hello everyone,<br />
<br />
We have a little problem with the auto-complete functionality in the Directorypage.<br />
<br />
If we type 'c:\' in the textbox, we will get directly suggestions for the path.<br />
<br />
But if we type in an UNC-path like '\\server\path' the installer will block for some seconds after the first three characters. <br />
<br />
Does NSIS starts a Computer Browsing in this case?<br />
<br />
Can we disable the auto-complete functionality?<br />
<br />
Any help will be appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd February 2009, 15:56</div></div><div class="posttext">NSIS just tells windows to auto-complete, it does no processing on its own.<br />
<br />
You can control some aspects of autocomplete in the internet explorer advanced options (yes, really)<br />
<br />
If you REALLY need to disable the autocompletion, you must do some COM magic with CLSID_AutoComplete on the editbox<br />
<br />
edit:<br />
calling IAutoComplete::Enable orIAutoComplete2::SetOptions(xxx) should be what you are after (depending on how much control you want)<br />
<br />
You can call COM with the system plugin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd February 2009, 16:53</div></div><div class="posttext">function dshow<br />
; ONLY TESTED ON XPSP2, COULD FAIL BADLY ON OTHER SYSTEMS!!!<br />
!include LogicLib.nsh<br />
FindWindow $9 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
GetDlgItem $9 $9 0x3FB<br />
!define CLSCTX_INPROC_SERVER 1<br />
!define CLSID_AutoComplete {00BB2763-6A77-11D0-A535-00C04FD7D062}<br />
!define IID_IAutoComplete  {00BB2762-6A77-11D0-A535-00C04FD7D062}<br />
System::Call &quot;ole32::CoCreateInstance( \<br />
	g '${CLSID_AutoComplete}', i 0, \<br />
	i ${CLSCTX_INPROC_SERVER}, \<br />
	g '${IID_IAutoComplete}', *i .r0) i.r1&quot;<br />
${If} $1 = 0<br />
	/*&lt;HACK&gt;<br />
	IAutoComplete.Init:<br />
		punkACL needs a IUnknown that implements IEnumString, <br />
		I don't know if IAutoComplete does or if QI is not called by Init, but this seems to work<br />
	&lt;/HACK&gt;*/<br />
	System::Call &quot;$0-&gt;3(i $9,i $0,i0,i0)i.r1&quot; ;IAutoComplete.Init<br />
	${If} $1 = 0<br />
		System::Call &quot;$0-&gt;4(i 0)&quot; ;IAutoComplete.Enable<br />
	${EndIf}<br />
	System::Call &quot;$0-&gt;2()&quot; ;Release<br />
${EndIf}<br />
functionend<br />
<br />
page directory &quot;&quot; dshow</div></div><hr />


<div class="post"><div class="posttop"><div class="username">beth62</div><div class="date">19th April 2010, 18:03</div></div><div class="posttext">I am having the same problem as the original poster and the suggested fix did not work for me.  It literally take s seconds for NSIS to respond when the user is trying to change the UNC path.<br />
<br />
Can an option be added to disable autocomplete on the directory page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">19th April 2010, 18:38</div></div><div class="posttext">Alternative:<br />
<br />
function dshow<br />
FindWindow $9 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
GetDlgItem $9 $9 0x3FB<br />
System::Call 'SHLWAPI::SHAutoComplete(i $9,i 0x80000000|0x20000000)'<br />
functionend <br />
page directory &quot;&quot; dshow Note that calling SHAutoComplete more than once will cause a leak (probably not a big deal in our case)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>