<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" install sequence just before MUI_PAGE_FINISH, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  install sequence just before MUI_PAGE_FINISH NSIS Discussion" />
	
	<title> install sequence just before MUI_PAGE_FINISH [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  install sequence just before MUI_PAGE_FINISH</div>
<hr />
<div class="pda"><a href="t-295347.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=295347">install sequence just before MUI_PAGE_FINISH</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">zanz</div><div class="date">31st July 2008, 23:17</div></div><div class="posttext">Is there a function or way to access files from the install dir just before the finish page MUI_PAGE_FINISH is displayed?<br />
<br />
.onInstSuccess function (i think) executes when the finish page is already displayed. <br />
<br />
A situation where installer has just finished copying files to the installdir, but the finish page isn't displayed. Do we have any function in between?<br />
<br />
What I'm trying to do is to silently install a msi package from the install dir. When i silently launch the installation of the msi package from the installdir on .onInstSuccess fucntion, it seems like the installer has frozen on the finish page (until the MSI package is installed). It's a bad user experience. I'm just trying to create a better user experience. Please help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">1st August 2008, 00:31</div></div><div class="posttext">Create a custom pre/show function for the finish page:<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE MyFinishPre<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW MyFinishShow<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
[...]<br />
<br />
Function MyFinishPre<br />
  ...<br />
FunctionEnd<br />
<br />
Function MyFinishShow<br />
  Banner::show /NOUNLOAD &quot;Installing important stuff, please wait...&quot;<br />
  File /oname=$PLUGINSDIR\Setup.exe &quot;redist\Setup.exe&quot;<br />
  ExecWait '&quot;$PLUGINSDIR\Setup.exe&quot; /S'<br />
  Banner::destroy&quot;<br />
FunctionEnd<br />
<br />
<br />
Alternatively you could simply install the MSI package in the last install section.<br />
<br />
If you do it in the show function, I'd use the Banner plugin, see code above...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zanz</div><div class="date">1st August 2008, 18:57</div></div><div class="posttext">Thanks a bunch, exactly what i was looking for!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>