<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Add task using schtasks from nsis, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Add task using schtasks from nsis NSIS Discussion" />
	
	<title> Add task using schtasks from nsis [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Add task using schtasks from nsis</div>
<hr />
<div class="pda"><a href="t-349406.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=349406">Add task using schtasks from nsis</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">adnanshaheen</div><div class="date">1st October 2012, 15:29</div></div><div class="posttext">Hi All,<br />
<br />
I am trying to add a task to task scheduler, using my nsis script.<br />
<br />
ExecWait '$SYSDIR\schtasks.exe /Create /TN MyAppTask /SC ONSTART /TR &quot;$INSTDIR&quot;\MyApp.exe /RU System'<br />
<br />
It adds a task but there is a problem with the task.<br />
schtasks add the task with application name &quot;$INSTDIR&quot;\MyApp.exe<br />
You people must know, here, $INSTDIR is &quot;C:\Program Files&quot;.<br />
<br />
Now the problem is, schtasks add the task with application &quot;C:\Program&quot; and arguments to the application as &quot;Files\MyApp.exe&quot;. Which is definitely incorrect.<br />
<br />
I want the application &quot;C:\Program Files\MyApp.exe&quot; to be the task.<br />
Any help is highly appreciated.<br />
<br />
Regards:-<br />
Adnan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">1st October 2012, 15:42</div></div><div class="posttext">Try &quot;$INSTDIR\MyApp.exe&quot;?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">adnanshaheen</div><div class="date">1st October 2012, 15:54</div></div><div class="posttext">Same result</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">1st October 2012, 16:42</div></div><div class="posttext">Example @ http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/schtasks.mspx?mfr=true uses quoted path so it should be supported...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">adnanshaheen</div><div class="date">1st October 2012, 16:55</div></div><div class="posttext">It should be, but it seems not.<br />
<br />
Why don't you give it a small try. You will find out.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">1st October 2012, 18:45</div></div><div class="posttext">The page that Anders recommends has an example:<br />
schtasks /change /tn Notepad /tr &quot;c:\program files\Internet Explorer\iexplore.exe&quot; /ru DomainX\Admin01<br />
<br />
You should use their syntax with single quotes around the entire line for ExecWait to take the line as one parameter.ExecWait '$SYSDIR\schtasks /create /tn MyAppTask /sc onstart /tr &quot;$INSTDIR\MyApp.exe&quot; /ru SYSTEM'<br />
If that still doesn't work, try using the short file name version (8.3) of the path to your program. It won't need quotes that way.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">adnanshaheen</div><div class="date">2nd October 2012, 07:36</div></div><div class="posttext">ok, thanks. But this doesn't work either.<br />
<br />
How to get the short file name using the nsi script.<br />
Because $INSTDIR can be changed by user during installation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">adnanshaheen</div><div class="date">2nd October 2012, 09:11</div></div><div class="posttext">I guess GetFullPathName /SHORT is the answer here. Thanks Demiller9</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">5th October 2012, 13:09</div></div><div class="posttext">http://forums.winamp.com/showthread.php?t=283321</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>