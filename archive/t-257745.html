<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" help reading field values on ModernUI, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  help reading field values on ModernUI NSIS Discussion" />
	
	<title> help reading field values on ModernUI [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  help reading field values on ModernUI</div>
<hr />
<div class="pda"><a href="t-257745.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257745">help reading field values on ModernUI</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">chickendavis</div><div class="date">17th October 2006, 16:13</div></div><div class="posttext">Hello,<br />
<br />
I've been struggling with reading the values from some fields i have on a custom dialog using the Modern UI. <br />
<br />
Here is the ini content (Tester.ini):<br />
[Settings]<br />
NumFields=1<br />
<br />
[Field 1]<br />
Type=CheckBox<br />
Left=15<br />
Right=-12<br />
Top=3<br />
Bottom=18<br />
Text=Enabled Blah<br />
<br />
<br />
Here are some script snippets that deal with this dialog:<br />
;include custom page<br />
Page Custom ShowDlg LeaveDlg<br />
<br />
;initialization<br />
Var DLG_INI<br />
Function .onInit<br />
  InitPluginsDir<br />
  GetTempFileName $DLG_INI $PLUGINSDIR<br />
  File /oname=$DLG_INI &quot;Tester.ini&quot;<br />
FunctionEnd<br />
<br />
Function ShowDlg<br />
  InstallOptions::initDialog /NOUNLOAD &quot;$BMS_DLG_INI&quot;<br />
  InstallOptions::show<br />
FunctionEnd<br />
<br />
Function LeaveDlg<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $0 &quot;Tester.ini&quot; &quot;Field 1&quot; &quot;State&quot;<br />
  MessageBox MB_OK &quot;Value: $0&quot;<br />
FunctionEnd<br />
<br />
<br />
As you can see this is a very simple example. Im using the MUI_INSTALLOPTIONS_READ macro but it never pulls the value in. MessageBox never displays a value. From what i've read, this script seems correct. Is there something im missing? or is there an alternative way of reading the values from the fields.<br />
<br />
Thanks very much for the help. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th October 2006, 16:22</div></div><div class="posttext">If you're not using the MUI macros to extract and show the INI file, don't use the MUI macros to read and write from the file. Use ReadINIStr instead.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chickendavis</div><div class="date">18th October 2006, 13:53</div></div><div class="posttext">sweet that worked perfect.. thanx for the help mon.<br />
should i be using the mui macros as opposed to how im doing it now? if so, can you give me an example of how the script would change to use mui macros instead? <br />
thanx again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th October 2006, 09:55</div></div><div class="posttext">When using the MUI, you should use the MUI macros to handle custom InstallOptions pages as it does some things behind the scenes for you so they'll come up more MUI-like. An example is available in the Examples\Modern UI directory.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>