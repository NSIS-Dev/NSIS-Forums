<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" install problem on Windows Server 2003, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  install problem on Windows Server 2003 NSIS Discussion" />
	
	<title> install problem on Windows Server 2003 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  install problem on Windows Server 2003</div>
<hr />
<div class="pda"><a href="t-299376.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=299376">install problem on Windows Server 2003</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">xlrotor</div><div class="date">31st October 2008, 04:59</div></div><div class="posttext">A user today reported that a rather simple installer of mine installed fine for him on a Win XP system, but when he ran it on a Windows Server 2003 system, everything appeared to have gone fine except the application folder in Program Files didn't get created, and so no files were installed.<br />
<br />
Does anyone have a clue as to what might cause this?<br />
<br />
Thanks,<br />
<br />
Brian Murphy<br />
Austin, Texas<br />
<br />
Here's the part of the script where the installing is done.  I changed &quot;ifnewer&quot; to &quot;try&quot; and sent that to him to try, but I doubt it will matter.<br />
<br />
InstallDir &quot;$PROGRAMFILES\XLRotor Security Key Server&quot;<br />
InstallDirRegKey HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot;<br />
ShowInstDetails show<br />
ShowUnInstDetails show<br />
<br />
Section &quot;MainSection&quot; SEC01<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  SetOverwrite ifnewer<br />
<br />
  File /a /r &quot;Files\*.*&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">31st October 2008, 06:53</div></div><div class="posttext">Are you dealing with the 64-bit version of 2003 server?  If so, then the files were likely installed under the &quot;Program Files (x86)&quot; folder.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xlrotor</div><div class="date">31st October 2008, 12:40</div></div><div class="posttext">I will find out and report back.  <br />
<br />
Although, I did ask him to search the entire system for the files, and he said he did and did not find the files.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">31st October 2008, 16:18</div></div><div class="posttext">Another thing that comes to mind is that maybe the user just didn't have the proper permissions.  You might change your code just slightly to check for errors.  (It won't tell you WHICH error, but would at least alert you to problems during the install):<br />
<br />
!include logiclib.nsh<br />
...<br />
Section &quot;MainSection&quot; SEC01<br />
   ClearErrors<br />
   SetOutPath &quot;$INSTDIR&quot;<br />
   SetOverwrite ifnewer<br />
   File /a /r &quot;Files\*.*&quot;<br />
   ${If} ${Errors}<br />
      MessageBox MB_OK &quot;Error copying files!&quot;<br />
   ${EndIf}<br />
SectionEnd<br />
(Or, you could change the MessageBox to a DetailPrint command so that problems are at least documented in the install log.)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>