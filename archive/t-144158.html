<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Open with... NSIS, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Open with... NSIS NSIS Discussion" />
	
	<title> Open with... NSIS [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Open with... NSIS</div>
<hr />
<div class="pda"><a href="t-144158.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=144158">Open with... NSIS</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">30th July 2003, 20:55</div></div><div class="posttext">i was wondering if/how i could register a filetype to be opened with a NSIS scripted program (blabla.exe filename.bla). the question would be how to hand over the file as variable within NSIS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">30th July 2003, 21:44</div></div><div class="posttext">I think, based on makensis.nsi example, it's registry thing, look:<br />
<br />
  ReadRegStr $1 HKCR &quot;.nsi&quot; &quot;&quot;<br />
  StrCmp $1 &quot;&quot; Label1<br />
    StrCmp $1 &quot;NSISFile&quot; Label1<br />
    WriteRegStr HKCR &quot;.nsi&quot; &quot;backup_val&quot; $1<br />
  Label1:<br />
  WriteRegStr HKCR &quot;.nsh&quot; &quot;&quot; &quot;NSHFile&quot;<br />
  ReadRegStr $0 HKCR &quot;NSHFile&quot; &quot;&quot;<br />
  StrCmp $0 &quot;&quot; 0 skipNSHAssoc<br />
	WriteRegStr HKCR &quot;NSHFile&quot; &quot;&quot; &quot;NSIS Header File&quot;<br />
	WriteRegStr HKCR &quot;NSHFile\shell&quot; &quot;&quot; &quot;open&quot;<br />
	WriteRegStr HKCR &quot;NSHFile\DefaultIcon&quot; &quot;&quot; $INSTDIR\makensisw.exe,1<br />
  skipNSHAssoc:<br />
  WriteRegStr HKCR &quot;NSHFile\shell\open\command&quot; &quot;&quot; 'notepad.exe &quot;%1&quot;'<br />
  WriteRegStr HKCR &quot;.nsi&quot; &quot;&quot; &quot;NSISFile&quot;<br />
  ReadRegStr $0 HKCR &quot;NSISFile&quot; &quot;&quot;<br />
  StrCmp $0 &quot;&quot; 0 skipNSIAssoc<br />
	WriteRegStr HKCR &quot;NSISFile&quot; &quot;&quot; &quot;NSIS Script File&quot;<br />
	WriteRegStr HKCR &quot;NSISFile\shell&quot; &quot;&quot; &quot;open&quot;<br />
	WriteRegStr HKCR &quot;NSISFile\DefaultIcon&quot; &quot;&quot; $INSTDIR\makensisw.exe,1<br />
  skipNSIAssoc:<br />
  WriteRegStr HKCR &quot;NSISFile\shell\open\command&quot; &quot;&quot; 'notepad.exe &quot;%1&quot;'<br />
  WriteRegStr HKCR &quot;NSISFile\shell\compile&quot; &quot;&quot; &quot;Compile NSI&quot;<br />
  WriteRegStr HKCR &quot;NSISFile\shell\compile\command&quot; &quot;&quot; '&quot;$INSTDIR\makensisw.exe&quot; &quot;%1&quot;'<br />
  WriteRegStr HKCR &quot;NSISFile\shell\compile-bz2&quot; &quot;&quot; &quot;Compile NSI (with bz2)&quot;<br />
  WriteRegStr HKCR &quot;NSISFile\shell\compile-bz2\command&quot; &quot;&quot; '&quot;$INSTDIR\makensisw.exe&quot; /X&quot;SetCompressor bzip2&quot; &quot;%1&quot;'<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">31st July 2003, 00:51</div></div><div class="posttext">See my archive page on the related topic. :D <br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">31st July 2003, 09:57</div></div><div class="posttext">maybe the topic of this was misleading. i want to open a file with a software made with nsis, not with nsis itself.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">31st July 2003, 10:44</div></div><div class="posttext">I think you would need to use the System plugin for that.<br />
After getting hold of the file you will ned to use SendMessage to place the file name in your IO Text box [or whatever]<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">31st July 2003, 10:49</div></div><div class="posttext">Ok, it's very easy actually.<br />
Use the GetParameters function on the NSIS archive, and that will get hold of the file name that Windows executed your program with.<br />
You need to write registry strings to register your file type too.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">31st July 2003, 12:17</div></div><div class="posttext">sounds very nice. will put my script to the archive once its working.<br />
<br />
edit: how do i get the parameters only?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">31st July 2003, 14:18</div></div><div class="posttext">* i tried using the GetFileName function to strip the application name (to get the parameters only). didnt work. i guess it can be done with a modified GetParameters, but i dont even understand this one.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">31st July 2003, 16:09</div></div><div class="posttext">Use GetParemeters like so:<br />
<br />
Call GetParemeters<br />
 Pop $0<br />
<br />
$0 = paramater, in this case the file (name) that was double clicked on<br />
<br />
E.g.<br />
If the user opened up map.sla, then $0 would be &quot;map.sla&quot; (including quotes)<br />
You can simply write that value to an ini file, or whatever.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">31st July 2003, 18:34</div></div><div class="posttext">Originally posted by Afrow UK <br />
<br />
If the user opened up map.sla, then $0 would be &quot;map.sla&quot; (including quotes)<br />
<br />
this is not quite true. i tested this in the command-line. openening a file containing no spaces in its name, $0 will not contain any quotes. when i open a file with spaces, windows requires using quotes, so $0 will contains quotes.<br />
<br />
the problem is that those quotes don't allow me to use the $0 to write it into an ini-file (File=C:\Program Files\Bla\&quot;my file.bla&quot;).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">31st July 2003, 20:11</div></div><div class="posttext">You need to remove them.<br />
You will need to add the StrStr and StrReplace functions to your script to get it working:<br />
<br />
## Check if $0 has any &quot; in it<br />
Push $0<br />
Push &quot;$\&quot;&quot;<br />
 Call StrStr<br />
Pop $1<br />
StrCmp $1 &quot;&quot; no_replace<br />
# $1 = &quot;&quot; if no &quot;$\&quot;&quot; was found in string<br />
<br />
## Replace all &quot;$\&quot; in string<br />
Push $0<br />
Push &quot;$\&quot;<br />
Push &quot;&quot;<br />
 Call StrReplace<br />
Pop $0<br />
<br />
no_replace:<br />
<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">2nd August 2003, 09:32</div></div><div class="posttext">now i lost it completely. i put this right after my last &quot;pop $0&quot; command?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd August 2003, 11:49</div></div><div class="posttext">Sorry, I missed somthing off.<br />
On the StrReplace push:<br />
Push &quot;$\&quot;<br />
change to<br />
Push &quot;$\&quot;&quot;<br />
<br />
$\&quot; is the same as &quot; but it escapes the command-quotes.<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>