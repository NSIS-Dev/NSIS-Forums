<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Closing a DOS box problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Closing a DOS box problem NSIS Discussion" />
	
	<title> Closing a DOS box problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Closing a DOS box problem</div>
<hr />
<div class="pda"><a href="t-108185.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=108185">Closing a DOS box problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Sailo</div><div class="date">3rd October 2002, 14:42</div></div><div class="posttext">Hi,<br />
<br />
I'm struggling to close a DOS box after running a batch file.  What am i missing?<br />
<br />
Name &quot;DOS Window Test&quot;<br />
OutFile &quot;FindWindow.exe&quot;<br />
<br />
!define WM_CLOSE 0x10<br />
<br />
Section<br />
File 'test.bat'<br />
<br />
Exec 'test.bat'<br />
<br />
findloop:<br />
    Sleep 500<br />
    FindWindow $0 &quot;test&quot;<br />
    StrCmp $0 0 findloop<br />
<br />
MessageBox MB_OK &quot;Click OK to close DOS Window&quot;<br />
<br />
SendMessage $0 ${WM_CLOSE} 0 0<br />
<br />
SectionEnd<br />
;eof<br />
<br />
It just seems to get stuck in a loop.<br />
<br />
Test.bat just contains an echo statement.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd October 2002, 14:50</div></div><div class="posttext">Are you sure the window name is &quot;test&quot;? Have you tried nsExec? It will show the output in the NSIS log, or no output at all if that's what you want.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sailo</div><div class="date">3rd October 2002, 15:10</div></div><div class="posttext">The blue bar at the top of the window reads 'Finished - test' and if i right click on it and select properties it has test in the title box.<br />
<br />
I'm using nsis 1.99 so don't have option of nsExec. Any other ideas? How do you use shellExec? Will that help?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd October 2002, 15:23</div></div><div class="posttext">Download nsExec.dll alone from the CVS and use it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sailo</div><div class="date">3rd October 2002, 15:56</div></div><div class="posttext">How can i display a list of window titles of windows that are currently open?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd October 2002, 16:03</div></div><div class="posttext">You can't with NSIS. You will have to create an extension DLL to do this with EnumWindows.<br />
<br />
Why won't you use nsExec? It is so much easier and simpler.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sailo</div><div class="date">3rd October 2002, 16:46</div></div><div class="posttext">I am just trying to make sure my window title is correct. <br />
<br />
I can't get nsExec to work. Where is the log that it rights. I can't find any info on it.<br />
<br />
If you just open a command prompt what is the window title? This is all i'm trying to find out.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd October 2002, 16:57</div></div><div class="posttext">nsExec logs into the NSIS log, installation details. Logging will not work with NSIS 1.x because the logging method has changed since 2.0a2/3, I am sorry I mislead you. You can still use simple Exec with no output.<br />
<br />
I think the window title should be the name of the batch file at the begining but after it finishes it depends on language of the system (Finished in different languages). You can't trust the NSIS process to be fast enough when trying to find the window before the title changes, it could be problematic.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sailo</div><div class="date">3rd October 2002, 17:06</div></div><div class="posttext">I have found that if you run a batch file and the very last command in the file is CLS windows automatically shuts the screen for you. So instead i created a temporary batch file, put my command with all its variables into it with a CLS on the end then used execwait to run it then deleted it.<br />
<br />
This works fine for me but thanks for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">david33470</div><div class="date">7th October 2002, 13:13</div></div><div class="posttext">During the installation, I compile the uninstal script (that it permit me to give some parameter from the install script to the uninstall one) using the following comand:<br />
<br />
ExecWait '&quot;$NSISDIR\makensis.exe&quot; /CD /PAUSE /Duninstalrekey=&quot;My parameter&quot;  Uninstallscript.nsi'<br />
but the problem is that the dos windows doesn't close automaticaly!!!<br />
what can I do for the windows closing automaticaly???<br />
<br />
Tank you, in advance, for your help!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">7th October 2002, 15:33</div></div><div class="posttext">Use nsExec</div></div><hr />


<div class="post"><div class="posttop"><div class="username">david33470</div><div class="date">7th October 2002, 21:09</div></div><div class="posttext">OK but I dont find nsexec in the documentation.<br />
how can I use this command?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Netsabes</div><div class="date">7th October 2002, 21:38</div></div><div class="posttext">It's a plugin. There should be a readme in Contrib/nsExec/ explaining it's functions.<br />
Also, if you are using the current cvs version, plugins are not called like in NSIS 1.x/2.0alpha. You need to use something like plugin::func.<br />
<br />
For nsExec, it's nsExec::Exec [/TIMEOUT=x] path and nsExec::ExecToLog [/TIMEOUT=x] path</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">8th October 2002, 09:31</div></div><div class="posttext">The old way still works, but this is a easier of course.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>