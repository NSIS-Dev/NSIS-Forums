<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" catch more then 1 event on custom page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  catch more then 1 event on custom page NSIS Discussion" />
	
	<title> catch more then 1 event on custom page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  catch more then 1 event on custom page</div>
<hr />
<div class="pda"><a href="t-292049.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=292049">catch more then 1 event on custom page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ssam</div><div class="date">20th May 2008, 13:07</div></div><div class="posttext">Hello,<br />
<br />
at first sorry for my bad english, but i hope you understand me.<br />
<br />
<br />
<br />
Function getDataTestDBLeave<br />
<br />
  readinistr $0 'getDataTestDB.ini' 'Settings' 'State'<br />
  StrCmp $0 10 TestDB_checked TestDB_nocheck<br />
<br />
   TestDB_checked:<br />
<br />
   ReadIniStr $3 &quot;getDataTestDB.ini&quot; &quot;Field 3&quot; &quot;HWND&quot;<br />
   ReadIniStr $5 &quot;getDataTestDB.ini&quot; &quot;Field 5&quot; &quot;HWND&quot;<br />
   ReadIniStr $7 &quot;getDataTestDB.ini&quot; &quot;Field 7&quot; &quot;HWND&quot;<br />
   ReadIniStr $9 &quot;getDataTestDB.ini&quot; &quot;Field 9&quot; &quot;HWND&quot;<br />
<br />
   ReadIniStr $1 &quot;getDataTestDB.ini&quot; &quot;Field 10&quot; &quot;state&quot;<br />
   StrCmp $1 1 enable disable<br />
<br />
   disable:<br />
   EnableWindow $3 0<br />
   EnableWindow $5 0<br />
   EnableWindow $7 0<br />
   EnableWindow $9 0<br />
   <br />
   WriteIniStr &quot;getDataTestDB.ini&quot; &quot;Field 3&quot; &quot;Flags&quot; &quot;DISABLED&quot;<br />
   WriteIniStr &quot;getDataTestDB.ini&quot; &quot;Field 5&quot; &quot;Flags&quot; &quot;DISABLED&quot;<br />
   WriteIniStr &quot;getDataTestDB.ini&quot; &quot;Field 7&quot; &quot;Flags&quot; &quot;DISABLED&quot;<br />
   WriteIniStr &quot;getDataTestDB.ini&quot; &quot;Field 9&quot; &quot;Flags&quot; &quot;DISABLED&quot;<br />
   pop $0<br />
   pop $1<br />
   pop $3<br />
   pop $5<br />
   pop $7<br />
   pop $9<br />
   abort<br />
<br />
   enable:<br />
   EnableWindow $3 1<br />
   EnableWindow $5 1<br />
   EnableWindow $7 1<br />
   EnableWindow $9 1<br />
   <br />
   WriteIniStr &quot;getDataTestDB.ini&quot; &quot;Field 3&quot; &quot;Flags&quot; &quot;&quot;<br />
   WriteIniStr &quot;getDataTestDB.ini&quot; &quot;Field 5&quot; &quot;Flags&quot; &quot;&quot;<br />
   WriteIniStr &quot;getDataTestDB.ini&quot; &quot;Field 7&quot; &quot;Flags&quot; &quot;&quot;<br />
   WriteIniStr &quot;getDataTestDB.ini&quot; &quot;Field 9&quot; &quot;Flags&quot; &quot;&quot;<br />
   pop $0<br />
   pop $1<br />
   pop $3<br />
   pop $5<br />
   pop $7<br />
   pop $9<br />
   <br />
   abort <br />
<br />
/* Here begins my Problem */ <br />
<br />
<br />
 <br />
    Readinistr '$TestDB_Hostname_state' 'getDataTestDB.ini' 'Field 3' 'State'<br />
    ${If} $TestDB_Hostname_state == ''<br />
      MessageBox MB_OK &quot;Hostname nicht gesetzt&quot;<br />
      abort<br />
    ${Endif}<br />
<br />
    Readinistr '$TestDB_TNSname_state' 'getDataTestDB.ini' 'Field 5' 'State'<br />
    ${If} $TestDB_TNSname_state == ''<br />
      MessageBox MB_OK &quot;TNS Name nicht gesetzt&quot;<br />
      abort<br />
    ${Endif}<br />
<br />
    Readinistr '$TestDB_DBSID_state' 'getDataTestDB.ini' 'Field 7' 'State'<br />
    ${If} $TestDB_DBSID_state == ''<br />
      MessageBox MB_OK &quot;DB SID nicht gesetzt&quot;<br />
      abort<br />
    ${Endif}<br />
<br />
    Readinistr '$TestDB_Listenerport_state' 'getDataTestDB.ini' 'Field 9' 'State'<br />
    ${If} $TestDB_Listenerport_state == ''<br />
      MessageBox MB_OK &quot;Listenerport nicht gesetzt&quot;<br />
      abort<br />
    ${Endif}<br />
<br />
    TestDB_nocheck:<br />
<br />
FunctionEnd<br />
<br />
<br />
The first part should enable the 4 text-fields and this works fine. <br />
The second part of the funtion should only work, if the user click on next-button.<br />
if the checkbox not enabled, the second part musst not used.<br />
<br />
actually, if i enable the checkbox, the code test directly, before i can fill in the fields.<br />
<br />
Can anyone help me?<br />
<br />
I will check if the fields are filled.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">20th May 2008, 15:44</div></div><div class="posttext">Field 10 is supposed to have the notify flag right?<br />
    Function getDataTestDBLeave<br />
<br />
      readinistr $0 'getDataTestDB.ini' 'Settings' 'State'<br />
      StrCmp $0 0 TestDB_nocheck<br />
<br />
       ReadIniStr $3 &quot;getDataTestDB.ini&quot; &quot;Field 3&quot; &quot;HWND&quot;<br />
       ReadIniStr $5 &quot;getDataTestDB.ini&quot; &quot;Field 5&quot; &quot;HWND&quot;<br />
       ReadIniStr $7 &quot;getDataTestDB.ini&quot; &quot;Field 7&quot; &quot;HWND&quot;<br />
       ReadIniStr $9 &quot;getDataTestDB.ini&quot; &quot;Field 9&quot; &quot;HWND&quot;<br />
<br />
       ReadIniStr $1 &quot;getDataTestDB.ini&quot; &quot;Field 10&quot; &quot;state&quot;<br />
<br />
       EnableWindow $3 $1<br />
       EnableWindow $5 $1<br />
       EnableWindow $7 $1<br />
       EnableWindow $9 $1<br />
       Abort<br />
<br />
        TestDB_nocheck:<br />
<br />
        Readinistr '$TestDB_Hostname_state' 'getDataTestDB.ini' 'Field 3' 'State'<br />
        ${If} $TestDB_Hostname_state == ''<br />
          MessageBox MB_OK &quot;Hostname nicht gesetzt&quot;<br />
          abort<br />
        ${Endif}<br />
<br />
        Readinistr '$TestDB_TNSname_state' 'getDataTestDB.ini' 'Field 5' 'State'<br />
        ${If} $TestDB_TNSname_state == ''<br />
          MessageBox MB_OK &quot;TNS Name nicht gesetzt&quot;<br />
          abort<br />
        ${Endif}<br />
<br />
        Readinistr '$TestDB_DBSID_state' 'getDataTestDB.ini' 'Field 7' 'State'<br />
        ${If} $TestDB_DBSID_state == ''<br />
          MessageBox MB_OK &quot;DB SID nicht gesetzt&quot;<br />
          abort<br />
        ${Endif}<br />
<br />
        Readinistr '$TestDB_Listenerport_state' 'getDataTestDB.ini' 'Field 9' 'State'<br />
        ${If} $TestDB_Listenerport_state == ''<br />
          MessageBox MB_OK &quot;Listenerport nicht gesetzt&quot;<br />
          abort<br />
        ${Endif}<br />
<br />
    FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ssam</div><div class="date">21st May 2008, 06:20</div></div><div class="posttext">oh sorry, yes field 10 is the checkbox and has the notify flag<br />
<br />
field 3,5,7,9 are the text-fields, which are enabled if the checkbox is are enabled.<br />
<br />
<br />
here the inifile:<br />
<br />
Function write_getDataTestDB.ini<br />
<br />
  <br />
<br />
  WriteIniStr 'getDataTestDB.ini' 'Settings' 'NumFields' '10'<br />
  WriteIniStr 'getDataTestDB.ini' 'state' 'State' '0'<br />
  <br />
  WriteIniStr 'getDataTestDB.ini'  'Field 1' 'Type' 'Label'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 1' 'Text' 'Bitte geben Sie die Daten ihrer Test-Datenbank ein.\r\nAlle Felder mÃ¼ssen ausgefÃ¼llt werden!'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 1' 'Left' '0'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 1' 'Right' '250'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 1' 'Top' '0'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 1' 'Bottom' '20'<br />
  <br />
  WriteIniStr 'getDataTestDB.ini'  'Field 10' 'Type' 'Checkbox'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 10' 'Text' 'TestDatenbank aktivieren'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 10' 'Left' '0'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 10' 'Right' '100'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 10' 'Top' '30'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 10' 'Bottom' '40'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 10' 'State' '0'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 10' 'Flags' 'NOTIFY'<br />
<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 2' 'Type' 'Label'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 2' 'Text' 'Hostname:'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 2' 'Left' '0'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 2' 'Right' '80'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 2' 'Top' '50'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 2' 'Bottom' '60'<br />
<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 3' 'Type' 'Text'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 3' 'Left' '100'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 3' 'Right' '220'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 3' 'Top' '50'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 3' 'Bottom' '62'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 3' 'Flags' 'Disabled|notify'<br />
<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 4' 'Type' 'Label'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 4' 'Text' 'TNS-Name Datenbank:'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 4' 'Left' '0'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 4' 'Right' '80'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 4' 'Top' '70'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 4' 'Bottom' '80'<br />
<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 5' 'Type' 'Text'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 5' 'Left' '100'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 5' 'Right' '220'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 5' 'Top' '70'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 5' 'Bottom' '82'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 5' 'Flags' 'Disabled'<br />
<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 6' 'Type' 'Label'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 6' 'Text' 'Datenbank SID:'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 6' 'Left' '0'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 6' 'Right' '80'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 6' 'Top' '90'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 6' 'Bottom' '100'<br />
<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 7' 'Type' 'Text'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 7' 'Left' '100'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 7' 'Right' '220'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 7' 'Top' '90'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 7' 'Bottom' '102'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 7' 'Flags' 'Disabled'<br />
<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 8' 'Type' 'Label'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 8' 'Text' 'Listenerport:'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 8' 'Left' '0'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 8' 'Right' '80'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 8' 'Top' '110'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 8' 'Bottom' '120'<br />
<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 9' 'Type' 'Text'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 9' 'Left' '100'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 9' 'Right' '130'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 9' 'Top' '110'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 9' 'Bottom' '122'<br />
  WriteIniStr 'getDataTestDB.ini'  'Field 9' 'Flags' 'Disabled|only_numbers'<br />
<br />
FunctionEnd<br />
<br />
<br />
edit:<br />
it works .... IT WORKS ..........IT WORKS <br />
<br />
Thx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">21st May 2008, 06:23</div></div><div class="posttext">Try the code I've posted above, it should be work as expected.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ssam</div><div class="date">21st May 2008, 06:29</div></div><div class="posttext">Yes i see it, but i dont understand why this works. can you explain it me?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">21st May 2008, 07:52</div></div><div class="posttext">Well, I think would be better explanation to examine the included InstallOptions examples especially the one named test-notify.nsi :)<br />
<br />
Also you could have the same functionality writing less code with nsDialogs.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ssam</div><div class="date">21st May 2008, 08:13</div></div><div class="posttext">ok i will do this, but i dont know why my code, with the same functionality not works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">21st May 2008, 08:51</div></div><div class="posttext">Your code fails mainly because you're adding the label TestDB_nocheck: in the wrong place.<br />
btw why not use logiclib? it's easier.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ssam</div><div class="date">21st May 2008, 09:26</div></div><div class="posttext">yes , that is one, what i not understand. TestDB_nocheck: is the labal, where nothing maust be done, and the function ends.<br />
<br />
i fought, that if checkbox not &quot;checked&quot;, he jumps to TestDB_nocheck: ond function end. now is TestDB_nocheck: before my readed text-fields and he ignores these fields, if checkbox not &quot;checked&quot;. Dont understand me false, the code works and makes what i want, but i dont understand why he ignores them.<br />
<br />
in my understand ( java, c, c++, php, ... etc.) ,  a function is read and done, line by line.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">21st May 2008, 09:36</div></div><div class="posttext">Either checked or unchecked the control sets the notify and here is the point where your code fails.<br />
<br />
In the example I've posted above, I know the notify is set either by the checkbox or by the next button, so what I do is to check if the next button is pressed, and if it is pressed I jump to the label TestDB_nocheck:, otherwise I know it is the checkbox who triggered the notify and I set the state of the text fields regarding to the state of the check box.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ssam</div><div class="date">21st May 2008, 11:22</div></div><div class="posttext">ah ok i think i understand.<br />
<br />
now i have the following Problem. test the script, the code works perfektly, but start te installer exe, he checks the textfields too, when the checkbox is not set.<br />
<br />
but he shold only check the fields, if they are filled.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">21st May 2008, 12:23</div></div><div class="posttext">Might be beacuse text has added to the fileds so even if the field is disabled the text exists so the condition is true.<br />
<br />
Try this:<br />
!include WinMessages.nsh<br />
Function getDataTestDBLeave<br />
<br />
      readinistr $0 'getDataTestDB.ini' 'Settings' 'State'<br />
      StrCmp $0 0 TestDB_nocheck<br />
<br />
       ReadIniStr $3 &quot;getDataTestDB.ini&quot; &quot;Field 3&quot; &quot;HWND&quot;<br />
       ReadIniStr $5 &quot;getDataTestDB.ini&quot; &quot;Field 5&quot; &quot;HWND&quot;<br />
       ReadIniStr $7 &quot;getDataTestDB.ini&quot; &quot;Field 7&quot; &quot;HWND&quot;<br />
       ReadIniStr $9 &quot;getDataTestDB.ini&quot; &quot;Field 9&quot; &quot;HWND&quot;<br />
<br />
       ReadIniStr $1 &quot;getDataTestDB.ini&quot; &quot;Field 10&quot; &quot;state&quot;<br />
       <br />
       ${If} $1 = 0<br />
       SendMessage $3 ${WM_SETTEXT} 0 &quot;STR:&quot;<br />
       SendMessage $5 ${WM_SETTEXT} 0 &quot;STR:&quot;<br />
       SendMessage $7 ${WM_SETTEXT} 0 &quot;STR:&quot;<br />
       SendMessage $9 ${WM_SETTEXT} 0 &quot;STR:&quot;<br />
       ${EndIf}<br />
<br />
       EnableWindow $3 $1<br />
       EnableWindow $5 $1<br />
       EnableWindow $7 $1<br />
       EnableWindow $9 $1<br />
       Abort<br />
<br />
        TestDB_nocheck:<br />
<br />
        Readinistr '$TestDB_Hostname_state' 'getDataTestDB.ini' 'Field 3' 'State'<br />
        ${If} $TestDB_Hostname_state == ''<br />
          MessageBox MB_OK &quot;Hostname nicht gesetzt&quot;<br />
          abort<br />
        ${Endif}<br />
<br />
        Readinistr '$TestDB_TNSname_state' 'getDataTestDB.ini' 'Field 5' 'State'<br />
        ${If} $TestDB_TNSname_state == ''<br />
          MessageBox MB_OK &quot;TNS Name nicht gesetzt&quot;<br />
          abort<br />
        ${Endif}<br />
<br />
        Readinistr '$TestDB_DBSID_state' 'getDataTestDB.ini' 'Field 7' 'State'<br />
        ${If} $TestDB_DBSID_state == ''<br />
          MessageBox MB_OK &quot;DB SID nicht gesetzt&quot;<br />
          abort<br />
        ${Endif}<br />
<br />
        Readinistr '$TestDB_Listenerport_state' 'getDataTestDB.ini' 'Field 9' 'State'<br />
        ${If} $TestDB_Listenerport_state == ''<br />
          MessageBox MB_OK &quot;Listenerport nicht gesetzt&quot;<br />
          abort<br />
        ${Endif}<br />
<br />
    FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ssam</div><div class="date">21st May 2008, 12:41</div></div><div class="posttext">yes that was my idea too, but hoped there were a another idea.<br />
<br />
Ok thx for help Red Wine.<br />
<br />
Hope that the Tread helps other usere too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">21st May 2008, 13:02</div></div><div class="posttext">I bet that several users will provide several methods, this is the way nsis works ;)<br />
btw nsDialogs would save your effort for this project.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TobbeSweden</div><div class="date">10th June 2008, 17:18</div></div><div class="posttext">Originally posted by Red Wine <br />
btw why not use logiclib? it's easier. <br />
It would be even better if it was part of NSIS itself so we could get rid of the ugly ${} around the keywords...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sheik</div><div class="date">10th June 2008, 20:53</div></div><div class="posttext">Originally posted by TobbeSweden <br />
It would be even better if it was part of NSIS itself so we could get rid of the ugly ${} around the keywords...  <br />
<br />
I absolutely agree here.<br />
LogicLib should just become a basic part of the NSIS language.<br />
<br />
It sure makes things a lot easier for us average joes. =)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>