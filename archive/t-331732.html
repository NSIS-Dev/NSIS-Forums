<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" finishpage cancel button not funtioning, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  finishpage cancel button not funtioning NSIS Discussion" />
	
	<title> finishpage cancel button not funtioning [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  finishpage cancel button not funtioning</div>
<hr />
<div class="pda"><a href="t-331732.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=331732">finishpage cancel button not funtioning</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">tubecharger</div><div class="date">20th June 2011, 23:32</div></div><div class="posttext">Using mui2, and <br />
!define MUI_FINISHPAGE_RUN $UserDir\myProg.exe<br />
!define MUI_FINISHPAGE_CANCEL_ENABLED<br />
<br />
My finish page is displayed correctly with the Cancel button enabled, but when I click on it nothing happens. Do I need to implement code behind the Cancel button or should it just automatically cancel/exit without running the defined executable?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">21st June 2011, 06:37</div></div><div class="posttext">The &quot;Run myprog&quot; option on the finish page is a checkbox. If you leave it unchecked and click Finish, the installer will exit. If you check it and click Finish, the installer will exit and myprog will be started. What more functionality do you need?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tubecharger</div><div class="date">21st June 2011, 13:56</div></div><div class="posttext">Trying to streamline so that only one click is needed if the optional run is not desired. The question however, is why the Cancel doesn't do anything when it is enabled.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">21st June 2011, 14:50</div></div><div class="posttext">You can't cancel the install, you already completed the install, there is nothing to cancel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">21st June 2011, 15:40</div></div><div class="posttext">Trying to streamline so that only one click is needed if the optional run is not desired.<br />
!define MUI_FINISHPAGE_RUN_NOTCHECKED<br />
<br />
<br />
It's all in the manual. Or, in this case, in the MUI2 readme: http://nsis.sourceforge.net/Docs/Modern%20UI%202/Readme.html</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tubecharger</div><div class="date">21st June 2011, 18:22</div></div><div class="posttext">Directly from the manual:<br />
MUI_FINISHPAGE_CANCEL_ENABLED<br />
Enable the Cancel button so the user can skip any options displayed on the finish page.<br />
<br />
This is exactly what I want to do and what I currently have implemented in my code. But when I click on the Cancel button which is not grayed out, nothing happens. Is this the correct behavior? Comparing the behavior to the explanation from the manual, it does not appear to be correct. Is there something else that I need to do to get the cancel button to &quot;skip any options displayed on the finish page&quot; and exit. I don't need it to roll back. I just want to exit without running the myProg.exe.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">21st June 2011, 19:59</div></div><div class="posttext">Directly from the manual:<br />
MUI_FINISHPAGE_CANCEL_ENABLED<br />
Enable the Cancel button so the user can skip any options displayed on the finish page.<br />
<br />
This is exactly what I want to do and what I currently have implemented in my code. But when I click on the Cancel button which is not grayed out, nothing happens. Is this the correct behavior? Comparing the behavior to the explanation from the manual, it does not appear to be correct. Is there something else that I need to do to get the cancel button to &quot;skip any options displayed on the finish page&quot; and exit. I don't need it to roll back. I just want to exit without running the myProg.exe.<br />
<br />
It works fine in MUI1, probably a bug in MUI2 or nsDialogs.<br />
<br />
Try this workaround:<br />
<br />
!include MUI2.nsh<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_INSTFILES<br />
#Do NOT use MUI_FINISHPAGE_CANCEL_ENABLED<br />
!define MUI_FINISHPAGE_RUN &quot;$windir\explorer.exe&quot;<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW NSIS2d46_MUI2_CancelEnabledFix<br />
!insertmacro MUI_PAGE_FINISH<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
!ifndef SC_CLOSE<br />
!define SC_CLOSE 0xF060<br />
!endif<br />
Function NSIS2d46_MUI2_CancelEnabledFix<br />
EnableWindow $mui.Button.Cancel 1<br />
System::Call 'USER32::GetSystemMenu(i $hwndparent,i0)i.s'<br />
System::Call 'USER32::EnableMenuItem(is,i${SC_CLOSE},i0)'<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tubecharger</div><div class="date">21st June 2011, 20:25</div></div><div class="posttext">Thanks very much Anders. That worked!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>