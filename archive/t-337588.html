<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Legacy Drivers &amp; Win7 x64, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Legacy Drivers &amp; Win7 x64 NSIS Discussion" />
	
	<title> Legacy Drivers &amp; Win7 x64 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Legacy Drivers &amp; Win7 x64</div>
<hr />
<div class="pda"><a href="t-337588.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=337588">Legacy Drivers &amp; Win7 x64</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">PoRtAbLe_StEaLtH</div><div class="date">15th November 2011, 16:43</div></div><div class="posttext">Hey guys.. first time posting here.. but i have been browsing these forums for quite some time.<br />
<br />
I am a huge fan/user of NSIS.<br />
While many have converted to PAF, i faithfully am sticking by.<br />
<br />
I have successfully compiled many Portable Launchers for my apps.<br />
and have run into many problems, but always found an answer by trial &amp; error/research.<br />
<br />
Until now: i have been frustrated for many weeks now.<br />
<br />
Problem: i can't seem to delete legacy registry keys.<br />
My OS: Win7/64<br />
<br />
I have tried Access::Control plugin without success.<br />
<br />
The problem is the key can only be deleted under 'System'.<br />
<br />
Anyone have any ideas?<br />
Thanks in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">15th November 2011, 17:18</div></div><div class="posttext">NSIS has no support for running things as System, if you want to do that you need to call a utility like psexec or use a service.<br />
<br />
Did you take ownership of the key with AccessControl::SetRegKeyOwner before changing the ACL as admin?<br />
<br />
Did you check with Process Monitor to make sure this is a access denied issue?<br />
<br />
Are you using SetRegView?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PoRtAbLe_StEaLtH</div><div class="date">15th November 2011, 19:25</div></div><div class="posttext">NSIS has no support for running things as System, if you want to do that you need to call a utility like psexec or use a service.<br />
<br />
very nice.. PsExec.exe did it :)<br />
thank you so very much for the prompt response.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PoRtAbLe_StEaLtH</div><div class="date">9th June 2012, 12:11</div></div><div class="posttext">NSIS has no support for running things as System, if you want to do that you need to call a utility like psexec or use a service.<br />
<br />
Did you take ownership of the key with AccessControl::SetRegKeyOwner before changing the ACL as admin?<br />
<br />
Did you check with Process Monitor to make sure this is a access denied issue?<br />
<br />
Are you using SetRegView?<br />
<br />
<br />
hey Anders,<br />
thanks for mentioning PsExec..<br />
that's what im using to delete legacy keys ..<br />
<br />
however.. i have seen apps use AccessControl to delete legacy keys, but when i run those apps on my computer.. it doesn't work.<br />
<br />
i have also ran into SetACL, which in it's documentation, says: &quot;can be used to delete those pesky legacy keys&quot;.<br />
<br />
neither of which works.. <br />
<br />
and yes.. i tried setregview, SetRegKeyOwner first, etc..<br />
<br />
on my computer.. legacy keys are registered to &quot;System&quot;.<br />
is this the case just for Windows 7?<br />
<br />
i have been looking into this for quite a while and it seems im the only one who seems to have a problem deleting legacy keys.<br />
<br />
i can use PsExec.. but if i could find an alternative.. it would be better.. as PsExec scares people.. they think im trying to &quot;secretly take over&quot; their computers.. lol.<br />
<br />
thanks for any other suggestions/tips.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">23rd June 2012, 19:07</div></div><div class="posttext">PsExec scares people.. they think im trying to &quot;secretly take over&quot; their computers.. lol.<br />
well, offtopic - there is nothing to lol with your actions - at least you change important settings and this destroy windows. thats worth to kickass.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th June 2012, 22:19</div></div><div class="posttext">You will have to write a Windows service in C then. This can be created, executed and then deleted using a services plug-in such as SimpleSC.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PoRtAbLe_StEaLtH</div><div class="date">6th December 2012, 10:53</div></div><div class="posttext">You will have to write a Windows service in C then. This can be created, executed and then deleted using a services plug-in such as SimpleSC.<br />
<br />
Stu<br />
<br />
this post is rather old, and i completely forgot about this.<br />
<br />
i was able to figure it out using Access::Control.<br />
my syntax was incorrect.<br />
<br />
although.. i wish there was a /r (recursive) switch.<br />
it would save a lot of coding.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>