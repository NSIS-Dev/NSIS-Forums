<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" uninstall using rundll32 advpack.dll does not work, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  uninstall using rundll32 advpack.dll does not work NSIS Discussion" />
	
	<title> uninstall using rundll32 advpack.dll does not work [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  uninstall using rundll32 advpack.dll does not work</div>
<hr />
<div class="pda"><a href="t-195716.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=195716">uninstall using rundll32 advpack.dll does not work</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">vhl_idioteque</div><div class="date">6th October 2004, 01:26</div></div><div class="posttext">made an installer , and uninstaller:<br />
<br />
I want to run the following commands:<br />
<br />
rundll32 advpack.dll,LaunchINFSection %windir%\inf\mpeg4ax.inf,Uninstall<br />
rundll32 advpack.dll,LaunchINFSection %windir%\inf\mpg4sax.inf,Uninstall<br />
rundll32 advpack.dll,LaunchINFSection %windir%\inf\msaud.inf,Uninstall<br />
rundll32 advpack.dll,LaunchINFSection %windir%\inf\wmavdsax.inf,Uninstall<br />
rundll32 advpack.dll,LaunchINFSection %windir%\inf\WMFSDK.inf,Uninstall<br />
rundll32 advpack.dll,LaunchINFSection %windir%\inf\wmv8ax.inf,Uninstall<br />
rundll32 advpack.dll,LaunchINFSection %windir%\inf\wmvax.inf,Uninstall<br />
<br />
rundll32 advpack.dll,LaunchINFSection %windir%\inf\wmv9vcm.inf,Uninstall<br />
<br />
This works in the batch file i created but how do I integrate this in the NSIS script does not work:<br />
<br />
//Batch file uninstall_wmv.bat<br />
rundll32 advpack.dll,LaunchINFSection %windir%\inf\mpeg4ax.inf,Uninstall<br />
rundll32 advpack.dll,LaunchINFSection %windir%\inf\mpg4sax.inf,Uninstall<br />
rundll32 advpack.dll,LaunchINFSection %windir%\inf\msaud.inf,Uninstall<br />
rundll32 advpack.dll,LaunchINFSection %windir%\inf\wmavdsax.inf,Uninstall<br />
rundll32 advpack.dll,LaunchINFSection %windir%\inf\WMFSDK.inf,Uninstall<br />
rundll32 advpack.dll,LaunchINFSection %windir%\inf\wmv8ax.inf,Uninstall<br />
rundll32 advpack.dll,LaunchINFSection %windir%\inf\wmvax.inf,Uninstall<br />
<br />
rundll32 advpack.dll,LaunchINFSection %windir%\inf\wmv9vcm.inf,Uninstall<br />
////<br />
<br />
<br />
<br />
;Run the uninstaller<br />
uninst:<br />
<br />
ClearErrors<br />
<br />
Exec 	&quot;$INSTDIR\uninstall_wmv.bat&quot;<br />
<br />
ExecShell  open &quot;rundll32 advpack.dll,LaunchINFSection %windir%\inf\mpeg4ax.inf,Uninstall&quot;<br />
ExecShell  open &quot;rundll32 advpack.dll,LaunchINFSection %windir%\inf\mpg4sax.inf,Uninstall&quot;<br />
ExecShell  open &quot;rundll32 advpack.dll,LaunchINFSection %windir%\inf\msaud.inf,Uninstall&quot;<br />
ExecShell  open &quot;rundll32 advpack.dll,LaunchINFSection %windir%\inf\wmavdsax.inf,Uninstall&quot;<br />
ExecShell  open &quot;rundll32 advpack.dll,LaunchINFSection %windir%\inf\WMFSDK.inf,Uninstall&quot;<br />
ExecShell  open &quot;rundll32 advpack.dll,LaunchINFSection %windir%\inf\wmv8ax.inf,Uninstall&quot;<br />
ExecShell  open &quot;rundll32 advpack.dll,LaunchINFSection %windir%\inf\wmvax.inf,Uninstall&quot;<br />
<br />
ExecShell  open &quot;rundll32 advpack.dll,LaunchINFSection %windir%\inf\wmv9vcm.inf,Uninstall&quot;<br />
<br />
  ExecWait '$R0 _?=$INSTDIR' ;Do not copy the uninstaller to a temp file<br />
    IfErrors no_remove_uninstaller<br />
    ;You can either use Delete /REBOOTOK in the uninstaller or add some code<br />
    ;here to remove to remove the uninstaller. Use a registry key to check<br />
    ;whether the user has chosen to uninstall. If you are using an uninstaller<br />
    ;components page, make sure all sections are uninstalled.<br />
   no_remove_uninstaller:<br />
<br />
done:<br />
<br />
<br />
ANy Idea's ??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bluenet</div><div class="date">6th October 2004, 04:18</div></div><div class="posttext">Use ExecWait instead of ExecShell, $WINDIR instead of %windir%</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th October 2004, 14:44</div></div><div class="posttext">You can also call LaunchINFSection with the System.dll plug-in. There is no need to use rundll32.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>