<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to update system DLLs?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to update system DLLs? NSIS Discussion" />
	
	<title> How to update system DLLs? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to update system DLLs?</div>
<hr />
<div class="pda"><a href="t-87966.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=87966">How to update system DLLs?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ivank</div><div class="date">17th May 2002, 04:56</div></div><div class="posttext">What is the right way to update system DLLs that are constantly in use, such as mfc42.dll? <br />
<br />
Note that I need to update the DLL only if the version of the DLL in my install is newer than the version currently present on the target computer. Comparison by creation date instead of version will probably do too.<br />
<br />
SetOverwrite has &quot;ifnewer&quot; mode, but does not have &quot;rebootOK&quot; flag.<br />
&quot;Rename&quot; has &quot;rebootOK&quot; flag, but lacks &quot;ifnewer&quot; mode.<br />
<br />
Generally it would be nice to have some kind of &quot;smartReplace&quot; option for overwrite that would do this:<br />
<br />
1. Check if taret file already exists.<br />
2. If it does, check creation dates. If target is younger than the source, don't replace.<br />
3. If target is in use, copy source to temporary directory and do rename /rebootOK. Otherwise just replace the target with the source.<br />
<br />
I guess this can be done manually for each DLL, but it requires a bunch of commands. And it is even more difficult to put it into a function that takes file name as a parameter and does the rest automatically.<br />
<br />
Maybe somebody already wrote such a function? ;) <br />
Please advise.<br />
<br />
With best regards<br />
Ivan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th May 2002, 09:55</div></div><div class="posttext">In your functions.html file there is a function that does excatly that, and in the forums there a lot of improvements for it. Search for it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ivank</div><div class="date">17th May 2002, 15:20</div></div><div class="posttext">What function do you have in mind?<br />
<br />
I looked in Functions.html and did not find anything like this.<br />
UpgradeDLL macro comes close, but this is not it. It deals with a COM server DLL, and it won't update it if DLL cannot be overwritten.<br />
<br />
Although, that macro gave me some ideas.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th May 2002, 15:30</div></div><div class="posttext">UpgradeDLL on the forums does excatly what you have requested. It checks the version, reaplces if needed, and if needed replaces after reboot.<br />
<br />
And functions.html does contain the UpgradeDLL macro.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glenncarr</div><div class="date">11th June 2002, 22:11</div></div><div class="posttext">UpgradeDLL on the forums does excatly what you have requested. It checks the version, reaplces if needed, and if needed replaces after reboot<br />
<br />
:weird: What exactly in the macro causes the replacement at reboot?  I would have expected something to modify the &quot;Runonce&quot; registry key.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th June 2002, 14:01</div></div><div class="posttext">Hmm.... Nothing :)<br />
<br />
The modified macro on the forums does that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glenncarr</div><div class="date">12th June 2002, 14:41</div></div><div class="posttext">OK, so I'm new to these forums and I apologize for not knowing this... but, is there a central repository in the forums for these updated macros?  I.e., where is the latest, most up-to-date version of UpgradeDLL ?<br />
<br />
:o</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th June 2002, 14:52</div></div><div class="posttext">Just sort the search results by date.<br />
Some people did try to make such centeral repositories but non lasted (as far as I know of...).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glenncarr</div><div class="date">12th June 2002, 15:16</div></div><div class="posttext">One more question... why won't searching for &quot;UpgradeDLL&quot; return any results?  :igor:   <br />
<br />
Am I doing something stupid?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">12th June 2002, 17:33</div></div><div class="posttext">Try searching for Upgrade and find o.o.<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=76578&amp;highlight=upgrade<br />
<br />
-Hendri.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>