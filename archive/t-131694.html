<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" IsAdminDll question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  IsAdminDll question NSIS Discussion" />
	
	<title> IsAdminDll question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  IsAdminDll question</div>
<hr />
<div class="pda"><a href="t-131694.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=131694">IsAdminDll question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">SprinklerHead</div><div class="date">14th April 2003, 15:00</div></div><div class="posttext">I just tried using IsAdminDll with my installer. Works great on my Win2000 box, but on a Win98 box it returns 0 (not admin) every time. I guess this is correct, but in my mind it seems like it should return 1 for Win95-based machines since users have complete control. I was expecting it to return 0 only for NT-based machines with few priveleges.<br />
<br />
But just to be sure, do I have this straight:<br />
<br />
- Perform a check to see if the machine is 95 or NT based. <br />
<br />
- If it is 95 based, skip the IsAdminDll check and proceed with the install.<br />
<br />
- If it is NT based, perform the IsAdminDll check. If 1 (admin) proceed, if 0 (not admin) abort.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th April 2003, 15:13</div></div><div class="posttext">Instead of the IsAdminDll, you can use UserInfo.dll which is included in the latest NSIS versions.<br />
<br />
UserInfo fails and sets the error flag when there is no NT operating system. I think IsAdminDll has the same behavior, so you can use IfErrors.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SprinklerHead</div><div class="date">14th April 2003, 15:25</div></div><div class="posttext">I'd rather not upgrade NSIS at the moment unless I have to. Can the UserInfo.dll be used with v2.0b0?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th April 2003, 15:31</div></div><div class="posttext">It will probably work, but I highly recommend you to upgrade to the latest version. You only have to change some very small things in your script if you are using the Modern UI, otherwise you don't even have to change anything.<br />
<br />
Lots of bugs have been solved in later versions, using an outdated beta version is not a good idea.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SprinklerHead</div><div class="date">15th April 2003, 13:32</div></div><div class="posttext">OK, I upgraded and hit a few snags (still using nextpage &amp; previouspage functions) but I think I have everything straight except for one thing. The v2.0b0 makensis.exe had the command line parameter /cd. It doesn't anymore I assume because it won't compile with /cd. Any clue as to what /cd did, because I can't remember and I am using it in my old batch file to create my installer. I took it out and it seems to work OK, but that has me a bit worried.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th April 2003, 13:43</div></div><div class="posttext">/CD made makensis change the working directory to the directory of the script. It is now the default and the switch has been replaced with /NOCD that will disable this behavior. You can safely remove the switch from your batch file.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>