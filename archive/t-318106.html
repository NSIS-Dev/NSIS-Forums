<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait not waiting on 64 bit OS, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait not waiting on 64 bit OS NSIS Discussion" />
	
	<title> ExecWait not waiting on 64 bit OS [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait not waiting on 64 bit OS</div>
<hr />
<div class="pda"><a href="t-318106.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318106">ExecWait not waiting on 64 bit OS</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kporter20</div><div class="date">1st April 2010, 16:37</div></div><div class="posttext">I have an installer which detects whether IIS is installed (done via the registry) and will install it if required. If running Server 2008, I am using pkgmgr to install the relevant components. <br />
<br />
A sub-section of my script is as follows:<br />
<br />
Section &quot;IIS&quot; IIS<br />
<br />
  ; detect if IIS is installed<br />
  Call IsIISInstalled<br />
<br />
  ${If} $0 == &quot;&quot;<br />
    ; install IIS<br />
    MessageBox MB_OK &quot;IIS has not been detected on this system and will now be installed.&quot;<br />
<br />
	; detect operating system<br />
	GetVersion::WindowsName<br />
	Pop $R0<br />
<br />
	${If} $R0 == &quot;Server 2008&quot;<br />
		ExecWait &quot;$WINDIR\system32\pkgmgr.exe /iu:IIS-WebServerRole&quot; $1<br />
                .. etc		<br />
<br />
		MessageBox MB_OK &quot;ExecWait returned $1&quot;<br />
<br />
		; now check to make sure that IIS was installed correctly before continuing<br />
		Call IsIISInstalled<br />
<br />
		${If} $0 == &quot;&quot;<br />
		  ; IIS install failed<br />
		  MessageBox MB_OK &quot;Could not install IIS. ${PRODUCT_NAME} requires IIS to function. Please install IIS manually and try again.&quot;<br />
		  Abort &quot;IIS installation failed, installation aborted&quot;<br />
		${EndIf}<br />
<br />
	${Else}<br />
	${EndIf}<br />
<br />
  ${Else}<br />
  ${EndIf}<br />
<br />
SectionEnd<br />
<br />
The call to pkgmgr using ExecWait executes and waits till the package is installed on Server 2008 32 bit but on Server 2008 64 bit, ExecWait does not appear to wait and nothing gets installed. <br />
<br />
On Server 2008 32 bit, ExecWait returned 0<br />
<br />
On Server 2008 64 bit, ExecWait returned &quot;&quot; (nothing)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">1st April 2010, 18:07</div></div><div class="posttext">Make sure that something is, in fact, being executed.<br />
<br />
Keep in mind for example that on 64bit versions of Windows, System32 is transparently redirected to SysWoW64 (&quot;Windows (32) on Windows 64&quot; - confusing name? yes.).<br />
<br />
If you need to ExecWait the 64bit version of pkgmgr, either refer to $WINDIR\SysNative\ (Vista+ and XP64 with some obscure by-request hotfix) or disable file system redirection (XP64).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kporter20</div><div class="date">1st April 2010, 22:37</div></div><div class="posttext">Thanks for the suggestions. I will try these out.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kporter20</div><div class="date">6th April 2010, 09:30</div></div><div class="posttext">Disabling file system redirection for that section worked. Thanks. :up:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">6th April 2010, 11:00</div></div><div class="posttext">coo - glad that was it :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>