<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Sections and subsections, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Sections and subsections NSIS Discussion" />
	
	<title> Sections and subsections [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Sections and subsections</div>
<hr />
<div class="pda"><a href="t-233606.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=233606">Sections and subsections</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Fretje</div><div class="date">20th December 2005, 13:01</div></div><div class="posttext">Hello, <br />
I want to achieve something simple, but I don't get it to work like I want to.<br />
I have 2 sections &quot;section1&quot; and &quot;section2&quot;. Section2 can not be installed without section1.<br />
So I thought I make them displayed in the components page like the attached picture.<br />
<br />
I have done this using the following code:<br />
<br />
SectionGroup /e &quot;Section1&quot; SEC1Group<br />
  Section &quot;-Section1&quot; SEC1<br />
    ...<br />
  SectionEnd<br />
  Section &quot;Section2&quot; SEC2<br />
    ...<br />
  SectionEnd<br />
SectionGroupEnd<br />
<br />
This way I thought the behaviour I described above will be automatically implemented, because I thought when a section of a particular sectiongroup is selected, the sectiongroup itself is also selected. But this seems not to be the fact.<br />
When the group is de-selected first, both checkboxes are de-selected, then afterwards the &quot;section2&quot; section can be checked, and the section1 checkbox gets grey (like a 3-state checkbox in the 3rd state). I want it to be checked plain (all the subgroups are checked, so the group should be checked).<br />
<br />
Then I thought I override the .OnSelChange as follows:<br />
<br />
Function .onSelChange<br />
  !insertmacro SectionFlagIsSet ${SEC2} ${SF_SELECTED} endOnSelChange selectSection1<br />
selectSection1:<br />
  !insertmacro SelectSection ${SEC1}<br />
endOnSelChange:<br />
FunctionEnd<br />
<br />
But this makes it unable to de-select group1.<br />
<br />
Am I missing something here? Or is there another way of doing this?<br />
<br />
Any help appreciated!<br />
<br />
Greetings,<br />
<br />
Fretje</div></div><hr />


<div class="post"><div class="posttop"><div class="username">guest1298</div><div class="date">20th December 2005, 21:33</div></div><div class="posttext">First off, change those names cause it's hard to follow when Group and Sub1 have the same name (Section1).<br />
<br />
When a Sub is selected, other Sub is not automatically selected even if it's hidden. You have to handle that yourself.<br />
When Group is selected, all Subs are selected. I think you don't want this, you'd only want Sub1 selected in this case.<br />
You also want them all selected when Sub2 is selected, and you want them all unselected when Sub2 is unselected. Correct? If so, what you're trying to achieve is not trivial. You need to keep states and write a more elaborate .onSelChange function. You'll call SectionGetFlags everytime, compare current state to previous one and take action and/or call SectionSetFlags accordingly. Lot of head ache... just for the sake of getting an indented view?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Fretje</div><div class="date">20th December 2005, 23:34</div></div><div class="posttext">The actual problem is *real simple* : there's one section dependent of another...<br />
So the dependent section has to de-select when the main section is de-selected.<br />
And the main section has to be selected when the dependend section is selected.<br />
How can I establish this behaviour in the components page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">guest1298</div><div class="date">21st December 2005, 08:37</div></div><div class="posttext">You have a flawed approach to the *real simple* problem then..<br />
<br />
The user cannot select/unselect a hidden section. You want a sub selected when the other sub is selected and vice versa.<br />
Then why don't you just merge the two into one? Whats the point of creating subs?<br />
<br />
But, since you insist on using your own jargon here (which do you mean by &quot;main section&quot;?), I might well have wasted my time again.<br />
Good luck.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Fretje</div><div class="date">21st December 2005, 09:53</div></div><div class="posttext">I'm terribly sorry wasting your time, but I think this *real simple* problem is actually so simple nobody understands. Or maybe it's just me not asking it right.<br />
<br />
Actually I already solved this problem using your previous comment, but let's just restate everything, because I think this should be something that's implemented in the basic nsis section-stuff.<br />
<br />
Just forget about the subsections and the hidden section.<br />
Let's simply say we just have 2 sections: &quot;SectionOne&quot; and &quot;SectionTwo&quot; which both are optional (the user can choose to NOT install them):<br />
<br />
<br />
Section &quot;SectionOne&quot; SEC1<br />
  ...<br />
SectionEnd<br />
<br />
Section &quot;SectionTwo&quot; SEC2<br />
  ...<br />
SectionEnd<br />
<br />
<br />
Now let's say that &quot;SectionTwo&quot; is dependent on &quot;SectionOne&quot; (&quot;SectionTwo&quot; can NOT be installed WITHOUT &quot;SectionOne&quot;).<br />
Or to put it in other words: &quot;SectionTwo&quot; REQUIRES &quot;SectionOne&quot;.<br />
<br />
So if &quot;SectionOne&quot; is de-selected, &quot;SectionTwo&quot; is automatically de-selected as well. And if &quot;SectionTwo&quot; is selected, &quot;SectionOne&quot; is automatically selected.<br />
<br />
I now solved this issue by declaring 2 variables which contain the previous selected-state of the concerning sections. Initializing these variables with &quot;1&quot; in .onInit. Then overriding .onSelChange like this:<br />
<br />
<br />
Function .onSelChange<br />
  ${If} $SEC2_SEL = 0<br />
  ${AndIf} ${SectionIsSelected} ${SEC2}<br />
  ${AndUnless} ${SectionIsSelected} ${SEC1}<br />
    !insertmacro SelectSection ${SEC1}<br />
  ${EndIf}<br />
  <br />
  ${If} $SEC1_SEL = 1<br />
  ${AndUnless} ${SectionIsSelected} ${SEC1}<br />
  ${AndIf} ${SectionIsSelected} ${SEC2}<br />
    !insertmacro UnSelectSection ${SEC2}<br />
  ${EndIf}<br />
  <br />
  ${If} ${SectionIsSelected} ${SEC1}<br />
    StrCpy $SEC1_SEL 1<br />
  ${Else}<br />
    StrCpy $SEC1_SEL 0<br />
  ${EndIf}<br />
  <br />
  ${If} ${SectionIsSelected} ${SEC2}<br />
    StrCpy $SEC2_SEL 1<br />
  ${Else}<br />
    StrCpy $SEC2_SEL 0<br />
  ${EndIf}<br />
FunctionEnd<br />
<br />
<br />
I find it strange that no-one has run into this before... I think it should be possible to achieve this behaviour by a simple command like e.g. <br />
<br />
SectionRequires ${SEC1} ${SEC2}<br />
<br />
Greetings,<br />
<br />
Fretje</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st December 2005, 09:58</div></div><div class="posttext">Perhaps you could ask for a feature request on the project page.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Fretje</div><div class="date">21st December 2005, 10:52</div></div><div class="posttext">done ;-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd December 2005, 12:21</div></div><div class="posttext">That was actually needed and implemented differently in an old version (http://cvs.sourceforge.net/viewcvs.py/nsis/NSIS/Examples/makensis.nsi?rev=1.204&amp;view=markup) of the NSIS package installer. Instead of clearing the selection of dependent sections, the required section was set to read-only and its name was suffixed with &quot;(required)&quot; when a dependent section was selected.<br />
<br />
I prefer to allow the developer the freedom to implement the logic as required. However, I do agree this can be easier. The .onSelChange callback can be more powerful. It can, for example, receive information about what exactly happened instead of guessing according to saved states.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>