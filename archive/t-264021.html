<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to hide Dos window? Help, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to hide Dos window? Help NSIS Discussion" />
	
	<title> How to hide Dos window? Help [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to hide Dos window? Help</div>
<hr />
<div class="pda"><a href="t-264021.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=264021">How to hide Dos window? Help</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">19th January 2007, 18:52</div></div><div class="posttext">Hi,<br />
<br />
I am a newbie of NSIS, when using NSIS, I encounter one problem about DOS black window.<br />
<br />
After I install all the files, I have to run a window service so that my program can call this window service correctly. I use one function in .nsi file something like as follows:<br />
<br />
Function StartService<br />
  Execwait &quot;net start myServiceName&quot;<br />
FunctionEnd<br />
<br />
However, it will show me a black Dos window, i really don't want the black window shows up! I tried to use .bat (Dos batch file)! Same thing!<br />
<br />
Anybody has good suggestions to help me finish my project!<br />
<br />
Thank you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th January 2007, 18:56</div></div><div class="posttext">Use nsExec (http://nsis.sourceforge.net/Docs/nsExec/nsExec.txt). The usage example (http://nsis.sourceforge.net/Examples/nsExec/test.nsi) can also help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">24th January 2007, 06:23</div></div><div class="posttext">nsexec is not perfect at all.<br />
<br />
i actually work on a specific script wich starts makensis.exe<br />
with nsexec - in most cases it work here, but on another computer<br />
in most cases it fails.<br />
<br />
app1 writes a script which is compiled to app2.<br />
the script is fine but it isnt compiled - app2 is missing<br />
or it contains no data to extract.<br />
<br />
so i start to examine nsexec and found execdos:<br />
http://nsis.sourceforge.net/ExecDos_plug-in<br />
<br />
execdos produces no errors - app2 is created.<br />
<br />
so i think nsexec has limitations with a dos box on a actual<br />
windows xp - it doesnt wait.<br />
<br />
you know makensis best...<br />
<br />
btw i miss parameters for makensisw - are there any?<br />
(need autoclose after execwait).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th January 2007, 09:26</div></div><div class="posttext">Care to elaborate, Brummelchen?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">24th January 2007, 15:55</div></div><div class="posttext">huh?<br />
<br />
in short again<br />
<br />
- app1 -&gt; script for app2<br />
- extract compiler (20 files only)<br />
- compile script app2<br />
- delete compiler<br />
<br />
i think nsexec doesnt get that makensis hasnt finished<br />
so parts of the compiler is deleted while makensis is<br />
still working - so failure occurs - no app2.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th January 2007, 15:57</div></div><div class="posttext">I need details. nsExec has always worked fine for me. How and where exactly does it fail?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">24th January 2007, 15:59</div></div><div class="posttext">see above pls - no app2 or no data in app2 (exe is fine)<br />
<br />
the original script has around 1500 lines now and the created script is fine - no syntax error.<br />
<br />
nsexec fails - execdos works</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th January 2007, 16:04</div></div><div class="posttext">Did you make sure nsExec is the problem? Try adding a message box after nsExec returns and see if makensis has actually finished by then.<br />
<br />
I need a way to reproduce this. The script would work best. A minimal version of it, if possible. All 1500 lines if not.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">24th January 2007, 16:17</div></div><div class="posttext">&gt;&gt; Did you make sure nsExec is the problem?<br />
<br />
pretty sure - with a messagebox i get no failure ;)<br />
(although the mbox only tells me, that i can grab the outputted <br />
script &amp; exe for review - on the users computer same)<br />
<br />
btw the essential part is half of the script - i am not <br />
ready for &quot;include&quot; which m8 make it easier for me.<br />
<br />
&gt;&gt; I need a way to reproduce this.<br />
<br />
and i need mail P</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th January 2007, 16:21</div></div><div class="posttext">kichik@users.sf.net</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">24th January 2007, 16:30</div></div><div class="posttext">on the way - you can delete the address now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th January 2007, 16:34</div></div><div class="posttext">That's OK, let Spam Assassin handle whoever/whatever uses that. It's all over the web anyway. And even if it wasn't, spambots randomize user names anyway.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">24th January 2007, 20:16</div></div><div class="posttext">nsExec:exec is working fine for me. Thank you for helping me out.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th January 2007, 22:01</div></div><div class="posttext">Brummelchen, I still can't reproduce it. I can barely compile it, because of missing files, and then I can't run it because the browse buttons don't work and I can't read the text.<br />
<br />
Can you add some more details on the other computer on which it doesn't work? Also, can you have nsExec run &quot;cmd /C makensis ...  &gt; some.log&quot; instead of what it has now and paste the log?<br />
<br />
One thing I did get from the script is the lack of Pop after nsExec. I don't see any important code after it, so the stack corruption shouldn't matter too much. But you should add it in case you'll add more code there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">24th January 2007, 22:11</div></div><div class="posttext">thats why i added the compiled win-version ;)<br />
<br />
plugins needed: md5, execdos, helpbutton (not really), IO, banner<br />
<br />
&gt;&gt; on the other computer on which it doesn't work?<br />
<br />
No, its far away. I only can get the script and the exe-file.<br />
script is fine, but exe only contains header or it doesnt exist.<br />
thats all i can barely say.<br />
ok, some more i dont mind cause it is like mine:<br />
windows xp sp2, nod32 (virusscanner) - meets mine ~70%<br />
i have no details about the dos-box (-default.pif)<br />
<br />
i only can say that a message box prevents the failure.<br />
after that is the compiler deleted - much time to execute it properly</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th January 2007, 22:25</div></div><div class="posttext">But the compiled version is using ExecDos and not nsExec. And the missing files I'm talking about are not the plug-ins, although it would have been nicer if they were in the archive. There are other missing files including images, executables and header files.<br />
<br />
I see now that the leave function is not the last code in the script after all. So the stack corruption can have an effect after all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">24th January 2007, 22:33</div></div><div class="posttext">&gt;&gt; But the compiled version is using ExecDos and not nsExec<br />
<br />
gna - right :/<br />
<br />
&gt;&gt; that the leave function is not the last code in the script after all.<br />
<br />
idd - after compiling it returns to the GUI or it quits.<br />
it only has that ONE page - no need to go back/forward.<br />
so that should be no problem - either the stack behaviour itself is buggy :D<br />
<br />
too bad we cant meet this time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th January 2007, 22:37</div></div><div class="posttext">There is a problem with the stack because you continue running code after nsExec returns. That code might be affected by the fact the stack doesn't contain what it expects.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">24th January 2007, 22:45</div></div><div class="posttext">hmm, then it is a stack problem - when i put something on the stack <br />
and take it back in the right sequence - there cant be any problem!?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th January 2007, 22:50</div></div><div class="posttext">There can be a problem if something puts another thing on the stack between the time you put the original value and between the time you expect to find that value. That's exactly what happens if you don't Pop nsExec's return value.<br />
<br />
But that's just a problem. I doesn't have to be the problem. To pinpoint the problem I need more details and/or a way to reproduce this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">24th January 2007, 22:55</div></div><div class="posttext">&quot;nsExec::Exec&quot; needs a pop?<br />
i only can read that for the 2 other functions...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th January 2007, 23:02</div></div><div class="posttext">They all need a Pop. They all return &quot;error&quot;, &quot;timeout&quot; or the exit code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">25th January 2007, 02:41</div></div><div class="posttext">Then update the documentation pls...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th January 2007, 09:05</div></div><div class="posttext">How would you make it clearer? The &quot;return value&quot; section doesn't mention anything about being ExecToStack and ExecToLog specific.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">25th January 2007, 15:19</div></div><div class="posttext">it doesnt help me in my case - but the example only contains <br />
the 2 other functions of nsexec and they need pop. <br />
&quot;nsExec::Exec&quot; is not discussed.<br />
and the doc is also poor about a return value.<br />
idd &quot;nsExec::ExecToStack&quot; hast 2 return values - so test.nsi <br />
indicates for me that the first function needs NO additional POP.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th January 2007, 15:24</div></div><div class="posttext">Fine, I updated test.nsi to include an example of nsExec::Exec as well. It Pops.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">25th January 2007, 15:26</div></div><div class="posttext">Thank you - this m8 fix my special problem - i'll give it a try.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>