<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MSDE Installation, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MSDE Installation NSIS Discussion" />
	
	<title> MSDE Installation [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MSDE Installation</div>
<hr />
<div class="pda"><a href="t-162991.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=162991">MSDE Installation</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">vrtata</div><div class="date">3rd January 2004, 06:01</div></div><div class="posttext">I want to use NSIS to install MSDE 2000. I require help in the following areas.<br />
<br />
1. Check if a particular version of MSDE is Installed.<br />
2. Upgrade if the MSDE version is older than 2000.<br />
3. Installation of MSDE through merge modules.<br />
<br />
I have done this through the windows installer but it bugs me. I need to achieve this through NSIS (I am in love with it).<br />
<br />
Appreciate any help.<br />
<br />
Ramesh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">3rd January 2004, 11:32</div></div><div class="posttext">http://support.microsoft.com/default.aspx?scid=kb;en-us;321185</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd January 2004, 12:10</div></div><div class="posttext">To install the merge modules you can create a small silent .msi which will include them and install it using:<br />
<br />
ExecWait '&quot;$SYSDIR\msiexec.exe&quot; /i &quot;C:\path\to\mymsi.msi&quot; /qn'<br />
<br />
On the downside, you'd still need MSI runtimes installed if MSM is the only thing you have access too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vrtata</div><div class="date">5th January 2004, 04:21</div></div><div class="posttext">But how do I find out during the process of Installation that MSDE is installed or not. My installation package needs to check for two things before it decides on the installation methodology.<br />
<br />
1. Check if .NET Framework is installed (a function is already available with NSIS to check this)<br />
2. To check if MSDE is installed or not. If NOT then the installation needs to invoke the MSDE Installation process also.<br />
<br />
Rgds</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">5th January 2004, 08:09</div></div><div class="posttext">See that Microsoft page for registry keys you have to check.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mbuckbee</div><div class="date">7th January 2004, 07:40</div></div><div class="posttext">I saw that there is a plug-in to check for services, etc. <br />
<br />
You could use that to look for the existence of the MSDE service.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Olomite</div><div class="date">13th January 2004, 03:38</div></div><div class="posttext">I'd like to run MSDE2000 setup.exe using ExecWait.  But when I kick off the msde installer my installer keeps going without waiting for msde to finish installing.<br />
<br />
How do I get my installer to wait for the msde2000 install to finish?<br />
<br />
Any help would be great!<br />
<br />
Thanks-<br />
Lance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th January 2004, 15:29</div></div><div class="posttext">It's probably a self-extracting archive that starts a different application. Maybe you can extract it using an archive application that supports CAB compression (which is the compression Microsoft uses for most installers).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Olomite</div><div class="date">13th January 2004, 17:35</div></div><div class="posttext">Can anyone expand on this?  -&gt; has anyone done this and gotten it to work?  if so what'd you use?  any other suggestions?<br />
<br />
thanks-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th January 2004, 18:15</div></div><div class="posttext">I don't know what kind of installer it is, it's just a suggestion. Most common archivers support CAB compression, it won't be difficult to find out.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Olomite</div><div class="date">13th January 2004, 18:48</div></div><div class="posttext">sorry</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th January 2004, 18:58</div></div><div class="posttext">Did you try to extract that installer (setup.exe)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Olomite</div><div class="date">13th January 2004, 21:01</div></div><div class="posttext">I see a file in the setup directory called SQLRUN.CAB<br />
<br />
I'm not sure what to do now to use that. <br />
<br />
 sorry for the double post earlier.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th January 2004, 21:22</div></div><div class="posttext">I mean: Open the file setup.exe itself in a CAB-supporting archiver.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">g8oz</div><div class="date">4th February 2004, 22:46</div></div><div class="posttext">Check this key:<br />
<br />
HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\Installed Instances<br />
<br />
Unfortunately it is REG_MULTI_SZ (an array essentially), and there is no nice way to read those in NSIS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">4th February 2004, 23:14</div></div><div class="posttext">See the users manual for information about reading REG_MULTI_SZ.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">willykelleher</div><div class="date">4th March 2004, 16:27</div></div><div class="posttext">I wrote a program to install msde and it checks the default instance and installs or upgrades. I am not sure how this will come out after posting. This is probably not a very clean way but I am new.<br />
<br />
I also start the service after it is installed or upgraded with another function which determines OS and starts it accordingly. I use an ini file to controll version's of this and other programs in the installer, that I download at the start of the install. I include a default config ini if the installer can't get the config off the net. I believe the method I use to compare versions is inacurate as I am having an issue with another program in the installer with major/minor version numbers where the string length of the newer version is less than the older one and the intcmp fails because of this. <br />
<br />
I never fully completed the upgrade part and maybe that is why I have the wait messagebox so it doesn't continue till upgrade is done. The setpw.bat sets the sa password if it is null from the previuos install so the upgrade works <br />
<br />
Function UpdateMSDE<br />
   Push $R0<br />
   readINIStr $R1 &quot;$INSTDIR\CFG\HTTP_CFG.ini&quot; &quot;MSDE&quot; &quot;MinVer&quot;<br />
   ReadRegStr $R0 HKLM &quot;SOFTWARE\Microsoft\MSSQLServer\MSSQLServer\CurrentVersion&quot; &quot;CSDVersion&quot;<br />
;   dumpstate::debug<br />
   StrCmp $R0 &quot;&quot; lbl_no 0<br />
;   IntCmp $R0 &quot;8.00.194&quot; lbl_done lbl_up lbl_done<br />
;   IntCmp $R0 &quot;8.00.760&quot; lbl_done lbl_up lbl_done<br />
   Push $R0<br />
   Push &quot;.&quot;<br />
   Call RemoveStr<br />
   Pop $R0<br />
   Push $R1<br />
   Push &quot;.&quot;<br />
   Call RemoveStr<br />
   Pop $R1<br />
   IntCmp $R0 $R1 lbl_done lbl_up lbl_done<br />
   StrCpy $R0 'OK'<br />
   GoTo lbl_done<br />
   lbl_up:<br />
     MessageBox MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON1 \<br />
        &quot;MSDE Version $R0 Needs Updating to $R1 Would you like me to try: ?&quot; IDNO lbl_done<br />
     SetOutPath &quot;$INSTDIR\&quot;<br />
     !ifdef INS_MSDE<br />
       call DLMSDE<br />
     !endif<br />
     !ifndef INS_MSDE<br />
       File /r ${QPS_IN}\MSDE<br />
     !endif<br />
 <br />
     ExecWait '&quot;$INSTDIR\MSDE\setpw.bat&quot;'<br />
     ExecWait '&quot;$INSTDIR\MSDE\Setup.exe&quot; /l $INSTDIR\msdeup.log /upgradesp SQLRUN INSTANCENAME=MSSQLServer SECURITYMODE=SQL UPGRADEUSER=sa UPGRADEPWD=password'<br />
     MessageBox MB_OK &quot;WAIT&quot;<br />
     Goto lbl_done<br />
   lbl_no:<br />
     ;SetOutPath &quot;$INSTDIR\MSDE&quot;<br />
     SetOutPath &quot;$INSTDIR\&quot;<br />
     !ifdef INS_MSDE<br />
       call DLMSDE<br />
       goto lbl_ins<br />
     !endif<br />
     !ifndef INS_MSDE<br />
        File /r ${QPS_IN}\MSDE<br />
     !endif<br />
   lbl_ins:<br />
     MessageBox MB_OK &quot;INSTALLING MSDE&quot;<br />
     call updateMSDEPath<br />
     ExecWait '&quot;$INSTDIR\MSDE\Setup.exe&quot; /l $INSTDIR\msde.log SQLRUN SECURITYMODE=SQL SAPWD=password'<br />
     StrCpy $R0 'NO'<br />
     Goto lbl_done<br />
   lbl_done:<br />
   call startMSDE<br />
   SectionGetFlags ${SecM3} $R1<br />
   IntOp $R2 $R1 &amp; 0x80000000<br />
   IntCmp $R2 0 Start Skip<br />
 Start:<br />
   call StartApps<br />
   goto done<br />
 Skip:<br />
   !define MSDE_ONLY &quot;TRUE&quot;<br />
 done:<br />
   Exch $R0<br />
FunctionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>