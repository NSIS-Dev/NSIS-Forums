<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" how to copy  files from one dir to another with file extention., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  how to copy  files from one dir to another with file extention. NSIS Discussion" />
	
	<title> how to copy  files from one dir to another with file extention. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  how to copy  files from one dir to another with file extention.</div>
<hr />
<div class="pda"><a href="t-196072.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=196072">how to copy  files from one dir to another with file extention.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">saritha</div><div class="date">9th October 2004, 08:28</div></div><div class="posttext">Hi Iam writing a Installer script what it does is  ……it will copy a  * .p12 files   from temp to config dir <br />
<br />
<br />
<br />
Temp and config are two different dir’s , both will have not only *.p12 ,but also another files.<br />
<br />
Temp should only copy the *.p12 files from temp to config dir and remove old *p12 files from config dir<br />
<br />
<br />
<br />
 It will work only if we know the file name. ………Without knowing the filename how to copy only specific type of file’s from one dir to another with help of file extension.<br />
<br />
Here am writing script, which is, not work bur I want to explain you in detail.<br />
<br />
<br />
outfile &quot;C:\Importcert1.exe&quot;<br />
section Import<br />
StrCpy $R4 &quot;&quot;<br />
<br />
loop:<br />
IfFileExists &quot;C:\Program Files\VistaWiz\OpenVPN\temp\*.p12&quot; config no_config<br />
<br />
<br />
no_config:<br />
Strcmp $R4 &quot;counter&quot; endall<br />
MessageBox MB_ICONEXCLAMATION|MB_OK \<br />
           'Could not find p12 Files In temp Dir .\<br />
               $\n &quot;Without it you cannot run &quot; ${APPNAMEANDVERSION}&quot;. \<br />
            $\n$\n Please Extract E-Mail Attachmet Into temp Dir Then Click Importcert Link.'<br />
goto endForGood<br />
<br />
doDel:<br />
       StrCpy $R4 &quot;counter&quot;<br />
     ;  KillProcDLL::KillProc &quot;openvpn-gui.exe&quot;<br />
       delete &quot;C:\Program Files\VistaWiz\OpenVPN\config\*.p12&quot;<br />
      <br />
config:<br />
KillProcDLL::KillProc &quot;openvpn-gui.exe&quot;<br />
StrCmp $R4 &quot;&quot; doDel<br />
CopyFiles /SILENT &quot;C:\Program Files\VistaWiz\OpenVPN\temp\*.p12&quot; &quot;C:\Program Files\VistaWiz\OpenVPN\config\*.p12&quot;<br />
delete &quot;C:\Program Files\VistaWiz\OpenVPN\temp\*.p12&quot;<br />
goto loop<br />
<br />
endall:<br />
SetOutPath &quot;C:\Program Files\VistaWiz\OpenVPN\bin\&quot;<br />
Exec &quot;openvpn-gui.exe&quot;<br />
<br />
<br />
endForGood:<br />
sectionend<br />
<br />
Please help p me  I really appreciate</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th October 2004, 11:42</div></div><div class="posttext">CopyFiles /SILENT &quot;C:\Program Files\VistaWiz\OpenVPN\temp\*.p12&quot; &quot;C:\Program Files\VistaWiz\OpenVPN\config&quot;<br />
<br />
To delete all .p12 files in the temp dir, you should use FindFirst, FindNext etc:<br />
<br />
Function DeleteP12Files<br />
Exch $R0<br />
Push $R1<br />
Push $R2<br />
 ClearErrors<br />
 FindFirst $R1 $R2 &quot;$R0\*.p12&quot;<br />
 Top:<br />
  IfErrors Done<br />
<br />
  Delete &quot;$R0\$R2&quot;<br />
<br />
  ClearErrors<br />
   FindNext $R1 $R2<br />
  Goto Top<br />
 Done:<br />
<br />
 FindClose $R1<br />
Pop $R2<br />
Pop $R1<br />
Pop $R0<br />
FunctionEnd<br />
<br />
Then call the function like so:<br />
Push &quot;C:\Program Files\VistaWiz\OpenVPN\temp&quot;<br />
 Call DeleteP12Files<br />
This will delete all p12 files in that directory.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saritha</div><div class="date">9th October 2004, 22:08</div></div><div class="posttext">Thank you very very much !</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>