<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS - Dynamic custom pages, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS - Dynamic custom pages NSIS Discussion" />
	
	<title> NSIS - Dynamic custom pages [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS - Dynamic custom pages</div>
<hr />
<div class="pda"><a href="t-305564.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305564">NSIS - Dynamic custom pages</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">sylvinhio</div><div class="date">21st April 2009, 09:40</div></div><div class="posttext">Hello,<br />
<br />
I'm using NSIS with Eclipse plugin to build custom pages.<br />
My custom pages are &quot;.ini&quot; files and used like that:<br />
Page Custom MyPage MyPageLeave &quot; : This is my page&quot;<br />
<br />
In a custom page, I have &quot;2 group boxes&quot;:<br />
<br />
The first group box contains 2 radio buttons<br />
The second contains a textbox<br />
<br />
When checking a radio button, I want to disable the textbox.<br />
When checking the other radio button, I want to enable the textbox.<br />
<br />
Is it possible ?<br />
<br />
Thanks a lot</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">21st April 2009, 10:08</div></div><div class="posttext">NOTIFY flag</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sylvinhio</div><div class="date">21st April 2009, 11:01</div></div><div class="posttext">Hi, thanks for your answer... it's seems to work.<br />
<br />
No my problems are:<br />
<br />
1/ When my radio is checked, the &quot;leave&quot; function is invoked. In my leave function, I'm setting values like<br />
<br />
WriteINIStr $R0 &quot;Field 7&quot; &quot;State&quot; &quot;localhost&quot;<br />
WriteINIStr $R0 &quot;Field 7&quot; &quot;Flags&quot; &quot;DISABLED&quot;<br />
<br />
My my page is not reloaded so my changes are not uploaded on the page. How can I do that ?<br />
<br />
2/ When my radio is checked, the &quot;leave&quot; function is invoked. How can I make the difference between the &quot;leave&quot; function invoked by my NOTIFY flag and the leave function invoked when the page is leaved ?<br />
<br />
Thank you very much for your help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">21st April 2009, 11:05</div></div><div class="posttext">the installoptions readme tells you how</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sylvinhio</div><div class="date">21st April 2009, 12:59</div></div><div class="posttext">In the documentation, it's written that changes on the new version &quot;Made pages refresh after an aborted leave function&quot;.<br />
<br />
But if I'm doing &quot;Abort&quot; in the leave function, my page is not refreshed !!<br />
<br />
I didn't find anything about how I can make the difference between the &quot;leave&quot; function invoked by my NOTIFY flag and the leave function invoked when the page is leaved.<br />
<br />
Can you help me or tell me in which part of the documentation I can find that information ?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">21st April 2009, 13:09</div></div><div class="posttext">Your validation/leave function can read the &quot;State&quot; value from the &quot;Settings&quot; section to determine which control caused the notification, if any, and perform some appropriate action followed by an Abort instruction (to tell NSIS to return to the page). The Examples\InstallOptions folder contains an example script showing how this might be used. <br />
<br />
Your page is not refreshed, you need to update the controls and not the .ini</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sylvinhio</div><div class="date">21st April 2009, 13:46</div></div><div class="posttext">Hi,<br />
<br />
Sorry but I didn't find how to change control value instead of ini values.<br />
<br />
The only thing I found was :<br />
<br />
 Writing to INI files<br />
<br />
The INSTALLOPTIONS_WRITE macro allows you to write values to the INI file to change texts or control settings on runtime:<br />
<br />
!insertmacro INSTALLOPTIONS_WRITE &quot;myFile.ini&quot; &quot;Field #&quot; &quot;Name&quot; &quot;Value&quot;<br />
<br />
But that doesn't update my control value...<br />
<br />
<br />
I forgot to tell I'm using NSIS InstallOptions....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sylvinhio</div><div class="date">21st April 2009, 15:13</div></div><div class="posttext">I have tried with the following instructions (the field number of the text i want to update is 2):<br />
<br />
GetDlgItem $R1 $HWNDPARENT 1201     ;1200 + Field number - 1<br />
MessageBox MB_OK &quot;R1 = $R1&quot;<br />
SendMessage $R1 ${WM_SETTEXT} &quot;STR:MY NEW VALUE&quot; 0<br />
<br />
The messagebox instruction always displays R1 = 0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sylvinhio</div><div class="date">21st April 2009, 16:25</div></div><div class="posttext">I have found how to set the text value :<br />
<br />
;Get the HWND ID of the field<br />
ReadINIStr $idChampIP &quot;$R0&quot; &quot;Field 2&quot; &quot;HWND&quot;<br />
    <br />
,;Sets the value to &quot;localhost&quot;<br />
SendMessage $idChampIP ${WM_SETTEXT} 1 &quot;STR:localhost&quot;<br />
<br />
But I would like to set the flag &quot;DISABLED&quot; to 1 on this field<br />
<br />
I have tried that without success (&quot;2&quot; means that this is the 2nd flag but I'm not sure it works like that)<br />
<br />
SendMessage $idChampIP ${BM_SETCHECK} 1 &quot;2&quot;<br />
<br />
<br />
Don't know how it works and can't find any documentation givin' all the constants we can use 'BM_, WM_, ...)<br />
<br />
Can someone help me please ?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st April 2009, 19:04</div></div><div class="posttext">EnableWindow<br />
<br />
I recommend you switch to MUI2 and nsDialogs.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sylvinhio</div><div class="date">21st April 2009, 21:49</div></div><div class="posttext">I just want to disable the text box, not the entire Page.<br />
How can I use that flag ? I thought that &quot;EnableWindow&quot; had effect on the entire page....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sylvinhio</div><div class="date">22nd April 2009, 09:19</div></div><div class="posttext">Tu sum up I've gt two problems, after searching all the day in the documentation and code examples.<br />
<br />
1/ How to dynamically disable a textbox<br />
<br />
I have found how to set the text value :<br />
<br />
;Get the HWND ID of the field<br />
ReadINIStr $idChampIP &quot;$R0&quot; &quot;Field 2&quot; &quot;HWND&quot;<br />
<br />
,;Sets the value to &quot;localhost&quot;<br />
SendMessage $idChampIP ${WM_SETTEXT} 1 &quot;STR:localhost&quot;<br />
<br />
But I would like to set the flag &quot;DISABLED&quot; to 1 on this field<br />
<br />
I have tried that without success (&quot;2&quot; means that this is the 2nd flag but I'm not sure it works like that)<br />
<br />
SendMessage $idChampIP ${BM_SETCHECK} 1 &quot;2&quot;<br />
<br />
<br />
Don't know how it works and can't find any documentation givin' all the constants we can use 'BM_, WM_, ...)<br />
<br />
2/ When I'm in a &quot;leave&quot; function of a custom page, how to know if I'm coming from the NOITIFY event of a control or from the &quot;NEXT button click&quot;.<br />
<br />
<br />
If someone can help me...<br />
<br />
Thanks a lot</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">22nd April 2009, 09:36</div></div><div class="posttext">1)<br />
ReadINIStr $idChampIP &quot;$R0&quot; &quot;Field 2&quot; &quot;HWND&quot;<br />
EnableWindow $idChampIP 0<br />
<br />
2)<br />
read the state value in the settings section IIRC, like I said, read the docs, and the docs will tell you to check testnotify.nsi<br />
<br />
as far as docs for WM_,BM_ etc, check www.MSDN.com</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sylvinhio</div><div class="date">22nd April 2009, 14:47</div></div><div class="posttext">Thanks a lot, everything works fine !!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glambert</div><div class="date">5th May 2009, 09:38</div></div><div class="posttext">Hi,<br />
<br />
I've got a custom page with 2 radio buttons on it, whatever I do on it I can't go through to the next page.<br />
<br />
My code is - <br />
<br />
<br />
Function ShowDLLPage<br />
  InstallOptions::initDialog &quot;$PLUGINSDIR\dlltype.ini&quot;<br />
  Pop $0<br />
  InstallOptions::show<br />
  Pop $0<br />
FunctionEnd<br />
<br />
Function ProcessDLLPage<br />
  ReadINIStr $0 &quot;$PLUGINSDIR\dlltype.ini&quot; &quot;Settings&quot; &quot;State&quot;<br />
  StrCmp $0 1 pcs<br />
  StrCmp $0 2 lv<br />
  Abort<br />
<br />
  pcs:<br />
    FileOpen $9 $INSTDIR\config\mode.conf w<br />
    FileWrite $9 &quot;1&quot;<br />
    FileClose $9<br />
    Abort<br />
  lv:<br />
    FileOpen $9 $INSTDIR\config\mode.conf w<br />
    FileWrite $9 &quot;0&quot;<br />
    FileClose $9<br />
    Abort<br />
FunctionEnd<br />
<br />
<br />
at first I thought, it must be the Abort's, but when I removed them, just clicking on the radio buttons went through to the next page and didn't do the file writing stuff at all.<br />
<br />
can anyone point out where i'm going wrong here?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th May 2009, 10:16</div></div><div class="posttext">Depending on your NSIS version you may need to use /NOUNLOAD on your InitDialog call.<br />
<br />
Edit: If it is not that, check the INI file exists and that it does not contain errors.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glambert</div><div class="date">5th May 2009, 10:26</div></div><div class="posttext">Originally posted by Afrow UK <br />
Depending on your NSIS version you may need to use /NOUNLOAD on your InitDialog call.<br />
<br />
Edit: If it is not that, check the INI file exists and that it does not contain errors.<br />
<br />
Stu  <br />
<br />
Hi Stu,<br />
<br />
I appreciate the quick reply.<br />
<br />
It didn't fix it unfortunately.  My version of NSIS is 2.42<br />
<br />
The INI file is - <br />
<br />
<br />
[Settings]<br />
NumFields=2<br />
Title=&quot;Choose Install Type&quot;<br />
<br />
[Field 1]<br />
Type=&quot;RadioButton&quot;<br />
Text=&quot;PCS&quot;<br />
Flags=NOTIFY<br />
State=0<br />
Left=10<br />
Right=100<br />
Top=17<br />
Bottom=25<br />
<br />
[Field 2]<br />
Type=&quot;RadioButton&quot;<br />
Text=&quot;LV&quot;<br />
Flags=NOTIFY<br />
State=1<br />
Left=10<br />
Right=100<br />
Top=30<br />
Bottom=38<br />
<br />
<br />
EDIT: it is going through to the &quot;leave&quot; page when it isn't allowing the next button to be clicked, I checked the file it should be writing to and it is working properly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th May 2009, 10:51</div></div><div class="posttext">So the file exists in $PLUGINSDIR?<br />
You should try the InstallOptions helper script header.<br />
<br />
But first try replacing both plugin calls with just a call to InstallOptions::Dialog<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glambert</div><div class="date">5th May 2009, 11:01</div></div><div class="posttext">Originally posted by Afrow UK <br />
So the file exists in $PLUGINSDIR?<br />
You should try the InstallOptions helper script header.<br />
<br />
But first try replacing both plugin calls with just a call to InstallOptions::Dialog<br />
<br />
Stu  <br />
<br />
Hi Stu,<br />
<br />
in the .onInit function I'm doing - <br />
<br />
<br />
InitPluginsDir<br />
  File /oname=$PLUGINSDIR\dlltype.ini &quot;dlltype.ini&quot;<br />
<br />
<br />
I have changed initDialog to Dialog and still no joy with it.<br />
<br />
Are there any errors in my ini file that you can see?  Do I have to do something special for the next button?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th May 2009, 11:04</div></div><div class="posttext">I assume you have Page Custom ShowDLLPage ProcessDLLPage?<br />
What is the value of $0 after the ::Dialog call?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glambert</div><div class="date">5th May 2009, 11:10</div></div><div class="posttext">Originally posted by Afrow UK <br />
I assume you have Page Custom ShowDLLPage ProcessDLLPage?<br />
What is the value of $0 after the ::Dialog call?<br />
<br />
Stu  <br />
<br />
Yes - <br />
<br />
<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  Page custom ShowDLLPage ProcessDLLPage<br />
<br />
<br />
I set an alert to come up with the value of $0.<br />
<br />
When I click the following, these values appear - <br />
<br />
PCS = 1<br />
LV = 2<br />
Next = 0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glambert</div><div class="date">5th May 2009, 15:47</div></div><div class="posttext">resolved by using nsDialogs</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th May 2009, 16:40</div></div><div class="posttext">Shame you had to go down that route (even though it is best to switch anyway). Would be nice to know what went wrong.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">5th May 2009, 17:22</div></div><div class="posttext">If I recall correctly 'Flags' in [Field 1] should be NOTIFY|GROUP</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>