<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Causes for Reboot &amp; Manual button get displayed on FinishPage, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Causes for Reboot &amp; Manual button get displayed on FinishPage NSIS Discussion" />
	
	<title> Causes for Reboot &amp; Manual button get displayed on FinishPage [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Causes for Reboot &amp; Manual button get displayed on FinishPage</div>
<hr />
<div class="pda"><a href="t-265919.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=265919">Causes for Reboot &amp; Manual button get displayed on FinishPage</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">16th February 2007, 10:23</div></div><div class="posttext">Hi Folks!<br />
<br />
Yes, I'm back! Was not in touch for weeks due official tour and other assignments.<br />
<br />
I'm yet to go through the threads started by me in the last 20 days. I'll definitely go through them and will revert to them. But in the meantime,here's one more new issue.<br />
<br />
The senior most person from my management have reported that my installer has once worked peculiarly, though he was  unable to reproduce the anomaly in front of me.<br />
<br />
He is saying that my installer has displayed the option 'Reboot' and 'Manual' in the Finish page of the installation. I'm wondering how can it be, when I've not issued any such command! And the installer was working fine when I left. As per him, at that situation he selected the option 'manual'. And after the installation he run our application and discovered that the application is giving an error as the installer failed to register one of the ocx. This is the whole scenario, tell me why this thing happened for once only and he was unable to recreate this error again as the installer is working fine after that one time blunder.<br />
<br />
In my knowledge knowingly, I've not used any commands related to reboot in my installer script. May be the installer is auto-checking the installation and activating this feature! During installation my installer uses the command DELETE and COPY for certain operations. Anything related to, if the operation is unsucessful?<br />
<br />
Still these are the commands anything close to reboot in use:<br />
<br />
 Section &quot;-Install ActiveX controls &quot;<br />
   IfFileExists &quot;$INSTDIR\MyApp.exe&quot; 0 new_installation<br />
     StrCpy $ALREADY_INSTALLED 1<br />
   new_installation:<br />
   !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;AppDLLOCX\comdlg32.ocx&quot; &quot;$SYSDIR\comdlg32.ocx&quot; &quot;$SYSDIR&quot;<br />
 SectionEnd<br />
<br />
Section Uninstall<br />
; plz. note the following line is commented!<br />
;  RMDir /r /REBOOTOK $INSTDIR <br />
<br />
SectionEnd<br />
<br />
Function .onRebootFailed<br />
   MessageBox MB_OK|MB_ICONSTOP &quot;Reboot failed. Please reboot manually.&quot; /SD IDOK<br />
FunctionEnd<br />
<br />
<br />
With regards,<br />
<br />
<br />
<br />
<br />
<br />
<br />
:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">16th February 2007, 14:26</div></div><div class="posttext">The RegDll command (or an alternative like UpgradeDll_Func you might use) probably failed and set the RebootFlag TRUE. (See the help 4.9.11.2 SetRebootFlag, and 4.9.4.11 IfRebootFlag)<br />
<br />
The Finish page displays the option your boss saw if that flag is set.<br />
<br />
The dll might have failed to register because A) it depends upon other dlls that were not installed yet, or B) it needs a path variable that wasn't set yet, or C) another process was active and using an older copy of the dll, so the new one won't get copied into the directory until a reboot.<br />
<br />
I struggled with this last week because my dlls needed the vc_redistributable dlls, but I installed those after mine. On the first install on a clean box, it wouldn't register them. second install worked (because the dependency was solved by then).<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">16th February 2007, 14:44</div></div><div class="posttext">Thanks Don for the reply. I've to leave office now, will check it tomorrow as per your suggestion. You've correctly deciphered my issue. Your second install worked like my boss's - how the 2nd time it works?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>