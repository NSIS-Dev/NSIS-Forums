<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ebanner - weird problem on some machines, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ebanner - weird problem on some machines NSIS Discussion" />
	
	<title> ebanner - weird problem on some machines [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ebanner - weird problem on some machines</div>
<hr />
<div class="pda"><a href="t-323998.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=323998">ebanner - weird problem on some machines</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">zivha</div><div class="date">12th November 2010, 18:24</div></div><div class="posttext">Hello,<br />
<br />
  I am struggling to figure out what is wrong with a simple piece of code. The code seems to run on most machines and different OS. On one machine it does not.<br />
<br />
  I am using modern UI2 using custom dialog boxes. I need to display a logo on the right top corner of the dialog, the logo can change dynamically so I am creating it with ebanner.<br />
<br />
  Here is the relevant snippet of code creating the dialog and placing the logo<br />
<br />
	nsDialogs::Create 1018<br />
	Pop $Dialog<br />
<br />
	${NSD_CreateBitmap} -120 9u 120 80 &quot;&quot;<br />
	Pop $R0<br />
	ebanner::show /NOUNLOAD /HWND=$R0 /HALIGN=MIDDLE /VALIGN=MIDDLE &quot;$TMP\logo.png&quot;<br />
	<br />
	nsDialogs::Show<br />
<br />
  I have two machines, both run Windows 7 64 bit, one one machine this code displays an empty dialog with the logo on the right top corner. On the other machine it displays an empty dialog, the logo is just not displayed.<br />
<br />
  Any ideas??? struggling to figure out what is wrong with this piece of code... <br />
<br />
  Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zivha</div><div class="date">13th November 2010, 15:26</div></div><div class="posttext">Ok - after more digging and searching I found the following. eBanner uses IImgCtx COM interface to decode the PNG file. The machine on which ebanner fails also has IE9 beta installed, it seems that IE9 made some changes to this interface...<br />
<br />
now to figure out how to get around it, wish there was a plugin that included a decoder.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">13th November 2010, 17:53</div></div><div class="posttext">The problem has been signaled to Microsoft : https://connect.microsoft.com/IE/feedback/details/611317/iimgctx-fails-to-draw-after-installing-ie9-beta<br />
<br />
It is not sure they will fix the problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">13th November 2010, 18:16</div></div><div class="posttext">Thanks, zivha, I could reproduce this problem after installing IE9.<br />
I found one link with the same situation<br />
http://social.msdn.microsoft.com/Forums/ru-RU/ieextensiondevelopment/thread/7b9a7426-0a2d-4cbc-ad90-f7b8c9a715ec<br />
Probably this guy sent request to connect.microsoft.com as well but I could not find this.<br />
In Codeproject IImg_Ctx comments (end of http://www.codeproject.com/KB/graphics/JianImgCtxDecoder.aspx page, latest comment) you can find the same link as Wizou just published, but for me this link is unavailable. Fortunatelly comment includes reply from MS: &quot;Apparently IE9 beta brings this component down, so all coders out there forget this stuff as soon as you can. And sorry for those who already used it in their projects, you're in big trouble. Remember, microsoft will always outplay you! And yes, this is officially confirmed by microsoft, look here: They are &quot;surprised that it does not crash&quot;, very funny guys indeed.&quot;<br />
May be it's to to use GDI+ ?... <br />
After some googling: Oups, GDI+ may not work even on Vista...<br />
If situation will be confirmed, the only 'all Win versions compatible' way I see is to use OleLoadPicture with 24-bit BMP or JPEG for 'dynamic' images. 7z compression is very good, so file size is not a problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">13th November 2010, 22:17</div></div><div class="posttext">To view the URL, you need to register on connect.microsoft.com and demand access to product &quot;IE&quot;.<br />
It's free, quick and immediate.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zivha</div><div class="date">14th November 2010, 01:53</div></div><div class="posttext">Yeah guys, thanks for all the feedback.<br />
<br />
So I guess this means ebanner plugin should be deprecated and removed? it seems to no longer (or maybe never really did) work well anymore as it uses this interface.<br />
<br />
As for another solution, I would appreciate any help or ideas you have, how can one go about putting a PNG on a dialog if transparency support is important? I want the PNG backgroudn to match the dialog background and using transparency seems like the right way to go. Embedding a decoder would be big and troublesome. What is one to do?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">14th November 2010, 08:34</div></div><div class="posttext">Wizou - thanks!<br />
zivha - &quot;(or maybe never really did)&quot; - we had not any problems with this plug-in before IE9. BTW if you don't need 24-bit color, you can use AnimGif with static gif, if my memory doesn't fail me it supports transparency.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">14th November 2010, 17:05</div></div><div class="posttext">(GIFs are 8-bit and transparency is only on/off, no blending)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>