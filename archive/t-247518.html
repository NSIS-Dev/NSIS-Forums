<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Reinstall feature, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Reinstall feature NSIS Discussion" />
	
	<title> Reinstall feature [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Reinstall feature</div>
<hr />
<div class="pda"><a href="t-247518.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=247518">Reinstall feature</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">coco_vc</div><div class="date">31st May 2006, 15:09</div></div><div class="posttext">Hi all,<br />
<br />
I need to extend my installer, so that if the product is already installed and the setup is run, to first (if the user choses) uninstall the existent version or to (if the user choses) just install  all the files without running the uninstaller first. For this task I have a few questions:<br />
<br />
1) In the NSIS\Examples\makensis.nsi is done<br />
<br />
<br />
ReadRegStr $R1 HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\NSIS&quot; &quot;UninstallString&quot;<br />
ExecWait '$R1 _?=$INSTDIR'<br />
<br />
<br />
What does the _?= mean?<br />
<br />
2) When uninstalling I know for sure that one of my dlls is in use and can't be released. So it can't be deleted, so normally at the end it asks for a reboot. I also specifically ask for a reboot after a normal installation b/c all applications need the new dll. But in the reinstall scenario I would like to not have 2 reboots, one after running the uninstaller and one after installing, but only one reboot after both steps. So I need to run (from my installer) the uninstaller somehow, with a parameter that says that the reboot shouldn't be asked, and then somehow in my uninstaller code to repress the reboot if that param is specified. Can I do that? If yes, how can I check in the uninstaller the parameters?<br />
<br />
Thx,<br />
Viv</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">31st May 2006, 21:08</div></div><div class="posttext">1.<br />
_?=$INSTDIR prevents the uninstaller copying itself to $TEMP and executing from there. Instead the uninstaller will execute from $INSTDIR.<br />
<br />
More info:<br />
http://nsis.sourceforge.net/When_I_use_ExecWait_uninstaller.exe_it_doesn%27t_wait_for_the_uninstaller?n22049_wiki_wiki__session=9076eccc098a648ac35f96c1f84fdfd8<br />
<br />
2.<br />
http://nsis.sourceforge.net/Category:Command_Line_Functions<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">coco_vc</div><div class="date">29th June 2006, 16:05</div></div><div class="posttext">Thx Stu for your answer.<br />
<br />
1) Why would makensis.nsi use the:<br />
<br />
ExecWait '$R1 _?=$INSTDIR'<br />
<br />
?<br />
Is b/c it doesn't want the uninstaller.exe to be deleted in case smth bad happens during uninstalling?<br />
<br />
2) I need from my installer to run my uninstaller. I know for sure that my uninstaller will ask for a reboot at the end, but I want when it is run from my installer, not to ask for reboot. One way to do this would be:<br />
- call from my installer the uninstaller with a parameter, eg -noreboot<br />
- in my uninstaller, at the end check if that param is specified and if yes supress the reboot by doing:<br />
<br />
SetRebootFlag false<br />
<br />
Is this a correct way of doing what I need?<br />
<br />
Thx,<br />
Viv</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>