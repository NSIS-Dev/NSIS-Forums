<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Newbie: Needs Help with Text to File + Registation Email, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Newbie: Needs Help with Text to File + Registation Email NSIS Discussion" />
	
	<title> Newbie: Needs Help with Text to File + Registation Email [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Newbie: Needs Help with Text to File + Registation Email</div>
<hr />
<div class="pda"><a href="t-188856.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=188856">Newbie: Needs Help with Text to File + Registation Email</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">PCEnhancer</div><div class="date">4th August 2004, 10:40</div></div><div class="posttext">Hi i'm back, My installer is now reaching the end of its completion. By it's not there yet. I am trying to build a Registation page that will put a copy of all the fields Entered into a &quot;Regstation.Txt&quot; file in the programs &quot;$INSTDIR&quot;. The other thing that is causing me the even more trouble is trying to figure out how to get the Regstation information to Email its self to my email account. Please Help.<br />
<br />
:( I know this is a lot to ask but i wouldn't ask unless there was no other way. Tank you.<br />
<br />
Please Note that when this Project reaches its completion. I will be putting a large sample of its .nsi with all it Functions and a few of my files up for grabs in the http://nsis.sourceforge.net/nsisarchive/<br />
with full credit to all who help(ed).<br />
<br />
Here is a very small sample what i have so far on the Regstation Page.<br />
<br />
;Text to File - Registation Page<br />
!include &quot;MUI.nsh&quot;<br />
;Name and file<br />
  Name &quot;Text to File&quot;<br />
  OutFile &quot;Text.exe&quot;<br />
;Default installation folder<br />
  InstallDir &quot;$PROGRAMFILES\Text in Here&quot;<br />
;Get installation folder from registry if available<br />
  InstallDirRegKey HKCU &quot;Software\Text in Here&quot; &quot;&quot;<br />
<br />
  Page custom Regstation<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
Section &quot;Dummy Section&quot; SecDummy<br />
SectionEnd<br />
;--------------------------------<br />
;Installer Functions<br />
Function .onInit<br />
	InitPluginsDir<br />
	File /oname=$PLUGINSDIR\Text.ini &quot;Text.ini&quot;<br />
	;Extract InstallOptions INI files<br />
	!insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;RegistrationDialog.ini&quot;<br />
FunctionEnd<br />
Function Regstation<br />
	InstallOptions::dialog &quot;$PLUGINSDIR\Text.ini&quot;<br />
FunctionEnd<br />
<br />
;-----------------------<br />
HERE IS THE: Text.ini<br />
;-----------------------<br />
[Settings]<br />
NumFields=10<br />
Title=Registion Page<br />
<br />
[Field 1]<br />
Type=Label<br />
Text=*First Name*<br />
Left=0<br />
Right=90<br />
Top=0<br />
Bottom=9<br />
<br />
[Field 2]<br />
Type=Text<br />
Text=First name<br />
Left=0<br />
Right=103<br />
Top=9<br />
Bottom=22<br />
<br />
[Field 3]<br />
Type=Label<br />
Text=*E-Mail*<br />
Left=1<br />
Right=25<br />
Top=25<br />
Bottom=33<br />
<br />
[Field 4]<br />
Type=Text<br />
Text=E-Mail<br />
Left=0<br />
Right=103<br />
Top=33<br />
Bottom=46<br />
<br />
[Field 5]<br />
Type=Groupbox<br />
Text=O/S<br />
Left=112<br />
Right=162<br />
Top=11<br />
Bottom=46<br />
<br />
[Field 6]<br />
Type=RadioButton<br />
Text=Unknown<br />
Flags=GROUP<br />
State=1<br />
Left=118<br />
Right=160<br />
Top=20<br />
Bottom=27<br />
<br />
[Field 7]<br />
Type=RadioButton<br />
Text=WinXP<br />
Left=118<br />
Right=152<br />
Top=27<br />
Bottom=35<br />
<br />
[Field 8]<br />
Type=RadioButton<br />
Text=Other<br />
Left=118<br />
Right=152<br />
Top=35<br />
Bottom=43<br />
<br />
[Field 9]<br />
Type=Label<br />
Text=Yes, I would like to get updates by E-Mail<br />
Left=25<br />
Right=200<br />
Top=62<br />
Bottom=102<br />
<br />
[Field 10]<br />
Type=Checkbox<br />
State=1<br />
Left=11<br />
Right=21<br />
Top=62<br />
Bottom=72</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">4th August 2004, 13:17</div></div><div class="posttext">You cannot easily force the user's computer to silently send you an email. If that were possible, then that would leed to people getting hold of people's private data etc and that would/could be illegal.<br />
<br />
You can however, do ExecShell &quot;&quot; &quot;mailto:your.email&amp;website.com?subject=$title&amp;body=$text&quot;<br />
Not sure if this will work with all E-mail client programs, but it works with Outlook/Outlook Express.<br />
<br />
To get hold of all the entered data, use ReadINIStr $var &quot;IOfile.ini&quot; &quot;Field X&quot; &quot;State&quot;<br />
To collect it all into the your $text variable, use StrCpy $text &quot;$var1&lt;html stuff&gt;$var2 etc&quot;<br />
<br />
Remember if you are using the method that I suggested, you need to send HTML to the E-mail's body, not just pure text with new line breakes ($\r$\n == &lt;br /&gt;).<br />
<br />
Also, my examples use $text, $var, $var1 etc for variables. These have to be defined first, or you should just use the readily defined ones ($0-9, $R0-9)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">4th August 2004, 13:49</div></div><div class="posttext">Not sure if this will work with all E-mail client programs, but it works with Outlook/Outlook Express.<br />
<br />
Remember that Internet Explorer has an option to choose what program to open for e-mails.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PCEnhancer</div><div class="date">4th August 2004, 14:21</div></div><div class="posttext">:) Thank you for your help. I will try what you have suggested and let you know how it works out. Theres just one thing Im not sure of, How do you send an HTML to the E-mail's body. Could you give me a sample of how &quot;all&quot; this should look?:confused:  It would realy help. I am So lost. Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">OJglass</div><div class="date">4th August 2004, 22:09</div></div><div class="posttext">You would be better off to hit a website and pass the information you need in through query strings to a script that can then take some action based on the values that are passed to it.<br />
<br />
Personally i think it would be best to use the download plugin so you can verify (by receiving a .ini file for instance and parsing it) if the script received the information correctly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PCEnhancer</div><div class="date">5th August 2004, 03:53</div></div><div class="posttext">Thank you for your help, but i am still very lost :confused:. The (ExecShell &quot;&quot; &quot;mailto:your.email&amp;subject=$title&amp;body=$text&quot;) works ok but I am not sure how to use the &quot;$title&quot; or &quot;$text&quot; variables. And the (ReadINIStr $var &quot;IOfile.ini&quot; &quot;Field X&quot; &quot;State&quot;) is not working for me, I think I have things mixed up. <br />
<br />
If you could wright a sample of how this needs to look it would Realy Realy Help. Thanks<br />
<br />
Also is there a way to make the &quot;Next&gt;&quot; buttion only on the custom page say Register and have it launch the &quot;ExecShell&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">5th August 2004, 07:34</div></div><div class="posttext">Besides the legal issues perhaps BLAT can help you. It's an open source command line email sender. http://blat.sf.net</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PCEnhancer</div><div class="date">7th August 2004, 05:09</div></div><div class="posttext">Thanks for BLAT it will hopefully be a big help. But I am still in Confusion with (ReadINIStr $var &quot;IOfile.ini&quot; &quot;Field X&quot; &quot;State&quot;) the ($text) variables, and the (StrCpy $text &quot;$var1&lt;html stuff&gt;$var2).<br />
<br />
I really need to see an example or two, this part is killing me. every thing I have tried has failed. Please help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PCEnhancer</div><div class="date">15th August 2004, 06:37</div></div><div class="posttext">Thank you for all your help, i have my Registation page almost done. the only thing that I still cant figure out is how to get BLAT to work. all the information is in a text file, I just need to get that text file to email its self to me using Blat or some other program during the installation. Please Help. Examples would be helpful. Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th August 2004, 11:38</div></div><div class="posttext">If it's an exe, you need to Exec it or, nsExec::Exec.<br />
<br />
You will need too extract it to a temp folder, so...<br />
<br />
Function .onInit<br />
 InitPluginsDir<br />
FunctionEnd<br />
Section<br />
 SetOutPath $PLUGINSDIR<br />
 File &quot;blat.exe&quot;<br />
 File ...other blat files...<br />
 nsExec::Exec &quot;$PLUGINSDIR\blat.exe -options&quot;<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PCEnhancer</div><div class="date">16th August 2004, 20:55</div></div><div class="posttext">Thank that helped<br />
<br />
only I used (nsExec::ExecToLog) it hides the window.<br />
nsExec::ExecToLog &quot;C:\blat.exe - a command&quot;<br />
<br />
Thanks a lot everything.:)<br />
<br />
the only thing that i need to do now is figure out how to put a check box on the WELCOMEPAGE that will skip a page if checked [NOTE] I know how to skip pages, i just dont know how to put a check box on only the WELCOMEPAGE</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">17th August 2004, 14:37</div></div><div class="posttext">nsExec::ExecToLog should be used only on the InstFiles page. It grabs the output and prints it into the details window. You should use nsExec::Exec.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PCEnhancer</div><div class="date">18th August 2004, 18:33</div></div><div class="posttext">Thanks but nsExec::ExecToLog works like ExecWait and if placed in the right spot like a Function, does not print on the InstFiles page. Tanks for your help.<br />
<br />
I Do have two more questions in:<br />
;--------------------------------<br />
Function .onVerifyInstDir<br />
	IfFileExists &quot;$INSTDIR&quot; PathGood<br />
	MessageBox MB_YESNO|MB_TOPMOST &quot;	Are you sure you whant to install here. \<br />
	$\r$\n$\r$\nIf you choose install here the some things will not work. IDYES PathGood IDNO installold<br />
	installold:<br />
	MessageBox MB_YESNO|MB_TOPMOST &quot;${APPNAME} Installation must be restarted to restore destination Folder $\n			Restart Now? &quot; \<br />
	IDNO PathGood IDYES<br />
	Quit	;Abort<br />
	PathGood:<br />
FunctionEnd<br />
;------------------------------<br />
How do you reset the &quot;$INSTDIR&quot; so that you do not have to restart the app?<br />
<br />
And in a text box how do make it tab over to the next box if more than one &quot;word&quot; is used, but only tab over in that one box and not the others. And is it possible to make the first letter in thows that one box automaticly swich to a capital while the fallowing letters are lower case<br />
Thank you for your time and help.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>