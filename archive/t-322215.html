<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Go to a NSIS page!, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Go to a NSIS page! NSIS Discussion" />
	
	<title> Go to a NSIS page! [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Go to a NSIS page!</div>
<hr />
<div class="pda"><a href="t-322215.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322215">Go to a NSIS page!</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">thanatos83</div><div class="date">6th September 2010, 13:43</div></div><div class="posttext">HI. :)<br />
<br />
I read the documentation about how to jump a NSIS page, so i need to jump to a page specific if a user select one option u other option.<br />
<br />
Well I set this in my script:<br />
<br />
# Installer pages<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_LICENSE $(MUILicense)<br />
Page custom SetupType SetupTypeLeave<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!insertmacro MUI_PAGE_STARTMENU Application $StartMenuGroup<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_PAGE_FINISH<br />
!insertmacro MUI_UNPAGE_CONFIRM<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
Function RelGotoPage<br />
  IntCmp $R9 0 0 Move Move<br />
    StrCmp $R9 &quot;X&quot; 0 Move<br />
      StrCpy $R9 &quot;120&quot;<br />
 <br />
  Move:<br />
  SendMessage $HWNDPARENT &quot;0x408&quot; &quot;$R9&quot; &quot;&quot;<br />
FunctionEnd<br />
<br />
Them i put this:<br />
<br />
${If} $SelRap == ${BST_CHECKED}<br />
        StrCpy $R9 3 <br />
        Call RelGotoPage<br />
    ${Else}<br />
        StrCpy $R9 6 <br />
        Call RelGotoPage       <br />
${EndIf}      <br />
<br />
<br />
But i confuse because the third page of NSIS is my custom page and then it shows me the install page. What is the order of the NSIS pages that shows with &quot;StrCpy $R9 3&quot; or for example 1,2,3,4, etc... ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">6th September 2010, 14:35</div></div><div class="posttext">It's a relative jump. If you pass '3', it should jump three pages forward. So where you end up depends entirely on where you're jumping from.<br />
<br />
Also, why on earth would you want to jump 120 pages? o__O</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th September 2010, 14:53</div></div><div class="posttext">Going forward any number than there are pages simulates a Cancel click.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thanatos83</div><div class="date">6th September 2010, 16:05</div></div><div class="posttext">It's a relative jump. If you pass '3', it should jump three pages forward. So where you end up depends entirely on where you're jumping from.<br />
<br />
Also, why on earth would you want to jump 120 pages? o__O<br />
<br />
OK, thanks i change this for 8 pages in total... now i see how this work with relative jumps.<br />
<br />
But there's also a problem, because the first condition work nice and goes to install files but if i select de second and try to jump to !insertmacro MUI_PAGE_DIRECTORY page then the installer generated an error and exits from installer.<br />
<br />
May be it is a bug ? :stare:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">6th September 2010, 16:17</div></div><div class="posttext">no idea about the crash (might need full example code)... but if you only need to move forward, I'd recommend using the technique of calling Abort in the pages' Pre function.  Use a variable to indicate which page you want to land on and call Abort in every page that is not the page you want.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thanatos83</div><div class="date">7th September 2010, 16:40</div></div><div class="posttext">hi.<br />
<br />
I get the same problem... crash if i jump to directory page, maybe the reason is the value 1 of StrCpy $R9 1 because it's reserved value for next page ?.<br />
<br />
I put my script, any help please!<br />
<br />
# Página - Bienvenida<br />
!insertmacro MUI_PAGE_WELCOME<br />
<br />
# Página - Licencia <br />
!insertmacro MUI_PAGE_LICENSE $(MUILicense)<br />
<br />
# Página - Tipo de instalación <br />
Page custom TipoInstalacion TipoInstalacionLeave<br />
<br />
# Página - Directorio<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE Directorio_PreFunction<br />
    !insertmacro MUI_PAGE_DIRECTORY<br />
    <br />
# Página - Menu Inicio<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE MenuInicio_PreFunction    <br />
    !insertmacro MUI_PAGE_STARTMENU Application $StartMenuGroup<br />
    <br />
# Página - Acceso Directo<br />
Page custom AccesoDirecto<br />
 <br />
# Página - Instalación<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE Instalacion_PreFunction   <br />
    !insertmacro MUI_PAGE_INSTFILES<br />
    <br />
# Página - Finalizar    <br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE Finalizar_PreFunction<br />
    !insertmacro MUI_PAGE_FINISH<br />
    <br />
# Define la función FunAbo    <br />
!define MUI_CUSTOMFUNCTION_ABORT FunAbo<br />
<br />
# Páginas de desinstalación<br />
!insertmacro MUI_UNPAGE_CONFIRM<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
# Function jump pages<br />
Function RelGotoPage<br />
  IntCmp $R9 0 0 Move Move<br />
    StrCmp $R9 &quot;X&quot; 0 Move<br />
      StrCpy $R9 &quot;6&quot; ;Nº total de páginas<br />
 <br />
  Move:<br />
  SendMessage $HWNDPARENT &quot;0x408&quot; &quot;$R9&quot; &quot;&quot;<br />
FunctionEnd<br />
<br />
<br />
# Custom function SetupType<br />
Function TipoInstalacion <br />
StrCpy $R8 1 ;esta es la primera página<br />
   <br />
!insertmacro MUI_HEADER_TEXT &quot;$(Tit1)&quot; &quot;$(SubTit1)&quot;<br />
<br />
nsDialogs::Create /NOUNLOAD 1018<br />
    Pop $CD1<br />
<br />
    ${If} $CD1 == error<br />
        Abort<br />
    ${EndIf}       <br />
    <br />
    ${NSD_CreateRadioButton} 12u 20u 100% 20 &quot;$(InstRap)&quot;<br />
    Pop $Rad2<br />
    <br />
 # Por defecto selecciona la Instalación rápida<br />
    ${NSD_SetState} $Rad2 ${BST_CHECKED}<br />
    <br />
    ${NSD_CreateRadioButton} 12u 33u 100% 20 &quot;$(InstPer)&quot;<br />
    Pop $Rad1<br />
    <br />
    ${NSD_CreateLabel} 0u 0u 100% 20 &quot;$(L1)&quot;<br />
    Pop $Lab1<br />
    <br />
nsDialogs::Show        <br />
FunctionEnd<br />
<br />
Function TipoInstalacionLeave<br />
# Guarda el estado del control del RadioButton<br />
    ${NSD_GetState} $Rad1 $SelPer<br />
    ${NSD_GetState} $Rad2 $SelRap<br />
<br />
# Condición basada en la selección del RadioButton    <br />
    ${If} $SelRap == ${BST_CHECKED}<br />
        StrCpy $R9 4 ; va hacia la página de instalación<br />
        Call RelGotoPage<br />
    ${Else}<br />
        StrCpy $R9 1 ; va hacia la página de seleccionar directorio<br />
        Call RelGotoPage       <br />
    ${EndIf}      <br />
FunctionEnd<br />
<br />
<br />
# Directory page<br />
Function Directorio_PreFunction<br />
  StrCpy $R8 2 ;esta es la segunda página<br />
FunctionEnd<br />
<br />
# Startmenu page<br />
Function MenuInicio_PreFunction<br />
  StrCpy $R8 3 ;esta es la tercera página<br />
FunctionEnd<br />
<br />
<br />
# Custom function Shorcut<br />
Function AccesoDirecto    <br />
StrCpy $R8 4 ;esta es la cuarta página<br />
<br />
!insertmacro MUI_HEADER_TEXT &quot;$(Tit2)&quot; &quot;$(SubTit2)&quot;<br />
<br />
nsDialogs::Create /NOUNLOAD 1018<br />
    Pop $CD2<br />
<br />
    ${If} $CD2 == error<br />
        Abort<br />
    ${EndIf}       <br />
    <br />
    ${NSD_CreateCheckBox} 0u 14u 100% 20 &quot;$(AccEsc)&quot;<br />
    Pop $Check1    <br />
    <br />
    ${NSD_CreateCheckBox} 0u 33u 100% 20 &quot;$(AccIni)&quot;<br />
    Pop $Check2<br />
    <br />
    ${NSD_CreateLabel} 0u 0u 100% 20 &quot;$(L2)&quot;<br />
    Pop $Lab2<br />
    <br />
nsDialogs::Show        <br />
FunctionEnd<br />
<br />
<br />
# Installation page<br />
Function Instalacion_PreFunction<br />
  StrCpy $R8 5 ;esta es la quinta página<br />
FunctionEnd<br />
<br />
# Finish page<br />
Function Finalizar_PreFunction<br />
  StrCpy $R8 6 ;esta es la sexta página<br />
FunctionEnd<br />
<br />
<br />
# Custom function abort<br />
Function FunAbo<br />
  StrCmp $R8 1 0 End ;Compare the variable with the<br />
                     ;page index of your choice<br />
    StrCpy $R9 1<br />
    Call RelGotoPage<br />
    Abort<br />
  End:<br />
FunctionEnd<br />
<br />
PD... Sorry for some strings in spanish language i'm spanish :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">7th September 2010, 22:17</div></div><div class="posttext">hi.<br />
<br />
I get the same problem... crash if i jump to directory page, maybe the reason is the value 1 of StrCpy $R9 1 because it's reserved value for next page ?.<br />
<br />
I put my script, any help please!<br />
<br />
Thanks for the semi-full example; it gives us something to work with :)<br />
<br />
Those who want to poke at it, the following is missing (just put it at the top):<br />
<br />
!include &quot;MUI2.nsh&quot;<br />
var StartMenuGroup<br />
var CD1<br />
var CD2<br />
var Check1<br />
var Check2<br />
var Lab1<br />
var Lab2<br />
var Rad1<br />
var Rad2<br />
var SelPer<br />
var SelRap<br />
Outfile &quot;$%temp%\temp.exe&quot;<br />
<br />
Section<br />
SectionEnd<br />
<br />
<br />
On to the issue at hand, then... the problem in your script appears to be that you're calling 'RelGotoPage 1' from your Custom Page's Leave function.  You can't do that, as NSIS will get stuck in a loop.  Not sure why, but it does :)<br />
<br />
As you only need to go +1 page anyway, you can just -not- call &quot;RelGotoPage&quot; at all, and NSIS will take the user to the next page as usual :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thanatos83</div><div class="date">8th September 2010, 00:26</div></div><div class="posttext">Exactly, i removed the part in the condition:<br />
<br />
    ${Else}<br />
        StrCpy $R9 1 ; va hacia la página de seleccionar directorio<br />
        Call RelGotoPage       <br />
    ${EndIf}      <br />
<br />
So it seems NSIS was getting in a constant loop, and now work fine...<br />
<br />
Thanks for help :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">8th September 2010, 00:35</div></div><div class="posttext">No prob :)  I'd still recommend using the other method, seeing as you're only going forward... as you can then easily re-order pages, add/remove pages, etc. without having to worry about updating the relGotoPage index numbers.  But this should definitely work :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>