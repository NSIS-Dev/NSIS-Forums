<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Check if a string is Char(zero), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Check if a string is Char(zero) NSIS Discussion" />
	
	<title> Check if a string is Char(zero) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Check if a string is Char(zero)</div>
<hr />
<div class="pda"><a href="t-193112.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=193112">Check if a string is Char(zero)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">DiLDoG</div><div class="date">10th September 2004, 16:50</div></div><div class="posttext">I'm trying to get the label of a CD using this:<br />
<br />
; Get current drive label<br />
DriveInfo::GetDriveLabel &quot;D:\&quot;<br />
Pop $1<br />
<br />
But if there is no cd in drive, it returns a zero character (at least I think it is). How do I replace that zero char with &quot;&lt;empty&gt;&quot; for example?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">10th September 2004, 17:01</div></div><div class="posttext">strcmp &quot;$1&quot; &quot;0&quot; 0 +2<br />
strcpy $1 &quot;&lt;empty&gt;&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DiLDoG</div><div class="date">10th September 2004, 17:04</div></div><div class="posttext">not the character &quot;0&quot; but Chr(0), so ascii value 0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">10th September 2004, 18:20</div></div><div class="posttext">ahh, use &quot;&quot; intead of &quot;0&quot; in the compare then.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DiLDoG</div><div class="date">10th September 2004, 19:05</div></div><div class="posttext">hm doenst seem to work, perhaps it aint Chr(0), but<br />
<br />
The plugin uses<br />
GetVolumeInformation(buf,buf2,sizeof(buf2)-1,0,0,0,0,0);<br />
<br />
and MSDN sais &quot;If not all the requested information is retrieved, the return value is zero.&quot;<br />
<br />
And if I display the var in a msgbox or any other thing it displays the square box char.<br />
<br />
this is my code as it is now:<br />
<br />
<br />
<br />
    StrCpy $2 &quot;&quot;<br />
<br />
again:<br />
    ; Enumerate CD Drives<br />
    EnumCDs::next /NOUNLOAD<br />
    Pop $0<br />
    StrCmp $0 &quot;error&quot; done<br />
    StrCmp $0 &quot;done&quot; done<br />
<br />
    ; Get current drive label<br />
    DriveInfo::GetDriveLabel &quot;$0&quot;<br />
    Pop $1<br />
    <br />
    strcmp &quot;$1&quot; &quot;&quot; 0 +2<br />
    strcpy $1 &quot;&lt;empty&gt;&quot;<br />
    <br />
    StrCpy $2 &quot;$2|$0 $1&quot;<br />
    goto again<br />
    <br />
done:<br />
    EnumCDs::next<br />
    Pop $0<br />
<br />
    WriteINIStr &quot;$PLUGINSDIR\insertcd.ini&quot; &quot;Field 1&quot; &quot;ListItems&quot; $2</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">10th September 2004, 19:22</div></div><div class="posttext">What about calling kernel32 directly and bypassing the driveinfo plugin? ie something like this (http://nsis.sourceforge.net/archive/viewpage.php?pageid=464).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DiLDoG</div><div class="date">10th September 2004, 19:39</div></div><div class="posttext">hm cant get that one working at all...<br />
<br />
<br />
; $0 - Drive to check returns the Disc Serial Number<br />
<br />
Function GetDiskVolumeSerialNumber<br />
<br />
  !define GetVolumeInformation &quot;Kernel32::GetVolumeInformation(t,*t,i,*i,*i,*i,t,i) i&quot;<br />
  <br />
  StrCpy $R0 &quot;hi&quot;<br />
  System::Call '${GetVolumeInformation}(&quot;C:\&quot;,,${NSIS_MAX_STRLEN},.r0,,,,${NSIS_MAX_STRLEN})'<br />
  MessageBox MB_OK|MB_ICONSTOP &quot;hi $R0 hi&quot;<br />
  <br />
FunctionEnd  ;GetDiskVolumeSerialNumber<br />
<br />
always results in &quot;hi hi hi&quot; Shouldn't R1 be changed there?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">10th September 2004, 20:26</div></div><div class="posttext">With this works with me:<br />
<br />
System::Call 'kernel32::GetVolumeInformation(t &quot;C:\&quot;, t .r0 , i 255, *i .r1, *i .r2, *i .r3, *i .r4, i 255) i .r11'<br />
DetailPrint $0<br />
DetailPrint $1<br />
DetailPrint $2<br />
DetailPrint $3<br />
DetailPrint $4<br />
DetailPrint $R1</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>