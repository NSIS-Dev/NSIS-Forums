<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How keeping NSIS window while the application's window  doesn't appear ?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How keeping NSIS window while the application's window  doesn't appear ? NSIS Discussion" />
	
	<title> How keeping NSIS window while the application's window  doesn't appear ? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How keeping NSIS window while the application's window  doesn't appear ?</div>
<hr />
<div class="pda"><a href="t-307678.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=307678">How keeping NSIS window while the application's window  doesn't appear ?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Icks92</div><div class="date">25th June 2009, 09:11</div></div><div class="posttext">Hello,<br />
<br />
I explain you my problem, I finished my NSIS, all is good, it does all what I want etc. At the end, the nsis call the next window and gives its the focus. So it is able to find a window. My only problem is, beetween the moment that the NSIS find the window and the moment that it opens, there is sometimes, 1 or 2 seconds. Durind this time, we don't know what happen. So I would like the last NSIS's window close, when the next window appear, and not only when it finds it.<br />
<br />
I tried the sleep function but it is not satisfying, because this time depends of the computer, the OS ..., I tried the ExecWait function but, whith the one, the NSIS window never close, and my compiler doesn't know the ExecCmd function.<br />
<br />
Would you have a solution to this problem ?<br />
<br />
I write you a piece of the code :<br />
<br />
Section ...<br />
.<br />
.<br />
.<br />
nsExec::Exec 'net start &quot;...&quot;'<br />
${IfNot} ${Silent}<br />
	${If} ${...}<br />
		        Exec '&quot;$INSTDIR\... .exe&quot; /oob'<br />
		${Else}<br />
			Exec '&quot;$INSTDIR\ ... .exe&quot; /oob'<br />
		${EndIf}<br />
	${EndIf}<br />
		StrCpy $count 1<br />
		Looping:<br />
			FindWindow $R5 &quot; ...&quot; &quot;&quot;<br />
			StrCmp $count 6 abort<br />
			StrCmp $R5 0 0 next2<br />
				Sleep 300<br />
				IntOp $count $count + 1 <br />
					Goto Looping<br />
		next2:<br />
			System::Call &quot;user32::SetForegroundWindow($R5)&quot;<br />
		abort:<br />
;(I tried a 'sleep 500' here but it was not satisfying)<br />
	Quit<br />
SectionEnd<br />
<br />
<br />
THANK YOU FOR YOUR HELP</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>