<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Simulating Local Variables, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Simulating Local Variables NSIS Discussion" />
	
	<title> Simulating Local Variables [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Simulating Local Variables</div>
<hr />
<div class="pda"><a href="t-171531.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=171531">Simulating Local Variables</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">JoeAcunzo</div><div class="date">29th February 2004, 19:21</div></div><div class="posttext">I've become a big NSIS fan in a short period of time.  One of the features I wish it had is &quot;local variables&quot;.  That is, variables scoped within a section and within a function.  This is becoming more important as I write more and more script code and start to build up a libary of reusable scripts (using !include), where use of globals have the potential for conflict since they are all in the same namespace.  And I realize there are many predefined variables that I could use ($R0...$R9 and $0...$9), but that doesn't make for very readable code.<br />
<br />
So, I've come up with a way to simulate local variables using macros and defines and would like feedback on this approach from the experts in this forum.  (See attached.)  I'd like feedback both on the implementation and the usage.<br />
<br />
Using this approach, I can write code like below and be assured of having a locally scoped variable &quot;count&quot;.<br />
<br />
<br />
${LocalVAR} count<br />
Section &quot;one&quot;<br />
    strcpy ${count} 1<br />
SectionEnd<br />
${LocalVAREnd} count<br />
<br />
${LocalVAR} count<br />
Function one<br />
    strcpy ${count} 2<br />
FunctionEnd<br />
${LocalVAREnd} count<br />
<br />
<br />
See the attachment for more examples and the implementation.<br />
<br />
So folks, what do you think?  Ideally, this would eventually be added to the compiler itself ;) but for now, this does the trick, for me anyway.<br />
<br />
Joe A.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">29th February 2004, 19:27</div></div><div class="posttext">You can also use defined symbols to make $R0...$R9 and $0...$9 more readable.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JoeAcunzo</div><div class="date">29th February 2004, 20:48</div></div><div class="posttext">Yes, I started using defines to make the register variables more readable before using this new approach.  There are two issues with that approach as I see it that my approach addresses:<br />
<br />
1. To be a &quot;good programming citizen&quot;, you should save/restore registers (i.e. push/pop), which is very easy to overlook potentially causing problems in nested function calls.  My approach doesn't require you to worry about this issue.<br />
<br />
2. You still have the namespace issue since defines share a common namespace.  My approach takes care of that for you (the LocalVAREnd simply undef's the defines used against the uniquely generated global VARs).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">29th February 2004, 20:51</div></div><div class="posttext">It is indeed useful for large libraries :) Can you create an archive page for your code?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shantanu_gadgil</div><div class="date">29th February 2004, 20:53</div></div><div class="posttext">The way things are going (good !) NSIS will turn into a programming language of sorts !!!<br />
<br />
As a Win32 programmer, I'm happy !!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabiochelly</div><div class="date">29th February 2004, 22:11</div></div><div class="posttext">But did you intend to add local variable to NSIS?<br />
It is is very difficult to create complex scripts like it is.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">1st March 2004, 14:43</div></div><div class="posttext">You only have to include the header file, there is no need to write complex scripts.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JoeAcunzo</div><div class="date">1st March 2004, 16:34</div></div><div class="posttext">Originally posted by Joost Verburg <br />
It is indeed useful for large libraries :) Can you create an archive page for your code? <br />
Joost -- Yes, I will add it to the archive soon.  As I've never added to this archive, I have a question.  Can anyone add to it or do I need a password and/or to be authorized in some way?<br />
<br />
However before I add it, I also have a scheme in mind that simulates parameter passing to functions and thought I should incorporate that into this same LocalVAR.nsh header file as well.  Or would you prefer that be a separate header?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">1st March 2004, 16:43</div></div><div class="posttext">That is fine. You have to register an NSIS Archive account to create pages, but it only takes a few seconds.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MysticHead</div><div class="date">10th December 2004, 15:29</div></div><div class="posttext">Just wondering what the status of this was. I couldn't find any listing for &quot;JoeAcunzo&quot; in the archive... Does anyone know if this local variable code made it into the archive under a different name? <br />
<br />
thanks,<br />
<br />
 -marc</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JoeAcunzo</div><div class="date">10th December 2004, 21:00</div></div><div class="posttext">Marc - Sorry, I got very busy putting out a new product called ComputerTime (see www.softwaretime.com for details), and never got around to posting this code.  I've attached the code to this posting.  Hope it helps.<br />
<br />
Joe A.<br />
<br />
PS. I never finished the ability to (simulate) passing variables to functions.  Not forgotten, just on a back burner.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MysticHead</div><div class="date">10th December 2004, 21:14</div></div><div class="posttext">Wow, quick response, I was just curious about the status.  It looks pretty slick:) <br />
<br />
thanks Joe.<br />
<br />
 -marc</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Madhusudhanan</div><div class="date">22nd April 2009, 16:11</div></div><div class="posttext">I tried to declare a local variable like this <br />
${LocalVAR} count<br />
Strcpy ${count} 1<br />
${LocalVAREnd} count,but it throws the following error when compiling.<br />
VAR expects 1-2 parameters, got 3.<br />
Usage: Var [/GLOBAL] var_name<br />
Error in macro mLocalVAR on macroline 12</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>