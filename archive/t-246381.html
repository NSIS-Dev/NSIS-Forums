<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Forcing InstallLib to replace dll?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Forcing InstallLib to replace dll? NSIS Discussion" />
	
	<title> Forcing InstallLib to replace dll? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Forcing InstallLib to replace dll?</div>
<hr />
<div class="pda"><a href="t-246381.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246381">Forcing InstallLib to replace dll?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Ian Goldby</div><div class="date">17th May 2006, 14:05</div></div><div class="posttext">Is there any way to force InstallLib to replace a DLL even if the replacement does not have a newer version number than the original? This is not a shared DLL, by the way.<br />
<br />
In my case, a DLL file version may be unchanged in the new release of the software, but the product version has changed. NSIS doesn't normally try to replace a DLL if the file version is not newer than the existing one. But it doesn't take into account that the product version has increased. The result is that after installation, the old DLL with the old product version is still on the disk.<br />
<br />
So I'd like InstallLib to replace the file if the file version is greater than or equal to the existing dll. Is this possible?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">17th May 2006, 17:23</div></div><div class="posttext">See in NSIS manual 4.9.3.5 GetDLLVersion with the given example.<br />
Once you get the version, you can use IntCmp to compare it with a defined version and do what you wish to do, either in case when they are equal, or in cases when the installed version is less/more.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ian Goldby</div><div class="date">18th May 2006, 09:05</div></div><div class="posttext">Yes, that's how InstallLib does it (except that it uses IntCmpU as the version numbers are unsigned integers).<br />
<br />
I was hoping to use InstallLib, because it does extra things like registering DLLs, copy-on-boot, etc.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">18th May 2006, 12:34</div></div><div class="posttext">According to dll's everything you can do with InstallLib you can do it also with GetDllVersion/RegDll/UnRegDll/Reboot Flag etc.<br />
BTW, is it necessary to register a non shared dll?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ian Goldby</div><div class="date">18th May 2006, 15:02</div></div><div class="posttext">According to dll's everything you can do with InstallLib you can do it also with GetDllVersion/RegDll/UnRegDll/Reboot Flag etc. Does File automatically replace DLLs that are in use next time you reboot?<br />
<br />
According to dll's everything you can do with InstallLib you can do it also with GetDllVersion/RegDll/UnRegDll/Reboot Flag etc. By register, I mean call the DLL's DLLRegisterServer entry point - i.e. what regsvr32 does. But I don't want to call regsvr32 if there is a built in NSIS function that does this for me - i.e. InstallLib.<br />
<br />
I think my best course of action will be to copy the InstallLib macro and modify it for my purposes. Seems like an ugly hack of last resort though...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">18th May 2006, 17:26</div></div><div class="posttext">I think my best course of action will be to copy the InstallLib macro and modify it for my purposes. Seems like an ugly hack of last resort though...<br />
If you insist in &quot;automatically&quot;, this is probably a good try :-)<br />
If you prefer to write your own customised code from scratch, then the other method would be more suitable :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ian Goldby</div><div class="date">19th May 2006, 16:04</div></div><div class="posttext">Well, it turned out to be easy to modify the CmpIntU lines in Library.nsh to achieve what I wanted.<br />
<br />
Thanks for your help.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>