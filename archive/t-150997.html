<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Setting InstallDir from reg key but manipulating first., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Setting InstallDir from reg key but manipulating first. NSIS Discussion" />
	
	<title> Setting InstallDir from reg key but manipulating first. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Setting InstallDir from reg key but manipulating first.</div>
<hr />
<div class="pda"><a href="t-150997.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=150997">Setting InstallDir from reg key but manipulating first.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Wunderboy</div><div class="date">1st October 2003, 01:30</div></div><div class="posttext">Hello Mr DJ. Long time lister, first time caller...<br />
<br />
I've only just stared using NSIS and despite reading, re-reading, browsing the FAQ and archives I've got myself in a tizz over this little problem.<br />
<br />
I would be ever so greatful is some kind soul could help me out of my quandry.<br />
<br />
First up, I'm using 2.0b3 and the Modern User Interface - just so you know.<br />
<br />
Problem is as follows. When my user comes to the &quot;Choose Install Location&quot; section, I need to pre-set what that install dir will be.<br />
<br />
Now, the actually path I want is in the registry BUT, and this is the catch, I need to manipulate it before its set as InstallDir.<br />
<br />
Heres the problem.<br />
<br />
My install path can be read from:<br />
 HKCU\Software\Company\Product\InstallPath<br />
<br />
which returns something like:<br />
<br />
C:\Program Files\Product\UserName\Prefs<br />
<br />
Now, what I need to do is alter that returned value by removing the &quot;Prefs&quot; part and appending some extra info to it. e.g.<br />
<br />
C:\Program Files\Product\UserName\Data\NewStuff<br />
<br />
The &quot;Data\NewStuff&quot; will be defined as a variable in the script and the above modified path should be what appears in the Install Location dialog and also be the value of $INSTDIR (or some other suitable var such as $OUTPATH).<br />
<br />
Now this has got me foxed because the users who will be using this installer are not *that* bright hence the need to prompt them with the correct path in the directory text box.<br />
<br />
To be honest, the NSIS scripting language does confuse me a bit and I cannot figure out how to achieve this so I would be awfully greatful is someone could help me out.<br />
<br />
Thanks in advance.<br />
<br />
- Jed</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st October 2003, 11:28</div></div><div class="posttext">Simply edit $INSTDIR in .onInit. Use GetParent (a function in one of the appendixes of the manual) to remove Prefs and then simply use:<br />
<br />
StrCpy $INSTDIR $INSTDIR\Data\NewStuff</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>