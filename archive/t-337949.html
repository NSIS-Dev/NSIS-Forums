<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" wscript.exe problem when run javascript, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  wscript.exe problem when run javascript NSIS Discussion" />
	
	<title> wscript.exe problem when run javascript [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  wscript.exe problem when run javascript</div>
<hr />
<div class="pda"><a href="t-337949.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=337949">wscript.exe problem when run javascript</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">NOCaut</div><div class="date">22nd November 2011, 11:24</div></div><div class="posttext">test.js<br />
<br />
function SetHomePage()<br />
	netscape.security.PrivilegeManager.enablePrivilege ('UniversalBrowserRead');<br />
<br />
	var m_tb_prefs = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;].getService(Components.interfaces.nsIPrefBranch);<br />
		var res = false;<br />
<br />
			curHomePage = m_tb_prefs.getCharPref('browser.startup.homepage');<br />
			m_tb_prefs.setCharPref('browser.startup.homepage', 'http://www.4shared.com/');<br />
			m_tb_prefs.setIntPref('browser.startup.page', 1);		<br />
}<br />
<br />
SetHomePage()<br />
<br />
and run Exec 'wscript.exe &quot;c:\test.js&quot;'<br />
<br />
Error: &quot;netscape is undefined&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">22nd November 2011, 12:21</div></div><div class="posttext">The NSIS forum is not the correct place to post javascript questions!<br />
<br />
...wscript is windows scripting host and not a general web browser, you cannot access browser specific objects with it.<br />
<br />
Who would want 4shared.com as their homepage anyway? All this seems a bit fishy to me, you should just let the user set their homepage.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NOCaut</div><div class="date">22nd November 2011, 12:23</div></div><div class="posttext">I get url: http://www.4shared.com/ for example.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NOCaut</div><div class="date">22nd November 2011, 12:25</div></div><div class="posttext">i want know i can change *.js file using nsis?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">22nd November 2011, 12:30</div></div><div class="posttext">I get url: http://www.4shared.com/ for example.<br />
Use example.com next time you need a general URL.<br />
<br />
My point still stands, you cannot set the homepage this way. Setting the users homepage like this is usually done by spyware like applications, if you don't have evil intentions you should just let the user set the homepage.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">22nd November 2011, 12:34</div></div><div class="posttext">i want know i can change *.js file using nsis?<br />
<br />
If you are rolling out Firefox in a domain environment I believe there are better ways of dealing with this than editing .js files that belong to the user. You should take a look at the unofficial Firefox MSI installers or edit the profile defaults in \FireFox\defaults\profile</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NOCaut</div><div class="date">22nd November 2011, 13:33</div></div><div class="posttext">ok thanks</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>