<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Dynamic Selection of Uninstall Sections does not work, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Dynamic Selection of Uninstall Sections does not work NSIS Discussion" />
	
	<title> Dynamic Selection of Uninstall Sections does not work [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Dynamic Selection of Uninstall Sections does not work</div>
<hr />
<div class="pda"><a href="t-352389.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=352389">Dynamic Selection of Uninstall Sections does not work</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">xbarns</div><div class="date">22nd November 2012, 09:26</div></div><div class="posttext">Hi all,<br />
<br />
i have a problem with my uninstaller, every section i execute on install, places a reference in the registry using.<br />
<br />
WriteRegStr HKLM &quot;${REGKEY}\Components&quot; &quot;Component1&quot; 1    <br />
<br />
now on uninstall i have <br />
<br />
<br />
!macro _SELECT_SECTION SECTION_REGISTRY SECTION_NAME SECTION_ID<br />
    <br />
    Push $R0<br />
    ReadRegStr $R0 HKLM &quot;${SECTION_REGISTRY}&quot; &quot;${SECTION_NAME}&quot;<br />
    MessageBox MB_OK &quot;${SECTION_REGISTRY}-${SECTION_NAME}-${SECTION_ID}&quot;<br />
    ${IF} $R0 = 1<br />
        MessageBox MB_OK &quot;SELECT-${SECTION_ID}&quot;<br />
        !insertmacro SelectSection &quot;${SECTION_ID}&quot;<br />
    ${ELSE}<br />
        MessageBox MB_OK &quot;UNSELECT-${SECTION_ID}&quot;<br />
        !insertmacro UnselectSection &quot;${SECTION_ID}&quot;<br />
    ${ENDIF}<br />
    Pop $R0<br />
!macroend<br />
!define SELECT_SECTION `!insertmacro _SELECT_SECTION`<br />
<br />
(Messageboxes are for Debug!)<br />
<br />
Section &quot;-un.Component1&quot; UNSEC_Component1<br />
	MessageBox MB_OK &quot;Removing Component1&quot;<br />
SectionEnd<br />
<br />
Function un.onInit<br />
	${SELECT_SECTION} &quot;${REGKEY}\Components&quot; &quot;Component1&quot; UNSEC_Component1<br />
FunctionEnd<br />
<br />
	<br />
<br />
Now i get all the needed MessageBoxes from the macro telling me the section is selected but it never executes the section....<br />
<br />
Any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">{_trueparuex^}</div><div class="date">22nd November 2012, 21:30</div></div><div class="posttext">The way you pass the section ID to the SelectSection and UnselectSection macro is wrong. You call the macros with the name of the define, that contains the section ID, instead of calling the macros with the value of the define.<br />
<br />
Either call your macro this way:<br />
${SELECT_SECTION} &quot;${REGKEY}\Components&quot; &quot;Component1&quot; ${UNSEC_Component1}<br />
<br />
Or, change you macro to call the SelectSection and UnselectSection this way:<br />
!insertmacro SelectSection &quot;${${SECTION_ID}}&quot;<br />
<br />
PaR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xbarns</div><div class="date">22nd November 2012, 21:43</div></div><div class="posttext">PaR<br />
<br />
we have a saying here that roughly translates to<br />
<br />
&quot;I didn't see the forest because of all the trees...&quot;<br />
<br />
I was so convinced that the last parameter is right that i didn't even bother to look into it, now that you have mentioned it i remember having other installers where i work with sections and ${} around the ID.<br />
<br />
Thanks a lot!<br />
<br />
x</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>