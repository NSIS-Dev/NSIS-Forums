<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Question on inner workings of InstallLib, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Question on inner workings of InstallLib NSIS Discussion" />
	
	<title> Question on inner workings of InstallLib [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Question on inner workings of InstallLib</div>
<hr />
<div class="pda"><a href="t-240812.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=240812">Question on inner workings of InstallLib</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">14th March 2006, 14:45</div></div><div class="posttext">Say I do the following:<br />
<br />
<br />
&lt;!------------------Snip------------------&gt;<br />
Section &quot;Install&quot;<br />
  ;Install Files<br />
  SetOutPath $INSTDIR<br />
  SetCompress Auto<br />
  SetOverwrite IfNewer<br />
  File /r &quot;.\myDll.dll&quot;<br />
<br />
;un and re Register DLL's...<br />
  IfFileExists &quot;$INSTDIR\myDll.dll&quot; 0 +2<br />
    StrCpy $ALREADY_INSTALLED 1<br />
<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED NOREBOOT_NOTPROTECTED .\myDll.dll $INSTDIR\myDll.dll %TEMP%<br />
<br />
SectionEnd<br />
&lt;!----------------End Snip------------------&gt;<br />
<br />
First, &quot;File /r&quot; will write over the VB6 dll that's already there.  Next InstallLib will come around and try to unregister and register the dll that I've put in his place.  Is InstallLib able to uninstall (regsvr32 /u) a dll that's already been deleted?  Am I doing this wrong?<br />
<br />
Thanks Much,<br />
Eric</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th March 2006, 14:57</div></div><div class="posttext">InstallLib both extracts and registers the DLL. You shouldn't extract it on your own before calling InstallLib.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">14th March 2006, 15:18</div></div><div class="posttext">Cool, thanks!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>