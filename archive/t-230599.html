<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NTLDR is missing!!!!, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NTLDR is missing!!!! NSIS Discussion" />
	
	<title> NTLDR is missing!!!! [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NTLDR is missing!!!!</div>
<hr />
<div class="pda"><a href="t-230599.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=230599">NTLDR is missing!!!!</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">BattyNDN</div><div class="date">10th November 2005, 03:28</div></div><div class="posttext">Hi everyone.<br />
<br />
While testing an installer built by NSIS, I got the error <br />
<br />
NTLDR is missing<br />
Press Ctrl+Alt+Delete to Restart<br />
<br />
What possible scenarios could cause this error to occur. It occurs not one time after installation, but after 10 or so install/uninstalls. Could it be involved in writing to the registry and deleting specific registry keys? I know this is quite a vague question but I don't know where to begin with this issue.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">10th November 2005, 05:12</div></div><div class="posttext">I have had this same problem before (recently in fact. It happened when I was trying to compile an example script made with the experience ui. I finally got it to run but with no pages and this must have deleted the files). NTLDR stands for NT file system loader. This file is in the root directory with a few other files (io.sys, msdos.sys, detect.com). I found out (using someone elses computer with windows xp) that the file system is intact, it is just that startup is missing this file. I recommend backing up all of your personal stuff and reinstall windows (if you have that luxury). Hey, I had to do it (I also found out that setup deletes the files in the my documents folder. The folders are still there but the files are gone - even copying and renaming the folder on the same drive does not work - poor me, I lost all my documents, music, and videos). <br />
<br />
Before you reinstall windows (if you have that luxury), you could try copying the NTLDR file from someone elses computer that has the NT file system.<br />
<br />
Hope this helps.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th November 2005, 08:59</div></div><div class="posttext">This would have been caused if you did a Delete &quot;*.*&quot; by giving it  a relative path rather than a full path.<br />
NTLDR is a file that sits on the root of your system HDD and without it your PC will not boot.<br />
I fixed it by installing Windows on another HDD and then creating a new NTLDR file on my original HDD.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">10th November 2005, 15:17</div></div><div class="posttext">Maybe it is a good idea to test your new scrips on a virtual PC installed on your developing machine instead of directly on your developers machine. Just do not change settings and restart the virtual PC for another test round.<br />
<br />
If you make a shared folder where the install.exe lands you do not even move files around.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dandaman32</div><div class="date">10th November 2005, 16:15</div></div><div class="posttext">I have never heard of such an issue as this but I will look into it and see what I can do.  What example script are you compiling?  The main ExperienceUI setup program does not use a &quot;Delete *.*&quot; but it deletes every file individually on a whitelist basis.<br />
<br />
Edit: I have noticed that on several different machines, with different configurations, all files in root of C: are deleted when Windows Media Slayer is launched for the first time.  This took place on new installations of Win2k Pro with no SPs, and WinXP Home SP1, nothing else installed yet.  If you haven't snooped around your WinXP cd at all, all of the i386\*.??_ files are compressed CAB files that can be unzipped with Recovery Console's EXPAND command.  NTLDR is not compressed however, so you can simply pop in your XP cd, start Recovery Console, and copy the CD's i386\NTLDR file to C:<br />
<br />
BattyNDN, did the installer that you were having trouble with use the ExperienceUI?  If so, was it one of the example installers or was it an installer for a real program?<br />
<br />
This looks like a rather big issue, so I will work on it hard and see what I can find.<br />
<br />
-dandaman32</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">13th November 2005, 01:00</div></div><div class="posttext">&gt;&gt; What possible scenarios could cause this error to occur<br />
<br />
Listen to me - pls - you have an undeclared variable such as <br />
<br />
$PLUGINSDIR<br />
<br />
and if you have that<br />
<br />
Function .onGUIEnd<br />
  Delete $PLUGINSDIR\*.*<br />
  RMdir $PLUGINSDIR<br />
<br />
and it NOT declared that var is set to System-Root.<br />
<br />
Thats a minor bug and annoying &quot;feature&quot; that NSIS dont<br />
verify all vars in sc. :/<br />
<br />
hth</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">13th November 2005, 02:45</div></div><div class="posttext">I have a sanity checking function for that... need to wikify it...<br />
<br />
Done: http://nsis.sourceforge.net/IsRoot_-_check_whether_path_results_in_root<br />
<br />
Things missing is checking for things like &quot;..&quot; in the path... not too sure yet how to deal with that - such paths tend to be 'deliberate' rather than the result of e.g. missing data or typos, which the sanity check is really intended for.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">15th November 2005, 00:40</div></div><div class="posttext">I was using the Windows Notepad example script. It would not compile the first time so I started commenting out the lines where the compile would freeze. After running it, I found I couldn't boot my system again. Just started tinkering again and found out that it was file /oname=$PLUGINSDIR\filename.bmp &quot;${XPUI_${UNINSTALLER}LEFTLOGO} in GUIINIT that was causing it to not compile. Taking out the defined uninstaller created another error: cannot open include file system.nsh. After commenting out this line, I was shown a nice Experience UI installer for the first time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dandaman32</div><div class="date">15th November 2005, 04:25</div></div><div class="posttext">JasonFriday13 wrote:<br />
Just started tinkering again and found out that it was file /oname=$PLUGINSDIR\filename.bmp &quot;${XPUI_${UNINSTALLER}LEFTLOGO} in GUIINIT that was causing it to not compile.<br />
Ah - I think I see what happened here: XPUI.nsh, around line 1588<br />
<br />
  !insertmacro XPUI_DEFAULT XPUI_UNLEFTLOGO `${XPUI_LEFTLOGO}`<br />
  !insertmacro XPUI_DEFAULT XPUI_HEADERIMAGE `${NSISDIR}\\Contrib\\ExperienceUI\\Skins\\Default\\Header.bmp`<br />
  !insertmacro XPUI_DEFAULT XPUI_UNHEADERIMAGE `${XPUI_HEADERIMAGE}`<br />
  !insertmacro XPUI_DEFAULT XPUI_BOTTOMIMAGE_BMP `${NSISDIR}\\Contrib\\ExperienceUI\\Skins\\Default\\Bottom.bmp`<br />
  !insertmacro XPUI_DEFAULT XPUI_UNBOTTOMIMAGE_BMP `${XPUI_BOTTOMIMAGE_BMP}`<br />
  !ifdef XPUI_PAGE_BGIMAGE<br />
    !insertmacro XPUI_DEFAULT XPUI_PAGE_BGIMAGE_BMP    `${NSISDIR}\\Contrib\\ExperienceUI\\Skins\\Default\\Page.bmp`<br />
    !insertmacro XPUI_DEFAULT XPUI_LEFTLOGO `${NSISDIR}\\Contrib\\ExperienceUI\\Skins\\Default\\lb_page.bmp`<br />
  !else<br />
    !insertmacro XPUI_DEFAULT XPUI_LEFTLOGO `${NSISDIR}\\Contrib\\ExperienceUI\\Skins\\Default\\LeftBranding.bmp`<br />
  !endif<br />
<br />
Should be:<br />
<br />
  !ifdef XPUI_PAGE_BGIMAGE<br />
    !insertmacro XPUI_DEFAULT XPUI_PAGE_BGIMAGE_BMP    `${NSISDIR}\\Contrib\\ExperienceUI\\Skins\\Default\\Page.bmp`<br />
    !insertmacro XPUI_DEFAULT XPUI_LEFTLOGO `${NSISDIR}\\Contrib\\ExperienceUI\\Skins\\Default\\lb_page.bmp`<br />
  !else<br />
    !insertmacro XPUI_DEFAULT XPUI_LEFTLOGO `${NSISDIR}\\Contrib\\ExperienceUI\\Skins\\Default\\LeftBranding.bmp`<br />
  !endif<br />
  !insertmacro XPUI_DEFAULT XPUI_UNLEFTLOGO `${XPUI_LEFTLOGO}`<br />
  !insertmacro XPUI_DEFAULT XPUI_HEADERIMAGE `${NSISDIR}\\Contrib\\ExperienceUI\\Skins\\Default\\Header.bmp`<br />
  !insertmacro XPUI_DEFAULT XPUI_UNHEADERIMAGE `${XPUI_HEADERIMAGE}`<br />
  !insertmacro XPUI_DEFAULT XPUI_BOTTOMIMAGE_BMP `${NSISDIR}\\Contrib\\ExperienceUI\\Skins\\Default\\Bottom.bmp`<br />
  !insertmacro XPUI_DEFAULT XPUI_UNBOTTOMIMAGE_BMP `${XPUI_BOTTOMIMAGE_BMP}`<br />
<br />
I'm not sure, but there may have been a hidden &quot;feature&quot; in 1.1M3 that was not yet documented but nevertheless existed (maybe - still not sure if it made it or not :shrug:) that used a bitmap behind the page area.  Truth is, that demanded a new Left Logo in order to work.  I needed to check the state of the background image (XPUI_PAGE_BGIMAGE) and change the Left Logo accordingly.  This script should fix it.<br />
<br />
Edit: Also removed $PLUGINSDIR cleaning, I'll let NSIS do it for me.<br />
<br />
For more information, see this forum thread (http://xpui.sourceforge.net/forum/viewtopic.php?p=10).<br />
<br />
-dandaman32</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dandaman32</div><div class="date">15th November 2005, 04:53</div></div><div class="posttext">JasonFriday13 wrote:<br />
Taking out the defined uninstaller created another error: cannot open include file system.nsh<br />
<br />
System.nsh is just a pointer to the SysFunc.nsh included with NSIS.  File attached.  Will include System.nsh in 1.1.<br />
<br />
-dandaman32</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ntldrismissing</div><div class="date">17th November 2005, 07:49</div></div><div class="posttext">Missing registry keys (or a damaged registry) will not cause the &quot;NTLDR is missing&quot; error.  The NTLDR is called before the registry when your computer gets booted.<br />
<br />
Microsoft mentions in KB article 320397 that if to many files are added and then removed from the root of the system disk, the MFT will become fragmented and the entry that points to the NTLDR will be in the &quot;second allocution index&quot;.  Which apparently is a problem.<br />
<br />
If anyone happens to be coming here looking for a fix for this error might I humbly suggest:<br />
<br />
http://ntldrismissing.com/<br />
<br />
You can use it to create a boot disk to get you back into Windows where you can back up your data and attempt further troubleshooting from a more familiar environment.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">17th November 2005, 09:42</div></div><div class="posttext">Thanks, I will put a link to that on my website for future reference if that is OK<br />
<br />
-Stu :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ntldrismissing</div><div class="date">18th November 2005, 05:41</div></div><div class="posttext">No problem, feel free to link all you like.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>