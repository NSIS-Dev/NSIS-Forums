<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ending a running exe, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ending a running exe NSIS Discussion" />
	
	<title> ending a running exe [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ending a running exe</div>
<hr />
<div class="pda"><a href="t-147585.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=147585">ending a running exe</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">khal_nayak</div><div class="date">30th August 2003, 10:11</div></div><div class="posttext">i have a small application which keeps running with windows but if i wanna provide an update for it, i cant replace the exe file as it will be running. is there any way i can end task it through NSIS or some way i can remove the registry entry and then restart the installer to continue with the rest of the installation?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th August 2003, 12:01</div></div><div class="posttext">There are so many forum threads discussing this... Please search the forum. Here's one for example:<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=128743</div></div><hr />


<div class="post"><div class="posttop"><div class="username">khal_nayak</div><div class="date">30th August 2003, 22:18</div></div><div class="posttext">i have read all those threads bout killing an application but all dont seem the ideal way of doing it. Is it possible to pass certain parameters to the insaller so that i can make it detect if the older version of the application is running then ask the user to restart the pc and mean while remove the entry from the registry so the application doesnt run again, then after restarting, the installer should continue from where it left not asking the user to click anything or do anything and deleting the older file and replacing it with the new. the main thing that i want is to be able to pass some parameters to the installer so when it restarts, it comes in the silent install mode and complete the rest of the updating. the other way is to re run the installer and ask the user for all the details again, if some switches were written then it can do specified tasks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st August 2003, 11:21</div></div><div class="posttext">Assuming you can't close the application and that you must reboot, you can use $CMDLINE to check the command line parameters passed on to the installer. To make the installer start up silent all you need to do is pass /S and NSIS will take care of the rest. To check if the installer is silent by command line you can use IsSilent (http://nsis.sourceforge.net/archive/viewpage.php?pageid=79). To get the command line parameters alone, without the executable path use GetParameters (http://nsis.sourceforge.net/Docs/AppendixB.html#B.3).<br />
<br />
If I were you I would try to avoid the reboot and seek a way to close the process that doesn't involve TerminateProcess. Maybe if you specify the application you're trying to close someone can help you with it. If it is a service you can use Sunjammer's services handler plug-in from the archive's downloads page (http://nsis.sourceforge.net/archive/download.php).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">khal_nayak</div><div class="date">2nd September 2003, 11:15</div></div><div class="posttext">can u plz type some code for me to check if a file is open or running, meaning locked or not</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd September 2003, 11:23</div></div><div class="posttext">It's very simple, just try to open it using FileOpen.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">khal_nayak</div><div class="date">2nd September 2003, 14:44</div></div><div class="posttext">i tried to use that same command but wasnt able to get the installer compiled as some problem with the variables. i would appreciate it if u just typed that 3  to 4 line code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd September 2003, 14:48</div></div><div class="posttext">Here's one:<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=137714&amp;highlight=fileopen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">khal_nayak</div><div class="date">2nd September 2003, 14:51</div></div><div class="posttext">thanx m8</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>