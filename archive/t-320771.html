<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" RequestExecutionLevel problem..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  RequestExecutionLevel problem... NSIS Discussion" />
	
	<title> RequestExecutionLevel problem... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  RequestExecutionLevel problem...</div>
<hr />
<div class="pda"><a href="t-320771.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=320771">RequestExecutionLevel problem...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Pawel</div><div class="date">13th July 2010, 17:19</div></div><div class="posttext">Hi,<br />
I got problem with NSIS &quot;RequestExecutionLevel&quot; command.<br />
<br />
Could someone explain me why do I need that (on Win7, Vista)?<br />
<br />
I always use RequestExecutionLevel &quot;admin&quot;. Thanks to this, I could do with my installer things with admin rights (as I understand it).<br />
<br />
But, there is a problem. I am logged in on Normal User account with UAC enabled.<br />
When I use this: RequestExecutionLevel &quot;admin&quot; Windows prompt for admin password.<br />
OK. <br />
Now, I want to check what is the result of $Appdata variable. Let's see below example:<br />
<br />
Function .oninit<br />
   MessageBox MB_OK &quot;$Appdata&quot;<br />
FunctionEnd<br />
<br />
<br />
As a result I got Appdata path for Admin user(!) (not an account that I am logged in).<br />
Should be: C:\Users\Pawel_StandardUser\AppData<br />
I got: C:\Users\Pawel\AppData   (my admin account)<br />
<br />
Is this normal? if I request admin, I am logged in as Administrator? How can I get then appdata path of account that I am logged in...<br />
<br />
If I use here RequestExecutionLevel &quot;user&quot; or &quot;highest&quot; the result path is OK...<br />
Please, anybody give me some explanation... i am totally lost...<br />
<br />
Thanks,<br />
-Pawel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">14th July 2010, 00:08</div></div><div class="posttext">http://forums.winamp.com/showthread.php?threadid=285047</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pawel</div><div class="date">14th July 2010, 01:23</div></div><div class="posttext">Uff, UAC hell..<br />
Thx<br />
-Pawel</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>