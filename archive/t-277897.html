<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" 3 bugs with MUI 2.0, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  3 bugs with MUI 2.0 NSIS Discussion" />
	
	<title> 3 bugs with MUI 2.0 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  3 bugs with MUI 2.0</div>
<hr />
<div class="pda"><a href="t-277897.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277897">3 bugs with MUI 2.0</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">abu_abdulla</div><div class="date">25th September 2007, 14:38</div></div><div class="posttext">Hi,<br />
<br />
before stating the problems here is the code (Ver 2.30, rtl.bmp is attached, I'm using Win XP SP2):<br />
<br />
<br />
<br />
!include &quot;MUI.nsh&quot;<br />
<br />
  !define MUI_HEADERIMAGE<br />
  !define MUI_HEADERIMAGE_BITMAP &quot;rtl.bmp&quot;<br />
  !define MUI_HEADERIMAGE_BITMAP_NOSTRETCH<br />
  !define MUI_HEADERIMAGE_BITMAP_RTL &quot;rtl.bmp&quot;<br />
  !define MUI_HEADERIMAGE_BITMAP_RTL_NOSTRETCH<br />
  !define MUI_HEADERIMAGE_UNBITMAP &quot;rtl.bmp&quot;<br />
  !define MUI_HEADERIMAGE_UNBITMAP_NOSTRETCH<br />
  !define MUI_HEADERIMAGE_UNBITMAP_RTL &quot;rtl.bmp&quot;<br />
  !define MUI_HEADERIMAGE_UNBITMAP_RTL_NOSTRETCH<br />
  !define MUI_ABORTWARNING<br />
<br />
OutFile &quot;demo.exe&quot;<br />
<br />
InstallDir &quot;$PROGRAMFILES\Demo&quot;<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
!insertmacro MUI_LANGUAGE &quot;Arabic&quot;<br />
<br />
Name &quot;Demo&quot;<br />
<br />
Function .onInit<br />
	!insertmacro MUI_LANGDLL_DISPLAY<br />
FunctionEnd<br />
<br />
  ;!insertmacro MUI_PAGE_WELCOME<br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  <br />
  ;!insertmacro MUI_UNPAGE_WELCOME<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_UNPAGE_INSTFILES<br />
 <br />
Section &quot;Demo&quot;<br />
<br />
  SetOutPath $INSTDIR<br />
  <br />
  ; Put file there<br />
  WriteUninstaller &quot;$INSTDIR\uninstall.exe&quot;<br />
<br />
SectionEnd<br />
<br />
Section &quot;Start Menu Shortcuts&quot;<br />
  <br />
  CreateDirectory &quot;$SMPROGRAMS\Demo&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\Demo\Uninstall.lnk&quot; &quot;$INSTDIR\uninstall.exe&quot; &quot;&quot; &quot;$INSTDIR\uninstall.exe&quot; 0<br />
<br />
SectionEnd<br />
<br />
Section &quot;Uninstall&quot;<br />
  <br />
  RMDir /r &quot;$SMPROGRAMS\Demo&quot;<br />
  RMDir /r &quot;$INSTDIR&quot;<br />
<br />
SectionEnd<br />
<br />
<br />
<br />
Now to the problems:<br />
<br />
1 - Uninstall bmp image is not shown when uninstalling.<br />
2 - When selecting arabic language the header image is not shown fully (just part of it). I have reported this in:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=277846<br />
<br />
3 - Remove the comments for MUI_PAGE_WELCOME  &amp;  MUI_UNPAGE_WELCOME and the compiler will report these errors:<br />
<br />
<br />
<br />
Error: resolving uninstall function &quot;un.Nsis2Io&quot; in function &quot;un.mui.WelcomePre_43.7.5.9&quot;<br />
Note: uninstall functions must begin with &quot;un.&quot;, and install functions must not<br />
Error - aborting creation process<br />
<br />
<br />
<br />
Please help. thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nvit</div><div class="date">25th September 2007, 14:49</div></div><div class="posttext">Originally posted by abu_abdulla <br />
Hi,<br />
<br />
before stating the problems here is the code (Ver 2.30, rtl.bmp is attached, I'm using Win XP SP2):<br />
<br />
<br />
<br />
!include &quot;MUI.nsh&quot;<br />
<br />
<br />
<br />
Please help. thanks  <br />
<br />
If you use MUI2 you should change your code to:<br />
<br />
<br />
!include MUI2.nsh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">abu_abdulla</div><div class="date">26th September 2007, 06:27</div></div><div class="posttext">Thanks for the comment. I did this but the image now is not shown at all. In addition the language choice frame is not displayed also.<br />
<br />
The code again since [PHP] tag removes '\'<br />
<br />
<br />
<br />
!include &quot;MUI2.nsh&quot;<br />
<br />
  !define MUI_HEADERIMAGE<br />
  !define MUI_HEADERIMAGE_BITMAP &quot;rtl.bmp&quot;<br />
  !define MUI_HEADERIMAGE_BITMAP_NOSTRETCH<br />
  !define MUI_HEADERIMAGE_BITMAP_RTL &quot;rtl.bmp&quot;<br />
  !define MUI_HEADERIMAGE_BITMAP_RTL_NOSTRETCH<br />
  !define MUI_HEADERIMAGE_UNBITMAP &quot;rtl.bmp&quot;<br />
  !define MUI_HEADERIMAGE_UNBITMAP_NOSTRETCH<br />
  !define MUI_HEADERIMAGE_UNBITMAP_RTL &quot;rtl.bmp&quot;<br />
  !define MUI_HEADERIMAGE_UNBITMAP_RTL_NOSTRETCH<br />
  !define MUI_ABORTWARNING<br />
<br />
OutFile &quot;demo.exe&quot;<br />
<br />
InstallDir &quot;$PROGRAMFILES\Demo&quot;<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
!insertmacro MUI_LANGUAGE &quot;Arabic&quot;<br />
<br />
Name &quot;Demo&quot;<br />
<br />
Function .onInit<br />
    !insertmacro MUI_LANGDLL_DISPLAY<br />
FunctionEnd<br />
<br />
  ;!insertmacro MUI_PAGE_WELCOME<br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  <br />
  ;!insertmacro MUI_UNPAGE_WELCOME<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
Section &quot;Demo&quot;<br />
<br />
  SetOutPath $INSTDIR<br />
  <br />
  ; Put file there<br />
  WriteUninstaller &quot;$INSTDIR\uninstall.exe&quot;<br />
<br />
SectionEnd<br />
<br />
Section &quot;Start Menu Shortcuts&quot;<br />
  <br />
  CreateDirectory &quot;$SMPROGRAMS\Demo&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\Demo\Uninstall.lnk&quot; &quot;$INSTDIR\uninstall.exe&quot; &quot;&quot; &quot;$INSTDIR\uninstall.exe&quot; 0<br />
<br />
SectionEnd<br />
<br />
Section &quot;Uninstall&quot;<br />
  <br />
  RMDir /r &quot;$SMPROGRAMS\Demo&quot;<br />
  RMDir /r &quot;$INSTDIR&quot;<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">abu_abdulla</div><div class="date">28th September 2007, 18:51</div></div><div class="posttext">Does this happens only to me? or is there anything missing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th September 2007, 19:14</div></div><div class="posttext">You have inserted the page macros after the language macros. The language macros must be inserted after the page macros.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">abu_abdulla</div><div class="date">29th September 2007, 07:31</div></div><div class="posttext">Thanks so much kichik for your comment. Problems 1 &amp; 3 are solved by this.<br />
On the other hand, problem 2 is still which is in case of selecting Arabic language (RTL language) the header image is not shown fully (just part of it) although I'm using MUI_HEADERIMAGE_BITMAP_RTL_NOSTRETCH.<br />
<br />
This is the code again after the modification (image is attached in the first post):<br />
<br />
<br />
<br />
!include &quot;MUI.nsh&quot;<br />
<br />
  !define MUI_HEADERIMAGE<br />
  !define MUI_HEADERIMAGE_BITMAP &quot;rtl.bmp&quot;<br />
  !define MUI_HEADERIMAGE_BITMAP_NOSTRETCH<br />
  !define MUI_HEADERIMAGE_BITMAP_RTL &quot;rtl.bmp&quot;<br />
  !define MUI_HEADERIMAGE_BITMAP_RTL_NOSTRETCH<br />
  !define MUI_HEADERIMAGE_UNBITMAP &quot;rtl.bmp&quot;<br />
  !define MUI_HEADERIMAGE_UNBITMAP_NOSTRETCH<br />
  !define MUI_HEADERIMAGE_UNBITMAP_RTL &quot;rtl.bmp&quot;<br />
  !define MUI_HEADERIMAGE_UNBITMAP_RTL_NOSTRETCH<br />
  !define MUI_ABORTWARNING<br />
<br />
OutFile &quot;demo.exe&quot;<br />
<br />
InstallDir &quot;$PROGRAMFILES\Demo&quot;<br />
<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!insertmacro MUI_PAGE_INSTFILES<br />
<br />
!insertmacro MUI_UNPAGE_CONFIRM<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
!insertmacro MUI_LANGUAGE &quot;Arabic&quot;<br />
<br />
Name &quot;Demo&quot;<br />
<br />
Function .onInit<br />
    !insertmacro MUI_LANGDLL_DISPLAY<br />
FunctionEnd<br />
<br />
Section &quot;Demo&quot;<br />
<br />
  SetOutPath $INSTDIR<br />
  <br />
  ; Put file there<br />
  WriteUninstaller &quot;$INSTDIR\uninstall.exe&quot;<br />
<br />
SectionEnd<br />
<br />
Section &quot;Start Menu Shortcuts&quot;<br />
  <br />
  CreateDirectory &quot;$SMPROGRAMS\Demo&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\Demo\Uninstall.lnk&quot; &quot;$INSTDIR\uninstall.exe&quot; &quot;&quot; &quot;$INSTDIR\uninstall.exe&quot; 0<br />
<br />
SectionEnd<br />
<br />
Section &quot;Uninstall&quot;<br />
  <br />
  RMDir /r &quot;$SMPROGRAMS\Demo&quot;<br />
  RMDir /r &quot;$INSTDIR&quot;<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th September 2007, 10:10</div></div><div class="posttext">Still can't reproduce. Include screenshots and rtl.bmp as requested in the original thread.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">abu_abdulla</div><div class="date">29th September 2007, 16:01</div></div><div class="posttext">screen shot is attached<br />
<br />
rtl.bmp:<br />
http://forums.winamp.com/attachment.php?s=&amp;postid=2242144</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th September 2007, 16:06</div></div><div class="posttext">That's exactly what's supposed to happen. The header image shouldn't be that large, it should be 150x57. When you use RTL, those 150x57 will start on the right side and so your overflow will go over the right edge of the screen.<br />
<br />
To have the image cover the entire header, you'll have to modify the UI. Edit Contrib\UIs\modern_headerbmp.exe with Resource Hacker and move control #1046 to wherever you want the header image to be (when it's RTL, it'll just put the image on the exact opposite side). Then use MUI_UI_HEADERIMAGE to tell the MUI to load your UI instead of modern_headerbmp.exe.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>