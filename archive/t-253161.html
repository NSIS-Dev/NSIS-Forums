<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Running Processes and questsions, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Running Processes and questsions NSIS Discussion" />
	
	<title> Running Processes and questsions [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Running Processes and questsions</div>
<hr />
<div class="pda"><a href="t-253161.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=253161">Running Processes and questsions</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">solinent</div><div class="date">13th August 2006, 03:21</div></div><div class="posttext">I'm very new to this, so bear with me.  I'm trying to switch to NSIS.  I have a couple questions:<br />
<br />
Are all OCX's DLL's and TLB's registered automatically or do I have to call a function (if so which function)?<br />
<br />
I have made a script and tested it, but if my program is running it obviously cannot write to the files (since they are running).  How can I check if running processes are running and/or tell the user to stop them before continuing.  Does it need a restart?  My previous progam installer I believe it made them restart and then it installed the components that couldn't be installed.  How do I do this?<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mark Nascimento</div><div class="date">13th August 2006, 05:01</div></div><div class="posttext">I use this (win98):<br />
<br />
ClearErrors<br />
Rename C:\SomeDir\App.exe C:\SomeDir\App.exe ;If app.exe is in use, error.<br />
IfErrors 0 +3<br />
MessageBox ...(if you want)<br />
Abort ;(if you want, or do something,)<br />
<br />
I also ask IfFileExists, avoid looping. So you can GoTo top and check it again. Can also use IntOp and Sleep to limit the loopin times.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">solinent</div><div class="date">13th August 2006, 05:06</div></div><div class="posttext">So what exactly will that code do? To me (I'm VERY new even though I know a fair amount of programing languages) it lookslike this: rename the app to the same name.  If an error occured messagebox and abort.  ?<br />
<br />
Ok nevermind I think I have it figured out: (my very first true nsis code (the other was generated and edited by me)<br />
<br />
  LookForProcesses:<br />
  Processes::FindProcess &quot;RSA&quot;<br />
  ${If} $R0 == &quot;1&quot;<br />
    MessageBox MB_OKCANCEL &quot;The ********* Apocalypse Client is still running.  It will now be stopped\n\r to continue with the installation.&quot; IDOK CloseProcess IDCANCEL Aborter<br />
      CloseProcess:<br />
        Processes::KillProcess &quot;RSA&quot;<br />
        Goto Next<br />
      Aborter:<br />
        MessageBox MB_OK &quot;Setup Failed.  Please close all windows and try again.&quot;<br />
        Abort<br />
      Next:<br />
      ${If} $R0 == '0'<br />
        MessageBox MB_OKCANCEL &quot;Failed to Close.  Please try to close with the Task Manager or manually and press OK or press Cancel to stop installation&quot; IDOK LookForProcesses IDCANCEL Aborter<br />
      ${EndIf}<br />
  ${EndIf}<br />
<br />
<br />
Ok anyways the first message box (where I have \n\r) is getting some of the words cut out.  Is there a way around this or should I just make it shorter.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th August 2006, 11:19</div></div><div class="posttext">It's not \r\n in NSIS, it's $\r$\n.<br />
You are better off using the FCT plugin (http://nsis.sf.net/FCT_plug-in) for this. It tries to close the program first and then only terminates it after a confirmation message box.<br />
<br />
See Appendix B (http://nsis.sourceforge.net/Docs/AppendixB.html) of the NSIS manual for DLL/TLB installation and uninstallation.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">solinent</div><div class="date">13th August 2006, 12:23</div></div><div class="posttext">I need help with that plugin.  Also where do I put the includemacro?  Could you give me an example usage for that plugin if I want it to close rsa.exe?<br />
<br />
EDIT: I've figured that includemacro goes in the section part after file.  Finding a starting point in NSIS was hard, literally.  In the help files there should be something along the lines of:<br />
<br />
Structure of a basic install<br />
-declarations<br />
-macros<br />
-Following lines to define nsis variables<br />
<br />
Name &quot;${PRODUCT_NAME} ${PRODUCT_VERSION}&quot;<br />
OutFile &quot;install.exe&quot;<br />
InstallDir &quot;$PROGRAMFILES\ProductName&quot;<br />
InstallDirRegKey HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot;<br />
ShowInstDetails show<br />
ShowUnInstDetails show<br />
<br />
-Sections to define extraction from exe and to define copy from outside files, script and custom elements here.<br />
<br />
Section MainProgram<br />
SetOutPath &quot;$INSTDIR&quot; ;file on user system, destination, other values listed below<br />
SetOverwrite on ;other values listed below<br />
File &quot;myprog.exe&quot; ;file on build system, if on drive c would conform to C:\myprog.exe<br />
<br />
End Section<br />
<br />
Section Uninstall<br />
;uninstall section use delete and RMDIR (For directories) to delete files<br />
<br />
End Section<br />
<br />
-here I would put a list of constants and stuff (like where $INSTDIR is and where $SYSDIR is etc.<br />
<br />
It would help newbies like me to quickly start making an installer.  I had to go through some random help files and make an installer (bad generated code BTW) with HM NIS edit.<br />
<br />
Anyways thanks so far but I still don't get that plugin you described.  Does it look for window titles? hWnds? What defines what it looks for.  Doesn't seem to have a EXE file paramater.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">13th August 2006, 15:49</div></div><div class="posttext">PLug-in finds application by it's window, 2 string parameters - window title and class. Can find by title or class substring. First sends WM_CLOSE to all windows found, after this (if application still alive) terminates program. To get window class string you can use spyxx.exe (included to MS VS). Put included to zip dll to NSIS/plugins folder before installer compile.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>