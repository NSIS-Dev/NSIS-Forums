<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Shortcut issue, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Shortcut issue NSIS Discussion" />
	
	<title> Shortcut issue [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Shortcut issue</div>
<hr />
<div class="pda"><a href="t-290471.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=290471">Shortcut issue</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pld32</div><div class="date">18th April 2008, 15:46</div></div><div class="posttext">I'm trying to create a shortcut in my install folder based on my .exe<br />
<br />
CreateShortCut &quot;$INSTDIR\myapp\myapp.lnk&quot; \<br />
$INSTDIR\myapp.exe&quot; \<br />
&quot;MC Data Backup&quot; &quot;&quot; &quot;&quot; SW_SHOWNORMAL \<br />
ALT|CTRL|SHIFT|F5 &quot;myapp MC&quot;<br />
<br />
No shortcut is created. If I change &quot;$INSTDIR\myapp\myapp.lnk&quot;<br />
to &quot;$SMPROGRAMS\myapp\myapp.lnk&quot; it works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th April 2008, 15:51</div></div><div class="posttext">Does $INSTDIR\myapp exist?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pld32</div><div class="date">18th April 2008, 15:59</div></div><div class="posttext">SetOutPath &quot;$INSTDIR&quot;<br />
  SetOverwrite try<br />
  CreateDirectory &quot;$SMPROGRAMS\iNetBackup&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\iNetBackup\iNetBackup.lnk&quot;           &quot;$INSTDIR\iNetBackup.exe&quot;<br />
  File /r /x *.ico &quot;H:\iNetBackup Install\*.*&quot;<br />
<br />
I would say yes. This is the code prior to the shortcut command. when my setup.exe is completed every thing is fine except no shortcut.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th April 2008, 16:13</div></div><div class="posttext">Do you have access to write there? Are you sure nothing deletes it later in the script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pld32</div><div class="date">18th April 2008, 16:19</div></div><div class="posttext">I have admin rights.<br />
nothing gets deleted in my setup.exe until the uninstall is run but @ this time I'm not deleting the shortcut.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th April 2008, 16:29</div></div><div class="posttext">It's not Vista, is it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pld32</div><div class="date">18th April 2008, 16:32</div></div><div class="posttext">no xps sp2</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th April 2008, 16:36</div></div><div class="posttext">Check if the error flag is set using ClearErrors and IfErrors. Also try checking if the file exists right after it's created using IfFileExists. Maybe something else deletes it later down the road.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pld32</div><div class="date">18th April 2008, 17:25</div></div><div class="posttext">Thank you for your help. Sorry to have bothered u it was a stupid typo error. Just did not see it.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>