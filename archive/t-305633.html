<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" My plugin isn't loaded, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  My plugin isn't loaded NSIS Discussion" />
	
	<title> My plugin isn't loaded [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  My plugin isn't loaded</div>
<hr />
<div class="pda"><a href="t-305633.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305633">My plugin isn't loaded</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jeusdi</div><div class="date">23rd April 2009, 08:02</div></div><div class="posttext">Hello forum.<br />
<br />
   I've developed my plugin. I copy the dll file on NSIS_INSTALL/Plugins and compile my script. When I perform the installer, it tells me that the dll can't be loaded:<br />
<br />
http://i16.photobucket.com/albums/b45/jeusdi/NSIS2.png<br />
<br />
Can you help me about?<br />
I will appreciate your help a lot.<br />
<br />
My C++ main code:<br />
<br />
<br />
#include &lt;windows.h&gt;<br />
#include &quot;NSIS/pluginapi.h&quot;<br />
//#include &quot;gSOAP/InstWs.h&quot;<br />
#include &quot;plugin.h&quot;<br />
<br />
HINSTANCE g_hInstance;<br />
BOOL WINAPI DllMain(HANDLE hInst, ULONG ul_reason_for_call, LPVOID lpReserved)<br />
{<br />
    g_hInstance = hInst;<br />
	return TRUE;<br />
}<br />
<br />
/***************************************************************************************<br />
* Function: GmCaptureEx::ActivateLicence (exported)<br />
* Description:<br />
*    Activates and retrieves from a WS a licence. This licence is saved on a file.<br />
* Parameters:<br />
*    - licence_type_code: The licence type code.<br />
*    - customer_code:     The customer code.<br />
*    - customer_passwd:   The customer password.<br />
*    - customer_mail:     The customer mail.<br />
*    - #fields:           Number of fields.<br />
*    - fields:            Parametrized fields in order to activate the licence.<br />
***************************************************************************************/<br />
NSISFunction(Activate)<br />
{<br />
	EXDLL_INIT();<br />
	{<br />
		char licence_filename[23];<br />
		params_t params;<br />
		int nfields;<br />
<br />
		ActivateLicence(&quot;licence_code&quot;, &quot;customer_code&quot;, licence_filename);<br />
<br />
		popstring(params.licence_type_code);<br />
		popstring(params.customer_code);<br />
		popstring(params.customer_passwd);<br />
		popstring(params.customer_passwd);<br />
		params.nfields = popint();<br />
		<br />
                ...<br />
<br />
		pushstring(&quot;result&quot;);<br />
	}<br />
}<br />
<br />
<br />
Note: I've created the dll with Visual C++ as Win32 dynamic library. This library uses other library. When I build the projects these generates their *.dll and *.lib files. I've tried to copy these ones together with the plugin dll, however, it doesn't work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">23rd April 2009, 14:38</div></div><div class="posttext">Since is C++, you need on &quot;extern&quot; on each exported function of the DLL:<br />
<br />
extern &quot;C&quot; __declspec( dllexport ) SomeFunction (...) {}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">24th April 2009, 00:10</div></div><div class="posttext">I guess NSISFunction is defined somewhere (in plugin.h?) as extern &quot;C&quot; blabla.<br />
<br />
What happens when you compile the exdll example which comes with NSIS?<br />
Can you load that plugin?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">24th April 2009, 00:14</div></div><div class="posttext">actually extern &quot;C&quot; is not needed.<br />
I use the following without problems:<br />
#define NSISFunction(funcname) void __declspec(dllexport) funcname(HWND hwndParent, int string_size, TCHAR *variables, stack_t **stacktop, extra_parameters *extra)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>