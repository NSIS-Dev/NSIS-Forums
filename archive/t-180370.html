<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Ending the installer in a modern UI, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Ending the installer in a modern UI NSIS Discussion" />
	
	<title> Ending the installer in a modern UI [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Ending the installer in a modern UI</div>
<hr />
<div class="pda"><a href="t-180370.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=180370">Ending the installer in a modern UI</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Omatase</div><div class="date">18th May 2004, 05:09</div></div><div class="posttext">This must be such an easy thing, but I can't find it in the help file or on this message board. Possibly because it's so easy noone has asked it :(.<br />
<br />
Anyway, I am trying to: <br />
1&gt; show a welcome screen using the modern UI &lt;--Working<br />
2&gt; Run a custom function on Welcome_leave &lt;--Working<br />
3&gt; Close the installer&lt;--Not working. <br />
<br />
Using the Abort command only prevents the next window from displaying. This is good. I don't want the next window to display. I also want the installer to close though.<br />
<br />
Anyway, now that I'm using the modern UI I seem to have no control over when to stop the installer. Can someone please tell me how I can close the installer when the user clicks 'Next'?<br />
<br />
Thankyou for your help in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">18th May 2004, 06:25</div></div><div class="posttext">Have you tried the quit command?<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Omatase</div><div class="date">18th May 2004, 13:34</div></div><div class="posttext">No sir I had not, but as it happens that command also doesn't produce the desired result. Let me paste the relevant code in case that will be helpful. :winamp: <br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_LEAVE &quot;WelcomePageLeave&quot;<br />
!insertmacro MUI_PAGE_WELCOME<br />
<br />
Function WelcomePageLeave<br />
<br />
    Call IsDotNETInstalled<br />
<br />
    Pop $R3<br />
<br />
    StrCmp $R3 0 +2<br />
       <br />
       MessageBox MB_OK &quot;Framework installed!&quot; ID_OK Done<br />
<br />
       ; else<br />
       MessageBox MB_OKCANCEL &quot;The Microsoft .NET Framework is required for this application. Press OK to install, press Cancel to abort.&quot; IDOK InstallNET IDCANCEL 0<br />
       Abort ;&lt;-Next page skipped<br />
       quit  ;now how do I close the installer?<br />
<br />
InstallNET:<br />
       SetOutPath &quot;$INSTDIR&quot;<br />
       SetOverwrite ifnewer<br />
       File &quot;dotnetfx.exe&quot;<br />
       ExecWait '&quot;$INSTDIRdotnetfx.exe&quot;'<br />
<br />
Done:     <br />
       <br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">18th May 2004, 14:15</div></div><div class="posttext">Remove the Abort command.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Omatase</div><div class="date">18th May 2004, 14:53</div></div><div class="posttext">All worky! TYVM!!!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>