<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" 404 error with Inetc corrupts the stack when /END is used, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  404 error with Inetc corrupts the stack when /END is used NSIS Discussion" />
	
	<title> 404 error with Inetc corrupts the stack when /END is used [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  404 error with Inetc corrupts the stack when /END is used</div>
<hr />
<div class="pda"><a href="t-263692.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=263692">404 error with Inetc corrupts the stack when /END is used</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">15th January 2007, 01:30</div></div><div class="posttext">I'm storing some registers on the stack and then using the Inetc plugin (in NSISdl mode) to download a file using an Inetc::get command which has /END at the end.<br />
<br />
If the download is successful the plugin leaves one value on the stack (OK) but if the file is not found then the plugin leaves two values on the stack (on my Win98SE system):<br />
<br />
File not found (404)<br />
/END<br />
<br />
My code checks the Inetc result by popping the result from the stack. Since my code did not expect this extra value (/END) some register corruption occurred when my code used the stack to restore the registers.<br />
<br />
As a workaround I'm checking to see if /END is left on the stack when Inetc does not return &quot;OK&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">15th January 2007, 14:03</div></div><div class="posttext">Yes, plug-in stops reading stack on error.. I'll add patch soon. Thanks, pengyou. May multi-download mode is excessive (not required in real life)? This case /end not required and it is easy to fix situation..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">15th January 2007, 14:45</div></div><div class="posttext">Thanks for the quick response.<br />
<br />
Although my installer uses Inetc to download several files it only downloads one file at a time (I've never used the multi-download mode).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">18th January 2007, 12:18</div></div><div class="posttext">The &quot;1 January 2007&quot; version of Inetc was leaving /END on the stack when it detected an error:<br />
<br />
File Not Found (404)<br />
/END<br />
data-x<br />
data-y<br />
data-z<br />
<br />
The &quot;17 January 2007&quot; version of the Inetc plugin leaves the stack with just one value on it if an error is detected:<br />
<br />
File Not Found (404)<br />
<br />
This means my installer is unable to restore the data-x, data-y and data-z values.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">18th January 2007, 12:56</div></div><div class="posttext">Sorry. Updated. Good news - popstring not crashes on null pointer ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">18th January 2007, 13:43</div></div><div class="posttext">The new &quot;18 January 2007&quot; version of Inetc solves my problem.<br />
<br />
Thanks for fixing it so quickly!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>