<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" sortcut on desktop not removed, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  sortcut on desktop not removed NSIS Discussion" />
	
	<title> sortcut on desktop not removed [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  sortcut on desktop not removed</div>
<hr />
<div class="pda"><a href="t-336821.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=336821">sortcut on desktop not removed</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Olibara</div><div class="date">1st November 2011, 08:35</div></div><div class="posttext">Hello<br />
I've made a installer script<br />
The install works fine<br />
Uninstall too<br />
<br />
However the shortcut created on the desktop is not removed (even on an XP machine)<br />
Here is the uninstall section<br />
<br />
Section Uninstall<br />
  SetShellVarContext all<br />
  Delete &quot;$INSTDIR\uninst.exe&quot;  <br />
;Desktop  <br />
  Delete &quot;$DESKTOP\Kairo.lnk&quot;<br />
;Installation directory  <br />
  Delete &quot;$INSTDIR\Kairo.url&quot;<br />
  Delete &quot;$INSTDIR\Kairo.lnk&quot;<br />
  Delete &quot;$INSTDIR\Kairo-website.url&quot;<br />
  RMDir /r &quot;$INSTDIR&quot;<br />
<br />
  ;Start Menu<br />
  Delete &quot;$SMPROGRAMS\Kairo\Kairo.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\Kairo\Uninstall.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\Kairo\Kairo-website.lnk&quot;<br />
  RMDir  &quot;$SMPROGRAMS\Kairo&quot;<br />
<br />
  DeleteRegKey HKLM &quot;Software\Kairo&quot;<br />
	${un.registerExtension} &quot;.grb&quot; &quot;Grib_Files&quot;<br />
	${un.registerExtension} &quot;.grb2&quot; &quot;Grib2_Files&quot;	<br />
  SetAutoClose true<br />
SectionEnd<br />
What can be wrong ?<br />
<br />
Thanks for any help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">1st November 2011, 10:13</div></div><div class="posttext">Either the path is incorrect (shellvar context?), or you don't have permissions (admin access), or the file is in use and locked (not very likely in this case).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Olibara</div><div class="date">1st November 2011, 10:50</div></div><div class="posttext">Thank for your Help you MSG<br />
<br />
Either the path is incorrect (shellvar context?)<br />
<br />
I use exactly the same path and ShellVar as during installSection -AdditionalIcons<br />
  SetShellVarContext all<br />
  WriteIniStr &quot;$INSTDIR\${PRODUCT_NAME}-website.url&quot; &quot;InternetShortcut&quot; &quot;URL&quot; &quot;${PRODUCT_WEB_SITE}&quot;<br />
  CreateDirectory &quot;$SMPROGRAMS\Kairo&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\Kairo\Kairo.lnk&quot; ${PRODUCT_EXE_FILE_PATH}<br />
  CreateShortCut &quot;$SMPROGRAMS\Kairo\Kairo-website.lnk&quot; &quot;$INSTDIR\${PRODUCT_NAME}-website.url&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\Kairo\Uninstall.lnk&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
SectionEnd<br />
<br />
or you don't have permissions (admin access)<br />
I don't think so it is on my XP developper machine and I have full rights<br />
<br />
or the file is in use and locked<br />
No everithing is closed when I run uninstall and I can delete it manually anyway</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">1st November 2011, 11:03</div></div><div class="posttext">Well in that code you pasted I see no desktop icon being created. I can imagine the shellvar context maybe changed before the code to create the desktop shortcut is executed?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Olibara</div><div class="date">1st November 2011, 11:41</div></div><div class="posttext">Oups !<br />
<br />
You are right : the desktop link is in another section maybe I have to move it or set ShellVarContext in the section below ??<br />
<br />
Section &quot;App Folders&quot;<br />
  SetOverwrite ifnewer<br />
<br />
  ;Include the entire Frontend directory<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  File /r &quot;${LICENSE_PATH}&quot;<br />
  <br />
  SetOutPath &quot;$INSTDIR\gdal_test\&quot;<br />
  File /r /x *.svn &quot;${PROJECT_FOLDER}\gdal_test\&quot;<br />
<br />
  SetOutPath &quot;$INSTDIR\data\&quot;<br />
  File /r /x *.svn /x templates /x test-grib &quot;${PROJECT_FOLDER}\data\&quot;<br />
  <br />
  SetOutPath &quot;$INSTDIR\Resources\&quot;<br />
  File /r /x *.svn &quot;${PROJECT_FOLDER}\Resources\&quot;<br />
  <br />
  SetOutPath &quot;$INSTDIR\Tools\&quot;<br />
  File /r /x *.svn &quot;${PROJECT_FOLDER}\Tools\&quot;<br />
<br />
  SetOutPath &quot;$INSTDIR\bin\&quot;<br />
  File /r /x *.svn /x *.pdb /x *.vshost.exe /x *.manifest /x *.config &quot;${PROJECT_FOLDER}\bin\x86\Release\&quot; <br />
  ;!!! le backslash final est indispensable pour ne pas recreer un Release sous bin<br />
  <br />
<br />
  CreateShortcut &quot;$INSTDIR\Kairo.lnk&quot; ${PRODUCT_EXE_FILE_PATH}<br />
  CreateShortCut &quot;$DESKTOP\Kairo.lnk&quot; ${PRODUCT_EXE_FILE_PATH}<br />
  ${registerExtension} &quot;$INSTDIR\bin\Kairo.exe&quot; &quot;.grb&quot; &quot;Grib_Files&quot;<br />
  ${registerExtension} &quot;$INSTDIR\bin\Kairo.exe&quot; &quot;.grb2&quot; &quot;Grib2_Files&quot;  <br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">1st November 2011, 13:37</div></div><div class="posttext">Default context is current, so yeah.  http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.7.7</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Olibara</div><div class="date">1st November 2011, 13:57</div></div><div class="posttext">Thank you very much<br />
<br />
Your help was usefull !<br />
It is working now  !</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>