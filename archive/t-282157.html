<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" mysql, long paths and quotes, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  mysql, long paths and quotes NSIS Discussion" />
	
	<title> mysql, long paths and quotes [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  mysql, long paths and quotes</div>
<hr />
<div class="pda"><a href="t-282157.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=282157">mysql, long paths and quotes</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">BerSerK6996</div><div class="date">26th November 2007, 20:58</div></div><div class="posttext">Hi,<br />
<br />
first of all I have to thank whoever made NSIS, I think it's awesome!;) <br />
<br />
Second I have some questions, my main use for NSIS is deploying a client/server application with a mysql backend.<br />
<br />
I can't really understand why sometimes I have to use single or double quotes or no quotes so I hope someone here can enlighten me.<br />
<br />
Here's some code from my script :<br />
Section &quot;&quot;;<br />
<br />
InitPluginsDir<br />
SetOutPath $PLUGINSDIR<br />
File struct.sql<br />
<br />
SetOutPath $INSTDIR<br />
<br />
;execute mysql commands<br />
GetFullPathName /SHORT $INSTDIRSHORT $INSTDIR<br />
${GetTime} &quot;&quot; &quot;L&quot; $0 $1 $2 $3 $4 $5 $6 ;get local time<br />
StrCpy $TS &quot;$0-$1-$2-$4-$5-$6&quot;<br />
<br />
StrCpy $FULLBACKUP &quot;$INSTDIRSHORT\ecoges-fullbackup-$TS.sql&quot;<br />
StrCpy $DATABACKUP &quot;$INSTDIRSHORT\ecoges-databackup-$TS.sql&quot;<br />
StrCpy $MYSQLDUMP &quot;$INSTDIRSHORT\bin\mysqldump.exe&quot;<br />
StrCpy $MYSQLCLIENT &quot;$INSTDIRSHORT\bin\mysql.exe&quot;<br />
StrCpy $STRUCSCRIPT &quot;$PLUGINSDIR\struct.sql&quot;<br />
<br />
nsExec::Exec '&quot;$MYSQLDUMP&quot; -r &quot;$FULLBACKUP&quot; ecoges -uroot -p1234 --complete-insert'<br />
nsExec::Exec '&quot;$MYSQLDUMP&quot; -r &quot;$DATABACKUP&quot; ecoges -uroot -p1234 --no-create-info --complete-insert'<br />
<br />
DetailPrint &quot;RÃ©initialisation de la base de donnÃ©es...&quot;<br />
nsExec::Exec 'cmd /C $MYSQLCLIENT -uroot -p1234 ecoges &lt; $STRUCSCRIPT'<br />
<br />
DetailPrint &quot;RÃ©cupÃ©ration des donnÃ©es...&quot;<br />
nsExec::Exec 'cmd /C $MYSQLCLIENT -uroot -p1234 ecoges &lt; &quot;$DATABACKUP&quot;'<br />
<br />
SectionEnd ; end the section<br />
<br />
Why do I have to remove all quotes with $MYSQLCLIENT and $MYSQLDUMP can work with or without them ?<br />
<br />
Why do I have to use double quotes when I restore $DATABACKUP but not when I create it with $MYSQLDUMP ?<br />
<br />
My code works but I try to make it as clean as possible.  I hope I'm not too hard to understand...<br />
<br />
Thanks for your help!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th November 2007, 21:06</div></div><div class="posttext">You use quotes around the executable paths in case those paths contain spaces. Lets say $MYSQLCLIENT is C:\Program Files\app.exe without any quotes... cmd will try and execute C:\Program.exe first instead.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BerSerK6996</div><div class="date">26th November 2007, 21:17</div></div><div class="posttext">ok, but why is it failing when the mysql client is in C:\mysql\bin\mysql.exe and I use double quotes ?  That's the part I don't get...<br />
<br />
if<br />
GetFullPathName /SHORT $INSTDIRSHORT $INSTDIR<br />
StrCpy $MYSQLCLIENT &quot;$INSTDIRSHORT\bin\mysql.exe&quot;<br />
<br />
$MYSQLCLIENT = c:\mysql\bin\mysql.exe = works fine<br />
$MYSQLCLIENT = c:\program files\mysql\mysql server 5.0\bin\mysql.exe = works fine<br />
&quot;$MYSQLCIENT&quot; = c:\mysql\bin\mysql.exe = fails</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th November 2007, 23:23</div></div><div class="posttext">That's some cmd.exe quoting fun for you. Add &quot;IF 1==1&quot; (sans quotes) before the path and it should work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BerSerK6996</div><div class="date">27th November 2007, 00:33</div></div><div class="posttext">like ?<br />
<br />
StrCpy $MYSQL IF 1==1 &quot;$INSTDIR\bin\mysql.exe&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th November 2007, 00:41</div></div><div class="posttext">No.nsExec::Exec 'cmd /C IF 1==1 &quot;$MYSQLCLIENT&quot; -uroot -p1234 ecoges &lt; &quot;$DATABACKUP&quot;'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BerSerK6996</div><div class="date">27th November 2007, 00:52</div></div><div class="posttext">ok thanks, I'll test that out tomorrow.<br />
<br />
can you tell me what that code actually do if it's not too complicated ?<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th November 2007, 17:56</div></div><div class="posttext">It forces cmd.exe to drop its weird quotes handling. If the first character in the command line is a quote, it'll the strip the first and the last quote thus rendering the command line completely invalid. See cmd.exe /? for more information.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BerSerK6996</div><div class="date">27th November 2007, 18:05</div></div><div class="posttext">I didn't know that but I will remember it for sure!<br />
<br />
Thanks a lot for your time.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>