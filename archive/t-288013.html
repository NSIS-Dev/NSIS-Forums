<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Create custom finish page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Create custom finish page NSIS Discussion" />
	
	<title> Create custom finish page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Create custom finish page</div>
<hr />
<div class="pda"><a href="t-288013.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=288013">Create custom finish page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">M. Ratz</div><div class="date">5th March 2008, 11:44</div></div><div class="posttext">hi @ all<br />
<br />
I have to create a finish page with a label or text/list-box where the things I have installed are listed. I assumed that with rect = 1040 I can create welcome/finish-pages (as it is said in nsDialogs help) where the welcome-bitmap on the left side is already set. But instead of that I get a page where neither my controls are shown nor the welcome-bitmap<br />
<br />
please help me<br />
<br />
thx in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">5th March 2008, 12:34</div></div><div class="posttext">I see there that &quot;bla&quot; button, what's wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">M. Ratz</div><div class="date">5th March 2008, 12:41</div></div><div class="posttext">I'm sorry i attached wrong file :rolleyes:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">5th March 2008, 12:52</div></div><div class="posttext">(copy-paste from Docs)<br />
<br />
Create<br />
<br />
nsDialogs::Create /NOUNLOAD rect<br />
<br />
Creates a new dialog. rect specific the identifier of the control whose location will be mimiced. This should usually be 1018, which is control mimiced for creation of built-in pages. The Modern UI also has control 1040 for the welcome and the finish page.<br />
<br />
Returns the new dialog's HWND on the stack or error.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">M. Ratz</div><div class="date">5th March 2008, 13:20</div></div><div class="posttext">I have already read the nsDialogs help.<br />
<br />
When i take &quot;1018&quot; as rect everything is good, but the welcome-picture is not shown. Changing rect into &quot;1040&quot; I get only the blank page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">5th March 2008, 13:30</div></div><div class="posttext">You are mixing basic UI and MUI...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">M. Ratz</div><div class="date">6th March 2008, 08:39</div></div><div class="posttext">Hello <br />
<br />
i now changed the pages included to MUI format but it's still the same. so please tell me: what am I doing wrong.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">7th March 2008, 07:09</div></div><div class="posttext">I'm using 1018 all the time and it's :up:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">M. Ratz</div><div class="date">7th March 2008, 09:04</div></div><div class="posttext">good morning pospec<br />
<br />
when using 1018 i only get a page, as they are before instfiles-dialog. what I wnat is a finish-page-looking page as it is given in the image. tell me plz how I can create such a page</div></div><hr />


<div class="post"><div class="posttop"><div class="username">M. Ratz</div><div class="date">7th March 2008, 09:06</div></div><div class="posttext">here is it</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th March 2008, 16:08</div></div><div class="posttext">Use Page Custom ....<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">greatguns</div><div class="date">19th June 2009, 11:07</div></div><div class="posttext">Originally posted by Afrow UK <br />
Use Page Custom ....<br />
<br />
Stu  <br />
I have the same problem. Page Custom does not help with creating a specific page.<br />
<br />
Page custom AbortedInstall<br />
Function AbortedInstall<br />
<br />
  !ifdef AbortInstall<br />
         Abort<br />
  !endif<br />
  nsDialogs::Create /NOUNLOAD 1040<br />
  Pop $Dialog<br />
  ${If} $Dialog == error<br />
       Abort<br />
  ${EndIf}<br />
<br />
  !insertmacro MUI_HEADER_TEXT &quot;Installation Aborted&quot; &quot;Product was not installed.&quot;<br />
  ${NSD_CreateLabel} 0 0 100% 16u \<br />
    &quot;Click Finish to exit the wizard.&quot;<br />
<br />
  nsDialogs::Show<br />
FunctionEnd<br />
<br />
<br />
I want the page to look like the finish page but i get the normal nsis page.<br />
<br />
I can put in all the code from the finish.nsh file in here, to make the page to show up right.....but that does not seem right.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th June 2009, 16:37</div></div><div class="posttext">Do you have to recreate the entire finish page? If you only need to add a control or two you can do so without recreating the dialog.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">greatguns</div><div class="date">20th June 2009, 22:55</div></div><div class="posttext">Originally posted by Afrow UK <br />
Do you have to recreate the entire finish page? If you only need to add a control or two you can do so without recreating the dialog.<br />
<br />
Stu  <br />
Thanks for the reply stu.<br />
<br />
Here is a mockup of exactly what i need.<br />
<br />
I want to define this page such that if anyone clicks cancel on any of the wizard pages i need to redirect them to this custom abort page.<br />
<br />
As for your question, i need to recreate the entire page as this is a single custom page, which gets shown on abort.<br />
<br />
I am not sure what you mean by &quot;do you have to recreate the entire finish page&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sergforce</div><div class="date">21st June 2009, 13:13</div></div><div class="posttext">Originally posted by greatguns <br />
Thanks for the reply stu.<br />
<br />
I want to define this page such that if anyone clicks cancel on any of the wizard pages i need to redirect them to this custom abort page.<br />
 <br />
<br />
Could you explain how you made it? I'm trying to do such things. And your last attachment looks great. How did you create it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">21st June 2009, 14:40</div></div><div class="posttext">I did a similar 'not finished' page for one of my installers (but based upon a condition I detect in .onInit, not upon the Cancel button). I added logic in the 'pre' functions for each page to abort them, letting the installer go directly to the finish page. I customized the text on the page to announce that the software was not installed and they read it and press 'Finish' to close the program.!define MUI_PAGE_CUSTOMFUNCTION_PRE SccVerErrPre<br />
!insertmacro MUI_PAGE_WELCOME<br />
<br />
!ifdef LICENSE_TXT<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE SccVerErrPre<br />
!insertmacro MUI_PAGE_LICENSE &quot;${LICENSE_TXT}&quot;<br />
!endif<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE SccVerErrPre<br />
!insertmacro MUI_PAGE_INSTFILES<br />
<br />
!define MUI_FINISHPAGE_TEXT $FinishText<br />
!define MUI_FINISHPAGE_TITLE $FinishTitle<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
function SccVerErrPre<br />
	${If} $SccVerError &lt;&gt; 0<br />
	${OrIf} $OlhVerError &lt;&gt; 0<br />
		Abort<br />
	${EndIf}<br />
functionEnd<br />
<br />
$FinishText and $FinishTitle are variables that I build up to tell them it wasn't installed and why.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">greatguns</div><div class="date">21st June 2009, 22:10</div></div><div class="posttext">Originally posted by demiller9 <br />
I did a similar 'not finished' page for one of my installers (but based upon a condition I detect in .onInit, not upon the Cancel button). I added logic in the 'pre' functions for each page to abort them, letting the installer go directly to the finish page. I customized the text on the page to announce that the software was not installed and they read it and press 'Finish' to close the program.!define MUI_PAGE_CUSTOMFUNCTION_PRE SccVerErrPre<br />
!insertmacro MUI_PAGE_WELCOME<br />
<br />
!ifdef LICENSE_TXT<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE SccVerErrPre<br />
!insertmacro MUI_PAGE_LICENSE &quot;${LICENSE_TXT}&quot;<br />
!endif<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE SccVerErrPre<br />
!insertmacro MUI_PAGE_INSTFILES<br />
<br />
!define MUI_FINISHPAGE_TEXT $FinishText<br />
!define MUI_FINISHPAGE_TITLE $FinishTitle<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
function SccVerErrPre<br />
	${If} $SccVerError &lt;&gt; 0<br />
	${OrIf} $OlhVerError &lt;&gt; 0<br />
		Abort<br />
	${EndIf}<br />
functionEnd<br />
<br />
$FinishText and $FinishTitle are variables that I build up to tell them it wasn't installed and why.<br />
<br />
Don <br />
<br />
I thought of doing the same thing, but add a pre function to each of the pages and redirecting to the finish page and then customizing the finish page messages seems a very round about way of achieving this. <br />
<br />
I hope there is a better way to get the custom finish page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">greatguns</div><div class="date">21st June 2009, 22:22</div></div><div class="posttext">Originally posted by sergforce <br />
Could you explain how you made it? I'm trying to do such things. And your last attachment looks great. How did you create it?  <br />
well that was a mockup of how i want the page to look.<br />
I can tell you how i disabled the buttons and made that page to show up when you click cancel, but i don't know how to make that page appear just like that.<br />
<br />
<br />
Var /Global AbortInstall<br />
!define MUI_CUSTOMFUNCTION_ABORT CancelInstall<br />
<br />
;Makes NSIS to go to a specified page relatively from the current page<br />
;See http://nsis.sourceforge.net/Go_to_a_NSIS_page<br />
Function RelGotoPage<br />
  IntCmp $R9 0 0 Move Move<br />
    StrCmp $R9 &quot;X&quot; 0 Move<br />
      StrCpy $R9 &quot;120&quot;<br />
<br />
  Move:<br />
  SendMessage $HWNDPARENT &quot;0x408&quot; &quot;$R9&quot; &quot;&quot;<br />
FunctionEnd<br />
<br />
Function CancelInstall<br />
  StrCpy $AbortInstall &quot;true&quot; ;We specify that we are aborting the installation<br />
  StrCpy $R9 1<br />
  Call RelGotoPage<br />
  Abort<br />
FunctionEnd<br />
<br />
!macro DisableBackCancelAndFinishButton<br />
  SendMessage $mui.Button.Back ${WM_SETTEXT} 0 &quot;STR:$(^BackBtn)&quot;<br />
  ShowWindow $mui.Button.Back ${SW_SHOW}<br />
  EnableWindow $mui.Button.Back 0<br />
  SendMessage $mui.Button.Cancel ${WM_SETTEXT} 0 &quot;STR:$(^CancelBtn)&quot;<br />
  ShowWindow $mui.Button.Cancel ${SW_SHOW}<br />
  EnableWindow $mui.Button.Cancel 0<br />
  SendMessage $mui.Button.Next ${WM_SETTEXT} 0 &quot;STR:Finish&quot;<br />
  ShowWindow $mui.Button.Next ${SW_SHOW}<br />
  EnableWindow $mui.Button.Next 1<br />
!macroend<br />
<br />
<br />
<br />
It has more functions, but this is how it works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sergforce</div><div class="date">22nd June 2009, 19:01</div></div><div class="posttext">demiller9, greatguns Thanks! It works :) <br />
<br />
I thought there was a special macros or function to go to the finish page silently. Aborting each page wasn't obvious to me. Maybe because I've just started using NSIS.  I think it wouldn't be bad to place this recipe on the tutorials wiki page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">greatguns</div><div class="date">22nd June 2009, 19:35</div></div><div class="posttext">Originally posted by sergforce <br />
demiller9, greatguns Thanks! It works :) <br />
<br />
I thought there was a special macros or function to go to the finish page silently. Aborting each page wasn't obvious to me. Maybe because I've just started using NSIS.  I think it wouldn't be bad to place this recipe on the tutorials wiki page.  <br />
Aborting each page is a very bad way of going to the finish page.(atleast i think so)<br />
Ideally, what we want to do is in the custom abort function<br />
<br />
Function CancelInstall<br />
StrCpy $AbortInstall &quot;true&quot; ;We specify that we are aborting the installation<br />
StrCpy $R9 1<br />
Call AbortPage ; we specify a specific abort page<br />
Abort<br />
FunctionEnd<br />
<br />
This way anytime a person clicks cancel we will redirect them to the abort page instead of aborting the installation in each page.<br />
<br />
But i could not get the RelGotoPage function to go to a specified page(it always goes to a relative page from the current page). I think there is a way to do this.....just need to find it :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">greatguns</div><div class="date">23rd June 2009, 21:50</div></div><div class="posttext">ideas anyone??<br />
Still can't figure out how to create a &quot;Welcome&quot;/&quot;finish&quot; dialog using nsDialogs.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>