<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Must select at least one Component?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Must select at least one Component? NSIS Discussion" />
	
	<title> Must select at least one Component? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Must select at least one Component?</div>
<hr />
<div class="pda"><a href="t-198805.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198805">Must select at least one Component?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">9th November 2004, 15:56</div></div><div class="posttext">Hello all.<br />
<br />
My installer has 3 sections, I think I would like to make sure the user selects at least 1 of them.  Is there a way I can prevent them from continuing past the components page if no component was selected?  Thanks all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mirakulix</div><div class="date">9th November 2004, 16:00</div></div><div class="posttext">check out one-section.nsi in the examples folder.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">9th November 2004, 17:01</div></div><div class="posttext">Mirakulix, I checked out the one-section.nsi, and it looks like that would allow me to ensure ONLY 1 component could be selected.  I would like to ensure that AT LEAST 1 component is selected before leaving the components page.  Did I miss something in the one-section.nsi?  Thanks for your help.<br />
<br />
p.s. I think what would be great would be to have the next button grayed out until at least one component is selected.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">9th November 2004, 18:21</div></div><div class="posttext">I also tried the following, just to see if i could detect if the first section was selected, but this does not work.  &quot;SectionGetFlags SEC01 $SEC01&quot; sets $SEC01 to 1 no matter what.<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_LEAVE &quot;ComponentsLeave&quot;<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
<br />
Function ComponentsLeave<br />
  SectionGetFlags SEC01 $SEC01<br />
  StrCmp $SEC01 &quot;*&quot; End NotSelected<br />
  NotSelected:<br />
  Abort<br />
  End:<br />
FunctionEnd<br />
<br />
(where * would be the value if the section was selected)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mirakulix</div><div class="date">9th November 2004, 18:34</div></div><div class="posttext">While you wrote your code, I wrote mine.:igor: It's quite the same, though.<br />
<br />
Name &quot;One or more Sections&quot;<br />
OutFile &quot;one-section.exe&quot;<br />
!define SF_SELECTED   1<br />
<br />
;--------------------------------<br />
; Pages<br />
<br />
Page components &quot;&quot; &quot;&quot; componentsLeave<br />
Page instfiles<br />
<br />
;--------------------------------<br />
; Sections<br />
<br />
Section !Required<br />
  SectionIn RO<br />
SectionEnd<br />
<br />
Section &quot;Group 1 - Option 1&quot; g1o1<br />
SectionEnd<br />
<br />
Section /o &quot;Group 1 - Option 2&quot; g1o2<br />
SectionEnd<br />
<br />
Section /o &quot;Group 1 - Option 3&quot; g1o3<br />
SectionEnd<br />
<br />
;--------------------------------<br />
; Functions<br />
<br />
; $1 counts the number of selected sections<br />
Function ComponentsLeave<br />
    SectionGetFlags &quot;${g1o1}&quot; $0<br />
    IntOp $1 $0 &amp; ${SF_SELECTED}<br />
    SectionGetFlags &quot;${g1o2}&quot; $0<br />
    IntOp $0 $0 &amp; ${SF_SELECTED}<br />
    IntOp $1 $1 + $0 <br />
    SectionGetFlags &quot;${g1o3}&quot; $0<br />
    IntOp $0 $0 &amp; ${SF_SELECTED}<br />
    IntOp $1 $1 + $0<br />
    StrCmp $1 &quot;0&quot; 0 +3<br />
        MessageBox MB_OK|MB_ICONSTOP &quot;You must select at least one Section.&quot;<br />
        Abort     ;stay at page<br />
FunctionEnd<br />
<br />
<br />
SectionGetFlags SEC01 $SEC01 ;$ missing?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th November 2004, 18:41</div></div><div class="posttext">It's a compile-time define for a Section, not a variable.<br />
Should be ${SEC01}<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">9th November 2004, 18:57</div></div><div class="posttext">Mirakulix, thanks!  Its working very well.  I try to never put any code into my script without fully understanding it, and I have to be honest, Iâ€™m still very new at the NSIS, but learning fast I hope.  Could you explain the significance of &quot;!define SF_SELECTED 1&quot; ?  I looked in the documentation, but it seems it only relates to silent installs. :igor: Thanks again!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th November 2004, 19:04</div></div><div class="posttext">It's a compile-time define which sets the value of ${SF_SELECTED} to be &quot;1&quot; on compile.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mirakulix</div><div class="date">9th November 2004, 19:07</div></div><div class="posttext">This has nothing to do with the compiler, I just defined the constant SF_SELECTED = 1 for later use (to try to indicate that this line masks out the is-selected-bit):<br />
IntOp $1 $0 &amp; ${SF_SELECTED}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">9th November 2004, 19:21</div></div><div class="posttext">Would this work too?:<br />
<br />
<br />
Function ComponentsLeave<br />
    SectionGetFlags &quot;${SEC01}&quot; $0<br />
    StrCmp $0 1 End<br />
    SectionGetFlags &quot;${SEC02}&quot; $0<br />
    StrCmp $0 1 End<br />
    SectionGetFlags &quot;${SEC03}&quot; $0<br />
    StrCmp $0 1 End<br />
    MessageBox MB_OK|MB_ICONSTOP &quot;You must select at least one Section.&quot;<br />
    Abort<br />
    End:<br />
FunctionEnd<br />
<br />
<br />
This way I can skip the &quot;!define SF_SELECTED 1&quot;, and it shortens up the code a tad.  Thanks again everyone.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mirakulix</div><div class="date">9th November 2004, 19:44</div></div><div class="posttext">You can safely replace the ${SF_SELECTED} with 1, but you can (should) not omit masking out the lowest bit.<br />
SectionGetFlags returns an integer of<br />
which only the lowest bit specifies if the section is selected.<br />
You can only omit the masking if you are absolutely sure that no other options (Bold font, subsection, read-only) are turned on for these sections.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">9th November 2004, 19:50</div></div><div class="posttext">Mirakulix, so what you saying is that it is safer to include the &quot;!define SF_SELECTED 1&quot; line, correct? Ok, no problem, I can add that back. I'm using the MUI, so should this line be up at the top, say in the ;MUI Settings area? Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th November 2004, 20:28</div></div><div class="posttext">There is no need to define SF_SELECTED yourself. Simply include Sections.nsh.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">9th November 2004, 20:35</div></div><div class="posttext">Right here?<br />
<br />
; MUI 1.67 compatible ------<br />
!include &quot;MUI.nsh&quot;<br />
!include &quot;Sections.nsh&quot;<br />
<br />
I did not have that or the !define SF_SELECTED 1, and it seemed still work, was i just getting lucky?  Thanks all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mirakulix</div><div class="date">9th November 2004, 20:46</div></div><div class="posttext">If you replace all occurrences of ${SF_SELECTED} with 1s, you don't need to !define ${SF_SELECTED} because this constant is not appearing in your code at all.<br />
And if you don't use any other constants or macros from Sections.nsh, you need not to !include Sections.nsh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">9th November 2004, 21:25</div></div><div class="posttext">Sounds good.  Thanks all, you guys are all very patient and helpful.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Urd</div><div class="date">12th December 2004, 12:16</div></div><div class="posttext">Can the One or more Sections script be changed so it only allows one of three components but also allows for none to be installed.  As it is now one is selected all the time, all of them can't be unchecked.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">13th December 2004, 08:55</div></div><div class="posttext">Mirakulix, all Afrow was saying was that the !define command sets the ${SF_SELECTED} variable to be '1' at compile time, not at runtime.  Which is correct.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>