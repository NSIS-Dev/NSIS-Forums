<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Overwrite always, but silently, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Overwrite always, but silently NSIS Discussion" />
	
	<title> Overwrite always, but silently [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Overwrite always, but silently</div>
<hr />
<div class="pda"><a href="t-133135.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=133135">Overwrite always, but silently</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">rpetges</div><div class="date">25th April 2003, 21:33</div></div><div class="posttext">Hi,<br />
<br />
I have an application DLL (language resource) that is always locked and that should always be overwritten when updated without any user intervention.<br />
<br />
Currently, I use the UpgradeDLL macro who checks the Version of the DLL and skips when it's equal... I need to always overwite !<br />
<br />
How can I do this silently, i.e. I don't want a message prompted to the user like &quot;Error opening file for writing......&quot;.<br />
<br />
Many thanks<br />
Romain</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th April 2003, 21:40</div></div><div class="posttext">If you want it to always overwrite the dll, can't you just use the...<br />
<br />
SetOutPath (path to the dll file is on user's pc)<br />
File (path to the dll on your local pc)<br />
<br />
<br />
I don't see why you need to use the upgradedll macro if your not checking dll versions.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rpetges</div><div class="date">25th April 2003, 21:52</div></div><div class="posttext">If you want it to always overwrite the dll, can't you just use the...<br />
<br />
SetOutPath (path to the dll file is on user's pc)<br />
File (path to the dll on your local pc)<br />
<br />
 <br />
<br />
Indeed, you're right... don't know why I used the UpgradeDLL macro.<br />
<br />
But my problem persits, I can't overwrite this file in a silent mode. The user must confirm an action on the following message box (see attached picture)<br />
<br />
How can I bypass this error message ?<br />
<br />
Thanks, Romain</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th April 2003, 23:32</div></div><div class="posttext">Try this:<br />
http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.3.12<br />
<br />
Use:<br />
<br />
SetFileAttributes &quot;$PROGRAMFILES\Romain's Software\Attribute Changer\aclang.dll&quot; NORMAL<br />
SetOutPath &quot;$PROGRAMFILES\Romain's Software\Attribute Changer&quot;<br />
File &quot;C:\path\to\local\aclang.dll&quot;<br />
SetFileAttributes &quot;$PROGRAMFILES\Romain's Software\Attribute Changer\aclang.dll&quot; READONLY|SYSTEM<br />
<br />
<br />
This might work. So in effect, it will remove all flags from the users' aclang.dll, extract the new one, then put the flags back again. (I asume the flags must be READONLY and SYSTEM, but check what it should be.<br />
<br />
This might not work if the dll is always in use.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rpetges</div><div class="date">25th April 2003, 23:40</div></div><div class="posttext">This might not work if the dll is always in use. <br />
<br />
I think you overlooked something in my firt post ... I wrote that the file is always locked (in use)<br />
<br />
But, it should be possible to bypass this error message and replace the file on reboot, or isn't this simply possible ?<br />
<br />
Romain</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th April 2003, 15:41</div></div><div class="posttext">Extract the file to another location (in the temp or installation folder) and use Rename /REBOOTOK</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rpetges</div><div class="date">26th April 2003, 15:51</div></div><div class="posttext">Good idea, I'll give it a try. <br />
<br />
Thanks</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>