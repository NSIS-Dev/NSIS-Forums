<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How do we overwrite a running file, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How do we overwrite a running file NSIS Discussion" />
	
	<title> How do we overwrite a running file [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How do we overwrite a running file</div>
<hr />
<div class="pda"><a href="t-302072.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=302072">How do we overwrite a running file</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">seckg</div><div class="date">14th January 2009, 19:40</div></div><div class="posttext">Hi All,<br />
My install script (NSI)already set SetOverwrite on<br />
but when the file (dll or exe) is running, NSI setup<br />
just ignore it, and it will not be upgraded even<br />
restart the computer.<br />
<br />
Section &quot;-Compsect&quot; SEC0000<br />
    SetOutPath $INSTDIR<br />
    SetOverwrite on<br />
    File ..\ty.ocx<br />
    File ..\logo.gif<br />
    File ..\tty.dll<br />
    File ..\vcredist_x86.exe<br />
<br />
Is there any solution for this?<br />
BTW, I want to conditional install vcredist_x86.exe if it<br />
is not installed, I can check registry, how do i implement<br />
it in NSI script<br />
<br />
Best Regards<br />
Seckg</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th January 2009, 20:49</div></div><div class="posttext">See /rebootok for the File instruction.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ivan Andreevich</div><div class="date">14th January 2009, 20:54</div></div><div class="posttext">DLL/exe setup (including rebooting if needed): http://nsis.sourceforge.net/Docs/AppendixB.html<br />
Check if exe is running: http://nsis.sourceforge.net/FindProcDLL_plug-in<br />
Kill exe: http://nsis.sourceforge.net/KillProcDLL_plug-in<br />
<br />
<br />
Conditional installation of VC++ 2005 redist SP1:<br />
ReadRegStr $R0 HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{7299052b-02a4-4627-81f2-1818da5d550d}&quot; DisplayName<br />
${If} $R0 == &quot;&quot;<br />
   ;extract the file<br />
   ExecWait '&quot;msiexec&quot; /i &quot;path/to/msi&quot; /quiet'<br />
${EndIf}<br />
<br />
Non-SP1 is here HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">seckg</div><div class="date">19th January 2009, 23:01</div></div><div class="posttext">It seems that /REBOOTOK only works with <br />
Delete command, doesn't work with File command.<br />
<br />
-Seckg</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">20th January 2009, 05:32</div></div><div class="posttext">That could be done by examining the target system for certain running processes before the actual installer/uninstaller loads as already suggested above by Ivan.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th January 2009, 15:36</div></div><div class="posttext">See the macro on this page:<br />
http://forums.winamp.com/showthread.php?threadid=293513<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">seckg</div><div class="date">20th January 2009, 18:20</div></div><div class="posttext">Thank you very much, it helps.<br />
<br />
-Seckg</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>