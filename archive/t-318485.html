<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ${NSD_CreateNumber} with up/down arrows (aka &quot;spin control&quot;) possible?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ${NSD_CreateNumber} with up/down arrows (aka &quot;spin control&quot;) possible? NSIS Discussion" />
	
	<title> ${NSD_CreateNumber} with up/down arrows (aka &quot;spin control&quot;) possible? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ${NSD_CreateNumber} with up/down arrows (aka &quot;spin control&quot;) possible?</div>
<hr />
<div class="pda"><a href="t-318485.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318485">${NSD_CreateNumber} with up/down arrows (aka &quot;spin control&quot;) possible?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">18th April 2010, 17:12</div></div><div class="posttext">I have been trying to find some information on what's known in MFC as &quot;spin control&quot; but I couldn't find any.<br />
<br />
Is there a different name for it, or this simply is not supported yet in nsDialogs?<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">18th April 2010, 17:28</div></div><div class="posttext">Not yet supported.<br />
Here is what I come up with to add support:<br />
!define UDS_WRAP                0x0001<br />
!define UDS_SETBUDDYINT         0x0002<br />
!define UDS_ALIGNRIGHT          0x0004<br />
!define UDS_ALIGNLEFT           0x0008<br />
!define UDS_AUTOBUDDY           0x0010<br />
!define UDS_ARROWKEYS           0x0020<br />
!define UDS_HORZ                0x0040<br />
!define UDS_NOTHOUSANDS         0x0080<br />
!define UDS_HOTTRACK            0x0100<br />
<br />
!define __NSD_UpDown_CLASS msctls_updown32<br />
!define __NSD_UpDown_STYLE ${DEFAULT_STYLES}|${UDS_ARROWKEYS}|${UDS_AUTOBUDDY}<br />
!define __NSD_UpDown_EXSTYLE 0<br />
<br />
!insertmacro __NSD_DefineControl UpDown<br />
then try creating a UpDown control with nsDialogs just after your edit field<br />
<br />
Note: I didn't test this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">18th April 2010, 19:01</div></div><div class="posttext">Wizou's ${NSD_CreateUpDown} code works fine.  Just keep in mind that NSD_OnClick and _OnChange will do nothing for the UpDown control, so set _OnChange up on its buddy control (typically a ${NSD_CreateText}) instead.<br />
<br />
You may also want to set up some sane range (the default is inverted, for one) and a default value:<br />
<br />
!define UDM_SETRANGE 0x0465<br />
!define UDM_SETPOS32 0x0471<br />
<br />
[...]<br />
${NSD_CreateText} 0 0 50 16 &quot;0&quot;<br />
  Pop $UpDownBuddy<br />
${NSD_CreateUpDown} 50 0 48 16 &quot;&quot;<br />
  Pop $UpDown<br />
  SendMessage $UpDown ${UDM_SETRANGE} 0 100 ; min max<br />
  SendMessage $UpDown ${UDM_SETPOS32} 0 50 ; 0 value<br />
<br />
; Setting up the OnChange callback here to prevent UpDown from triggering it on creation<br />
${NSD_OnChange} $UpDownBuddy custom.updownbuddy.onchange<br />
<br />
<br />
If you do use a Buddy control, you might also have to do some sanity checking yourself.  E.g. you can enter a value in the Text control that is outside of the UpDown control's range.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">26th September 2010, 14:14</div></div><div class="posttext">Wizou and Animaether, thanks for your replies. I tried implementing your code. It displays very well, but when I click the up/down arrows, nothing changes in the buddy. Any idea what could be missing?<br />
<br />
Here is my code:<br />
<br />
Var hUpDown<br />
Var hUpDownBuddy<br />
Var varUpDownToMM<br />
<br />
!define UDM_SETRANGE 0x0465<br />
!define UDM_SETPOS32 0x0471<br />
!define UDM_GETPOS32 0x0472<br />
<br />
!define UDS_WRAP                0x0001<br />
!define UDS_SETBUDDYINT         0x0002<br />
!define UDS_ALIGNRIGHT          0x0004<br />
!define UDS_ALIGNLEFT           0x0008<br />
!define UDS_AUTOBUDDY           0x0010<br />
!define UDS_ARROWKEYS           0x0020<br />
!define UDS_HORZ                0x0040<br />
!define UDS_NOTHOUSANDS         0x0080<br />
!define UDS_HOTTRACK            0x0100<br />
<br />
!define __NSD_UpDown_CLASS msctls_updown32<br />
!define __NSD_UpDown_STYLE ${DEFAULT_STYLES}|${UDS_ARROWKEYS}|${UDS_AUTOBUDDY}<br />
!define __NSD_UpDown_EXSTYLE 0<br />
<br />
!insertmacro __NSD_DefineControl UpDown  <br />
<br />
Function custom.updownbuddy.onchange<br />
  SendMessage $hUpDown ${UDM_GETPOS32} 0 0 $varUpDownToMM<br />
FunctionEnd<br />
<br />
Function Test<br />
[...]<br />
	${NSD_CreateLabel} 2 74u 16u 12u &quot;testtext:&quot;<br />
	Pop $hStaticLabel<br />
${NSD_CreateNumber} 26u 72u 24u 12u &quot;2&quot;<br />
  Pop $hUpDownBuddy<br />
${NSD_CreateUpDown} 50u 72u 24u 12u &quot;&quot;<br />
  Pop $hUpDown<br />
  SendMessage $hUpDown ${UDM_SETRANGE} 0 23 ; min max<br />
  SendMessage $hUpDown ${UDM_SETPOS32} 0 50 ; 0 value<br />
<br />
; Setting up the OnChange callback here to prevent UpDown from triggering it on creation<br />
${NSD_OnChange} $hUpDownBuddy custom.updownbuddy.onchange  <br />
<br />
[...]<br />
FunctionEnd<br />
Isn't the associated buddy supposed to change automatically upon clicking an up/down arrow? (otherwise it wouldn't have been called a buddy, right?)<br />
<br />
There is something I am missing here but I don't know what it is. Any idea?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">26th September 2010, 14:39</div></div><div class="posttext">You have forgotten to include ${UDS_SETBUDDYINT} in your updown control's style.<br />
<br />
<br />
UDS_SETBUDDYINT<br />
<br />
Causes the up-down control to set the text of the buddy window (using the WM_SETTEXT message) when the position changes. The text consists of the position formatted as a decimal or hexadecimal string.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">26th September 2010, 15:42</div></div><div class="posttext">You have forgotten to include ${UDS_SETBUDDYINT} in your updown control's style.<br />
You were right on the money. Thank you Animaether.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">27th September 2010, 19:09</div></div><div class="posttext">I have added a section to the nsDialogs FAQ, where you can also grab the correct method of handling UpDown control interaction:<br />
http://nsis.sourceforge.net/mediawiki/index.php?title=NsDialogs_FAQ&amp;action=submit#How_to_detect_UpDown_control_interaction</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">27th September 2010, 19:43</div></div><div class="posttext">I have added a section to the nsDialogs FAQ, where you can also grab the correct method of handling UpDown control interaction:<br />
http://nsis.sourceforge.net/mediawiki/index.php?title=NsDialogs_FAQ&amp;action=submit#How_to_detect_UpDown_control_interaction<br />
Animaether, you rock! Thank you very much.<br />
<br />
Now, it would be nice to have the same for the Date and Time Picker  :)<br />
<br />
http://msdn.microsoft.com/en-us/library/bb761727%28v=VS.85%29.aspx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">27th September 2010, 20:40</div></div><div class="posttext">I'll leave that as an exercise for the reader ;)<br />
( and another thread )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">27th September 2010, 22:51</div></div><div class="posttext">silly wiki link goes to an edit page.. figures.<br />
<br />
here's a regular link: http://nsis.sourceforge.net/mediawiki/index.php?title=NsDialogs_FAQ#How_to_detect_UpDown_control_interaction</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">1st October 2010, 19:36</div></div><div class="posttext">nsnb - what did you need that DateTime control for?<br />
<br />
I'm miraculously finding myself with a project where I might end up using it ( you must have jynxed me ;) ).. so I've got all of the important bits going.. but plan on finishing it up into a user-friendly and global variables-eating header file as the bugger is fairly extensive in messages/notifications bits.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>