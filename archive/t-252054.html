<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstaller: removing Start Menu folder?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstaller: removing Start Menu folder? NSIS Discussion" />
	
	<title> Uninstaller: removing Start Menu folder? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstaller: removing Start Menu folder?</div>
<hr />
<div class="pda"><a href="t-252054.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=252054">Uninstaller: removing Start Menu folder?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Guv'nor</div><div class="date">27th July 2006, 12:53</div></div><div class="posttext">Hello!<br />
<br />
I've got a little problem with my uninstaller.<br />
It seems like mostly he doesn't want to delete my Start Menu folder, my remove-line looks like this:<br />
<br />
    RMDir /r &quot;${S_DIR}&quot;<br />
<br />
and my constant ${S_DIR}&quot; looks like this:<br />
<br />
    !define S_DIR &quot;$SMPROGRAMS\MyApp&quot;<br />
<br />
But he just can't delete it. I don't understand this, because with every other Directory I want to remove, it works perfectly.<br />
<br />
I hope someone could help me here :)<br />
<br />
Nice greetings<br />
Guv'nor</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th July 2006, 13:52</div></div><div class="posttext">Try using Delete on each icon to delete them and then use RMDir without /r.<br />
It may be Windows locking the folder as it usually writes a hidden desktop.ini file to start menu folders.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guv'nor</div><div class="date">27th July 2006, 14:15</div></div><div class="posttext">Well, sadly, that didn't work.<br />
<br />
I tried it like this:<br />
<br />
<br />
    Delete &quot;$SMSTARTUP\${S_EXE_NAME}.lnk&quot;<br />
    <br />
    Delete &quot;${S_DIR}\${S_EXE_NAME}.lnk&quot;<br />
    Delete &quot;$(uninstname)&quot;<br />
    Delete &quot;${S_DIR}\desktop.ini&quot;<br />
    RMDir &quot;${S_DIR}&quot;<br />
<br />
<br />
And now I've got something very interesting: I copied the uninstall log into notepad and I noticed, that he just stops after deleting the Autorun-Entry (that's why I included that line here also). Right after that, he logs &quot;Finished.&quot;<br />
<br />
I don't understand that, the above script is taken 1:1 out of my script, there are no lines in between or something. He should just go on with deleting the remaining 4 entries.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th July 2006, 18:48</div></div><div class="posttext">Are you using SetShellVarContext in the installer? Have you used it in the uninstaller as well?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guv'nor</div><div class="date">28th July 2006, 07:06</div></div><div class="posttext">Well, that's it :)<br />
<br />
I could not even remember using it, I just wanted to answer you with &quot;no I don't use it&quot; ;) but then I looked again and noticed that I really have this thing in my script :)<br />
<br />
Thanks!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>