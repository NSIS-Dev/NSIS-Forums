<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Trying to refresh IE post install, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Trying to refresh IE post install NSIS Discussion" />
	
	<title> Trying to refresh IE post install [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Trying to refresh IE post install</div>
<hr />
<div class="pda"><a href="t-264940.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=264940">Trying to refresh IE post install</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">muddlethrough</div><div class="date">2nd February 2007, 20:22</div></div><div class="posttext">I'm trying to figure out a way to reloading the web page that my install came from once the install has finished.  The only options seem to be to use either:<br />
ExecShell &quot;open&quot; &quot;url&quot;<br />
or <br />
Exec '&quot;$PROGRAMFILES\Internet Explorer\iexplore.exe&quot; &quot;url&quot;'<br />
but the first opens the default browser or picks a window from the default browser (may not be the window that the install was launched from) to load in.  The second forces IE but opens in a new window everytime.<br />
<br />
This only applies to Internet Explorer but there could be people using Firefox with an IE view etc.<br />
<br />
To be honest this seems like too much to be asking but I thought I would throw it open for discussion.  Any suggestions?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">2nd February 2007, 20:36</div></div><div class="posttext">I guess this is something the page should do instead of the installer, e.g. within a java script check if your application is installed by checking on registry records, file existence, or whatever, and according to the result of this check show/hide the install link or even show a different page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">muddlethrough</div><div class="date">2nd February 2007, 20:42</div></div><div class="posttext">Yes I did think of that and I tried setting a cookie in the installation and looking for that in the browser but the loop that the javascript goes into (continually looking for the cookie) freezes the browser, plus I couldn't figure out how to  load the install and then run a javascript function.  Maybe this is my poor javascript skills!?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">2nd February 2007, 20:49</div></div><div class="posttext">Unfortunately my java script skills are more poor.<br />
What I had in mind was something like microsoft's windows update pages, implemented in java, thus suitable for all browsers instead of IE.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">muddlethrough</div><div class="date">2nd February 2007, 21:14</div></div><div class="posttext">Thank you very much for your suggestions.  <br />
<br />
Let me explain further what it is I am trying to do.  The UI designers have decided that the ActiveX control (only valid for IE) that we use as part of our site is difficult to install - the nasty yellow bar thing!  So my install is supposed to be replacing the the standard ActiveX install with a downloadable executable which will install and register the ActiveX at the click of a button.  This all works fine - woo hoo!  The standard IE ActiveX install would load the ActiveX as part of the whole process, but if I'm not using that anymore then I need to instruct the browser somehow to load the control after installation.  Manual refresh works fine as it can detect whether the control is installed on page reload.  Yahoo does it somehow!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">2nd February 2007, 21:41</div></div><div class="posttext">I believe you're just a tick away to achieve it, most likely, soon, other users of this forum will post the way to catch this tick ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dandaman32</div><div class="date">2nd February 2007, 22:08</div></div><div class="posttext">Use setTimeout() to check for the cookie once every 3-5 seconds.<br />
<br />
function chkCookie()<br />
{<br />
  if(document.cookie.indexOf('cookieName'))<br />
  {<br />
    window.reload();<br />
  }<br />
  else<br />
  {<br />
    setTimeout('chkCookie();', 3000);<br />
  }<br />
}<br />
chkCookie();<br />
And to those of you who have been wondering where I've been the past several months...I've been learning PHP and Javascript :-)<br />
<br />
-dandaman32</div></div><hr />


<div class="post"><div class="posttop"><div class="username">muddlethrough</div><div class="date">2nd February 2007, 22:53</div></div><div class="posttext">That actually seems like it should work, thanks.  I made one amendment:<br />
<br />
function chkCookie()<br />
{<br />
  if(document.cookie.indexOf('cookieName') &gt;= 0)<br />
  {<br />
    window.reload();<br />
  }<br />
  else<br />
  {<br />
    setTimeout('chkCookie();', 3000);<br />
  }<br />
}<br />
<br />
Now I just need to figure out my cookie domain issues - but i don't think you guys can help with that one.<br />
<br />
Thank you again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">4th February 2007, 23:06</div></div><div class="posttext">One can still use DDE to send commands to the browserwindows.<br />
See old netscape documentation, but it works ain IE and Firefox none the less.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>