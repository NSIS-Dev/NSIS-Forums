<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" nsXML - an MSXML NSIS XML plugin, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  nsXML - an MSXML NSIS XML plugin NSIS Discussion" />
	
	<title> nsXML - an MSXML NSIS XML plugin [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  nsXML - an MSXML NSIS XML plugin</div>
<hr />
<div class="pda"><a href="t-210994.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=210994">nsXML - an MSXML NSIS XML plugin</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">21st March 2005, 07:59</div></div><div class="posttext">Been working on an XML writing plugin recently and have come up with the following API...<br />
<br />
  initCOM<br />
  init<br />
  startElem<br />
  endElem<br />
  startDocument<br />
  endDocument<br />
  insertElemVal<br />
  elemVal<br />
  write <br />
  uninitCOM<br />
<br />
I'm using MSXML and SAX for the writer so this should allow for some pretty strict error checking when required plus it's probably the XML parser I know best.  Note that it only does writing right now, I'm playing around with some stuff  for how parsing might work.  The API is pretty much a wrapper for an MSXML SAX writer instance so if you are familiar with that then you should have no troubles.  I am still open for suggestions/request so if you have some please let me know this thing is far from done.  You need MSXML 3 so make sure you have that.  I'm not sure if you need a specific revision of the MSXML3.dll I'll see if I can find out.<br />
<br />
init          - Intializes a bunch of MSXML parser instance <br />
stuff<br />
startDocument - Starts a document in memory<br />
endDocument   - Ends a document in memory<br />
<br />
startElem     - Start an element in the document, it'll insert something like &quot;&lt;Start&gt;&quot; but not the cooresponding &quot;&lt;/Start&gt;&quot; which of course is what endElem is for<br />
<br />
endElem - As I mentioned inserts the end element tag &quot;&lt;/Start&gt;&quot; for example<br />
<br />
elemVal - Inserts a value for the current element.  Should be preceeded by a call to startElem and proceeded by a call to endElem<br />
<br />
insertElemVal - Combines calls to startElement, endElement and characters to write an element into the XML document.  In the example above<br />
<br />
  nsXML::insertElemVal &quot;Hello&quot; &quot;123&quot;<br />
<br />
would insert &lt;Hello&gt;123&lt;/Hello&gt; into the XML document<br />
<br />
write - Writes the constrcuted XML doc out to the file you specify<br />
<br />
initCOM &amp; uninitCOM - Are only necessary if you don't use COM elsewhere in other plugins.  Call CoInitialize and CoUninitialize respectively.<br />
<br />
And here's an example script snippet which you should just be able to try out<br />
<br />
nsXML::initCOM<br />
nsXML::init<br />
nsXML::startDocument<br />
nsXML::insertElemVal &quot;Hello&quot; &quot;123&quot;<br />
nsXML::insertElemVal &quot;Hel2lo&quot; &quot;1233333&quot;<br />
nsXML::endDocument<br />
nsXML::write &quot;c:\temp.xml&quot;<br />
nsXML::uninitCOM<br />
<br />
<br />
The plugins attached for you to try out although quite buggy at this point.  I'm getting a crash on shutdown of any installers I make with the plugin.  I'm looking into it.<br />
<br />
Other features I plan to add...<br />
-Search and replace on a specific element or value<br />
-Unicode support (not sure if this is possible with language tables or not but it would be really cool if you could do it)<br />
-support for DOM parser/writer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">21st March 2005, 14:48</div></div><div class="posttext">Cool... going to try it.... although mine was a crap :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsegal</div><div class="date">21st March 2005, 18:20</div></div><div class="posttext">I remember your post on your plugin Joelito, let me know if you want to help out on this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kike_velez</div><div class="date">22nd March 2005, 07:44</div></div><div class="posttext">Hello<br />
<br />
@Regal : Cool :up:<br />
@Joelito: Courage . I think that 2 plugins is better thant one. I plugin for xml is a hard work. :up: <br />
<br />
Best regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">22nd March 2005, 14:21</div></div><div class="posttext">Thanks kike :)<br />
<br />
The thing is that I was trying to do my own parser... I can do it by using, like Regal, wrapping other parser...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd March 2005, 17:19</div></div><div class="posttext">If 2 is better than 1, then surely 2.5 is better than 2.<br />
<br />
Bellow there is a link to a little XML plug-in, based on expat and scew, that I started working on and never finished. I doesn't require any external components but MSVCRT.dll. It's also, surprisingly, called nsXML. I tried to avoid having the script save handles to XML elements everywhere, so I went with something similar to XPath, but with writing ability too.<br />
<br />
http://www.stashbox.org/uploads/1111511534/nsXML.zip</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saivert</div><div class="date">24th March 2005, 16:59</div></div><div class="posttext">Looks like that link is dead. I came here for your nsXML plugin which supposedly was going to explain how to use the ExecuteCodeSegment, but no luck.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th March 2005, 15:20</div></div><div class="posttext">I don't know why stashbox.org isn't responding. I hope it'll get back online soon. For now, I have attached the plug-in without expat and scew.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saivert</div><div class="date">25th March 2005, 15:31</div></div><div class="posttext">Excellent!!!<br />
I'l have a look at the code soon, maybe I will find out some more ways to exploit the ExecuteCodeSegment trick.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">31st July 2005, 10:57</div></div><div class="posttext">You can also check my small (11K) nsisXML plugin based on MSXML<br />
at http://omarcoux.free.fr/nsisXML</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saivert</div><div class="date">31st July 2005, 18:36</div></div><div class="posttext">I think Wizou's plug-in is more complete as it supports XPath. XPath is so much easier to work with than opening a child, descending checking tag attribute and repeating until what you want is found. Good for general enumeration, but this is not usually what you want. You will most likely update some configuration data when handling XML files in NSIS. Kichik and Wizou should team up and make one single XML plug-in for NSIS that does it's job.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>