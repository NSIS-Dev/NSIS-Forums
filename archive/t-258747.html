<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" nsExec::execToStack w/ spaces, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  nsExec::execToStack w/ spaces NSIS Discussion" />
	
	<title> nsExec::execToStack w/ spaces [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  nsExec::execToStack w/ spaces</div>
<hr />
<div class="pda"><a href="t-258747.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258747">nsExec::execToStack w/ spaces</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">neil.benn</div><div class="date">1st November 2006, 23:22</div></div><div class="posttext">Hello,<br />
<br />
      I am using nsExec::execToStack to call a program I have written,I am passing it:<br />
<br />
48#&quot;\windows\CrEme\bin\CrEme.exe&quot; -Of -vkb -wd '|PROGRAM_FILES|\DropPaq' -jar 'bin\DropPaq.jar' etc\RippleConfig.xml fire default<br />
<br />
as a parameter.  the program then returns:<br />
<br />
48#&quot;\windows\CrEme\bin\CrEme.exe&quot; -Of -vkb -wd 'Programme\DropPaq' -jar 'bin\DropPaq.jar' etc\RippleConfig.xml fire default<br />
<br />
basically, it interrrogates a PDA to find out the names of the special directories and returns the result from the string to stdout.  When I'm popping the result off the stack I only get the text up to the space :<br />
<br />
48#&quot;\windows\CrEme\bin\CrEme.exe&quot;<br />
<br />
  I'mnot sure if it is the quotes or the space that is giving me the problem, I've tried popping the data off twice to see if I get the next bit but nothing is happening.  Has anyone ever seen this effect?  If so do you know what is going on and do you know how to circumvent it?<br />
<br />
  Thanks for your help.<br />
<br />
Cheers,<br />
<br />
Neil</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd November 2006, 08:40</div></div><div class="posttext">Works fine for me with invalid input. It just pushes &quot;error&quot; on the stack. What's the exact code you're using?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">neil.benn</div><div class="date">2nd November 2006, 20:08</div></div><div class="posttext">Hello,<br />
<br />
       Thanks for the response, the program gives the base response works as seen above when run from the command prompt.  The NSIS code that calls this is as follows:<br />
<br />
---    <br />
    DetailPrint &quot;Accessing PDA&quot;<br />
    nsExec::Exec '$INSTDIR\CEFileOp.exe /c dev:&quot;|PROGRAMS|\DropPaq Fire.lnk&quot; desk:&quot;DropPaq Fire.lnk&quot;'<br />
    call CheckCESuccess<br />
    IfErrors FailedMod<br />
    DetailPrint &quot;Checking system&quot;<br />
    FileOpen $3 &quot;DropPaq Fire.lnk&quot; r<br />
    FileRead $3 $4<br />
    FileClose $3<br />
    MessageBox MB_OK '&quot;$INSTDIR\CEFileOp.exe&quot; /r $4'<br />
    nsExec::ExecToStack '&quot;$INSTDIR\CEFileOp.exe&quot; /r $4'<br />
    call CheckCESuccess<br />
    Pop $0<br />
    MessageBox MB_OK $0<br />
    Pop $1<br />
    MessageBox MB_OK $1<br />
    IfErrors FailedMod SuccessMod <br />
    <br />
    FailedMod:<br />
        SetErrors<br />
        Return<br />
    SuccessMod:<br />
        DetailPrint &quot;Successful Access&quot;<br />
<br />
---<br />
<br />
Basically this connects to the handheld, retrieves the file 'Droppaq Fire.lnk', reads th contents out nto a string and then calls the replace on that string.  I have checked that the file is being read correctly as the correct data shows up on the messagebox, this calls the exe with the details as used on the command line.  However the return via nsExec::ExecToStack only shows the following bit, however this is missing the quotes I actually get returned - <br />
<br />
48#\windows\CrEme\bin\CrEme.exe<br />
<br />
Note, this is without the quotes, so I assume that the quotes in the return string are causing me a problem.  In addition,when I pop off the stack twice, the second time gives me an error so there is no more to retrieve from stdout.<br />
<br />
I'm going to try making a batch file which returns a string with quotes in to see what that does when called with nsExec:ExecToStack.<br />
<br />
  However,if anyone has seen this before - tips would be great :).<br />
<br />
Cheers,<br />
<br />
Neil</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd November 2006, 20:27</div></div><div class="posttext">What about the code for CheckCESuccess? Does it not touch the stack at all?<br />
<br />
Make sure you're not passing new line characters along with $4 after you FileRead it. Use TrimNewLines to remove them.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">neil.benn</div><div class="date">8th November 2006, 13:08</div></div><div class="posttext">Hello,<br />
<br />
      Apologies, the error was with my code - I had rogue speechmarks in the execution string that I was not escaping - I escaped them and it now works fine.<br />
<br />
Cheers,<br />
<br />
Neil</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>