<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ReplaceBetween: Replace text between two markers in a file &quot;Including Markers&quot;, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ReplaceBetween: Replace text between two markers in a file &quot;Including Markers&quot; NSIS Discussion" />
	
	<title> ReplaceBetween: Replace text between two markers in a file &quot;Including Markers&quot; [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ReplaceBetween: Replace text between two markers in a file &quot;Including Markers&quot;</div>
<hr />
<div class="pda"><a href="t-330573.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330573">ReplaceBetween: Replace text between two markers in a file &quot;Including Markers&quot;</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">lancelhoff</div><div class="date">13th May 2011, 12:37</div></div><div class="posttext">I seem to be stumped on what should be an easy to resolve... <br />
<br />
Does anyone know how to manipulate Stuarts ReplaceBetween function (http://nsis.sourceforge.net/ReplaceBetween:_Replace_text_between_two_markers_in_a_file) <br />
to replace text from starting marker to ending marker &quot;including the markers&quot;, instead of Between?<br />
<br />
Function ReplaceBetween<br />
 Exch $R0 ; file<br />
 Exch<br />
 Exch $R1 ; replace with<br />
 Exch 2<br />
 Exch $R2 ; before this (marker 2)<br />
 Exch 2<br />
 Exch 3<br />
 Exch $R3 ; after this  (marker 1)<br />
 Exch 3<br />
 Push $R4 ; marker 1 len<br />
 Push $R5 ; marker pos<br />
 Push $R6 ; file handle<br />
 Push $R7 ; temp file handle<br />
 Push $R8 ; temp file name<br />
 Push $R9 ; current line string<br />
 Push $0 ; current chop<br />
 Push $1 ; marker 1 + text<br />
 Push $2 ; marker 2 + text<br />
 Push $3 ; marker 2 len<br />
 <br />
 GetTempFileName $R8<br />
 FileOpen $R7 $R8 w<br />
 FileOpen $R6 $R0 r<br />
 <br />
 StrLen $3 $R3<br />
 StrLen $R4 $R2<br />
 <br />
 Read1:<br />
  ClearErrors<br />
  FileRead $R6 $R9<br />
  IfErrors Done<br />
  StrCpy $R5 -1<br />
 <br />
 FindMarker1:<br />
  IntOp $R5 $R5 + 1<br />
  StrCpy $0 $R9 $3 $R5<br />
  StrCmp $0 &quot;&quot; Write<br />
  StrCmp $0 $R3 0 FindMarker1<br />
   IntOp $R5 $R5 + $3<br />
   StrCpy $1 $R9 $R5<br />
 <br />
  StrCpy $R9 $R9 &quot;&quot; $R5<br />
  StrCpy $R5 0<br />
  Goto FindMarker2<br />
 <br />
 Read2:<br />
  ClearErrors<br />
  FileRead $R6 $R9<br />
  IfErrors Done<br />
  StrCpy $R5 0<br />
 <br />
 FindMarker2:<br />
  IntOp $R5 $R5 - 1<br />
  StrCpy $0 $R9 $R4 $R5<br />
  StrCmp $0 &quot;&quot; Read2<br />
  StrCmp $0 $R2 0 FindMarker2<br />
   StrCpy $2 $R9 &quot;&quot; $R5<br />
 <br />
   FileWrite $R7 $1$R1$2<br />
   Goto Read1<br />
 <br />
 Write:<br />
  FileWrite $R7 $R9<br />
  Goto Read1<br />
 <br />
 Done:<br />
  FileClose $R6<br />
  FileClose $R7<br />
 <br />
  SetDetailsPrint none<br />
  Delete $R0<br />
  Rename $R8 $R0<br />
  SetDetailsPrint both<br />
 <br />
 Pop $3<br />
 Pop $2<br />
 Pop $1<br />
 Pop $0<br />
 Pop $R9<br />
 Pop $R8<br />
 Pop $R7<br />
 Pop $R6<br />
 Pop $R5<br />
 Pop $R4<br />
 Pop $R3<br />
 Pop $R2<br />
 Pop $R1<br />
 Pop $R0<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lancelhoff</div><div class="date">13th May 2011, 14:39</div></div><div class="posttext">Nevermind, I found that the Macro and function Linefind that exists in the included TextFunc.nsh, works just fine for this purpose.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">14th May 2011, 07:54</div></div><div class="posttext">Please don't post large amounts of code. Use either http://pastebin.com or add your code as an attachment.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>