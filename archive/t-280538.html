<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" RequestExecutionLevel &amp; Vista, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  RequestExecutionLevel &amp; Vista NSIS Discussion" />
	
	<title> RequestExecutionLevel &amp; Vista [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  RequestExecutionLevel &amp; Vista</div>
<hr />
<div class="pda"><a href="t-280538.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=280538">RequestExecutionLevel &amp; Vista</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Boneyhead</div><div class="date">2nd November 2007, 01:44</div></div><div class="posttext">Reading through the help for NSIS it states that Vista already detect NSIS installers and decides that admin privileges are needed. Does this mean we can forgo adding RequestExecutionLevel to the script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd November 2007, 02:16</div></div><div class="posttext">Sort of, your installer will be treated as a legacy installer (whatever that means)<br />
<br />
no harm in adding RequestExecutionLevel admin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">abcdgoldfish</div><div class="date">10th June 2009, 02:09</div></div><div class="posttext">Okay, I've been Vista'd and could use some help.  I am trying to copy some font files into C:\Windows\Fonts and have had no success.  I placed the following code in my .nsi file, using UAC_AdminOnly.nsi as a guide.  I got that particular code by following the link to a zip file in nsis.sourceforge.net/UAC_plug-in.<br />
<br />
First line in my .nsi file:<br />
RequestExecutionLevel user<br />
...<br />
!include UAC.nsh<br />
...<br />
!define fontsDir &quot;C:\Windows\Fonts&quot;<br />
Section &quot;MainSection&quot; SEC0<br />
    Rename $INSTDIR\qcsans.ttf ${fontsDir}\myFont.ttf<br />
    Rename $INSTDIR\my_bold.ttf ${fontsDir}\my_bold.ttf<br />
SectionEnd<br />
<br />
Function .onInit<br />
    ${UAC.I.Elevate.AdminOnly}<br />
FunctionEnd<br />
<br />
Function .OnInstFailed<br />
    ${UAC.Unload}<br />
FunctionEnd<br />
 <br />
Function .OnInstSuccess<br />
    ${UAC.Unload}<br />
<br />
FunctionEnd<br />
<br />
Not only are the font files not copied into the folder but, when I try to uninstall, I now get the error message Could not write update &lt;MYENV&gt; to HKLM.  Could someone please shed some light on how to solve this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">10th June 2009, 09:46</div></div><div class="posttext">why are you using the UAC plugin?<br />
<br />
Search for fonts on the wiki for sample code</div></div><hr />


<div class="post"><div class="posttop"><div class="username">abcdgoldfish</div><div class="date">12th June 2009, 20:05</div></div><div class="posttext">Forgive my ignorance but I searched http://nsis.sourceforge.net/Category:Code_Examples which led me to http://nsis.sourceforge.net/Category:Plugins in which the only reference to fonts was the FontName plugin.  This does not appear to do what I need, which is to install the fonts.  Am I missing something obvious?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">abcdgoldfish</div><div class="date">12th June 2009, 20:07</div></div><div class="posttext">For clarification, since the URLs were cleaned up in my previous post:<br />
nsis.sourceforge.net/Category:Code_Examples led me to nsis.sourceforge.net/Category:Plugins</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>