<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Turning Windows 7 features on and off, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Turning Windows 7 features on and off NSIS Discussion" />
	
	<title> Turning Windows 7 features on and off [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Turning Windows 7 features on and off</div>
<hr />
<div class="pda"><a href="t-314807.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=314807">Turning Windows 7 features on and off</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kuroSAVVAS</div><div class="date">23rd November 2009, 14:46</div></div><div class="posttext">I have a project that uses the windows indexing service through Microsoft sql 2008 server. Now Microsoft decided to get rid of this service starting from vista and replaced it with windows search. The thing is that i still need the indexing service for 2 reasons. One is existing code and second is that Microsoft's driver for windows search from sql server does not work! :)<br />
<br />
I found online that you can enable the indexing service again by going to     <br />
Start &gt; Control Panel &gt; Programs &gt; Programs and Features &gt; Turn Windows Features on or off &gt; Indexing Service<br />
<br />
and it works just fine. The problem is that i would like my installer to automatically enable this service. Note that this is not a matter of simply enabling a service (i know how to do that). This is a feature of windows not enabled by default and i need a way to do it automatically.<br />
<br />
Any thoughts?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CancerFace</div><div class="date">24th November 2009, 09:31</div></div><div class="posttext">The Indexing service is called CISVC and can be found in [HKLM]\SYSTEM\CurrentControlSet\services\CISVC<br />
You can check if the key exists or use the service plugin to check if the service is installed and if not create it.<br />
Alternatively you can use the sc.exe command invoked from nsExec to create the service:<br />
nsExec::ExecToLog '&quot;$SYSDIR\sc.exe&quot; create CISVC binpath= &quot;$SYSDIR\cisvc.exe&quot; type= share DisplayName= &quot;@$SISDIR\CISVC.EXE,-1&quot; start= auto depend= RPCSS'<br />
<br />
You may want to manually modify some registry entries after that (adding a description etc). Have a look at the bottom of this (http://www.blackviper.com/Windows_7/Services/Indexing_Service.htm) page to get an idea.<br />
Note that you need elevated privileges to do all the above.<br />
Hope this helps,<br />
CF</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kuroSAVVAS</div><div class="date">24th November 2009, 14:29</div></div><div class="posttext">As it turns out i found a way to enable windows features through the command line. For the indexing service i use this:<br />
<br />
ExecWait 'ocsetup.exe Indexing-Service-Package /passive /quiet'</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>