<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to run a program and wait till it finishes before an uninstall continues?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to run a program and wait till it finishes before an uninstall continues? NSIS Discussion" />
	
	<title> How to run a program and wait till it finishes before an uninstall continues? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to run a program and wait till it finishes before an uninstall continues?</div>
<hr />
<div class="pda"><a href="t-139665.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=139665">How to run a program and wait till it finishes before an uninstall continues?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">20th June 2003, 20:57</div></div><div class="posttext">I need to run a program before an uninstall completes. My application installs services onto the users system and an uninstall will not work as it can not delete any of the services in use.<br />
<br />
I have a batch file which shuts down all the services... I need to call it and have it finish *before* the uninstall continues...<br />
<br />
This should be possible I hope... Can someone please help me with this?<br />
<br />
Thank you for any information on this :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">20th June 2003, 21:18</div></div><div class="posttext">Use ExecWait.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">20th June 2003, 22:32</div></div><div class="posttext">I placed the Execwait command as the first command in the section &quot;section uninstall&quot;. It seems to work like a charm. Wise?<br />
<br />
Thank you Joost for this information :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">22nd June 2003, 23:57</div></div><div class="posttext">i would put execwait in the &quot;Function un.onInit&quot; - this is executed before all other uninstall stuff.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">23rd June 2003, 01:47</div></div><div class="posttext">Thank you Brummelchen,<br />
<br />
I previously had it at the top of the uninstall function call but it seems your method is just as good and will be my preferred method from now on. Thank you<br />
<br />
Now I just have to get these executables to launch in minimized mode or appear not at all...<br />
<br />
Thanks again :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">23rd June 2003, 02:08</div></div><div class="posttext">I looked further into the nsExec function and I think it works without displaying the dos box... I really hope so and this NSIS is getting cooler by the moment. Thank you to everyone for your help :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">23rd June 2003, 08:51</div></div><div class="posttext">Yes that is the whole point of nsExec, plus it allows you to capture output into the stack or to the details window!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">23rd June 2003, 10:11</div></div><div class="posttext">Putting it in the section is better than using un.onInit, because:<br />
<br />
1) It won't be executed if the user quits the uninstaller before uninstalling<br />
2) There is a dialog when the user has to wait</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">23rd June 2003, 10:39</div></div><div class="posttext">@Joost<br />
<br />
In that (1) point you're right - but look yourself what i did <br />
<br />
Function un.onInit<br />
  MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 &quot;&lt;bla&gt; would you like to uninstall '${MUI_PRODUCT}' and all its components?&quot; IDYES +2<br />
  Abort<br />
FunctionEnd<br />
<br />
My first question in the uninstaller<br />
<br />
(2) he is using something like execwait - there is no option to display a messagebox while waiting?<br />
I have problems to understand inserting sections while using the MUI or InsertOptions to get messages.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">23rd June 2003, 12:32</div></div><div class="posttext">Ok, but most people use a confirm page.<br />
<br />
If you put it in a section, you will see the normal installation window (with details, information etc.).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">23rd June 2003, 19:45</div></div><div class="posttext">So far I have ExecWait in the &quot;un.onInit&quot; function area below &quot;Abort&quot; and it seems to do its job pretty good. I've tested it with continuing ahead and in quitting the uninstall early by saying no.<br />
<br />
It seems to so far work without problems. Joost are you referring to the nsExec command in the &quot;un.onInit function area&quot;? That is the command I would like to use but I have no real idea on how to get it to run for an uninstallation.<br />
<br />
The nsExec will not run in either of the uninstall functions or section areas.<br />
<br />
So far ExecWait seems to do its job *but* it is unable to do it with parameters to minimize or hide dos boxes like nsExec does. Is their a solution or a way to call nsExec for an uninstallation?<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">24th June 2003, 00:01</div></div><div class="posttext">What is the problem? nsExec should work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">24th June 2003, 00:21</div></div><div class="posttext">This works using ExecWait in 2.0b3<br />
Function un.onInit<br />
  MessageBox...<br />
  Abort<br />
  ExecWait &quot;$INSTDIR\Core_Shut_Down.bat&quot;<br />
FunctionEnd<br />
And this Works in 2.0b3<br />
Section Uninstall<br />
  ExecWait &quot;$INSTDIR\Core_Shut_Down.bat&quot;<br />
  ...<br />
<br />
But neither of these work in regards to nsExec in 2.0b3<br />
Function un.onInit<br />
  MessageBox...<br />
  Abort<br />
  nsExec::Exec &quot;$INSTDIR\Core_Shut_Down.bat&quot;<br />
FunctionEnd<br />
And neither does this work in 2.0b3<br />
Section Uninstall<br />
  nsExec::Exec &quot;$INSTDIR\Core_Shut_Down.bat&quot;<br />
  ...<br />
<br />
Currently nsExec works in a section only during install but how do I tell uninstall to execute a section before going through with the uninstall? I am considering anything that works in either minimizing or hiding the dos boxes all together... Preferably nsExec.<br />
<br />
Thank you Joost</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">24th June 2003, 01:28</div></div><div class="posttext">Ok I just successfully tweaked my script so to be fully compliant with the latest dev build of 2.0b4. I will get to work on this. Thank you Everyone!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>