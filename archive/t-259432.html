<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Sorting a DropList, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Sorting a DropList NSIS Discussion" />
	
	<title> Sorting a DropList [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Sorting a DropList</div>
<hr />
<div class="pda"><a href="t-259432.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=259432">Sorting a DropList</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ashu.joshi</div><div class="date">13th November 2006, 13:37</div></div><div class="posttext">Dear All ,<br />
<br />
I have been using NSIS for quite some time now and i really find it very useful and interesting.<br />
<br />
Till date all of my queries were answered by seraching through this elaborate Forum of yours. But now i have a query for which i could not find any answers.<br />
<br />
I have created a DropList by using &quot;SendMessage $R3 ${CB_ADDSTRING} 0 &quot;STR:Item1&quot; in a loop.<br />
<br />
But after adding the items i am unable to sort this list. <br />
Pls advise.<br />
<br />
I am using NSIS 2.15 with InstalloptionsEx<br />
<br />
Thanks in advance<br />
<br />
- Ashutosh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th November 2006, 23:43</div></div><div class="posttext">You can set the CBS_SORT style of the combo box. You could do it by calling SetWindowLong with the System plug-in. If that doesn't work, you'll have to create the window with that style in advance. For that, you'd probably have to change the source code of InstallOptionsEx.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ashu.joshi</div><div class="date">15th November 2006, 04:58</div></div><div class="posttext">Thank you so much. Will try it out and let you know the outcome.<br />
<br />
- Ashutosh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ashu.joshi</div><div class="date">15th November 2006, 09:22</div></div><div class="posttext">Hello Kichik,<br />
<br />
Tried using the system plugin with the function mentioned by you, but it does not seem to work. This is what I tried :<br />
<br />
strlen $5 $NEWLIST<br />
                <br />
                intop $5 $5 - 1<br />
                ${For} $R1 0 $5<br />
                strcmp $R1 0 0 +2<br />
                SendMessage $R3 ${CB_ADDSTRING} &quot;STR:None&quot;<br />
                        strcpy $R2 $NEWLIST 1 $R1<br />
                        strcmp $R2 &quot;|&quot; +2<br />
                SendMessage $R3 ${CB_ADDSTRING} 0 &quot;STR:$R2&quot;<br />
                ${next}<br />
                SendMessage $R3 ${CB_SETCURSEL} 0 0<br />
                ;SetWindowLong(hwnd,GWL_STYLE,0)<br />
                ;!define GWL_STYLE -16<br />
                ;!define GWL_EXSTYLE -20<br />
                strcpy $1 68288533 ;&quot;0x2000L&quot; ;&quot;CBS_SORT&quot;<br />
System::Call &quot;user32::SetWindowLongA(i $R3, i ${GWL_STYLE}, i r1)&quot;<br />
<br />
-----------------------------------------------------------<br />
So i just sorted my string before using the CB_ADDSTRING and that solved the problem.<br />
<br />
Thanks you.<br />
<br />
-Ashutosh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">12th April 2010, 16:34</div></div><div class="posttext">looking for the same. i'm using the locate plugin to get a couple of files i want to display in a droplist. looking for some way to sort the files alphabetically.<br />
<br />
any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">12th April 2010, 17:33</div></div><div class="posttext">try setting the CBS_SORT style *before* adding the strings</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">12th April 2010, 18:05</div></div><div class="posttext">try setting the CBS_SORT style *before* adding the strings<br />
<br />
it won't display the control.<br />
<br />
i guess i could use the array plugin, but why should it - if it should work without it</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">12th April 2010, 18:49</div></div><div class="posttext">I thought I had this added to the nsDialogs pages somewhere already, but I guess not.. Stuffed it into the FAQ.<br />
<br />
http://nsis.sourceforge.net/NsDialogs_FAQ#How_to_create_a_sorted_droplist_control<br />
( pages are slow to load again - try again later if it doesn't appear to go anywhere )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">12th April 2010, 21:32</div></div><div class="posttext">thanks animaether, works perfectly</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th April 2010, 23:10</div></div><div class="posttext">For the record you have to get the current style first with GetWindowLong, binary or CBS_SORT with the returned value and set the new value with SetWindowLong.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">12th April 2010, 23:47</div></div><div class="posttext">For the record you have to get the current style first with GetWindowLong, binary or CBS_SORT with the returned value and set the new value with SetWindowLong.<br />
<br />
I couldn't get that to work when I made that header.. maybe I missed something, though...<br />
<br />
<br />
!include &quot;LogicLib.nsh&quot;<br />
!include &quot;nsDialogs.nsh&quot;<br />
!include &quot;WinMessages.nsh&quot;<br />
<br />
/* from: http://nsis.sourceforge.net/NsDialogs_FAQ#How_to_create_a_sorted_droplist_control */<br />
!include &quot;nsDialogs_createDroplistSorted.nsh&quot;<br />
<br />
OutFile test.exe<br />
<br />
XPStyle on<br />
<br />
Var dialog<br />
Var hwnd<br />
Var null<br />
<br />
Page custom nsDialogsPage<br />
<br />
Function nsDialogsPage<br />
<br />
	nsDialogs::Create 1018<br />
		Pop $dialog<br />
<br />
	${NSD_CreateDroplist} 0 0 100% 40% &quot;&quot;<br />
	    Pop $hwnd<br />
	    System::Call &quot;user32::GetWindowLong(i $hwnd,i ${GWL_STYLE}) i.r1&quot;<br />
	    IntOp $1 $1 | ${CBS_SORT}<br />
	    System::Call &quot;user32::SetWindowLong(i $hwnd,i ${GWL_STYLE}, i r1)&quot;<br />
	    ${NSD_CB_AddString} $hwnd &quot;C&quot;<br />
	    ${NSD_CB_AddString} $hwnd &quot;B&quot;<br />
	    ${NSD_CB_AddString} $hwnd &quot;A&quot;<br />
	    /* doesn't work? */<br />
<br />
	${NSD_CreateDroplistSorted} 0 20% 100% 40% &quot;&quot;<br />
	    Pop $hwnd<br />
	    ${NSD_CB_AddString} $hwnd &quot;Z&quot;<br />
	    ${NSD_CB_AddString} $hwnd &quot;Y&quot;<br />
	    ${NSD_CB_AddString} $hwnd &quot;X&quot;<br />
	    /* should work */<br />
<br />
	nsDialogs::Show<br />
FunctionEnd<br />
<br />
Section<br />
SectionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>