<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" problems registering DLL files, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  problems registering DLL files NSIS Discussion" />
	
	<title> problems registering DLL files [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  problems registering DLL files</div>
<hr />
<div class="pda"><a href="t-201326.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=201326">problems registering DLL files</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mike1998</div><div class="date">6th December 2004, 19:30</div></div><div class="posttext">I'm having some problems getting NSIS to properly register several DLLs.  Only these particular DLLs are giving me a problem:<br />
<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED \<br />
               &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\dtsffile.dll&quot; \<br />
               &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools\dtsffile.dll&quot; \<br />
               &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED \<br />
              &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\dtspkg.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools\dtspkg.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED \<br />
              &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\dtspump.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools\dtspump.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED \<br />
              &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\axscphst.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools\axscphst.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED \<br />
              &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\custtask.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools\custtask.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
<br />
<br />
In the install.log file It show the following lines:<br />
<br />
IfFileExists: file &quot;C:\Program Files\Common Files\Mustang Shared\DTS Tools\dtsffile.dll&quot; exists, jumping 0<br />
Error registering DLL: Could not load C:\Program Files\Common Files\Mustang Shared\DTS Tools\dtsffile.dll<br />
Jump: 611<br />
IfFileExists: file &quot;C:\Program Files\Common Files\Mustang Shared\DTS Tools\dtspkg.dll&quot; exists, jumping 0<br />
Error registering DLL: Could not load C:\Program Files\Common Files\Mustang Shared\DTS Tools\dtspkg.dll<br />
Jump: 654<br />
IfFileExists: file &quot;C:\Program Files\Common Files\Mustang Shared\DTS Tools\dtspump.dll&quot; exists, jumping 0<br />
Error registering DLL: Could not load C:\Program Files\Common Files\Mustang Shared\DTS Tools\dtspump.dll<br />
Jump: 697<br />
IfFileExists: file &quot;C:\Program Files\Common Files\Mustang Shared\DTS Tools\axscphst.dll&quot; exists, jumping 0<br />
Error registering DLL: Could not load C:\Program Files\Common Files\Mustang Shared\DTS Tools\axscphst.dll<br />
Jump: 740<br />
IfFileExists: file &quot;C:\Program Files\Common Files\Mustang Shared\DTS Tools\custtask.dll&quot; exists, jumping 0<br />
Error registering DLL: Could not load C:\Program Files\Common Files\Mustang Shared\DTS Tools\custtask.dll<br />
Jump: 783<br />
<br />
<br />
Any items what could be causing the problem?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mike1998</div><div class="date">6th December 2004, 19:37</div></div><div class="posttext">I should also add that registering the files manually with regsvr32.exe works fine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">7th December 2004, 09:05</div></div><div class="posttext">No clue about this but as a starter you could try putting quotation marks around REBOOT_NOTPROTECTED.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th December 2004, 19:26</div></div><div class="posttext">Make sure that all of the DLL's dependencies are in place and that they can be found. In your case, you probably just need to use:SetOutPath &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;SetOutPath sets the current working directory. That's one of the places Windows looks for dependencies.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mike1998</div><div class="date">10th December 2004, 15:30</div></div><div class="posttext">Originally posted by kichik <br />
Make sure that all of the DLL's dependencies are in place and that they can be found. In your case, you probably just need to use:SetOutPath &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;SetOutPath sets the current working directory. That's one of the places Windows looks for dependencies.  <br />
<br />
You were right.  These DLLs require various RLL files (resource files) to be in the \Resource\1033\ subdirectory, while the fiels *were* being put there first, apparently it couldn't find them becuase the output path was the sysdir at the time of registration.<br />
<br />
So rule-of-thumb now: If your files require RLL files, you must set the output path first if you us the new InstallLib macros.<br />
<br />
Here is the new, complete script to install the SQL Server 2000 DTS files:<br />
  ; MS SQL Server (DTS) Components<br />
  SetOutPath &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools\Resources\1033&quot;<br />
  File &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\Resources\1033\dtsffile.rll&quot;<br />
  File &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\Resources\1033\dtspkg.rll&quot;<br />
  File &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\Resources\1033\dtspump.rll&quot;<br />
  File &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\Resources\1033\axscphst.rll&quot;<br />
  File &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\Resources\1033\dtsrun.rll&quot;<br />
  File &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\Resources\1033\custtask.rll&quot;<br />
  SetOutPath &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
  File &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\sqlresld.dll&quot;<br />
  File &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\dtsrun.exe&quot;<br />
  SetOutPath $SYSDIR<br />
  File &quot;C:\Windows\System32\sqlunirl.dll&quot;<br />
  SetOutPath &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED \<br />
               &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\dtsffile.dll&quot; \<br />
               &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools\dtsffile.dll&quot; \<br />
               &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED \<br />
              &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\dtspkg.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools\dtspkg.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED \<br />
              &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\dtspump.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools\dtspump.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED \<br />
              &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\axscphst.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools\axscphst.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED \<br />
              &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\custtask.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools\custtask.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vazagothic</div><div class="date">10th December 2004, 20:03</div></div><div class="posttext">What about a problem with InstallLib where it crashes the installer on WinXP and it doesn't crash on Win2000 (I try to register<br />
few OCX files) ?<br />
<br />
I use clean installs of Win2K and WinXP and the installer crashes every time (I use Virtual PC as well as &quot;live&quot; PC to test it)<br />
<br />
WinXP Error:<br />
<br />
AppName: setup.exe	 <br />
AppVer: 0.0.0.0	 <br />
ModName: msvcrt.dll<br />
ModVer: 7.0.2600.1106	 <br />
Offset: 000216af<br />
<br />
It installs w/o a problem on clean installations of WinME, Win98SE and Win2K.<br />
<br />
<br />
SetOutPath $INSTDIR <br />
!insertmacro InstallLib RegDLL $ALREADY_INSTALLED REBOOT_PROTECTED ctListBar.ocx $INSTDIR\ctListBar.ocx $INSTDIR<br />
!insertmacro InstallLib RegDLL $ALREADY_INSTALLED REBOOT_PROTECTED ctNavBar.ocx  $INSTDIR\ctNavBar.ocx  $INSTDIR<br />
!insertmacro InstallLib RegDLL $ALREADY_INSTALLED REBOOT_PROTECTED ctToolBar.ocx $INSTDIR\ctToolBar.ocx $INSTDIR<br />
; Shortcuts to Somewhere in Start Menu and on Desktop<br />
CreateDirectory &quot;$SMPROGRAMS\Somewhere&quot;<br />
CreateShortCut  &quot;$SMPROGRAMS\Somewhere\Somewhere.lnk&quot;         &quot;$INSTDIR\Somewhere.exe&quot;<br />
CreateShortCut  &quot;$DESKTOP\Somewhere.lnk&quot;                      &quot;$INSTDIR\Somewhere.exe&quot;<br />
 <br />
<br />
Brings the following errors:<br />
[...]<br />
Extract: C:\Program Files\Somewhere\ctListBar.ocx<br />
Could not load: C:\Program Files\Somewhere\ctListBar.ocs<br />
Extract: C:\Program Files\Somewhere\ctListBar.ocx<br />
Could not load: C:\Program Files\Somewhere\ctListBar.ocs<br />
Extract: C:\Program Files\Somewhere\ctListBar.ocx<br />
Could not load: C:\Program Files\Somewhere\ctListBar.ocs<br />
Create folder C:\Documets and Settings\All Users\Start Menu\Somewhere<br />
<br />
and then it crashed with the mentioned error.<br />
<br />
Any ideas ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th December 2004, 20:07</div></div><div class="posttext">Probably a missing dependency. It is also possible the OCX is not compatible with Windows XP.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vazagothic</div><div class="date">10th December 2004, 20:47</div></div><div class="posttext">I can register them manually using RegSvr32.exe.<br />
<br />
Hmm, I did create a simple installer which just registers those OCXs and it worked. I must have messed something with my script. I will check it now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vazagothic</div><div class="date">10th December 2004, 21:52</div></div><div class="posttext">Finally got it nailed - it turned out that the OCX files had to be registered before other DLLs (even if the DLLs didn't require those OCX files at all)<br />
<br />
Now it works perfectly under WinXP, Win2K, etc :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MAmorim</div><div class="date">22nd September 2005, 02:58</div></div><div class="posttext">Originally posted by mike1998 <br />
You were right.  These DLLs require various RLL files (resource files) to be in the \Resource\1033\ subdirectory, while the fiels *were* being put there first, apparently it couldn't find them becuase the output path was the sysdir at the time of registration.<br />
<br />
So rule-of-thumb now: If your files require RLL files, you must set the output path first if you us the new InstallLib macros.<br />
<br />
Here is the new, complete script to install the SQL Server 2000 DTS files:<br />
  ; MS SQL Server (DTS) Components<br />
  SetOutPath &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools\Resources\1033&quot;<br />
  File &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\Resources\1033\dtsffile.rll&quot;<br />
  File &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\Resources\1033\dtspkg.rll&quot;<br />
  File &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\Resources\1033\dtspump.rll&quot;<br />
  File &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\Resources\1033\axscphst.rll&quot;<br />
  File &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\Resources\1033\dtsrun.rll&quot;<br />
  File &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\Resources\1033\custtask.rll&quot;<br />
  SetOutPath &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
  File &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\sqlresld.dll&quot;<br />
  File &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\dtsrun.exe&quot;<br />
  SetOutPath $SYSDIR<br />
  File &quot;C:\Windows\System32\sqlunirl.dll&quot;<br />
  SetOutPath &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED \<br />
               &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\dtsffile.dll&quot; \<br />
               &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools\dtsffile.dll&quot; \<br />
               &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED \<br />
              &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\dtspkg.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools\dtspkg.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED \<br />
              &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\dtspump.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools\dtspump.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED \<br />
              &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\axscphst.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools\axscphst.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED \<br />
              &quot;C:\Program Files\Microsoft SQL Server\80\Tools\Binn\custtask.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools\custtask.dll&quot; \<br />
              &quot;$PROGRAMFILES\Common Files\Mustang Shared\DTS Tools&quot;<br />
  <br />
The Best Solution, Congratulations!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jholguin</div><div class="date">23rd February 2007, 17:27</div></div><div class="posttext">This worked for me as well when I was trying to register FoxPro 9 Runtimes even though I wasn't using RLL files. Thanks!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>