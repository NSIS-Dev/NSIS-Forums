<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Find and Close or Terminate plug-in and macro, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Find and Close or Terminate plug-in and macro NSIS Discussion" />
	
	<title> Find and Close or Terminate plug-in and macro [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Find and Close or Terminate plug-in and macro</div>
<hr />
<div class="pda"><a href="t-231493.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=231493">Find and Close or Terminate plug-in and macro</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">20th November 2005, 12:55</div></div><div class="posttext">Running application that installer intends to replace or remove is a common problem, and this is why we can find so many  samples on the forum how to find window and close it or how to kill process by name :). I don't like process termination as a first step (not saved data loss, exe file may stay marked 'in use' and cause a reboot), so I wrote combined script, it finds window and first tries to close it but, if process is still alive after timeout, terminates application. Not a big deal, but this looks more safe for me, this is link to Find and Close or Terminate (http://nsis.sourceforge.net/Find_and_Close_or_Terminate) macro.<br />
But there are 2 problems with this macro: in the 'safe' (not looping) version it closes one instance of application only; System plug-in required. System plug-in is not so big (10 kB), but I had to include it both to installer and uninstaller (double size). And the only reason for this in some packages is safe program termination only (using my macro). This is why I uploaded very compact (2 kB in zip) Close or Terminate (http://nsis.sourceforge.net/Close_or_Terminate) plug-in, it scans all top level windows using EnumWindows and closes or terminates all instances of application. It also can find window by part of it's title (caption). Compare to System plug-in I could use simple script and reduce package size (-4 kB for installer only, the same for uninstaller). BTW Afrow UK wrote (http://forums.winamp.com/showthread.php?postid=1761400#post1761400) about this not long ago ;).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>