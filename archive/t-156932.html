<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Multi-User Install Logic, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Multi-User Install Logic NSIS Discussion" />
	
	<title> Multi-User Install Logic [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Multi-User Install Logic</div>
<hr />
<div class="pda"><a href="t-156932.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=156932">Multi-User Install Logic</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jaschulz</div><div class="date">20th November 2003, 19:33</div></div><div class="posttext">Can anyone point me to a document that explains the logic of installing software on a machine with multiple users.  For instance, many example NSIS scripts put the software in C:\Program Files\MyApp (or something of the sort) and then makes the install user specific by placing info under the HKCU key in the reg.  Okay, suppose two users install my app on the same machine.  The second install over-writes the copy of my app already in place in c:\Program Files\MyApp (which is fine assuming that both installs are of the same version number).  But now one user decides to uninstall.  Doesn't that effectively unstall MyApp for the second user as well?  What is the right way to handle this sort of thing?<br />
<br />
JAS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">myne</div><div class="date">20th November 2003, 19:43</div></div><div class="posttext">So in that scenario you shouldnt use HKCU, you should use HKLM\software instead. For the startmenu you should use $ALLUSERSPROFILE\startmenu. (cmd &gt; set [enter] - it's a windows variable)<br />
<br />
That will make the install into a generic one availiable to all users - I assume this is what you are asking? Ofcourse if one user uninstalls they'll all uninstall<br />
<br />
Hope this helps</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jaschulz</div><div class="date">20th November 2003, 19:48</div></div><div class="posttext">Well, that's part of what I need to know.  Using your info, I can see that I could offer the installer the choice between making the app available to all users, or installing it only for the current user.  But I am still left with my question about what happens if two users of the same machine chose the second of these options (i.e. if each of them installs only for himself).  In that circumstance, doesn't one user deciding to uninstall effectively unstall for the other user as well?<br />
<br />
JAS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">myne</div><div class="date">20th November 2003, 19:54</div></div><div class="posttext">Well yes, it would delete the files rendering the program unusable to others. However if they both installed it then one user would still have (useless) start menu shortcuts</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jaschulz</div><div class="date">20th November 2003, 22:47</div></div><div class="posttext">So, I suppose, the only way to avoid this is to have the installer keep a record in the registry of how many users there are.  Am I the only one who has ever worried about this?<br />
<br />
JAS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">myne</div><div class="date">21st November 2003, 00:40</div></div><div class="posttext">You could just tell your users not to uninstall things without permission...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>