<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with System::Call under WinXP SP1, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with System::Call under WinXP SP1 NSIS Discussion" />
	
	<title> Problem with System::Call under WinXP SP1 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with System::Call under WinXP SP1</div>
<hr />
<div class="pda"><a href="t-209322.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=209322">Problem with System::Call under WinXP SP1</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ImmortAlex</div><div class="date">2nd March 2005, 11:58</div></div><div class="posttext">I have a very strange problem with System plugin.<br />
My installer use my own DLL to validate serial number by calling some functions with System::Call. All works fine everywhere, in any Windows I can reach, except Windows XP SP1 (tested on 4 different machine).<br />
Investigating this problem I find, that it doesn't work when I unpack my DLL into $PLUGINSDIR, but work from any other place.<br />
Very strange bug... What was broken in XP SP1?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">2nd March 2005, 14:14</div></div><div class="posttext">Did you try InitPluginsDir before using $PLUGINSDIR?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ImmortAlex</div><div class="date">3rd March 2005, 02:43</div></div><div class="posttext">Of course! There are a lot of files that I need in this folder (plugins, InstallOptions' INIs), and they all are there. Moreover IfFileExists shows that my DLL is in $PLUGINSDIR, but System::Call doesn't call functions from it.<br />
I even wrote very simple DLL in BC++, consists of one function displaying MessageBox, and I can't call this function in XP SP1 ! In any other OS (XP SP2, 2K SP4 for example) all works fine. And it works from $SYSDIR.<br />
<br />
I'm trying to recompile System plugin in BC++, but have no luck, so I can't debug this situation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ImmortAlex</div><div class="date">3rd March 2005, 05:04</div></div><div class="posttext">Seems like I have solved this problem.<br />
Reading appendix D.4 of manual I found that &quot;you have to change the output directory to that where the DLL you want to use is&quot;. While I wrote full path to my DLL like<br />
System::Call &quot;$PLUGINSDIR\my.dll::func()&quot;<br />
<br />
It's strange, but the only one OS where it doesn't work was XP SP1...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">3rd March 2005, 11:15</div></div><div class="posttext">SetOutPath &quot;$PLUGINSDIR&quot;<br />
might also help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ImmortAlex</div><div class="date">3rd March 2005, 11:19</div></div><div class="posttext">My previous post is about it. May be I was very short? :)<br />
Yes, I solve the problem with SetOutPath.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>