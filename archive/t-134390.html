<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" More questions..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  More questions... NSIS Discussion" />
	
	<title> More questions... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  More questions...</div>
<hr />
<div class="pda"><a href="t-134390.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=134390">More questions...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th May 2003, 16:00</div></div><div class="posttext">1. I'm trying to set a branding image on the top of my nsis dialog, using the modern ui code.<br />
I have this part, but it doesn't seem to be enough to get it working.<br />
What would I need to add into my script to get this to work (without using modern ui - because my whole app is using custom pages)<br />
Here's what I have so far:[code    File &quot;/oname=$TEMP\ddayupdater\logo.bmp&quot; &quot;${NSISDIR}\ddayupdater\logo.bmp&quot;<br />
    SetBrandingImage /IMGID=1046 /RESIZETOFIT &quot;$TEMP\ddayupdater\logo.bmp&quot;[/code]<br />
<br />
2. My app is going to download updates from a list on the web. Is it possible to get an exe file version? I want to be able to compare the version of an executable on their hdd to the version that will be in the web list.<br />
Is the UpgradeDLL macro a good solution to this? I will need to get the dll version of the dll on the users' hard drive (and exe versions), and then compare them to the versions I have written into my web list (which I will have to update manually)<br />
<br />
Thanks<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">5th May 2003, 16:39</div></div><div class="posttext">1) Use AddBrandingImage<br />
<br />
2) You can find a plug-in in the archive</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th May 2003, 17:29</div></div><div class="posttext">Whats the plugin called? I can't find one that will get an exe version.<br />
<br />
Does UpgradeDLL only replace the dll if it is older than the dll that is going to be copied?<br />
<br />
NM, UpgradeDLL isn't want I need. Just need to get the dll / exe versions now...<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">5th May 2003, 17:45</div></div><div class="posttext">Sysinfo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th May 2003, 17:54</div></div><div class="posttext">Is there an example of where AddBranding image is used.<br />
I want to add an image just like on the NSIS Installer exe has - modern-header.bmp.<br />
I want to get that image there without using Modern UI.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th May 2003, 18:38</div></div><div class="posttext">Hmm. Sysinfo doesn't seem to output any of the versions. Some of them apparently have no version.<br />
I'm even trying to get dll versions of system files (in the demo.nsi script) but it doesn't even print dll / file versions of them either.<br />
<br />
Is there a problem?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th May 2003, 18:47</div></div><div class="posttext">I just opened up the SysInfo.nsi script.<br />
I'm using examples from the SysInfo.nsi script like so:<br />
sysinfo::GetFileVersionValue 'FileVersion' 'C:\quake2\quake2.exe'<br />
Pop $R0<br />
DetailPrint $R0<br />
It still doesn't print a file version. I'm also trying to get versions of some dll files in that directory, and all of them do not print any dll versions.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">5th May 2003, 18:56</div></div><div class="posttext">Check the file properties in Windows. Do they have version numbers?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th May 2003, 19:08</div></div><div class="posttext">On WinXP, the version numbers for these dll's are printed below the file name, and also an extra 'file version' properties tab is there. The dll's I am using don't have these versions printed.<br />
<br />
A friend says I need to register these dll's before I can get the dll versions. Is this what I need to do?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">5th May 2003, 20:03</div></div><div class="posttext">That's not true. These DLL's don't have version info, you have to use the date or something else to identify them (use GetFileTime).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th May 2003, 20:15</div></div><div class="posttext">Ok thanks<br />
I will use that function on the archive :)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th May 2003, 21:00</div></div><div class="posttext">Hmm, looking at http://nsis.sourceforge.net/archive/nsisweb.php?page=218&amp;instances=0,11,211<br />
<br />
Do you think it would be possible to modify this to get the files' creation date?<br />
I think a custom function would be nice, just to get the creation date. I don't need the time or anything.<br />
I have no-idea where to start though - I'm only good at string functions!<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">5th May 2003, 21:09</div></div><div class="posttext">Use GetFileTime and compare the output (higher = new file).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th May 2003, 15:30</div></div><div class="posttext">I can't get SysInfo because all of the downloads on the Archive are gone (?!?!?!) but afaik SysInfo is not such a new plug-in and might have even been created before the stack pushing order was revesred. Try:<br />
<br />
sysinfo::GetFileVersionValue 'C:\quake2\quake2.exe' 'FileVersion'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th May 2003, 15:54</div></div><div class="posttext">That doesn't work either :(<br />
I will have to use GetFileTime instead. With GetFileTime, should I get the high end and low end dwords and combine them into 1 string for a definate file identity?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th May 2003, 16:11</div></div><div class="posttext">This thread should help: http://forums.winamp.com/showthread.php?s=&amp;threadid=112059&amp;highlight=GetFileTime</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>