<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MSIBANNER driven by InetLoad, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MSIBANNER driven by InetLoad NSIS Discussion" />
	
	<title> MSIBANNER driven by InetLoad [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MSIBANNER driven by InetLoad</div>
<hr />
<div class="pda"><a href="t-203472.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=203472">MSIBANNER driven by InetLoad</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">30th December 2004, 20:10</div></div><div class="posttext">is there a way to have InetLoad  drive MSIBanner for a very simple progress bar...be great to use it for updating small files... InetLoad in popup mode is still a little too complicated for my users ;)  Just having a simple graphic-only progress bar in the .oninit would be quite cool :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">31st December 2004, 01:02</div></div><div class="posttext">mmm, what's InetLoad? :/<br />
<br />
MSIBanner have a simple progress bar... or I missed something?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">31st December 2004, 01:39</div></div><div class="posttext">InetLoad is quite a cool ftp/http plugin created by Takir [sp?] that works with proxy networks. I am using the InetLoad plugin[not in POPUP mode] rather than NSISDL.  NSISDL could not cut thru my client's proxy.<br />
As far as MSIBANNER, I was wondering if you could feed it actual percentage download values rather than faking the progress bar with something like<br />
Function bannerLoop<br />
strcpy $count 0<br />
strcpy $loopTotal 10<br />
;<br />
loop:<br />
MSIBanner::UPDATE /NOUNLOAD &quot;$bannerText&quot;<br />
sleep ${delay}<br />
IntOp $count $count + 1<br />
strcmp $count $loopTotal loopFinished loop<br />
;<br />
loopFinished:<br />
strcpy $count &quot;0&quot;<br />
FunctionEnd<br />
<br />
many thanks for the plug Lobo as I am using it for a system check in the .onInit :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">31st December 2004, 02:46</div></div><div class="posttext">I was wondering if you could feed it actual percentage<br />
<br />
I can try :)<br />
But it will be after new year, I got to finish an old project first.<br />
<br />
many thanks for the plug Lobo as I am using it for a system check in the .onInit <br />
<br />
thanks to you.... :)<br />
but, may I ask you: After the MSIBanner is destroy, the NSIS is in minimized state?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">31st December 2004, 09:41</div></div><div class="posttext">2 grahama: If you have MS VS installed, you can create your own version of plug-in dialog, just make some controls &quot;not visible&quot;. As a variant - see attached zip.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">31st December 2004, 17:24</div></div><div class="posttext">many thanks, Takhir.  That inetLoad plug is a real life saver.  Thanks for the ability to integrate it back into the MUI.;really helped :)<br />
To Lobot:<br />
after I destroy the banner, a custom media player is launched or the user is taken to the  'First Install' page.  I use NSIS to either launch the main file or install/update...then launch the main file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">31st December 2004, 17:43</div></div><div class="posttext">inetLoadltd is Very Cool :)<br />
Would it be difficult for POPUP to mimic  MSIBANNER<br />
1)inclusion of MUI_ICON in the header of the POPUP<br />
2) inclusion of a text string variable...like $bannerText in the above function<br />
3) use roughly the same dimensions of MSIBanner..or even make it definable<br />
This would be perfect solution [and very slick] to downloading ini files and updating certain small files in the .onInit stage.  For myself, I download an ini file and check that against the registry.  If only a few [small]files need to be replaced/downloaded, I update them in the onInit stages.  This is easiser on the user who does not have to go thru the whole installation process every time an individual file is updated. One big 'first install' is enough.<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">31st December 2004, 18:55</div></div><div class="posttext">Originally posted by grahama many thanks, Takhir.  That inetLoad plug is a real life saver.<br />
Agreed, this is one of the best plugin i've seen.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">1st January 2005, 07:56</div></div><div class="posttext">Thanks and Happy New Year!<br />
We have 10 days New Year state holidays in Russia, so I'll probably can make changes in this (specific) version soon :) If grahama could send me required banner design (image), this would be easier for me. ineum(monkey)narod.ru <br />
And this is a little program (120 kB package) with NSIS installer http://ineum.narod*****mgr_en.htm ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">3rd January 2005, 09:01</div></div><div class="posttext">This is how I see it - InetLoad in .onInit with MSI banner design. New /BANNER parameter for the text to be displayed (this version only) - see Readme.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">4th January 2005, 09:04</div></div><div class="posttext">Takhir - 10 days that's really cool! Do you get Christmas holiday as well?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">4th January 2005, 11:06</div></div><div class="posttext">Russia celebrates Christmas January 7, so holidays includes it ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">5th January 2005, 19:35</div></div><div class="posttext">Finally I wrote version with all 3 &quot;display modes&quot; support, direct link  http://nsis.sourceforge.net/archive/download.php?file=InetLoad.zip and archive page http://nsis.sourceforge.net/archive/nsisweb.php?page=671&amp;instances=0,32</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">5th January 2005, 22:27</div></div><div class="posttext">wow<br />
thanks Takhir<br />
I just got back from vacation...no internet...kind of a relief...to be unplugged for a while<br />
Banner mode will be very very slick and professional looking <br />
Looking forward to checking out your great work :)<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">6th January 2005, 02:46</div></div><div class="posttext">Hi Takhir, happy new year :)<br />
do you think you can:<br />
1) integrate the MUI_ICON into /BANNER mode <br />
2) set up a header text for the  inetLoad plug in /BANNER mode ...<br />
an example of this for MSIBANNER would be<br />
MSIBANNER::SHOW /NOUNLOAD &quot;Welcome to Fonovisa&quot; &quot;Checking your system&quot;<br />
'Welcome to Fonovisa' becomes the header text [does not change] <br />
and 'Checking your System' becomes the main text which can change each time you MSIBANNER::UPDATE <br />
As long as the banner has not been destroyed, the header text for the plug will always say... Welcome to Fonovisa.   pretty cool<br />
<br />
many thanks for all of your hard work....<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">6th January 2005, 07:25</div></div><div class="posttext">1) do you want to define icon file in the command line?<br />
2) finally it's possible to define caption text, but please note that plug-in currently implements &quot;modal&quot; dialog. This means that &quot;load&quot; call returns when plug-in finishes all it's jobs only. So UPDATE's are not possible now. MSI BANNER works in the modeless (detached) mode.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">6th January 2005, 10:15</div></div><div class="posttext">Integration is a good idea, OK, I know how to extract first installerâ€™s icon from exe file. Tested on 98 SE and XP Pro only, W2K test required :) Test package attached.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>