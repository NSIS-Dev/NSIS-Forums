<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" CreateShortCut adds drive letter ???, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  CreateShortCut adds drive letter ??? NSIS Discussion" />
	
	<title> CreateShortCut adds drive letter ??? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  CreateShortCut adds drive letter ???</div>
<hr />
<div class="pda"><a href="t-90351.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=90351">CreateShortCut adds drive letter ???</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">veekee</div><div class="date">8th June 2002, 12:19</div></div><div class="posttext">Hi,<br />
<br />
Someone asks me in a french nsis forum about a problem with the CreateShortCut function ! I asked him to llokup in the doc but i found his problem quite stange !<br />
He wanted to use parameters in the shortcup, and use the direct method :<br />
CreateShortCut &quot;$INSTDIR\Play HLP.lnk&quot; &quot;'$INSTDIR\halflife.exe' -console -dev -game Hl-Parpaing&quot;<br />
<br />
:D<br />
<br />
I know that this is not the wrong way to use that function, but if this is executed by NSIS, the shortcut links to : &quot;C:\'E:\HalfLife\halflife.exe' -console -dev -game Hl-Parpaing&quot;<br />
<br />
C:/ was added at the begining ? Does anyone knows why ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th June 2002, 12:47</div></div><div class="posttext">I know that this is not the wrong way to use that function, but if this is executed by NSIS, the shortcut links to : &quot;C:\'E:\HalfLife\halflife.exe' -console -dev -game Hl-Parpaing&quot; <br />
<br />
As a matter of fact, it IS the wrong way of using this function. The parameters should come in a seperate string. And it does show in the docs:<br />
<br />
CreateShortCut link.lnk target.file [parameters] [icon.file] [icon_index_number] [start_options] [keyboard_shortcut]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">veekee</div><div class="date">8th June 2002, 12:57</div></div><div class="posttext">Sur, this is in the doc ... the fact is : is there a logical reason that NSIS links to &quot;C:\'E:\HalfLife\halflife.exe' -console -dev -game Hl-Parpaing&quot; instead of &quot;'E:\HalfLife\halflife.exe' -console -dev -game Hl-Parpaing&quot; ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th June 2002, 13:09</div></div><div class="posttext">The reason there are two strings is that this is the way Windows does it. The Windows function that creates the shortcut gets two parameters, one for the path and one for the shortcut parameters.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">veekee</div><div class="date">8th June 2002, 13:33</div></div><div class="posttext">but why, when using one parameter (intead of the two required), is there a c:\ that appears ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th June 2002, 14:23</div></div><div class="posttext">Because it does not know a drive marked with a &quot;, so it adds the default drive letter. This is what Windows does, NSIS has nothing to do with it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">veekee</div><div class="date">8th June 2002, 14:30</div></div><div class="posttext">aarg, so simple ! Thanks a lot kichik : you were very patient ;) (:igor: &lt;- me :D) !</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>