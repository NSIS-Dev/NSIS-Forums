<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" $DOCUMENTS not pointing to the correct folder in Windows 7, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  $DOCUMENTS not pointing to the correct folder in Windows 7 NSIS Discussion" />
	
	<title> $DOCUMENTS not pointing to the correct folder in Windows 7 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  $DOCUMENTS not pointing to the correct folder in Windows 7</div>
<hr />
<div class="pda"><a href="t-334225.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=334225">$DOCUMENTS not pointing to the correct folder in Windows 7</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">alex001</div><div class="date">30th August 2011, 17:07</div></div><div class="posttext">Hello,<br />
i try to install some file to a standard's user My Documents folder in Windows 7.<br />
<br />
The problem is that the files are installed in the My Documents folder of the administrator instead !!<br />
<br />
Is not the constant $DOCUMENTS working in Windows 7 correctly ?<br />
<br />
Thank you <br />
Alex</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">30th August 2011, 17:43</div></div><div class="posttext">requestexecutionlevel user<br />
<br />
<br />
(Reason: Win7 auto-elevates NSIS installers if they don't have a manifest.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alex001</div><div class="date">30th August 2011, 19:00</div></div><div class="posttext">ok thanks for the quick answer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alex001</div><div class="date">31st August 2011, 09:14</div></div><div class="posttext">Hello,<br />
that is not a solution. Now i cannot install any application to Program Files etc.<br />
<br />
Admin level is required.<br />
<br />
Isn't there another workaround ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">31st August 2011, 11:09</div></div><div class="posttext">If your installer is running at admin level (which is necessary if you want to install to $PROGRAMFILES), you have no business writing to a user's documents folder. An installer that requires admin access should always install for all users (this is simply how Windows is designed). Therefore you should be using the allusers Documents folder (simply use setshellvarcontext all for this).<br />
<br />
Conversely, if you want to do stuff at userlevel (such as writing to one user's documents), the whole install should be executed at userlevel. This means you should install to $APPDATA or $LOCALAPPDATA instead of $PROGRAMFILES, and write to HKCU instead of HKLM.<br />
<br />
<br />
<br />
Edit: And note that for proper Win7 compatibility, you should add requestexecutionlevel (admin or user) to your installer in any case.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>