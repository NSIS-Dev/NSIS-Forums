<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" WinVista non-admin Install/uninstall issues, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  WinVista non-admin Install/uninstall issues NSIS Discussion" />
	
	<title> WinVista non-admin Install/uninstall issues [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  WinVista non-admin Install/uninstall issues</div>
<hr />
<div class="pda"><a href="t-272649.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=272649">WinVista non-admin Install/uninstall issues</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">rkdurtschi</div><div class="date">11th June 2007, 13:46</div></div><div class="posttext">Hello,<br />
Please consider this question about using NSIS v2.8. I am attempting to install my app on PC's running VISTA.<br />
My install script includes the following:<br />
<br />
RequestExecutionLevel admin<br />
<br />
When logged on to the target PC as an admin, My app installs and uninstalls GREAT :) When logged on as non-admin, the app installs successfully, but I get no shortcuts. I only get shortcuts on the admins account.<br />
<br />
What I want is to install/uninstall my app from either the admin OR the non-admin account and get shortcuts on the respective account I install from.<br />
<br />
Is there any way to accomplish this task?<br />
(carefully read thread: Shortcuts on Vista, Alex5 5-23-2007, but didn't see a solution there)<br />
<br />
Many thanks!!!<br />
<br />
Roger</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">11th June 2007, 19:05</div></div><div class="posttext">This is how UAC works, if you don't want to deal with vista, put the shortcuts in the all users start menu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rkdurtschi</div><div class="date">13th June 2007, 03:49</div></div><div class="posttext">Thanks (I noticed Mozilla Firefox installs to All Users when installing their app on Vista machines).<br />
<br />
One more ?<br />
<br />
Is there and NSIS script that causes the path to point to the All Users dir for the install and the uninstall?<br />
<br />
I'm looking for the script to return this path for the All Users program shortcuts: C:\ProgramData\Microsoft\Windows\Start Menu\Programs<br />
<br />
And the script to return this path for All Users desktop shortcuts:<br />
 C:\Users\Public\Public Desktop<br />
<br />
Thanks a million for your time.<br />
Roger</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">13th June 2007, 05:22</div></div><div class="posttext">SetShellVarContext all</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>