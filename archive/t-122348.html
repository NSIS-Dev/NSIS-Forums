<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" OT: registering a shell extension, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  OT: registering a shell extension NSIS Discussion" />
	
	<title> OT: registering a shell extension [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  OT: registering a shell extension</div>
<hr />
<div class="pda"><a href="t-122348.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=122348">OT: registering a shell extension</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">honold</div><div class="date">22nd January 2003, 04:45</div></div><div class="posttext">i would like to register an EXTENSION-SPECIFIC shell extension to a right-click menu; namely, when one right-clicks on a .iso image i would like a 'burn image' option which would execute the app i want (cdrecord).<br />
<br />
i traced around misc existing ones in my registry, but they all seem to reference specifically-named 'keys' like {1111-0000-AAAA-FFFF-DDDD}, so i'm a bit lost.  i've got the sample listed below, but i don't know how to generate a UNIQUE key for any system.<br />
<br />
- edit:<br />
<br />
i got even further now, found i can use uuidgen or guidgen (wonder what the difference is) from the ms platform sdk to make these.  is this my only way?  would i have to include this in my installer, pipe the output to a file, read in the file, etc?<br />
<br />
REGEDIT4<br />
<br />
	[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.zzz]<br />
	@ = &quot;zzzfile&quot;<br />
<br />
	[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\zzzfile]<br />
	@ = &quot;a zzz file&quot;<br />
<br />
	[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\zzzfile\shellex\<br />
		ContextMenuHandlers\{11111...}]<br />
	@ = &quot;&quot;<br />
<br />
	[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{11111...}]<br />
	@ = &quot;a zzz file&quot;<br />
<br />
	[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{11111...}\InProcServer32]<br />
	@ = &quot;c:\\myshellextension.dll&quot;<br />
	&quot;ThreadingModel&quot; = &quot;Apartment&quot;<br />
<br />
	[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\<br />
		Shell Extensions\Approved]<br />
	&quot;{11111...}&quot; = &quot;a zzz file handler&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">virtlink</div><div class="date">22nd January 2003, 11:02</div></div><div class="posttext">To create a file association, do the following in NSIS:<br />
<br />
WriteRegStr HKCR &quot;.xxx&quot; &quot;&quot; &quot;MyApp.Document&quot;<br />
WriteRegStr HKCR &quot;MyApp.Document&quot; &quot;&quot; &quot;MyApp Document&quot;<br />
WriteRegStr HKCR &quot;MyApp.Document\\shell\\open\\command&quot; &quot;&quot; 'c:\\LongPathname\\Myapp.exe &quot;%1&quot;'<br />
<br />
Replace &quot;MyApp.Document&quot; by an identifier for the association, usually applicationname+&quot;.Document&quot;<br />
Replace &quot;.xxx&quot; with the extention (don't forget the '.' in front of it)<br />
Replace &quot;MyApp Document&quot; by a title for the association.<br />
Replace &quot;c:\LongPathname\Myapp.exe %1&quot; by your program path (don't forget the '%1' after it, else the filename will not be passed trough to the program).<br />
<br />
To create an extra submenuitem, use this code:<br />
<br />
WriteRegStr HKCR &quot;MyApp.Document\\shell\\menuitem name\\command&quot; &quot;&quot; 'c:\\LongPathname\\2ndMyapp.exe &quot;%1&quot;'<br />
<br />
This line is basically the same as the last line of my other code, but i've replaced &quot;open&quot; in the keyname with &quot;menuitem name&quot;. Tou can use any name for a menu, just replace &quot;menuitem name&quot; with it, for example: &quot;Burn this CD&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd January 2003, 14:30</div></div><div class="posttext">You can also replace the &quot;open&quot; in &quot;MyApp.Document\shell\open\command&quot; to add more commands such as burn for example. NSIS does this (compile nsi script) so you can find an example in makensis.nsi.<br />
<br />
If you want to create a more serious shell extension look at:<br />
<br />
http://www.codeproject.com/shell/shellextguideindex.asp</div></div><hr />


<div class="post"><div class="posttop"><div class="username">virtlink</div><div class="date">22nd January 2003, 14:54</div></div><div class="posttext">KiCHiK, you repeated me. The last two lines of my post said the same. :p</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd January 2003, 15:05</div></div><div class="posttext">Oops :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">honold</div><div class="date">22nd January 2003, 18:02</div></div><div class="posttext">wow awesome!<br />
<br />
is there a way to pipe commands in this?  like blah blah blah blah %1;pause, to add a pause after it?<br />
<br />
i know i can use a batch file for that, but it seems a bit unclean</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd January 2003, 18:07</div></div><div class="posttext">I don't think so. Windows does not support such a sophisticated command line parsing. You can write a little silent NSIS installer to do that. I wouldn't recommend on a batch file because it will open up a DOS window.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">honold</div><div class="date">22nd January 2003, 20:15</div></div><div class="posttext">ok what about the HKCR\*\shellex\ContextMenuHandlers?  it looks like those require guids<br />
<br />
this also makes me wonder how winamp2 has the right-click play/enqueue in winamp shell extensions without being present in this key</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd January 2003, 22:32</div></div><div class="posttext">Those keys relate to more serious shell extension with sub menus, drag &amp; drop suppport and more. The link I gave above is about those extensions.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>