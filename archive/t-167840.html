<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" dotnetfx.exe, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  dotnetfx.exe NSIS Discussion" />
	
	<title> dotnetfx.exe [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  dotnetfx.exe</div>
<hr />
<div class="pda"><a href="t-167840.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=167840">dotnetfx.exe</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ursus76</div><div class="date">3rd February 2004, 01:54</div></div><div class="posttext">I need to install .Net Framework and I need<br />
1.silent installation of dotnetfx.exe<br />
2.need to get the return code(error code, reboot etc as Microsoft's website described http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconsetupexebootstrappersampleoperations.asp)<br />
<br />
I tried this, works, however, can't get the return code.<br />
---&gt; <br />
ExecWait &quot;$TEMP\dotnetfx.exe /q:a /c:$\&quot;install /l /q$\&quot;&quot;<br />
<br />
So instead, I use the command below. And I get $0=0(which supposed to mean no error) but actually dotnet framework is not installed at all. Is there any problem with my script or I should use different approach?<br />
---&gt;<br />
nsExec::ExecToStack &quot;dotnetfx.exe&quot; $TEMP\<br />
Pop $0<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">3rd February 2004, 03:49</div></div><div class="posttext">Try this codeExecWait '$TEMP\dotnetfx.exe /q:a /c:$\&quot;install /l /q$\&quot;' $1 Now $1 should contain the error/exit code.<br />
<br />
Vytautas ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd February 2004, 10:41</div></div><div class="posttext">As for the second one, I doubt it really returns 0. You ended your line with a backslash which means the next line will be appended to it. This means the Pop isn't really executed but is sent as an argument to nsExec. This argument plus the stack item you forgot to pop will corrupt the stack and leave it in a state you don't expect it to be.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ursus76</div><div class="date">3rd February 2004, 19:34</div></div><div class="posttext">Thanks, I'm using ExecWait now and sorry, the second one shouldn't have backslash.<br />
<br />
Another question regarding this:<br />
I'd like to test that whenever the error message generated by dotnetfx.exe (like reboot-needed), I'm able to suppress it till the program finishes(like reboot after the installation is done). But since I can't make my dotnetfx.exe wrong on my computer, is there any way to test it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ursus76</div><div class="date">3rd February 2004, 19:41</div></div><div class="posttext">One more question:<br />
<br />
ExecWait '$TEMP\dotnetfx.exe /q:a/c:$\&quot;install /l /q$\&quot;' $1<br />
<br />
It takes quite some time to finish the dotnetfx execution, and the installation program just seems hangs and stops there. Is there any way to keep the progress bar moving or give the user any feedback about what is going on?<br />
<br />
Thanks a lot!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">opher</div><div class="date">3rd February 2004, 21:23</div></div><div class="posttext">Vytautas hi,<br />
Afaik, one doesn't need to use $\&quot; to insert a &quot; (double-qoute) in a string pre- and post-pended with ' (single-qoute). This for example works ExecWait 'cmd.exe /c dir &quot;C:\Program Files&quot; &amp;&amp; pause'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">3rd February 2004, 22:14</div></div><div class="posttext">ursus76 there is no easy way to keep the progress bar moving, the only solution would be to make the other install visible if thats possible.<br />
<br />
If you get the reboot-needed error you should set the reboot flag in nsis and it will ask you to reboot when complete.<br />
<br />
opher you are right, I had just copied ursus76's code and quickly modified it to return the error varialble without analysing it too much.<br />
<br />
Vytautas :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th February 2004, 13:26</div></div><div class="posttext">ursus76, you can use the Banner plug-in to let the user know something is going on.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eccles</div><div class="date">4th February 2004, 13:49</div></div><div class="posttext">ursus76,<br />
<br />
Give this a try.  It uses the System plugin and the attached include file.!include ExecProgress.nsh<br />
<br />
Name &quot;ExecProgress Example&quot;<br />
OutFile ExecProgress.exe<br />
ShowInstDetails show<br />
<br />
Section<br />
<br />
  SetOutPath $TEMP<br />
<br />
  File &quot;${NSISDIR}\makensisw.exe&quot;<br />
  File &quot;${NSISDIR}\makensis.exe&quot;<br />
  !insertmacro ExecProgress makensisw SW_SHOWNORMAL $0<br />
  DetailPrint &quot;Returned: $0&quot;<br />
  Delete $TEMP\makensis.exe<br />
  Delete $TEMP\makensisw.exe<br />
<br />
  ReadEnvStr $0 &quot;COMSPEC&quot;<br />
  !insertmacro ExecProgress $0 SW_SHOWNORMAL $0<br />
  DetailPrint &quot;Returned: $0&quot;<br />
<br />
  !insertmacro ExecProgress '&quot;I will surely fail&quot;' SW_SHOWNORMAL $0<br />
  DetailPrint &quot;Returned: $0&quot;<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JCD29</div><div class="date">16th June 2005, 22:02</div></div><div class="posttext">it works but how to know that the dotnetfx.exe has been installed on my computer...because I don't want to install it whenever my installer is launched<br />
thanks in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">17th June 2005, 19:53</div></div><div class="posttext">http://nsis.sourceforge.net/archive/nsisweb.php?page=882&amp;instances=0,110,809 - how to detect<br />
http://nsis.sourceforge.net/archive/nsisweb.php?page=809&amp;instances=0,110 - &quot;How to detect if ... is installed&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">17th June 2005, 20:41</div></div><div class="posttext">Or the wiki links:<br />
<br />
http://nsis.sourceforge.net/wiki/index.php?title=How_to_Detect_.NET_Framework<br />
http://nsis.sourceforge.net/wiki/index.php?title=Category:Other_Products_Version_Detection_Functions</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrak</div><div class="date">19th November 2005, 02:49</div></div><div class="posttext">Is there a way to &quot;fake&quot; the completition in the progress bar? Install of .net Framework takes approx. 3-4 minutes, so one could simulate this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chuying</div><div class="date">13th January 2006, 21:26</div></div><div class="posttext">Is there anyone who can help me to figure out  <br />
how to silently uninstall .Net Framework 2.0 beta?<br />
<br />
Can I use similar command to silent install as <br />
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50215\Microsoft .NET Framework 2.0 Beta 2\install.exe /q:a /c:&quot;install /q /l&quot;<br />
but change the switch?<br />
<br />
Or if you can point me to any site where I can find the information.  Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th January 2006, 21:32</div></div><div class="posttext">You can check what the Add/Remove control panel calls when uninstalling .NET. Search under HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chuying</div><div class="date">13th January 2006, 21:51</div></div><div class="posttext">Thank for Kichik's quick response.<br />
 <br />
The value for the registry key you have mentioned ( HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft .NET Framework 2.0 Beta 2\uninstallstring)<br />
<br />
is<br />
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50215\Microsoft .NET Framework 2.0 Beta 2\install.exe<br />
<br />
When I ran this install.exe, it pops up user dialog since detecting the exists of the same version of .Netfx. In the dialog, there are two options: repair or uninstall.  This dialog is what I want to pass by.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>