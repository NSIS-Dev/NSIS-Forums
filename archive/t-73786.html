<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Remove entry from environment path, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Remove entry from environment path NSIS Discussion" />
	
	<title> Remove entry from environment path [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Remove entry from environment path</div>
<hr />
<div class="pda"><a href="t-73786.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=73786">Remove entry from environment path</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">oecherprinte</div><div class="date">29th January 2002, 10:57</div></div><div class="posttext">Hi there,<br />
<br />
in my installation process I am adding<br />
an entry to the environment path.<br />
<br />
How can I remove this entry during uninstall?<br />
I need to find a substring within a string and<br />
remove it, but how can I do this in NSIS?<br />
<br />
Any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">felfert</div><div class="date">29th January 2002, 11:26</div></div><div class="posttext">Have a look at the StrStr function in the function-examples of the NSIS documentation. It does not what you want, but you should be able to modify it to your needs.<br />
<br />
Ciao<br />
 -Fritz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oecherprinte</div><div class="date">29th January 2002, 14:02</div></div><div class="posttext">Thanks for your help. It works.<br />
<br />
Here's the solution:<br />
<br />
Name &quot;stringtest&quot;<br />
OutFile &quot;stringtest.exe&quot;<br />
<br />
;------------------------------------------------------------------------------<br />
; RemoveStr<br />
; input, top of stack = string to search for<br />
;        top of stack-1 = string to search in<br />
; output, top of stack (replaces with the portion of the string remaining)<br />
; modifies no other variables.<br />
;<br />
; Usage:<br />
;   Push &quot;this is a long ass string&quot;<br />
;   Push &quot;ass&quot;<br />
;   Call StrStr<br />
;   Pop $0<br />
;  ($0 at this point is &quot;this is a long string&quot;)<br />
<br />
Function RemoveStr<br />
  Exch $1 ; st=haystack,old$1, $1=needle<br />
  Exch    ; st=old$1,haystack<br />
  Exch $2 ; st=old$1,old$2, $2=haystack<br />
  Push $3<br />
  Push $4<br />
  Push $5<br />
  StrLen $3 $1<br />
  StrCpy $4 0<br />
  ; $1=needle<br />
  ; $2=haystack<br />
  ; $3=len(needle)<br />
  ; $4=cnt<br />
  ; $5=tmp<br />
  ; $6= output string with search string removed<br />
  ; $7= tmp output character<br />
  loop:<br />
    StrCpy $5 $2 $3 $4<br />
    StrCmp $5 $1 skip<br />
    StrCmp $5 &quot;&quot; done<br />
<br />
    ;-- Copy current character into output if no match was detected and increment counter<br />
    StrCpy $7 $2 1 $4<br />
    StrCpy $6 &quot;$6$7&quot;<br />
    IntOp $4 $4 + 1<br />
    Goto loop<br />
  <br />
    ;-- Inrement by length of hayneedle<br />
    skip:<br />
     IntOp $4 $4 + $3<br />
     Goto loop    <br />
<br />
  done:<br />
  StrCpy $1 $2 &quot;&quot; $4<br />
  Pop $5<br />
  Pop $4<br />
  Pop $3<br />
  Pop $2<br />
  Exch $6<br />
FunctionEnd<br />
<br />
<br />
;--------------------------------------------------<br />
;- Test Function<br />
;--------------------------------------------------<br />
<br />
Section &quot;&quot; ; (default section)<br />
<br />
Push &quot;laberschwallblalaberschwallblalaberschwallblalaberschwallblalaberschwallblalaberschwallbla&quot;<br />
Push &quot;schwall&quot;<br />
<br />
Call RemoveStr<br />
<br />
Pop $0<br />
<br />
MessageBox MB_OK $0<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th January 2002, 17:58</div></div><div class="posttext">Hi!<br />
<br />
I have once made some functions that do exacly what you are looking for. I have also made a little program that will allow you to update enviorment variables without reboooting under NT.<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=67208</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>