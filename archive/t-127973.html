<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MUI Version, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MUI Version NSIS Discussion" />
	
	<title> MUI Version [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MUI Version</div>
<hr />
<div class="pda"><a href="t-127973.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=127973">MUI Version</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">viper0179</div><div class="date">10th March 2003, 21:18</div></div><div class="posttext">Hello again everyone,<br />
<br />
I was just trying to find a more automated process for updating my MUI_VERSION number inside of the installation script. Since the version number is incremented automatically whenever I build my project it gets updated consistently. What I'm trying to do is read the version information out of the Visual Basic project file:<br />
<br />
MajorVer=1<br />
MinorVer=1<br />
RevisionVer=3<br />
<br />
I'd like them read into 3 seperate variables so that I can use them inside the script. Right now in my script here's what I've got:<br />
<br />
!define APP_MAJOR $R1<br />
!define APP_MINOR $R2<br />
!define APP_REVIS $R3<br />
<br />
!define MUI_VERSION &quot;${APP_MAJOR}&quot;<br />
<br />
OutFile &quot;..\MyProject ${MUI_VERSION} Installer.exe&quot;<br />
<br />
Function .onInit<br />
  ReadINIStr $R1 &quot;MyProject.vbp&quot; &quot;&quot; &quot;MajorVer&quot;<br />
  ReadINIStr $R2 &quot;MyProject.vbp&quot; &quot;&quot; &quot;MinorVer&quot;<br />
  ReadINIStr $R3 &quot;MyProject.vbp&quot; &quot;&quot; &quot;RevisionVer&quot;<br />
FunctionEnd<br />
<br />
I was thinking that by doing this on the initialization of the installer package it would read the settings out of the VB Project file and then set the variables accordingly, however it doesn't seem to be working properly. I think that there might be a problem with the vbp file since the variables do not have any quotation marks around them. Anyone have any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th March 2003, 21:22</div></div><div class="posttext">The MUI_VERSION is a define which will be processed on compile-time. The run-time ReadINIStr commands won't work. Maybe launch makensis with the /DMUI_VERSION=&quot;bla&quot; flag by a VB program (and remove the MUI_VERSION define from your script).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">viper0179</div><div class="date">10th March 2003, 21:27</div></div><div class="posttext">Argggg, well that explains a lot. Thanks Joost.<br />
<br />
What about if I used just VERSION around the script instead of MUI_VERSION? Load the variables using the .oninit function and then went from there?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th March 2003, 21:39</div></div><div class="posttext">The name won't make a difference. Use my suggestion above (makensis flag to set the define). That's the best way (compile time, don't waste a variable).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">viper0179</div><div class="date">11th March 2003, 13:20</div></div><div class="posttext">Hmm, well it was worth a shot :) Thanks again for the advice Joost.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>