<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Help please ;-), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Help please ;-) NSIS Discussion" />
	
	<title> Help please ;-) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Help please ;-)</div>
<hr />
<div class="pda"><a href="t-130341.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=130341">Help please ;-)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dabossuk</div><div class="date">31st March 2003, 00:48</div></div><div class="posttext">Hi<br />
<br />
its almost 2am and time for bed, and finally got the last of my bugs out ;-) However I am stuck on the following things :<br />
<br />
1. Auto Uninstall<br />
<br />
If I run the setup I check to see if my app is already installed, if it is I want to uninstall it before installing again.  Right now it pops up a messagebox telling the user to manually uninstall the app.  Is there a clean, simple way of automatically uninstalling before installing - or do I just need to copy / paste the uninstall section into a function and just call that ?  or is it best to let the user deal with it ?<br />
<br />
2. Is there a way to add an uninstall item to the add/remove ?  I have tried the sample in the archive but it does not work.  Ie <br />
<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\program&quot; &quot;MyApp&quot; &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
&quot;program&quot; = is what is in the sample - should this be the name of my app ?<br />
<br />
3. Finally a dumb question! ;-)<br />
<br />
I under stand Push and Pop - and I am using them.  However I am also using Exch and have just copy / pasted out of other samples - but really do not understand what it does.  For example, the checking for .NET sample of the archive uses it - but if I comment out it makes no difference ... could someone explain to me in idiot language.<br />
<br />
Thanks for any advice, I am using NSIS 2B3<br />
<br />
Thanks<br />
<br />
Dabossuk</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">31st March 2003, 01:33</div></div><div class="posttext">I try to help you<br />
1. Before to  <br />
File &quot;myfile.chm&quot; <br />
where's start to copy the file use the istruction &quot;IfFileExists&quot;<br />
Read the example: ${NSISDIR}\NSIS\Examples\makensis.nsi<br />
<br />
2.This might help you<br />
<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${MUI_PRODUCT}&quot; &quot;DisplayName&quot; &quot;${MUI_PRODUCT} - Uninstall&quot;<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${MUI_PRODUCT}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\Uninstaller.exe&quot;<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${MUI_PRODUCT}&quot; &quot;DisplayIcon&quot; &quot;$INSTDIR\Uninstaller.exe,0&quot;<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${MUI_PRODUCT}&quot; &quot;Publisher&quot; &quot;From Me&quot;<br />
<br />
<br />
3. Push almost like &quot;Read&quot; Pop almost like &quot;Write&quot;, I think :igor:<br />
 Read this doc (http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.9)  <br />
<br />
PS:<br />
program=${MUI_PRODUCT}<br />
<br />
helps</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">31st March 2003, 07:50</div></div><div class="posttext">1) Use:<br />
<br />
<br />
SetOverwrite ifnewer<br />
<br />
;Use file commands here!<br />
<br />
SetOverwrite on<br />
<br />
<br />
This is the most recommended way to install. Because if is a update, will update only new files.<br />
<br />
2) See at Apendix C (http://nsis.sourceforge.net/Docs/ApendixC.html#C.1) in documentation. Example of use:<br />
<br />
WriteRegStr HKLM &quot;Software/Microsoft/Windows/CurrentVersion/Uninstall/Product&quot; &quot;DisplayName&quot; &quot;Application Name&quot;<br />
<br />
3) Exch - Exchanges two elements - if you put a variable parameter - will exchange the top of the stack with the variable:<br />
<br />
<br />
;STACK Top: Something<br />
StrCpy $0 &quot;None&quot;<br />
<br />
Exch $0<br />
<br />
MessageBox MB_OK $0 ;Will show here &quot;Something&quot;<br />
;STACK Top: None<br />
<br />
<br />
If you put a number parameter - will exchange the top of the stack with the element in this position (starting in 2nd top of stack):<br />
<br />
<br />
;STACK Top: Something, 2nd: None, 3rd: Object<br />
<br />
Exch 2<br />
<br />
;STACK Top: Object, 2nd: None, 3rd: Something<br />
<br />
<br />
If you do not put a parameter - will exchange between two top stack elements.<br />
<br />
<br />
;STACK Top: Something, 2nd: None<br />
<br />
Exch<br />
<br />
;STACK Top: None, 2nd: Something</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>