<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Finding WA3 and closing prob., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Finding WA3 and closing prob. NSIS Discussion" />
	
	<title> Finding WA3 and closing prob. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Finding WA3 and closing prob.</div>
<hr />
<div class="pda"><a href="t-87330.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=87330">Finding WA3 and closing prob.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bballer182</div><div class="date">10th May 2002, 17:00</div></div><div class="posttext">OK I have found the function for closing WA 1.x and 2.x, and it works fine for closing those apps. But my problem is that when i was using NSIS 1.97 and the function above i was also closing WA3 which is what i wanted it to do, so thats fine, but when i recompiled all of my scripts with 1.98, and it gets to the install screen it freezes it WA3 is running. When i close WA3 it will continue the install just fine. <br />
<br />
So what i was wondering is if the was code floating out there that could close WA3 also. Or is that all i have to do is create a new function with the WA3 window name, to close it. <br />
<br />
<br />
please help me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">10th May 2002, 18:02</div></div><div class="posttext">Originally posted by bballer182 <br />
Or is that all i have to do is create a new function with the WA3 window name, to close it.<br />
I guess that's it! Just in the same way to close any program: FindWindow, SendMessage routine.<br />
<br />
Good luck,<br />
-Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bballer182</div><div class="date">12th May 2002, 01:15</div></div><div class="posttext">the problem is i don't know how to do it. I don't even know the WA3 window name is?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">12th May 2002, 09:47</div></div><div class="posttext">You should use some spy software to find out.<br />
<br />
-Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bballer182</div><div class="date">15th May 2002, 02:17</div></div><div class="posttext">OK i figured out the problem using Nocarr's(thanks dude) little utility to find the window name, and it works fine when WA3 isn't minimized in the systray. <br />
<br />
Is there a way to close a proccess? Because WA3 is listed as a process in the task manager.<br />
<br />
If you want it check it out in my sig.<br />
<br />
-justin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bballer182</div><div class="date">17th May 2002, 03:18</div></div><div class="posttext">HELP ME PLEASE <br />
<br />
<br />
Is there a way to close a proccess? Because WA3 is listed as a process in the task manager.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bballer182</div><div class="date">22nd May 2002, 02:17</div></div><div class="posttext">Smile2Me do you know?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd May 2002, 12:25</div></div><div class="posttext">You can always use TerminateProcess, but something tells me there is a better way to do this...<br />
How about searching for the main WindowProc and sending it WM_CLOSE, WM_CLOSE, or WM_COMMAND pretending to be a menu command of exit?<br />
<br />
Doesn't WA3 SDK say anything about this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bballer182</div><div class="date">22nd May 2002, 16:46</div></div><div class="posttext">Originally posted by kichik <br />
<br />
How about searching for the main WindowProc and sending it WM_CLOSE, WM_CLOSE, or WM_COMMAND pretending to be a menu command of exit?<br />
<br />
Doesn't WA3 SDK say anything about this? <br />
<br />
Thats a good idea; sending a menu command of exit. I'll try. :winamp: ;) :) :D :cool:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bballer182</div><div class="date">22nd May 2002, 22:31</div></div><div class="posttext">One problem with that is that i don't know how to work the sdk, i don't even know c++ or basic or anything. The only language that i know is English, NSIS, and a tiny bit of HTML.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">23rd May 2002, 09:48</div></div><div class="posttext">Sorry, I don't know how to kill a process in the SysTray. Check MSDN for this. Sorry, I do not have time for this. If you find something that might be useful, post it and maybe some of us can help you program it into a dll or exe.<br />
<br />
Sorry for my late reply. I forgot to check this thread.<br />
<br />
Good luck,<br />
-Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bballer182</div><div class="date">24th May 2002, 05:08</div></div><div class="posttext">OK i found the page your probably looking for but this is an app to shut it down. I hope this is what your looking for <br />
<br />
http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vbcon/html/vbwlkWalkthroughManagingNTProcesses.asp</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bballer182</div><div class="date">25th May 2002, 06:16</div></div><div class="posttext">Wow i can't belive how active this forum is. I can remember about 6 months ago when a person could post something and about a week later some one might have passed over the forum to answer the question. so i have to move this back to the top so it can get read again. <br />
<br />
I think this is the place but i have no idea what to do with it. <br />
<br />
http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vbcon/html/vbwlkWalkthroughManagingNTProcesses.asp</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th May 2002, 10:56</div></div><div class="posttext">If you insist... I thought someone will give you the correct answer by now, but if you insist I will give you my answer which I am not so sure about.<br />
<br />
Option 1: Call TerminateProcess - Very brutal and unwanted. Only possible with an extension DLL or a change to NSIS code.<br />
Option 2: Find the main window of Winamp 3 and destroy it - The more welcomed way, but harder. The main window of Winamp 3 could not be found with the utility above, you need Spy for it to show you all of the windows and their classes. Just open up spy and list all available windows and search for windows of Winamp 3 and try closing them one by one until one closes the Winamp 3 process as well. There must be a better way to find it but I don't know about one.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bballer182</div><div class="date">27th May 2002, 03:06</div></div><div class="posttext">To Justin<br />
<br />
This sounds like a good idea to add KillWinProcess or KillProcess because some apps (WA3) when in the minmized mode do not have windows. <br />
<br />
I will also ask over at the Winamp 3 discussion Forum. to see if anyone there has any ideas.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">X-Fixer</div><div class="date">27th May 2002, 05:30</div></div><div class="posttext">I have no problems with the following code:<br />
<br />
Name &quot;Kill WA3&quot;<br />
AllowRootDirInstall false<br />
OutFile &quot;wa3kill.exe&quot;<br />
Caption &quot;WA3 Killer&quot;<br />
ShowInstDetails show<br />
<br />
Function KillWA3<br />
    FindWindow $0 &quot;STUDIO&quot;<br />
    IsWindow $0 Found<br />
    DetailPrint &quot;WinAmp3 is not running.&quot;<br />
    goto Done<br />
Found:<br />
    SendMessage $0 16 0 0<br />
    DetailPrint $0<br />
Done:<br />
FunctionEnd<br />
<br />
Section &quot;crap&quot;<br />
    Call KillWA3<br />
SectionEnd<br />
<br />
<br />
It closes 1 instance of Winamp3, even if it's minimized.<br />
<br />
Issues figured out while coding.<br />
1. NSIS understands WM_CLOSES but has it equal to 0.<br />
2. Winamp3 windows ignore WM_DESTROY and WM_QUIT.<br />
3. Winamp3 does not destroy it's windows on minimize (so they are still here), but their order is changed, so FindWindow returns handle not to the main window (this window ignore WM_CLOSE, so if you make loop like in functions.html your installer will freeze). So you can search by title (but this will only work for some specific beta). Also, FindWindow with wildcards would be cool.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bballer182</div><div class="date">27th May 2002, 06:49</div></div><div class="posttext">Thank you my friend!:D :) That worked like a champ!<br />
<br />
I still think i maybe useful to have KillProcess in NSIS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">X-Fixer</div><div class="date">27th May 2002, 08:24</div></div><div class="posttext">Originally posted by bballer182 <br />
I still think i maybe useful to have KillProcess in NSIS. <br />
<br />
WinAPI function TerminateProcess() is very bad and suggested only as the last chance to close application (e.g. it doesn't respond to messages, or &quot;softly&quot; hanged). I will prefer EnumWindows and FindWindow with wildcards. Though it's pretty easy to add KillProcess and some GetProcess() functions to NSIS.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>