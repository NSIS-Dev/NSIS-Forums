<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Check Box on the Custom page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Check Box on the Custom page NSIS Discussion" />
	
	<title> Check Box on the Custom page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Check Box on the Custom page</div>
<hr />
<div class="pda"><a href="t-320238.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=320238">Check Box on the Custom page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">25th June 2010, 09:04</div></div><div class="posttext">Hello, Guys. <br />
<br />
Sorry if such issue have already been discussed. Hope this will help me to get quick solution.<br />
<br />
1. Have my own custom page. There are 2 checkboxes there and one depends on another. Everything is simple like a table. <br />
<br />
2. If the FIRST one is checked the SECOND is active.<br />
If the FIRST is unchecked the second becomes enabled. <br />
<br />
3. I save states of both checkboxes.<br />
<br />
And now the problem. If I press NEXT button and then on the following page at once button BACK window that should be disabled appears active again. The same is when I press BACK button on the sane custom page. <br />
<br />
Hope described clear :) How to save the states of the checkboxes?<br />
<br />
Thank you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">25th June 2010, 09:54</div></div><div class="posttext">At the page's leave function, save the state to a variable. Then in the page creation code, do something like:<br />
<br />
${NSD_CreateCheckBox}<br />
${If} $variable == 1<br />
setstate 1<br />
${Else}<br />
setstate 0<br />
${EndIf}<br />
<br />
etc.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">25th June 2010, 10:00</div></div><div class="posttext">Thank you for your answer.<br />
<br />
Custom page is made via ini file, so impossible to make changes (I think)<br />
<br />
Also would be good to know how to make PRE and LEAVE functions for custom page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th June 2010, 10:48</div></div><div class="posttext">You can add the NOTIFY flag to check boxes. To check/uncheck them you can use the nsDialogs macros. See the Install Options readme for getting their handles. Alternatively, just switch to nsDialogs :)<br />
<br />
Edit: pre and leave functions? If you've used Page Custom then you should know it has two parameters (show function and optional leave function). There is no need for a pre function as that is just the show function before calling a ::Show plug-in function.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">25th June 2010, 16:18</div></div><div class="posttext">Seems have to place my code here. <br />
<br />
Actually it is simple by itself <br />
<br />
<br />
        Var /GLOBAL CheckVar1 // Initialized in the .onInit <br />
        Var /GLOBAL CheckVar2 // Initialized in the .onInit<br />
<br />
Function MyCustomPage<br />
        ${if} $CheckVar1 == &quot;1&quot;<br />
               ReadINIStr $0 &quot;$PLUGINSDIR\NewPage.ini&quot; &quot;Field 7&quot; &quot;HWND&quot;<br />
               EnableWindow $0 1<br />
        ${Else}<br />
               ReadINIStr $0 &quot;$PLUGINSDIR\NewPage.ini&quot; &quot;Field 7&quot; &quot;HWND&quot;<br />
               EnableWindow $0 0<br />
        ${EndIf}<br />
<br />
         !insertmacro MUI_HEADER_TEXT &quot;Custom Page&quot; &quot;Please select the option you want.&quot;<br />
         !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;NewPage.ini&quot;<br />
FunctionEnd<br />
<br />
Function PressButton<br />
        ReadINIStr $R0 &quot;$PLUGINSDIR\NewPage.ini&quot; &quot;Settings&quot; &quot;State&quot;<br />
<br />
        StrCmp $R0 1 checkbox1clicked<br />
        StrCmp $R0 7 checkbox2clicked<br />
        StrCmp $R0 0 next next<br />
<br />
checkbox1clicked:<br />
        ReadINIStr $0 &quot;$PLUGINSDIR\NewPage.ini&quot; &quot;Field 1&quot; &quot;State&quot;<br />
        StrCmp $0 1 checked1 unchecked1<br />
<br />
checked1:<br />
        StrCpy $CheckVar1 &quot;1&quot;<br />
        ReadINIStr $0 &quot;$PLUGINSDIR\NewPage.ini&quot; &quot;Field 7&quot; &quot;HWND&quot;<br />
        EnableWindow $0 1<br />
        Abort<br />
<br />
unchecked1:<br />
        StrCpy $CheckVar1 &quot;0&quot;<br />
        ReadINIStr $0 &quot;$PLUGINSDIR\NewPage.ini&quot; &quot;Field 7&quot; &quot;HWND&quot;<br />
        EnableWindow $0 0<br />
<br />
checkbox2clicked:<br />
        ReadINIStr $0 &quot;$PLUGINSDIR\NewPage.ini&quot; &quot;Field 7&quot; &quot;State&quot;<br />
        StrCmp $0 1 checked2 unchecked2<br />
<br />
checked2:<br />
        StrCpy $CheckVar2 &quot;1&quot;<br />
        Abort<br />
<br />
unchecked2:<br />
        StrCpy $CheckVar2 &quot;0&quot;<br />
        Abort<br />
<br />
next:<br />
        StrCmp $CheckVar1 0 exit install<br />
<br />
install:<br />
        BringToFront<br />
<br />
exit:<br />
FunctionEnd<br />
<br />
Once again: no problem to save the state of checkboxes. Problem is: How to SET this state when the Custom page is loaded again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th June 2010, 17:05</div></div><div class="posttext">As I said, use the macro from nsDialogs to check/uncheck dynamically.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">25th June 2010, 17:50</div></div><div class="posttext">Solved the problem by modifying Function MyCustomPage<br />
<br />
Function MyCustomPage<br />
        ${if} $CheckVar1 == &quot;1&quot;<br />
               WriteIniStr $PLUGINSDIR\NewPage.ini &quot;Field 7&quot; &quot;Flags&quot; &quot;Enabled&quot;<br />
        ${Else}<br />
               WriteIniStr $PLUGINSDIR\NewPage.ini &quot;Field 7&quot; &quot;Flags&quot; &quot;Disabled&quot;<br />
        ${EndIf}<br />
<br />
        !insertmacro MUI_HEADER_TEXT &quot;Custom Page&quot; &quot;Please select the option you want.&quot;<br />
        !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;NewPage.ini&quot;<br />
FunctionEnd <br />
<br />
<br />
Thanks everybody for help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th June 2010, 13:43</div></div><div class="posttext">Just to explain why your previous code did not work; it was because you needed to place it between INITDIALOG and SHOW rather than before DISPLAY.<br />
<br />
Edit: Also sorry for pointing you in the wrong direction (nsDialogs). When you said set the state that implied the check/unchecked state rather than the enabled/disabled state.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">28th June 2010, 18:01</div></div><div class="posttext">Thanks, Stu. Sorry haven't seen your last answer.<br />
<br />
Unfortunately, the problem persists, as my method doesn't work correctly. Disabling checkbox (making it inactive) by WriteIniStr causes next time reading by MUI_INSTALLOPTIONS_DISPLAY a new ini file with actually disabled control (checkbox) and even activating it by EnableWindows does nothing since control doesn't receive notifications.<br />
<br />
So problem persists and I still need help. <br />
<br />
How to save checkboxes disabled states after quiting and then returning to the custom page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th June 2010, 18:35</div></div><div class="posttext">You want to do both. Write to the INI file and set dynamically. To do it dynamically you have to use InitDialog and Show as I have said already.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">28th June 2010, 21:44</div></div><div class="posttext">Thanks again, Stu.<br />
<br />
Actually I've replaced MUI_INSTALLOPTIONS_DISPLAY with INSTALLOPTIONS_INITDIALOG and INSTALLOPTIONS_SHOW.<br />
<br />
But wat is the real difference? As I can see it is impossible to use the in the Page Custome leave function as it causes an error (or quitting installer). <br />
<br />
Also from many tests with code and direct change of ini file I don't see any way to change functionality of the control (checkbox in my case) in the Page Custom leave function.<br />
<br />
Am I wrong? If so please anybody show me how to do this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">29th June 2010, 10:50</div></div><div class="posttext">You can change it between InitDialog and Show or in the Leave function. At both times the dialog is in memory. If your code is not working then you are doing something wrong. Perhaps you should just switch to nsDialogs!<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oldfriend</div><div class="date">29th June 2010, 21:05</div></div><div class="posttext">SOLVED! Stu, thank you for your time and patience.<br />
<br />
Inattention is the rock on which I've split. Inattention, guys ... <br />
<br />
2 checkboxes.<br />
1. If the first one is checked the second one could be checked or unchecked.<br />
2. If the first checkbox unchecked the second is disabled. <br />
<br />
The states if checkboxes are saved when the is closed. Actually I have many checkboxes, but adapted it to 1 secondary checkbox.<br />
<br />
<br />
VAR /GLOBAL MAIN_CHB /*should be initilized before in the .onInit for example */<br />
<br />
Function CustomPage<br />
        !insertmacro INSTALLOPTIONS_INITDIALOG &quot;CustomPage.ini&quot;<br />
<br />
        ${if} $MAIN_CHB == &quot;0&quot;<br />
                 ReadINIStr $0 &quot;$PLUGINSDIR\CustomPage.ini&quot; &quot;Field 7&quot; &quot;HWND&quot;<br />
                 EnableWindow $0 0<br />
        ${EndIf}<br />
<br />
        !insertmacro INSTALLOPTIONS_SHOW<br />
FunctionEnd<br />
<br />
Function CustomPageLeave<br />
        ReadINIStr $R0 &quot;$PLUGINSDIR\CustomPage.ini&quot; &quot;Settings&quot; &quot;State&quot;<br />
<br />
        StrCmp $R0 1 checkbox1clicked<br />
        StrCmp $R0 7 checkbox2clicked<br />
        StrCmp $R0 0 next next<br />
<br />
checkbox1clicked:<br />
        ReadINIStr $0 &quot;$PLUGINSDIR\CustomPage.ini&quot; &quot;Field 1&quot; &quot;State&quot;<br />
        StrCmp $0 1 checked1 unchecked1<br />
<br />
checked1:<br />
        StrCpy $Main &quot;1&quot;<br />
        StrCpy $Secondary &quot;1&quot;<br />
<br />
        ReadINIStr $0 &quot;$PLUGINSDIR\CustomPage.ini&quot; &quot;Field 7&quot; &quot;HWND&quot;<br />
        SendMessage $0 ${BM_SETCHECK} 1 &quot;0&quot;<br />
        EnableWindow $0 1<br />
<br />
        Abort<br />
<br />
unchecked1:<br />
        StrCpy $Main &quot;0&quot;<br />
        StrCpy $Secondary &quot;0&quot;<br />
<br />
        ReadINIStr $0 &quot;$PLUGINSDIR\CustomPage.ini&quot; &quot;Field 7&quot; &quot;HWND&quot;<br />
        SendMessage $0 ${BM_SETCHECK} 0 &quot;0&quot;<br />
        EnableWindow $0 0<br />
<br />
        Abort<br />
<br />
checkbox2clicked:<br />
        ReadINIStr $0 &quot;$PLUGINSDIR\CustomPage.ini&quot; &quot;Field 7&quot; &quot;State&quot;<br />
        StrCmp $0 1 checked2 unchecked2<br />
<br />
checked2:<br />
        ${If} $Main == &quot;1&quot;<br />
              StrCpy $Secondary &quot;1&quot;<br />
        ${EndIf}<br />
        Abort<br />
<br />
unchecked2:<br />
        ReadINIStr $0 &quot;$PLUGINSDIR\CustomPage.ini&quot; &quot;Field 7&quot; &quot;State&quot;<br />
        StrCpy $Secondary &quot;0&quot;<br />
        Abort<br />
next:<br />
        StrCmp $Main 0 exit install<br />
FunctionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>