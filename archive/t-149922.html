<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Fold UpdateDLL + AddSharedDLL into Files, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Fold UpdateDLL + AddSharedDLL into Files NSIS Discussion" />
	
	<title> Fold UpdateDLL + AddSharedDLL into Files [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Fold UpdateDLL + AddSharedDLL into Files</div>
<hr />
<div class="pda"><a href="t-149922.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=149922">Fold UpdateDLL + AddSharedDLL into Files</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">metalogic</div><div class="date">21st September 2003, 09:25</div></div><div class="posttext">Hi all,<br />
I'm a newbie to NSIS. I was using another installer before. Overall I'm quite pleased with it. I'm still finishing up my new installer but it looks like it will be about 30% smaller than my old one (VISE). It also looks a whole lot nicer. Thanks go out to all that work on this project.<br />
<br />
That said, I do find the functionality of the File inscruction a little simplistic. To register a DLL which probably most installs need to do, we have to use a macro (UpgradeDll, which only works on the CVS code, not the latest beta). Wouldn't it be cleaner to have syntax such as this?:<br />
<br />
SetOverwrite ifnewerversion ;note: *ifnewerversion*, not ifnewer<br />
File myfile.dll<br />
<br />
<br />
In my opinion, pretty much every file needs to be replaced even if in use, not just registerable DLLs. I don't want my installer not to upgrade a file just because it's in use. So instead of ever using File I always have to use:<br />
<br />
!define UPGRADEDLL_NOREGISTER<br />
  !insertmacro UpgradeDLL myfile.exe  $INSTDIR\myfile.exe $SYSDIR<br />
!undef UPGRADEDLL_NOREGISTER<br />
<br />
<br />
That makes the installer grow by chunks for every file since we are including the macro for each file.<br />
<br />
Sorry for the long post but it seems like this one change would go a long way for easier/smaller scripts that yield smaller installers.<br />
<br />
All the best,<br />
Santiago</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">21st September 2003, 11:20</div></div><div class="posttext">By default, the installer gives a warning when a certain file is in use and gives the possibility to retry. That is what most people need for normal applications.<br />
<br />
You can also let the installer automatically close your application, so the files won't be in use.<br />
<br />
Registering a DLL is possible with the RegDll command. The UpgradeDLL macro does a lot more:<br />
<br />
* Compare versions of file / local file<br />
* Upgrade &amp; possible if possible<br />
* Create temporary file if file is in use<br />
* Copy new file on reboot<br />
* Register DLL on reboot<br />
<br />
This macro is intented for system DLL files (like runtimes etc.).<br />
<br />
The is an UpgradeDLL version available for both beta 3 and beta 4 CVS. You can find it in the 'Useful functions' appendix of the documentation. The latest version in the NSIS Archive requires some of the new beta 4 commands.<br />
<br />
The reason why NSIS is so small is that we don't add a command for everything that can also be done with the script language. Using a macro is just as easy as a using normal command.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">metalogic</div><div class="date">22nd September 2003, 06:09</div></div><div class="posttext">Hi Joost,<br />
Thank you for taking the time to reply. I know you must be busy with the next version of NSIS.<br />
<br />
I didn't realize there was a version of UpgradeDLL for beta 3. I'll look that up.<br />
<br />
If the reason for using macros instead of adding it to the language is to keep the installer smaller, then that's fair enough.<br />
<br />
Thanks for your time,<br />
Santiago</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>