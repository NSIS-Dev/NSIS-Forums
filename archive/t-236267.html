<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS unstall resources, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS unstall resources NSIS Discussion" />
	
	<title> NSIS unstall resources [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS unstall resources</div>
<hr />
<div class="pda"><a href="t-236267.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=236267">NSIS unstall resources</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">princy</div><div class="date">24th January 2006, 04:17</div></div><div class="posttext">i'm creating a java application using derby,java connecting Quickbooks.i want the script to install resouces like derby,jvm,qbbridge,xerces parser (and set classpath)automatically during installation so tht client dosen't need to install it.plzz do help me<br />
J.Princy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dandaman32</div><div class="date">24th January 2006, 05:00</div></div><div class="posttext">If those programs use EXE or MSI databases you can usually do a silent (unattended) install.<br />
<br />
For an EXE, this varies, but NSIS installers run silently if you pass the /S switch on the command line.<br />
<br />
To install an MSI database, you can use this macro:<br />
<br />
!macro InstallMSI FILE TEXT<br />
  Exch $0<br />
  Push $1<br />
  Push $OUTDIR<br />
  GetTempFileName $1<br />
  StrCpy $1 $1 -4<br />
  SetOutPath $TEMP<br />
  File &quot;/oname=$1.msi&quot; &quot;${FILE}&quot;<br />
  Banner::show /NOUNLOAD `${TEXT}`<br />
    ExecWait '&quot;$SYSDIR\msiexec.exe&quot; /qn /i &quot;$1.msi&quot;'<br />
  Banner::destroy<br />
  Delete &quot;$1.msi&quot;<br />
  Pop $OUTDIR<br />
  Pop $1<br />
  Exch $0<br />
!macroend<br />
<br />
<br />
And to invoke it:<br />
<br />
<br />
Section<br />
  !insertmacro InstallMSI &quot;C:\Path\To\MSI\File\On\Dev\Machine.msi&quot; &quot;Text displayed while installing&quot;<br />
SectionEnd<br />
<br />
In this case, the compiler would compress &quot;C:\Path\To\MSI\File\On\Dev\Machine.msi&quot; into the NSIS installer and the MSI file will be extracted at runtime and installed.  Note that this function installs the MSI database without showing any UI.  To show a full UI, change the &quot;/qn&quot; to &quot;/qf&quot; in the ExecWait line.<br />
<br />
You can set class paths with WriteRegStr.<br />
<br />
-dandaman32</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>