<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Can I make a script require a minimum NSIS version?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Can I make a script require a minimum NSIS version? NSIS Discussion" />
	
	<title> Can I make a script require a minimum NSIS version? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Can I make a script require a minimum NSIS version?</div>
<hr />
<div class="pda"><a href="t-284486.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=284486">Can I make a script require a minimum NSIS version?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dllmain</div><div class="date">6th January 2008, 16:31</div></div><div class="posttext">Hello!<br />
<br />
<br />
I'd like to make sure that a certain script throws an error if compiled with a version prior to X like I can do in Autoconf:<br />
<br />
AC_PREREQ(2.60)<br />
<br />
Is there a way to achieve this with NSIS? I didn't find anything about this.<br />
<br />
Thanks in advance,<br />
<br />
<br />
<br />
Sebastian</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th January 2008, 16:48</div></div><div class="posttext">!if `${NSIS_VERSION}` &lt; 2.34<br />
  !error `NSIS version 2.34 or greater required.`<br />
!endif<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dllmain</div><div class="date">6th January 2008, 17:11</div></div><div class="posttext">Thanks for the hint about ${NSIS_VERSION} but your code doesn't work, for two reasons:<br />
 ${NSIS_VERSION} starts with &quot;v&quot; as in &quot;v2.34&quot;<br />
  &lt; seems to only compare numbers, not strings.<br />
Still a good start, I think I can make something of that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">6th January 2008, 17:12</div></div><div class="posttext">the code should still work<br />
<br />
!if `${NSIS_VERSION}` &lt; v2.34<br />
!error `NSIS version 2.34 or greater required.`<br />
!endif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dllmain</div><div class="date">6th January 2008, 17:31</div></div><div class="posttext">If I try that exact code with the string 2.35 it doesn't fail for my local NSIS 2.34. So it seems it's always false.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">6th January 2008, 17:54</div></div><div class="posttext">did you try enclosing v2.35 within quotes?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dllmain</div><div class="date">6th January 2008, 18:23</div></div><div class="posttext">yes, no luck.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">6th January 2008, 18:35</div></div><div class="posttext">try this<br />
<br />
!define NO &quot;v2.35&quot;<br />
<br />
!if `${NSIS_VERSION}` &lt; '${NO}'<br />
!error `NSIS version 2.34 or greater required.`<br />
!endif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dllmain</div><div class="date">6th January 2008, 18:37</div></div><div class="posttext">I did some research in between. I found out the following:<br />
  The ${NSIS_VERSION} constant was first introduced in 2.0b4<br />
  2.15 is the only release in [2.0b4, 2.34] without the &quot;v&quot; prefix in ${NSIS_VERSION}<br />
With that and an idea from here (http://svn.secondlife.com/trac/linden/browser/release/indra/newview/installers/windows/installer_template_multilang.nsi?rev=10&amp;format=raw) I was able to construct this code for detecting NSIS &gt;=2.34:<br />
<br />
!ifndef NSIS_VERSION<br />
  ; Anything before 2.0b4<br />
  !error &quot;NSIS 2.34 or later required.&quot;<br />
!endif<br />
!define &quot;X${NSIS_VERSION}&quot;<br />
!ifdef Xv2.33 | Xv2.32 | Xv2.31 | Xv2.30 | Xv2.29 | Xv2.28 | Xv2.27 | Xv2.26 | Xv2.25 | Xv2.24 | Xv2.23 | Xv2.22 | Xv2.21 | Xv2.20 | Xv2.19 | Xv2.18 | Xv2.17 | Xv2.16 | X2.15 | Xv2.14 | Xv2.13 | Xv2.12 | Xv2.11 | Xv2.10 | Xv2.09 | Xv2.08 | Xv2.07 | Xv2.06 | Xv2.05 | Xv2.04 | Xv2.03 | Xv2.02 | Xv2.01 | Xv2.0<br />
  ; Stable releases, 2.15 without &quot;v&quot; prefix<br />
  !error &quot;NSIS 2.34 or later required.&quot;<br />
!endif<br />
!ifdef Xv2.0b4 | Xv2.0rc1 | Xv2.0rc2 | Xv2.0rc3 | Xv2.0rc4 | Xv2.07b0<br />
  ; Pre-releases<br />
  !error &quot;NSIS 2.34 or later required.&quot;<br />
!endif<br />
!undef &quot;X${NSIS_VERSION}&quot;<br />
<br />
Please report any bugs you find.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dllmain</div><div class="date">6th January 2008, 18:43</div></div><div class="posttext">Originally posted by fabian.rap.more <br />
try this<br />
<br />
!define NO &quot;v2.35&quot;<br />
<br />
!if `${NSIS_VERSION}` &lt; '${NO}'<br />
!error `NSIS version 2.34 or greater required.`<br />
!endif <br />
Just saw this. I tried that and with other quote chars as well - still doesn't work for me. It makes me wonder if you actually try the code you paste here.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zeeh3</div><div class="date">6th January 2008, 18:46</div></div><div class="posttext">I think none of these commands allow use of variables.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">6th January 2008, 18:47</div></div><div class="posttext">i always try my scripts before posting them...............</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th January 2008, 19:31</div></div><div class="posttext">You're right, that doesn't work.<br />
This does though. Used a bit of a hack to strip the v from the front using /date:<br />
<br />
!define VERSION_A 2.34<br />
!define /date VERSION_B %${NSIS_VERSION}<br />
!if `${VERSION_B}` &lt; `${VERSION_A}`<br />
  !error `NSIS version ${VERSION_A} or greater required. You are using ${NSIS_VERSION}.`<br />
!endif<br />
<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dllmain</div><div class="date">6th January 2008, 20:47</div></div><div class="posttext">The only problem I can think of is that it accepts Xrc1 if X is required. Other than that very smart solution.<br />
<br />
I made a macro/file of that, see attachment. Usage is<br />
<br />
!include &quot;RequireVersion.nsh&quot;<br />
!insertmacro REQUIRE_VERSION &quot;2.34&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th January 2008, 21:11</div></div><div class="posttext">That's good. Should make a Wiki page.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>