<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Cancelling the installation process as it happens, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Cancelling the installation process as it happens NSIS Discussion" />
	
	<title> Cancelling the installation process as it happens [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Cancelling the installation process as it happens</div>
<hr />
<div class="pda"><a href="t-277190.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277190">Cancelling the installation process as it happens</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">HaydenDevlin</div><div class="date">11th September 2007, 11:50</div></div><div class="posttext">Hello,<br />
<br />
I am trying to make an installer for a large program and I have sucessfully done so using NSIS and using the ModernUI, but there is one thing I want to be able to add, but it doesn't seem to be an option. What I want to do is to make it so that users of my installer can cancel the install while it is happening in the install screen, so that if the install is taking too long or users realise that they have made a mistake or whatever, they can stop the install as it happens by pressing cancel, at which point the installer will remove all of the files that it had put onto the computer. It's quite surprising to me that this does not seem to be a supported feature in the ModernUI, and it makes me think that I am just missing something obvious, but I have tried and looked through the documentation and forums to no avail. I know that the UltraModernUI allows this, but there are problems with that itself anyway, and it is not what we want to use if we can help it.<br />
<br />
Thanks in advance for any help,<br />
<br />
Hayden Devlin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">darthvader</div><div class="date">11th September 2007, 17:00</div></div><div class="posttext">Have you tried using the callback function .onUserAbort. Just write the files you want to remove when the user aborts the installer, you can have the installer do anything over here. This is the flexibility of NSIS over other Installers.;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">HaydenDevlin</div><div class="date">11th September 2007, 17:02</div></div><div class="posttext">Well when installing the cancel button is not enabled, it is shaded out so you can't press it. Surely the onAbort method would only be called when cancel is clicked yes? Do you know how to enable the cancel button while installing?<br />
<br />
Thanks,<br />
<br />
Hayden Devlin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">darthvader</div><div class="date">11th September 2007, 17:12</div></div><div class="posttext">I am not sure but try defining this at the top of your script<br />
<br />
!define MUI_FINISHPAGE_ABORTWARNINGCHECK</div></div><hr />


<div class="post"><div class="posttop"><div class="username">HaydenDevlin</div><div class="date">11th September 2007, 17:18</div></div><div class="posttext">I'm afraid that doens't seem to do anything :( When the installation occurs all buttons become disabled, including the buttons of the window itself (except for the minimize button). Does that happen for other people when their software installs or have I somehow set that myself? What I want is just to have ht ecancel button enabled while uninstalling<br />
<br />
Thanks,<br />
<br />
Hayden Devlin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">darthvader</div><div class="date">11th September 2007, 17:47</div></div><div class="posttext">This link might help you.<br />
<br />
http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1219437&amp;group_id=22049&amp;atid=373087</div></div><hr />


<div class="post"><div class="posttop"><div class="username">HaydenDevlin</div><div class="date">11th September 2007, 17:54</div></div><div class="posttext">Oh great that looks like it might be able to do what I am after I will have a look tomorrow to make sure but it sounds good!<br />
<br />
Thanks,<br />
<br />
Hayden Devlin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">HaydenDevlin</div><div class="date">11th September 2007, 18:25</div></div><div class="posttext">Hmm don't want to sound too stupid but how do you use what is on that website? There are 2 .patch files you can download, but aren't .patch they for unix? If not does anyone know how to use them on a windows machine?<br />
<br />
Thanks,<br />
<br />
Hayden Devlin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">HaydenDevlin</div><div class="date">14th September 2007, 14:00</div></div><div class="posttext">I have managed to install the patches onto my windows version of NSIS 2.30 by using cygwin (like a unix environment for windows) to do the patching via the unix patch command. The patch, however seems to only work on an older version of NSIS, as some of the code regions for patching are now slightly different from when the patch was written. This means that not all of the patch sections or 'hunks' work, and the patched version no longer compiles. By reading the patch file and manually applying the patch sections to the current NSIS code I managed to apply all of the patch code. This did not compile because of a more recently added line of code in the NSIS code, but with a little tinkering it compiled ok, but then crashes when you run it. So basically the patch doesn't work anymore. Does anyone know if there is an up-to-date patch for this, or what version of NSIS the patch actually works with (and where I can get it)?<br />
<br />
Thanks in advance for any help,<br />
<br />
Hayden Devlin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th September 2007, 18:52</div></div><div class="posttext">If you attach your latest changes, I can have a look and see why it crashes.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">makhzi</div><div class="date">18th September 2007, 15:24</div></div><div class="posttext">I've found the problem, it lies here:<br />
ui.c ( line 676 )<br />
<br />
<br />
    else if (id == IDCANCEL)<br />
    {<br />
...<br />
...<br />
...<br />
        if (g_this_page-&gt;wndproc_id == PWP_INSTFILES)<br />
        {<br />
<br />
        }<br />
<br />
<br />
g_this_page is NULL, when CANCEL button is pressed during setup of installation process ( dest. folder, shortcuts etc. ) <br />
<br />
Currently I'm trying to solve this problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">18th October 2007, 09:46</div></div><div class="posttext">Hi there<br />
<br />
What is the current status ? Is it still impossible to cancel installation (abort installation while it is installing) ?<br />
<br />
The previous patch seems out of date for current NSIS builds.<br />
<br />
As &quot;aborting&quot; is already possible when the user is prompted the dialog for a file that cannot be open for writing, it shouldn't be too hard to implement the Cancel button to behave as if user clicked abort on that dialog.<br />
(of course this would allow aborting only during &quot;File&quot; operations, but this would be enough for most installers)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th October 2007, 01:04</div></div><div class="posttext">Status hasn't changed.<br />
<br />
Abortion isn't the same as the file open problem dialog. Those originate from two different threads. The naive implementation would actually only make it possible to abort in between File commands and not while extracting a big file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">22nd October 2007, 10:12</div></div><div class="posttext">sure..<br />
<br />
I was just saying that rather than waiting 6+ months for a new &quot;abort&quot; feature fully implemented, that could be nice to start by having a quick implementation that would be already enough to answer the needs of 90% of NSIS users.<br />
<br />
(if the demand is strong)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd October 2007, 01:19</div></div><div class="posttext">I currently have more important subjects lined up. A high quality and up-to-date patch would be useful.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">namorham</div><div class="date">14th March 2008, 08:07</div></div><div class="posttext">So far I have had no luck enabling the cancel button during the install section, so is it possible to remove it.  I have been working on a single page install (for a patch) and since this is the only page the back and cancel buttons are pointless/redundant.  Short of defining my own custom page, is there a way to remove these butttons?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dmut</div><div class="date">28th May 2008, 10:34</div></div><div class="posttext">Hi All<br />
Have run into the same problem recently. Managed to enable &quot;cancel&quot;, but have no luck to stop file copying thread. and therefore removing files in .onGuiEnd leads to crash or leftover files.<br />
Already read similar threads, nothing helpfull found.<br />
Is there is a way to add a command to stop file copying process? or add a mutex, which should be checked before copying every next file, so we can at least wait while an operation on sigle file finished?<br />
Advice is highly appreciated.<br />
<br />
Regards, Dmut<br />
<br />
ps: kichik, NSIS is THE BEST, don't stop on it :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">coderanger</div><div class="date">18th July 2008, 01:14</div></div><div class="posttext">Is there still no workaround for this with MUI? I have a large (~2GB) installer and it would be nice to allow aborting it, even without any kind of rollback.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dmut</div><div class="date">28th August 2008, 15:45</div></div><div class="posttext">Originally posted by coderanger <br />
Is there still no workaround for this with MUI? I have a large (~2GB) installer and it would be nice to allow aborting it, even without any kind of rollback.  <br />
I have had to use nsis.sourceforge.net/Multi-volume_Distribution &quot;CABsetup&quot;, to implement a canceling, rollback, and to be able to create my installer bigger then 2gb.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ChocJunkie</div><div class="date">2nd October 2009, 11:51</div></div><div class="posttext">Originally posted by dmut <br />
I have had to use nsis.sourceforge.net/Multi-volume_Distribution &quot;CABsetup&quot;, to implement a canceling, rollback, and to be able to create my installer bigger then 2gb.  <br />
<br />
Can you cancel the running install process?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>