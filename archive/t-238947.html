<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS Search function question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS Search function question NSIS Discussion" />
	
	<title> NSIS Search function question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS Search function question</div>
<hr />
<div class="pda"><a href="t-238947.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=238947">NSIS Search function question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">DBE</div><div class="date">24th February 2006, 12:27</div></div><div class="posttext">Hi there, <br />
I'm wondering if it's possible to create an EXE-file, which can search through a TXT-file for unique numbers?<br />
<br />
And when a number is found, to return the result containing the description of that number, and the price.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th February 2006, 12:46</div></div><div class="posttext">There's lots of text file manipulation files on the Wiki:<br />
http://nsis.sourceforge.net/Category:Text_Files_Manipulation_Functions<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DBE</div><div class="date">24th February 2006, 13:32</div></div><div class="posttext">Hi Stu!<br />
Thanks for the quick reply.<br />
<br />
I think you misunderstand the question.<br />
<br />
I have a txt file which contains part numbers in the following way:<br />
<br />
Part Number (TAB) Description of Part Number (TAB) Price of the Part<br />
<br />
I would like to make an exe-file, which allows the users of this file to search for a specific part number. Every part number is a unique number.<br />
<br />
When the script finds the number, it has to return the result, as described above: <br />
Part number<br />
with description<br />
and the price of the part<br />
<br />
Later on, the idea would be that the result of the search can be added (by e.g. a button) in some sort of order form, which can be printed and faxed, or e-mailed to a specific address.<br />
<br />
It's hard for me to explain, but if there are any questions, I'll do my best to answer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">24th February 2006, 15:01</div></div><div class="posttext">Have a look at the functions in the NSIS help, Appendix E.  I think the 'LineFind' function should be just what what you are looking for.  It would allow you to search for the line in the file.  Once you find what you are looking for, you can create a callback function to read the line and parse the results for displaying to the user.<br />
<br />
(If you don't find Appendix E in the help files, you'll need to get the latest build of NSIS.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DBE</div><div class="date">24th February 2006, 15:46</div></div><div class="posttext">The problem is, that the users only have to be able to search for the part number. They don't know which part number is on which line.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">25th February 2006, 03:34</div></div><div class="posttext">Sorry... I misread the original post...<br />
<br />
What I'd probably do is use a FileRead to read the parts file line by line.  If you consider each line a 'row' of a database, then you can multiple WordFind functions (also in the appendix of the NSIS help) to break each row into a list of 'fields'.  Field #1 would be your part number. (Use $/t as your delimiter.)<br />
<br />
If you wanted to store the results in a variable, you could use WordReplace to replace the tabs ($\t) with carriage returns ($\r$\n).  Then, just display the results in a message box.  (Or in a custom page.  but, in a custom page, you'd need to use \r\n instead)<br />
<br />
If you needed to store multiple results, you may need to use the stack or write the output to a file for retrieval later.<br />
<br />
(Hope this makes sense.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">25th February 2006, 06:46</div></div><div class="posttext">Name &quot;Output&quot;<br />
OutFile &quot;Output.exe&quot;<br />
<br />
!include &quot;TextFunc.nsh&quot;<br />
!insertmacro LineFind<br />
!insertmacro TrimNewLines<br />
<br />
!include &quot;WordFunc.nsh&quot;<br />
!insertmacro WordFind<br />
<br />
Var FINDIT_PARTNUMBER<br />
Var PARTNUMBER<br />
Var DESCRIPTION<br />
Var PRICE<br />
<br />
Section<br />
	StrCpy $FINDIT_PARTNUMBER '123456'<br />
<br />
	${LineFind} &quot;C:\a.log&quot; &quot;/NUL&quot; &quot;1:-1&quot; &quot;LineFindCallback&quot;<br />
<br />
	IfErrors 0 +2<br />
	MessageBox MB_OK &quot;Error&quot;<br />
	MessageBox MB_OK '$$PARTNUMBER={$PARTNUMBER}$\n$$DESCRIPTION={$DESCRIPTION}$\n$$PRICE={$PRICE}'<br />
SectionEnd<br />
<br />
Function LineFindCallback<br />
	${TrimNewLines} '$R9' $R9<br />
	${WordFind} '$R9' '$\t' &quot;+1&quot; $1<br />
	StrCmp $1 $FINDIT_PARTNUMBER 0 end<br />
<br />
	StrCpy $PARTNUMBER $1<br />
	${WordFind} '$R9' '$\t' &quot;+2&quot; $DESCRIPTION<br />
	${WordFind} '$R9' '$\t' &quot;+3&quot; $PRICE<br />
	StrCpy $0 StopLineFind<br />
<br />
	end:<br />
	Push $0<br />
FunctionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>