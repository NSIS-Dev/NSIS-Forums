<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" New installer script functions, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  New installer script functions NSIS Discussion" />
	
	<title> New installer script functions [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  New installer script functions</div>
<hr />
<div class="pda"><a href="t-103519.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=103519">New installer script functions</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bayden</div><div class="date">4th September 2002, 08:07</div></div><div class="posttext">Hi!  I just discovered this forum, and wanted to ask around to see if I'm doing something useful or wasting my time...<br />
<br />
For my private build of NSIS 1.98, I've just about finished enabling the following new functions:<br />
---<br />
Download &quot;http://www.foo.com/dl/blah.cab&quot; &quot;$TEMP\out.cab&quot;<br />
Expand &quot;%TEMP\out.cab&quot; &quot;$INSTDIR&quot;<br />
---<br />
<br />
Is this sort of thing old hat and already scheduled for inclusion in NSIS 2.0?  <br />
<br />
Thanks for any feedback,<br />
<br />
Eric Lawrence<br />
Applications Architect<br />
Bayden Systems</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th September 2002, 08:12</div></div><div class="posttext">There is already a DLL that can download files for you. It is called NSIS-dl, and is included in the Bin dir in your NSIS 1.98. The sources are in Contrib\NSISdl.<br />
<br />
Another DLL written by CodeSquid can extract files from ZIPs. You can find it at Sunjammer's NSIS Archive (have a look at the FAQ for links). It would be great if you make a DLL for extracting from CAB files too, and post it here.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bayden</div><div class="date">4th September 2002, 08:30</div></div><div class="posttext">I took a look at the code which performs a HTTP download, and while it looks complete, it seems excessively complicated.  URLMon exports a single function which will perform a file download, and adding a reference to it adds just 500 bytes to the installer... much less than the NSISDL.dll, which is ~15kb.<br />
<br />
I would think that downloads and decompression are something central enough to make it into the engine itself.<br />
<br />
Thanks for the feedback!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th September 2002, 08:43</div></div><div class="posttext">Is this function exported from WinInet.dll?<br />
As far as I know NSISdl didn't use it deliberately because it is slow and heavy. NSISdl uses Nullsoft's JNet-lib, which uses socks for fast operations.<br />
<br />
I don't think these functions are crucial enough to be included in the &quot;engine&quot;. NSIS 2 provides a very easy way to call DLL functions by Sunjammer. Just write them as any other functions and NSIS will inculde the file, extract and delete it for you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bayden</div><div class="date">4th September 2002, 10:02</div></div><div class="posttext">Actually, it's exported by URLMon.  URLMon is always loaded in Windows and has shipped since IE3.  <br />
<br />
I've got both compression and download in my installer for a &lt;1kb increase in output size.<br />
<br />
But I agree, the DLL system is great, and its good that it's there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fastfreeware</div><div class="date">10th September 2002, 05:27</div></div><div class="posttext">Thanks, this is very good if there is download code<br />
already in the NSIS installer.  I will use it, but<br />
I have two additional questions:<br />
<br />
1)  Does anyone know if the DLL's<br />
specified allow you to gauge progress of the download,<br />
so I can generate a status bar (this would be from VB).<br />
<br />
2)  I would imagine that this would let my installer<br />
check to see whether certain mandatory libraries are<br />
available, and download the ones that are not.  I<br />
also hope to use this to check to see if certain<br />
optional libraries for my APP are already installed,<br />
and download them based on a user dialog (explaining<br />
how long it will take, etc).<br />
<br />
--For non-system files, I will use a file existence test.<br />
  But how do I do this for system files?<br />
<br />
Can I write a script that tests the date and/or the<br />
Windows Version of a DLL?  The issue here is I need<br />
to make sure the user has a consistent version of<br />
the database libraries jet 3.5 and dao 3.51.<br />
<br />
-rc</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bayden</div><div class="date">10th September 2002, 05:53</div></div><div class="posttext">My code does not support a progress bar, unfortunately.  It would require wrapping an ugly COM interface, and since C++ is not my native language, I decided to pass.<br />
<br />
With regard to checking system libraries-- My code checks Delphi libraries only, sorry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th September 2002, 06:49</div></div><div class="posttext">NSISdl uses a progress bar if quiet mode is not used.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fastfreeware</div><div class="date">10th September 2002, 16:12</div></div><div class="posttext">Great -- this clarifies what I want my script to do (it<br />
installs a free database software program for nonprofits).<br />
<br />
But I am not sure if there is a way to combine the<br />
behavior of UpgradeDLL with NSISdll.  That's really<br />
want I want to do.  The installer will include the<br />
items that most users have.  If the installation<br />
takes place on an old pc, I want to have UpgradeDLL<br />
obtain the required files from the internet, so that<br />
they don't have to be part of the install package.<br />
<br />
So if I can detect that the user is running an old<br />
version of Windows95 (lacking MSVCRT.DLL or a newer<br />
version of OLEAUT32.DLL), I can have the script end<br />
with 2 possible scenarios (user dialogues):<br />
<br />
1) ODB was installed successfully.  Do you want to<br />
run the program now?<br />
<br />
2) ODB was installed, but before you run the program<br />
you will some updates to Windows.  Would you like to<br />
automatically download and install them now?  (Make sure your internet connnection is active before clicking Yes.)<br />
<br />
Can a combination of UpgradeDLL and NSISdl.dll handle<br />
this functionality?  Do I need to use GetDLLVersion instead?<br />
Any sample scripts I can refer to?<br />
<br />
-rc</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th September 2002, 16:27</div></div><div class="posttext">Edit the updgrade DLL macro you have to move after reboot from the place you tell him (where you have downloaded the file to) instead of extracting it and moving the extracted file on reboot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saritha</div><div class="date">29th July 2004, 06:54</div></div><div class="posttext">how to use nsisdl to download a file from http:\abc.com \t.zip and how to extract a zip file</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>