<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" DSN Creation, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  DSN Creation NSIS Discussion" />
	
	<title> DSN Creation [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  DSN Creation</div>
<hr />
<div class="pda"><a href="t-87103.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=87103">DSN Creation</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">vrtata</div><div class="date">8th May 2002, 15:34</div></div><div class="posttext">Hi.. i am distributing a software which uses a database and would like to know the procedure of creating a User DSN using NSIS. With the kind of features that NSIS has, I am sure this can be achieved somehow...Could somebody pls guide me in this regards. <br />
<br />
Thanx<br />
Ramesh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th May 2002, 15:47</div></div><div class="posttext">Well, I am pretty sure my dictionary was wrong when it gave me &quot;Deep Space Network&quot; as the defenition for DSN... Could we please explain what DSN is?<br />
<br />
A few ideas even though I have no idea what you want :D :<br />
1) Create an extension DLL that creates this user DSN.<br />
2) Call some commands of the database interface using Exec/ExecWait.<br />
3) Using SendMessage send it WM_CREATE or something :)<br />
4) Use FileOpen/FileRead/FileWrite/FileClose to create it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vrtata</div><div class="date">8th May 2002, 16:03</div></div><div class="posttext">:rolleyes: that's a tough one for a starter like me. Any more ideas? :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mark_Ive</div><div class="date">8th May 2002, 17:04</div></div><div class="posttext">Hi Ramesh,<br />
<br />
You can setup a access DSN using....<br />
<br />
WriteRegStr HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODBC.INI\DSNNAME&quot; &quot;DBQ&quot; &quot;c:\mydatabase.mdb&quot; <br />
WriteRegStr HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODBC.INI\DSNNAME&quot; &quot;Description&quot; &quot;Description&quot;<br />
WriteRegStr HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODBC.INI\DSNNAME&quot; &quot;Driver&quot; &quot;C:\\WINNT\\System32\\odbcjt32.dll&quot;<br />
WriteRegDword HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODBC.INI\DSNNAME&quot; &quot;DriverId&quot; &quot;00000019&quot;<br />
WriteRegStr HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODBC.INI\DSNNAME&quot; &quot;FIL&quot; &quot;MS Access;&quot;<br />
WriteRegDword HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODBC.INI\DSNNAME&quot; &quot;SafeTransactions&quot; &quot;00000000&quot;<br />
WriteRegStr HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODBC.INI\DSNNAME&quot; &quot;UID&quot; &quot;&quot;<br />
<br />
WriteRegStr HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODBC.INI\DSNNAME\Engines\Jet&quot; &quot;ImplicitCommitSync&quot; &quot;Yes&quot;<br />
WriteRegDword HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODBC.INI\DSNNAME\Engines\Jet&quot; &quot;MaxBufferSize&quot; &quot;00000200&quot;<br />
WriteRegDword HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODBC.INI\DSNNAME\Engines\Jet&quot; &quot;PageTimeout&quot; &quot;00000005&quot;<br />
WriteRegDword HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODBC.INI\DSNNAME\Engines\Jet&quot; &quot;Threads&quot; &quot;00000003&quot;<br />
WriteRegStr HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODBC.INI\DSNNAME\Engines\Jet&quot; &quot;UserCommitSync&quot; &quot;Yes&quot;<br />
WriteRegStr HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODBC.INI\ODBC Data Sources&quot; &quot;DSNNAME&quot; &quot;Microsoft Access Driver (*.mdb)&quot;<br />
<br />
<br />
or an SQL one using .....<br />
<br />
WriteRegStr HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODBC.INI\DSNNAME&quot; &quot;Driver&quot; &quot;C:\\WINNT\\System32\\SQLSRV32.dll&quot;<br />
WriteRegStr HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODBC.INI\DSNNAME&quot; &quot;Server&quot; &quot;Server Name&quot;<br />
WriteRegStr HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODBC.INI\DSNNAME&quot; &quot;Database&quot; &quot;db on sql server&quot;<br />
WriteRegStr HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODBC.INI\DSNNAME&quot; &quot;LastUser&quot; &quot;sa&quot;<br />
WriteRegStr HKEY_LOCAL_MACHINE &quot;Software\ODBC\ODB.INI\ODBC Data Sources&quot; &quot;DSNNAME&quot; &quot;SQL Server&quot;<br />
<br />
<br />
hope this helps<br />
ps you can look in your registry to work out other types</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th May 2002, 17:06</div></div><div class="posttext">Well, if you can tell me what DSN is I will able to be a bit more specific :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mark_Ive</div><div class="date">8th May 2002, 17:12</div></div><div class="posttext">A DSN is an ODBC data source</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">19th April 2003, 17:51</div></div><div class="posttext">btw, there is a bit more natural way:<br />
<br />
<br />
!define ODBC_ADD_DSN 1<br />
!define ODBC_ADD_SYS_DSN 4<br />
system::call 'odbccp32.dll::SQLConfigDataSourceA(i 0, i ${ODBC_ADD_DSN}, t &quot;driver&quot;, t &quot;attributes&quot;) i'<br />
<br />
<br />
MSDN contains full desctiption of SQLConfigDataSource.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">virtlink</div><div class="date">19th April 2003, 19:21</div></div><div class="posttext">Originally posted by kichik <br />
Well, I am pretty sure my dictionary was wrong when it gave me &quot;Deep Space Network&quot; as the defenition for DSN... Could we please explain what DSN is?(...) <br />
<br />
Originally posted by kichik <br />
Well, if you can tell me what DSN is I will able to be a bit more specific :)  <br />
<br />
Originally posted by Mark_Ive <br />
A DSN is an ODBC data source  <br />
<br />
As far as I can tell (not being a DSN expert), is that a DSN is an adress to a data source, for example, a MySQL database. Just like an IP-adress for websites. (I might be wrong, then please correct me, brainsucker, Mark_Ive or vrtata) :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Dick4</div><div class="date">20th April 2003, 19:11</div></div><div class="posttext">In Windows, there is an &quot;ODBC Data Sources&quot; control panel that allows you to add addressing to databases, so I could setup a MySQL database with a username/password and the connect info and then within my app simply say &quot;Connect to MyDB&quot; where &quot;MyDB&quot; is the &quot;DSN&quot; name for my database.  I can do this for anything, Excel files, MS SQL databases, Access, etc.  Just makes accessing the database a little easier.<br />
<br />
I believe what Mark_Ive said is correct...all that data is stored in the registry so you can simply add the entries there and it should take care of it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">artificial</div><div class="date">20th April 2004, 15:33</div></div><div class="posttext">Brainsucker, <br />
<br />
You mentioned that a more natural way to install an ODBC connection was to use system::call 'odbccp32.dll::SQLConfigDataSourceA(...)'<br />
but this doesn't seem to work. I can get it to work from a 5 line c++ program (same parameters to call) but not from NSIS. Just wondering if you had any insight into this - otherwise I'm banging on the registry. <br />
<br />
Thanks in advance. <br />
<br />
Artificial</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gold0r</div><div class="date">26th August 2004, 12:35</div></div><div class="posttext">Unfortunately I'm having all sorts of problems trying to set up a working DSN. I was able to set up a working SQL Server ODBC DSN using nsODBC. But if I try to set up two ODBC links in the one installation, then only the first one will work. I then reverted to the direct registry method, which seems to create dsns that work, but they're not showing up on the list under Administrative Tools. But when attempting to create a dsn with the same name an alert comes up saying that the dsn already exists. I also looked into the system call mentioned above, but I didn't have any luck with that either (I'm not sure how to give all the connection properties, do the null delimiters work?)<br />
<br />
Can anybody shed any light on any of the above? Something that I would have thought would be quite simple has already taken up a lot of my time and I'm still not able to get it right.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Domgrief</div><div class="date">27th August 2004, 03:54</div></div><div class="posttext">I've been hacking up quick installs for MS Access databases for a while now, and here's the code I'm using.<br />
<br />
I know this isn't too different from Mark_Ive's earlier post, but it may clear up a couple of additional questions.<br />
<br />
At the start of the script, this define just saves a lot of copying and pasting.<br />
<br />
The ODBC_CONNECTION_NAME we're adding here is the DSN - this is what will appear in the ODBC Administrator and all of your apps.<br />
<br />
!define ODBC_CONNECTION_NAME &quot;BaB&quot;<br />
<br />
Later on, I add the following. Obviously your &quot;Driver&quot;, &quot;Description&quot;, and &quot;DBQ&quot; settings will change with each different Access connection. For databases other than Access, just take a look in your registry and steal the appropriate settings.<br />
<br />
The first line in the code below is what causes the DSN to appear in the ODBC Administrator. I noticed this was in the earlier post, but maybe this was missing from yours gold0r?<br />
<br />
Also, replace HKLM below with HKCU to create a &quot;User DSN&quot; instead of a &quot;System DSN&quot;.<br />
<br />
  ; Write the ODBC database connection for Windows<br />
<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\ODBC Data Sources&quot; &quot;${ODBC_CONNECTION_NAME}&quot; &quot;Microsoft Access Driver (*.mdb)&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;FIL&quot; &quot;MS Access;&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;Driver&quot; &quot;$SYSDIR\odbcjt32.dll&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;Description&quot; &quot;GBIS Back and Beyond Demo Dataset&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;UID&quot; &quot;&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;DBQ&quot; &quot;$INSTDIR\BackAndBeyond.mdb&quot;<br />
  WriteRegDWord HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;SafeTransactions&quot; &quot;00000000&quot;<br />
  WriteRegDWord HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;DriverID&quot; &quot;00000019&quot;<br />
  WriteRegDWord HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}\Engines\Jet&quot; &quot;Threads&quot; &quot;00000003&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}\Engines\Jet&quot; &quot;ImplicitCommitSync&quot; &quot;&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}\Engines\Jet&quot; &quot;UserCommitSync&quot; &quot;Yes&quot;<br />
  WriteRegDWord HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}\Engines\Jet&quot; &quot;PageTimeout&quot; &quot;00000005&quot;<br />
  WriteRegDWord HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}\Engines\Jet&quot; &quot;MaxBufferSize&quot; &quot;00000800&quot;<br />
 <br />
<br />
Finally, in the cleanup:<br />
<br />
  DeleteRegKey &quot;HKLM&quot; &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot;<br />
  DeleteRegValue &quot;HKLM&quot; &quot;SOFTWARE\ODBC\ODBC.INI\ODBC Data Sources&quot; &quot;${ODBC_CONNECTION_NAME}&quot;<br />
<br />
<br />
Your mileage may vary, but I've been using this method quite successfully on all of the NT-based boxes here at the office.<br />
<br />
I'm not sure whether this works with 9x kernels, but I can't think of any reason offhand why it wouldn't.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Domgrief</div><div class="date">27th August 2004, 04:12</div></div><div class="posttext">And the same again for SQL Server:<br />
<br />
In the defines we'll set the DSN name again:<br />
!define ODBC_CONNECTION_NAME &quot;MSPubs&quot;<br />
<br />
If anyone's screwing around with SQL Express 2005, you may need to axe the &quot;Database&quot; section and use &quot;localhost\pubs&quot; (or whatever) in the &quot;Server&quot; section instead. But you can find all that out by checking your own registry anyway.<br />
<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\ODBC Data Sources&quot; &quot;${ODBC_CONNECTION_NAME}&quot; &quot;SQL Server&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;Description&quot; &quot;MS Demo Database&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;Driver&quot; &quot;$SYSDIR\SQLSRV32.dll&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;LastUser&quot; &quot;bob&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;Server&quot; &quot;localhost&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;Database&quot; &quot;pubs&quot;<br />
<br />
<br />
And in the uninstaller:<br />
<br />
  DeleteRegKey &quot;HKLM&quot; &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot;<br />
  DeleteRegValue &quot;HKLM&quot; &quot;SOFTWARE\ODBC\ODBC.INI\ODBC Data Sources&quot; &quot;${ODBC_CONNECTION_NAME}&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vun</div><div class="date">5th October 2004, 02:29</div></div><div class="posttext">Hi all, I have some problems with my DSN creation. I used the examples above to try to create a DSN and I do not have any errors when compiling. But when I try to launch my program, I get prompted a message saying that DSN could not be found. I have posted my script below. I hope it explains my problem better. I am trying to create a DSN for Firebird database. Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vun</div><div class="date">5th October 2004, 02:34</div></div><div class="posttext">I'm so sorry. I posted the wrong script above and have removed it. The right one is below. Thanks once again!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vun</div><div class="date">6th October 2004, 03:13</div></div><div class="posttext">Hi I would really appreciate it if someone helped me out here. I only need this last part to work for my installer. Once this DSN creation part is done I will no longer bug anyone on the forum ;) . Thank you!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vun</div><div class="date">7th October 2004, 08:16</div></div><div class="posttext">Hi, I still have not been able to solve my problem which I stated above. To make thigs easier for all I am gonna paste my script in this post. If anyone ses any fault please tell me. Btw, Friday (tomorrow) is my last day for my attachment so I hope someone would reply me by then.<br />
<br />
Here's  the code:<br />
<br />
WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\ODBC Data Sources&quot; &quot;${ODBC_CONNECTION_NAME}&quot; &quot;Firebird Server&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;FIL&quot; &quot;Firebird;&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;Driver&quot; &quot;$SYSDIR\IB6ODBC.dll&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;Description&quot; &quot;Easy Soft IB6ODBC&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;UID&quot; &quot;&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;DBQ&quot; &quot;$INSTDIR\QSystem_ANSI.gdb&quot;<br />
  WriteRegDWord HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;SafeTransactions&quot; &quot;00000000&quot;<br />
  WriteRegDWord HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot; &quot;DriverID&quot; &quot;00000019&quot;<br />
  WriteRegDWord HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}\Engines\Jet&quot; &quot;Threads&quot; &quot;00000003&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}\Engines\Jet&quot; &quot;ImplicitCommitSync&quot; &quot;&quot;<br />
  WriteRegStr   HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}\Engines\Jet&quot; &quot;UserCommitSync&quot; &quot;Yes&quot;<br />
  WriteRegDWord HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}\Engines\Jet&quot; &quot;PageTimeout&quot; &quot;00000005&quot;<br />
  WriteRegDWord HKLM &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}\Engines\Jet&quot; &quot;MaxBufferSize&quot; &quot;00000800&quot;<br />
<br />
<br />
; For the delete section of the DSN  <br />
  DeleteRegKey &quot;HKLM&quot; &quot;SOFTWARE\ODBC\ODBC.INI\${ODBC_CONNECTION_NAME}&quot;<br />
  DeleteRegValue &quot;HKLM&quot; &quot;SOFTWARE\ODBC\ODBC.INI\ODBC Data Sources&quot; &quot;${ODBC_CONNECTION_NAME}&quot;<br />
<br />
Thanks in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vun</div><div class="date">7th October 2004, 10:28</div></div><div class="posttext">Ok I know I must be pissing a lot of people in this forum now, and I apologise for that. I just want to know must I have a ReadRegStr command before I start to write the registry strings for the dsn?<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th October 2004, 15:03</div></div><div class="posttext">I suggest you try brainsucker's method. If there is an API function for this, why use the registry directly?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">smarif</div><div class="date">22nd July 2009, 11:15</div></div><div class="posttext">Hi All,<br />
I just want to make a small note here... the solution of writing to registry given by Domgrief works absolutely fine, but just a small correction in the Driver ID dWord value should be &quot;0x00000019&quot; instead of &quot;00000019&quot; though this does not give any error it works fine it allows to connect to the DB as well, but if you go and check in the ODBC Administrator via control panel you wont see any database file there... after putting this string it works fine.<br />
<br />
thanks<br />
arif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">22nd July 2009, 11:34</div></div><div class="posttext">The other DWORD values should have 0x in front of them too. As you can imagine, &quot;00000019&quot; will be read by NSIS as decimal 1 and not 25 (0x00000019).<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>