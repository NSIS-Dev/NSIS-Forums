<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" !macro Suggestions, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  !macro Suggestions NSIS Discussion" />
	
	<title> !macro Suggestions [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  !macro Suggestions</div>
<hr />
<div class="pda"><a href="t-193805.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=193805">!macro Suggestions</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">16th September 2004, 23:05</div></div><div class="posttext">I do have some suggestions for the compile time command &quot;!macro&quot;:<br />
<br />
- Introduce nesting of !macro's inside themselves so you can record them when they are inserted. This would really cut a lot of space in a file. Like this code below (w/ the suggestion below also):<br />
<br />
!macro STRFUNC_DEFFUNC Name<br />
  !define `${Name}` `!insertmacro FUNCTION_STRING_${Name}`<br />
  !define `Un${Name}` `!insertmacro FUNCTION_STRING_Un${Name}`<br />
  <br />
  !macro `FUNCTION_STRING_Un${Name}`<br />
    !define `Un${Name}` `!insertmacro FUNCTION_STRING_${Name}`<br />
  !macroend<br />
!macroend<br />
<br />
!insertmacro STRFUNC_DEFFUNC StrCase<br />
!insertmacro STRFUNC_DEFFUNC StrClb<br />
!insertmacro STRFUNC_DEFFUNC StrIOToNSIS<br />
!insertmacro STRFUNC_DEFFUNC StrLoc<br />
!insertmacro STRFUNC_DEFFUNC StrNSISToIO<br />
!insertmacro STRFUNC_DEFFUNC StrRep<br />
!insertmacro STRFUNC_DEFFUNC StrSort<br />
!insertmacro STRFUNC_DEFFUNC StrStr<br />
!insertmacro STRFUNC_DEFFUNC StrStrAdv<br />
!insertmacro STRFUNC_DEFFUNC StrTok<br />
!insertmacro STRFUNC_DEFFUNC StrTrimNewLines(I was so excited with the size I could cut down with this, that I made StrFunc.nsh 1.07 first version based on the code above. Now that I discovered it is not that way, I saved it somewhere else so I can remember about this :))<br />
<br />
(This code is the initial definition of the header file commands for install and uninstall for the user to use)<br />
<br />
- Enable !macro's to have defined values (with !define) for the parameters. Like the code above suggests.<br />
<br />
- A character on the parameter name to make that parameter optional. This should be only for the last parameters of the macro. I.e.:<br />
<br />
!macro FUNCTION_STRING_StrStrAdv OutVar String StrToSearch *SearchDirection- A message is appearing when ${} is used. I know, it appears like a define but it cannot be one as you can't define &quot;&quot; or create an user variable with brackets &quot;{}&quot;.<br />
<br />
- Everytime a macro (macro #1) is called with an !insertmacro(macro #2) and this macro (macro #2) tries to get a parameter value of the main macro (macro #1) and push that value for use with functions, it pushes nothing. You can't know what is causing it because MessageBox ever gives the correct value, and dumpstate says that happened only empty pushes. An example of this:<br />
<br />
!macro TEST P1<br />
  Push `${${P1}}` ;Here is the problem<br />
!macroend<br />
<br />
!macro TEST2 Parameter1<br />
  !insertmacro TEST Parameter1 ;TEST2's 1st parameter name<br />
!macroend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th September 2004, 11:46</div></div><div class="posttext">Macro names with defines in them already work.<br />
<br />
What message appears when using ${}?<br />
<br />
Your last example works fine. Look for that push line in the compiler output.<br />
<br />
As for the rest, add a feature request. There are currently more important things to do, so it'll have to wait.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">17th September 2004, 23:08</div></div><div class="posttext">What message appears when using ${}?<br />
<br />
&quot;unknown variable/constant &quot;{}&quot; detected, ignoring&quot;<br />
<br />
How can it be a variable/constant if you can't !define or create a custom variable with that? I know, it's nothing really important...<br />
<br />
Your last example works fine. Look for that push line in the compiler output.<br />
<br />
Maybe I could test this after, as I fixed this using a different approach already on StrFunc.nsh.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">17th September 2004, 23:40</div></div><div class="posttext">Oh, the real problem was that !include was including the wrong file! I done it like this:<br />
<br />
!include &quot;StrFunc.nsh&quot;<br />
<br />
But on the current folder of the script there had this file with the same name (I was using it for backup). I can see now why some of your statements are true:<br />
<br />
Macro names with defines in them already work.Your last example works fine. Look for that push line in the compiler output.Posted feature requests.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>