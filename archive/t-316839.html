<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" InstallDirRegKey, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  InstallDirRegKey NSIS Discussion" />
	
	<title> InstallDirRegKey [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  InstallDirRegKey</div>
<hr />
<div class="pda"><a href="t-316839.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=316839">InstallDirRegKey</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">silencshadow</div><div class="date">6th February 2010, 14:14</div></div><div class="posttext">Hey Guys,<br />
i got a problem with InstallDirRegKey i need to check up 2 installdirregkeys for Teamspeak 3 Style package ...<br />
<br />
 InstallDirRegKey HKCU &quot;Software\TeamSpeak 3 Client&quot; &quot;&quot;<br />
 InstallDirRegKey HKLM &quot;Software\TeamSpeak 3 Client&quot; &quot;&quot;<br />
<br />
its everytime set the installdir to the last ... how i can check if first not exist take the second and if the last not exist take the first??<br />
<br />
Help plz :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">6th February 2010, 14:47</div></div><div class="posttext">There is only support for 1. To use more than one, you need to code it yourself in .onInit</div></div><hr />


<div class="post"><div class="posttop"><div class="username">silencshadow</div><div class="date">6th February 2010, 14:49</div></div><div class="posttext">Originally posted by Anders <br />
There is only support for 1. To use more than one, you need to code it yourself in .onInit  <br />
<br />
<br />
can you show me how? its needed ....<br />
<br />
thx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">silencshadow</div><div class="date">6th February 2010, 15:24</div></div><div class="posttext">*bump*</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">6th February 2010, 15:30</div></div><div class="posttext">Originally posted by silencshadow <br />
*bump*  <br />
<br />
Don't bump, you just posted this topic and it was #2 on the front page, bumping when you are really close to the top is just fucking rude. I was going to help you, but that is not going to happen now. You can wait (without bumping) to see if someone else gives you any help, or you can do it yourself, just take a look at the registry functions in the helpfile</div></div><hr />


<div class="post"><div class="posttop"><div class="username">silencshadow</div><div class="date">6th February 2010, 15:34</div></div><div class="posttext">Im sry though ur gone away and other guys think that this is solved.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CG!</div><div class="date">6th February 2010, 16:41</div></div><div class="posttext">But keep your project private if you include TeamSpeak files because the TeamSpeak Systems GmbH doesn't allow repackaging and republishing w/o permission. And as far as i understood, they won't give permission.<br />
it's the reason why there are no legal portable versions of TeamSpeak. The versions made with THinstall are illegal.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">silencshadow</div><div class="date">6th February 2010, 16:47</div></div><div class="posttext">Its a Skin, not illegal :) its official but i want to automatic it and i need to find out how i can check 2 regestrys from the regedit if they exist or not ... can anyone PLZ help me?!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">6th February 2010, 20:55</div></div><div class="posttext">Something like this...<br />
( checks HKCU first, falls back to HKLM, then falls back to a default path )<br />
<br />
!include &quot;LogicLib.nsh&quot;<br />
<br />
OutFile &quot;test.exe&quot;<br />
<br />
Function .onInit<br />
	; Clear all errors first<br />
	ClearErrors<br />
	<br />
	; Check for the HKCU registry key (presuming paramter 'InstallLocation' by the installer.<br />
	ReadRegStr $0 HKCU &quot;Software\TeamSpeak 3 Client&quot; &quot;InstallLocation&quot;<br />
	${Unless} ${Errors}<br />
		; If that doesn't fail, set the $InstDir variable to its value<br />
	    StrCpy $InstDir $0<br />
	${Else}<br />
		; Otherwise, try the HKLM registry key (clear errors flag first)<br />
		ClearErrors<br />
		ReadRegStr $0 HKLM &quot;Software\TeamSpeak 3 Client&quot; &quot;InstallLocation&quot;<br />
		${Unless} ${Errors}<br />
		    ; This should look familiar<br />
		    StrCpy $InstDir $0<br />
		${Else}<br />
		    ; If this also failed (so HKCU -and- HKLM failed), set a default location.<br />
		    StrCpy $InstDir &quot;$PROGRAMFILES\Default\Installation\Folder\&quot;<br />
		${EndIf}<br />
	${EndIf}<br />
	MessageBox MB_OK &quot;$$InstDir = $InstDir&quot;<br />
FunctionEnd<br />
<br />
Section<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">silencshadow</div><div class="date">6th February 2010, 23:19</div></div><div class="posttext">I say thx to you :) im very drunken, dont hope that i write stupid things :) and i have 1 more question, i want to build a exe ... i post it now ... second plz<br />
<br />
<br />
;--------------------------------<br />
;Include Modern UI<br />
<br />
  !include &quot;MUI2.nsh&quot;<br />
<br />
;--------------------------------<br />
;General<br />
<br />
  ;Name and file<br />
  Name &quot;Xetu-Hosting Teamspeak 3 Style&quot;<br />
  OutFile &quot;XetuStyle1.0.exe&quot;<br />
  <br />
  ;Get installation folder from registry if available<br />
 InstallDirRegKey HKCU &quot;Software\TeamSpeak 3 Client&quot; &quot;&quot;<br />
 ;InstallDirRegKey HKLM &quot;Software\TeamSpeak 3 Client&quot; &quot;&quot;<br />
<br />
<br />
  ;Request application privileges for Windows Vista<br />
  RequestExecutionLevel admin<br />
<br />
;--------------------------------<br />
<br />
XPStyle on<br />
Function .onInit<br />
<br />
    SetOutPath &quot;$TEMP&quot;<br />
    File &quot;C:\Users\SilencShadoW\Desktop\Desktop\Xetu-Hosting\Style\plugins\splash.bmp&quot;<br />
    File &quot;C:\Users\SilencShadoW\Desktop\Desktop\Xetu-Hosting\Style\plugins\splash.dll&quot;<br />
<br />
<br />
;--------------------------------<br />
<br />
        InitPluginsDir<br />
        File /oname=$TEMP\splash.bmp &quot;C:\Users\SilencShadoW\Desktop\Desktop\Xetu-Hosting\Style\plugins\splash.bmp&quot;<br />
<br />
        advsplash::show 1000 600 400 -1 $TEMP\splash<br />
<br />
        Pop $0          ; $0 has '1' if the user closed the splash screen early,<br />
                        ; '0' if everything closed normally, and '-1' if some error occurred.<br />
<br />
        Delete $TEMP\splash.bmp<br />
        Delete $TEMP\splash.dll<br />
	SetOutPath C:<br />
<br />
FunctionEnd<br />
<br />
;--------------------------------<br />
;Variables<br />
<br />
  Var StartMenuFolder<br />
<br />
;--------------------------------<br />
;Interface Settings<br />
<br />
  !define MUI_HEADERIMAGE<br />
  !define MUI_HEADERIMAGE_BITMAP &quot;C:\Users\SilencShadoW\Desktop\Desktop\Xetu-Hosting\Style\Header\xetu.bmp&quot;<br />
  !define MUI_ABORTWARNING<br />
<br />
;--------------------------------<br />
;Pages<br />
<br />
  !insertmacro MUI_PAGE_WELCOME<br />
  !insertmacro MUI_PAGE_LICENSE &quot;C:\Users\SilencShadoW\Desktop\Desktop\Xetu-Hosting\Style\Lizenz\License.txt&quot;<br />
  !insertmacro MUI_PAGE_COMPONENTS<br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  <br />
  ;Start Menu Folder Page Configuration<br />
  !define MUI_STARTMENUPAGE_REGISTRY_ROOT &quot;HKCU&quot; <br />
  !define MUI_STARTMENUPAGE_REGISTRY_KEY &quot;Software\Xetu-Hosting Teamspeak 3 Style&quot; <br />
  !define MUI_STARTMENUPAGE_REGISTRY_VALUENAME &quot;Start Menu Folder&quot;<br />
  <br />
  !insertmacro MUI_PAGE_STARTMENU Application $StartMenuFolder<br />
  <br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_PAGE_FINISH  <br />
<br />
<br />
  !insertmacro MUI_UNPAGE_WELCOME<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_UNPAGE_INSTFILES<br />
  !insertmacro MUI_UNPAGE_FINISH<br />
<br />
;--------------------------------<br />
;Languages<br />
 <br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
;--------------------------------<br />
;Installer Section<br />
<br />
<br />
Section &quot;Xetu-Hosting Icon Pack&quot; IconPack<br />
<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  <br />
    SetOutPath $INSTDIR\gfx\Xetu<br />
    File &quot;C:\Users\SilencShadoW\Desktop\Desktop\Xetu-Hosting\Style\gfx\Xetu\*&quot;<br />
    <br />
  !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
     <br />
  !insertmacro MUI_STARTMENU_WRITE_END<br />
<br />
SectionEnd<br />
<br />
<br />
;___________________________________________________________________<br />
<br />
Section &quot;Xetu-Hosting Emoticons&quot; Emoticons<br />
<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  <br />
<br />
    SetOutPath $INSTDIR\gfx\Xetu\emoticons<br />
    File &quot;C:\Users\SilencShadoW\Desktop\Desktop\Xetu-Hosting\Style\gfx\Xetu\emoticons\*&quot;<br />
    <br />
  !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
     <br />
  !insertmacro MUI_STARTMENU_WRITE_END<br />
<br />
SectionEnd<br />
<br />
<br />
;___________________________________________________________________<br />
<br />
<br />
Section &quot;Xetu-Hosting Style&quot; Style<br />
<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
<br />
<br />
    SetOutPath $INSTDIR\styles<br />
    File &quot;C:\Users\SilencShadoW\Desktop\Desktop\Xetu-Hosting\Style\styles\Xetu.qss&quot;<br />
    <br />
;___________________________________________________________________<br />
<br />
  ;Store installation folder<br />
  WriteRegStr HKCU &quot;Software\Xetu-Hosting Teamspeak 3 Style&quot; &quot;&quot; $INSTDIR<br />
  <br />
  ;Create uninstaller<br />
  WriteUninstaller &quot;$INSTDIR\XetuUninstall.exe&quot;<br />
  <br />
  !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
    <br />
    ;Create shortcuts<br />
    CreateDirectory &quot;$SMPROGRAMS\$StartMenuFolder&quot;<br />
    CreateShortCut &quot;$SMPROGRAMS\$StartMenuFolder\Uninstall.lnk&quot; &quot;$INSTDIR\XetuUninstall.exe&quot;<br />
<br />
  !insertmacro MUI_STARTMENU_WRITE_END<br />
<br />
<br />
SectionEnd<br />
<br />
;--------------------------------<br />
;Descriptions<br />
<br />
  ;Language strings<br />
  LangString DESC_IconPack ${LANG_ENGLISH} &quot;The Xetu-Hosting Icon Pack.&quot;<br />
  LangString DESC_Emoticons ${LANG_ENGLISH} &quot;The Xetu-Hosting Emoticons.&quot;<br />
  LangString DESC_Style ${LANG_ENGLISH} &quot;The Xetu-Hosting Style.&quot;<br />
 <br />
<br />
  ;Assign language strings to sections<br />
  !insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />
    !insertmacro MUI_DESCRIPTION_TEXT ${Style} $(DESC_Style)<br />
    !insertmacro MUI_DESCRIPTION_TEXT ${Emoticons} $(DESC_Emoticons)<br />
    !insertmacro MUI_DESCRIPTION_TEXT ${IconPack} $(DESC_IconPack)<br />
  !insertmacro MUI_FUNCTION_DESCRIPTION_END<br />
<br />
;--------------------------------<br />
;Uninstaller Section<br />
<br />
Section &quot;Uninstall&quot;<br />
<br />
  Delete &quot;$INSTDIR\gfx\Xetu\emoticons\*&quot;<br />
  Delete &quot;$INSTDIR\gfx\Xetu\*&quot;<br />
  Delete &quot;$INSTDIR\styles\Xetu.qss&quot;<br />
<br />
  Delete &quot;$INSTDIR\XetuUninstall.exe&quot;<br />
<br />
  RMDir &quot;$INSTDIR\gfx\Xetu\Emoticons&quot;<br />
  RMDir &quot;$INSTDIR\gfx\Xetu&quot;<br />
  <br />
  !insertmacro MUI_STARTMENU_GETFOLDER Application $StartMenuFolder<br />
    <br />
  Delete &quot;$SMPROGRAMS\$StartMenuFolder\Uninstall.lnk&quot;<br />
  RMDir &quot;$SMPROGRAMS\$StartMenuFolder&quot;<br />
  <br />
  DeleteRegKey /ifempty HKLM &quot;Software\Xetu-Hosting Teamspeak 3 Style&quot;<br />
<br />
SectionEnd<br />
<br />
Is there a way that i build this installer only as patcher? that i start it and then its checks on a site if there is a newer version of the gfx, gfx/emoticons and styles/xetu.qss ??<br />
and how i can solve it on the server if there is a way ... thank u!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">silencshadow</div><div class="date">7th February 2010, 09:03</div></div><div class="posttext">And i have one more Question, how can i add on the finishpage some boxes to mark like view changelog and the needed one is ... a box to mark that the installer close teamspeak 3 and restart it ... is there a way for it?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>