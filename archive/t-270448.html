<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Directory Constants on Japanese XP, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Directory Constants on Japanese XP NSIS Discussion" />
	
	<title> Directory Constants on Japanese XP [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Directory Constants on Japanese XP</div>
<hr />
<div class="pda"><a href="t-270448.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=270448">Directory Constants on Japanese XP</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mtconleyuk</div><div class="date">1st May 2007, 14:36</div></div><div class="posttext">I have an installer that I'm attempting to run on a Japanese system, but the predefined constants $SMPROGRAMS, $DESKTOP, $STARTMENU, and $SMSTARTUP (and possibly some others) all wind up pointing to the wrong location: the user's folder in the Documents and Settings folder.<br />
<br />
I'm not doing anything special, and I have a test script that just calls SetShellVarContext current, followed by a DetailPrint of each string, so I can see what they're supposed to be.<br />
<br />
Any idea why this should be happening? Does anyone else have this problem?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">1st May 2007, 15:27</div></div><div class="posttext">I just tried this on a Japanese system, and the constant values were correct for me. Are you running a true Japanese OS or another OS that has been set to Japanese?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mtconleyuk</div><div class="date">1st May 2007, 15:32</div></div><div class="posttext">I'm running Japanese Windows XP, installed from an MSDN developer disc.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mtconleyuk</div><div class="date">1st May 2007, 15:44</div></div><div class="posttext">Here's the test script I've been using, by the way.<br />
<br />
[Bogus test script deleted]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mtconleyuk</div><div class="date">1st May 2007, 15:53</div></div><div class="posttext">Sorry about that last post; here's a cleaned-up version of the script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">1st May 2007, 15:55</div></div><div class="posttext">I compiled and ran, and it displayed correctly for me. I'm testing on a Japanese XP VPC image. I had to comment out this:<br />
!include &quot;CMSLIb.nsh&quot;      ; CrystalMaker functions.<br />
 !insertmacro GetContextDocsFolder<br />
<br />
Unless that is causing the issue, it could be your instance of a Japanese system. NSIS has had multi-lingual support for a while now. VPC is now free, so if you confirm that it's your system causing the problem, you could install VPC to do your development and testing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mtconleyuk</div><div class="date">1st May 2007, 16:02</div></div><div class="posttext">You don't have to compile the thing on the Japanese system itself, do you? I built mine on a stock English system and copied the binary over.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">1st May 2007, 16:05</div></div><div class="posttext">Correct, you can compile on an English system. My last comment was confusing. I meant you could use VPC to test with, not to actually do your script development on.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mtconleyuk</div><div class="date">1st May 2007, 16:17</div></div><div class="posttext">Right. Well, I'm going to assume my system is corrupt and reinstall and see what happens. Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mtconleyuk</div><div class="date">2nd May 2007, 10:17</div></div><div class="posttext">I ran a repair from the installation DVD and now everything works fine. My guess is the problem occurred when I tried to install a video driver for this laptop awhile ago and the installation failed.<br />
<br />
Thanks for the script testing!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>