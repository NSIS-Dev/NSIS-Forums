<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How about file time of installed files... ?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How about file time of installed files... ? NSIS Discussion" />
	
	<title> How about file time of installed files... ? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How about file time of installed files... ?</div>
<hr />
<div class="pda"><a href="t-365794.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=365794">How about file time of installed files... ?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jenserl</div><div class="date">9th July 2013, 10:15</div></div><div class="posttext">Hello,<br />
<br />
looked up in the forum already, either i'm blind or unable to search :)<br />
<br />
I'm new to NSIS installer, took an example and built my own installer around it. Everything works great after some days. Good piece of software!<br />
<br />
I use the file time of the installed files as a hint for the version of the software:<br />
e.g. files of V 2.05.27 get a filetime of 05:27 So in case of service the version can easily be seen. The date is set to the release date of the software.<br />
<br />
The way i do it: Copy all files in the target folder and then build the installer, in which i execute filetime.exe, a simple command line tool to set the desired timestamp. At that point it's all ok, the files get the desired time stamp and it is also unchanged after building the installer - as it is supposed to.<br />
<br />
But:<br />
Finally the installed files have a timestamp of e.g. 04:27 instead of 05:27. Seems to be something around daylight time...<br />
<br />
<br />
For the last 10 years i've used an old version of Install Shield without having this timestamp problem. There i also have set the time stamp with filetime.exe<br />
<br />
Any idea how to keep the time stamp of the installed files untouched?<br />
<br />
Did not find anything in the users manual and not here in the forum.<br />
<br />
Regards, jenserl<br />
<br />
<br />
PS: The OS is WinXP</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jenserl</div><div class="date">12th July 2013, 11:41</div></div><div class="posttext">Wow, no one any idea...  ?<br />
<br />
:confused:  ooops...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">12th July 2013, 12:29</div></div><div class="posttext">You could include filetime.exe in the installer and set the timestamp after the files have been extracted on the final system.<br />
<br />
But the timestamp will still vary by an hour when the system switches to/from daylight time. Even with InstallShield it has been doing that all along, you've just not noticed it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">12th July 2013, 12:37</div></div><div class="posttext">Also, your method is not very well suited to your goals. Filetimes are subject to change by influence from the user.<br />
<br />
You're much better off putting the fileversion inside the files themselves.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jenserl</div><div class="date">15th July 2013, 10:58</div></div><div class="posttext">@ demiller9:<br />
Thank you for the hint with setting filetime after extraction.<br />
BUT fiddling around with this, i didn't find a way to have this done.<br />
<br />
I wrote the function:<br />
<br />
Function .onInstSuccess<br />
  MessageBox MB_OK &quot;Pre File Time!&quot;&quot;<br />
  !execute         &quot;C:\WINDOWS\filetime.exe C:\Program Files\MyApp\MyApp.exe -t 30062011080910&quot;<br />
  MessageBox MB_OK &quot;After File Time&quot;<br />
FunctionEnd<br />
<br />
<br />
The two MeesageBoxes show up, but the timestamp of MyApp.exe is unchanged.<br />
No error message in the MakeNSISW compiler,<br />
no error running the installer<br />
<br />
I also tried to place the &quot;!execuite...&quot; line inside, at the end, of the Section &quot;install&quot;, but nothing happened also.<br />
<br />
What I'm doing wrong? Maybe it's wrong just that I'm new to NSIS ... :-)<br />
<br />
<br />
<br />
Yes, i know about daylight problem, but it never showed up the last 8 years i was using the pretty old InstallShield V2.12 (62)...<br />
<br />
@MSG:<br />
Yes, there is version information in the executable.<br />
And i know about those users kidding around in the applications files, too ;-)<br />
But, if they do something wrong, its their machine not running and their prodution stopping.<br />
So, most of the useres dont do anything with the application directly, because finally they will pay the service staff and the loss of production   :D<br />
<br />
<br />
As i wrote in the initial posting: That timestamp is just a simple way to provide version info for our service staff. The application itself is not depending on that info. And, i repeat myself: Its all ok with that pretty old InstallShield.<br />
<br />
So i would like to use this way of help further on...<br />
If not possible, ok, forget abot it.<br />
<br />
Regards, Jenserl</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">15th July 2013, 11:59</div></div><div class="posttext">Use single and double quotes as here:<br />
http://nsis.sourceforge.net/Docs/Chapter5.html#5.1.9</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jenserl</div><div class="date">15th July 2013, 12:19</div></div><div class="posttext">@ jpderuiter:<br />
Sorry, this did not help also...<br />
<br />
Tried also the !system command, no change :-(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jenserl</div><div class="date">15th July 2013, 12:23</div></div><div class="posttext">During compile time, i set the datetime of the source files with:<br />
<br />
!execute                  &quot;${MYTOOLSPATH}\${FILETIMEAPP} ${SRCPATH_APP}\*.* -t ${APP_DATETIME}&quot;<br />
<br />
and this works as supposed...<br />
<br />
<br />
jenserl</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">15th July 2013, 12:57</div></div><div class="posttext">!execute is a compile time command, you want the execution time command ExecWait (or one of the plug-in equivalents like nsExec::Exec to avoid a console window).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">15th July 2013, 15:05</div></div><div class="posttext">There's also the Time plugin (http://nsis.sourceforge.net/Time_plug-in).<br />
But if your exe already contains version info, why can't your service guy just hover the mouse over it? No offence, but it's like your philosophy is &quot;let's do it the complicated and unreliable way&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jenserl</div><div class="date">17th July 2013, 08:44</div></div><div class="posttext">@demiller9<br />
Oh yes, true. But with all the Exec... Commands i could not get datetime.exe to work. It seemed to run without error but did not change anything. Seems i still do basic things wrong... :-( Tried it in section &quot;install&quot; after the File commands, tried it in  .onInstSuccess - nothing happened.<br />
<br />
@aerDNA<br />
Anyway, this helped. Thank you very much, it brought the solution. File datetime changing now as desired.<br />
<br />
<br />
But, demiller9, you are right :up:, depending on daylight time, the displayed filetime is adjusted. Either i really did not have to use this little helper or it just happened that daylight time was correct everytime we looked at the files :-) :rolleyes:<br />
<br />
OK, that all brought me a bit deeper into NSIS and i learned a lot about the way to do things. Even therefore i thank you all very much for your help. <br />
<br />
So lets close this thread now. Have a nice time,<br />
Jenserl</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">17th July 2013, 14:02</div></div><div class="posttext">You do realize you haven't solved the post-install DST switch problem? And you're not going to since you're working with local time. UTC you'd have to get programmatically, which defeats your purpose. Suit yourself.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jenserl</div><div class="date">18th July 2013, 09:39</div></div><div class="posttext">Hey aerDNA,<br />
<br />
yes, i realized that the &quot;problem&quot; is not solved. But it's behaving the same now as with the 8 years old solution before. And i think i can live with that also the next 8 years... :D<br />
<br />
As i wrote above, it's only a little helper and rarely used, because...<br />
- as long as the application is running, the version is shown in the title line. So, no problem.<br />
- if not and a service guy is around, he knows to look up the version in the properties. So, no problem also.<br />
- Only if it happens that i've to talk with a machine operator (their main knowledge is how to use hammer and wrench...:)) AND the app refusing to run, it's good to have a simple way to find out about the version. Next, the files' date is set to the release date of the version, at least looking up the release date in my documents shows the correct version. Mostly its enough already to see that all the application's files have same version and are not mangled by some creative users. For that, even a time shifted timestamp is ok, as long as all files have the same...<br />
<br />
The way it was and is now will fit the requirements...<br />
<br />
But back to your suggestion with UTC:<br />
Did you mean to set the PC's time to UTC and disable DST switching? Or setting the file time as UTC time? I i've tried the second with the Time plugin, but of course with DST change also the displayed file time changed - as expected...<br />
<br />
Well, a new installer was on my ToDo list for longer time already. Since there was a delay in the mechanic part of the current project, i've found enough time now to do this. The new installer now is doing what is expected: Its installing an application... :up: :-) For me, the rest is more or less &quot;a little cosmetic&quot; problem. And that all suits my needs now...<br />
<br />
Best regards and thank you for your help,<br />
Jenserl</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>