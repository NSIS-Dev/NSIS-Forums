<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Patch technology in NSIS, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Patch technology in NSIS NSIS Discussion" />
	
	<title> Patch technology in NSIS [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Patch technology in NSIS</div>
<hr />
<div class="pda"><a href="t-47383.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=47383">Patch technology in NSIS</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">17th April 2001, 20:41</div></div><div class="posttext">Hi everyone,<br />
<br />
I'm currently working on a 'patch' program which allows you to update files from 1 version to another.<br />
It'll calculate the CRC of the source file, check if the patch is designed for this purpose, patch it, and then check to see if the CRC of the target file is correct.<br />
<br />
However, I'm currently still working on the patch generator - though I have a (very) slow VB version which works.<br />
<br />
Does anyone have any suggestions for a patcher?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">18th April 2001, 19:58</div></div><div class="posttext">Hello everyone,<br />
<br />
I'm still working on it, but I'm currently tracking down some bugs in the patch generator.<br />
Once I got those ironed out, I have a basic patch generator. If you have a 1 MB file which is 90% identical to file #2, the patch will be about 20% - not very good, but it's a start.<br />
<br />
After I get some bugs out, I can start on optimizing.<br />
<br />
Is anyone interested in a patcher anyway?<br />
<br />
Estimated size for the patch program executable itself is 32-64 KB. (Haven't finished it yet).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rm'</div><div class="date">19th April 2001, 02:20</div></div><div class="posttext">Originally posted by Koen van de Sande <br />
Is anyone interested in a patcher anyway?<br />
<br />
Yes. Clickteam has a nice patch proggie, but then again, it's Clickteam. I'd prefer something that's adless.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">polaughlin</div><div class="date">19th April 2001, 03:18</div></div><div class="posttext">I am very much interested.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">19th April 2001, 18:38</div></div><div class="posttext">I fixed tons of bugs in my patcher, but there still appears to be one left, there is a problem with files larger than 1 MB and/or non-text characters. I'll just have to keep looking...<br />
<br />
Still, the patcher is coming along quite nicely, it can at least generate patches now, and I have a &quot;Patcher&quot; which applies it to a file. Current size of the Patcher is 62 KB (or 28 KB after UPX), which is quite big. However, I'm using Delphi, so you do not need any extra other files. It's 62 KB plus the patch file size and nothing more.<br />
<br />
After I get all bugs out, I can start to improve performance (and efficiency) of the patch generator. I'm not using any compression, because the compression inside NSIS is much better than anything I can add.<br />
<br />
I'll post any progress I make here.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">20th April 2001, 20:44</div></div><div class="posttext">I fixed a copy-paste bug (which took me 2 days).<br />
<br />
It works very well now, very fast compared to my VB version. I'm going to try and add variable-block size searching next, which'll improve both speed and patch size.<br />
<br />
Is anyone else interested besides polaughin and Radioactive Man?<br />
<br />
I could use a C(++) programmer who can translate the actual runtime program into C and make it smaller, because it's 61 KB because of the Delphi stuff.<br />
<br />
It's a really simple program, less than 200 lines (haven't looked).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Edgewize</div><div class="date">21st April 2001, 00:22</div></div><div class="posttext">I'd be glad to create a very small compiled C version!  You can keep all the credit for the program as long as I get to use it in my installer :)<br />
<br />
Send me an email - wiked_edge@yahoo.com</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">21st April 2001, 13:05</div></div><div class="posttext">That'd be great edgewize! I'm currently brushing up things a bit and making some last changes to the file format. And I just rewrote the CRC code a little which saves 1 kb.<br />
<br />
Runtime size is now 61 KB, or 30 KB after UPX. Patch files can be (must be) linked to the exe in order to work. The file format supports multiple patches inside one patch file, but only one patch can be executed at a time.<br />
All this is possible, but I haven't written support for it in the generator.<br />
<br />
I'll send you the source code for the patcher tonight (including some test patches/files).<br />
<br />
Should I release a first version which works, or should I wait until I've improved compression and speed in the generator?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">22nd April 2001, 20:21</div></div><div class="posttext">I've just uploaded VPatch v1.0 (yes, it has a name now) to: http://www.tibed.net/vpatch/vp100.exe<br />
<br />
What can it do?<br />
- Create a small patch from an old version to a new version.<br />
- Attach patches for multiple files to the patcher (so you only need to include this 30 KB once)<br />
- Configure compression through genpat.ini (make sure you do this in order to have acceptable creation times).<br />
- On my test files, it makes Clickteam Patch Maker look like crap: I have smaller patches (but it takes much longer than in Patch Maker).<br />
<br />
E-mail koen@tibed.net or post here with suggestions/bug reports!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Edgewize</div><div class="date">23rd April 2001, 02:59</div></div><div class="posttext">This is a replacement vpatch.bin with full source code, and a project file for MSVC++ 6.0 (sp4).  Only 4k, much smaller for less overhead on the patch EXE file.<br />
<br />
http://edgewize.cjb.net/vpatch_c.zip</div></div><hr />


<div class="post"><div class="posttop"><div class="username">polaughlin</div><div class="date">24th April 2001, 04:42</div></div><div class="posttext">Are you planning on implementing a GUI for this patch program?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">24th April 2001, 18:06</div></div><div class="posttext">Yes, a GUI is planned, but I haven't started yet. If someone makes a good GUI for NSIS, perhaps the patcher could be integrated.<br />
But I can probably make an application where you can select original/new versions, create patches, save projects, etc. Then you'd no longer have to use any of the commandline utilities.<br />
<br />
But I'm going to work on the Patch Generator itself first, I'm hoping to make it a little faster.<br />
<br />
Question: v1.0 uses very little memory, but read the file the whole time from disk. Does anyone mind if the program is going to use SourceSize+TargetSize MB of RAM? Adding this will make patch creation of large files slower, but other things will be faster.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bor</div><div class="date">24th April 2001, 18:30</div></div><div class="posttext">Maybe you could make it an option so you can choose to use more RAM or read the file from disk.<br />
<br />
Bor</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">30th April 2001, 21:19</div></div><div class="posttext">I just made it use memory instead of disk - this causes a major speed increase :) - my new version works 80% faster. I'll be releasing this new version soon.<br />
(now that it's faster, I can increase the default compression to be better).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">2nd May 2001, 14:17</div></div><div class="posttext">80% faster is not a correct measure.<br />
I mean 5 times faster.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>