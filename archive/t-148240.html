<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Banner doesn't show, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Banner doesn't show NSIS Discussion" />
	
	<title> Banner doesn't show [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Banner doesn't show</div>
<hr />
<div class="pda"><a href="t-148240.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=148240">Banner doesn't show</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">5th September 2003, 19:02</div></div><div class="posttext">The banner plugin doesn't show in the latest CVS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th September 2003, 20:17</div></div><div class="posttext">Thanks, fixed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th September 2003, 20:18</div></div><div class="posttext">Was there changes made to the banner plugin, if so was it to remove the task bar item?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th September 2003, 20:22</div></div><div class="posttext">No.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">6th September 2003, 00:26</div></div><div class="posttext">eek! Banner doesn't show the text</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th September 2003, 09:47</div></div><div class="posttext">Works fine for me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">7th September 2003, 12:33</div></div><div class="posttext">Lobo is right. There is problem with it (for me it occurs whenever some window exists under banner dialog at the moment of startup). Moreover: after some time it stops responding to windows messages (seems so), so no repaint occur.<br />
<br />
Also a small tip: the user may want sometimes to set separate window name and ICD_STR text, so may be you should check it is not already set.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">7th September 2003, 15:04</div></div><div class="posttext">On Win98SE the banner appears but has no text on it (I tried the 'Example.nsi' script in the Contrib\Banner folder).<br />
<br />
The &quot;Calculating..&quot; text which is supposed to appear in the banner appears in the taskbar.<br />
<br />
I am using the 7 September (13:44 GMT) CVS snapshot which has Banner.DLL v1.5.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th September 2003, 15:08</div></div><div class="posttext">It never responded to Windows messages in .onInit. I have fixed that along some other thing in some version, but that resulted in:<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=136605&amp;highlight=banner<br />
<br />
so I reverted back. Ramon was supposed to write a new version of Banner that would solve all known issues but got the same results as I did. We were both busy with other things so we left it aside for now.<br />
<br />
Anyway, Banner shows for me every time and besides adding a ShowWindow command on WM_INITDIALOG nothing has changed about Banner. I will need an example.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th September 2003, 15:15</div></div><div class="posttext">Oh, of course... If it doesn't accept messages... Bah... Brainsucker, got time to rewrite it? :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">7th September 2003, 15:28</div></div><div class="posttext">thanks... I thought that It was only me. Testing in WinMe appears the banner but no text.<br />
In WinXP is fine. It appers correcly, as older versions...<br />
Is it fixed now?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th September 2003, 15:30</div></div><div class="posttext">No.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">8th September 2003, 13:26</div></div><div class="posttext">I hate GUI. I hate windows GUI twice as much.<br />
<br />
p.s. There are some changes on using at .onInit and some additional functionality. see banner.txt for my comments</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">8th September 2003, 13:30</div></div><div class="posttext">You could of course use banner::destroy without /nounload at .oninit, but NSIS window will appear somewhere at background.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">emiste7</div><div class="date">8th September 2003, 14:59</div></div><div class="posttext">My old banner two text in two different lines....<br />
with the update....just the banner no text.<br />
Downloaded the Banner1 from here ...same problem..no text.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">8th September 2003, 15:54</div></div><div class="posttext">The new DLL in &quot;banner1.zip&quot; works OK on my Win98SE system. The 'Contrib\Banner\Example.nsi' script now works and in my MUI-based installer the banner now appears with two lines of text.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">8th September 2003, 16:28</div></div><div class="posttext">emiste7 could you post your script and you OS version here?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">emiste7</div><div class="date">8th September 2003, 18:52</div></div><div class="posttext">I just dowloaded the new version of the NSIS b4 and I used the banner in the Examples.<br />
And I dowloaded your banner1.....doesnt work I cant see the text<br />
OS XP pro<br />
And this it was the old one<br />
Function .onInit<br />
Banner::show /NOUNLOAD /set 76 &quot;Welcome from the team&quot; &quot;Vers. 2.1&quot;<br />
;&amp;&amp; This is much easier on the poor ol' CPU!<br />
Sleep 1800<br />
Banner::destroy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">8th September 2003, 19:58</div></div><div class="posttext">I know it's a stupid question, but have you copied banner.dll to your plugins dir? ;)<br />
<br />
Ok. it shows the banner window but no text in it? strange. Could you please increase sleep value and drag some window over the banner. During this operation banner window saves it's contents (or its saves the contents of dragged window)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">emiste7</div><div class="date">9th September 2003, 02:20</div></div><div class="posttext">Yes I did......<br />
I  changed the time ......nothing.<br />
I updated the NSIS nothing ,I uninstalled all .....because it wasnt showing in the Finish page the link and run checkbox.<br />
I downloaded a new NSIS.....now I can see the text, both lines, but..probably is my immagination, I dont see the icon in the banner.<br />
Is the usually an icon in the banner????<br />
and The link and the run check box still missing.<br />
I dont know......</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lzandman</div><div class="date">9th September 2003, 09:20</div></div><div class="posttext">I also noticed something strange using the banner-plugin. When I start my installer from a command-prompt (cmd.exe) in Windows XP the the banner is displayed too small. But when starting it using &quot;start.exe&quot; everything is just fine.<br />
<br />
I guess the difference is, when it is started from cmd.exe the NSIS process is created using CreateProcess(). When started using &quot;start.exe&quot; it is started using ShellExecute(). But can anyone explain why the banner displays incorrectly?<br />
<br />
BTW: I'm still using NSIS v2.0b3<br />
<br />
Greetings,<br />
<br />
Leon</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">9th September 2003, 10:39</div></div><div class="posttext">&gt; Is the usually an icon in the banner???? <br />
yes, there is usually icon at the MUI banners. his could be connected with troubles with MUI, since banner is using IDD_VERIFY dialog. also, /set 76 will work only at MUI installations, there is no such dialog item at usual nsis (just a tip, I didn't got which banner example you have used. If that is one from contrib\banner it will show only &quot;ver2.1&quot;). <br />
<br />
Leon: which banner you have tested? old (from cvs) or banner1?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lzandman</div><div class="date">9th September 2003, 12:58</div></div><div class="posttext">Originally posted by brainsucker <br />
Leon: which banner you have tested? old (from cvs) or banner1? The banner.dll itself doesn't have version info attached, so I can't tell you which version it is.<br />
<br />
I've downloaded the file &quot;NSIS 2.0 Beta 3a - Released March 15, 2003&quot; from the NSIS website. I use the banner.dll that's included in that version.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th September 2003, 13:28</div></div><div class="posttext">Try the banner.dll that brainsucker attached here, that's banner1 (see the zip name). As for CVS, see http://nsis.sf.net/ for more information on development versions.<br />
<br />
emiste7, as I've said here (http://forums.winamp.com/showthread.php?s=&amp;threadid=148349), make sure you are using the latest CVS version and not that from 24 hours ago. See the sticky about CVS issues for more information about 24 hours lag. You should use the snapshot until SourceForge fix their CVS issues.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th September 2003, 17:21</div></div><div class="posttext">Brainsucker, your Banner version (and my old new one too) pops strings from the stack on another thread. It can cause trouble because the user might use the stack on .onInit after calling Banner.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">9th September 2003, 17:36</div></div><div class="posttext">My ;) banner version waits till the other thread will pop arguments from stack ;) see the while (!hwBanner) Sleep(1); cycle. I was to lasy to pop them before analysis, so this is the easiest way (I think).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th September 2003, 18:31</div></div><div class="posttext">Ah, right... Probably is easier than poping them on the main thread...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th September 2003, 20:02</div></div><div class="posttext">Here is anoter version based on some of both worlds. This one works just as the old one (no need to use /NOUNLOAD for destroy and destroy again in a section). For now it's just a proof of concept, it just shows how it works. It is not for public usage as it contains debug messages (nothing you'll see unless you really want to) and it probably needs more testing. But it does resolve the problem with the installer poping on the background.<br />
<br />
Please try it (but don't use it in your production installers for) and tell me if you find any problems.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">9th September 2003, 23:09</div></div><div class="posttext">hm. Sorry, kichik, but it doesn't work for me. the window is still at background. And Install options fail again here.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lzandman</div><div class="date">10th September 2003, 09:25</div></div><div class="posttext">Originally posted by kichik <br />
Try the banner.dll that brainsucker attached here, that's banner1 (see the zip name). As for CVS, see http://nsis.sf.net/ for more information on development versions.Using banner1 it works. Thanx...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th September 2003, 11:24</div></div><div class="posttext">Oops, last minute addition killed it. Here's one that does show it on top. What do you mean by &quot;Install options fail again here&quot;? <br />
<br />
The Banner.dll attached crashes if destroy is called a very short period of time after show, so don't use it except for checking that the dialog shows on the foreground.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">10th September 2003, 12:29</div></div><div class="posttext">Kichik, I tried using your revised banner.dll on my Win98SE system, using the 9 September (19:44 GMT) CVS snapshot. The Contrib\Banner\Example.nsi script worked OK but when I tried my MUI-based script, the installer crashed.<br />
<br />
In my installer I have a custom page 'leave' function which displays a banner for 5 seconds. No banner appeared then after about 5 seconds I got the following error message:<br />
<br />
THE-PROGRAM caused an invalid page fault in<br />
module &lt;unknown&gt; at 0000:00cc102c.<br />
Registers:<br />
EAX=00000000 CS=0187 EIP=00cc102c EFLGS=00010202<br />
EBX=00ddfa90 SS=018f ESP=00ddfa40 EBP=00ddfa5c<br />
ECX=00000000 DS=018f ESI=00008ab4 FS=1b07<br />
EDX=00008ad0 ES=018f EDI=00ddfa44 GS=57ff<br />
Bytes at CS:EIP:<br />
<br />
Stack dump:<br />
bff7363b 00000724 00000046 00000000 00ddfad0 8a8e57ff 0000018f 00ddfa70<br />
bff94407 57ff8ab4 000057ff 00000000 bff719b8 00008aae 00ddfd30 bff7186d <br />
<br />
I'm not sure if 5 seconds counts as &quot;a very short period of time&quot; so the crash may not be a problem. However the banner did not appear (expected to see an icon and two lines of text)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th September 2003, 12:31</div></div><div class="posttext">It always worked when the NSIS window already existed, that doesn't matter. I need to know if it works on .onInit. Should have been more clear on that, sorry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th September 2003, 13:42</div></div><div class="posttext">OK, here's one that's not supposed to crash anywhere. It turned up well on all of my tests, .onInit and not .onInit. Please let me know if it crashes or doesn't behave as expected anywhere.<br />
<br />
It also has some of Brainsucker's additions, namely the ability to hide the taskbar icon (set main text to &quot;&quot;) and the ability to set a different text for the window and IDC_STR (/set 1030 &quot;test&quot; &quot;another text&quot;). I have not added the ability to disable the window because that's already possible with the built-in EnableWindow NSIS script instruction.<br />
<br />
It's still full of debug information, so I don't recommend you use it in public installers (unless it's beta too, heh).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">10th September 2003, 14:32</div></div><div class="posttext">Kichik, sorry I missed the part about .onInit. After downloading the latest version of your DLL, I modified .onInit to display a banner for 5 seconds (the same banner as my custom page's 'leave' function).<br />
<br />
The .onInit banner appeared (with the icon and two lines of text) when I started the installer. But when I reached the part where the custom page 'leave' function displays a banner, no banner appeared. This time no error appeared and after 60 seconds I tried Ctrl-Alt-Del and found that my installer was listed as &quot;(Not responding)&quot;.<br />
<br />
Brainsucker's DLL from banner1.zip works perfectly in my installer (in .onInit and in the custom page's 'leave' function).<br />
<br />
I'm using Win98SE and the 9 September (19:44 GMT) CVS snapshot and an MUI-based installer script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th September 2003, 15:13</div></div><div class="posttext">Thanks, fixed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">10th September 2003, 16:14</div></div><div class="posttext">Kichik, your latest banner.dll now works OK in .onInit and in my custom page 'leave' function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th September 2003, 17:35</div></div><div class="posttext">OK, uploaded new Banner. Thanks for helping us test.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>