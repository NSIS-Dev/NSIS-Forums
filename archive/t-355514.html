<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" change default push button, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  change default push button NSIS Discussion" />
	
	<title> change default push button [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  change default push button</div>
<hr />
<div class="pda"><a href="t-355514.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=355514">change default push button</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">nashtor</div><div class="date">4th February 2013, 12:15</div></div><div class="posttext">Hi there,<br />
<br />
I am using MUI2 and created a textfield and a button on a custom page.<br />
<br />
If the user writes something into the textfield I would like the button to be pushed as soon as return/enter is pushed. (much like the behavior of &quot;run.exe&quot;)<br />
<br />
${NSD_CreateText} 35% 0 25% 12u &quot;&quot;<br />
Pop $SearchField<br />
${NSD_CreateButton} 60% 0 5% 12u &quot;=&quot;<br />
Pop $SearchBTN<br />
<br />
After reading documentations and forum post for hours I believe &quot;DM_SETDEFID&quot; (!define DM_SETDEFID 0x401) to be the solution I need. But I cannot get it to work. Maybe I am even using 'SendMessage' wrong.<br />
<br />
Could somebody profide an example or post an idea on how to solve this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">4th February 2013, 13:07</div></div><div class="posttext">http://forums.winamp.com/showthread.php?t=334783</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nashtor</div><div class="date">5th February 2013, 23:45</div></div><div class="posttext">@jpderuiter<br />
already tried this before but with no luck.<br />
<br />
<br />
<br />
Just wrote a basic script I would like you to take a look at please.<br />
I believe I am totally missing something here ...<br />
;--------------------------------<br />
;Include<br />
	<br />
	!include &quot;MUI2.nsh&quot;<br />
	!include &quot;nsDialogs.nsh&quot;<br />
	!include &quot;LogicLib.nsh&quot;<br />
	!include &quot;winmessages.nsh&quot;<br />
<br />
<br />
;--------------------------------<br />
;General<br />
	<br />
	Name &quot;ChangeDefaultButton&quot;<br />
	OutFile &quot;ChangeDefaultButton.exe&quot;<br />
	<br />
	InstallDir &quot;$EXEDIR&quot;<br />
<br />
	RequestExecutionLevel user<br />
<br />
	<br />
;--------------------------------<br />
;Variables<br />
<br />
	Var Dialog<br />
	Var SearchBox<br />
	Var SearchBTN<br />
	<br />
	<br />
;--------------------------------<br />
;Definitions<br />
	<br />
	!define DM_SETDEFID 0x401<br />
	<br />
	<br />
;--------------------------------<br />
;Pages<br />
	<br />
	Page custom nsDialogsSearchPage &quot;SearchPage_leave&quot;<br />
	!insertmacro MUI_PAGE_INSTFILES<br />
	<br />
	<br />
;--------------------------------<br />
;Languages<br />
	<br />
	!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
	<br />
	<br />
;--------------------------------<br />
;Sections<br />
<br />
Section DummySection<br />
<br />
SectionEnd<br />
	<br />
	<br />
;--------------------------------<br />
;Functions<br />
<br />
Function nsDialogsSearchPage<br />
	<br />
	!insertmacro MUI_HEADER_TEXT &quot;SearchPage&quot; &quot;Is ENTER working for you?&quot;<br />
	<br />
	nsDialogs::Create 1018<br />
	Pop $Dialog<br />
<br />
	${If} $Dialog == error<br />
		Abort<br />
	${EndIf}<br />
	<br />
	<br />
	${NSD_CreateText} 20% 40% 40% 12u &quot;&quot;<br />
	Pop $SearchBox<br />
	<br />
	${NSD_CreateButton} 60% 40% 10% 12u &quot;search&quot;<br />
	Pop $SearchBTN<br />
	<br />
	${NSD_OnClick} $SearchBTN OnClick_Search<br />
	<br />
	# with $HWNDPARENT there will be no errorsound while pushing enter; but it will not activate SearchBTN either<br />
	# if $HWNDPARENT is replaced by $SearchBox, NEXT/INSTALL button becomes the default button again<br />
	SendMessage $HWNDPARENT ${DM_SETDEFID} $SearchBTN 0<br />
	<br />
	# just so you can write directly into searchBox when the page is created:<br />
	SendMessage $HWNDPARENT ${WM_NEXTDLGCTL} $SearchBox 1<br />
	<br />
	nsDialogs::Show<br />
	<br />
FunctionEnd<br />
<br />
Function SearchPage_Leave<br />
<br />
	Abort<br />
	<br />
FunctionEnd<br />
<br />
Function OnClick_Search<br />
	<br />
	MessageBox MB_OK &quot;SearchBTN was clicked ...&quot;<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">6th February 2013, 06:13</div></div><div class="posttext">The WPARAM (first parameter) for the DM_SETDEFID message should not be the button handle, it has to be the button id.<br />
<br />
For your example program, that is 1201. The thread that jpderuiter pointed out to you makes that clear (the original poster in that thread did the same mistake). Your program will work when you change line 81 to read SendMessage $HWNDPARENT ${DM_SETDEFID} 1201 0The first control you created (the edit box) will be 1200, then they count up from there.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nashtor</div><div class="date">6th February 2013, 19:37</div></div><div class="posttext">Thank you very much!<br />
It's working almost perfectly!<br />
<br />
My appologies for asking a already answered question a second time --&gt; I did not get the &quot;$mui.Button.Back.Id&quot;, sorry for that.<br />
<br />
<br />
Just one thing that still confuses me:<br />
With this method all non-buttons (texts, layers...) get the default pushable button set to the specified ID. I believe I have to change the 'HWNDPARENT'-part but neither ID nor $SearchField seems to work...<br />
Is it possible to just change the default button of one 'edit' field?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">6th February 2013, 20:44</div></div><div class="posttext">The default button is a dialog setting, it applies to the entire dialog. (That's why the SetDefaultId message name begins with DM - Dialog Message).<br />
<br />
You could change the default button as the user navigates around on the form, but you'll need to capture events that occur when controls get and lose focus. I don't know if NsDialogs gives you that fine a level of control.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nashtor</div><div class="date">7th February 2013, 08:54</div></div><div class="posttext">Thanks for your help and clarification! I really appreciate it!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>