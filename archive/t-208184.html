<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstaller log, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstaller log NSIS Discussion" />
	
	<title> Uninstaller log [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstaller log</div>
<hr />
<div class="pda"><a href="t-208184.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=208184">Uninstaller log</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">tbreina</div><div class="date">18th February 2005, 17:18</div></div><div class="posttext">Ok. I've read the threads regarding creating an uninstaller log to list which files my package installs, but am still a little stumped.<br />
<br />
The script by Afrow UK (http://nsis.sourceforge.net/archive/viewpage.php?pageid=556) works fine for me (except I had trouble with the variable $OUTPATH and changed it to $OUTDIR). I get a nice log of all the files I called during install.<br />
<br />
However, as with a previous user (another thread on the subject), I can't seem to figure out how to take care of the case where I have installed an entire directory with a wildcard ( e.g. <br />
<br />
${File} /r &quot;dir1\*.*&quot; <br />
<br />
would be the command using Afrow UK's script above). I could just RMDIR /r to get everything in that directory, but would rather have the uninstall log file print out each file that dir1\*.* caused to be installed.<br />
<br />
Can this be done with an embedded FindFirst/FindNext/FindClose?<br />
I was thinking for example,<br />
<br />
Var UninstLog<br />
<br />
; Add file macro<br />
!macro File FileName<br />
FindFirst $0 $1 ${FileName}<br />
loopfindfirst:<br />
  StrCmp $1 &quot;&quot; done<br />
  DetailPrint $1<br />
  File $1<br />
  FileWrite &quot;$UninstLog&quot; &quot;$OUTDIR\$1$\r$\n&quot;<br />
  FindNext $0 $1<br />
  Goto loop<br />
donefindfirst:<br />
!macroend<br />
!define File &quot;!insertmacro File&quot;<br />
 <br />
<br />
The problem here is that the loopfindfirst: is re-declared each time the ${File} command is sent (which generates an error}.<br />
<br />
Anyone see a better solution?<br />
<br />
Thanks.<br />
-Tony</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th February 2005, 19:57</div></div><div class="posttext">FindFirst won't be the best solution because there may be other files in the directory you're installing to. Currently, the best solution is using an external program to create a list of files from a wildcard. The program can use Afrow's macro for each file. This program can be executed using !system and its output can be included in the script using !include. It's possible to write such a program even as a NSIS installer.<br />
<br />
A similar program was built for similar situation:<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=150770&amp;highlight=rsegal</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tbreina</div><div class="date">18th February 2005, 20:25</div></div><div class="posttext">The FolderList.exe program seems to be exactly what I need (even a little better than for what I'm using it for).<br />
<br />
Thanks.<br />
-Tony<br />
<br />
p.s. Could this program be referenced along with scripts that build uninstaller logs</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>