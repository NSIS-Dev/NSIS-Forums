<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Failing section access by index at runtime, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Failing section access by index at runtime NSIS Discussion" />
	
	<title> Failing section access by index at runtime [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Failing section access by index at runtime</div>
<hr />
<div class="pda"><a href="t-322945.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322945">Failing section access by index at runtime</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mabian</div><div class="date">6th October 2010, 11:01</div></div><div class="posttext">Hello,<br />
<br />
I am seeing a strange thing:<br />
<br />
I have several sections built using macros, they have index {S1} to {S5}.<br />
The sections have empty name and have the /o setting to make them disabled by default.<br />
Then, within the onInit handler, I call the following function to work on the {Sn} indexed sections.<br />
<br />
Function InitializeSections<br />
	${ForEach} $i 1 5 + 1<br />
		StrCpy $P_SectionIndex &quot;S$i&quot;<br />
<br />
		ClearErrors<br />
		SectionGetText {$P_SectionIndex} $P_SectionName<br />
		IfErrors 0 +2<br />
		MessageBox MB_OK &quot;Error!&quot;<br />
		MessageBox MB_OK &quot;Section Name: $P_SectionName&quot;<br />
<br />
(... do something else on the section with {$P_SectionIndex} index)<br />
<br />
	${Next}<br />
FunctionEnd<br />
<br />
The problem is that the code seems to access the sections by sequence instead of by name. <br />
The error message is never shown.<br />
I thought I would be able to access sections using their index stored in a variable, but it doesn't seem to work.<br />
If I try to retrieve the text when P_SectionName is &quot;S1&quot; I get the very first section of the whole project, &quot;S2&quot; gets the second and so on, in other words it seems only the numeric part of the index is used. Am I missing something or do indexes only work by numeric index?<br />
<br />
Thanks,<br />
   Mario</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th October 2010, 11:34</div></div><div class="posttext">http://forums.winamp.com/showpost.php?p=2701179&amp;postcount=4<br />
<br />
I have several sections built using macros, they have index {S1} to {S5}.No, they don't. It's ${S1} to ${S5}. Also these are defines containing 0 to 4 respectively.<br />
<br />
If you want to enumerate sections, enumerate by index number (0...) and ignore those defines.<br />
<br />
Edit: And I'll say this again (and again) you can't do...<br />
<br />
!define SomeDefine1<br />
StrCpy $0 1<br />
!ifdef SomeDefine$0<br />
  !echo ${SomeDefine$0}<br />
!endif<br />
<br />
...which is effectively what you are trying to do. Defines are compile time constants and their values are evaluated on compile. Variables are run time and therefore you cannot use them in constant names. The names of constants do not exist after compile.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mabian</div><div class="date">6th October 2010, 13:01</div></div><div class="posttext">Yeah, it took a while but I think I got the concept now.<br />
<br />
I used ${S1} to get the numeric index of the first section involved and I loop from there on.<br />
<br />
Looks fine now.<br />
<br />
Thanks a lot!<br />
<br />
- Mario</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>