<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" FontRegAdv Problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  FontRegAdv Problem NSIS Discussion" />
	
	<title> FontRegAdv Problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  FontRegAdv Problem</div>
<hr />
<div class="pda"><a href="t-245701.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=245701">FontRegAdv Problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ajfisher</div><div class="date">8th May 2006, 17:23</div></div><div class="posttext">Hi--<br />
<br />
I'm new to NSIS and the forum. I'm having a problem using the FontRegAdv header provided in the wiki for uninstalling fonts. I get the following message:<br />
<br />
Call must be used with function names starting with &quot;un.&quot; in the uninstall section.<br />
Usage: Call function_name | [:label_name]<br />
Error in macro GetFileNameCall on macroline 2<br />
Error in macro RemoveTTF on macroline 11<br />
Error in script &quot;C:\Documents and Settings\me\My Documents\Work\Win\FontsFull.nsi&quot; on line 224 -- aborting creation process<br />
<br />
Here's the beginning of my unistall section:<br />
Section /o un.Main UNSEC0000<br />
    StrCpy $FONT_DIR $FONTS<br />
 <br />
  	!insertmacro RemoveTTF 'TAMBURO_.TTF'; line 224<br />
<br />
Any Suggestions?<br />
<br />
Thanks<br />
<br />
Allen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th May 2006, 20:14</div></div><div class="posttext">Try replacing the part between &quot;### Modified Code from FileFunc.nsh ###&quot; and &quot;### End Code From ###&quot; with:<br />
!ifmacrondef GetFileName<br />
        !macro GetFileName _PATHSTRING _RESULT<br />
                Push `${_PATHSTRING}`<br />
<br />
		Exch $0<br />
		Push $1<br />
		Push $2<br />
<br />
		StrCpy $2 $0 1 -1<br />
		StrCmp $2 '\' 0 +3<br />
		StrCpy $0 $0 -1<br />
		goto -3<br />
<br />
		StrCpy $1 0<br />
		IntOp $1 $1 - 1<br />
		StrCpy $2 $0 1 $1<br />
		StrCmp $2 '' end<br />
		StrCmp $2 '\' 0 -3<br />
		IntOp $1 $1 + 1<br />
		StrCpy $0 $0 '' $1<br />
<br />
		end:<br />
		Pop $2<br />
		Pop $1<br />
		Exch $0<br />
<br />
               	Pop ${_RESULT}<br />
        !macroend<br />
<br />
	!define GetFileName `!insertmacro GetFileName`<br />
!endifLet me know if it works, so I can update the Wiki, or you can update the Wiki yourself.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ajfisher</div><div class="date">8th May 2006, 22:42</div></div><div class="posttext">kichik--<br />
<br />
Thanks for the response. That seems to have broken something in InstallTTF. If I call installTTF more than once in a section, there's another compile error:<br />
<br />
Error: label &quot;end:&quot; already declared in section<br />
Error in macro GetFileName on macroline 20<br />
Error in macro InstallTTF on macroline 10<br />
Error in script &quot;C:\Documents and Settings\me\My Documents\Work\Win\FontsFull.nsi&quot; on line 76 -- aborting creation process<br />
<br />
Line 76 is just another call to InstallTTF.<br />
<br />
thanks for the help so far.<br />
<br />
<br />
--A</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th May 2006, 22:51</div></div><div class="posttext">Then:!ifmacrondef GetFileName<br />
        !macro GetFileName _PATHSTRING _RESULT<br />
                Push `${_PATHSTRING}`<br />
<br />
		Exch $0<br />
		Push $1<br />
		Push $2<br />
<br />
		StrCpy $2 $0 1 -1<br />
		StrCmp $2 '' 0 +3<br />
		StrCpy $0 $0 -1<br />
		goto -3<br />
<br />
		StrCpy $1 0<br />
		IntOp $1 $1 - 1<br />
		StrCpy $2 $0 1 $1<br />
		StrCmp $2 '' +4<br />
		StrCmp $2 '' 0 -3<br />
		IntOp $1 $1 + 1<br />
		StrCpy $0 $0 '' $1<br />
<br />
		Pop $2<br />
		Pop $1<br />
		Exch $0<br />
<br />
               	Pop ${_RESULT}<br />
        !macroend<br />
<br />
	!define GetFileName `!insertmacro GetFileName`<br />
!endif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ajfisher</div><div class="date">8th May 2006, 23:50</div></div><div class="posttext">kichik--<br />
<br />
Thanks again. This brings me back to the original error, but this time with differnt line numbers:<br />
<br />
Call must be used with function names starting with &quot;un.&quot; in the uninstall section.<br />
Usage: Call function_name | [:label_name]<br />
Error in macro FontName on macroline 2<br />
Error in macro RemoveTTF on macroline 64<br />
Error in script &quot;C:\Documents and Settings\afisher.CODA\My Documents\Work\Win\MMFontsFull.nsi&quot; on line 224 -- aborting creation process<br />
<br />
Am I calling RemoveTTF correctly?<br />
<br />
 !insertmacro RemoveTTF 'TAMBURO_.TTF'<br />
<br />
When something says that it's incorrectin &quot;macroline XXX&quot; where would I go to look for that in the header file?<br />
<br />
Thanks,<br />
<br />
Allen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th May 2006, 13:07</div></div><div class="posttext">Well, the functions in FontName.nsh also need an upgrade. They only work for the installer. I suggest you contact Vytautas and ask him to upgrade the functions for compatibility with the uninstaller.<br />
<br />
&quot;macroline XXX&quot; is the XXX-th line of the macro itself. You should look where the macro is defined and count those number of lines from the !macro line.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ajfisher</div><div class="date">9th May 2006, 14:35</div></div><div class="posttext">kichik,<br />
<br />
Thanks for all your help. It's greatly appreciated.  Would you like me to update the wiki? <br />
<br />
Allen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th May 2006, 14:36</div></div><div class="posttext">No, it doesn't work yet in the uninstaller and it'll just make installers larger.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">govmust</div><div class="date">11th September 2007, 12:38</div></div><div class="posttext">So this RemoveTTF doesn't work?<br />
<br />
Would someone update wiki then?<br />
I would guess there arre more people like me who are trying to use it without any luck.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">msroboto</div><div class="date">19th August 2008, 15:32</div></div><div class="posttext">Has there been any resolution on this?<br />
<br />
Error in macro GetFileNameCall on macroline 2<br />
Error in macro RemoveTTF on macroline 11<br />
Error in script &quot;C:\Users\Sue\workspace\ConVAInstaller\fonttest.nsi&quot; on line 39 -- aborting creation process<br />
<br />
I tried a couple of tests including the one from the wiki and this is what I get on the un.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nortle73</div><div class="date">28th July 2010, 16:46</div></div><div class="posttext">I know this is an old thread but has anyone successfully managed to get the RemoveTTFfont command to work succesfully?<br />
<br />
I have been struggling for days now before having a look on the forum and finding people are having similar problems.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>