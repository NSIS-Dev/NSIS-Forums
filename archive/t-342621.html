<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" WriteRegStr ignored in script, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  WriteRegStr ignored in script NSIS Discussion" />
	
	<title> WriteRegStr ignored in script [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  WriteRegStr ignored in script</div>
<hr />
<div class="pda"><a href="t-342621.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=342621">WriteRegStr ignored in script</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jbillen</div><div class="date">25th February 2012, 06:54</div></div><div class="posttext">I have several sections similar to below. The command WriteReg used to work (as I see using Regedit), but the script, which compiles successfully, now seems to ignore these lines. Is there something that would prevent writing to the Registry.  I'm logged in as an administrator and can edit the Registry using .reg files or Regedit.<br />
<br />
<br />
Section &quot;&quot;<br />
   WriteRegStr  HKCR &quot;QKPfile&quot;                        &quot;&quot;  &quot;Quikplot input&quot;<br />
   WriteRegStr  HKCR &quot;QKPfile\Shell&quot;                  &quot;&quot;  &quot;&quot;<br />
   WriteRegStr  HKCR &quot;QKPfile\Shell\Print&quot;            &quot;&quot;  &quot;&quot;<br />
   WriteRegStr  HKCR &quot;QKPfile\Shell\Print\command&quot;    &quot;&quot; 'Notepad.exe /p &quot;%1&quot;'<br />
   WriteRegStr  HKCR &quot;QKPfile\Shell\Open&quot;             &quot;&quot;  &quot;&quot;<br />
   WriteRegStr  HKCR &quot;QKPfile\Shell\Open\command&quot;     &quot;&quot; '$INSTDIR\Quikplot.exe &quot;%1&quot;'<br />
   WriteRegStr  HKCR &quot;QKPfile\Shell\Edit&quot;             &quot;&quot;  &quot;&quot;<br />
   WriteRegStr  HKCR &quot;QKPfile\Shell\Edit\command&quot;     &quot;&quot; 'Notepad.exe &quot;%1&quot;'<br />
   WriteRegStr  HKCR &quot;.QKP&quot;   &quot;AlwaysShowExt&quot;             &quot;&quot;<br />
   WriteRegStr  HKCR &quot;.QKP&quot;                           &quot;&quot;  &quot;QKPfile&quot;<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">25th February 2012, 08:46</div></div><div class="posttext">Why would it ignore the lines? <br />
<br />
Is this 64 bit windows? Either way, fire up Process Monitor and try to figure out the problem...<br />
<br />
...also<br />
* The verbs should not have empty strings, set a string or don't write anything at all<br />
* '$INSTDIR\Quikplot.exe &quot;%1&quot;' should be '&quot;$INSTDIR\Quikplot.exe&quot; &quot;%1&quot;'<br />
* Why are you setting AlwaysShowExt? Respect the users settings please...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jbillen</div><div class="date">25th February 2012, 18:55</div></div><div class="posttext">Is s 64-bit Windows, but I don't think that should be a problem because it did work at one time. I'll take your advice about the AlwaysShowExt. Thanks for tip on Process Manager. I don't understand your first bullet.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jbillen</div><div class="date">25th February 2012, 20:45</div></div><div class="posttext">I downloaded Process Monitor (not Manager as mentioned earlier) from CNET and ran the installer made from the script. Some of the WriteRegStr commands result is &quot;SUCCESS&quot;, but RegCreateKey commands say &quot;ACCESS DENIED	Desired Access: Set Value&quot;.  The RegQueryKey commands result in &quot;SUCCESS.&quot; <br />
<br />
There are some other Registry command evidently generated by the installer that say, for example &quot;RegOpenKey	HKCU\Software\Classes\QKPfile\Shell\Open	NAME NOT FOUND	Desired Access: Maximum Allowed&quot;.  I am not sure if this is important.<br />
<br />
Why when logged in as an administrator should I see ACCESS DENIED?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">25th February 2012, 21:45</div></div><div class="posttext">Do you have &quot;RequestExecutionLevel admin&quot; in your script?<br />
RegCreateKey should not fail. Try deleting the key in regedit...<br />
<br />
Don't do WriteRegStr HKCR &quot;QKPfile\Shell\Open&quot; &quot;&quot; &quot;&quot; etc</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jbillen</div><div class="date">25th February 2012, 23:28</div></div><div class="posttext">That's how I was testing the script: first delete the key in regedit. The &quot;RequestExecutionLevel admin&quot; statement solved the problem. Thanks a lot for the help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">26th February 2012, 07:50</div></div><div class="posttext">Well then you did not run as admin before (Maybe you need to read about UAC on MSDN)<br />
<br />
You should use http://pastebin.com/EvMkyLLt to make sure.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jbillen</div><div class="date">26th February 2012, 19:19</div></div><div class="posttext">I saw the script in the link you supplied and I read about UAC is Wikipedia. I see why the statement &quot;RequestExecutionLevel admin&quot; is needed.<br />
<br />
I started using NSIS just recently after using InstallShield for a long time, so I probably have quite a few things to learn. For one, I do not see how to access this message from the forums/winamp.com homepage without searching for something in the post. I was only able to start the original post by clicking on a link in one of kichik's replys. I would appreciate it if you could point me in right direction.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">26th February 2012, 19:35</div></div><div class="posttext">http://forums.winamp.com/ scroll down to &quot;Developer Center&quot; and click &quot;NSIS Discussion&quot; but I just type &quot;nsis forum&quot; in the addressbar and firefox+google does the rest...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jbillen</div><div class="date">26th February 2012, 19:55</div></div><div class="posttext">Thanks. That will keep me from stumbling around...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>