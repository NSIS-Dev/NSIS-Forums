<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Need help about some easy subjects, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Need help about some easy subjects NSIS Discussion" />
	
	<title> Need help about some easy subjects [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Need help about some easy subjects</div>
<hr />
<div class="pda"><a href="t-232073.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=232073">Need help about some easy subjects</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Xi0Ns</div><div class="date">27th November 2005, 23:37</div></div><div class="posttext">First: thanks for all the people that makes this real:<br />
<br />
I want to ask some things:<br />
<br />
1: How do i do to set a custom folder in a shortcut's &quot;Start in&quot; field when i create such shortcut?<br />
<br />
2: In the components page, i want to display &quot;Create shortcuts&quot; and enable to expand this and show under the same component, 2 child components &quot;Start menu&quot; and &quot;Desktop&quot;?? (that stuff with the &quot;+&quot; symbol beside the component).<br />
<br />
Thanks for your help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th November 2005, 13:50</div></div><div class="posttext">1. Use SetOutPath first.<br />
2. ...<br />
<br />
SectionGroup &quot;Create shortcuts&quot; secGroupCSC<br />
<br />
Section &quot;Desktop&quot; secSCDesktop<br />
 SetOutPath $INSTDIR<br />
 CreateShortCut &quot;$DESKTOP\My App.lnk&quot; &quot;$INSTDIR\MyApp.exe&quot;<br />
SectionEnd<br />
<br />
Section &quot;Start menu&quot; secSCStartMenu<br />
 SetOutPath $INSTDIR<br />
 CreateDirectory &quot;$SMPROGRAMS\My App&quot;<br />
 CreateShortCut &quot;$SMPROGRAMS\My App\My App.lnk&quot; &quot;$INSTDIR\MyApp.exe&quot;<br />
SectionEnd<br />
<br />
SectionGroupEnd<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Xi0Ns</div><div class="date">28th November 2005, 14:11</div></div><div class="posttext">Thanks, u are the best, but i need two last things.<br />
<br />
1) Is there any way to do this?: When i launch the setup.exe i want it to check if the app is already installed, if that is the situation, launch the uninstall program before performing the installation (Very useful for the new releases)<br />
<br />
2) When launching the uninstall, check if the app is running, and if so happens, close it before performing the uninstall..<br />
<br />
<br />
I hope i can explain myself clearly.. as u probably deduced, i am not english talking ;)<br />
<br />
Thanks a lot mate</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">28th November 2005, 16:22</div></div><div class="posttext">1. Yes.<br />
read the uninstaller location from the registry (ReadRegStr)<br />
- if the read string is empty, your app probably isn't installed (short of the user mucking with the registry)<br />
- if the read string isn't empty, your app probably -is- installed.<br />
-- check whether the uninstaller file exists (IfFileExists)<br />
--- if it doesn't exist, the user moved or deleted the files after installation, can't do much about that :)<br />
--- if it does exist, throw up a messagebox stating that you'll be running the uninstaller first<br />
---- run the uninstaller<br />
<br />
2. http://nsis.sourceforge.net/Detect_if_a_window_is_open_and_close_it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">28th November 2005, 16:24</div></div><div class="posttext">Oh, step 1 is detailed here as well:<br />
http://nsis.sourceforge.net/Auto-uninstall_old_before_installing_new<br />
<br />
Though it lacks the check whether the uninstaller file exists (it tries to run it, regardless, and if an error occurred (such as the file not existing), it skips.  Cleaner to check whether the file exists first :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Xi0Ns</div><div class="date">28th November 2005, 16:32</div></div><div class="posttext">Thanks!!! is a really good idea.. i will try to do it..<br />
<br />
thanks a lot.. but i still need to know how to close the running app...<br />
<br />
Thanks, again to all of u ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Xi0Ns</div><div class="date">28th November 2005, 18:39</div></div><div class="posttext">http://nsis.sourceforge.net/Detect_...n_and_close_it<br />
<br />
<br />
<br />
Sorry, i didnt see b4... thanks</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>