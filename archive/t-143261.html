<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Shortcut Icon, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Shortcut Icon NSIS Discussion" />
	
	<title> Shortcut Icon [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Shortcut Icon</div>
<hr />
<div class="pda"><a href="t-143261.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=143261">Shortcut Icon</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jcagle</div><div class="date">23rd July 2003, 03:01</div></div><div class="posttext">I have created a VB application that uses a &quot;home-made&quot; icon for the .exe icon. Do I need to copy this icon to the destination hard drive in order to use it for shortcut icons??? I tried simply pointing to the application itself, but that didn't seem to work. So, I guess my full question is:<br />
<br />
Is there a way to pull the icon from the .exe or, do I need to copy the icon to the hard drive and use that in the path for my shortcut icon?<br />
<br />
Thanks in advance!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dajvid</div><div class="date">23rd July 2003, 04:48</div></div><div class="posttext">Although I haven't touched VB for a little while, if I recall correctly, you should be able to specify the icon for the application in VB before you compile it.<br />
<br />
Is that what you were after? (I found it a little hard to understand what exactly you were asking) Otherwise, you can specify the icon file and index when you create a shortcut in NSIS (it's just in the Users Manual).<br />
<br />
Ta,<br />
Dave.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jcagle</div><div class="date">23rd July 2003, 13:40</div></div><div class="posttext">I'll try to be clearer:<br />
<br />
I have a VB application where I've assigned it an icon during compile time...and this works fine. When I install this .exe and make a desktop shortcut to this .exe on the destination machine, the shortcut does NOT display the icon. I attempted to set the icon parameter of the &quot;CreateShortcut&quot; method in NSIS to the .exe...hoping that the shortcut would pick-up the icon from that .exe...but, it doesn't appear to work. So, I've ended up copying the actual .ico onto the destination machine and setting the CreateShortcut icon parameter to this .ico...which works.<br />
<br />
My question is:<br />
Is there a way to get the CreateShortcut icon parameter to pull the icon from the .exe? I would rather not copy my .ico onto the destination machine...if possible.<br />
<br />
Thanks again, and sorry for the confusion my first posting may have caused!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">23rd July 2003, 13:58</div></div><div class="posttext">This code should work:CreateShortCut &quot;$SMPROGRAMS\Example\Example.lnk&quot; &quot;$INSTDIR\vbprog.exe&quot; &quot;&quot; &quot;$INSTDIR\vbprog.exe&quot; 0 <br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jcagle</div><div class="date">23rd July 2003, 14:21</div></div><div class="posttext">That's exactly what I tried, Vytautas, but it doesn't seem to work. I'll try it again when I get to my home PC...but, I'm expecting it not to work. Any other suggestions?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">23rd July 2003, 14:24</div></div><div class="posttext">Make sure that you include the empty quotes &quot;&quot;.  Also does the shortcut display any icon and if so what does it look like, attach a screenshot if possible.<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jcagle</div><div class="date">23rd July 2003, 15:21</div></div><div class="posttext">The icon that gets displayed is the default .exe windows icon...you know, the white box with a blue bar across the top. I'm away from my home PC right now or else I'd post a screen shot. You can see the icon I'm talking about by simply creating hello.txt and renaming it to hello.exe in a folder within windows.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ramon18</div><div class="date">28th July 2003, 12:36</div></div><div class="posttext">You can analyse the problem using the Explorer's <br />
properties TAB -&gt; ChangeIcon, then you can see how many icons your exe have and which index is the correct,<br />
<br />
good luck,<br />
Ramon</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jcagle</div><div class="date">28th July 2003, 13:04</div></div><div class="posttext">Thanks, that's a good idea, ramon18!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>