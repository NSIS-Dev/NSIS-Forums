<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Unminimize solution?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Unminimize solution? NSIS Discussion" />
	
	<title> Unminimize solution? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Unminimize solution?</div>
<hr />
<div class="pda"><a href="t-240450.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=240450">Unminimize solution?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Jamyn</div><div class="date">10th March 2006, 16:30</div></div><div class="posttext">Hi all,<br />
<br />
I noticed that this (http://nsis.sourceforge.net/Allow_only_one_installer_instance#The_advanced_way) wiki page, which talks about setting a mutex and only allowing one copy of the installer to run, has been updated.<br />
<br />
Someone updated the page with an advanced example that will check for the installer, and if someone tries to launch two copies  - it will set the first one as the active window instead.<br />
<br />
Now I know this is a tiny thing, but if the user has (for some reason) minimized the first installer window, the example will indeed set the first one as the active window.  But, it will not &quot;pop&quot; it back up from being minimized.  At least this is the case when testing on Windows XP.<br />
<br />
Do any of you smart people know the proper way to add the functionality to this example?  I thought it would be a useful addition to the advanced example, but don't want to modify it in an unportable way.<br />
<br />
*wishes he knew a lot more... ok anything.. about windows api stuff* ;)<br />
<br />
Thanks,<br />
<br />
-J</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th March 2006, 16:42</div></div><div class="posttext">You can try adding a call to ShowWindow:!include WinMessages.nsh<br />
ShowWindow $1 ${SW_SHOW}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jamyn</div><div class="date">10th March 2006, 16:44</div></div><div class="posttext">Thanks Kichik -- I drink from your fountain of knowledge regularly ;)  Much appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jamyn</div><div class="date">10th March 2006, 17:03</div></div><div class="posttext">I will say up front - I'm very much grasping at thin air here, and &quot;guessing&quot; on the format of the extra line:<br />
<br />
Is this a proper way to add this functionality in a portable way? (ie: not requiring the WinMessages include)? It does seem to work when I test it, but that does't mean it's the &quot;right&quot; way, that it won't blow up, etc. <br />
<br />
<br />
System::Call &quot;kernel32::CreateMutexA(i 0, i 0, t '$(^Name)') i .r0 ?e&quot;<br />
        Pop $0<br />
        StrCmp $0 0 launch<br />
            StrLen $0 &quot;$(^Name)&quot;<br />
            IntOp $0 $0 + 1<br />
        loop:<br />
            FindWindow $1 '#32770' '' 0 $1<br />
            IntCmp $1 0 +4<br />
            System::Call &quot;user32::GetWindowText(i r1, t .r2, i r0) i.&quot;<br />
            StrCmp $2 &quot;$(^Name)&quot; 0 loop<br />
            System::Call &quot;user32::SetForegroundWindow(i r1) i.&quot;<br />
            System::Call &quot;user32::ShowWindow(i r1) i.&quot;<br />
            ; ShowWindow $1 ${SW_SHOW}<br />
            Abort<br />
        launch:<br />
 FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th March 2006, 17:11</div></div><div class="posttext">WinMessages.nsh is included in the NSIS package, it's portable enough. There's no need to use the System plug-in when you've got ShowWindow as a built-in instruction. You can use the code I've put above as-is.<br />
<br />
Your current code is missing an argument for ShowWindow. You passed only the window handle and forgot the requested show command.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jamyn</div><div class="date">11th March 2006, 05:13</div></div><div class="posttext">Sorry to mis-state what I meant.  I have the flu, and have been quite medicated for the last few days.  I find it hard to articulate correctly (not that I do much better of a job when I'm not sick, but...<br />
<br />
I of course am not implying you write non-portable code :)  What I mean to say is, I wanted to apply that one extra piece of the puzzle, to the current wiki entry.  So I wanted to add the line using the same &quot;style&quot; as the wiki entry author - the author used the System:: method.<br />
<br />
Perhaps I will just add another example, using the WinMessages style of doing things instead of using the System:: calls.  Thanks again for your feedback to my question.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>