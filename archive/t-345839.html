<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Refreshing Enviroment Variables, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Refreshing Enviroment Variables NSIS Discussion" />
	
	<title> Refreshing Enviroment Variables [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Refreshing Enviroment Variables</div>
<hr />
<div class="pda"><a href="t-345839.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=345839">Refreshing Enviroment Variables</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mista-birdy</div><div class="date">27th June 2012, 15:42</div></div><div class="posttext">Hi all,<br />
I'm started to work with NSIS. It's a great installer.<br />
But I need a little help.<br />
<br />
After installing SQL Server, the command sqlcmd should be available for calling from commandprompt. Because SQL Server add the Commandtool Path to Enviroment Vars.<br />
<br />
But it i can't just call sqlcmd. I have to call the full path. <br />
I think it's because NSIS have the old enviroments vars in cache.<br />
<br />
How can I refresh this cache so that i can just call <br />
ExecWait 'SQLCMD ...' ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">27th June 2012, 17:44</div></div><div class="posttext">nsis works &quot;life&quot; and dont cache anything - its on your system.<br />
<br />
either you use the PATH-Variable for those commands (dos command) or AppPath in registry.<br />
http://msdn.microsoft.com/en-us/library/windows/desktop/ee872121%28v=vs.85%29.aspx<br />
<br />
HTH</div></div><hr />


<div class="post"><div class="posttop"><div class="username">msroboto</div><div class="date">27th June 2012, 21:29</div></div><div class="posttext">Right but let's say you change the PATH even manually no current running program, Command Prompt or NSIS installer will pick that up automatically without being restarted.<br />
<br />
You can test that by opening a command prompt then changing your PATH.<br />
The PATH is not reflected in that command prompt but if you open a new command prompt the new PATH or other environment variable will be available.<br />
<br />
So the short answer is short of restarting the installer or starting a new installer you won't have access to the new PATH or other ENV variables.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th June 2012, 00:12</div></div><div class="posttext">Indeed environment variables are copied for each process on launch and therefore is up to that process to update its own environment variables if required. To do this you can use SetEnvironmentVariable in Kernel32.dll:<br />
http://nsis.sourceforge.net/Setting_Environment_Variables_to_Active_Installer_Process<br />
<br />
(Note that page uses SetEnvironmentVariableA - it should just be SetEnvironmentVariable - System plug-in calls SetEnvironmentVariableA or SetEnvironmentVariableW accordingly).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">28th June 2012, 00:13</div></div><div class="posttext">no current running program, Command Prompt or NSIS installer will pick that up automatically without being restarted.<br />
<br />
Explorer picks up the new path...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>