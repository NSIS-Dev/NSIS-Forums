<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" SetOverwrite not working (urgent!), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  SetOverwrite not working (urgent!) NSIS Discussion" />
	
	<title> SetOverwrite not working (urgent!) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  SetOverwrite not working (urgent!)</div>
<hr />
<div class="pda"><a href="t-273841.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=273841">SetOverwrite not working (urgent!)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">theblazingangel</div><div class="date">4th July 2007, 05:57</div></div><div class="posttext">i've got a problem with SetOverwrite. i need to control SetOverwrite with a command line parameter, this means wrapping a SetOverwrite command in an ${If} check, but it's not working... it's as if the ${If} check doesn't exist, i've also tried StrCpm and that doesn't have any effect either!<br />
<br />
in the below example it should always overwrite an existing file, unless the switch is set in which case it should only do it if it has a newer copy. however what actually happens is that it always does the if-newer check...<br />
<br />
example code that doesn't work:<br />
<br />
!include 'MUI.nsh'<br />
!include 'LogicLib.nsh'<br />
<br />
Name 'test'<br />
InstallDir &quot;C:\test\&quot;<br />
OutFile &quot;test.exe&quot;<br />
<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!insertmacro MUI_PAGE_INSTFILES<br />
<br />
!insertmacro MUI_LANGUAGE 'English'<br />
<br />
Var /GLOBAL switch_test<br />
<br />
Section 'Installation'<br />
<br />
	SetOutPath $INSTDIR<br />
<br />
	StrCpy $switch_test '0'<br />
<br />
	${If} $switch_test == '1'<br />
	    SetOverwrite ifnewer<br />
	${EndIf}<br />
<br />
	File test.txt<br />
<br />
SectionEnd<br />
<br />
<br />
what am i doing wrong?<br />
<br />
i'd appreciate a speedy response if possible, i'm already late delivering the software i'm packing due to other delays.<br />
thank you :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">theblazingangel</div><div class="date">4th July 2007, 06:34</div></div><div class="posttext">damn it, found the answer here: http://forums.winamp.com/showthread.php?postid=2183260<br />
<br />
i've also now found the note in the 'compiler command' section of the docs. perhaps it could be made clearer, perhaps even just a note could be added that ${If} and StrCmp have no effect, because i think it's pretty important that we know that!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th July 2007, 18:52</div></div><div class="posttext">Compiler flags now states:The following commands affect how the compiler generates code and compresses data. Unless otherwise noted, these commands are valid anywhere in the script, and effect every line below where each one is placed (until overridden by another command). They cannot be jumped over using flow control insutrctions.<br />
<br />
For example, in the following script, blah.dat will never be overwritten.${If} $0 == 0<br />
  SetOverwrite on<br />
${Else}<br />
  SetOverwrite off<br />
${EndIf}<br />
File blah.dat # overwrite is always off here!Instead, the following should be used.${If} $0 == 0<br />
  SetOverwrite on<br />
  File blah.dat<br />
${Else}<br />
  SetOverwrite off<br />
  File blah.dat<br />
${EndIf}What do you think?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">theblazingangel</div><div class="date">4th July 2007, 19:22</div></div><div class="posttext">that looks great, thanks :)<br />
<br />
the only gripe i now have is that when compiling a release using the /nonfatal switch on the file command, warnings for missing items are now listed twice, and it seems to process all of the files to include twice.<br />
i wish it didn't do that...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th July 2007, 19:25</div></div><div class="posttext">Well, those are different errors. You might even have a !system command in between those two that generates the file so the second File might not fail.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>