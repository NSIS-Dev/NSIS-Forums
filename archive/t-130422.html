<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Why doesn't this 12-line script exit?! :P, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Why doesn't this 12-line script exit?! :P NSIS Discussion" />
	
	<title> Why doesn't this 12-line script exit?! :P [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Why doesn't this 12-line script exit?! :P</div>
<hr />
<div class="pda"><a href="t-130422.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=130422">Why doesn't this 12-line script exit?! :P</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">psyke</div><div class="date">31st March 2003, 19:43</div></div><div class="posttext">Hello,<br />
<br />
I don't understand why this script won't cause the installer to exit... 'Abort' has been used, and so has 'AutoCloseWindow true'.<br />
<br />
Name &quot;Abort from Section&quot;<br />
OutFile &quot;Abort.exe&quot;<br />
ShowInstDetails nevershow<br />
AutoCloseWindow true<br />
Page instfiles<br />
<br />
Section &quot;blah&quot;<br />
MessageBox MB_OK &quot;Section blah&quot;<br />
Abort &quot;shouldn't this quit?&quot;<br />
SectionEnd<br />
<br />
Function .onInstSuccess<br />
MessageBox MB_OK &quot;exiting&quot;<br />
FunctionEnd<br />
<br />
Looking forward to the answer to this mystery. ;) (Using latest dev snapshot.)<br />
<br />
Salaam/Peace.<br />
<br />
(P.S. I know about the 'Quit' command, I want to know why the above script doesn't create an installer that automatically closes - thanks.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">31st March 2003, 19:51</div></div><div class="posttext">maybe this:<br />
<br />
Name &quot;Abort from Section&quot;<br />
OutFile &quot;Abort.exe&quot;<br />
ShowInstDetails nevershow<br />
AutoCloseWindow true<br />
Page instfiles<br />
<br />
Section &quot;blah&quot;<br />
MessageBox MB_OK &quot;Section blah&quot;<br />
Abort <br />
SectionEnd<br />
<br />
Function .onInstSuccess<br />
MessageBox MB_OK &quot;exiting&quot;<br />
Abort<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psyke</div><div class="date">31st March 2003, 19:56</div></div><div class="posttext">Thanks Dark Boy, but that doesn't work. (Did it it work in your version of NSIS?)<br />
<br />
The Abort command is allowed to take a parameter. From the docs:<br />
<br />
Abort user_message<br />
Cancels the install, stops execution of script, and displays<br />
user_message in the status display.<br />
Note: you can use this from Callback functions to do special things.<br />
Page callbacks also uses Abort for special purposes. <br />
<br />
And after calling Abort from the Section, .onInstSuccess never gets called anyway... so the Abort you added to .onInstSuccess never runs. <br />
<br />
thanks for trying to help though, i appreciate it. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">31st March 2003, 20:36</div></div><div class="posttext">Read the info you just posted, it aborts the install.<br />
<br />
Use Quit to exit immidiately.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psyke</div><div class="date">31st March 2003, 20:42</div></div><div class="posttext">oh, right. :P<br />
<br />
i misinterpretedstops execution of script as, stops execution period.<br />
<br />
thanks for pointing that out Joost.<br />
<br />
(And thanks for your work on Modern UI &amp; other stuff. :) )<br />
<br />
Salaam/Peace.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">icebrrrg</div><div class="date">4th November 2003, 20:23</div></div><div class="posttext">so ... if i get 50% through my install, and then i do an abort (well, it seems like i should do a quit?) ... do i have to manually roll back any changes made up to that point?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">4th November 2003, 20:54</div></div><div class="posttext">But it is recommended. A great suggestion for rollback occasions:<br />
<br />
You can put a &quot;IntOp&quot; command for each &quot;File&quot; command and each command that you know, will affect the user's system, like registry entries. And when the installator fails or a command abort is executed, it uses the callback function .onInstFailed. Inside this function, put i.e.:<br />
<br />
<br />
#Total number of files 21:<br />
<br />
IntCmp $0 20 0 0 +2<br />
  Delete &quot;blablabla.txt&quot;<br />
<br />
IntCmp $0 19 0 0 +2<br />
  Delete &quot;blablabla.exe&quot;<br />
<br />
IntCmp $0 18 0 0 +2<br />
  DeleteRegValue HKLM &quot;Software\Your Program&quot; &quot;Install Dir&quot;<br />
<br />
<br />
$0 is the variable you put the amount of commands to reverse.<br />
20, 19 and 18 numbers - if have a problem with the file #20 and abort, will do the reverse operations of the installation commands #20 to #1.<br />
<br />
So will be a &quot;LIKE&quot; the real installation rollback.<br />
<br />
:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">icebrrrg</div><div class="date">4th November 2003, 21:26</div></div><div class="posttext">That is indeed a great suggestion. :) Thanks.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>