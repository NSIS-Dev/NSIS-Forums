<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Weird font question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Weird font question NSIS Discussion" />
	
	<title> Weird font question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Weird font question</div>
<hr />
<div class="pda"><a href="t-82514.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=82514">Weird font question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">27th March 2002, 01:13</div></div><div class="posttext">Is there a way to use NSIS to code the following?:<br />
<br />
1. Open the Fonts folder<br />
2. Open the Arial.ttf font (or any other font)<br />
3. Click on Done<br />
<br />
For some reason I still haven't figured out, very few users of our software have a problem printing. The problem is that the text printed is a little larger and/or more spaced out than what it was intended (Looks like it is the bold text which prints slightly oversized). This causes some text to overwrite other text. What I found out is that if you perform the steps listed above, somehow it fixes the problem. Could this be a registry problem I can &quot;fix&quot; with NSIS? The application is written in Visual Fox Pro. <br />
<br />
-Carlos</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pomflain</div><div class="date">27th March 2002, 01:36</div></div><div class="posttext">Is this an installer problem,  or an application problem?  I've run into a similar problem in Win32 programs before,  depends on if the person is using Small Fonts or Large Fonts in their display settings.  The &quot;solution&quot; was to make things larger on the build system,  or to build on a 9x kernel system.  Not sure if that's what you mean,  but that sounds like the same kind of problem I was having there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">27th March 2002, 03:16</div></div><div class="posttext">Originally posted by Pomflain <br />
Is this an installer problem,  or an application problem?... <br />
I don't know if this is an installer or an application problem. The application is built on a 9x system. The problem can occur in any version of Win32. Somehow clicking on a font and then on &quot;Done&quot; fixes it. I am curious to know what exactly happens when you click on Done.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pomflain</div><div class="date">27th March 2002, 06:53</div></div><div class="posttext">Originally posted by cchian <br />
<br />
I don't know if this is an installer or an application problem. The application is built on a 9x system. The problem can occur in any version of Win32. Somehow clicking on a font and then on &quot;Done&quot; fixes it. I am curious to know what exactly happens when you click on Done. <br />
<br />
No I meant in the installer itself,  or in your application.  I'm going on the presumption you mean in your application.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">27th March 2002, 19:29</div></div><div class="posttext">Originally posted by Pomflain <br />
<br />
<br />
No I meant in the installer itself,  or in your application.  I'm going on the presumption you mean in your application. <br />
Hi Pomflain, I am not sure what you meant. Can you refrase it for me again?<br />
<br />
Thanks, :)<br />
<br />
Carlos</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">30th March 2002, 06:10</div></div><div class="posttext">Pomflain,<br />
<br />
Maybe the post by KiCHiK titled Fonts will do the trick. See this tread:<br />
http://forums.winamp.com/showthread.php?threadid=79586&amp;referrerid=24442</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pomflain</div><div class="date">30th March 2002, 06:32</div></div><div class="posttext">Originally posted by cchian <br />
<br />
Hi Pomflain, I am not sure what you meant. Can you refrase it for me again?<br />
<br />
Thanks, :)<br />
<br />
Carlos <br />
<br />
Ok, you said you were having a problem with the printing wherein the text was too large for some users.  If those particular users happen to be using the large fonts setting in Control Panel/Display,  that could be what the cause of your problem is.  I figure you mean in your application since I don't see much reason to be printing something from the installer.<br />
<br />
Thanks for pointing out the other thread,  but I don't have any problems like that.  I have run into problems with the large/small font issue before and I've seen others have problems,  so that's why I mentioned it.  It's not something that is particularly obvious.<br />
<br />
Hope that was a bit clearer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pomflain</div><div class="date">30th March 2002, 06:41</div></div><div class="posttext">Originally posted by cchian <br />
<br />
Hi Pomflain, I am not sure what you meant. Can you refrase it for me again?<br />
<br />
Thanks, :)<br />
<br />
Carlos <br />
<br />
Ok, you said you were having a problem with the printing wherein the text was too large for some users.  If those particular users happen to be using the large fonts setting in Control Panel/Display,  that could be what the cause of your problem is.  I figure you mean in your application since I don't see much reason to be printing something from the installer.<br />
<br />
Thanks for pointing out the other thread,  but I don't have any problems like that.  I have run into problems with the large/small font issue before and I've seen others have problems,  so that's why I mentioned it.  It's not something that is particularly obvious.<br />
<br />
Hope that was a bit clearer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">30th March 2002, 16:21</div></div><div class="posttext">Originally posted by Pomflain <br />
<br />
Ok, you said you were having a problem with the printing wherein the text was too large for some users.  If those particular users happen to be using the large fonts setting in Control Panel/Display,  that could be what the cause of your problem is.  I figure you mean in your application since I don't see much reason to be printing something from the installer.<br />
<br />
Yes, the problem is printing from the application.  I am still curious to find out why clicking on the (for example) Arial font and then on Done fixes the printing problem.  Fortunately, it is an easy fix, but would be great if our developers could somehow do it behind the scenes (like during installation) so users don't have to contact us with the problem on the first place.  I feel users shouldn't have to encounter this issue in the first place.  In other words, the problem is in our end and not the users.<br />
As a side note, I encountered this same printing problem with a new Windows XP system that has not had its display settings changed from the default.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">plaztic</div><div class="date">9th April 2002, 15:34</div></div><div class="posttext">There's an application called AutoIt. It's a quite powerful scripting tool. You could automate the whole font session with this.<br />
<br />
I sometimes use it together with NSIS to automate installations, rather install silently.<br />
<br />
Oh, forgot to add the address: http://www.hiddensoft.com/autoit/<br />
<br />
\plaz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th April 2002, 21:00</div></div><div class="posttext">Hi Carlos!<br />
<br />
I believe this NSIS code should do the same trick:<br />
<br />
!include &quot;C:\\Program Files\\NSIS\\WinMessages.nsh&quot;<br />
<br />
ExecShell open &quot;$WINDIR\\Fonts\\arial.ttf&quot; SW_SHOWMINIMIZED<br />
loop:<br />
	Sleep 100<br />
	FindWindow $0 &quot;FontViewWClass&quot;<br />
	IntCmp $0 0 loop<br />
		SendMessage $0 ${WM_CLOSE} 0 0<br />
		Goto done<br />
done:<br />
<br />
KiCHiK<br />
<br />
(edit): It is recommended you take the font diretory from the registry (HKCU\Software\Microsoft\CurrentVersion\Explorer\Shell Folders\Fonts).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">10th April 2002, 05:25</div></div><div class="posttext">Thanks for the tips!<br />
<br />
Lately I have been trying to figure out why the simple action of opening the control_panel\fonts\arial.ttf font fixes the problem. I have done a comparison of the registry and have almost concluded that the problem is that the required fonts (arial narrow and variants) are being copied to the fonts directory, but are not being registered with Windows.<br />
It think I will modify and use Kichik's code to do the trick, I just need to figure out exactly what code I need to write to register the fonts or do the equivalent of just opening and closing the fonts folder silently.<br />
<br />
Carlos</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th April 2002, 14:16</div></div><div class="posttext">If you want to reregister the font (although Windows does it on its self when it boot) you can use the DLL I have written and uploaded in the post you yourself referenced to.<br />
<br />
http://forums.winamp.com/showthread.php?threadid=79586&amp;referrerid=24442<br />
<br />
KiCHiK</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>