<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" InetLoad Broken, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  InetLoad Broken NSIS Discussion" />
	
	<title> InetLoad Broken [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  InetLoad Broken</div>
<hr />
<div class="pda"><a href="t-258865.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258865">InetLoad Broken</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">4th November 2006, 01:49</div></div><div class="posttext">I'm having a problem with InetLoad.<br />
<br />
And I'll accept help from Afrow to saivert. I am thinking intetload is busted when requesting https.<br />
<br />
When it is inside my main program, it totally fails to write an outfile. When implemented here, it writes the outfile, but crashes, not getting to the messagebox afterwards. And before you ask, I've done it with /SILENT and I've done it with /END and I've done it with /RESUME and every combination thereof. <br />
<br />
;=== Runtime Switches<br />
CRCCheck On<br />
WindowIcon Off<br />
SilentInstall Silent<br />
AutoCloseWindow True<br />
SetCompressor /SOLID LZMA<br />
<br />
Var AUTHURL<br />
Var AUTHSTRING<br />
<br />
Section &quot;Main&quot;<br />
<br />
;md5dll::GetMD5File &quot;$EXEDIR\Data\torrify\torrify.key&quot;<br />
md5dll::GetMD5File &quot;torrify.key&quot;<br />
Pop $0<br />
StrCpy $AUTHURL &quot;https://www.metropipe.net/torrify/check.php?md5=&quot;<br />
StrCpy $AUTHSTRING `&quot;$AUTHURL$0&quot;`<br />
MessageBox MB_OK &quot;$AUTHSTRING&quot;<br />
InetLoad::load &quot;$AUTHSTRING&quot; &quot;$EXEDIR\outfile&quot; <br />
MessageBox MB_OK &quot;Check for outfile&quot;	<br />
<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">4th November 2006, 09:58</div></div><div class="posttext">I received single-byte file both using InetLoad and Inetc (http://nsis.sourceforge.net/Inetc_plug-in) (&quot;0&quot;).<br />
;InetLoad::load &quot;$AUTHSTRING&quot; &quot;$EXEDIR\outfile&quot; <br />
Inetc::get &quot;$AUTHSTRING&quot; &quot;$EXEDIR\outfile&quot; /end<br />
Pop $0<br />
MessageBox MB_OK &quot;Result $0, Check for outfile&quot; <br />
<br />
The problem is that both plug-ins work correct on all my comps and I cannot reproduce your problem, but independant testers reported that Inetc was stable in all modes. Below are http headers from inetc:<br />
HTTP/1.1 200 OK<br />
Date: Sat, 04 Nov 2006 12:02:36 GMT<br />
Server: Apache/1.3.26 (Unix) Debian GNU/Linux mod_ssl/2.8.9 OpenSSL/0.9.6g PHP/4.3.6<br />
X-Powered-By: PHP/4.3.6<br />
Keep-Alive: timeout=15, max=100<br />
Connection: Keep-Alive<br />
Content-Type: text/html; charset=iso-8859-1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">4th November 2006, 11:45</div></div><div class="posttext">Also: in the silent mode you can use /popup option - InetLoad in all tests was stable both in /popup or /banner modes.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">4th November 2006, 13:45</div></div><div class="posttext">Hmmm. Strange indeed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">4th November 2006, 14:54</div></div><div class="posttext">I added InetLoad internal switch to /popup for silent mode - no difference for user if installer and plug-in windowa are hidden. The same was done for Inetc earlier (it could not add NSISdl style child control to installer window if parent not exists).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">4th November 2006, 15:18</div></div><div class="posttext">Okay. Now I am sure the problem is with InetLoad.<br />
<br />
It is not correctly understanding strings. If you directly substitute the value of $AUTHSTRING instead of using $AUTHSTRING, then it works and correclty returns &quot;1&quot; instead of &quot;0&quot;.<br />
<br />
Name &quot;Testcon&quot;<br />
OutFile &quot;Testcon.exe&quot;<br />
<br />
;=== Runtime Switches<br />
CRCCheck On<br />
WindowIcon Off<br />
AutoCloseWindow True<br />
SetCompressor /SOLID LZMA<br />
SilentInstall Silent<br />
<br />
Var AUTHURL<br />
Var AUTHSTRING<br />
Var AUTHMD5<br />
<br />
Section &quot;Main&quot;<br />
		StrCpy $AUTHMD5 &quot;df4d054a8ddcb5bcd1a59eebd6e12890&quot;<br />
		StrCpy $AUTHURL &quot;https://www.metropipe.net/torrify/check.php?md5=&quot;<br />
		StrCpy $AUTHSTRING `&quot;$AUTHURL$AUTHMD5&quot;`<br />
		MessageBox MB_OK &quot;Authorization String = $AUTHSTRING&quot;<br />
		InetLoad::load /SILENT /RESUME &quot;$AUTHSTRING&quot; &quot;$EXEDIR\auth.chk&quot; /END<br />
SectionEnd<br />
<br />
Which will return a &quot;0&quot;<br />
<br />
versus:<br />
<br />
Name &quot;Testcon&quot;<br />
OutFile &quot;Testcon.exe&quot;<br />
<br />
;=== Runtime Switches<br />
CRCCheck On<br />
WindowIcon Off<br />
AutoCloseWindow True<br />
SetCompressor /SOLID LZMA<br />
SilentInstall Silent<br />
<br />
<br />
Section &quot;Main&quot;		<br />
		InetLoad::load /SILENT /RESUME &quot;https://www.metropipe.net/torrify/check.php?md5=df4d054a8ddcb5bcd1a59eebd6e12890&quot; &quot;$EXEDIR\auth.chk&quot; /END<br />
SectionEnd<br />
<br />
which will return &quot;1&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">4th November 2006, 16:48</div></div><div class="posttext">[/RESUME RETRY_QUESTION]<br />
If you want use default resume question value, please set <br />
/resume &quot;&quot;<br />
In your command line plug-in threats URL as resume text and cannot get correct URL, so script above could not work (with last versions). Plug-in exit code (see included samples) may help to understand what really happened. Using Pop after plug-in call also helps to keep stack clean - otherwise next plug-in call may get garbage as parameters.<br />
InetLoad not interprets parameters, it downloads basing on the strings coming from stack only - NSIS pushes command line parameters there, so this is not InetLoad problem. You can use Push instructions instead of command lin, beginning with last parameter. This should work, but you can use Push+Pop and compare strings to check stack correctness.<br />
And for silent mode resume always internally switched to 'false'.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">4th November 2006, 17:02</div></div><div class="posttext">Then why does it still not return &quot;1&quot; when:<br />
<br />
<br />
Name &quot;Testcon&quot;<br />
OutFile &quot;Testcon.exe&quot;<br />
<br />
;=== Runtime Switches<br />
CRCCheck On<br />
WindowIcon Off<br />
AutoCloseWindow True<br />
SetCompressor /SOLID LZMA<br />
SilentInstall Silent<br />
<br />
Var AUTHURL<br />
Var AUTHSTRING<br />
Var AUTHMD5<br />
<br />
Section &quot;Main&quot;<br />
		StrCpy $AUTHMD5 &quot;df4d054a8ddcb5bcd1a59eebd6e12890&quot;<br />
		StrCpy $AUTHURL &quot;https://www.metropipe.net/torrify/check.php?md5=&quot;<br />
		StrCpy $AUTHSTRING `&quot;$AUTHURL$AUTHMD5&quot;`<br />
		MessageBox MB_OK &quot;Authorization String = $AUTHSTRING&quot;<br />
		InetLoad::load &quot;$AUTHSTRING&quot; &quot;$EXEDIR\auth.chk&quot; /END<br />
SectionEnd<br />
<br />
<br />
InetLoad not interprets parameters, it downloads basing on the strings coming from stack only <br />
<br />
If that is true, why are the examples in the Plugins wiki using parameters?:<br />
<br />
InetLoad::load &quot;http://dl.zvuki*****6306/mp3/12.mp3&quot; &quot;$EXEDIR\12.mp3&quot; \<br />
               &quot;ftp://dl.zvuki*****6306/mp3/11.mp3&quot; &quot;$EXEDIR\11.mp3&quot;<br />
Pop $0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">4th November 2006, 18:13</div></div><div class="posttext">How it works ;)<br />
NSIS takes parameters beginning the last one and pushes them to installer's stack - this way it transfers parameters to plug-in. No difference for plug-in what form of stack filling was used<br />
plugin::func param1 param2<br />
or<br />
Push param2<br />
Push param1<br />
plugin::func<br />
first form is shorter and so used more often, but second form shows what really happens. I used short form for samples.<br />
Just return $_REQUEST['md5'] string from check.php and compare with string sent ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">4th November 2006, 20:22</div></div><div class="posttext">Takhir, your answer is absolute bullshit. It works using the characters, it stops working when using a variable. If you just don't know the answer admit that Inetload is broken or that nsis isn't properly passing variables.<br />
<br />
Once again: This one works, and the next code example does not. This has zero to do with parameters or the stack or anything else. It is a direct substitution that is not syntax related.<br />
<br />
The one that works:<br />
<br />
Name &quot;Testcon&quot;<br />
OutFile &quot;Testcon_push.exe&quot;<br />
<br />
;=== Runtime Switches<br />
CRCCheck On<br />
WindowIcon Off<br />
AutoCloseWindow True<br />
SetCompressor /SOLID LZMA<br />
SilentInstall Silent<br />
<br />
Section &quot;Main&quot;<br />
		Pop $0<br />
		Push &quot;/END&quot;<br />
		Push &quot;$EXEDIR\output.txt&quot;<br />
		Push &quot;https://www.metropipe.net/torrify/check.php?md5=df4d054a8ddcb5bcd1a59eebd6e12890&quot;<br />
		InetLoad::load<br />
SectionEnd<br />
<br />
<br />
And now the one that doesn't, which is a direct substitution using a string instead of text:<br />
<br />
<br />
<br />
Name &quot;Testcon&quot;<br />
OutFile &quot;Testcon_push.exe&quot;<br />
<br />
;=== Runtime Switches<br />
CRCCheck On<br />
WindowIcon Off<br />
AutoCloseWindow True<br />
SetCompressor /SOLID LZMA<br />
SilentInstall Silent<br />
<br />
Var AUTHURL<br />
Var AUTHSTRING<br />
Var AUTHMD5<br />
<br />
Section &quot;Main&quot;<br />
		StrCpy $AUTHMD5 &quot;df4d054a8ddcb5bcd1a59eebd6e12890&quot;<br />
		StrCpy $AUTHURL &quot;https://www.metropipe.net/torrify/check.php?md5=&quot;<br />
		StrCpy $AUTHSTRING `&quot;$AUTHURL$AUTHMD5&quot;`<br />
		Pop $0<br />
		Push &quot;/END&quot;<br />
		Push &quot;$EXEDIR\output.txt&quot;<br />
		Push &quot;$AUTHSTRING&quot;<br />
		InetLoad::load<br />
SectionEnd<br />
<br />
<br />
As you notice, the first code produces &quot;1&quot;, and the second code produces &quot;0&quot;. 1, from the server, means that the website address exists, and 0 means it does not. So that direct substitution which is entirely equivalent, should result in a &quot;1&quot; instead of a &quot;0&quot;. There is no reason that the first way should succeed and the second way shouldn't, if InetLoad or NSIS didn't have errors. I seriously am waiting for an explanation about how these are both just fine and now it is some other issue.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th November 2006, 20:28</div></div><div class="posttext">Nice way of saying thank you, torpark.<br />
<br />
You have an extra set of quotes there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">4th November 2006, 21:02</div></div><div class="posttext">Kichik, you are brilliant. That is exactly the right answer. No wonder I wasn't seeing the issue.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>