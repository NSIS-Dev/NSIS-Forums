<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait 'gacutil.exe', media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait 'gacutil.exe' NSIS Discussion" />
	
	<title> ExecWait 'gacutil.exe' [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait 'gacutil.exe'</div>
<hr />
<div class="pda"><a href="t-277935.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277935">ExecWait 'gacutil.exe'</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jason_lakewhitn</div><div class="date">26th September 2007, 14:26</div></div><div class="posttext">I have being trying to use the 'ExecWait' with GacUtil.exe.<br />
For some reason it will not work. It will work through a .bat file and on the command prompt. Also, note that I am executing regasm.exe on a different .dll and that works fine. I am including a copy of both regasm.exe and gacutil.exe with the installer.<br />
I am using the code below.<br />
<br />
  CreateDirectory $INSTDIR\Bin<br />
  File /oname=$INSTDIR\Bin\Custom.Library.dll                                                    Custom.Library.dll<br />
  StrCpy $0 $OUTDIR<br />
  StrCpy $OUTDIR &quot;$INSTDIR\Bin&quot; ;The directory of the .dll.<br />
  MessageBox MB_OK $OUTDIR<br />
  ExecWait 'gacutil /u &quot;Custom.Library&quot;' $1<br />
  MessageBox MB_OK $1<br />
<br />
As you can see I change the working directory, so that the parameters passed are as simple as possible. This comes from trying to solve this problem. I am using the MessBox for debuging purpose only. It normaly returns an exit code of 1.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th September 2007, 15:59</div></div><div class="posttext">Copying something into $OUTDIR doesn't change the working directory. You must use SetOutPath for that. Using SetOutPath will also save you using /oname.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jason_lakewhitn</div><div class="date">26th September 2007, 16:32</div></div><div class="posttext">Thank you for the info. since I posted I have figured it out.<br />
It always seems to work like that. You think you have done all you can, then you ask for help and figure it out before you go back to check on the help.<br />
<br />
At any rate this is what I did using ExecDos plugin:<br />
<br />
install:<br />
  StrCpy $0 &quot;$\&quot;$INSTDIR\Bin\gacutil.exe$\&quot; /nologo /i $\&quot;$INSTDIR\Bin\Custom.Library.dll$\&quot;&quot;<br />
  ExecDos::exec /DETAILED &quot;$0&quot; &quot;&quot; &quot;&quot;<br />
  StrCpy $0 &quot;$\&quot;$INSTDIR\Bin\RegAsm.exe$\&quot; /nologo /codebase /tlb:$\&quot;$INSTDIR\Extensions\MyExten.tlb$\&quot; $\&quot;$INSTDIR\Extension\MyExten.dll$\&quot;&quot;<br />
  ExecDos::exec /DETAILED &quot;$0&quot; &quot;&quot; &quot;&quot;<br />
<br />
uninstall: (Remove items from GAC last)<br />
  Push $0<br />
  StrCpy $0 &quot;$\&quot;$INSTDIR\Bin\RegAsm.exe$\&quot; /nologo /unregister $\&quot;$INSTDIR\Extensions\MyExten.dll$\&quot;&quot;<br />
  ExecDos::exec /DETAILED &quot;$0&quot; &quot;&quot; &quot;&quot;<br />
  StrCpy $0 &quot;$\&quot;$INSTDIR\Bin\gacutil.exe$\&quot; /nologo /u Custom.Library&quot;<br />
  ExecDos::exec /DETAILED &quot;$0&quot; &quot;&quot; &quot;&quot;</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>