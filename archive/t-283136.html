<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" List of SQL Servers from a Text File to a ListBox, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  List of SQL Servers from a Text File to a ListBox NSIS Discussion" />
	
	<title> List of SQL Servers from a Text File to a ListBox [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  List of SQL Servers from a Text File to a ListBox</div>
<hr />
<div class="pda"><a href="t-283136.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=283136">List of SQL Servers from a Text File to a ListBox</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">13th December 2007, 13:59</div></div><div class="posttext">Dear Friends,<br />
<br />
I want the users to show a drop-down list filled with list of sql servers.<br />
I'm able to extract the list of servers and write it into a text file by executing the OSQL command from NSIS. Now how to proceed further to make them available in a drop-down list box.<br />
<br />
My text file &quot;ServerList.txt&quot; is like this:<br />
<br />
Servers:<br />
    (local)<br />
    JACK<br />
    ALICE<br />
    ALEX\SQLEXPRESS<br />
    JULIE<br />
    TOM\SQLEXPRESS<br />
    MAINSERVER   (local)<br />
    JACK<br />
    ALICE<br />
    HARRY<br />
    SERVER<br />
    SERVER1<br />
    SUPPORT1<br />
    SUPPORT2<br />
    SWAPAN<br />
    SWAPAN\SKDSSE<br />
    SWAPAN\SQLEXPRESS<br />
<br />
plz. note there is white space above the line &quot;Servers:&quot;. Attached the text file.<br />
<br />
I want to know how to read from the actual data i.e.<br />
    (local)<br />
and not start from the 1st line:<br />
Servers:<br />
And then how to trim a line and read it, then moving to next line and perform the same job, until the end of data.<br />
<br />
Then want to make them join to a single variable with a pipe (|)separtor between each server names something like:<br />
<br />
StrCpy $SQLList $SQLList|$R0<br />
<br />
<br />
If some For Next is to be done to pad the data to the variable SQLList, then please show me with the above scenario.<br />
<br />
Regards,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">13th December 2007, 16:22</div></div><div class="posttext">!define CUST_INI &quot;$PLUGINSDIR\custom.ini&quot;<br />
<br />
!include &quot;TextFunc.nsh&quot;<br />
!insertmacro TrimNewLines<br />
<br />
outfile 'test.exe'<br />
<br />
page custom CreateCustom<br />
page instfiles<br />
<br />
section <br />
<br />
sectionend<br />
<br />
Function .onInit<br />
InitPluginsDir<br />
Call ReadServers<br />
WriteINIStr &quot;${CUST_INI}&quot; &quot;Settings&quot; &quot;NumFields&quot; &quot;1&quot;<br />
WriteINIStr &quot;${CUST_INI}&quot; &quot;field 1&quot; &quot;type&quot; &quot;droplist&quot;<br />
WriteINIStr &quot;${CUST_INI}&quot; &quot;field 1&quot; &quot;left&quot; &quot;10&quot;<br />
WriteINIStr &quot;${CUST_INI}&quot; &quot;field 1&quot; &quot;right&quot; &quot;-10&quot;<br />
WriteINIStr &quot;${CUST_INI}&quot; &quot;field 1&quot; &quot;top&quot; &quot;10&quot;<br />
WriteINIStr &quot;${CUST_INI}&quot; &quot;field 1&quot; &quot;bottom&quot; &quot;-10&quot;<br />
WriteINIStr &quot;${CUST_INI}&quot; &quot;field 1&quot; &quot;state&quot; &quot;$R2&quot;<br />
WriteINIStr &quot;${CUST_INI}&quot; &quot;field 1&quot; &quot;Listitems&quot; &quot;$R2|$R3&quot;<br />
FunctionEnd<br />
<br />
Function ReadServers<br />
StrCpy $R2 &quot;&quot;<br />
StrCpy $R3 &quot;&quot;<br />
FileOpen $R0 &quot;listofservers.txt&quot; r<br />
start:<br />
FileRead $R0 &quot;$R1&quot;<br />
${TrimNewLines} &quot;$R1&quot; &quot;$R1&quot;<br />
StrCmp &quot;$R1&quot; &quot;&quot; start<br />
StrCpy &quot;$R2&quot; &quot;$R1&quot;<br />
loop:<br />
FileRead $R0 &quot;$R1&quot;<br />
IfErrors done<br />
${TrimNewLines} &quot;$R1&quot; &quot;$R1&quot;<br />
StrCpy &quot;$R3&quot; &quot;$R3|$R1&quot;<br />
goto loop<br />
done:<br />
FileClose $R0<br />
FunctionEnd<br />
<br />
Function CreateCustom<br />
push $0<br />
InstallOptions::dialog &quot;${CUST_INI}&quot;<br />
pop $0<br />
pop $0<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">14th December 2007, 04:57</div></div><div class="posttext">Great Red Wine! Thanks thats what I was looking for. You must be surprised I was thinking of you while posting this issue, but was not sure of your reply as the title relates to SQL.<br />
I will work on it and will come up with new issues for you!<br />
Thanks again!<br />
<br />
Regards,</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>