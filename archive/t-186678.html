<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Finishpage: run a file and creating shortcut, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Finishpage: run a file and creating shortcut NSIS Discussion" />
	
	<title> Finishpage: run a file and creating shortcut [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Finishpage: run a file and creating shortcut</div>
<hr />
<div class="pda"><a href="t-186678.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=186678">Finishpage: run a file and creating shortcut</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">rien</div><div class="date">15th July 2004, 14:06</div></div><div class="posttext">Hello,<br />
<br />
I have the problem with the finishpage:<br />
<br />
!define MUI_FINISHPAGE_RUN &quot;$INSTDIR\appz.exe&quot;<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
The appz starts like a shortcut without a workingdir!<br />
<br />
The shortcut to this appz works only because the SetOutPath &quot;$INSTDIR\&quot; is defined before the &quot;!insertmacro MUI_STARTMENU_WRITE_BEGIN Application.&quot;<br />
<br />
How I defined the workingdir?<br />
<br />
In INNO Installer it's really simple:<br />
<br />
[Run]<br />
Filename: {app}\appz.exe; WorkingDir: {app}; Description: Start den test; Flags: nowait postinstall <br />
<br />
And then I wish that the user can choice to make a desktop shortcut to this app at the finishpage. (now this will create it automatic)<br />
<br />
It's possible with a simple script?<br />
<br />
I hope someone can help me. <br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">15th July 2004, 14:41</div></div><div class="posttext">For the working directory:<br />
!define MUI_FINISHPAGE_RUN<br />
!define MUI_FINISHPAGE_RUN_FUNCTION RunMyApp<br />
<br />
Function RunMyApp<br />
<br />
  SetOutPath $INSTDIR<br />
  Exec '&quot;$INSTDIR\MyApp.exe&quot;'<br />
<br />
Function<br />
For the desktop shortcut:<br />
!define MUI_FINISHPAGE_SHOWREADME<br />
!define MUI_SHOWREADME_TEXT &quot;Create &amp;desktop shortcut&quot;<br />
!define MUI_FINISHPAGE_SHOWREADME_FUNCTION CreateDeskShortcut<br />
<br />
Function CreateDeskShortcut<br />
<br />
  ;CreateShortcut command here<br />
<br />
Function<br />
Note: Usually people use the components page for shortcut options.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rien</div><div class="date">15th July 2004, 15:37</div></div><div class="posttext">Hello Joost,<br />
<br />
this is I call perfect help! Thank you very much.<br />
It works fine. Now I need only text for multi language<br />
support but I think I'll found this easy. <br />
<br />
Best greetings!<br />
<br />
rien</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rien</div><div class="date">15th July 2004, 16:49</div></div><div class="posttext">:igor: It isn't so easy! I add the red Langstring but there is only a empty checked field (no text).<br />
<br />
<br />
!define MUI_FINISHPAGE_SHOWREADME<br />
!define MUI_FINISHPAGE_SHOWREADME_TEXT<br />
!define MUI_FINISHPAGE_SHOWREADME_FUNCTION CreateDeskShortcut <br />
LangString MUI_FINISHPAGE_SHOWREADME_TEXT ${LANG_ENGLISH}  &quot;Create &amp;desktop shortcut&quot;<br />
LangString MUI_FINISHPAGE_SHOWREADME_TEXT ${LANG_GERMAN}  &quot;&amp;Desktop-Symbol anlegen&quot;<br />
<br />
<br />
Function CreateDeskShortcut<br />
<br />
  ;Working Directory<br />
SetOutPath $INSTDIR<br />
  ;CreateShortcut command here<br />
CreateShortCut &quot;$DESKTOP\MyApp.lnk&quot; &quot;$INSTDIR\MyApp.exe&quot;<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rien</div><div class="date">16th July 2004, 00:30</div></div><div class="posttext">Hello,<br />
<br />
I don't find the solution for my little problem,<br />
I think it could be only a easy fault.<br />
<br />
Can someone please help me?!<br />
<br />
Perhaps someone has the time to have a look.<br />
<br />
rien</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">16th July 2004, 01:24</div></div><div class="posttext">From the &quot;Syntax&quot; section near the start of the MUI ReadMe:<br />
<br />
&quot;If you want a certain value (e.g. a text) to be language-specific, set a language string (using LangString) and define $(STRINGNAME) as value.&quot;<br />
<br />
So to use a language string for the MUI_FINISHPAGE_SHOWREADME_TEXT you need to do something like this:<br />
<br />
LangString MAKE_SHORTCUT_TEXT ${LANG_ENGLISH}  &quot;Create &amp;desktop shortcut&quot;<br />
LangString MAKE_SHORTCUT_TEXT ${LANG_GERMAN}  &quot;&amp;Desktop-Symbol anlegen&quot;<br />
<br />
!define MUI_FINISHPAGE_SHOWREADME_TEXT  &quot;$(MAKE_SHORTCUT_TEXT)&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rien</div><div class="date">17th July 2004, 12:45</div></div><div class="posttext">Thanks to Joost Verburg and pengyou!<br />
<br />
The last problem was, I had to move the Langstrings behind the Language macros!<br />
<br />
<br />
- Finishpage with checkboxes: run app and creating a desktop symbol to app -<br />
<br />
<br />
!define MUI_FINISHPAGE_RUN<br />
!define MUI_FINISHPAGE_RUN_FUNCTION RunMyApp<br />
<br />
Function RunMyApp<br />
<br />
  SetOutPath $INSTDIR<br />
  Exec '&quot;$INSTDIR\MyApp.exe&quot;'<br />
<br />
FunctionEnd<br />
<br />
!define MUI_FINISHPAGE_SHOWREADME<br />
!define MUI_FINISHPAGE_SHOWREADME_TEXT &quot;$(MAKE_SHORTCUT_TEXT)&quot;<br />
!define MUI_FINISHPAGE_SHOWREADME_FUNCTION CreateDeskShortcut <br />
<br />
Function CreateDeskShortcut<br />
<br />
  ;Working Directory<br />
SetOutPath $INSTDIR<br />
  ;CreateShortcut command here<br />
CreateShortCut &quot;$DESKTOP\MyApp.lnk&quot; &quot;$INSTDIR\MyApp.exe&quot;<br />
FunctionEnd<br />
.<br />
.<br />
.<br />
; Set languages (first is default language)<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
!insertmacro MUI_LANGUAGE &quot;German&quot;<br />
<br />
; English Strings<br />
LangString MAKE_SHORTCUT_TEXT ${LANG_ENGLISH}  &quot;Create &amp;desktop shortcut&quot;<br />
<br />
; German Strings<br />
LangString MAKE_SHORTCUT_TEXT ${LANG_GERMAN}  &quot;&amp;Desktop-Symbol anlegen&quot;<br />
<br />
Best Regards<br />
<br />
Rien</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">18th July 2004, 15:28</div></div><div class="posttext">The language files set the defines like ${LANG_ENGLISH}. The easiest method is to follow the order in the Modern UI Readme.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rien</div><div class="date">21st July 2004, 00:48</div></div><div class="posttext">Hello,<br />
<br />
I think I have an interesting question.<br />
<br />
Who must look the script above for the classic installer?<br />
Exist perhaps a converter? :) I don't think so.<br />
<br />
I don't find a script by the examples for the finish page.<br />
<br />
Is it difficult to write the script for the classic installer? Perhaps someone can help for fun.<br />
<br />
Good evening<br />
<br />
Rien</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rien</div><div class="date">23rd July 2004, 14:24</div></div><div class="posttext">Hi,<br />
<br />
can someone please have a look on the script above?<br />
<br />
I want this script for the classic installer of NSIS.<br />
I don't know how I get the finishpage in the classic installer. I think it couldn't be so difficult.<br />
<br />
Greetings.<br />
<br />
Rien</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">23rd July 2004, 14:59</div></div><div class="posttext">The classic installer does not have a &quot;Finish&quot; page - it only has the following pages built-in (see &quot;4.5.4 Page&quot; in NSIS User Manual):<br />
<br />
license<br />
components<br />
directory<br />
instfiles<br />
uninstConfirm<br />
<br />
So if you want a &quot;Finish&quot; page in a classic installer, you'll need to make your own custompage using InstallOptions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rien</div><div class="date">24th July 2004, 14:51</div></div><div class="posttext">Thank you,<br />
<br />
now have the custom page, but I don't understand anything.<br />
<br />
I use this ini file:<br />
[Settings]<br />
NumFields=3<br />
<br />
[Field 1]<br />
Type=GroupBox<br />
Left=0<br />
Right=-1<br />
Top=0<br />
Bottom=-5<br />
Text=Installation Complete<br />
<br />
[Field 2]<br />
Type=checkbox<br />
Text=Install a shortcut on your desktop?<br />
Left=10<br />
Right=-10<br />
Top=17<br />
Bottom=25<br />
State=1<br />
Flags=GROUP<br />
<br />
[Field 3]<br />
Type=checkbox<br />
Text=Play MyApp!<br />
Left=10<br />
Right=-10<br />
Top=43<br />
Bottom=51<br />
State=1<br />
Flags=GROUP<br />
<br />
<br />
And I have at this script to my *.nsi file:<br />
<br />
Page license<br />
Page directory<br />
Page instfiles<br />
Page custom customPage &quot;&quot; &quot;: custom page&quot; <br />
<br />
  <br />
Function customPage <br />
   GetTempFileName $R0 <br />
   File /oname=$R0 final_page.ini <br />
   InstallOptions::dialog $R0 <br />
   Pop $R1 <br />
   StrCmp $R1 &quot;cancel&quot; done <br />
   StrCmp $R1 &quot;back&quot; done <br />
   StrCmp $R1 &quot;success&quot; done <br />
   error: MessageBox MB_OK|MB_ICONSTOP &quot;InstallOptions error:$\r$\n$R1&quot; <br />
   done: <br />
FunctionEnd<br />
<br />
<br />
It looks like I wish, but there is no function.<br />
How I get the checkbox infos from the ini file in function?<br />
<br />
For me it's to difficult, but perhaps someone can help me<br />
and spend some time.<br />
<br />
I hope you can help me.<br />
<br />
Rien</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>