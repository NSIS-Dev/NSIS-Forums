<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" WriteINIStr for URL link, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  WriteINIStr for URL link NSIS Discussion" />
	
	<title> WriteINIStr for URL link [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  WriteINIStr for URL link</div>
<hr />
<div class="pda"><a href="t-139228.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=139228">WriteINIStr for URL link</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Mark Beckwith</div><div class="date">16th June 2003, 18:53</div></div><div class="posttext">First of all, let me say how overjoyed I am now that I am<br />
using NSIS.  I did more with NSIS in 2 days than I was able<br />
to do in months with InstallShield.  And the installation is<br />
1/2 the size!  I keep thinking I forgot to add something.<br />
<br />
Anyway, there is obviously something I'm conceptually<br />
missing.  I took the makensis.nsi script and hacked away on<br />
it until I had it working with our much simpler<br />
installation.  Everything works fine but:<br />
<br />
I have this in my nsi script:<br />
<br />
SetOutPath $INSTDIR<br />
 <br />
WriteINIStr &quot;$SMPROGRAMS\Intrig Insight\Intrig Online.url&quot; \<br />
&quot;InternetShortcut&quot; &quot;URL&quot; &quot;http://www.intrig.com/&quot;<br />
<br />
That is, I want to add a link to my company's home page.<br />
After installing, I click on the shortcut, and I get a<br />
windows error:<br />
<br />
&quot;The address at 0x32452434 cannot be written&quot; (or something<br />
like that).  And then the explorer bar goes away and I have<br />
to logout and log back in to get it to work again.  Not<br />
exactly an ideal user experience!<br />
<br />
Could you tell me what I'm missing.  Looks like a newbie<br />
error to me.  If you need more info please don't hesitate to ask.<br />
<br />
Thanks,<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">16th June 2003, 19:28</div></div><div class="posttext">I don't know maybe: &quot;http://www.intrig.com&quot; (without the &quot;/&quot;)<br />
I don't see way isn't work, the script is fine.<br />
maybe the &quot;\&quot; in your script....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">16th June 2003, 21:22</div></div><div class="posttext">I don't think that makes sense.<br />
<br />
Does it work if you create a .url file manually?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mark Beckwith</div><div class="date">16th June 2003, 21:36</div></div><div class="posttext">Sure.  I made a .url file on the desktop and it works fine.  <br />
<br />
Now, when I did a search on &quot;Intrig Online&quot;, it turned up nothing.  So I guess the url file is not being created.  Do I have to create the INI  file somewhere in my script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ramon18</div><div class="date">16th June 2003, 21:58</div></div><div class="posttext">Try this simple script and tell us the result,<br />
this script just generate one url on your desktop<br />
<br />
<br />
Name TestURL<br />
OutFile TestURL.exe<br />
<br />
<br />
Section XDummy<br />
<br />
  SetShellVarContext all<br />
  WriteIniStr &quot;$DESKTOP\TestURL.url&quot; &quot;InternetShortcut&quot; &quot;URL&quot; &quot;http://nsis.sourceforge.net/&quot;<br />
<br />
SectionEnd<br />
<br />
<br />
Btw: this seams to be a shell problem of your box, you can use notepad and open the &quot;TestURL.url&quot; and see if the contents is valid, for me is:<br />
<br />
<br />
[InternetShortcut]<br />
URL=http://nsis.sourceforge.net/<br />
<br />
<br />
Cyas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mark Beckwith</div><div class="date">16th June 2003, 22:53</div></div><div class="posttext">The above script works fine.  The problem occurs when I try to writeINIStr to the shortcut in the start menu.  The url file gets created in the current user, but I get the &quot;Cannot read address 0x00000000&quot; error when I click on it.  And I noticed that if I click on the Start&gt;Programs&gt;NSIS&gt;NSIS Development Site, I get the same error.  So it looks like there is something wrong with my machine setup.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">17th June 2003, 11:47</div></div><div class="posttext">Yes, there must be something wrong with your machine. Works fine here.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>