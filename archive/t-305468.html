<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstaller Determine Name of its Parent Folder, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstaller Determine Name of its Parent Folder NSIS Discussion" />
	
	<title> Uninstaller Determine Name of its Parent Folder [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstaller Determine Name of its Parent Folder</div>
<hr />
<div class="pda"><a href="t-305468.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305468">Uninstaller Determine Name of its Parent Folder</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bubustoober</div><div class="date">17th April 2009, 22:24</div></div><div class="posttext">This will probably be trivial for the gurus on this forum but I need some help because I'm a n00b to NSIS. Thanks in advance!<br />
<br />
I need to have my uninstaller determine the name of the parent folder from which the uninstaller is being run.<br />
<br />
For example, if the uninstaller is being run from &quot;C:\Data\ProgramName\uninstall.exe&quot;, I need to store the string &quot;ProgramName&quot; for later use.<br />
<br />
Ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Static_VoiD</div><div class="date">18th April 2009, 00:21</div></div><div class="posttext">Oh, my...there's a perfect function GetParent in FileFunc.nsh .<br />
The usage is described in NSIS help ;) .<br />
And if you need to retrieve the folder name only, you can use GetFileName from the same header for the parent folder you previously got.<br />
I'm sorry, i can't type a code 'cause i'm using mobile internet ATM :-S .<br />
Good luck.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">18th April 2009, 01:48</div></div><div class="posttext">4.6.2 Uninstall Section (http://nsis.sourceforge.net/Docs/Chapter4.html#4.6.2) <br />
A special Section named 'Uninstall' must be created in order to generate an uninstaller. This section should remove all files, registry keys etc etc that were installed by the installer, from the system. Here is an example of a simple uninstall section:Section &quot;Uninstall&quot;<br />
  Delete $INSTDIR\Uninst.exe ; delete self (see explanation below why this works)<br />
  Delete $INSTDIR\myApp.exe<br />
  RMDir $INSTDIR<br />
  DeleteRegKey HKLM SOFTWARE\myApp<br />
SectionEnd The first Delete instruction works (deleting the uninstaller), because the uninstaller is transparently copied to the system temporary directory for the uninstall.<br />
<br />
Note that in uninstaller code, $INSTDIR contains the directory where the uninstaller lies. It does not necessarily contain the same value it contained in the installer. If you need to store the installer directory, you can StrCpy $INSTDIR or WriteRegStr $INSTDIR.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bubustoober</div><div class="date">18th April 2009, 21:39</div></div><div class="posttext">Thanks for the replies!<br />
I tried the GetParent function...<br />
<br />
It takes &quot;C:\Program Files\Directory\Whatever&quot; and returns &quot;C:\Program Files\Directory&quot;<br />
<br />
What I need is the opposite - to push &quot;C:\Program Files\Directory\Whatever&quot; and return &quot;Whatever&quot;<br />
<br />
Being a n00b, I couldn't figure out how to modify GetParent to do the opposite - maybe someone on the forum would know how?<br />
<br />
<br />
<br />
Section &quot;Uninstall&quot;<br />
	Push &quot;C:\Program Files\Directory\Whatever&quot;<br />
	Call un.GetParent<br />
	Pop $R0<br />
	;...more uninstall code here...<br />
SectionEnd<br />
<br />
Function un.GetParent<br />
	 <br />
	  Exch $R0<br />
	  Push $R1<br />
	  Push $R2<br />
	  Push $R3<br />
	 <br />
	  StrCpy $R1 0<br />
	  StrLen $R2 $R0<br />
	 <br />
	  loop:<br />
	    IntOp $R1 $R1 + 1<br />
	    IntCmp $R1 $R2 get 0 get<br />
	    StrCpy $R3 $R0 1 -$R1<br />
	    StrCmp $R3 &quot;\&quot; get<br />
	  Goto loop<br />
	 <br />
	  get:<br />
	    StrCpy $R0 $R0 -$R1<br />
	 <br />
	    Pop $R3<br />
	    Pop $R2<br />
	    Pop $R1<br />
	    Exch $R0<br />
	 <br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">18th April 2009, 21:51</div></div><div class="posttext">if the uninstaller is being run from &quot;C:\Data\ProgramName\uninstall.exe&quot;, I need to store the string &quot;ProgramName&quot; for later use.<br />
 ; example: running C:\Data\ProgramName\uninstall.exe<br />
!include &quot;FileFunc.nsh&quot;<br />
${GetFileName} &quot;$INSTDIR&quot; $0<br />
; $0 is ProgramName</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bubustoober</div><div class="date">18th April 2009, 23:04</div></div><div class="posttext">Thanks guys, that works great!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>