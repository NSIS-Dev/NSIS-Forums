<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" I'm trying to have an answer about two directories in one installer until two days !!, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  I'm trying to have an answer about two directories in one installer until two days !! NSIS Discussion" />
	
	<title> I'm trying to have an answer about two directories in one installer until two days !! [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  I'm trying to have an answer about two directories in one installer until two days !!</div>
<hr />
<div class="pda"><a href="t-216268.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=216268">I'm trying to have an answer about two directories in one installer until two days !!</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">emdiouf</div><div class="date">17th May 2005, 17:04</div></div><div class="posttext">Hi,<br />
I'm waiting for your help about my question i posted until yesterday; it seems nobody wants to reply to me.<br />
Thanks to have a look :<br />
<br />
I'm trying to have in my installer two directories; one for my application and another for my database. <br />
I have already posted but nobody answered me yet.<br />
I have read in the archive this : http://nsis.sourceforge.net/archive....php?pageid=553<br />
<br />
That is not exactly what i want and i have adapted it:<br />
<br />
Here is my code that you can test; for the instructions in the sections, i just display messages:<br />
<br />
#begin of my code<br />
!include &quot;Sections.nsh&quot; <br />
<br />
Name Test <br />
OutFile test.exe <br />
<br />
Page components <br />
<br />
Var ECITIZ_DIR <br />
PageEx directory<br />
DirText &quot;Ceci installera l'Application&quot; <br />
DirVar $ECITIZ_DIR <br />
PageCallbacks DirectoryAppliPre &quot;&quot; &quot;&quot; <br />
PageExEnd <br />
<br />
Var POSTGRES_DIR <br />
PageEx directory <br />
DirText &quot;Ceci installera la Base de Données PostgreSQL \ dans le dossier suivant; pour l'installer dans un autre \ dossier,cliquez parcourir et choisissez un autre dossier. \ Cliquez suivant pour continuer.&quot; &quot;Installation de \<br />
la Base de Données PostgreSQL&quot; <br />
DirVar $POSTGRES_DIR <br />
PageCallbacks DirectoryBDPre &quot;&quot; &quot;&quot; <br />
PageExEnd <br />
<br />
Page instfiles <br />
<br />
!macro SiCocheAlorsVaA TMPVAR SECTION GOTO <br />
SectionGetFlags ${SECTION} ${TMPVAR} <br />
IntOp ${TMPVAR} ${TMPVAR} &amp; ${SF_SELECTED} <br />
IntCmp ${TMPVAR} 1 ${GOTO} +1 <br />
!macroend <br />
<br />
Function DirectoryAppliPre <br />
Push $1 <br />
StrCpy $ECITIZ_DIR &quot;c:\ecitiz&quot; <br />
!insertmacro SiCocheAlorsVaA $1 eCitiz afficherPageAppli <br />
!insertmacro SiCocheAlorsVaA $1 examples afficherPageAppli <br />
Pop $1 <br />
Abort <br />
<br />
afficherPageAppli: <br />
<br />
FunctionEnd <br />
<br />
Function DirectoryBDPre <br />
Push $1 <br />
StrCpy $ECITIZ_DIR &quot;c:\postgres&quot; <br />
!insertmacro SiCocheAlorsVaA $1 bdd afficherPageDB <br />
<br />
Abort <br />
<br />
afficherPageDB: <br />
Pop $1 <br />
FunctionEnd <br />
<br />
SubSection &quot;e-Citiz&quot; <br />
;sous-section d'installation du studio <br />
Section &quot;!e-Citiz Studio&quot; eCitiz <br />
SetOutPath $INSTDIR <br />
MessageBox MB_OK &quot;eCitiz&quot; <br />
SectionEnd <br />
<br />
;Sous-section d'installation du bouquet <br />
Section /o &quot;!Exemples de Téléprocédures&quot; examples <br />
SetOutPath $INSTDIR <br />
MessageBox MB_OK &quot;examples&quot; <br />
SectionEnd <br />
<br />
Section &quot;!Raccourcis&quot; short <br />
MessageBox MB_OK &quot;short&quot; <br />
SectionEnd <br />
<br />
SubSectionEnd <br />
<br />
<br />
SubSection &quot;Base de données&quot; <br />
# Sous-section d'installation de posgreSQL <br />
Section &quot;!PostgreSQL&quot; bdd <br />
MessageBox MB_OK &quot;bdd&quot; <br />
SectionEnd <br />
SubSectionEnd <br />
<br />
SubSection &quot;Adobe Acrobat Reader&quot; <br />
# Sous-section d'installation de Acrobat Reader <br />
Section /o &quot;!Adobe Acrobat Reader&quot; adobe <br />
MessageBox MB_OK &quot;adobe&quot; <br />
SectionEnd <br />
SubSectionEnd <br />
<br />
#end of my code<br />
<br />
a°)What i would like to do:<br />
1°)if and only if i select sections with index &quot;eCitiz&quot; or &quot;examples&quot;, it displays the page to select the directory for the Application; in all other cases it must not display this page to select the directory for my Application.<br />
2°)if and only if i select sections with index &quot;bdd&quot;, it displays the page to select the directory for my Data Base; in all other cases it must not display this page to select the directory for my Data Base. <br />
<br />
b°)How it works now :<br />
1°)if i select sections with index &quot;eCitiz&quot; or &quot;examples&quot;,and i click on next it starts executing instructions in sections &quot;eCitiz&quot; or &quot;examples&quot;, without displaying the page to select the directory for the Application.<br />
2°)if i select sections with index &quot;bdd&quot;,and i clisk on next it starts executing instructions in sections &quot;bdd&quot; , without displaying the page to select the directory for the DataBase.<br />
<br />
3°)if i select the three sections with index &quot;eCitiz&quot;, &quot;examples&quot;,and &quot;short&quot;,and i click on next it displays first the page to select the directory for the Application, and after the page to select the directory for the DataBase even if i have not select the section &quot;bdd&quot;<br />
<br />
4°)if i select the four sections with index &quot;eCitiz&quot;, &quot;examples&quot;,&quot;short&quot;,and &quot;bdd&quot;,and i click on next, it displays first the page to select the directory for the Application, and after the page to select the directory for the Data Base ;before executing instructions in the sections (here all is rigth).<br />
<br />
I think it is about the two functions &quot;DirectoryAppliPre&quot; and &quot;DirectoryDBPre&quot; or the macro &quot;SiCocheAlorsVaA&quot; ?<br />
Is there a bug in NSIS ? <br />
All seem to be logic in my code !!!<br />
Can somebody tell me what is wrong ?<br />
<br />
Thanks to have a look to my question !!<br />
<br />
:) :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">restools</div><div class="date">18th May 2005, 13:21</div></div><div class="posttext">#begin of my code<br />
<br />
!include &quot;Sections.nsh&quot;<br />
<br />
Name Test<br />
OutFile test.exe<br />
<br />
Page components<br />
<br />
Var ECITIZ_DIR<br />
<br />
PageEx directory<br />
  DirText &quot;Ceci installera l'Application&quot;<br />
  DirVar $ECITIZ_DIR<br />
  PageCallbacks DirectoryAppliPre &quot;&quot; &quot;&quot;<br />
PageExEnd<br />
<br />
Var POSTGRES_DIR<br />
<br />
PageEx directory<br />
  DirText &quot;Ceci installera la Base de Données PostgreSQL \ dans le dossier suivant; pour l'installer dans un autre \ dossier,cliquez parcourir et choisissez un autre dossier. \ Cliquez suivant pour continuer.&quot; &quot;Installation de \<br />
la Base de Données PostgreSQL&quot;<br />
  DirVar $POSTGRES_DIR<br />
  PageCallbacks DirectoryBDPre &quot;&quot; &quot;&quot;<br />
PageExEnd<br />
<br />
Page instfiles<br />
<br />
############ first: Section #################  notice<br />
<br />
SubSection &quot;e-Citiz&quot;<br />
  ;sous-section d'installation du studio<br />
  Section &quot;!e-Citiz Studio&quot; eCitiz<br />
    SetOutPath $INSTDIR<br />
    MessageBox MB_OK &quot;eCitiz&quot;<br />
  SectionEnd<br />
<br />
  ;Sous-section d'installation du bouquet<br />
  Section /o &quot;!Exemples de Téléprocédures&quot; examples<br />
    SetOutPath $INSTDIR<br />
    MessageBox MB_OK &quot;examples&quot;<br />
  SectionEnd<br />
<br />
  Section &quot;!Raccourcis&quot; short<br />
    MessageBox MB_OK &quot;short&quot;<br />
  SectionEnd<br />
<br />
SubSectionEnd<br />
<br />
<br />
SubSection &quot;Base de données&quot;<br />
# Sous-section d'installation de posgreSQL<br />
  Section &quot;!PostgreSQL&quot; bdd<br />
    MessageBox MB_OK &quot;bdd&quot;<br />
  SectionEnd<br />
SubSectionEnd<br />
<br />
SubSection &quot;Adobe Acrobat Reader&quot;<br />
# Sous-section d'installation de Acrobat Reader<br />
  Section /o &quot;!Adobe Acrobat Reader&quot; adobe<br />
    MessageBox MB_OK &quot;adobe&quot;<br />
  SectionEnd<br />
SubSectionEnd<br />
<br />
############## secondly: function ############## notice<br />
<br />
!macro SiCocheAlorsVaA TMPVAR SECTION GOTO<br />
  SectionGetFlags ${${SECTION}} ${TMPVAR}    # &lt;&lt;&lt;&lt;&lt;&lt; advert:  &quot;${${SECTION}}&quot;<br />
  IntOp ${TMPVAR} ${TMPVAR} &amp; ${SF_SELECTED}<br />
  IntCmp ${TMPVAR} 1 ${GOTO} +1<br />
!macroend<br />
<br />
Function DirectoryAppliPre<br />
  Push $1<br />
  StrCpy $ECITIZ_DIR &quot;c:\ecitiz&quot;<br />
  !insertmacro SiCocheAlorsVaA $1 eCitiz afficherPageAppli<br />
  !insertmacro SiCocheAlorsVaA $1 examples afficherPageAppli<br />
  Pop $1<br />
  Abort<br />
<br />
  afficherPageAppli:<br />
<br />
FunctionEnd<br />
<br />
Function DirectoryBDPre<br />
  Push $1<br />
  StrCpy $ECITIZ_DIR &quot;c:\postgres&quot;<br />
  !insertmacro SiCocheAlorsVaA $1 bdd afficherPageDB<br />
<br />
  Abort<br />
<br />
  afficherPageDB:<br />
    Pop $1<br />
FunctionEnd<br />
<br />
#end of my code</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>