<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Get me off this pit !!!!, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Get me off this pit !!!! NSIS Discussion" />
	
	<title> Get me off this pit !!!! [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Get me off this pit !!!!</div>
<hr />
<div class="pda"><a href="t-236934.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=236934">Get me off this pit !!!!</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jzdexta</div><div class="date">1st February 2006, 17:23</div></div><div class="posttext">When I compile my .nsi which has been attached to this application the following log file is generated:<br />
<br />
MakeNSIS v2.14 - Copyright 1999-2006 Nullsoft, Inc.<br />
<br />
Portions Copyright (C) 1995-1998 Jean-loup Gailly and Mark Adler (zlib).<br />
Portions Copyright (C) 1996-2002 Julian R Seward (bzip2).<br />
Portions Copyright (C) 1999-2003 Igor Pavlov (lzma).<br />
<br />
Contributors: nnop@newmail.ru, Ryan Geiss, Andras Varga, Drew Davidson, Peter Windridge, Dave Laundon, Robert Rainwater, Yaroslav Faybishenko, Jeff Doozan, Amir Szekely, Ximon Eighteen, et al.<br />
<br />
Processing config: <br />
Processing plugin dlls: &quot;C:\PROGRAM FILES\NSIS\Plugins\*.dll&quot;<br />
 - AdvSplash::show<br />
 - Banner::destroy<br />
 - Banner::getWindow<br />
 - Banner::show<br />
 - BgImage::AddImage<br />
 - BgImage::AddText<br />
 - BgImage::Clear<br />
 - BgImage::Destroy<br />
 - BgImage::Redraw<br />
 - BgImage::SetBg<br />
 - BgImage::SetReturn<br />
 - BgImage::Sound<br />
 - Dialer::AttemptConnect<br />
 - Dialer::AutodialHangup<br />
 - Dialer::AutodialOnline<br />
 - Dialer::AutodialUnattended<br />
 - Dialer::GetConnectedState<br />
 - InstallOptions::dialog<br />
 - InstallOptions::initDialog<br />
 - InstallOptions::show<br />
 - LangDLL::LangDialog<br />
 - Math::Script<br />
 - NSISdl::download<br />
 - NSISdl::download_quiet<br />
 - Splash::show<br />
 - StartMenu::Init<br />
 - StartMenu::Select<br />
 - StartMenu::Show<br />
 - System::Alloc<br />
 - System::Call<br />
 - System::Copy<br />
 - System::Free<br />
 - System::Get<br />
 - System::Int64Op<br />
 - System::Store<br />
 - TypeLib::GetLibVersion<br />
 - TypeLib::Register<br />
 - TypeLib::UnRegister<br />
 - UserInfo::GetAccountType<br />
 - UserInfo::GetName<br />
 - VPatch::vpatchfile<br />
 - nsExec::Exec<br />
 - nsExec::ExecToLog<br />
 - nsExec::ExecToStack<br />
<br />
!define: &quot;MUI_INSERT_NSISCONF&quot;=&quot;&quot;<br />
<br />
Changing directory to: &quot;D:\Dexta\Internet Code\crak\balance sheet&quot;<br />
<br />
Processing script file: &quot;D:\Dexta\Internet Code\crak\balance sheet\Net Sample.nsi&quot;<br />
!define: &quot;MUI_PRODUCT&quot;=&quot;ADO Total Show Beta Ver. 1.0.0&quot;<br />
!define: &quot;MUI_FILE&quot;=&quot;ADOTotalShow&quot;<br />
!define: &quot;MUI_VERSION&quot;=&quot;&quot;<br />
!define: &quot;MUI_BRANDINGTEXT&quot;=&quot;ADO Total Show Beta Ver. 1.0.0&quot;<br />
!include: &quot;C:\PROGRAM FILES\NSIS\Contrib\Modern UI\System.nsh&quot;<br />
NSIS Modern User Interface version 1.74 - © 2002-2006 Joost Verburg (C:\PROGRAM FILES\NSIS\Contrib\Modern UI\System.nsh:11)<br />
!define: &quot;MUI_VERBOSE&quot;=&quot;3&quot;<br />
!include: closed: &quot;C:\PROGRAM FILES\NSIS\Contrib\Modern UI\System.nsh&quot;<br />
OutFile: &quot;ADOTotalsShow.exe&quot;<br />
ShowInstDetails: nevershow<br />
ShowUninstDetails: nevershow<br />
!define: &quot;MUI_ICON&quot;=&quot;modern-install-blue.ico&quot;<br />
!define: &quot;MUI_UNICON&quot;=&quot;modern-uninstall-colorful.ico&quot;<br />
!define: &quot;MUI_SPECIALBITMAP&quot;=&quot;nsis.bmp&quot;<br />
InstallDir: &quot;$PROGRAMFILES\ADO Total Show Beta Ver. 1.0.0&quot;<br />
!define: &quot;MUI_WELCOMEPAGE&quot;=&quot;&quot;<br />
!define: &quot;MUI_DIRECTORYPAGE&quot;=&quot;&quot;<br />
!define: &quot;MUI_ABORTWARNING&quot;=&quot;&quot;<br />
!define: &quot;MUI_UNINSTALLER&quot;=&quot;&quot;<br />
!define: &quot;MUI_UNCONFIRMPAGE&quot;=&quot;&quot;<br />
!define: &quot;MUI_FINISHPAGE&quot;=&quot;&quot;<br />
Usage: Section [/0] [-][un.][section_name] [section index output]<br />
Error in script &quot;D:\Dexta\Internet Code\crak\balance sheet\Net Sample.nsi&quot; on line 74 -- aborting creation process<br />
 <br />
Can someone please help me :mad: :cry: :eek:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st February 2006, 17:50</div></div><div class="posttext">Section &quot;install&quot;<br />
not<br />
Section &quot;install&quot; Installation info<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jzdexta</div><div class="date">1st February 2006, 18:02</div></div><div class="posttext">When I re-compile the file after making aforementioned modifications this my new error:<br />
&quot;MakeNSIS v2.14 - Copyright 1999-2006 Nullsoft, Inc.<br />
<br />
Portions Copyright (C) 1995-1998 Jean-loup Gailly and Mark Adler (zlib).<br />
Portions Copyright (C) 1996-2002 Julian R Seward (bzip2).<br />
Portions Copyright (C) 1999-2003 Igor Pavlov (lzma).<br />
<br />
Contributors: nnop@newmail.ru, Ryan Geiss, Andras Varga, Drew Davidson, Peter Windridge, Dave Laundon, Robert Rainwater, Yaroslav Faybishenko, Jeff Doozan, Amir Szekely, Ximon Eighteen, et al.<br />
<br />
Processing config: <br />
Processing plugin dlls: &quot;C:\PROGRAM FILES\NSIS\Plugins\*.dll&quot;<br />
 - AdvSplash::show<br />
 - Banner::destroy<br />
 - Banner::getWindow<br />
 - Banner::show<br />
 - BgImage::AddImage<br />
 - BgImage::AddText<br />
 - BgImage::Clear<br />
 - BgImage::Destroy<br />
 - BgImage::Redraw<br />
 - BgImage::SetBg<br />
 - BgImage::SetReturn<br />
 - BgImage::Sound<br />
 - Dialer::AttemptConnect<br />
 - Dialer::AutodialHangup<br />
 - Dialer::AutodialOnline<br />
 - Dialer::AutodialUnattended<br />
 - Dialer::GetConnectedState<br />
 - InstallOptions::dialog<br />
 - InstallOptions::initDialog<br />
 - InstallOptions::show<br />
 - LangDLL::LangDialog<br />
 - Math::Script<br />
 - NSISdl::download<br />
 - NSISdl::download_quiet<br />
 - Splash::show<br />
 - StartMenu::Init<br />
 - StartMenu::Select<br />
 - StartMenu::Show<br />
 - System::Alloc<br />
 - System::Call<br />
 - System::Copy<br />
 - System::Free<br />
 - System::Get<br />
 - System::Int64Op<br />
 - System::Store<br />
 - TypeLib::GetLibVersion<br />
 - TypeLib::Register<br />
 - TypeLib::UnRegister<br />
 - UserInfo::GetAccountType<br />
 - UserInfo::GetName<br />
 - VPatch::vpatchfile<br />
 - nsExec::Exec<br />
 - nsExec::ExecToLog<br />
 - nsExec::ExecToStack<br />
<br />
!define: &quot;MUI_INSERT_NSISCONF&quot;=&quot;&quot;<br />
<br />
Changing directory to: &quot;D:\Dexta\Internet Code\crak\balance sheet&quot;<br />
<br />
Processing script file: &quot;D:\Dexta\Internet Code\crak\balance sheet\Net Sample.nsi&quot;<br />
!define: &quot;MUI_PRODUCT&quot;=&quot;ADO Total Show Beta Ver. 1.0.0&quot;<br />
!define: &quot;MUI_FILE&quot;=&quot;ADOTotalShow&quot;<br />
!define: &quot;MUI_VERSION&quot;=&quot;&quot;<br />
!define: &quot;MUI_BRANDINGTEXT&quot;=&quot;ADO Total Show Beta Ver. 1.0.0&quot;<br />
!include: &quot;C:\PROGRAM FILES\NSIS\Contrib\Modern UI\System.nsh&quot;<br />
NSIS Modern User Interface version 1.74 - © 2002-2006 Joost Verburg (C:\PROGRAM FILES\NSIS\Contrib\Modern UI\System.nsh:11)<br />
!define: &quot;MUI_VERBOSE&quot;=&quot;3&quot;<br />
!include: closed: &quot;C:\PROGRAM FILES\NSIS\Contrib\Modern UI\System.nsh&quot;<br />
OutFile: &quot;ADOTotalsShow.exe&quot;<br />
ShowInstDetails: nevershow<br />
ShowUninstDetails: nevershow<br />
!define: &quot;MUI_ICON&quot;=&quot;modern-install-blue.ico&quot;<br />
!define: &quot;MUI_UNICON&quot;=&quot;modern-uninstall-colorful.ico&quot;<br />
!define: &quot;MUI_SPECIALBITMAP&quot;=&quot;nsis.bmp&quot;<br />
InstallDir: &quot;$PROGRAMFILES\ADO Total Show Beta Ver. 1.0.0&quot;<br />
!define: &quot;MUI_WELCOMEPAGE&quot;=&quot;&quot;<br />
!define: &quot;MUI_DIRECTORYPAGE&quot;=&quot;&quot;<br />
!define: &quot;MUI_ABORTWARNING&quot;=&quot;&quot;<br />
!define: &quot;MUI_UNINSTALLER&quot;=&quot;&quot;<br />
!define: &quot;MUI_UNCONFIRMPAGE&quot;=&quot;&quot;<br />
!define: &quot;MUI_FINISHPAGE&quot;=&quot;&quot;<br />
Section: &quot;install&quot;<br />
SetOutPath: &quot;$INSTDIR&quot;<br />
!insertmacro: InstallLib<br />
!insertmacro: macro named &quot;InstallLib&quot; not found!<br />
Error in script &quot;D:\Dexta\Internet Code\crak\balance sheet\Net Sample.nsi&quot; on line 79 -- aborting creation process<br />
 &quot;<br />
<br />
Im now hopefull that it will work thank you and hope you cn figure out what is wrong with this script<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st February 2006, 18:56</div></div><div class="posttext">Did you !include Library.nsh?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jzdexta</div><div class="date">2nd February 2006, 10:21</div></div><div class="posttext">This is the output i get if i run the script with changes to include statement.<br />
:eek: <br />
MakeNSIS v2.14 - Copyright 1999-2006 Nullsoft, Inc.<br />
<br />
Portions Copyright (C) 1995-1998 Jean-loup Gailly and Mark Adler (zlib).<br />
Portions Copyright (C) 1996-2002 Julian R Seward (bzip2).<br />
Portions Copyright (C) 1999-2003 Igor Pavlov (lzma).<br />
<br />
Contributors: nnop@newmail.ru, Ryan Geiss, Andras Varga, Drew Davidson, Peter Windridge, Dave Laundon, Robert Rainwater, Yaroslav Faybishenko, Jeff Doozan, Amir Szekely, Ximon Eighteen, et al.<br />
<br />
Processing config: <br />
Processing plugin dlls: &quot;C:\PROGRAM FILES\NSIS\Plugins\*.dll&quot;<br />
 - AdvSplash::show<br />
 - Banner::destroy<br />
 - Banner::getWindow<br />
 - Banner::show<br />
 - BgImage::AddImage<br />
 - BgImage::AddText<br />
 - BgImage::Clear<br />
 - BgImage::Destroy<br />
 - BgImage::Redraw<br />
 - BgImage::SetBg<br />
 - BgImage::SetReturn<br />
 - BgImage::Sound<br />
 - Dialer::AttemptConnect<br />
 - Dialer::AutodialHangup<br />
 - Dialer::AutodialOnline<br />
 - Dialer::AutodialUnattended<br />
 - Dialer::GetConnectedState<br />
 - InstallOptions::dialog<br />
 - InstallOptions::initDialog<br />
 - InstallOptions::show<br />
 - LangDLL::LangDialog<br />
 - Math::Script<br />
 - NSISdl::download<br />
 - NSISdl::download_quiet<br />
 - Splash::show<br />
 - StartMenu::Init<br />
 - StartMenu::Select<br />
 - StartMenu::Show<br />
 - System::Alloc<br />
 - System::Call<br />
 - System::Copy<br />
 - System::Free<br />
 - System::Get<br />
 - System::Int64Op<br />
 - System::Store<br />
 - TypeLib::GetLibVersion<br />
 - TypeLib::Register<br />
 - TypeLib::UnRegister<br />
 - UserInfo::GetAccountType<br />
 - UserInfo::GetName<br />
 - VPatch::vpatchfile<br />
 - nsExec::Exec<br />
 - nsExec::ExecToLog<br />
 - nsExec::ExecToStack<br />
<br />
!define: &quot;MUI_INSERT_NSISCONF&quot;=&quot;&quot;<br />
<br />
Changing directory to: &quot;D:\Dexta\Internet Code\crak\balance sheet&quot;<br />
<br />
Processing script file: &quot;D:\Dexta\Internet Code\crak\balance sheet\Net Sample.nsi&quot;<br />
!define: &quot;MUI_PRODUCT&quot;=&quot;ADO Total Show Beta Ver. 1.0.0&quot;<br />
!define: &quot;MUI_FILE&quot;=&quot;ADOTotalShow&quot;<br />
!define: &quot;MUI_VERSION&quot;=&quot;&quot;<br />
!define: &quot;MUI_BRANDINGTEXT&quot;=&quot;ADO Total Show Beta Ver. 1.0.0&quot;<br />
!include: &quot;C:\PROGRAM FILES\NSIS\Contrib\Modern UI\System.nsh&quot;<br />
NSIS Modern User Interface version 1.74 - © 2002-2006 Joost Verburg (C:\PROGRAM FILES\NSIS\Contrib\Modern UI\System.nsh:11)<br />
!define: &quot;MUI_VERBOSE&quot;=&quot;3&quot;<br />
!include: closed: &quot;C:\PROGRAM FILES\NSIS\Contrib\Modern UI\System.nsh&quot;<br />
!include: &quot;C:\PROGRAM FILES\NSIS\Include\Library.nsh&quot;<br />
!define: &quot;LIB_INCLUDED&quot;=&quot;&quot;<br />
!define: &quot;SHCNE_ASSOCCHANGED&quot;=&quot;0x08000000&quot;<br />
!define: &quot;SHCNF_IDLIST&quot;=&quot;0x0000&quot;<br />
!include: closed: &quot;C:\PROGRAM FILES\NSIS\Include\Library.nsh&quot;<br />
OutFile: &quot;ADOTotalsShow.exe&quot;<br />
ShowInstDetails: nevershow<br />
ShowUninstDetails: nevershow<br />
!define: &quot;MUI_ICON&quot;=&quot;modern-install-blue.ico&quot;<br />
!define: &quot;MUI_UNICON&quot;=&quot;modern-uninstall-colorful.ico&quot;<br />
!define: &quot;MUI_SPECIALBITMAP&quot;=&quot;nsis.bmp&quot;<br />
InstallDir: &quot;$PROGRAMFILES\ADO Total Show Beta Ver. 1.0.0&quot;<br />
!define: &quot;MUI_WELCOMEPAGE&quot;=&quot;&quot;<br />
!define: &quot;MUI_DIRECTORYPAGE&quot;=&quot;&quot;<br />
!define: &quot;MUI_ABORTWARNING&quot;=&quot;&quot;<br />
!define: &quot;MUI_UNINSTALLER&quot;=&quot;&quot;<br />
!define: &quot;MUI_UNCONFIRMPAGE&quot;=&quot;&quot;<br />
!define: &quot;MUI_FINISHPAGE&quot;=&quot;&quot;<br />
Section: &quot;install&quot;<br />
SetOutPath: &quot;$INSTDIR&quot;<br />
!insertmacro: InstallLib<br />
warning: unknown variable/constant &quot;ALREADY_INSTALLED&quot; detected, ignoring (macro:InstallLib:49)<br />
!insertmacro: macro &quot;__InstallLib_Helper_GetVersion&quot; requires 2 parameter(s), passed 3!<br />
Error in macro InstallLib on macroline 86<br />
Error in script &quot;D:\Dexta\Internet Code\crak\balance sheet\Net Sample.nsi&quot; on line 79 -- aborting creation process<br />
 <br />
Attached is the script</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mr Inches</div><div class="date">2nd February 2006, 12:18</div></div><div class="posttext">OK - the problem on line 79 of your script is that you are using the variable ALREADY_INSTALLED for the &quot;shared&quot; parameter of the InstallLib, but you haven't declared it anywhere nor assigned it a value (I think InstallLib expects a value of 'NOTSHARED' or any other value. If any another value is specifed, it will query the share/installed count of the library held in the registry - if this is wrong, someone else correct me here, I haven't used InstalledLib, I am doing this from inspection of the NSIS include file.)<br />
<br />
There is a further error on line 86 of the macro, this is because the backslash in the first library filename is outside the double quotes. (\&quot;msvbvm60.dll&quot; should be &quot;\msvbvm60.dll&quot;). This is on line 79 of your script too.<br />
<br />
Hope that helps.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jzdexta</div><div class="date">2nd February 2006, 13:22</div></div><div class="posttext">Thanx for the help.<br />
Have succesfully compiled the application though the're 2 errors relating to MUI_Temp1 and MUI_Temp2 whats this?<br />
<br />
While installing the compiled application the directory page didnt appear so im wondering what did i do wrong and what should i do to display the directory page (Please find the attached nsi file)<br />
<br />
Was also trying to add an icon to the installer instead of the default winamp like icon and it failed how do i create it?<br />
<br />
The script is differnt from the other posted scripts</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mr Inches</div><div class="date">2nd February 2006, 14:29</div></div><div class="posttext">I have been through the attached script and fixed up (most) of the problems. Amendments are in the attached script. (I commented out the erroneous lines and tried to add an explanation to each one.). You should read the Modern UI doco if you want to configure the interface further.<br />
<br />
The MUI_TEMP1 and MUI_TEMP2 warnings result from you not managing to display any of the MUI pages; now the script will do that, those should be toast.<br />
<br />
I fixed up a number of other things so the script would compile on my computer, which I am glad to say it does. I even ran it and it seems to park stuff in the designated places. Didn't check the uninstall though, but it looks reasonable.<br />
<br />
One thing to note, ensure that your code to set ALREADY_INSTALLED doesn't just set it to a non-zero value; as per my previous post, I think InstallLib is looking for a string containing &quot;NOTSHARED&quot; or another string value e.g. &quot;SHARED&quot;, indicating it should update the registry with the additional &quot;install&quot; of the libraries.<br />
<br />
You may have also have to register some or all of the libraries once you have copied them onto the target computer e.g regsvr32 &lt;blah.ocx&gt; or similar. The uninstall may have to unregister and offer to delete them (if it thinks it is the last application using them).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mr Inches</div><div class="date">2nd February 2006, 14:37</div></div><div class="posttext">Caveat to my last post - I left the InstallLib lines commented out - they don't need to be - I just don't have the libraries on my computer and they stopped the compile from working. Oops.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jzdexta</div><div class="date">2nd February 2006, 15:16</div></div><div class="posttext">The below output is what is generated after working as advised by Mr Inches.<br />
Have uncommented the areas relevant to the application im compiling.<br />
<br />
MakeNSIS v2.14 - Copyright 1999-2006 Nullsoft, Inc.<br />
<br />
Portions Copyright (C) 1995-1998 Jean-loup Gailly and Mark Adler (zlib).<br />
Portions Copyright (C) 1996-2002 Julian R Seward (bzip2).<br />
Portions Copyright (C) 1999-2003 Igor Pavlov (lzma).<br />
<br />
Contributors: nnop@newmail.ru, Ryan Geiss, Andras Varga, Drew Davidson, Peter Windridge, Dave Laundon, Robert Rainwater, Yaroslav Faybishenko, Jeff Doozan, Amir Szekely, Ximon Eighteen, et al.<br />
<br />
Processing config: <br />
Processing plugin dlls: &quot;C:\PROGRAM FILES\NSIS\Plugins\*.dll&quot;<br />
 - AdvSplash::show<br />
 - Banner::destroy<br />
 - Banner::getWindow<br />
 - Banner::show<br />
 - BgImage::AddImage<br />
 - BgImage::AddText<br />
 - BgImage::Clear<br />
 - BgImage::Destroy<br />
 - BgImage::Redraw<br />
 - BgImage::SetBg<br />
 - BgImage::SetReturn<br />
 - BgImage::Sound<br />
 - Dialer::AttemptConnect<br />
 - Dialer::AutodialHangup<br />
 - Dialer::AutodialOnline<br />
 - Dialer::AutodialUnattended<br />
 - Dialer::GetConnectedState<br />
 - InstallOptions::dialog<br />
 - InstallOptions::initDialog<br />
 - InstallOptions::show<br />
 - LangDLL::LangDialog<br />
 - Math::Script<br />
 - NSISdl::download<br />
 - NSISdl::download_quiet<br />
 - Splash::show<br />
 - StartMenu::Init<br />
 - StartMenu::Select<br />
 - StartMenu::Show<br />
 - System::Alloc<br />
 - System::Call<br />
 - System::Copy<br />
 - System::Free<br />
 - System::Get<br />
 - System::Int64Op<br />
 - System::Store<br />
 - TypeLib::GetLibVersion<br />
 - TypeLib::Register<br />
 - TypeLib::UnRegister<br />
 - UserInfo::GetAccountType<br />
 - UserInfo::GetName<br />
 - VPatch::vpatchfile<br />
 - nsExec::Exec<br />
 - nsExec::ExecToLog<br />
 - nsExec::ExecToStack<br />
<br />
!define: &quot;MUI_INSERT_NSISCONF&quot;=&quot;&quot;<br />
<br />
Changing directory to: &quot;D:\Dexta\Internet Code\crak\balance sheet&quot;<br />
<br />
Processing script file: &quot;D:\Dexta\Internet Code\crak\balance sheet\net sample-mi.nsi&quot;<br />
!define: &quot;MUI_PROUCT&quot;=&quot;ADO Total Show Beta Ver. 1.0.0&quot;<br />
!define: &quot;PRODUCT&quot;=&quot;ADOTotalsShow&quot;<br />
!define: &quot;MUI_VERSION&quot;=&quot;&quot;<br />
!define: &quot;MUI_BRANDINGTEXT&quot;=&quot;ADO Total Show Beta Ver. 1.0.0&quot;<br />
CRCCheck: On<br />
!include: &quot;C:\PROGRAM FILES\NSIS\Include\Library.nsh&quot;<br />
!define: &quot;LIB_INCLUDED&quot;=&quot;&quot;<br />
!define: &quot;SHCNE_ASSOCCHANGED&quot;=&quot;0x08000000&quot;<br />
!define: &quot;SHCNF_IDLIST&quot;=&quot;0x0000&quot;<br />
!include: closed: &quot;C:\PROGRAM FILES\NSIS\Include\Library.nsh&quot;<br />
!include: &quot;C:\PROGRAM FILES\NSIS\Include\MUI.nsh&quot;<br />
!include: &quot;C:\PROGRAM FILES\NSIS\Contrib\Modern UI\System.nsh&quot;<br />
NSIS Modern User Interface version 1.74 - © 2002-2006 Joost Verburg (C:\PROGRAM FILES\NSIS\Contrib\Modern UI\System.nsh:11)<br />
!define: &quot;MUI_VERBOSE&quot;=&quot;3&quot;<br />
!include: closed: &quot;C:\PROGRAM FILES\NSIS\Contrib\Modern UI\System.nsh&quot;<br />
!include: closed: &quot;C:\PROGRAM FILES\NSIS\Include\MUI.nsh&quot;<br />
OutFile: &quot;ATS Setup.exe&quot;<br />
ShowInstDetails: show<br />
ShowUninstDetails: nevershow<br />
SetCompressor: bzip2<br />
!define: &quot;MUI_ICON&quot;=&quot;C:\PROGRAM FILES\NSIS\Contrib\Graphics\icons\modern-install-blue.ico&quot;<br />
!define: &quot;MUI_UNICON&quot;=&quot;C:\PROGRAM FILES\NSIS\Contrib\Graphics\icons\modern-uninstall-blue.ico&quot;<br />
!define: &quot;MUI_SPECIALBITMAP&quot;=&quot;nsis.ico&quot;<br />
Var: &quot;ALREADY_INSTALLED&quot;<br />
InstallDir: &quot;$PROGRAMFILES\ADOTotalsShow&quot;<br />
!define: &quot;MUI_PAGE_ABORTWARNING&quot;=&quot;&quot;<br />
!insertmacro: MUI_PAGE_WELCOME<br />
!insertmacro: end of MUI_PAGE_WELCOME<br />
!insertmacro: MUI_PAGE_DIRECTORY<br />
!insertmacro: end of MUI_PAGE_DIRECTORY<br />
!insertmacro: MUI_PAGE_INSTFILES<br />
!insertmacro: end of MUI_PAGE_INSTFILES<br />
!insertmacro: MUI_PAGE_FINISH<br />
!insertmacro: end of MUI_PAGE_FINISH<br />
!insertmacro: MUI_UNPAGE_WELCOME<br />
!insertmacro: end of MUI_UNPAGE_WELCOME<br />
!insertmacro: MUI_UNPAGE_CONFIRM<br />
!insertmacro: end of MUI_UNPAGE_CONFIRM<br />
!insertmacro: MUI_UNPAGE_INSTFILES<br />
!insertmacro: end of MUI_UNPAGE_INSTFILES<br />
!insertmacro: MUI_UNPAGE_FINISH<br />
!insertmacro: end of MUI_UNPAGE_FINISH<br />
!insertmacro: MUI_LANGUAGE<br />
warning: !warning: The MUI_PRODUCT and MUI_VERSION defines have been removed. Use a normal Name command now. (macro:MUI_INSERT:3)<br />
!insertmacro: end of MUI_LANGUAGE<br />
Section: &quot;-Install VB6 runtimes&quot;<br />
SetOutPath: &quot;$INSTDIR&quot;<br />
IfFileExists: &quot;$INSTDIR\ADOTotalsShow.exe&quot; ? 0 : new_installation<br />
StrCpy $ALREADY_INSTALLED &quot;1&quot; () ()<br />
File: &quot;ADOTotalsShow.exe&quot; [compress] 22671/86016 bytes<br />
File: &quot;Parts.mdb&quot; [compress] 11667/143360 bytes<br />
!insertmacro: InstallLib<br />
!insertmacro: end of InstallLib<br />
!insertmacro: InstallLib<br />
!insertmacro: end of InstallLib<br />
!insertmacro: InstallLib<br />
!insertmacro: end of InstallLib<br />
!insertmacro: InstallLib<br />
!insertmacro: end of InstallLib<br />
!insertmacro: InstallLib<br />
!insertmacro: end of InstallLib<br />
!insertmacro: InstallLib<br />
!insertmacro: end of InstallLib<br />
!insertmacro: InstallLib<br />
!insertmacro: end of InstallLib<br />
!insertmacro: InstallLib<br />
!insertmacro: end of InstallLib<br />
CreateShortCut: &quot;$DESKTOP\ADOTotalsShow.lnk&quot;-&gt;&quot;$INSTDIR\ADOTotalsShow.exe&quot; nsis.ico icon:,0, showmode=0x0, hotkey=0x0, comment=<br />
CreateDirectory: &quot;$SMPROGRAMS\ADOTotalsShow&quot;<br />
CreateShortCut: &quot;$SMPROGRAMS\ADOTotalsShow\Uninstall.lnk&quot;-&gt;&quot;$INSTDIR\Uninstall.exe&quot; C:\PROGRAM FILES\NSIS\Contrib\Graphics\icons\modern-uninstall-blue.ico icon:$INSTDIR\Uninstall.exe,0, showmode=0x0, hotkey=0x0, comment=<br />
CreateShortCut: &quot;$SMPROGRAMS\ADOTotalsShow\ADOTotalsShow.lnk&quot;-&gt;&quot;$INSTDIR\ADOTotalsShow.exe&quot; nsis.ico icon:$INSTDIR\ADOTotalsShow.exe,0, showmode=0x0, hotkey=0x0, comment=<br />
WriteRegStr: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\ADOTotalsShow\DisplayName=ADOTotalsShow (remove only)<br />
WriteRegStr: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\ADOTotalsShow\UninstallString=$INSTDIR\Uninstall.exe<br />
WriteUninstaller: &quot;$INSTDIR\Uninstall.exe&quot;<br />
SectionEnd<br />
Section: &quot;-un.Uninstall VB6 runtimes&quot;<br />
!insertmacro: UnInstallLib<br />
!insertmacro: end of UnInstallLib<br />
!insertmacro: UnInstallLib<br />
!insertmacro: end of UnInstallLib<br />
!insertmacro: UnInstallLib<br />
!insertmacro: end of UnInstallLib<br />
!insertmacro: UnInstallLib<br />
!insertmacro: end of UnInstallLib<br />
!insertmacro: UnInstallLib<br />
!insertmacro: end of UnInstallLib<br />
!insertmacro: UnInstallLib<br />
!insertmacro: end of UnInstallLib<br />
!insertmacro: UninstallLib<br />
!insertmacro: end of UninstallLib<br />
!insertmacro: UninstallLib<br />
!insertmacro: end of UninstallLib<br />
RMDir: /r &quot;$INSTDIR\*.*&quot;<br />
RMDir: &quot;$INSTDIR&quot;<br />
Delete: &quot;$DESKTOP\ADOTotalsShow.lnk&quot;<br />
Delete: &quot;$SMPROGRAMS\ADOTotalsShow\*.*&quot;<br />
RMDir: &quot;$SMPROGRAMS\ADOTotalsShow&quot;<br />
DeleteRegKey: HKEY_LOCAL_MACHINE\SOFTWARE\ADOTotalsShow<br />
DeleteRegKey: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\ADOTotalsShow<br />
SectionEnd<br />
<br />
Processed 1 file, writing output:<br />
Adding plug-ins initializing function... Done!<br />
Processing pages... Done!<br />
Removing unused resources... Done!<br />
Generating language tables... Done!<br />
Generating uninstaller... Done!<br />
<br />
Output: &quot;D:\Dexta\Internet Code\crak\balance sheet\ATS Setup.exe&quot;<br />
Install: 5 pages (320 bytes), 1 section (1048 bytes), 986 instructions (27608 bytes), 191 strings (3365 bytes), 1 language table (302 bytes).<br />
Uninstall: 5 pages (320 bytes), <br />
1 section (1048 bytes), 322 instructions (9016 bytes), 140 strings (2389 bytes), 1 language table (290 bytes).<br />
Datablock optimizer saved 34709 bytes (~2.4%).<br />
<br />
Using bzip2 compression.<br />
<br />
EXE header size:               46592 / 34304 bytes<br />
Install code:                   4584 / 33007 bytes<br />
Install data:                1326362 / 3045905 bytes<br />
Uninstall code+data:           22677 / 26790 bytes<br />
CRC (0xEAC8D4E1):                  4 / 4 bytes<br />
<br />
Total size:                  1400219 / 3140010 bytes (44.6%)<br />
<br />
1 warning:<br />
  !warning: The MUI_PRODUCT and MUI_VERSION defines have been removed. Use a normal Name command now. (macro:MUI_INSERT:3)<br />
<br />
Why does it generate this error despite it completes compilation and giving the setup program.<br />
How do I now change the page titles to reflect the appliction being compilied?<br />
<br />
im still in the pit !!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jzdexta</div><div class="date">2nd February 2006, 17:41</div></div><div class="posttext">Have actually downloaded vb6sp6 so as to update my runtime files and wanted to have the same done to all machines i install my application instead of having all dlls and ocx files being bundled together with my application.<br />
What i want to know is how do make the file run before executing the rest of the commands as in installing my application?<br />
I do anticipate that the same applies if happen to include mdac_types 2.8 or any other executable file that has to be run before completing the installation of my application.<br />
Can someone ples3e help me;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mr Inches</div><div class="date">2nd February 2006, 21:40</div></div><div class="posttext">The warnings are being generated because the items you are setting (MUI_PRODUCT and MUI_FILE) are deprecated (discouraged from being used usually because they have replaced with something else). As I noted in my comments, use something like:<br />
<br />
!define PRODUCT &quot;ADOShow&quot;<br />
Name ${PRODUCT}<br />
!define APPFILE &quot;${PRODUCT}.exe&quot;<br />
<br />
and replace all occurences of MUI_PRODUCT with PRODUCT and MUI_FILE with APPFILE.<br />
<br />
As for the title on each page, assuming you do the above, you could use something like:<br />
Caption &quot;${PRODUCT} Setup&quot; ;this duplicates the default caption.<br />
<br />
To install VBSP6, use ExecWait command to run the service pack installer in quiet mode. e.g.<br />
<br />
ExecWait &quot;VB6.0-KB290887-X86.exe&quot; &quot;/Q&quot;<br />
IfErrors FailedToInstallVBSP6<br />
ServicePackOK:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd February 2006, 11:30</div></div><div class="posttext">Please attach large scripts or compiler outputs next time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jzdexta</div><div class="date">3rd February 2006, 17:27</div></div><div class="posttext">Kichik <br />
If you culd have read from the top of this thread you could have found all the responses and areas that were really confusing i did provide the whole script unless its not showing on your browser.<br />
All the same thanks to everyone who has been participating in this thread that has really tought me so much.<br />
However something compels me to install the mdac setup file which if run in silent mode i almost doubt if it really installs, how would i be sure it really did?<br />
Any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd February 2006, 20:35</div></div><div class="posttext">You have pasted in 4 very long makensis.exe outputs. That's what I see first when I look at this thread. It makes the thread hard to follow. Please attach it next time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mr Inches</div><div class="date">5th February 2006, 01:29</div></div><div class="posttext">Re: MDAC installation.<br />
<br />
This should be the same as the VB Service Pack, just check for a non-zero exitcode on return. Most programs return an exit code of non-zero if they didn't work.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>