<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How do I choose which version of Microsoft Access database to install?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How do I choose which version of Microsoft Access database to install? NSIS Discussion" />
	
	<title> How do I choose which version of Microsoft Access database to install? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How do I choose which version of Microsoft Access database to install?</div>
<hr />
<div class="pda"><a href="t-134506.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=134506">How do I choose which version of Microsoft Access database to install?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">davidhop</div><div class="date">6th May 2003, 16:15</div></div><div class="posttext">I write stuff in Access VBA for Microsoft Office (some of us have to!)<br />
<br />
I can figure out from the registry which version of Access the user has installed, and then I want to choose which version of the database to install.<br />
<br />
In the language I'm familiar with, what I want to do is:<br />
<br />
AccessVer=CheckVersion<br />
<br />
SelectCase AccessVer<br />
Case 1<br />
   database97Install<br />
Case 2<br />
   database2000Install<br />
Case 3<br />
   databaseXPInstall<br />
Case else<br />
   msgbox &quot;Go away, you don't have Access installed&quot;<br />
End Select<br />
<br />
I've got the version from the registry into $4 which, with StrCmp I can use to generate messages, but how to I use this to get the installer to install different versions. <br />
<br />
Can anyone help - is that what this prefunc stuff is for? Probably very obvious, but I only just got into this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th May 2003, 17:12</div></div><div class="posttext">Get strcmp to target a definate place in the section, e.g.<br />
<br />
Section &quot;&quot;<br />
StrCmp $4 database97 database97Install<br />
StrCmp $4 database2000 database2000Install<br />
StrCmp $4 databaseXP databaseXPInstall<br />
Goto end<br />
database97Install:<br />
...Files to extract for database97 in here...<br />
Goto end<br />
database2000Install:<br />
...Files to extract for database2000 in here...<br />
Goto end<br />
databaseXPInstall:<br />
...Files to extract for databaseXP in here...<br />
end:<br />
SectionEnd<br />
<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">davidhop</div><div class="date">6th May 2003, 18:12</div></div><div class="posttext">I'm feeling particularly dim about this!:o <br />
<br />
What do I actually put in substitution for <br />
<br />
...Files to extract for database97 in here...<br />
<br />
I mean how do you write that?<br />
<br />
SetOutPath $INSTDIR<br />
File /r AuditorFiles97\*.*</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">6th May 2003, 18:38</div></div><div class="posttext">For example, if you want to extract a file called database.dat, use something like this:<br />
<br />
File /oname=database.dat 97.dat<br />
<br />
This will extract the file database.dat (with the data stored in 97.dat on your PC).<br />
<br />
If they don't need to have the same filename, you don't have to use /oname=?.<br />
<br />
If you put 'em in the same directory, you only have to use SetOutPath once, before the version check.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">davidhop</div><div class="date">6th May 2003, 18:50</div></div><div class="posttext">Thanks for that Joost (and Stu) - will give it a hack.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dajvid</div><div class="date">12th May 2003, 05:05</div></div><div class="posttext">Hi David,<br />
<br />
I'm wondering whether you can post your code to detect what version of Access is installed on the computer. I'm having varying amounts of success trying to write the code myself.<br />
<br />
Thanks,<br />
Dave.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">davidhop</div><div class="date">12th May 2003, 11:32</div></div><div class="posttext">Will certainly post code when it is done - but just blew up my app with a new 'feature' so got diverted from install routine!<br />
<br />
(and just seem to have unsubscribed myself from this thread - the screen said - so hope this is logged!)<br />
<br />
If you want where I have got to so far, post back, but I have to have something clean by Thursday anyway, so I'll put the finished code up then.<br />
<br />
So far as I can see the key is this<br />
EnumRegKey $R0 HKEY_LOCAL_MACHINE &quot;Software\Microsoft\Office\8.0\Access&quot; 0<br />
StrCmp $R0 &quot;&quot; not8 got8<br />
<br />
if you run this for 8=97, 9=2000 and 10=XP you know what is installed (according to the Registry anyway) and can then decide what to install (or nothing if no Access is found).<br />
<br />
XP seems to run 2000 stuff no probs. but I have to use different mde for 97.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th May 2003, 12:43</div></div><div class="posttext">This (http://nsis.sourceforge.net/archive/nsisweb.php?page=113&amp;instances=0,11) Archive directory might help too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">davidhop</div><div class="date">12th May 2003, 19:46</div></div><div class="posttext">TQ - that's a useful ref.<br />
<br />
First item on the list gets you the install path for Access - and being blinkered by a deadline right now I forgot about all the other stuff that lies buried below the reg key!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dajvid</div><div class="date">15th May 2003, 04:50</div></div><div class="posttext">Thanks for the reference Kichik - I was looking in the &quot;How to detect if ... is installed&quot; instead, which didn't have any relevant scripts.<br />
<br />
David, I can confirm for you that, as you suspected, Access XP is able to run Access 2000 files without conversion, however Access 97 needs Access 97 files. Hope you meet your deadline!<br />
<br />
Ta,<br />
Dave.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">davidhop</div><div class="date">16th May 2003, 13:24</div></div><div class="posttext">As promised here is the script that I used to install the right version of an Access App. I'm sure it could be more elegant - but it worked and if I'll stick up the next version if I get there.<br />
<br />
One odd thing I couldn't get round was that when I wrote a version with different components, I couldn't figure out how to fix the filesize being reported in the relevant section. With either of two files to be installed (conditional of Access version) the component dialog reported the install filesize as being the sum of both.<br />
<br />
A small thing to be hacked around later.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>