<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" React on on Custom page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  React on on Custom page NSIS Discussion" />
	
	<title> React on on Custom page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  React on on Custom page</div>
<hr />
<div class="pda"><a href="t-295852.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=295852">React on on Custom page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">monti0505</div><div class="date">12th August 2008, 17:39</div></div><div class="posttext">Hello,<br />
<br />
I created a custom page which looks like that:<br />
<br />
<br />
; Ini file generated by the HM NIS Edit IO designer.<br />
[Settings]<br />
NumFields=6<br />
<br />
[Field 1]<br />
Type=Groupbox<br />
Text=Licence<br />
Left=16<br />
Right=227<br />
Top=3<br />
Bottom=78<br />
<br />
[Field 2]<br />
Type=RadioButton<br />
Text=Demo<br />
Left=26<br />
Right=102<br />
Top=32<br />
Bottom=42<br />
<br />
[Field 3]<br />
Type=RadioButton<br />
Text=Single<br />
Left=26<br />
Right=102<br />
Top=46<br />
Bottom=57<br />
<br />
[Field 4]<br />
Type=Text<br />
Left=72<br />
Right=202<br />
Top=60<br />
Bottom=73<br />
<br />
[Field 5]<br />
Type=Label<br />
Text=Lizenzcode:<br />
Left=26<br />
Right=70<br />
Top=62<br />
Bottom=70<br />
<br />
[Field 6]<br />
Type=RadioButton<br />
Text=Floating<br />
Left=26<br />
Right=102<br />
Top=17<br />
Bottom=27<br />
<br />
<br />
<br />
<br />
In my Installer I want that the textfield is only enabled wenn the Radiobutton with Single is clicked.<br />
<br />
I tried to change color for test purposes but nothing happend:<br />
<br />
<br />
!include LogicLib.nsh<br />
Page custom licInfoDlg  MyCustomLeave<br />
<br />
<br />
Function MyCustomLeave<br />
  # Get control window handle.<br />
  !insertmacro INSTALLOPTIONS_READ $R0 &quot;licInfoDlg.ini&quot; &quot;Field 1&quot; &quot;HWND&quot;<br />
  # Check if text has been entered in field 1.<br />
  !insertmacro INSTALLOPTIONS_READ $R1 &quot;licInfoDlg.ini&quot; &quot;Field 4&quot; &quot;State&quot;<br />
  # Make field background red!<br />
  ${If} $R1 == &quot;&quot;<br />
    SetCtlColors $R1 0x000000 0xFF0000<br />
    Abort # Go back to page.<br />
  # Reset field colours.<br />
  ${Else}<br />
    SetCtlColors $R1 0x000000 0xFFFFFF<br />
  ${EndIf}<br />
FunctionEnd<br />
<br />
<br />
This is of course not the whole code but the main for the Custom Page.<br />
How can I implement that the textfield becomes enabled or disabled when a special Radio button is clicked?<br />
<br />
I looked for a tutorial but the one on NSIS Page did not help me.<br />
<br />
I hope you can give me an Idea or or a code snippet how to make the script work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">12th August 2008, 17:59</div></div><div class="posttext">You need to add the notify flag to the radio buttons and then create a callback function to enable/disable the text field.<br />
<br />
A good example included with NSIS:<br />
${NSISDIR}\Examples\InstallOptions\testnotify.nsi</div></div><hr />


<div class="post"><div class="posttop"><div class="username">monti0505</div><div class="date">13th August 2008, 08:59</div></div><div class="posttext">Thank you for the tipp. Its a good example script.<br />
<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">monti0505</div><div class="date">14th August 2008, 11:58</div></div><div class="posttext">Hi all, <br />
<br />
i changed my script to as it is done in the example script. <br />
But the textfield 4 still is not disabled when another radiobutton than the Radiobutton 3 is clicked.<br />
<br />
I want to become the field disabled when NOT radiobutton 3 is clicked.<br />
<br />
Can someone tell me why it does not function? I do not found the failure. The script can be compiled. So there can not be an syntax error or somethink like that.<br />
<br />
Here you can see the code:<br />
<br />
<br />
; Ini file generated by the HM NIS Edit IO designer.<br />
[Settings]<br />
NumFields=6<br />
<br />
[Field 1]<br />
Type=Groupbox<br />
Text=Licence<br />
Left=16<br />
Right=227<br />
Top=3<br />
Bottom=78<br />
<br />
[Field 2]<br />
Type=RadioButton<br />
Text=Demo<br />
Left=26<br />
Right=102<br />
Top=32<br />
Bottom=41<br />
Flags=NOTIFY<br />
<br />
[Field 3]<br />
Type=RadioButton<br />
Text=Single<br />
Left=26<br />
Right=102<br />
Top=46<br />
Bottom=57<br />
Flags=NOTIFY<br />
State=1<br />
<br />
[Field 4]<br />
Type=Text<br />
Left=72<br />
Right=202<br />
Top=60<br />
Bottom=73<br />
Flags=<br />
<br />
[Field 5]<br />
Type=Label<br />
Text=Lizenzcode:<br />
Left=26<br />
Right=70<br />
Top=62<br />
Bottom=70<br />
<br />
[Field 6]<br />
Type=RadioButton<br />
Text=Floating<br />
Left=26<br />
Right=102<br />
Top=17<br />
Bottom=27<br />
Flags=NOTIFY<br />
<br />
<br />
<br />
<br />
<br />
The part of the script where the field should be disabled:<br />
<br />
Page custom licInfoDlg  MyCustomLeave<br />
<br />
Function MyCustomLeave<br />
  # Get control window handle.<br />
  ReadINIStr $0 &quot;licinfodlg.ini&quot; &quot;Settings&quot; &quot;State&quot;<br />
  StrCmp $0 3 Single  ; <br />
  <br />
  <br />
  Single:<br />
  ReadINIStr $0 &quot;licinfodlg.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
  ReadINIStr $1 &quot;licinfodlg.ini&quot; &quot;Field 4&quot; &quot;HWND&quot;<br />
  EnableWindow $1 $0<br />
  ReadINIStr $1 &quot;licinfodlg.ini&quot; &quot;Field 4&quot; &quot;HWND2&quot;<br />
  EnableWindow $1 $0<br />
  <br />
   StrCmp $0 0 0 +3<br />
<br />
     WriteINIStr &quot;licinfodlg.ini&quot; &quot;Field 4&quot; &quot;Flags&quot; &quot;DISABLED&quot;<br />
     Goto +2<br />
<br />
     WriteINIStr &quot;licinfodlg.ini&quot; &quot;Field 4&quot; &quot;Flags&quot; &quot;&quot;<br />
     Abort<br />
  <br />
  <br />
FunctionEnd<br />
<br />
<br />
<br />
I hope someone can help me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">monti0505</div><div class="date">14th August 2008, 13:03</div></div><div class="posttext">Hello all,<br />
<br />
i modified the code a little bit to test what the cause could be:<br />
<br />
<br />
Function MyCustomLeave<br />
  # Get control window handle.<br />
  ReadINIStr $0 &quot;licinfodlg.ini&quot; &quot;Settings&quot; &quot;State&quot;<br />
  StrCmp $0 0 done  ; Next button?<br />
  StrCmp $0 3 Single  ; &quot;Install support for X&quot;?<br />
  <br />
  <br />
  Single:<br />
  ReadINIStr $0 &quot;licinfodlg.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
  ReadINIStr $1 &quot;licinfodlg.ini&quot; &quot;Field 4&quot; &quot;HWND&quot;<br />
  EnableWindow $1 $0<br />
  ReadINIStr $1 &quot;licinfodlg.ini&quot; &quot;Field 4&quot; &quot;HWND2&quot;<br />
  EnableWindow $1 $0<br />
  <br />
   StrCmp $0 0 +2<br />
  <br />
         MessageBox MB_ICONEXCLAMATION|MB_OK &quot;You must select at least one install option!&quot; ;WriteINIStr &quot;licinfodlg.ini&quot; &quot;Field 4&quot; &quot;Flags&quot; &quot;DISABLED&quot;<br />
      Abort ;Goto +2<br />
      <br />
     ;WriteINIStr &quot;licinfodlg.ini&quot; &quot;Field 4&quot; &quot;Flags&quot; &quot;&quot;<br />
     Abort<br />
  <br />
  done:<br />
 <br />
  <br />
FunctionEnd<br />
<br />
In this case the MessageBox appears<br />
<br />
But when I replace the &quot; MessageBox MB_ICONEXCLAMATION|MB_OK &quot;You must select at least one install option!&quot;<br />
<br />
with<br />
<br />
&quot;WriteINIStr &quot;licinfodlg.ini&quot; &quot;Field 4&quot; &quot;Flags&quot; &quot;DISABLED&quot; &quot;<br />
<br />
the field4 is still enabled. What does I have to do to disable the fierld4 when on radiobutton Single is clicked???</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">14th August 2008, 20:29</div></div><div class="posttext">EnableWindow should have 2 paramaters:  The first is the HWND of the control, the 2nd is a one (1) or zero (0).<br />
<br />
Setting the flags is good only for when returning to the page (like if the user goes back, it will remember the state).<br />
<br />
Also, use include LogicLib.nsh to make things easier.<br />
<br />
Have a look at the attached.  (I didn't test, so hopefully, I got it right.  But there should be enough comments for you to understand.)<br />
<br />
EDIT:  Since you already had a radio button with the state set, there would never be a situation in which no selection was made.  But, I did add a check to verify that if the 3rd option was checked, it must have something in the box before proceeding.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">monti0505</div><div class="date">15th August 2008, 09:10</div></div><div class="posttext">Hi!<br />
<br />
Thank you for the example script. <br />
<br />
I have done this now (its not the whole script):<br />
<br />
<br />
   !insertmacro INSTALLOPTIONS_READ $R1 &quot;licInfoDlg.ini&quot; &quot;Settings&quot; &quot;State&quot;<br />
   ReadINIStr $2 &quot;licinfodlg.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
<br />
${If} $1 != 0<br />
  ReadINIStr $3 &quot;licinfodlg.ini&quot; &quot;Field 4&quot; &quot;HWND&quot;<br />
<br />
    ${If} $2 = 1<br />
      ; radio button selected so enable the field<br />
       MessageBox MB_OK &quot;radio button selected so enable the field&quot;<br />
      WriteINIStr &quot;licinfodlg.ini&quot; &quot;Field 4&quot; &quot;Flags&quot; &quot;&quot;<br />
      EnableWindow $3 1<br />
    ${Else}<br />
      ; not selected, so disable field<br />
        MessageBox MB_OK &quot; ; not selected, so disable field&quot;<br />
      WriteINIStr &quot;licinfodlg.ini&quot; &quot;Field 4&quot; &quot;Flags&quot; &quot;DISABLED&quot;<br />
      EnableWindow $3 0<br />
    ${EndIf}<br />
<br />
<br />
But all the time the message  &quot;&quot; ; not selected, so disable field&quot; appears. It means it goes into the ELSE whatever radiobutton I click.<br />
I enabled the NOTIFY flag for all radio buttons but nothing changed.<br />
Any idea?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th August 2008, 11:58</div></div><div class="posttext">Use !insertmacro INSTALLOPTIONS_READ/WRITE, not Read/WriteINIStr. You have already done so with the first line!?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">16th August 2008, 02:41</div></div><div class="posttext">Just to elaborate a bit:<br />
<br />
The main difference between using the INSTALLOPTIONS_READ/Write macros and the normal Read/WriteIniStr function are that the read/write macros will read the files from $PLUGINSDIR.  Calling like you did will read the INI from whatever the current working directory is (which in your case is probably the same directory that your compiled EXE lives in), which is often NOT the directory that gets used by pages during runtime.<br />
<br />
I often just use the normal Read/WriteIniStr functions, but I can see how this may be confusing to others.  Afrow's suggestion of using the InstallOptions_Read/Write macros for all page functions leaves less room for error (and should have been my first suggestion.)  Sorry for the confusion.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">monti0505</div><div class="date">17th August 2008, 17:39</div></div><div class="posttext">Originally posted by Comperio <br />
Just to elaborate a bit:<br />
<br />
The main difference between using the INSTALLOPTIONS_READ/Write macros and the normal Read/WriteIniStr function are that the read/write macros will read the files from $PLUGINSDIR.   <br />
<br />
Hi, <br />
<br />
but I never deploy the $PLUGINSDIR but only the executable file which is compiled from the nsis script. <br />
How can then the INSTALLOPTIONS_READ/Write macros work?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ZmAn3</div><div class="date">18th August 2008, 00:27</div></div><div class="posttext">thank you so much that seems to be working great any idea on the start in folder part of the shortcuts properties?<br />
<br />
thanks again<br />
<br />
sorry posted in wrong place :/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">18th August 2008, 13:12</div></div><div class="posttext">You are supposed to extract your INI file using the INSTALLOPTIONS_EXTRACT macro then those macros will work. It is all described in the InstallOptions readme.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>