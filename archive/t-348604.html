<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Home directory when escalating privileges, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Home directory when escalating privileges NSIS Discussion" />
	
	<title> Home directory when escalating privileges [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Home directory when escalating privileges</div>
<hr />
<div class="pda"><a href="t-348604.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=348604">Home directory when escalating privileges</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bitonic</div><div class="date">17th September 2012, 15:17</div></div><div class="posttext">Hi,<br />
<br />
I have a problem: if an user runs an installer as a guest it'll ask for the admin password and gain privileges.  The problem is that then $HOMEDRIVE and $HOMEPATH will return the information relative to the admin, not the original user.<br />
<br />
How can I get around this?<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">17th September 2012, 17:10</div></div><div class="posttext">The proper way to do this consists of two steps:<br />
In the installer:<br />
- Copy the required files to all user appdata ($LOCALAPPDATA after setshellvarcontext all)<br />
In your application:<br />
- Copy the files from alluser appdata to the applicable currentuser directory when the application is run for the first time at userlevel.<br />
<br />
On a tangential note: Why do you want the contents of $HOMEPATH? You're not supposed to write to hardcoded paths like $HOMEPATH\foo\bar. You should write to appdata instead.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bitonic</div><div class="date">18th September 2012, 08:56</div></div><div class="posttext">The proper way to do this consists of two steps:<br />
In the installer:<br />
- Copy the required files to all user appdata ($LOCALAPPDATA after setshellvarcontext all)<br />
In your application:<br />
- Copy the files from alluser appdata to the applicable currentuser directory when the application is run for the first time at userlevel.<br />
Uhm, I'd prefer to avoid that - introducing logic in the application for something that should be taken care of in the installer is kind of ugly.  Is there any other way?<br />
<br />
<br />
On a tangential note: Why do you want the contents of $HOMEPATH? You're not supposed to write to hardcoded paths like $HOMEPATH\foo\bar. You should write to appdata instead.<br />
This doesn't really depend on us, we're writing an Erlang application and the cookie has to be put in the home dir.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">18th September 2012, 09:45</div></div><div class="posttext">The other solution is to install without elevation to somewhere in the users profile ($localappdata\programs) and write the registry details to HKCU. (Single user aka &quot;Just Me&quot; install)<br />
<br />
The reason you should install the initial application state to the all users profile or programfiles and copy it out on first run is because the basic scheme of storing it directly in the users profile during install breaks down when another user on the same machine tries to run the application, they will not get any state since they cannot (and should not) access the &quot;first&quot; users profile.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>