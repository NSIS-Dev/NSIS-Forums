<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Error when Extracting NSIS-Compressed Files, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Error when Extracting NSIS-Compressed Files NSIS Discussion" />
	
	<title> Error when Extracting NSIS-Compressed Files [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Error when Extracting NSIS-Compressed Files</div>
<hr />
<div class="pda"><a href="t-191820.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=191820">Error when Extracting NSIS-Compressed Files</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">rpgfan</div><div class="date">29th August 2004, 23:17</div></div><div class="posttext">I am trying to use NSIS to distribute a mod that I made.  Everything compiles properly, but whenever I test the installer, I get the following error from the installer that was made by NSIS v2.0.<br />
<br />
<br />
Error opening file for writing:<br />
<br />
If I click &quot;Ignore&quot;, I get the same message for the next file in the archive.<br />
<br />
The error persists whether the original files are present in the installation directory or not, so it is not an overwriting issue.<br />
<br />
Any ideas that may help?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scully13</div><div class="date">30th August 2004, 16:42</div></div><div class="posttext">Make sure that if the file already exists it isn't in use or read-only. If that isn't it make sure you have enough free disk space. That's the only time I've run into that error message but I guess there could be other reasons.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rpgfan</div><div class="date">31st August 2004, 02:43</div></div><div class="posttext">The file is neither in use, nor is it Read Only.<br />
<br />
I've got more than 25GB available on my hard drive, so it is not a problem with that.<br />
<br />
I am not having problems extracting files that are in the root directory, only those that were in a folder during compression.  Do all the files need to be in the same location prior to compiling the install script to get things to work correctly?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">KrYpT</div><div class="date">31st August 2004, 05:19</div></div><div class="posttext">(A side note... I doubt compression's your problem.)<br />
<br />
I don't know if this matters, but it's possible you're not creating the folders before you fill them with files. Maybe it would help to use CreateDirectory?<br />
<br />
Is the path given by the error prompt accurate? I know I was confused the first time I tried the command &quot;File Sounds\Ding.wav&quot; and it ended up $OUTDIR instead of $OUTDIR\Sounds. Again, check if the folder exists.<br />
<br />
Hope that helps....<br />
<br />
Geoff</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scully13</div><div class="date">31st August 2004, 13:08</div></div><div class="posttext">All the files don't need to be in the same location prior to compiling the script. You'll be specifying a path in your File command where the file is coming from. Do something like what KrYpT said and use CreateDiretory or use SetOutPath like it is below to make sure the folder exists and to set the path it should go to. If that doesn't work put some message boxes in to show you what your $OUTDIR and/or $INSTDIR variable are before doing your copy.<br />
<br />
SetOutPath &quot;$INSTDIR\help&quot;<br />
File F:\companies\help\*.htm<br />
SetOutPath &quot;$INSTDIR\help\images&quot;<br />
File F:\companies\help\images\*.gif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rpgfan</div><div class="date">31st August 2004, 17:39</div></div><div class="posttext">I don't know if this matters, but it's possible you're not creating the folders before you fill them with files. Maybe it would help to use CreateDirectory?<br />
<br />
<br />
The folders do exist on my machine prior to putting files there.<br />
<br />
Is the path given by the error prompt accurate? I know I was confused the first time I tried the command &quot;File Sounds\Ding.wav&quot; and it ended up $OUTDIR instead of $OUTDIR\Sounds. Again, check if the folder exists.<br />
<br />
<br />
The path given by the error prompt is correct.<br />
<br />
All the files don't need to be in the same location prior to compiling the script. You'll be specifying a path in your File command where the file is coming from. Do something like what KrYpT said and use CreateDiretory or use SetOutPath like it is below to make sure the folder exists and to set the path it should go to. If that doesn't work put some message boxes in to show you what your $OUTDIR and/or $INSTDIR variable are before doing your copy.<br />
<br />
SetOutPath &quot;$INSTDIR\help&quot;<br />
File F:\companies\help\*.htm<br />
SetOutPath &quot;$INSTDIR\help\images&quot;<br />
File F:\companies\help\images\*.gif<br />
<br />
No help there.  Here's the complete script that I'm compiling.  Maybe that will help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scully13</div><div class="date">31st August 2004, 18:57</div></div><div class="posttext">It worked fine for me. I don't have that game installed so that key doesn't exist in my registry. I changed it to something else though and created a bunch of empty files to match your file names and it was fine. You said the error message is returning the correct path or is it just saying &quot;\Kitanya\something.cre&quot;. In this case here it doesn't have an $INSTDIR set.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scully13</div><div class="date">31st August 2004, 19:03</div></div><div class="posttext">It looks like your InstallDirRegKey is wrong. It's not pointing to anything under BG2Main.exe. It should be something more like:<br />
<br />
InstallDirRegKey HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\BG2Main.exe&quot; Path<br />
<br />
I'm guessing on the &quot;Path&quot; part since I don't have the game but I have several other apps installed that use a similar deal in the registry. Try:<br />
MessageBox MB_OK $INSTDIR<br />
before your first SetOutPath.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rpgfan</div><div class="date">31st August 2004, 21:25</div></div><div class="posttext">That worked.  It is extracting everything correctly now.<br />
<br />
However, I'm getting a problem with that &quot;ExecWait&quot; in the .onInstSuccess call-back function.  Namely, the executable won't work.  I get a &quot;bad filename&quot; or somesuch error, despite the fact that the file is both named identically to the one in the script and it is contained in the script to be compressed into the archive.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scully13</div><div class="date">31st August 2004, 21:35</div></div><div class="posttext">I put a dummy EXE file in place of setup-kitanya.exe and it executed just fine for me. It ran as soon as I clicked Close on the final install dialog. Does the real setup-kitanya.exe reguire some command line parameters or something. I'm guessing that maybe you changed some other stuff in your script after you posted one here and it caused a problem. If so put your script back up here as an attachment and I'll check it out again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rpgfan</div><div class="date">1st September 2004, 02:08</div></div><div class="posttext">setup-kitanya.exe does not require command line parameters.<br />
<br />
I can't see exactly what the error given is, as my computer opens and closes the DOS window too quickly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scully13</div><div class="date">1st September 2004, 14:21</div></div><div class="posttext">Ok, so the script is basically the same as it was before. I was thinking maybe you added some new stuff that might have altered the $INSTDIR before the ExecWait command. Both scripts work fine for me with fake files and a dummy EXE that just pops up a dialog. So, my next question is what is the path that you are installing into? I can use that to try and recreate exactly what your doing. Also, You said a DOS box pops up so what type of app is this that is getting launched (MFC app, console program, another installer)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">KrYpT</div><div class="date">1st September 2004, 18:08</div></div><div class="posttext">I don't know if this is the problem or not, but maybe you could try &quot;SetOutPath $INSTDIR&quot; before the ExecWait? That just sets the current directory (so that the setup program is more likely to find associated files).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rpgfan</div><div class="date">2nd September 2004, 19:58</div></div><div class="posttext">So, my next question is what is the path that you are installing into?<br />
<br />
On my computer, it is C:\Program Files\Black Isle\BGII - SoA<br />
<br />
Also, You said a DOS box pops up so what type of app is this that is getting launched (MFC app, console program, another installer)?<br />
<br />
It's a console program.<br />
<br />
I don't know if this is the problem or not, but maybe you could try &quot;SetOutPath $INSTDIR&quot; before the ExecWait? That just sets the current directory (so that the setup program is more likely to find associated files).<br />
<br />
I'll try that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">2nd September 2004, 20:12</div></div><div class="posttext">&quot;When executing an application that is a 32-bit GUI application, CMD.EXE does not wait for the application to terminate before returning to the command prompt.  This new behavior does NOT occur if executing within a command script.&quot;<br />
<br />
You need to create a small C app that monitors the thread of the process you are running. If you don't know C, then do the following:<br />
<br />
1. Get the Windows Platform SDK. The C# compiler comes with it.<br />
2. Compile the source found in this (http://forums.winamp.com/showthread.php?s=&amp;threadid=180398) thread.<br />
<br />
then call the new executable using your app as the -f parameter, as specified in the syntax I posted in the above thread.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">KrYpT</div><div class="date">2nd September 2004, 20:52</div></div><div class="posttext">If it's really a console app you shouldn't need zimsms' code. Try using nsExec::ExecToLog and see what it comes up with.<br />
<br />
Also, I think you can get around the problem zimsms was having by creating a batch file which simply runs your exe. Haven't tested this but you should get the idea:<br />
<br />
ExecWait &quot;echo setup-kitanya.exe &gt; temp.bat&quot;<br />
ExecWait &quot;temp.bat&quot;<br />
Delete &quot;temp.bat&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rpgfan</div><div class="date">2nd September 2004, 23:18</div></div><div class="posttext">Actually, trying to run it via a batch file was one of the first things that I tried.  I got the same result.<br />
<br />
I'll try using ExecToLog and see if that tells me exactly what the error is.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scully13</div><div class="date">3rd September 2004, 13:11</div></div><div class="posttext">What were the results of using SetOutPath $INSTDIR to modify the $OUTDIR that KrYpT suggested? I'm assuming that after you do your install you are able to run the setup-kitanya.exe from the installed directory and it works fine. So, I'm thinking that should be all you need.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">3rd September 2004, 13:51</div></div><div class="posttext">As my previous post stated if the executable you are attempting to run was actually compiled as a 32-bit GUI app, then there are only the two ways around it. a) Using the ExecWait function I created, or b) Use thw Windows Scripting Wizard to create a script equivelant to the batch file you want to use.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rpgfan</div><div class="date">3rd September 2004, 14:04</div></div><div class="posttext">Originally posted by scully13 <br />
What were the results of using SetOutPath $INSTDIR to modify the $OUTDIR that KrYpT suggested? I'm assuming that after you do your install you are able to run the setup-kitanya.exe from the installed directory and it works fine. So, I'm thinking that should be all you need.  <br />
<br />
It now works perfectly.<br />
<br />
Thanks for the help, guys.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>