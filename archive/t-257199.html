<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Custom page problem..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Custom page problem... NSIS Discussion" />
	
	<title> Custom page problem... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Custom page problem...</div>
<hr />
<div class="pda"><a href="t-257199.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257199">Custom page problem...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Theresias</div><div class="date">9th October 2006, 15:20</div></div><div class="posttext">I'm having a custom page with 2 radiobuttons, from which I need to read the status.<br />
<br />
Function SelectInterfacePage<br />
<br />
 !insertmacro MUI_HEADER_TEXT &quot;$(SelectInterface_TITLE)&quot; &quot;$(SelectInterface_SUBTITLE)&quot;<br />
 !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;SelectInterface.ini&quot;<br />
 !insertmacro MUI_INSTALLOPTIONS_READ $USB &quot;SelectInterface&quot; &quot;Field 2&quot; &quot;State&quot;<br />
 !insertmacro MUI_INSTALLOPTIONS_READ $COM &quot;SelectInterface&quot; &quot;Field 3&quot; &quot;State&quot;<br />
<br />
FunctionEnd<br />
<br />
Comes up with...<br />
<br />
!insertmacro: MUI_INSTALLOPTIONS_READ<br />
Usage: ReadINIStr $(user_var: output) ini_file section entry_name<br />
Error in macro MUI_INSTALLOPTIONS_READ on macroline 5<br />
Error in script &quot;D:\Installer\TEST.nsi&quot; on line 78 -- aborting creation process<br />
<br />
Any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschagottfried</div><div class="date">9th October 2006, 16:57</div></div><div class="posttext">just use full file name like &quot;SelectInterface.ini&quot; as you do in &quot;display&quot; macro. That's all.<br />
<br />
Excerpt from NSIS help: Using InstallOptions for custom pages<br />
<br />
insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;ioFile.ini&quot;<br />
<br />
Use these macros to read or write INI file values:<br />
!insertmacro MUI_INSTALLOPTIONS_READ $VAR &quot;ioFile.ini&quot; &quot;Field #&quot; &quot;Name&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioFile.ini&quot; &quot;Field #&quot; &quot;Name&quot; &quot;Value&quot;<br />
For example, you can use the MUI_INSTALLOPTIONS_READ macro in a section to get the user input:<br />
<br />
!insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;ioFile.ini&quot; &quot;Field 1&quot; &quot;State&quot;<br />
<br />
For more details about InstallOptions, validation of user input etc., check the InstallOptions documentation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th October 2006, 17:25</div></div><div class="posttext">Did you declare the variables $USB and $COM with the Var instruction? Just use $R0 and $R1 instead (save on memory usage).<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Theresias</div><div class="date">9th October 2006, 18:06</div></div><div class="posttext">Originally posted by saschagottfried <br />
just use full file name like &quot;SelectInterface.ini&quot; as you do in &quot;display&quot; macro. That's all.<br />
<br />
That didn't change anything.<br />
<br />
Originally posted by saschagottfried <br />
For more details about InstallOptions, validation of user input etc., check the InstallOptions documentation. <br />
<br />
This was my plan, sadly SF.net was unaccessible for the time being.<br />
<br />
Originally posted by Afrow UK <br />
Did you declare the variables $USB and $COM with the Var instruction? Just use $R0 and $R1 instead (save on memory usage).<br />
<br />
You got it! Thank you, that solved it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">10th October 2006, 01:26</div></div><div class="posttext">And, ideally, the code should be split up like this:<br />
Page Custom SelectInterfacePage SelectInterfacePageLeave<br />
<br />
Function SelectInterfacePage <br />
<br />
!insertmacro MUI_HEADER_TEXT &quot;$(SelectInterface_TITLE)&quot; &quot;$(SelectInterface_SUBTITLE)&quot; <br />
!insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;SelectInterface.ini&quot; <br />
<br />
FunctionEnd<br />
<br />
Function SelectInterfacePageLeave<br />
<br />
!insertmacro MUI_INSTALLOPTIONS_READ $USB &quot;SelectInterface&quot; &quot;Field 2&quot; &quot;State&quot; <br />
!insertmacro MUI_INSTALLOPTIONS_READ $COM &quot;SelectInterface&quot; &quot;Field 3&quot; &quot;State&quot; <br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Theresias</div><div class="date">10th October 2006, 12:12</div></div><div class="posttext">Thanks Jason, I tried that and this is what I have now:<br />
<br />
Function SelectInterfacePageLeave<br />
   # Read USB ($R0)<br />
 !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;SelectInterface&quot; &quot;Field 2&quot; &quot;State&quot;<br />
   # Read COM ($R1)<br />
 !insertmacro MUI_INSTALLOPTIONS_READ $R1 &quot;SelectInterface&quot; &quot;Field 3&quot; &quot;State&quot;<br />
   StrCmp $R0 &quot;1&quot; USB COM<br />
    USB:<br />
     MessageBox MB_OK &quot;USB ausgewÃ¤hlt! USB: $R0 COM: $R1&quot;<br />
    COM:<br />
     MessageBox MB_OK &quot;COM ausgewÃ¤hlt! USB: $R0 COM: $R1&quot;<br />
FunctionEnd<br />
<br />
Problem now is, whatever I select, it ends up with using &quot;COM&quot;, so I tried to use the MBox to give me the current values of $R0 and $R1, but both are empty. Any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">11th October 2006, 00:05</div></div><div class="posttext">Try putting the extension on the file being read:!insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;SelectInterface.ini&quot; &quot;Field 2&quot; &quot;State&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Theresias</div><div class="date">11th October 2006, 09:19</div></div><div class="posttext">Again, thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschagottfried</div><div class="date">11th October 2006, 10:35</div></div><div class="posttext">...and you have to skip the &quot;COM&quot; label, when condition &quot;USB&quot; is met. I don't know if you have not figured out this yet.<br />
<br />
see this example from NSIS help:<br />
StrCmp $0 &quot;a string&quot; 0 +3<br />
  DetailPrint '$$0 == &quot;a string&quot;'<br />
  Goto +2<br />
  DetailPrint '$$0 != &quot;a string&quot;'<br />
<br />
my advice: include LOGIGLIB.nsh and this will never happen. A great tool especially for beginners with NSIS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">11th October 2006, 22:17</div></div><div class="posttext">Like this:<br />
Function SelectInterfacePageLeave<br />
   # Read USB ($R0)<br />
 !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;SelectInterface.ini&quot; &quot;Field 2&quot; &quot;State&quot;<br />
   # Read COM ($R1)<br />
 !insertmacro MUI_INSTALLOPTIONS_READ $R1 &quot;SelectInterface.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
   StrCmp $R0 &quot;1&quot; USB COM<br />
    USB:<br />
     MessageBox MB_OK &quot;USB ausgewÃ¤hlt! USB: $R0 COM: $R1&quot;<br />
     GoTo EndIf<br />
    COM:<br />
     MessageBox MB_OK &quot;COM ausgewÃ¤hlt! USB: $R0 COM: $R1&quot;<br />
  EndIf:<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Theresias</div><div class="date">11th October 2006, 22:39</div></div><div class="posttext">Thanks guys! Works perfectly now.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>