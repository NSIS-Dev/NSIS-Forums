<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Internationalization, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Internationalization NSIS Discussion" />
	
	<title> Internationalization [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Internationalization</div>
<hr />
<div class="pda"><a href="t-282325.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=282325">Internationalization</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">giugio</div><div class="date">29th November 2007, 11:33</div></div><div class="posttext">hy.<br />
I try the example in the help:<br />
<br />
i put this in the begin of the file <br />
LangString message ${LANG_ENGLISH} &quot;English message&quot;<br />
 LangString message ${LANG_FRENCH} &quot;French message&quot;<br />
 LangString message ${LANG_ITALIAN} &quot;ITALIAN message&quot;<br />
<br />
and i set this in the define part:<br />
<br />
!define MUI_WELCOMEPAGE_TITLE  $(msgTitleWelcome)<br />
!define MUI_WELCOMEPAGE_TEXT   $(msgTextWelcome)<br />
MessageBox MB_OK &quot;A translated message: $(message)&quot;<br />
<br />
before the !insertmacro MUI_PAGE_WELCOME<br />
but don't work</div></div><hr />


<div class="post"><div class="posttop"><div class="username">giugio</div><div class="date">29th November 2007, 15:52</div></div><div class="posttext">an alternative is define all' the text message in the top of the sript without the translation and insert all in the pages definition.<br />
How do this?<br />
thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galevsky</div><div class="date">29th November 2007, 16:13</div></div><div class="posttext">Okay, so pay attention to that:<br />
<br />
in the .onInit function:<br />
<br />
       !insertmacro MUI_LANGDLL_DISPLAY<br />
<br />
to ask for the language at the begining of the installation.<br />
<br />
Then do not used messages in the .onInit function since the language is still not taken into account. Wait for the second function...<br />
<br />
in a customized OnGuiInit function,<br />
do your message display via MessageBox.<br />
<br />
It must work. And it will in all the later sections/functions..<br />
<br />
In your example, in which function/section is located your MessageBox ? <br />
<br />
<br />
Gal'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">giugio</div><div class="date">29th November 2007, 17:14</div></div><div class="posttext">i insert <br />
!insertmacro MUI_LANGDLL_DISPLAY<br />
in the .oninit function, but dont show the language selection dialog.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galevsky</div><div class="date">29th November 2007, 17:39</div></div><div class="posttext">Try to compile and run that:<br />
<br />
<br />
!include &quot;MUI.nsh&quot;<br />
<br />
Name &quot;Modern UI Test&quot;<br />
OutFile test.exe<br />
XPStyle on<br />
<br />
<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
!insertmacro MUI_LANGUAGE &quot;Dutch&quot;<br />
<br />
<br />
LangString msg ${LANG_ENGLISH} &quot;English msg&quot;<br />
LangString msg ${LANG_DUTCH} &quot;Dutch msg&quot;<br />
<br />
<br />
function .onInit<br />
        !insertmacro MUI_LANGDLL_DISPLAY<br />
functionEnd<br />
<br />
section &quot;Silent&quot; SILENT_SEC<br />
       MessageBox MB_OK &quot;$(msg)&quot; ; $() instead of ${}<br />
sectionEnd<br />
<br />
<br />
<br />
<br />
Gal'<br />
<br />
PS: insert your MUI_LANGUAGES after the MUI_PAGES</div></div><hr />


<div class="post"><div class="posttop"><div class="username">only_johhny</div><div class="date">2nd December 2007, 14:30</div></div><div class="posttext">Using <br />
    MessageBox MB_OK $(SEC0001_NAME)<br />
<br />
I got always the same output, no matter what Language I've chosen. Now I know why - the language is not taken into account.<br />
<br />
But where can I do things like that?<br />
Error: Function named &quot;.OnGuiInit&quot; already exists. can I add there some lines? I want to do<br />
'!insertmacro SelectSection SEC0001' / '!insertmacro UnSelectSection SEC0001' depening on the language chosen.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd December 2007, 14:37</div></div><div class="posttext">!define MUI_CUSTOMFUNCTION_GUIINIT myOnGUIInit<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">only_johhny</div><div class="date">2nd December 2007, 15:36</div></div><div class="posttext">Now I can call my function. Fine. New Prolem<br />
<br />
If I do Function SELECT_LANGSECTIONS # selecting installer sections (languages)<br />
        ${If} $(SEC0002_NAME) == &quot;FranÃ§ais&quot;<br />
            !insertmacro SelectSection  SEC0002<br />
            !insertmacro SetSectionFlag SEC0002 2<br />
        ${EndIf}}<br />
FunctionEnd , the installer has 100% CPU and have to be killed when reaching the Select Page.<br />
<br />
Why is that? I use the following definition<br />
    Section /o $(SEC0002_NAME) SEC0002<br />
        SetOutPath $INSTDIR\fr<br />
        SetOverwrite on<br />
        File /r ..\bin\Release\fr\*<br />
        File /r ..\bin\Release\help\fr\*<br />
        WriteRegStr HKLM &quot;${REGKEY}\Components&quot; French 1<br />
        SectionIn 3<br />
    SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">only_johhny</div><div class="date">2nd December 2007, 15:44</div></div><div class="posttext">This seems to be a bug in NSIS, is there a workaround for now?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd December 2007, 16:11</div></div><div class="posttext">For the macro insertions, you need to pass ${SEC0002} not SEC0002.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galevsky</div><div class="date">2nd December 2007, 16:39</div></div><div class="posttext">I don't know what you are trying to do, but look at my example  above. Why are you defining a select_langsection function ? why do you need it ? Normally you don't...<br />
<br />
what do you want to do ? have a section only if the language is French (have a test encapsulating the section description) ? Or do you want to have the components page in the selected Language (automated with use of LangString) ?<br />
<br />
Gal'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">only_johhny</div><div class="date">2nd December 2007, 17:38</div></div><div class="posttext">I've tried ${SEC0001} before but didn't worked (Variable/Constant undefined): I had to put my function after the sections were defined.<br />
<br />
But the problem stays the same: 100% CPU using and the only option to kill the installer.<br />
<br />
There is a program in english with different language packages for other languages and three InstTypes: InstType $(inst_minimal)  #means installation without any additional language --&gt; only english<br />
InstType $(inst_standard) #means installation with the language chosen at installatin begining as additional packet<br />
InstType $(inst_full)     #means installation with all available language packets<br />
This is what I want to do: Add the chosen language of the installer to the InstType $(inst_standard) and select the standard type, so that the user does not to have choose the language twice.<br />
<br />
Is it possible to 'delete' the InstType $(inst_minimal) or $(inst_standard) if the user chooses english?<br />
<br />
I use the following code (with InstTypes as shown before )# Installer sections<br />
Section $(SEC0000_NAME) SEC0000<br />
    SetOutPath $INSTDIR<br />
    SetOverwrite on<br />
    File ..\bin\Release\license.rtf<br />
    SetOutPath $INSTDIR\en<br />
    File /r ..\bin\Release\help\en\*<br />
    WriteRegStr HKLM &quot;${REGKEY}\Components&quot; MainProg 1<br />
    SectionIn RO   # This Section is allways checked and cannot be disabled<br />
SectionEnd<br />
<br />
SectionGroup /e $(SECGRP0000_NAME) SECGRP0000<br />
    # what languages belongs to standard type<br />
    # is choosen dynamically via SELECT_LANGSECTIONS<br />
    Section /o $(SEC0001_NAME) SEC0001<br />
        SetOutPath $INSTDIR\de<br />
        SetOverwrite on<br />
        File /r ..\bin\Release\de\*<br />
        File /r ..\bin\Release\help\de\*<br />
        File ..\bin\Release\lizenz.rtf<br />
        WriteRegStr HKLM &quot;${REGKEY}\Components&quot; German 1<br />
        SectionIn 3<br />
    SectionEnd<br />
<br />
    Section /o $(SEC0002_NAME) SEC0002<br />
        SetOutPath $INSTDIR\fr<br />
        SetOverwrite on<br />
        File /r ..\bin\Release\fr\*<br />
        File /r ..\bin\Release\help\fr\*<br />
        WriteRegStr HKLM &quot;${REGKEY}\Components&quot; French 1<br />
        SectionIn 3<br />
    SectionEnd<br />
SectionGroupEnd<br />
<br />
Function MyOnGuiInit<br />
    # selecting installer sections (languages)<br />
    ${If} $(SEC0001_NAME)  == &quot;Deutsch&quot;<br />
        !insertmacro SelectSection  ${SEC0001}<br />
        !insertmacro SetSectionFlag ${SEC0001} 2<br />
    ${Else}<br />
        ${If} $(SEC0002_NAME) == &quot;FranÃ§ais&quot;<br />
            !insertmacro SelectSection  ${SEC0002}<br />
            !insertmacro SetSectionFlag ${SEC0002} 2<br />
        ${EndIf}<br />
    ${EndIf}<br />
FunctionEnd<br />
<br />
LangString SEC0001_NAME     ${LANG_ENGLISH} &quot;German&quot;<br />
LangString SEC0002_NAME     ${LANG_ENGLISH} &quot;French&quot;<br />
LangString SEC0001_NAME     ${LANG_GERMAN}  &quot;Deutsch&quot;<br />
LangString SEC0002_NAME     ${LANG_FRENCH}  &quot;FranÃ§ais&quot;<br />
<br />
<br />
There is no CPU problem when using !insertmacro SetSectionFlag ${SEC0001} ${SF_2} but I receive unknown variable/constant &quot;{SF_2}&quot; detected, ignoring (macro:SetSectionFlag:6) and because of this - no definition of InstType $(inst_standard).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd December 2007, 18:19</div></div><div class="posttext">If it says it is undefined then that means your code needs to go below the sections in your script.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">only_johhny</div><div class="date">2nd December 2007, 18:34</div></div><div class="posttext">As I said before:Originally posted by only_johhny <br />
I've tried ${SEC0001} before but didn't worked (Variable/Constant undefined): I had to put my function after the sections were defined.The problem is: what should I do because of this &quot;have to kill installer&quot;-thing</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd December 2007, 20:00</div></div><div class="posttext">What is ${SF_2}? The constants that you can use are in Sections.nsh. A value of 2 is ${SF_SECGRP} or in other words, setting it means you are turning your section into a group marker.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">only_johhny</div><div class="date">2nd December 2007, 21:09</div></div><div class="posttext">Oops... How can I do what I want? Any suggestions?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>