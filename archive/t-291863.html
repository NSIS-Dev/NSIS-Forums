<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS with main() function and no others or sections or pages?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS with main() function and no others or sections or pages? NSIS Discussion" />
	
	<title> NSIS with main() function and no others or sections or pages? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS with main() function and no others or sections or pages?</div>
<hr />
<div class="pda"><a href="t-291863.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291863">NSIS with main() function and no others or sections or pages?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">strong_epoxy</div><div class="date">16th May 2008, 00:46</div></div><div class="posttext">Is there a stripped down version of NSIS that doesn't require sections, pages, or other built in functions.<br />
<br />
In other words, a generalized scripting system supporting all the NSIS great functions and plugins, but doesn't require the install domain specific sections, pages, or install specific callback functions.<br />
<br />
The only required function would be main()<br />
<br />
That'd be hot...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">16th May 2008, 01:17</div></div><div class="posttext">no, but then you can make a very minimal installer of the type you describe with just this:<br />
<br />
<br />
OutFile &quot;Setup.exe&quot;<br />
<br />
Section &quot;&quot;<br />
SectionEnd<br />
<br />
Function .onInit<br />
	; your code here<br />
	Abort<br />
FunctionEnd<br />
<br />
<br />
Put the code you want in .onInit.  The 'Abort' at the end will make the installer exit immediately, without any UI being loaded, etc.  At the top you might still want to specify a compressor, but for the sake of minimalism.. the above is it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th May 2008, 10:34</div></div><div class="posttext">Or even shorter,<br />
<br />
OutFile file.exe<br />
SilentInstall silent<br />
<br />
Section<br />
...<br />
SectionEnd<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th May 2008, 11:32</div></div><div class="posttext">Afrow's solution also generates a smaller executable.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">16th May 2008, 13:24</div></div><div class="posttext">fancy :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th May 2008, 18:10</div></div><div class="posttext">Silent installers get stripped of their resources and some language strings are also not included so the overhead is smaller.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th May 2008, 19:25</div></div><div class="posttext">And if you want it even smaller, you can use UPX to pack the overhead and then you can remove the icon with Resource Hacker, both by using !packhdr. You can't use !packhdr more than once so you need to use batch scripts.<br />
<br />
Just to share with everyone, the batches I use in every installer I make:<br />
<br />
NSIS\packhdr\upx.bat<br />
<br />
cd /d %~dp0<br />
<br />
upx %1<br />
<br />
NSIS\packhdr\noicon.bat<br />
<br />
cd /d %~dp0<br />
<br />
ResHacker -delete %1, %1, icongroup,103,<br />
del ResHacker.log<br />
<br />
NSIS\packhdr\noicon+upx.bat<br />
<br />
cd /d %~dp0<br />
<br />
ResHacker -delete %1, %1, icongroup,103,<br />
del ResHacker.log<br />
<br />
upx %1<br />
<br />
<br />
Example NSIS code to compress overhead and remove icon:<br />
!packhdr $%TEMP%\exehead.tmp `&quot;${NSISDIR}\packhdr\noicon+upx.bat&quot; &quot;$%TEMP%\exehead.tmp&quot;`<br />
<br />
You need to extract Resource Hacker and UPX to NSIS\packhdr as well of course.<br />
<br />
http://angusj.com/resourcehacker/<br />
http://upx.sourceforge.net/<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>