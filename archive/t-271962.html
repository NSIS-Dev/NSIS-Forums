<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Finish button is pressed automatically..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Finish button is pressed automatically... NSIS Discussion" />
	
	<title> Finish button is pressed automatically... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Finish button is pressed automatically...</div>
<hr />
<div class="pda"><a href="t-271962.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=271962">Finish button is pressed automatically...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">daisywheel</div><div class="date">29th May 2007, 14:02</div></div><div class="posttext">Sometimes(I can't say exactly when or why) the finish button on finish dialog is pressed automatically...<br />
maybe somebody know possible reasons of at least could help with steps to localize the problem.<br />
<br />
All I can say that in some momment after installation I get a crash(I also can't localize it) and after that when I try to reinstall the finish button is ignored - the installation finishes by itself without pressing finish button.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">29th May 2007, 14:33</div></div><div class="posttext">Please attach part of the script.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">daisywheel</div><div class="date">30th May 2007, 11:16</div></div><div class="posttext">Unfortunately I can't attach part of script which could help you to understand the reason of problems.<br />
<br />
But after rather long playing with script I found the problem.<br />
In my case it was fixed by changing the order of insttalling and registering two dlls.<br />
<br />
was <br />
!insertmacro InstallLib REGDLL NOTSHARED NOREBOOT_PROTECTED &quot;c:\1\SomeLib1.dll&quot; $INSTDIR\SomeLib1.dll $TEMP<br />
!insertmacro InstallLib REGDLL NOTSHARED NOREBOOT_PROTECTED &quot;c:\1\SomeLib2.dll&quot; $INSTDIR\SomeLib2.dll $TEMP<br />
<br />
changed to <br />
!insertmacro InstallLib REGDLL NOTSHARED NOREBOOT_PROTECTED &quot;c:\1\SomeLib2.dll&quot; $INSTDIR\SomeLib2.dll $TEMP<br />
!insertmacro InstallLib REGDLL NOTSHARED NOREBOOT_PROTECTED &quot;c:\1\SomeLib1.dll&quot; $INSTDIR\SomeLib1.dll $TEMP<br />
<br />
I though that the problem was on my side - I mean that I was using NSIS in wrong order trying to register SomeLib1.dll which has dependency with SomeLib2.dll<br />
<br />
I added next row<br />
File &quot;c:\1\*.dll&quot;<br />
but it's also didn't help.<br />
<br />
Maybe I don't know something about sequence or registering dlls in NSIS?...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th May 2007, 11:56</div></div><div class="posttext">InstallLib places the files in the installer for you.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">daisywheel</div><div class="date">30th May 2007, 13:33</div></div><div class="posttext">I know that. But I don't understand why installer crashes depending on sequence of InstallLib calls.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th May 2007, 20:34</div></div><div class="posttext">Probably because some DLL files depend on others and fail to properly handle their shortage.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>