<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Custom page shows if files doesn't exist, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Custom page shows if files doesn't exist NSIS Discussion" />
	
	<title> Custom page shows if files doesn't exist [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Custom page shows if files doesn't exist</div>
<hr />
<div class="pda"><a href="t-283121.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=283121">Custom page shows if files doesn't exist</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">13th December 2007, 03:58</div></div><div class="posttext">Hi there is there a better way to script this, it seem a bit messy<br />
<br />
Basically if the file doesn't exist it shows the custom page  warning people it will be installed and run an *.inf file via a *.bat to install these drivers (I say warning as the drivers aren't officially passed by Microsoft, thus the warning not to worry and so on)<br />
<br />
if the file does exist the custom page doesn't show and the drivers are not installed<br />
<br />
<br />
Page custom Mpeg<br />
<br />
Function Mpeg<br />
IfFileExists &quot;$SYSDIR\Mpg4dmod.dll.bak&quot; MpegSkip MpegShow<br />
MpegShow:<br />
!insertmacro MUI_HEADER_TEXT &quot;$(TEXT_IO_TITLE)&quot; &quot;$(TEXT_IO_SUBTITLE)&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;mpeg21.ini&quot;<br />
<br />
CreateDirectory &quot;$INSTDIR\Mpeg&quot;<br />
SetFileAttributes &quot;$INSTDIR\Mpeg&quot; HIDDEN<br />
SetOutPath &quot;$INSTDIR\Mpeg&quot;<br />
File &quot;Mpeg\Mpeg.bat&quot;<br />
File &quot;Mpeg\msaud32.acm&quot;<br />
File &quot;Mpeg\MPG4c32.dll&quot;<br />
File &quot;Mpeg\MPG4ds32.ax&quot;<br />
File &quot;Mpeg\msadds32.ax&quot;<br />
File &quot;Mpeg\MS-MPG4.inf&quot;<br />
IfFileExists &quot;$SYSDIR\Mpg4dmod.dll.bak&quot; 0 +2<br />
Delete &quot;$SYSDIR\Mpg4dmod.dll.bak&quot;<br />
IfFileExists &quot;$SYSDIR\Mpg4dmod.dll&quot; 0 +2<br />
Rename &quot;$SYSDIR\Mpg4dmod.dll&quot; &quot;$SYSDIR\Mpg4dmod.dll.bak&quot;<br />
IfFileExists &quot;$SYSDIR\dllcache\Mpg4dmod.dll.bak&quot; 0 +2<br />
Delete &quot;$SYSDIR\dllcache\Mpg4dmod.dll.bak&quot;<br />
IfFileExists &quot;$SYSDIR\dllcache\Mpg4dmod.dll&quot; 0 +2<br />
Rename &quot;$SYSDIR\dllcache\Mpg4dmod.dll&quot; &quot;$SYSDIR\dllcache\Mpg4dmod.dll.bak&quot;<br />
nsExec::Exec '&quot;$INSTDIR\Mpeg\Mpeg.bat&quot;'<br />
SetOutPath &quot;$INSTDIR&quot;<br />
RMDir /r &quot;$INSTDIR\Mpeg&quot;<br />
SetOutPath &quot;$SYSDIR&quot;<br />
File &quot;Mpeg\Mpg4dmod.dll.bak&quot;<br />
MpegSkip:<br />
FunctionEnd<br />
<br />
<br />
At the moment the files install when you click out of the custom page to go to the install page, but the install page doesn't show until the drivers have finished installing, which is messy<br />
<br />
What I would like is this<br />
<br />
If file doesn't exist, show custom page but install the drivers with the main installation files<br />
<br />
I know how to do this if I where to have it selectable in the components page, you know if it was selected the page would show the files wouldn't be installed and visa versa<br />
<br />
but I want to do this so people don't have that option, once the drivers are installed, the page wouldn't show again as its a one off thing<br />
<br />
Please help<br />
<br />
and thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">13th December 2007, 05:08</div></div><div class="posttext">It's dangerous to go alone, take this (http://nsis.sourceforge.net/Go_to_a_NSIS_page).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">13th December 2007, 12:50</div></div><div class="posttext">What's that supposed to mean?<br />
<br />
You lot are too cryptic, you never give a straight answer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">13th December 2007, 14:27</div></div><div class="posttext">I guess didn't you see that &quot;this&quot; is a link :rolleyes:<br />
and you never play &quot;The legend of link&quot; for NES :rolleyes:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">13th December 2007, 15:33</div></div><div class="posttext">!define CUST_INI &quot;$PLUGINSDIR\custom.ini&quot;<br />
!include sections.nsh<br />
<br />
outfile 'test.exe'<br />
InstallDir &quot;$PROGRAMFILES\My Application&quot;<br />
showinstdetails show<br />
<br />
page custom CreateCustom <br />
page directory<br />
page instfiles<br />
<br />
section main sec1<br />
DetailPrint &quot;Section main: Always install this section&quot;<br />
sectionend<br />
<br />
section optional sec2<br />
detailprint &quot;Section optional: Installed when explorer.exe does not exist&quot;<br />
sectionend<br />
<br />
Function .onInit<br />
InitPluginsDir<br />
WriteINIStr &quot;${CUST_INI}&quot; &quot;Settings&quot; &quot;NumFields&quot; &quot;1&quot;<br />
WriteINIStr &quot;${CUST_INI}&quot; &quot;field 1&quot; &quot;type&quot; &quot;label&quot;<br />
WriteINIStr &quot;${CUST_INI}&quot; &quot;field 1&quot; &quot;left&quot; &quot;10&quot;<br />
WriteINIStr &quot;${CUST_INI}&quot; &quot;field 1&quot; &quot;right&quot; &quot;-10&quot;<br />
WriteINIStr &quot;${CUST_INI}&quot; &quot;field 1&quot; &quot;top&quot; &quot;10&quot;<br />
WriteINIStr &quot;${CUST_INI}&quot; &quot;field 1&quot; &quot;bottom&quot; &quot;18&quot;<br />
WriteINIStr &quot;${CUST_INI}&quot; &quot;field 1&quot; &quot;text&quot; &quot;hey, i'm a custom (IO) page&quot;<br />
FunctionEnd<br />
<br />
Function CreateCustom<br />
IfFileExists &quot;$WINDIR\Explorer.exe&quot; exists notexists<br />
exists:<br />
!insertmacro UnselectSection ${sec2}<br />
abort<br />
notexists:<br />
push $0<br />
InstallOptions::dialog &quot;${CUST_INI}&quot;<br />
pop $0<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">13th December 2007, 16:30</div></div><div class="posttext">Sorry Joel no I didn't see the link, my eyes aren't what they used to be. :blind &gt; :cool: <br />
<br />
And no I never played Legend of Link or Zelda (if those are the same thing or related.<br />
<br />
Now I feel stupid with my remark of &quot;What's that supposed to mean?&quot; :(<br />
<br />
And Red Wine thank you that makes a lot of sense, thank you again.:D<br />
<br />
All I have to do with Section optional is to hide it, then it won't show in the components page, cheers :)<br />
<br />
It help when you have a visual bit of script, sorry Joel the script in your link did make a lot sense to me but thanks again.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>