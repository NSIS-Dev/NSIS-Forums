<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Don't Have Write Access?!, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Don't Have Write Access?! NSIS Discussion" />
	
	<title> Don't Have Write Access?! [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Don't Have Write Access?!</div>
<hr />
<div class="pda"><a href="t-280057.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=280057">Don't Have Write Access?!</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">26th October 2007, 18:45</div></div><div class="posttext">Some users, who are admin, logged into their box, can't write to C:\Program Files\SomeDirectory etc. What is going on? How can this be? There are no programs like Norton running preventing access, yet when a routine to write a file is run to check privs, the user doesn't appear to have the capability.<br />
<br />
Is there anything else we can do or find out what is going on?<br />
<br />
I tried first using RequestExecutionLevel to user, then none, and now admin. All with the same effect. This is driving me crazy that the installer, and this installer alone, somehow doesn't have permission that even the user has.<br />
<br />
Please help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th October 2007, 19:07</div></div><div class="posttext">RequestExecutionLevel is for Vista only. Does this happen on Vista? If so, it's UAC. You have to pass the UAC prompt in order to write anything to Program Files.<br />
<br />
If it's not Vista, it's probably some left over privileges on the folder or its parent folder. NSIS doesn't modify any privileges unless told so. Try completely removing the folder and install again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">26th October 2007, 19:39</div></div><div class="posttext">Happen to some users in both XP and Vista. Left over privileges from what? We just created the directory, and then can't write to it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">27th October 2007, 01:08</div></div><div class="posttext">I can't reproduce the problem in XP.<br />
I don't know, maybe I didn't read well the first topic, but seems that the directory is been scanning during the creation from a 3rd part app...just maybe.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th October 2007, 11:35</div></div><div class="posttext">Check the access control lists on the Program Files folder.<br />
Properties&gt;Security (make sure Use simple file sharing is unchecked in Folder Options).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">29th October 2007, 01:52</div></div><div class="posttext">Problem Found!<br />
<br />
CreateDirectory created the program files directory as read-only. How did that happen? How do we change that?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">29th October 2007, 10:29</div></div><div class="posttext">Why should you use CreateDirectory to create it? Surely it will already exist? Use SetFileAttributes.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>