<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Advanced :) search in a text file, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Advanced :) search in a text file NSIS Discussion" />
	
	<title> Advanced :) search in a text file [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Advanced :) search in a text file</div>
<hr />
<div class="pda"><a href="t-182114.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=182114">Advanced :) search in a text file</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">WarmAr</div><div class="date">3rd June 2004, 14:38</div></div><div class="posttext">Your comments and remarks, please:<br />
<br />
Advanced search in text file (http://nsis.sourceforge.net/archive/nsisweb.php?page=576&amp;instances=0,11,311)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evilO</div><div class="date">3rd June 2004, 15:17</div></div><div class="posttext">Hi WarmAr :)<br />
<br />
<br />
1) First of all, welcome to the forums :) <br />
<br />
2) Then, thanks for your contribution... <br />
<br />
Well, there is another search function you could check, written by Afrow UK. It ouputs also the number of times the string has been found in the file, and the number of lines.. but it doesn't make the difference between commented and uncommented lines. Maybe you could &quot;merge&quot; the features...<br />
<br />
The function can be found here:<br />
<br />
http://nsis.sourceforge.net/archive/nsisweb.php?page=315<br />
<br />
<br />
3) About the parameter &quot;dummy&quot;<br />
<br />
I don't know how in another way to get the necessary order of the stack elements <br />
<br />
Well, your 'exch' instructions should look like this: <br />
<br />
 <br />
Function SearchInFile<br />
  Exch $3 ; search mode<br />
  Exch 3<br />
  Exch $2 ; file handle<br />
  Exch 2<br />
  Exch $1 ; comments delimiter<br />
  Exch<br />
  Exch $0 ; search sample<br />
<br />
; ...<br />
<br />
  Pop  $3<br />
  Pop  $2<br />
  Pop  $1<br />
  Pop  $0<br />
FunctionEnd<br />
<br />
<br />
And then if you don't want to change the variables in the function, you just have to change the order of the elements pushed on the stack as follows:<br />
<br />
<br />
 Push $handle<br />
 Push '#'<br />
 Push 'gds_db'<br />
 Push 'no'<br />
 Call SearchInFile<br />
 Pop $0<br />
<br />
<br />
And &quot;dummy&quot; has disapeared :D <br />
<br />
<br />
evilO/Olive</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WarmAr</div><div class="date">4th June 2004, 05:57</div></div><div class="posttext">Thanks for remarks! I shall bring in changes to function by the end of the next week</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evilO</div><div class="date">4th June 2004, 09:53</div></div><div class="posttext">Hi again !<br />
<br />
Thanks for remarks!<br />
<br />
You're more than welcome :)<br />
<br />
Just another thought: there is no need to pass the file handle to the function trough the stack, you could open the file in the function itself.. the less parameters, the better :D<br />
<br />
evilO/Olive</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WarmAr</div><div class="date">4th June 2004, 11:48</div></div><div class="posttext">here is no need to pass the file handle to the function trough the stack, you could open the file in the function itself.. the less parameters, the better <br />
<br />
I disagree. If don't push the handle it is necessary to push the filename. Here there are no less parameters :)<br />
<br />
Why the handle, instead of filename? Before working with file it is necessary to check up still its existence, to check up an opportunity of it to open. All this does not concern to search in file, we shall take out of context.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evilO</div><div class="date">10th June 2004, 10:05</div></div><div class="posttext">Hi WarmAr :)<br />
<br />
I disagree. If don't push the handle it is necessary to push the filename. Here there are no less parameters <br />
<br />
It's true, I probably wasn't fully awake at the time I wrote the post :D<br />
<br />
Why the handle, instead of filename? Before working with file it is necessary to check up still its existence, to check up an opportunity of it to open. All this does not concern to search in file, we shall take out of context.<br />
<br />
Well, it depends actually, there are several ways..<br />
<br />
- if you want to perform several operation on this file, you can check the file's existence and pass the handle to all the functions that need it. In this case the functions assume the file's handle is correct.<br />
<br />
- if you want to perform a single operation on a file, you can pass the filename to the functions that perform the check and open steps. <br />
<br />
<br />
In the 1st case, there are less open/close operations as the handle is kept from one function call to another. In the 2nd case, the advantage is that the function can be used &quot;on it's own&quot;... <br />
<br />
Well, both are good :D<br />
<br />
<br />
evilO/Olive</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WarmAr</div><div class="date">17th June 2004, 08:06</div></div><div class="posttext">evilO, thanks for help in mastering operations with stack!<br />
<br />
I have edited function. <br />
<br />
In addition to suggested by you changes I have added some more 'Exch' for the purposes of the standard order of the initial registers values in a stack</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>