<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problems passing parameters using ExecWait, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problems passing parameters using ExecWait NSIS Discussion" />
	
	<title> Problems passing parameters using ExecWait [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problems passing parameters using ExecWait</div>
<hr />
<div class="pda"><a href="t-307199.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=307199">Problems passing parameters using ExecWait</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">fmbulah</div><div class="date">8th June 2009, 19:18</div></div><div class="posttext">Hello,<br />
<br />
I am trying to launch the JRE installer using ExecWait and pass in the installation directory to install to a specific directory inside the installation:<br />
<br />
File &quot;jre-1_5_0_10-windows-i586-p.exe&quot;<br />
ExecWait '&quot;$OUTDIR\jre-1_5_0_10-windows-i586-p.exe&quot; INSTALLDIR=$INSTDIR\jre'<br />
<br />
It fails and brings up the Windows Installer error dialog which at the top says<br />
&quot;msiexec /Option &lt;Required Parameter&gt; [Optional Parameter]&quot;<br />
<br />
I suspect this is happening because it somehow is not recognizing the INSTALLDIR parameter.<br />
<br />
I've tried enclosing the entire parameter string in quotes and enclosing just the value ($INSTDIR\jre) in quotes and neither works.<br />
<br />
It works if I run it from a Windows command prompt.<br />
<br />
If I leave the parameter off of the ExecWait it works but installs to the default location unless you do a 'Custom' install which is what I am trying to avoid.<br />
<br />
Any and all ideas would be welcome and very much appreciated.<br />
<br />
Thanks in advance.<br />
<br />
Fred<br />
fbulah@progress.com</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th June 2009, 19:25</div></div><div class="posttext">What if $INSTDIR has spaces in it? You should put double quotes around your command line parameter as well.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fmbulah</div><div class="date">8th June 2009, 19:40</div></div><div class="posttext">Hi Stu,<br />
<br />
Thanks for the reply.  As I described in the message, I tried putting quotes around $INSTDIR and also tried putting quotes around INSTALLDIR=$INSTDIR\jre neither of which worked.  I tried putting quotes just around $INSTDIR and that also did not work.<br />
<br />
I'm just about ready to pull what little hair I have left out. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th June 2009, 21:28</div></div><div class="posttext">Ah sorry for missing that. Maybe this will help you:<br />
http://java.sun.com/j2se/1.4.2/docs/guide/plugin/developer_guide/silent.html<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fmbulah</div><div class="date">8th June 2009, 22:43</div></div><div class="posttext">Thanks for the pointer.  I think I've tried every permutation ... except the right one. :)<br />
<br />
Here's what I have now:<br />
<br />
ExecWait '&quot;$OUTDIR\jre-1_5_0_10-windows-i586-p.exe&quot; /s /v &quot;/qn ADDLOCAL=ALL IEXPLORER=1 MOZILLA=1 INSTALLDIR=$INSTDIR\jre /L $INSTDIR\jre.log&quot;' $0<br />
<br />
There is even an inconsistency in the instructions (surprise?): at the top it says to use /s /sv /qn &quot;  ... &quot;  while later on it says to use /s /v &quot;/qn ... &quot;<br />
<br />
Tried both ways but still to no avail ... going to give it one more shot.<br />
<br />
Ugggh!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">8th June 2009, 23:55</div></div><div class="posttext">As stated in the first note on the java page mentioned by Afrow UK no space should be used between /v and the quote since you install it as a &quot;Windows Offline Installation&quot;.<br />
<br />
JP</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fmbulah</div><div class="date">9th June 2009, 00:35</div></div><div class="posttext">Thanks for the response JP. As I described, I tried all permutations both with and without the space. I'll try once more just to make sure there was no cockpit error on my part.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">9th June 2009, 07:30</div></div><div class="posttext">There are actually a couple of posts about installing jre.<br />
You should use an escape character before the quotes in the parameter, so that the parser keeps them ($\&quot; instead of &quot;):ExecWait '&quot;$OUTDIR\jre-1_5_0_10-windows-i586-p.exe&quot; /s /v$\&quot;/qn ADDLOCAL=ALL IEXPLORER=1 MOZILLA=1 INSTALLDIR=$INSTDIR\jre /L $INSTDIR\jre.log$\&quot;' $0Why are you using an outdated version anyway?<br />
JRE is at Version 6 Update 13 now.<br />
http://www.java.com/en/download/manual.jsp</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fmbulah</div><div class="date">9th June 2009, 15:16</div></div><div class="posttext">Thanks for pointing out the need for an escape sequence ... good observation. I knew it would come down to something simple and somehow this did not dawn on me.<br />
<br />
Unfortunately the bad news is that I cut-and-pasted this exactly and it still did not work. It seemed to take a bit longer before ultimately displaying the Windows Installer error dialog, however. Needless to say this is incredibly frustrating because I thought this was it.<br />
<br />
NB: The return code - value of $0 - is 1639. I should have mentioned this before.  I Google'd this but haven't found anything yet.  Does this ring a bell?<br />
<br />
NB2: This installer is for a specific project for one of our customers that uses an older version of our software (Progress Apama) with 1.5_10.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">9th June 2009, 17:57</div></div><div class="posttext">OK, so msiexec doesn't like spaces in it's parameters.<br />
I wasn't able to work around this by using quotes.<br />
But I got it working using the short &quot;DOS&quot; version of a path, like c:\progra~1:File &quot;jre-1_5_0_10-windows-i586-p.exe&quot;<br />
GetFullPathName /SHORT $0 $INSTDIR<br />
ExecWait '&quot;$OUTDIR\jre-1_5_0_10-windows-i586-p.exe&quot; /s /v$\&quot;/qn ADDLOCAL=ALL IEXPLORER=1 MOZILLA=1 INSTALLDIR=$0\jre /L $0\jre.log$\&quot;' $1<br />
<br />
Not sure if it works on Vista though...<br />
<br />
Else you have to install it to a path without spaces...<br />
<br />
JP</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fmbulah</div><div class="date">9th June 2009, 18:34</div></div><div class="posttext">Eureka ... this worked! Now I don't have to jump out the MS Window. :)<br />
<br />
Thanks a ton ... your help is truly appreciated and your perseverance is to be commended.<br />
<br />
With apologies to all MS devotees out there, MS continues to be the bane of our existence well into the 21st Century. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">9th June 2009, 19:20</div></div><div class="posttext">You're welcome, I'm glad I could help.<br />
<br />
BTW, I forgot to search for the obvious thing: an escape character for msiexec.<br />
It appears to be \&quot;.<br />
Well, for NSIS this results in \$\&quot;.<br />
Now the full line would become:ExecWait '&quot;$OUTDIR\jre-1_5_0_10-windows-i586-p.exe&quot; /s /v$\&quot;/qn ADDLOCAL=ALL IEXPLORER=1 MOZILLA=1 INSTALLDIR=\$\&quot;$INSTDIR\jre\$\&quot; /L \$\&quot;$INSTDIR\jre.log\$\&quot;$\&quot;' $0It works, but really hard to read.<br />
The choice is yours ;-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fmbulah</div><div class="date">9th June 2009, 23:40</div></div><div class="posttext">Thanks again and duly noted.  <br />
<br />
But I think I may just quit while I'm ahead at this point. :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>