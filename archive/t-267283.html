<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Simple Email Parsing Code, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Simple Email Parsing Code NSIS Discussion" />
	
	<title> Simple Email Parsing Code [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Simple Email Parsing Code</div>
<hr />
<div class="pda"><a href="t-267283.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267283">Simple Email Parsing Code</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">99999999</div><div class="date">7th March 2007, 01:32</div></div><div class="posttext">VAR $USEREMAILADDRESS<br />
<br />
Function CheckUserEmailAddress<br />
<br />
    StrCpy $R1 $USEREMAILADDRESS<br />
    StrCpy $R2 &quot;&quot;<br />
    StrCpy $R3 &quot;&quot;<br />
    #count the number of @'s more than one is invalid, less than one is invalid<br />
    ${WordFind} &quot;$USEREMAILADDRESS&quot; &quot;@&quot; &quot;*&quot; $R1<br />
    StrCmp &quot;1&quot; &quot;$R1&quot; lbl_check2 lbl_error<br />
lbl_check2:<br />
    #count the number of words delimited by @ it should be 2.<br />
    ${WordFind} &quot;$USEREMAILADDRESS&quot; &quot;@&quot; &quot;#&quot; $R1<br />
    StrCmp &quot;2&quot; &quot;$R1&quot; lbl_check3 lbl_error<br />
lbl_check3:<br />
    #Split the words into user and domain<br />
    ${WordFind} &quot;$USEREMAILADDRESS&quot; &quot;@&quot; &quot;0&quot; $R2<br />
    ${WordFind} &quot;$USEREMAILADDRESS&quot; &quot;@&quot; &quot;1&quot; $R3<br />
    <br />
    #Determine if either of the fields contain special RFC822 characters<br />
    ${StrFilter} &quot;$R2&quot; &quot;&quot; &quot;&quot; '()&lt;&gt;,;:\&quot;[]' $R1<br />
    StrCmp &quot;$R2&quot; &quot;$R1&quot; 0 lbl_error<br />
    <br />
    ${StrFilter} &quot;$R3&quot; &quot;&quot; &quot;&quot; '()&lt;&gt;,;:\&quot;[]' $R1<br />
    StrCmp &quot;$R3&quot; &quot;$R1&quot; 0 lbl_error<br />
<br />
lbl_check4:<br />
    #Determine the number of fields in user and domain, check to see the number of delimiter is one less than the number of words.<br />
    ${WordFind} &quot;$R2&quot; &quot;.&quot; &quot;*&quot; $R5<br />
    ${WordFind} &quot;$R2&quot; &quot;.&quot; &quot;#&quot; $R6<br />
    IntOp $R5 $R5 + 1<br />
    StrCmp &quot;$R5&quot; &quot;$R6&quot; 0 lbl_error<br />
<br />
    ${WordFind} &quot;$R3&quot; &quot;.&quot; &quot;*&quot; $R5<br />
    ${WordFind} &quot;$R3&quot; &quot;.&quot; &quot;#&quot; $R6<br />
    IntOp $R5 $R5 + 1<br />
    StrCmp &quot;$R5&quot; &quot;$R6&quot; lbl_check5 lbl_error<br />
lbl_check5:<br />
    # make sure there is at least one &quot;.&quot; in the domain section.<br />
    ${WordFind} &quot;$R3&quot; &quot;.&quot; &quot;*&quot; $R1<br />
    IntCmp 1 $R1 lbl_end lbl_end lbl_error<br />
    <br />
    goto lbl_end<br />
lbl_error:<br />
    SetErrors<br />
lbl_end:<br />
FunctionEnd<br />
<br />
<br />
This function takes the contents of &quot;$USEREMAILADDRESS&quot; and then sets the error flag, if the email address did not meet the simple validation rules.  This covers pretty much all you could check, just by looking at an email address as a text string, and without any online verification.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">8th March 2007, 06:47</div></div><div class="posttext">Cool :)<br />
If you post the example at wiki (http://nsis.sf.net/Developer_Center), would be easily accessible by everyone.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Backland</div><div class="date">8th March 2007, 08:12</div></div><div class="posttext">Great function, thanks for contributing :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">99999999</div><div class="date">8th March 2007, 18:44</div></div><div class="posttext">While I have an account on the Wiki, I don't seem to be able to add pages to it. <br />
<br />
Originally posted by Red Wine <br />
Cool :)<br />
If you post the example at wiki (http://nsis.sf.net/Developer_Center), would be easily accessible by everyone.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th March 2007, 18:48</div></div><div class="posttext">Everyone can add pages. See the following FAQ item:<br />
<br />
http://nsis.sourceforge.net/Starting_a_new_page</div></div><hr />


<div class="post"><div class="posttop"><div class="username">99999999</div><div class="date">8th March 2007, 18:59</div></div><div class="posttext">Allrighty  it's at http://nsis.sourceforge.net/Email_Validation_Function   now.  Bit spoiled by the Wiki we have here at work. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">8th March 2007, 19:02</div></div><div class="posttext">URL:<br />
http://nsis.sourceforge.net/Email_Validation_Function<br />
<br />
I think would be nice if you add a complete example of usage as well :)<br />
<br />
edit: Also you need to add it in a category.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">99999999</div><div class="date">4th April 2007, 21:06</div></div><div class="posttext">Originally posted by Red Wine <br />
URL:<br />
http://nsis.sourceforge.net/Email_Validation_Function<br />
<br />
I think would be nice if you add a complete example of usage as well :)<br />
<br />
edit: Also you need to add it in a category.  <br />
<br />
<br />
Thanks for converting this for me RedWine.  I happened to look here for this type of code, and couldn't find it, so I just wanted to give back to you use for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">5th April 2007, 17:52</div></div><div class="posttext">well, this function is still to be optimized :)<br />
<br />
(write the checks on your own, without using the WordFind stuff, they add a lot of overhead by unused functionality)<br />
<br />
maybe i'll do that some time ;)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>