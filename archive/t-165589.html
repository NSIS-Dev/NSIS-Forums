<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Sysinfo and Win2000 fails, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Sysinfo and Win2000 fails NSIS Discussion" />
	
	<title> Sysinfo and Win2000 fails [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Sysinfo and Win2000 fails</div>
<hr />
<div class="pda"><a href="t-165589.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=165589">Sysinfo and Win2000 fails</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">blayde</div><div class="date">19th January 2004, 10:10</div></div><div class="posttext">Please help if you can, For me SunJammers SysInfo dll does not work on windows 2000. <br />
<br />
 i have compiled the test that comes with the dll, and every single call fails.  the error roughly reads &quot;cannont load c:\test\sysinfo.dll&quot;<br />
<br />
the output i get instead of the expected numbers is the the name of the 'attribute' i was looking for.  eg for<br />
<br />
!insertmacro GetSysVer 'MajorVersion'<br />
StrCpy $VerOSMajor $9<br />
 <br />
The variable $VerOSMajor will end up containg the string &quot;MajorVersion&quot;<br />
<br />
it works fine on my work machine, winXP, but i just formatted and setup a Win2k Sp3 machine and it fails on that.<br />
<br />
i can only assume it's the line, from the example with the dll, containing CallInstDLL in<br />
<br />
!macro GetSysVer VALUE<br />
	Push ${VALUE}<br />
	CallInstDLL &quot;$R0&quot; GetSystemVersionValue<br />
	Pop $9<br />
	DetailPrint 'GetSystemVersionValue: ${VALUE}: $9'<br />
!macroend<br />
<br />
that is failing, since i see nowhere else for the error to occur.<br />
<br />
i've tried hardcoding a location for the dll, and researched the archives for anything relating to 'sysinfo' or 'CallInstDLL' but with no solution.<br />
<br />
help :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">19th January 2004, 14:45</div></div><div class="posttext">For normal plug-ins that extend your installer, use the plug-in command plugin::function.<br />
<br />
Example:<br />
<br />
SystemInfo::GetSystemVersionValue<br />
<br />
You also don't have to use a plug-in to get the Windows version, you can also use the GetWindowsVersions function (see the Users Manual).<br />
<br />
CallInstDLL is intented to call a DLL file that already exists on the system. To use it, you will have to include the file, extract it to a temporary location and delete it afterwards. Of course you can't use a run-time variable with the location of the DLL on your system, it should be on the users system.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">blayde</div><div class="date">20th January 2004, 06:53</div></div><div class="posttext">thanks, i was looking doing that but i wasn't sure how to go about it.  but i've changed the code, now i know it can be done.<br />
<br />
problem : the code works fine on my machine ( xp ), but it still fails on win2000.  i no longer get any message about the dll failing to load, i guess becuase that is now left up to NSIS.  but the output from the functions is still the same ( as above ).<br />
<br />
Help :)<br />
<br />
Note : the change i did is simple, but i can post an attachment of the entire test .nsi if need be.<br />
<br />
the function above changed to<br />
<br />
!macro GetSysVer VALUE<br />
    SysInfo::GetSystemVersionValue ${VALUE}<br />
    Pop $9<br />
    DetailPrint 'GetSystemVersionValue: ${VALUE}: $9'<br />
!macroend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">20th January 2004, 08:11</div></div><div class="posttext">Using the same VALUE? Tried the GetWindowsVersion function?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">blayde</div><div class="date">20th January 2004, 08:22</div></div><div class="posttext">yes, it worked to a greater degree but not perfectly, but i think that was down to me being a noob.  my code, using GetWindowsVersion, _had_ detected that it was 200x.  i had code that tested for &quot;00&quot; and &quot;03&quot;, but wasn't working right.  it was as i was about to debug it that i found SysInfo.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">blayde</div><div class="date">20th January 2004, 16:39</div></div><div class="posttext">i've now successfully used GetWindowsVersion and the line<br />
[code]<br />
ReadRegStr $R6 HKLM &quot;Software\Microsoft\Windows Nt\CurrentVersion&quot; CSDVersion<br />
[\code]<br />
to get the version and service pack of windows.<br />
<br />
so _my_ problem of being able to get those things is gone, but the issue still stands.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>