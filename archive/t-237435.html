<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" .Net installation of specific version, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  .Net installation of specific version NSIS Discussion" />
	
	<title> .Net installation of specific version [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  .Net installation of specific version</div>
<hr />
<div class="pda"><a href="t-237435.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=237435">.Net installation of specific version</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">flakzeus</div><div class="date">7th February 2006, 20:03</div></div><div class="posttext">Could someone look over this function and tell me what is wrong? Basically I want to check and see if the .Net Framework 2.0 is installed, if it is not then install it. It is working up to the point that if 2.0 is already installed it trys to install it anyways.  I modified the example they have on the website just a hair.<br />
<br />
Thank you<br />
<br />
Function .onInit<br />
  Call GetDotNETVersion<br />
  Pop $0<br />
  ${If} $0 == &quot;not found&quot;<br />
            MessageBox MB_OKCANCEL &quot;We have detected that you do not have Microsoft .NET Framework 2.0 Installed. Press OK to install .NET Framework.&quot; IDOK installNET IDCANCEL 0<br />
    Abort<br />
  ${EndIf}<br />
 <br />
  StrCpy $0 $0 &quot;&quot; 1 # skip &quot;v&quot;<br />
 <br />
  ${VersionCompare} $0 &quot;2.0&quot; $1<br />
  ${If} $1 == 2<br />
            MessageBox MB_OKCANCEL &quot;We have detected that you do not have Microsoft .NET Framework 2.0 Installed. Press OK to install .NET Framework.&quot; IDOK installNET IDCANCEL 0<br />
    Abort<br />
  ${EndIf}<br />
	installNET:<br />
            SetOutPath &quot;$INSTDIR\bin&quot;<br />
            SetOverwrite ifnewer<br />
            File &quot;c:\Program Files\Progam\bin\dotnetfx.exe&quot;<br />
            ExecWait '&quot;$INSTDIR\bin\dotnetfx.exe&quot;'<br />
FunctionEnd<br />
 <br />
Function GetDotNETVersion<br />
  Push $0<br />
  Push $1<br />
 <br />
  System::Call &quot;mscoree::GetCORVersion(w .r0, i ${NSIS_MAX_STRLEN}, *i) i .r1&quot;<br />
  StrCmp $1 &quot;error&quot; 0 +2<br />
    StrCpy $0 &quot;not found&quot;<br />
 <br />
  Pop $1<br />
  Exch $0<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th February 2006, 10:05</div></div><div class="posttext">You overwrite the result of GetDotNETVersion with nothing, if .NET is installed. You should use LogicLib (${If}, ${AndIf}, etc.) for the entire logic of that function.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>