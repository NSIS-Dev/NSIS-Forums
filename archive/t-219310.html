<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How set charset for font in Installation?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How set charset for font in Installation? NSIS Discussion" />
	
	<title> How set charset for font in Installation? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How set charset for font in Installation?</div>
<hr />
<div class="pda"><a href="t-219310.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=219310">How set charset for font in Installation?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">20th June 2005, 19:08</div></div><div class="posttext">How set charset for font in Installation?<br />
<br />
I need set charset in Installation after selection of language in language dialog.<br />
<br />
How can I do it?<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zozooo</div><div class="date">20th June 2005, 19:45</div></div><div class="posttext">SetFont &quot;fontname&quot; size</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pidgeot</div><div class="date">20th June 2005, 20:30</div></div><div class="posttext">Setting the font is not the same as settting the charset.<br />
<br />
As far as I'm aware, NSIS can only use the system charset. So basically, only users with Shift-JIS as their system charset can see Japanese text, etc.<br />
<br />
Of course, this is dependant on the end-user system, not the system the installer was compiled on.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">20th June 2005, 20:30</div></div><div class="posttext">I need set CHARSET of font! but not size</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">23rd June 2005, 08:55</div></div><div class="posttext">Who knows how I can do it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd June 2005, 11:18</div></div><div class="posttext">It's always DEFAULT_CHARSET. If you want to change it, you can call CreateFont using the System plug-in and set the font for all the controls on your own.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">23rd June 2005, 14:07</div></div><div class="posttext">Pleeese, give small example of using function CreateFont for setting CHARSET.<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">30th June 2005, 12:30</div></div><div class="posttext">kichik, please, give example of using function CreateFont from System plug-in.<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th June 2005, 19:12</div></div><div class="posttext">It's not that hard...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pidgeot</div><div class="date">30th June 2005, 20:07</div></div><div class="posttext">This full list of charset defines might come in handy. Values taken from the help file for Delphi 7 and verified with MSDN Library April 2003.<br />
!define ANSI_CHARSET 0<br />
!define DEFAULT_CHARSET 1<br />
!define SYMBOL_CHARSET 2<br />
!define MAC_CHARSET 77<br />
!define SHIFTJIS_CHARSET 128<br />
!define HANGEUL_CHARSET 129<br />
!define JOHAB_CHARSET 130<br />
!define GB2312_CHARSET 134<br />
!define CHINESEBIG5_CHARSET 136<br />
!define GREEK_CHARSET 161<br />
!define TURKISH_CHARSET 162<br />
!define VIETNAMESE_CHARSET 163<br />
!define HEBREW_CHARSET 177<br />
!define ARABIC_CHARSET 178<br />
!define BALTIC_CHARSET 186<br />
!define RUSSIAN_CHARSET 204<br />
!define THAI_CHARSET 222<br />
!define EASTEUROPE_CHARSET 238<br />
!define OEM_CHARSET 255</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">4th July 2005, 14:23</div></div><div class="posttext">I have next code<br />
<br />
<br />
Function SetCustomOwn<br />
  !insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;${PAGE_OWN}&quot;<br />
<br />
  Pop $hwnd <br />
<br />
  GetDlgItem $DlgItem $hwnd ${ITEM_GROUPBOX_OWN}<br />
  System::Call &quot;gdi32::CreateFont(i 0, i 0, i 0, i 0, i 0, i 0, i 0, i 0, \<br />
  i ${EASTEUROPE_CHARSET}, i ${OUT_DEFAULT_PRECIS}, \<br />
  i ${CLIP_DEFAULT_PRECIS}, i ${DEFAULT_QUALITY}, \<br />
  i ${DEFAULT_PITCH}, t 'Tahoma') i .r0&quot;<br />
  SendMessage $DlgItem ${WM_SETFONT} $0 0 <br />
  ; SendMessage $DlgItem ${WM_SETFONT} $0 1<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_SHOW<br />
FunctionEnd<br />
<br />
<br />
BUT it has no effect.<br />
What's problem?<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th July 2005, 20:40</div></div><div class="posttext">Does $DlgItem contain a valid value? Did you include WinMessages.nsh? Did you try setting another font but the default Tahoma to see if it's just the charset that's not set? Would be easier to see why it has no effect with a full example.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">6th July 2005, 09:01</div></div><div class="posttext">$DlgItem contains valid value - I checked it by using <br />
ShowWindow $DlgItem 0<br />
WinMessages.nsh was included.<br />
I've tried &quot;Tahoma&quot;, &quot;Arial&quot;, &quot;Courier New&quot; but result the same.<br />
Function SetCustomA<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;${PAGE_DATABASE}&quot; \<br />
    &quot;${FLD_IMG_EXISTING_DATABASE}&quot; &quot;Text&quot; \<br />
    &quot;$TEMP\${IMG_EXISTING_DATABASE}&quot;<br />
<br />
  !insertmacro MUI_HEADER_TEXT &quot;$(TEXT_IO_TITLE)&quot; &quot;$(TEXT_IO_SUBTITLE_DATABASE)&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;${PAGE_DATABASE}&quot;<br />
<br />
  Pop $hwnd ; hwnd of dialog<br />
<br />
  GetDlgItem $DlgItem $hwnd ${ITEM_GROUPBOX_DB}<br />
  SendMessage $DlgItem ${WM_SETTEXT} 0 &quot;STR:$(CAPTION_GROUPBOX_DB)&quot;<br />
<br />
  System::Call &quot;gdi32::CreateFont(i 0, i 0, i 0, i 0, i 0, i 0, i 0, i 0, \<br />
  i 0, i ${OUT_DEFAULT_PRECIS}, \<br />
  i ${CLIP_DEFAULT_PRECIS}, i ${DEFAULT_QUALITY}, \<br />
  i ${DEFAULT_PITCH}, t 'Courier New') i .r0&quot;<br />
  SendMessage $DlgItem ${WM_SETFONT} $0 0<br />
<br />
  GetDlgItem $DlgItem $hwnd ${ITEM_EXISTING_DATABASE}<br />
  SendMessage $DlgItem ${WM_SETTEXT} 0 &quot;STR:$(CAPTION_EXISTING_DATABASE):&quot;<br />
  GetDlgItem $DlgItem $hwnd ${ITEM_DATABASE_DESCRIPTION}<br />
  SendMessage $DlgItem ${WM_SETTEXT} 0 &quot;STR:$(MSG_DATABASE_DESCRIPTION)&quot;<br />
<br />
  SendMessage $DlgItem ${WM_SETFONT} $0 0<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_SHOW<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th July 2005, 20:19</div></div><div class="posttext">Seems fine. I'd try with 1 in lParam. Doesn't hurt updating it the control. If it still doesn't work, attach a complete example.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">8th July 2005, 07:18</div></div><div class="posttext">I've tried, but result the same.<br />
<br />
Sorry, but I can't attach a complete example, because it's policy of our company.<br />
I can attach screenshot, but I don't know how I can do it.<br />
Please, say to me how.<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pidgeot</div><div class="date">8th July 2005, 07:51</div></div><div class="posttext">You're not being asked to post the entire script you're working on. You're only being asked to show a script that shows the problem. The script doesn't have to do anything else, but it needs to be compileable as-is. Alternatively, use the code you've already posted to create a new, otherwise unrelated script around that function that still shows the problem.<br />
<br />
If your company has a policy against that, you wouldn't even have been allowed to post that function above.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">8th July 2005, 08:54</div></div><div class="posttext">You can see problem code above.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pidgeot</div><div class="date">8th July 2005, 09:04</div></div><div class="posttext">You seem to be misunderstanding me.<br />
<br />
If we're to help properly, we'll need you to create a new, complete script that uses the function, but which doesn't work as intended. It is not enough to just see the function, as the reason it fails may be due to something you do before calling the function.<br />
<br />
Because YOU are having the problem, YOU will have to make a complete working example script (obviously showing the problem) that we can compile and test without any modifications.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">8th July 2005, 09:22</div></div><div class="posttext">I very well understand you.<br />
But problem only in one function CreateFont.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th July 2005, 10:56</div></div><div class="posttext">Originally posted by anonym <br />
I very well understand you.<br />
But problem only in one function CreateFont. If you say the problem is only in that function, you don't understand Pidgeot. The problem might be in another part of the script. That function is far from being stand-alone.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">4th May 2006, 10:53</div></div><div class="posttext">I'm sorry.<br />
Please, see problem code below<br />
<br />
<br />
Name font<br />
OutFile font.exe<br />
<br />
XPStyle on<br />
<br />
Var hwnd<br />
Var DlgItem<br />
<br />
Section<br />
!include WinMessages.nsh<br />
<br />
!define GREEK_CHARSET 161<br />
!define EASTEUROPE_CHARSET 238<br />
<br />
!define OUT_DEFAULT_PRECIS 0<br />
!define CLIP_DEFAULT_PRECIS 0<br />
!define DEFAULT_QUALITY 0<br />
!define DEFAULT_PITCH 0<br />
<br />
System::Call &quot;gdi32::CreateFont(i 0, i 0, i 0, i 0, i 0, \<br />
  i 0, i 0, i 0, i ${EASTEUROPE_CHARSET}, i ${OUT_DEFAULT_PRECIS}, \<br />
  i ${CLIP_DEFAULT_PRECIS}, i ${DEFAULT_QUALITY}, \<br />
  i ${DEFAULT_PITCH}, t 'Tahoma') i .r0&quot;<br />
<br />
GetDlgItem $1 $HWNDPARENT 1<br />
SendMessage $1 ${WM_SETFONT} $0 1<br />
<br />
  GetDlgItem $DlgItem $HWNDPARENT 1028<br />
  SendMessage $DlgItem ${WM_SETFONT} $0 1<br />
  SendMessage $DlgItem ${WM_SETTEXT} 0 &quot;STR:***283;š***269;***345;žýáíéú***367;&quot;<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th May 2006, 11:04</div></div><div class="posttext">Still works fine for me when changing EASTEUROPE_CHARSET to HEBREW_CHARSET and changing the text to Hebrew. Make sure the file is saved with the correct codepage. Try saving it using Notepad and select ANSI encoding in the save dialog.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">4th May 2006, 11:09</div></div><div class="posttext">It works on your computer because you have Hebrew Windows.<br />
You try my code without changes.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th May 2006, 11:16</div></div><div class="posttext">I can't try your code without changes because my non-Unicode codepage is Hebrew and because the characters I copy from the web browser depend on its selected codepage which is probably not the same as yours.<br />
<br />
If it doesn't work on your computer because you don't have eastern european codepage selected, then that's the problem. You can't display characters of a different codepage then your selected codepage without Unicode. NSIS is not Unicode enabled.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">4th May 2006, 11:32</div></div><div class="posttext">I know that NSIS is not Unicode, but Delphi 7 also is not Unicode, but it can displays in different codepages by using different charsets. Charsets uses special for it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th May 2006, 11:50</div></div><div class="posttext">I don't know exactly what Delphi does, but if it's does not create a full blown Unicode application, it can still call the Unicode version of the API.<br />
<br />
As far as I can tell, what you're trying to do is not possible. Even if you select the charset, the codepage must fit. For example, how will it decode MBCS without the correct codepage?<br />
<br />
But, if you can show me a piece of C code that does this, I'll translate it to NSIS script for you.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>