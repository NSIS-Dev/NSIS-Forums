<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installling/Deleting DLL files?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installling/Deleting DLL files? NSIS Discussion" />
	
	<title> Installling/Deleting DLL files? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installling/Deleting DLL files?</div>
<hr />
<div class="pda"><a href="t-234791.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=234791">Installling/Deleting DLL files?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">LaneinBC</div><div class="date">5th January 2006, 16:23</div></div><div class="posttext">What is the normal method to handle the situation where you have installed a DLL file, lets say into the \Windows\System32 folder. As this could be already be there, then there is no need to re-copy it. So far no problem. Now when you run your product's uninstaller, it will try to delete the DLL file from this folder. But it is required by some other software package, and should not be deleted. How do you handle this with NSIS?<br />
<br />
I assume this is a normal thing that must have already been dealt with..<br />
<br />
Thanks<br />
Lane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th January 2006, 17:25</div></div><div class="posttext">Your best bet is to write a registry key that stores 0 or 1. 1 being that the DLL already existed and it should not be uninstalled. Optionally you could include an uninstall.ini file inside your program's directory and store this information in that using WriteINIStr and ReadINIStr.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LaneinBC</div><div class="date">5th January 2006, 17:29</div></div><div class="posttext">Ok, good idea...<br />
What about the &quot;InstallLib&quot; macro. Is this for this purpose?<br />
<br />
Lane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhaelochon</div><div class="date">5th January 2006, 17:34</div></div><div class="posttext">Microsoft addressed this issue with the concept of shared DLLs. Take a look at appendix B (http://nsis.sourceforge.net/Docs/AppendixB.html) of the NSIS docs for info about how to use InstallLib and UnInstallLib with shared DLLs.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">5th January 2006, 17:42</div></div><div class="posttext">If we are talking about shared dlls, MSDN says following about 'Usage counting': When a component is first installed, the setup program or installer DLL creates a value under the following key for each file in that component that is not already on the system:<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\SharedDlls<br />
And 'Removing an Application': An uninstall program should complete the following steps: <br />
Remove all information used by the application from the registry. If decrementing a DLL's usage count results in a usage count of zero, the uninstall program should display a message offering to delete the DLL or save it in case it may be needed later...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LaneinBC</div><div class="date">5th January 2006, 18:19</div></div><div class="posttext">Ok, That seems to make sense (about the registry entries for shared DLL's). I havn't looked, but would this be what the InstallLib macro might be doing???<br />
<br />
Lane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhaelochon</div><div class="date">5th January 2006, 18:37</div></div><div class="posttext">Yes, Lane. That's what InstallLib and UnInstallLib are for.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>