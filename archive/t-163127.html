<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Unistall silent option and desktop refresh, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Unistall silent option and desktop refresh NSIS Discussion" />
	
	<title> Unistall silent option and desktop refresh [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Unistall silent option and desktop refresh</div>
<hr />
<div class="pda"><a href="t-163127.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=163127">Unistall silent option and desktop refresh</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Raj2003</div><div class="date">4th January 2004, 02:49</div></div><div class="posttext">Hi,<br />
<br />
NSIS Version: NSIS20a7<br />
<br />
When user install a new version, I check the user already has older version of our product so that I can do a upgrade. Here upgrade is install new version and uninstall the older version!<br />
<br />
All works fine if I do the followng:<br />
1. install new version<br />
ExecWait '&quot;$0\Uninstall.exe&quot; _=$0'<br />
2. uninstall older version.<br />
<br />
If the do the following, I get the desktop refresh issue:<br />
1. install new version<br />
ExecWait '&quot;$0\Uninstall.exe&quot; /S _=$0'<br />
2. uninstall /S older version - now my destop icon is still displayed and if I do a manual refresh it goes away (right mouse button on desktop and clik &quot;Refresh&quot;). So the uninstall works fine but no refresh!<br />
<br />
NOTE: Without /S option it refreshes properly.<br />
<br />
In my *.nsi script I tried the following to refresh the desktop by SendMessage:<br />
SendMessage 65535 26 0 0 ;<br />
<br />
Screen flikers (refresh happens) but my old Icon is still visible.<br />
<br />
Someone help me to resolve this issue.<br />
<br />
Thanks....<br />
Raj<br />
:D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">4th January 2004, 11:14</div></div><div class="posttext">That is weird. Are you the code is executed succesfully? Try to add a messagebox.<br />
<br />
You are also using a very old alpha version of NSIS 2. Upgrading is highly recommended.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Raj2003</div><div class="date">5th January 2004, 03:31</div></div><div class="posttext">Installed the latest NSIS 2.0 RC1 and tested the same, It seems the problem still exists.<br />
<br />
Any quick fix?<br />
<br />
Thanks,<br />
Raj</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">5th January 2004, 08:10</div></div><div class="posttext">Can you post the script code? The desktop should refresh automatically. Maybe it's a problem with your system, try another computer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scully13</div><div class="date">9th June 2004, 13:22</div></div><div class="posttext">I couldn't get the &quot;SendMessage 65535 26 0 0&quot; to work either from a script. So, I wrote a DLL to refresh the desktop for me. I've attached it here with source if anybody else needs it. I only tested it under Win XP Pro so if anybody has any problems with it let me know. I also included an example script that creates 2 shortcuts on the desktop but 3 show up. Then it refreshes the desktop to only show the 2 that should be there. The bug appears to be a Windows bug because you can recreate the same problem by manually creating the shortcuts too. There are other instances that will cause the desktop shortcuts to mess up but this eaxmple was the easiest to recreate and test with.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>