<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to delete LOCALAPPDATA for all users, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to delete LOCALAPPDATA for all users NSIS Discussion" />
	
	<title> How to delete LOCALAPPDATA for all users [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to delete LOCALAPPDATA for all users</div>
<hr />
<div class="pda"><a href="t-314700.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=314700">How to delete LOCALAPPDATA for all users</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Armatron</div><div class="date">18th November 2009, 18:34</div></div><div class="posttext">Hi everyone,<br />
<br />
I'm trying to delete a whole directory inside $LOCALAPPDATA when I run the uninstaller for my app. The problem is that this only works for one user.<br />
<br />
Since I request admin level to run the installer, just the admin's LOCALAPPDATA gets affected by this delete. Even if a standard user originally runs the installer, the elevation request then switches to the admin user. And that's why I only get to delete the admin's LOCALAPPDATA.<br />
<br />
I noticed that using 'SetShellVarContext all' didn't work to make this delete universal (even though it helped me create/delete the shortcuts I created for all users).<br />
<br />
So, would anybody know a way to delete LOCALAPPDATA for ALL users? Or at least for the standard user that originally runs the process before elevating to admin process?<br />
<br />
Thanks in advance :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">18th November 2009, 19:08</div></div><div class="posttext">LOCALAPPDATA is, as the name suggests, a local per-user directory. The all users directory is called APPDATA.<br />
<br />
I can think of three ways to solve your problem.<br />
1) Use EnumUsersReg and try to get the directory location from registry. There is a very large chance that this will NOT work properly on all machines out there.<br />
2) Use the UAC plugin to delete the local directory directly, from user level. This will definitely work, but only for the one user starting the installer, not for any other users that might exist on the machine. Also, this should take a bit more time to implement correctly.<br />
3) Create a textfile in $instdir, use the accesscontrol plugin to enable write privileges for all users on that file, and have your software save the location of LocalAppData to that file. Read the file during uninstallation, so you'll know which directory to delete.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">19th November 2009, 08:39</div></div><div class="posttext">Run your (un)installer without admin rights ? (RequestExecutionLevel)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>