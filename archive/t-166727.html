<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How disable directory field on MUI_PAGE_DIRECTORY?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How disable directory field on MUI_PAGE_DIRECTORY? NSIS Discussion" />
	
	<title> How disable directory field on MUI_PAGE_DIRECTORY? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How disable directory field on MUI_PAGE_DIRECTORY?</div>
<hr />
<div class="pda"><a href="t-166727.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=166727">How disable directory field on MUI_PAGE_DIRECTORY?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">26th January 2004, 15:12</div></div><div class="posttext">I'm using MUI<br />
<br />
How disable directory field on MUI_PAGE_DIRECTORY?<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">26th January 2004, 15:27</div></div><div class="posttext">if i understand you correctly, this makes no sense at all. either leave the directory page or use it as is.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th January 2004, 16:11</div></div><div class="posttext">This has been asked before. Use EnableWindow in the show function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">26th January 2004, 16:38</div></div><div class="posttext">What item_id of directory field?<br />
<br />
Next code not work:<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW MyFuncDir<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
<br />
Function MyFuncDir<br />
  FindWindow $hwnd &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
  GetDlgItem ${TEMP} $hwnd 1202<br />
  EnableWindow ${TEMP} 0<br />
FunctionEnd<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th January 2004, 16:45</div></div><div class="posttext">1019</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">26th January 2004, 17:20</div></div><div class="posttext">Thank you very much !!!<br />
<br />
Where I can find all item_id?<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th January 2004, 17:28</div></div><div class="posttext">See resource.h or use a resource hacker to view the dialogs in the Contrib\UIs folder.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anonym</div><div class="date">26th January 2004, 18:44</div></div><div class="posttext">Thank you Joost Verburg<br />
<br />
All works perfectly</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">31st January 2005, 01:37</div></div><div class="posttext">hello, I'm trying to do it to...<br />
<br />
I do not completely understand what to do, and this code does not work...<br />
<br />
can you mr anonym please give the complete code working ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">31st January 2005, 10:11</div></div><div class="posttext">!define MUI_PAGE_CUSTOMFUNCTION_SHOW MyFuncDir<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
<br />
Function MyFuncDir<br />
FindWindow $R0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
GetDlgItem $R1 $R0 1019<br />
EnableWindow $R1 0<br />
FunctionEnd-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">31st January 2005, 10:19</div></div><div class="posttext">thx very much...<br />
<br />
this deactivates the field, but, not the &quot;browse&quot; button --&gt; I still can change the $INSTDIR<br />
<br />
have you got the value of the &quot;browse&quot; button --&gt; though I can really disable the choice ?<br />
(I think with just this value I could now do it :p )<br />
<br />
<br />
<br />
<br />
why doing this and not skipping this page ?<br />
--&gt; because of the &quot;proceed&quot; button... (uninstall or reinstall or install)<br />
this page is juste before the instfiles page, so I have to show that you're going to install or uninstall (and not only display a next page)<br />
<br />
<br />
---&gt; because of the reinstallation :<br />
you reinstall and I show where is your software, (I don't want them ta change the INSTDIR if they reinstall)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">31st January 2005, 17:28</div></div><div class="posttext">where can I find this value ?<br />
<br />
what is resource.h ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">1st February 2005, 10:40</div></div><div class="posttext">up :D<br />
<br />
i'me certainly annoying, but this is the last thing missing to me to finish my installer...<br />
<br />
the question is :<br />
<br />
<br />
<br />
<br />
how to disable the &quot;browse&quot; button in the MUI directory page ???</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">1st February 2005, 11:42</div></div><div class="posttext">try this (http://www.catch22.net/software/winspy.asp) and then drag the finder over the browse button and look for the 'Control ID' once the window details have been found.<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">1st February 2005, 12:17</div></div><div class="posttext">well I'vbe done what you aksed me to do...<br />
<br />
I have a control ID :<br />
000003E9<br />
<br />
and now ? :p<br />
because the control ID of the install dir text is<br />
000003FB<br />
and this is not the value I entered to disable it...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">1st February 2005, 12:21</div></div><div class="posttext">year 3FB in hex = 1019 in decimal !<br />
<br />
super...<br />
<br />
3E9 = 1001<br />
<br />
I'm gonna try 1001 !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">1st February 2005, 12:48</div></div><div class="posttext">this is the perfect code to disable directory page :<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW MyFuncDir<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
...<br />
<br />
Function MyFuncDir<br />
	FindWindow $R0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
	GetDlgItem $R1 $R0 1019<br />
	EnableWindow $R1 0<br />
	FindWindow $R0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
	GetDlgItem $R1 $R0 1001<br />
	EnableWindow $R1 0<br />
FunctionEnd<br />
<br />
<br />
thx to everybody !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">1st February 2005, 13:44</div></div><div class="posttext">heh, forgot to say it's all in hexadecimal. glad it's working now :)<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">1st February 2005, 13:48</div></div><div class="posttext">Ok, I know this is a bit off topic, but I just have to ask:<br />
<br />
A MUI DIRECTORY page basiclaly just has 2 options: a text field for a description and a place to enter a path.  There are no other options a user can click on, etc. that will make the select direcotry part become usable.  Which leads to ask why even bother displaying the page in the first place?<br />
<br />
I'm sure you have your reasons; I'm just being curious...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">1st February 2005, 14:16</div></div><div class="posttext">1) if you have already installed<br />
if you lanch the installer (and the uninstaller too for me)<br />
they can propose you to reinstall, and if you want to reinstall<br />
you choose your components (add, remove)<br />
you go now to the directory page<br />
<br />
<br />
and with a disabled directory page you can announce where the software will be reinstalled-modified<br />
<br />
<br />
for a difficulty reason, and too because it's not logical, I don't want them to change the install dir<br />
---&gt; disabling directory page<br />
<br />
<br />
2) the directory page button is the install button...<br />
So if you skip it, no more &quot;install button&quot;... just next buttons...<br />
and it's more &quot;clear&quot; to disable the fields of the directory page than to change the buttons of another page<br />
<br />
<br />
<br />
these are my reasons ;)<br />
<br />
<br />
ps : I'll come back and give all my script file when the software will be released... 10th february 2005</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aj kwak</div><div class="date">21st April 2005, 15:10</div></div><div class="posttext">Function MyFuncDir<br />
  FindWindow $hwnd &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
 <br />
<br />
nice truck with winspy.<br />
<br />
but how do you find de window(here 32770) or 8002hex ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">21st April 2005, 17:42</div></div><div class="posttext">#32770 is a standard classname for all dialog windows created by windows. if you do the same over a messagebox you should see the classname is the same. but basically it's just how the OS is designed<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunil_muppirala</div><div class="date">3rd May 2005, 07:54</div></div><div class="posttext">i tried the code given by  superwan<br />
<br />
i still cant disable the browse button and the install location field.<br />
pls help me out</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aj kwak</div><div class="date">3rd May 2005, 09:04</div></div><div class="posttext">FindWindow $R0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
GetDlgItem $R1 $R0 1019<br />
EnableWindow $R1 0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cerf</div><div class="date">25th November 2005, 22:04</div></div><div class="posttext">Hello there, I recently posted This Thread (http://forums.winamp.com/showthread.php?threadid=231906&amp;highlight=destination+folder) and now I see, the page can be disabled, but how can I disable it dinamically? I mean, if installRegKey returns that there is a previous installation, then disable the controls, but if it's a fresh installation let the user choose.<br />
<br />
Thanks!<br />
<br />
Cërf.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th November 2005, 12:10</div></div><div class="posttext">Why not simply skip (http://nsis.sourceforge.net/Skipping_Pages) the directory page if it's not needed? If you really want to disable it, add an if block around the above code:!include LogicLib.nsh<br />
#...<br />
${If} $INSTDIR != &quot;&quot;<br />
  # disable<br />
${EndIf}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dandaman32</div><div class="date">26th November 2005, 18:26</div></div><div class="posttext">If you're using the $hwnd var, you need to declare it first: Var hwndThat could be the source of your problems.<br />
<br />
-dandaman32</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cerf</div><div class="date">28th November 2005, 14:41</div></div><div class="posttext">Thanks Hichik!<br />
You're right, now my problem is that I can't seem to find out (and this is embarrasing) how to assign $INSTDIR a default value, when it's a fresh installation.<br />
<br />
Thanks again, Cërf.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">28th November 2005, 16:16</div></div><div class="posttext">!include LogicLib.nsh<br />
#...<br />
${If} $INSTDIR != &quot;&quot;<br />
  # disable controls here<br />
  StrCpy $INSTDIR &quot;c:\some\default\folder&quot;<br />
${EndIf}<br />
<br />
<br />
--<br />
<br />
additional note: you don't have to convert from hex to dec.  If WinSpy gives you e.g. the value 403, simply use 0x403 in your NSIS script instead of 1027.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cerf</div><div class="date">28th November 2005, 16:29</div></div><div class="posttext">Thanks Animaether!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">28th November 2005, 19:40</div></div><div class="posttext">wish I knew how to get backslashes into a PHP quote ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cerf</div><div class="date">28th November 2005, 20:15</div></div><div class="posttext">You can't, that's why most people use [ code ][ /code ]<br />
Like this:<br />
<br />
 |\_/|  <br />
<br />
<br />
Cërf.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cerf</div><div class="date">28th November 2005, 20:17</div></div><div class="posttext">The only thing is that there is no syntax coloring : (</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">28th November 2005, 20:25</div></div><div class="posttext">hence why I'm using the PHP tag ;)<br />
<br />
Must be some way - 'll have to dig around the help a bit :)<br />
<br />
Edit: okay, no there isn't :D<br />
silly stripslashes() to remove color-coding-induced backslashes that eats regular backslashes :x</div></div><hr />


<div class="post"><div class="posttop"><div class="username">youn75</div><div class="date">19th December 2005, 14:58</div></div><div class="posttext">I use this useful code :<br />
!define InstallDirRegKey '&quot;HKLM&quot; &quot;Software\${PRODUCT_PUBLISHER}\${CLIENT_NAME}\${PRODUCT_NAME}&quot; &quot;InstallPath&quot;'<br />
InstallDirRegKey ${InstallDirRegKey}<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE DirectoryPre<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW DirectoryPre<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
<br />
Function DirectoryPre<br />
         ReadRegStr $R0 ${InstallDirRegKey}<br />
         StrCmp $R0 &quot;&quot; FullDirectoryPage PartialDirectoryPage<br />
         <br />
         PartialDirectoryPage:<br />
         FindWindow $R1 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
         GetDlgItem $R2 $R1 1019<br />
         EnableWindow $R2 0<br />
         GetDlgItem $R2 $R1 1001<br />
         EnableWindow $R2 0<br />
         <br />
         FullDirectoryPage:<br />
FunctionEnd<br />
-----------------------------------------------------------<br />
First install must write in registry 'InstallPath'.<br />
If this 'InstallPath' exist, directory field and 'Browse' button are disabled on MUI_PAGE_DIRECTORY<br />
<br />
Regards<br />
From Paris,<br />
Yves</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fluidz91</div><div class="date">6th March 2008, 15:18</div></div><div class="posttext">Hi,<br />
<br />
I ve been searching and reading forum for hours without any clue why i can't get it works.<br />
<br />
I'd like to change the Text button of the Components Page &quot;Next &gt;&quot; by &quot;Install &gt;&quot;<br />
<br />
I tried so many different things i m now a little bit messed up.<br />
<br />
<br />
#...<br />
<br />
# Variables<br />
Var hwnd<br />
#...<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW ComponentsShow<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
#!define MUI_PAGE_CUSTOMFUNCTION_SHOW ComponentsShow<br />
# Before or after !insertmacro changes nothing<br />
#...<br />
<br />
Function ComponentsShow<br />
    # CHECK IF SERVER INSTALLED YET TO INSTALL SERVICE/FILES<br />
    #MessageBox MB_OK &quot;$(^Name) : $isInstalled$\nText : $(TEXT_INSTALL)&quot;<br />
    StrCmp $isInstalled &quot;1&quot; 0 +7<br />
        FindWindow $hwnd &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
        Push $R0<br />
        GetDlgItem $R0 $hwnd 1<br />
       #MessageBox MB_OK &quot;$(^Name) : $R0$\nHWND : $hwnd&quot;<br />
        SendMessage $R0 ${WM_SETTEXT} 0 &quot;STR:$(TEXT_INSTALL)&quot;<br />
        Pop $R0<br />
        <br />
FunctionEnd<br />
<br />
#...<br />
<br />
LangString TEXT_INSTALL ${LANG_FRENCH} &quot;&amp;Installer &gt;&quot;<br />
LangString TEXT_INSTALL ${LANG_ENGLISH} &quot;&amp;Install &gt;&quot;<br />
<br />
<br />
<br />
On the Components page, the next button still displays &quot;Suivant &gt;&quot;<br />
C:\NSIS\makensis.exe /VERSION<br />
2.17<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">6th March 2008, 18:44</div></div><div class="posttext">The button is not a child of the sub-dialog, it is located on the main dialog. You can get the handle withGetDlgItem $R0 $HWNDPARENT 1<br />
But NSIS will change the button text according to whether there are other pages before the INSTFILES page. You would only need to change the text if the page(s) before INSTFILES are going to be hidden with abort.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fluidz91</div><div class="date">10th March 2008, 14:16</div></div><div class="posttext">Thx Don,<br />
<br />
sorry but i don't understand the explanation (i m not english native speaker).<br />
I tried first 'GetDlgItem $R0 $HWNDPARENT 1' without FindWindow but with same result (maybe i should retry because i ve done some other changes after).<br />
<br />
i think i forget to say in previous post that i had a mui_page_directory i could also skip. I m gonna try to put the code in the pre function of diretory page (i lack time for the moment and a build is about 15 mn)<br />
<br />
<br />
# Installer pages<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_LICENSE cluf.rtf<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW ComponentsShow<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE DirectoryPre<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_PAGE_FINISH<br />
!insertmacro MUI_UNPAGE_CONFIRM<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
...<br />
<br />
Function ComponentsShow<br />
    # CHECK IF SERVER INSTALLED YET TO INSTALL SERVICE/FILES<br />
    ;MessageBox MB_OK &quot;$(^Name) : $isInstalled$\nText : $(TEXT_INSTALL)&quot;<br />
    StrCmp $isInstalled &quot;1&quot; 0 +7<br />
        FindWindow $hwnd &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
        Push $R0<br />
        GetDlgItem $R0 $hwnd 1<br />
       ;MessageBox MB_OK &quot;$(^Name) : $R0$\nHWND : $hwnd&quot;<br />
        SendMessage $R0 ${WM_SETTEXT} 0 &quot;STR:$(TEXT_INSTALL)&quot;<br />
        Pop $R0<br />
        <br />
FunctionEnd<br />
<br />
Function DirectoryPre<br />
    # CHECK IF SERVER INSTALLED YET TO INSTALL SERVICE/FILES<br />
    StrCmp $isInstalled &quot;1&quot; 0 +1<br />
    Abort # Skip page<br />
FunctionEnd<br />
<br />
<br />
If application is already installed i show the commonents page but next i don't want to show de directory page (that seems to work as expected).<br />
<br />
Thx Anyway...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>