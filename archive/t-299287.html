<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Avoiding a bad way of starting an application on login / startup, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Avoiding a bad way of starting an application on login / startup NSIS Discussion" />
	
	<title> Avoiding a bad way of starting an application on login / startup [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Avoiding a bad way of starting an application on login / startup</div>
<hr />
<div class="pda"><a href="t-299287.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=299287">Avoiding a bad way of starting an application on login / startup</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">JonathansCorner</div><div class="date">28th October 2008, 20:27</div></div><div class="posttext">I have a Tcl script that I want to provide a notification window when someone connects to a port it's listening to and provides specific information, and I'd like to have the script started when the user logs in, or possibly when the computer is started up.<br />
<br />
I'd imagine that if I poked around other resources I could find a bad way to get it to work on my system... and wanted to ask people on this system, who probably know the right way, what's the &quot;best engineering&quot; approach in this case?<br />
<br />
Jonathan (http://JonathansCorner.com/)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">29th October 2008, 01:39</div></div><div class="posttext">I'm unfamiliar with what a TCL script is, but if it is, or can be package in, an executable, then you can use the registry in windows to set it to run at startup.  You can either do this for a particular user by adding a registry entry to HKCU, or do it for all users by adding it to HKLM<br />
<br />
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run<br />
<br />
The other option is to place a shortcut into the &quot;startup&quot; folder of the start menu.  Once again, you can do this under an individual user's start menu or the All Users startmenu.<br />
<br />
If you want to make it easy for the user to enable/disable this feature, you should do it through the start menu.<br />
<br />
The registry is probably the easier method though, and what I would go with.  If I wanted to allow the user to disable the &quot;Run at startup&quot;, then I'd provide a GUI that allows them to do that, and the application would remove the registry entry for them.<br />
<br />
IMO it is a really awful practice to set a program to run at startup and not provide an obvious/intuitive way to let the user disable that feature.  Additionally I'd say that the installer should even have a &quot;Run at startup&quot; checkbox so the user can disable the feature.<br />
<br />
Oh, the other option is to install a Windows Service.  One big difference will be that the above methods will not run the program until a user logs in.  A windows Service can startup before anyone has even logged in, which is great if you need the application to run on a server, where users are not normally logged in.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JonathansCorner</div><div class="date">29th October 2008, 15:11</div></div><div class="posttext">TCL is a scripting language, something of a lesser-known cousin to Perl and Python--it is indeed an executable, although interpreted rather than being a standalone .exe.<br />
<br />
So the installer, to work for the current user, should be something like:<br />
<br />
WriteRegStr HKCU &quot;Software\MicroSoft\Windows\CurrentVersion\Run&quot; &quot;${_APP_NAME}&quot; &quot;${_APP_NAME}&quot;<br />
<br />
Or is part of that a bit off?<br />
<br />
Thanks for your help,<br />
Jonathan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">30th October 2008, 07:34</div></div><div class="posttext">I think that's right, except the value parameter should be the full path to the executable, something like this I think:<br />
<br />
WriteRegStr HKCU &quot;Software\Microsoft\Windows\CurrentVersion\Run&quot; &quot;${_APP_NAME}&quot; &quot;C:\blah\TLC.exe&quot;<br />
<br />
Edit: I'm not sure if registry keys are case sensitive, but I noticed you have MicroSoft instead of Microsoft.  Thought I'd point that out if you have a problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JonathansCorner</div><div class="date">30th October 2008, 14:10</div></div><div class="posttext">Thanks you, in particular for the capitalization note.<br />
<br />
Originally posted by AaronLS <br />
I think that's right, except the value parameter should be the full path to the executable, something like this I think:<br />
<br />
WriteRegStr HKCU &quot;Software\Microsoft\Windows\CurrentVersion\Run&quot; &quot;${_APP_NAME}&quot; &quot;C:\blah\TLC.exe&quot;<br />
<br />
Edit: I'm not sure if registry keys are case sensitive, but I noticed you have MicroSoft instead of Microsoft.  Thought I'd point that out if you have a problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JonathansCorner</div><div class="date">10th December 2008, 22:22</div></div><div class="posttext">WriteRegStr HKCU &quot;Software\Microsoft\Windows\CurrentVersion\Run&quot; &quot;${_APP_NAME}&quot; &quot;C:\blah\TLC.exe&quot;<br />
<br />
Followup question: How, in the uninstaller, do I delete the registry key or part of key created as quoted above? <br />
<br />
Thanks,<br />
Jonathan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">10th December 2008, 23:24</div></div><div class="posttext">Originally posted by JonathansCorner <br />
Followup question: How, in the uninstaller, do I delete the registry key or part of key created as quoted above? <br />
<br />
Thanks,<br />
Jonathan  <br />
<br />
According to the NSIS user manual section 4.9.2.4 it should be something like this:<br />
DeleteRegValue HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Run&quot; &quot;${_APP_NAME}&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JonathansCorner</div><div class="date">11th December 2008, 14:26</div></div><div class="posttext">Originally posted by AaronLS <br />
According to the NSIS user manual section 4.9.2.4 it should be something like this:<br />
DeleteRegValue HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Run&quot; &quot;${_APP_NAME}&quot; Thank you!<br />
<br />
Much appreciated,</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>