<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" INSTDIR and  MUI_PAGE_DIRECTORY behavior problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  INSTDIR and  MUI_PAGE_DIRECTORY behavior problem NSIS Discussion" />
	
	<title> INSTDIR and  MUI_PAGE_DIRECTORY behavior problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  INSTDIR and  MUI_PAGE_DIRECTORY behavior problem</div>
<hr />
<div class="pda"><a href="t-305178.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305178">INSTDIR and  MUI_PAGE_DIRECTORY behavior problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jaridmo</div><div class="date">10th April 2009, 01:21</div></div><div class="posttext">I am using NSIS 2.43<br />
<br />
I have written an install script with the basic components of an installer (PAGE_WELCOME, PAGE_LICENSE, PAGE_COMPONENTS, PAGE_DIRECTORY, PAGE_INSTFILES, and PAGE_FINISH).  I am having a problem with the PAGE_DIRECTORY.<br />
<br />
I understand that the default behavior of the INSTDIR is to keep the end directory of the path and append that to any newly selected path chosen in the Browse directory dialog.  I CANNOT get my script to behave this way.<br />
<br />
I set the INSTDIR in the .onInit function to C:\Biodose<br />
<br />
It shows up correctly in the Directory dialog, but when I browse and select a directory it does not append Biodose to the newly chosen directory.<br />
<br />
From everywhere I have found I read that this should be the behavior as long as there is no trailing backslash (ie C:\Biodose\ should behave as it is now).  I have tried it both ways. <br />
<br />
I have even created a variable called CompanyName and set the INSTDIR to C:\$CompanyName and its still not working correctly.<br />
<br />
The funny thing is that this is the behavior some developers are after, just not me.<br />
<br />
Any Ideas???</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">10th April 2009, 04:51</div></div><div class="posttext">I believe the above is only the case for the InstallDir directive (set outside functions, sections, etc.)<br />
<br />
<br />
!addplugindir &quot;.&quot;<br />
!addincludedir &quot;.&quot;<br />
<br />
!include &quot;nsDialogs.nsh&quot;<br />
!include &quot;winmessages.nsh&quot;<br />
!include &quot;logiclib.nsh&quot;<br />
<br />
!include &quot;MUI2.nsh&quot;<br />
<br />
OutFile &quot;test.exe&quot;<br />
<br />
Page Directory dirPre dirShow dirPost<br />
<br />
InstallDir &quot;$PROGRAMFILES\myApplication&quot;<br />
<br />
Function .onInit<br />
	StrCpy $INSTDIR &quot;$PROGRAMFILES\myOtherApplication&quot;<br />
FunctionEnd<br />
<br />
Function dirPre<br />
	MessageBox MB_OK &quot;Pre: $INSTDIR&quot;<br />
FunctionEnd<br />
Function dirShow<br />
FunctionEnd<br />
Function dirPost<br />
	MessageBox MB_OK &quot;Post: $INSTDIR&quot;<br />
FunctionEnd<br />
<br />
Section<br />
SectionEnd<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
<br />
You should notice that after the directory is picked, the directory text field ends in 'myApplication', as per the IntallDir directive, rathern than 'myOtherApplcation', as per the .onInit-setting of $INSTDIR.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jaridmo</div><div class="date">10th April 2009, 22:32</div></div><div class="posttext">Thank you Animaether - works now!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>