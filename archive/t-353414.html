<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ProgramData Windows 8, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ProgramData Windows 8 NSIS Discussion" />
	
	<title> ProgramData Windows 8 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ProgramData Windows 8</div>
<hr />
<div class="pda"><a href="t-353414.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=353414">ProgramData Windows 8</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Ocrana</div><div class="date">14th December 2012, 03:17</div></div><div class="posttext">Hello,<br />
<br />
my installer use the &quot;C:\ProgramData&quot; folder to install files for all users. But in Windows 8 NSIS do not write to this folder. I use:<br />
<br />
<br />
StrCpy $0 &quot;FoxBurner&quot;<br />
; Retrieving CommonApplicationData path (in $1)<br />
System::Call &quot;shfolder::SHGetFolderPath(i $HWNDPARENT, i 0x0023, i 0, i 0, t.r1)&quot;<br />
StrCpy $APPLICATION_COMMON_FOXBURNER_FOLDER &quot;$1\$0&quot;<br />
	<br />
CreateDirectory $APPLICATION_COMMON_FOXBURNER_FOLDER<br />
# Make the directory &quot;$APPLICATION_COMMON_FOLDER\application name&quot; read write delete accessible by all users<br />
; SID instead of BU as users (it works also on Windows 2000)<br />
AccessControl::GrantOnFile \<br />
      &quot;$APPLICATION_COMMON_FOXBURNER_FOLDER&quot; &quot;(S-1-5-32-545)&quot; &quot;FullAccess + GenericRead + GenericWrite + Delete + AddFile&quot;<br />
		<br />
<br />
<br />
On Windows 8 this C:\ProgramData  only contains a &quot;Microsoft&quot; subfolder but none of the folder I install. Any ideas?<br />
BTW: On Vista/XP/Windows7 everything works fine.<br />
<br />
Ingo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">plaintext</div><div class="date">14th December 2012, 17:18</div></div><div class="posttext">My code looks like this:<br />
<br />
!define CSIDL_COMMON_APPDATA 0x0023        <br />
Var AppDataPath<br />
System::Call &quot;shell32::SHGetFolderPath(0, i ${CSIDL_COMMON_APPDATA}, 0, 0, t .r1)&quot;  <br />
StrCpy $AppDataPath &quot;$1\${PRODUCT_PUBLISHER}\${PRODUCT_NAME}&quot;<br />
CreateDirectory &quot;$AppDataPath&quot;<br />
AccessControl::GrantOnFile &quot;$AppDataPath&quot; &quot;(BU)&quot; &quot;GenericRead + GenericWrite&quot;<br />
<br />
Works as expected.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">14th December 2012, 22:29</div></div><div class="posttext">If everyone needs write access to something in a common folder you probably have a design (and security) issue in your application.<br />
<br />
Also, why not just use setshellvarcontext all?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>