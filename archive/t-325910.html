<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Exec in loop, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Exec in loop NSIS Discussion" />
	
	<title> Exec in loop [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Exec in loop</div>
<hr />
<div class="pda"><a href="t-325910.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=325910">Exec in loop</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">t0rb3n</div><div class="date">13th January 2011, 10:06</div></div><div class="posttext">Hi,<br />
<br />
I'm trying to wrap a suit of installers. Since there may be many changes in the suit, it needs to be customizable by non-programmers.<br />
Thus, my plan is to read a list of file names from a file and execute them, but only the last one gets executed. I tried Exec and nsExec::Exec, same result.<br />
<br />
Here is the relevant part of the script:<br />
<br />
<br />
Section Main<br />
	FileOpen $0 &quot;installers.lst&quot; r<br />
	FileRead $0 $1<br />
	IfErrors end_loop<br />
  loop:<br />
	nsExec::Exec '&quot;$1&quot;'<br />
	Pop $2<br />
	MessageBox MB_OK &quot;$1 returned $2&quot;<br />
	ClearErrors<br />
	FileRead $0 $1<br />
	IfErrors 0 loop<br />
  end_loop:<br />
	FileClose $0<br />
SectionEnd<br />
<br />
<br />
The message box pops up for every item and shows return code &quot;error&quot;, only the last item in the file is actually executed.<br />
Am I doing it wrong? Or is this even intended behavior?<br />
<br />
Thanks in advance!<br />
<br />
<br />
PS: The installer.lst looks like this:<br />
<br />
externals.exe<br />
test.bat<br />
server\apache-tomcat-5.5.27.exe<br />
util\Firefox Setup 3.6.exe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th January 2011, 11:39</div></div><div class="posttext">!include TextFunc.nsh<br />
...<br />
ClearErrors<br />
FileOpen $0 &quot;installers.lst&quot; r<br />
${DoUntil} ${Errors}<br />
  FileRead $0 $1<br />
  ${TrimNewLines} $1 $1<br />
  ${If} ${FileExists} $EXEDIR\$1<br />
    nsExec::Exec `&quot;$EXEDIR\$1&quot;`<br />
    Pop $1<br />
  ${EndIf}<br />
${Loop}<br />
FileClose $0Firstly FileRead reads the newline characters so you must trim them. Secondly I would always use a full path.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">t0rb3n</div><div class="date">13th January 2011, 12:46</div></div><div class="posttext">Works perfectly, thank you so much!<br />
<br />
PS: I hate newlines... : )</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>