<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Check for Windows 7 / Seven, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Check for Windows 7 / Seven NSIS Discussion" />
	
	<title> Check for Windows 7 / Seven [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Check for Windows 7 / Seven</div>
<hr />
<div class="pda"><a href="t-305675.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305675">Check for Windows 7 / Seven</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kando234</div><div class="date">24th April 2009, 08:58</div></div><div class="posttext">Hi,<br />
<br />
is there any way to check if user is running Windows 7 ?<br />
<br />
Thanks<br />
and greets<br />
kando</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">24th April 2009, 09:06</div></div><div class="posttext">WinVer.nsh will give you the version number, so check for &gt;=6.1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kando234</div><div class="date">24th April 2009, 09:46</div></div><div class="posttext">How to do that with WinVer.nsh ?<br />
<br />
It offers me only the following functions<br />
and not getting the version number to compare it ?<br />
<br />
<br />
; AtLeastWin&lt;version&gt; checks if the installer is running on Windows version at least as specified.<br />
; IsWin&lt;version&gt; checks if the installer is running on Windows version exactly as specified.<br />
; AtMostWin&lt;version&gt; checks if the installer is running on Windows version at most as specified.<br />
;<br />
; &lt;version&gt; can be replaced with the following values:<br />
;<br />
;   95<br />
;   98<br />
;   ME<br />
;<br />
;   NT4<br />
;   2000<br />
;   XP<br />
;   2003<br />
;   Vista<br />
;   2008</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">24th April 2009, 16:33</div></div><div class="posttext">It's slightly hidden away / not documented.  Near the bottom of WinVer.nsh are the bits you'll want to peek at.  Example:<br />
<br />
<br />
${WinVerGetMajor} $0<br />
${WinVerGetMinor} $1<br />
${WinVerGetBuild} $2<br />
${WinVerGetServicePackLevel} $3<br />
MessageBox MB_OK &quot;$0.$1.$2 SP$3&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th May 2009, 14:59</div></div><div class="posttext">Windows 7 has settled on 6.1? If so, we should add it to WinVer.nsh.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">10th May 2009, 17:00</div></div><div class="posttext">The Release Candidate, Build 7100, is version 6.1, yes.<br />
<br />
For confirmation.. download and install, or poke at a number of websites who have done so and peruse screenshots of the 'about screen' :)<br />
<br />
There was some talk of that 6.1 not being the case if they ever got around to implementing minwin but.. yeah</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">10th May 2009, 21:01</div></div><div class="posttext">minwin was never a product, closest you get is server core<br />
<br />
We don't know the build number until RTM, but using 6.1.0000 for now would probably work</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pawel</div><div class="date">10th May 2009, 21:16</div></div><div class="posttext">Originally posted by Animaether <br />
The Release Candidate, Build 7100, is version 6.1, yes.<br />
<br />
For confirmation.. download and install, or poke at a number of websites who have done so and peruse screenshots of the 'about screen' :)<br />
 <br />
Here is a screenshot. it is 6.1 for now.<br />
http://shup.com/Shup/156791/Untitled.png <br />
-Pawel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">th_mi</div><div class="date">11th May 2009, 12:14</div></div><div class="posttext">Originally posted by PepeSoft <br />
Here is a screenshot. it is 6.1 for now.<br />
[Image] (http://shup.com/Shup/156791/Untitled.png) <br />
-Pawel  <br />
<br />
And it will be 6.1 later in W7. See here:<br />
http://msdn.microsoft.com/en-us/library/ms724833(VS.85).aspx<br />
(MSDN documentation &quot;OSVERSIONINFOEX Structure&quot; of function &quot;GetVersionEx&quot;)<br />
<br />
Even if this piece of software is called &quot;Windows Seven&quot; the internal version number is &quot;6.1&quot; :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th May 2009, 12:39</div></div><div class="posttext">That MSDN page also says Windows 2008 R2 has the same version number. Need to work around that one like we worked around Vista and 2008. Anders, care to handle this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">11th May 2009, 17:47</div></div><div class="posttext">for those that can't wait for the next release, get it from http://nsis.svn.sourceforge.net/viewvc/nsis/NSIS/trunk/Include/WinVer.nsh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th May 2009, 18:19</div></div><div class="posttext">Also, if anyone has Windows 7 and/or Windows Server 2008 R2, please add it to the WinVer test thread (http://forums.winamp.com/showthread.php?s=&amp;threadid=300436&amp;highlight=winver).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pawel</div><div class="date">16th May 2009, 14:18</div></div><div class="posttext">Originally posted by kichik <br />
Also, if anyone has Windows 7 and/or Windows Server 2008 R2, please add it to the WinVer test thread (http://forums.winamp.com/showthread.php?s=&amp;threadid=300436&amp;highlight=winver).  <br />
<br />
Kichik,<br />
I want to test it, but what tool should I use?<br />
Should I use WinVer, from that thread? Is it updated to support win7?<br />
-Pawel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th May 2009, 15:18</div></div><div class="posttext">The tool from the thread is version independent. The version attached there should work fine on Windows 7 as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">8th June 2009, 16:51</div></div><div class="posttext">I can't seem to get Windows 7 to even show up with I pop the variable.  I am using the latest WinVer.nsh that includes Win7 routines.<br />
<br />
Any help is greatly appreciated.  <br />
<br />
Please see my code.<br />
<br />
<br />
Function .onInit<br />
<br />
GetVersion::WindowsName<br />
Pop $R0<br />
<br />
;${If} $R1 == &quot;64&quot;<br />
;  Goto no64<br />
;${EndIf}<br />
${If} $R0 == &quot;XP&quot;<br />
  Goto xp<br />
${ElseIf} $R0 == &quot;XP x64&quot;<br />
  Goto go_away<br />
${ElseIf} $R0 == &quot;2000&quot;<br />
  Goto go_away<br />
${ElseIf} $R0 == &quot;Server 2003&quot;<br />
  Goto go_away<br />
${Elseif} $R0 == &quot;Server 2003 R2&quot;<br />
  Goto go_away<br />
${Elseif} $R0 == &quot;Vista&quot;   <br />
  Goto vista<br />
${Else}<br />
  Goto error<br />
${EndIf}<br />
; i suppose i do need to add a win7 block?  will there be multiple SKUs like Vista?<br />
<br />
<br />
xp:<br />
   GetVersion::WindowsType<br />
   Pop $R0<br />
   ${If} $R0 == &quot;Professional&quot;<br />
   ${OrIf} $R0 == &quot;Tablet PC Edition&quot;<br />
     Goto go_away<br />
   ${Else}<br />
     Goto non_professional<br />
   ${EndIf}<br />
<br />
non_professional:<br />
  MessageBox MB_YESNO|MB_ICONEXCLAMATION|MB_TOPMOST|MB_DEFBUTTON2 \<br />
  &quot;The XYZ-Soft software has not been tested on, and is not supported on Windows XP $R1.$\r$\n$\r$\nXYZ-Tek cannot \<br />
  provide technical support for this installation.$\r$\n$\r$\nDo you want to continue?&quot; \<br />
  IDYES go_away IDNO done<br />
    <br />
vista:<br />
   GetVersion::WindowsType<br />
   Pop $R1<br />
<br />
     ${If} $R1 == &quot;Home Basic Edition&quot;<br />
         MessageBox MB_YESNO|MB_ICONEXCLAMATION|MB_TOPMOST|MB_DEFBUTTON2 \<br />
         &quot;The XYZ-Soft software has not been tested on, and is not supported on Windows $R0 $R1.$\r$\n$\r$\nXYZ-Tek cannot \<br />
         provide technical support for this installation.$\r$\n$\r$\nDo you want to continue?&quot; \<br />
         IDYES go_away IDNO done<br />
     ${ElseIf} $R1 == &quot;Home Premium Edition&quot;<br />
         MessageBox MB_YESNO|MB_ICONEXCLAMATION|MB_TOPMOST|MB_DEFBUTTON2 \<br />
         &quot;The XYZ-Soft software has not been tested on, and is not supported on Windows $R0 $R1.$\r$\n$\r$\nXYZ-Tek cannot \<br />
         provide technical support for this installation.$\r$\n$\r$\nDo you want to continue?&quot; \<br />
        IDYES go_away IDNO done<br />
      ${ElseIf} $R1 == &quot;Starter Edition&quot;<br />
         MessageBox MB_YESNO|MB_ICONEXCLAMATION|MB_TOPMOST|MB_DEFBUTTON2 \<br />
         &quot;The XYZ-Soft software has not been tested on, and is not supported on Windows $R0 $R1.$\r$\n$\r$\nXYZ-Tek cannot \<br />
         provide technical support for this installation.$\r$\n$\r$\nDo you want to continue?&quot; \<br />
         IDYES go_away IDNO done<br />
      ${Else}<br />
         Goto go_away<br />
      ${EndIf}<br />
<br />
error:<br />
  ; generic block for the rest of OS's... 95,98,Me,7, etc. ??? <br />
  MessageBox MB_YESNO|MB_ICONEXCLAMATION|MB_TOPMOST|MB_DEFBUTTON2 \<br />
  &quot;The XYZ-Soft software has not been tested on, and is not supported on Windows $R0 $R1.$\r$\n$\r$\nXYZ-Tek cannot \<br />
  provide technical support for this installation.$\r$\n$\r$\nDo you want to continue?&quot; \<br />
  IDYES go_away IDNO done<br />
<br />
done:<br />
   Quit</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th June 2009, 17:15</div></div><div class="posttext">You are using GetVersion plug-in and not WinVer.nsh. Use:!include WinVer.nsh<br />
<br />
${If} ${IsWin7}<br />
  MessageBox MB_OK 7<br />
${ElseIf} ${IsWin2000}<br />
  MessageBox MB_OK 2000<br />
# etc... ${ElseIf}...<br />
${EndIf}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">8th June 2009, 18:46</div></div><div class="posttext">oops,<br />
thanks! (i think i used winver at one point in my life but switched i guess, i think my old codebase has it).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">9th June 2009, 14:46</div></div><div class="posttext">Okay.. I got a couple of more questions.<br />
<br />
In GetVersion they have the ability to find home edition detection (probably why i used it to begin with), is WinVer.nsh going to detect the different SKUs of Home/Vista/7 (Home/Pro/Home Basic/Ultimate/...)  Is there a way to detect that?<br />
<br />
Also, I like to detect anything below Win 95 (Windows 1.0 - 3.11).  is there a way to detect &lt; 95?  (I know GetVersion does for example)<br />
<br />
Since I know GetVersion more, is my logic below correct?  How do I get the version to display in the second message?<br />
<br />
<br />
Function .onInit<br />
<br />
; Give warning about Windows 7<br />
<br />
${If} ${IsWin7}<br />
  MessageBox MB_YESNO|MB_ICONEXCLAMATION|MB_TOPMOST|MB_DEFBUTTON2 \<br />
  &quot;The blah software has not been tested on, and is not supported on Windows 7.$\r$\n$\r$\nFoobar Industries cannot \<br />
  provide technical support for this installation.$\r$\n$\r$\nDo you still want to continue with the installation?&quot; \<br />
  IDYES go_away IDNO done<br />
${ElseIf} ${AtLeastWin95}<br />
     ${And} ${AtMostWinME}<br />
       MessageBox MB_OK|MB_ICONSTOP &quot;Windows -version- is not supported by the blah software.&quot; IDOK  ; Anything below 2000 throw error<br />
       Quit<br />
; what about below 95 (Win 1 - 3.11)<br />
${EndIf}<br />
<br />
<br />
done:<br />
   Quit<br />
<br />
go_away:<br />
; ...<br />
<br />
<br />
Thanks so much!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">9th June 2009, 15:12</div></div><div class="posttext">lol, Win v1.<br />
<br />
AFAIK, NSIS does not work on anything below v4</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">9th June 2009, 16:18</div></div><div class="posttext">I thought nsis did work with &lt; 4.  <br />
I thought it can with 3.1 at least, though i never verified it.  i thought i saw it in some forum.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">9th June 2009, 16:32</div></div><div class="posttext">Win 3.1 is 16bit, you would have to install Win32s on there</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">9th June 2009, 20:20</div></div><div class="posttext">Okay but how do I determine the windows version using winver in the output?<br />
<br />
<br />
${ElseIf} ${AtLeastWin95}<br />
     ${And} ${AtMostWinME}<br />
       MessageBox MB_OK|MB_ICONSTOP &quot;Windows -version- is not supported by the blah software.&quot; IDOK  ; Anything below 2000 throw error<br />
       Quit<br />
${EndIf}<br />
<br />
<br />
That is generic code, so do i need to make an if for each version?  <br />
<br />
I can't say : MessageBox MB_OK|MB_ICONSTOP &quot;Windows ${WINVER} is .. &quot; .. ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">26th June 2009, 14:54</div></div><div class="posttext">My above code doeswnt seem to work.  I tried changing And to AndIf and made no difference other than it allowed me to compile it.  <br />
<br />
I am unable to execute the installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">27th July 2009, 13:47</div></div><div class="posttext">it would be lovely, if WinVer could make a check if the user is running a 64-bit system (whether its xp, vista or win7 etc.). something like ${Is64bit}/${Is32bit} would be very helpful!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">27th July 2009, 14:43</div></div><div class="posttext">Originally posted by Yathosho <br />
it would be lovely, if WinVer could make a check if the user is running a 64-bit system (whether its xp, vista or win7 etc.). something like ${Is64bit}/${Is32bit} would be very helpful! <br />
<br />
x64.nsh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">didava</div><div class="date">6th September 2013, 22:39</div></div><div class="posttext">hi <br />
<br />
for win 8 &amp; xp <br />
<br />
Is this true?<br />
<br />
${If} ${IsWin8}<br />
<br />
  MessageBox MB_OK 8<br />
<br />
${ElseIf} ${IsXP}<br />
<br />
  MessageBox MB_OK XP<br />
<br />
# etc... ${ElseIf}...<br />
<br />
${EndIf}<br />
<br />
???????</div></div><hr />


<div class="post"><div class="posttop"><div class="username">didava</div><div class="date">6th September 2013, 23:33</div></div><div class="posttext">var isWindowsXP<br />
  var IsWindows7<br />
  var IsWindows8<br />
<br />
------<br />
<br />
[QUOTE]<br />
<br />
<br />
        Version::IsWindowsXP<br />
        Pop $isWindowsXP<br />
        ${If} $isWindowsXP == &quot;1&quot;<br />
        Goto XP<br />
        ${EndIf}<br />
<br />
       Version::IsWindows7<br />
       Pop $IsWindows7<br />
       ${If} IsWindows7 == &quot;1&quot;<br />
       Goto WINDOWS7<br />
       ${EndIf}<br />
<br />
       Version::IsWindows8<br />
       Pop $IsWindows8<br />
       ${If} IsWindows8 == &quot;1&quot;<br />
       Goto WINDOWS8<br />
       <br />
     ${ElseIf}<br />
           MessageBox MB_OK|MB_ICONSTOP|MB_TOPMOST &quot;$(OS_NOT_S)&quot;<br />
           QUIT<br />
       ${EndIf}<br />
<br />
            WINDOWS8:<br />
<br />
            WINDOWS7:<br />
<br />
             xp:</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>