<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Making an Installer from an existing Installer and a Configuration file, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Making an Installer from an existing Installer and a Configuration file NSIS Discussion" />
	
	<title> Making an Installer from an existing Installer and a Configuration file [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Making an Installer from an existing Installer and a Configuration file</div>
<hr />
<div class="pda"><a href="t-349842.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=349842">Making an Installer from an existing Installer and a Configuration file</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">scythe</div><div class="date">9th October 2012, 12:56</div></div><div class="posttext">Hi,<br />
<br />
I have an Installer A.exe, created by NSIS, which is the same for all customers. Furthermore a have a dynamically created config file B.ini which differs for each customer. Given A.exe and the customer-specific config file B.ini, I would like to bundle these two files into an NSIS installer C.exe which installs A.exe and copies B.ini to the install dir.<br />
<br />
What is the simples way to do so?<br />
<br />
I'm new to NSIS and would appreciate any help or source code. Thank you!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">9th October 2012, 13:17</div></div><div class="posttext">I'm assuming you're asking how to automate the process of creating all the C.exes for all your customers.<br />
<br />
The easiest way I can think of is putting all the config.ini files in subfolders (or renaming them (customerID).ini or something), then enumerate all the ini paths/filenames in a vbs/bat/NSISexe and executing makensisw for each filename with the filename supplied as a commandline parameter. You can use makensisw's /D parameter to specificy a !define during compilation, so that in the nsi script you'd do something like:<br />
File &quot;/oname=$INSTDIR\config.ini&quot; &quot;${TheFilenameDefine}&quot;<br />
<br />
Of course you'll also need to change the filename of each generated C.exe. Simply do: name ${TheFilenameDefine}.exe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scythe</div><div class="date">9th October 2012, 16:28</div></div><div class="posttext">Thank you very much for your reply. This already helps a lot. However, I'm wondering if there is a possibility to write the config file B.ini without creating a C.exe for every customer.<br />
<br />
In other words: Is there a possibility to just append the config file B.ini of a specific customer (that is the raw bytes) to the installer A.exe without invoking makensis and specify a command in the script for A.exe which looks for this config data and if it exists writes it to the file B.ini during installation?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">9th October 2012, 16:33</div></div><div class="posttext">Yes, there is. NSIS installers only do a CRC check on their own data. If you append bytes to the exe, it will not interfere with the installer. If you want to use an NSIS exe to do this, you can use FileWriteByte. You'll have to make sure that the correct bytes are read during installation (FileReadByte). Perhaps using a fixed filelength for each ini would be the simplest way.<br />
<br />
Note however that if the ini contents are already known during compilation of A.exe, you can simply use the ini instructions to create the config.ini file at runtime: http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2.13</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scythe</div><div class="date">11th October 2012, 16:45</div></div><div class="posttext">Thanks for your reply. I was able to solve the problem by writing a function based on ReadCustomerData http://nsis.sourceforge.net/ReadCustomerData. However I'm running into trouble if the appended data contains linebreaks, so I had to escape \r and \n and remove the escaping when writing the appended data back to aconfig file.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>