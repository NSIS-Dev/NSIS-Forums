<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Bug - Uninstallsection, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Bug - Uninstallsection NSIS Discussion" />
	
	<title> Bug - Uninstallsection [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Bug - Uninstallsection</div>
<hr />
<div class="pda"><a href="t-138983.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=138983">Bug - Uninstallsection</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">KronosTheFirst</div><div class="date">14th June 2003, 09:55</div></div><div class="posttext">Hello!<br />
<br />
My Problem is, that I cannot delete the start menu entries :(.<br />
I use MakeNSIS v2.0b3 (ModernUI, MultiLanguage), Windows 2000 SP2.<br />
One sees in the log-file that the setup doesn't even try the deletion yet.<br />
<br />
<br />
Section &quot;Uninstall&quot;<br />
[...]<br />
  Delete &quot;$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\*.*&quot;<br />
  Delete &quot;$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\Homepage.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\Manager.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\Uninstall.lnk&quot;<br />
  RMDir &quot;$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}&quot;<br />
<br />
  Delete &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
  RMDir &quot;$INSTDIR&quot;<br />
<br />
  DeleteRegKey /ifempty HKCU &quot;Software\${MUI_PRODUCT}&quot;<br />
<br />
  !insertmacro MUI_UNFINISHHEADER<br />
<br />
SectionEnd<br />
<br />
Thank you in advance!<br />
Greetings<br />
Kronos</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th June 2003, 13:46</div></div><div class="posttext">Please get the latest development version (use NSIS Update) and see the StartMenu.nsi example. The MUI_STARTMENUPAGE_VARIABLE is only for the installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">KronosTheFirst</div><div class="date">15th June 2003, 10:20</div></div><div class="posttext">THX! I will test it...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">terum</div><div class="date">9th July 2003, 16:24</div></div><div class="posttext">I got quite the same problem as KronosTheFirst with my own installer.<br />
<br />
So, I tried with the original StartMenu.nsi file : still the same :<br />
(Extract of StartMenu.nsi)<br />
  ;Remove shortcut<br />
  ReadRegStr ${TEMP} &quot;${MUI_STARTMENUPAGE_REGISTRY_ROOT}&quot; &quot;${MUI_STARTMENUPAGE_REGISTRY_KEY}&quot; &quot;${MUI_STARTMENUPAGE_REGISTRY_VALUENAME}&quot;<br />
  <br />
  StrCmp ${TEMP} &quot;&quot; noshortcuts<br />
  <br />
    Delete &quot;$SMPROGRAMS\${TEMP}\Modern UI.lnk&quot;<br />
    Delete &quot;$SMPROGRAMS\${TEMP}\Uninstall.lnk&quot;<br />
    RMDir &quot;$SMPROGRAMS\${TEMP}&quot; ;Only if empty, so it won't delete other shortcuts<br />
(End of Extract)<br />
<br />
When running Uninstall, the entries &quot;C:\Documents and Settings\....\Test Software\*.lnk&quot; are deleted from the Start Menu, but the folder &quot;C:\Documents and Settings\....\Test Software&quot; is not deleted.<br />
<br />
When trying to delete it manually, through the Start Menu, or the explorer, I receive a Windows error message &quot;Sharing violation&quot;.<br />
When running a file handle explorer, such as the excellent Sysinternals Process Explorer, I find that Explorer has opened an handle which is &quot;C:\Documents and Settings\...\Menu Démarrer\Programmes\Test Software\&quot; (my OS W2K is a french one).<br />
When trying to manually delete the folder, another handle is opened which is &quot;C:\Documents and Settings\...\Menu Démarrer\Programmes\Test Software&quot; (please note the difference : the closing &quot;\&quot;).<br />
I then close the first handle (wonderful feature of Process Explorer)<br />
And now it is possible to manually delete the folder.<br />
<br />
So, may be this can help you to find out an explanation ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">9th July 2003, 16:45</div></div><div class="posttext">This problem is not related to the first one (the first script is invalid).<br />
<br />
Please download the latest development version, compile StartMenu.nsi, run it and post the result.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">terum</div><div class="date">9th July 2003, 18:08</div></div><div class="posttext">Thanks Joost to spend time with my problem, :up: <br />
<br />
I already use the last version.<br />
But, in order to be sure, I've redownloaded it again.<br />
NSIS version 2.0 beta 3. (nsis20b3.exe, 1355 Kb)<br />
MakeNSISW v 1.9 (59 Kb, 20 Feb 2002)<br />
makensis.exe (355 Kb, 17 March 2003)<br />
StartMenu.nsi (4 Kb, 14 March 2003)<br />
<br />
Same results. Start Menu Folder not deleted after uninstall.<br />
I've tried on another PC. Same thing. But it's also a W2K french one.<br />
<br />
I attach a zip file containing my compiled StartMenu.exe as well as some windows screencopies.<br />
<br />
I suppose that the example StartMenu.nsi has been already tested by others.<br />
So I just wonder if my exe/uninstall works on other machines than mines (for instance on W2K english versions) ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th July 2003, 18:49</div></div><div class="posttext">The latest version is the development snapshot from http://nsis.sourceforge.net/<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">terum</div><div class="date">10th July 2003, 15:47</div></div><div class="posttext">Sorry, I'm just another blind NSIS newbie.<br />
<br />
Now it works fine.<br />
<br />
I appreciate that you spent time with me and I'll search better next time.<br />
:confused:</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>