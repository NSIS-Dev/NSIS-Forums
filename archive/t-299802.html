<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Vista security issue/bug? -- RegDLL, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Vista security issue/bug? -- RegDLL NSIS Discussion" />
	
	<title> Vista security issue/bug? -- RegDLL [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Vista security issue/bug? -- RegDLL</div>
<hr />
<div class="pda"><a href="t-299802.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=299802">Vista security issue/bug? -- RegDLL</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">omeara55</div><div class="date">12th November 2008, 01:04</div></div><div class="posttext">Hey everyone...  First off, big thanks to all the NSIS contributors -- it's truly great work and we all thank you for your time and effort!<br />
<br />
Hopefully, some NSIS gurus here will be able to figure this one out...<br />
<br />
My installer is having issues when non-admin users try to install it.  Specifically, RegDLL is failing, presumably because regsvr child process isn't inheriting the admin rights of the installer (host) process.  The installer uses 'RequestExecutionLevel admin' and the installer properly prompts to authentication when it starts, so the installer process definitely has admin permissions (also verified by the fact it installs files into Program Files).<br />
<br />
Is anyone aware of this issue or perhaps what may be going on?  Sorry if I missed something obvious or am doing something dumb.<br />
<br />
Thanks in advance,<br />
Andy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">12th November 2008, 08:08</div></div><div class="posttext">a child process will always inherit its parent rights unless you create a custom and/or restricted token. You could try Process Monitor from sysinternals and see it gives you any clues as to why its failing</div></div><hr />


<div class="post"><div class="posttop"><div class="username">{_trueparuex^}</div><div class="date">12th November 2008, 10:37</div></div><div class="posttext">:confused: RegDLL doesn't use regsvr to register. You could try to test why it's failing by calling regsvr by yourself.<br />
<br />
E.g. ExecWait 'regsvr32.exe &quot;$INSTDIR\foo.dll&quot;'<br />
<br />
This way you get the error message if it fails to register.<br />
<br />
PaR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">omeara55</div><div class="date">13th November 2008, 02:14</div></div><div class="posttext">Hey guys, thanks for chiming in with your comments.  Trueparuex, your suggestion did the trick!  Using ExecWait results in proper registration, indicting there may in fact be a bug inside RegDLL.  To be clear, the repro case is calling RegDLL under Vista x64, using an installer marked with 'RequestExecutionLevel admin' , logged in as a standard user (ie a non-admin). <br />
<br />
I'm willing to write up and file a bug on this at sourceforge if people here agree that this looks like a legit issue.  Thoughts?   Thanks again for the workaround, trueparuex!<br />
<br />
Andy</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>