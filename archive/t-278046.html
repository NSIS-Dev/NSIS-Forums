<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninst on what you inst'd, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninst on what you inst'd NSIS Discussion" />
	
	<title> Uninst on what you inst'd [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninst on what you inst'd</div>
<hr />
<div class="pda"><a href="t-278046.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=278046">Uninst on what you inst'd</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">28th September 2007, 20:44</div></div><div class="posttext">OK, looking for a little strategy advice.  I've run into something new to me.  Most client side app's deal with this, but I mostly build release files for items that live on their own tier and don't have any conflict when installing.<br />
<br />
I've got this one application that's become a thorn in my side though...  It has about 10 installers that can live on 1 to 10 different machines.  Each one of the apps lives in the same directory, and thus, when they go on the same machine, the uninstallers tend to uninstall the other installed files.  So I need to figure out 2 things:<br />
<br />
1)  How do I only uninstall what the previous installer installed?<br />
2)  If there are shared files, how do I know that they're potentially shared files, and thus, not uninstall them?<br />
<br />
All advise will be much appreciated!<br />
<br />
Thanks Once Again,<br />
Eric &lt;&gt;&lt;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">29th September 2007, 00:37</div></div><div class="posttext">I can help you on #1<br />
If the old installer is made by you..you can config the old installer to install a setup.cfg or whatever name, but basically an ini file to write the components installed and later you can read it in new installer. You can save installations paths in registry.<br />
<br />
If the installer is not made by you, well...you can try deleting the files<br />
<br />
Delete $SOMEDIR\\*.* ; also trt /r for recursive</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CancerFace</div><div class="date">29th September 2007, 15:35</div></div><div class="posttext">Similar to what Joel suggested, how about using extended logging with your installer, then employ the Delete Files From Log (http://nsis.sourceforge.net/Delete_Files_From_Log) function from the wiki in your uninstaller? This is something that you can call from another uninstaller as well, keeping track of what each app is installing/uninstalling.<br />
<br />
As for shared components, they are always a thorn in one's side. However there are several ways to deal with them, assuming that you are responsible for installing them. What I tend to do, although I am not sure if it is the best strategy, is use the shared DLL key in the registry (HKLM\Software\Microsoft\Windows\CurrentVersion\SharedDLLs) for files that many apps will share. I use this (http://nsis.sourceforge.net/Add_a_shared_DLL) macro to install a shared component and this (http://nsis.sourceforge.net/Remove_a_shared_DLL) to remove it. The shared files do not have to be DLL/OCX/TLB nor do they have to reside in $SYSDIR which makes this approach quite generic and useful.<br />
<br />
Alternatively you can use the InstallLib  (http://nsis.sourceforge.net/Docs/AppendixB.html) macro for shared components.<br />
<br />
CF</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>