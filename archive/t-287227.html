<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Windows XP ExecWait  a program with admin rights, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Windows XP ExecWait  a program with admin rights NSIS Discussion" />
	
	<title> Windows XP ExecWait  a program with admin rights [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Windows XP ExecWait  a program with admin rights</div>
<hr />
<div class="pda"><a href="t-287227.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=287227">Windows XP ExecWait  a program with admin rights</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jlanza</div><div class="date">19th February 2008, 23:25</div></div><div class="posttext">In Windows XP as a limited user I want to be able to run a custom exe and wait for it to finish as admin. The exe I want to run is a custom legacy uninstaller I have coded up. I have accomplished this in Vista with the manifest via RequestExecutionLevel Admin.  However in XP there is no elevation dialog that pops up and the custom uninstaller is unable to remove files from program files and the registry.  Does anyone have any solution?  Any help would be greatly appreciated!  Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">20th February 2008, 00:12</div></div><div class="posttext">you could call ShellExecuteEx with the runas verb and some flag to keep the process handle open(can't remember its exact name ATM, check MSDN), then just wait for that handle, you could use the system plugin for this or write your own</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jlanza</div><div class="date">20th February 2008, 15:51</div></div><div class="posttext">Thank you this method worked great.<br />
<br />
Is there a way to do the same thing in Windows Vista from  a limited account where UAC is disabled? I want to run as admin dialog to come up and it wont because it is ignoring my manifest.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>