<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Why doesnt this command work?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Why doesnt this command work? NSIS Discussion" />
	
	<title> Why doesnt this command work? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Why doesnt this command work?</div>
<hr />
<div class="pda"><a href="t-190999.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=190999">Why doesnt this command work?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">JiveMiguel</div><div class="date">23rd August 2004, 00:26</div></div><div class="posttext">ExecWait 'cscript &quot;$INSTDIR\helpers\sys.vbs&quot; &gt; systemsummary.txt'<br />
<br />
I have this command in my nsis script. The idea is to run the WSH script 'sys.vbs' and to send the output to the file systemsummary.txt, instead of the screen. That way, if the end user has a problem post-install, he or she can send me the file 'systemsummary.txt' and I can get an idea of how their system is configured, what services are running, etc.<br />
<br />
As far as I can tell, the script is not executing and the text file isn't being created. The line right before this one is an execwait that runs a different WSH script, and it's working fine... Can anyone help me?<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">23rd August 2004, 01:01</div></div><div class="posttext">You need to execute it under command prompt correct?<br />
If so you need to include the path to COMSPEC (Dos command-line).<br />
<br />
Something like this:<br />
<br />
Push $R0<br />
ReadEnvStr $R0 &quot;COMSPEC&quot;<br />
ExecWait '$R0 cscript &quot;$INSTDIR\helpers\sys.vbs&quot; &gt; systemsummary.txt'<br />
Pop $R0<br />
<br />
You're also using a relative path to cscript. Is it in the shell, or shouldn't you supply the full path? Similarely, shouldn't you supply the full path for the output file?<br />
<br />
Lastly, ExecWait will show a command window. You could use nsExec::Exec instead to hide it, and then display a status message with the Banner plugin.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JiveMiguel</div><div class="date">23rd August 2004, 01:19</div></div><div class="posttext">Thanks for your response. First, i'll answer your questions:<br />
<br />
Yes, I want this to execute under a command prompt. The Cscript exe should be in the system PATH var, so a relative path should be ok. As I said, I run other cscripts in this installer in the same way (no path specified) and they work. I've tried speccing an absolute path for the textfile, as well as the relative one shown in my post, and neither work. I'm not worried about showing the command window, as it's only visible for a half second (or so).<br />
<br />
Your example didn't work. It simply opened a command window at the specified path, and waited for input. The installer only continued once I typed 'exit'.<br />
<br />
It seems that my problem is related with sending the output to a textfile using the '&gt;' character. <br />
<br />
Still confused... but thanks for your response.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th August 2004, 21:25</div></div><div class="posttext">Add /C after $R0 in Afrow's example and it should work. If it doesn't, search the forum for examples. Try searching for 'MySQL'.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JiveMiguel</div><div class="date">26th August 2004, 21:52</div></div><div class="posttext">Thanks. Your suggestion worked. I added the /C to the execwait line and it works as I'd expect it to. <br />
<br />
Why does the /C make it work? I looked in the NSIS docs and can't figure it out. Am I modifying the execwait command with the /C or something else? <br />
<br />
Thanks again,<br />
- Greg</div></div><hr />


<div class="post"><div class="posttop"><div class="username">niteflyer</div><div class="date">27th August 2004, 16:39</div></div><div class="posttext">/C does not modify ExecWait but COMSPEC.<br />
Type cmd /? or command /? at the console to get help...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>