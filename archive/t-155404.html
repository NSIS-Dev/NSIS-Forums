<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Strange Font Installation Problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Strange Font Installation Problem NSIS Discussion" />
	
	<title> Strange Font Installation Problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Strange Font Installation Problem</div>
<hr />
<div class="pda"><a href="t-155404.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=155404">Strange Font Installation Problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">7th November 2003, 04:29</div></div><div class="posttext">When I use the following macro to install a font file it copies the file OK but the font does not appear in any font lists even after the PC is restarted.  However if you open the Windows Fonts folder in Explorer all of the font are availabble to the programs.<br />
<br />
I'm cannot be certain if this script did work previously and this is just a incompatibility with the newer version of NSIS or if it always behaved in this manner.<br />
!macro InstallFont FontNAME Index<br />
<br />
  SetOutPath $FONT_DIR<br />
  IfFileExists &quot;$FONT_DIR\${FontName}&quot; ${Index}<br />
  File '${FontName}'<br />
  System::Call &quot;GDI32::AddFontResourceA(t) i ('${FontName}') .s&quot;<br />
${Index}:<br />
<br />
!macroend<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">7th November 2003, 05:35</div></div><div class="posttext">Try adding this line after you add the font (code by kichik):<br />
<br />
SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">7th November 2003, 05:46</div></div><div class="posttext">Do I need to add this line after every font is added, cos I already have this line after all of the fonts are installed, I insert this macro several times in one of the sections and I have that line after the last line.<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">7th November 2003, 05:52</div></div><div class="posttext">I believe you only need this line once.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">7th November 2003, 06:00</div></div><div class="posttext">In that case thats not the problem.  I know that this problem exists in Win98SE and I also suspect in WinXP, will confirm later tonight.<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th November 2003, 08:09</div></div><div class="posttext">You also have to create a certain registry key. Search the forum for the original thread where the AddFontResourceA function first brought up, it's there. It would be nice if you can merge it all together into one archive page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">7th November 2003, 08:41</div></div><div class="posttext">Thanks, modified my macro.  Will test and create an Archive page if OK.<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">7th November 2003, 11:23</div></div><div class="posttext">Archive page created.  Thanks guys for helping me to solve this problem.<br />
<br />
Vytautas :D</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>