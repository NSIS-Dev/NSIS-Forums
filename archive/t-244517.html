<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" problem with MUI_FINISHPAGE_RUN, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  problem with MUI_FINISHPAGE_RUN NSIS Discussion" />
	
	<title> problem with MUI_FINISHPAGE_RUN [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  problem with MUI_FINISHPAGE_RUN</div>
<hr />
<div class="pda"><a href="t-244517.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=244517">problem with MUI_FINISHPAGE_RUN</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">24th April 2006, 23:14</div></div><div class="posttext">i need to run this script<br />
  !define MUI_FINISHPAGE_RUN &quot;$\&quot;$SYSDIR\rundll32.exe$\&quot; shell32.dll,Control_RunDLL cttune.cpl&quot;<br />
<br />
but nothing happens :(<br />
<br />
i tried it several ways, these two works<br />
;--------------------------------<br />
Name &quot;cttune&quot;<br />
Caption &quot;cttune&quot;<br />
OutFile &quot;cttune_start.exe&quot;<br />
AutoCloseWindow true<br />
;--------------------------------<br />
Section &quot;&quot;<br />
SectionEnd<br />
;--------------------------------<br />
Function .onInit<br />
  print_on:<br />
  Exec '&quot;$SYSDIR\rundll32.exe&quot; shell32.dll,Control_RunDLL cttune.cpl'<br />
  Exec &quot;$\&quot;$SYSDIR\rundll32.exe$\&quot; shell32.dll,Control_RunDLL cttune.cpl&quot;<br />
  quit<br />
FunctionEnd<br />
<br />
as you can see one with &quot;..&quot; and one with '..'<br />
$\&quot; is &quot; within &quot;..&quot; (otherwise error)<br />
<br />
i cant use '..' in MUI_FINISHPAGE_RUN<br />
and i dont want to use a custom page - NO!<br />
pls help.<br />
<br />
ps files are installed and dos-console works too<br />
<br />
PPS how to open control panel with explorer call?<br />
that would help instead</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">25th April 2006, 00:01</div></div><div class="posttext">PPS how to open control panel with explorer call?<br />
that would help instead<br />
<br />
http://nsis.sourceforge.net/Opening_Control_Panel_/_Display_Properties<br />
EDIT:<br />
This one works perfectly:<br />
!define MUI_FINISHPAGE_RUN <br />
!define MUI_FINISHPAGE_RUN_FUNCTION run_cpl<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
Function run_cpl<br />
        Exec 'Rundll32.exe shell32.dll,Control_RunDLL Desk.cpl,@0, 1'<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">25th April 2006, 00:29</div></div><div class="posttext">i want to open the control panel or the cpl itself<br />
<br />
you show me what i already know and have tried - but it wont work<br />
<br />
also does not work with MUI_FINISHPAGE_RUN:<br />
&gt;&gt; Rundll32.exe shell32.dll,Control_RunDLL<br />
(this opens the control panel only)<br />
<br />
all infos about cpl here<br />
http://www.wintotal.de/Tipps/Eintrag.php?RBID=2&amp;TID=184&amp;URBID=7<br />
<br />
Ok, thats new for me:<br />
  !define MUI_FINISHPAGE_RUN &quot;$SYSDIR\rundll32.exe&quot;<br />
  !define MUI_FINISHPAGE_RUN_PARAMETERS &quot;shell32.dll,Control_RunDLL cttune.cpl&quot;<br />
<br />
that did it :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">25th April 2006, 00:34</div></div><div class="posttext">did you try the MUI_FINISHPAGE_RUN_FUNCTION?<br />
I posted an edit above about this.<br />
This one works perfect for me :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">25th April 2006, 00:43</div></div><div class="posttext">thx a lot - idd i had a look at it last minutes.<br />
<br />
i think i go to implement radiobuttons in the iospecial..,<br />
<br />
damn i lost focus in that command :(<br />
<br />
ps do you know the syntax for a pre-page before MUI_FINISHPAGE_RUN ?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>