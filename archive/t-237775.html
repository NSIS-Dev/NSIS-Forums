<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Registery key rights, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Registery key rights NSIS Discussion" />
	
	<title> Registery key rights [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Registery key rights</div>
<hr />
<div class="pda"><a href="t-237775.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=237775">Registery key rights</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">{_trueparuex^}</div><div class="date">11th February 2006, 15:37</div></div><div class="posttext">I have a problem when creating file associations. If I am in admin user, all the registery keys what NSIS creates gets onlya admin rights. When I go to users with lower user rights the associations doesn't work, because the user doesn't have the rights to read the necessary registery keys.<br />
<br />
Is there anyway to get NSIS create those keys with read rights for all useres?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">11th February 2006, 17:39</div></div><div class="posttext">Hi!<br />
<br />
Could you post an example?<br />
<br />
-Bruno.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">{_trueparuex^}</div><div class="date">11th February 2006, 19:01</div></div><div class="posttext">This code should be enough. Just do the necessary changes<br />
<br />
StrCpy $R0 &quot;jp2&quot; ; file extension<br />
StrCpy $R1 &quot;JP2FILE&quot; ; file type key in registery<br />
StrCpy $R2 &quot;JPEG-2000 Format&quot; ; file type name<br />
StrCpy $R3 '&quot;C:\Program Files\whatever\aplication.exe&quot; &quot;%1&quot;' ; commandline<br />
StrCpy $R4 '&quot;C:\Program Files\whatever\aplication.exe&quot;,0' ; icon file and index<br />
<br />
  WriteRegStr HKLM &quot;.$R0&quot; &quot;&quot; &quot;$R1&quot;<br />
  WriteRegStr HKLM &quot;$R1&quot; &quot;&quot; &quot;$R2&quot;<br />
  WriteRegStr HKLM &quot;$R1\shell&quot; &quot;&quot; &quot;open&quot;<br />
  WriteRegStr HKLM &quot;$R1\shell\open\command&quot; &quot;&quot; '$R3'<br />
  WriteRegStr HKLM &quot;$R1\DefaultIcon&quot; &quot;&quot; '$R4'<br />
<br />
I also attached the original thingy meant to create XnView association.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">11th February 2006, 19:33</div></div><div class="posttext">Ok. I made some tests with the script.<br />
<br />
This was ok. I could create the associations correctly and my guest user on the same system could also use those associations. I use Windows xp.<br />
<br />
What's your OS? Did you open your regedit and inspect the keys? Are there only admin rights on the keys? There should be at least administrators with full access and users with read (and some others...).<br />
<br />
-Bruno.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">{_trueparuex^}</div><div class="date">11th February 2006, 19:43</div></div><div class="posttext">I use windows 2000 pro. And I used Sysinternals AccessEnum and regedt32 (regedit doesn't have a function to check the rights in win2k) to check those keys. And the keys haves only admin / system rights for read and write.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">11th February 2006, 20:00</div></div><div class="posttext">Ok, I tried this also with Windows 2000. The behaviour is the same. It works.<br />
<br />
It seems, that these rights are not correctly inherited from the parent keys. (On the key &quot;Classes&quot; the group &quot;Users&quot; should give the read permission to the child keys.)<br />
<br />
Do you have a virtual maschine or something like that with a fresh Windows 2000 installation?<br />
<br />
-Bruno.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">{_trueparuex^}</div><div class="date">11th February 2006, 22:05</div></div><div class="posttext">I just notice that in my sample above I used HKLM instead of HKCR.<br />
<br />
In the thingy, I used first the &quot;HKCR&quot; key for the associations, but when I notice that the associations doesn't work on other users I changed it to &quot;HKLM\SOFTWARE\Classes\&quot;, but as you can see that didn't help either.  :( <br />
<br />
But normally &quot;HKCR&quot; key should be the right place for the associations right?<br />
<br />
Do you have a virtual maschine or something like that with a fresh Windows 2000 installation?<br />
No, but I could but I could install the VMware (http://www.vmware.com/products/server/) if it even is suitable for tests like this. It will take some time though.<br />
<br />
Edit: I tried the thingy in XP and indeed in XP it works, keys gets the rights from the parent keys. I start to think more and more that there is something wrong in my system. :tinfoil:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">11th February 2006, 23:28</div></div><div class="posttext">I just notice that in my sample above I used HKLM instead of HKCR.<br />
<br />
<br />
Well, it's the same! HKCR is the short way to get into HKLM\Software\Classes.<br />
<br />
 <br />
No, but I could but I could install the VMware (http://www.vmware.com/products/server/) if it even is suitable for tests like this. It will take some time though.<br />
 <br />
<br />
You will see: VMWare is great for tests of a setup. You can always get to the original state and can be sure, that the conditions are equal. Every time.<br />
<br />
You could use VMWare-Player and the sample of this page: http://www.vmaschinen.de/cgi-bin/vmware.cgi?xdown-100000082815<br />
(Altough the Workstation version is great and worth to consider...)<br />
<br />
<br />
Edit: I tried the thingy in XP and indeed in XP it works, keys gets the rights from the parent keys. I start to think more and more that there is something wrong in my system. :tinfoil:<br />
<br />
Mmmh. Maybe there's something wrong.<br />
<br />
Good luck.<br />
<br />
-Bruno.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">{_trueparuex^}</div><div class="date">14th April 2006, 19:26</div></div><div class="posttext">I finally got around this problem. And apparently there was something seriously wrong in my system and NSIS had nothing to do with the problem.<br />
<br />
For some wierd reason the permissions just didn't inherited from the parent keys at all, even though there was nothing wrong in the HKCR key permissions or inheriting options. I didn't find out what was causing it until now. Apparently these problems was the first sign of corrupted registery. This week, I got bigger problems with my system and I found out that the registery is corrupted. So I reinstalled the whole system and now the problem is gone along with some other problems I have experienced lately. :) <br />
<br />
ps. I tried the VMWare-Player, but I never got into it and I end up to test with another win2k and what didn't have the problem.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>