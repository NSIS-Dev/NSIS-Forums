<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS Issue on Chinese windows XP / 7, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS Issue on Chinese windows XP / 7 NSIS Discussion" />
	
	<title> NSIS Issue on Chinese windows XP / 7 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS Issue on Chinese windows XP / 7</div>
<hr />
<div class="pda"><a href="t-330457.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330457">NSIS Issue on Chinese windows XP / 7</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ranajyotic</div><div class="date">9th May 2011, 12:32</div></div><div class="posttext">I have a simple silent installer script which installs a printer driver and then run a EXE. It works perfectly in English OS, but in both the Chinese Traditional and Simplified it will fail to find the folder where the files have been extracted, which is the user Temp folder.<br />
Here is the script. Please let me know what solution is available.<br />
<br />
# General Symbol Definitions<br />
!define REGKEY &quot;SOFTWARE\$(^Name)&quot;<br />
<br />
# Included files<br />
!include Sections.nsh<br />
!include &quot;FileFunc.nsh&quot;<br />
!include LogicLib.nsh<br />
<br />
<br />
#!insertmacro GetParameters<br />
<br />
# Installer pages<br />
Page instfiles<br />
<br />
# Installer attributes<br />
OutFile DriverX86.exe<br />
CRCCheck on<br />
XPStyle on<br />
Icon &quot;logo.ico&quot;<br />
SilentInstall silent<br />
Var DEVICE_NAME<br />
# Installer sections<br />
Section -Main SEC0000<br />
    StrCpy $DEVICE_NAME &quot;XXXX Device&quot;    <br />
    SetOutPath $TEMP\UPD<br />
    SetOverwrite on<br />
    File /a /r Print\Win_2KXP\*    <br />
    ExecWait &quot;rundll32 printui.dll PrintUIEntry /if /b $\&quot;$DEVICE_NAME$\&quot; /f $TEMP\UPD\somefile.inf /m $\&quot;XXXX Device$\&quot; /r $\&quot;LPT1:$\&quot;&quot;<br />
    Delete $TEMP\UPD\Win_2KXP\English\i386\*<br />
    Delete $TEMP\UPD\Win_2KXP\English\*<br />
    Delete $TEMP\UPD\Win_2KXP\i386\*<br />
    Delete $TEMP\UPD\Win_2KXP\*<br />
    RMDir /r $TEMP\UPD\i386<br />
    RMDir /r $TEMP\UPD\English\i386<br />
    RMDir /r $TEMP\UPD\English<br />
    RMDir /r $TEMP\UPD<br />
    SetOutPath $TEMP\BPTracker<br />
    SetOverwrite on<br />
    File /a /r WIN-DS3IVPKX4GX_Install\*<br />
    ExecWait &quot;$TEMP\BPTracker\WIN-DS3IVPKX4GX_Install.exe /s&quot;<br />
    Delete $TEMP\BPTracker\WIN-DS3IVPKX4GX_Install.exe<br />
    RMDir $TEMP\BPTracker<br />
SectionEnd<br />
<br />
# Installer functions<br />
Function .onInit<br />
    InitPluginsDir<br />
FunctionEnd<br />
<br />
The problem seems to be in the $TEMP variable. When the installer is executed the system is unable to find the Driver files which is located in $TEMP\UPD</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">9th May 2011, 13:17</div></div><div class="posttext">You are missing some quotes, try ExecWait &quot;rundll32 printui.dll PrintUIEntry /if /b $\&quot;$DEVICE_NAME$\&quot; /f $\&quot;$TEMP\UPD\somefile.inf$\&quot; /m $\&quot;XXXX Device$\&quot; /r $\&quot;LPT1:$\&quot;&quot;<br />
<br />
and ExecWait '&quot;$TEMP\BPTracker\WIN-DS3IVPKX4GX_Install.exe&quot; /s'</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>