<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" About RMDir the installation folder, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  About RMDir the installation folder NSIS Discussion" />
	
	<title> About RMDir the installation folder [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  About RMDir the installation folder</div>
<hr />
<div class="pda"><a href="t-276727.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=276727">About RMDir the installation folder</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Bardy</div><div class="date">31st August 2007, 05:29</div></div><div class="posttext">Hi everyone,<br />
<br />
I am a fresh for NSIS. There is a difficulty for me about RMDIR the installation folder. For example, if I write code &quot;RMDir &quot;$INSTDIR&quot; in the script. Then set &quot;D:\XXX\XXX\installation&quot; as the installation folder when I implement the installation. After I uninstall, the folder &quot;D:\XXX\XXX&quot; will still exist. <br />
<br />
How can I solve this problem? Please help me.<br />
<br />
BR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cheryll</div><div class="date">31st August 2007, 07:31</div></div><div class="posttext">Well, RMDir will only delete the specified folder. If you secified D:\xxx\xxx\installation as you instdir, then it will only delete \installation. If you want to remove the other folders as well just repeat the process:<br />
RMDir &quot;D:\xxx\xxx&quot;<br />
RMDir &quot;D:\xxx&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bardy</div><div class="date">31st August 2007, 08:18</div></div><div class="posttext">Thank you for your answer. But you know, I just wrote code &quot;RMDIR $INSTDIR&quot;. Before someone specified the folder when they implemented the instllation, I don't know what directory they want. Perhaps they will choose &quot;D:\aaa\installation&quot; or &quot;C:\bbb\ccc\installation&quot;. I just wanna uninstallation can remove any folder they chose.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cheryll</div><div class="date">31st August 2007, 08:49</div></div><div class="posttext">I do understand you point, but RMDir just deletes the topmost directory.I haven't bothered with something like this yet, cause most people probably wont put a lot of empty directorys befor the acctual folder.<br />
But I guess you can use getParent. It will give you the next over- directory. <br />
It's not very elegant, but it works. Perhaps someone else will have a better idea. I'm rather new to NSIS myself.<br />
<br />
!include &quot;FileFunc.nsh&quot;<br />
!insertmacro un.GetParent<br />
[...]<br />
RMdir $instdir<br />
${un.GetParent} $instdir $R0   <br />
;first the directory then the variable where to put the parent<br />
RMdir $R0<br />
${un.GetParent} $R0 $R1<br />
RMDir $R1<br />
...etc.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bardy</div><div class="date">31st August 2007, 08:59</div></div><div class="posttext">Thank you very much!! You help me a lot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">31st August 2007, 13:04</div></div><div class="posttext">Indirectly related note: I noticed that if you use SetOutPath &quot;$PLUGINSDIR&quot; during installation (this set the current directory), NSIS won't be able to remove this temporary plugins directory at the end of installation, so make sure you move out, for example with a SetOutPath &quot;$INSTDIR&quot;, before ending installation<br />
<br />
I guess a similar problem might occur if you SetOutPath &quot;$INSTDIR&quot; during uninstallation, you might then not be able to RMDir $INSTDIR<br />
<br />
Because Windows won't let you remove a directory if current directory is still pointing to it</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fluidz91</div><div class="date">20th February 2008, 11:19</div></div><div class="posttext">I have the same issue.<br />
I m afraid that with this method you can erase all the &quot;Program Files&quot; folder or even worst the root of drive !<br />
<br />
By default, the install folder ($INSTDIR) is &quot;$PROGRAMFILES\Company\ProductName&quot; but it can be c:\company\productname or c:\productname or whatever<br />
<br />
on uninstall section i do RmDir /r /REBOOTOK $INSTDIR and on my first exemple &quot;$PROGRAMFILES\Company\&quot; is left.<br />
The use of GetParent seems to be dangerous when you don't know how many subfolders are created.<br />
Any clue ?<br />
<br />
<br />
<br />
Originally posted by cheryll <br />
I do understand you point, but RMDir just deletes the topmost directory.I haven't bothered with something like this yet, cause most people probably wont put a lot of empty directorys befor the acctual folder.<br />
But I guess you can use getParent. It will give you the next over- directory. <br />
It's not very elegant, but it works. Perhaps someone else will have a better idea. I'm rather new to NSIS myself.<br />
<br />
!include &quot;FileFunc.nsh&quot;<br />
!insertmacro un.GetParent<br />
[...]<br />
RMdir $instdir<br />
${un.GetParent} $instdir $R0   <br />
;first the directory then the variable where to put the parent<br />
RMdir $R0<br />
${un.GetParent} $R0 $R1<br />
RMDir $R1<br />
...etc.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>