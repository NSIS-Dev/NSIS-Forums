<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" DLL version numbering, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  DLL version numbering NSIS Discussion" />
	
	<title> DLL version numbering [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  DLL version numbering</div>
<hr />
<div class="pda"><a href="t-95793.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=95793">DLL version numbering</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Kypec</div><div class="date">26th July 2002, 13:02</div></div><div class="posttext">While I've been trying GetDLLVersion functionality I discovered the following: the numbers which I obtain when calling this function (NSIS 1.99) and the numbers which I can see when viewing the properties of the file (File version tab) are not always the same. Here is a short list obtained from my Win98SE system -<br />
filename    file version tab    GetDLLVersion returned value<br />
OLEAUT32.DLL    2.40.4515    00020028 11A30000 - seems OK<br />
MFC42.DLL       6.00.8665.0  00060000 21D90000 - seems OK<br />
MSVCRT.DLL      6.10.8924.0  00060001 22DC0000 - .10.&lt;&gt;0001 !!!<br />
FM20.DLL        2.01         00020001 17E00001 - what's that 17E00001?<br />
COMDLG32.OCX    6.00.8418    00060000 00540012 - .8418 together?<br />
IO.OCX          1.11         00010001 00010000 - .11 together?<br />
<br />
Can anybody explain these irregularities to me? :igor:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">26th July 2002, 14:42</div></div><div class="posttext">There is at least three ways to obtain the version information about a file using Windows (at a programming level) so it can get confusing. I don't have time to investigate fully but as a quick alternative you might try http://www.clantpa.co.uk/nsis/x18sysinfoV0.0.zip which I wrote a while back. It allows you to get the following information (using msvcrt.dll as an example) :-<br />
<br />
Method One:<br />
GetDllVersion is not supported by msvcrt.dll but for files that do support it it returns Version, Build and Platform.<br />
<br />
Method Two:<br />
via the dll method GetFileVersion().<br />
6.1.9359.0<br />
<br />
Method Three:<br />
via the dll method GetFileVersionValue().<br />
<br />
Company Name: Microsoft Corporation<br />
File Description: Microsoft (R) C Runtime Library<br />
File Version: 6.10.9359.0<br />
Internal Name: MSVCRT.DLL<br />
LegalCopyright: Copyright (C) Microsoft Corp. 1981-1999<br />
Original Filename: MSVCRT.DLL<br />
Product Name: Microsoft (R) Visual C++<br />
Product Version: 6.10.9359.0<br />
<br />
Now I haven't looked at this for a while but what interests me is that methods two and three return slightly different numbers as you noticed. Maybe you can use the third method in my dll to always obtain the correct number.<br />
<br />
<br />
Just tried it on comdlg32.ocx and I get back :-<br />
Method One: Not supported<br />
Method Two: 6.0.84.18<br />
Method Three: 6.00.8418</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>