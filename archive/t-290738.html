<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installer crash in Vista RTM, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installer crash in Vista RTM NSIS Discussion" />
	
	<title> Installer crash in Vista RTM [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installer crash in Vista RTM</div>
<hr />
<div class="pda"><a href="t-290738.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=290738">Installer crash in Vista RTM</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">canute</div><div class="date">23rd April 2008, 21:19</div></div><div class="posttext">I'm seeing an NSIS Installer / Uninstaller crash that seems to only occur in Vista RTM. The installer seems to work fine in XP and Vista SP1. However the setup needs to support RTM as well. The crash occurs seemingly at random throughout the install process, and doesn't happen all the time. It crashes with the following error report:<br />
<br />
Problem signature:<br />
  Problem Event Name:         APPCRASH<br />
  Application Name:           Setup.exe_unknown<br />
  Application Version:        0.0.0.0<br />
  Application Timestamp:      47eebf2f<br />
  Fault Module Name:	      comdlg32.dll_unloaded<br />
  Fault Module Version:	      0.0.0.0<br />
  Fault Module Timestamp:     549bd09<br />
  Exception Code:	      c0000005<br />
  Exception Offset:	      77154593<br />
  OS Version:	              6.0.6000.2.0.0.256.1<br />
  Locale ID:	              1033<br />
  Additional Information 1:   2b5e<br />
  Additional Information 2:   d41d8cd98f00b204e9800998ecf8427e<br />
  Additional Information 3:   3080<br />
  Additional Information 4:	1ca6700788fcc8e9282daf2f5d93c6a5<br />
<br />
Read our privacy statement:<br />
  http://go.microsoft.com/fwlink/?linkid=50163&amp;clcid=0x0409<br />
<br />
Anyone see anything like this before? Also is it possible to get map files for NSIS 2.35?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd April 2008, 21:36</div></div><div class="posttext">Are you registering any DLL files? Try commenting those out and see if it still crashes.<br />
<br />
Installers work fine for me on Vista and I have received no reports of such crashes, so it might be something in the script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">canute</div><div class="date">25th April 2008, 16:30</div></div><div class="posttext">I am using DLL files, but when I use the installer in silent mode (no dialogs or windows drawn), it works fine. Since the dlls are still doing what they're supposed to in silent mode, I don't think its the dll's, at least the ones I'm using.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th April 2008, 16:35</div></div><div class="posttext">Try removing the registration of the DLL files. If it still crashes, attach a minimal script reproducing the problem (no need for File commands, RegDLL and installation of anything) and I'll take a look.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">canute</div><div class="date">30th April 2008, 03:04</div></div><div class="posttext">kichik,<br />
<br />
Thanks for your quick replies and suggestions. I believe I have successfully debugged the problem. It has something to do with plugin loading / unloading, which Vista RTM doesn't seem to like. I realized that it is safer to just leave SetPluginsUnload to 'alwaysoff'.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>