<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Changing Images using Install Options, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Changing Images using Install Options NSIS Discussion" />
	
	<title> Changing Images using Install Options [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Changing Images using Install Options</div>
<hr />
<div class="pda"><a href="t-169455.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=169455">Changing Images using Install Options</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">15th February 2004, 15:05</div></div><div class="posttext">How can I change an image of an image control (the images are the same size) in an Install Options page after selecting a radiobutton with NOTIFY flag? (means in run-time)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">15th February 2004, 15:19</div></div><div class="posttext">This page shows you how to use the APIs you need:<br />
<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=405</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">15th February 2004, 15:29</div></div><div class="posttext">I'll test that. And just another question, how I can check/uncheck checkboxes in run-time using Install Options?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">15th February 2004, 15:30</div></div><div class="posttext">By sending a window message. You can find a reference of all messages in the MSDN library.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">15th February 2004, 16:05</div></div><div class="posttext">I tried the code but it didn't work (EDIT: The object is not deleted, so continue the same):<br />
<br />
    System::Call &quot;${sysDeleteObject} (R1) .R2&quot;<br />
    MessageBox MB_OK $R2<br />
    System::Call '${sysLoadImage} (0, s, ${IMAGE_BITMAP}, 0, 0, ${LR_CREATEDIBSECTION}|${LR_LOADFROMFILE}) .R1' &quot;$0\$1.bmp&quot;<br />
    SendMessage $0 ${STM_SETIMAGE} ${IMAGE_BITMAP} $R1<br />
<br />
The MessageBox should show a non-zero result as MSDN says, but I put the right image handle, field 16 (before have only labels, textboxes, checkboxes and groupboxes):<br />
<br />
[Field 16]<br />
Type=Bitmap<br />
Text=C:\Games\C-evo\HAL.bmp<br />
State=&quot;C:\Games\C-evo\HAL.bmp&quot;<br />
Left=257<br />
Right=300<br />
Top=3<br />
Bottom=43<br />
<br />
What is wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">15th February 2004, 16:12</div></div><div class="posttext">Why are you deleting an object before loading the image?<br />
<br />
Did you detect the inner window field hwnd correctly (as described in the IO documentation)?<br />
<br />
Is that bitmap path correct? Does it return a valid bitmap handle?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">15th February 2004, 16:17</div></div><div class="posttext">I fixed it. YEAH, it's working!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">15th February 2004, 16:30</div></div><div class="posttext">About the checkbox thing, I know that is BM_SETCHECK, but I don't know its number value. Where I can find it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">15th February 2004, 16:36</div></div><div class="posttext">The value is:<br />
<br />
0xF1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">15th February 2004, 16:55</div></div><div class="posttext">Oh yeah! It works too. If someone wants the code, it is right here:<br />
<br />
!define BM_SETCHECK 0x00F1 # Message<br />
<br />
  !define BST_UNCHECKED 0x0000<br />
  !define BST_CHECKED 0x0001<br />
  !define BST_INDETERMINATE 0x0002<br />
<br />
  SendMessage $0 ${BM_SETCHECK} ${BST_CHECKED} &quot;&quot;<br />
<br />
  # Replace ${BST_CHECKED} with one of those &quot;BST_&quot; you want (uncheck, check or gray/check).<br />
<br />
Thanks Joost. NSIS is really the best. :up:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">16th February 2004, 13:15</div></div><div class="posttext">The StrCtlColors command supports variable for input? I'm having problems using this command.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">16th February 2004, 18:55</div></div><div class="posttext">It does not take variables, you should add two commands and run one of them.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">17th February 2004, 01:06</div></div><div class="posttext">Are you planning to add this &quot;variable support&quot; to StrCtlColors soon? If not that soon, have another way to paint controls without StrCtlColors?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">17th February 2004, 13:45</div></div><div class="posttext">Why do you need variable support? Use StrCmp to check the value of a variable and then run the SetCtlColors commands you need.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">18th February 2004, 11:43</div></div><div class="posttext">Because it depends from the user input from InstallOptions, if I do this the program script size will be gigantic.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">18th February 2004, 14:00</div></div><div class="posttext">So you want to use to be able to choose every possible color for your installer dialog? That's not currently possible.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">18th February 2004, 14:15</div></div><div class="posttext">Is why that question:<br />
<br />
Are you planning to add this &quot;variable support&quot; to StrCtlColors soon? If not that soon, have another way to paint controls without StrCtlColors?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">18th February 2004, 17:02</div></div><div class="posttext">You can sumbit a feature request at the project page. There is no other way to set a color.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">5th March 2004, 17:16</div></div><div class="posttext">the &quot;!define BM_SETCHECK 0x00F1&quot; is mentioned at this thread.<br />
could that be included in the winmessages.nsh, or isn't that a winmessage?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">5th March 2004, 21:19</div></div><div class="posttext">Currently WinMessages.nsi only contains the generic window messages, not the messages for all user interface controls.<br />
<br />
If anyone wants to extend this header file that would be nice :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">5th March 2004, 22:52</div></div><div class="posttext">i'd do it, but i don't know the messages. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">6th March 2004, 00:17</div></div><div class="posttext">I was thinking this entire week about that. Including some API's commonly used too.<br />
<br />
I've got the SDK and .NET SDK to use &quot;cl.exe&quot; compiler, but I have some problems when compiling NSIS; it gives me errors like files missing from NSIS Source:<br />
<br />
&quot;NSIS\Source\exehead\Release-zlib\icon.h&quot;<br />
<br />
Is it my problem or NSIS Source problem?<br />
<br />
(Target file: &quot;NSIS\Source\exedata.cpp&quot;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th March 2004, 10:33</div></div><div class="posttext">It means that you didn't compile the exehead project. But what does this have to do with the messages header file?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">7th March 2004, 10:59</div></div><div class="posttext">It's my lazyness to post new threads... If want you can move my post to a new thread. (I'll post the file in the next post)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">7th March 2004, 11:13</div></div><div class="posttext">I did the work for yesterday's entire morning to include all messages, styles... (defines) in just one file. <br />
<br />
To this work, delete all defines in your script for APIs messages (not the APIs themselves!) and include this powerful file.<br />
<br />
(just some defines which are the combination of other ones I don't know really how to calculate, and some others those have &quot;L&quot; at end of the number which I don't know what it means)<br />
<br />
The file is too big I had to upload it in my site (Size: 105kb):<br />
<br />
WinMessages.nsh.txt (http://www.geocities.com/civ_deguix/files/WinMessages.nsh.txt)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">7th March 2004, 12:43</div></div><div class="posttext">L means that it is a long number. NSIS won't do anything with it, so it should be removed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">7th March 2004, 13:32</div></div><div class="posttext">But when calling System plugin it does:<br />
<br />
!define HKEY_LOCAL_MACHINE 0x80000002<br />
<br />
System::Call &quot;Advapi32::RegCreateKeyA(l ${ROOT_KEY}, t 'Software/Test', i.r0) i.r1&quot;$1 = 0, means it passed. But replacing &quot;l&quot; with &quot;i&quot; gives error.<br />
<br />
The original number was &quot;(( HKEY ) (ULONG_PTR)((LONG)0x80000002) )&quot;<br />
<br />
So should be a warning for who uses System plugin.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">7th March 2004, 13:42</div></div><div class="posttext">Indeed, but the constant itself should not contain a L.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">7th March 2004, 13:43</div></div><div class="posttext">Yep, I'll comment those &quot;L&quot;, so they will know about that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">7th March 2004, 14:27</div></div><div class="posttext">OK, updated with L's commented, fixed some calculations (combinations with ORs and ANDs) and added Basic Registry (just those ones someone is talking about in another thread). I'll include more tomorrow.<br />
<br />
WinMessages.nsh.txt (http://www.geocities.com/civ_deguix/files/WinMessages.nsh.txt) (Size: 109kb)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">7th March 2004, 14:47</div></div><div class="posttext">Can you split it up in multiple header files?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">8th March 2004, 03:06</div></div><div class="posttext">All those were inside WinUser.h, this one is the biggest file of defines on the SDK (I think).<br />
<br />
Yes, I can. But by what way do you suggest? I'm putting even more defines from other SDK files now (separated by comments of each file name included)...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">8th March 2004, 12:26</div></div><div class="posttext">Using such huge files will slow down compilation. It's better to split it up and let people choose.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">8th March 2004, 22:25</div></div><div class="posttext">I was thinking this way, as every define is from a group of defines, to organize them as they were organizated, like:<br />
<br />
All &quot;HKEY_*&quot; defines will be in one group called HKEY.<br />
All &quot;WM_*&quot; defines will be in one group called WM.<br />
<br />
So the compilation will be not so big as before, and you'll use those really you want.<br />
<br />
What do you think about this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">9th March 2004, 13:41</div></div><div class="posttext">Please test how long it takes to include the files or groups.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">9th March 2004, 21:36</div></div><div class="posttext">My computer is too fast it compiles the Modern UI examples (for example) in less than 1 second. Including with this huge file. But I didn't finished my work here, I need to add more define, however I didn't split it up yet. I'm working on several things at the same time so don't expect this done to today, nor tomorrow...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>