<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Need Help, all i want is a shortcut on startmenu, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Need Help, all i want is a shortcut on startmenu NSIS Discussion" />
	
	<title> Need Help, all i want is a shortcut on startmenu [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Need Help, all i want is a shortcut on startmenu</div>
<hr />
<div class="pda"><a href="t-223606.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=223606">Need Help, all i want is a shortcut on startmenu</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">XeoNoX</div><div class="date">9th August 2005, 04:44</div></div><div class="posttext">Im doing this the cheezy way because im new to this whole installer thing, so im using the ZIP to EXE installer program.<br />
<br />
I have the following line of code in the /contrib/zip2exe/modern.nsh file, and its making shortcuts but it is installing twice and i end up with 2 shortcuts, what am i doing wrong all i want is the shortcut to go in C:\Documents and Settings\All Users\Start Menu\Programs\XYZ\xyz.lnk<br />
and maybe one on the desktop if its not too complicated.<br />
<br />
can someone help me witht the right code?<br />
<br />
---------------------------------------------------------<br />
;Change this file to customize zip2exe generated installers with a modern interface<br />
<br />
!include &quot;MUI.nsh&quot;<br />
<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!insertmacro MUI_PAGE_INSTFILES<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
Page custom StartMenuGroupSelect &quot;&quot; &quot;: Start Menu Folder&quot;<br />
Function StartMenuGroupSelect<br />
	Push $R1<br />
<br />
	StartMenu::Select /checknoshortcuts &quot;Don't create a start menu folder&quot; /autoadd /lastused $R0 &quot;XYZ&quot;<br />
	Pop $R1<br />
<br />
	StrCmp $R1 &quot;success&quot; success<br />
	StrCmp $R1 &quot;cancel&quot; done<br />
		; error<br />
		MessageBox MB_OK $R1<br />
		Return<br />
	success:<br />
	Pop $R0<br />
<br />
	done:<br />
	Pop $R1<br />
FunctionEnd<br />
<br />
Page instfiles<br />
Section<br />
	# this part is only necessary if you used /checknoshortcuts<br />
	StrCpy $R1 $R0 1<br />
	StrCmp $R1 &quot;&gt;&quot; skip<br />
<br />
		SetShellVarContext All<br />
		CreateDirectory $SMPROGRAMS\$R0<br />
		CreateShortCut &quot;$SMPROGRAMS\$R0\All users XYZ.lnk&quot; $INSTDIR\XYZ.exe<br />
<br />
	skip:<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">9th August 2005, 08:34</div></div><div class="posttext">you can add IfFileExists (http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.4.10) before creating a shortcut and skip this, if it exists already</div></div><hr />


<div class="post"><div class="posttop"><div class="username">XeoNoX</div><div class="date">10th August 2005, 02:09</div></div><div class="posttext">so how should the code look?<br />
<br />
<br />
IfFileExists $INSTDIR\XYZ.exe 0 +2<br />
<br />
<br />
then what???</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>