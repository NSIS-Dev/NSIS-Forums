<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Newbie question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Newbie question NSIS Discussion" />
	
	<title> Newbie question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Newbie question</div>
<hr />
<div class="pda"><a href="t-326161.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=326161">Newbie question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jzakula</div><div class="date">18th January 2011, 23:35</div></div><div class="posttext">I'm new to NSIS (couple of days). It seems to be a great tool thus far. I seem to have everything working except for one issue. I'm installing a 32 bit legacy app on Windows 7x64. I cannot get the InstallLib  macro to write files to $SYSDIR or &quot;$COMMONFILES\Microsoft Shared\VFP&quot;.<br />
<br />
I think I have set RequestExecutionLevel and used UAC_RunElevated correctly?? from what I found in the examples and forums. The File statement does succeed in creating a file in the SysWOW64 folder, so $SYSDIR is working for it. It also creates the $INSTDIR folder under Program Files x64 and populates the files. There are no error messages; the $SYSDIR files simply do not get created. I seem to be close but I must be missing something simple - either a setting, system variable, or I may not fully understand the coding order required.<br />
<br />
I am listing the code (less uninstall) in hopes that someone can look at it and point me in the right direction.<br />
<br />
<br />
; Script generated by the HM NIS Edit Script Wizard.<br />
<br />
; HM NIS Edit Wizard helper defines<br />
!define PRODUCT_NAME &quot;KOF Data System&quot;<br />
!define PRODUCT_VERSION &quot;1.0&quot;<br />
!define PRODUCT_PUBLISHER &quot;KOF Company&quot;<br />
!define PRODUCT_WEB_SITE &quot;http://www.zakula.com&quot;<br />
!define PRODUCT_DIR_REGKEY &quot;Software\Microsoft\Windows\CurrentVersion\App Paths\kfMain.exe&quot;<br />
!define PRODUCT_UNINST_KEY &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}&quot;<br />
!define PRODUCT_UNINST_ROOT_KEY &quot;HKLM&quot;<br />
!define PRODUCT_STARTMENU_REGVAL &quot;NSIS:StartMenuDir&quot;<br />
<br />
; MUI 1.67 compatible ------<br />
!include &quot;MUI.nsh&quot;<br />
<br />
!include LogicLib.nsh<br />
<br />
; Administrative priveleges<br />
!include UAC.nsh<br />
<br />
; 64 bit compatibility ------<br />
!include x64.nsh        ; jz<br />
<br />
; DLL/TLB installation routine ------<br />
!include Library.nsh        ; jz<br />
<br />
; MUI Settings<br />
!define MUI_ABORTWARNING<br />
!define MUI_ICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico&quot;<br />
!define MUI_UNICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico&quot;<br />
<br />
; Welcome page<br />
!insertmacro MUI_PAGE_WELCOME<br />
<br />
; License page<br />
!define MUI_LICENSEPAGE_CHECKBOX<br />
!insertmacro MUI_PAGE_LICENSE &quot;g:\kof_setup_9\License.txt&quot;<br />
<br />
; Start menu page<br />
var ICONS_GROUP<br />
!define MUI_STARTMENUPAGE_NODISABLE<br />
!define MUI_STARTMENUPAGE_DEFAULTFOLDER &quot;KOF Data System&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_ROOT &quot;${PRODUCT_UNINST_ROOT_KEY}&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_KEY &quot;${PRODUCT_UNINST_KEY}&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME &quot;${PRODUCT_STARTMENU_REGVAL}&quot;<br />
!insertmacro MUI_PAGE_STARTMENU Application $ICONS_GROUP<br />
<br />
; Instfiles page<br />
!insertmacro MUI_PAGE_INSTFILES<br />
<br />
; Finish page<br />
!define MUI_FINISHPAGE_RUN &quot;$INSTDIR\kfMain.exe&quot;<br />
!define MUI_FINISHPAGE_SHOWREADME &quot;$INSTDIR\ReadMe.txt&quot;<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
; Uninstaller pages<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
; Language files<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
; MUI end ------<br />
<br />
Name &quot;${PRODUCT_NAME} ${PRODUCT_VERSION}&quot;<br />
OutFile &quot;kfSetup.exe&quot;<br />
InstallDir &quot;$PROGRAMFILES\KOF&quot;<br />
InstallDirRegKey HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot;<br />
BrandingText 'KOF System'<br />
ShowInstDetails show<br />
ShowUnInstDetails show<br />
RequestExecutionLevel none<br />
BGGradient FF0000 0000FF 00FF00<br />
Icon 'g:\kof_Setup_9\kof.ico'<br />
InstProgressFlags 'smooth'<br />
LicenseBkColor '/windows'<br />
WindowIcon on<br />
SetFont Tahoma 10<br />
<br />
<br />
;;;;;;;;; FUNCTION .ONINIT ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
Function .onInit     ; jz<br />
<br />
  ; Try to setup admin priveleges for install process (COPIED EXAMPLE)<br />
  uac_tryagain:<br />
  !insertmacro UAC_RunElevated<br />
  #MessageBox mb_TopMost &quot;0=$0 1=$1 2=$2 3=$3&quot;<br />
  ${Switch} $0<br />
  ${Case} 0<br />
  	${IfThen} $1 = 1 ${|} Quit ${|} ;we are the outer process, the inner process has done its work, we are done<br />
  	${IfThen} $3 &lt;&gt; 0 ${|} ${Break} ${|} ;we are admin, let the show go on<br />
  	${If} $1 = 3 ;RunAs completed successfully, but with a non-admin user<br />
  		MessageBox mb_IconExclamation|mb_TopMost|mb_SetForeground &quot;This installer requires admin access, try again&quot; /SD IDNO IDOK uac_tryagain IDNO 0<br />
  	${EndIf}<br />
  	;fall-through and die<br />
  ${Case} 1223<br />
  	MessageBox mb_IconStop|mb_TopMost|mb_SetForeground &quot;This installer requires admin privileges, aborting!&quot;<br />
  	Quit<br />
  ${Case} 1062<br />
  	MessageBox mb_IconStop|mb_TopMost|mb_SetForeground &quot;Logon service not running, aborting!&quot;<br />
  	Quit<br />
  ${Default}<br />
  	MessageBox mb_IconStop|mb_TopMost|mb_SetForeground &quot;Unable to elevate , error $0&quot;<br />
  	Quit<br />
  ${EndSwitch}<br />
  <br />
  <br />
  ; Set up and display splash screen w/fade-in<br />
  SetOutPath $TEMP<br />
  File /oname=$PLUGINSDIR\SplashTmp.bmp &quot;g:\kof_setup_9\KOF_SetupSplash1.bmp&quot;<br />
  advsplash::show 1000 850 500 -1 $PLUGINSDIR\SplashTmp<br />
  <br />
  <br />
  ; To determine the system folders (32 bit or 64 bit) at runtime<br />
  ${EnableX64FSRedirection}<br />
  StrCpy $INSTDIR &quot;$PROGRAMFILES\KOF&quot;<br />
FunctionEnd<br />
;;;;;;;;; FUNCTION .ONINIT ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
<br />
<br />
;;;;;;;;; FUNCTION .ONGUIEND ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
Function .onGuiEnd     ; jz<br />
  ; Run PostgreSql ODBC 8.3 install application, and then delete it<br />
  ExecWait '&quot;msiexec&quot; /i &quot;$INSTDIR\psql_odbc_8_3.msi&quot;'  ; PostgreSQL ODBC installer<br />
  ;Delete &quot;$INSTDIR\psql_odbc_8_3.msi&quot;<br />
  <br />
  ; If Chosen by user, display the readme file<br />
  MessageBox MB_YESNO|MB_ICONQUESTION &quot;Do you wish to view the ReadMe file now?&quot; IDNO false<br />
    !system '&quot;$WINDIR\notepad.exe&quot; &quot;$INSTDIR\ReadMe.txt&quot;'<br />
    false:<br />
  <br />
  MessageBox MB_YESNO|MB_ICONQUESTION &quot;The computer must be rebooted for settings to take effect. Do you wish to reboot your computer now?&quot; IDNO false2<br />
    Reboot<br />
    false2:<br />
FunctionEnd<br />
;;;;;;;;; FUNCTION .ONGUIEND ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
<br />
<br />
<br />
;;;;;;; SECTION SEC01 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
Section &quot;MainSection&quot; SEC01<br />
  SetOverwrite ifnewer<br />
<br />
  ; Copy into $INSTDIR<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  <br />
  ; Copy app-specific files<br />
  File &quot;g:\kof_setup_9\kfMain.exe&quot;<br />
  File &quot;g:\kof_setup_9\Config.fpw&quot;<br />
  File &quot;g:\kof_setup_9\AppStart.app&quot;<br />
  ; Dummy app to trigger &quot;get updated build&quot; process<br />
  File &quot;g:\kof_setup_9\kf0000.app&quot;<br />
  File &quot;g:\kof_setup_9\AppInfo.ini&quot;<br />
  File &quot;g:\kof_setup_9\ReportOutput.app&quot;<br />
  File &quot;g:\kof_setup_9\ReportPreview.app&quot;<br />
  File &quot;g:\kof_setup_9\ReportBuilder.app&quot;<br />
  File &quot;g:\kof_setup_9\FoxTools.fll&quot;<br />
  File &quot;g:\kof_setup_9\MD5.fll&quot;<br />
  File &quot;g:\kof_setup_9\FoxUser.dbf&quot;<br />
  File &quot;g:\kof_setup_9\FoxUser.fpt&quot;<br />
  File &quot;g:\kof_setup_9\vfpAlert.exe&quot;<br />
  <br />
  ; Copy necessary ODBC driver installation package<br />
  File &quot;g:\kof_setup_9\PostgresOdbcDriver\psql_odbc_8_3.msi&quot;<br />
<br />
  ; Copy files needed for Dazzle interface is to be shipping computer<br />
  CreateDirectory &quot;$INSTDIR\Dazzle&quot;<br />
  SetOutPath &quot;$INSTDIR\Dazzle&quot;<br />
  File &quot;g:\kof_setup_9\Dazzle\Dazzle_BoundPrint.lyt&quot;<br />
  File &quot;g:\kof_setup_9\Dazzle\Dazzle_FirstClass.lyt&quot;<br />
  File &quot;g:\kof_setup_9\Dazzle\Dazzle_MediaMail.lyt&quot;<br />
  File &quot;g:\kof_setup_9\Dazzle\Dazzle_ParcelPost.lyt&quot;<br />
  File &quot;g:\kof_setup_9\Dazzle\Dazzle_PriorityMail.lyt&quot;<br />
  File &quot;g:\kof_setup_9\Dazzle\Dazzle_APO_FPO_ShipLabel.lyt&quot;<br />
  File &quot;g:\kof_setup_9\Dazzle\Dazzle_Lg_Pri_Intl_ShipLbl.lyt&quot;<br />
  File &quot;g:\kof_setup_9\Dazzle\KofPackage1.lyt&quot;<br />
  File &quot;g:\kof_setup_9\Dazzle\DazzleAddressCodes.txt&quot;<br />
  File &quot;g:\kof_setup_9\Dazzle\DazzlePostalServices.txt&quot;<br />
  File &quot;g:\kof_setup_9\Dazzle\KofDazzle_ReadMe.txt&quot;<br />
  <br />
  ; Copy into $INSTDIR\BarCode_Scanner<br />
  CreateDirectory &quot;$INSTDIR\BarCode_Scanner&quot;<br />
  SetOutPath &quot;$INSTDIR\BarCode_Scanner&quot;<br />
  File &quot;g:\kof_setup_9\BarCode_Scanner\Free3of9.txt&quot;<br />
  File &quot;g:\kof_setup_9\BarCode_Scanner\kf_ScannerSetup.txt&quot;<br />
  File &quot;g:\kof_setup_9\BarCode_Scanner\Xi2000_Manual.pdf&quot;<br />
  File &quot;g:\kof_setup_9\BarCode_Scanner\Xi2000_Spec.pdf&quot;<br />
<br />
  ; Copy into $FONTS<br />
  SetOutPath &quot;$FONTS&quot;<br />
  File &quot;g:\kof_setup_9\BarCode_Scanner\Free3of9.ttf&quot;<br />
  File &quot;g:\kof_setup_9\BarCode_Scanner\Fre3of9x.ttf&quot;<br />
  <br />
  SetOutPath &quot;$SYSDIR&quot;<br />
  ; Try to use a straight file write to sysdir<br />
  File &quot;g:\kof_setup_9\TestSysDirFile.txt&quot;<br />
  <br />
  ; Install in $COMMONFILES or $SYSDIR<br />
  !insertmacro InstallLib DLL SHARED REBOOT_PROTECTED &quot;g:\kof_setup_9\MsVcr71.dll&quot; $SYSDIR $COMMONFILES<br />
  <br />
  CreateDirectory &quot;$COMMONFILES\Microsoft Shared\VFP&quot;<br />
  !insertmacro InstallLib DLL SHARED REBOOT_PROTECTED &quot;g:\kof_setup_9\GdiPlus.dll&quot; &quot;$COMMONFILES\Microsoft Shared\VFP&quot; $COMMONFILES<br />
  <br />
  !insertmacro InstallLib REGDLL SHARED REBOOT_PROTECTED &quot;g:\kof_setup_9\vfp9R.dll&quot; &quot;$COMMONFILES\Microsoft Shared\VFP&quot; $COMMONFILES<br />
  !insertmacro InstallLib REGDLL SHARED REBOOT_PROTECTED &quot;g:\kof_setup_9\vfp9T.dll&quot; &quot;$COMMONFILES\Microsoft Shared\VFP&quot; $COMMONFILES<br />
  !insertmacro InstallLib DLL SHARED REBOOT_PROTECTED &quot;g:\kof_setup_9\vfp9Renu.dll&quot; &quot;$COMMONFILES\Microsoft Shared\VFP&quot; $COMMONFILES<br />
  <br />
  !insertmacro InstallLib REGEXE SHARED REBOOT_PROTECTED &quot;g:\kof_setup_9\FoxHHelp9.exe&quot; &quot;$COMMONFILES\Microsoft Shared\VFP&quot; $COMMONFILES<br />
  !insertmacro InstallLib DLL SHARED REBOOT_PROTECTED &quot;g:\kof_setup_9\FoxHHelpPs9.dll&quot; &quot;$COMMONFILES\Microsoft Shared\VFP&quot; $COMMONFILES<br />
  <br />
  ; Already available in windows<br />
  ;!insertmacro InstallLib DLL SHARED REBOOT_PROTECTED &quot;g:\kof_setup_9\MsXml3.dll&quot; $SYSDIR $COMMONFILES<br />
  ;!insertmacro InstallLib DLL SHARED REBOOT_PROTECTED &quot;g:\kof_setup_9\MsXml3r.dll&quot; $SYSDIR $COMMONFILES<br />
  <br />
  !insertmacro InstallLib DLL    SHARED REBOOT_PROTECTED &quot;g:\kof_setup_9\MsXml3a.dll&quot; $SYSDIR $COMMONFILES<br />
  !insertmacro InstallLib REGDLL SHARED REBOOT_PROTECTED &quot;g:\kof_setup_9\MsXml4.dll&quot;  $SYSDIR $COMMONFILES<br />
  !insertmacro InstallLib REGDLL SHARED REBOOT_PROTECTED &quot;g:\kof_setup_9\MsXml4r.dll&quot; $SYSDIR $COMMONFILES<br />
  <br />
  !insertmacro InstallLib REGDLL SHARED    REBOOT_PROTECTED &quot;g:\kof_setup_9\Filer.dll&quot;    &quot;$COMMONFILES\Microsoft Shared\VFP&quot; $COMMONFILES<br />
  !insertmacro InstallLib DLL    NOTSHARED REBOOT_PROTECTED &quot;g:\kof_setup_9\DibApi32.dll&quot;  $INSTDIR $COMMONFILES<br />
<br />
  ; Create the Shortcuts<br />
  !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
  SetShellVarContext all<br />
  CreateDirectory &quot;$SMPROGRAMS\KOF Data System&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\KOF Data System\KOF.lnk&quot; &quot;$INSTDIR\kfMain.exe&quot;<br />
  CreateShortCut &quot;$DESKTOP\KOF.lnk&quot; &quot;$INSTDIR\kfMain.exe&quot;<br />
  CreateShortCut &quot;$QUICKLAUNCH\KOF.lnk&quot; &quot;$INSTDIR\kfMain.exe&quot;<br />
  SetShellVarContext current<br />
  !insertmacro MUI_STARTMENU_WRITE_END<br />
  <br />
SectionEnd<br />
;;;;;;; SECTION SEC01 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th January 2011, 00:11</div></div><div class="posttext">In your post, I assume you meant Program Files (x86)? You need to use ${DisableX64FSRedirection} to write to system32/Program Files. Also I would recommend using MUI2.nsh over MUI.nsh (uses nsDialogs and is therefore faster).<br />
<br />
Your script isn't too big but in future please attach the script or use pastebin.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jzakula</div><div class="date">19th January 2011, 00:37</div></div><div class="posttext">Hi Stu,<br />
<br />
Thanks, I did mean x86. <br />
<br />
I changed<br />
${EnableX64FSRedirection}<br />
to<br />
${DisableX64FSRedirection}<br />
but the 32 bit files still do not show up in the system directory (SysWoW64?) with InstallLib. Is .onInit the right place for this?<br />
<br />
Thanks for the prompt response.<br />
<br />
Jeff</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th January 2011, 11:09</div></div><div class="posttext">OK sorry if you want to install to SysWOW64 then you do not need to enable or disable file system redirection. Windows will redirect to SysWOW64 anyway. If it is not working then you don't have access to the folder. You need to use RequestExecutionLevel admin.<br />
<br />
Edit: Also .onInit would not be the correct place as the Wow64EnableWow64FsRedirection API only works for the current thread. Sections run under a new thread and therefore you'd need to use Wow64EnableWow64FsRedirection again.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jzakula</div><div class="date">19th January 2011, 17:45</div></div><div class="posttext">Hi Stu,<br />
<br />
I'm back again. I cannot seem to get get this thing to work. I've tried what you suggested and a host of other things. The InstallLib macro simply refuses to install any files in any system folders or any &quot;common files&quot; subfolders. The File command has no problem writing these dlls to the folders where InstallLib fails. <br />
<br />
What is the special secret to making InstallLib work? Do I need to use SetOutPath to point to the target directory even though the target directory is one of the parameters? Is my syntax somehow incorrect? Do I need to use the File command to copy the file first? How do I know it got registered, etc?<br />
<br />
I have attached my code so you can see the InstallLib syntax. I must be doing something really stupid, but I can't seem to see what. This is the only problem I've had, but without this functionality there is no install.<br />
<br />
Jeff</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jzakula</div><div class="date">19th January 2011, 17:55</div></div><div class="posttext">Sorry, I forgot to attach on the last post.<br />
<br />
Jeff</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th January 2011, 20:35</div></div><div class="posttext">Do you need to use the UAC plugin? I've been doing fine with RequestionExecutionLevel admin on Windows 7 32/64.<br />
<br />
I recommend just writing a basic script which does the bare minimum until you can find out the problem.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jzakula</div><div class="date">19th January 2011, 20:47</div></div><div class="posttext">No problem. I'll comment it out and try it.<br />
<br />
Also, I'm just about coded up to use the File command to create the files and RegDLL to register them. Is that a feasible way to do the same thing?<br />
<br />
Jeff</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th January 2011, 20:59</div></div><div class="posttext">It depends on the library. RegDll is the same as using regsvr32 /s (but does not depend on it).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jzakula</div><div class="date">26th January 2011, 18:28</div></div><div class="posttext">Hi Stu,<br />
<br />
I've been out of the office for a while. The presence of the UAC plugin didn't affect my problem either way. I did, when I got back, get things working in a round-about way. I found a prewritten installer for all the VFP support libraries that I needed. I called that installer from an ExecWait statement. I preceded that with instructions on a notepad window called from ExecWait. I followed that with a .msi to install odbc drivers via ExecWait.<br />
<br />
It's not thrilling, but it works. I would still like to know why InstallLib fails for the next time that I need to do something similar.<br />
<br />
Thanks for the effort,<br />
<br />
Jeff</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th January 2011, 18:56</div></div><div class="posttext">Notepad window? If you mean a console window you can hide those using nsExec.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jzakula</div><div class="date">27th January 2011, 16:43</div></div><div class="posttext">Well, actually it is a Notepad window. I don't need to really hide. I'm using an external installer (exe) for some of the support libraries during the middle of the NSIS install. But it requires to make a few selections on its start screen. So I use ExecWait to display the Notepad window with instructions on what to select, and it informs the user that the install process will continue when he closes the instruction window.<br />
<br />
But I have another question. In my script I would like to abstract the path where the compiler finds the source files. This way I could put everything on the local server where there is easy access to the installation executable. Also, edits and recompiles of the script that might be needed will always be where they are going to be used, eliminating the need to remember to copy any files when any change occurs.<br />
<br />
Can I just copy my current ${NSISDIR} tree to the server? Will everything work there from any computer, or is an install required because of support files or reg keys? Then I can add my source folders to that tree and and use ${NSISDIR} to find everything. Also, $EXEPATH and $EXEDIR do not presently work. Is this because I move the exe file after it gets compiled to the server where it gets run from desktop computers as a program on a mapped network drive? In fact, maybe this is why InstallLib does not work at runtime?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>