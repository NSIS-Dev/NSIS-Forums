<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Function to enable Adobe Flash Player silent automatic update feature, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Function to enable Adobe Flash Player silent automatic update feature NSIS Discussion" />
	
	<title> Function to enable Adobe Flash Player silent automatic update feature [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Function to enable Adobe Flash Player silent automatic update feature</div>
<hr />
<div class="pda"><a href="t-343851.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=343851">Function to enable Adobe Flash Player silent automatic update feature</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Rapport12</div><div class="date">6th April 2012, 22:12</div></div><div class="posttext">I created the following function to enable the Adobe Flash Player silent automatic update function that was introduced (http://blogs.adobe.com/asset/2012/03/an-update-for-the-flash-player-updater.html) in the recent 11.2 version.  KiCHiK's &quot;Replacing Lines in a Text File&quot; example code was very helpful here.  I believe you will also need LogicLib.nsh and x64.nsh as includes for this function to work.  I tested it with Windows XP (32-Bit) and Windows 7 (64-Bit).  Because you are accessing protected system files, you'll need &quot;RequestExecutionLevel&quot; set to &quot;Admin&quot; on Windows 7.  I just wanted to share it incase there are other systems administrators that could find it useful.  Thanks!<br />
<br />
<br />
Function SilentAutoUpdateEnable<br />
<br />
${If} ${RunningX64}<br />
<br />
	IfFileExists &quot;$WINDIR\SysWOW64\Macromed\Flash\mms.cfg&quot; 0 CreateMMSFile64<br />
<br />
	ClearErrors<br />
	FileOpen $0 &quot;$WINDIR\SysWOW64\Macromed\Flash\mms.cfg&quot; &quot;r&quot;			; open target file for reading<br />
	GetTempFileName $R0								; get new temp file name<br />
	FileOpen $1 $R0 &quot;w&quot;								; open temp file for writing<br />
	loop64:<br />
		FileRead $0 $2								; read line from target file<br />
		IfErrors done64								; check if end of file reached<br />
		StrCmp $2 &quot;SilentAutoUpdateEnable=0$\r$\n&quot; 0 +2				; compare line with search string with CR/LF<br />
			StrCpy $2 &quot;SilentAutoUpdateEnable=1$\r$\n&quot;			; change line<br />
 		StrCmp $2 &quot;SilentAutoUpdateEnable=0&quot; 0 +2				; compare line with search string without CR/LF (at the end of the file)<br />
			StrCpy $2 &quot;SilentAutoUpdateEnable=1&quot;				; change line<br />
		FileWrite $1 $2								; write changed or unchanged line to temp file<br />
	Goto loop64<br />
 <br />
	done64:<br />
		FileClose $0								; close target file<br />
		FileClose $1								; close temp file<br />
		Delete &quot;$WINDIR\SysWOW64\Macromed\Flash\mms.cfg&quot;			; delete target file<br />
   		CopyFiles /SILENT $R0 &quot;$WINDIR\SysWOW64\Macromed\Flash\mms.cfg&quot;		; copy temp file to target file<br />
   		Delete $R0								; delete temp file<br />
	Goto Complete64<br />
<br />
	CreateMMSFile64:<br />
<br />
		FileOpen $9 &quot;$WINDIR\SysWOW64\Macromed\Flash\mms.cfg&quot; &quot;w&quot;		; creates the file and opens it for write<br />
		FileWrite $9 &quot;AutoUpdateDisable=0$\r$\n&quot;				; write the first line<br />
		FileWrite $9 &quot;SilentAutoUpdateEnable=1&quot;					; write the last line<br />
		FileClose $9								; closes and saves the file<br />
	<br />
	Complete64:<br />
	<br />
<br />
${Else}<br />
<br />
	IfFileExists &quot;$WINDIR\system32\Macromed\Flash\mms.cfg&quot; 0 CreateMMSFile32<br />
<br />
	ClearErrors<br />
	FileOpen $0 &quot;$WINDIR\system32\Macromed\Flash\mms.cfg&quot; &quot;r&quot;			; open target file for reading<br />
	GetTempFileName $R0								; get new temp file name<br />
	FileOpen $1 $R0 &quot;w&quot;								; open temp file for writing<br />
	loop32:<br />
		FileRead $0 $2								; read line from target file<br />
		IfErrors done32								; check if end of file reached<br />
		StrCmp $2 &quot;SilentAutoUpdateEnable=0$\r$\n&quot; 0 +2				; compare line with search string with CR/LF<br />
			StrCpy $2 &quot;SilentAutoUpdateEnable=1$\r$\n&quot;			; change line<br />
		StrCmp $2 &quot;SilentAutoUpdateEnable=0&quot; 0 +2				; compare line with search string without CR/LF (at the end of the file)<br />
 			StrCpy $2 &quot;SilentAutoUpdateEnable=1&quot;				; change line<br />
		FileWrite $1 $2								; write changed or unchanged line to temp file<br />
	Goto loop32<br />
<br />
	done32:<br />
		FileClose $0								; close target file<br />
		FileClose $1								; close temp file<br />
		Delete &quot;$WINDIR\system32\Macromed\Flash\mms.cfg&quot;			; delete target file<br />
		CopyFiles /SILENT $R0 &quot;$WINDIR\system32\Macromed\Flash\mms.cfg&quot;		; copy temp file to target file<br />
		Delete $R0								; delete temp file<br />
	Goto Complete32<br />
<br />
	CreateMMSFile32:<br />
<br />
		FileOpen $9 &quot;$WINDIR\system32\Macromed\Flash\mms.cfg&quot; &quot;w&quot;		; creates the file and opens it for write<br />
		FileWrite $9 &quot;AutoUpdateDisable=0$\r$\n&quot;				; write the first line<br />
		FileWrite $9 &quot;SilentAutoUpdateEnable=1&quot;					; write the last line<br />
		FileClose $9								; closes and saves the file<br />
<br />
	Complete32:<br />
<br />
${EndIf}<br />
<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th April 2012, 22:59</div></div><div class="posttext">You don't need to have the code twice for 32/64. NSIS is 32-bit so will always point to SysWOW64 on 64-bit Windows and System32 on 32-bit Windows when you use $SYSDIR (unless you disable file system redirection using the macro in x64.nsh).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">7th April 2012, 01:56</div></div><div class="posttext">from my view - code that none needs - as you pointed out to adobe blogs the updater has itself this option. <br />
and 11.2 is present version. eot<br />
http://www.adobe.com/products/flashplayer/distribution3.html</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">7th April 2012, 07:42</div></div><div class="posttext">Thanks for sharing. But next time please use an attachment or pastebin for something this big. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Rapport12</div><div class="date">9th April 2012, 17:55</div></div><div class="posttext">Afrow UK - You're right.  The code is redundant.  Thanks for the tip.  :)<br />
<br />
Brummelchen - The code allows systems administrators that manage hundreds or thousands of systems to enable this feature automatically.  I did not see an option in the native Flash installer to control this feature.  The only current methods of enabling the feature, to my knowledge, are via the mms.cfg file and the Flash control panel applet.<br />
<br />
MSG - Thanks for the tip on using an attachment.  Will do next time around.<br />
<br />
<br />
Thanks for the feedback!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>