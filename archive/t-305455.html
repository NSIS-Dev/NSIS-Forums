<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Special ShortCut with Short File Paths, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Special ShortCut with Short File Paths NSIS Discussion" />
	
	<title> Special ShortCut with Short File Paths [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Special ShortCut with Short File Paths</div>
<hr />
<div class="pda"><a href="t-305455.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305455">Special ShortCut with Short File Paths</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">grendell2099</div><div class="date">17th April 2009, 12:09</div></div><div class="posttext">I need some help creating a â€œspecialâ€ shortcut. I have read a lot of posts here but am not finding my answer. The shortcut is for an Access file with workgroup security so it has a long string by the time you get the 3 filepaths and commands put together. I am trying to use short paths for the necessary files so I do not hit the 256 character limit on the string.<br />
	I figured out how to get the quotes in the correct places, but now I cannot get the short file path to show up in the shortcut. It appears correctly in the String2 variable, but the shortcut created has the long path. Below is the code I am using (with short file paths just for testing- the real ones are quite long). Can anyone advise on what I am missing?<br />
<br />
# name the installer<br />
outFile &quot;CreateShortCut.exe&quot;<br />
<br />
Var String2<br />
!define MyTest &quot;MSACCESS.EXE&quot;<br />
<br />
section<br />
SetOutPath $INSTDIR<br />
GetFullPathName /SHORT $String2 &quot;C:\Program Files\Microsoft Office\Office10\MSACCESS.EXE&quot;<br />
DetailPrint $String2<br />
CreateShortCut &quot;TESTshortCut.lnk&quot; $String2 '/user BOB /wrkgrp &quot;F:\WRKGP.mdw&quot;/pwd &quot;PW&quot; &quot;C:\TEMP_JUNK\TEST.mde&quot;' &quot;&quot;<br />
;Quit<br />
sectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">17th April 2009, 12:42</div></div><div class="posttext">windows probably thinks its helping out and coverts the path for you<br />
<br />
its probably better to create a shortcut to a batch file (or a little nsis app or a windows scripting host script) that runs the command for you<br />
<br />
<br />
@echo off<br />
start MSACCESS.EXE /foo /bar<br />
cls<br />
<br />
only problem with that is that it will flash a black screen for 1 second (you can probably set the shortcut to start minimized)<br />
<br />
or a scripting host script, something like<br />
<br />
var s=WScript.CreateObject(&quot;WScript.Shell&quot;);<br />
s.Run(&quot;MSACCESS.EXE /param1 \&quot;quoted param\&quot; /param3&quot;);<br />
<br />
the shortcut would have to execute &quot;$sysdir\wscript.exe&quot; with &quot;$instdir\yourscript.js&quot; as a parameter<br />
<br />
BUT, the real way to do this is to use COM automation in a windows scripting host script<br />
<br />
in VBScript it would probably look something like<br />
<br />
dim acc<br />
set acc = CreateObject(&quot;Access.Application&quot;)<br />
with acc<br />
 .Visible=true<br />
 .OpenCurrentDatabase &quot;C:\path\file.mdb&quot;<br />
 ....etc...<br />
end with<br />
<br />
(not that I have ever done any office automation)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grendell2099</div><div class="date">17th April 2009, 12:57</div></div><div class="posttext">Thanks for the input Anders. I had been thinking of this in terms of getting a shortcut set up during installation (there is always one computer with a weird exe location). However, I already use a small NSIS &quot;launcher&quot; to check for updates and open the database... it makes more sense to have the launcher find the correct exe and use it there. <br />
     I will approach it that way and see what I come up with.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">17th April 2009, 13:05</div></div><div class="posttext">with com automation, you don't need to know where the exe is</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grendell2099</div><div class="date">20th April 2009, 11:33</div></div><div class="posttext">Thanks again Anders for the assist. I haven't used com automation so I have some studying to do...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>