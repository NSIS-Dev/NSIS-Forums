<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installing VC++ 8.0.CRT redistributables, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installing VC++ 8.0.CRT redistributables NSIS Discussion" />
	
	<title> Installing VC++ 8.0.CRT redistributables [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installing VC++ 8.0.CRT redistributables</div>
<hr />
<div class="pda"><a href="t-289030.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289030">Installing VC++ 8.0.CRT redistributables</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ojt</div><div class="date">25th March 2008, 15:17</div></div><div class="posttext">I know this has been asked before, but I can't seem to find an answer.<br />
<br />
I have a program which depends on the VC++ 8.0.CRT redistributables (msvcr80.dll and friends) beeing installed system wide. <br />
<br />
We are currently using InstallShield Express, but would like to switch to NSIS. <br />
<br />
IS has an option that automatically installs redistributables. How can this be done using NSIS? I'd like to avoid calling the VC++ 8.0.CRT installer, but rather have NSIS do the installation.<br />
<br />
I'm a newbee to NSIS, so please spoonfeed me...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">25th March 2008, 16:09</div></div><div class="posttext">I did it for our installer by 'unpacking' the VC8 CRT exe, and getting the msi and cab files buried inside it. Then I call ExecWait to install those.    SetOutPath $PLUGINSDIR<br />
    File &quot;.\SCC_LIB\WindowsInstaller-KB893803-v2-x86.exe&quot;<br />
    File &quot;.\SCC_LIB\VCRedist.msi&quot;<br />
    File &quot;.\SCC_LIB\VCRedis1.cab&quot;<br />
<br />
    ExecWait '&quot;$PLUGINSDIR\WindowsInstaller-KB893803-v2-x86.exe&quot;  /quiet /norestart'<br />
<br />
    ExecWait '&quot;$SYSDIR\msiexec.exe&quot; /i $PLUGINSDIR\VCRedist.msi /qn /norestart'<br />
Windows Installer 3.1 is not standard on Windows 2000, so I am also installing that in the code above.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nooky59</div><div class="date">25th March 2008, 16:31</div></div><div class="posttext">Hey,<br />
<br />
I'm on a same subject today (but I embed a VC++ 9.0 CRT) but it's the same.<br />
<br />
Here is what I've done :<br />
<br />
Section &quot;Microsoft Visual C++ 2008 Redistributable Package (x86)&quot; SEC02<br />
  File &quot;C:\Documents and Settings\nooky59\Bureau\vcredist_x86.exe&quot;<br />
  ExecWait '$INSTDIR\vcredist_x86.exe /q:a /c:&quot;VCREDI~3.EXE /q:a /c:&quot;&quot;msiexec /i vcredist.msi /qn&quot;&quot; &quot;'<br />
SectionEnd<br />
<br />
I've found it there :<br />
<br />
http://blogs.msdn.com/astebner/archive/2007/02/07/update-regarding-silent-install-of-the-vc-8-0-runtime-vcredist-packages.aspx<br />
<br />
But I want to go one step further if possible (if someone know how to do). I would like to forbid or to warn the user if he try to uninstall the Visual C++ runtime independently from the add / remove panel.<br />
<br />
Is this possible ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">25th March 2008, 18:17</div></div><div class="posttext">That is not really possible, but it's not your problem either if the user uninstall's random runtimes.<br />
<br />
If the registry entry for VC9CRT does not have a comment, I guess you could add one, but that is a bit ugly and selfish<br />
<br />
Or if it's that big of a deal, create a little loader application in VC6 or whatever, that checks for v9 of the CRT and warns/re-installs if needed, then starts your real app. Or maybe switch to MSI, I think it supports stuff like that with it's special shortcuts</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">25th March 2008, 18:26</div></div><div class="posttext">You can bundle the run-time with your application by adding a manifest file to the application folder. Check MSDN for details.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jimpark</div><div class="date">25th March 2008, 19:58</div></div><div class="posttext">Hey Joost, could not find the article on MSDN.  Can you post a link?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">25th March 2008, 20:05</div></div><div class="posttext">http://msdn2.microsoft.com/en-us/library/ew0y5khy(VS.80).aspx maybe<br />
<br />
but this would only work on XP and later no?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">25th March 2008, 21:53</div></div><div class="posttext">See the second part of this page:<br />
<br />
http://msdn2.microsoft.com/en-us/library/ms235291(VS.80).aspx<br />
<br />
Basically you need to install Microsoft.VC80.CRT.manifest along with the run-time files in the same directory as the executable.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nooky59</div><div class="date">25th March 2008, 23:33</div></div><div class="posttext">Originally posted by Joost Verburg <br />
See the second part of this page:<br />
<br />
http://msdn2.microsoft.com/en-us/library/ms235291(VS.80).aspx<br />
<br />
Basically you need to install Microsoft.VC80.CRT.manifest along with the run-time files in the same directory as the executable.  <br />
<br />
Yes, but I don't know if this the same problem for ojt who has initiated the topic but in my particular case, I can't simply put the runtime in the same directory.<br />
<br />
It works with my app, but I use Qt and the jpeg support is compiled as a DLL plugin, and it seems that this jpeg plugin don't find the runtime if it is not installed system-wide.<br />
<br />
So, there is perhaps other cases where a system-wide install of the runtime is needed.<br />
<br />
Thanks for your answers. Yes, perhaps with MSI has I've already seen such messages when trying to removing software parts.<br />
<br />
Else, the launcher could be a good idea, I have thought about that, I will do that if it is necessary to protect against runtime removing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th March 2008, 13:49</div></div><div class="posttext">It works fine with Qt. Just make sure you compile Qt with the same version of Visual C++.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Huette</div><div class="date">30th April 2008, 08:27</div></div><div class="posttext">Hoi!<br />
Does anybody know, if there's a way to determine, wheter VC80 is already installed or not?<br />
<br />
We have to install it via the microsoft redistributable during our updates, because our applications need firebird 2.1 and the gds32.dll (of fb 2.1) needs MS VC80.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd May 2008, 00:05</div></div><div class="posttext">See Koby's explanation on MSVCRT 8.0. You might be able to use the same interfaces to check if the module is already installed.<br />
<br />
http://kobyk.wordpress.com/2008/04/12/deploying-the-visual-c-libraries-with-an-nsis-installer/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Huette</div><div class="date">2nd May 2008, 08:56</div></div><div class="posttext">thanks, kichik. that's a very interesting tutorial.<br />
<br />
you mean i should use the system-plugin to call a api-function, which tells me if i need to install vc8.0?<br />
<br />
i gonna try to find that function...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>