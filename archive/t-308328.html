<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Please help understand nsExec::Exec mystery, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Please help understand nsExec::Exec mystery NSIS Discussion" />
	
	<title> Please help understand nsExec::Exec mystery [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Please help understand nsExec::Exec mystery</div>
<hr />
<div class="pda"><a href="t-308328.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=308328">Please help understand nsExec::Exec mystery</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">14th July 2009, 14:12</div></div><div class="posttext">A baffling problem: The following line runs PERFECTLY in an NSIS script:<br />
nsExec::Exec '&quot;$varCOMSPEC&quot; /C assoc .bat=batfile'<br />
<br />
But when adding redirection, it actually ruins the association:<br />
 nsExec::Exec '&quot;$varCOMSPEC&quot; /C assoc .bat=batfile &gt; nsExecTest.log'<br />
<br />
Any idea why?<br />
<br />
Please note that I am not asking about the 'assoc' internal Windows command (I also know about the alternative File Association (http://nsis.sourceforge.net/File_Association) plugin). I am merely trying to understand why the behavioral change of nsExec::Exec when adding redirection to a log file.<br />
<br />
Thanks.  :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th July 2009, 14:40</div></div><div class="posttext">In what way does it ruin the association?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">14th July 2009, 15:15</div></div><div class="posttext">Originally posted by Afrow UK <br />
In what way does it ruin the association?<br />
<br />
It turns an OK context menu:<br />
http://img190.imageshack.us/img190/6439/assocok.th.png (http://img190.imageshack.us/i/assocok.png/)<br />
To this (incorrect) context menu:<br />
http://img182.imageshack.us/img182/1913/assocbad.th.png (http://img182.imageshack.us/i/assocbad.png/)<br />
<br />
I also compared the registry before and after and the only relevant difference that I was able to spot is:<br />
<br />
OK: <br />
[HKEY_CLASSES_ROOT\.bat]<br />
@=&quot;batfile&quot;<br />
<br />
BAD:  [HKEY_CLASSES_ROOT\.bat]<br />
@=&quot;batfile &quot;<br />
<br />
Apparently the redirection appends a space after &quot;batfile&quot;. Hmmm...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th July 2009, 15:35</div></div><div class="posttext">Try getting rid of the space before the &gt;.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">14th July 2009, 15:42</div></div><div class="posttext">Originally posted by Afrow UK <br />
Try getting rid of the space before the &gt;.<br />
Thank you! That helped.<br />
<br />
It turns out that this problem exists in the command.com prompt (in Windows XP at least) without regard to NSIS.<br />
<br />
The following works: <br />
&quot;%COMSPEC%&quot; /C assoc .bat=batfile&gt; nsExecTest.log<br />
While the following doesn't work:<br />
 &quot;%COMSPEC%&quot; /C assoc .bat=batfile &gt; nsExecTest.log<br />
Is this considered a bug in command.com?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th July 2009, 15:46</div></div><div class="posttext">It's more likely just how assoc.exe parses its command line. Command Prompt will give it everything before the &gt; including the space.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>