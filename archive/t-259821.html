<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstall leave Start Menu shortcuts in Vista, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstall leave Start Menu shortcuts in Vista NSIS Discussion" />
	
	<title> Uninstall leave Start Menu shortcuts in Vista [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstall leave Start Menu shortcuts in Vista</div>
<hr />
<div class="pda"><a href="t-259821.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=259821">Uninstall leave Start Menu shortcuts in Vista</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jvs</div><div class="date">17th November 2006, 22:14</div></div><div class="posttext">When uninstalling a program by double-clicking on uninstall.exe in teh program folder or on the uninstall shortcut in the start menu, ALL the start menu shortcuts for the program are NOT deleted.<br />
<br />
It happens with NSIS 2.21 in Vista RC2 Build 5744<br />
<br />
As an example, you can see it happening with example2.exe from the NSIS examples folder</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">17th November 2006, 22:48</div></div><div class="posttext">This does not happen for me on one of my builds. Also using build 5744.<br />
<br />
However, any exe that is unsigned gets flagged by Vista. Is there a new easy way to sign uninstallers, or would it still be necessary to build them as a separate EXE and bundle them?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">18th November 2006, 08:24</div></div><div class="posttext">Yes, separate bundeling :( makes the build process somehow more cumbersome and not possible on POSIX only systems. I once discussed this in the forum, do not recall where.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th November 2006, 09:38</div></div><div class="posttext">It's not a problem with signing, it's a problem with the manifest. Installers which don't have the RequestExecutionLevel manifest will be executed in compatibility mode. Apparently, one of workaround they have implemented is automatically moving shortcuts from the user's start menu to all user's start menu. Either use SetShellVarContext all or RequestExecutionLevel to get around this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">20th November 2006, 16:24</div></div><div class="posttext">aha, I discovered that I get the following prompt when running the uninstall from the start menu shortcut but not when running it from Add/Remove:<br />
_____<br />
<br />
An unidentified program wants access to your computer<br />
 uninstall.exe<br />
 Unidentified Publisher<br />
_____<br />
<br />
(I would have attached a screenshot but couldn't seem to get one from the Vista full screen prompt)<br />
<br />
The uninstall shortcut lives under C:\ProgramData\Microsoft\Windows\Start Menu\Programs and was created after using 'SetShellVarContext all'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jvs</div><div class="date">21st November 2006, 00:14</div></div><div class="posttext">Sorry, I forgot to mention that the uninstaller worked fine for me when run from Add/Remove programs, it iws &quot;broken&quot; only when I run it from the uninstall shortcut in Start Menu. In my case, I dont see any prompt, the uninstaller just removes everything except the Start Menu program shortcuts and folders. <br />
<br />
If I add the manifest, will then I see the prompt asking to run the uninstaller in elevated mode?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">21st November 2006, 12:17</div></div><div class="posttext">Best practice is NOT to have an uninstall shortcut in the start menu in your future installers. I know it is a common practice but IMHO not a good practice.<br />
<br />
Uninstalling is much better defined if you just instruct users to go to Controlpanel -&gt; ADD n Remove -&gt; Your XYZ application.<br />
<br />
Success<br />
<br />
It is even easier for a helpdesk employee to remember.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">21st November 2006, 12:21</div></div><div class="posttext">Oh, and JVS try to use NSIS v2.21 or higher, this might help. Very old NSIS version had an issue with shortcut removal.<br />
<br />
Do not forget to SEARCH the forum, it might be of good help to you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st November 2006, 18:43</div></div><div class="posttext">Best practice is NOT to have an uninstall shortcut in the start menu in your future installers. I know it is a common practice but IMHO not a good practice.Even MSDN is on your side on this one ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DaCzar</div><div class="date">12th February 2007, 02:07</div></div><div class="posttext">For me uninstall does not work correctly with Vista.<br />
<br />
In Vista Home Premium the uninstall leaves Menu Items (Start | Programs) where they are - even when the uninstall is started from the &quot;control panel add/remove programs&quot;.<br />
<br />
Is there a fix? Or work around available?<br />
<br />
I am using 2.21 of NSIS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">12th February 2007, 09:23</div></div><div class="posttext">Tested MerryGoRound (http://ineum.narod*****mgr_en.htm) (125 kB) on Vista Ultimate Release - uninstall worked correct both from Start menu and Control panel, UAC popups both on install and uninstall. RequestExecutionLevel admin, default context (Current User only). Are your paths-links in the uninstall section correct (like this Delete &quot;$SMPROGRAMS\${APP_NAME}\${APP_LNK}&quot;)? Can you check this using MessageBox?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th February 2007, 18:02</div></div><div class="posttext">DaCzar, see my first response on this thread. Use the latest version of NSIS with RequestExecutionLevel or use SetShellVarContext.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DaCzar</div><div class="date">14th February 2007, 01:24</div></div><div class="posttext">OK <br />
<br />
I am not sure at the moment what RequestExecutionLevel  is but I will see if I can work it out.<br />
<br />
Will report back on how I get on :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DaCzar</div><div class="date">14th February 2007, 01:47</div></div><div class="posttext">Sorry it seems to be beyond my limited understanding of NSIS. :(<br />
<br />
I keeping reading about a manifest, however I cannot find information in the Help file about manifest - what it is, how to access it or change it or even where it is stored. <br />
<br />
I get the feeling that setting the default of  RequestExecutionLevel to none is something that will have to change.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DaCzar</div><div class="date">14th February 2007, 09:42</div></div><div class="posttext">I have added <br />
<br />
RequestExecutionLevel admin<br />
<br />
to the top of my script. Will test it tomorrow to see if it works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th February 2007, 19:44</div></div><div class="posttext">It's not in the documentation because you don't have the latest version of NSIS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DaCzar</div><div class="date">16th February 2007, 01:41</div></div><div class="posttext">I do now ;)<br />
<br />
didn't realise a 2.23 version was out</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ilya31</div><div class="date">16th February 2007, 23:42</div></div><div class="posttext">I have added RequestExecutionLevel admin to my script and all<br />
Menu Items (Start | Programs) are now deleting properly in Vista.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DaCzar</div><div class="date">19th February 2007, 19:44</div></div><div class="posttext">Yes this worked for me also. Hooray! One less problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Daniel McGravey</div><div class="date">13th March 2008, 16:43</div></div><div class="posttext">Can someone help me with this problem?  I'm having the Vista Problem where the uninstaller is not removing the program, folder or shortcuts. <br />
<br />
I think the solution is including the RequestExecutionLevel admin function.<br />
<br />
If someone can private message me with how to contact them (yahoo messenger, aol IM, etc.) or their email address, I can send them the NSI and I'll pay you for your time.<br />
<br />
Thanks</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>