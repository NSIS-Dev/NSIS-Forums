<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" $INSTDIR &gt; InstallDir ?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  $INSTDIR &gt; InstallDir ? NSIS Discussion" />
	
	<title> $INSTDIR &gt; InstallDir ? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  $INSTDIR &gt; InstallDir ?</div>
<hr />
<div class="pda"><a href="t-201537.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=201537">$INSTDIR &gt; InstallDir ?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MysticHead</div><div class="date">8th December 2004, 17:51</div></div><div class="posttext">Hello,<br />
<br />
I've been reading the forums/archive/manual and I haven't been able to find the answer to this question, though search results are often a bit overwhelming so maybe I missed it... sorry if that's the case.<br />
<br />
 Does $INSTDIR take precidence over InstallDir? <br />
<br />
The documentation talks about InstallDir setting the default directory. Does that mean that InstallDir is ONLY used if $INSTDIR is NOT set? <br />
<br />
It seems to work this way, but I wanted to clarify that it was the intent and not simply that my script was written in such a way as to make it look like this was happening.<br />
<br />
I've used VenisIX to get my basic script, and then I've continued to modify it. I'm using .onInit to set the value of $INSTDIR to C:\3rdPartyAppDir\myApp but I just realized that after the funcion end, in &quot;main installer settings&quot;  InstalDir is being set to $PROGRAMFILES\myApp <br />
<br />
As I said everything seems to work fine, but I wanted to make sure it was working correctly:) <br />
<br />
thanks,<br />
<br />
  -marc</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th December 2004, 18:12</div></div><div class="posttext">If you want to overwrite InstallDir, you simply change the value of $INSTDIR. $INSTDIR will initially contain the value set with InstallDir until you change the value using StrCpy.<br />
<br />
E.g.<br />
Function .onInit<br />
 IfFileExists &quot;C:\blah\*.*&quot; 0 +2<br />
  StrCpy $INSTDIR &quot;C:\blah&quot;<br />
FunctionEnd<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MysticHead</div><div class="date">8th December 2004, 22:07</div></div><div class="posttext">I wasn't trying to overwrtie anything. I just noticed that by accident I was using InstallDir AFTER I'd already used StrCpy to set $INSTDIR in my .onInit function. It seemed like the InstallDir line was simply being ignored, and I didn't know if that was by design or by chance. <br />
<br />
--------------------<br />
E.g.<br />
Function .onInit<br />
IfFileExists &quot;C:\blah\*.*&quot; 0 +2<br />
StrCpy $INSTDIR &quot;C:\blah&quot;<br />
FunctionEnd<br />
<br />
Name &quot;mySwellApp&quot; <br />
InstallDir &quot;$PROGRAMFILES\${APPNAMEANDVERSION}&quot;<br />
InstallDirRegKey HKLM &quot;Software\${APPNAMEANDVERSION}&quot; &quot;&quot;<br />
<br />
etc...<br />
-----------<br />
<br />
Really I guess I can just remove this InstallDir line, as it seems to be ignored. Originally I thought that it might be better to leave it in as a default, incase the $INSTDIR value wasn't set properly. I did some further testing and it looks like NSIS already takes care of the case where $INSTDIR == &quot;&quot; and just forces you to browse for a folder.<br />
<br />
I should have given that a shot before posting originally. <br />
<br />
Thanks. <br />
<br />
 -marc</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">9th December 2004, 01:51</div></div><div class="posttext">Installdir is a compile time instruction</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th December 2004, 19:41</div></div><div class="posttext">InstallDir sets the default value. The value of $INSTDIR is set as follows: Value from command line (/D=) If $INSTDIR is invalid, value from InstallDirRegKey If $INSTDIR is invalid, value from InstallDirAfter all these, your script starts to execute, including .onInit. It is free to change $INSTDIR.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MysticHead</div><div class="date">10th December 2004, 16:50</div></div><div class="posttext">OK, thanks. I think I've got it.<br />
<br />
InstallDir is set at compile time (along with InstallDirRegKey) and they will contain the default values of $INSTDIR.<br />
<br />
Once the script is actually run .onInit (or other functions) can freely replace that default value, giving $INSTDIR a new (current) value, basically at run time. <br />
<br />
So is it correct to say that InstallDir sort of breaks out from the idea that each instruction is read/acted on sequentially? Or is it that it's still read in sequence, but portions of the script are read when compiling and other portions are read when running?<br />
<br />
I'm sorry if I'm making this overly complicated. I really do think I understand the answer to my original question, I'm just trying to make sure I've got it straight...not _trying_ to just beat this horse into the ground.<br />
<br />
thanks again,<br />
 <br />
  -marc</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th December 2004, 17:50</div></div><div class="posttext">InstallDir is performed sequentially, but doesn't belong to the same context as the code in .onInit. It's an installer attribute. If your script has two InstallDir lines, only the last one will count.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>