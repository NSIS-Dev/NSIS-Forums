<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Nit: MUI documentation as installed, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Nit: MUI documentation as installed NSIS Discussion" />
	
	<title> Nit: MUI documentation as installed [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Nit: MUI documentation as installed</div>
<hr />
<div class="pda"><a href="t-228297.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228297">Nit: MUI documentation as installed</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">l_d_allan</div><div class="date">12th October 2005, 23:14</div></div><div class="posttext">When the NSIS documentation is installed locally, I'm encountering a script error when clicking on <br />
<br />
2.5 Modern UI<br />
    &lt;&lt;Modern UI Examples&gt;&gt;<br />
<br />
I believe this works on the web, but something was perhaps overlooked in the HtmlHelp workshop (.hhp?)<br />
<br />
Or am I doing something wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">12th October 2005, 23:38</div></div><div class="posttext">I see the same problem. I am guessing that IE places restrictions on what shell open actions can be performed within a CHM file.<br />
IMHO, this link needs to be removed from the documentation if it is going to be problematic.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">l_d_allan</div><div class="date">13th October 2005, 01:25</div></div><div class="posttext">Maybe, but other links work. I've built HtmlHelp .chm files, and the cause is typically something being left out of the .hhp, .hhc, or .hhk file ... if HtmlHelp Workshop or equivalent was used.<br />
<br />
I took a look in CVS for the original (and maybe submit a patch), but didn't find them (may have been looking in all the wrong places.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">13th October 2005, 03:21</div></div><div class="posttext">The other links open files. The one that fails opens a folder.  What is failing is the shell open call with the folder as the parameter.<br />
Nothing was left out from the hhp. The same code is used for both the web as well as the chm help.<br />
IMHO, it would be better if that link actually pointed to:<br />
../Docs/Modern UI/Readme.html#examples.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th October 2005, 12:37</div></div><div class="posttext">What exactly did you do to get this error? It always works for me, even with all security zones set to high level.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">13th October 2005, 13:56</div></div><div class="posttext">Open the NSIS.chm file, go to section 2.5 and click on the &quot;Modern UI Examples&quot; link.<br />
The attached error is seen.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th October 2005, 14:00</div></div><div class="posttext">That works just fine for me. There's also a try-catch block around that code to make sure this kind of messages don't come up. What might have you done differently? What OS do you use? What version of IE?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">13th October 2005, 14:17</div></div><div class="posttext">Windows XP Pro SP2<br />
IE 6.0.2900.2180.xpsp_sp2_gdr.050301-1519<br />
128 bit encryption<br />
I am not quite sure why the error is being thrown. I debugged it using the MS script debugger and the problem is occurring with the ActiveXObject &quot;Shell.Application&quot;.<br />
BTW, there is no try catch block around the area where it is failing.<br />
This is happening in chmlink.js and the problem line is 84:<br />
<br />
<br />
  if (FolderExists(lfn))<br />
  {<br />
    var objShell = new ActiveXObject(&quot;Shell.Application&quot;);<br />
    objShell.Open(lfn);<br />
  }<br />
<br />
<br />
Perhaps you should call TryShellExec instead of directly trying to open the folder?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th October 2005, 14:25</div></div><div class="posttext">I think it didn't work with TryShellExec, but I'm not sure. Want to give it a shot? I still can't reproduce this...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">13th October 2005, 14:35</div></div><div class="posttext">I will give it a shot.<br />
And, oh, BTW, clicking on the same link on the NSIS web site help docs results in a 403 error:<br />
<br />
Forbidden<br />
You don't have permission to access /Examples/Modern UI/ on this server.<br />
<br />
Apache/1.3.33 Server at nsis.sourceforge.net Port 80</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th October 2005, 14:47</div></div><div class="posttext">Thanks, fixed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">13th October 2005, 14:57</div></div><div class="posttext">Well... it kind of works- the folder opens within the CHM browser instead of externally.<br />
Let me investigate further.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">13th October 2005, 15:32</div></div><div class="posttext">After some playing around, I can't get it to work.<br />
I think it may be related to Windows XP SP2 which added more stringent security wrt to scripting.<br />
However, browsing to file:///../Examples/Modern%20UI does work.<br />
I still feel that changing the link to <br />
../Docs/Modern UI/Readme.html#examples would be a better idea, since this would also work on the NSIS web site.<br />
<br />
I see you fixed the web site, so maybe we continue with what we have now, except that you fall back to navigating to the file:/// URL if the shell open fails.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th October 2005, 15:50</div></div><div class="posttext">I have XP SP2, that's not the problem.<br />
<br />
I can live with it falling back to opening the folder in the CHM window.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">l_d_allan</div><div class="date">13th October 2005, 15:58</div></div><div class="posttext">These may be relevant re Local Machine Zone Lockdown:<br />
<br />
http://msdn.microsoft.com/security/productinfo/XPSP2/securebrowsing/locallockdown.aspx<br />
<br />
http://msdn.microsoft.com/security/productinfo/XPSP2/securebrowsing/lockdown_devimp.aspx<br />
<br />
http://weblogs.asp.net/jgalloway/archive/2004/08/20/218123.aspx<br />
<br />
I've wondered if HtmlHelp developers may be prone to encounter this hassle. And whether the end-users would experience problems with WinXp-SP2. <br />
<br />
There are references to &quot;mark of the web&quot; comments that seems to be a work-around.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>