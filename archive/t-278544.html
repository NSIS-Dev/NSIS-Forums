<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" compiling makensis binary on Linux 64-bit OS, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  compiling makensis binary on Linux 64-bit OS NSIS Discussion" />
	
	<title> compiling makensis binary on Linux 64-bit OS [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  compiling makensis binary on Linux 64-bit OS</div>
<hr />
<div class="pda"><a href="t-278544.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=278544">compiling makensis binary on Linux 64-bit OS</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">cyrustransform</div><div class="date">9th October 2007, 22:07</div></div><div class="posttext">I have been attempting to get the makensis binary to compile on a Linux 64-bit (Fedora Core 7) operating system with no success.  I have not found any posts in these forums or any others regarding similar problems so its time to post.  Is it possible to compile the makensis binary on x64 architecture?  If so what am I doing wrong or what do I need to change to make it work?<br />
<br />
# uname -a <br />
Linux buildserver10 2.6.22.9-91.fc7 #1 SMP Thu Sep 27 20:47:39 EDT 2007 x86_64 x86_64 x86_64 GNU/Linux<br />
<br />
# scons --version<br />
SCons by Steven Knight et al.:<br />
script: v0.96.93.D001, 2006/11/06 08:31:54, by knight on roxbury<br />
engine: v0.96.93.D001, 2006/11/06 08:31:54, by knight on roxbury<br />
<br />
# gcc -v<br />
Using built-in specs.<br />
Target: x86_64-redhat-linux<br />
Configured with: ../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-languages=c,c++,objc,obj-c++,java,fortran,ada --enable-java-awt=gtk --disable-dssi --enable-plugin --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-1.5.0.0/jre --enable-libgcj-multifile --enable-java-maintainer-mode --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --with-cpu=generic --host=x86_64-redhat-linux<br />
Thread model: posix<br />
gcc version 4.1.2 20070925 (Red Hat 4.1.2-27)<br />
<br />
# python --version<br />
Python 2.5<br />
<br />
I extracted the file nsis-2.31-src.tar.bz2 to /buildsystem/tools/nsis-2.31-src<br />
<br />
Then executed the following command<br />
# scons SKIPSTUBS=all SKIPPLUGINS=all SKIPUTILS=all SKIPMISC=all NSIS_CONFIG_CONST_DATA_PATH=no PREFIX=/buildsystem/tools/nsis-2.31-src<br />
<br />
I have included the full output from the above command in the scons-output.txt file attached to this topic.  <br />
<br />
The problem I'm running into starts with <br />
/usr/bin/ld: warning: i386 architecture of input file `build/release/makensis/build.o' is incompatible with i386:x86-64 output</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th October 2007, 23:24</div></div><div class="posttext">The incompatible output warnings seem to come from the lack of -m32 in the linkage. That should be automatically added by the configuration, but yours is cached to not use it. Add --cache=force to your scons call line and attach config.log.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cyrustransform</div><div class="date">10th October 2007, 21:54</div></div><div class="posttext">Thank you for the reply.  I used --cache-force.  It still failed.  I deleted my nsis-2.31-src directory, extracted the source download and copied it back over to make sure there wasn't anything left behind that could cause issues.  This is the command I ended up running.    <br />
<br />
# scons SKIPSTUBS=all SKIPPLUGINS=all SKIPUTILS=all SKIPMISC=all NSIS_CONFIG_CONST_DATA_PATH=no  PREFIX=/buildsystem/tools/nsis-2.31-src --cache-force<br />
<br />
Attached is my config.log</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th October 2007, 23:52</div></div><div class="posttext">It's actually --config=force with an equality sign. But cleaning out the entire directory did the same trick. It was not meant to solve the problem, just show it in config.log, and I think it did. ld hits a segfault when testing for -m32. While strictly speaking it should be considered as a gcc bug, I'd guess testing for -m32 in the compiler prior to checking for it in the linker should solve it. In SCons/Config/gnu try replacing lines 88 and 89.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cyrustransform</div><div class="date">11th October 2007, 01:40</div></div><div class="posttext">I get the following output when I use the = instead of the - in --cache=force.  That's why I ended up using --cache-force instead.  I thought it was because you are using a newer version of scons but I upgraded to v0.97.D001 and it still does the same thing.  <br />
<br />
# scons SKIPSTUBS=all SKIPPLUGINS=all SKIPUTILS=all SKIPMISC=all NSIS_CONFIG_CONST_DATA_PATH=no  PREFIX=/buildsystem/tools/nsi<br />
s-2.31-src --cache=force<br />
usage: scons [OPTION] [TARGET] ...<br />
<br />
SCons error: ambiguous option: --cache (--cache-disable, --cache-show, --cache-populate, --cache-debug, --cache-force?)<br />
<br />
<br />
Anyway... Moving on to the good stuff.  As you suggested above, I moved line 88--&gt;89 and 89--&gt;88 in nsis-2.31-src/SCons/Config/gnu and I got the result &quot;scons: done building targets.&quot; I now have the nsis-2.31-src/build/release/makensis/makensis binary.  <br />
<br />
Thank you very much!  PROBLEM SOLVED.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th October 2007, 22:26</div></div><div class="posttext">Weird... Maybe the equality sign is used only on Windows.<br />
<br />
Anyway, I've fixed this for the next version of NSIS. You might also want to report this to gcc. It shouldn't segfault.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>