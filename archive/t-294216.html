<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Call vbscript and get output, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Call vbscript and get output NSIS Discussion" />
	
	<title> Call vbscript and get output [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Call vbscript and get output</div>
<hr />
<div class="pda"><a href="t-294216.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=294216">Call vbscript and get output</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">patelb</div><div class="date">9th July 2008, 19:22</div></div><div class="posttext">I am writing an installer that needs to put some files on the root virtual web folder usually its c:\inetput\wwww but not always.  I have written a vbscript that finds the root folder for me.  What would be the easiest way to get the output from the script into nsis?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">9th July 2008, 19:26</div></div><div class="posttext">I think it would be much easier and more reliable if you detect the location the &quot;root virtual web folder&quot; directly in your NSIS installer. Why do you need VBScript? Also your installer would fail, if the user has disabled the Windows Scripting Host, because your VBScript cannot run. Howevery, if you still want to do it, try like that:<br />
<br />
nsExec:execToLog '&quot;$SYSTEM\CScript.exe&quot; &quot;$INSTDIR\foobar.vbs&quot;'<br />
<br />
Your script will need to write the desired output to the console. nsExec will redirect the console output into the installer where it can be processed...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">patelb</div><div class="date">9th July 2008, 19:31</div></div><div class="posttext">Is there a way of detecting the root web folder from nsis?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">9th July 2008, 19:40</div></div><div class="posttext">Originally posted by patelb <br />
Is there a way of detecting the root web folder from nsis?  <br />
<br />
If there is a way in VBScript, then I think there is one in NSIS too :D<br />
<br />
1. You can read values from the Registry in NSIS easily<br />
2. You can call Win32 API functions by using the NSIS &quot;System&quot; plugin<br />
3. You can create your own custom NSIS Plugin, if needed<br />
<br />
<br />
How do you do it in your VBScript ???? :confused:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">patelb</div><div class="date">9th July 2008, 19:44</div></div><div class="posttext">I took an existing script and condensed it to this:<br />
<br />
strComputer = &quot;.&quot;<br />
Set objWMIService = GetObject _<br />
    (&quot;winmgmts:{authenticationLevel=pktPrivacy}\\&quot; _<br />
        &amp; strComputer &amp; &quot;\root\microsoftiisv2&quot;)<br />
Set colItems = objWMIService.ExecQuery _<br />
    (&quot;Select * from IIsWebVirtualDirSetting&quot;)<br />
For Each objItem in colItems<br />
    Wscript.Echo &quot;Path: &quot; &amp; objItem.Path<br />
    exit for<br />
Next<br />
<br />
The first output is the only thing I care for that is why I am exiting, yes I know its not neat but I just copied and pasted and it works!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">9th July 2008, 19:51</div></div><div class="posttext">I'm not a VBScript coder, so I don't understand that code.<br />
<br />
But I'm pretty sure the Root Dir of the WWW Service is store in the Registry somewhere. In that case you can get it with a single &quot;ReadRegStr&quot; command in NSIS, you only need to find out the proper key. No VBScript would be needed. So this would be the most easy and reliable way. <br />
<br />
<br />
However with your VBScript it should work like:<br />
<br />
SetOutPath $INSTDIR<br />
File &quot;C:\My Scripts\Foobar.vbs&quot;<br />
<br />
nsExec:execToStack '&quot;$SYSTEM\CScript.exe&quot; &quot;$INSTDIR\foobar.vbs&quot;'<br />
Pop $0<br />
<br />
MessageBox MB_OK &quot;Tada: $0&quot;<br />
<br />
<br />
But maybe you must use Cscript.Echo instead of Wscript.Echo ???<br />
<br />
<br />
[EDIT]<br />
<br />
Forget about it. Wscript.Echo works in Cscript.exe as well.<br />
Just tried it :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">patelb</div><div class="date">9th July 2008, 19:54</div></div><div class="posttext">Ok cool thanks for the help!  I know the way im doing it is really sloppy but it is the only way I could think of.  Ill look in the www service being in the registry, but I dont think there is a key for it there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">9th July 2008, 19:58</div></div><div class="posttext">Originally posted by patelb <br />
Ok cool thanks for the help!  I know the way im doing it is really sloppy but it is the only way I could think of.  Ill look in the www service being in the registry, but I dont think there is a key for it there.  <br />
<br />
Where else than in the Registry should the IIS service store it's root dir?<br />
<br />
Somewhere the root dir has to be stored physically...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">patelb</div><div class="date">9th July 2008, 20:02</div></div><div class="posttext">Your right! Its here: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\InetStp\PathWWWRoot<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">9th July 2008, 20:04</div></div><div class="posttext">Originally posted by patelb <br />
Your right! Its here: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\InetStp\PathWWWRoot<br />
<br />
Thanks!  <br />
<br />
Section<br />
  ReadRegStr $0 HKLM &quot;SOFTWARE\Microsoft\InetStp&quot; &quot;PathWWWRoot&quot;<br />
  MessageBox MB_OK &quot;WWW Root: $0&quot;<br />
  MessageBox MB_OK &quot;This information was presented without any invocation of VBScrpt!&quot;<br />
SectionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>