<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" RMDir has no effect, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  RMDir has no effect NSIS Discussion" />
	
	<title> RMDir has no effect [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  RMDir has no effect</div>
<hr />
<div class="pda"><a href="t-207196.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=207196">RMDir has no effect</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">paul.guest</div><div class="date">8th February 2005, 02:27</div></div><div class="posttext">Hi. My installer must create a shortcut to a file that does not yet exist. further more, the directory which eventually contains the file CANNOT exist after the installation. currently i am attempting to achieve this behaviour with the following script:SetOutPath &quot;$INSTDIR\webapps\xxx\WEB-INF&quot;<br />
CreateShortCut &quot;$SMPROGRAMS\XXX Documents\Export or Import Database.lnk&quot; \<br />
  &quot;$INSTDIR\webapps\xxx\WEB-INF\guiexportimport.bat&quot; \ <br />
  &quot;&quot; \<br />
  &quot;$INSTDIR\xxx.ico&quot; 0 SW_SHOWNORMAL<br />
; Remove directory created by SetOutPath<br />
RMDir /r &quot;$INSTDIR\webapps\xxx&quot;problem is the RMDir has no effect and the xxx directory still exists after the installation has completed. (the WEB-INF dir under xxx also exists). does anyone know what i am doing wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">8th February 2005, 03:39</div></div><div class="posttext">Are you saying the shortcut is actually being created?  (that would really surprise me, especially when you say that you must create a shortcut to file that does not exist.)<br />
<br />
Assuming that the target really does exist (and that you have sufficiet rights to the shortcut directory), then as a test, I'd try to insert some &quot;IfErrors&quot; commands after the CreateShortcut and RMDir commands to see if either is returning an error.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">paul.guest</div><div class="date">8th February 2005, 04:02</div></div><div class="posttext">yes, the shortcut was being created, even though the file did not exist (i agree the documentation says it shouldn't have been created).<br />
<br />
i was originally using 2.04 and i have just tested the script (unchanged) with 2.05 and 2.0<br />
2.04 &gt; problem<br />
2.05 &gt; problem<br />
2.0  &gt; no problem<br />
<br />
so the bug was arose due to upgrade from 2.0 to 2.04. is this a regression?<br />
<br />
today was the first time i ran the script but the guy who wrote it was using 2.0 so that explains why it only just appeared.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">paul.guest</div><div class="date">8th February 2005, 04:11</div></div><div class="posttext">bug logged (1118369)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">8th February 2005, 19:03</div></div><div class="posttext">This is not a bug. Windows not allows to delete current folder of applications. Following works on my comp<br />
<br />
SetOutPath &quot;$INSTDIR\webapps\xxx\WEB-INF&quot;<br />
; ...<br />
SetOutPath $INSTDIR<br />
RMDir /r &quot;$INSTDIR\webapps\xxx&quot;<br />
<br />
NSIS approach to &quot;outpath&quot; might be changed in later versions.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>