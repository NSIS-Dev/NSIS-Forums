<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MUI_DIRECTORYPAGE Question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MUI_DIRECTORYPAGE Question NSIS Discussion" />
	
	<title> MUI_DIRECTORYPAGE Question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MUI_DIRECTORYPAGE Question</div>
<hr />
<div class="pda"><a href="t-212506.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=212506">MUI_DIRECTORYPAGE Question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">PatrickFraley</div><div class="date">7th April 2005, 13:20</div></div><div class="posttext">Hi All,<br />
<br />
I have a little odity in the MUI_DIRECTORYPAGE.  The Dialog allows the user to select a folder which is write protected.  this does seem kind of odd,  should it not prevent the selection of writeprotected folders.  the install finishes and acts like everything went ok, but the files did not get installed.  do I have to write a custom function to check for permisions (I would think not, since there is the MUI_DIRECTORYPAGE_VERIFYONLEAVE var, which allows me to do it, but it also says that if not used it will disable the next button if the folder is invalid, what is an invalid folder anyhow?)<br />
<br />
Tia<br />
Patrick</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">7th April 2005, 13:39</div></div><div class="posttext">Is .onVerifyInstDir - callback function what you wanted?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PatrickFraley</div><div class="date">7th April 2005, 14:04</div></div><div class="posttext">actually I had hopped that NSIS would check at least for writepermissions automatically?!?!?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th April 2005, 15:56</div></div><div class="posttext">It seems not.<br />
<br />
To test, this should work:<br />
Function .onVerifyInstDir<br />
ClearErrors<br />
FileOpen $R0 &quot;$INSTDIR\temp.tmp&quot; w<br />
FileWrite $R0 &quot;&quot;<br />
FileClose $R0<br />
IfErrors 0 +3<br />
MessageBox MB_OK|MB_ICONEXCLAMATION &quot;Selected folder is not writable!&quot;<br />
Abort<br />
Delete &quot;$INSTDIR\temp.tmp&quot;<br />
FunctionEnd<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PatrickFraley</div><div class="date">8th April 2005, 08:31</div></div><div class="posttext">Thanks, this seems awfully complicated just to check write permissions.  I will try it and post my experiences :)  Thanks again.<br />
patrick</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PatrickFraley</div><div class="date">8th April 2005, 08:38</div></div><div class="posttext">Ok I tried it and it does not work, I never have write Permissions on the selected folder, since the folder does not yet exist (at least on a new install) ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stb</div><div class="date">8th April 2005, 09:44</div></div><div class="posttext">; add this function<br />
<br />
Function LeaveDirectoryPage<br />
  ClearErrors<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
<br />
  Push $0<br />
  FileOpen $0 &quot;&lt;UNIQUEKEY&gt;.dummy&quot; &quot;w&quot;<br />
  FileWriteByte $0 &quot;0&quot;<br />
  FileClose $0<br />
  Pop $0<br />
  Delete &quot;$INSTDIR\&lt;UNIQUEKEY&gt;.dummy&quot;<br />
  IfErrors 0 finish<br />
  MessageBox MB_OK|MB_ICONSTOP &quot;not writable&quot; <br />
  Abort<br />
finish:<br />
FunctionEnd<br />
<br />
<br />
; IMPORTANT: replace &lt;UNIQUEKEY&gt; with some unique key (GUID ist good)!<br />
<br />
<br />
; insert !define MUI_PAGE_CUSTOMFUNCTION_LEAVE LeaveDirectoryPage<br />
; before !insertmacro MUI_PAGE_DIRECTORY<br />
<br />
<br />
.onVerifyInstDir is not best here as that would (try) create directories before the user really wants to. Therefore I use the solution above.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PatrickFraley</div><div class="date">8th April 2005, 09:57</div></div><div class="posttext">thanks stb,<br />
<br />
this one seems to be working :)<br />
<br />
patrick</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>