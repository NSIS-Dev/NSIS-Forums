<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Integrated .Net Framework, not download it, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Integrated .Net Framework, not download it NSIS Discussion" />
	
	<title> Integrated .Net Framework, not download it [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Integrated .Net Framework, not download it</div>
<hr />
<div class="pda"><a href="t-301688.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=301688">Integrated .Net Framework, not download it</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">typingcat</div><div class="date">4th January 2009, 12:57</div></div><div class="posttext">Hello. I'm a new user of NSIS. I have created a simple application that uses WinPCap in C#. So, my application requires both .NET Framework and WinPCap installed. Other than that my application doesn't need any special setup, no sytem file change, no registry entry, no anything.<br />
<br />
I've searched Google for this, but all the search results were about downloading the .NET Framework from Microsoft's web site then installing. For I'm going to distribute my application in a CD, I want the .Net Framework integrated inside the setup file in order to save user's downloading time.<br />
<br />
I need to know how to integrate the .NET Framework into the setup file, but not copy it to the Program files folder. I tried to do it myself, but the .Net Framework setup file was also copied to the Program Files folder.<br />
<br />
If you have some free time, would you give me a simple code that does:<br />
1. Integrate the .NET Framework setup file into my setup file.<br />
2. Execute the .NET Framework setup quitely before installing (I already know how to check if .NET is installed so you may skip the code to check if it is installed or not)<br />
3. Not copy the .NET Framework setup file to the Program Files folder.<br />
<br />
If you teach me the code above, I think I myself can then apply the code to do the same thing for WinPCap. Thank you for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">4th January 2009, 17:19</div></div><div class="posttext">1. Integrate the .NET Framework setup file into my setup file.<br />
<br />
Use NSIS' File instruction to add the executable into the installfer.<br />
<br />
2. Execute the .NET Framework setup quitely before installing (I already know how to check if .NET is installed so you may skip the code to check if it is installed or not)<br />
<br />
You need to know which are the params of the .net installer to do  it quitely...According to this site (http://sojoe*******2006/11/01/silent-install-of-ms-net-framework-version-2/), you need to pass something like /q:a /c:&quot;install.exe /q&quot;...use this with NSIS' instructions Exec, ExecWait or ExecShell.<br />
<br />
3. Not copy the .NET Framework setup file to the Program Files folder.<br />
<br />
Ok, you can use $PLUGISDIR to output the .net installer, at the end of the nsis installer, $PLUGINSDIR is deleted.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbguy</div><div class="date">4th January 2009, 22:22</div></div><div class="posttext">Do NOT include the .NET Framework as an installer file. Who wants to wait a minute and a half while your installer decompresses a pre-compressed .NET installer?<br />
<br />
It's insanity.<br />
<br />
What you should do is add the .NET installer to the CD in the same path as your installer. Then use $EXEPATH to find it and execute it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">4th January 2009, 23:47</div></div><div class="posttext">Yes if you are using a CD, just put it in a sub-folder and execute it with ExecWait:<br />
<br />
ExecWait `&quot;$EXEDIR\DotNET\setup.exe&quot; /q:a /c:&quot;install.exe /q&quot;` $R0<br />
<br />
Notice the use of double quotes. Also note the $R0 on the end... that will receive the exit code of the setup (0 on success, if anything else you could show a message box).<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>