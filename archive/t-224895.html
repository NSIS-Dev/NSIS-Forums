<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" UnInstallLib doesn't work as expected, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  UnInstallLib doesn't work as expected NSIS Discussion" />
	
	<title> UnInstallLib doesn't work as expected [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  UnInstallLib doesn't work as expected</div>
<hr />
<div class="pda"><a href="t-224895.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=224895">UnInstallLib doesn't work as expected</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">SyRenity</div><div class="date">31st August 2005, 01:05</div></div><div class="posttext">Hi.<br />
<br />
I'm trying to show the user a warning to close the opened software, while uninstalling the DDLs that it uses. Now, as the manual says regarding the UnInstallLib, the NOREBOOT_PROTECTED should warn the user if the libraries are in use:<br />
&quot;Warns the user when the library is in use. The user will have to close applications using the library.&quot;<br />
<br />
Below a snippet of my code that tries to uninstall the libraries:<br />
<br />
!insertmacro UnInstallLib REGDLL NOTSHARED NOREBOOT_PROTECTED &quot;$INSTDIR\BarLcher.dll&quot;<br />
!insertmacro UnInstallLib REGDLL NOTSHARED NOREBOOT_PROTECTED &quot;$INSTDIR\CompBar.dll&quot;<br />
<br />
<br />
For some reason, the uninstallation simply continues until it's completed, leaving the libraries in use intact. Is this functionality is not completed yet? If yes, how then the software can be dectected, so the user could be warned?<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SyRenity</div><div class="date">5th September 2005, 12:29</div></div><div class="posttext">Hi.<br />
<br />
Perhaps the developers of the Library.nsh will know the answer? How one can be contacted?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">5th September 2005, 14:33</div></div><div class="posttext">This is indeed an error, currently only the error flag is set when the file cannot be deleted.<br />
<br />
I'll try to find a solution.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>