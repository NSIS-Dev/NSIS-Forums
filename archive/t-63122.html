<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Small problem with WriteRegStr, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Small problem with WriteRegStr NSIS Discussion" />
	
	<title> Small problem with WriteRegStr [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Small problem with WriteRegStr</div>
<hr />
<div class="pda"><a href="t-63122.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=63122">Small problem with WriteRegStr</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">sixty4bit</div><div class="date">19th October 2001, 22:26</div></div><div class="posttext">This is definately an upgrade that needs to happen.  Currently, when writing to the registry, the script is only allowed to write DWORD or Strings.  There are about 5 different datatypes that are allowed to be written (REG_SZ[default], REG_BINARY, REG_DWORD, REG_MULTI_SZ and REG_EXPAND_SZ) you can get more information on these guys here:<br />
<br />
http://msdn.microsoft.com/library/default.asp?url=/library/en-us/regentry/DataTypes.asp <br />
<br />
The REG_EXPAND_SZ is needed when writing to the path environment variable or any other environment variable that has a variable in the value (%SYSTEMROOT%).  It would be very valuable to be able to specify the data type for writing to the registry.<br />
DWORD, REG_SZ and BINARY are all covered, EXPAND is definately needed.<br />
<br />
I really enjoy this product, I will do this in perl for now, but it would be great to have this in the product so that I don't have to maintain the perl script also.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Schultz</div><div class="date">20th October 2001, 01:12</div></div><div class="posttext">in version 1.59 this is posible i belive. just have to add 1 more string to your script.. <br />
ReadEnvStr $1 SYSTEMROOT<br />
and then use $1 instead of %SYSTEMROOT% when writing to the registry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sixty4bit</div><div class="date">20th October 2001, 03:20</div></div><div class="posttext">The aim here wasn't to get the value of %SYSTEMROOT%.  I need to be able to specify the data type for the registry value.  Specifically, need to be able to specify REG_EXPAND_SZ so that when %SYSTEMROOT% is used in a registry string, it will be parsed as whatever the system sees as the root of the system.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Schultz</div><div class="date">20th October 2001, 05:17</div></div><div class="posttext">ok sorry for my ignorance i understand what you are trying to do now.<br />
<br />
Edit:<br />
 I kinda looked into what you are asking. Not sure if this would go mainstream into NSIS because i can't find out if Win9x supports this or not.. everywhere i have read it only says Windows NT.. But if you want based off NSIS 1.59 i added this feature into it. you can use it via WriteRegExpand <br />
same variables as WriteRegStr. you can get the exe at <br />
http://www.edensrising.com/nsis/makensis.rar the sources are also there if you would perfer to compile it yourself. btw it is rar'ed because webserver treats exe's as cgi executables..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sixty4bit</div><div class="date">21st October 2001, 16:54</div></div><div class="posttext">Shultz,<br />
<br />
This is awesome!  I have a question about the OSVERSIONINFO, do Win2K and WinXP both return WINNT also?  I am just concerned about compatability across all Win types.  Thanks for this!  It is a great help!<br />
<br />
Did you submit this as a diff to Justin?  I am sure he would include it if you made it easy for him to include.<br />
<br />
Thanks again,<br />
<br />
Sixty4Bit</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Schultz</div><div class="date">21st October 2001, 23:00</div></div><div class="posttext">i had my friend test it under WinXp and he said it returned the WinNT string so it should detect WinXP as WinNT.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>