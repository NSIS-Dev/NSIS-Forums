<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Global variables scope when !define is used, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Global variables scope when !define is used NSIS Discussion" />
	
	<title> Global variables scope when !define is used [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Global variables scope when !define is used</div>
<hr />
<div class="pda"><a href="t-110370.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=110370">Global variables scope when !define is used</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">neomaniakov</div><div class="date">18th October 2002, 13:13</div></div><div class="posttext">Hi all<br />
<br />
I try to use Gloval variables with !define statement<br />
when i receive values from extended DLL. I dont wanted to call<br />
DLL twice or 5 time when i need some global value<br />
<br />
When i use <br />
CODE:--------------------------------------------<br />
pluginDllName::Fill_S0<br />
Pop $0<br />
!define GLOBAL1 $0<br />
CODE:END -------------------------------------------- <br />
<br />
if after that on some place in NSIS script <br />
CODE:--------------------------------------------<br />
StrCpy $0 &quot;test2&quot;<br />
CODE:END -------------------------------------------- <br />
${GLOBAL1} value changes to &quot;test2&quot; too ?!?!? ...<br />
I thought that statement &quot;!define GLOBAL1 $0&quot;<br />
can be used for init ${GLOBAL1} with value of $0<br />
not to Link with $0<br />
What I suppose to do if I want to keep variable GLOBAL1<br />
with global scope not to change when $0 changes ?<br />
Some kind of:<br />
CODE:--------------------------------------------<br />
pluginDllName::Fill_S0<br />
Pop $0<br />
!define GLOBAL1  <br />
StrCpy ${GLOBAL1} $0<br />
CODE:END -------------------------------------------- <br />
<br />
But in this case I receive Error when compile:<br />
ERR: ---------------------------------------<br />
StrCpy expects 2-2 parameters, got 1.<br />
Usage: StrCpy $(user_var: output) str [maxlen] [startoffset]<br />
ERR:END ---------------------------------------</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th October 2002, 13:40</div></div><div class="posttext">!define is a compile time command. It defines a symbol as a certain string at compile time, not runtime. If you define GLOBAL as $0 everytime the compiler will encouter ${GLOBAL} it will replce it with the string $0, which later, at runtime, will be translated to whatever value it holds.<br />
<br />
You can't create more variables than what you already have in NSIS ($0...$9, $R0...$R9). Those variables are already global, you can use them everywhere in the script, and they will maintain the same value all over it.<br />
<br />
If you want to keep a certain value in some variable you will have to reserve a variable from the existing variables for it. $R8 for example.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">neomaniakov</div><div class="date">18th October 2002, 14:09</div></div><div class="posttext">10ks kichik,<br />
<br />
it helps me a lot, I'll fix my scripts</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vtsaran</div><div class="date">13th June 2003, 19:24</div></div><div class="posttext">Sorry. Do you mean to say that all variables in NSIS scripting language are global? If I used $R1 in function1, the $R1 in function2 will overwrite the first one? O gee, I hope this is not the case.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lilla</div><div class="date">13th June 2003, 21:14</div></div><div class="posttext">I am doing something similar and it is working fine so far.<br />
I had problems until I finally figured out that the variable I used <br />
($0) could not be used by any function, or else it would be overwritten. I need to test on WIN_VER in several different sections<br />
and I didn't want to use $0, I wanted a meaningful name, like WIN_VER.<br />
<br />
The way I see it now, it's like ${WIN_VER} is a friendly name for $0.<br />
I'm new to NSIS, so if this is not a good way, please advise.<br />
<br />
Call GetWindowsVersion<br />
Pop $0 ; at this point $0 is &quot;NT 4.0&quot; or whatnot<br />
!define WIN_VER $0 ; create a global variable<br />
; MessageBox MB_OK &quot;GetWindowsVersion ${WIN_VER}&quot;<br />
StrCmp ${WIN_VER} '98' ContinueAsk<br />
StrCmp ${WIN_VER} '98 SE' Continue2<br />
StrCmp ${WIN_VER} 'XP' Continue2<br />
<br />
; Usage:<br />
;   Call GetWindowsVersion<br />
;   Pop $R0    ; at this point $R0 is &quot;NT 4.0&quot; or whatnot<br />
Function GetWindowsVersion<br />
  Push $R0<br />
  Push $R1<br />
... snip...<br />
<br />
Lilla</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th June 2003, 21:19</div></div><div class="posttext">That's right. ${WINVER} will be replaced by $0. Maybe you'd better use a variable that is not so common, like $9.<br />
<br />
Support for real user variables ($USER) will be added very soon (it's already in the development snapshot, but not enabled by default).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">13th June 2003, 22:50</div></div><div class="posttext">Originally posted by vtsaran <br />
Sorry. Do you mean to say that all variables in NSIS scripting language are global? If I used $R1 in function1, the $R1 in function2 will overwrite the first one? O gee, I hope this is not the case.  <br />
<br />
Yep that's how it works, like a set of registers you can manipulate.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>