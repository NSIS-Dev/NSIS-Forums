<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" DotNetVer.nsh - another way of checking MS.Net version, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  DotNetVer.nsh - another way of checking MS.Net version NSIS Discussion" />
	
	<title> DotNetVer.nsh - another way of checking MS.Net version [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  DotNetVer.nsh - another way of checking MS.Net version</div>
<hr />
<div class="pda"><a href="t-324928.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=324928">DotNetVer.nsh - another way of checking MS.Net version</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dgrinberg</div><div class="date">16th December 2010, 03:23</div></div><div class="posttext">Hi all,<br />
<br />
I know that there are a couple of methods in the wiki for determining the existence and version of Microsoft.Net, but not one of them covered everything I needed and I found them a little messy.<br />
<br />
I have created a header file, for purely determining the existence and version of dotNet.  I liked the cleanliness of the WinVer header, and decided to base DotNetVer off that.<br />
Thanks to a little help from the community, it checks for DotNet 1.0 to 4.0, their service packs and types of installation.<br />
<br />
Thus DotNetVer.nsh is a LogicLib extension for checking Microsoft .NET Framework versions and service packs.<br />
<br />
 &quot;HasDotNet&lt;version&gt;&quot; checks if the specific version of .NET framework is installed.<br />
<br />
 &lt;version&gt; can be replaced with the following values:<br />
<br />
   1.0<br />
   1.1<br />
   2.0<br />
   3.0<br />
   3.5<br />
   4.0<br />
<br />
 &quot;AtLeastDotNetServicePack&quot; checks if the .NET framework has a service pack version at least as specified.<br />
 &quot;IsDotNetServicePack&quot; checks if the .NET framework has a service pack version exactly as specified.<br />
 &quot;HasDotNetClientProfile&quot; checks if the .NET framework is a client profiled install.<br />
 &quot;HasDotNetFullProfile&quot; checks if the .NET framework is a full install.<br />
<br />
<br />
 Usage examples:<br />
<br />
 ${If} ${HasDotNet4.0}<br />
    DetailPrint &quot;Microsoft .NET Framework 4.0 installed.&quot;<br />
    ${If} ${DOTNETVER_4_0} AtLeastDotNetServicePack 1<br />
        DetailPrint &quot;Microsoft .NET Framework 4.0 is at least SP1.&quot;<br />
    ${Else}<br />
        DetailPrint &quot;Microsoft .NET Framework 4.0 SP1 not installed.&quot;<br />
    ${EndIf}<br />
    ${If} ${DOTNETVER_4_0} HasDotNetClientProfile 1<br />
        DetailPrint &quot;Microsoft .NET Framework 4.0 (Client Profile) available.&quot;<br />
    ${EndIf}<br />
    ${If} ${DOTNETVER_4_0} HasDotNetFullProfile 1<br />
        DetailPrint &quot;Microsoft .NET Framework 4.0 (Full Profile) available.&quot;<br />
    ${EndIf}<br />
    ${If} ${DOTNETVER_4_0} HasDotNetFullProfile 0<br />
        DetailPrint &quot;Microsoft .NET Framework 4.0 (Full Profile) not available.&quot;<br />
    ${EndIf}<br />
 ${EndIf}<br />
 <br />
 <br />
 Code: Download from GITHUB https://github.com/dgrinberg/NSIS_headers<br />
 Hompage:  http://ontheperiphery.veraida.com/<br />
 <br />
 <br />
Please feel free to use and modify as you see fit.  If you find any issues, let me know and I will have a look - alternatively you can fork it on GITHUB and then push any changes back to me.<br />
<br />
Thanks all<br />
<br />
David Grinberg</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th December 2010, 19:19</div></div><div class="posttext">Nice work. It would be helpful if you could upload to the NSIS Wiki.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">16th December 2010, 21:01</div></div><div class="posttext">Thanks for the work, I'm sure lots of people will be helped by this. I didn't look in detail at your macro, but I'd suggest to use the same format for the ${Has} defines and the more elaborate ${VER} defines. So if you have ${HasDotNet4.0}, it may be better if you'd use ${DotNetVer4.0} instead of ${DOTNETVER_4_0}.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tossnet</div><div class="date">8th May 2011, 13:50</div></div><div class="posttext">nice job !<br />
If framework (4) was not install<br />
Have you the code to download it and install it ?<br />
thanks</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>