<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" InstallTypes question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  InstallTypes question NSIS Discussion" />
	
	<title> InstallTypes question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  InstallTypes question</div>
<hr />
<div class="pda"><a href="t-221603.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221603">InstallTypes question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">16th July 2005, 09:54</div></div><div class="posttext">i kinda asked this question before but the result wasn't satisfying, now i thought of another way of solving my problem.<br />
<br />
i'd like to have a dynamic installtype (autodetection of some settings), now i was wondering if it's possible to do so in a leave function.<br />
<br />
however, the attached script doesn't work, maybe someone can help here.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th July 2005, 12:21</div></div><div class="posttext">This could be your problem:<br />
<br />
StrCmp $0 &quot;Automatic&quot; 0 +3<br />
!insertmacro SelectSection &quot;1&quot;<br />
Abort<br />
<br />
If you look in the SelectSection macro it contains more than one line of code, hence the +3 jump won't work. You need to use a label.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">16th July 2005, 12:47</div></div><div class="posttext">doesn't work, when i select the installtype &quot;automatic&quot; nothing happens</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th July 2005, 16:15</div></div><div class="posttext">I'm not sure exactly what you're trying to do, but InstTypeGetText 0 $0 is wrong because it should be InstTypeGetText 1 $0.<br />
<br />
Also which section are you trying to select?<br />
If it's the first one, then you want to SelectSection 0 not 1.<br />
<br />
And finally, you will not notice a difference because all sections are already selected (if the two above problems are fixed).<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">16th July 2005, 18:18</div></div><div class="posttext">what i'm trying to do: i have an installer with a couple of static sections and i'd like to have a detection feature. right now i'm using a detection-feature, but the sections don't get saved. so when the user selects another installtype, the selection is gone.<br />
<br />
the new idea was to call my detection-function in a leave function instead of doing that before the components page gets displayed. i'm not sure if it's possible, but i guess it is. i'm just a bit unexperienced with show/leave functions. not sure about the difference and the correct syntax.<br />
<br />
so what i'm trying to do: user selects installtype &quot;automatic&quot; and the function detects which of my sections will be selected.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th July 2005, 19:07</div></div><div class="posttext">What do you need the detection feature for?<br />
The only way to check if sections are selected is by using the SectionFlagIsSet macro (or SectionIsSelected with LogicLib).<br />
<br />
!include Sections.nsh<br />
...<br />
Section &quot;A section&quot; SecID<br />
<br />
!insertmacro SectionFlagIsSet ${SecID} ${SF_SELECTED} JUMPIFSET JUMPIFNOTSET<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">16th July 2005, 19:31</div></div><div class="posttext">the detection feature basically checks which features of the installer were installed. so my function uses UnselectSection to disable existing components. the current version displays a messagebox before the components page shows up, but many people don't read messageboxes anyway.. and as i said before it would be nice to jump back to that detected selection (through the installtype).<br />
<br />
the problem right now is that the code above does absolutely nothing, when i choose &quot;automatic&quot; as insttype. if i get this dummy-script to work, i can easily use my existing function with it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">18th July 2005, 13:59</div></div><div class="posttext">You can use SectionSetInstTypes. And set for all sections a necessary accessory to &quot;Automatic&quot; type. So installer will not &quot;forget&quot; a set of sections at change of InstallType.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">19th July 2005, 16:11</div></div><div class="posttext">anyone aware of an example with that command. reading the docs didn't help me understanding what exactly it does.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">19th July 2005, 16:21</div></div><div class="posttext">For example. There are 3 sections (S1,S2,S3) and 2 InstType (Full, Minimal).<br />
<br />
SectionSetInstTypes ${S1} 3<br />
SectionSetInstTypes ${S2} 1<br />
SectionSetInstTypes ${S3} 1<br />
<br />
Now Full install type contain all sections, Minimal - only first (S1).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">19th July 2005, 18:20</div></div><div class="posttext">Or next example. Check which features of the installer were installed. If component (section) was installed and you didn't want install it again - use for this section &quot;SectionSetInstTypes sec_id 1&quot; (if there are only 2 insttypes - All, Automatic).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">22nd July 2005, 18:35</div></div><div class="posttext">this isn't exactly a good option for me, it makes my necessarily complicated - that is, if it can't be done in the way i previously proposed (but didn't get to work).<br />
<br />
can anybody tell me, if there's a way to make it work the way i suggested?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">25th July 2005, 11:32</div></div><div class="posttext">Probably it will be most easier to write function which set necessary components for Automatic type. And in function .onSelChange call it if this type has been chosen. But i think use of the SectionSetInstTypes not such complicated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">25th July 2005, 23:27</div></div><div class="posttext">(in my previous post there was an &quot;un-&quot; for unnecessarily missing)<br />
<br />
the following problem appears when using SectionSetInstTypes:<br />
<br />
when the installer is launched everything is fine. when i select the &quot;onInit&quot; installtype, the correct sections are being shown. now, when i switch back to the installtype &quot;all&quot;, the sections selected by SectionSetInstTypes are not selected anymore.<br />
OutFile DynSection.exe<br />
<br />
InstType &quot;All&quot;<br />
InstType &quot;Second only&quot;<br />
InstType &quot;onInit&quot;<br />
<br />
Page Components<br />
Page InstFiles<br />
<br />
Section &quot;1&quot; First<br />
SectionIn 1<br />
DetailPrint &quot;Section 1 was selected&quot;<br />
SectionEnd<br />
<br />
Section &quot;2&quot; Second<br />
SectionIn 1 2<br />
DetailPrint &quot;Section 2 was selected&quot;<br />
SectionEnd<br />
<br />
Section &quot;3&quot; Third<br />
SectionIn 1<br />
DetailPrint &quot;Section 3 was selected&quot;<br />
SectionEnd<br />
<br />
Section &quot;4&quot; Fourth<br />
SectionIn 1<br />
DetailPrint &quot;Section 3 was selected&quot;<br />
SectionEnd<br />
<br />
Function .onInit<br />
SectionSetInstTypes ${Third} &quot;4&quot;<br />
SectionSetInstTypes ${Fourth} &quot;4&quot;<br />
FunctionEnd<br />
is this a bug or a feature (if so, what is its purpose)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">26th July 2005, 13:27</div></div><div class="posttext">That is because SectionSetInstTypes sets the install types for section with bits. For your install types max value may be 7 = 0111 (bitwise) - section is in all install types. Value 5 =  0101 (bitwise) - section is in &quot;All&quot; and &quot;onInit&quot; types. So value 4 indicate that section is only in &quot;onInit&quot; type (0100 bit).<br />
This script works correctly (but i think not as it is necessary for you:D). Try to use SectionSetInstTypes ${Third} &quot;5&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">27th July 2005, 00:30</div></div><div class="posttext">understanding it now, maybe the documentation should at least give 2 examples for better comprehension. thanks glory_man!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>