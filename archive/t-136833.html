<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" unload dll from memory, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  unload dll from memory NSIS Discussion" />
	
	<title> unload dll from memory [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  unload dll from memory</div>
<hr />
<div class="pda"><a href="t-136833.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=136833">unload dll from memory</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">27th May 2003, 22:03</div></div><div class="posttext">Hi<br />
<br />
2nd problem<br />
<br />
i have a dll here which is not a registered dll - any attempts to do so failed<br />
<br />
this dll is somewhere - not any system folder.<br />
i made effort to replace it with the UnloadDLL script - the reboot option is offered.<br />
<br />
but when i try to delete this dll inc the folder i made no effort<br />
<br />
rmdir /rebootok does not work till now (2b3) - tried several solutions from this forum.<br />
<br />
UnRegDLL &lt;dll&gt; does not work either<br />
<br />
i can delete it with the wininit.ini (OS=XP) but the folder is not deleted yet.<br />
<br />
any hints?<br />
<br />
THX</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">27th May 2003, 22:08</div></div><div class="posttext">Does it work if you put RMDir /REBOOTOK after UpgradeDLL?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">27th May 2003, 22:24</div></div><div class="posttext">Hi Joost<br />
<br />
rmdir /rebootok causes error - must be rmdir /r :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th May 2003, 13:04</div></div><div class="posttext">To delete a file after reboot you should use Delete /REBOOTOK not RMDir /REBOOTOK. Use Delete /REBOOTOK on the file first and then RMDir /REBOOTOK on the folder containing the file, it should execute in the order you specify it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">28th May 2003, 15:46</div></div><div class="posttext">you are talking about the cvs?<br />
cvs causes errors during compilation on my script while 2b3 does not</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th May 2003, 15:50</div></div><div class="posttext">RMDir /REBOOTOK is the only thing that depends on the latest CVS version, other things apply to b3 too.<br />
<br />
What errors do you get when you get the latest CVS version? If it's MUI errors then you should probably read the MUI readme again, define names and other things have changed. If not, attach the output of makensis.exe here and I'll have a look.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">28th May 2003, 21:51</div></div><div class="posttext">2b3<br />
!insertmacro MUI_SECTIONS_FINISHHEADER<br />
<br />
cvs<br />
!insertmacro: MUI_SECTIONS_FINISHHEADER<br />
!insertmacro: macro named &quot;MUI_SECTIONS_FINISHHEADER&quot; not found!<br />
Error in script &quot;setup.nsi&quot; on line 182 -- aborting creation process<br />
<br />
i did not found any documentation :( or i have the wrong docs</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th May 2003, 21:53</div></div><div class="posttext">The documentation is in ${NSISDIR}\Contrib\Modern UI<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">28th May 2003, 22:04</div></div><div class="posttext">readme.htm<br />
Old Section &quot;7. Insert the MUI_SECTIONS_FINISHHEADER macro&quot; <br />
is missing<br />
<br />
:hang:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th May 2003, 09:50</div></div><div class="posttext">That's because you don't need MUI_SECTIONS_FINISHHEADER any more :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">29th May 2003, 15:14</div></div><div class="posttext">@kichik<br />
<br />
thank you very much - i deleted it and put the new strings from MUI into.<br />
<br />
it is always strange to use something and then someones tells me i dont need it any longer ;)<br />
<br />
BTW the history file told me about nsis 2b4 - is this the cvs (loaded on 27th of mai) ?<br />
<br />
from my other posting - it went wrong there.<br />
<br />
~~~8&lt;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br />
<br />
i have a solution to my problem<br />
; Usage:<br />
;  push dirname\dllname<br />
;  call exchange<br />
<br />
Function exchange<br />
  Exch $R1<br />
  Push $R2<br />
  Push $R3<br />
  Push $R4<br />
  ; $R1=oldname<br />
  ; $R2=newname<br />
  ; $R3=counter<br />
  StrCpy $R3 0<br />
  <br />
  ;check first if deletable<br />
  Delete $R1<br />
  IfFileExists $R1 0 copy<br />
<br />
  loop:<br />
    StrCpy $R2 $R1.$R3.tmp<br />
    IfFileExists $R2 0 done<br />
    IntOp $R3 $R3 + 1<br />
    Goto loop<br />
<br />
  done:<br />
  Rename $R1 $R2<br />
  <br />
  copy:<br />
  ;file was found and renamed<br />
  File &quot;yourdll.dll&quot;<br />
  ;delete old TMP-files on next boot<br />
  Delete /REBOOTOK &quot;$INSTDIR\*.tmp&quot;<br />
<br />
  Pop $R3<br />
  Pop $R2<br />
  Pop $R1<br />
FunctionEnd<br />
<br />
<br />
another installer gave me that hint to rename that file, copy new file and delete old one on reboot.<br />
i dont need the other script (UpgradeDLL.nsh]any longer :)<br />
<br />
Now it is a fine peace of work i finshed a couple of minutes ago WITH your help<br />
<br />
PS the function isnt perfect at all but it takes someone only a minute to make it 100% variable<br />
<br />
PPS some explanation:<br />
the file that has to be replaced will be renamed to &lt;oldname.ext.counter.tmp&gt;<br />
counter goes up from &quot;0&quot; to anywhere but it is quite impossible that someone has done this a million times<br />
before renaming it is controlled if that file is not there otherwise counter=counter+1 and loop<br />
TMP-files are deleted on reboot<br />
<br />
~~~8&lt;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>