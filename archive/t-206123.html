<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Why Does RegDLL Uses Short Filenames, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Why Does RegDLL Uses Short Filenames NSIS Discussion" />
	
	<title> Why Does RegDLL Uses Short Filenames [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Why Does RegDLL Uses Short Filenames</div>
<hr />
<div class="pda"><a href="t-206123.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=206123">Why Does RegDLL Uses Short Filenames</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">JoeAcunzo</div><div class="date">27th January 2005, 19:59</div></div><div class="posttext">I've determined that RegDLL translates long filenames into short names before actually registering the DLL.  For example, &quot;LongName.ocx&quot; gets registered (in the Registry) as &quot;LongNa~1.ocx&quot;.<br />
<br />
Can RegDLL be forced to use the long name?<br />
<br />
This use of short names is causing a problem when I run my patch installer that patches, for example, LongName.ocx.  Using my patch procedure, the short name becomes &quot;LongNa~2.ocx&quot;, which of course is not registered (&quot;~1&quot; is registered from the original install, not &quot;~2&quot;).<br />
<br />
This change in short name happens because I patch into a temporary name of &quot;LongName.ocx~patched&quot;, and if all files are patched without error, I then delete the original &quot;LongName.ocx&quot; and rename the patched version &quot;LongName.ocx~patched&quot; to the correct name of &quot;LongName.ocx&quot;.  My goal is to leave the original in place as long as possible.<br />
<br />
Joe A.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th January 2005, 20:08</div></div><div class="posttext">RegDLL itself doesn't use short file names. When using /REBOOTOK on Windows 9x, the file names are translated to short file names if the action is done after reboot because of a limitation of Windows 9x.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JoeAcunzo</div><div class="date">27th January 2005, 20:55</div></div><div class="posttext">This is happening on Windows XP, and in a situation that does not require a reboot to get the file installed.  It is on the very first install that the short name is used in the registry (NOT in the directory for the filename as that maintains the long name, it's using the short name just in the registry). What else could impact this?  Here's the code I'm using, pretty simple:<br />
<br />
[code]<br />
; Must set to here to find dependent DLLs for the .ocx.<br />
SetOutPath &quot;$INSTDIR\${BIN}&quot;<br />
ClearErrors<br />
RegDLL &quot;$INSTDIR\${BIN}\BCGTimeIntervals.ocx&quot;<br />
[code]<br />
<br />
Thanks,<br />
Joe A.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th January 2005, 21:02</div></div><div class="posttext">Well, if the RegDLL itself triggers the registry value creation, then it's the the OCX itself that is writing that short file name. Nothing is written to the registry by NSIS when you use the RegDLL command.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JoeAcunzo</div><div class="date">28th January 2005, 00:24</div></div><div class="posttext">kichik, your absolutely right (as usual) about this not being a RegDLL issue.  I just unregistered the OCX and used regsvr32 to register it, and I get the same thing -- it gets registered with the short name.  I then stepped through the registration code (it's using MFC), and I don't see how that's happening, unless some Windows API is doing it during registration (doubtful), but it is NOT an NSIS issue.  Thanks again for your help, it's much appreciated.<br />
<br />
Joe A.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>