<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" WinVer.nsh - having a problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  WinVer.nsh - having a problem NSIS Discussion" />
	
	<title> WinVer.nsh - having a problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  WinVer.nsh - having a problem</div>
<hr />
<div class="pda"><a href="t-327778.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=327778">WinVer.nsh - having a problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Ron.Stordahl</div><div class="date">24th February 2011, 02:35</div></div><div class="posttext">WinVer.nsh provides a method to detect the OS Version and take certain actions thus:<br />
<br />
${If} ${AtLeastWinVista}<br />
  --take certain action--<br />
${Endif}<br />
<br />
The above works nicely.  But if I substitute a variable for &quot;AtLeastWinVista&quot; it doesn't work:<br />
<br />
Var Min_OS_Ver<br />
StrCpy $Min_OS_Ver &quot;AtLeastWinVista&quot;<br />
${If} ${$Min_OS_Ver}<br />
 --take certain action--<br />
${Endif}<br />
<br />
Doesn't compile.  I am using the OS Version testing at several places in my install source and want to define the test parameter at just one place.<br />
<br />
Am I making a mistake or doesn't WinVer.nsh support this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">msroboto</div><div class="date">24th February 2011, 05:21</div></div><div class="posttext">I don't know what you're trying to do.<br />
I think something like this??<br />
<br />
Var Min_OS_Ver<br />
StrCpy $Min_OS_Ver ${AtLeastWinVista}<br />
${If} $Min_OS_Ver<br />
--take certain action--<br />
${Endif}<br />
<br />
I'm not even sure if that will work but it might.<br />
${AtLeastWinVista} as ${If} are macros I think.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">24th February 2011, 06:20</div></div><div class="posttext">Why would you want to use a variable instead of ${AtLeastWinVista}? You can use ${AtLeastWinVista} more than once, you know. Just use it every time you need to know if the OS is Vista or higher.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ron.Stordahl</div><div class="date">24th February 2011, 15:03</div></div><div class="posttext">MSG: The reason is I like to define all constants wherever possible in one place at the beginning in a group.  I believe it is good practice rather than smearing them all around the place.  This particular expression occurs in 3 different sections.<br />
<br />
msroboto: Ill try what you suggest when I get back.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th February 2011, 15:53</div></div><div class="posttext">You do not use variables and StrCpy to define constants. Use !define, which will work here.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ron.Stordahl</div><div class="date">24th February 2011, 16:33</div></div><div class="posttext">msroboto:  What you suggested didn't work.  The error message was: &quot;_If&quot; required 4 parameter(s), passed 2!<br />
<br />
Afro UK:  I have tried:<br />
<br />
!define Min_OS &quot;AtLeastWinXP&quot;<br />
..<br />
..<br />
${If} ${Min_OS}  as well as ${If} ${&quot;Min_OS&quot;} and get exactly the same error.<br />
<br />
Of course ${If} ${AtLeastWinXP} works so I know I am using that correctly.<br />
<br />
I would like to get this working so that I can define the second parameter once at the beginning of the installer.  I use it in several sections including the uninstaller.  So it is desirable to define it just once if possible.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jiake</div><div class="date">24th February 2011, 16:37</div></div><div class="posttext">Both &quot;${If}&quot; &amp; &quot;${AtLeastWinVista}&quot; are macros, they will be replcce with the pre-defined string when compiling. But the value of $Min_OS_Ver only would be known when running.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th February 2011, 16:52</div></div><div class="posttext">!define Min_OS ${AtLeastWinXP}<br />
${If} ${Min_OS}<br />
<br />
should work.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ron.Stordahl</div><div class="date">24th February 2011, 17:30</div></div><div class="posttext">Stu:<br />
<br />
!define Min_OS ${AtLeastWinXP}<br />
${If} ${Min_OS}<br />
<br />
Worked!  Thank you!  I will be using AtLeastVista to put user data in $APPDATA as needed for Vista and W7.  Up to this point user data has gone in $INSTDIR, too late to change that for XP without causing user confusion.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">24th February 2011, 17:59</div></div><div class="posttext">You mean, too late for Win95+IE4 ? ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hedrox</div><div class="date">15th January 2013, 13:03</div></div><div class="posttext">can anyone plz help me out, i found WinVer.nsh with windows 8 detection, or at least i think so :)<br />
http://nsis.svn.sourceforge.net/viewvc/nsis/NSIS/trunk/Include/WinVer.nsh?revision=6249&amp;view=markup&amp;pathrev=6249<br />
but don't know how to use it in my code for example:<br />
<br />
!include LogicLib.nsh<br />
!include UAC.nsh<br />
!include WinVer.nsh<br />
<br />
Function .onInit<br />
${WinVerGetMajor} $1<br />
DetailPrint &quot;Major version = $1&quot;<br />
${WinVerGetMinor} $2<br />
DetailPrint &quot;Minor version = $2&quot;<br />
${WinVerGetBuild} $3<br />
DetailPrint &quot;Build number = $3&quot; <br />
<br />
FunctionEnd<br />
<br />
This one does not work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">15th January 2013, 23:09</div></div><div class="posttext">Should work as usual:<br />
<br />
${If} ${IsNT}<br />
    ${If} ${AtLeastWin8}<br />
        MessageBox MB_OK &quot;You have Windows 8 or a future version!&quot;<br />
    ${EndIf}<br />
<br />
    ${If} ${IsWin8}<br />
        MessageBox MB_OK &quot;Your system is Windows 8!&quot;<br />
    ${EndIf}<br />
<br />
    ${If} ${IsAtMostWin8}<br />
        MessageBox MB_OK &quot;You have Windows 8 or an older version!&quot;<br />
    ${EndIf}<br />
${EndIf}<br />
<br />
And don't let yourself get confused by Microsoft's marketing department!<br />
The so-called &quot;Windows 8&quot; in fact is Windows NT 6.2, so that's probably what you get when you read the &quot;raw&quot; version numbers ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">15th January 2013, 23:32</div></div><div class="posttext">can anyone plz help me out, i found WinVer.nsh with windows 8 detection, or at least i think so :)<br />
http://nsis.svn.sourceforge.net/viewvc/nsis/NSIS/trunk/Include/WinVer.nsh?revision=6249&amp;view=markup&amp;pathrev=6249<br />
but don't know how to use it in my code for example:<br />
<br />
<br />
The .nsh in SVN is not compatible with 2.46 but you can grab the version number from there and modify your local .nsh...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>