<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" CreateShortcut Problem with Icon, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  CreateShortcut Problem with Icon NSIS Discussion" />
	
	<title> CreateShortcut Problem with Icon [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  CreateShortcut Problem with Icon</div>
<hr />
<div class="pda"><a href="t-356396.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=356396">CreateShortcut Problem with Icon</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">RossW</div><div class="date">27th February 2013, 16:31</div></div><div class="posttext">I'm trying to associate a custom icon to my application via CreateShortcut:<br />
<br />
<br />
<br />
  !define MUI_ICON &quot;${NSISDIR}\Contrib\Graphics\Icons\orange-install-nsis.ico&quot;<br />
  !define MUI_UNICON &quot;${NSISDIR}\Contrib\Graphics\Icons\orange-uninstall-nsis.ico&quot;<br />
<br />
  LogText &quot;&gt; creating $SMPROGRAMS\$STARTMENU_FOLDER\Uninstall.lnk ...&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\$STARTMENU_FOLDER\Uninstall.lnk&quot; &quot;$INSTDIR\Uninstall.exe&quot; &quot;${MUI_UNICON}&quot;<br />
<br />
  LogText &quot;&gt; creating $SMPROGRAMS\$STARTMENU_FOLDER\${WfestAppName}.lnk ...&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\$STARTMENU_FOLDER\${WfestAppName}.lnk&quot; \<br />
      &quot;$ACCESS_DIR\MSACCESS.EXE&quot; '&quot;$R0\${WfestAppFileName}&quot; /wrkgrp &quot;$R1&quot;' &quot;$INSTDIR\Images\WF_72x72_2.ico&quot;<br />
<br />
<br />
The problem is that the Uninstall link under Start &gt; Programs &gt; (my program folder) ends up with the application's icon, not the intended 'X' icon in MUI_UNICON (I added the info to specifically set the MUI_UNICON above but that didn't help).<br />
<br />
Any ideas on what's going on here? I'm installing on a Win7 Pro 64-bit machine (BTW, the actual uninstall.exe file in my INSTDIR has the right icon).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RossW</div><div class="date">27th February 2013, 17:52</div></div><div class="posttext">Well, that's weird - tried it a few more times after restarting the box and all works fine now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">28th February 2013, 07:27</div></div><div class="posttext">You cannot set the uninstall icon to ${MUI_UNICON}, as the latter only exists at compiletime. Just set the icon field to uninstall.exe.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RossW</div><div class="date">1st March 2013, 01:08</div></div><div class="posttext">Thanks MSG. I only added it because it seemed like the only way to get the uninstall icon back.<br />
<br />
So, another weird compiler problem which I think now is the same as this - even after updating the script, the installer 'seems' to use a previous version's info (could the extraction of the setup.exe be cached on my Windows 7 box?). On the machine I usually develop NSIS scripts on, this change to the script:<br />
<br />
<br />
!define: &quot;MUI_STARTMENUPAGE_DEFAULTFOLDER&quot;=&quot;WonderFest Model Contest&quot;<br />
<br />
<br />
works as expected on that WinXP box. But when I run the setup.exe on another Win7 machine, it seems to use the previous value:<br />
<br />
50271<br />
<br />
This is the same behaviour I saw with the uninstaller icon - I had changed it to a custom one but then decided to go back to the MUI orang one, but it was still showing my custom icon on this machine (which is why I tried putting in the ${MUI_UNICON} bit). I think if I reboot the Win7 box all is well.<br />
<br />
Anyone ever come across this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">2nd March 2013, 11:51</div></div><div class="posttext">Perhaps you stored the start menu folder location in registry during a previous install?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RossW</div><div class="date">2nd March 2013, 12:37</div></div><div class="posttext">That's true, but the uninstall section removes those registry settings. And the icon for the uninstaller wouldn't be in the registry.<br />
<br />
I'll look to see if the registry really is cleaned up after uninstall.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>