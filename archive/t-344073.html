<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Stop the background installation after uninstalling option selected using nsDialog, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Stop the background installation after uninstalling option selected using nsDialog NSIS Discussion" />
	
	<title> Stop the background installation after uninstalling option selected using nsDialog [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Stop the background installation after uninstalling option selected using nsDialog</div>
<hr />
<div class="pda"><a href="t-344073.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=344073">Stop the background installation after uninstalling option selected using nsDialog</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">priyankaB</div><div class="date">13th April 2012, 09:50</div></div><div class="posttext">Hi All,<br />
<br />
I am into the initial phase of learning the NSIS scripting. <br />
I would like to know how can I stop the installation, when the user selects uninstall option (on the custom page with options reinstall or uninstall). I do not want the user to install the application after uninstalling. It should simply quit. Code snippet of my Custom Leave function is as below:-<br />
<br />
---clip---<br />
<br />
 Function LeaveCustomCheck<br />
<br />
	Pop $hwnd<br />
	${If} $hwnd == $Group1Radio1<br />
	    ;Perform Installation<br />
	${ElseIf} $hwnd == $Group1Radio2<br />
	SetAutoClose true<br />
	BringToFront<br />
	ReadRegStr $R1 HKLM &quot;${PRODUCT_UNINST_KEY}&quot; &quot;UninstallString&quot;<br />
	HideWindow<br />
	ClearErrors<br />
	ExecWait '$R1 _?=$INSTDIR'<br />
	IfErrors no_remove_uninstaller<br />
	IfFileExists &quot;$INSTDIR\uninstall.exe&quot; 0 no_remove_uninstaller<br />
    Delete &quot;$R1&quot;<br />
    RMDir $INSTDIR<br />
	Quit<br />
	;Call RelGotoPage<br />
	no_remove_uninstaller:<br />
	${Else}<br />
	MessageBox MB_ICONSTOP &quot;Please select either of the options or press Cancel to exit installer.&quot; IDOK<br />
	Abort<br />
	${EndIf}<br />
	<br />
FunctionEnd<br />
<br />
---clap---<br />
<br />
Once the user selects &quot;Uninstall&quot; radiobutton and presses &quot;Next&quot; button, the uninstallation starts and hides the page behind it. After the uninstallation ends, the page MUI_PAGE_DIRECTORY pops up, to select directory for further installation. I want this script to end once Uninstallation completes.<br />
<br />
Would appreciate, if anyone of you can help me with a solution for the same.<br />
<br />
Thanks in advance.<br />
<br />
-Priyanka</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">13th April 2012, 10:29</div></div><div class="posttext">You should never install or uninstall anything in a page's leave function - that way you're making changes to the users system before the actual instfiles page comes up!<br />
<br />
What you should do is set a variable to install, uninstall or reinstall/modify. Then do:<br />
section YourSection<br />
${If} $Variable == install<br />
;install<br />
${Else}<br />
;uninstall<br />
${EndIf}<br />
sectionend<br />
<br />
You could also modify the finish page in its show function, depending on the value of the variable.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">priyankaB</div><div class="date">13th April 2012, 16:13</div></div><div class="posttext">I am still confused, if the above specified solution will work. Here is what I am trying to achieve in my script:-<br />
1. If the application is not installed, then simply install the same without showing Custom Page.<br />
2. If the application is already installed, then show the custom page (with options reinstall/uninstall) and perform action as selected by the user.<br />
<br />
Also, both the install and uninstall sections are different. So, would it be possible to do installation and uninstallation within one section?<br />
<br />
Here is my script:-<br />
; Script generated by the HM NIS Edit Script Wizard.<br />
<br />
; HM NIS Edit Wizard helper defines<br />
!define PRODUCT_NAME &quot;MITRAC CC TDS-PROG Tool&quot;<br />
!define PRODUCT_VERSION &quot;2.6.0.6&quot;<br />
!define PRODUCT_DIR_REGKEY &quot;Software\Microsoft\Windows\CurrentVersion\App Paths\TDSProg.exe &quot;<br />
!define PRODUCT_UNINST_KEY &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}&quot;<br />
!define PRODUCT_UNINST_ROOT_KEY &quot;HKLM&quot;<br />
!define TEXT_IO_TITLE &quot;MITRAC CC TDS-PROG Tool&quot;<br />
!define TEXT_IO_SUBTITLE &quot;This Application is already installed. What would you like to do?&quot;<br />
<br />
; MUI 1.67 compatible ------<br />
!include &quot;MUI.nsh&quot;<br />
!include &quot;LogicLib.nsh&quot;<br />
!include &quot;nsDialogs.nsh&quot;<br />
<br />
; MUI Settings<br />
!define MUI_ABORTWARNING<br />
!define MUI_HEADERIMAGE<br />
!define MUI_ICON &quot;TDSProjectToolInstall.ico&quot;<br />
!define MUI_UNICON &quot;TDSProjectToolUninstall.ico&quot;<br />
<br />
; Language Selection Dialog Settings<br />
!define MUI_LANGDLL_REGISTRY_ROOT &quot;${PRODUCT_UNINST_ROOT_KEY}&quot;<br />
!define MUI_LANGDLL_REGISTRY_KEY &quot;${PRODUCT_UNINST_KEY}&quot;<br />
!define MUI_LANGDLL_REGISTRY_VALUENAME &quot;NSIS:Language&quot;<br />
<br />
!insertmacro MUI_RESERVEFILE_INSTALLOPTIONS<br />
; Welcome page<br />
!insertmacro MUI_PAGE_WELCOME<br />
/*; License page<br />
!insertmacro MUI_PAGE_LICENSE &quot;..\SoftwareLicence.txt&quot;*/<br />
;Overwrite Check<br />
Page custom ShowCustomCheck LeaveCustomCheck<br />
; Directory page<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
; Instfiles page<br />
!insertmacro MUI_PAGE_INSTFILES<br />
; Finish page<br />
!define MUI_FINISHPAGE_RUN &quot;$INSTDIR\TDSProg.exe &quot;<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
; Uninstaller pages<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
; Language files<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
!insertmacro MUI_LANGUAGE &quot;French&quot;<br />
!insertmacro MUI_LANGUAGE &quot;German&quot;<br />
<br />
; MUI end ------<br />
<br />
<br />
Name &quot;${PRODUCT_NAME} ${PRODUCT_VERSION}&quot;<br />
<br />
OutFile &quot;MITRAC_CC_TDS-PROG-Tool_2.6.0.6_install.exe&quot;<br />
<br />
InstallDir &quot;$PROGRAMFILES\MITRAC\TDS-PROG2&quot;<br />
InstallDirRegKey HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot;<br />
ShowInstDetails show<br />
ShowUnInstDetails show<br />
<br />
Function .onInit<br />
  <br />
  !insertmacro MUI_LANGDLL_DISPLAY<br />
 	<br />
FunctionEnd<br />
<br />
var dialog<br />
var hwnd<br />
 <br />
var Group1Radio1<br />
var Group1Radio2<br />
var Label<br />
var Text<br />
<br />
Function ShowCustomCheck<br />
<br />
	ReadRegStr $R0 HKLM &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayName&quot;<br />
    StrCmp $R0 &quot;&quot; lbl_ok 0<br />
	nsDialogs::Create 1018<br />
		Pop $dialog<br />
	!insertmacro MUI_HEADER_TEXT &quot;Already Installed&quot; &quot;Choose the maintenance option to perform.&quot;<br />
	${NSD_CreateLabel} 0 0 100% 20% &quot;$(^Name)is already installed. Select the operation you want to perform and click Next to continue.&quot;<br />
	Pop $Label<br />
	<br />
	${NSD_CreateRadioButton} 10 30 60% 25% &quot;Re-install&quot;<br />
	Pop $Group1Radio1<br />
	${NSD_AddStyle} $Group1Radio1 ${WS_GROUP}<br />
	${NSD_OnClick} $Group1Radio1 RadioClick<br />
	<br />
	${NSD_CreateRadioButton} 10 35% 25% 12% &quot;Un-install&quot;<br />
	Pop $Group1Radio2<br />
	${NSD_OnClick} $Group1Radio2 RadioClick <br />
	<br />
	nsDialogs::Show<br />
	lbl_ok:<br />
		Return<br />
 FunctionEnd<br />
 <br />
 Function RadioClick<br />
 ;<br />
 FunctionEnd<br />
 <br />
 Function LeaveCustomCheck<br />
<br />
	Pop $hwnd<br />
	${If} $hwnd == $Group1Radio1<br />
	    ;Perform Installation<br />
	${ElseIf} $hwnd == $Group1Radio2<br />
	SetAutoClose true<br />
	BringToFront<br />
	ReadRegStr $R1 HKLM &quot;${PRODUCT_UNINST_KEY}&quot; &quot;UninstallString&quot;<br />
	;HideWindow<br />
	ClearErrors<br />
	ExecWait '$R1 _?=$INSTDIR'<br />
	IfErrors no_remove_uninstaller<br />
	IfFileExists &quot;$INSTDIR\uninstall.exe&quot; 0 no_remove_uninstaller<br />
    Delete &quot;$R1&quot;<br />
    RMDir $INSTDIR<br />
	Quit<br />
	;Call RelGotoPage<br />
	no_remove_uninstaller:<br />
	${Else}<br />
	MessageBox MB_ICONSTOP &quot;Please select either of the options or press Cancel to exit installer.&quot; IDOK<br />
	Abort<br />
	${EndIf}<br />
	<br />
FunctionEnd<br />
<br />
Section &quot;MainSection&quot; SEC01<br />
  lbl_inst:<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  SetOverwrite ifnewer<br />
  File &quot;..\TDSProg\release\TDSProg.exe&quot;<br />
  CreateDirectory &quot;$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS-PROG Tool.lnk&quot; &quot;$INSTDIR\TDSProg.exe&quot;<br />
  CreateShortCut &quot;$DESKTOP\TDS-PROG Tool.lnk&quot; &quot;$INSTDIR\TDSProg.exe&quot;<br />
  <br />
  File &quot;..\TDSProg\release\MTScc.dll&quot;<br />
  File &quot;..\TDSProg\release\MTHelpViewer.dll&quot;<br />
  File &quot;..\TDSProg\release\MTResManager.dll&quot;<br />
  File &quot;..\TDSProg\release\MTGrid.dll&quot;<br />
  File &quot;..\TDSProg\release\TDSLib.dll&quot;<br />
  File &quot;..\TDSProg\release\TDSOutput.dll&quot;<br />
  File &quot;..\TDSProg\release\TDSParseDLL.dll&quot;<br />
  File &quot;..\TDSProg\release\TDSParseDLL_Unicode.dll&quot;<br />
  File &quot;..\TDSProg\release\Trace.dll&quot;<br />
  File &quot;..\TDSProg\release\TDSImportInterface.dll&quot;<br />
  File &quot;..\TDSProg\release\TDSXMLExportPlugin.dll&quot;<br />
  File &quot;..\TDSProg\release\olexlsf.tlh&quot;	<br />
  File &quot;..\TDSProg\release\olexlsf.tli&quot;<br />
  File &quot;..\service\makedlu\makedlu.exe&quot;<br />
  File &quot;..\service\makedlu\tar.exe&quot;<br />
  File &quot;..\service\makedlu\gzip.exe&quot;<br />
  File &quot;..\service\makedlu\zip.exe&quot;<br />
  File &quot;..\service\xfo40-reg-20090111\REG\Lib\olexlsf.dll&quot;<br />
  Exec &quot;Setenv D:\Program Files\MITRAC\TDS-PROG2&quot;<br />
  Exec &quot;REGSVR32.EXE olexlsf.dll&quot;<br />
  SetOutPath &quot;$INSTDIR\temp&quot;<br />
  File &quot;..\TDSProg\release\temp\exportFile.xls&quot;<br />
  <br />
SectionEnd<br />
SetPluginUnload  alwaysoff<br />
<br />
<br />
<br />
Section &quot;SupportDll&quot; SEC02<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  File &quot;mfc42loc.dll&quot;  <br />
  File &quot;QtCore4.dll&quot;<br />
  File &quot;QtGui4.dll&quot;<br />
  File &quot;QtXml4.dll&quot;<br />
SectionEnd<br />
<br />
Section &quot;Help&quot; SEC03<br />
  SetOutPath &quot;$INSTDIR\help\en&quot;<br />
  File &quot;..\TDSProg\help\en\contents.xml&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish.htm&quot;<br />
  File &quot;..\TDSProg\help\en\style.css&quot;<br />
  SetOutPath &quot;$INSTDIR\help\en\HelpEnglish_files&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image001.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image002.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image003.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image004.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image005.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image006.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image007.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image008.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image009.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image010.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image011.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image012.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image013.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image014.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image015.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image016.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image017.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image018.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image019.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image020.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image021.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image022.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image023.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image024.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image025.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image026.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image027.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image028.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image029.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image030.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image031.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image032.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image033.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image034.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image035.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image036.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image037.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image038.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image039.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image040.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image041.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image042.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image043.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image044.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image045.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image046.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image047.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image048.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image049.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image050.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image051.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image052.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image053.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image054.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image055.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image056.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image057.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image058.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image059.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image060.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image061.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image062.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image063.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image064.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image065.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image066.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image067.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image068.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image069.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image070.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image071.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image072.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image073.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image074.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image075.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image076.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image077.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image078.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image079.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image080.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image081.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image082.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image083.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image084.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image085.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image086.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image087.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image088.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image089.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image090.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image091.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image092.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image093.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image094.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image095.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image096.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image097.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image098.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image099.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image100.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image101.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image102.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image103.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image104.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image105.png&quot;<br />
  File &quot;..\TDSProg\help\en\HelpEnglish_files\image106.png&quot;<br />
  <br />
SectionEnd<br />
Section &quot;Help&quot; SEC04<br />
  SetOutPath &quot;$INSTDIR\help\en_ecm&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\contents.xml&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish.htm&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\style.css&quot;<br />
  SetOutPath &quot;$INSTDIR\help\en_ecm\HelpEnglish_files&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image001.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image002.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image003.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image004.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image005.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image006.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image007.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image008.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image009.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image010.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image011.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image012.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image013.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image014.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image015.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image016.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image017.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image018.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image019.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image020.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image021.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image022.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image023.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image024.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image025.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image026.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image027.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image028.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image029.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image030.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image031.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image032.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image033.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image034.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image035.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image036.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image037.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image038.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image039.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image040.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image041.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image042.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image043.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image044.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image045.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image046.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image047.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image048.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image049.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image050.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image051.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image052.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image053.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image054.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image055.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image056.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image057.png&quot;<br />
  File &quot;..\TDSProg\help\en_ecm\HelpEnglish_files\image058.png&quot;<br />
  <br />
  <br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  File &quot;..\3EGM080680D9023_EN_D_TDS_PROG_UserManual_Engineering.pdf&quot;<br />
  File &quot;..\3EGM080680D9024_EN_D_TDS_PROG_UserManual_EndCustomer.pdf&quot;<br />
  File &quot;..\3EGM080680D9025_EN_C_TDS_PROG_Tutorial.pdf&quot;<br />
  File &quot;..\3EGM080680D0260_EN__TDS-PROG_ReleaseNote_2_6_0_0.pdf&quot;<br />
<br />
SectionEnd<br />
<br />
Section -AdditionalIcons<br />
  CreateShortCut &quot;$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS User Manual-Engineering.lnk&quot; &quot;$INSTDIR\3EGM080680D9023_EN_D_TDS_PROG_UserManual_Engineering.pdf&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS User Manual-EndCustomer.lnk&quot; &quot;$INSTDIR\3EGM080680D9024_EN_D_TDS_PROG_UserManual_EndCustomer.pdf&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS User Guide.lnk&quot; &quot;$INSTDIR\3EGM080680D9025_EN_C_TDS_PROG_Tutorial.pdf&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS Release Notes.lnk&quot; &quot;$INSTDIR\3EGM080680D0260_EN__TDS-PROG_ReleaseNote_2_6_0_0.pdf&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\Uninstall.lnk&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
SectionEnd<br />
<br />
Section -RegistrySettings<br />
  WriteRegStr HKCR &quot;.mdp&quot; &quot;&quot; &quot;mdpfile&quot;<br />
  WriteRegStr HKCR &quot;mdpfile&quot; &quot;&quot; &quot;TDS-PROG Tool Project File&quot;<br />
  WriteRegDWORD HKCR &quot;mdpfile&quot; &quot;EditFlags&quot; 0x00000000<br />
  WriteRegDWORD HKCR &quot;mdpfile&quot; &quot;BrowserFlags&quot; 0x00000008<br />
  WriteRegStr HKCR &quot;mdpfile\DefaultIcon&quot; &quot;&quot; &quot;$\&quot;$INSTDIR\TDSProg.exe$\&quot;,1&quot;<br />
  WriteRegStr HKCR &quot;mdpfile\shell&quot; &quot;&quot; &quot;Open&quot;<br />
  WriteRegStr HKCR &quot;mdpfile\shell\Open&quot; &quot;&quot; &quot;Open Project with TDS Prog Tool&quot;<br />
  WriteRegStr HKCR &quot;mdpfile\shell\Open\command&quot; &quot;&quot; &quot;$\&quot;$INSTDIR\TDSProg.exe$\&quot; $\&quot;-o$\&quot; $\&quot;%1$\&quot;&quot;<br />
  WriteRegStr HKCR &quot;mdpfile\shell\Generate&quot; &quot;&quot; &quot;Generate Files with TDS Prog Tool&quot;<br />
  WriteRegStr HKCR &quot;mdpfile\shell\Generate\command&quot; &quot;&quot; &quot;$\&quot;$INSTDIR\TDSProg.exe$\&quot; $\&quot;-g$\&quot; $\&quot;%1$\&quot;&quot;<br />
  WriteRegStr HKCR &quot;mdpfile\shell\Clean&quot; &quot;&quot; &quot;Clean Files with TDS Prog Tool&quot;<br />
  WriteRegStr HKCR &quot;mdpfile\shell\Clean\command&quot; &quot;&quot; &quot;$\&quot;$INSTDIR\TDSProg.exe$\&quot; $\&quot;-c$\&quot; $\&quot;%1$\&quot;&quot;<br />
SectionEnd<br />
<br />
Section -Post<br />
  WriteUninstaller &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot; &quot;$INSTDIR\TDSProg.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayName&quot; &quot;$(^Name)&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayIcon&quot; &quot;$INSTDIR\TDSProg.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayVersion&quot; &quot;${PRODUCT_VERSION}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;URLInfoAbout&quot; &quot;${PRODUCT_WEB_SITE}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;Publisher&quot; &quot;${PRODUCT_PUBLISHER}&quot;<br />
SectionEnd<br />
<br />
<br />
Function un.onUninstSuccess<br />
  HideWindow<br />
  MessageBox MB_ICONINFORMATION|MB_OK &quot;$(^Name) was successfully removed from your computer.&quot;<br />
FunctionEnd<br />
<br />
Function un.onInit<br />
<br />
!insertmacro MUI_UNGETLANGUAGE<br />
  MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 &quot;Are you sure you want to completely remove $(^Name) and all of its components?&quot; IDYES +2<br />
  Abort<br />
FunctionEnd<br />
<br />
Section Uninstall<br />
  Delete &quot;$INSTDIR\uninst.exe&quot;<br />
<br />
  Delete &quot;$INSTDIR\3EGM080680D9023_EN_D_TDS_PROG_UserManual_Engineering.pdf&quot;<br />
  Delete &quot;$INSTDIR\3EGM080680D9024_EN_D_TDS_PROG_UserManual_EndCustomer.pdf&quot;<br />
  Delete &quot;$INSTDIR\3EGM080680D9025_EN_C_TDS_PROG_Tutorial.pdf&quot;<br />
  Delete &quot;$INSTDIR\3EGM080680D0260_EN__TDS-PROG_ReleaseNote_2_6_0_0.pdf&quot;<br />
  <br />
<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish.htm&quot;<br />
  Delete &quot;$INSTDIR\help\en\contents.xml&quot;<br />
  Delete &quot;$INSTDIR\help\en\style.css&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image001.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image002.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image003.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image004.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image005.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image006.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image007.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image008.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image009.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image010.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image011.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image012.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image013.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image014.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image015.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image016.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image017.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image018.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image019.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image020.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image021.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image022.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image023.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image024.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image025.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image026.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image027.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image028.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image029.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image030.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image031.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image032.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image033.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image034.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image035.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image036.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image037.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image038.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image039.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image040.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image041.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image042.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image043.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image044.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image045.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image046.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image047.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image048.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image049.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image050.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image051.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image052.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image053.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image054.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image055.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image056.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image057.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image058.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image059.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image060.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image061.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image062.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image063.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image064.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image065.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image066.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image067.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image068.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image069.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image070.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image071.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image072.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image073.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image074.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image075.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image076.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image077.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image078.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image079.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image080.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image081.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image082.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image083.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image084.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image085.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image086.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image087.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image088.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image089.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image090.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image091.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image092.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image093.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image094.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image095.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image096.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image097.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image098.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image099.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image100.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image101.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image102.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image103.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image104.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image105.png&quot;<br />
  Delete &quot;$INSTDIR\help\en\HelpEnglish_files\image106.png&quot;<br />
<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish.htm&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\contents.xml&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\style.css&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image001.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image002.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image003.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image004.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image005.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image006.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image007.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image008.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image009.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image010.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image011.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image012.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image013.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image014.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image015.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image016.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image017.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image018.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image019.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image020.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image021.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image022.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image023.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image024.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image025.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image026.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image027.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image028.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image029.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image030.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image031.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image032.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image033.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image034.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image035.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image036.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image037.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image038.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image039.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image040.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image041.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image042.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image043.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image044.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image045.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image046.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image047.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image048.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image049.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image050.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image051.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image052.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image053.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image054.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image055.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image056.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image057.png&quot;<br />
  Delete &quot;$INSTDIR\help\en_ecm\HelpEnglish_files\image058.png&quot;<br />
    <br />
  Delete &quot;$INSTDIR\QtXml4.dll&quot;<br />
  Delete &quot;$INSTDIR\QtGui4.dll&quot;<br />
  Delete &quot;$INSTDIR\QtCore4.dll&quot;<br />
  Delete &quot;$INSTDIR\mfc42loc.dll&quot;<br />
  Delete &quot;$INSTDIR\MTScc.dll&quot;<br />
  Delete &quot;$INSTDIR\MTHelpViewer.dll&quot;<br />
  Delete &quot;$INSTDIR\MTAbout.dll&quot;<br />
  Delete &quot;$INSTDIR\MTGrid.dll&quot;<br />
  Delete &quot;$INSTDIR\MTResManager.dll&quot;<br />
  Delete &quot;$INSTDIR\TDSLib.dll&quot;<br />
  Delete &quot;$INSTDIR\TDSParseDLL.dll&quot;<br />
  Delete &quot;$INSTDIR\TDSParseDLL_Unicode.dll&quot;<br />
  Delete &quot;$INSTDIR\TDSOutput.dll&quot;<br />
  Delete &quot;$INSTDIR\Trace.dll&quot;<br />
  Delete &quot;$INSTDIR\TDSImportInterface.dll&quot;<br />
  Delete &quot;$INSTDIR\olexlsf.tlh&quot;	<br />
  Delete &quot;$INSTDIR\olexlsf.tli&quot;<br />
  Delete &quot;$INSTDIR\olexlsf.dll&quot;<br />
  Delete &quot;$INSTDIR\TDSProg.exe&quot;<br />
  Delete &quot;$INSTDIR\olexlsf.dll&quot;<br />
  Delete &quot;$INSTDIR\makedlu.exe&quot;<br />
  Delete &quot;$INSTDIR\tar.exe&quot;<br />
  Delete &quot;$INSTDIR\gzip.exe&quot;<br />
  Delete &quot;$INSTDIR\zip.exe&quot;<br />
  Delete &quot;$INSTDIR\temp\exportFile.xls&quot;<br />
  Delete &quot;$INSTDIR\TDSXMLExportPlugin.dll&quot;<br />
  <br />
<br />
  Delete &quot;$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\Uninstall.lnk&quot;<br />
  Delete &quot;$DESKTOP\TDS-PROG Tool.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS-PROG Tool.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS User Manual-Engineering.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS User Manual-EndCustomer.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS User Guide.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS Release Notes.lnk&quot;<br />
  <br />
  <br />
  RMDir &quot;$SMPROGRAMS\MITRAC Tool Suite\TDS-PROG2&quot;<br />
  RMDir &quot;$INSTDIR\help\en\HelpEnglish_files&quot;<br />
  RMDir &quot;$INSTDIR\help\en_ecm\HelpEnglish_files&quot;<br />
  RMDir &quot;$INSTDIR\help\en_ecm&quot;<br />
  RMDir &quot;$INSTDIR\help\en&quot;<br />
  RMDir &quot;$INSTDIR\help&quot;<br />
  RMDir &quot;$INSTDIR\temp&quot;<br />
  RMDir &quot;$INSTDIR&quot;<br />
<br />
  DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot;<br />
  DeleteRegKey HKLM &quot;${PRODUCT_DIR_REGKEY}&quot;<br />
  DeleteRegKey HKCR &quot;mdpfile\DefaultIcon&quot;<br />
  DeleteRegKey HKCR &quot;mdpfile\shell\Open\command&quot;<br />
  DeleteRegKey HKCR &quot;mdpfile\shell\Open&quot;<br />
  DeleteRegKey HKCR &quot;mdpfile\shell\Generate\command&quot;<br />
  DeleteRegKey HKCR &quot;mdpfile\shell\Generate&quot;<br />
  DeleteRegKey HKCR &quot;mdpfile\shell\Clean\command&quot;<br />
  DeleteRegKey HKCR &quot;mdpfile\shell\Clean&quot;<br />
  DeleteRegKey HKCR &quot;mdpfile\shell&quot;<br />
  SetAutoClose true<br />
SectionEnd<br />
<br />
Regards,<br />
-Priyanka</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">13th April 2012, 17:22</div></div><div class="posttext">PLEASE use pastebin or an attachment for such huge amounts of code. ~_~<br />
<br />
Yes, you can do both install and uninstall in one section, using the very simple code I gave you. Make sure that the default value of $variable is set to install, in case the installer skips the install/uninstall/reinstall page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th April 2012, 18:00</div></div><div class="posttext">Also switch to MUI2.nsh (as you are using nsDialogs).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">priyankaB</div><div class="date">17th April 2012, 06:23</div></div><div class="posttext">The fix you gave me didn't work and now the uninstall is behaving in a weird manner.<br />
May be my way of implementing the same is wrong.:(<br />
Could you please check and verify. I have attached the script with this post.<br />
<br />
-Priyanka</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">17th April 2012, 06:36</div></div><div class="posttext">Why are you calling the uninstaller? You can just as simply uninstall the previous version directly from your install section.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>