<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" update dlls via cab files?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  update dlls via cab files? NSIS Discussion" />
	
	<title> update dlls via cab files? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  update dlls via cab files?</div>
<hr />
<div class="pda"><a href="t-170993.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=170993">update dlls via cab files?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">treborhudson</div><div class="date">25th February 2004, 22:00</div></div><div class="posttext">I'm creating an installer that I need to check for a specific window media decoder version.  The easiest way to do this is to tell Windows to install the CAB file that contains the latest version of the file and let windows handle the dependencies and registry stuff.  Does NSIS support anything like this?  I'm told that the windows API has this built in.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">25th February 2004, 22:19</div></div><div class="posttext">A CAB file itself does not contain installation information. These things are usually setup using an application or included INF file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">treborhudson</div><div class="date">25th February 2004, 23:14</div></div><div class="posttext">Thanks for the quick reply.<br />
<br />
I don't have a good handle on the process then.<br />
<br />
Could someone quickly explain the process to go through so NSIS can ensure that the system I'm installing on has or gets installed a newer version of the codec?<br />
<br />
I'm guessing here:<br />
Find the .dll or .cab file that needs to be installed.<br />
Check windows version.<br />
(Something with .inf files)<br />
Execute a NSIS command that calls some windows bit of functionality that does the heavy lifting.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">25th February 2004, 23:20</div></div><div class="posttext">Microsoft distributes installers for Windows Media Playes codecs. If you don't want to handle the installation yourself you can extract such an installer to a temporary location ($PLUGINSDIR after using InitPlugisDir) and run the installer silently.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">treborhudson</div><div class="date">27th February 2004, 01:20</div></div><div class="posttext">OK.  I'm using MessageBox MB_YESNO to ask the user if they want to install a new media player version.  If they say NO, it jumps past this line (doesn't execute it):<br />
<br />
ExecWait &quot;$INSTDIR\upgrades\MPSetup.exe&quot;<br />
<br />
However, since I'm calling another installation program, it warns me in the WMP setup that another installation hasn't finished yet and is going to abort.  <br />
<br />
How can I call another installer while mine is running?  OR  How can I close my installer but queue up another (possibly 2 other) installer(s) when it finishes?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">heXor</div><div class="date">27th February 2004, 08:01</div></div><div class="posttext">There are different solutions to this problem.<br />
The most professional is not to show any message box, but to have a customized page using the InstallOptions plugin. <br />
<br />
In a customized page you could have two radiobuttons the user can choose between. Install the codecs or do not install them. Ofcourse that there can be a checkbox too...<br />
<br />
Anyway, if you use the MessageaBox, you will have 2 possibilities to start the other installation.<br />
<br />
1. From a section in your NSIS script<br />
2. From an installer page, when you leave the page and goto next page for example.<br />
<br />
Calling the other installtion should be done as do now, i.e to use the ExecWait command. NSIS installation will wait until &quot;$INSTDIR\upgrades\MPSetup.exe&quot; finishes and then NSIS continues.<br />
<br />
I don't really understand if you want to start another instance of the NSIS installation or if you want to call another program, so this you will have to explain more...<br />
<br />
Quiting the NSIS installation is easy..just write &quot;Quit&quot; in your NSIS script and the installation will exit...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">treborhudson</div><div class="date">27th February 2004, 16:57</div></div><div class="posttext">So is launching a 2nd installer from a messagebox the reason the 2nd installer won't continue?<br />
<br />
I only want my 1 instance of the NSIS installer I'm writing, but I need to offer to install the new Windows Media Player (WMP) if they are on Windows 98.  (I haven't added the OS check yet, but that seems simple enough)<br />
<br />
My main blocker at the moment is that the WMP installer will not run when called from my NSIS installer.  It prompts me that another installation is currently active and needs to be shut down before the WMP installer will continue... Press OK to abort.  That kind of thing.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">27th February 2004, 18:36</div></div><div class="posttext">That is weird. An NSIS installer should not make a difference for the other installer. Does it work when executing it manually using the same parameters?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">treborhudson</div><div class="date">27th February 2004, 18:54</div></div><div class="posttext">Yes.<br />
<br />
What we are reverting to for this installation is to copy over the WMP executable to the hard drive.  Then when our program launches, check for Windows 98 and offer to install WMP from there.  When we run the installer at that time, it works just fine.<br />
<br />
I'd like to install all necessary things at the same time, but for now, this is an acceptable solution.<br />
<br />
I'd be happy to provide more information.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">heXor</div><div class="date">27th February 2004, 19:21</div></div><div class="posttext">I also think it's weird...<br />
The other installer should not interfere with NSIS...those two installers have nothing to do with each other.<br />
<br />
Anyway, I suggest this:<br />
Create a very simple NSIS installation. You can create a simple NSIS installation by just creating a section and writing the OutFile command. You can take one of the simple examples you find in your NSIS examples folder.<br />
<br />
Unpack your exe file (the installer you're trying to run) and then run it with the ExecWait command. If you get the same error, then please post that installation together with the NSIS script file to this forum. The we'll have a look at it.<br />
<br />
It's very difficult to know what the problem is.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">treborhudson</div><div class="date">28th February 2004, 01:58</div></div><div class="posttext">I won't be able to get back to this until Monday, but I made a test installer and I slightly misread the text and the problem.  Here is the exact text:<br />
<br />
&quot;Another program installation was not completed.  You must restart your computer to complete that installation before upgrading Windows.  Click Cancel, restart your computer, and then try installing Windows Media Player 9 Series again.&quot;<br />
<br />
Options: Next, Cancel<br />
<br />
If I click Next, it proceeds to the next installation page where one would presume it normally starts the installation.<br />
<br />
So it seems the WMP installer somehow knows that it was called by another installer?<br />
<br />
All my install does is copy the executable to the INSTDIR and prompts the user to install it and calls ExecWait to call the .exe file.  I can post the file if need be.<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">heXor</div><div class="date">28th February 2004, 10:09</div></div><div class="posttext">Please post the simple installer.<br />
We'll have al look at it.<br />
<br />
Regards<br />
/Paul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">heXor</div><div class="date">1st March 2004, 07:08</div></div><div class="posttext">Maybe you can try something else:<br />
Instead of unpacking to the $PLUGINSDIR, try to unpack to c:\ - only for testing purposes, ofcourse.<br />
<br />
Try to run the other installer from c:\ and see if you get the same warning message. Maybe it doesn't like to be started from a temp directory...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">treborhudson</div><div class="date">1st March 2004, 18:11</div></div><div class="posttext">I posted 3 files here:<br />
http://kuanyin.orcasinc.com/~rob/<br />
<br />
The test.nsi is the script.  The Test.exe is the result of that script.  The MPSetup.exe is the 2nd installer that gets called (and is included in Test.exe).<br />
<br />
Thanks for the help!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">treborhudson</div><div class="date">2nd March 2004, 00:06</div></div><div class="posttext">Ignore my last few posts... it's the cause of an ID-10-T error.<br />
<br />
For some reason my system was in a weird state and after following the instructions of the WMP installer by rebooting, everything is fine.  Even launching the WMP installer from within my installer no longer shows the error.<br />
<br />
Thanks for the help.  Time to slap my forehead now.  :|</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>