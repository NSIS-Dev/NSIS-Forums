<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Possible for NSIS to install Visual C++ packages?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Possible for NSIS to install Visual C++ packages? NSIS Discussion" />
	
	<title> Possible for NSIS to install Visual C++ packages? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Possible for NSIS to install Visual C++ packages?</div>
<hr />
<div class="pda"><a href="t-367574.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=367574">Possible for NSIS to install Visual C++ packages?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">wrybread</div><div class="date">29th July 2013, 20:25</div></div><div class="posttext">I'd like to install the Visual C++ 2010 Redistributable from an NSIS installer. Is that possible?<br />
<br />
I've seen many other installers do this, but I don't think I've seen an NSIS package do it.<br />
<br />
FYI, this is the VC++ package I'm referring to:<br />
<br />
http://www.microsoft.com/en-us/download/details.aspx?id=5555<br />
<br />
Thanks for any tips.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nawfal</div><div class="date">30th July 2013, 07:09</div></div><div class="posttext">Can't you bundle the redistributable yourself in the installer, copy it to some temp location, and then run the exe from there? Or do you want it all silently? Or do you want nsis to check for redistributable itself in the machine, and download from the internet if not installed?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wrybread</div><div class="date">30th July 2013, 20:40</div></div><div class="posttext">Thanks for the reply.<br />
<br />
Ideally I'd like to check for the presence of VC2010 and install it if necessary. No need to download it, I can package it with my installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nawfal</div><div class="date">31st July 2013, 00:02</div></div><div class="posttext">You can check registry. See this link http://blogs.msdn.com/b/astebner/archive/2010/05/05/10008146.aspx<br />
<br />
Something like: <br />
<br />
!include x64.nsh<br />
<br />
<br />
<br />
${If} ${RunningX64}<br />
	ReadRegStr $1 HKLM &quot;SOFTWARE\Microsoft\VisualStudio\10.0\VC\VCRedist\x64&quot; &quot;Installed&quot;<br />
	StrCmp $1 1 installed<br />
${Else}<br />
	ReadRegStr $1 HKLM &quot;SOFTWARE\Microsoft\VisualStudio\10.0\VC\VCRedist\x86&quot; &quot;Installed&quot;<br />
	StrCmp $1 1 installed<br />
${EndIf}<br />
<br />
;not installed, so run the installer<br />
ExecWait 'MyPathWhereInstallerIs\vc++2010setup.exe'<br />
<br />
installed:<br />
;we are done<br />
<br />
You could use the logic If in LogicLib to do the conditional check to make code look better.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wrybread</div><div class="date">1st August 2013, 05:30</div></div><div class="posttext">Thanks hugely, works beautifully.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>