<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" CreateShortCut issue, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  CreateShortCut issue NSIS Discussion" />
	
	<title> CreateShortCut issue [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  CreateShortCut issue</div>
<hr />
<div class="pda"><a href="t-203892.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=203892">CreateShortCut issue</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Artmageddon</div><div class="date">4th January 2005, 20:08</div></div><div class="posttext">Hey, I'm having a bit of a hard time using CreateShortcut with an app of mine. Basically, I'm installing a set of programs, each with their own folder, and each of those folders will be in a main folder(which will, in turn, be in the program files folder). Basically, an example of this would be:<br />
<br />
C:\Program Files\AllGames\GameSet1\GameA<br />
C:\Program Files\AllGames\GameSet1\GameB<br />
C:\Program Files\AllGames\GameSet2\...<br />
and so on.<br />
<br />
What I'm doing here is that I'm giving the user the default path of installing to:<br />
C:\Program Files\AllGames\GameSet1<br />
(since other sets will be handled by other installers),<br />
and here, two separate subfolders will be placed in GameSet1, aptly named GameA and GameB. $INSTDIR has been set to this path.<br />
<br />
The problem I'm having is with the Start In not matching up with the folder in the target. One of the games I'm installing is very particular about the way the shortcut defines where the .exe is and where it's supposed to look(otherwise it doesn't work). We have a 3rd-party system that wrapped our software with some special stuff, so it makes things a little hairy(though I know it's not the cause of the problem). Basically, what's happening is that the 3rd-party's page loads, so it's finding the .exe through some special windows trick or another, but the actual game won't load since the .exe isn't found in the start in folder. <br />
<br />
The .exe is in<br />
C:\Program Files\MyGames\GameSet1\GameA\, and the start in folder is:<br />
<br />
C:\Program Files\MyGames\<br />
<br />
How do I make these two match? I'm already using:<br />
CreateShortCut &quot;$R5\$R1.lnk&quot; &quot;$INSTDIR\GameA\RocketBowl.exe&quot;  &quot;&quot; &quot;$INSTDIR\GameA\RocketBowl.exe&quot;, where $R5 is the desktop path, $R1 is the text caption for the icon.<br />
<br />
This issue applies to the start menu shortcuts, too.<br />
<br />
Please help, so confused :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th January 2005, 20:11</div></div><div class="posttext">SetOutPath sets the working directory of the shortcut.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Artmageddon</div><div class="date">4th January 2005, 20:14</div></div><div class="posttext">So I just do something like:<br />
SetOutPath &quot;C:\Program...&lt;exe target&gt;&quot;, and then do the CreateShortCut?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th January 2005, 20:16</div></div><div class="posttext">Yes, you use SetOutPath with the desired working directory and then CreateShortcut.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Artmageddon</div><div class="date">4th January 2005, 20:17</div></div><div class="posttext">oh Thank God, I finally got it. <br />
<br />
And thank you of course...I've been stuck on this for an embarrassing amount of time :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">4th January 2005, 21:43</div></div><div class="posttext">Does it mention in the manual that SetOutPath sets current 'start in' path for CreateShortcut's?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">5th January 2005, 12:00</div></div><div class="posttext">Yes. <br />
<br />
From the Docs:<br />
$OUTDIR is used for the working directory. You can change it by using SetOutPath before creating the Shortcut.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">5th January 2005, 12:34</div></div><div class="posttext">Whoops, wrong topic!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>