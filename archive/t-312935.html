<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" UAC plug-in EM: install function &quot;ExecAppFile&quot; not referenced, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  UAC plug-in EM: install function &quot;ExecAppFile&quot; not referenced NSIS Discussion" />
	
	<title> UAC plug-in EM: install function &quot;ExecAppFile&quot; not referenced [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  UAC plug-in EM: install function &quot;ExecAppFile&quot; not referenced</div>
<hr />
<div class="pda"><a href="t-312935.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=312935">UAC plug-in EM: install function &quot;ExecAppFile&quot; not referenced</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kripplet</div><div class="date">24th September 2009, 13:10</div></div><div class="posttext">Hi everyone,<br />
<br />
When I try using the UAC plug-in (http://nsis.sourceforge.net/UAC_plug-in) inside a MUI skinned installer, I get following EM:<br />
install function &quot;ExecAppFile&quot; not referenced - zeroing code (1533-1542) out.<br />
<br />
I put the dll's and nsh files under the correct locations.<br />
I stated &quot;RequestExecutionLevel user&quot; at the top of my nsi.<br />
I included UAC.nsh.<br />
<br />
Anyone has ideas on why this can happen?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">24th September 2009, 13:49</div></div><div class="posttext">It's not an error, it's a compiler warning. Apparently there's a function called ExecAppFile that is never called. This function doesn't exist in UAC.nsh, so I doubt it is related to the UAC plugin. The problem is probably in your own code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kripplet</div><div class="date">24th September 2009, 13:57</div></div><div class="posttext">If you read the documentation on the UAC plug-in wikipage, then there it says to use this to run an application after the installer has finished:<br />
<br />
!define MUI_FINISHPAGE_RUN<br />
!define MUI_FINISHPAGE_RUN_FUNCTION ExecAppFile<br />
 <br />
Function ExecAppFile<br />
    UAC::Exec '' '&quot;$INSTDIR\${APPFILE}&quot;' '' ''<br />
FunctionEnd<br />
<br />
That is why I use &quot;ExecAppFile&quot;. It is indeed no function of UAC, but of UMUI.<br />
<br />
And you're also correct that it isn't a EM but a warning. But it also says that it is zeroing out the code, which results in an installer which doesn't start up anything after it is finished.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">24th September 2009, 14:35</div></div><div class="posttext">this has nothing to do with the uac plugin. Maybe  MUI_FINISHPAGE_RUN_FUNCTION is not the correct define for UMUI</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kripplet</div><div class="date">24th September 2009, 14:49</div></div><div class="posttext">Yes, sorry I mentioned it as UAC EM, it indeed is not. I just wanted to add UAC in the title of this topic.<br />
<br />
But MUI_FINISHPAGE_RUN_FUNCTION is defined correctly for UMUI. That is, I can find it back in the UMUI.nsh file. And there it looks exact the same as in how it is defined inside MUI.nsh.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kripplet</div><div class="date">25th September 2009, 10:54</div></div><div class="posttext">Ok guys,<br />
<br />
I stopped using the MUI_FINISHPAGE_RUN_FUNCTION and used the function UMUI_CUSTOMFUNCTION_GUIEND instead. This worked. Thanks.<br />
<br />
But now I have another question, I assume that this is an UAC issue, or more likely me using the syntax incorrectly. When I try to install a service trough UAC::Exec, nothing happens on Vista, whilest the service gets installed correctly on XP.<br />
<br />
This is what I try to use:<br />
<br />
UAC::Exec &quot;&quot; &quot;$INSTDIR\Uploadservice.exe -install&quot; &quot;&quot; &quot;&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">25th September 2009, 11:05</div></div><div class="posttext">UAC::Exec &quot;&quot; &quot;$INSTDIR\Uploadservice.exe&quot; &quot;-install&quot; &quot;&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kripplet</div><div class="date">25th September 2009, 12:01</div></div><div class="posttext">Sorry to say, but that gives exact the same result. Works in XP, but does nothing in Vista.<br />
<br />
I do see that in Vista (and XP as well) during the install a cmd-screen pops up titled &quot;C:\Program Files\uploadservice\Uploadservice.exe&quot; and immediately shuts down again. Is there a way that I can prevent this cmd-screen from shutting down, so I can actually see what it tries to do and maybe the error it is giving?<br />
<br />
Thanks for the help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">25th September 2009, 12:19</div></div><div class="posttext">well, first off, are you sure this service can be installed as non admin?<br />
<br />
as far as stopping goes, try<br />
UAC::Exec &quot;&quot; &quot;cmd.exe&quot; '/k &quot;$INSTDIR\Uploadservice.exe&quot; -install' &quot;&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kripplet</div><div class="date">25th September 2009, 14:41</div></div><div class="posttext">No, that just opened up an empty command prompt with no title. <br />
<br />
But no problem, I found out that I called the UAC::Exec at a wrong location inside my code, that is why it didn't ran correctly.<br />
<br />
So all my issues are gone. My installer works now!<br />
<br />
Thanks for all the help Anders.<br />
You made a great plug-in, thanks for that as well!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>