<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Possible bug in GetServerName macro., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Possible bug in GetServerName macro. NSIS Discussion" />
	
	<title> Possible bug in GetServerName macro. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Possible bug in GetServerName macro.</div>
<hr />
<div class="pda"><a href="t-257351.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257351">Possible bug in GetServerName macro.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">banksr0</div><div class="date">11th October 2006, 15:27</div></div><div class="posttext">I was trying out the GetServerName macro found here (http://nsis.sourceforge.net/User_Management_using_API_calls#Get_Server_Name) and I think it might be bugged on Windows 98. <br />
It uses the GetComputerNameW to support older operating systems. However, GetComputerNameW is not implemented in 9x/ME and will not work without the support of something like MSLU (http://www.microsoft.com/globaldev/handson/dev/mslu_announce.mspx).<br />
<br />
Therefore, I was thinking that the ANSI GetComputerNameA should be used instead of the Unicode GetComputerNameW. <br />
<br />
Can anyone confirm that my understanding of this is correct, or am I missing something? <br />
<br />
If I am right, would it be appropriate if I updated the wiki appropriately?<br />
<br />
Many thanks :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">11th October 2006, 20:36</div></div><div class="posttext">yeah use the A version</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CancerFace</div><div class="date">11th October 2006, 22:23</div></div><div class="posttext">The GetComputerName API call was added in order to provide support for NT4 and not 9x/ME. Besides, the Netapi32 calls used on that Wiki page are not available in 9x/ME ;) <br />
CF</div></div><hr />


<div class="post"><div class="posttop"><div class="username">banksr0</div><div class="date">12th October 2006, 10:50</div></div><div class="posttext">CancerFace:<br />
<br />
The function could perhaps be implemented in the following way, to ensure it works on all the systems it used to work on, and works on 9x too.<br />
<br />
Currently it is:<br />
sName = GetComputerNameExW // For XP, 2003, etc.<br />
If sName = &quot;&quot;<br />
   sName = GetComputerNameW // For NT (4?)<br />
<br />
It could be changed to<br />
sName = GetComputerNameExW // For XP, 2003, etc.<br />
If sName = &quot;&quot;<br />
   sName = GetComputerNameW // For NT (4?)<br />
   If sName = &quot;&quot;<br />
      sName = GetComputerNameA // For 9x.<br />
<br />
This won't change existing functionality, but will allow 9x machines to use the correct API call (as neither of the 2 previous calls are implemented on 9x machines).<br />
<br />
How does that sound?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CancerFace</div><div class="date">12th October 2006, 11:09</div></div><div class="posttext">@banksr0<br />
There is no arguement about what you propose since the macro on the Wiki (http://nsis.sourceforge.net/User_Management_using_API_calls#Get_Server_Name) does not work on 9x/ME machines.<br />
<br />
However my point was that the above Wiki page describes user management functions that do not exist in 9x/ME and as such I don't see a point in updating the code on that page.<br />
<br />
If you really think that there should be some information on the Wiki about getting the computer name in a 9x/ME system, using API calls, then I suggest to look into this (http://nsis.sourceforge.net/Your_Computer_Name) page and add a similar macro/function there.<br />
CF</div></div><hr />


<div class="post"><div class="posttop"><div class="username">banksr0</div><div class="date">12th October 2006, 11:25</div></div><div class="posttext">Ahhhh!!! Sorry - I completely misunderstood you! I see your point and completely agree with it. I hadn't really thought about what the purpose of the page as a whole was, as I wasn't doing any user-management stuff. <br />
<br />
Thanks for the pointer - I'll look into the other page :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>