<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Is it unloading the files or what?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Is it unloading the files or what? NSIS Discussion" />
	
	<title> Is it unloading the files or what? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Is it unloading the files or what?</div>
<hr />
<div class="pda"><a href="t-294609.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=294609">Is it unloading the files or what?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">shanetracer</div><div class="date">16th July 2008, 11:02</div></div><div class="posttext">I found this code on the internet and have been trying to get it to work: <br />
<br />
## Sections Group 1<br />
SectionGroup /e &quot;Program #1&quot; PROG1<br />
Section &quot;Main&quot; SEC1<br />
 ##All the files in Group 1 will be installed to the same location, $INSTDIR<br />
 SetOutPath &quot;$INSTDIR&quot;<br />
 ## Main files to install here<br />
<br />
messagebox mb_ok sec1<br />
<br />
SectionEnd<br />
<br />
Section &quot;Other&quot; SEC2<br />
 ## Other files to install here<br />
<br />
messagebox mb_ok sec2<br />
<br />
SectionEnd<br />
<br />
SectionGroupEnd<br />
<br />
## Sections Group 2<br />
SectionGroup /e &quot;Program #2&quot; PROG2<br />
<br />
Section &quot;Main&quot; SEC3<br />
 ##All the files in Group 2 will be installed to the same location, $INSTDIR<br />
 SetOutPath &quot;$INSTDIR&quot;<br />
 ## Main files to install here<br />
<br />
messagebox mb_ok sec3<br />
<br />
SectionEnd<br />
<br />
Section &quot;Other&quot; SEC4<br />
 ## Other files to install here<br />
<br />
messagebox mb_ok sec4<br />
<br />
SectionEnd<br />
<br />
SectionGroupEnd<br />
<br />
##===========================================================================<br />
## Settings<br />
##===========================================================================<br />
<br />
!define PROG1_InstDir    &quot;C:\PROG1&quot;<br />
!define PROG1_StartIndex ${PROG1}<br />
!define PROG1_EndIndex   ${SEC2}<br />
<br />
!define PROG2_InstDir &quot;C:\PROG2&quot;<br />
!define PROG2_StartIndex ${PROG2}<br />
!define PROG2_EndIndex   ${SEC4}<br />
<br />
##===========================================================================<br />
## Please don't modify below here unless you're a NSIS 'wiz-kid'<br />
##===========================================================================<br />
<br />
## Create $PLUGINSDIR<br />
Function .onInit<br />
 InitPluginsDir<br />
FunctionEnd<br />
<br />
## If user goes back to this page from 1st Directory page<br />
## we need to put the sections back to how they were before<br />
Var IfBack<br />
Function SelectFilesCheck<br />
 StrCmp $IfBack 1 0 NoCheck<br />
  Call ResetFiles<br />
 NoCheck:<br />
FunctionEnd<br />
<br />
## Also if no sections are selected, warn the user!<br />
Function ComponentsLeave<br />
Push $R0<br />
Push $R1<br />
<br />
 Call IsPROG1Selected<br />
  Pop $R0<br />
 Call IsPROG2Selected<br />
  Pop $R1<br />
 StrCmp $R0 1 End<br />
 StrCmp $R1 1 End<br />
  Pop $R1<br />
  Pop $R0<br />
 MessageBox MB_OK|MB_ICONEXCLAMATION &quot;$(NoSectionsSelected)&quot;<br />
 Abort<br />
<br />
End:<br />
Pop $R1<br />
Pop $R0<br />
FunctionEnd<br />
<br />
Function IsPROG1Selected<br />
Push $R0<br />
Push $R1<br />
<br />
 StrCpy $R0 ${PROG1_StartIndex} # Group 1 start<br />
<br />
  Loop:<br />
   IntOp $R0 $R0 + 1<br />
   SectionGetFlags $R0 $R1			# Get section flags<br />
    IntOp $R1 $R1 &amp; ${SF_SELECTED}<br />
    StrCmp $R1 ${SF_SELECTED} 0 +3		# If section is selected, done<br />
     StrCpy $R0 1<br />
     Goto Done<br />
    StrCmp $R0 ${PROG1_EndIndex} 0 Loop<br />
<br />
 Done:<br />
Pop $R1<br />
Exch $R0<br />
FunctionEnd<br />
<br />
Function IsPROG2Selected<br />
Push $R0<br />
Push $R1<br />
<br />
 StrCpy $R0 ${PROG2_StartIndex}    # Group 2 start<br />
<br />
  Loop:<br />
   IntOp $R0 $R0 + 1<br />
   SectionGetFlags $R0 $R1			# Get section flags<br />
    IntOp $R1 $R1 &amp; ${SF_SELECTED}<br />
    StrCmp $R1 ${SF_SELECTED} 0 +3		# If section is selected, done<br />
     StrCpy $R0 1<br />
     Goto Done<br />
    StrCmp $R0 ${PROG2_EndIndex} 0 Loop<br />
<br />
 Done:<br />
Pop $R1<br />
Exch $R0<br />
FunctionEnd<br />
<br />
## Here we are selecting first sections to install<br />
## by unselecting all the others!<br />
Function SelectFilesA<br />
<br />
 # If user clicks Back now, we will know to reselect Group 2's sections for<br />
 # Components page<br />
 StrCpy $IfBack 1<br />
<br />
 # We need to save the state of the Group 2 Sections<br />
 # for the next InstFiles page<br />
Push $R0<br />
Push $R1<br />
<br />
 StrCpy $R0 ${PROG2_StartIndex} # Group 2 start<br />
<br />
  Loop:<br />
   IntOp $R0 $R0 + 1<br />
   SectionGetFlags $R0 $R1				    # Get section flags<br />
    WriteINIStr &quot;$PLUGINSDIR\sections.ini&quot; Sections $R0 $R1 # Save state<br />
    !insertmacro UnselectSection $R0			    # Then unselect it<br />
    StrCmp $R0 ${PROG2_EndIndex} 0 Loop<br />
<br />
 # Don't install prog 1?<br />
 Call IsPROG1Selected<br />
 Pop $R0<br />
 StrCmp $R0 1 +4<br />
  Pop $R1<br />
  Pop $R0<br />
  Abort<br />
<br />
 # Set current $INSTDIR to PROG1_InstDir define<br />
 StrCpy $INSTDIR &quot;${PROG1_InstDir}&quot;<br />
<br />
Pop $R1<br />
Pop $R0<br />
FunctionEnd<br />
<br />
## Here we need to unselect all Group 1 sections<br />
## and then re-select those in Group 2 (that the user had selected on<br />
## Components page)<br />
Function SelectFilesB<br />
Push $R0<br />
Push $R1<br />
<br />
 StrCpy $R0 ${PROG1_StartIndex}    # Group 1 start<br />
<br />
  Loop:<br />
   IntOp $R0 $R0 + 1<br />
    !insertmacro UnselectSection $R0		# Unselect it<br />
    StrCmp $R0 ${PROG1_EndIndex} 0 Loop<br />
<br />
 Call ResetFiles<br />
<br />
 # Don't install prog 2?<br />
 Call IsPROG2Selected<br />
 Pop $R0<br />
 StrCmp $R0 1 +4<br />
  Pop $R1<br />
  Pop $R0<br />
  Abort<br />
<br />
 # Set current $INSTDIR to PROG2_InstDir define<br />
 StrCpy $INSTDIR &quot;${PROG2_InstDir}&quot;<br />
<br />
Pop $R1<br />
Pop $R0<br />
FunctionEnd<br />
<br />
## This will set all sections to how they were on the components page<br />
## originally<br />
Function ResetFiles<br />
Push $R0<br />
Push $R1<br />
<br />
 StrCpy $R0 ${PROG2_StartIndex}    # Group 2 start<br />
<br />
  Loop:<br />
   IntOp $R0 $R0 + 1<br />
   ReadINIStr &quot;$R1&quot; &quot;$PLUGINSDIR\sections.ini&quot; Sections $R0 # Get sec flags<br />
    SectionSetFlags $R0 $R1				  # Re-set flags for this sec<br />
    StrCmp $R0 ${PROG2_EndIndex} 0 Loop<br />
<br />
Pop $R1<br />
Pop $R0<br />
FunctionEnd<br />
<br />
## Here we are deleting the temp INI file at the end of installation<br />
Function DeleteSectionsINI<br />
 Delete &quot;$PLUGINSDIR\Sections.ini&quot;<br />
 FlushINI &quot;$PLUGINSDIR\Sections.ini&quot;<br />
FunctionEnd<br />
<br />
Whenever I add more than two sections to sectiongroup 2 and don't select group 1 in the setup itself, it does not jump to sectiongroup 2 without displaying some sort of status bar. It looks like it's installing the components of sectiongroup 1. How do I get rid of this step?<br />
<br />
Cheers<br />
<br />
Rich</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">16th July 2008, 11:11</div></div><div class="posttext">How do we get rid of reading such a huge posts?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shanetracer</div><div class="date">16th July 2008, 12:09</div></div><div class="posttext">Anything smart to say or just moaning?<br />
<br />
Originally posted by pospec <br />
How do we get rid of reading such a huge posts?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>