<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Make installer topmost window., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Make installer topmost window. NSIS Discussion" />
	
	<title> Make installer topmost window. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Make installer topmost window.</div>
<hr />
<div class="pda"><a href="t-287202.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=287202">Make installer topmost window.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">NEHOG</div><div class="date">19th February 2008, 17:19</div></div><div class="posttext">The 'powers at be' asked that we make the installer a topmost window (in windows one would use the API) :<br />
<br />
   SetWindowPos Me.hwnd, HWND_TOPMOST, 0, 0, 0, 0, SWP_NOSIZE Or SWP_NOMOVE <br />
<br />
This keeps the application (the installer in this case) always on top of other windows (like TaskManager...) so it won't get lost. (I think marketing feels that users are loosing the installer for some reason...) <br />
<br />
Search didn't really get me anything, so if anyone has suggestions... <br />
;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th February 2008, 17:32</div></div><div class="posttext">Use System plug-in.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NEHOG</div><div class="date">20th February 2008, 20:42</div></div><div class="posttext">Originally posted by Afrow UK <br />
Use System plug-in.<br />
<br />
Stu  <br />
<br />
Thanks Stu. For others later looking at this thread, here is the final result:<br />
<br />
<br />
!include &quot;${NSISDIR}\Examples\System\System.nsh&quot;<br />
# --- Define and make accessible the system plugin.<br />
# before 2.07 !include &quot;${NSISDIR}\Contrib\System\System.nsh&quot;<br />
<br />
# --- The function to force a window to be topmost. <br />
<br />
Function WindowToTop<br />
	;Save existing register values to the stack<br />
	Push $0<br />
	Push $1<br />
	Push $2<br />
	Push $3<br />
	Push $4<br />
	Push $5<br />
	Push $6<br />
	Push $7<br />
<br />
;	HWND_TOPMOST not defined in the system plugin, so we define it here instead.  <br />
	!define HWND_TOPMOST   -1<br />
  <br />
;       SetWindowPos(Me.hwnd, HWND_TOPMOST, 0, 0, 0, 0, SWP_NOSIZE Or SWP_NOMOVE) 'These two lines bring the window<br />
<br />
	System::Call &quot;User32::SetWindowPos(i, i, i, i, i, i, i) b ($HWNDPARENT, ${HWND_TOPMOST}, 0, 0, 0, 0, ${SWP_NOMOVE}|${SWP_NOSIZE})&quot;<br />
 <br />
	;Restore register values from the stack<br />
	Pop $7<br />
	Pop $6<br />
	Pop $5<br />
	Pop $4<br />
	Pop $3<br />
	Pop $2<br />
	Pop $1<br />
	Pop $0<br />
FunctionEnd<br />
<br />
<br />
<br />
The WindowToTop function then can be called from within the NSIS script as needed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">20th February 2008, 21:56</div></div><div class="posttext">you don't have to save the registers if you are not using any of them ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NEHOG</div><div class="date">21st February 2008, 01:47</div></div><div class="posttext">Good point... (Teach me to cut-n-paste!)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>