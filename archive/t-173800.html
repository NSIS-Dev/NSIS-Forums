<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with OS seeing PATH change, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with OS seeing PATH change NSIS Discussion" />
	
	<title> Problem with OS seeing PATH change [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with OS seeing PATH change</div>
<hr />
<div class="pda"><a href="t-173800.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=173800">Problem with OS seeing PATH change</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">justjer</div><div class="date">18th March 2004, 05:20</div></div><div class="posttext">I'm having a problem where Windows 2000 does not recognize a path change when I'm using the typical path manipulation scripts in the archive or when using pathman.exe. Both make the call to the OS to refresh its environment, but when my script executes something that should be in the path it fails.<br />
<br />
I'm wondering if, when setting the path within a function, the section that calls the function does not see the new environment/path.<br />
<br />
My code looks something like this<br />
<br />
SubSection Splat<br />
<br />
  Section Woo<br />
    Call InstPerl<br />
    nsExec::ExecToLog 'Perl &quot;$EXEDIR\Scripts\AutoInst.pl&quot;'<br />
  SectionEnd<br />
<br />
  Section Hoo<br />
    blah blah...<br />
  SectionEnd<br />
<br />
SubSectionEnd<br />
<br />
Function InstPerl<br />
  ExecWait 'msiexec.exe /i &quot;$EXEDIR\ActivePerl.msi&quot; /l*v C:\SUlogs\Perl.log /qb'<br />
  Push &quot;C:\Perl\Bin&quot;<br />
  Call AddToPath  ; Same as Path Manip scripts in NSIS Archive<br />
  ;Alternatively, I've tried the following<br />
  ;nsExec::ExecToLog '&quot;$EXEDIR\UTILS\pathman&quot; /as &quot;C:\Perl\Bin&quot;'<br />
FunctionEnd<br />
<br />
<br />
Thanks in advance to anyone who can shed some light on this. =)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">18th March 2004, 14:31</div></div><div class="posttext">Did you reboot your system?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th March 2004, 17:42</div></div><div class="posttext">Use this one instead:<br />
<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=161<br />
<br />
Make sure you call it before you execute that application.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">justjer</div><div class="date">19th March 2004, 04:22</div></div><div class="posttext">setenv.dll did not work<br />
<br />
I need this to work without rebooting the system. My issue is the the line &quot;nsExec::ExecToLog 'Perl &quot;$EXEDIR\Scripts\AutoInst.pl&quot;'&quot; will not execute unless C:\Perl\Bin is in the path. I know I can work around this in several ways, but I need the path to work while the installer is running.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th March 2004, 13:00</div></div><div class="posttext">SetEnv.dll works fine for me. For example:ReadEnvStr $R0 &quot;PATH&quot; <br />
StrCpy $R0 &quot;$R0;F:\Perl\Bin&quot; <br />
SetEnv::SetEnvVar &quot;PATH&quot; $R0<br />
nsExec::ExecToLog `perl.exe -e &quot;print 'hello world';&quot;`<br />
Pop $0 # return value/error/timeout<br />
DetailPrint &quot;&quot;<br />
DetailPrint &quot;       Return value: $0&quot;<br />
DetailPrint &quot;&quot;Attach your complete script for testing.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>