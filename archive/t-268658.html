<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Error Building NSIS on HP-UX, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Error Building NSIS on HP-UX NSIS Discussion" />
	
	<title> Error Building NSIS on HP-UX [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Error Building NSIS on HP-UX</div>
<hr />
<div class="pda"><a href="t-268658.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=268658">Error Building NSIS on HP-UX</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">tresemi</div><div class="date">30th March 2007, 18:41</div></div><div class="posttext">Hi,<br />
<br />
I'm trying to build NSIS on HP-UX environment.<br />
I have installed Python-2.5, scons-0.96.95 and trying to install nsis-2.24.<br />
<br />
I tried to install using: <br />
scons SKIPSTUBS=all SKIPPLUGINS=all SKIPUTILS=all SKIPMISC=all NSIS_CONFIG_CONST_DATA_PATH=no PREFIX=/tmp install-compiler<br />
<br />
and that's the log:<br />
<br />
<br />
root@itacare:/home/zembrzus/nsis/NSIS# scons SKIPSTUBS=all SKIPPLUGINS=all SKIPUTILS=all SKIPMISC=all NSIS_CONFIG_CONST_DATA_PATH=no PREFIX=/tmp&gt;<br />
scons: Reading SConscript files ...<br />
Delete(&quot;nsis-30-Mar-2007.cvs&quot;)<br />
Delete(&quot;.instdist&quot;)<br />
Delete(&quot;.test&quot;)<br />
Using GNU tools configuration<br />
Checking for linker flag -m32... (cached) yes<br />
Checking for compiler flag -m32... (cached) no<br />
Checking for linker flag $MAP_FLAG... (cached) no<br />
Checking for linker flag -s... (cached) yes<br />
Checking for linker flag $MAP_FLAG... (cached) no<br />
Checking for linker flag -s... (cached) yes<br />
Checking for memcpy requirement... (cached) yes<br />
Checking for memset requirement... (cached) yes<br />
Checking for linker flag -pthread... (cached) yes<br />
Checking for __BIG_ENDIAN__... (cached) no<br />
Checking for C library gdi32... (cached) no<br />
Checking for C library user32... (cached) no<br />
Checking for C library pthread... (cached) yes<br />
Checking for C library stdc++... (cached) yes<br />
Checking for C library iconv... (cached) no<br />
Checking for C library dl... (cached) yes<br />
Checking for C library gdi32... (cached) no<br />
Checking for C library iconv... (cached) no<br />
Checking for C library pthread... (cached) yes<br />
Checking for C library user32... (cached) no<br />
Checking for C++ library cppunit... (cached) no<br />
scons: done reading SConscript files.<br />
scons: Building targets ...<br />
g++ -o build/release/makensis/makensis -m32 -s -pthread build/release/makensis/build.o build/release/makensis/clzma.o build/release/makensis/crc32.o build/release/makensis/DialogTemplate.o build/release/makensis/dirreader.o build/release/makensis/fileform.o build/release/makensis/growbuf.o build/release/makensis/lang.o build/release/makensis/lineparse.o build/release/makensis/makenssi.o build/release/makensis/manifest.o build/release/makensis/mmap.o build/release/makensis/Plugins.o build/release/makensis/ResourceEditor.o build/release/makensis/ResourceVersionInfo.o build/release/makensis/script.o build/release/makensis/ShConstants.o build/release/makensis/strlist.o build/release/makensis/tokens.o build/release/makensis/util.o build/release/makensis/winchar.o build/release/makensis/writer.o build/release/makensis/bzip2/blocksort.o build/release/makensis/bzip2/bzlib.o build/release/makensis/bzip2/compress.o build/release/makensis/bzip2/huffman.o build/release/makensis/7zip/7zGuids.o build/release/makensis/7zip/7zip/Common/OutBuffer.o build/release/makensis/7zip/7zip/Common/StreamUtils.o build/release/makensis/7zip/7zip/Compress/LZ/LZInWindow.o build/release/makensis/7zip/7zip/Compress/LZMA/LZMAEncoder.o build/release/makensis/7zip/7zip/Compress/RangeCoder/RangeCoderBit.o build/release/makensis/7zip/Common/Alloc.o build/release/makensis/7zip/Common/CRC.o build/release/makensis/zlib/deflate.o build/release/makensis/zlib/trees.o -Lbuild/release/makensis -LSource -lpthread -lstdc++<br />
ld: Unsatisfied symbol &quot;libiconv_open&quot; in file build/release/makensis/util.o<br />
ld: Unsatisfied symbol &quot;libiconv_close&quot; in file build/release/makensis/util.o<br />
ld: Unsatisfied symbol &quot;libiconv&quot; in file build/release/makensis/util.o<br />
3 errors.<br />
collect2: ld returned 1 exit status<br />
scons: *** [build/release/makensis/makensis] Error 1<br />
scons: building terminated because of errors.<br />
<br />
Any toughts ?<br />
<br />
Thanks in advance!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th March 2007, 18:58</div></div><div class="posttext">Delete .sconsign.dblite and add LIBPATH=/usr/lib/where/ever/iconv/is/located to the build line.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st March 2007, 12:58</div></div><div class="posttext">I forgot LIBPATH doesn't actually work. Wait for 2.25 which will be released today and use APPEND_LIBPATH instead.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tresemi</div><div class="date">2nd April 2007, 15:03</div></div><div class="posttext">Ok. It have worked fine to me. Thanks.<br />
<br />
Now I've nsis installed, but I'm getting this error trying to compile the example1.nsi.<br />
<br />
What would be my fault?<br />
<br />
Thanks.<br />
<br />
root@itacare:/home/zembrzus/nsis-2.25# ./makensis Examples/example1.nsi<br />
MakeNSIS v02-Apr-2007.cvs - Copyright 1995-2007 Contributors<br />
See the file COPYING for license details.<br />
Credits can be found in the Users Manual.<br />
<br />
Processing config:<br />
Processing plugin dlls: &quot;/home/zembrzus/nsis-2.25/Plugins/*.dll&quot;<br />
<br />
!define: &quot;MUI_INSERT_NSISCONF&quot;=&quot;&quot;<br />
<br />
Changing directory to: &quot;/home/zembrzus/nsis-2.25/Examples&quot;<br />
<br />
Processing script file: &quot;Examples/example1.nsi&quot;<br />
Name: &quot;Example1&quot;<br />
OutFile: &quot;example1.exe&quot;<br />
InstallDir: &quot;$PROGRAMFILES\Example1&quot;<br />
Page: directory<br />
Page: instfiles<br />
Section: &quot;&quot;<br />
SetOutPath: &quot;$INSTDIR&quot;<br />
File: &quot;example1.nsi&quot; [compress] 378/794 bytes<br />
SectionEnd<br />
<br />
Processed 1 file, writing output:<br />
Processing pages... Done!<br />
Removing unused resources...<br />
Error: Unsupported PE format<br />
Error - aborting creation process</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd April 2007, 15:45</div></div><div class="posttext">Sounds like every executable you extracted got corrupted somehow. Notice it doesn't find any plug-ins either. Try extracting the ZIP again and make sure the DLL files and the files in Stubs have have some normal data in them.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">16th April 2007, 22:50</div></div><div class="posttext">I'm also having the same problem:<br />
<br />
$ uname -a<br />
HP-UX omztdv1 B.11.23 U ia64 2505142627 unlimited-user license<br />
<br />
Does anyone have any luck building AND using NSIS on this platform?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th April 2007, 23:14</div></div><div class="posttext">Seems like big endian support was broken since 2.24. The PE magic wasn't converted to big endian prior to comparison. Use the attached patch to fix this.<br />
<br />
(Or on cvs (http://nsis.cvs.sourceforge.net/nsis/NSIS/Source/Platform.h?r1=1.38&amp;r2=1.39))</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">17th April 2007, 19:45</div></div><div class="posttext">Still not working.  Here is more info, including an attached script you can run to reproduce my results:<br />
<br />
$ uname -a<br />
HP-UX omztdv1 B.11.23 U ia64 2505142627 unlimited-user license<br />
<br />
$ gcc --version<br />
gcc (GCC) 4.1.2<br />
Copyright (C) 2006 Free Software Foundation, Inc.<br />
This is free software; see the source for copying conditions.  There is NO<br />
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.<br />
<br />
$ scons --version<br />
SCons by Steven Knight et al.:<br />
        script: v0.96.96.D001, 2007/04/12 14:12:18, by knight on roxbury<br />
        engine: v0.96.96.D001, 2007/04/12 14:12:18, by knight on roxbury<br />
Copyright (c) 2001, 2002, 2003, 2004, 2005, 2006, 2007 The SCons Foundation</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">17th April 2007, 19:49</div></div><div class="posttext">Here is also the result of running the earlier build script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th April 2007, 20:05</div></div><div class="posttext">That's due to memory alignment problems. There's an open bug report (https://sourceforge.net/tracker/index.php?func=detail&amp;aid=1470826&amp;group_id=22049&amp;atid=373085) regarding this. For now, you can run makensis under WINE.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">17th April 2007, 20:39</div></div><div class="posttext">I'm dubious of wine working at all on hpux ia64, but I'll look into it:  my initial attempt to compile on hpux ia64 failed quickly, and I'm not seeing pre-built binaries in my initial search.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">19th April 2007, 17:23</div></div><div class="posttext">Just thought I'd report back that I've given up on the possibility of makensis on HP-UX B.11.23 ia64.  My skills are not good enough to patch either wine or nsis to make it work.<br />
<br />
But just in case anyone out there can know a patch, I'll post the gdb backtrace here.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">20th April 2007, 00:27</div></div><div class="posttext">Hey, I got it working...after giving up and looking into some other issue, we stumbled across an HP compiler option &quot;+u1&quot; which allows for unaligned access.  Anyone know if there is a corresponding gcc option for this?<br />
<br />
So here is a crude script containing some patches--don't know if they are all really needed.  I know a lot more about GNU autotools than 'scons'.  It seems like it ought to be easier to pass compiler flags/options without patching files to do it, but maybe I'm just missing something.<br />
<br />
Anyway, compiler options that only work with one compiler probably shouldn't be forced on other compilers (-Wall and -m32 come to mind).<br />
<br />
Also the test for big endian appears to get it wrong for HPUX ia64, which is why I force the -D entry for it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th April 2007, 10:03</div></div><div class="posttext">GCC should support -mno-strict-align according to the following message:<br />
<br />
http://gcc.gnu.org/ml/gcc/1999-10n/msg00317.html</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th April 2007, 13:02</div></div><div class="posttext">To add compiler flags or linker flags, you can pass APPEND_CCFLAGS or APPEND_LINKFLAGS in the scons build line.<br />
<br />
-Wall and -m32 aren't forced on any compilers because the file that adds them (SCons/Config/gnu) is specific to gcc.<br />
<br />
The test for big endian is pretty simple. If it failed, it's probably because the environment wasn't properly set when it was ran. To verify, delete .sconsign.dblite and .sconf_temp and run scons again. Then you can see exactly what happens in config.log.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">20th April 2007, 14:17</div></div><div class="posttext">We have 3 compilers on our system:<br />
<br />
(1) hpux ansi c and c++:<br />
<br />
   /usr/bin/cc<br />
   /opt/aCC/bin/aCC<br />
<br />
(2) gcc (I think it was version 3.4) packaged by hp<br />
<br />
   /usr/local/bin/gcc<br />
   /usr/local/bin/c++<br />
<br />
(3) gcc 4.1.2 packaged by hp<br />
<br />
   /opt/hp-gcc/bin/gcc<br />
   /opt/hp-gcc/bin/g++<br />
<br />
When I do no patches, it seems to select /opt/aCC/bin/aCC for c++ and /usr/local/bin/gcc for c (this last bit about gcc I will re-confirm when I get to the office).<br />
<br />
And then &quot;-Wall&quot; is an error to /opt/aCC/bin/aCC.<br />
<br />
I'm using scons 0.96.96.<br />
<br />
I'm willing to learn and help to get any of this nicely fixed (I know not everyone has access to this platform).  Let me know what you would like from me and I can try to provide it (unfortunately I cannot provide direct login access to our hardware).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">20th April 2007, 15:45</div></div><div class="posttext">Re: &quot;(2) gcc (I think it was version 3.4) packaged by hp&quot;<br />
<br />
... the precise version is 3.4.3<br />
<br />
Re: &quot;When I do no patches, it seems to select /opt/aCC/bin/aCC for c++ and /usr/local/bin/gcc for c.&quot;<br />
<br />
... I have re-verified this behavior.<br />
<br />
Thus, the first un-patched error looks like this (notice &quot;Using GNU tools configuration&quot;, how do I get it not to use that, since the aCC compiler became selected?):<br />
<br />
deverly@omztdv1:~/helper-tools/nsis-2.25-src$ scons DEBUG=yes STRIP=no SKIPSTUBS=all SKIPPLUGINS=all SKIPUTILS=all SKIPMISC=all PREFIX_BIN=/opt/vzb/bin PREFIX=/opt/vzb PREFIX_CONF=/etc/opt/vzb APPEND_LINKFLAGS=&quot;-L/usr/local/lib/hpux32&quot; install-compiler<br />
scons: Reading SConscript files ...<br />
Delete(&quot;nsis-20-Apr-2007.cvs&quot;)<br />
Delete(&quot;.instdist&quot;)<br />
Delete(&quot;.test&quot;)<br />
Using GNU tools configuration<br />
Checking for linker flag -m32... yes<br />
Checking for compiler flag -m32... no<br />
Checking for linker flag $MAP_FLAG... no<br />
Checking for linker flag $MAP_FLAG... no<br />
Checking for memcpy requirement... yes<br />
Checking for memset requirement... yes<br />
Checking for linker flag -pthread... yes<br />
Checking for __BIG_ENDIAN__... no<br />
Checking for C library gdi32... no<br />
Checking for C library user32... no<br />
Checking for C library pthread... yes<br />
Checking for C library stdc++... yes<br />
Checking for C library iconv... yes<br />
Checking for C library dl... yes<br />
Checking for C library gdi32... no<br />
Checking for C library iconv... yes<br />
Checking for C library pthread... yes<br />
Checking for C library user32... no<br />
Checking for C++ library cppunit... no<br />
scons: done reading SConscript files.<br />
scons: Building targets ...<br />
/opt/aCC/bin/aCC -o build/debug/makensis/build.o -c -g -Wall -D_WIN32_IE=0x0500 -Ibuild/debug/makensis -ISource Source/build.cpp<br />
aCC: error 1914: bad form for `-W' option<br />
scons: *** [build/debug/makensis/build.o] Error 1<br />
scons: building terminated because of errors.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">20th April 2007, 15:58</div></div><div class="posttext">I've looked at the __BIG_ENDIAN__ test and now see that both flavors of gcc/g++/c++ on my system define __BIG_ENDIAN__, but cc/aCC do not (they define _BIG_ENDIAN instead).<br />
<br />
So the bad test was really a symptom caused by the bad combination of gcc with aCC noted earlier.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">20th April 2007, 16:23</div></div><div class="posttext">Just tested:  both gcc 3.4.3 and 4.1.2 do NOT support -mno-strict-align on hpux ia64:<br />
<br />
error: invalid option `no-strict-align'<br />
<br />
Thus far this means only the HP compilers and their options can be used.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">20th April 2007, 17:01</div></div><div class="posttext">Under nsis 2.25 and HP cc/aCC, there are two compile errors in the unpatched source code:<br />
<br />
/opt/aCC/bin/aCC -o build/debug/makensis/Plugins.o -c -mt +u1 -g -D__BIG_ENDIAN__ -D_WIN32_IE=0x0500 -Ibuild/debug/makensis -ISource Source/Plugins.cpp<br />
&quot;Source/Plugins.cpp&quot;, line 72: error #2350: more than one operator &quot;&gt;=&quot;<br />
          matches these operands:<br />
            built-in operator &quot;arithmetic &gt;= arithmetic&quot;<br />
            function &quot;std::fpos&lt;_StateT&gt;::operator&gt;=(const std::fpos&lt;_StateT&gt;<br />
                      &amp;) const [with _StateT=mbstate_t]&quot;<br />
            function &quot;std::fpos&lt;_StateT&gt;::operator&gt;=(std::streamoff) const<br />
                      [with _StateT=mbstate_t]&quot;<br />
            operand types are: std::basic_ifstream&lt;char,<br />
                      std::char_traits&lt;char&gt;&gt;::pos_type &gt;= int<br />
    assert(result &gt;= 0);<br />
    ^<br />
<br />
1 error detected in the compilation of &quot;Source/Plugins.cpp&quot;.<br />
scons: *** [build/debug/makensis/Plugins.o] Error 2<br />
scons: building terminated because of errors.<br />
<br />
<br />
/opt/aCC/bin/aCC -o build/debug/makensis/ResourceEditor.o -c -mt +u1 -g -D__BIG_ENDIAN__ -D_WIN32_IE=0x0500 -Ibuild/debug/makensis -ISource Source/ResourceEditor.cpp<br />
<br />
&quot;Source/ResourceEditor.cpp&quot;, line 684: error #2308: more than one instance of<br />
          overloaded function &quot;ConvertEndianness&quot; matches the argument list:<br />
            function &quot;ConvertEndianness(DWORD)&quot;<br />
            function &quot;ConvertEndianness(LONG)&quot;<br />
            function &quot;ConvertEndianness(WORD)&quot;<br />
            argument types are: (unsigned long)<br />
      PIMAGE_RESOURCE_DATA_ENTRY(cRDataE-&gt;m_dwWrittenAt)-&gt;OffsetToData = ConvertEndianness(seeker - pbRsrcSec + m_dwResourceSectionVA);<br />
                                                                         ^<br />
<br />
1 error detected in the compilation of &quot;Source/ResourceEditor.cpp&quot;.<br />
scons: *** [build/debug/makensis/ResourceEditor.o] Error 2<br />
scons: building terminated because of errors.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th April 2007, 19:28</div></div><div class="posttext">SCons first tries to use hpcc and hpc++ before it looks for gcc. You can see this logic its source code near the bottom of SCons/Tool/__init__.py. Since it doesn't find hpcc, something must be wrong with SCons/Tool/hpcc.py. Since those tools have a different set of flags and probably issues, a new NSIS build configuration must be created for them. Copy SCons/Config/default to SCons/Config/hpux and modify as needed. For the build system to use it, add the following to SConstruct.elif 'hpcc' in tools:<br />
	envs = SConscript('SCons/Config/hpux') Next come the build errors. I can see three types of errors. Silly conversion issues like that assert line. 0 needs to be converted to pos_type. DWORD conversions that are actually pointer conversions. ptrdiff_t or size_t should be used instead. This includes that ConvertEndianness which has no conversion at all. DWORD not being prolery defined. If DWORD is not 32-bit on ia64 it must be fixed. If DWORD isn't 32-bit, all of the structs definitions are worthless.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">20th April 2007, 20:16</div></div><div class="posttext">Well I've tried the SCons/Config/hpux with patching in the elif 'hpcc' statement, but its still selecting gnu instead.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th April 2007, 20:19</div></div><div class="posttext">The SCons problem needs to be handled first. Because it selects gcc for C code, NSIS build system selects the gnu configuration. For test purpose you can change the elif line just one line above the one you've added.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">20th April 2007, 21:51</div></div><div class="posttext">Originally posted by kichik <br />
The SCons problem needs to be handled first. Because it selects gcc for C code, NSIS build system selects the gnu configuration. For test purpose you can change the elif line just one line above the one you've added.  <br />
<br />
I'm not sure I understand what you mean ... what I think you mean didn't fix it.<br />
<br />
Here is what I have working so far.  It is attached as a build/patch script and the output of it.<br />
<br />
(I know it only patches SConstruction and SCons/Config/gnu, but I'm still clueless on them).<br />
<br />
Interestingly, it builds 5 out of 6 examples under &quot;Examples/Modern UI&quot;.  The one it fails on is MultiLanguage.nsi as follows:<br />
<br />
Removing unused resources... Done!<br />
Generating language tables...<br />
Error while applying NLF font/RTL: Unicode conversion failed<br />
Error - aborting creation process</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th April 2007, 21:59</div></div><div class="posttext">Just above the elif line you've added to the SConstruct file there's an elif line for the gnu configuration. Either put hpux line first or remove the gnu line completely for test purpose. This assumes you already have a configuration file for hpux in SCons/Config, which you don't have. At least according to the patch.<br />
<br />
Unicode conversion usually fails because of a missing codepage. Your iconv probably doesn't support one of the codepages used by the language files. You can have `create_code_page_string` in Source/util.cpp print out the codepages it tries to initialize to find out exactly which one is missing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">21st April 2007, 00:16</div></div><div class="posttext">So I printed 'tools' and here is what came out:<br />
<br />
['default', 'hplink', 'gcc', 'hpc++', 'g77', 'as', <br />
'ar', 'lex', 'm4', 'RCS', 'rpcgen', 'SCCS', 'tar', 'yacc', <br />
'zip'] <br />
<br />
I assumed then that I should have this in SConstruct:<br />
<br />
<br />
print tools<br />
if 'msvc' in tools or 'mstoolkit' in tools:<br />
        envs = SConscript('SCons/Config/ms')<br />
elif 'hpc++' in tools:<br />
        envs = SConscript('SCons/Config/hpux')<br />
elif 'gcc' in tools:<br />
        envs = SConscript('SCons/Config/gnu')<br />
else:<br />
        envs = SConscript('SCons/Config/default')<br />
<br />
<br />
<br />
However, it still tries to use gcc instead of /usr/bin/cc (symlink to /opt/ansic/bin/cc, the HP ANSI C compiler, as installed by HP):<br />
<br />
<br />
<br />
/opt/aCC/bin/aCC -o build/release/makensis/clzma.o -c -mt<br />
  +u1 -D_WIN32_IE=0x0500 Source/clzma.cpp<br />
gcc -o build/release/makensis/crc32.o -c -mt +u1<br />
  -D_WIN32_IE=0x0500 Source/crc32.c<br />
gcc: +u1: No such file or directory<br />
cc1: error: invalid option `t'<br />
scons: *** [build/release/makensis/crc32.o] Error 1<br />
scons: building terminated because of errors.<br />
<br />
<br />
<br />
I know its now picking up the SCons/Config/hpux file, but I'm not sure how that file should be altered, given that scons seems to want gcc for its c compiler.<br />
<br />
(Just FYI, I'll be leaving for the weekend, but can pick this back up on Monday ... thanks for all your help!)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st April 2007, 00:19</div></div><div class="posttext">Using GCC is a SCons issue which should be fixed on the SCons side. See my first bullet in 6 replies above. Loading SCons/Config/hpux only configures flags and such. It's SCons that configures the compiler paths and the default flags and search directories.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">23rd April 2007, 18:03</div></div><div class="posttext">I don't have enough knowledge to know whether there is a scons bug or not, so I posted a message here:<br />
<br />
http://scons.tigris.org/servlets/ReadMsg?list=users&amp;msgNo=10713<br />
<br />
Meanwhile, perhaps we don't have to wait.  I'm attaching another try, following the pattern I think you have suggested.  It is a script with some patches and its output, as well as the output of running the built makensis against the 6 MUI examples.<br />
<br />
The script copies SCons/Config/default to SCons/Config/hpux and then patches SCons/Config/hpux so that the exact changes will be easily seen.<br />
<br />
Here is a summmary of the counted and sorted compiler warnings:<br />
<br />
   1 &quot;Source/build.cpp&quot;, line 488: warning #2068-D: integer conversion resulted in a change of sign<br />
   1 &quot;Source/build.cpp&quot;, line 512: warning #2068-D: integer conversion resulted in a change of sign<br />
   1 &quot;Source/build.cpp&quot;, line 533: warning #2068-D: integer conversion resulted in a change of sign<br />
   1 &quot;Source/script.cpp&quot;, line 2771: warning #2186-D: pointless comparison of unsigned integer with zero<br />
   1 &quot;Source/script.cpp&quot;, line 5838: warning #2111-D: statement is unreachable<br />
   1 &quot;Source/util.cpp&quot;, line 583: warning #2541-D: omission of exception specification is incompatible with previous function &quot;operator new(size_t)&quot; (declared at line 89 of &quot;/opt/aCC/include_std/new&quot;)<br />
   1 &quot;Source/util.cpp&quot;, line 590: warning #2541-D: omission of exception specification is incompatible with previous function &quot;operator delete(void *)&quot; (declared at line 91 of &quot;/opt/aCC/include_std/new&quot;)<br />
   1 &quot;Source/util.cpp&quot;, line 594: warning #2541-D: omission of exception specification is incompatible with previous function &quot;operator delete[](void *)&quot; (declared at line 95 of &quot;/opt/aCC/include_std/new&quot;)<br />
   1 &quot;Source/util.cpp&quot;, line 682: warning #2186-D: pointless comparison of unsigned integer with zero<br />
  12 &quot;Source/ResourceEditor.h&quot;, line 64: warning #3055-D: types cannot be declared in anonymous unions<br />
  12 &quot;Source/ResourceEditor.h&quot;, line 78: warning #3055-D: types cannot be declared in anonymous unions</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">23rd April 2007, 20:59</div></div><div class="posttext">As it turns out, the aCC compiler is all that is needed, since it has this option:<br />
<br />
-Ae        In aC++, invokes aCC as an ANSI-C compiler <br />
<br />
I've found that just because aCC exists doesn't mean /opt/ansic/bin/cc does.  So I've make a small change in the script to allow compiling with just aCC.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th April 2007, 14:29</div></div><div class="posttext">It's definitly a problem with SCons as it doesn't properly find aCC when it's actually there. But the temporary fix should work. However, it should check for the necessity of the change.if 'gcc' in defenv['TOOLS']:<br />
  defenv['CC'] = defenv['CXX'] + ' -Ae' I think it'd be better to check for _BIG_ENDIAN with a configuration test, just like in SCons/Config/gnu. A simple #ifdef can make sure the test program will return 1 in case _BIG_ENDIAN is defined. Currently, your hpux changes the build flags for everything built. It allows you to build makensis but not the rest. I think the best thing here would be to extract most of the mingw stuff from SCons/Config/gnu to SCons/Config/posix and use that in both SCons/Config/gnu and SCons/Config/hpux. This way, everything could be built on HP-UX and there'd be no code duplication. I think some of the flags, like -g, are also common to the two configurations. Let me know if you're up to it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">24th April 2007, 21:26</div></div><div class="posttext">Thanks for the reply.  Here are some thoughts, let me know what you think.<br />
<br />
Originally posted by kichik <br />
 It's definitly a problem with SCons as it doesn't properly find aCC when it's actually there. But the temporary fix should work. However, it should check for the necessity of the change.if 'gcc' in defenv['TOOLS']:<br />
  defenv['CC'] = defenv['CXX'] + ' -Ae'<br />
<br />
 <br />
<br />
As far as I can tell, it does find aCC with no issue.  And on any HPUX system, until there is some unaligned option, gcc/g++ cannot be used to build makensis, so aCC is exactly and only what is needed.<br />
<br />
Given that we are using the scons detection of aCC to drive the process into using SCons/Conf/hpux, it seems correct to say that if we are in  SCons/Conf/hpux, CXX = 'aCC' and thus CC must be 'aCC -Ae', no matter what scons says, even when all scons bugs are fixed.<br />
<br />
 <br />
 I think it'd be better to check for _BIG_ENDIAN with a configuration test, just like in SCons/Config/gnu. A simple #ifdef can make sure the test program will return 1 in case _BIG_ENDIAN is defined.<br />
 <br />
<br />
Hmmm...shouldn't this then be a 'global' test instead of a platform-specific test?<br />
<br />
And if so, then shouldn't the test itself never look to see what the compiler defines, but always provide the 'correct' answer to the question of whether a system was big endian or not, thus avoiding the problem if two different compilers are used, once for CC and one for CXX, that give different #defines automatically?<br />
<br />
 <br />
 Currently, your hpux changes the build flags for everything built. It allows you to build makensis but not the rest. I think the best thing here would be to extract most of the mingw stuff from SCons/Config/gnu to SCons/Config/posix and use that in both SCons/Config/gnu and SCons/Config/hpux. This way, everything could be built on HP-UX and there'd be no code duplication. I think some of the flags, like -g, are also common to the two configurations. Let me know if you're up to it.  <br />
<br />
Yes I was wondering about this last night.  We don't have the option of installing any cross compiler onto these systems so I don't have a way to test cross compilation.<br />
<br />
However, I'm wondering if there wouldn't be an elegant way so that the same mingw cross-compilation environment could be used and then that could be included into the specific hpux or gcc files that are building makensis.<br />
<br />
I'll definitely look at the gcc file to try to emulate that so the makensis compiler options are only used for makensis, but I don't know how to be elegant regarding a cross compilation mingw environment using scons.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th April 2007, 21:34</div></div><div class="posttext">It doesn't find aCC (the C compiler) and that's why it loads gcc. Look in SCons/Tool/__init__.py and you'll see this logic. I also forgot to mention that '-Ae' should go into CCFLAGS and not CC.defenv.Append(CCFLAGS = '-Ae')Regarding _BIG_ENDIAN, I prefer not to run tests that aren't really needed. With Visual C++, this isn't required because we're always building for Win32 and on GCC it's only required sometimes. It'd be semi-global if the split is made from SCons/Config/gnu into SCons/Config/posix.<br />
<br />
Cross compilation environments aren't so elegant in SCons, but already dealt with in the gnu configuration file. There's a function there that converts a given environment to a cross-compile environment.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">25th April 2007, 19:02</div></div><div class="posttext">It seems that anything I add to CCFLAGS also goes to CXX.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th April 2007, 19:52</div></div><div class="posttext">Right, that was recently changed. Use CFLAGS instead (one C only).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">27th April 2007, 00:43</div></div><div class="posttext">Here is the latest incarnation of script/patches.<br />
<br />
I have not addressed the cross-compiler issues, since don't have a cross compiler in this environment so as to test anything I do in this regard.<br />
<br />
And I'm still setting CC = CXX because, even if it finds some other HP c compiler, I only want it to use CXX when building makensis.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th April 2007, 12:51</div></div><div class="posttext">Thanks. Please submit a patch (http://sourceforge.net/tracker/?group_id=22049&amp;atid=373087) and I'll add it after 2.26.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">30th April 2007, 17:08</div></div><div class="posttext">I've not yet submitted a patch, because I'm still confused as to the mindset I should use when thinking about scons changes, specifically relating to selecting compilers and paths ($CC, $CXX, $PATH) on unix environments.<br />
<br />
I'm an avid autotools user (autoconf, automake, libtool), so I tend to start with the idea that $CC, $CXX, $PATH can be determined by the person running the build.<br />
<br />
When I patch nsis to accept my PATH, scons finds all my compilers on hpux ia64, but prefers CC=/opt/ansic/bin/cc and CXX=/opt/aCC/bin/aCC over any of the others.<br />
<br />
On hpux, it is possible that one might have /opt/aCC/bin/aCC, but not /opt/ansic/bin/cc.<br />
<br />
It may also be possible that the hpux user would want to select /opt/hp-gcc/bin/gcc and /opt/hp-gcc/bin/g++ over any of the other installed compilers.<br />
<br />
There are options (http://sourceforge.net/tracker/?func=detail&amp;aid=1470826&amp;group_id=22049&amp;atid=373085) for each of these scenarios which will allow for unaligned access on hpux.<br />
<br />
But currently, it is does not seem possible for the builder to determine PATH, CXX, and CC within nsis.  I'm curious if this is your preference?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th April 2007, 19:14</div></div><div class="posttext">SCons doesn't provide much of a convenient user interface for selecting the compilers used to build. When you build an environment with the default values, it'll load what it thinks is best. Then it'll go on and search additional peripheral tools. It's also possible to pass a list of tools to load instead of this default behavior.<br />
<br />
The tools define far more than just the path of the compiler. They define required flags, available builders, file extensions, etc. Tool definitions are made of code, so they are able to perform complex searches. Take NSIS/SCons/Tools/crossmingw.py for example, which searches for the right compiler.<br />
<br />
Add the Options list only being able to perform on an already existing environment with a loaded set of tools and you get (1) an ugly hack to load specific tools and not the defaults, (2) inability to define just the compiler path and (3) errors about missing builders when using an incomplete list of tools (i.e. no tool for C selected).<br />
<br />
Number 2 has a very good reason and I actually like that about SCons. Number 1 can be solved by using ARGUMENTS, which I forgot about. Number 3 must be handled by the user with a little help from the build scripts that add the tools that are always required - namely `zip`. It can also be solved by adding a tool selection mechanism to SCons which will allow selecting a specific tool for a specific task while allowing tools for other tasks to be automatically detected.<br />
<br />
I've now added the TOOLSET option to SConstruct which allows passing a comma-separated list of tools to load instead of the default. It assumes the user selects a tool for each required task. Instead of directly selecting the C compiler, it asks for a name SCons builder to do the task. Flags can still be added with APPEND_CCFLAGS and APPEND_LINKFLAGS.<br />
<br />
Which of the options work on GCC? Does the unalign lib work on GCC as well?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">30th April 2007, 19:35</div></div><div class="posttext">Originally posted by kichik <br />
Which of the options work on GCC? Does the unalign lib work on GCC as well? <br />
<br />
Compiling with gcc/g++ seems to work fine with the following approach on hpux ia64:<br />
<br />
1.  since there are no headers for allow_unaligned_data_access(), one must define it:<br />
<br />
extern &quot;C&quot; { void allow_unaligned_data_access(); }<br />
<br />
2.  then at the beginning of main():<br />
<br />
allow_unaligned_data_access();<br />
<br />
3a.  finally, on Itanium link:<br />
<br />
-lunalign<br />
<br />
3b.  or on PA-RISC link:<br />
<br />
-lhppa<br />
<br />
But of course, this means there must be some way of knowing you are on these platforms so as to select the correct actions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th April 2007, 19:38</div></div><div class="posttext">SCons uses if env['PLATFORM'] == 'hpux', so that should be good enough.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">30th April 2007, 19:49</div></div><div class="posttext">Originally posted by kichik <br />
SCons uses if env['PLATFORM'] == 'hpux', so that should be good enough.  <br />
<br />
Is there another way that determines whether to use -lunalign or -lhppa?  (note that on Itanium at least, both libraries are installed, because we have emulation capabilities).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th April 2007, 19:52</div></div><div class="posttext">If linking to both on Itanium is ok, both can be checked for and linked against if they exist.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">30th April 2007, 19:58</div></div><div class="posttext">This is the result:<br />
<br />
ld: Can't find library or mismatched ABI for -lhppa<br />
<br />
(In our case, it is the mismatched ABI, since we are compiling for ia64).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th April 2007, 20:03</div></div><div class="posttext">As long as it's an error, it's good enough for the configuration functions which expect nothing bug success before they include a library. See AddAvailableLibs in SCons/utils.py.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">30th April 2007, 20:08</div></div><div class="posttext">Yes, to confirm, both g++ and aCC return an error to the shell when trying to link to the wrong ABI.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">1st May 2007, 18:55</div></div><div class="posttext">Originally posted by kichik <br />
I've now added the TOOLSET option to SConstruct which allows passing a comma-separated list of tools to load instead of the default. It assumes the user selects a tool for each required task. Instead of directly selecting the C compiler, it asks for a name SCons builder to do the task. Flags can still be added with APPEND_CCFLAGS and APPEND_LINKFLAGS.<br />
<br />
I've tried this TOOLSET option, but it isn't working, since the PATH cannot be set, and it doesn't seem to go through any scons logic to search the path.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">1st May 2007, 21:49</div></div><div class="posttext">Here is the latest incarnation of make-nsis.txt script/patch.<br />
<br />
I think the only remaining issue in the patch is that I've incorporated the PATH, so it can find the various tools, since on my HP system they are as follows (and who can predict where others may have installed their tools):<br />
<br />
/opt/aCC/bin/aCC<br />
/opt/ansic/bin/cc<br />
<br />
/opt/hp-gcc/bin/gcc<br />
/opt/hp-gcc/bin/g++<br />
<br />
/usr/local/bin/gcc<br />
/usr/local/bin/c++<br />
<br />
However, I'm open to discovering or being shown other issues :)<br />
<br />
It should work for both gcc/g++ and aCC on both PA-RISC/Itanium on all HP-UX.<br />
<br />
To use g++/gcc instead, change from:<br />
<br />
TOOLSET=hpc++,hpcc,hplink<br />
<br />
to:<br />
<br />
TOOLSET=g++,gcc,gnulink<br />
<br />
Also, be sure your PATH contains all the locations of the tools you plan to use.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">7th May 2007, 16:58</div></div><div class="posttext">Originally posted by kichik <br />
Thanks. Please submit a patch (http://sourceforge.net/tracker/?group_id=22049&amp;atid=373087) and I'll add it after 2.26.  <br />
<br />
Patch #1714416 submitted.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th May 2007, 20:48</div></div><div class="posttext">Thanks. I'll take a look when I get the time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Portante</div><div class="date">15th June 2007, 04:44</div></div><div class="posttext">Hello folks,<br />
<br />
I have tried deckrider's patch (applied to NSIS 2.28), and I have had to make a few other tweaks to get the install compiler built. However, the setup.exe generated hangs on our windows box. Perhaps I can confirm that the tweaks I have made are not too harmful.<br />
<br />
I am running things on an rx2600 (IA) HP-UX 11.23 (the 0505 release) with the following compiler versions<br />
<br />
  B3901BA C.11.23.09 HP C/ANSI C Developer's Bundle (S800)<br />
  B3913DB C.05.55    HP aC++ Compiler (S800)<br />
<br />
Using HP's C++ compiler the anonymous unions in ResourceEditor.h were considered errors. So as a work around, I named them _a and _b and modified the source code to reference them. Ugly, I know, but wanted to get around that for now.<br />
<br />
I then modified deckrider's hpc++ configuration to add +W829 so that a number of warnings about deprecated constant conversions would be ignored.<br />
<br />
I then had to tweak util.cpp, to change &quot;CP1252&quot; to &quot;cp1252&quot;, and &quot;UCS-2LE&quot; to &quot;UCS-2BE&quot; in order for HP-UX's iconv_open() to accept the arguments. However, the use of UCS-2BE most likely means that I cannot use nsis-2.28.zip pre-compiled contents, as those executables use UCS-2LE, right?<br />
<br />
Thanks, -peter</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">15th June 2007, 11:53</div></div><div class="posttext">Originally posted by Portante <br />
Hello folks,<br />
<br />
I have tried deckrider's patch (applied to NSIS 2.28), and I have had to make a few other tweaks to get the install compiler built. However, the setup.exe generated hangs on our windows box<br />
<br />
I haven't tried NSIS 2.28 yet.  We've been using the patch (#1714416) that was uploaded to sourceforge without issue, but only to build the 'makensis' executable and only for NSIS 2.27.  (I'll provide a few more details when I get to work--no such host with me here at home.)  Do you have these issues with 2.27?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th June 2007, 15:47</div></div><div class="posttext">You can't use UCS-2BE. Windows uses little endian so every string must be encoded with little endian and not big endian. If HP-UX's libiconv doesn't support UCS-2LE, it can't be used and must be replaced.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">15th June 2007, 18:47</div></div><div class="posttext">Originally posted by deckrider <br />
(I'll provide a few more details when I get to work--no such host with me here at home.)  <br />
<br />
Still haven't tried 2.28 yet, but here are my details for 2.27:<br />
<br />
<br />
$ uname -a<br />
HP-UX omztdv1 B.11.23 U ia64 2505142627 unlimited-user license<br />
<br />
$ aCC -V<br />
aCC: HP C/aC++ B3910B A.06.12 [Aug 17 2006]<br />
<br />
$ cc -V<br />
cc: HP aC++/ANSI C B3910B A.06.10 [Mar 22 2006]<br />
<br />
$ ldd `which makensis`<br />
        libunalign.so.1 =&gt;      /usr/lib/hpux32/libunalign.so.1<br />
        libpthread.so.1 =&gt;      /usr/lib/hpux32/libpthread.so.1<br />
        libiconv.so =&gt;  /usr/local/lib/hpux32/libiconv.so<br />
        libstd_v2.so.1 =&gt;       /usr/lib/hpux32/libstd_v2.so.1<br />
        libCsup.so.1 =&gt; /usr/lib/hpux32/libCsup.so.1<br />
        libm.so.1 =&gt;    /usr/lib/hpux32/libm.so.1<br />
        libunwind.so.1 =&gt;       /usr/lib/hpux32/libunwind.so.1<br />
        libc.so.1 =&gt;    /usr/lib/hpux32/libc.so.1<br />
        libdl.so.1 =&gt;   /usr/lib/hpux32/libdl.so.1<br />
        libc.so.1 =&gt;    /usr/lib/hpux32/libc.so.1<br />
        libuca.so.1 =&gt;  /usr/lib/hpux32/libuca.so.1<br />
<br />
<br />
# note above that I didn't link to the native libiconv<br />
# but the one I link to is available from HP :<br />
<br />
$ swlist -l file | grep /usr/local/lib/hpux32/libiconv.so<br />
<br />
  GNUbase.GNUBASE-IPF-RUN: /usr/local/lib/hpux32/libiconv.so<br />
<br />
# and finally how I build:<br />
<br />
scons \<br />
        SKIPSTUBS=all \<br />
        SKIPPLUGINS=all \<br />
        SKIPUTILS=all \<br />
        SKIPMISC=all \<br />
        VERSION=$PACKAGE_VERSION \<br />
        PATH=$PATH \<br />
        TOOLSET=hpc++,hpcc,hplink \<br />
        APPEND_CPPPATH=/usr/local/include \<br />
        APPEND_LIBPATH=/usr/local/lib/hpux32 \<br />
        PREFIX_BIN=/opt/vzb/bin \<br />
        PREFIX=/opt/vzb \<br />
        PREFIX_CONF=/etc/opt/vzb \<br />
        PREFIX_DEST=$DSTDIR \<br />
        install-compiler</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Portante</div><div class="date">28th June 2007, 15:47</div></div><div class="posttext">Folks, here is what I had to do to get NSIS 2.28 to build and run on HP-UX 11.11 (PA) and 11.23 (IA) platforms. The additional patch (see attachment) contains:<br />
<br />
<br />
 hpc++: a couple of flags to enable the code to be compiled with only a few changes<br />
 SConstruct: change order of gnu and hpc++ conditionals so that GNU is not recognized by default<br />
 ResourceEditor.cpp, ResourceEditor.h, util.cpp: remove anonymous unions; this is a hack fix, which I did not like doing, but I didn't find a compiler switch to enable this behavior; also for util.cpp, the new and delete operator definitions conflicted with HP-UX C++ header files.<br />
<br />
<br />
How to build NSIS for HP-UX (using NSIS 2.28 as an example)<br />
<br />
Assumptions:<br />
<br />
 For 11.23 IA<br />
<br />
$ swlist -a revision -a architecture -a title B3913DB,r=C.05.55<br />
# B3913DB                       C.05.55        HP-UX_B.11.23_IA HP aC++ Compiler (S800) <br />
  B3913DB.C-Dev-Tools           B.11.23.03     HP-UX_B.11.23_IA C Language Development Tools <br />
  B3913DB.Caliper               B.11.23.03     HP-UX_B.11.23_IA HP Itanium Performance Measurement Tools <br />
  B3913DB.ACXX                  C.05.55        HP-UX_B.11.23_IA HP aC++        <br />
  B3913DB.WDB-GUI               B.11.23.03     HP-UX_B.11.23_IA GUI for the HP WDB Debugger <br />
  B3913DB.WDB                   B.11.23.03     HP-UX_B.11.23_IA HP Wildebeest (HP WDB) Debugger <br />
  B3913DB.Auxiliary-Opt         B.11.23.03     HP-UX_B.11.23_IA Auxiliary Optimizer for HP Languages. <br />
$ aCC -V<br />
aCC: HP aC++/ANSI C B3910B A.05.55 [Dec 04 2003]<br />
$ swlist -a revision -a architecture -a title B3901BA,r=C.05.55<br />
# B3901BA                       C.05.55        HP-UX_B.11.23_IA HP C/ANSI C Developer's Bundle (S800) <br />
  B3901BA.C-ANSI-C              C.05.55        HP-UX_B.11.23_IA HP C/ANSI C Compiler <br />
  B3901BA.X11MotifDevKit        B.11.23.03     HP-UX_B.11.23_IA/PA HP-UX Developer's Toolkit - X11, Motif, and Imake <br />
  B3901BA.Caliper               B.11.23.03     HP-UX_B.11.23_IA HP Itanium Performance Measurement Tools <br />
  B3901BA.WDB-GUI               B.11.23.03     HP-UX_B.11.23_IA GUI for the HP WDB Debugger <br />
  B3901BA.WDB                   B.11.23.03     HP-UX_B.11.23_IA HP Wildebeest (HP WDB) Debugger <br />
  B3901BA.Auxiliary-Opt         B.11.23.03     HP-UX_B.11.23_IA Auxiliary Optimizer for HP Languages. <br />
  B3901BA.C-Dev-Tools           B.11.23.03     HP-UX_B.11.23_IA C Language Development Tools <br />
$ cc -V<br />
cc: HP aC++/ANSI C B3910B A.05.55 [Dec 04 2003]<br />
$ swlist -a revision -a architecture -a title gcc libiconv<br />
# gcc                           3.4.3          HP-UX_B.11.23_64 gcc            <br />
  gcc.gcc-INC                                                                <br />
  gcc.gcc-MAN                                                                <br />
  gcc.gcc-RUN                                                                <br />
  gcc.gcc-SHLIBS                                                             <br />
# libiconv                      1.11           HP-UX_B.11.23_64 libiconv       <br />
  libiconv.libiconv-RUN                                                      <br />
<br />
 For 11.11 PA<br />
<br />
$ swlist -a revision -a architecture -a title B3913DB,r=C.03.70<br />
# B3913DB                       C.03.70        HP-UX_B.11.11_32/64 HP aC++ Compiler (S800) <br />
  B3913DB.C-Dev-Tools           B.11.11.16     HP-UX_B.11.00_32/64 C Language Development Tools <br />
  B3913DB.ACXX                  C.03.70        HP-UX_B.11.00_32/64 HP aC++        <br />
  B3913DB.CodeAdvisor           C.01.00        HP-UX_B.11.00_32/64 HP Static Analysis Tool <br />
  B3913DB.WDB-GUI               B.11.11.16     HP-UX_B.11.00_32/64 GUI for the HP WDB Debugger <br />
  B3913DB.WDB                   B.11.11.16     HP-UX_B.11.00_32/64 HP Wildebeest (HP WDB) Debugger <br />
  B3913DB.DebugPrg              B.11.11.16     HP-UX_B.11.00_32/64 Debugging Support Tools <br />
  B3913DB.Auxiliary-Opt         B.11.11.16     HP-UX_B.11.00_32/64 Auxiliary Optimizer for HP Languages. <br />
# aCC -V<br />
aCC: HP ANSI C++ B3910B A.03.70<br />
# swlist -a revision -a architecture -a title B3901BA,r=B.11.11.16<br />
# B3901BA                       B.11.11.16     HP-UX_B.11.11_32/64 HP C/ANSI C Developer's Bundle for HP-UX (S800) <br />
  B3901BA.C-ANSI-C              B.11.11.16     HP-UX_B.11.00_32/64 HP C/ANSI C Compiler <br />
  B3901BA.X11MotifDevKit        B.11.11.02     HP-UX_B.11.11_32/64 HP-UX Developer's Toolkit - X11, Motif, and Imake <br />
  B3901BA.ImagingDevKit         B.11.11.02     HP-UX_B.11.11_32/64 HP-UX Developer's Toolkit - Imaging <br />
  B3901BA.CDEDevKit             B.11.11.02     HP-UX_B.11.11_32/64 CDE Developer Kit <br />
  B3901BA.AudioDevKit           B.11.11.02     HP-UX_B.11.11_32/64 HP-UX Audio Developer Kit <br />
  B3901BA.CodeAdvisor           C.01.00        HP-UX_B.11.00_32/64 HP Static Analysis Tool <br />
  B3901BA.WDB-GUI               B.11.11.16     HP-UX_B.11.00_32/64 GUI for the HP WDB Debugger <br />
  B3901BA.WDB                   B.11.11.16     HP-UX_B.11.00_32/64 HP Wildebeest (HP WDB) Debugger <br />
  B3901BA.DebugPrg              B.11.11.16     HP-UX_B.11.00_32/64 Debugging Support Tools <br />
  B3901BA.Auxiliary-Opt         B.11.11.16     HP-UX_B.11.00_32/64 Auxiliary Optimizer for HP Languages. <br />
  B3901BA.C-Dev-Tools           B.11.11.16     HP-UX_B.11.00_32/64 C Language Development Tools <br />
  B3901BA.C-Analysis-Tools      B.11.11.16     HP-UX_B.11.00_32/64 C Language Analysis Tools <br />
# cc -V tmp.c<br />
cpp.ansi: HP92453-01 B.11.11.16 HP C Preprocessor (ANSI)<br />
ccom: HP92453-01 B.11.11.16 HP C Compiler<br />
/usr/ccs/bin/ld: 92453-07 linker linker ld B.11.53 060322<br />
$ swlist -a revision -a architecture -a title gcc libiconv<br />
# gcc                           3.4.3          HP-UX_B.11.11_700/800 gcc            <br />
  gcc.gcc-INC                                                                <br />
  gcc.gcc-MAN                                                                <br />
  gcc.gcc-RUN                                                                <br />
# libiconv                      1.11           HP-UX_B./800   libiconv       <br />
  libiconv.libiconv-RUN                                                      <br />
<br />
 /tmp/nsis-2.28.zip exists<br />
 /tmp/nsis-2.28-src.tar exists<br />
 /tmp/nsis-hpux.patch (http://sourceforge.net/tracker/download.php?group_id=22049&amp;atid=373087&amp;file_id=228205&amp;aid=1714416) exists<br />
 /tmp/nsis-hpux-vse.patch exists (see attachment)<br />
 <br />
<br />
Note that HP-UX's /usr/bin/patch does not work with the patch files listed above. So the source tree might first have to be patched up on a box with GNU patch 2.5.9 (http://mirrors.ibiblio.org/pub/mirrors/gnu/alpha/gnu/diffutils/patch-2.5.9.tar.gz ) or later, and then moved to the target HP-UX box (installing and running GNU patch on the HP-UX box will work as well).<br />
<br />
For both IA and PA first perform the following steps:<br />
<br />
<br />
cd /opt<br />
umask 022<br />
unzip /tmp/nsis-2.28.zip<br />
ln -s nsis-2.28 nsis<br />
cd /tmp<br />
tar xf /tmp/nsis-2.28-src.tar<br />
cd nsis-2.28-src<br />
patch -p1 &lt; ../nsis-hpux.patch<br />
patch -p1 &lt; ../nsis-hpux-vse.patch<br />
<br />
<br />
Then, for PA:<br />
<br />
<br />
scons \<br />
    SKIPSTUBS=all \<br />
    SKIPPLUGINS=all \<br />
    SKIPUTILS=all \<br />
    SKIPMISC=all \<br />
    NSIS_CONFIG_CONST_DATA_PATH=no \<br />
    APPEND_CPPPATH=/usr/local/include \<br />
    APPEND_LIBPATH=/usr/local/lib \<br />
    PREFIX=/opt/nsis \<br />
    install-compiler<br />
<br />
<br />
Then, for IA (only difference is that APPEND_LIBPATH is set to /usr/local/lib/hpux32):<br />
<br />
<br />
scons \<br />
    SKIPSTUBS=all \<br />
    SKIPPLUGINS=all \<br />
    SKIPUTILS=all \<br />
    SKIPMISC=all \<br />
    NSIS_CONFIG_CONST_DATA_PATH=no \<br />
    APPEND_CPPPATH=/usr/local/include \<br />
    APPEND_LIBPATH=/usr/local/lib/hpux32 \<br />
    PREFIX=/opt/nsis \<br />
    install-compiler</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th June 2007, 18:02</div></div><div class="posttext">Does that remove the need for the PATH change? deckrider, does the new patch work for you too?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">20th July 2007, 20:39</div></div><div class="posttext">Originally posted by kichik <br />
Does that remove the need for the PATH change? deckrider, does the new patch work for you too?  Sorry to take so long to respond, I just noticed this recently.  A friend loaned me some time on:<br />
<br />
HP-UX B.11.11 U 9000/893 HP-UX<br />
aCC: HP ANSI C++ B3910B A.03.34<br />
<br />
As a small note, on this older compiler, I had to convert all the source<br />
code from dos to unix line endings, otherwise it would fail on #define<br />
multiline continuations.<br />
<br />
I'm providing a patch to nsis-2.29-src which works for both the above<br />
host/compiler and:<br />
<br />
HP-UX B.11.23 U ia64<br />
aCC: HP C/aC++ B3910B A.06.12 [Aug 17 2006]<br />
<br />
The only real difference from my original patch is that it adds -AA to<br />
CXXFLAGS (its the default on aCC A.06.12) and fixes some compile errors<br />
in Source/util.cpp (they were only warnings on aCC A.06.12).<br />
<br />
Clearly, the library locations will be different, but these should be<br />
specified by the user anyway.<br />
<br />
I should explain that my patches are essentially to add alignment fixups based on SIGBUS.  Either -lunalign or -lhppa provides this handler<br />
as documented here:<br />
<br />
http://h30097.www3.hp.com/docs/porting/tru64-to-hpux/tru64-to-hpux.pdf<br />
<br />
As for Portante's patch, I haven't yet had the time to analyze or test<br />
it, but if it converts makensis to using only aligned access, then this<br />
is better and the alignment fixups I'm using are not needed, and should<br />
be removed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">20th July 2007, 21:36</div></div><div class="posttext">I had more time than I thought this afternoon:<br />
<br />
I tried applying nsis-hpux.patch-patch.txt, and during the hpux ia64 build I get these:<br />
<br />
aCC: warning 967: Option -AA or -AP does not apply to ANSI C compilation, ignored.<br />
<br />
Without the alignment fixups from http://h30097.www3.hp.com/docs/porting/tru64-to-hpux/tru64-to-hpux.pdf the running of makensis still results in a bus error.<br />
<br />
But the 'anonymous' warnings are now gone  :)  so I'm going to add that patch to my build of nsis-2.29-src.<br />
<br />
Here are the only warnings left for me on hpux ia64:<br />
<br />
<br />
aCC -o build/release/makensis/build.o -c +DD32 -mt -AA -D__BIG_ENDIAN__ -DNSIS_HPUX_ALLOW_UNALIGNED_DATA_ACCESS -D_WIN32_IE=0x0500 -I/usr/local/include Source/build.cpp<br />
&quot;Source/build.cpp&quot;, line 534: warning #2068-D: integer conversion resulted in<br />
          a change of sign<br />
                  *out++ = (unsigned int) NS_VAR_CODE; // Named user variable;<br />
                           ^<br />
<br />
&quot;Source/build.cpp&quot;, line 558: warning #2068-D: integer conversion resulted in<br />
          a change of sign<br />
                  *out++=(unsigned int)NS_SHELL_CODE; // Constant code identifier<br />
                         ^<br />
<br />
&quot;Source/build.cpp&quot;, line 579: warning #2068-D: integer conversion resulted in<br />
          a change of sign<br />
                  *out++ = (unsigned int)NS_LANG_CODE; // Next word is lang-string Identifier<br />
                           ^<br />
<br />
aCC -o build/release/makensis/script.o -c +DD32 -mt -AA -D__BIG_ENDIAN__ -DNSIS_HPUX_ALLOW_UNALIGNED_DATA_ACCESS -D_WIN32_IE=0x0500 -I/usr/local/include Source/script.cpp<br />
&quot;Source/script.cpp&quot;, line 2775: warning #2186-D: pointless comparison of<br />
          unsigned integer with zero<br />
          if (s &lt; 0)<br />
                ^<br />
<br />
&quot;Source/script.cpp&quot;, line 5760: warning #2111-D: statement is unreachable<br />
      return PS_ERROR;<br />
      ^<br />
<br />
aCC -o build/release/makensis/util.o -c +DD32 -mt -AA -D__BIG_ENDIAN__ -DNSIS_HPUX_ALLOW_UNALIGNED_DATA_ACCESS -D_WIN32_IE=0x0500 -I/usr/local/include Source/util.cpp<br />
&quot;Source/util.cpp&quot;, line 676: warning #2186-D: pointless comparison of unsigned<br />
          integer with zero<br />
        if( nchars &lt; 0 ){<br />
                   ^<br />
<br />
<br />
Note that I did not use +W829 (I think it just suppresses a compiler message for a certain compiler--not the version I'm using, since none of my warnings have that number)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">20th July 2007, 22:59</div></div><div class="posttext">Here is the final combined patch (thanks Portante) that I'm using (eliminates all aCC compiler warnings on hpux ia64 aCC HP C/aC++ B3910B A.06.12 [Aug 17 2006]).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st July 2007, 16:52</div></div><div class="posttext">Could you change _a and _b to meaningful names, wrap __THROWSPEC_NULL in some kind of #ifdef and preferably comment on its meaning (Google shows nothing) and submit it as a patch (http://sourceforge.net/tracker/?group_id=22049&amp;atid=373087)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deckrider</div><div class="date">23rd July 2007, 14:07</div></div><div class="posttext">Originally posted by kichik <br />
Could you change _a and _b to meaningful names, wrap __THROWSPEC_NULL in some kind of #ifdef and preferably comment on its meaning (Google shows nothing) and submit it as a patch (http://sourceforge.net/tracker/?group_id=22049&amp;atid=373087)?  <br />
<br />
Ooops....didn't mean to let that slip through:  '__THROWSPEC_NULL' should really be 'throw()' and '__THROWSPEC_X(__bad_alloc)' should really be 'throw(bad_alloc)'.  The patch I submitted has that corrected, but not in any #ifdef, since it should just be standard for all compilers (but I haven't tested on msvc).<br />
<br />
The meaningful names I chose are:  UName and UOffset, but these can easily be searched and replaced in the patch if they aren't good.<br />
<br />
I've submitted patch <br />
1758863 at https://sourceforge.net/tracker/index.php?func=detail&amp;aid=1758863&amp;group_id=22049&amp;atid=373087<br />
<br />
I developed this patch using free accounts from http://www.testdrive.hp.com/ which I would like to recommend trying.<br />
<br />
It may help to understand why PATH may need to be specified (for instance, if you want to compile using GCC on HPUX, but you must build/install GCC in your home directory since you don't have administrator rights).<br />
<br />
Also, I think it may valuable to try some changes first hand if needed.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>