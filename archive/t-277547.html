<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Removing Reg keys on uninstall with Vista, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Removing Reg keys on uninstall with Vista NSIS Discussion" />
	
	<title> Removing Reg keys on uninstall with Vista [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Removing Reg keys on uninstall with Vista</div>
<hr />
<div class="pda"><a href="t-277547.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277547">Removing Reg keys on uninstall with Vista</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">SolemnSolitary</div><div class="date">19th September 2007, 09:44</div></div><div class="posttext">Hi<br />
I'm hoping someone can help me here, I'm very new to Nsis and just trying to edit an installer so it will now support Vista as well as XP but have run into a problem. With my XP installer it seems to work fine when removing a reg key for a context menu ive added but with vista it wont remove the context menu item aka not removing the reg key. have anyone had this probelm before maybe?<br />
<br />
Code:<br />
<br />
Install<br />
    WriteRegStr HKLM &quot;Software\CLASSES\*\shell&quot; &quot;&quot; &quot;&quot;<br />
    WriteRegStr HKLM &quot;Software\CLASSES\*\shell\AIToolkit&quot; &quot;&quot; &quot;&quot;<br />
    WriteRegStr HKLM &quot;Software\CLASSES\*\shell\AIToolkit\command&quot; &quot;&quot; &quot;$\&quot;${INSTDIR}\AIToolkit.exe$\&quot; $\&quot;%L$\&quot; $\&quot;context$\&quot;&quot;<br />
<br />
Uninstall<br />
    DeleteRegValue HKLM &quot;Software\CLASSES\*\shell\AIToolkit&quot; &quot;command&quot;<br />
    DeleteRegValue HKLM &quot;Software\CLASSES\*\shell&quot; &quot;AIToolkit&quot;<br />
<br />
<br />
Thanks!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">19th September 2007, 10:36</div></div><div class="posttext">try <br />
<br />
DeleteRegKey HKLM &quot;Software\CLASSES\*\shell\AIToolkit&quot;</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>