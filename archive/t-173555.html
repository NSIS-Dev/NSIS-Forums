<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Exit code of Uninst.exe /S, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Exit code of Uninst.exe /S NSIS Discussion" />
	
	<title> Exit code of Uninst.exe /S [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Exit code of Uninst.exe /S</div>
<hr />
<div class="pda"><a href="t-173555.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=173555">Exit code of Uninst.exe /S</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Herr Pfarrer</div><div class="date">16th March 2004, 15:32</div></div><div class="posttext">Hi,<br />
I'm working on a &quot;silent&quot; uninstall. I call the self generated Uninst.exe through another program, it executes well and does cleanly uninstall.<br />
I get its exit code and instead of 0 or 1 (like the exit code of the installer in /S mode) I've got 4407346<br />
<br />
Is there something special to do in the &quot;Unsinstall&quot; section ?<br />
Or am I wrong elsewhere ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th March 2004, 17:10</div></div><div class="posttext">Without getting into too many details, the solution is the same as it is for this FAQ item:<br />
<br />
http://nsis.sourceforge.net/support/faq_item/?id=19&amp;backPID=15&amp;tx_faq_faq=14</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Herr Pfarrer</div><div class="date">17th March 2004, 14:25</div></div><div class="posttext">Indeed, I tested this option in a Win32 console program :<br />
<br />
...<br />
CreateProcess (NULL, &quot;C:\\Temp\\Uninst.exe _?=C:\\Temp /S&quot;, NULL, NULL, FALSE, CREATE_NO_WINDOW, NULL, NULL, &amp;si, &amp;pi);<br />
...<br />
DWORD dwExitCode = 0;<br />
GetExitCodeProcess (pi.hProcess, &amp;dwExitCode);<br />
...<br />
<br />
And it works !<br />
I have got a 0 in dwExitCode when it's ok<br />
and a 1 when it's failed<br />
(I just made a fake Uninst.exe with an Abort in it)<br />
<br />
Thank's for the tip ;-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th March 2004, 16:21</div></div><div class="posttext">Are you sure it works as should? The /S switch should be set before _?=.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsclient</div><div class="date">24th October 2006, 00:42</div></div><div class="posttext">The actual FAQ answer that answers this is:<br />
<br />
[B]When I use ExecWait uninstaller.exe it doesn't wait for the uninstaller[B]<br />
<br />
A precis of the answer is: because what you think is the uninstaller only runs for a fraction of a second: it copies itself to a temporary area and runs from there. This system can be defeated<br />
<br />
And the FAQ itself is (currently) at http://nsis.sourceforge.net/When_I_use_ExecWait_uninstaller.exe_it_doesn%27t_wait_for_the_uninstaller</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>