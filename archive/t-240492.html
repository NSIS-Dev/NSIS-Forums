<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" SetCaretPos system call, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  SetCaretPos system call NSIS Discussion" />
	
	<title> SetCaretPos system call [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  SetCaretPos system call</div>
<hr />
<div class="pda"><a href="t-240492.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=240492">SetCaretPos system call</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">10th March 2006, 23:24</div></div><div class="posttext">I'm trying to set the caret position within the text field of a custom page. My call is within the SetFocus (http://nsis.sourceforge.net/wiki/Set_Focus_to_a_Control) function.<br />
<br />
System::Call &quot;user32::CreateCaret(i r0, i, i R2, i R5)i&quot;<br />
System::Call &quot;user32::SetCaretPos(i 10, i) i .r1&quot;<br />
System::Call &quot;user32::ShowCaret(i r0)i&quot;<br />
<br />
This is the same order of calls that MSDN uses in their example. My return value ($1) is 1, which means that the call succeeded, according to the docs.<br />
<br />
But, no matter what values I pass in, the caret remains at the beginning of the text field when it is given focus. Has anybody used this successfully? If so, how do you know what to pass in for the x/y coordinates? For example, how would you set the position to the end of the string in a text field?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">11th March 2006, 03:55</div></div><div class="posttext">Set caret position to the end of the text:<br />
<br />
Test.nsiName &quot;Test&quot;<br />
OutFile &quot;Test.exe&quot;<br />
<br />
!include &quot;WinMessages.nsh&quot;<br />
<br />
Var HWND<br />
Var INI<br />
<br />
Page Custom ShowCustom LeaveCustom<br />
Page instfiles<br />
<br />
Function ShowCustom<br />
	InstallOptions::initDialog /NOUNLOAD &quot;$INI&quot;<br />
	Pop $HWND<br />
<br />
	GetDlgItem $0 $HWND 1200<br />
	SendMessage $0 ${WM_SETTEXT} 1 &quot;STR:12345$\r$\n67890$\r$\nabcdf$\r$\n&quot;<br />
	System::Call &quot;user32::SetFocus(i r0)&quot;<br />
	System::Call &quot;user32::SendMessage(i r0, i ${EM_GETLINECOUNT}, i 0, i 0)i .r1&quot;<br />
	IntOp $1 $1 - 1<br />
	System::Call &quot;user32::SendMessage(i r0, i ${EM_LINEINDEX}, i r1, i 0)i .r2&quot;<br />
	System::Call &quot;user32::SendMessage(i r0, i ${EM_LINELENGTH}, i r2, i 0)i .r3&quot;<br />
	IntOp $4 $3 + $2<br />
	SendMessage $0 ${EM_SETSEL} $4 $4<br />
	SendMessage $0 ${EM_LINESCROLL} 0 $1<br />
<br />
	InstallOptions::show<br />
	Pop $0<br />
FunctionEnd<br />
<br />
Function LeaveCustom<br />
	ReadINIStr $0 $INI &quot;Settings&quot; &quot;State&quot;<br />
	StrCmp $0 0 Enter<br />
	goto main<br />
<br />
	main:<br />
	Abort<br />
<br />
	Enter:<br />
FunctionEnd<br />
<br />
Function .onInit<br />
	InitPluginsDir<br />
	GetTempFileName $INI $PLUGINSDIR<br />
	File /oname=$INI &quot;Test.ini&quot;<br />
FunctionEnd<br />
<br />
Section &quot;Empty&quot;<br />
SectionEnd<br />
Test.ini[Settings]<br />
NumFields=1<br />
NextButtonText=&amp;Enter<br />
<br />
[Field 1]<br />
Type=Text<br />
Flags=MULTILINE|VSCROLL|HSCROLL<br />
Left=5<br />
Right=-48<br />
Top=5<br />
Bottom=60</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">11th March 2006, 06:23</div></div><div class="posttext">Thanks Instructor! It works perfectly :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>