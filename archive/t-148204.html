<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Upgrade dll problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Upgrade dll problem NSIS Discussion" />
	
	<title> Upgrade dll problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Upgrade dll problem</div>
<hr />
<div class="pda"><a href="t-148204.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=148204">Upgrade dll problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">yehiaeg</div><div class="date">5th September 2003, 10:18</div></div><div class="posttext">hello,<br />
i am trying to use the UpgradeDll macro, i copy and paste it in an &quot;UpgradeDll.nsi&quot;<br />
<br />
but there is always this error:<br />
<br />
GetTempFileName expects 1 parameters, got 2.<br />
Usage: GetTempFileName $(user_var: name output)<br />
Error in macro UpgradeDLL on macroline 43<br />
Error in script &quot;C:\Yehia\Developement\VB\mycss\Setup\Setup.nsi&quot; on line 42 -- aborting creation process<br />
<br />
but i think i am writing the roght parameter:<br />
bla...<br />
!include &quot;UpgradeDll.nsi&quot;  <br />
bla...<br />
!insertmacro UpgradeDLL &quot;C:\yehia\Developement\VB\mycss\Setup\RichTx32.ocx&quot; &quot;$SYSDIR\RichTx32.ocx&quot; &quot;$SYSDIR&quot;<br />
<br />
so what's the problem?<br />
i attached the setup if this would help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th September 2003, 11:22</div></div><div class="posttext">You're using a new function with an old NSIS. The UpgradeDLL from the online manual is built for the latest CVS version of NSIS, it won't work with b3. For more information about getting the latest CVS version see http://nsis.sf.net/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yehiaeg</div><div class="date">5th September 2003, 12:16</div></div><div class="posttext">ok, i updated the english language file and makensis.exe and makensisw.exe and the modernui system file,<br />
<br />
but the compiler found another error:<br />
!insertmacro: MUI_SECTIONS_FINISHHEADER<br />
!insertmacro: macro named &quot;MUI_SECTIONS_FINISHHEADER&quot; not found!<br />
Error in script &quot;C:\Yehia\Developement\VB\mycss\Setup\Setup.nsi&quot; on line 91 -- aborting creation process<br />
<br />
is this mui_sections_finishheader was removed in the new version?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th September 2003, 12:19</div></div><div class="posttext">When updating from CVS you should update everything, not just some of the files. If you don't, you'd get weird errors such as the one you got from UpgradeDLL.<br />
<br />
Yes, MUI_SECTIONS_FINISHHEADER is no longer needed. There are many more changes, it would be best to just re-read the MUI readme. Also read this (http://forums.winamp.com/showthread.php?s=&amp;threadid=148146).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yehiaeg</div><div class="date">5th September 2003, 13:02</div></div><div class="posttext">another stupid question, in the upgrade dll there a coment saying <br />
 ;If you want to support Win9x, you can only use short filenames<br />
 ; (8.3).<br />
<br />
this means that this wouldn't work<br />
!insertmacro UpgradeDLL &quot;C:\yehia\Developement\VB\mycss\Setup\eSellerateEngine.dll&quot; &quot;$WINDIR\eSellerateEngine.dll&quot; &quot;$SYSDIR  ???</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th September 2003, 13:09</div></div><div class="posttext">Indeed. This won't work as you expect on Windows 9x. If eSellerateEngine.dll is in use while the installer is running then it will be deleted on reboot and the new file will be named something like eSelle~1.dll. This is a limitation of Windows 9x.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yehiaeg</div><div class="date">5th September 2003, 13:22</div></div><div class="posttext">another question:<br />
what happened to !define MUI_BRANDINGTEXT  &quot; &quot; , it isn't working anymore</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th September 2003, 13:26</div></div><div class="posttext">MUI no longer sets the branding text. You can use BrandingText as with normal scripts now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yehiaeg</div><div class="date">5th September 2003, 13:30</div></div><div class="posttext">thanks, anywhere to find a list of what modification were made to the script language?<br />
<br />
<br />
thanks again for the help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th September 2003, 13:35</div></div><div class="posttext">Yep:<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=148146</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yehiaeg</div><div class="date">5th September 2003, 13:38</div></div><div class="posttext">thanks again and again<br />
u' re a very helpful guy</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>