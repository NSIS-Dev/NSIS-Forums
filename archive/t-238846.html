<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Screensaver Registry and more, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Screensaver Registry and more NSIS Discussion" />
	
	<title> Screensaver Registry and more [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Screensaver Registry and more</div>
<hr />
<div class="pda"><a href="t-238846.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=238846">Screensaver Registry and more</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">levj</div><div class="date">23rd February 2006, 18:43</div></div><div class="posttext">Hi,<br />
  I'm new at NSIS, but I am a programmer in C\C++, so I have a good understanding of computers/code.  I am trying to create an install to a screensaver.  How would, at the end of the program, set my screensaver to be the current screensaver, and open the control panel for screensaver(otherwise accessed by rightclicking the desktop&gt;properties&gt;screensaver)?  What registry key holds the current screensaver info, and how would I open the screensaver settings box?  Thanks<br />
Levi</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Dark Fire Guy</div><div class="date">23rd February 2006, 19:11</div></div><div class="posttext">I don't know any official way using the registry, but when I want to install a screensaver I use ExecShell &quot;Install&quot;. I would then execute whatever file brings up the display properties ($Sysdir\Something.cpl or $Sysdir\Something.exe).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">levj</div><div class="date">23rd February 2006, 21:59</div></div><div class="posttext">:)   Thanks,  I've figured it out.  I used ExecShell.  <br />
Levi</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">24th February 2006, 13:29</div></div><div class="posttext">rubbish ;p<br />
try this<br />
<br />
!include &quot;Sections.nsh&quot;<br />
<br />
<br />
<br />
  !insertmacro MUI_PAGE_COMPONENTS<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  page custom Options  ; &lt;-- insert only this line<br />
  !insertmacro MUI_PAGE_FINISH<br />
<br />
<br />
Section &quot;Set as default Screensaver&quot; SecInfo41<br />
SectionEnd<br />
<br />
<br />
Function Options<br />
  ;get user options from sections, setsaver<br />
  SectionGetFlags ${SecInfo41} $R9<br />
  IntOp $SETSAVER $R9 &amp; ${SF_SELECTED}<br />
<br />
  ;options<br />
  StrCmp $SETSAVER &quot;0&quot; no_default<br />
    GetFullPathName /SHORT $R9 &quot;link_to_my_saver.scr&quot;<br />
    WriteRegStr HKCU &quot;Control Panel\Desktop&quot; &quot;SCRNSAVE.EXE&quot; $R9<br />
  no_default:<br />
FunctionEnd<br />
<br />
<br />
Some explanation<br />
- you need sections.nsh<br />
- insert new custom page<br />
- insert section (will be shown in MUI_PAGE_COMPONENTS)<br />
- function determines if section selected and do action<br />
<br />
Read the manual where to insert each part<br />
<br />
this is the right key and it needs 8.3 DOS-name (GetFullPathName /SHORT)<br />
HKCU &quot;Control Panel\Desktop&quot; &quot;SCRNSAVE.EXE&quot;<br />
<br />
if you want to open the desktop settings (saver) just exec this<br />
RUNDLL32 shell32.dll,Control_RunDLL desk.cpl,,1<br />
<br />
more about the control panel here<br />
http://www.wintotal.de/Tipps/Eintrag.php?RBID=2&amp;TID=184&amp;URBID=7<br />
<br />
if you want to learn more about executing SCR-files open regedit.exe <br />
and examine this key<br />
HKEY_CLASSES_ROOT\scrfile\shell<br />
(config, install, open)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>