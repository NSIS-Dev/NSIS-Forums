<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to Detect / Start / Stop SQL Service Manager, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to Detect / Start / Stop SQL Service Manager NSIS Discussion" />
	
	<title> How to Detect / Start / Stop SQL Service Manager [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to Detect / Start / Stop SQL Service Manager</div>
<hr />
<div class="pda"><a href="t-263995.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=263995">How to Detect / Start / Stop SQL Service Manager</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">19th January 2007, 09:12</div></div><div class="posttext">Hello Everybody,<br />
<br />
I've made an installer which installs MSDE 2000. Now it needs some fine tuning, so seeking help from you people.<br />
<br />
;this runs the setup of msde:<br />
nsExec::Exec &quot;$INSTDIR\setup.exe&quot;<br />
<br />
;then I tries to start the SQL Service Manager<br />
;to avoid a reboot for automatic start of Service Manager.<br />
<br />
To start the SQL service manager, the following command does not runs on Windows 2000, though it is fine in Win XP:<br />
<br />
nsExec::Exec &quot;cmd /C NET START MSSQLSERVER&quot;<br />
(this command is running fine in XP)<br />
<br />
So how to start the service manager in Windows 2000?<br />
<br />
Moreover I want to know how to detect whether the SQL Service Manager is running or not, irrespective of user's using any version of Windows.<br />
<br />
With regards,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">19th January 2007, 13:21</div></div><div class="posttext">I'll get back to this thread...I've messed up something...NET START command works in Windows 2000.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vissers</div><div class="date">19th January 2007, 13:33</div></div><div class="posttext">Hi,<br />
<br />
You can use the readregstr command to detect the MSSQL on local computer.<br />
<br />
To start it for example:<br />
<br />
execwait 'scm.exe -Action 1 -Service MSSQL$Example -silent 2</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">19th January 2007, 14:03</div></div><div class="posttext">SORRY FRIENDS!<br />
<br />
There is some basic error in my initial post. First I want to declare that  nsExec::Exec &quot;NET START MSSQLSERVER&quot; also works in Windows 2000.<br />
<br />
From my debugging, what I've come to know that from my these two commands:<br />
      nsExec::Exec &quot;$INSTDIR\setup.exe&quot;<br />
      nsExec::Exec &quot;NET START MSSQLSERVER&quot;<br />
MSDE gets installed and the service MSSQLSERVER also gets started without reboot.<br />
<br />
But if I reboot the computer the Service Manager is added up in the Windows StartUp and the icon of SQL Server Service Manager comes in the Task bar. And this shows the user that the MSDE has been properly installed. How can I accomplish this job? i.e. to add it up in the Windows StartUp and in the Task bar.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">19th January 2007, 14:09</div></div><div class="posttext">Vissers Thanks a lot!<br />
<br />
Its seems my issue can be resolved by your example. Let me try...will get back to you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">19th January 2007, 14:18</div></div><div class="posttext">I've to leave my office now as its off 4 the day 2day.<br />
<br />
But in the meantime Vissers, can you confirm me that your this command with scm.exe will be able to start the Service Manager for the first time just after the msde has been installed and no reboot is done, and from startup Service Manager not activated too. If it can still start the service manager my purpose will be fullfilled.<br />
<br />
Hope to see your reply, when I come to office tomorrow.<br />
<br />
Have a nice day!<br />
<br />
With regards,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">20th January 2007, 05:59</div></div><div class="posttext">From my debugging, what I've come to know that my these two commands:<br />
nsExec::Exec &quot;$INSTDIR\setup.exe&quot;<br />
nsExec::Exec &quot;NET START MSSQLSERVER&quot;<br />
<br />
are running simultanelously!<br />
<br />
The installer is not waiting for the setup.exe (the msde setup) to get its operation finished. Its starts the second command nsExec::Exec &quot;NET START MSSQLSERVER&quot;. And thats why my command is not giving the desired output.<br />
<br />
So how to wait till my 1st command is finished?  The 'Sleep' command will not be proper to use here, as I don't know how much time it will take to complete the msde setup on different computers.<br />
<br />
Anyone listening? Or a separate post required?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vissers</div><div class="date">22nd January 2007, 10:01</div></div><div class="posttext">use:<br />
<br />
<br />
    execwait '$INSTDIR\setup.exe'<br />
    execwait 'NET START MSSQLSERVER'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd January 2007, 19:35</div></div><div class="posttext">nsExec already waits, that won't help. I already answered you in the other thread (http://forums.winamp.com/showthread.php?postid=2106983#post2106983).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>