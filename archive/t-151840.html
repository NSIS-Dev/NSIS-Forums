<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Newbie Problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Newbie Problem NSIS Discussion" />
	
	<title> Newbie Problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Newbie Problem</div>
<hr />
<div class="pda"><a href="t-151840.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=151840">Newbie Problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">soulfinger</div><div class="date">7th October 2003, 16:09</div></div><div class="posttext">I am sooo new to this it's not even funny. Well...just a little bit. Anyway my problem is that I have a setup.exe file which will need to be installed on a pocket pc device. No problem, I created the setup.exe file in embedded visual basic. Now I need the setup.exe file to be installed in the desktop program folder first then into the pocket pc. Cool..this is where NSIS comes in. I read the Modern UI read me file to see if i can use one of the scripts to accomplish this. I found a script to help me run the setup.exe after it is installed on the desktop program folder. The problem is after the NSIS installer asks me if I want to run the program &quot;setup.exe&quot;, I get an error that says &quot; error reading setup ini &quot;. Does anyone know what this means and what I have to do to have the setup.exe launch. I appreciate any help at this point.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">7th October 2003, 16:13</div></div><div class="posttext">Looks like an error of your other setup application.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th October 2003, 16:14</div></div><div class="posttext">1. Extract the setup.exe program to $DESKTOP<br />
2. Use SetOutPath to set the working directory<br />
3. Use Exec to run it, or if it's a command-line dos program use nsExec::Exec to run it hidden.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">soulfinger</div><div class="date">7th October 2003, 16:32</div></div><div class="posttext">The setup.exe program runs fine before I incoporate it into NSIS.   It's afterwards  when I get the error reading setup ini.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th October 2003, 16:42</div></div><div class="posttext">So your setup program requires an ini file to run?<br />
<br />
Do you have the setup.ini file?<br />
Maybe you should try:<br />
<br />
File &quot;/oname=$DESKTOP\setup.exe&quot; &quot;setup.exe&quot;<br />
File &quot;/oname=$DESKTOP\setup.ini&quot; &quot;setup.ini&quot;<br />
SetOutPath $DESKTOP<br />
nsExec::Exec &quot;$DESKTOP\setup.exe&quot;<br />
<br />
Or similar.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th October 2003, 16:43</div></div><div class="posttext">But NSIS doesn't have any message like the one you've quoted. Try to do what Afrow UK suggested. Setting the working directory is probably what's missing. If the working directory is not set correctly it might not be able to find the INI file it's looking for.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">soulfinger</div><div class="date">8th October 2003, 16:22</div></div><div class="posttext">I figured out why I'm getting this problem. Duh!! The setup.exe isn't a real exe file. It's actually launching a cab file. So when i put the setup.exe into NSIS that's why it comes with the ini error because they all have to be together to launch from the desktop. So..I figured that out. I'm confused what to do now. Any suggestions?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th October 2003, 16:25</div></div><div class="posttext">So, you just need to place the setup and cab files in the same directory, and then execute the setup.exe<br />
<br />
What is the problem with that?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">soulfinger</div><div class="date">8th October 2003, 17:15</div></div><div class="posttext">Sorry Stu. This is all new to me. I know some don't have the patience for people like me. It's a hugh learning curve. Thanks for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th October 2003, 17:17</div></div><div class="posttext">Well, like I posted above with a slight modification;<br />
File &quot;/oname=$DESKTOP\setup.exe&quot; &quot;setup.exe&quot;<br />
File &quot;/oname=$DESKTOP\setup.cab&quot; &quot;setup.cab&quot;<br />
SetOutPath $DESKTOP<br />
nsExec::Exec &quot;$DESKTOP\setup.exe&quot;<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">soulfinger</div><div class="date">8th October 2003, 17:19</div></div><div class="posttext">Cool. I'll work on it now.<br />
<br />
thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th October 2003, 17:26</div></div><div class="posttext">Note the above code assumes the following:<br />
* setup.exe is in your nsi file's dir<br />
* The cab file is called setup.cab, and is also in your nsi file's dir<br />
* You want the files to be extracted to the desktop<br />
<br />
Heres a bit of info on what they do:<br />
The first File parameter /oname sets the output path &amp; name.<br />
The second File parameter sets the source of the file being compressed.<br />
SetOutPath will set the working directory for setup.exe (so setup.exe will look for the cab file in the working directory set, which is $DESKTOP)<br />
nsExec::Exec will run the setup program invisibly (nsExec is a plugin)<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>