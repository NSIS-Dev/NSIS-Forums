<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problems using UnRegDLL, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problems using UnRegDLL NSIS Discussion" />
	
	<title> Problems using UnRegDLL [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problems using UnRegDLL</div>
<hr />
<div class="pda"><a href="t-158203.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=158203">Problems using UnRegDLL</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">T595</div><div class="date">1st December 2003, 12:17</div></div><div class="posttext">I've searched the forum without any luck...<br />
<br />
I want to register/unregister some dll's with my setup program (apart from installing the rest of the application) and the first section works just fine.<br />
<br />
During install, I unreg the dll in two locations (to awoid duplicates) and the one that unregisters from the installation folder (marked: &gt;&gt;) works just fine during setup, but when using the exact same command during uninstall it fails...  <br />
(could not load: c:\program files\TEST\TEST.dll)<br />
<br />
running a &quot;regsvr32 /U TEST.dll&quot; from the commandprompt works just fine too, so the option would be using ExecWait, or ?<br />
<br />
Anyone have a solution for this problem ?<br />
<br />
Section &quot;Test&quot; TST<br />
  SetOutPath $INSTDIR\TEST<br />
  File TEST\TEST.dll<br />
  UnRegDLL $SYSDIR\TEST.dll<br />
&gt;&gt;  UnRegDLL $INSTDIR\TEST\TEST.dll<br />
  RegDLL $INSTDIR\TEST\TEST.dll<br />
  WriteUninstaller &quot;$INSTDIR\uninstall.exe&quot;<br />
SectionEnd<br />
<br />
<br />
Section &quot;Uninstall&quot;<br />
    UnRegDLL $INSTDIR\TEST\TEST.dll<br />
    RMDir /r &quot;$INSTDIR\TEST&quot;<br />
SectionEnd<br />
<br />
<br />
<br />
<br />
<br />
Many thanks,<br />
<br />
Magnus</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st December 2003, 13:20</div></div><div class="posttext">Make sure the DLL has all its dependencies where it can find them. Using the following before UnregDLL should probably do it:<br />
<br />
SetOutPath $INSTDIR\Test<br />
<br />
SetOutPath sets the working directory which is one of the directories where Windows looks for DLL dependencies. Don't forget to set it to something else before you want to delete the directory because the working directory cannot be deleted.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T595</div><div class="date">1st December 2003, 16:21</div></div><div class="posttext">Brilliant, it works like a charm...<br />
<br />
Thanks a lot!<br />
<br />
<br />
/Magnus</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Shalafi</div><div class="date">28th September 2010, 02:21</div></div><div class="posttext">Sorry for revive so old thread, but this is the only entry about this topic that Google shows me ;)<br />
<br />
I have exactly the same problem; my uninstaler can't unregister a dll. It sais &quot;could not load: C:\program files\MediaTab\MediaTab64.dll&quot;<br />
<br />
I tried what T595 said, adding SetOutPath $INSTDIR\MediaTab before UnRegDll but it doesn't solve the problem. Also, I tried with different values for SetOutPath without any change.<br />
<br />
Any help? Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">28th September 2010, 07:53</div></div><div class="posttext">I guess it's a x64 Dll?<br />
http://forums.winamp.com/showthread.php?t=318803<br />
This post is about installation, but the same applies for uninstallation:<br />
http://nsis.sourceforge.net/Docs/AppendixB.html#B.3</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Shalafi</div><div class="date">28th September 2010, 11:31</div></div><div class="posttext">Thanks for your help.<br />
I tried what you said, but I's still failling. This is my uninstall code:<br />
<br />
... stuff ...<br />
${If} ${RunningX64}<br />
    ;SetRegView 64 --- Commented because I used it before<br />
    Delete &quot;$INSTDIR\Uninstall.exe&quot;<br />
    ;UnRegDLL &quot;$INSTDIR\MediaTab64.dll&quot; --- Commented because I used it before<br />
    define LIBRARY_X64<br />
    !insertmacro UnInstallLib REGDLL NOTSHARED NOREBOOT_NOTPROTECTED &quot;$INSTDIR\MediaTab64.dll&quot;<br />
    !undef LIBRARY_X64<br />
... more stuff ...<br />
<br />
The error still is &quot;Could not load: C:\program files\MediaTab\MediaTab64.dll&quot;<br />
<br />
Thanks again; any other idea?<br />
<br />
P.D: manual unregistering with regsvr32 works perfect<br />
<br />
EDIT ------------------------<br />
I defined LIBRARY_X64 at the begining of the script and I didn't remember it; I have commented the define at unistall part and now it's working.<br />
Thank you so much!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>