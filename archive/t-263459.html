<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How do I register.net library thru NSIS Script, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How do I register.net library thru NSIS Script NSIS Discussion" />
	
	<title> How do I register.net library thru NSIS Script [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How do I register.net library thru NSIS Script</div>
<hr />
<div class="pda"><a href="t-263459.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=263459">How do I register.net library thru NSIS Script</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">gnanaprakash</div><div class="date">11th January 2007, 14:27</div></div><div class="posttext">Hi,<br />
<br />
How do I register.net library thru NSIS Script.Pls provide me sample script.<br />
<br />
<br />
Thanks in Advance;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th January 2007, 21:17</div></div><div class="posttext">The following Wiki page has some information about this.<br />
<br />
http://nsis.sourceforge.net/Register_a_managed_.NET_DLL_in_the_GAC</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gnanaprakash</div><div class="date">12th January 2007, 16:31</div></div><div class="posttext">Hi,<br />
<br />
I tried to put my dll in GAC by using the below script but I was not able to register.<br />
<br />
;R0 &quot;$INSTDIR\mydll.dll&quot;'<br />
nsExec::Exec '&quot;$WINDIR\Microsoft.NET\Framework\v1.1.432\GacUtil.exe&quot; /i &quot;$R0&quot; /f'<br />
<br />
<br />
for the GACUtil do I need to give the above path or &quot;..\Program Files\Microsoft Visual Studio 8\VC\gacutil\&quot;<br />
<br />
Iam not sure what's wrong in it.Even I tried like this<br />
<br />
ExecWait '&quot;$WINDIR\Microsoft.NET\Framework\v1.1.432\GacUtil.exe&quot; /i &quot;$INSTDIR\mydll.dll&quot;' still I am not able to register. <br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th January 2007, 18:15</div></div><div class="posttext">If you point to the Visual Studio directory, only users with Visual Studio will be able to install your application. You don't want that. Probably a better overall solution would be including gacutil.exe with your installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gnanaprakash</div><div class="date">13th January 2007, 09:17</div></div><div class="posttext">After Calling this script <br />
R0 &quot;$INSTDIR\mydll.dll&quot;'<br />
nsExec::Exec '&quot;$WINDIR\Microsoft.NET\Framework\v1.1.432\GacUtil.exe&quot; /i &quot;$R0&quot; /f'<br />
 ;(or)<br />
ExecWait '&quot;$WINDIR\Microsoft.NET\Framework\v1.1.432\GacUtil.exe&quot; /i &quot;$INSTDIR\mydll.dll&quot;' still I am not able to register. <br />
<br />
I was not able to find &quot;mydll.dll&quot; in GAC.<br />
<br />
What's wrong in it?.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th January 2007, 16:13</div></div><div class="posttext">Does that work from the command line? Are you sure gacutil.exe really exists? Why not package gacutil.exe with your installer, as I suggested?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gnanaprakash</div><div class="date">15th January 2007, 15:24</div></div><div class="posttext">Yes it's working in command line and gacutil is exists in &quot;\Microsoft.NET\Framework\v1.1.432\GacUtil.exe&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th January 2007, 18:34</div></div><div class="posttext">Try executing it with nsExec. Maybe it prints some kind of an error.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gnanaprakash</div><div class="date">17th January 2007, 05:29</div></div><div class="posttext">Hi,<br />
<br />
I have one more gacutil under the  following folder.<br />
<br />
nsExec::Exec '&quot;C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\Bin\gacutil.exe&quot;<br />
<br />
If I use the above path in the script It's registering .<br />
<br />
If I use this path it's  not registering. &quot;\Microsoft.NET\Framework\v1.1.432\GacUtil.exe&quot;<br />
<br />
<br />
Thanks,<br />
Gnanaprakash</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">17th January 2007, 06:18</div></div><div class="posttext">nsExec::Exec '&quot;C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\Bin\gacutil.exe&quot;<br />
this path points to your local system, probably is not valid for every target.<br />
If I use this path it's not registering. &quot;\Microsoft.NET\Framework\v1.1.432\GacUtil.exe&quot;Also, this one is partially hard coded therefore useless for every machine.<br />
Why not just package gacutil with your installer as kichik suggested twice?<br />
If you want anyway to use the gacutil that resides on the target, you need to grab in a variable the framework path from registry, and use it like this,<br />
ReadRegStr $0 HKLM &quot;SOFTWARE\Microsoft\.NETFramework&quot; &quot;InstallRoot&quot;<br />
nsExec::Exec &quot;$0\v1.1.4322\gacutil.exe&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gnanaprakash</div><div class="date">18th January 2007, 11:38</div></div><div class="posttext">Yes,I am packaging gacutil with installer as kichik suggested .<br />
<br />
Thanks for helping me :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mayevski</div><div class="date">27th February 2007, 10:34</div></div><div class="posttext">You are not allowed to distribute GACUtil.<br />
Also, different versions of gacutil (namely, 1.1 and 2.0) install the assemblies to different GACs (1.1 and 2.0 accordingly). So the correct way is to use Fusion DLLs on the target systems.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zanz</div><div class="date">30th July 2008, 02:32</div></div><div class="posttext">I read the following note from the link posted by kichik:<br />
- The above will not work in most cases on Vista, since you need permissions to do it. So we need some way to do the above from within NSIS. I have no idea how. <br />
<br />
Retrieved from &quot;http://nsis.sourceforge.net/Register_a_managed_.NET_DLL_in_the_GAC&quot;<br />
<br />
<br />
Is there any alternative for Vista? If my permission level is set to 'admin' would I still have problem on Vista? thanks!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>