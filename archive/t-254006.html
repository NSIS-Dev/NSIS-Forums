<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" silent - callback function that validates a custom page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  silent - callback function that validates a custom page NSIS Discussion" />
	
	<title> silent - callback function that validates a custom page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  silent - callback function that validates a custom page</div>
<hr />
<div class="pda"><a href="t-254006.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=254006">silent - callback function that validates a custom page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">coco_vc</div><div class="date">24th August 2006, 13:54</div></div><div class="posttext">Hi all,<br />
<br />
When uninstalling first thing the uninstaller does is to show a custom page that asks:<br />
a) uninstall the product from the machine<br />
b) disable for current user<br />
<br />
Then in the &quot;Function un.ValidateSelection&quot; (where: UninstPage custom un.UninstallModePage un.ValidateSelection) I do:<br />
if users choses a, the uninstaller goes normally further. If the user choses b, the uninstaller runs an exe from my application and then quits, as the product shouldn't be uninstalled, and my exe will take care of just disabling for current user.<br />
<br />
This works ok in a non-silent uninstall, but in a silent uninstall, the function un.ValidateSelection is not called. Where and how should I write the neccesary code? meaning the code that checks if a) or b) should be done (in a silent uninstall can be part of the cmd line param) and in case it's a) to run an exe and to quit the uninstaller?<br />
<br />
Thx,<br />
Viv</div></div><hr />


<div class="post"><div class="posttop"><div class="username">coco_vc</div><div class="date">25th August 2006, 12:48</div></div><div class="posttext">haven't I been clear with my question, or there is no &quot;right&quot; answer for it?<br />
<br />
Thx,<br />
Viv</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th August 2006, 13:36</div></div><div class="posttext">You should implement the working code in the sections and only have the custom page set a variable that tells the code what to do. That same variable can also be set in un.onInit according to the command line.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">coco_vc</div><div class="date">28th August 2006, 14:52</div></div><div class="posttext">Yes, that's indeed better :)<br />
<br />
Thx,<br />
Viv</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>