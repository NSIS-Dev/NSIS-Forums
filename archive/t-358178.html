<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Why user-defined function didnot call in silent installer?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Why user-defined function didnot call in silent installer? NSIS Discussion" />
	
	<title> Why user-defined function didnot call in silent installer? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Why user-defined function didnot call in silent installer?</div>
<hr />
<div class="pda"><a href="t-358178.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=358178">Why user-defined function didnot call in silent installer?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ilaiyaraja</div><div class="date">27th March 2013, 08:14</div></div><div class="posttext"># Auto-generated by EclipseNSIS Script Wizard<br />
# 27 Mar, 2013 11:54:28 AM<br />
<br />
Name Test<br />
<br />
# General Symbol Definitions<br />
!define REGKEY &quot;SOFTWARE\$(^Name)&quot;<br />
<br />
# MUI Symbol Definitions<br />
!define MUI_ICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-install-colorful.ico&quot;<br />
!define MUI_FINISHPAGE_NOAUTOCLOSE<br />
!define MUI_STARTMENUPAGE_REGISTRY_ROOT HKLM<br />
!define MUI_STARTMENUPAGE_NODISABLE<br />
!define MUI_STARTMENUPAGE_REGISTRY_KEY ${REGKEY}<br />
!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME StartMenuGroup<br />
!define MUI_STARTMENUPAGE_DEFAULTFOLDER Test<br />
!define MUI_UNICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall-colorful.ico&quot;<br />
!define MUI_UNFINISHPAGE_NOAUTOCLOSE<br />
<br />
# Included files<br />
!include Sections.nsh<br />
!include MUI2.nsh<br />
<br />
# Variables<br />
Var StartMenuGroup<br />
<br />
# Installer pages<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!insertmacro MUI_PAGE_STARTMENU Application $StartMenuGroup<br />
!insertmacro MUI_PAGE_INSTFILES<br />
page custom test<br />
!insertmacro MUI_PAGE_FINISH<br />
!insertmacro MUI_UNPAGE_CONFIRM<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
# Installer languages<br />
!insertmacro MUI_LANGUAGE English<br />
<br />
# Installer attributes<br />
OutFile setup.exe<br />
InstallDir $PROGRAMFILES\Test<br />
CRCCheck on<br />
XPStyle on<br />
ShowInstDetails show<br />
InstallDirRegKey HKLM &quot;${REGKEY}&quot; Path<br />
ShowUninstDetails show<br />
<br />
# Installer sections<br />
Section -Main SEC0000<br />
    SetOutPath $INSTDIR<br />
    MessageBox MB_OK &quot;done&quot;<br />
    SetOverwrite on<br />
    File src\com\test\Sample.java<br />
    WriteRegStr HKLM &quot;${REGKEY}\Components&quot; Main 1<br />
SectionEnd<br />
<br />
Section -post SEC0001<br />
    WriteRegStr HKLM &quot;${REGKEY}&quot; Path $INSTDIR<br />
    SetOutPath $INSTDIR<br />
    WriteUninstaller $INSTDIR\uninstall.exe<br />
    !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
    SetOutPath $SMPROGRAMS\$StartMenuGroup<br />
    CreateShortcut &quot;$SMPROGRAMS\$StartMenuGroup\$(^UninstallLink).lnk&quot; $INSTDIR\uninstall.exe<br />
    !insertmacro MUI_STARTMENU_WRITE_END<br />
    WriteRegStr HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$(^Name)&quot; DisplayName &quot;$(^Name)&quot;<br />
    WriteRegStr HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$(^Name)&quot; DisplayIcon $INSTDIR\uninstall.exe<br />
    WriteRegStr HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$(^Name)&quot; UninstallString $INSTDIR\uninstall.exe<br />
    WriteRegDWORD HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$(^Name)&quot; NoModify 1<br />
    WriteRegDWORD HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$(^Name)&quot; NoRepair 1<br />
SectionEnd<br />
Function test<br />
MessageBox MB_OK &quot;ok&quot;<br />
//Do some stuff<br />
FunctionEnd<br />
# Macro for selecting uninstaller sections<br />
!macro SELECT_UNSECTION SECTION_NAME UNSECTION_ID<br />
    Push $R0<br />
    ReadRegStr $R0 HKLM &quot;${REGKEY}\Components&quot; &quot;${SECTION_NAME}&quot;<br />
    StrCmp $R0 1 0 next${UNSECTION_ID}<br />
    !insertmacro SelectSection &quot;${UNSECTION_ID}&quot;<br />
    GoTo done${UNSECTION_ID}<br />
next${UNSECTION_ID}:<br />
    !insertmacro UnselectSection &quot;${UNSECTION_ID}&quot;<br />
done${UNSECTION_ID}:<br />
    Pop $R0<br />
!macroend<br />
<br />
# Uninstaller sections<br />
Section /o -un.Main UNSEC0000<br />
    Delete /REBOOTOK $INSTDIR\Sample.java<br />
    DeleteRegValue HKLM &quot;${REGKEY}\Components&quot; Main<br />
SectionEnd<br />
<br />
Section -un.post UNSEC0001<br />
    DeleteRegKey HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$(^Name)&quot;<br />
    Delete /REBOOTOK &quot;$SMPROGRAMS\$StartMenuGroup\$(^UninstallLink).lnk&quot;<br />
    Delete /REBOOTOK $INSTDIR\uninstall.exe<br />
    DeleteRegValue HKLM &quot;${REGKEY}&quot; StartMenuGroup<br />
    DeleteRegValue HKLM &quot;${REGKEY}&quot; Path<br />
    DeleteRegKey /IfEmpty HKLM &quot;${REGKEY}\Components&quot;<br />
    DeleteRegKey /IfEmpty HKLM &quot;${REGKEY}&quot;<br />
    RmDir /REBOOTOK $SMPROGRAMS\$StartMenuGroup<br />
    RmDir /REBOOTOK $INSTDIR<br />
SectionEnd<br />
<br />
# Installer functions<br />
Function .onInit<br />
    !ifdef IsSilent<br />
    SetSilent silent<br />
    !endif<br />
    InitPluginsDir<br />
FunctionEnd<br />
<br />
# Uninstaller functions<br />
Function un.onInit<br />
    ReadRegStr $INSTDIR HKLM &quot;${REGKEY}&quot; Path<br />
    !insertmacro MUI_STARTMENU_GETFOLDER Application $StartMenuGroup<br />
    !insertmacro SELECT_UNSECTION Main ${UNSEC0000}<br />
FunctionEnd<br />
<br />
# Installer Language Strings<br />
# TODO Update the Language Strings with the appropriate translations.<br />
<br />
LangString ^UninstallLink ${LANG_ENGLISH} &quot;Uninstall $(^Name)&quot;<br />
<br />
<br />
In the above code I have run both ways silent and non-silent mode.if i run non-silent mode[user interaction] the custom page[test] called msg box displayed.If i run silent mode, its did not call custom page [test] no msg box displayed.<br />
I dont know what is the difference these two?<br />
Is there any reason user-defined custom page did not call in silent mode?<br />
How to call custom page if i run silent mode?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th March 2013, 12:59</div></div><div class="posttext">Page callbacks do not run in silent mode because you do not have any UI in silent mode.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ilaiyaraja</div><div class="date">2nd April 2013, 10:31</div></div><div class="posttext">Thanks.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>