<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" delete setup.exe as last action?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  delete setup.exe as last action? NSIS Discussion" />
	
	<title> delete setup.exe as last action? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  delete setup.exe as last action?</div>
<hr />
<div class="pda"><a href="t-265448.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=265448">delete setup.exe as last action?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">xirisone</div><div class="date">9th February 2007, 09:11</div></div><div class="posttext">Hi,<br />
<br />
I need to delete my NSIS 'setup.exe' as last step of the setup itself. I can not use a BAT-file which calls setup.exe first and then deletes the file.<br />
<br />
Can a NSIS setup delete it's own setup.exe as last action?<br />
<br />
TIA,<br />
  xirisone</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">9th February 2007, 09:16</div></div><div class="posttext">http://forums.winamp.com/showthread.php?s=&amp;threadid=236058&amp;highlight=selfdel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xirisone</div><div class="date">9th February 2007, 10:11</div></div><div class="posttext">do I have to replace 'SelfDel' with the name of my MySetup.exe in your example.nsi?<br />
<br />
!define APP_NAME SelfDel    # old<br />
!define APP_NAME MySetup    # new<br />
<br />
TIA, <br />
    xirisone (newbie)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xirisone</div><div class="date">9th February 2007, 11:00</div></div><div class="posttext">@Takhir<br />
got you dll working - nearly....<br />
Problem: link and folder 'unsd' are not deleted.<br />
My script attached. Did I include the code from your example.nsi wrongly?<br />
<br />
TIA,<br />
    xirisone</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">9th February 2007, 11:14</div></div><div class="posttext">Included sample removes uninstaller, if you want to remove setup.exe use following code<br />
Function .onGUIEnd<br />
  SelfDel::del<br />
FunctionEndbut please note that in the silent mode this may not work (no function call in NSIS). The same line at the end of last mandatory section should work always, but cursor on the finish page will be with 'waiting'.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xirisone</div><div class="date">9th February 2007, 12:03</div></div><div class="posttext">@Takhir<br />
removing the setup.exe works fine with you example, the link and the folder 'unsd' are not deleted. Could you check my test.nsi? That would be VERY nice.<br />
TIA,<br />
  xirisone</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">9th February 2007, 12:23</div></div><div class="posttext">I guess you don't need to create links at all. The sample included to SelfDel.zip describes the most complex situation - uninstaller deletion inplace. To simulate uninstall it creates subdir, writes uninstaller and creates link (simulating start menu). You don't need this, just add the only line from my post above after # prepare automatic delete of Installer....<br />
BTW I re-tested included to zip sample and it worked as requested.<br />
Uninstaller auto deletes itself, this not require a plug-in.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xirisone</div><div class="date">9th February 2007, 13:00</div></div><div class="posttext">@Takhir<br />
You're right!!!! Just using:<br />
<br />
Function .onGUIEnd<br />
  SelfDel::del<br />
FunctionEnd<br />
<br />
does the job.<br />
Thank you VERY much!<br />
<br />
xirisone</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th February 2007, 21:19</div></div><div class="posttext">Originally posted by xirisone <br />
@Takhir<br />
You're right!!!! Just using:<br />
<br />
Function .onGUIEnd<br />
  SelfDel::del<br />
FunctionEnd<br />
<br />
does the job.<br />
Thank you VERY much!<br />
<br />
xirisone  What about if users for some reason decided to install the application later and click cancel e.g. on license page or components page or every included page?<br />
It deletes the installer and nothing is installed.<br />
Compile the following example and hit cancel on some page.<br />
<br />
Not the best behaviour if I've downloaded a large (e.g. 100 mb) installer on a slow internet connection and I have to download again and perhaps I'll get again the same strange result.<br />
<br />
Perhaps you should add a messagebox informing users not to click cancel otherwise they have to re-download the installer.<br />
!define APP_NAME SelfDel<br />
<br />
Name &quot;${APP_NAME}&quot;<br />
OutFile &quot;${APP_NAME}.exe&quot;<br />
InstallDir &quot;$PROGRAMFILES\${APP_NAME}&quot;<br />
<br />
Page Components<br />
Page Directory<br />
Page InstFiles<br />
<br />
Section &quot;Dummy Section&quot; <br />
<br />
    SetOutPath &quot;$INSTDIR&quot;<br />
<br />
SectionEnd<br />
<br />
<br />
Function .onGUIEnd<br />
<br />
    SelfDel::del<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">10th February 2007, 09:24</div></div><div class="posttext">Just to keep xirisone informed: SelfDel plug-in page (http://nsis.sourceforge.net/SelfDel_plug-in)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">10th February 2007, 10:42</div></div><div class="posttext">@ Takhir,<br />
probably you need to update the above provided link, currently it is a link to page that doesn't exist.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">10th February 2007, 10:48</div></div><div class="posttext">Thanks, Red Wine. Updated.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>