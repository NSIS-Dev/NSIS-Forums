<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Creating DesktopShortcut, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Creating DesktopShortcut NSIS Discussion" />
	
	<title> Creating DesktopShortcut [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Creating DesktopShortcut</div>
<hr />
<div class="pda"><a href="t-128319.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=128319">Creating DesktopShortcut</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">2shepi</div><div class="date">13th March 2003, 14:49</div></div><div class="posttext">Hi<br />
<br />
its the first day i work with nsis and i think its a great thing, but i couldnt find out how i could create Desktop Shortcuts...<br />
could u help me out pls.<br />
<br />
my nsi file<br />
Please attach large scripts. attached below :down:<br />
<br />
tnx 4 supporting me...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th March 2003, 15:52</div></div><div class="posttext">Welcome to the forum! :D<br />
<br />
To create a shortcut on the desktop use CreateShortcut with the $DESKTOP variable. For example (taken from &lt;NSIS Dir&gt;\Examples\makensis.nsi):<br />
CreateShortCut &quot;$DESKTOP\Nullsoft Install System.lnk&quot; &quot;$INSTDIR\NSIS.exe&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">2shepi</div><div class="date">13th March 2003, 16:05</div></div><div class="posttext">hi kichik<br />
tnx 4 ur fast answer.<br />
Not creating the shortcut is my problem, the problems comes up with generating a custompage!<br />
When i declare a custompage the others, &quot;pre defined&quot; pages dont have any &quot;pre defined&quot; text. hope u could follow..<br />
<br />
[edit]<br />
Sorry 4 File pasting...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th March 2003, 16:14</div></div><div class="posttext">Sorry, lost you... If you want to create a custom page have a look at the InstallOptions.nsi example in Examples\Modern UI. But what does a custom page have to do with a desktop shortcut? Are you trying to give the user the option to create a desktop icon? If so, maybe you should create another section that will do it, just like in Examples\makensis.nsi.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">2shepi</div><div class="date">13th March 2003, 16:22</div></div><div class="posttext">kk now lets initialize our mind :confused: <br />
<br />
From the beginning.<br />
The User could choose which components will be installed, next screen he could choose, creating startmenu entries and in the next screen i wanne let the user choose creating a shortcut on his desktop. imho - i already said, the first day with nsis, so dont judge me - this have to be realize by a custompage.<br />
<br />
Hope know u understand! sorry 4 :igor:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th March 2003, 16:34</div></div><div class="posttext">Then what you need is to have a look at the InstallOptions.nsi example in Examples\Modern UI. It will show you how to create a custom page, and how to read the user input from it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">2shepi</div><div class="date">13th March 2003, 16:51</div></div><div class="posttext">ok now works over.. ill take a look tomorrow nd will post the result. hope gonna get it! tnx 4 supporting me</div></div><hr />


<div class="post"><div class="posttop"><div class="username">2shepi</div><div class="date">14th March 2003, 07:33</div></div><div class="posttext">hope smn gonna read this post at this time :D<br />
<br />
now i tested with the &quot;InstallOptions.nsi&quot; but when i compile &quot;InstallOptions.nsi&quot; i dont see any fields is this normal?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">2shepi</div><div class="date">14th March 2003, 07:57</div></div><div class="posttext">!insertmacro: macro named &quot;MUI_FINISHPAGE&quot; not found!<br />
<br />
hm why?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">14th March 2003, 08:03</div></div><div class="posttext">is: !define MUI_FINISHPAGE</div></div><hr />


<div class="post"><div class="posttop"><div class="username">2shepi</div><div class="date">14th March 2003, 08:17</div></div><div class="posttext">yes it is<br />
<br />
 !define MUI_FINISHPAGE<br />
    !define MUI_FINISHPAGE_RUN &quot;$INSTDIR\maintlog.cmd&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">2shepi</div><div class="date">14th March 2003, 08:53</div></div><div class="posttext">i dont look trough.<br />
!define mui_[pagename]<br />
<br />
!insertmacro MUI_PAGECOMMAND_LICENSE<br />
<br />
could i see anywhere which &quot;macro&quot; are real or so? couldnt follow, where does it get the license page and so?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th March 2003, 09:00</div></div><div class="posttext">What is exactly your problem? Why not add an an extra section, so the user can choose for a desktop shortcut on the components page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">2shepi</div><div class="date">14th March 2003, 09:35</div></div><div class="posttext">ok now i did it with a section, the simplest way 4 me as a beginner.<br />
<br />
My next problem - someone will know why im sure - is the startmenu entrie wouldnt be created.<br />
<br />
could u have a look into my source pls! tnx.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th March 2003, 11:25</div></div><div class="posttext">Defining MUI_STARTMENUPAGE is not enough. You have to create the shortcuts too. Have a look at Examples\Modern UI\StartMenu.nsi and especially the part that starts with:<br />
!insertmacro MUI_STARTMENU_WRITE_BEGIN</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>