<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExeHead &amp; Ole request, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExeHead &amp; Ole request NSIS Discussion" />
	
	<title> ExeHead &amp; Ole request [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExeHead &amp; Ole request</div>
<hr />
<div class="pda"><a href="t-147977.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=147977">ExeHead &amp; Ole request</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">3rd September 2003, 03:07</div></div><div class="posttext">I've just finished new System version, with support of GUID &amp; WCHAR params, and fast VTable calling (i.e. COM ready). <br />
The only problem is that ExeHead subsequent calls to OleInitialize(NULL) and OleUninitialize() kill all my chances to work with COM. Actually, only two calls to each function needed (one at  main app thread, and second at install_thread). Currently the same two x2 calls are placed at RegisterDll and CreateShortcut functions. I've compiled modified version for System debugging and it works fine. Could you make the same available to public, please?<br />
<br />
p.s. the size situation could be balanced: if only  NSIS_SUPPORT_CREATESHORTCUT defined - run functions at installer thread only. if NSIS_SUPPORT_ACTIVEXREG defined - run them at main thread too. or something like that. Thanx.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">3rd September 2003, 03:09</div></div><div class="posttext">btw, new style CreateGUID: ;)<br />
System::Call 'ole32::CoCreateGuid(g .r0)'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">3rd September 2003, 13:03</div></div><div class="posttext">Major system upgrade. As I said before some exehead adaptation needed to use new &quot;-&gt;&quot; calling method. All other changes could be used right now.<br />
<br />
release 4, 3 september 2003.<br />
1. Division by zero fatal error at Int64Op killed.<br />
2. bool type removed (use int instead).<br />
3. GUID (g) and LPWSTR (w) types added.<br />
4. Memory cleanup after using t (string), g (guid) and w (unicode string) added.<br />
5. Automatic A-letter at proc name discovery.<br />
6. COM optimized: new proc specification &quot;x-&gt;y&quot;, where x is interface ptr, and y is vtable member index. For such procs Interface pointer passed as first arg automaticaly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th September 2003, 19:17</div></div><div class="posttext">Done.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>