<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Need help with script!, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Need help with script! NSIS Discussion" />
	
	<title> Need help with script! [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Need help with script!</div>
<hr />
<div class="pda"><a href="t-48366.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=48366">Need help with script!</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">PabUK</div><div class="date">28th April 2001, 13:41</div></div><div class="posttext">I have a problem that just won't go away. On some systems, my installer fails to create the directory when doing a SetOutPath and then of course fails to install the files. It also seems to fail creating shortcuts as well.<br />
<br />
The only system I know for sure to have this behaviour right now is running Windows 2000, which I do not have so cannot test myself.<br />
<br />
Could you please download my installer and script and help me out with it?<br />
<br />
Installer:<br />
http://www.pawsoft.btinternet.co.uk/temp/pawclock_beta3.exe<br />
<br />
NSIS Script:<br />
http://www.pawsoft.btinternet.co.uk/temp/pawclock.nsi<br />
<br />
Any help would be greatly appreciated!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mcgarrah</div><div class="date">28th April 2001, 14:47</div></div><div class="posttext">How does NSIS handle not having administrative privs to a system?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">28th April 2001, 15:53</div></div><div class="posttext">Are you using SetOutPath on a directory whose parent directory hasn't been created yet?  I'm not sure, but this could be a problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PabUK</div><div class="date">28th April 2001, 16:55</div></div><div class="posttext">It is definetely not limited to Windows 2000, as another person just mailed me and had problems in Windows 95. Also in Win ME, although just the createshortcut problem there.<br />
<br />
Here are the screenshots I was sent:<br />
http://www.pawsoft.btinternet.co.uk/temp/ab_pc292setupwin95.gif<br />
<br />
http://www.pawsoft.btinternet.co.uk/temp/ab_pc292setupwinME.gif<br />
<br />
So far I have not been able to reproduce any of these problems on my Win ME system. This is all very frustrating.<br />
<br />
I'll look into that parent directory thing rainwater. Don't think it is that though.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PabUK</div><div class="date">28th April 2001, 18:31</div></div><div class="posttext">I have finally found out what is going on here (it looks like rainwater was right). If you look at my script you will notice the default install locations is &quot;$PROGRAMFILES\PAWSoft\PAWClock&quot; and the default start menu location is &quot;$SMPROGRAMS\PAWSoft\PAWClock&quot;.<br />
<br />
I have been focusing on deleting the PAWClock directory for my tests, without ever considering the PAWSoft directory. I have now tried renaming my PAWSoft directory (both in Program Files and the Start Menu) and reproduced the same errors as shown in the above screenshots.<br />
<br />
So what is happening? NSIS appears to be failing to recursively create the necessary directories. From the NSIS documentation on SetOutPath:<br />
<br />
&quot;Note that it recursively creates it, so if you create C:\poop\dir2\dir3, it will create all that it needs to.&quot;<br />
<br />
For some reason in my case this is not happening, as it will only work if the PAWSoft directory is already present. I have tried CreateDirectory as well but this doesn't make any difference.<br />
<br />
The problem is how do I fix it? I cannot create the PAWSoft directory first because the user might not have selected the default installation location.<br />
<br />
Any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PabUK</div><div class="date">28th April 2001, 18:40</div></div><div class="posttext">AAAAAAAAAAAAAAAAAHHHHHHHHHHHHHHH!<br />
<br />
Sorry about that, but I just found out why it wasn't working. It was a bug in NSIS 1.3 (the version I was using). Even though I had glanced through the version 1.4 Beta 1/2 changes several times I didn't (until a moment ago) notice the bit about fixing the recursive create directory.<br />
<br />
This is typical. Previously when something went wrong I would upgrade to the latest NSIS hoping that the problem I had created would be fixed. Of course it never was, because it was my script at fault. This time I didn't do that thinking that it was my script when in fact there really was a bug with NSIS 1.3.<br />
<br />
Very annoying, but at least it is worked out now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">justin</div><div class="date">29th April 2001, 07:30</div></div><div class="posttext">sorry bout that.. I suck :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PabUK</div><div class="date">29th April 2001, 14:34</div></div><div class="posttext">No problem Justin!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">justin</div><div class="date">30th April 2001, 06:29</div></div><div class="posttext">:) I'll try to keep it to a minimum. Anybody have any problems with 1.4? :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PabUK</div><div class="date">30th April 2001, 13:16</div></div><div class="posttext">Well obviously I don't at the moment or I would have told you.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>