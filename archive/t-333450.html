<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Creating dynamic sections, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Creating dynamic sections NSIS Discussion" />
	
	<title> Creating dynamic sections [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Creating dynamic sections</div>
<hr />
<div class="pda"><a href="t-333450.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=333450">Creating dynamic sections</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">gokussx4</div><div class="date">11th August 2011, 20:26</div></div><div class="posttext">Thanks first of all for viewing this thread as I know some of the seniors are thinking &quot;why didn't he just search the forum?&quot;<br />
<br />
Fortunately I have and I don't think the solution of creating a &quot;bunch&quot; of empty sections and changing the name of that section at runtime is a solution for me.<br />
<br />
Though I would think this problem would be one that is quite common I could be mistaken.<br />
<br />
My example is that I want the sections that are available for selection to be based on if a directory or file exists.<br />
<br />
One would hope there would be a insert section command of some sort but that doesn't seem to be the case.<br />
<br />
Are there any solutions for this out there or another idea besides creating empty sections in the script prior to runtime?<br />
<br />
Have a great day! :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">11th August 2011, 20:32</div></div><div class="posttext">There are no other solutions. Sections are defined at compiletime. Your only option is to have a 100 hidden sections, and rename/unhide them at runtime. Why do you think this is not a solution for you?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gokussx4</div><div class="date">11th August 2011, 20:49</div></div><div class="posttext">Thanks for the reply.<br />
<br />
For our particular install case, if a plugin developer creates a new project (which per plugin is simply a dll, pdb and dependency folder) then we want that new plugin to appear by the name of the folder ( or file doesn't really matter) the next time a build occurs. This would allow new plugins to be created and be picked up by the installer without someone having to modify the nsi script.<br />
<br />
Arbitrarily added x number of sections could mean that you reach a limit of the sections and have to modify the script. <br />
<br />
If this is the only solution, though, is there any overhead of creating so many blank sections that will not be used during that time?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">11th August 2011, 21:08</div></div><div class="posttext">Aha, so you want to create sections depending on files present at compile time? As far as I know there are no compiletime commands in NSIS that allow you to enumerate compiletime files/folders, so you'll need to run an external script/exe that generates nsi code depending on file existence. See this thread: http://forums.winamp.com/showthread.php?t=332913<br />
<br />
(You can execute exes, vbs scripts, etc during compilation using the !system command.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">11th August 2011, 21:19</div></div><div class="posttext">My suggestion is to not think of your plugins as equating to NSIS sections. <br />
<br />
Just create a custom page with a treeview control, where each of your plugin folders is shown as an item in the tree. Allow the user to select or unselect them, and then read the tree settings when the page is left (when Next is clicked). Having read the settings, you can process them (when Install is clicked) in one section. <br />
<br />
You don't need dynamic sections at all. Your script will enumerate the parent folder to find the plugins and display all of them in the treeview.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gokussx4</div><div class="date">11th August 2011, 22:36</div></div><div class="posttext">Aha, so you want to create sections depending on files present at compile time? As far as I know there are no compiletime commands in NSIS that allow you to enumerate compiletime files/folders, so you'll need to run an external script/exe that generates nsi code depending on file existence. See this thread: http://forums.winamp.com/showthread.php?t=332913<br />
<br />
(You can execute exes, vbs scripts, etc during compilation using the !system command.)<br />
<br />
My suggestion is to not think of your plugins as equating to NSIS sections. <br />
<br />
Just create a custom page with a treeview control, where each of your plugin folders is shown as an item in the tree. Allow the user to select or unselect them, and then read the tree settings when the page is left (when Next is clicked). Having read the settings, you can process them (when Install is clicked) in one section. <br />
<br />
You don't need dynamic sections at all. Your script will enumerate the parent folder to find the plugins and display all of them in the treeview.<br />
<br />
Don<br />
<br />
This is a great design idea! I like this one the most because it would seem to have less maintenance. Thank you!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gokussx4</div><div class="date">11th August 2011, 22:38</div></div><div class="posttext">demiller9,<br />
<br />
Do you have an example link you could provide something that would get me started for a similar solution? I am not well versed in NSIS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gokussx4</div><div class="date">11th August 2011, 22:40</div></div><div class="posttext">Thank you both for your great suggestions! This will definitely help me accomplish my goals with our current installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">12th August 2011, 06:46</div></div><div class="posttext">You don't need dynamic sections at all. Your script will enumerate the parent folder to find the plugins and display all of them in the treeview.<br />
Err... That only works at runtime. He explained he wants to add sections automatically depending on files present during *compiling*.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">12th August 2011, 07:04</div></div><div class="posttext">I may have misunderstood his desire, but this is what I think he has asked to do: Create an installer that will show an 'unlimited' number of plugin choices (sections, he termed them). I read this to be some-random-app plugins, not NSIS plugins.<br />
<br />
I suggested that the 'sections' are just a custom page with a treeview, and will be processed by a single NSIS section. The plugin files it will install have ALL been included in the installer using a wildcard on the parent folder, and could be temporarily extracted to the target system into the PlugInsDir. In that location the NSIS runtime can enumerate them and create the treeview entries. Extracting them to the PlugInsDir will ensure they will all be deleted when the installer terminates.<br />
<br />
@MSG: your suggestion to use a vbscript to enumerate the plugins at compile time and generate NSIS code is perfectly sound. The generated code would define the sections to show the plugins and, inside the sections, file commands to install them. It will handle as many plugins as it finds. The benefit might be simpler coding (he doesn't need to code a custom page with a treeview); the extra vbscript code is only a small negative.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">12th August 2011, 08:23</div></div><div class="posttext">Ah, I see what you mean now. Smart solution, although the temporary extraction at runtime might be a disadvantage, requiring HDD space before installation has begun. Personally I'd go for simple compiletime enumeration (could use an NSIS exe for that, even). But it's an interesting idea, to be sure.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gokussx4</div><div class="date">12th August 2011, 15:40</div></div><div class="posttext">I may not have explained this properly, do excuse me, but I did mean dynamically pull the folders files at the time of compiling the installer. Thanks again both, this has been very helpful.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bella10388</div><div class="date">16th August 2011, 08:38</div></div><div class="posttext">Aha, so you want to create sections depending on files present at compile time? As far as I know there are no compiletime commands in NSIS that allow you to enumerate compiletime files/folders, so you'll need to run an external script/exe that generates nsi code depending on file existence. See this thread: http://forums.winamp.com/showthread.php?t=332913<br />
<br />
(You can execute exes, vbs scripts, etc during compilation using the !system command.)<br />
<br />
<br />
Such a very amazing link!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>