<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Calling external dll and returning value, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Calling external dll and returning value NSIS Discussion" />
	
	<title> Calling external dll and returning value [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Calling external dll and returning value</div>
<hr />
<div class="pda"><a href="t-317313.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=317313">Calling external dll and returning value</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pillairohit</div><div class="date">26th February 2010, 06:12</div></div><div class="posttext">Hi.<br />
<br />
In my installer I've made calls to a 3rd party dll in the following way :<br />
   &lt;DLL_name&gt;::&lt;function_name&gt; &lt;parameters, if any&gt;<br />
<br />
I've made such calls directly, not using any plug-in or system call.<br />
<br />
Now I want to call a function from a dll, which returns a value. So I do a 'pushstring(parameter_name, NSIS_MAX_STRLEN)' @ the end of the called function within the dll. There is only one string that I'm returning from the function to the dll.<br />
<br />
However, I am not able to retrieve the value within NSIS. I tried to pop from stack using $0 and $R0, but to no avail.<br />
<br />
I also tried using System::Call '&lt;DLL_name&gt;::&lt;function_name&gt;(t, *i) i(.r0, r1r1).r2' <br />
But in that case, my dll ain't getting called at all.I'm not clear about how the parameters are returned if we use System::Call.<br />
<br />
What am I doing wrong here? How do I make the call in NSIS? <br />
<br />
Thanks.<br />
Rohit.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">26th February 2010, 12:40</div></div><div class="posttext">You cannot call a dll function using dllname::function. You can only call NSIS plugins that way.<br />
<br />
All normal dll functions should be called using the System plugin. Read the System plugin readme for details on the parameter format. Or look for examples in google etc.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>