<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Using an Install List file, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Using an Install List file NSIS Discussion" />
	
	<title> Using an Install List file [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Using an Install List file</div>
<hr />
<div class="pda"><a href="t-274098.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=274098">Using an Install List file</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">josabraham</div><div class="date">9th July 2007, 12:23</div></div><div class="posttext">Hello <br />
<br />
I would like to create an Installer for my app. There are hundreds of files. so I like to do it in the following way. I list all files and folders in a text file. I want to read it from NSIS script in a loop and then install the files. This helps me to add new files and folders only to the List files (a text file).<br />
<br />
while not end of file<br />
{<br />
 Read Lines in text file <br />
 Install files<br />
}<br />
<br />
Structure of list file<br />
<br />
<br />
1---&gt; Index of List of destination directories to be created<br />
2---&gt; Index of files to be copied<br />
<br />
2, Filename, SRC_FOLDER, DEST_FOLDER,RegisterFile<br />
<br />
<br />
1 Register File<br />
0 Do not Registerfile<br />
<br />
Sample structure of file<br />
<br />
1, 1, destFolder1,0<br />
1, 2, destFolder2,1<br />
<br />
2, 1, Test1.dll, source, destination, true<br />
2, 2, Test2.dll, source, destination, flase<br />
<br />
<br />
Can you show me some sample code which does the same.<br />
<br />
How can I read a file using loop since the end of file is encountered?<br />
<br />
regards<br />
Josabraham</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th July 2007, 12:29</div></div><div class="posttext">That could be done if you create a small program (easy to do it with nsis) which reads the text file and creates a proper header which is included in your main script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">josabraham</div><div class="date">9th July 2007, 13:25</div></div><div class="posttext">Hi,<br />
<br />
How can I do the extarction of comma separated strings  from the line which I can read from the file?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th July 2007, 15:53</div></div><div class="posttext">Check out the included StrFunc, TextFunc and WordFunc</div></div><hr />


<div class="post"><div class="posttop"><div class="username">josabraham</div><div class="date">10th July 2007, 12:33</div></div><div class="posttext">Hi Thank you for the reply<br />
<br />
Is it possible to create arrays and structures in NSIS?<br />
<br />
Regards<br />
<br />
Josabraham</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th July 2007, 12:46</div></div><div class="posttext">Arrays are possible with the NSISArray plugin.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">josabraham</div><div class="date">10th July 2007, 13:10</div></div><div class="posttext">Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">josabraham</div><div class="date">13th July 2007, 07:26</div></div><div class="posttext">Hello I try to concatenate the strings in the following way.But it does n't work?<br />
<br />
What is wrong with this?<br />
==================================================<br />
strcpy $FinalName $DestFolder<br />
strcpy $FinalName $FileName<br />
Messagebox MB_ICONINFORMATION|MB_OK   $FinalName<br />
==================================================<br />
<br />
best regards<br />
<br />
josabraham</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th July 2007, 09:17</div></div><div class="posttext">StrCpy copies a string into a variable. It does not concatenate a string to a variable. Copy the string you want to appear in the variable directly instead of using StrCpy twice.StrCpy $FinalName $DestFolder\$FileName</div></div><hr />


<div class="post"><div class="posttop"><div class="username">josabraham</div><div class="date">13th July 2007, 10:33</div></div><div class="posttext">Thank you, <br />
<br />
Now I have file name with full path in the variable $Final name.<br />
<br />
Is it possible to specify file name as below.This gives error<br />
<br />
=========================<br />
File $FinalName<br />
=========================<br />
<br />
best regards<br />
<br />
josabraham</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th July 2007, 10:36</div></div><div class="posttext">No, of course you can't do that. You can't have the script, which runs on the user machine, determine which files go into the installer. Think about it, the compiler would need to run the script, predict the details of the user computer and compress files according to that.<br />
<br />
What you're looking for is !define.!define DestFolder something<br />
!define FileName blah.dat<br />
!define FinalName &quot;${DestFolder}\${FileName}&quot;<br />
<br />
File &quot;${FinalName}&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th July 2007, 11:04</div></div><div class="posttext">To put it into perspective, variables are for run time use whereas constants are for compile time.<br />
If you need to do run time stuff on compile time, then see this page:<br />
http://nsis.sourceforge.net/Invoking_NSIS_run-time_commands_on_compile-time<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">josabraham</div><div class="date">13th July 2007, 11:33</div></div><div class="posttext">Hello thank you for the reply,<br />
<br />
I get filenames from a text file.I open the file.There are parts in the list fie.<br />
<br />
1 it list all directories there.<br />
<br />
1,0,MainDir1<br />
1,1,MainDir1\subDir1<br />
1,2,MainDir2<br />
<br />
2 item list the files<br />
<br />
2,0,Filename,index of srcDir, index of destDir, reg = true or false<br />
<br />
99; end of list file<br />
<br />
So I read the file and build the output path suitably<br />
<br />
So all the file names are coming from the list text file.So filenames are available only at run time.<br />
<br />
So the script is not aware of the names of the files or destination or source directories.So I cannot declare the names as constants.<br />
<br />
This type of design is possible using NSIS?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th July 2007, 11:38</div></div><div class="posttext">In this case, you need two runtimes. One that reads the list file and one that actually installs it. Make a program or an installer that creates a script according to the list file and compile that script to generate the real installer. Afrow's link demonstrates how this can be done in one step.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">josabraham</div><div class="date">13th July 2007, 11:54</div></div><div class="posttext">Thank you<br />
<br />
regards<br />
<br />
Josabraham</div></div><hr />


<div class="post"><div class="posttop"><div class="username">josabraham</div><div class="date">18th July 2007, 11:07</div></div><div class="posttext">Hello,<br />
<br />
My project is consist of more than 2500 files to be processed.So compiling the output for every minor change takes long time.<br />
<br />
Is there any way to create the output with out processing the whole files.Meaning by including only changed files(Like in Visual C++ IDE)<br />
<br />
best regards<br />
<br />
josabraham</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">18th July 2007, 15:53</div></div><div class="posttext">Have it not run the executable itself so that you have to run it manually, and/or only have it ran if the list file does not exist.<br />
<br />
The only real solution is to get the number of files in the folder or the size of the folder and compare it to the number of files or size that was gained the last time.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>