<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" variable as shortcut...howto, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  variable as shortcut...howto NSIS Discussion" />
	
	<title> variable as shortcut...howto [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  variable as shortcut...howto</div>
<hr />
<div class="pda"><a href="t-181238.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181238">variable as shortcut...howto</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">razor_x</div><div class="date">26th May 2004, 17:34</div></div><div class="posttext">i have an unstaller with several sections all but one are optional.I know i can use getsectionflags to create a specified shortcut,by the section selected.But how would i create a variable named shortcut,based on $INSTDIR?...for example they install to c:\blahblah...i want to make a short cut on the desktop to c:\blahblah c:\whatever.exe.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">26th May 2004, 17:40</div></div><div class="posttext">Use the CreateShortcut command. For example:<br />
<br />
 CreateShortCut &quot;$DESKTOP\Shortcut Name.lnk&quot; &quot;$INSTDIR\My.exe&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">razor_x</div><div class="date">26th May 2004, 17:44</div></div><div class="posttext">thanks for the reply..but i cant use...<br />
<br />
CreateShortCut &quot;$DESKTOP\Shortcut Name.lnk&quot; &quot;$INSTDIR\My.exe&quot; <br />
<br />
as &quot;shortcut name&quot; would have to be a variable defined at run time not compile time.<br />
<br />
hence my question....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">26th May 2004, 17:59</div></div><div class="posttext">Var &quot;MyVar&quot;<br />
<br />
in .OnInit<br />
StrCpy $MyVar &quot;&quot;<br />
<br />
in a section/function/macro<br />
StrCpy $MyVar &quot;Shortcut Name&quot;<br />
CreateShortCut &quot;$DESKTOP\$MyVar.lnk&quot; &quot;$INSTDIR\My.exe&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">razor_x</div><div class="date">27th May 2004, 16:19</div></div><div class="posttext">thxz for the reply again.But that wont help me I cant define &quot;shortcut name&quot; i want that to be defined by the user.Somehow have the shortcut be linked to the $INSTDIR by a variable...the exe is always the same but i would like the shortcut named after the folder..anyway to do this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">27th May 2004, 16:44</div></div><div class="posttext">In my previous post you can specify what the name of the shortcut is by populating the variable; for example:<br />
<br />
StrCpy $MyVar &quot;Shortcut Name&quot;<br />
<br />
The value within the quotes could be any value specified at runtime or compile time. All you need to do is populate it. <br />
<br />
For example; if you wanted to make the shortcut name equal $INSTDIR, then do this:<br />
<br />
StrCpy $MyVar &quot;$INSTDIR&quot;<br />
<br />
If you want it to hold some value from the registry then do this:<br />
<br />
ReadRegStr $0 &quot;HKLM&quot; &quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot; &quot;ProductName&quot;<br />
StrCpy $MyVar &quot;$0&quot;<br />
<br />
If you want to get the value from the user, you will need to use the InstallOptions to define a custom page that populates $MyVar with the value you are trying to obtain.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evilO</div><div class="date">27th May 2004, 16:58</div></div><div class="posttext">Hi :)<br />
<br />
@zimsms: right, except that a shortcut can't contain special characters, as ':' and '\'. <br />
<br />
@razor_x: Assuming your installation directory is at the drive's root, this will remove the first 3 characters and create the shortcut:<br />
<br />
StrLen $R0 $INSTDIR<br />
StrCpy $R1 $INSTDIR $R0 3<br />
<br />
CreateShortCut &quot;$DESKTOP\$R1.lnk&quot; &quot;$INSTDIR\My.exe&quot;<br />
<br />
<br />
For instance, if the installation directory is &quot;c:\blahblah&quot;, the shortcut will be named &quot;blahblah&quot;<br />
<br />
Will that do ??<br />
<br />
evilO/Olive</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">27th May 2004, 17:12</div></div><div class="posttext">True enough evilO! I didn't want to confuse razor_x with string functions. But that is a valid point. All illegal characters will have to be stripped out of the string.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">razor_x</div><div class="date">27th May 2004, 17:15</div></div><div class="posttext">thxz alot guys! got it working and learned a few things in the process...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evilO</div><div class="date">27th May 2004, 17:35</div></div><div class="posttext">Cool, so we all made our day ;) !<br />
<br />
evilO/Olive</div></div><hr />


<div class="post"><div class="posttop"><div class="username">razor_x</div><div class="date">27th May 2004, 17:44</div></div><div class="posttext">just one more question if i had to install to other than the root..could it be done some way?<br />
<br />
for example c:\blah works well but what about...c:\program files\blah?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">27th May 2004, 18:15</div></div><div class="posttext">Yes you could do that, use the reverse string search for &quot;\&quot; or &quot;/&quot; depending on the platform, the resulting value would be the very last folder name. See the string functions in the NSIS Archive.<br />
<br />
I believe it was the &quot;Advanced Search in String&quot; function<br />
<br />
Archive:String Functions (http://nsis.sourceforge.net/archive/nsisweb.php?page=122&amp;instances=0,11)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">razor_x</div><div class="date">27th May 2004, 18:19</div></div><div class="posttext">thxz again :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">27th May 2004, 18:20</div></div><div class="posttext">Your Welcome!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">razor_x</div><div class="date">27th May 2004, 18:56</div></div><div class="posttext">well i tried advancedstrstr and doesnt work well for me and i'll tell you why...<br />
<br />
Push 0  ;Loops Quantity (0 for one code execution, only accept positive numbers) <br />
<br />
the amount of &quot;\&quot; must be known for this code to work...<br />
<br />
If push Push 1 ;Loops Quantity  <br />
<br />
then C:\blah works fine...<br />
<br />
but if c:\program files\blah<br />
<br />
does not work.<br />
<br />
so again how too define this shortcut as a true variable...with as MANY or FEW backslashes as is inputed...or is there even a way?i'm thinking there is not a way but there should be.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">razor_x</div><div class="date">28th May 2004, 06:30</div></div><div class="posttext">nvm...<br />
<br />
found this function in the archive and works great.<br />
<br />
get last directory part (http://nsis.sourceforge.net/archive/nsisweb.php?page=221&amp;instances=0,11,211) <br />
<br />
please excuse my newbness.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">28th May 2004, 13:45</div></div><div class="posttext">Not a problem, learning something new is always a challenge; especially under deadlines!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>