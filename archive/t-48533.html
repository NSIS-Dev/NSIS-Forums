<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Justin?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Justin? NSIS Discussion" />
	
	<title> Justin? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Justin?</div>
<hr />
<div class="pda"><a href="t-48533.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=48533">Justin?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">30th April 2001, 13:55</div></div><div class="posttext">Sorry to post this again, but I've been fiddling for ages to try and get it working, no one here seems to know what to do, and the original thread seems to have been forgotten...I hope I don't get into too much trouble! :(<br />
<br />
Hi all,<br />
<br />
For some reason, this code doesn't work right. If yes, the program should run and the installer should quit. If no, the installer should stay put and let the user see the details. It quits though, no matter what is chosen!<br />
<br />
Am I doing something wrong?<br />
<br />
AutoCloseWindow False<br />
MessageBox MB_YESNO|MB_ICONQUESTION &quot;Would you like to run it now?&quot; IDNO 2<br />
AutoCloseWindow True<br />
Exec &quot;$INSTDIR\IT.EXE&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">30th April 2001, 16:37</div></div><div class="posttext">I believe the compiler options are set at compile time, so the AutoCloseWindow is parsed regardless of the jump statement.  If you are using the new version, labels are required instead of numbers for the jumps.<br />
<br />
You may want to try putting the statements in a !ifdef and !ifndef instead.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yazno</div><div class="date">30th April 2001, 18:49</div></div><div class="posttext">hi,<br />
<br />
what you are trying to do is not possible at the moment.<br />
<br />
-<br />
<br />
justin .. would it be possible to make it so that you are able to set defines within functions ?<br />
<br />
for example:<br />
<br />
Function ASK<br />
MessageBox MB_YESNO|MB_ICONQUESTION &quot;Would you like to run it now?&quot; IDNO END<br />
!define close<br />
ExecShell open &quot;$INSTDIR&quot;<br />
END:<br />
FunctionEnd<br />
<br />
!ifdef close<br />
autoclosewindow true<br />
!endif<br />
<br />
Section &quot;Required&quot;<br />
SetOutPath -<br />
call ask<br />
SectionEnd<br />
<br />
or better yet to call the .onInstSuccess and .onInstFailed Callbacks when finished with installing and not when pushing the close button ?<br />
<br />
cu yzo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kaboon</div><div class="date">2nd May 2001, 21:02</div></div><div class="posttext">In case you didn't figured it out yet... :)<br />
<br />
<br />
Function .onInstSuccess<br />
  MessageBox MB_YESNO|MB_ICONQUESTION \<br />
             &quot;Setup has completed. Run PROGRAM now?&quot; \<br />
             IDNO NoExec<br />
    ExecShell open '$INSTDIR\PROGRAM.exe'<br />
  NoExec:<br />
FunctionEnd<br />
<br />
<br />
Past that above the un-install code</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yazno</div><div class="date">2nd May 2001, 21:45</div></div><div class="posttext">kaboon,<br />
<br />
.onInstSuccess is called _after_ you push the close button!<br />
<br />
that is not what petersa wanted.<br />
<br />
cu yzo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kaboon</div><div class="date">2nd May 2001, 22:21</div></div><div class="posttext">I'm sorry wasn't paying 100% attention here. :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">3rd May 2001, 12:33</div></div><div class="posttext">Sorry, I haven't explained myself properly.<br />
<br />
What I want to happen, is the install to finish its copying, and throw the message box up. Depending on the answer, it should either do or don't close the box.<br />
<br />
Since it isn't a feature, can this be put in, please?<br />
<br />
As for the labels, I wrote this before labels were invented... :)<br />
<br />
Alex</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kaboon</div><div class="date">3rd May 2001, 18:36</div></div><div class="posttext">I still don't get it...<br />
<br />
yazno and petersa, I still think that this will work:<br />
<br />
AutoCloseWindow true<br />
<br />
Function .onInstSuccess<br />
  MessageBox MB_YESNO|MB_ICONQUESTION \<br />
             &quot;Setup has completed. Run ProgramX now?&quot; \<br />
             IDNO NoExec<br />
    ExecShell open '$INSTDIR\ProgramX.exe'<br />
  NoExec:<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">3rd May 2001, 21:06</div></div><div class="posttext">But they don't want to close the window to close automatically IIRC.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">4th May 2001, 07:05</div></div><div class="posttext">Okay,<br />
<br />
I want to ask the user if they want to run the program. If they do, I want the installer to close. If they don't, I want the installer to stay open so they can look at what went on.<br />
<br />
Alex</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yazno</div><div class="date">4th May 2001, 09:36</div></div><div class="posttext">well,<br />
<br />
like i said, you won't be able to do that with the normal commands, but it is still possible.<br />
<br />
1. make an installer like this:<br />
<br />
----- cut ------<br />
<br />
Name &quot; &quot;<br />
OutFile closeinstaller.exe<br />
SilentInstall silent<br />
CRCCheck off<br />
<br />
Section &quot;&quot;<br />
FindWindowByTitle close 'test Setup: Installing Files'<br />
FindWindowByTitle close 'test Setup: Completed'<br />
Delete /REBOOTOK $TEMP\closeinstaller.exe<br />
SectionEnd<br />
<br />
------ cut ------<br />
<br />
then make your normal installer like this:<br />
<br />
------- cut -----<br />
<br />
Name test<br />
OutFile test_setup.exe<br />
InstallDir $PROGRAMFILES\TEST<br />
AutoCloseWindow false<br />
<br />
Function WannaRun<br />
MessageBox MB_YESNO 'Run the program now?' IDNO CLOSE<br />
SetOutPath $TEMP<br />
File closeinstaller.exe<br />
Exec $INSTDIR\whatever.exe<br />
Exec $TEMP\closeinstaller.exe<br />
CLOSE:<br />
FunctionEnd<br />
<br />
Section &quot;&quot;<br />
SetOutPath -<br />
File whatever.exe<br />
Call WannaRun<br />
SectionEnd<br />
<br />
---- cut -----<br />
<br />
thats it .. <br />
<br />
btw: Justin, please implement a CloseSetup command!!<br />
<br />
cu yzo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yazno</div><div class="date">8th May 2001, 05:20</div></div><div class="posttext">hi, <br />
<br />
since nsis 1.42 is out and with it 'SetAutoClose', it is possible now!<br />
<br />
Function WannaRun <br />
MessageBox MB_YESNO 'Run the program now?' IDNO lbl_end<br />
SetAutoClose true<br />
Exec whatever.exe <br />
lbl_end:<br />
FunctionEnd <br />
<br />
thx justin!<br />
<br />
cu yzo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">9th May 2001, 01:10</div></div><div class="posttext">Thanks yzo! Thanks Justin!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>