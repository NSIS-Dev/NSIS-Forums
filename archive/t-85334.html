<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" SetCurrentDirectory, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  SetCurrentDirectory NSIS Discussion" />
	
	<title> SetCurrentDirectory [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  SetCurrentDirectory</div>
<hr />
<div class="pda"><a href="t-85334.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=85334">SetCurrentDirectory</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">tenfour</div><div class="date">20th April 2002, 08:02</div></div><div class="posttext">In a nutshell:  How do you get NSIS to set the current directory, ala SetCurrentDirectory()?<br />
<br />
Here's my issue:  I need to UnRegDLL a COM DLL in the uninstall section.  That COM DLL is dependent on another DLL that's in the same dir as it, but of course loading the COM DLL fails because it can't find the dependency... the logical way to solve this is to use SetCurrentDirectory() to put the current directory in with the COM DLL, unregister it, and continue along.<br />
<br />
I can't seem to find a way to change the current directory in code though :/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">20th April 2002, 10:12</div></div><div class="posttext">http://firehose.net/free/nsis/makensis.htm#SetOutPath<br />
<br />
SetOutPath controls the current dir.<br />
<br />
-Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tenfour</div><div class="date">20th April 2002, 19:54</div></div><div class="posttext">That's what I thought, but that doesn't work.  SetOutPath appears only controls how NSIS will handle relative paths, it doesn't actually SetCurrentDirectory.<br />
<br />
I've tried your suggestion, but UnRegDLL doesn't use $OUTDIR as the current directory.<br />
<br />
tenfour</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">21st April 2002, 09:14</div></div><div class="posttext">tenfour,<br />
<br />
I'm not sure that I understand what you want to do, but anyway, here's a dll that sets and gets (for checking purpose) the current dir. Does it work now?<br />
<br />
Good luck, greetz,<br />
-Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st April 2002, 14:17</div></div><div class="posttext">Here is one without using any DLL or source changing:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=79913</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tenfour</div><div class="date">21st April 2002, 23:17</div></div><div class="posttext">Wow, thank you so much :)  I didn't see that other thread.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">22nd April 2002, 07:40</div></div><div class="posttext">I forgot about this thread, sorry.<br />
<br />
-Hendri.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>