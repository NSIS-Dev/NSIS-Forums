<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstall Error, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstall Error NSIS Discussion" />
	
	<title> Uninstall Error [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstall Error</div>
<hr />
<div class="pda"><a href="t-138682.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=138682">Uninstall Error</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Jermbox</div><div class="date">11th June 2003, 20:27</div></div><div class="posttext">I am getting this strange error when I try to start the uninstall exe. I get a popup that says &quot;Error launching Installer&quot;. I pulled everything out of the uninstall section except the basics, and still get the same results. See code below:<br />
<br />
; Write the uninstall keys for Windows<br />
  WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\RT Workstation&quot; &quot;DisplayName&quot; &quot;RT Workstation (remove only)&quot;<br />
  WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\RT Workstation&quot; &quot;UninstallString&quot; &quot;$INSTDIR\Uninst.exe&quot;<br />
WriteUninstaller &quot;$INSTDIR\Uninst.exe&quot;<br />
SectionEnd<br />
<br />
Section &quot;Shortcuts&quot;<br />
  ;Add Shortcuts<br />
SectionEnd<br />
<br />
UninstallText &quot;This will uninstall RT Workstation from your system&quot;<br />
UninstallIcon &quot;E:\Files\Projects\Install\isicon.ico&quot;<br />
<br />
Section Uninstall<br />
  ;Delete Files<br />
<br />
  ; Directories To Remove During Uninstall<br />
  RMDir /r &quot;$INSTDIR\BIN&quot;<br />
<br />
  ; Delete Uninstaller And Unistall Registry Entries<br />
  Delete &quot;$INSTDIR\Uninst.exe&quot;<br />
  <br />
SectionEnd<br />
<br />
I looked around in this forum but can't seem to find any info on this error. Anyone have any ideas? <br />
<br />
Thanks in advance,<br />
<br />
J</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">11th June 2003, 20:54</div></div><div class="posttext">From where you are uninstalling, via:<br />
Control panel (add/remove), start menu, or other shortcut?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ramon18</div><div class="date">11th June 2003, 21:29</div></div><div class="posttext">Can you upload you script (simplified)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jermbox</div><div class="date">11th June 2003, 21:41</div></div><div class="posttext">Here is the script... thinned out the install files list but the rest is normal.<br />
<br />
To Lobo, I have tried it both from CP,start menu and the actual unistall file itself... no luck.<br />
<br />
Thanks in advance,<br />
<br />
J</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ramon18</div><div class="date">11th June 2003, 21:44</div></div><div class="posttext">Your attach failed!?! maybe you should zip it out?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jermbox</div><div class="date">11th June 2003, 22:21</div></div><div class="posttext">Let try this again ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ramon18</div><div class="date">11th June 2003, 22:29</div></div><div class="posttext">Run for me like a charm!<br />
<br />
Perhaps problems with your OS or something, have you tried executing &quot;Uninst.exe&quot; directly from explorer or from a MS-DOS prompt?<br />
<br />
<br />
good luck<br />
Ramon</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jermbox</div><div class="date">11th June 2003, 22:43</div></div><div class="posttext">Thats strange ...<br />
<br />
tried the exe on both my XP Pro box and on a 2000 box with the same results. Mind if I ask what version of NSIS you are using? I built the installer with nsis20b3. Not sure if that matters much.<br />
<br />
Anyways, thanks for looking.<br />
<br />
J</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ramon18</div><div class="date">11th June 2003, 22:47</div></div><div class="posttext">Can you upload the Uninst.exe? (zipped)<br />
<br />
I can try it on my box, this will tell if the problem is NSIS version, <br />
<br />
btw: my version is current CVS developing version<br />
<br />
cyas<br />
Ramon</div></div><hr />


<div class="post"><div class="posttop"><div class="username">micolithe</div><div class="date">11th June 2003, 22:48</div></div><div class="posttext">It looks like a registry error.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jermbox</div><div class="date">12th June 2003, 14:18</div></div><div class="posttext">Ramon - Here is the uninst.exe file generated during the install process.<br />
<br />
J</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th June 2003, 14:19</div></div><div class="posttext">What is the content of the $TEMP variable on your computer? Does it exist? Are there any files named *~NSISu_.exe in your temporary directory? How many of them? If there are any files like that, what happens if you delete them? Does the uninstaller work again? Does it create a new one?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th June 2003, 14:20</div></div><div class="posttext">What OS are you working on?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jermbox</div><div class="date">12th June 2003, 14:48</div></div><div class="posttext">?: What is the content of the $TEMP variable on your computer?<br />
<br />
Temp=%USERPROFILE%\Local Settings\Temp<br />
<br />
?: Does it exist?<br />
<br />
Yes<br />
<br />
?: Are there any files named *~NSISu_.exe in your temporary directory?<br />
<br />
There is one file in dir, A~NSISu_.exe<br />
<br />
?: If there are any files like that, what happens if you delete them? Does the uninstaller work again? Does it create a new one?<br />
<br />
When I delete the A~NSISu_ file and run the uninstall exe again it gives same error and generates another A~NSISu_ file in the Temp dir.<br />
<br />
<br />
<br />
This machine is running WinXP Pro SP-1 but also tried it on Win2K SP-3 with same results. The only thing simlar is they both have nsis20b3 installed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th June 2003, 14:53</div></div><div class="posttext">Does the value of $TEMP literally contains %USERPROFILE% or have you taken this from another place such as the registry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jermbox</div><div class="date">12th June 2003, 15:00</div></div><div class="posttext">The value of the variable is actually %userprofile%\Local Settings\Temp , but when checked on the command line with a SET command it resolves itself to the actual dir path. When you had asked about that in your earlier post I thought maybe there might be some issue with the uninstaller being able to resolve the %userprofile% variable as the TEMP value. So, I created a dir C:\temp and adjusted the temp variable. Re-ran install and attempted uninstall with same results</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th June 2003, 16:17</div></div><div class="posttext">Can you please run the attached installer (installs nothing, just uses NSIS scripting), copy the results (right click on the list) and attach it here as a text file?<br />
<br />
I just want to be sure of some facts before we continue.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jermbox</div><div class="date">12th June 2003, 16:22</div></div><div class="posttext">Looks like the attachment didn't stick, could you post it again please.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th June 2003, 16:24</div></div><div class="posttext">Oops... Here it is.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jermbox</div><div class="date">12th June 2003, 16:35</div></div><div class="posttext">TEMP<br />
C:\Temp<br />
TEMP from HKCU\Environment<br />
C:\Temp<br />
TMP from HKCU\Environment<br />
C:\Temp<br />
TEMP from HKLM\...\Environment<br />
%SystemRoot%\TEMP<br />
TMP from HKLM\...\Environment<br />
%SystemRoot%\TEMP<br />
ReadEnvStr $0 TEMP<br />
C:\Temp<br />
ReadEnvStr $0 TMP<br />
C:\Temp<br />
ExpandEnvStrings $0 %TEMP%<br />
C:\Temp<br />
ExpandEnvStrings $0 %TMP%<br />
C:\Temp<br />
RegOpenKeyEx returned 0<br />
RegQueryValueEx returned 0<br />
TEMP is 1<br />
RegQueryValueEx returned 0<br />
TMP is 1<br />
RegCloseKey returned 0<br />
Completed</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th June 2003, 16:47</div></div><div class="posttext">Well, I was actually more interseted in the old settings.<br />
<br />
Is there any message box appearing before the &quot;Can't launch installer&quot; message box in the attached uninstaller?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jermbox</div><div class="date">12th June 2003, 17:14</div></div><div class="posttext">Ok .... this is going to sound strange but here is something interesting:<br />
<br />
I downloaded the uninst file you posted, un-zipped to the desktop and it ran without error. I then took my uninst file from the root of C:\ and brought it to the desktop and it ran fine. Copied it back to the root, ran it and got the original error. I then copied your uninst file to C:\ and also got the error. Not really sure what this means.<br />
Ideas?<br />
<br />
J <br />
<br />
:attached error message</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th June 2003, 17:23</div></div><div class="posttext">Ooh! Now I see what's the thing is. It's not a bug, it's a feature :)<br />
<br />
NSIS doesn't consider the root directory of drives to be a valid installation directory unless forced to (using AllowRootDirInstall).<br />
<br />
The error might be vague but just imagine what would have happened if you'd a RMDir /r Windows in your uninstall script...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jermbox</div><div class="date">12th June 2003, 17:45</div></div><div class="posttext">Wow... what a long road we traveled to get to this point. :)<br />
<br />
Kichik / Ramon18, Thanks alot for your help getting this figured out.<br />
I appreciate your time and effort.<br />
<br />
J.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrPeggs</div><div class="date">29th November 2007, 08:44</div></div><div class="posttext">I realise this is an ancient thread but i had the same issue today when a user installed to c:\ and then couldnt uninstall<br />
<br />
I understand the reason for having the AllowRootDirInstall flag but my question is - why on earth let people install to root if they cant uninstall? i.e. shouldnt AllowRootDirInstall (or rather the lack of) apply to the install process as well as the uninstall?<br />
<br />
or am i being dim?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th November 2007, 17:24</div></div><div class="posttext">The following simple script works perfectly fine for me and it shows AllowRootDirInstall affects both the installer and the uninstaller. Are you sure you're using the greatest and latest and that your script uses AllowRootDirInstall?Name test<br />
OutFile test.exe<br />
<br />
AllowRootDirInstall true<br />
<br />
Section<br />
WriteUninstaller C:\uninst.exe<br />
Exec &quot;C:\uninst.exe&quot;<br />
SectionEnd<br />
<br />
Section uninstall<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrPeggs</div><div class="date">4th December 2007, 09:21</div></div><div class="posttext">hi<br />
i am running version 2.30 which i realise isn't the latest and the string AllowRootDirInstall does not appear anywhere in my script, which is why i was surprised it allowed installation to C:\ if it didnt allow uninstallation.<br />
Anyway, i now see how it is meant to be used so can get round the problem if necessary</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>