<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Launch a program by accessing it's link from STARTUP, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Launch a program by accessing it's link from STARTUP NSIS Discussion" />
	
	<title> Launch a program by accessing it's link from STARTUP [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Launch a program by accessing it's link from STARTUP</div>
<hr />
<div class="pda"><a href="t-207318.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=207318">Launch a program by accessing it's link from STARTUP</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Chilli24</div><div class="date">9th February 2005, 10:41</div></div><div class="posttext">I want to launch a program by accessing it's link from STARTUP. I have tried this code, but it doesn' work. Anybody now what's the solution?<br />
<br />
ClearErrors<br />
<br />
ReadRegStr $startup HKCU &quot;Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders&quot; &quot;Startup&quot;<br />
<br />
nsExec::Exec '$startup\launchthis.lnk'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th February 2005, 10:52</div></div><div class="posttext">NSIS already has a $SMSTARTUP constant (see docs!)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Chilli24</div><div class="date">9th February 2005, 11:51</div></div><div class="posttext">I already tried that but it didn't work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">9th February 2005, 12:58</div></div><div class="posttext">Try the commands Exec or ExecShell instead of the nsExec Plugin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th February 2005, 13:21</div></div><div class="posttext">Yes you need to use ExecShell<br />
<br />
Exec is for exe files.<br />
nsExec::Exec is for command-line applications (mostly).<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Chilli24</div><div class="date">9th February 2005, 13:31</div></div><div class="posttext">OK. I tried this:<br />
ExecShell &quot;open&quot; '$SMSTARTUP\merge.lnk'<br />
And it didn't work.<br />
What's the scenario: I have a text document named merge.txt that has a shortcut into the STARTUP folder. How do I execute that shortcut ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">9th February 2005, 13:35</div></div><div class="posttext">If you made the shortcut within your installer why would you execute the shortcut to open a text file? There a different ways to open it. Try one of these:<br />
<br />
- ExecShell &quot;open&quot; &quot;Path\to\Textfile&quot;<br />
- Exec &quot;Notepad.exe&quot; &quot;Path\to\Textfile&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Chilli24</div><div class="date">9th February 2005, 14:08</div></div><div class="posttext">I've not made the shortcut within my installer. The shortcut exists on the user's computer. Any ideas now?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">9th February 2005, 14:47</div></div><div class="posttext">perhaps this helps:<br />
<br />
SetShellVarContext All/current<br />
<br />
; you should set the above to the correct value. If not it can happen that it starts in the wrong location<br />
<br />
ExecShell &quot;&quot; '$SMSTARTUP\merge.lnk'<br />
<br />
; if open is not the default action</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Chilli24</div><div class="date">10th February 2005, 09:10</div></div><div class="posttext">I've tried both SetShellVarContext current and SetShellVarContext All with <br />
ExecShell &quot;&quot; '$SMSTARTUP\merge.lnk' and ExecShell &quot;open&quot; '$SMSTARTUP\merge.lnk'<br />
It still doesn't anything. I'm very confused.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">10th February 2005, 09:33</div></div><div class="posttext">The question is does your open command point to the correct location or has nsis a problem to start link files.<br />
<br />
Perhaps you should ensure that you point to the correct location using the command &quot;IfFileExists&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Chilli24</div><div class="date">10th February 2005, 09:39</div></div><div class="posttext">The $SMSTARTUP points to the right location because I've read the path to Startup directly from the registry and it's the same as $SMSTARTUP. So this is not the problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">10th February 2005, 09:58</div></div><div class="posttext">I tested it now and for me it works.<br />
<br />
<br />
OutFile &quot;test.exe&quot;<br />
<br />
Section &quot;&quot;<br />
SetShellVarContext current<br />
IfFileExists &quot;$SMPROGRAMS\7-Zip\7-Zip File Manager.lnk&quot; file_exists<br />
MessageBox MB_OK &quot;File not found&quot;<br />
Goto Ende<br />
<br />
file_exists:<br />
ExecShell &quot;open&quot; &quot;$SMPROGRAMS\7-Zip\7-Zip File Manager.lnk&quot;<br />
ende:<br />
SectionEnd<br />
 <br />
<br />
In my test it worked with ExecShell open and ExecShell &quot;&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Chilli24</div><div class="date">10th February 2005, 10:34</div></div><div class="posttext">OK. I've tried this and it doesn't work.<br />
SetShellVarContext current<br />
IfFileExists &quot;$SMPROGRAMS\NSIS\NSIS Menu.lnk&quot; file_exists<br />
MessageBox MB_OK &quot;File not found&quot;<br />
Goto Ende<br />
file_exists:<br />
ExecShell &quot;open&quot; &quot;$SMPROGRAMS\NSIS\NSIS Menu.lnk&quot;<br />
ende:<br />
<br />
I've also tried:<br />
ExecShell &quot;&quot; &quot;$SMPROGRAMS\NSIS\NSIS Menu.lnk&quot;<br />
<br />
It doesn't say that the file does not exist but it doesn't do anything.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">10th February 2005, 10:44</div></div><div class="posttext">What Specs you have?<br />
<br />
I tested it under WINDOWS XP Pro SP1 with NSIS 2.05</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">10th February 2005, 10:54</div></div><div class="posttext">Last NSIS Menu.lnk code also works fine on Win2K Server SP2, NSIS 2.04.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Chilli24</div><div class="date">10th February 2005, 12:17</div></div><div class="posttext">On XP SP2 it didn't work. On 2000 server it works. I'll have to see it works on 2003 server too. Everybody, thanks for your help.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>