<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" HKCU - Multiuser changes, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  HKCU - Multiuser changes NSIS Discussion" />
	
	<title> HKCU - Multiuser changes [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  HKCU - Multiuser changes</div>
<hr />
<div class="pda"><a href="t-221368.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221368">HKCU - Multiuser changes</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">DennisFeiock</div><div class="date">13th July 2005, 17:30</div></div><div class="posttext">I have been trying to think of the best way to resolve a problem I am having.<br />
<br />
What I need to do is make registry entries for each user that has logged into the PC.<br />
<br />
I can add the entries to the Default User hive (c:\Documents and Settings\Default User\ntuser.dat), but that doesnt help me with adding the changes to all the users that have logged into the PC already.<br />
<br />
The only way that I could think of to accomplish this task is to have something along the lines of EnumRegKey, but for a directory, and scan through the Documents and Settings directory.  Then, using reg.exe, load the user's HKCU hive and make the necessary changes.  Then use reg.exe again to unload the hive.  Only problem with this is that I cant find a command that would work like EnumRegKey but for directories.<br />
<br />
I just figured there had to be a better way to accomplish what Im going for.  Also, while Im thinking about it, is there a way to load a user's ntuser.dat file without scripting in reg.exe and loading it to the HKU hive?<br />
<br />
Thanks!<br />
 - DF</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th July 2005, 19:35</div></div><div class="posttext">Use EnumUsersReg (http://nsis.sourceforge.net/wiki/EnumUsersReg).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DennisFeiock</div><div class="date">14th July 2005, 20:34</div></div><div class="posttext">Works like a charm.  Thanks kichik.<br />
<br />
 - DF</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>