<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Registry update, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Registry update NSIS Discussion" />
	
	<title> Registry update [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Registry update</div>
<hr />
<div class="pda"><a href="t-280502.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=280502">Registry update</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">chamakits</div><div class="date">1st November 2007, 16:26</div></div><div class="posttext">Hey guys.  I'm having some big problems with the registry.<br />
The program for which i'm doing an installer, had already been installed into a few of our clients computers.  That version however is highly outdated, and the previous installer was...well...hard-coded to work.  The thing is, right now, the .ocx and the .dll that it used and still uses have change where they are placed.  And here comes my problem.  Before just registering my .dll and my .ocx, I want to find if the .dll and the .ocx are already registered.  If they are, I want to delete those entries, and write my new ones.  If they aren't, then just register them.  For example, right now, MSWINSCK.OCX had not been properly registered, because it was already registered in the computer where I was testing, but since it changed folder, the program wouldn't run properly.<br />
<br />
Any help would be greatly appreciated.  Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st November 2007, 19:06</div></div><div class="posttext">If the registry settings are wrong anyway, just delete them and let the new registration process properly recreate them.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chamakits</div><div class="date">1st November 2007, 19:23</div></div><div class="posttext">Yeah, but the thing is, these are clients computers.<br />
I can't go to them and one by one delete all these entries.<br />
I want to be able to search through the registry, find the key, delete it, and register the new one.<br />
<br />
I'm working on a script to do with NSIS, so, I may have it solved, but I'm having some trouble with EnumRegValue and EnumRegKey.  But i think i'll get this done soon</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st November 2007, 19:28</div></div><div class="posttext">Why would you need to search the registry if you a well defined set of registered controls? If you know what you've registered the last time, you can easily find out what to remove.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chamakits</div><div class="date">1st November 2007, 19:38</div></div><div class="posttext">Thats just it.<br />
The previous version of the program wasn't done by me.<br />
Not only that, but since there wasn't much of a formal installer, the program isn't uniform between all our clients, meaning that in different client's computers, the dlls and ocx's may be somewhere different.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st November 2007, 19:44</div></div><div class="posttext">But you can still tell which registry keys it updates. Running RegMon (http://www.microsoft.com/technet/sysinternals/utilities/regmon.mspx) in the background, while executing the old installer, might be a good start.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chamakits</div><div class="date">1st November 2007, 19:56</div></div><div class="posttext">I know which keys I want to update.  What I don't know is where they are registered in the registry, and not even exactly sure where they are located in the computer.<br />
<br />
Hm... If I did a script with NSIS that searches in the folders for those .dlls and .ocx, can i use UnRegDLL knowing their path?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st November 2007, 19:58</div></div><div class="posttext">Yes, you can UnregDLL them once you find them. But I'd recommend you find out using RegMon which registry keys they update first. One of those keys may even tell you where the DLL is located.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>