<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Is path writable?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Is path writable? NSIS Discussion" />
	
	<title> Is path writable? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Is path writable?</div>
<hr />
<div class="pda"><a href="t-209116.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=209116">Is path writable?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">aifex</div><div class="date">28th February 2005, 15:43</div></div><div class="posttext">How do i check if a Directory i writable?<br />
Im trying to make sure user don't choose wrong directory in<br />
.onVerifyInstDir<br />
<br />
Saw this function somewhere:<br />
<br />
Function .onVerifyInstDir<br />
  ClearErrors<br />
  SetOutPath $INSTDIR<br />
<br />
  FileOpen $0 ${GUID_FILE} &quot;w&quot;<br />
  FileWriteByte $0 &quot;0&quot;<br />
  IfErrors notPossible possible<br />
<br />
  notPossible:<br />
            MessageBox MB_OK &quot;Not able to write into this directory! Choose another one.&quot;<br />
            Abort<br />
  possible:<br />
           FileClose $0<br />
           Delete &quot;$INSTDIR\${GUID_FILE}&quot;<br />
<br />
  <br />
FunctionEnd<br />
<br />
<br />
This function don't work well beacuse it will create directorys that don't exist if user enters own path.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th February 2005, 16:32</div></div><div class="posttext">If you do not want the user to enter a non-existant directory path, then...<br />
<br />
Function .onVerifyInstDir<br />
IfFileExists &quot;$INSTDIR\*.*&quot; +3<br />
MessageBox MB_OK &quot;Please enter a directory path that exists!&quot;<br />
Abort<br />
<br />
ClearErrors<br />
<br />
FileOpen $0 &quot;$INSTDIR\${GUID_FILE}&quot; &quot;w&quot;<br />
FileWriteByte $0 &quot;0&quot;<br />
IfErrors 0 possible<br />
MessageBox MB_OK &quot;Not able to write into this directory! Choose another one.&quot;<br />
Abort<br />
possible:<br />
FileClose $0<br />
Delete &quot;$INSTDIR\${GUID_FILE}&quot;<br />
<br />
FunctionEnd<br />
<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aifex</div><div class="date">1st March 2005, 06:30</div></div><div class="posttext">But if they should be able to ?<br />
I there not an easy way to check if a directory is writable.<br />
<br />
The problem is that there are limited users (Not admin) that can't write to $PROGRAMFILES. So must detect if dir is valid or elese force to choose a new one.  The program will install to a new dir ($PROGRAMFILES\AppName). Perhaps to check when Finsihed is pressed? Any Ideas anyone?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Aifex</div><div class="date">1st March 2005, 07:41</div></div><div class="posttext">Ok this works.<br />
Now the directory above &quot;AppName&quot; is checked if it exist<br />
and if it's writable. This is ok. Also added this<br />
function in a    &quot;!define MUI_PAGE_CUSTOMFUNCTION_LEAVE &quot;DirectoryLeave&quot; Function &quot;  so user can't type wrong path.<br />
<br />
Can I stop user from using EditBox? <br />
<br />
<br />
<br />
<br />
InstallDir &quot;$PROGRAMFILES\AppName&quot;<br />
...<br />
...<br />
;This function verifyes that output directory is writable<br />
Function .onVerifyInstDir<br />
<br />
  IfFileExists &quot;$INSTDIR\..\*.*&quot; +3<br />
  MessageBox MB_OK &quot;Please enter a directory path that exists!&quot;<br />
  Abort<br />
<br />
  ClearErrors<br />
<br />
  FileOpen $0 &quot;$INSTDIR\..\${GUID_FILE}&quot; &quot;w&quot;<br />
  FileWriteByte $0 &quot;0&quot;<br />
  IfErrors notPossible possible<br />
<br />
  notPossible:<br />
            MessageBox MB_OK &quot;Not able to write into this directory! Choose another one.&quot;<br />
            Abort<br />
  possible:<br />
           FileClose $0<br />
           Delete &quot;$INSTDIR\..\${GUID_FILE}&quot;<br />
<br />
  <br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st March 2005, 18:28</div></div><div class="posttext">I'd simply put the original check in the leave function. This way, only when the user clicks next the directory will be created. If it's writable, you're good to go. Only the directory the user wants to create will be created because he already clicked next.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>