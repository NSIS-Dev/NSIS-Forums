<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Killing a process by PID, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Killing a process by PID NSIS Discussion" />
	
	<title> Killing a process by PID [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Killing a process by PID</div>
<hr />
<div class="pda"><a href="t-302352.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=302352">Killing a process by PID</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Ivan Andreevich</div><div class="date">23rd January 2009, 01:12</div></div><div class="posttext">There seem to be 4 plugins for process destruction -<br />
1) http://nsis.sourceforge.net/Processes_plug-in<br />
2) http://nsis.sourceforge.net/NsProcess_plugin<br />
3) http://nsis.sourceforge.net/KillProc_plug-in<br />
4) http://nsis.sourceforge.net/KillProcDLL_plug-in<br />
<br />
Did I miss any?<br />
<br />
However, none of these have an option of killing a process by PID (process id). Is there a way to do this without modifying an existing plugin?<br />
<br />
Thanks,<br />
Ivan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd January 2009, 11:06</div></div><div class="posttext">I don't know of any plug-in that would allow you to do that. I have to wonder though, why would you want to do that? In some point, you have to get that PID by its name. Why not use the name again?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">23rd January 2009, 12:04</div></div><div class="posttext">thats not 100% true, some unix ported stuff put their pid in a textfile on startup. Or maybe you just had a HWND and wanted to kill its process</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ivan Andreevich</div><div class="date">23rd January 2009, 18:10</div></div><div class="posttext">Originally posted by kichik <br />
I don't know of any plug-in that would allow you to do that. I have to wonder though, why would you want to do that? In some point, you have to get that PID by its name. Why not use the name again? <br />
I install and uninstall a DLL. Sometimes that DLL is in use by mmc.exe. However, that can be many things, and I just want to kill the ones using it and leave the other ones. <br />
<br />
So far my best bet I found so far is http://www.tech-recipes.com/rx/446/xp_kill_windows_process_command_line_taskkill/ via nsExec</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd January 2009, 18:39</div></div><div class="posttext">That could be so dangerous... You could find yourself killing an important system service. You should use the LockedList plug-in (http://nsis.sourceforge.net/LockedList_plug-in) instead and let the user exit those programs.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">23rd January 2009, 18:46</div></div><div class="posttext">If you just want to kill a process by PID, you can simply call the TerminateProcess function, which is part of the Win32 API, using the NSIS System Plugin:<br />
* http://msdn.microsoft.com/en-us/library/ms686714(VS.85).aspx<br />
* http://nsis.sourceforge.net/Docs/System/System.html<br />
<br />
No need for a special plugin. But as mentioned already, this is dangerous, if you did not obtain the PID of the target process properly. Processes tend to have different PID's each run ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ivan Andreevich</div><div class="date">23rd January 2009, 18:59</div></div><div class="posttext">Originally posted by kichik <br />
That could be so dangerous... You could find yourself killing an important system service. You should use the LockedList plug-in (http://nsis.sourceforge.net/LockedList_plug-in) instead and let the user exit those programs.  <br />
That plugin is AWESOME, thanks for pointing it out for me! I will use it for a regular installation.<br />
<br />
However, the other part of my installation must happen unattended on a remote machine. So I still need to kill processes by PID.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">23rd January 2009, 19:38</div></div><div class="posttext">If you need to terminate a service, use &quot;net.exe stop &lt;service_name&gt;&quot; instead of killing a process by PID. Even if you obtained the PID by process name, your service most likely is running in &quot;svchost.exe&quot;, so you'd have to kill ALL instances of svchost.exe. Unfortunately this way you will kill many important system services, as several services can run in one process. And you even can't now which instance of &quot;svchost.exe&quot; does contain YOUR service...<br />
<br />
Also note that LockedList can work in a &quot;silent&quot; way !!!<br />
<br />
  LockedList::AddCaption /NOUNLOAD &quot;*Chrome&quot;<br />
  LockedList::AddCaption /NOUNLOAD &quot;*Chromium&quot;<br />
  LockedList::AddModule /NOUNLOAD &quot;$EXEDIR\chrome.exe&quot;<br />
  LockedList::AddModule /NOUNLOAD &quot;$EXEDIR\chrome.dll&quot;<br />
  LockedList::AddModule /NOUNLOAD &quot;$EXEDIR\icudt38.dll&quot;<br />
  LockedList::AddModule /NOUNLOAD &quot;$EXEDIR\themes\default.dll&quot;<br />
  LockedList::AddModule /NOUNLOAD &quot;$EXEDIR\plugins\gears\gears.dll&quot;<br />
  LockedList::SilentSearch</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ivan Andreevich</div><div class="date">23rd January 2009, 20:18</div></div><div class="posttext">Originally posted by LoRd_MuldeR <br />
If you need to terminate a service, use &quot;net.exe stop &lt;service_name&gt;&quot; instead of killing a process by PID. Even if you obtained the PID by process name, your service most likely is running in &quot;svchost.exe&quot;, so you'd have to kill ALL instances of svchost.exe. Unfortunately this way you will kill many important system services, as several services can run in one process. And you even can't now which instance of &quot;svchost.exe&quot; does contain YOUR service...<br />
<br />
Also note that LockedList can work in a &quot;silent&quot; way !!!<br />
<br />
  LockedList::AddCaption /NOUNLOAD &quot;*Chrome&quot;<br />
  LockedList::AddCaption /NOUNLOAD &quot;*Chromium&quot;<br />
  LockedList::AddModule /NOUNLOAD &quot;$EXEDIR\chrome.exe&quot;<br />
  LockedList::AddModule /NOUNLOAD &quot;$EXEDIR\chrome.dll&quot;<br />
  LockedList::AddModule /NOUNLOAD &quot;$EXEDIR\icudt38.dll&quot;<br />
  LockedList::AddModule /NOUNLOAD &quot;$EXEDIR\themes\default.dll&quot;<br />
  LockedList::AddModule /NOUNLOAD &quot;$EXEDIR\plugins\gears\gears.dll&quot;<br />
  LockedList::SilentSearch  <br />
Yeap, noticed the silent way. Not sure if it fulfills all my req's, but I'll give it a shot.<br />
<br />
I obtain the PIDs of the processes using my dll via http://www.tech-recipes.com/rx/679/xp_tasklist_get_list_processes_command_line/<br />
tasklist /m name.dll<br />
<br />
After that I can kill by PID selectively. It's not supposed to always work - i.e. if my DLL is used over network, it's svchost.exe and I cannot terminate it. However, I do want a best effort solution.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>