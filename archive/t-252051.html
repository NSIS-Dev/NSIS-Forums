<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with install forcing app shutdown - Tried multiple solutions - Please comment, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with install forcing app shutdown - Tried multiple solutions - Please comment NSIS Discussion" />
	
	<title> Problem with install forcing app shutdown - Tried multiple solutions - Please comment [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with install forcing app shutdown - Tried multiple solutions - Please comment</div>
<hr />
<div class="pda"><a href="t-252051.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=252051">Problem with install forcing app shutdown - Tried multiple solutions - Please comment</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Webree</div><div class="date">27th July 2006, 12:05</div></div><div class="posttext">Hi guys,<br />
<br />
I'm trying to force a shutdown of a VB6 application with a system tray icon. The main form is docked above the Windows taskbar (Locked into position and decreases desktop workable area, APPBAR class for those of you who know).<br />
<br />
I've tried multiple ways of shutting down the application on Install/Uninstall, I need this implemented effectively for the &quot;Live Update&quot; procedure within my APP.<br />
<br />
I've tried the common SendMessage {WM_CLOSE} - and also Takhir's Find and Close or Terminate Plugin (http://nsis.sourceforge.net/Close_or_Terminate) <br />
<br />
The FCT plugin DOES shut down my toolbar, I get my window space back (It undocks) and every thing shuts down and then restarts once installed.<br />
<br />
But... Two problems...<br />
<br />
Once in a while I will see a windows error dialog popup (Windows recovered from an error, Send report, dont send report). That's something I really need to avoid...<br />
<br />
Also: The System Tray icon remains in the tray. So upon restarting, there are 2 icons present until the ghost one is hovered over.<br />
<br />
Perhaps this is something I need to program into my app, but all your comments or alternatives would be appreciated!<br />
<br />
Regards,<br />
Steve</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th July 2006, 13:48</div></div><div class="posttext">If the icon is still there after you're closing it with the FCT plugin then that means that FCT couldn't close it with WM_CLOSE and terminated it instead.<br />
<br />
WM_CLOSE doesn't close the window?<br />
What if you put End in the closing event in your VB app?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Webree</div><div class="date">27th July 2006, 15:22</div></div><div class="posttext">I tried End... The first time the icon disappeared, but subsequent tries -&gt; Still the same problem.<br />
<br />
It's not a consistent thing, which is the most annoying part.<br />
<br />
It may show a windows error, it may not.<br />
It may leave a locked dock space where the toolbar used to be, it may not.<br />
<br />
Is it possible to send a call to my app which will trigger a function programmed into my app via NSIS? Then I can program a clean shutdown within the app itself invoked by the installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th July 2006, 17:33</div></div><div class="posttext">Are you sure you aren't meant to remove the icon yourself (i.e. from in the app closing event)?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">27th July 2006, 18:58</div></div><div class="posttext">We need to clarify the situation. So what I understood. Sometimes FCT closes your application with WM_CLOSE and everything is OK. But termination is still often situation and may cause application internal error (with 'error report' dialog) or may not, in both cases tray icon stays undeleted. The main question is why app's reactions on WM_CLOSE differ? Just tested with 2 old VP apps - works fine. Is your program busy with some tasks? Increase timeout this case. Latest FCT version also includes WM_SYSCOMMAND-SC_CLOSE option, may be this can help.<br />
About interprocess communication - I not used VB for a long time and not sure what can be implemented, but simple ways are DDE, WM_COPY, Mailslots.<br />
But I still guess that the best way is to understand why application behavior on WM_CLOSE is so strange.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>