<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" detect a soft run or not before NSIS uninstall, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  detect a soft run or not before NSIS uninstall NSIS Discussion" />
	
	<title> detect a soft run or not before NSIS uninstall [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  detect a soft run or not before NSIS uninstall</div>
<hr />
<div class="pda"><a href="t-224126.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=224126">detect a soft run or not before NSIS uninstall</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">foruok</div><div class="date">17th August 2005, 08:50</div></div><div class="posttext">I'd made a NSIS installer,it will generate an uninstaller when the user run it.I want to know  whether my software is in use before the user  uninstall it. If my software is running, uninstaller should notify the user to close it before uninstall.<br />
<br />
What shall I do?<br />
<br />
I can't find the function to enumerate the processes on client system with NSIS script language.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">17th August 2005, 11:06</div></div><div class="posttext">You can try the FindProcDLL plugin which you can get on the NSIS Wiki:<br />
<br />
http://nsis.sourceforge.net/wiki/Find_Process_By_Name<br />
<br />
If you want to cut down on space (e.g. not use a DLL) you can try FindWindow instead...<br />
<br />
  FindWindow $R0 &quot;&quot; &quot;application title&quot;<br />
  IsWindow $R0 0 +3<br />
  MessageBox MB_RETRYCANCEL|MB_ICONEXCLAMATION &quot;Close blah?&quot; IDRETRY -2<br />
  Abort<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">foruok</div><div class="date">18th August 2005, 04:27</div></div><div class="posttext">Afrow UK:<br />
thanks a lot.<br />
This problem had been resolved.<br />
I make a little program with C(enumerate and search certain process),then call it with ExecShell.<br />
<br />
I have another question.<br />
<br />
In NSIS manual,some explains about function FindWindow like this:<br />
  FindWindow user_var(hwnd output) windowclass [windowtitle] [windowparent] [childafter]<br />
<br />
If I don't know the &quot;windowsclass&quot; and &quot;windowtitle&quot; ,they will be generated by system when some app run. e.g.,when I install a protocol driver without microsoft's digital authentication,client OS will pop up some windows to notify the user:&quot;this driver has no digital authentication,continue or abort or get the authentication now&quot;. I want to capture these windows,then send close message(or other message,such as WM_LBUTTONDOWN) to them <br />
. I don't want to see these windows,I will try to close them by some message.<br />
<br />
I will use NSIS to install a driver.....<br />
<br />
I'm poor in English,sorry.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>