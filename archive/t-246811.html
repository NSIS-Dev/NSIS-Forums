<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Message Box Problem with MUI_INSTALLOPTIONS_WRITE, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Message Box Problem with MUI_INSTALLOPTIONS_WRITE NSIS Discussion" />
	
	<title> Message Box Problem with MUI_INSTALLOPTIONS_WRITE [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Message Box Problem with MUI_INSTALLOPTIONS_WRITE</div>
<hr />
<div class="pda"><a href="t-246811.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246811">Message Box Problem with MUI_INSTALLOPTIONS_WRITE</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">tbednarz</div><div class="date">23rd May 2006, 07:29</div></div><div class="posttext">When using MUI_INSTALLOPTIONS_WRITE, message Boxes show only ONE line and CUT the text after the first escaped CR/LF($\n)!<br />
<br />
I have the following code:<br />
<br />
;------- Validation Messages ------<br />
LangString SK-TEXT_VALIDATE1 ${LANG_ENGLISH} &quot;Please enter a correct subscription key.$\n(16 characters without any spaces or dashes)&quot;<br />
LangString SK-TEXT_VALIDATE1 ${LANG_GERMAN} &quot;Bitte geben Sie einen korrekten Abonnements-Key ein.$\n(16 Zeichen ohne Leerzeichen oder Bindestriche)&quot;<br />
<br />
....<br />
<br />
; -- Language specific validation error messages<br />
!insertmacro MUI_INSTALLOPTIONS_WRITE &quot;SubscriptionKey.ini&quot; &quot;Field 3&quot; &quot;ValidateText&quot; &quot;$(SK-TEXT_VALIDATE1)&quot;<br />
<br />
If an illeagal or wrong string is entered, an error meassage appears. The problem is, that only the text BEFORE the CR/LF is shown. If I do NOT add CR/LF the whole screensize is used before it wraps text!<br />
<br />
Is this a bug and is there an work-around? Just as a sidenote: If I use <br />
<br />
MessageBox MB_RETRYCANCEL|MB_ICONSTOP &quot;$(SK-ERROR_INETCALLFAILED)&quot; IDRETRY Loop<br />
<br />
to display an error message, the escaped CR/LF work just fine!<br />
<br />
Many thanks for your help.<br />
<br />
Tom</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">23rd May 2006, 12:00</div></div><div class="posttext">From InstallOption documentation:<br />
&quot;For Text fields with the MULTILINE flag, \r\n will be converted to a newline.&quot;<br />
You may want to refer to IO documentation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tbednarz</div><div class="date">23rd May 2006, 15:52</div></div><div class="posttext">I tried all combinations (\n, \r, \r\n, \n\r) and NONE does work!<br />
<br />
Tom</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">23rd May 2006, 17:10</div></div><div class="posttext">This:<br />
&quot;SubscriptionKey.ini&quot; &quot;Field 3&quot; &quot;ValidateText&quot;<br />
is not a valid IO ini file<br />
Should be:<br />
&quot;SubscriptionKey.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
and that &quot;Field 3&quot; must be a Text field with MULTILINE flags.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">25th May 2006, 11:59</div></div><div class="posttext">Completely misunderstood the reference on ValidateText above :-) Sorry guys...<br />
Anyway I made an own test thus the new line issue works fine for this test.<br />
!define Valid_Text &quot;Error\r\nYou must type something here\r\n\<br />
between 4 to 8 chars max.\r\nPlease try again&quot;<br />
<br />
outfile 'test.exe'<br />
<br />
page license<br />
page custom page_test<br />
page instfiles<br />
<br />
function .onInit<br />
InitPluginsDir<br />
file /oname=$PLUGINSDIR\validtest.ini 'validtest.ini'<br />
functionend<br />
<br />
function page_test<br />
WriteIniStr '$PLUGINSDIR\validtest.ini' 'Field 1' 'ValidateText' &quot;${Valid_Text}&quot;<br />
Push $0<br />
InstallOptions::initDialog /NOUNLOAD '$PLUGINSDIR\validtest.ini'<br />
Pop $0<br />
InstallOptions::show<br />
Pop $0<br />
functionend<br />
<br />
section -<br />
sectionend<br />
 ; name it validtest.ini<br />
[Settings]<br />
NumFields=1<br />
<br />
[Field 1]<br />
Type=Text<br />
MaxLen=8<br />
MinLen=4<br />
ValidateText=error<br />
State=Text Field<br />
Left=30<br />
Right=120<br />
Top=12<br />
Bottom=25</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th May 2006, 15:14</div></div><div class="posttext">You need to use \r\n (without the $).<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tbednarz</div><div class="date">26th May 2006, 08:23</div></div><div class="posttext">Huuuuh! The $-sign was the problem. I thought escaping sequencies must start with a $-sign? <br />
<br />
At least in the help file, chapter '4.1 Script File format' it says:<br />
<br />
...<br />
Strings<br />
...<br />
It is also possible to put newlines, tabs etc. in a string using $\r, $\n, $\t etc. More information...<br />
<br />
.....<br />
<br />
However without the $ sign it works perfect. Thanks a lot for your help guys!<br />
<br />
Tom</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th May 2006, 08:36</div></div><div class="posttext">That applies to NSIS code, not InstallOptions INI files.<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>