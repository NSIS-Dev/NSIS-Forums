<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" HOWTO: Install multimple versions of .NET Framework, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  HOWTO: Install multimple versions of .NET Framework NSIS Discussion" />
	
	<title> HOWTO: Install multimple versions of .NET Framework [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  HOWTO: Install multimple versions of .NET Framework</div>
<hr />
<div class="pda"><a href="t-257009.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257009">HOWTO: Install multimple versions of .NET Framework</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">RaggieSoft</div><div class="date">7th October 2006, 00:14</div></div><div class="posttext">My program needs .NET 2.0 and a 3rd party DLL I use requires .NET 1.1.  I found this that may help: Microsoft Component Installer (Download from Microsoft for Free (http://www.microsoft.com/downloads/info.aspx?na=47&amp;p=1&amp;SrcDisplayLang=en&amp;SrcCategoryId=&amp;SrcFamilyId=cd11be5a-c735-48d9-9cdd-a6d211c2e1c1&amp;u=details.aspx%3ffamilyid%3d2A5E4EBC-651C-40AA-9525-1810AF47C317%26displaylang%3den))<br />
<br />
See it in action on my site as it makes sure your system has:<br />
<br />
.NET 1.1<br />
.NET 1.1 SP1<br />
J# 1.1<br />
J# 2.0<br />
Windows Installer 3.1<br />
<br />
See Component Installer in Action (http://www.kmmr.org/products/tstore/download.htm) <br />
<br />
Any developers out there who can help me integrate this into my main installer?  Attached is my NSI file  My email address is mragsdale (at) kmmr dot org<br />
<br />
Here's how MS Component Installer works:<br />
1. uses psetup.ini to see what I want updated<br />
2. downloads from MS and installs components as needed<br />
3. reboots as needed (the tool does remember where it left off after reboot)<br />
<br />
Start: Copy of &quot;psetup.ini&quot; I created:<br />
<br />
; The following products are supported in the bootstrapper. They will be installed in the<br />
; order of this comment block, assuming each is &quot;Yes&quot; in the key/value section below. Note that<br />
; you will need to ensure each product's prerequisites are installed for each install to succeed.<br />
; In other words, don't say &quot;no&quot; for DotNetFW11 if you're installing the SP1 unless you're quite<br />
; sure the .NET Framework 1.1 will already be installed on all machines. Note that saying &quot;Yes&quot; <br />
; will only initiate the install if that product is not installed (detected at runtime).<br />
;<br />
; MDAC28 - Microsoft Data Access Components 2.8<br />
; MSI20 - Microsoft Windows Installer 2.0<br />
; MSI31 - Microsoft Windows Installer 3.0<br />
; DotNetFW11 - .NET Framework 1.1 Redist<br />
; DotNetFW11SP1 - .NET Framework 1.1 Service Pack 1 Redist<br />
; DotNetFW20 - .NET Framework 2.0 Redist (prerelease)<br />
; DirectX9 - DirectX 9.0c Redist<br />
; Sql2005Express - SQL 2005 Express<br />
; VSTO2005 - Visual Studio Tools for Office 2005<br />
; ReportViewer2005 - Report Viewer 2005<br />
; JSharp11 - J# 1.1 redist<br />
; JSharp20 - J# 2.0 redist<br />
;<br />
; PostInstallAction - This text will be passed to ShellExecute when the installer completes<br />
; successfully. It can be a URL, local path, or anything you can execute from the command line.<br />
<br />
[prereqchecks]<br />
MDAC28=Yes<br />
MSI20=Yes<br />
MSI31=Yes<br />
DotNetFW11=Yes<br />
DotNetFW11SP1=Yes<br />
DotNetFW20=Yes<br />
DirectX9=Yes<br />
Sql2005Express=No<br />
VSTO2005=No<br />
ReportViewer2005=No<br />
JSharp11=Yes<br />
JSharp20=Yes<br />
PostInstallAction=<br />
<br />
<br />
End: Copy of &quot;psetup.ini&quot; I created.<br />
<br />
What I'd like to do:<br />
1. uses downloads my Setup EXE<br />
2. it downloads (using NSISdl::download) Component Installer<br />
3. Component Installer updates (and reboots go figure) as needed<br />
4. user is returned to my setup to continue installation<br />
<br />
The problem is that I won't know what the filename for my Setup EXE will be called (in case the uses &quot;Saves Link As&quot; and gives a new file name).  Is there a way to figure this out in the NSIS script?  I do know how to write to the RunOnce Registry key for post boot action.<br />
<br />
I'm kinda new at NSIS (but I'm already hooked, so I'm switching from InstallShield 12).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>