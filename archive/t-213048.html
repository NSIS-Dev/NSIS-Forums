<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" RegDLL not working with SP2??, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  RegDLL not working with SP2?? NSIS Discussion" />
	
	<title> RegDLL not working with SP2?? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  RegDLL not working with SP2??</div>
<hr />
<div class="pda"><a href="t-213048.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=213048">RegDLL not working with SP2??</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">miakki</div><div class="date">13th April 2005, 01:59</div></div><div class="posttext">Hi everybody! <br />
<br />
I just installed SP2 on my XP machine, and all of a sudden my BHO (which is an dll) refuses to register. <br />
<br />
There's no warning message or anything, it just doesn't register.. <br />
<br />
EDIT:  It works great when registering the dll without using the installer &quot;regsvr.exe /i DLL&quot; <br />
<br />
What could this be??<br />
<br />
Please help. <br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th April 2005, 11:20</div></div><div class="posttext">Do you mean &quot;with regsvr.exe&quot; and it doesn't work with RegDLL?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">miakki</div><div class="date">13th April 2005, 15:09</div></div><div class="posttext">Hi! <br />
<br />
Yes, it go to start-&gt;run and enter: <br />
<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
regsvr32 /i C:\thefile.dll <br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
<br />
It works fine! <br />
<br />
But if I have the NSIS script trying to install it nothing happens (however, it does work great on my other machine which have SP1) <br />
<br />
Here the script: <br />
<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
Function .onInit<br />
	SetOutPath &quot;$DESKTOP&quot;<br />
	File &quot;thefile.dll&quot;<br />
	RegDLL &quot;$DESKTOP\thefile.dll&quot;<br />
FunctionEnd<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
<br />
No error message or anything.. it just doesn't install, but it gets extracted to the desktop. <br />
<br />
<br />
Any idea?? <br />
<br />
<br />
I've been trying to fix this for hours.. help!  :/ <br />
<br />
<br />
Thank you!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">miakki</div><div class="date">13th April 2005, 22:53</div></div><div class="posttext">any help would be highly appreciated, I'm going nuts! <br />
<br />
thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">14th April 2005, 00:51</div></div><div class="posttext">Here are some miscellaneous comments that might help:<br />
<br />
In your example, you say you used Regsvr32 to register the file.  You say you used the command:regsvr32 /i C:\thefile.dll   However, I noticed that in your actual script, you used a slighly different path. RegDLL &quot;$DESKTOP\thefile.dll&quot;.  Therefore, my first suggestion would be to change your installer to use the same path as your REGSVR32 test command line and see what happens.<br />
<br />
Another thing you might try is looking for the error flag after calling RegDLL.  (According to the documentation, the error flag is raised if the DLL could not be registered.  But this does not mean that an physical error will be generated.)  Try adding this bit of code directly after calling RegDLL:<br />
<br />
IfErrors dllFailed dllOk<br />
dllFailed:<br />
MessageBox MB_ICONEXCLAMATION|MB_OK &quot;DLL Register failed!&quot;<br />
Goto end<br />
dllok:<br />
MessageBox MB_ICONINFORMATION|MB_OK &quot;DLL Register OK.&quot;<br />
end:<br />
FunctionEnd<br />
<br />
This will allow to to detect if there are actually errors or not.<br />
<br />
Finally, I'd make sure you that you are logged into the XP box as an administrator.  Security seemed to be a driving force behind SP2.  You may not have permissions to do the things you once could before.  By being logged in as admin, you'll have removed one more thing from the list of &quot;unknowns&quot;.<br />
<br />
Hope this helps!;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">miakki</div><div class="date">14th April 2005, 02:49</div></div><div class="posttext">Thanks a lot for your help comperio, however, nothing helped :(  Actually, I'm even more confused now.. <br />
<br />
<br />
I added the code you supplied right after the RegDLL, and nothing happened.. <br />
<br />
Since I have tested all of this with a silent installer, I didn't know of the fact that the installer simply exit when trying to Reg the dll! <br />
<br />
Now why is this?<br />
<br />
I checked, and I'm still Administrator.. <br />
<br />
<br />
Could it be that there's something wronf with the DLL? But would some issue with the DLL really make the installer exit without any message? <br />
<br />
<br />
<br />
Gee.. I'm banging my head over here.. =) <br />
<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">miakki</div><div class="date">14th April 2005, 03:22</div></div><div class="posttext">OK, I just solved it: <br />
<br />
Applications compressed with the popular application/encryptor teLock, can't be executed/registered by an NSIS installer on SP2.  <br />
<br />
I think...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">14th April 2005, 03:27</div></div><div class="posttext">&lt;&lt;edit&gt;&gt;...<br />
(I originally replied with more troubleshooting, but then saw that you figured it out, so I deleted my reply...)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">miakki</div><div class="date">14th April 2005, 03:34</div></div><div class="posttext">:) <br />
<br />
Thanks anyway! I appreciate it!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>