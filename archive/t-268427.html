<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" CoFreeUnusedLibraries call in InstallLib, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  CoFreeUnusedLibraries call in InstallLib NSIS Discussion" />
	
	<title> CoFreeUnusedLibraries call in InstallLib [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  CoFreeUnusedLibraries call in InstallLib</div>
<hr />
<div class="pda"><a href="t-268427.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=268427">CoFreeUnusedLibraries call in InstallLib</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">26th March 2007, 19:34</div></div><div class="posttext">In http://nsis.sourceforge.net/Docs/AppendixB.html#B.2.3 under LIBRARY_COM it says &quot;...to call CoFreeUnusedLibraries after registration&quot; and the Library.nsh code shows this.<br />
MSDN:<br />
CoFreeUnusedLibraries<br />
Unloads any DLLs that are no longer in use and that, when loaded, were specified to be freed automatically.<br />
Is there a reason this call is only made after registration? Why isn't it called before installation/registration also? I don't have experience with CoFreeUnusedLibraries, so I'm trying to understand its usage, but from the description it seems like you'd want to call it before installation/registration.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th March 2007, 20:46</div></div><div class="posttext">Calling it before unregistration will have no meaning because the unregistered DLL is not loaded at that stage. The idea behind this call is unloading the DLL so it can be deleted after it's unregistered.<br />
<br />
Calling it in the registration process is probably useful only for freeing unused memory. In that case as well it wouldn't make any sense calling it before the DLL was even loaded.<br />
<br />
See the original thread (http://forums.winamp.com/showthread.php?threadid=126207) for more details.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">27th March 2007, 21:36</div></div><div class="posttext">Thanks, I didn't find that older thread when researching.<br />
<br />
I had in mind the scenario of an overinstall. For example, a COM DLL is already installed and was being used. The process using it stopped using it, but it had not been unloaded by the time you overinstall. It seemed like CoFreeUnusedLibraries or CoFreeUnusedLibrariesEx would possibly allow you to overinstall the DLL immediately without having to install it as a temp file and rename on reboot. If the DLL is actively being used, the API call would not help...this would all depend on the timing.<br />
<br />
I may be (make that 'probably am') completely wrong about this, so I was seeing what others thought about it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th March 2007, 21:52</div></div><div class="posttext">It only frees DLLs of the current process, not all processes on the system.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">27th March 2007, 21:55</div></div><div class="posttext">ah, that makes sense. Thanks for the clarification :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>