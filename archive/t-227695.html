<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Library.nsh, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Library.nsh NSIS Discussion" />
	
	<title> Library.nsh [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Library.nsh</div>
<hr />
<div class="pda"><a href="t-227695.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=227695">Library.nsh</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">5th October 2005, 10:00</div></div><div class="posttext">In Include/Library.nsh, I see several lines like this: !include &quot;${NSISDIR}\Bin\LibraryLocal.nsh&quot;If the user isn't logged in as an Administrator, then this won't work because they won't be able to edit/create files in ${NSISDIR}\Bin\. This is in version 2.10 BTW.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th October 2005, 14:43</div></div><div class="posttext">Thanks, fixed.<br />
<br />
I've added !tempfile and !delfile, modified LibraryLocal to accept an output file on the command line and updated Library.nsh to use it.<br />
<br />
!tempfile uses mkstemp on *nix and !delfile simply uses unlink. They can be used to fix the portability issues in LogicLib.nsh. However, there's still a problem with the quoting in the !system call.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">8th October 2005, 11:17</div></div><div class="posttext">Excellent news, thanks! Should be able to fix the !system quoting in a cross-platform way - IIRC, cmd.exe can use &quot;quoted text&quot;, and probably command.com too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th October 2005, 12:34</div></div><div class="posttext">It can use quoted text, but echo itself takes the line as is. Using:echo &quot;asd&quot;will output:&quot;asd&quot;Even if there's a switch for cmd.exe or command.com to treat the quotes otherwise, how can you call cmd.exe with the switch in a portable method?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">9th October 2005, 12:04</div></div><div class="posttext">Hmm. I see 2 options:<br />
<br />
Set an environment variable or registry item to enable the correct quoting on Windows. Not sure if this is available.<br />
<br />
Instead of using echo, would it be possible to create file writing functions like !fileopen, !fileread, !filewrite and !fileclose? These would be build-time functions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th October 2005, 13:56</div></div><div class="posttext">I was actually thinking of adding !fileappend and !filereadline while I was at it. But I didn't want to bloat it too much. But I guess I'll add it anyway, unless someone has a better idea for this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">9th October 2005, 14:13</div></div><div class="posttext">when you add more build functions ...<br />
why not simply remove all and replace them by:<br />
!compiletime<br />
!compiletimeend<br />
<br />
every plain nsis code between those lines then will be run immediatly. :D<br />
just an idea ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th October 2005, 14:55</div></div><div class="posttext">That'd require a weird merger between the exehead code and the compiler code. How would you handle defines? How will !ifdef be done? It'd also not work on POSIX because the exehead code is very Windows specific.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">9th October 2005, 19:15</div></div><div class="posttext">hey, this has been more or less a fun posting :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th October 2005, 16:33</div></div><div class="posttext">I've added !appendfile.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>