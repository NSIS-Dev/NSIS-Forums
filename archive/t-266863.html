<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Checking installed printers, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Checking installed printers NSIS Discussion" />
	
	<title> Checking installed printers [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Checking installed printers</div>
<hr />
<div class="pda"><a href="t-266863.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=266863">Checking installed printers</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ignavia</div><div class="date">1st March 2007, 16:09</div></div><div class="posttext">The program I'm installing routes printouts to the default printer. During the course of the installation, if there are NO printers installed, I'd like to (optionally) run the Add Printer wizard. If there are MULTIPLE printers installed, I'd like to open the Printers folder so the user can verify their default. (Or maybe if I can read the name of the default printer, that'd be better).<br />
<br />
Here's what I have so far:<br />
<br />
<br />
Section &quot;-Check for printers&quot;<br />
	EnumRegValue $0 HKCU &quot;Software\Microsoft\Windows NT\CurrentVersion\Devices&quot; 0<br />
	IfErrors +2<br />
	Goto done<br />
	MessageBox MB_YESNO &quot;You do not have any printers installed. Would$\n\<br />
			you like to run the Add Printer wizard now?&quot; IDNO +2<br />
	ExecWait 'RunDll32.exe SHELL32.DLL,SHHelpShortcuts_RunDLL AddPrinter'<br />
	done:<br />
SectionEnd<br />
<br />
Section &quot;-Open Printers Folder&quot;<br />
	EnumRegValue $0 HKCU &quot;Software\Microsoft\Windows NT\CurrentVersion\Devices&quot; 1<br />
	IfErrors done<br />
	MessageBox MB_YESNO &quot;MCPPRT will route mainframe printouts to your default printer.$\n\<br />
			Would you like to open the Printers folder to check your default?&quot; IDNO +2<br />
	ExecWait 'RunDll32.exe SHELL32.DLL,SHHelpShortcuts_RunDLL PrintersFolder'<br />
	done:<br />
SectionEnd<br />
<br />
<br />
Is this the best method? Is there another method that will work on Windows 98 *and* XP? Are there any conditions under which this wouldn't work?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st March 2007, 20:00</div></div><div class="posttext">You can use a plug-in (http://forums.winamp.com/showthread.php?s=&amp;threadid=103943&amp;highlight=printer) to enumerate available printers.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>