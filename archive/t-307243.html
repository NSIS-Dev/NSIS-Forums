<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Product Version MessageBox from start menu shortcut, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Product Version MessageBox from start menu shortcut NSIS Discussion" />
	
	<title> Product Version MessageBox from start menu shortcut [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Product Version MessageBox from start menu shortcut</div>
<hr />
<div class="pda"><a href="t-307243.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=307243">Product Version MessageBox from start menu shortcut</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">YeSaYa</div><div class="date">10th June 2009, 12:08</div></div><div class="posttext">Hi,<br />
I would like to include in my installer a start menu shortcut to message box with product version information.<br />
Is there any way create a shortcut not to some file, but some function in installer script which will be invoked?(for example function may containing:<br />
MessageBox MB_ICONINFORMATION|MB_OK &quot;Version &quot; &quot;${PRODUCT_VERSION}&quot;)?<br />
<br />
Thanks and Regards,<br />
Sasa</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">10th June 2009, 12:33</div></div><div class="posttext">you could pass something like &quot;/version&quot; as a command line parameter to your installer, check for that in the installer, and if /version is specified, only pop up a messagebox.<br />
<br />
You might want to make that a separate installer if your regular installers requires Admin; otherwise just to check the version would pop up UAC on Vista/Se7en, etc.<br />
Ideally you'd write a small app that does it proper :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">YeSaYa</div><div class="date">10th June 2009, 16:01</div></div><div class="posttext">Thanks for anwering,<br />
I decided to add another trivial installer which will produce version.exe with desired information and wich I will attach for link in Start Menu.<br />
Now I am facing with new issue:<br />
I would like to implement following line in my &quot;main&quot; installer:<br />
<br />
ExecShell &quot;open&quot; '&quot;${NSISDIR}\makensis.exe&quot; version.nsi'<br />
<br />
to get version.exe which I will latest in main installer script I will use when I will create shortcut.<br />
Unfortunately, this ExecShell is executing with no errors in log but it doesn't produce expected version.exe file and it causing error later in main installer script when I am trying to copy file which doesn't exist.<br />
Simple call from command line: &quot;C:\Program Files\NSIS\makensis.exe&quot; version.nsi will produce expected version.exe.<br />
<br />
Any ideas what I am doing wrong?<br />
<br />
Thanks once again,<br />
Sasa</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">10th June 2009, 16:07</div></div><div class="posttext">err... you can't do that - unless you're distributing NSIS with your own plugin, too.<br />
<br />
Why aren't you just storing the version number in the registry on installation, and then reading that out from there?  You should only have to build an executable that reads that out once, locally, and then include that executable in your installer :o</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th June 2009, 16:28</div></div><div class="posttext">ExecShell is a run time instruction. You need to use !system.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">YeSaYa</div><div class="date">10th June 2009, 19:38</div></div><div class="posttext">Stu,<br />
thanks... It is exactly what I was looking for...<br />
<br />
Regards,<br />
Sasa</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th June 2009, 20:15</div></div><div class="posttext">Also just a note on your version.nsi it should probably look something like this:<br />
<br />
OutFile version.exe<br />
SilentInstall silent<br />
XPStyle on<br />
Icon ...<br />
<br />
Section<br />
  MessageBox MB_OK|MB_ICONINFORMATION ...<br />
SectionEnd<br />
<br />
That is the most minimal script which will not have any UI resources in it (SilentInstall silent ensures this).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">YeSaYa</div><div class="date">10th June 2009, 20:44</div></div><div class="posttext">:D<br />
Yes, exactly... And most important - it's working. ;)<br />
<br />
Sasa</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>