<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Attempting to use installer to call another installer in Silent mode., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Attempting to use installer to call another installer in Silent mode. NSIS Discussion" />
	
	<title> Attempting to use installer to call another installer in Silent mode. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Attempting to use installer to call another installer in Silent mode.</div>
<hr />
<div class="pda"><a href="t-275936.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=275936">Attempting to use installer to call another installer in Silent mode.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Gato Muerto</div><div class="date">15th August 2007, 02:50</div></div><div class="posttext">The first installer will ask the user if they want to install the additional content, and on yes will call the second installer.  No problem.  However Boss says he wants it to work without user input.  Easy enough, just slap an &quot;/S&quot; at the end  of the nsExec::ExecToLog portion.  The second installer works, but gives an error message at the end.  The only clue I have is a blank messagebox with the word &quot;Error&quot;, and an OK button.  The program installs, but I am wondering what is causing the &quot;Error&quot; message.  <br />
<br />
How do I isolate this, if I want the program to install silently within another program, but run normally if run without the original installer?<br />
<br />
There is supposed to be a log file, but that appears to not work correctly, either.  I get the log file from the original installer, but not from the smaller sub-installer.  No error messages in the regular log, so this appears to be a sub-installer issue.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">darthvader</div><div class="date">15th August 2007, 04:00</div></div><div class="posttext">Can you check if the second sub installer installs correctly if you run it in silent mode without using it in the script?<br />
<br />
If this works fine then problem might be in the nsExec plugin try using ExecWait since i assume the sub installer is a windows application.<br />
<br />
If it does not work(throwing some errors) then the problem is in the sub installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Gato Muerto</div><div class="date">15th August 2007, 18:06</div></div><div class="posttext">/me kicks self.  <br />
Thanks, I should have thought of that... <br />
<br />
Just tried it, and yes, there is still an error.  Any thoughts on how to obtain the error message while running in silent mode?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">darthvader</div><div class="date">15th August 2007, 18:24</div></div><div class="posttext">I am assuming the second installer is NSIS Installer, since you were talking about /S switch. <br />
<br />
The most common problem with silent mode is you wouldnt have specified the inputs(/SD switch) for MessageBoxes in silent mode. Check if you have specified /SD switches to all messageboxes? <br />
<br />
I may not be right but just give it a shot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wacaveman</div><div class="date">15th August 2007, 18:48</div></div><div class="posttext">I do the silent install within installers all of the time.  Just use the logging build, and send an installer.log to the install directory.  As a suggestion, implement logging using the following macros, otherwise if you add logging, you won't be able to build again if you use the default compiler (IMHO, if this was in the standard build, it would make two separate NSIS compilers un-neccessary).<br />
<br />
!macro Logger What<br />
!ifdef NSIS_CONFIG_LOG<br />
  LogSet &quot;${What}&quot;<br />
!endif<br />
!macroend<br />
<br />
!macro Log What<br />
!ifdef NSIS_CONFIG_LOG<br />
  LogText &quot;${What}&quot;<br />
!endif<br />
!macroend<br />
<br />
Then, to turn it on:<br />
!insertmacro Logger on<br />
<br />
And to log some text:<br />
!insertmacro Log &quot;About to install ${prodname}&quot;<br />
<br />
Anyway, the logging build is the ONLY way to fly for debugging silent installs.  Go to the downloads screen and look under special builds.<br />
<br />
-Kevin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Gato Muerto</div><div class="date">15th August 2007, 21:01</div></div><div class="posttext">darthvader:<br />
Part of my surprise is the secondary script (yes, NSIS) completely lacks any messagebox lines.  What would cause a random &quot;error&quot; messagebox to appear when run in silent mode?<br />
<br />
Kevin:  <br />
Thanks for the suggestion about a logging build.  I'll look into it.  I am a little confused regarding: &quot;you won't be able to build again if you use the default compiler&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Gato Muerto</div><div class="date">16th August 2007, 02:09</div></div><div class="posttext">Found there was an issue with the logging that I already had in the program.  Found it by backtracking and commenting out sections until I found the culprit.<br />
<br />
Thanks for your suggestions.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>