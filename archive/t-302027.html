<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Registering *.dll, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Registering *.dll NSIS Discussion" />
	
	<title> Registering *.dll [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Registering *.dll</div>
<hr />
<div class="pda"><a href="t-302027.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=302027">Registering *.dll</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Tonst</div><div class="date">13th January 2009, 13:39</div></div><div class="posttext">Hi<br />
<br />
I've had a bit of a look but i'm a bit confused.<br />
<br />
In ${SourcePath}\Components\ I have *.dll/*.ocx/*.exe that I want to copy to my current $OUTDIR and register. Currently for the DLL/OCX I am using:<br />
  !insertmacro InstallLib REGDLL 0 REBOOT_NOTPROTECTED &quot;${SourcePath}\Components\ADOListView.ocx&quot; &quot;$OUTDIR\ADOListView.ocx&quot; $0<br />
And for the exes:<br />
  File &quot;${SourcePath}\PopupMessage.exe&quot;<br />
  ExecWait '&quot;$OUTDIR\PopupMessage.exe&quot; /regserver'<br />
<br />
However I've got so many files I don't want to hardcode each one, plus it's hassle adding/removing new/old ones, so how can I just do it with a wildcard?<br />
<br />
For my .Net files I have:<br />
  File &quot;${SourcePath}\ComponentsDOTNET\*.dll&quot;<br />
  ${Locate} &quot;$OUTDIR\&quot; &quot;/M=Interop* /L=F /G=0&quot; &quot;Regasm&quot;<br />
And that works fine, the Regasm function simply executes regasm.exe with the filepath to register<br />
<br />
<br />
I could do the same sort of thing and just call regsvr32 I guess.... Or will that cause problems for me?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tonst</div><div class="date">13th January 2009, 15:35</div></div><div class="posttext">Ok Kind of figured it out using a !system and !include to run and include the result of the following at compile time:<br />
<br />
!include &quot;FileFunc.nsh&quot;<br />
!insertmacro Locate<br />
!include &quot;${enta_SourceFolder}\Setup\VersionNumber.inc&quot; ;defines SourcePath<br />
<br />
<br />
OutFile &quot;RegisterVB6Components.exe&quot;<br />
SilentInstall silent<br />
<br />
Section<br />
  FileOpen $R1 &quot;VB6Registration.inc&quot; w<br />
  ${Locate} &quot;${SourcePath}\Components\&quot; &quot;/M=*.dll /L=F /G=0&quot; &quot;Regdll&quot;<br />
  ${Locate} &quot;${SourcePath}\Components\&quot; &quot;/M=*.ocx /L=F /G=0&quot; &quot;Regdll&quot;<br />
  ${Locate} &quot;${SourcePath}\Components\&quot; &quot;/M=*.exe /L=F /G=0&quot; &quot;Regexe&quot;<br />
  FileClose $R1<br />
SectionEnd<br />
<br />
Function Regdll<br />
 FileWrite $R1 '!insertmacro InstallLib REGDLL $$ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;$R9&quot; &quot;$$OUTDIR\$R7&quot; &quot;$$OUTDIR\&quot;$\r$\n'<br />
<br />
 Push $0<br />
FunctionEnd<br />
<br />
Function Regexe<br />
 ;FileWrite $R1 '!insertmacro InstallLib REGEXE $$ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;$R9&quot; &quot;$$OUTDIR\$R7&quot; &quot;$$OUTDIR\&quot;$\r$\n'<br />
<br />
 Push $0<br />
FunctionEnd<br />
But it doesn't like REGEXE despite it being in the documentation in Appendix B.... Hmmm</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th January 2009, 19:37</div></div><div class="posttext">Make sure you're using the latest version of NSIS for REGEXE. It was only added on 2.42.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>