<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Need help with GetParameters function, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Need help with GetParameters function NSIS Discussion" />
	
	<title> Need help with GetParameters function [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Need help with GetParameters function</div>
<hr />
<div class="pda"><a href="t-108983.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=108983">Need help with GetParameters function</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">8th October 2002, 23:06</div></div><div class="posttext">I currently have code that will give me the name of the batch file calling the NSIS executable (I must use a batch file for this application). The program that calls the batch file is another software that passes some data to our app by means of the batch and NSIS file combination. <br />
Here is my current batch file code:<br />
copy %1 mydata.dat<br />
myapp.exe %0 <br />
As I mentioned above, I can already get the name of the batch file with the %0 parameter. What I would also like to do is to pass it the data with the %1 parameter so my batch file should just be something like:<br />
myapp.exe %0 %1 The problem is I cannot figure out how to get %1 so I can copy it into a file/variable. How do I read the second parameter?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">9th October 2002, 07:36</div></div><div class="posttext">Put quotes around the parameters, so you will know when the second one starts.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">9th October 2002, 21:04</div></div><div class="posttext">I added quotes around the parameters so my batch file now looks like:<br />
<br />
myapp.exe &quot;%0&quot; &quot;%1&quot; <br />
<br />
I also added the following two things right before closing the GetParameters Function code:<br />
* A message box to show me the values of $0, $1 and $2<br />
  ( This is the code:  MessageBox MB_OK &quot;0=$0$\n1=$1$\n2=$2&quot; )<br />
* StrCpy $1 c:\mydata.dat<br />
<br />
The values of $0, $1 and $2 come up blank and the data being transferred doesn't get copied into c:\mydata.dat</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">9th October 2002, 21:07</div></div><div class="posttext">I forgot to mention that I am using 1.98</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">9th October 2002, 21:31</div></div><div class="posttext">You need to write some code to separate these parameters. The StrCpy instruction does not write stuff to a file, it just copies a variable.<br />
<br />
Can you post the other code?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th October 2002, 21:54</div></div><div class="posttext">$0, $1 and $2 are not the equivalent of %0, %1 and %2... You have to call the GetParameters function, then Pop to get its result and parse it. If you used myapp.exe &quot;%0&quot; &quot;%1&quot; to call the installer the string popped will be &quot;%0&quot; &quot;%1&quot; (%0 and %1 of course replaced by their real values...). You will then have to seperate this string to two strings by searching for the quotes and using StrCpy starting position parameter and number of characters to copy parameter.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eccles</div><div class="date">9th October 2002, 22:20</div></div><div class="posttext">Using the function GetNextParm (http://www.clantpa.co.uk/nsis/wiki/index.php/GetNextCommandLineParameter), this should do the trick:Push $CMDLINE<br />
Call GetNextParm<br />
Pop $0 ; name of installer<br />
Call GetNextParm<br />
Pop $1 ; first parameter<br />
Call GetNextParm<br />
Pop $2 ; second parameter<br />
Pop $9 ; remaining parameters (not required - just keeping the stack tidy)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">9th October 2002, 22:24</div></div><div class="posttext">Attached is my NSIS script and batch file zipped up.<br />
<br />
I will try to figure out Kichik's suggestion of &quot;You will then have to seperate this string to two strings by searching for the quotes and using StrCpy starting position parameter and number of characters to copy parameter.&quot;<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th October 2002, 12:00</div></div><div class="posttext">Using GetNextParm (http://www.clantpa.co.uk/nsis/wiki/index.php/GetNextCommandLineParameter) will actually be easier :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">10th October 2002, 18:02</div></div><div class="posttext">Thanks for the help, but I am still having problems figuring out how to implement the &quot;GetNextParm&quot; function in my code. I added the &quot;GetNextParm&quot; function as posted by eccles and called it from the .OnInit function (after &quot;Call GetParameters&quot;), but now I am getting a stack fault error when the exe is executed. What am I doing wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th October 2002, 20:56</div></div><div class="posttext">You have an example of usage in the URL eccles gave you. You don't need to call GetParameters if you use GetNextParm...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tderouin</div><div class="date">21st February 2003, 18:31</div></div><div class="posttext">GetNextParam should be using $R0..$R9 and not $0..$9. Using $9 around the start menu functionality in Modern UI wipes out the Start Menu folder.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st February 2003, 18:35</div></div><div class="posttext">Where did you find GetNextParm? The links above are dead.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tderouin</div><div class="date">21st February 2003, 18:41</div></div><div class="posttext">That's a good question, I think I found it in included example piece of code posted somewhere on this board, but I can't remember where.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">21st February 2003, 21:47</div></div><div class="posttext">I still have the backups of that clantpa site. Does anyone want me to fish out the stuff that those dead links used to refer to?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st February 2003, 21:50</div></div><div class="posttext">I'll be happy to polish it if I'll get a copy of it ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">21st February 2003, 22:26</div></div><div class="posttext">Here it is. <br />
<br />
Also for anyone interested (you're pretty mad if you try this) I've made the backups accessible by ftp (ftp://nsis:nsis@sunjammer.serveftp.net). The reason I've done this is that I have very little time to go through them and yet there is potentially still useful information in there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">21st February 2003, 22:28</div></div><div class="posttext">Hmm forgot the file :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st February 2003, 23:09</div></div><div class="posttext">It uses $9 in the example but in the function itself pushes and pops like needed. If you want to perform the check in the installer you can use this function, it's optimized for that task:<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=79</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>