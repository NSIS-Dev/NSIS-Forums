<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" windows 2000, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  windows 2000 NSIS Discussion" />
	
	<title> windows 2000 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  windows 2000</div>
<hr />
<div class="pda"><a href="t-281550.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=281550">windows 2000</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">noisehole</div><div class="date">16th November 2007, 11:20</div></div><div class="posttext">hi,<br />
<br />
i noticed some issue with nsis 2.29 and windows 2000:<br />
<br />
- registry access like DeleteRegValue fails<br />
- $PROGRAMFILES(64) does not point to the localized &quot;Program Files&quot; folder, its always &quot;c:\Program Files&quot;<br />
- prolly all reg functions are affected, these above mentioned issues are definitely broken on my good old w2k test box<br />
<br />
i guess that the KEY_WOW64_32KEY / KEY_WOW64_64KEY api flag is  breaking the registry access. i learned the hard way in my own software: if you pass either of these flags to RegOpenKeyEx on a w2k os, you will get an error and wont get access at all. the msdn page states that this flag is unsupported on w2k.<br />
<br />
i didnt dare to update to &gt;=2.30 because of the modern ui beta. i dont have the time right now to dig into the source, so maybe my assumptions are wrong or this issue is resolved by now. sorry for the noise if thats the case. if it isnt: how do i solve this?<br />
<br />
regards<br />
<br />
edit: so i assume this has been introduced with SetRegView, but commenting that command out does not help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th November 2007, 12:25</div></div><div class="posttext">KEY_WOW64_32KEY and KEY_WOW64_64KEY are never used when SetRegView is set to 32. KEY_WOW64_64KEY is used only when SetRegView is set to 64. The same goes to $PROGRAMFILES and $PROGRAMFILES64 which aren't affected by SetRegView.<br />
<br />
On top of that, DeleteRegValue, $PROGRAMFILES and other registry functions all work perfectly fine for me on 2000. The problem must be elsewhere.<br />
<br />
The MUI beta is a beta of MUI2. The good old Modern UI is not affected.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">noisehole</div><div class="date">19th November 2007, 12:12</div></div><div class="posttext">sorry for jumping to conclusions, i did some further testing to analyse my problem. turns out i expected some other behavior (or/and didnt read the documentation carefully enough ;) )<br />
<br />
setregview 64: if using this and running the installer on a 32bit windows, it will break registry access. &quot;!insertmacro MUI_LANGDLL_DISPLAY&quot; wont read/save, my uninstall function is unable to remove regentries etc, etc..<br />
<br />
$PROGRAMFILES64: same situation on 32bit windows. it isnt set at all, its hardcoded &quot;c:\program files&quot;, no matter where the real $PROGRAMFILES (manually changed or localized) is.<br />
<br />
now these arent really bugs, as i said i just excpected other behaviour. i package 32 and 64bit software in distinct installers with the same nsis script. i use &quot;setregview 64&quot; as the first cmd in (un).onInit and $PROGRAMFILES64 instead of $PROGRAMFILES. this way i hoped to not have to worry about what the user is actually running.<br />
to fix it, i will only use it after checking for a 64bit os,  no problem. but wouldnt it be convenient if it was as i am describing? with the current behavior, is there any advantage for nsis users (cant think of any right now)?<br />
<br />
regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th November 2007, 19:31</div></div><div class="posttext">This way, the common case of installing executables into the Program Files will cause 32-bit executables to be installed into &quot;C:\Program Files&quot; on x64 instead of &quot;C:\Program Files (x86)&quot;. I prefer having the user explicitly require installation as 32-bit or 64-bit.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>