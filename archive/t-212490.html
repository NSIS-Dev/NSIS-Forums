<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" CreateDirectory does not set error flag?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  CreateDirectory does not set error flag? NSIS Discussion" />
	
	<title> CreateDirectory does not set error flag? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  CreateDirectory does not set error flag?</div>
<hr />
<div class="pda"><a href="t-212490.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=212490">CreateDirectory does not set error flag?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Sashka</div><div class="date">7th April 2005, 06:39</div></div><div class="posttext">NSIS version I am using is the latest official release -- NSIS 2.06<br />
<br />
Here are the two code samples. First one does not work, so I had to revert to the second one, which does what I want. By not working I mean that it obviously does not create the directory (which has an illegal character '?'), but also it does not display the message box, as it should.<br />
<br />
1)<br />
 ...<br />
 StrCpy $TMP_DIR &quot;C:\lalala?&quot;<br />
 ClearErrors<br />
 CreateDirectory &quot;$TMP_DIR&quot;<br />
 IfErrors 0 +3<br />
 MessageBox MB_OK &quot;Cannot create directory '$TMP_DIR'&quot;<br />
 Abort<br />
 ...<br />
<br />
2)<br />
 ...<br />
 StrCpy $TMP_DIR &quot;C:\lalala?&quot;<br />
 ClearErrors<br />
 CreateDirectory &quot;$TMP_DIR&quot;<br />
 IfFileExists &quot;$TMP_DIR\*.*&quot; +3<br />
 MessageBox MB_OK &quot;Cannot create directory '$TMP_DIR'&quot;<br />
 Abort<br />
 ...<br />
<br />
<br />
Another relevant matter. Are the calls 'IfErrors' and 'GetErrorLevels' related? Would it be correct to say that 'IfErrors' checks whether there is any error at all, whereas 'GetErrorLevel $var' shows the actual error code value?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sashka</div><div class="date">7th April 2005, 07:08</div></div><div class="posttext">Sorry! My previous message is slightly misleading... In fact, I know what the problem is :-). Illegal characters for the dir/file name seem to simply get ignored! So when I tried to create a folder &quot;lalala?&quot;, it actually translated it as &quot;lalala&quot;, ignoring the '?'.<br />
<br />
Another interesting thing totally relevant to the previous paragraph. If you put an illegal character in the path input box on the directory page, this character simply gets ignored! <br />
<br />
Isn't all this a bit improper :-)? I think it would be much better for the script writer to handle such an error rather than implement some questionable :-) default behaviour...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th April 2005, 12:06</div></div><div class="posttext">I think it would be a very bad idea for it not to be automatic.<br />
We'd have to parse all our CreateDirectory, SetOutPath etc strings for invalid characters, and apart from adding to the overhead it'd increase the script size as well.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">7th April 2005, 12:32</div></div><div class="posttext">BTW this happens not only with ? and * (*.ns?), but with : as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th April 2005, 12:47</div></div><div class="posttext">You can't have these in file names:<br />
\ / : * ? &quot; &lt; &gt; |<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th April 2005, 16:14</div></div><div class="posttext">GetErrorLevel is not realted to IfErrors. See section 2 of appendix D (http://nsis.sourceforge.net/Docs/AppendixD.html#D.2).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sashka</div><div class="date">8th April 2005, 01:45</div></div><div class="posttext">AfrowUK, so let's say you are creating a directory in a certain file system via a UI or a command line. Would you like it if instead of telling you that the directory with the name you specified is invalid, it would actually create a directory with a different name from what you intended, chopping some characters it does not like and so on? This does not sound very attractive to me personally. I am just trying to reason...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>