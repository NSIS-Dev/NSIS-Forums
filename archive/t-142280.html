<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Dialup Internet &amp; E-Mail, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Dialup Internet &amp; E-Mail NSIS Discussion" />
	
	<title> Dialup Internet &amp; E-Mail [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Dialup Internet &amp; E-Mail</div>
<hr />
<div class="pda"><a href="t-142280.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=142280">Dialup Internet &amp; E-Mail</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">15th July 2003, 13:37</div></div><div class="posttext">Does anyone know of a way of creating &amp; deleting dialup internet accounts using NSIS?  It would also be nice to do the same to e-mail accounts in Outlook Express.<br />
<br />
Also is there a way to check and disable &quot;File &amp; Printer Sharing&quot; for dialup networking adapter?<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">16th July 2003, 11:58</div></div><div class="posttext">Some time ago I found one program that could backup/restore dial-up accounts easily. you can found one utility that can do that and use it through nsis.<br />
<br />
I don't use outlook, so I can't help on this.<br />
<br />
Maybe there's a registry tweak to disable that sharing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">17th July 2003, 14:32</div></div><div class="posttext">I was thinking more along the lines of an API call or adding registry entries to add a dailup account and/or e-mail account.<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th July 2003, 16:12</div></div><div class="posttext">RasCreatePhonebookEntry is the closest function I could find. Dial-up uses RAS, so that's where your answer probably is. As for Outlook [Express], afaik it doesn't have any API. But you can probably create the right registry keys and folders. In Windows XP the folders are in Documents and Settings\USER\Local Settings\Application Data\Identities\{xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}. Look for {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx} in the registry and you'll find the right registry key. As for File &amp; Sharing, I have no idea... Maybe a VBScript would do the trick.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">18th July 2003, 06:00</div></div><div class="posttext">I found that I can create an email account by creating several reg entries in this key &quot;HKEY_CURRENT_USER\Software\Microsoft\Internet Account Manager\Accounts\xxxxxxxx&quot;.  I have two questions about this:<br />
<br />
1) Is there a way of getting the next available subfolder in the registry, i.e. it uses hex numbers.<br />
<br />
2) The 'pop3 password2' value seemed to be somehow encrypted, is there a API call to encrypt a password so that it can be written to the registry?<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th July 2003, 11:22</div></div><div class="posttext">That hex number is a GUID, you have to generate a new one using CoCreateGuid. It'll probably be easier to use uuidgen.exe (a utility by Microsoft) to convert it to a string you can use in the registry.<br />
<br />
As for the password, no idea. It's probably using CryptoAPI and might even use the CryptEncryptMessage function, but I am not sure.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">18th July 2003, 12:36</div></div><div class="posttext">kichik are you sure that it is GUID, it seems very short for it as its only 8 chars long and seems to be sequential.  Note that it is in the &quot;HKEY_CURRENT_USER&quot; and not in &quot;HKEY_LOCAL_MACHINE&quot;.<br />
<br />
As for the password thanks for the hint, I'll try to compare the results from those API functions with the results generated from within outlook express.<br />
<br />
Vytautas<br />
<br />
BTW where could i find more info about RAS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th July 2003, 12:43</div></div><div class="posttext">Are you sure you're looking at the right place? My Outlook Express account information is in HKEY_CURRENT_USER\Identities\{guid}\Software\Microsoft\Outlook Express.<br />
<br />
You can find more information about RAS in MSDN.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">18th July 2003, 12:50</div></div><div class="posttext">Which version of windows are you running?  I tried Win2k and WinXP and found that &quot;HKEY_CURRENT_USER\Identities\{guid}\Software\Microsoft\Outlook Express&quot; location contains setting for Outlook Express and that &quot;HKEY_CURRENT_USER\Software\Microsoft\Internet Account Manager\Accounts\xxxxxxxx&quot; contains the actual e-mail account settings such as pop3 &amp; smtp servers, username, etc.<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th July 2003, 13:52</div></div><div class="posttext">I'm using XP and the account information is in a key called &quot;Internet Account Manager&quot;, just as yours, but under the same key as the above Outlook Express key.<br />
<br />
I have multiple users on this computer, and had multiple OE users (identities) on this user, so that's must be why it's not in the same place.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">18th July 2003, 22:28</div></div><div class="posttext">Yes the multiple OE identities would explain that, so under the second key do you have just the GUID or are there other keys after that, i.e. &quot;00000001&quot;.<br />
<br />
Also is there a way to enumerate keys in a specified branch of the registry and/or check if a specified key exists.<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th July 2003, 22:32</div></div><div class="posttext">Under Internet Account Manager it's exactly as you've described.<br />
<br />
To enumerate a key use EnumRegKey and EnumRegValue.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">19th July 2003, 11:48</div></div><div class="posttext">OE stores account data in two different places, depending upon the identity involved. There is an original &quot;Main Identity&quot; which is usually created when OE is installed. If other identities are created, their account data is stored separately from that of the original &quot;Main Identity&quot;.<br />
<br />
I found a helpful description here: http://insideoe.tomsterdam.com/files/regkeys.htm</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>