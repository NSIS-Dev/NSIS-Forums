<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NET Framework 2.0 after NET Framework 1.1, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NET Framework 2.0 after NET Framework 1.1 NSIS Discussion" />
	
	<title> NET Framework 2.0 after NET Framework 1.1 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NET Framework 2.0 after NET Framework 1.1</div>
<hr />
<div class="pda"><a href="t-274448.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=274448">NET Framework 2.0 after NET Framework 1.1</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dtomhawk</div><div class="date">16th July 2007, 10:58</div></div><div class="posttext">Hi all.<br />
<br />
The problem:<br />
<br />
IS:<br />
The user has NET Framework 1.1 installed<br />
<br />
MUST:<br />
NET Framework 2.0 must be downloaded and installed.<br />
Application 'ABC-Example' must be installed.<br />
<br />
THE PROBLEM:<br />
The installation script downloads NET Framework 2.0 and tries to install it. During the NET Framework 2.0 installation comes the error message: 'The following application must be closed:  ABC-Example Installation' with the buttons: &quot;Abort, Retry, Ignore&quot;. If I press 'Ignore' the installation proceeds successfully.<br />
<br />
THE QUESTION:<br />
How could I avoid the error message ? The installation script works in general, but it looks not pretty.<br />
<br />
Sorry the screenshot is in german, but I hope the general situation is understandable.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">16th July 2007, 12:08</div></div><div class="posttext">Weird... I would say these,<br />
When download is finished a message box that informs users they should run the installer again after framework installation. After the message box Exec &quot;framework_installer&quot; and terminate your ABC installer.<br />
Or, try to execute framework installer in quiet mode and show a banner while it's running.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dtomhawk</div><div class="date">16th July 2007, 12:21</div></div><div class="posttext">Thank you 'Red Wine' for the answer, but I am trying to make &quot;one click&quot; installation. It is quiet important that the user presses the mouse buttons as seldom as possible.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">16th July 2007, 12:43</div></div><div class="posttext">That's a weird situation, I can't think why the halted ABC installer bothers the framework installation and causes that message to appear.<br />
<br />
Did you try the workaround to execute framework installer in silent mode? I think it uses the switch /Q for that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dtomhawk</div><div class="date">16th July 2007, 13:05</div></div><div class="posttext">To 'Red Wine':<br />
Framework in silent mode would be unacceptable because the user must agree with NET Framework 2.0 license.<br />
<br />
I suppose that NET Framework 2.0 updates some dlls, they are being used (direct or indirect) in NSIS Installer and NET Framework 1.1. It is strange that it goes without any problem if there are no NET Frameworks installed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th July 2007, 19:45</div></div><div class="posttext">You're probably using GetDotNETVersion (http://nsis.sourceforge.net/Get_.NET_Version) which uses mscoree.dll to query the installed version of .NET. Old versions of the function didn't unload the DLL after usage, so the .NET installer would flag them as blocking. Upgrade your .NET detection script to add the &quot;?u&quot; flag to the System::Call line and everything should be fine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dtomhawk</div><div class="date">17th July 2007, 09:09</div></div><div class="posttext">To 'kichik':<br />
Great thanks ! You are right !!! I was so stupid and didn't  proof the GetDOTNetVersion I have and the latest published version. <br />
<br />
Thank you.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>