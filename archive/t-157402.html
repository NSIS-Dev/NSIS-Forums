<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" PWD registering vs. NSIS registering, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  PWD registering vs. NSIS registering NSIS Discussion" />
	
	<title> PWD registering vs. NSIS registering [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  PWD registering vs. NSIS registering</div>
<hr />
<div class="pda"><a href="t-157402.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=157402">PWD registering vs. NSIS registering</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dleclair</div><div class="date">24th November 2003, 10:34</div></div><div class="posttext">First of all i'm french... so don't be to scared when reading me.<br />
<br />
I'm trying to translate PDW setup file (that's the VB deployment tool output file) code lines into NSIS code. Here is what i'm after:<br />
<br />
File2=@COMCAT.DLL,$(WinSysPathSysFile),$(DLLSelfRegister),,5/31/98 11:00:00 PM,22288,4.71.1460.1<br />
<br />
According to Micosoft MSDN, DllSelfRegister means self registering file containing DllRegisterServer and UnregServer functions... . The macro WinSysPathSysFile installs files to the system subdirectory, but the file is installed as a shared component (MS source http://support.microsoft.com/default.aspx?scid=http://support.microsoft.com:80/support/kb/articles/Q189/7/43.asp&amp;NoWebContent=1 ). <br />
<br />
I just want to know what this actually does. Does it copy the dll file in the system directory and then register it again, or does it only increment the reference count?<br />
<br />
The same question for the following line of code gained from Setup.lst:<br />
<br />
File14=@COMCT332.OCX,$(WinSysPath),$(DLLSelfRegister),$(Shared),6/23/98 11:00:00 PM,369696,6.0.0.8169<br />
<br />
$(shared) indicates if the file is a shared system file and will be  registered as such in the system registry... so why do they not use directly the WinSysPathSysFile macro instead since this could do the same job?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th November 2003, 11:31</div></div><div class="posttext">To replace a DLL if newer and register it, use UpgradeDLL. In 2.0b4 it's in Inlcude\UpgradeDLL.nsh so you can simply add !include UpgradeDLL.nsh to make it available in your script. For usage instructions see the appendix in the documentation where UpgradeDLL is described.<br />
<br />
To increase or decrease the count of a shared DLL you can use the available functions in the same appendix.<br />
<br />
There is a complete example that installs VB6 runtime files which uses both of those. It is in the appendix C.<br />
<br />
You can also try this automated PDW to NSIS tool:<br />
<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=162</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dleclair</div><div class="date">24th November 2003, 12:27</div></div><div class="posttext">Precisely.... the web link you indicate, seems to be broken now...<br />
<br />
Also i'm searching for how to translate properly what PWD is doing cause' i already know how to register a dll and add a reference to it using NSIS script... The related ducumentation is good enough and very helpful.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th November 2003, 12:32</div></div><div class="posttext">UpgradeDLL does the same as DLLSelfRegister and the other two functions do what it does for shared DLL/OCX. Translating is simply using those.<br />
<br />
The link works fine for me now, try again. SourceForge MySQL serer sometimes lags a bit.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>