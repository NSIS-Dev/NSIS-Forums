<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait doesn't wait, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait doesn't wait NSIS Discussion" />
	
	<title> ExecWait doesn't wait [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait doesn't wait</div>
<hr />
<div class="pda"><a href="t-267251.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267251">ExecWait doesn't wait</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">HendriAdriaens</div><div class="date">6th March 2007, 13:53</div></div><div class="posttext">Hi,<br />
<br />
I'm writing a small utility to run winzip from php. The exec function of php has a bug regarding quotation in arguments and brings up a dos box that I want to suppress. Other methods (via:<br />
$WshShell = new COM(&quot;WScript.Shell&quot;);<br />
$oExec = $WshShell-&gt;Run($cmdline, 0, $m);<br />
do run and do hide the dos box, but do not wait for winzip to finish (which is essential). <br />
<br />
I run it now via the start command of windows, but that brings up a dos box that I don't want. So I considered rerouting it via a small utility built with nsis, see below. Very simple, but it doesn't work: ExecWait doesn't wait.<br />
<br />
Do you know a solution?<br />
<br />
Thanks, best regards,<br />
-Hendri.<br />
(PS: I am running the latest nsis on winxp sp2).<br />
<br />
<br />
name &quot;Test&quot;<br />
outfile &quot;test.exe&quot;<br />
<br />
SilentInstall silent<br />
<br />
Section<br />
Call GetParameters<br />
Pop $0<br />
ExecWait '$0'<br />
sectionEnd<br />
<br />
Function GetParameters<br />
 <br />
  Push $R0<br />
  Push $R1<br />
  Push $R2<br />
  Push $R3<br />
  <br />
  StrCpy $R2 1<br />
  StrLen $R3 $CMDLINE<br />
  <br />
  ;Check for quote or space<br />
  StrCpy $R0 $CMDLINE $R2<br />
  StrCmp $R0 '&quot;' 0 +3<br />
    StrCpy $R1 '&quot;'<br />
    Goto loop<br />
  StrCpy $R1 &quot; &quot;<br />
  <br />
  loop:<br />
    IntOp $R2 $R2 + 1<br />
    StrCpy $R0 $CMDLINE 1 $R2<br />
    StrCmp $R0 $R1 get<br />
    StrCmp $R2 $R3 get<br />
    Goto loop<br />
  <br />
  get:<br />
    IntOp $R2 $R2 + 1<br />
    StrCpy $R0 $CMDLINE 1 $R2<br />
    StrCmp $R0 &quot; &quot; get<br />
    StrCpy $R0 $CMDLINE &quot;&quot; $R2<br />
  <br />
  Pop $R3<br />
  Pop $R2<br />
  Pop $R1<br />
  Exch $R0<br />
 <br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th March 2007, 20:41</div></div><div class="posttext">Call the good old start.exe that does wait with nsExec that hides the dos box.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">6th March 2007, 22:01</div></div><div class="posttext">watch out, there is no such thing as start.exe on NT based systems, only w9x, on NT its built into cmd.exe<br />
<br />
you probably need to use something like <br />
%comspec% /c start foobar<br />
<br />
(start on NT is very stupid, if you need to use a quoted path, start thinks this is the window title so you need to do: %comspec% /c Start &quot;&quot; &quot;c:\foo bar&quot;, not sure what that does on 9x)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">HendriAdriaens</div><div class="date">7th March 2007, 00:10</div></div><div class="posttext">Indeed, %comspec% /c Start &quot;&quot; &quot;c:\foo bar&quot; seems to work. I found it myself too earlier today, but thanks anyway. Besides, with the WshShell object and the fact that start takes /wait, I managed to write a function that executes that command without dos box and it will wait for the application to finish. So the nsis utility is not necessary anymore, but still, the ExecWait not waiting surprised me.<br />
<br />
-Hendri</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhuvidya</div><div class="date">12th March 2007, 00:53</div></div><div class="posttext">i am trying to do something similar, but having no luck<br />
<br />
i need to run some &quot;msi&quot; install programs at the end of my main script<br />
<br />
i would like to use ExecWait, but the following doesn;t seem to work<br />
<br />
ExecWait '%comspec% /c Start open &quot;$INSTDIR\Tmp\msxml.msi&quot;'<br />
<br />
nothing happens<br />
<br />
what am i doing wrong?<br />
<br />
cheers<br />
bhu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">12th March 2007, 01:59</div></div><div class="posttext">its not Start open, if you want to set the title, use doublequotes, but you really should use msiexec.exe instead of the whole %comspec% /c mess<br />
<br />
see http://forums.winamp.com/showthread.php?s=&amp;threadid=212645</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhuvidya</div><div class="date">12th March 2007, 02:10</div></div><div class="posttext">thanx very much - that works!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>