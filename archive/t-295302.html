<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" issue with uninstall of a shared dll, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  issue with uninstall of a shared dll NSIS Discussion" />
	
	<title> issue with uninstall of a shared dll [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  issue with uninstall of a shared dll</div>
<hr />
<div class="pda"><a href="t-295302.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=295302">issue with uninstall of a shared dll</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">zanz</div><div class="date">31st July 2008, 00:59</div></div><div class="posttext">I'm using the InstallLib to register a shared DLL and use the UnInstallLib to unregister it.<br />
<br />
After the product is installed, the DLL gets registered. However, when I goto SharedDLL path in the registry: <br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\SharedDlls<br />
<br />
The DLL name is not marked as Shared (itâ€™s not there at all in the SharedDLL reg path).<br />
I further tested it by installing two different products. Product A installed the shared dll, and then i installed product B (they both share the same custom function from a header file to register the dll). Everything works fine. However, if I uninstall product A or product B. The shared DLL gets removed and unregistered. From that point on, for obvious reasons, i cannot use the other product.<br />
<br />
I've tried both combinations of:<br />
<br />
!insertmacro UnInstallLib REGDLL SHARED NOREBOOT_PROTECTED &quot;FullPath\myDLL.dll&quot;<br />
<br />
!insertmacro UnInstallLib REGDLL NOTSHARED NOREBOOT_PROTECTED &quot;FullPath\myDLL.dll&quot;<br />
<br />
Without any success. Is this the problem with uninstall or install? How can I find out if the Nullsoft installer has marked the DLL as a shared DLL? Is there any other place other than the Microsoft registry path above? <br />
Any sort of hints or help will be really appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">KrisAster</div><div class="date">31st July 2008, 14:24</div></div><div class="posttext">It seems as if it's a problem with how you're installing the shared dll.  Can you show us the InstallLib line that installs the dll?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">l0k1</div><div class="date">31st July 2008, 15:30</div></div><div class="posttext">Check the value of the 'SHARED' parameter you provide to the macro.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zanz</div><div class="date">31st July 2008, 16:46</div></div><div class="posttext">Here's a function i wrote to register the shared DLL, i basically used the example from the documentation:<br />
<br />
Function MySharedDLL<br />
<br />
	IfFileExists &quot;$COMMONFILES\xyzDLL\xyzDLL.dll&quot; 0 new_installation ;Replace MyApp.exe with your application filename<br />
		StrCpy $ALREADY_INSTALLED 1<br />
		<br />
new_installation:<br />
	!insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED ${SOURCE_DIR}\xyzDLL.dll  $SYSDIR\xyzDLL.dll $SYSDIR<br />
<br />
FunctionEnd<br />
<br />
<br />
Am I setting the $ALREADY_INSTALLED var correctly? It would really help if you could show me an example. Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zanz</div><div class="date">31st July 2008, 23:19</div></div><div class="posttext">any help?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>