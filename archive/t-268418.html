<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to bring the App window to the front, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to bring the App window to the front NSIS Discussion" />
	
	<title> How to bring the App window to the front [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to bring the App window to the front</div>
<hr />
<div class="pda"><a href="t-268418.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=268418">How to bring the App window to the front</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">26th March 2007, 17:21</div></div><div class="posttext">When the installation comes to Finish page, I have a check box to Run our App.<br />
The checkbox was checked, then i click on finish button. It dose get App running, but somehow,the window of our App sits behind the other windows.<br />
<br />
How can I get our app's window to up front?<br />
<br />
James</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">26th March 2007, 19:22</div></div><div class="posttext">You can use FindWindow to get your app's HWND and then use an API, such as SetWindowPos to try to bring your app to the front. Note that Windows is restrictive about this at times. You can search the forums for that API to find specific examples with code.<br />
Also, if your installer is one of the windows blocking your app, you can use HideWindow just before you launch it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">26th March 2007, 19:33</div></div><div class="posttext">can you give me sample code..<br />
<br />
Thank you..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">26th March 2007, 19:43</div></div><div class="posttext">Here's an example using SetForegroundWindow, which is probably the better call to use. If you didn't write your app, you can ask the developer or run Spy++ to get the app's window class.<br />
<br />
FindWindow $0 &quot;my app's window class&quot; &quot;&quot;<br />
IsWindow $0 0 +2<br />
System::Call 'user32::SetForegroundWindow(i r0)'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">26th March 2007, 21:03</div></div><div class="posttext">where should I put those code? I can get the class name from spy++.  <br />
tried to put them into installer, seems to not work...<br />
??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">26th March 2007, 21:23</div></div><div class="posttext">I think those code should be run after I click the finish button, the start our applicaiton, then bring it to up front. Otherwise,it can't find the window since app is not running yet.<br />
???????</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">26th March 2007, 21:26</div></div><div class="posttext">Yes, it has to be after your app runs but of course before your installer exits.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">26th March 2007, 21:28</div></div><div class="posttext">so where should I put those code? there is an Event like AfterClickFinishButton?<br />
Thank you for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">26th March 2007, 21:30</div></div><div class="posttext">If you are using MUI, see the MUI documentation for MUI_PAGE_CUSTOMFUNCTION_LEAVE<br />
If not, see the docs for the Page instruction.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">26th March 2007, 21:31</div></div><div class="posttext">Yes, I am using MUI, thanks for your quick reply</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">26th March 2007, 21:53</div></div><div class="posttext">But this button is on Finish Page, then run our application .exe file???<br />
still not working</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">26th March 2007, 21:55</div></div><div class="posttext">it is not a custom page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">26th March 2007, 22:26</div></div><div class="posttext">Can you attach your script? It would make it a lot easier to help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">26th March 2007, 22:33</div></div><div class="posttext">The installer's last page Finish Page. <br />
<br />
!define MUI_FINISHPAGE_RUN_TEXT &quot;'  Start ${PRODUCT_NAME}'&quot;<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
when installing the installer, after copying files, the comes to last page Finish window. If i click on Finish button on this window, then will run ${PRODUCT_NAME}.exe file. The problem is that ${PRODUCT_NAME}.exe window behind some windows, how can I get it to up front (topmost).<br />
Any thoughts</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">26th March 2007, 23:11</div></div><div class="posttext">Try to add the provided by dienjd above code in function .onInstSuccess in loop to see if it makes the trick, e.g.<br />
<br />
loop:<br />
FindWindow $0 &quot;my app's window class&quot; &quot;&quot;<br />
IsWindow $0 0 loop<br />
System::Call 'user32::SetForegroundWindow(i r0)'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">27th March 2007, 00:40</div></div><div class="posttext">It does work for me!<br />
<br />
Thank you very much, Red Wine.<br />
I always can get answers from you. You are my saver!<br />
Every time when I post my question here, always look forward to hearing from you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">27th March 2007, 00:43</div></div><div class="posttext">You're welcome :) <br />
Thanks goes to dienjd for the provided solution ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JamesKiller</div><div class="date">27th March 2007, 00:44</div></div><div class="posttext">Yes. Thanks Dienjd as well.<br />
<br />
You guys save me one day work.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>