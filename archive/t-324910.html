<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Reading a 64bit registry key with 32bit NSIS installer, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Reading a 64bit registry key with 32bit NSIS installer NSIS Discussion" />
	
	<title> Reading a 64bit registry key with 32bit NSIS installer [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Reading a 64bit registry key with 32bit NSIS installer</div>
<hr />
<div class="pda"><a href="t-324910.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=324910">Reading a 64bit registry key with 32bit NSIS installer</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">voxio</div><div class="date">15th December 2010, 13:28</div></div><div class="posttext">Hi Guys,<br />
<br />
I have a Windows Server 2008 machine (64bit) and I'm trying to grab a value from the registry with a 32bit NSIS installer binary but I get re-directed to Wow64node even with SetRegView 64 set.<br />
<br />
I'm using the following code to check the JRE version and grab java_home:<br />
<br />
<br />
${elseif} $arch == &quot;64&quot;<br />
        ;check for 64bit JRE on 64bit<br />
        SetRegView 64<br />
        ReadRegStr $1 HKLM &quot;SOFTWARE\JavaSoft\Java Runtime Environment&quot; &quot;CurrentVersion&quot;<br />
        Messagebox MB_OK &quot;1: $1&quot;<br />
        ReadRegStr $2 HKLM &quot;SOFTWARE\JavaSoft\Java Runtime Environment\$1&quot; &quot;JavaHome&quot;<br />
        ;check for 32bit JRE on 64bit<br />
        ${if} $2 == &quot;&quot;<br />
            ReadRegStr $1 HKLM &quot;SOFTWARE\Wow6432Node\JavaSoft\Java Runtime Environment&quot; &quot;CurrentVersion&quot;<br />
            ReadRegStr $2 HKLM &quot;SOFTWARE\Wow6432Node\JavaSoft\Java Runtime Environment\$1&quot; &quot;JavaHome&quot;<br />
        ${endif}<br />
    ${endif}<br />
<br />
<br />
The MessageBox always prints $1 as nothing even though the registry key exists.<br />
<br />
Any help would be appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">15th December 2010, 14:17</div></div><div class="posttext">Where did $arch get set? AKA are you sure this is a 64 bit system?<br />
<br />
And with anything like this, just fire up Process Monitor and check which key is accessed</div></div><hr />


<div class="post"><div class="posttop"><div class="username">voxio</div><div class="date">15th December 2010, 14:50</div></div><div class="posttext">$arch gets picked up correctly.<br />
<br />
Process monitor says it's trying to access:<br />
<br />
RegOpenKey	HKLM\SOFTWARE\Wow6432Node\JavaSoft\Java Runtime Environment	NAME NOT FOUND	Desired Access: Read<br />
<br />
So its definitely forcing me over to the 64bit side.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th December 2010, 22:34</div></div><div class="posttext">Are you sure you have a 64-bit JavaSoft key (not in Wow6432Node)? I don't have one on any of my Windows x64 machines.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">voxio</div><div class="date">16th December 2010, 11:22</div></div><div class="posttext">Hi Afrow,<br />
<br />
If you install 32bit JRE on a 64bit machine (which I believe is the default) the correct registry keys are placed in Wow6432Node. If you install 64bit JRE on a 64bit machine the registry keys are placed in the 64bit registry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MrRichards</div><div class="date">5th May 2011, 10:42</div></div><div class="posttext">Hi,<br />
I'm sorry to bring this up again, but is there a way to delete Registry-Values from a 64 Bit Programm? <br />
<br />
I tried <br />
DeleteRegValue HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Run&quot; &quot;SunJavaUpdateSched&quot; <br />
<br />
But when looking for what NSIS is trying to delete, I can see that NSIS tries to delete from<br />
<br />
&quot;HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Run\SunJavaUpdateSched&quot;<br />
<br />
Why is it doing so and is there a way to prevent this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">5th May 2011, 11:42</div></div><div class="posttext">Hi,<br />
I'm sorry to bring this up again, but is there a way to delete Registry-Values from a 64 Bit Programm? <br />
<br />
I tried <br />
DeleteRegValue HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Run&quot; &quot;SunJavaUpdateSched&quot; <br />
<br />
But when looking for what NSIS is trying to delete, I can see that NSIS tries to delete from<br />
<br />
&quot;HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Run\SunJavaUpdateSched&quot;<br />
<br />
Why is it doing so and is there a way to prevent this?<br />
SetRegView</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MrRichards</div><div class="date">5th May 2011, 12:34</div></div><div class="posttext">Thank you! <br />
<br />
I need to read Registry-Strings from Programs that are 64 Bit and from some, that are not (these are in the Wow6432Node). When I call 'SetRegView 64', can I call DeleteRegValue HKLM &quot;SOFTWARE\Wow6432Node\Something then or is the only way calling 'SetRegView 32' to get this string?<br />
Also, what happens if I call SetRegView 64 on 32 Bit Systems? Does this affect the installer in any way?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">5th May 2011, 12:54</div></div><div class="posttext">These things are trivially simple to test by yourself. Why don't you just try it, and see what happens?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sr164w</div><div class="date">5th December 2011, 06:28</div></div><div class="posttext">Hii<br />
I am trying to access 32bit registry from 63bit machine using SetRegView 32<br />
though 32bit software installed in the registry it is showing tat its not installed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">5th December 2011, 11:27</div></div><div class="posttext">You'll need to give more details. For example, some code example of how you write (and then read!) the registry keys.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>