<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" currency selection drop down, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  currency selection drop down NSIS Discussion" />
	
	<title> currency selection drop down [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  currency selection drop down</div>
<hr />
<div class="pda"><a href="t-318395.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318395">currency selection drop down</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">nick_goyal</div><div class="date">14th April 2010, 11:41</div></div><div class="posttext">Hi,<br />
<br />
How can i give a drop down list to select standard set of currency in the installation page. There are more then 100 currency which i want to give, so is there any plugin or a way by which i can provide this option in the installation page.<br />
<br />
Thank you for any kind of help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">14th April 2010, 12:13</div></div><div class="posttext">nsDialogs and a listbox should be all you need.  You could hard-code the currencies, or you can include a flat text file with your installer to build the list at runtime.<br />
<br />
<br />
!include &quot;LogicLib.nsh&quot;<br />
!include &quot;MUI2.nsh&quot;<br />
!include &quot;winMessages.nsh&quot;<br />
!include &quot;nsDialogs.nsh&quot;<br />
<br />
OutFile &quot;test.exe&quot;<br />
<br />
Section<br />
SectionEnd<br />
<br />
Var dialog<br />
Var hwnd<br />
Var null<br />
<br />
Var hwnd_listbox<br />
<br />
/* A variable to hold the currency the user selects */<br />
Var currency<br />
<br />
Page Custom customPage<br />
<br />
Function .onInit<br />
    InitPluginsDir<br />
FunctionEnd<br />
<br />
Function customPage<br />
    nsDialogs::Create 1018<br />
    Pop $dialog<br />
<br />
	/* Extract a list of currencies */<br />
    SetOutPath &quot;$PluginsDir&quot;<br />
        File &quot;currencies.txt&quot;<br />
<br />
	/* Create a list box */<br />
    ${NSD_CreateListBox} 0 0 50% 100% &quot;&quot;<br />
        Pop $hwnd_listbox<br />
        <br />
        /* Populate it with our list of currencies */<br />
        FileOpen $0 &quot;$PluginsDir\currencies.txt&quot; &quot;r&quot;<br />
        FileRead $0 $1<br />
        ClearErrors<br />
        ${DoUntil} ${Errors}<br />
            ${NSD_LB_AddString} $hwnd_listbox $1<br />
            FileRead $0 $1<br />
		${Loop}<br />
		FileClose $0<br />
		<br />
		/* Add a callback for when the user selects a currency */<br />
		${NSD_OnChange} $hwnd_listbox customPage.listbox.onchange<br />
<br />
	/* Disabe the Next/Close button - the user -must- pick a currency */<br />
	/* (none are selected by default in this example) */<br />
	GetDlgItem $0 $HWNDPARENT 1<br />
	EnableWindow $0 0<br />
<br />
    nsDialogs::Show<br />
FunctionEnd<br />
<br />
Function customPage.listbox.onchange<br />
	Pop $hwnd<br />
	<br />
	/* Store the selected currency in the $currency variable */<br />
	${NSD_LB_GetSelection} $hwnd_listbox $currency<br />
	<br />
	/* Enable the Next/Close button */<br />
	GetDlgItem $0 $HWNDPARENT 1<br />
	EnableWindow $0 1<br />
FunctionEnd<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
<br />
With the content of &quot;currencies.txt&quot; being something like (up to you, of course):<br />
<br />
EUR - Euro<br />
USD - U.S. Dollars<br />
GBP - United Kingdom Pounds</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">14th April 2010, 13:28</div></div><div class="posttext">You could enumerate all system local names with EnumSystemLocalesEx, and then get the currency of that local with GetLocaleInfoEx (using LOCALE_SCURRENCY as LCType) using the System plugin to get rid of the text file.<br />
But I don't say that it'll be easy...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">14th April 2010, 13:45</div></div><div class="posttext">You might run into an issue with missing currencies or the converse.. getting currencies you do not support.  Making your own list would preclude such issues.<br />
<br />
Depends on the author's intent of the list, of course =)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nick_goyal</div><div class="date">15th April 2010, 14:04</div></div><div class="posttext">Thank you very much @Animaether but i want a drop list in place of list Box.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nick_goyal</div><div class="date">15th April 2010, 14:08</div></div><div class="posttext">Thank you for such a great help well i want a drop list in place of the list box. So how can i achieve it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nick_goyal</div><div class="date">15th April 2010, 14:28</div></div><div class="posttext">Thanks a lot everybody i got the mistake i was making its NSD_CB_AddString in place of NSD_LB_AddString for a Drop List. ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">15th April 2010, 15:19</div></div><div class="posttext">yeah, they're different messages - glad you got it :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nick_goyal</div><div class="date">20th April 2010, 15:59</div></div><div class="posttext">HI Animaether,<br />
<br />
Can you please tell me how to select default value in the drop down list ?? like i want to select 37th entry of my drop down list as the default value. so how can i achieve it.<br />
<br />
There is one more issue i am facing with the first entry of the drop list &quot;i&gt;&gt;J&quot; kind of next is coming. Although i am not passing anything like that. For the reference i am attaching the currency drop list file.<br />
<br />
Thank you very much in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">20th April 2010, 16:31</div></div><div class="posttext">Can you please tell me how to select default value in the drop down list ?? like i want to select 37th entry of my drop down list as the default value. so how can i achieve it.<br />
Probably the sanest way is to select by string using NSD's own macros:<br />
<br />
[...]<br />
        ${Loop}<br />
        FileClose $0<br />
		${NSD_CB_SELECTSTRING} $hwnd_listbox &quot;Ghana, Cedis&quot;<br />
[...]<br />
<br />
<br />
If you absolutely must select by index, you'd use:<br />
<br />
[...]<br />
        ${Loop}<br />
        FileClose $0<br />
		SendMessage $hwnd_listbox ${CB_SETCURSEL} 36 0<br />
[...]<br />
<br />
Note that the index is zero-based.. so to select the 37th, you pass 36 to the SendMesage command.<br />
<br />
<br />
There is one more issue i am facing with the first entry of the drop list &quot;i&gt;&gt;J&quot; kind of next is coming. Although i am not passing anything like that. For the reference i am attaching the currency drop list file.<br />
Good thing you attached the file :)  Your currencies.txt file is in Unicode.  That gobbledygook you see in front of the first entry is the BOM (Byte Order Mark).<br />
Re-saving with an ANSI codepage should sort it right out.  If you need to keep it as Unicode for any particular reason, you'll have to treat it as such :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nick_goyal</div><div class="date">22nd April 2010, 07:59</div></div><div class="posttext">Hi Animaether,<br />
<br />
Thank you very much for the great help. Problem solved:up:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hazeline03</div><div class="date">17th July 2010, 04:57</div></div><div class="posttext">I think you should give first the drop down list to select standard set of currency in the installation page in order for us to tell if there are any plugin or a way by which you can provide this option in the installation page.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>