<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Backup before install, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Backup before install NSIS Discussion" />
	
	<title> Backup before install [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Backup before install</div>
<hr />
<div class="pda"><a href="t-304303.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=304303">Backup before install</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Farewellx</div><div class="date">17th March 2009, 20:35</div></div><div class="posttext">hey guys,<br />
<br />
need help, iÂ´m trying to make a script which does a backup of the directory like c:\test to c:\testbackup, it should do that automaticly and it should pop up a confirmation ... all that should happen before it starts to install my files, which are in an zip file.... is that possible?<br />
<br />
thanks =)<br />
<br />
<br />
<br />
<br />
p.s. excuse me for my poor english, my german is much better =)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">17th March 2009, 21:55</div></div><div class="posttext">yes - it's possible<br />
no - it's not easy<br />
<br />
one solution...<br />
1. extract all folders and files to a temp location (not in $TEMP, lest that gets auto-cleared)<br />
2. loop over those folders and files (several functions available)<br />
3. check if a given file already exists in the destination folder<br />
4. if it does, rename that file to a backup location<br />
5. then rename the file from your temp location to the destination location<br />
<br />
There's others, but the above is reasonably easy to execute :|<br />
<br />
( like I mentioned in another thread.. a callback for File/etc. would be awesome )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Farewellx</div><div class="date">17th March 2009, 23:12</div></div><div class="posttext">so there is no way to do that directly, click a button and the given folder copies to the backup folder? <br />
i found this link http://nsis.sourceforge.net/Backup_files_on_install,_restore_on_uninstall but i really donÂ´t know how to import this macro to nsis<br />
<br />
!insertmacro BackupFile &quot;Dir with file in it&quot; &quot;File&quot; &quot;Backup to&quot;<br />
<br />
lilke: !insertmacro BackupFile &quot;c:\test&quot; &quot;Backup to&quot; &quot;c:\test\backup&quot;<br />
<br />
thanks =)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zeeh3</div><div class="date">17th March 2009, 23:15</div></div><div class="posttext">This macro only works for files, not folders.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Farewellx</div><div class="date">17th March 2009, 23:17</div></div><div class="posttext">the link is shown as &quot;URL submitted by user&quot; hope you can see it anyway...<br />
<br />
if not here it is insis.sourceforge.net/Backup_files_on_install,_restore_on_uninstall</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Farewellx</div><div class="date">17th March 2009, 23:18</div></div><div class="posttext">damn ... this one: nsis.sourceforge.net/Backup_files_on_install,_restore_on_uninstall<br />
<br />
thanks =)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zeeh3</div><div class="date">17th March 2009, 23:54</div></div><div class="posttext">Maybe calling SHFileOperation with system plugin can solve the problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">18th March 2009, 02:49</div></div><div class="posttext">well, the main problem with most of these headers is that you have to explicitly name every file.<br />
<br />
So if you use a File command that includes multiple files (for example, you have a folder called &quot;documentation&quot;, and within it is a few hundred html+jpg+gif images as your docs, and you include it as 'File &quot;documentation\*.*&quot;'), you're SOL.<br />
<br />
You'd have to first build an include file using another installer that actually grabs the list of files that would be included, and spits out separate File (or in this case BackupFile) commands.<br />
<br />
Absolutely doable.. and absolutely annoying :\</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TobbeSweden</div><div class="date">18th March 2009, 08:02</div></div><div class="posttext">I don't get it. Why can't you just do something like this?<br />
CopyFiles &quot;C:\folder\*&quot; &quot;C:\folder_backup\&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">18th March 2009, 12:27</div></div><div class="posttext">Typically because you don't want to back up -all- files - just the ones you're updating/overwriting.  E.g. say you're writing a mod for a game that replaces some of the model, graphics and sound files.  Do you then want to back up all 7GB, even if you're only replacing, say, 200MB?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TobbeSweden</div><div class="date">18th March 2009, 12:32</div></div><div class="posttext">Yes of course I understand that there is a need for something like that too, but didn't Farewellx specifically say he wanted to copy a whole directory to a backup location? Or did I misread that?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">18th March 2009, 12:56</div></div><div class="posttext">true that, TobbeSweden; although he didn't specify 'whole' explicitly, I suppose that is indeed all he might need :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Farewellx</div><div class="date">18th March 2009, 13:47</div></div><div class="posttext">hey guys, yes the installer should copy the hole folder with all the files and subfolders</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Farewellx</div><div class="date">18th March 2009, 13:55</div></div><div class="posttext">hey guys, sry for the double post again...<br />
<br />
i wouldnÂ´t need an nsis script if it would be possible to click the installer:<br />
1. run my .BAT file which copies the folder/files/subf. to the right destination<br />
2. and after that the the installer actually starts the installing process ...<br />
<br />
this would also solve my problem <br />
<br />
thx =)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">njshaw2</div><div class="date">20th March 2009, 15:03</div></div><div class="posttext">Couldn't you just use NSIS' &quot;Rename&quot; function?  That can rename a directory to another name (on the same drive), e.g.:<br />
<br />
Rename &quot;C:\test&quot; &quot;C:\testbackup&quot;<br />
<br />
That would do the job, providing you wanted the entire folder contents (including sub-folders) moved.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Farewellx</div><div class="date">23rd March 2009, 00:57</div></div><div class="posttext">the user must choose the folder before rename it or what ever ... thats what i am looking for ... user chooses the folder, clicks NEXT and the installer renames the folder automaticly to _backup</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>