<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" using BinFileRead (cls) with NSIS, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  using BinFileRead (cls) with NSIS NSIS Discussion" />
	
	<title> using BinFileRead (cls) with NSIS [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  using BinFileRead (cls) with NSIS</div>
<hr />
<div class="pda"><a href="t-308916.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=308916">using BinFileRead (cls) with NSIS</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">DaveClarke</div><div class="date">26th July 2009, 11:17</div></div><div class="posttext">Hi all,<br />
<br />
I need some advice for something who works good in EXE made with VB6 but doesn't work in EXE made with NSIS.<br />
<br />
I've created an installer that gets external parameter and uses it in the installation <br />
<br />
the download page (.../download.asp?customer_id=12345) is using BinFileRead class that gets the binary data and replaces the matching string.<br />
<br />
However, as I mentioned this works in EXE made with VB6, which looks like this:<br />
=========================<br />
strURL = &quot;77777&quot;<br />
wbBrowser.Navigate &quot;http://.../index.asp?cust_id=&quot; &amp; strURL<br />
=========================<br />
and when I run the 'download.asp' it uses BinFileRead to search and replace the &quot;77777&quot; with the querystring.<br />
<br />
But, when I'm doing this with NSIS I created it doesn't work.<br />
The NSIS looks like that:<br />
=================<br />
!define strURL &quot;77777&quot;<br />
.<br />
.<br />
.<br />
Section &quot; -post&quot;<br />
ExecShell &quot;open&quot; '&quot;http://.../index.asp?cust_id=${strURL}&quot;'<br />
Quit<br />
SectionEnd<br />
=================<br />
<br />
Any clue what can I do in here?<br />
<br />
When I'm printing the binary data in the browser, then in the VB exe I can see full URL and the code has been replaced, but in the NSIS I can't find any.<br />
<br />
Thanks for your assistance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DaveClarke</div><div class="date">27th July 2009, 13:50</div></div><div class="posttext">Ok... I'll try different thing :)<br />
<br />
Which way is the best to open -&gt; replace string -&gt; save binary data inside EXE made with NSIS?<br />
<br />
Means to replace a string on demand while a user downloads the setup.exe<br />
<br />
Thanks...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">29th July 2009, 02:12</div></div><div class="posttext">You won't see the original string in an NSIS built executable. Even if you could, changing it would result in the self CRC hashing to fail. You need to append your URL on the end of the executable and then read it using:<br />
http://nsis.sourceforge.net/ReadCustomerData<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>