<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" currentversion\run does not work in Win 7 32 bit os, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  currentversion\run does not work in Win 7 32 bit os NSIS Discussion" />
	
	<title> currentversion\run does not work in Win 7 32 bit os [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  currentversion\run does not work in Win 7 32 bit os</div>
<hr />
<div class="pda"><a href="t-345915.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=345915">currentversion\run does not work in Win 7 32 bit os</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Jake2313</div><div class="date">1st July 2012, 18:22</div></div><div class="posttext">I am desperate for help. :cry:<br />
I am new to Groups and this forum, joined today. I looked up what I could on the problem below but could not find the answer.<br />
If I put the program in the RunOnce key it works fine, but I need the desktop loaded to get access to the task bar at the bottom of the screen<br />
The user is a member of the adminiistrator group<br />
The HS NSIS Editor 2.0.3 is being run as an administrator.<br />
The UAC on the system has NOT been dissabled.<br />
The FADE.EXE program is nothing more than a fading graphic and message box.<br />
The code below is what I am trying to get to work.<br />
Any help would be GREATLY appreciated, my boss is growing impatient with me.<br />
<br />
;Running a .exe file on Windows Start<br />
!include &quot;uac.nsh&quot;<br />
!include &quot;registry.nsh&quot;<br />
!include &quot;LogicLib.nsh&quot;<br />
!include &quot;x64.nsh&quot;<br />
Name &quot;START WINDOWS&quot;<br />
OutFile &quot;STRWIN.exe&quot;<br />
#AutoCloseWindow true<br />
RequestExecutionLevel admin<br />
## The section SampleFromWeb works fine on 32 or 64 bit, I know it should go to <br />
## wow643node but it works both ways on a 64 bit machine<br />
Section SampleFromWEB<br />
  WriteRegStr HKEY_LOCAL_MACHINE &quot;Software\Microsoft\Windows\CurrentVersion\Run&quot; \<br />
&quot;Notepad&quot; &quot;$WinDir\Notepad.exe&quot;<br />
  MessageBox MB_OK &quot;The Notepad Running as Windows Start&quot;<br />
SectionEnd<br />
<br />
## The SectionRun32 does not work, It writes the registry but the EXE does not load after ##Windows has finished loading<br />
Section Run32<br />
SetRegView 32<br />
        WriteRegStr &quot;HKLM&quot; &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Run&quot; \<br />
        &quot;Fade&quot; &quot;E:\Commands32BitNSIS\Fade.exe&quot;<br />
sectionend<br />
RequestExecutionLevel none<br />
<br />
<br />
Thanks in advance for your help<br />
Alan Alias Jake2313</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st July 2012, 23:44</div></div><div class="posttext">Try SetRegView 64 (not 32).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jake2313</div><div class="date">2nd July 2012, 01:25</div></div><div class="posttext">Thank you for your response!!<br />
Tried your solution, no luck.<br />
I activated the real admin account and everything runs fine. Unfortunately the customer will not allow the user to be a true administrator. <br />
I have tried all three levels for RequestExecutionLevel none help.<br />
Please help,,again</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd July 2012, 05:46</div></div><div class="posttext">!include &quot;uac.nsh&quot; why?<br />
<br />
Have you verified that the entry is there in Autoruns? You can log with Process Monitor even when no users are logged in, google and you will find...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd July 2012, 11:33</div></div><div class="posttext">Try SetRegView 64 (not 32).<br />
<br />
StuSorry this would not have worked - I missed the bit in your topic title - SetRegView 64 does nothing on a 32-bit OS.<br />
<br />
Try creating the registry value manually and see if that works. If not then I would suspect something is wrong with the application.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jake2313</div><div class="date">2nd July 2012, 16:10</div></div><div class="posttext">I agree it seems to be my EXE. Notepad and wordpad work fine.<br />
Running as true Admin also works fine.<br />
Here is the code for my Fade.exe file. It's a very simple test.<br />
<br />
Name &quot;IntelliScan 5 Setup Step 2 of 2&quot;<br />
OutFile &quot;Fade.exe&quot;<br />
!include &quot;logiclib.nsh&quot;<br />
!include &quot;uac.nsh&quot;<br />
!include &quot;registry.nsh&quot;<br />
!include &quot;x64.nsh&quot;<br />
AutoCloseWindow true<br />
ShowInstDetails show<br />
RequestExecutionLevel highest<br />
section<br />
MessageBox MB_OK &quot;Click OK for logo&quot;<br />
sectionend<br />
RequestExecutionLevel none<br />
<br />
So much for doing simple things quickly</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd July 2012, 18:05</div></div><div class="posttext">You are not supposed to elevate at startup, use requestexecutionlevel user</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jake2313</div><div class="date">2nd July 2012, 21:29</div></div><div class="posttext">I ahave tried all 4 elevations, none work</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jake2313</div><div class="date">2nd July 2012, 21:30</div></div><div class="posttext">I have tried all 4 elevations none work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd July 2012, 21:32</div></div><div class="posttext">Have you tried putting the executable in Program Files or %APPDATA%?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jake2313</div><div class="date">2nd July 2012, 21:40</div></div><div class="posttext">yes.<br />
As you read erlier it works when you log in as a true administrator. By that I mean I enabled the administrator acount through the fontrol panel then logged in as administrator and everything works fine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd July 2012, 22:07</div></div><div class="posttext">I have tested using:Name &quot;IntelliScan 5 Setup Step 2 of 2&quot;<br />
OutFile &quot;Fade.exe&quot;<br />
AutoCloseWindow true<br />
ShowInstDetails show<br />
RequestExecutionLevel user<br />
section<br />
MessageBox MB_OK &quot;Click OK for logo&quot;<br />
sectionendTested on Windows 7 x64 with UAC on its maximum level. This works fine for limited and administrator users. I put the executable in C:\Program Files\Test. Probably pointing out the obvious here but your script does have RequestExecutionLevel twice (highest and none).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd July 2012, 22:55</div></div><div class="posttext">..and none=admin because of setup detection so use &quot;user&quot;.<br />
<br />
The only way to figure out the issue is to have Process Monitor logging events during log on...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jake2313</div><div class="date">2nd July 2012, 22:59</div></div><div class="posttext">Hi Stu<br />
<br />
Thanks for taking the time to test my little EXE on your system!!!<br />
I have not had aproblem runnig on a 64 bit system, the problem shows up when I try to run it on a Win 7 32 bit Pc</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd July 2012, 23:36</div></div><div class="posttext">Just tried on Windows 7 32-bit with the same result as the test on Windows 7 64-bit. Check your path is correct (run it from cmd).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jake2313</div><div class="date">2nd July 2012, 23:40</div></div><div class="posttext">What happens when you put in the following reg key?<br />
<br />
&quot;HKLM&quot; &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Run&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd July 2012, 23:54</div></div><div class="posttext">That is the key I tried.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jake2313</div><div class="date">3rd July 2012, 00:51</div></div><div class="posttext">It WORKS!!!!<br />
All of you have been very patient with me, thanks you so much. It seems when it comes to software I always make things to complicated.<br />
<br />
I thank you and my boss thanks you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">3rd July 2012, 02:48</div></div><div class="posttext">It WORKS!!!!<br />
All of you have been very patient with me, thanks you so much. It seems when it comes to software I always make things to complicated.<br />
<br />
<br />
What did you change to make it work?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jake2313</div><div class="date">3rd July 2012, 03:12</div></div><div class="posttext">I cut it down to the code Stu had in his reply above. Like I said I usualy end up making things to hard for myself, like they say keep it simple _______<br />
<br />
Thanks again for all your help<br />
Jake</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>