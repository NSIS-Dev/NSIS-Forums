<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Change radiobutton in .oninit function, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Change radiobutton in .oninit function NSIS Discussion" />
	
	<title> Change radiobutton in .oninit function [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Change radiobutton in .oninit function</div>
<hr />
<div class="pda"><a href="t-188418.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=188418">Change radiobutton in .oninit function</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Satsuki</div><div class="date">31st July 2004, 11:28</div></div><div class="posttext">Thank for this very good forum, i've learned a lot with it.<br />
Sorry for my bad english, i'm not english native.<br />
<br />
so here's my problem:<br />
in my scrip i use radiobutton in a .onselchange function:<br />
<br />
section $(SecHP20Name) hp20<br />
WriteRegDWORD ....<br />
WriteRegDWORD ....<br />
sectionend<br />
section /o $(SecHP21Name) hp21<br />
WriteRegDWORD ....<br />
WriteRegDWORD ....<br />
sectionend<br />
section /o $(SecHP51Name) hp51<br />
WriteRegDWORD ....<br />
WriteRegDWORD ....<br />
sectionend<br />
<br />
Function .onSelChange<br />
  !insertmacro StartRadioButtons $8<br />
    !insertmacro RadioButton ${hp20}<br />
    !insertmacro RadioButton ${hp21}<br />
    !insertmacro RadioButton ${hp51}<br />
  !insertmacro EndRadioButtons<br />
FunctionEnd<br />
<br />
<br />
this works great, but in .oninit function i need to change the default selected radiobutton but if i use sectionsetflags or !insertmacro SelectSection, it select one of the radiobutton without unselect the others one (like if the radiobutton wasn't active).<br />
<br />
i hope i've been clear (if not i'll try to be more acurate)<br />
<br />
thanks in advance<br />
<br />
++</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumuri</div><div class="date">31st July 2004, 13:26</div></div><div class="posttext">You only have to use sectionsetflags to unset the others button<br />
<br />
SectionSetFlags 0 0x10 ; this button is inactive<br />
SectionSetFlags 1 0x10 ; this button is inactive too<br />
SectionSetFlags 2 0x01 ; this button is active<br />
<br />
i don't know if you want to disable the button or only unselect it. 0x10 is to disable it. Look in the doc to find the code to unselect them ;).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">31st July 2004, 13:33</div></div><div class="posttext">simply include the sections header file:<br />
!include Sections.nsh<br />
inside this, u'll find some macros for radio-button behaviour. works really good.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Satsuki</div><div class="date">31st July 2004, 13:51</div></div><div class="posttext">if i use sectionsetflags to unsheck radiobutton it's buggy, the sction is unshecked but the radiobutton works as if it is checked, for exemple i see: <br />
[0]<br />
[0]<br />
[X]<br />
but when i sheck the first one:<br />
[X]<br />
[0]<br />
[X]<br />
and i want:<br />
[X]<br />
[0]<br />
[0]<br />
<br />
what i mean is when i use sectionsetflags, the sections are shecked but the radiobuton consider that the section are as they are before the use of sectionsetflags... so it's no use.<br />
<br />
i just want a way to change the default shecked button, that all, but all the way i've found to change it make the radiobutton bug<br />
<br />
++</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st July 2004, 13:58</div></div><div class="posttext">From Sections.nsh:; You should pass a variable that keeps the selected section<br />
; as the first parameter for this macro. This variable should<br />
; be initialized to the default section's index.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumuri</div><div class="date">31st July 2004, 14:00</div></div><div class="posttext">have you read this ????<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=188384<br />
he has the same problems as you ;).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Satsuki</div><div class="date">31st July 2004, 14:34</div></div><div class="posttext">thanks i'm going to read all that ^^<br />
<br />
++</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Satsuki</div><div class="date">31st July 2004, 15:03</div></div><div class="posttext">i got exactly the same bug when i change the default with<br />
<br />
Push $0<br />
StrCpy $8 ${hp21}<br />
SectionGetFlags ${hp21} $0<br />
IntOp $0 $0 | ${SF_SELECTED}<br />
SectionSetFlags ${hp21} $0<br />
SectionGetFlags ${hp20} $0<br />
IntOp $0 $0 &amp; ${SECTION_OFF}<br />
SectionSetFlags ${hp20} $0<br />
SectionGetFlags ${hp51} $0<br />
IntOp $0 $0 &amp; ${SECTION_OFF}<br />
SectionSetFlags ${hp51} $0<br />
Pop $0<br />
<br />
this code unselect the first option and select the second option but when i sheck an other radiobuton i get :<br />
[0]<br />
[X]<br />
[X]<br />
instead of :<br />
[0]<br />
[0]<br />
[X]<br />
<br />
 <br />
++</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">31st July 2004, 15:38</div></div><div class="posttext">If you want to change the default &quot;radiobutton&quot; section in .onInit you'll also need to change the line<br />
<br />
section $(SecHP20Name) hp20<br />
<br />
to<br />
<br />
section /o $(SecHP20Name) hp20<br />
<br />
(i.e. ensure none of the sections are selected by default)<br />
<br />
otherwise you could end up with two sections selected at the same time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumuri</div><div class="date">31st July 2004, 15:43</div></div><div class="posttext">lol, sorry,i was just saying that you should watch the one-section.nsi .<br />
<br />
Your problem come from the fact that you have to use a variable to keep the selected option (like kichik said)<br />
<br />
All is explain in one section.nsi ;).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Satsuki</div><div class="date">31st July 2004, 17:31</div></div><div class="posttext">section /o $(SecHP20Name) hp20<br />
  WriteRegDWORD ...<br />
  WriteRegDWORD ...<br />
sectionend<br />
section /o $(SecHP21Name) hp21<br />
  WriteRegDWORD ...<br />
  WriteRegDWORD ...<br />
sectionend<br />
section /o $(SecHP51Name) hp51<br />
  WriteRegDWORD ...<br />
  WriteRegDWORD ...<br />
sectionend<br />
<br />
Function .onInit<br />
  ReadRegStr $R9 .....<br />
    StrCmp $R9 &quot;...&quot; goto20 goto21c<br />
      goto20:<br />
        StrCpy $8 ${hp20}<br />
        !insertmacro SelectSection ${hp20}<br />
      goto21c:<br />
        StrCmp $R9 &quot;...&quot; goto21 goto51c<br />
      goto21:<br />
        StrCpy $8 ${hp21}<br />
        !insertmacro SelectSection ${hp21}<br />
      goto51c:<br />
        StrCmp $R9 &quot;...&quot; goto51 gotofinal<br />
      goto51:<br />
        StrCpy $8 ${hp51}<br />
        !insertmacro SelectSection ${hp51}<br />
      gotofinal:<br />
FunctionEnd<br />
<br />
Function .onSelChange<br />
  !insertmacro StartRadioButtons $8<br />
    !insertmacro RadioButton ${hp20}<br />
    !insertmacro RadioButton ${hp21}<br />
    !insertmacro RadioButton ${hp51}<br />
  !insertmacro EndRadioButtons<br />
FunctionEnd<br />
<br />
same bug here, i've read a lot the one-section.nsi but if i want to change the default radiobutton in it, it make the same bug to ...<br />
sorry for bother you but i don't understand at all why it doesn't work (if you can explain with a concret exemple instead of some abstract definition (i'm not english native so thecnical english is not easy to understand for me))<br />
<br />
thanks again<br />
<br />
++</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st July 2004, 17:36</div></div><div class="posttext">Your code works just fine for me, after replacing all of the triple dots with something meaningful, of course... There must be something else in the script. You should attach your entire script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Satsuki</div><div class="date">31st July 2004, 18:14</div></div><div class="posttext">my script is ok if hp20 is the radiobutton by default.<br />
if it's not, when you try to select an other radiobutton, it bugg.<br />
i'm going to simplifie my scrip, and post it here after that (more than 1200 lines of code)<br />
<br />
++</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Satsuki</div><div class="date">31st July 2004, 18:29</div></div><div class="posttext">must realy have something bad in my script, i've tested this script and it works perfectly well:<br />
<br />
!include &quot;MUI.nsh&quot;<br />
!include &quot;Sections.nsh&quot;<br />
<br />
  Name &quot;test1&quot;<br />
  OutFile &quot;test1.exe&quot;<br />
<br />
  InstallDir &quot;$PROGRAMFILES\test1&quot;<br />
<br />
  !insertmacro MUI_PAGE_COMPONENTS<br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_UNPAGE_INSTFILES<br />
  !insertmacro MUI_LANGUAGE &quot;French&quot;<br />
<br />
<br />
section /o &quot;HP2.0&quot; hp20<br />
WriteRegDWORD HKCU &quot;Software\test&quot; &quot;remind&quot; &quot;20&quot;<br />
sectionend<br />
section /o &quot;HP2.1&quot; hp21<br />
WriteRegDWORD HKCU &quot;Software\test&quot; &quot;remind&quot; &quot;21&quot;<br />
sectionend<br />
section /o &quot;HP5.1&quot; hp51<br />
WriteRegDWORD HKCU &quot;Software\test&quot; &quot;remind&quot; &quot;51&quot;<br />
sectionend<br />
<br />
<br />
Function .onInit<br />
<br />
ReadRegStr $R9 HKCU &quot;Software\test&quot; &quot;remind&quot;<br />
StrCmp $R9 &quot;20&quot; goto20 goto21c<br />
goto20:<br />
StrCpy $8 ${hp20}<br />
!insertmacro SelectSection ${hp20}<br />
goto21c:<br />
StrCmp $R9 &quot;21&quot; goto21 goto51c<br />
goto21:<br />
StrCpy $8 ${hp21}<br />
!insertmacro SelectSection ${hp21}<br />
goto51c:<br />
StrCmp $R9 &quot;51&quot; goto51 gotofinal<br />
goto51:<br />
StrCpy $8 ${hp51}<br />
!insertmacro SelectSection ${hp51}<br />
goto endsel<br />
gotofinal:<br />
StrCpy $8 ${hp20}<br />
!insertmacro SelectSection ${hp20}<br />
endsel:<br />
<br />
functionend<br />
<br />
<br />
Function .onSelChange<br />
  !insertmacro StartRadioButtons $8<br />
    !insertmacro RadioButton ${hp20}<br />
    !insertmacro RadioButton ${hp21}<br />
    !insertmacro RadioButton ${hp51}<br />
  !insertmacro EndRadioButtons<br />
FunctionEnd<br />
<br />
<br />
<br />
!insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />
!insertmacro MUI_FUNCTION_DESCRIPTION_END<br />
<br />
<br />
thanks for all, i'm going to verif my script ^^<br />
<br />
++<br />
<br />
[EDIT] bug spotted, i had a bad command in my .oninit function (400 lines of code that looks like a mess so that my fault).<br />
thank for all, i learned a lot about radiobutton.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>