<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" run installed app as administrator, and remove services, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  run installed app as administrator, and remove services NSIS Discussion" />
	
	<title> run installed app as administrator, and remove services [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  run installed app as administrator, and remove services</div>
<hr />
<div class="pda"><a href="t-321882.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=321882">run installed app as administrator, and remove services</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">technobuddha</div><div class="date">22nd August 2010, 21:24</div></div><div class="posttext">Hi all,<br />
I have an nsis installer, that installs a few applications.<br />
it works in windows xp, but in widnows 7, there are a few problems, and I'm sure nsis has a plugin for me, but can't figure it out for the likes of me.<br />
<br />
The application, which needs to run at startup, is always prompted with &quot;needs to run as administrator&quot;. My understanding, is that a shortcut with the checked &quot;run as administrator&quot; needs to be included? how is this accomplished with NSIS?<br />
<br />
also, another service application, gets installed and runs fine, but when the user tries to remove it, via the installer, it won't work: needs administrative permission to remove (because the uninstaller runs a batch file,to remove the services). Is there an nsis plugin that allows the removal of a service, instead of a batch file?<br />
<br />
thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">22nd August 2010, 22:02</div></div><div class="posttext">The application, which needs to run at startup, is always prompted with &quot;needs to run as administrator&quot;. My understanding, is that a shortcut with the checked &quot;run as administrator&quot; needs to be included? how is this accomplished with NSIS?<br />
http://forums.winamp.com/showthread.php?t=278764&amp;highlight=shortcut+administrator - Create a shortcut link which has &quot;Run as administrator&quot; option enabled on Vista<br />
http://forums.winamp.com/showthread.php?t=319628&amp;highlight=shortcut+administrator - CreateShortcut to run as administrator<br />
<br />
Note that this won't -remove- the prompt for elevation to Administrator, though.  In fact, if the application already asks for it, then the shortcut flag won't change anything.  The shortcut flag is needed for applications that do -not- attempt to elevate themselves to Administrator (i.e. you double-click on it, and it runs as User), but you always want to run as Administrator anyway (so that double-clicking on it will prompt for Administrator elevation, etc.).<br />
<br />
Is there an nsis plugin that allows the removal of a service, instead of a batch file?<br />
http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">technobuddha</div><div class="date">23rd August 2010, 18:21</div></div><div class="posttext">sooo, then how does NSIS able to create an installer, that allows for an application to startup WITHOUT being prompted for administration privilage? this application needs it, and i suspect what your saying, is that at this time, NSIS can't do that then?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">23rd August 2010, 21:04</div></div><div class="posttext">If an application requires administrative access, then naturally there's nothing you can do about that. If it needs it, it needs it. Not even NSIS can change that.<br />
<br />
What makes you think you can run an application without what it needs? You wouldn't expect your PC to start running without the electricity it requires, would you?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">23rd August 2010, 23:38</div></div><div class="posttext">One potential confusing situation is when you build an installer that requires Admin access, so you 'RequestExecutionLevel admin' in your installer.  Now the installer process has Admin privileges.  Next up you install an application that requires Administrator privileges and on the Finish page you add a &quot;Run MyProgram now&quot; option.  The user leaves that checked, finishes the installer, and the application ruins.. without an elevation prompt.  So what happens there?  The installer with its Admin privileges process launches another process (the application) - and this process automatically takes on the same privileges (roughly speaking) as the process that launched it (the installer).  Hence no renewed elevation required.<br />
<br />
This is typically -not- desired, though, and is one of the main reasons the UAC plugin exists, for example... to specifically launch an application as User even if the installer runs with Admin privileges.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">technobuddha</div><div class="date">24th August 2010, 14:09</div></div><div class="posttext">Yep,thanks Animaether for the suggestion, I used the NSIS_Simple_Service_Plugin, and it works! with regards to 'RequestExecutionLevel admin', I'll add that!!!<br />
<br />
I hope this works, and i'll find out tomorrow... I appreciate your time!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">24th August 2010, 16:31</div></div><div class="posttext">Yep,thanks Animaether for the suggestion, I used the NSIS_Simple_Service_Plugin, and it works! with regards to 'RequestExecutionLevel admin', I'll add that!!!<br />
<br />
I hope this works, and i'll find out tomorrow... I appreciate your time!<br />
<br />
I'm not entirely convinced you understood what I wrote :)<br />
<br />
If you add &quot;RequestExecutionLevel admin&quot; to your installer, then the user will be prompted for elevation when they run the installer, but not be prompted again when the installer runs the application.<br />
However, if the user -themselves- run the application (presuming they're not running under an admin shell/etc.), they -will- still be prompted.  There's just no way around that other than getting the application's developer to release a non-Admin-required version of the application. Presumably it needs Admin for a reason, though :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>