<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" running .bat file, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  running .bat file NSIS Discussion" />
	
	<title> running .bat file [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  running .bat file</div>
<hr />
<div class="pda"><a href="t-121884.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=121884">running .bat file</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">greenstars</div><div class="date">18th January 2003, 14:25</div></div><div class="posttext">Hi,<br />
<br />
I'm trying to execute a batch file using ExecWait.  However, it doesn't appear to be executing.  The DOS window flashes, butonly for a second, but the code in the batch file should take at least 10 seconds to execute.  What's going on?<br />
<br />
Thanks,<br />
<br />
Mike</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th January 2003, 14:36</div></div><div class="posttext">Are you sure it runs in with the current directory it thinks it should run in? The NSIS current directory is $EXEDIR (the installer directory). It currently only changes for RegDLL and UnRegDLL so the DLL's regsitered will find their &quot;friends&quot;. You can write CD $INSTDIR to the batch file using NSIS or just convert the batch file commands to NSIS commands.<br />
<br />
BTW, if you don't want any window to come up use nsExec.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">greenstars</div><div class="date">19th January 2003, 22:55</div></div><div class="posttext">OK, so I got it to work, sort of.  I used the fully qualified name of the batch file instead of the relative name (ie c:\my.bat instead of my.bat).  But, now, it will only execute it if I don't pass the batch file any parameters.  How can I get it to execute the batch file with parameters?<br />
<br />
Thanks!<br />
<br />
Mike</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JaqDraco</div><div class="date">20th January 2003, 08:39</div></div><div class="posttext">yesterday i tested nsexec. Did i something wrong or is nsexec not capable of starting a programm with parameters?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th January 2003, 11:35</div></div><div class="posttext">If the executable path has spaces in it you must quote it. For example:<br />
<br />
nsExec::ExecToLog '&quot;C:\Program Files\My Program\prog.exe&quot; parm1 parm2 &quot;parm 3 with spaces in it&quot;'<br />
<br />
If using a variable such as $INSTDIR for the path of the program it is always a good idea to quote because oyu can never know if the user chose a path with spaces or not.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">greenstars</div><div class="date">20th January 2003, 15:36</div></div><div class="posttext">Thanks for your help, I think I figured out the problem.  I was quoting it as '&quot;c:\my.bat&quot; &quot;param1&quot; &quot;param2&quot;'.  I changed it to 'c:\my.bat &quot;param1&quot; &quot;param2&quot;' and now it works.<br />
<br />
-- Mike</div></div><hr />


<div class="post"><div class="posttop"><div class="username">virtlink</div><div class="date">20th January 2003, 16:04</div></div><div class="posttext">It should also work with the quotes, like kichik said. kichik, is this (another) bug?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th January 2003, 16:08</div></div><div class="posttext">No, all of this quoting sutff is a Windows' feature :D</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>