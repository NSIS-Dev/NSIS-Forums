<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Callback from a Plugin back into NSIS?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Callback from a Plugin back into NSIS? NSIS Discussion" />
	
	<title> Callback from a Plugin back into NSIS? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Callback from a Plugin back into NSIS?</div>
<hr />
<div class="pda"><a href="t-287351.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=287351">Callback from a Plugin back into NSIS?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">99999999</div><div class="date">21st February 2008, 23:43</div></div><div class="posttext">Is it possible with NSIS, to make callback which is callable from a plugin, while the plugin is doing a very long task.<br />
<br />
So effectively the pseudo code would look something like:<br />
<br />
<br />
Function ProgressCallback<br />
   Pop $0<br />
   ${Log} &quot;$0&quot;  <br />
FunctionEnd<br />
<br />
AddressOf $1 ProgressCallback<br />
<br />
Plugin::DoLongTask $1<br />
<br />
<br />
The intention here, is that there is a very long process taking place, and that I want to callback into the NSIS install script to have it send the progress reports to our install manager.<br />
Obviously the DoLongTask of the plugin would then use address $1 to make the callback somehow.  The &quot;AddressOf&quot; command above is just my own pseudo code, and obviously not real as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">22nd February 2008, 00:12</div></div><div class="posttext">in the nsis code, you use GetFunctionAddress to get the address, in the plugin code, you call ExecuteCodeSegment (part of the extra parameter struct passed to plugin exports) (you also subtract 1 from the address you get from GetFunctionAddress IIRC)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">99999999</div><div class="date">22nd February 2008, 00:20</div></div><div class="posttext">Thanks very much!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">99999999</div><div class="date">4th March 2008, 00:29</div></div><div class="posttext">Hmm okay, this works fine when I pass data into the NSIS script. However it appears, that using popstack, and getuservariable, I am unable to get any data back from the NSIS script.<br />
<br />
Is this correct?  Or am I doing something wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">4th March 2008, 00:46</div></div><div class="posttext">no, could get data back, save &quot;result&quot; from the nsis function in a specific register or push it to the stack, then read it back in the plugin when the nsis function call returns</div></div><hr />


<div class="post"><div class="posttop"><div class="username">99999999</div><div class="date">4th March 2008, 01:01</div></div><div class="posttext">Hmm that's what I am doing the callback does that exactly.  Now I realize actually that in the callback functions, I am unable to get data off the stack either, or from the registers. <br />
What appears to happen from my perspective, is that NSIS engine, and my plugin appear to have two seperate copies of the stack and registers set.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th March 2008, 17:14</div></div><div class="posttext">You'll have to add some code examples to that statement to get a solution.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>