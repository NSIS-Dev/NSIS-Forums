<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Files wont get installed., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Files wont get installed. NSIS Discussion" />
	
	<title> Files wont get installed. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Files wont get installed.</div>
<hr />
<div class="pda"><a href="t-354682.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=354682">Files wont get installed.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">thaman667</div><div class="date">17th January 2013, 13:44</div></div><div class="posttext">What I am trying to achieve.<br />
I have an installer that installs 5 files at 1 place and 1 file at an another place. (C:\ProgramData\Data Access Worldwide\Visual Report Writer\2.1\) &amp; (C:\ProgramData\Data Access Worldwide\Visual Report Writer\2.1\Data)<br />
<br />
If the windows is vista or higher, if the windows is XP then it should install all the files at 1 place.(C:\Program Files\Data Access Worldwide\Visual Report Writer\2.1)<br />
<br />
This is what I tried but it does not install any files, I assume I am doing something completely wrong but I can't figure out what..<br />
<br />
; Script generated by the HM NIS Edit Script Wizard.<br />
<br />
; HM NIS Edit Wizard helper defines<br />
!define PRODUCT_NAME &quot;Visual Report Writer Developer Deployment&quot;<br />
!define PRODUCT_VERSION &quot;2.1&quot;<br />
!define PRODUCT_PUBLISHER &quot;DataAccess&quot;<br />
!define PRODUCT_WEB_SITE &quot;http://www.dataaccess.com&quot;<br />
!define PRODUCT_UNINST_KEY &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}&quot;<br />
!define PRODUCT_UNINST_ROOT_KEY &quot;HKLM&quot;<br />
!define PRODUCT_STARTMENU_REGVAL &quot;NSIS:StartMenuDir&quot;<br />
<br />
; MUI 1.67 compatible ------<br />
!include &quot;MUI.nsh&quot;<br />
!include &quot;LogicLib.nsh&quot;<br />
!include &quot;WinVer.nsh&quot;<br />
!include &quot;x64.nsh&quot;<br />
<br />
; MUI Settings<br />
!define MUI_ABORTWARNING<br />
!define MUI_ICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico&quot;<br />
!define MUI_UNICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico&quot;<br />
<br />
; Welcome page<br />
!insertmacro MUI_PAGE_WELCOME<br />
; License page<br />
!insertmacro MUI_PAGE_LICENSE &quot;License Agreement.txt&quot;<br />
; Directory page<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
; Start menu page<br />
var ICONS_GROUP<br />
!define MUI_STARTMENUPAGE_NODISABLE<br />
!define MUI_STARTMENUPAGE_DEFAULTFOLDER &quot;Visual Report Writer Developer Deployment&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_ROOT &quot;${PRODUCT_UNINST_ROOT_KEY}&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_KEY &quot;${PRODUCT_UNINST_KEY}&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME &quot;${PRODUCT_STARTMENU_REGVAL}&quot;<br />
!insertmacro MUI_PAGE_STARTMENU Application $ICONS_GROUP<br />
; Instfiles page<br />
!insertmacro MUI_PAGE_INSTFILES<br />
; Finish page<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
; Uninstaller pages<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
; Language files<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
;Directories<br />
;!define Dir1 &quot;C:\ProgramData\Data Access Worldwide\Visual Report Writer\2.1\Data\&quot;<br />
;!define Dir2 &quot;C:\Program Files\Data Access Worldwide\Visual Report Writer\2.1\&quot;<br />
;!define Dir3 &quot;C:\Program Files(x86)\Data Access Worldwide\Visual Report Writer\2.1\&quot;<br />
<br />
; MUI end ------<br />
<br />
Name &quot;${PRODUCT_NAME} ${PRODUCT_VERSION}&quot;<br />
OutFile &quot;Setup.exe&quot;<br />
InstallDir &quot;C:\ProgramData\Data Access Worldwide\Visual Report Writer\2.1&quot;<br />
ShowInstDetails show<br />
ShowUnInstDetails show<br />
<br />
Section &quot;-RuntimeFiles64&quot; SEC01<br />
  StrCpy $INSTDIR &quot;C:\ProgramData\Data Access Worldwide\Visual Report Writer\2.1\Data&quot;<br />
  SetOverwrite ifnewer<br />
  File &quot;Installation Files\Visual Report Writer 2012 Developer Edition API.ocx&quot;<br />
  File &quot;Installation Files\language.db&quot;<br />
  File &quot;Installation Files\Dynapdf.dll&quot;<br />
  File &quot;Installation Files\Dfapi30.dll&quot;<br />
  File &quot;Installation Files\Df_collate.cfg&quot;<br />
<br />
; Shortcuts<br />
  !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
  !insertmacro MUI_STARTMENU_WRITE_END<br />
SectionEnd<br />
<br />
Section &quot;-RuntimeFiles32&quot; SEC02<br />
  StrCpy $INSTDIR &quot;C:\Program Files(x86)\Data Access Worldwide\Visual Report Writer\2.1&quot;<br />
  SetOverwrite ifnewer<br />
  File &quot;Installation Files\Visual Report Writer 2012 Developer Edition API.ocx&quot;<br />
  File &quot;Installation Files\language.db&quot;<br />
  File &quot;Installation Files\Dynapdf.dll&quot;<br />
  File &quot;Installation Files\Dfapi30.dll&quot;<br />
  File &quot;Installation Files\Df_collate.cfg&quot;<br />
<br />
; Shortcuts<br />
  !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
  !insertmacro MUI_STARTMENU_WRITE_END<br />
SectionEnd<br />
<br />
Section &quot;-VRW.DB XP&quot; SEC03<br />
  StrCpy $INSTDIR &quot;C:\Program Files\Data Access Worldwide\Visual Report Writer\2.1&quot;<br />
  File &quot;Installation Files\vrw.db&quot;<br />
SectionEnd<br />
<br />
Section &quot;-VRW.DB NOTXP&quot; SEC04<br />
  StrCpy $INSTDIR &quot;C:\ProgramData\Data Access Worldwide\Visual Report Writer\2.1\Data&quot;<br />
  File &quot;Installation Files\vrw.db&quot;<br />
SectionEnd<br />
<br />
Section -AdditionalIcons<br />
  !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
  CreateDirectory &quot;$SMPROGRAMS\$ICONS_GROUP&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\$ICONS_GROUP\Uninstall.lnk&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
  !insertmacro MUI_STARTMENU_WRITE_END<br />
SectionEnd<br />
<br />
Section -Post<br />
  WriteUninstaller &quot;$INSTDIR\uninst.exe&quot;<br />
SectionEnd<br />
<br />
Function .onInit<br />
;  IfFileExists &quot;C:\ProgramData\Data Access Worldwide\Visual Report Writer\2.1\Data\*.*&quot; +3 0<br />
;  MessageBox MB_OK &quot;Directory does not exists and will now be created.&quot;<br />
;  CreateDirectory &quot;C:\ProgramData\Data Access Worldwide\Visual Report Writer\2.1\Data\&quot;<br />
<br />
 ${If} ${IsWinXP}<br />
 ${AndIfNot} ${RunningX64} #32 bit<br />
   !insertmacro UnselectSection ${SEC01}<br />
   !insertmacro SelectSection ${SEC02}<br />
   !insertmacro UnselectSection ${SEC04}<br />
   !insertmacro SelectSection ${SEC03}<br />
   MessageBox MB_OK &quot;Windows XP&quot;<br />
<br />
   IfFileExists &quot;C:\Program Files\Data Access Worldwide\Visual Report Writer\2.1*.*&quot; +3 0<br />
   MessageBox MB_OK &quot;Directory does not exists and will now be created.&quot;<br />
   CreateDirectory &quot;C:\Program Files\Data Access Worldwide\Visual Report Writer\2.1&quot;<br />
 ${ElseIf} ${AtleastWinVista}<br />
 ${AndIf} ${RunningX64}<br />
   !insertmacro UnselectSection ${SEC02}<br />
   !insertmacro SelectSection ${SEC01}<br />
   !insertmacro UnselectSection ${SEC03}<br />
   !insertmacro SelectSection ${SEC04}<br />
   MessageBox MB_OK &quot;Windows Vista or higher 64 Bit&quot;<br />
   <br />
   IfFileExists &quot;C:\Program Files (x86)\Data Access Worldwide\Visual Report Writer\2.1*.*&quot; +3 0<br />
   MessageBox MB_OK &quot;Directory does not exists and will now be created.&quot;<br />
   CreateDirectory &quot;C:\Program Files (x86)\Data Access Worldwide\Visual Report Writer\2.1&quot;<br />
 ${Else} # Vista or higher 32 bit<br />
   !insertmacro UnselectSection ${SEC02}<br />
   !insertmacro SelectSection ${SEC01}<br />
   !insertmacro UnselectSection ${SEC03}<br />
   !insertmacro SelectSection ${SEC04}<br />
   MessageBox MB_OK &quot;Windows Vista or higher 32 Bit&quot;<br />
<br />
   IfFileExists &quot;C:\Program Files\Data Access Worldwide\Visual Report Writer\2.1*.*&quot; +3 0<br />
   MessageBox MB_OK &quot;Directory does not exists and will now be created.&quot;<br />
   CreateDirectory &quot;C:\Program Files\Data Access Worldwide\Visual Report Writer\2.1&quot;<br />
 ${EndIf}<br />
FunctionEnd<br />
<br />
Function .onInstSuccess<br />
  Exec 'C:\Windows\System32\regsvr32.exe /i &quot;Visual Report Writer 2012 Developer Edition API.ocx&quot;'<br />
FunctionEnd<br />
<br />
Function un.onUninstSuccess<br />
  Exec 'C:\Windows\System32\regsvr32.exe /u &quot;Visual Report Writer 2012 Developer Edition API.ocx&quot;'<br />
  HideWindow<br />
  MessageBox MB_ICONINFORMATION|MB_OK &quot;$(^Name) was successfully removed from your computer.&quot;<br />
FunctionEnd<br />
<br />
Function un.onInit<br />
  MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 &quot;Are you sure you want to completely remove $(^Name) and all of its components?&quot; IDYES +2<br />
  Abort<br />
FunctionEnd<br />
<br />
Section Uninstall<br />
  !insertmacro MUI_STARTMENU_GETFOLDER &quot;Application&quot; $ICONS_GROUP<br />
  Delete &quot;$INSTDIR\uninst.exe&quot;<br />
  Delete &quot;$INSTDIR\Df_collate.cfg&quot;<br />
  Delete &quot;$INSTDIR\Dfapi30.dll&quot;<br />
  Delete &quot;$INSTDIR\Dynapdf.dll&quot;<br />
  Delete &quot;$INSTDIR\Visual Report Writer 2012 Developer Edition API.ocx&quot;<br />
  Delete &quot;$INSTDIR\language.db&quot;<br />
  Delete &quot;$INSTDIR\vrw.db&quot;<br />
<br />
  Delete &quot;$SMPROGRAMS\$ICONS_GROUP\Uninstall.lnk&quot;<br />
<br />
  RMDir &quot;$SMPROGRAMS\$ICONS_GROUP&quot;<br />
  RMDir &quot;$INSTDIR&quot;<br />
<br />
  SetAutoClose true<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">17th January 2013, 14:53</div></div><div class="posttext">You don't have RequestExecutionLevel in your script.<br />
<br />
You should not hard-code paths, use $ProgramFiles, $windir etc</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thaman667</div><div class="date">17th January 2013, 15:03</div></div><div class="posttext">You don't have RequestExecutionLevel in your script.<br />
Didn't do anything extra, still doesn't copy anything.<br />
<br />
You should not hard-code paths, use $ProgramFiles, $windir etc<br />
Paths are correct, this is how my boss want it to be.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">17th January 2013, 18:02</div></div><div class="posttext">Didn't do anything extra, still doesn't copy anything.<br />
Did you set it to requestexecutionlevel admin?<br />
<br />
Paths are correct, this is how my boss want it to be.<br />
<br />
Your boss is most probably wrong. The name &quot;program files&quot; is different on different language versions of Windows. Even if you're only deploying on English Windows versions, users can change the location of program files. Some Windows installs don't even have a C drive.<br />
<br />
(Other explanation: You're developing an installer for a Windows application. If that application insists on using c:\Program Files, it is not a valid Windows application and is therefore broken. If you want to use Windows, you need to use it the way it was meant to be used. Otherwise, use a different OS.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">msroboto</div><div class="date">17th January 2013, 18:04</div></div><div class="posttext">[QUOTE=Paths are correct, this is how my boss want it to be.[/QUOTE]<br />
<br />
So if someone has these directories on the D drive you are screwed.  Just because your boss doesn't know the right way to do this doesn't mean you should do it wrong.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thaman667</div><div class="date">21st January 2013, 10:19</div></div><div class="posttext">Corrected the paths and its still not working :\</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">21st January 2013, 16:01</div></div><div class="posttext">Like I said.<br />
<br />
Did you set it to requestexecutionlevel admin?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>