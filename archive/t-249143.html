<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installer Wrapper that calls other NSIS installs?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installer Wrapper that calls other NSIS installs? NSIS Discussion" />
	
	<title> Installer Wrapper that calls other NSIS installs? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installer Wrapper that calls other NSIS installs?</div>
<hr />
<div class="pda"><a href="t-249143.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=249143">Installer Wrapper that calls other NSIS installs?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">RossW</div><div class="date">19th June 2006, 21:49</div></div><div class="posttext">Is it possible to write a 'wrapper' script that can run other NSIS setup.exe's? If the wrapper script has the Licence and Directory pages, can I pass in the parent directory chosen in the wrapper to the individual installers so that they're silent installs, but if the called installers were invoked directly they would still display the Licence &amp; Directory pages (the latter is less of a requirement than the ability to pass in the parent directory and do a silent install)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th June 2006, 22:47</div></div><div class="posttext">This should be quite simple.<br />
<br />
The wrapper executable executes the silent installer with Exec in the Directory pages' Leave function and then calls Quit. Before calling Exec it should store the entered installation path ($INSTDIR) under a temporary registry key (using WriteRegStr).<br />
<br />
The silent installer when executed checks for the presence of this key (ReadRegStr). If the error flag is set (by using IfErrors - make sure to call ClearErrors first before ReadRegStr!) then it executes the wrapper installer itself and then quits (can all be done in .onInit).<br />
<br />
Naturally, if the registry key does exist and a value that isn't empty is read (in the silent installer .onInit), then the registry key should be deleted so that the silent installer cannot be executed again without displaying the License and Directory pages.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RossW</div><div class="date">20th June 2006, 03:08</div></div><div class="posttext">Thanks Stu!<br />
<br />
A few follow-up questions (I'm new to NSIS, so please pardon my obtuseness):<br />
<br />
1) Do I have to do anything special in the actual installers to allow for silent install?<br />
2) Rather than use a temp reg entry, could I use arguments in the Exec statement?<br />
3) Would there be some sample code for any of this, particularly for the oinit function that calls the section installer directly?<br />
<br />
Cheers,<br />
Ross</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stb</div><div class="date">20th June 2006, 07:48</div></div><div class="posttext">ad 1) You should use /SD for message boxes and must be aware that not all call backs run in silent mode (if you have advanced page call back functions defined). If you have only simple installers you have just to check the message boxes (see NSIS help).<br />
<br />
ad 2) Yes, see NSIS help for silent mode (/D).<br />
<br />
ad 3) You can't call a section directly. You can disable/enable any installer pages (directory selection, welcome screen), at a minimum you need INSTFILES.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RossW</div><div class="date">20th June 2006, 14:54</div></div><div class="posttext">Just to be clear, I can run an install script directly (with licence page 'I Agree' button') but also silently where that page will be bypassed?<br />
<br />
Also, if I add code to the Directory page's Leave function to call the individual installers in silent mode, how do I determine which 'components' the user checked? For example, my wrapper installer could list 3 'components' but they only check one of them, so how do I know to run just that selection's installer?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stb</div><div class="date">20th June 2006, 15:23</div></div><div class="posttext">Yes, have a look at the NSIS help. The &quot;silent mode&quot; can be set by NSIS script (compile time/run time) and/or by command line option. No page will show up if the installer is in silent mode.<br />
<br />
You cannot/should not drop install code in the Leave function because Leave is a call back and will (?) not be called in silent mode. It is bad behaviour, too. All code which effectively installs files or settings should be in Sections.<br />
<br />
Make one section for each of the sub-installers and call the sub-installers with ExecWait within the Section area.<br />
<br />
See NSIS help or examples for Sections (how to define defaults etc.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">farialima</div><div class="date">22nd June 2006, 21:30</div></div><div class="posttext">I think that there's a small issue with such a setup, namely that the disk space required for installation will be wrong, potentially leading the installer to run even if there's not enough disk space.<br />
<br />
Let me try to explain:<br />
<br />
The setup that you are proposing is, if I'm correct, to have a &quot;wrapper&quot; installer contain other installers, that will be unpacked, silently run, and (I suppose) deleted once they have run. <br />
<br />
The user will choose the install location in the &quot;wrapper&quot; installer. So when NSIS computes the disk space size needed to install, he will do it in the &quot;wrapper&quot; installer, and it will be the installed size of the wrapper installer - i.e. the size of all the sub-installers. <br />
<br />
Instead, it should be the size of all the files contained in all the subinstallers, because ultimately, that's the space that will be used on disk !<br />
<br />
Furthermore, I suppose that, during installation, the temporary disk space needed is: <br />
- the space for the sub-installers &quot;setup.exe&quot;<br />
- plus the space of the files installed by the sub-installers. <br />
Which means that, even if there's enough disk space overall, there's a risk that the installation will fail because there's *temporary* not enough disk space.<br />
<br />
Am I correct ? If yes, would you have any idea on how to fix that ?<br />
<br />
It seems like a small issue, but you don't want to lie to your users in terms of needed disk space...<br />
<br />
thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stb</div><div class="date">22nd June 2006, 21:46</div></div><div class="posttext">Yes. &quot;SectionSetSize&quot; is your friend (see NSIS help).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>