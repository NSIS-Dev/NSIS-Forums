<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Detecting application when run by another user. FindWindow or...?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Detecting application when run by another user. FindWindow or...? NSIS Discussion" />
	
	<title> Detecting application when run by another user. FindWindow or...? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Detecting application when run by another user. FindWindow or...?</div>
<hr />
<div class="pda"><a href="t-330072.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330072">Detecting application when run by another user. FindWindow or...?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">juliarg</div><div class="date">27th April 2011, 11:14</div></div><div class="posttext">In my uninstaller, I want to handle correctly the situation when one user on the machine tries to uninstall the app when another user has it running. Normally, I identify the running application using FindWindow and then looking at the window's user data from GetWindowLong(). But in this case, it doesn't seem to work. Can FindWindow find another user's windows? Is there a better way to handle this task?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">27th April 2011, 11:38</div></div><div class="posttext">FindWindow will not work:The traditional approach of using FindWindow or FindWindowEx will not work on a Windows XP system on which fast user switching is enabled because it will not detect application instances that are running in different user sessions (on different desktops).The suggested method on this site using a Global Mutex requires you to edit the application you want to install...<br />
If that's possible, you can use:<br />
http://nsis.sourceforge.net/Allow_only_one_installer_instance<br />
to check if it's running already.<br />
<br />
Else you may try to use the method of trying to open the application executable for writing.<br />
If it fails, it's in use:<br />
http://forums.winamp.com/showthread.php?threadid=274495<br />
Not sure if this works with fast user switching.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">7th May 2011, 16:20</div></div><div class="posttext">See http://nsis.sourceforge.net/Check_whether_your_application_is_running<br />
<br />
maybe one of the answers suits your situation</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>