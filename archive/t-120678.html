<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" DropList limited to 999 characters?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  DropList limited to 999 characters? NSIS Discussion" />
	
	<title> DropList limited to 999 characters? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  DropList limited to 999 characters?</div>
<hr />
<div class="pda"><a href="t-120678.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=120678">DropList limited to 999 characters?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Prinz</div><div class="date">8th January 2003, 23:22</div></div><div class="posttext">Hi,<br />
<br />
(Nsis 2.0b1 CVS Modern UI)<br />
<br />
I need to add 193 items into my droplist, but it doesn't show more than 999 characters, the rest has been cutted automatically. Is there a way to insert more?<br />
<br />
Greets!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th January 2003, 13:33</div></div><div class="posttext">Why do you need more than 999 characters? Is that even visible on screen?<br />
<br />
If you have a compiler you can change Contrib\InstallOptions\InstallOptions.cpp line 449 and replace 1000 with a bigger number, then recompile.<br />
If you don't I must know why would you ever need more then 999 characters before I make that buffer larger.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Prinz</div><div class="date">9th January 2003, 14:26</div></div><div class="posttext">Hi,<br />
<br />
I'd already found it in installoptions.cpp, thanks for your reply anyway.<br />
<br />
Why do I need more than 1000 characters? 1000 seems a lot, but in fact it isn't when you need for example: &quot;choose your country&quot;: there are 200 countries to choose from. It has about 2450 characters.<br />
<br />
Best Regards!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th January 2003, 14:33</div></div><div class="posttext">Ahh... Right, I forgot that the text field needs to contain all of the entries... I thought you wanted to make a 1000+ characters long line :D<br />
<br />
I have updated the max to 4096 characters, that should be enough I think.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Prinz</div><div class="date">9th January 2003, 18:27</div></div><div class="posttext">Thanks very much! :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Prinz</div><div class="date">10th January 2003, 20:29</div></div><div class="posttext">I've tested a little bit with the update, but the droplist is still limited to 1035 chars. (used to be 999) :(<br />
<br />
I've tried to compile InstallerOptions.cpp to test with static char szResult[4096];<br />
<br />
Very strange that it's 999 characters with a buffer of 1024 and 1035 characters with a buffer of 4096.<br />
<br />
Do you have an idea?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th January 2003, 22:25</div></div><div class="posttext">Well, NSIS variables are limited to 1024 charcaters by default. Are you using one big variable to write to the INI?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Prinz</div><div class="date">10th January 2003, 23:05</div></div><div class="posttext">I'm trying to fill a droplist like this from A to Z:<br />
<br />
[Field 1]<br />
Type=DropList<br />
ListItems=AR, Buenos Aires|AT, Salzburg|AT, Vienna|AU, Brisbane|AU, Melbourne|AU, Perth|AU, Sydney|BA, Sarajevo|BE, Antwerp|BE, Brussels|BG, Sofia|BO, La Paz|BR, Rio De Janeiro|BR, Sao Paulo|BS, Nassau|BY, Minsk|BZ, Belize City|CA, Calgary|CA, Edmonton|CA, Montreal|CA, Ottawa|CA, Quebec City|CA, Saskatoon|CA, Toronto|CA, Vancouver|CA, Winnipeg|CH, Bern|CH, Geneva|CH, Lausanne|CH, Zurich|CL, Santiago|CN, Beijing|CN, Shanghai|CO, Bogota|CR, San Jose|CU, Havana|CY, Nicosia|CZ, Prague|DE, Berlin|DE, Bonn|DE, Cologne|DE, Dresden|DE, Dusseldorf|DE, Frankfurt|DE, Hamburg|DE, Munich|DK, Copenhagen|DO, Santo Domingo|DZ, Algiers|EC, Guayaquil|EC, Quito|EG, Alexandria|EG, Cairo|ES, Ibiza|ES, Pamplona|ET, Addis Ababa|FI, Helsinki|FI, Turku|FR, Bordeaux|FR, Cannes|FR, Clermont|FR, Dijon|FR, Lille|FR, Lyon|FR, Marseille|FR, Nice|FR, Paris|FR, Reims|FR, Rennes|FR, Strasbourg|FR, Toulouse|FR, Tours|GB, Birmingham|GB, Liverpool|GB, London|GB, Manchester|GB, Newcastle|GB, Norwich|GB, Plymouth|GR, Athens|GT, Guatemala City|HK, Hong Kong|HN, Tegucigalpa|HT, Port-Au-Prince|HU, Budapest|HU, Zagreb|ID, Bali|ID, Jakarta|IE, Cork|IE, Dublin|IE, Shannon|IL, Jerusalem|IL, Tel Aviv|IN, Bombay|IN, Calcutta|IN, Delhi|IQ, Baghdad|IR, Tehran|IS, Reykjavik|IT, Florence|IT, Genoa|IT, Milan|IT, Naples|IT, Palermo|IT, Rome|IT, Venice|JM, Kingston|JO, Amman|JP, Osaka|JP, Sapporo|JP, Tokyo|KE, Nairobi|KR, Seoul|KW, Kuwait City|lB, Beirut|LK, Colombo|LU, Luxembourg|LY, Tripoli|MO, Casablanca|MX, Acapulco|MX, Cancun|MX, Chihuahua|MX, Guadalajara|MX, Mazatlan|MX, Mexico City|MY, Kuala Lumpur|NI, Lagos|NL, Amsterdam|NL, Rotterdam|NO, Floro|NO, Oslo|NO, Stavanger|NU, Managua|NZ, Auckland|NZ, Christchurch|NZ, Wellington|PA, Panama City|PE, Lima|PH, Manila|PK, Karachi|PL, Krakow|PL, Warsaw|PR, San Juan|PT, Lisbon|PT, Porto|PY, Asuncion|RO, Bucharest|RU, Archangelsk|RU, Irkutsk|RU, Kaliningrad|RU, Moscow|RU, Saint Petersburg|SA, Riyadh|SE, Gothenburg|SE, Malmo|SE, Stockholm|SG, Singapore|SI, Ljubljana|SK, Bratislava|SN, Dakar|SO, Mogadishu|SP, Barcelona|SP, Cordoba|SP, Granada|SP, Madrid|SP, Palma Mallorca|SP, Seville|SP, Tenerife|SP, Valencia|SP, Zaragoza|SY, Damascus|TH, Bangkok|TN, Tunis|TR, Ankara|TR, Istanbul|TT, Port of Spain|TW, Taipei|UA, Kiev|UA, Odessa|UK, Aberdeen|UK, Belfast|UK, Cardiff|UK, Edinburgh|UK, Glasgow|UK, Inverness|UY, Montevideo|VE, Caracas|VG, St. John|VN, Hanoi|ZA, Cape Town|ZA, Johannesburg|ZW, Harare<br />
Left=130<br />
Right=215<br />
Top=125<br />
Bottom=<br />
<br />
The text is being cutted right after HONG KONG. Isn't it possible to add more?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th January 2003, 23:09</div></div><div class="posttext">Depends on how you are writing into the INI. Do you compress it ready or do you change it using NSIS on run-time?<br />
<br />
EDIT: OK, it doesn't either way... Let me have a look.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Prinz</div><div class="date">10th January 2003, 23:13</div></div><div class="posttext">It's a custom page that imports the manually created .ini I wrote before the compile. It reads that .ini when the page shows up. About compression? I don't know.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th January 2003, 23:17</div></div><div class="posttext">There is the problem. From wsprintf docs:<br />
To use buffers larger than 1024 bytes, use _snwprintf. For more information, see the documentation for the C run-time library.<br />
<br />
I will have to fix that one... I will also have to have a look everywhere wsprintf is used =/<br />
<br />
For now replace line 585 of InstallOptions.cpp with:<br />
<br />
strcpy(pFields[nIdx].pszListItems, szResult);<br />
pFields[nIdx].pszListItems[nResult] = '|';<br />
pFields[nIdx].pszListItems[nResult + 1] = '0';</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Prinz</div><div class="date">10th January 2003, 23:37</div></div><div class="posttext">Thank you!<br />
<br />
I'm very sorry to bother you again with another question. When trying to compile InstallerOptions.cpp I receive the following error message:<br />
<br />
on line 290: sf-&gt;ParseDisplayName(hConfigWindow, NULL, (unsigned short *)s, &amp;eaten, &amp;root, NULL);<br />
<br />
[C++ Error] InstallerOptions.cpp(290): E2342 Type mismatch in parameter 'pszDisplayName' (wanted 'wchar_t *', got 'unsigned short *')<br />
<br />
I also inserted #define STRICT above #include &lt;windows.h&gt; to avoid an error on line 704</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th January 2003, 23:52</div></div><div class="posttext">What compiler are you using? Unsigned short is wchar_t...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Prinz</div><div class="date">10th January 2003, 23:54</div></div><div class="posttext">Borland C++ Builder 6.0 Enterprise</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th January 2003, 23:57</div></div><div class="posttext">Never used it...<br />
Just change (unsigned short *) to (wchar_t *), that should make it happy.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Prinz</div><div class="date">11th January 2003, 00:04</div></div><div class="posttext">Well, it did make the compiler happy, but unfortunately not the NSIS compiler:<br />
<br />
Invalid command: InstallOptions::initDialog<br />
Error in macro MUI_INSTALLOPTIONS_INITDIALOG on macroline 8<br />
Error in macro MUI_FUNCTIONS_WELCOMEPAGE on macroline 23<br />
Error in macro MUI_FUNCTIONS_PAGES on macroline 9<br />
Error in macro MUI_BASIC on macroline 9<br />
Error in macro MUI_SYSTEM on macroline 9<br />
Error in script &quot;C:\Program Files\NSIS20\Examples\Modern UI\droplist.nsi&quot; on line 79 -- aborting creation process<br />
<br />
Could you please compile it for me so I can go on with my project?<br />
Thanks for all your help!<br />
<br />
(you must be tired of me now ;) )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th January 2003, 00:23</div></div><div class="posttext">I am sorry I can't help you there... Seems like the compiler doesn't export IO's function or exports them under the wrong name.<br />
<br />
I have attached a compiled version with the above change.<br />
<br />
(you must be tired of me now :))<br />
<br />
Never :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Prinz</div><div class="date">11th January 2003, 00:26</div></div><div class="posttext">Thanks very much Kichik, this works fine!<br />
Keep up the good NSIS work :D</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>