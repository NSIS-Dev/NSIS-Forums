<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS scripting OS nitpicking, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS scripting OS nitpicking NSIS Discussion" />
	
	<title> NSIS scripting OS nitpicking [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS scripting OS nitpicking</div>
<hr />
<div class="pda"><a href="t-237813.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=237813">NSIS scripting OS nitpicking</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Pharaoh Atem</div><div class="date">12th February 2006, 01:07</div></div><div class="posttext">I have one program that has two versions: a version that works only on Windows 9x/NT4, and a version that works on Windows 2k/XP/Vista. Here is my problem: I need a way to make installers that either have both versions but distinguish between OSes to choose which files are allowed to be installed, or two separate installers that have OS checks to allow only certain OSes to run the installers... Can someone help me with this? I am using MUI-compatible skinning and base MUI.<br />
I also need help designing my installer to work with Limited Users, while allowing installations System-wide if Administrators are logged in and running the installation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th February 2006, 12:11</div></div><div class="posttext">Use GetVersion plugin (http://nsis.sf.net/File:GetVersion.zip) or GetWindowsVersion function (http://nsis.sourceforge.net/Docs/AppendixC.html#C.5).<br />
<br />
Edit: GetVersion plugin support added for Windows Vista and Longhorn Server.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pharaoh Atem</div><div class="date">12th February 2006, 14:26</div></div><div class="posttext">That solves one part of it, now I just need to know how to use it for my situation....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th February 2006, 14:53</div></div><div class="posttext">For example:<br />
<br />
!include LogicLib.nsh<br />
<br />
Section<br />
<br />
 GetVersion::WindowsName<br />
  Pop $R0<br />
 StrCpy $R0 $R0 2 8<br />
<br />
 ${If}   $R0 == 98<br />
 ${OrIf} $R0 == 95<br />
 ${OrIf} $R0 == NT<br />
<br />
  ## Extract 9x/NT files<br />
<br />
 ${ElseIf} $R0 == XP<br />
 ${OrIf}   $R0 == 20 # 2000<br />
 ${OrIf}   $R0 == Vi # Vista<br />
<br />
  ## Extract XP/2000/Vista files<br />
<br />
 ${EndIf}<br />
<br />
SectionEnd<br />
<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pharaoh Atem</div><div class="date">12th February 2006, 15:15</div></div><div class="posttext">So, with this I can use one installer to install different versions of a program on different versions of Windows? Well, unfortunately, I am extremely stupid on NSIS at the moment... Can you please make a complete example script for me?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th February 2006, 17:32</div></div><div class="posttext">There are already many example scripts bundled with NSIS. Rather than having a Section for each installation (for different Windows) you just use this code inside a Section (it already is in fact).<br />
<br />
I've put comments in there where you need to put the relevant instructions (SetOutPath, File etc) for the individual installations.<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>