<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" dialer, how to make it work?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  dialer, how to make it work? NSIS Discussion" />
	
	<title> dialer, how to make it work? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  dialer, how to make it work?</div>
<hr />
<div class="pda"><a href="t-177728.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=177728">dialer, how to make it work?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">tommy916</div><div class="date">23rd April 2004, 18:12</div></div><div class="posttext">It doesn't seem working for me. I've disable the internet, it messagebox say &quot;it is connected&quot;. Am i missing something? how do i include dialer.dll in the code?<br />
<br />
<br />
OutFile &quot;dial.exe&quot;<br />
Section <br />
Call ConnectInternet<br />
SectionEnd<br />
<br />
Function ConnectInternet<br />
   Push $R0<br />
     ClearErrors<br />
     Dialer::AttemptConnect<br />
     IfErrors noie3<br />
     <br />
     Pop $R0<br />
     StrCmp $R0 &quot;online&quot; connected<br />
       MessageBox MB_OK|MB_ICONSTOP &quot;Cannot connect to the internet.&quot;<br />
       Quit ;This will quit the installer. You might want to add your own error handling.<br />
     <br />
     noie3:<br />
     ; IE3 not installed<br />
     MessageBox MB_OK|MB_ICONINFORMATION &quot;Please connect to the internet now.&quot;<br />
     <br />
     connected:<br />
     MessageBox MB_OK &quot;it is connected&quot;<br />
   <br />
   Pop $R0<br />
   <br />
 FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">23rd April 2004, 19:41</div></div><div class="posttext">Do you have only one single dial-up connection that is disconnected from the Internet?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tommy916</div><div class="date">23rd April 2004, 20:03</div></div><div class="posttext">I was on internet network.<br />
I've disabled the network connection. <br />
I've tried one single connection disconnected<br />
and i've delete all the dialup connections.<br />
<br />
still don't work. I am not sure if i'm missing a code. I'm using exactly same code as i posted above. how do you include the dialer.dll in the code if it is required?<br />
<br />
Thank you<br />
:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">23rd April 2004, 20:09</div></div><div class="posttext">It only works for dial-up connections.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fredtheman</div><div class="date">24th April 2004, 00:16</div></div><div class="posttext">The ConnectInternet() function most likely relies on WININET.DLL that is part of IE. One of the API's of this DLL is InternetGetStateConnected()... which, as you've seen, is _not_ a reliable way to check if the user really is online.<br />
<br />
I came to the conclusion that the only truly reliable way is to read the DNS IP from the Registry, and connect out to it.<br />
<br />
Fred.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">24th April 2004, 02:17</div></div><div class="posttext">which windows ?<br />
<br />
in most cases u need a region number in the modem options of your system to get the dialer windows<br />
<br />
Start &gt; settings &gt; controls &gt; modem<br />
<br />
on winxp you need also the &quot;automatic RAS connection service&quot; as started automatically<br />
<br />
to check if you're really online you have to download a little file...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tommy916</div><div class="date">24th April 2004, 07:38</div></div><div class="posttext">I was using two XP computers. I guess I'll have to skip this since it is not set by default for RAS service enabled.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>