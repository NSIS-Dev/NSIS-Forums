<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Firebird connection, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Firebird connection NSIS Discussion" />
	
	<title> Firebird connection [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Firebird connection</div>
<hr />
<div class="pda"><a href="t-269287.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=269287">Firebird connection</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">AstraS</div><div class="date">10th April 2007, 08:49</div></div><div class="posttext">In my custom page user input connection params (ect connection strig, database pats, login, password)<br />
How can i check it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th April 2007, 20:19</div></div><div class="posttext">You can use an external utility like osql (http://www.di-mgt.com.au/osqlUtility.htm) to connect to the database with the supplied parameters.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AstraS</div><div class="date">10th April 2007, 21:10</div></div><div class="posttext">thx. But how can i use it ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th April 2007, 21:15</div></div><div class="posttext">Execute it using the parameters given by the user. If it doesn't return an error, you've made a valid connection and the connection parameters are correct.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AstraS</div><div class="date">10th April 2007, 21:41</div></div><div class="posttext">thx tvice, but i dont understend how can i use it from my installer :(<br />
(sorry for stupid question)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th April 2007, 21:47</div></div><div class="posttext">You can execute it using ExecWait or the nsExec plug-in. Both provide the result. ExecWait in the third parameter and nsExec on the stack.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AstraS</div><div class="date">11th April 2007, 07:41</div></div><div class="posttext">thx It is work. But it is new problem, i should use only freeware/open sorce and other not commercial soft, but this util from Microsoft, and i think that it's not free :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th April 2007, 20:51</div></div><div class="posttext">iodbc (http://www.firstsql.com/iodbc/) is licensed under GPL.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th April 2007, 23:19</div></div><div class="posttext">There are also a plug-in for this task.<br />
<br />
http://nsis.sourceforge.net/NsODBC_plug-in</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">11th April 2007, 23:43</div></div><div class="posttext">AstraS,<br />
Your original question was regarding setting up a Firebird database from NSIS.  As Kichik pointed out, you can use a command line utility to do so.<br />
<br />
If you look at the Firebird documentation (http://www.firebirdsql.org/manual/qsg2-config.html), you will find a tool called gsec, which looks like it should give you what you need.  (I have not actually worked with Firebird databases before, but from the description, it seems like it would work.)<br />
<br />
From Firebird's website:<br />
Firebird comes with a command-line user management tool called gsec. Although its functions can also be performed by a number of third-party GUI utilities, you should at least have a basic knowledge of gsec, since this is the official tool and it's present in every Firebird server installation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AstraS</div><div class="date">12th April 2007, 23:19</div></div><div class="posttext">thx all.<br />
but all of this is not what i want.<br />
i'll try to write it again.<br />
in my installer there are firebird database.<br />
before installation complete, user input login pass and path(to .fdb) file, and installer should check it. If pass login and path is correct the installation complete sucsesfully and if not correct installer somthing to do.<br />
sorry for english</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AstraS</div><div class="date">12th April 2007, 23:25</div></div><div class="posttext">PS and there are two important things<br />
1. it is should work with Firebird<br />
2. and be freeware or GNU or.....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th April 2007, 11:34</div></div><div class="posttext">How is this not what you want? It gives you access to the Firebird database so you can try and connect to it using the details provided by the user. If the connection fails, the credentials are wrong. Aside from osql, which is Microsoft's, everything else mentioned is completely free and Comperio's suggestion is even a part of Firebird itself.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AstraS</div><div class="date">13th April 2007, 13:23</div></div><div class="posttext">thx kichik<br />
but my script not work :( and i don't know why.<br />
i check it and all of this methods work whithout my script</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">13th April 2007, 14:43</div></div><div class="posttext">If the methods work outside of the script, then it's probably in the way that you are calling them within your install.<br />
<br />
Maybe if you attach a minimal example illustrating the problem, then someone could help get you pointed in the right direction.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AstraS</div><div class="date">13th April 2007, 18:50</div></div><div class="posttext">this is my test example<br />
<br />
;--------------------------------<br />
;Include Modern UI<br />
<br />
  !include &quot;MUI.nsh&quot;<br />
<br />
  XPStyle on<br />
  ;Name and file<br />
  Name &quot;B2 server&quot;<br />
  OutFile &quot;Setup.exe&quot;<br />
<br />
 ;Default installation folder<br />
 InstallDir &quot;$PROGRAMFILES\B\B2&quot;<br />
<br />
<br />
  !define MUI_ABORTWARNING<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
<br />
Function CheckDB<br />
	ExecWait '&quot;$INSTDIR\gsec.exe&quot; -user sysdba -pass masterkey -database c:\P\B2.fdb' $0<br />
	DetailPrint &quot;some program returned $0&quot;<br />
FunctionEnd<br />
<br />
;--------------------------------<br />
Section &quot;Main&quot; SecMain<br />
<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  File &quot;gsec.exe&quot;<br />
  call 	CheckDB<br />
  Delete $INSTDIR\gsec.exe<br />
  RMDir $INSTDIR<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AstraS</div><div class="date">13th April 2007, 21:42</div></div><div class="posttext">help me please!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">14th April 2007, 06:44</div></div><div class="posttext">Your script seems like it should work.  But, are you sure you got your command correct?  From the gsec documentation (http://www.firebirdsql.org/manual/fbutils-gsec-cmdline.html), you are only specifying a few options, but no real command.  (in other words, you haven't told it to actually do anything).  (By the way, what are you trying to accomplish anyway?)<br />
<br />
Does the same command run from a RUN box on the target computer?  (You may want to also try it from a command prompt just to see what type of message you may be getting back.)<br />
<br />
It might be helpful to read through the Firebird documentation (http://www.firebirdsql.org/pdfmanual/Firebird-1.5-QuickStart.pdf).  There's some good info there that may help.<br />
<br />
Again, I've never actually used a Firebird database before so this is probably all I can offer you.  From what I can tell so far, it looks like you just need to figure out the proper tools.  Maybe someone else can give you something more...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>