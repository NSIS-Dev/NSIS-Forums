<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait --&gt; then pass text to launched exe..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait --&gt; then pass text to launched exe... NSIS Discussion" />
	
	<title> ExecWait --&gt; then pass text to launched exe... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait --&gt; then pass text to launched exe...</div>
<hr />
<div class="pda"><a href="t-192179.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=192179">ExecWait --&gt; then pass text to launched exe...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">2nd September 2004, 02:02</div></div><div class="posttext">Hello all.<br />
<br />
I'm very new to NSIS, but I already love it.  I seemed to be stumped on my current challenge though.  I am using ExecWait to launch an exe that will automatically do some database editing.  Currently this exe simply requires a user to enter a username and password.  I would like to eliminate that user touch, and after launching the exe, pass in the text: &lt;username&gt;&lt;tab&gt;&lt;password&gt;&lt;enter&gt; .  Can someone point me in the right direction?  Thanks much all.<br />
<br />
Jnuw</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Gurleen</div><div class="date">2nd September 2004, 07:10</div></div><div class="posttext">What if you just pass the the parameters after the execWait<br />
like this <br />
ExecWait 'databaseHandler.exe username password'<br />
<br />
WEll this thing works when you call execWait with .msi <br />
<br />
ExecWait '${INSTALLERDLL}\msxml.msi /qn'  <br />
<br />
In the above command we are running msxml.msi with command line parameters . So you can pass the parameters to your program. Now it depends on your program how it handles these command line parameters.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">2nd September 2004, 08:59</div></div><div class="posttext">For DOS applications it is possible to launch application with redirected i/o . NSIS nsExec plugin hides console window and handles application's output. I also wrote a simple plugin using string parameter as stdin http://forums.winamp.com/showthread.php?s=&amp;threadid=181442&amp;highlight=stdin<br />
You can also set &quot;Ignore default libs&quot; in plugin project to decrease dll size (like this done in other plugins).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">2nd September 2004, 21:10</div></div><div class="posttext">Thanks guys for the responses.  Unfortunately this exe does not accept parameters, and is not a DOS app.  I didn’t write it, and can’t change it to use parms.  This is what it looks like:<br />
<br />
http://webpages.charter.net/orum/1.jpg <br />
<br />
So after launching it, I just need to send or pipe (like in a DOS batch file) a user name, then tab down and enter the password and hit enter.  Would SendMessage work for this?  Thanks all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">3rd September 2004, 15:40</div></div><div class="posttext">yes, sendmessage would work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">3rd September 2004, 16:29</div></div><div class="posttext">MSDN declares the only message for interprocess communication - WM_COPYDATA (Platform SDK/Windows Base Services/Interprocess Communication). This should work always. But in real life other messages work too (but without any warranties &amp;&amp; with some security limitations &amp;&amp; inside the same virtual desktop) - you can find few samples of WM_CLOSE usage in this forum.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">3rd September 2004, 16:36</div></div><div class="posttext">Originally posted by Comm@nder21 <br />
yes, sendmessage would work. <br />
Thanks Comm@ander21.  The exe I’m working with, pictured above, is called Mod.exe.  I'm having some trouble figuring out the syntax of the send message command.  Could someone lend a hand please?<br />
<br />
SendMessage HWND msg wparam lparam [user_var(return value)] [/TIMEOUT=time_in_ms]<br />
<br />
I read that &quot;HWND&quot; is the Windows Handle, which in this case would be Mod.exe.  Past that I’m not sure how to pass the username, then a tab, then the password, then an &lt;enter&gt; to the exe.  Any advice would be appreciated, thanks all.<br />
<br />
Thanks.<br />
Jnuw</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">29th September 2004, 21:57</div></div><div class="posttext">Bump.  Any know the syntax of the send message command?  Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th September 2004, 09:50</div></div><div class="posttext">The window handle is not Mod.exe. You can get the window handle using FindWindow. Once you got the main window's handle, you'd need to find the text field handles. To do that, you'd use GetDlgItem. If it's not a dialog, you'd need FindWindow again.<br />
<br />
Once you have the text fields' window handles you can send them WM_SETTEXT:!include WinMessages.nsh<br />
SendMessage $TEXT_HWND ${WM_SETTEXT} 0 &quot;STR:some text&quot;Then, once the text fields are full, you'd want to press the button. Assuming that is a dialog and that the continue button is the OK button, you'd send the main window a WM_COMMAND message:!include WinMessages.nsh<br />
SendMessage $MAIN_HWND ${WM_COMMAND} 1 0A few possible problems: You can't use ExecWait because the script will not continue to execute all of the SendMessage instructions until that program is closed. If you use Exec, you can't know for sure if the window has already been created and destroyed. Every loop you write might end up an infinite loop.To work around those, you need to write a plug-in or some System.dll code that will give you the process handle so you can wait on it until the window is created.<br />
<br />
The best solution for this is to find a way to pass those parameters in a sane way. If you can't find one, you might want to try AutoIt (http://www.hiddensoft.com/AutoIt3/) first.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">30th September 2004, 15:17</div></div><div class="posttext">kichik, thank you so much for your explanation.  You bring up some very good points there as far as possible problems.  I will check out these options, and post back with the results.  Thanks again.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>