<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to find all users names, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to find all users names NSIS Discussion" />
	
	<title> How to find all users names [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to find all users names</div>
<hr />
<div class="pda"><a href="t-206469.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=206469">How to find all users names</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Dkom</div><div class="date">31st January 2005, 17:04</div></div><div class="posttext">I want to delete files from &lt;sys_disk&gt;:\\Documents and Settings\&lt;user_name&gt;\Application Data\MyProgDir<br />
But $Appdata allows to delete only from AllUsers and CurrentUser. Is it possible to find all other user names without any plugins (maybe some registry values can store all users names)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">31st January 2005, 17:33</div></div><div class="posttext">i think this is hard without using a plugin, u could go thru the keys in HKEY_USERS (except .default) but im not sure if only admins can read this key<br />
<br />
ex: HKEY_USERS\S-1-5-20\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders\AppData</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">1st February 2005, 08:10</div></div><div class="posttext"></div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">1st February 2005, 08:38</div></div><div class="posttext">Get users profile folders name (2000/XP)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Dkom</div><div class="date">1st February 2005, 17:44</div></div><div class="posttext">Thanks, Instructor! Very useful code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpodtbc</div><div class="date">4th January 2007, 19:17</div></div><div class="posttext">that code is useful but what if one of the users changes the location of their special folders by editing the registry in hkey_current_user or using some windows tweak utility? <br />
<br />
currently, i can't find a way to obtain each user's special folders which is interesting since removing user-specific data on an uninstallation would seem desirable.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">4th January 2007, 20:04</div></div><div class="posttext">Originally posted by jpodtbc <br />
that code is useful but what if one of the users changes the location of their special folders by editing the registry in hkey_current_user or using some windows tweak utility? <br />
I suppose if one of the users has changed the location of his/her profile, the registry key where Instructor's code searches should be updated as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">27th June 2010, 17:08</div></div><div class="posttext">Just came across this while looking for a similar solution and here is another method for deriving the user name only (which can then be inserted into the relevant folder path): Use EnumUsersReg (http://forums.winamp.com/showthread.php?postid=2327651) and in the callback function simply query the HKU registry value:<br />
Software\Microsoft\Active Setup\Installed Components\{44BBA840-CC51-11CF-AAFA-00AA00B6015C}<br />
Reading the value of REG_SZ Username.<br />
<br />
Or, if you are only interested in %APPDATA% for that user, simply read in the EnumUsersReg callback the value of REG_SZ AppData in (HKU):<br />
Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders<br />
<br />
<br />
HTH</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>