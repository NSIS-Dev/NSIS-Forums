<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Looking for Rexx SearchPath function, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Looking for Rexx SearchPath function NSIS Discussion" />
	
	<title> Looking for Rexx SearchPath function [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Looking for Rexx SearchPath function</div>
<hr />
<div class="pda"><a href="t-164626.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=164626">Looking for Rexx SearchPath function</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">openafsdev</div><div class="date">13th January 2004, 07:37</div></div><div class="posttext">The following link describes the Rexx SearchPath function in detail <br />
<br />
http://www.borg.com/~jglatt/rexx/scripts/language/funcs5.htm#SEARCHPATH<br />
<br />
In brief, given a PATH-style environment variable (string of directory names separated by semi-colons) and a filename, the function will return the first matching filename found.<br />
<br />
  fullname = SEARCHPATH(path, filename)<br />
<br />
Has anyone implemented something similar to this for NSIS?  This type of functionality is very important when you are trying to find a previous installation which may not have been installed with a means of tracking it.  <br />
<br />
this is often true with opensource security software such as OpenSSL and MIT Kerberos for Windows which has been bundled with just about every application that uses it since there is no standard installation procedure.<br />
<br />
Thanks for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th January 2004, 15:34</div></div><div class="posttext">Get the PATH envrionment variable using ExpandEnvStrings, parse it using string commands like StrCpy and StrCmp and search using FindFirst/FindNext/FindClose.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">openafsdev</div><div class="date">13th January 2004, 15:55</div></div><div class="posttext">Joost, thank you for your reply.  Although a simply 'no' I have not would have been sufficient.  Clearly the building blocks are available to perform the search, it just would have been nicer if the function was available for inclusion.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th January 2004, 16:00</div></div><div class="posttext">You can write your own functions using the NSIS script language and share them with other users in the NSIS Archive.<br />
<br />
There are already file search functions and PATH variable modification function available, so you would only have to combine them to get what you want.<br />
<br />
And if you create one, other can benefit from it too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">openafsdev</div><div class="date">13th January 2004, 22:14</div></div><div class="posttext">Attached is a SearchPath implementation.  Feel free to insert it into the archive.  In exchange, please explain how ExpandEnvStrings and ReadEnvStr are supposed to work.  I can't figure  it out.<br />
<br />
  ReadEnvStr $R0 &quot;PATH&quot;<br />
<br />
sets $R0 to the empty string.  <br />
<br />
  ExpandEnvStrings $R0 &quot;PATH&quot;<br />
<br />
sets $R0 to &quot;PATH&quot;.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th January 2004, 22:30</div></div><div class="posttext">To get the content of a single variable you should use ReadEnvStr.<br />
<br />
ReadEnvStr $R0 &quot;PATH&quot;<br />
<br />
is the correct syntax and works for me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">openafsdev</div><div class="date">13th January 2004, 22:39</div></div><div class="posttext">As indicated it does not work for me.  NSIS 2.0 RC2 built from source with MSVC 6.0.  Installer running on Windows XP SP1.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th January 2004, 11:55</div></div><div class="posttext">What's the output when you enter PATH  in the command line?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">openafsdev</div><div class="date">14th January 2004, 12:01</div></div><div class="posttext">I obtain the PATH<br />
<br />
[C:\]PATH<br />
Path=C:\Program Files\Windows Resource Kits\Tools\;C:\Tcl\bin;C:\Perl\bin\;C:\PROGRAM FILES\THINKPAD\UTILITIES;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System3<br />
2\Wbem;C:\Program Files\ATI Technologies\ATI Control Panel;C:\Program Files\ATI<br />
Technologies\Fire GL 3D Studio Max;C:\Program Files\ATI Technologies\Fire GL Control Panel;C:\Program Files\PC-Doctor for Windows\services;C:\Program Files\Common Files\Adaptec Shared\System;c:\program files\resource kit\bin;c:\perl\bin;c:\<br />
ssleay32;c:\kerberos;c:\kermit;c:\rse;c:\rse\nt;c:\tools\hamilton\bin;c:\tools\mks\mksnt;C:\Program Files\Support Tools\;c:\tools\sysinternals;C:\Program Files\OpenAFS\Client\Program;C:\Program Files\OpenAFS\Common;C:\Adabas\bin;C:\Adabas\pgm</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th January 2004, 12:07</div></div><div class="posttext">Are you absolutely sure your script is correct? I tested it on multiple systems and it always gives the right output.<br />
<br />
Try:<br />
<br />
ReadEnvStr $R0 &quot;PATH&quot;<br />
MessageBox MB_OK $R0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">openafsdev</div><div class="date">14th January 2004, 12:13</div></div><div class="posttext">I copied your text exactly as you wrote it and pasted it followed by an &quot;abort&quot; command to the very beginning of the .onInit function.  The end result is a message box displaying the empty string.<br />
<br />
Is there anyway to build a debug version of the generated installer?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th January 2004, 12:54</div></div><div class="posttext">Maybe the string is too large for the default string size. Try to increase NSIS_MAX_STRLEN in exehead\config.h</div></div><hr />


<div class="post"><div class="posttop"><div class="username">openafsdev</div><div class="date">14th January 2004, 13:03</div></div><div class="posttext">increasing to 4096 did indeed solve the problem.   <br />
<br />
fyi, it would be a good idea to autogenerate the makenssi.mak and makenssi.dep files from the makenssi.dsw project.  that would allow the .NET2003 compiler to be used to build the project from the command line.  Unfortunately, I have not figured out yet how to generate makefiles from .NET2003.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th January 2004, 13:10</div></div><div class="posttext">Makefiles are published in this topic:<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=163009<br />
<br />
We are still looking for someone who wants to test these files with the free .NET command line compiler.<br />
<br />
Any help would be great.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">openafsdev</div><div class="date">14th January 2004, 13:14</div></div><div class="posttext">well, I don't have the &quot;free&quot; compiler.  I have the complete set of MSVC++ 6.0, MSVS.NET, and MSVS.NET2003 tools.  Using MSVC++ 6.0 I have generated the .mak and .dep files and then successfully used them to build NSIS with the MSVS.NET2003 compiler.<br />
<br />
I can provide the generated .dep and .mak files if you desire them.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>