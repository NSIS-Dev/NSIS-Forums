<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Win 7 register OCX problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Win 7 register OCX problem NSIS Discussion" />
	
	<title> Win 7 register OCX problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Win 7 register OCX problem</div>
<hr />
<div class="pda"><a href="t-322850.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322850">Win 7 register OCX problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">thek</div><div class="date">1st October 2010, 14:04</div></div><div class="posttext">Hello<br />
<br />
I have the following problem<br />
registering a control (cwui.ocx) from commandline works<br />
<br />
via NSIS only If I remoe the &quot;RequestExecutionLevel admin&quot; entry<br />
codeexample:<br />
!include Library.nsh<br />
Name &quot;test_ocx_install&quot;<br />
OutFile &quot;test_ocx_install.exe&quot;<br />
InstallDir $DESKTOP\Example1<br />
; Request application privileges for Windows Vista<br />
RequestExecutionLevel admin<br />
; Pages<br />
ShowInstDetails show<br />
Page directory<br />
Page instfiles<br />
Section &quot;&quot;<br />
  SetOutPath $TEMP<br />
    !insertmacro  InstallLib REGDLL 0 REBOOT_PROTECTED &quot;..\common\binaries\system32<br />
cwui.ocx&quot;      $SYSDIR\cwui.ocx  $SYSDIR<br />
    ${If} ${Errors}<br />
        DetailPrint &quot;Instlib failed&quot;<br />
        ClearErrors<br />
    ${endIf}<br />
SectionEnd<br />
<br />
This one failes<br />
if I remove the RequestExecutionLevel admin or replace it with RequestExecutionLevel none, the register task works well?!?!?<br />
<br />
<br />
Some hints what I'm doing wrong?:confused:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">meaningoflights</div><div class="date">21st February 2011, 07:13</div></div><div class="posttext">I have the same code (has worked perfectly for years) and now I too am getting customers reporting they install my app and get an error about &quot;RICHTX32.ocx&quot; not being registered.<br />
<br />
When I get my customers to run the RegSvr32 command it works and they can then run my application.<br />
<br />
I'm not sure about taking out the &quot;RequestExecutionLevel admin&quot; - does that seriously work as none? <br />
<br />
Even if I reproduce and confirm it is a workaround I would prefer to look into why the standard command doesn't work with admin? You know it would be a hack to detect the OS is win7 and have a condition to lower the privilages to none upon executing the  !insertmacro  InstallLib REGDLL <br />
<br />
This is really frustrating me because we've had win 7 users for a while now and all of a sudden 3 reports in as little as 5 days. Any help would be much appreciated. TIA</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thek</div><div class="date">21st February 2011, 08:19</div></div><div class="posttext">Sorry but we still haven't found a solution to this problem!<br />
<br />
Thats not 100% right, the newest version of this control don't have this problem, so we gonna  update it<br />
<br />
The last workaround would be to do pack the control in an MSI file and run it from the installer.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>