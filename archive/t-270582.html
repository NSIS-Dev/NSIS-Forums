<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" User Directory in Vista, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  User Directory in Vista NSIS Discussion" />
	
	<title> User Directory in Vista [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  User Directory in Vista</div>
<hr />
<div class="pda"><a href="t-270582.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=270582">User Directory in Vista</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MikeInVancouver</div><div class="date">3rd May 2007, 23:46</div></div><div class="posttext">I have run into a problem with Vista when the unistall is run. The files in the installation directory are all removed without a problem, but Vista has decided to make copies of the data files used by the application. So after an uninstall is run and the application is reinstalled in the same location for some reason the application looks for the copies first??????? (gotta love Vista). I need to remove these files on uninstall, but they exist in the users folder structure, specifically: c:\Users\&quot;username&quot;\AppData\Local\VirtualStore\Program Files\MyProgram\myprogram.exe<br />
<br />
So what I am trying to get is the Window users name so I can remove the appropiate folders.<br />
<br />
Any help is appreciated.<br />
<br />
Sorry for the long winded question but I thought others might be having a similar problem and I wanted it to be understood by all.<br />
<br />
Thank you,<br />
<br />
Mike</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">3rd May 2007, 23:55</div></div><div class="posttext">System::Call &quot;advapi32::GetUserName(t.r0,*i ${NSIS_MAX_STRLEN})i&quot;<br />
DetailPrint &quot;User name - $0&quot;<br />
<br />
If you want to write to program files you should add a manifest to your application telling vista it needs to run it as admin or save your users data in a folder where a normal user has access (Appdata or My documents etc)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>