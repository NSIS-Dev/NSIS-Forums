<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Reading Custom Page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Reading Custom Page NSIS Discussion" />
	
	<title> Reading Custom Page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Reading Custom Page</div>
<hr />
<div class="pda"><a href="t-284216.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=284216">Reading Custom Page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">backpacker299</div><div class="date">2nd January 2008, 16:36</div></div><div class="posttext">I have searched many places and tried different ways to read from a custom page, but things still do not work. I am looking for some help. Here are the relevant code shown in oder of processing (things exist in different, included, files)<br />
<br />
Var Database_Server ; Database server location<br />
Var Database_Database ; Database to use<br />
Var Database_Username ; Username to connect with<br />
Var Database_Password ; Password to connect with<br />
<br />
#----- PreDsnPage<br />
#                         Prepare the DSN custom page for action<br />
Function PreDsnPage<br />
<br />
         !insertmacro MUI_HEADER_TEXT &quot;Liebert Autotest Suite Setup&quot; &quot;ODBC Datasource Configuration&quot;<br />
         !insertmacro INSTALLOPTIONS_DISPLAY &quot;DSN.ini&quot;<br />
         <br />
FunctionEnd<br />
<br />
#----- PostDsnPage<br />
#                         Copy the data entered on the DSN custom page.<br />
Function PostDsnPage<br />
<br />
         ReadINIStr $Database_Server &quot;DSN.ini&quot; &quot;Field 5&quot; &quot;State&quot;<br />
         ReadINIStr $Database_Database &quot;DSN.ini&quot; &quot;Field 6&quot; &quot;State&quot;<br />
         ReadINIStr $Database_Username &quot;DSN.ini&quot; &quot;Field 8&quot; &quot;State&quot;<br />
         ReadINIStr $Database_Password &quot;DSN.ini&quot; &quot;Field 9&quot; &quot;State&quot;<br />
         <br />
         MessageBox MB_OK &quot;Server: $Database_Server&quot;<br />
         MessageBox MB_OK &quot;Database: $Database_Database&quot;<br />
         MessageBox MB_OK &quot;Username: $Database_Username&quot;<br />
         MessageBox MB_OK &quot;Password: $Database_Password&quot;<br />
<br />
FunctionEnd<br />
<br />
#----- .onInit<br />
#             Verifies that LAS is not already installed and then copies<br />
#             default directory locations to variables<br />
Function .onInit<br />
<br />
        ...<br />
<br />
        #----- Extract the Datasource custom page file<br />
        !insertmacro INSTALLOPTIONS_EXTRACT &quot;DSN.ini&quot;<br />
<br />
FunctionEnd<br />
<br />
The message boxes that I have to display the input display blanks.<br />
<br />
Thanks in advance for any and all help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">2nd January 2008, 16:45</div></div><div class="posttext">ReadINIStr... but where is that ini? Is it extracted properly into pluginsdir?<br />
If so you should add:<br />
ReadINIStr $Database_Server &quot;$PLUGINSDIR\DSN.ini&quot; &quot;Field 5&quot; &quot;State&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">2nd January 2008, 16:45</div></div><div class="posttext">Hi there!<br />
<br />
I'd suggest using<br />
<br />
<br />
ReadINIStr $Database_Username &quot;$PLUGINSDIR\DSN.ini&quot; &quot;Field 8&quot; &quot;State&quot;<br />
<br />
<br />
or<br />
<br />
<br />
!insertmacro INSTALLOPTIONS_READ $Database_Username &quot;DSN.ini&quot; &quot;Field 8&quot; &quot;State&quot;<br />
<br />
<br />
Use whatever you like best.<br />
<br />
Cheers<br />
<br />
Bruno</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">2nd January 2008, 16:46</div></div><div class="posttext">@Red Wine:<br />
<br />
Bullseye! Hit enter on the same time!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">backpacker299</div><div class="date">2nd January 2008, 16:58</div></div><div class="posttext">That would be the problem. Thank you both.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>