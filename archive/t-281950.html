<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Launch an .exe file after install?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Launch an .exe file after install? NSIS Discussion" />
	
	<title> Launch an .exe file after install? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Launch an .exe file after install?</div>
<hr />
<div class="pda"><a href="t-281950.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=281950">Launch an .exe file after install?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Contex</div><div class="date">22nd November 2007, 19:57</div></div><div class="posttext">Well I'm making a uninstaller that installs something.<br />
And how can I make the uninstaller open an .exe file right after you click close etc. (It's a kind of scanner) Scans a folder for something, if it detects, it deletes the files.<br />
<br />
Here's my code:<br />
<br />
<br />
;------------------------------------------------------<br />
	!include &quot;MUI.nsh&quot;<br />
<br />
	Name &quot;moh_breakthrough_demo&quot;<br />
	OutFile &quot;moh_breakthrough_demo.exe&quot;<br />
<br />
	InstallDir &quot;$PROGRAMFILES\EA GAMES\Medal of Honor Allied Assault Breakthrough Demo\&quot;<br />
	<br />
	!define MUI_HEADERIMAGE<br />
	!define MUI_HEADERIMAGE_BITMAP &quot;moh_header.bmp&quot;<br />
	<br />
	!define MUI_ABORTWARNING<br />
	!define MUI_WELCOMEFINISHPAGE_BITMAP &quot;moh_wizard.bmp&quot;<br />
	<br />
	!define MUI_ICON &quot;arrow2-install.ico&quot;<br />
	<br />
	!insertmacro MUI_PAGE_INSTFILES<br />
<br />
	!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
Section hideuinstaller<br />
<br />
HideWindow<br />
<br />
SectionEnd<br />
<br />
Section &quot;scan&quot; scan<br />
<br />
      Delete &quot;$INSTDIR\genocide.dll&quot;<br />
<br />
SectionEnd<br />
<br />
Section openfile<br />
<br />
Exec '&quot;$INSTDIR\moh_breakthrough.exe&quot; &quot;parameter 1&quot; &quot;parameter 2&quot;'<br />
 <br />
SectionEnd<br />
<br />
Section close<br />
<br />
SetAutoClose true<br />
<br />
SectionEnd<br />
<br />
;--------------------------------------------------------<br />
<br />
<br />
<br />
And when I try to run the uninstall i can see it delete the file.. but when it closes a problem pops up:<br />
<br />
<br />
http://img263.imageshack.us/img263/9590/launchmfcfo7.jpg <br />
<br />
Help :D?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd November 2007, 10:39</div></div><div class="posttext">According to the name the dialog displays it seems the application you're executing is crashing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Contex</div><div class="date">23rd November 2007, 13:20</div></div><div class="posttext">But when I exec a normal .txt file from notepad.. The same thing happends? :/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd November 2007, 13:22</div></div><div class="posttext">With the exact same text? Where does this text come from? What program of yours is called &quot;Launch MFC&quot;? Look for that program as that's the one that is crashing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Contex</div><div class="date">23rd November 2007, 19:49</div></div><div class="posttext">Oh now it doesn't even open the .txt file when i tested. And I think it's the moh_breakthrough.exe that's called Launch MFC... Well it's not running the .txt file either? Could that be a script problem?<br />
<br />
Also:<br />
Could it be because I use Vista x64? 64-bit..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd November 2007, 20:00</div></div><div class="posttext">Nothing in NSIS itself is called &quot;Launch MFC&quot; and nothing in the script you've provided is called &quot;Launch MFC&quot;. You must first find out what is this &quot;Launch MFC&quot; thing in order to find out what's wrong.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">23rd November 2007, 20:35</div></div><div class="posttext">That is a crash associated with the Quake 3 engine launcher (in your case moh_breakthrough.exe). I seem to remember (i.e. games like MOH, ET). If it is crashing then the game isn't installed properly.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Contex</div><div class="date">23rd November 2007, 21:15</div></div><div class="posttext">Hmmm.. Could it be because it's a cracked .exe? For allowing mods into the game. Maybe that's why its crashing?.. Maybe I should try to run some other file :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Fightin_Foo</div><div class="date">23rd November 2007, 22:46</div></div><div class="posttext">Just a quick thought here but did you try using the un.onUninstSuccess function?  It is called after the uninstaller is finished.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Contex</div><div class="date">24th November 2007, 00:48</div></div><div class="posttext">Well, I made a batch file thought.. Made it lanuch the batch file then lanuch the game file :S It worked then, Wierd eh. But I'll try that Fightin_Foo But first.. Eh this isn't a uninstaller, it's like a scanner. But I made it as an installer :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th November 2007, 11:38</div></div><div class="posttext">Try setting the working directory first to the same directory that contains the executable with SetOutPath.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Contex</div><div class="date">24th November 2007, 11:43</div></div><div class="posttext">InstallDir &quot;$PROGRAMFILES\EA GAMES\Medal of Honor Allied Assault Breakthrough Demo\&quot;<br />
<br />
Exec '&quot;$INSTDIR\moh_breakthrough.exe&quot; &quot;parameter 1&quot; &quot;parameter 2&quot;'<br />
<br />
So you mean I should place it in same directory as the &quot;scanner&quot; ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fluidz91</div><div class="date">14th January 2008, 17:01</div></div><div class="posttext">Originally posted by Afrow UK <br />
Try setting the working directory first to the same directory that contains the executable with SetOutPath.<br />
<br />
Stu <br />
Damn ! that solved a problem i had launching an .exe on .onInstSuccess. The .exe i was trying to launch with Exec command was generating errors. If i ran manually the .exe no problem, so i created a batch file to launch installer then application. In the NSIS script, i was copying a file to a subdirectory of the application to launch, then tried to exec the .exe but got errors, i just added the red part to the script as below :<br />
<br />
# Installer sections<br />
Section -Main SEC0000<br />
    SetOutPath $EXEDIR\SubDir<br />
    SetOverwrite on<br />
    File myfile.ext<br />
SectionEnd<br />
<br />
Function .onInstSuccess<br />
    SetOutPath $EXEDIR<br />
    Exec '&quot;App.exe&quot;'<br />
FunctionEnd<br />
<br />
<br />
And now it works like a charm.<br />
<br />
Hope that tip can help ppl in the future...<br />
<br />
Thx 4ever Afrow UK !<br />
<br />
Sorry for (very) explanation and (very) bad english ^^</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>