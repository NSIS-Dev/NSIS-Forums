<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" DllRegisterServer Problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  DllRegisterServer Problem NSIS Discussion" />
	
	<title> DllRegisterServer Problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  DllRegisterServer Problem</div>
<hr />
<div class="pda"><a href="t-53092.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=53092">DllRegisterServer Problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">arundel</div><div class="date">21st June 2001, 10:21</div></div><div class="posttext">I've got quite a problem here:<br />
<br />
I'd like NSIS to do this:<br />
<br />
$SYSDIR\regsvr32.exe /s File.ax<br />
<br />
How do I do that? I tried it with Exec and ExecShell, but that doesn't work. I tried the RegDLL Instruction and somehow feel this is the right command, but I can't figure out how to get the line above work.<br />
<br />
Could somebody give me a hint here?:(<br />
<br />
THX<br />
<br />
[Edited by arundel on 06-21-2001 at 08:11 AM]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arundel</div><div class="date">22nd June 2001, 14:38</div></div><div class="posttext">Well thank you very much for that big help.<br />
<br />
After a few hours of hard thinking and trying I found out a good way of executing the following command myself:<br />
<br />
&quot;$SYSDIR\regsvr32.exe /s $SYSDIR\File.ax&quot;<br />
<br />
This worked well:<br />
<br />
WriteRegStr HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce\Setup&quot; &quot;This will appear in the Register-Window&quot; &quot;$SYSDIR\regsvr32.exe /s $SYSDIR\File&quot;<br />
<br />
ExecWait $SYSDIR\runonce.exe ;This will run the above line and remove it from the registry<br />
<br />
<br />
I hope someone will respond to my next article!:mad:<br />
<br />
<br />
Ciao</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Gonzotek</div><div class="date">22nd June 2001, 15:39</div></div><div class="posttext">:0<br />
<br />
You only gave them 1 day....do you pay more for faster response times or something...<br />
<br />
I get my tech support for free here, and I never had a problem waiting for a week or so until I got an answer.  I read your post, but, heck, I didn't know the answer.<br />
<br />
Sorry, just venting a little. :D<br />
<br />
I'm glad you figured it out though, what exactly were you trying to do there.  I was a bit confused on the first post, and now I'm totally lost.  Are you just registering an ActiveX component?<br />
<br />
-=Gonzotek=-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PabUK</div><div class="date">22nd June 2001, 19:58</div></div><div class="posttext">Yeah, no need to get all upset because there was no response. You have to remember two things - this is the least visited of the Winamp forums and also what if nobody had the solution? Plus you didn't give it enough time like Gonzotek said.<br />
<br />
No need to get pissed off.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arundel</div><div class="date">22nd June 2001, 21:39</div></div><div class="posttext">i wasn't realy angry that nobody was responding to my thread. I was just hanging around that part which did not work and was feeling like this was realy essential.<br />
<br />
I only started scripting with NSIS a week ago and was getting to the point, where the manual can't help you anymore. Although I'm not into this business for very long I read quite a lot of threads in this Forum and must say that there are a lot of friendly guys in here who enjoy helping their troubled pals.<br />
<br />
So please don't take my IMPATIENCE personaly.:rolleyes:<br />
<br />
Gonzotek:<br />
<br />
Yes, it was my intention to register an ActiveX component.<br />
I'm putting up a compilation of DivX Codecs and needed to register the Direct Show Decoder (DivXa32.ax).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Gonzotek</div><div class="date">22nd June 2001, 23:12</div></div><div class="posttext">OK, It's cool.  Don't let me scare you off from asking for more help...Sometimes all the attitude in messages boards in general gets to me (and then I get my own attitude :) ).<br />
<br />
-=Gonzotek=-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Edgewize</div><div class="date">22nd June 2001, 23:23</div></div><div class="posttext">Strange that you need to go to all that trouble just to register the ActiveX component, I would think that these lines should work:<br />
<br />
SetOutPath &quot;$SYSDIR&quot;<br />
File &quot;divxa32.ax&quot;<br />
RegDLL &quot;$SYSDIR\divxa32.ax&quot;<br />
<br />
If RegDLL doesn't do it, this should definately work:<br />
<br />
SetOutPath &quot;$SYSDIR&quot;<br />
File &quot;divxa32.ax&quot;<br />
ExecWait &quot;$SYSDIR\regsvr32.exe /s $SYSDIR\divxa32.ax&quot;<br />
<br />
And if neither of those work, then there is something wrong with NSIS because they both ought to do the job.  What version of NSIS are you using?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arundel</div><div class="date">22nd June 2001, 23:45</div></div><div class="posttext">I'm using Nullsoft's pre-compiled NSIS 1.44!<br />
<br />
Your lines also work, but if I use the Run Once Wrapper Windows gives me a nice output window displaying the Registration Progress. Well actualy it all does the same and after all that trial-and-error procedure I went through I'd like to keep those lines of code.<br />
<br />
It surely is a bit longer and takes up a few more lines, but the final installer-output-file is just 500 KB, so that's not a problem at the moment.<br />
<br />
What also helped me a lot was your WindowsVersionDetect Function. I put that right into my .oninit Function.<br />
<br />
If you don't mind I made the following modification which might help in the future:<br />
<br />
;OLD PART OF CODE<br />
<br />
lbl_winnt: <br />
<br />
    StrCpy $9 $0 1<br />
    StrCmp $9 '3' lbl_winnt_x<br />
    StrCmp $9 '4' lbl_winnt_x<br />
    StrCmp $9 '5' lbl_winnt_5 lbl_error<br />
<br />
<br />
;NEW PART OF CODE<br />
<br />
lbl_winnt: <br />
<br />
    StrCpy $9 $0 1<br />
    StrCmp $9 '3' lbl_winnt_x<br />
    StrCmp $9 '4' lbl_winnt_x<br />
    StrCpy $9 $0 3<br />
    StrCmp $9 '5.0' lbl_winnt_5<br />
    StrCmp $9 '5.1' lbl_winxp lbl_error<br />
<br />
After finishing my current project I think I oughta extend my C++ and Assembler horizon...<br />
<br />
Thanks for your help...;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Edgewize</div><div class="date">22nd June 2001, 23:51</div></div><div class="posttext">Other software install programs often put stuff in the RunOnce section and expect it to be run at the next reboot, in order to replace or upgrade DLL files before they are loaded into memory.<br />
<br />
By running &quot;runonce.exe&quot; yourself instead of letting Windows trigger it on reboot, you might break other install/uninstall programs that the user has run right before yours.  Using ExecWait on &quot;regsvr32.exe&quot; should have the same effect as using runonce but without that possible side effect.<br />
<br />
No matter what you do, though, I'm glad it works for you :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>