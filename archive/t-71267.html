<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" file extension registration, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  file extension registration NSIS Discussion" />
	
	<title> file extension registration [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  file extension registration</div>
<hr />
<div class="pda"><a href="t-71267.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=71267">file extension registration</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">superrock</div><div class="date">8th January 2002, 18:37</div></div><div class="posttext">Hi!<br />
<br />
How can a file extention be registered for opening a file with the windows explorer by double clicking?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th January 2002, 19:49</div></div><div class="posttext">Hi!<br />
<br />
Under HKEY_CLASSES_ROOT key in the registry create the following structure:<br />
<br />
.ext = MyApp<br />
MyApp = My Application<br />
   |<br />
   -- Shell<br />
        |<br />
        -- open<br />
             |<br />
             -- command = c:\mydir\my.exe %1<br />
<br />
<br />
In NSIS script it should look something like this:<br />
WriteRegStr HKCR &quot;.ext&quot; &quot;&quot; &quot;MyApp&quot;<br />
WriteRegStr HKCR &quot;MyApp\Shell\open\command&quot; &quot;&quot; '&quot;C:\MyDir\my.exe&quot; %1'<br />
<br />
If you want you can also add a DefaultIcon key:<br />
WriteRegStr HKCR &quot;MyApp\DefaultIcon&quot; &quot;&quot; &quot;C:\MyDir\my.ico&quot;<br />
or<br />
WriteRegStr HKCR &quot;MyApp\DefaultIcon&quot; &quot;&quot; &quot;C:\MyDir\my.exe,1&quot;<br />
<br />
KiCHiK</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angry Weasel</div><div class="date">8th January 2002, 20:27</div></div><div class="posttext">There is another way...here's my function for it.<br />
<br />
<br />
Function RegExt<br />
Pop $0<br />
StrCmp $0 &quot;&quot; EndNow<br />
StrCpy $1 $0 20 1 <br />
WriteRegStr HKCR &quot;$1&quot; &quot;&quot; &quot;$1file&quot;<br />
WriteRegStr HKCR &quot;$1file\DefaultIcon&quot; &quot;&quot; &quot;$INSTDIR\MyIcon.ico&quot;<br />
WriteRegStr HKCR &quot;$1file\Shell\open\command&quot; &quot;&quot; &quot;$INSTDIR\MyApp.exe&quot;<br />
# If your icon is built in to your .exe, <br />
# use &quot;$INSTDIR\MyApp.exe,n&quot; where n is the<br />
# number of the icon in the .exe (start with 0 not 1)<br />
FunctionEnd<br />
<br />
<br />
To use it:<br />
<br />
Push &quot;.blah&quot; ; whatever your file extension is<br />
Call RegExt<br />
<br />
<br />
Sorry I can't figure out how to get the function to work properly for the uninstall thing but here's what you need to do...replace &quot;blah&quot; with whatever your extension is:<br />
<br />
<br />
DeleteRegKey HKCR &quot;.blah&quot;<br />
ReadRegStr $0 &quot;.blah&quot; &quot;&quot;<br />
DeleteRegKey HKCR &quot;$0&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mow</div><div class="date">24th September 2002, 20:33</div></div><div class="posttext">hi,<br />
<br />
I have used this method to register my own icon for my application. works fine. however, if there are already existing files with my filetype, the new icon is not displayed immediately. I need to kill/restart the explorer process or logout/login (which obviuosly does the same).<br />
<br />
How can I trigger that the explorer refreshes icons?<br />
<br />
Thanks,<br />
<br />
mow</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th September 2002, 22:37</div></div><div class="posttext">It's for VB, but you can easily do this with NSIS too:<br />
<br />
http://groups.google.com/groups?q=refreshing+the+%22icon+cache%22+windows&amp;hl=en&amp;lr=&amp;ie=UTF-8&amp;safe=off&amp;selm=MPG.faea75a5d002cfc989696%40news.apex.net&amp;rnum=2<br />
<br />
To send a timed message you will have to use the latest CVS version or a DLL. With the latest CVS version:<br />
<br />
SendMessage ${HWND_BROADCAST} ${WM_SETTINGCHANGE} 0x002A 0 /TIMEOUT=5000<br />
<br />
I got the 0x002A from this line in WinUser.h:<br />
#define SPI_SETNONCLIENTMETRICS     0x002A</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mow</div><div class="date">2nd February 2003, 12:53</div></div><div class="posttext">Hi,<br />
<br />
Sending this message is not enough, I suppose.<br />
<br />
I've done that, the screen flickers but nothing else happens - the icons don't change!<br />
<br />
Then I found a hint to change the default icon size, send the message, restore the original default icon size and send the message again.<br />
The registry entry is: <br />
HKCU &quot;Control Panel\Desktop\WindowMetrics&quot; &quot;Shell Icon Size&quot;<br />
If it does not exist, I use the default windows size 32...<br />
<br />
This seems to work, but is there another, an easier way to accomplish it?<br />
<br />
<br />
mow</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd February 2003, 15:34</div></div><div class="posttext">I never said the message alone will do, I just noted how to accomplish a certain part of the steps required in the link I have provided.<br />
<br />
I do not know of a better way, you'll have to search for it. If you do find one, plesae let us know about it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mow</div><div class="date">10th March 2003, 16:45</div></div><div class="posttext">hi!<br />
<br />
I have just realized, that sending this message rearranges all the icons on my desktop!!!!!!!!!!!!!!!<br />
<br />
<br />
how can I prevent this?<br />
<br />
<br />
please help,<br />
<br />
<br />
mow</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mow</div><div class="date">10th March 2003, 18:09</div></div><div class="posttext">hi, <br />
<br />
I have verified this:<br />
<br />
it just happens with windows xp.<br />
<br />
any ideas?<br />
<br />
<br />
thanks,<br />
<br />
<br />
mow</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th March 2003, 18:18</div></div><div class="posttext">You are rebuilding the icon cache. That is not nessacarry to make Window display the new icon, usually just a refresh of the Explorer Window works.<br />
<br />
There is no easy way to restore the desktop icon locations. It is possible, but it requires a lot of work and you need to write a plugin for it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mow</div><div class="date">10th March 2003, 18:27</div></div><div class="posttext">hi,<br />
<br />
do you mean if I send a refresh to the explorer window, it should do?<br />
<br />
how can I do this? does findwindow help me here?<br />
<br />
<br />
thanks for your help,<br />
<br />
<br />
mow</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>