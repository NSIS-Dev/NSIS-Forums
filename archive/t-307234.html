<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Launch program as admin from user priviledge script, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Launch program as admin from user priviledge script NSIS Discussion" />
	
	<title> Launch program as admin from user priviledge script [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Launch program as admin from user priviledge script</div>
<hr />
<div class="pda"><a href="t-307234.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=307234">Launch program as admin from user priviledge script</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">qwertymodo</div><div class="date">10th June 2009, 00:40</div></div><div class="posttext">I have an NSIS script that currently runs with only user privileges just fine, but I want to run an external application from my script that requires admin privileges.  When I try to do this currently, it just does nothing.  Is there any way to elevate the external app that needs it without requiring admin elevation for the whole script?  As it stands, if the only answer is to RequestExecutionLevel highest, I will just drop the whole thing.  I absolutely do not want to do this, as the external app, while it would be very nice to have that ability, is still a small, non-integral part of the script.  Thank you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">10th June 2009, 01:05</div></div><div class="posttext">If the external app requires &quot;admin&quot; rights, then the external app itself should request the required rights instead of just failing. But if you need to deal with the external app &quot;as-is&quot;, then you could make a dummy installer. While your main installer runs at &quot;user&quot; level, the dummy runs at &quot;admin&quot; level. That can be done using RequestExecutionLevel. The main installer will launch the dummy and the dummy will launch the external application at elevated execution level.<br />
<br />
Also the UAC Plugin for NSIS may be worth a look, although that plugin is more intended to run an external app at &quot;user&quot; level from an installer that is running at &quot;admin&quot; level.<br />
<br />
BTW: Why not run the installer with &quot;admin&quot; rights? Most things an installer has to do will require that anyway...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">qwertymodo</div><div class="date">10th June 2009, 21:24</div></div><div class="posttext">I don't want to run the whole thing as admin because it's not an installer, it's a portable application launcher (see portableapps.com).  For portability's sake, it should be able to run as a normal user, as 99% of the app doesn't need admin privileges.  Unfortunately that 1% (which is actually a separate executable from the main app, so it gets run separately) simply fails to run when launched from a script that is running with user privileges.  I will try the dummy script idea and see how that works.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>