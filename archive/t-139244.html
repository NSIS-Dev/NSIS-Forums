<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Another uninstall question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Another uninstall question NSIS Discussion" />
	
	<title> Another uninstall question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Another uninstall question</div>
<hr />
<div class="pda"><a href="t-139244.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=139244">Another uninstall question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Jermbox</div><div class="date">16th June 2003, 21:33</div></div><div class="posttext">I am trying to uninstall a directory that I created with the CreateDirectory command during the install process. I am using:<br />
<br />
     rmdir /r &quot;$INSTDIR\dir&quot;<br />
<br />
($INSTDIR=C:\&quot;) but, the directory never gets removed. I changed the $INSTDIR variable to the actual drive letter, rmdir /r &quot;C:\dir&quot; and it works just fine. Is this an issue with a root installations or am I doing something wrong? Any ideas would be appreciated.<br />
<br />
Thanks in advance,<br />
<br />
J.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">16th June 2003, 21:51</div></div><div class="posttext">Why not:<br />
<br />
RMDir /r &quot;$INSTDIR&quot; ;this will delete all files and folders on it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jermbox</div><div class="date">16th June 2003, 22:09</div></div><div class="posttext">I can't use, RMDir /r &quot;$INSTDIR&quot; , because $INSTDIR is the root of C:\. I am just trying remove the specific folders that I create in $INSTDIR.<br />
<br />
J.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">16th June 2003, 22:22</div></div><div class="posttext">Then...<br />
<br />
RMDir /r &quot;$INSTDIR\dir1&quot;   <br />
RMDir /r &quot;$INSTDIR\dir2&quot;<br />
...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">16th June 2003, 22:23</div></div><div class="posttext">Add<br />
<br />
MessageBox MB_OK $INSTDIR<br />
<br />
and check the result.<br />
<br />
Maybe there is a \ at the end, so you get C:\\, but I think NSIS automatically removes it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jermbox</div><div class="date">16th June 2003, 23:30</div></div><div class="posttext">I inserted the MessageBox MB_OK $INSTDIR and the results were fine,<br />
C: .<br />
<br />
So i guess what this means is the the rmdir /r &quot;$INSTDIR\dir&quot; command does not work on a folder if $INSTDIR is the root of the drive.<br />
<br />
Hmmm.<br />
<br />
<br />
J.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th June 2003, 12:23</div></div><div class="posttext">RMDir should only not delete if you are trying to delete the drive itself if you have used AllowRootDirInstall true (C: for example won't work, C:\ would work). I will check it out.<br />
<br />
BTW, How did you get the uninstall to accept C: as your $INSTDIR?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jermbox</div><div class="date">17th June 2003, 15:17</div></div><div class="posttext">Here is how I set C: for $INSTDIR<br />
<br />
   !define SYSDRIVE &quot;C:\\&quot;<br />
      AllowRootDirInstall true<br />
    InstallDir ${SYSDRIVE}<br />
<br />
It seems to work for the install. Directories get created fine, files get put where the need to be, it's just during the uninstall where it has problems. When the uninstaller runs it doesn't give any errors it just won't remove the directory.<br />
<br />
I made another base script as a test and found that the a MessageBox command in the install section that checks the variable $INSTDIR was correct but when I had another MessaageBox in the uninstall section, it was wrong. I am not sure what the deal is but I attached the test script that I used. Maybe someone can figure this out. It has me confused.<br />
<br />
Thanks in advance,<br />
<br />
J.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jermbox</div><div class="date">18th June 2003, 14:48</div></div><div class="posttext">Not sure if this helps any but I ran a dumpstate call in the install section and in the un-install section. Below are the results...<br />
<br />
Install Section Dumpstate:<br />
<br />
$0: <br />
$1: <br />
$2: <br />
$3: <br />
$4: <br />
$5: <br />
$6: <br />
$7: <br />
$8: <br />
$9: <br />
$R0: <br />
$R1: <br />
$R2: <br />
$R3: <br />
$R4: <br />
$R5: <br />
$R6: <br />
$R7: <br />
$R8: <br />
$R9: <br />
$CMDLINE: &quot;E:\Projects\Install\testApp.exe&quot; <br />
$INSTDIR: C:<br />
$OUTDIR: <br />
$EXEDIR: E:\Projects\Install<br />
$LANGUAGE: 1033<br />
<br />
<br />
Un-Install Section Dumpstate:<br />
<br />
$0: <br />
$1: <br />
$2: <br />
$3: <br />
$4: <br />
$5: <br />
$6: <br />
$7: <br />
$8: <br />
$9: <br />
$R0: <br />
$R1: <br />
$R2: <br />
$R3: <br />
$R4: <br />
$R5: <br />
$R6: <br />
$R7: <br />
$R8: <br />
$R9: <br />
$CMDLINE: &quot;C:\Temp\A~NSISu_.exe&quot; <br />
$INSTDIR: C:\Testdir<br />
$OUTDIR: C:\Testdir<br />
$EXEDIR: C:\Temp<br />
$LANGUAGE: 1033<br />
<br />
?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th September 2003, 17:30</div></div><div class="posttext">Latest CVS version allows you to put the uninstaller on the root directory (assuming you use AllowRootDirInstall true). I'm sorry for the long delay.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">YooperNC</div><div class="date">17th May 2004, 14:39</div></div><div class="posttext">Part of the problem could be that &quot;OUTDIR&quot; is set to the directory that you want to remove.  I have found this to be a problem.  It could be that when OUTDIR is set to a directory, that directory is &quot;in use&quot; as far as NSIS is concerned.  In any event, try issuing<br />
<br />
SetOutPath &quot;&quot;<br />
<br />
before the 'RMDir', and see if this helps.<br />
<br />
I am experiencing a similar problem.  One pesky directory is not being removed, so $INSTDIR is also not being removed.  The subdirectory is completely empty.  It has no hidden files (I know because I have the option to show hidden files set in my Windows Explorer).  Yet 'RMDir /REBOOTOK &quot;$INSTDIR\DSFilters&quot;' does not remove the directory.  I can manually delete both it and $INSTDIR after the fact.  All other 'RMDir /REBOOTOK ...' commands work just fine (except of course 'RMDir /REBOOKOK &quot;$INSTDIR&quot;').<br />
<br />
I see nothing different in the failing subdirectory as compared to the subdirectories which are successfully removed.  I do, however, see a lot of posts on this forum asking for help with this issue.<br />
<br />
I wonder if there is an inherent bug in NSIS that is eluding our efforts.  Unfortunately, I don't know how else to describe this problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">17th May 2004, 15:54</div></div><div class="posttext">If you have problems removing folders from your installer, make sure your uninstaller itself is not in use.<br />
<br />
If you execute your uninstaller in a normal way NSIS will automatically create a temporary copy of your uninstaller.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>