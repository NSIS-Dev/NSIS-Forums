<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" change PATH using variables, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  change PATH using variables NSIS Discussion" />
	
	<title> change PATH using variables [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  change PATH using variables</div>
<hr />
<div class="pda"><a href="t-260301.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=260301">change PATH using variables</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">davidnewcomb</div><div class="date">24th November 2006, 18:01</div></div><div class="posttext">I am trying to set a variable and then use that variable in the path. My problem is that the when I open another command window the PATH look right but it is treating the %VAR% as &quot;%VAR%&quot; and not whatever %VAR% resolves into.<br />
<br />
To put it another way - why don't this work as expected:<br />
<br />
    WriteRegStr \<br />
       HKLM &quot;SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot; \<br />
       &quot;BOB&quot; &quot;C:\bob&quot;<br />
<br />
    # Tell Windows to re-read its config<br />
    SendMessage ${HWND_BROADCAST} ${WM_WININICHANGE} 0 &quot;STR:Environment&quot; /TIMEOUT=5000<br />
<br />
<br />
    ReadRegStr $0 \<br />
       HKLM &quot;SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot; \<br />
       &quot;Path&quot;<br />
    MessageBox MB_OK &quot;ReadRegStr:Reg=$0&quot;<br />
<br />
    StrCpy $0 &quot;$0;%BOB%&quot;<br />
<br />
<br />
    WriteRegStr \<br />
       HKLM &quot;SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot; \<br />
       &quot;Path&quot; &quot;$0&quot;<br />
<br />
    MessageBox MB_OK &quot;ReadRegStr:Reg=$0&quot;<br />
       <br />
    # Tell Windows to re-read its config<br />
    SendMessage ${HWND_BROADCAST} ${WM_WININICHANGE} 0 &quot;STR:Environment&quot; /TIMEOUT=5000<br />
<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th November 2006, 18:06</div></div><div class="posttext">You'll have to resolve %BOB% yourself using ExpandEnvStrings or ReadEnvStr. The PATH environment variable isn't recursively expanded.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">davidnewcomb</div><div class="date">27th November 2006, 10:17</div></div><div class="posttext">Under Win2000 the registry entry for PATH is set to:<br />
<br />
%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem<br />
<br />
Is it the 'cmd' program that is doing the mangling behind the scences?<br />
When you change the PATH using MyComputer-&gt;Properties-&gt;Advanced-&gt;Environment then it 'appears' to work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">27th November 2006, 12:01</div></div><div class="posttext">Hi davidnewcomb!<br />
<br />
The path value is of type REG_EXPAND_SZ. If you write it with WriteRegStr the entry becomes a type REG_SZ and it will never expand to the full path (eg. %windir% -- c:\windows) in the future again. (You'll see that if you go into cmd and execute path, %windir% is shown and is not in expanded state.)<br />
<br />
Have a look into this wiki article:<br />
<br />
http://nsis.sourceforge.net/Path_Manipulation<br />
<br />
Cheers<br />
<br />
Bruno</div></div><hr />


<div class="post"><div class="posttop"><div class="username">davidnewcomb</div><div class="date">27th November 2006, 17:19</div></div><div class="posttext">Thanks very much - that hit the spot.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>