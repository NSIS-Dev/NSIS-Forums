<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS/Tomcat problems, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS/Tomcat problems NSIS Discussion" />
	
	<title> NSIS/Tomcat problems [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS/Tomcat problems</div>
<hr />
<div class="pda"><a href="t-319358.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=319358">NSIS/Tomcat problems</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">brandondash</div><div class="date">21st May 2010, 22:25</div></div><div class="posttext">Hi guys,<br />
<br />
First let me say I'm happy to finally be posting here. The websense filters at my place of business had this site blocked for years on account of the mp3 player. In fact I finally broke down and purchased a phone with android just so I could fumble my way here through a phone browser, only to have the site unblocked a week later! :P<br />
<br />
I have a problem using NSIS to install Apache Tomcat as a service. It is one of several components I install silently (including java, httpd, postgres, postgis, and jboss) and it's the only one giving me problems.<br />
<br />
In a nutshell, running service.bat via ExecWait completes with no error and seemingly no result. If I run it by hand it works. If I edit service.bat to put a pause at the end of the script it works. This problem has me truly baffled. <br />
<br />
Does anyone here install Tomcat as a service? Any ideas?<br />
<br />
regards,<br />
brandon-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">22nd May 2010, 10:00</div></div><div class="posttext">What is your ExecWait command line? Have you tried ExecDos or nsExec?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brandondash</div><div class="date">24th May 2010, 19:55</div></div><div class="posttext">NSIS snippet:<br />
<br />
SetOutPath &quot;c:\MYAPP\tomcat\bin&quot;<br />
ExecWait 'install-tomcat.bat'<br />
ExecWait 'net start MYTOMCAT'<br />
<br />
Then in install-tomcat.bat I have<br />
cd %~dp0<br />
set CATALINA_BASE=c:\MYAPP\tomcat<br />
service install MYTOMCAT<br />
<br />
<br />
I have only tried ExecWait because up until this point it has worked in every case (including a very similar install-jboss-as-a-service process).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th May 2010, 21:00</div></div><div class="posttext">Try running the batch with cmd /C:<br />
<br />
ReadEnvStr $R0 COMSPEC<br />
ExecWait `&quot;$R0&quot; /C &quot;path\to\install-tomcat.bat&quot;`<br />
<br />
Also as you are not giving it the full path to the batch file, it is working on the current directory (SetOutPath). Always use full paths.<br />
<br />
Edit: And lastly you should use ExecDos or nsExec for commands like this. Installers that show pop up console windows during installation look unprofessional.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brandondash</div><div class="date">2nd June 2010, 17:35</div></div><div class="posttext">Thanks for the advice. Will try and post back.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brandondash</div><div class="date">3rd June 2010, 23:13</div></div><div class="posttext">The nsExec::Exec switch did the trick! Don't ask me how or why, but it worked. I went ahead and switched all the bats and msi execs to it also. I agree that it makes a big difference in terms of professional appearance.<br />
<br />
Thanks for the help. ^_^<br />
<br />
brandon-</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>