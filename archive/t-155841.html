<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Internet Component Download problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Internet Component Download problem NSIS Discussion" />
	
	<title> Internet Component Download problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Internet Component Download problem</div>
<hr />
<div class="pda"><a href="t-155841.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=155841">Internet Component Download problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">zany</div><div class="date">11th November 2003, 09:04</div></div><div class="posttext">I have a little problem and maybe someone here can help me out.<br />
<br />
What I'm trying to accomplish is an installer which would be automatically invoked from the internet.<br />
<br />
So far I've created an installer with NSIS, packaged it inside a signed cab along with an INF file which uses a hook to launch the installer executable. Part of the problem might be that my application is not an ActiveX component, but a plain Windows executable.<br />
<br />
I'm writing the install information to HKCU branch to make it easier to remove the app if/when a particular user is deleted.<br />
<br />
Everything else works fine except that I can't uninstall the application properly using the uninstaller. To be more specific, Windows places a copy of my inf file to WINDOWS/Downloaded Program Files as well as writes registry entries under HKLM/Software/Microsoft/Code Store Database. <br />
<br />
I tried to delete the inf file, which results in Windows thinking the installation is broken. However, it does not attempt to install it again when I hit the page with the object tag pointing to my cab.<br />
<br />
If I go on and delete the registry key under the HKLM key mentioned above my installer will be invoked again, but do I violate the &quot;current user only&quot; policy by deleting this key?<br />
<br />
I've thought about making my application to support a few com interfaces and registering the component, but am I missing a point here?<br />
<br />
All I want to do is to be able to distribute the installer via internet (launch it using the object tag) and deploy the application for the current user to avoid problems with people not having admin/power user privileges.<br />
<br />
All ideas more than welcome.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th November 2003, 10:43</div></div><div class="posttext">Isn't there a special way to uninstall just like there is a special way to install? What happens if you go to Windows\Downloaded Program Files and manually delete the &quot;file&quot;? Doesn't it call your uninstaller?<br />
<br />
MSDN should probably answer this best if no one has a definite answer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zany</div><div class="date">11th November 2003, 10:57</div></div><div class="posttext">Well, the inf documentation is quite wide-spread along MSDN and MSI archives seem to be the preferred way to do it. Finding a definitve answer hasn't caught my eyes as of writing.<br />
<br />
My installation is not that special, if you have a look at Sun's JRE installer, it's very much the same, although my executable is NSIS installer.<br />
<br />
Downloaded Program Files is a special folder and as such, it displays the 'files' differently. Righ-clickin on an item would bring a choice of Update/Remove and remove deletes the inf file in this directory as well as deletes the associated registry entries.<br />
<br />
One way might be to use ShellExecute with Remove as the command.<br />
<br />
Deleting the inf file from the Downloaded Program Files only changes the status of my installation to broken and does not uninstall anything.<br />
<br />
I've written installations before, but I'm new to this internet thingy, so I might be looking for the ansfer from all the wrong places.<br />
<br />
Hopefully someone who has done this before can point me to right track.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>