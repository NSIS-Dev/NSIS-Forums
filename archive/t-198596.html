<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" http + ftp download plug-in, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  http + ftp download plug-in NSIS Discussion" />
	
	<title> http + ftp download plug-in [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  http + ftp download plug-in</div>
<hr />
<div class="pda"><a href="t-198596.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198596">http + ftp download plug-in</a></p>
<hr />
<div id="pagenumbers"><b>Pages :</b>
[<b>1</b>]
<a href="t-198596-p-2.html">2</a>
</div>
<hr />

<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">7th November 2004, 16:11</div></div><div class="posttext">Attached plugin supports http and ftp downloads. Included script sample downloads 2 mp3 files (one for each protocol). I wrote it fast (from code pieces I had :) ) and used the simplest InternetOpenUrl() way to do this, so functionality is limited (ftp restart may not work, WM_NOTIFY_OUTER_NEXT skipped, english only, ...). And dialog design is ugly :( (any ideas?) <br />
But finally http works good (many thanks to MS guys), I even tested download restart after disconnect (but this require more tests). Re-get defaults: disabled, pause 5 sec.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">8th November 2004, 05:57</div></div><div class="posttext">wording improved :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">9th November 2004, 07:43</div></div><div class="posttext">Empty file size fields looks lonely :) on ftp download, so I added ftp file size request. If ftp server not allows directory browsing (like dl.zvuki.ru does), InternetOpenUrl() fails and new connect (and time) required for file download, so I reworked this to common ftp session with single InternetConnect(). Script sample requests big (14 MB) file from MS ftp site (file size available), so better replace this with your own link.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Fred556</div><div class="date">11th November 2004, 15:22</div></div><div class="posttext">Can this plugin download silent and with process?<br />
<br />
can can shellexecute it.<br />
<br />
I am new in NSIS can you include a simple example?<br />
<br />
Thanks...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">11th November 2004, 17:52</div></div><div class="posttext">This may be interesting - start download at the very beginning and run 2 processes, installation itself and file download (or I misunderstood something?).<br />
It is possible to run dll as a process using rundll(32).dll, only new plug-in dll entry point required for this (short function). Programming side of problem is simple, but I'd like to understand first how to make working ftp reget using FtpCommand() call (size and restart commands). After this - may be.<br />
If you want hide plug-in dialog in it's current state - comment ShowWindow() line in source code and rebuild project.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th November 2004, 19:46</div></div><div class="posttext">What are the minimum requirements for this plug-in? It takes proxy settings from IE, right? I have been meaning to write a new NSISdl based on IE's downloading engine to solve all of those proxy problems. If you're already at it, how about you add an option to download more than one file in a row, I review the code, and we slap a NSISdl2 tag on it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">11th November 2004, 20:28</div></div><div class="posttext">yea :)<br />
I am having a lot of problems with corporate networks using proxy settings<br />
a new NSISdl  would be fantastic<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">12th November 2004, 12:44</div></div><div class="posttext">Originally posted by kichik <br />
What are the minimum requirements for this plug-in? It takes proxy settings from IE, right? <br />
<br />
I also had a full range of chunked HTTP + proxy problems in one of my apps when used socket based http client :( . What is good for net learning, sometimes is bad for business :) But few years ago Win95 compatibility requirement was taken off (in later Win versions IE and Inet API is always on place), and I could re-work it to Inet API.<br />
Minimum requirements... HTTP without problems. I also thought about re-get functionality (for installers  trying to download dotnetfx via dial-up) and about ftp, but it looks like both idias are not claimed by developers :)<br />
OK, simple and stable http download without re-get, but more then one file. I thought about local path definition only (instead of every local file parameter), but this limits functionality with static server files only (not cgi/php), so parameters line is following:<br />
<br />
InetLoad::load  URL1 local_file1 [URL2 local_file2 [...]]<br />
<br />
ftp works, but it not requests file size - InternetOpenUrl() functionality is limited.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">13th November 2004, 09:14</div></div><div class="posttext">to Kichik<br />
I also thought a little about extended requirements and result attached, better ftp and simple (hidden) re-get. But more code - more bugs :) You can use any version.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">13th November 2004, 12:16</div></div><div class="posttext">I fixed one bug in last (extended) version and improved download status displaying.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">14th November 2004, 20:56</div></div><div class="posttext">is inetload working with proxy networks...or is that a future thing ?<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">15th November 2004, 08:18</div></div><div class="posttext">Good question. Plug-in works in my proxy tests, but this is 10% of success only :( - independent test results required. I see non-zero downloads count, may be somebody (grahama) also can test plug-in :) Another request - english spelling in the InetLoad.cpp (and may be dialog window).<br />
Thanks.<br />
Attached version functionality is almost the same as in the previous post, I only made an attempt to remember &quot;coding rules&quot; and re-formatted source text (for possible cvs commits :).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">15th November 2004, 19:47</div></div><div class="posttext">will do and report back... :)<br />
<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">15th November 2004, 20:57</div></div><div class="posttext">could add a Silent feature ?<br />
something like:<br />
inetLoad::load /SILENT &quot;http://blah.com/blah.jpg&quot; &quot;$EXEDIR\blah.jpg&quot;<br />
<br />
<br />
will possibly get this thing tested today :)<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">15th November 2004, 23:53</div></div><div class="posttext">great news :)<br />
initial tests from a client came back successful...<br />
I'll go there myself to make sure later in the week...<br />
but this is very good news as nothing was getting thru with nsisdl<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">16th November 2004, 10:55</div></div><div class="posttext">Many thanks, grahama. I'll add this option (I tested right now - plug-in can take string from the stack and push it back if this is not /silent parameter :) ), but let's wait a little for another replies.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">17th November 2004, 07:48</div></div><div class="posttext">New plug-in version with /SILENT support (optional).<br />
Usage:<br />
  InetLoad::load [/SILENT] URL1 local_file1 [URL2 local_file2 [...]]<br />
<br />
Returns &quot;OK&quot; string if download successful<br />
<br />
  Pop $0<br />
  StrCmp $0 &quot;OK&quot; dlok<br />
  MessageBox ...<br />
  Quit<br />
dlok:<br />
  ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">17th November 2004, 19:44</div></div><div class="posttext">thanks for the Silent Feature Takhir<br />
<br />
is there a way I could pass along download info to the MUI interface like Nsisdl does ? very cool stuff :)<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">18th November 2004, 18:17</div></div><div class="posttext">NSISdl uses &quot;files&quot; page for progress bar and status display. My variant uses it's own dialog window and may work even from .onInit function (without installer page) - I know situations when this is important. And I guess it is better to use more space for all these numbers and names displaying - url, local file, file size, done, transfer rate, remaining time, total time, percents. Another words I'd like to keep my dialog :) <br />
I see 2 situations: 1) installer is visible and plug-in window appears as it is; 2) totally silent install and plug-in is also hidden (some logic may require in the plug-in call).<br />
But it may be good to add something meaning above general prograss bar (1006 static, where installer shows file names) :) , for example &quot;InetLoad plug-in&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th November 2004, 18:42</div></div><div class="posttext">In the latest CVS version, NSIS passes the silent flag which you can check.<br />
<br />
I prefer the download dialog to show inside the NSIS dialog. It looks nicer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">19th November 2004, 11:57</div></div><div class="posttext">Situation: program requires system SP to be installed ( &gt;100 MB), this was found in .onInit function, but where to download SP? File copy page IMHO is not good place for this, might be better to do this after License page or even in .onInit function. But where to show progress bar if  Installer’ dialog window not exists yet or have some other controls in this place (middle of the box). Or developers must create custom page for plug-in? I still guess that dialog box is better way (while dialog design is ugly  ). Also: when user closes plug-in dialog window, plug-in’s main (dialog) thread tries to stop or terminate i/o thread – not bad when i/o hangs. When embedded to installer page this is not so obvious.<br />
I added extra-&gt;exec_flags-&gt;silent support in some #ifdef’s to keep compatibility with current NSIS version (&lt;=2.02). Code attached.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th November 2004, 12:05</div></div><div class="posttext">No files should be downloaded in .onInit and anywhere else but the instfiles page. In my opnion, that's an annoying installer. I prefer installers to start &quot;installing&quot; only once I click install and verify all the parameters. But that can an option.<br />
<br />
In NSISdl, another progress bar is created for the download status.<br />
<br />
Clicking the Cancel button is more obvious than closing the download window.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">19th November 2004, 12:34</div></div><div class="posttext">I saw new progress bar created by NSISdl, but this is OK on instfiles page only, where this place is free. On the instfiles page - yes, this works fine.<br />
When plug-in window is visible, installer page (if any) is unavailable, and (I hope) user will find how to close plug-in window. Or I can add there Cancel button (very easy in VS GUI).<br />
The only place to start installation - yes, this is the best way, but life is very strange thing :) NSIS gives a lot of user vars to plug-in (but not silent state), this looks as very specific option (back door), so why not to give opportunity to download file in advance?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th November 2004, 12:37</div></div><div class="posttext">The dialog area is free when a plug-in is called inside a custom page callback function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">21st November 2004, 16:57</div></div><div class="posttext">for myself, I use banners in the beginning to alert the user of a version check....I download an ini file and compare it to the values in the registry...because the inetLoad plugin is larger the banner...it looks a little strange...This is only cosmetic, but I thought it was worth bringing up:)<br />
having all the strings passed to the MUI [instead of the plugin dialog window]  would be helpful in this particular situation...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">24th November 2004, 19:40</div></div><div class="posttext">Ok, I went over to Univision's [the client] corporate office and inetload did not work with their proxy network :( [nsisdl does not work either] My client launched the wrong installer...and told me it worked....<br />
I am kind of at my wits end with this...Is there another installer product that works with proxy or is this something in the queue for NSIS...here is something odd that might be of note.  My Apple powerbook[OS X] using Virtual PC [Win2k] gets thru their network on DHCP.  Using the same installer app on THEIR pc does not get thru..... What would this point to ?<br />
many thanks as I considering hard drugs at this point ;)<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">14th December 2004, 18:13</div></div><div class="posttext">I'm having a problem too with my work's proxy.  When i try to use inetload to download a text file, the text file's contents are overwritten with the page can not be display message, and the following:<br />
<br />
HTTP 407 Proxy Authentication Required - The ISA Server requires authorization to fulfill the request. Access to the Web Proxy service is denied. (12209)<br />
Internet Security and Acceleration Server<br />
<br />
Any ideas?  Thanks all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">15th December 2004, 11:08</div></div><div class="posttext">It’s not easy to debug program if you cannot touch the problem with your own hands J<br />
I made one minor improvement for error 407 (proxy authorization), might be good to test it. But the main question is in explicit proxy authorization if IE registry parameters (already used) are not enough for connection. This require user_name and password. I see  2 simple ways to resolve the problem, silent InternetSetOption(INTERNET_OPTION_PROXY_PASSWORD + INTERNET_OPTION_PROXY_USERNAME) if these  parameters presents in the plug-in call (something like “load /PASSWD=passwd …”)  or popup dialog (InternetErrorDlg for example), where user can enter name and passwd for proxy auth (not works in the silent mode). Both variants may present in program, of course. First is good for corporate network distribution, second – for Inet downloads. If this is what you need – I’ll be in office in Monday and can make changes next week.<br />
Also few words about http server authorization (error 401) – it is possible to define name and password in the URL, program extracts both parameters (if any. I did this for FTP if anonymous user is not accepted).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">15th December 2004, 16:33</div></div><div class="posttext">SUCCESS!!  Your new inetload cut right through my company's proxy!  Thank you so much Takhir.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">15th December 2004, 22:14</div></div><div class="posttext">Takhir, I found a minor issue.  Your plugin is still working beautifully, and getting through my proxy with out any problems, so thanks again.  <br />
<br />
I'm using your plugin with nsis 2.03, no MUI, and with a silent install.  I'm just using message boxes and banners.  If I run the InetLoad::load command with the /SILENT switch, all future message boxes appear in the background behind other windows.  If I remove the /SILENT switch from the InetLoad::load, which is fine, message boxes appear in front as they should.  I tried using the BringToFront command, but that did not work.  Just wanted to let you know about this, but all in all, your plugin is working great!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">16th December 2004, 09:13</div></div><div class="posttext">Could not reproduce with 2.02 - works fine, but this happens with 2.03 (on my home Win98SE) :( And $HWNDPARENT is NULL, we cannot use SetForegroundWindow() syscall to improve your situation. May be NSIS devs can say something? Plug-in always creates it's dialog window (required for download sync), it is hidden in silent mode and has NULL parent, but I don't know how this can cause later abnormal bihavior of 2.03.<br />
BTW - question to NSIS developers - while I see $HWNDPARENT == 0 in the 'SilentInstall silent' mode, can I use it instead of new 'extra-&gt;exec_flags-&gt;silent &gt; 0' flag ? Is this a reliable way?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">16th December 2004, 14:43</div></div><div class="posttext">No problem Takhir, thanks for looking into the minor problem.  I don't mind running your plugin in non-silent mode, which corrects the problem.  I'm still very pleased that your plugin gets through my proxy, so thanks again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">16th December 2004, 16:29</div></div><div class="posttext">You can simply download and install 2.02 version - InetLoad worked fine with it silent mode. Problems appears in 2.03 only (and this not the first situation with 2.03). <br />
Attached version recognizes silent installer mode even without /SILENT flag in the plug-in's call.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th December 2004, 18:25</div></div><div class="posttext">extra-&gt;exec_flags-&gt;silent != 0 is the most reliable way to detect silent installers. That is what NSIS itself uses.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">17th December 2004, 05:43</div></div><div class="posttext">great :)<br />
I am no longer having proxy problems either...Just tried it again today at their corp headquaters.  Is there any possibility that this plugin could be integrated into the the MUI ?  In my case, it would look a bit slicker....as I was using nsisdl...<br />
great job, Takhir :)<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">17th December 2004, 07:28</div></div><div class="posttext">I'll think about command line switch to support both modes ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">17th December 2004, 11:01</div></div><div class="posttext">Originally posted by Takhir <br />
I'll think about command line switch to support both modes ;) <br />
<br />
That would be a very good idea. I'm also using NSISdl, so if you could implement NSISdl's dialogue features into yours (including the text string settings) then that would be awsome.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrtech</div><div class="date">18th December 2004, 05:56</div></div><div class="posttext">I just started using this little dittie, but had to put the whole dialog into silent mode.  With the ns dl'er the full path was that was downloading was not shown, I preferred that.  Is there a switch you can add for /hideurlprefix or /showfilenameonly or something like that, thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">18th December 2004, 09:24</div></div><div class="posttext">First draft, but I could load some files with it :)<br />
Requires 2.03 – new plug-in parameter in this version is the only way to auto-recognize silent install without explicit /SILENT parameter on any step including .onInit (where main installer window not exists yet).<br />
/TIMEOUT parameter not implemented because MSDN describes many timeout flags (connect, receive, control send and receive, data send and receive…),  so I guess would be better to left defaults.<br />
/POPUP key displays detailed download dialog instead of embedded progress bar. Very useful in .onInit function (i.e. not in Section). So default is old (NSISdl) GUI :(<br />
/SILENT key explicitly prevents from displaying of any plug-in' output (both popup dialog and embedded progress bar). Not required if 'SilentInstall silent' mode is defined in installation script.<br />
Now plug-in displays short file name (like NSISdl did) <br />
And I still hope that NSIS developers can solve 2.03 problem with new windows going to background in the silent mode (this worked fine in 2.02).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">18th December 2004, 12:44</div></div><div class="posttext">I tried the plugin with the NSISdl interface. I found one problem...<br />
<br />
My title control (1006) has a transparent background (because you can't not have a transparent background when setting text colour using SetCtlColors for some reason). When I use InetLoad I get two layers of text on it: InetLoad plug-in and [download name].<br />
<br />
Edit: Could you also change it to &quot;Downloading [download name]...&quot;<br />
<br />
To fix the problem you need to refresh the label control by hiding it and showing it again and then set its text.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">18th December 2004, 15:47</div></div><div class="posttext">Might be better to give me test script, but I did some changes - redraw not tested.<br />
1006 redraw (RedrawWindow(with erase background))<br />
Downloading ...<br />
Connecting now appears at the beginning of download.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">18th December 2004, 20:50</div></div><div class="posttext">The problem is still there with the overlapping text.<br />
Compile this example; it shows the problem.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">19th December 2004, 07:47</div></div><div class="posttext">Updated. Tested on Win98 SE and WinXP Pro.<br />
And I still hope that InetLoad sounds better then NSISdl ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th December 2004, 14:28</div></div><div class="posttext">Works beautifully, well done!<br />
I will convert my installer over to InetLoad :)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th December 2004, 15:23</div></div><div class="posttext">Ok, I found some really dodgy weird bug.<br />
<br />
If I Push two things onto the stack before calling InetLoad, InetLoad always fails and returns either &quot;File Open Error&quot; or &quot;URL Parts Error&quot;.<br />
InetLoad returns &quot;File Open Error&quot; if I have two empty strings (&quot;&quot;) onto the stack, and &quot;URL Parts Error&quot; if I have two non-empty strings on the stack (ie &quot;blah&quot;).<br />
If I Pop one of them off immediately, InetLoad works as normal!<br />
It seems that if I have more than one item on the NSIS stack, InetLoad fails.<br />
<br />
This example shows the problem...<br />
Compile it and you'll get the problem straight away.<br />
<br />
Edit: Have you got code in there to read the URL and the save-to-file from the stack? Nothing in the readme about it!!!<br />
And it's not reading from the top of the stack either, more like either at the bottom of somewhere in-between!<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th December 2004, 15:33</div></div><div class="posttext">Could you just remove the stack support? For some reason because I'm using the stack a lot in this installer InetLoad messes the stack up completely (it seems to move things on the stack around!)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th December 2004, 15:38</div></div><div class="posttext">If I Push this onto the stack first:<br />
&quot;ja&quot;<br />
&quot;ja&quot;<br />
&quot;$EXEDIR\GameVer.muf&quot;<br />
&quot;http://myweb.tiscali.co.uk/imker/Updater/Games/hostile.gdf&quot;<br />
&quot;&quot;<br />
&quot;$EXEDIR\GameVer.muf&quot;<br />
&quot;http://myweb.tiscali.co.uk/imker/Updater/Games/hostile.gdf&quot;<br />
<br />
Then I call InetLoad, the stack becomes just:<br />
&quot;ja&quot;<br />
<br />
Definately something strange going on there :p<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">19th December 2004, 15:43</div></div><div class="posttext">This is not a bug, Kichik asked to add multiple files support, as many as plug-in can find in stack. This is why plug-in reads stack till the bottom. If plug-in cannot read both URL and file_name (one string presents), it exits with OK code, but if 2 strings comes from stack and one is not URL or another is not a valid file path - it fails with some code.<br />
And one more redraw of 1006 control on exit added, sorry, it's for 'Completed'.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th December 2004, 15:59</div></div><div class="posttext">You need something in the plugin to check when the URL's Pushed on to the stack end. E.g.<br />
<br />
Push &quot;start urls&quot;<br />
Push &quot;url 1&quot;<br />
Push &quot;save to&quot;<br />
Push &quot;url 2&quot;<br />
Push &quot;save to&quot;<br />
InetLoad::Load /SILENT<br />
<br />
InetLoad just needs to keep Popping off the stack until it finds the string &quot;start urls&quot; (or something).<br />
Currently it's Popping everything off the stack in case that it's another download URL. This is silly because we might need to use the stack for other strings as well. We call InetLoad and after that they're all gone!<br />
<br />
Edit: I don't think Kichik told you, but this has to be the default behaviour. Check out all the NSISdl macro's on the archive which do exactly the same thing...<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">19th December 2004, 16:28</div></div><div class="posttext">I can add /END parameter for such situations, for example <br />
<br />
   Push &quot;bla&quot;<br />
   InetLoad::load /POPUP &quot;http://myweb.tiscali.co.uk/imker/Updater/Games/hostile.gdf&quot; &quot;$EXEDIR\GameVer.muf&quot; /END<br />
   Pop $R0<br />
    MessageBox MB_OK $R0<br />
   Pop $R0<br />
    MessageBox MB_OK $R0<br />
Second MessageBox says &quot;bla&quot; in my test ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th December 2004, 16:49</div></div><div class="posttext">Ah very cool! :)<br />
<br />
I will try it out in a few minutes (when my map finishes compiling).<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th December 2004, 16:54</div></div><div class="posttext">Just curious then... How does the plugin know whether to get the URL's from the stack or from the command-line. If no extra params exist on the command-line then it reads from the stack?<br />
<br />
If it reads from the stack, then how does it know when to stop?<br />
I might think about using the stack to pass multiple URL's...<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">19th December 2004, 17:42</div></div><div class="posttext">Plug-in takes all parameters from the stack only. And I thought this is mainroad of NSIS plug-in usage (or I misunderstood something?). Installer pushes command line parameters to stack before plug-in call, plug-in uses popstring() for [IN] parameters and pushstring() for [OUT] result (because all plug-in entry points are 'void' type). I guess :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th December 2004, 18:26</div></div><div class="posttext">Oh I see now. I didn't know that sorry :D<br />
<br />
It now works bloody perfect, excellent! I can now distribute my installer (wahoo!)<br />
<br />
-Stu :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">5th January 2005, 19:38</div></div><div class="posttext">Last version archive page http://nsis.sourceforge.net/archive/nsisweb.php?page=671&amp;instances=0,32</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">11th January 2005, 07:55</div></div><div class="posttext">I tested new version, it supports MSI banner mode, two parameters set this window caption and text &quot;/BANNER CAPTION TEXT&quot;. Multilined text may be created using $\n character in the TEXT string, up to 3 lines I could add there. Plug-in displays package first icon in the top left corner of the banner window. Progress bar appears when (and if) file size comes from server, so if file size is unavailable (chunked reply, very seldom for static files) or file size is &lt; 8 kB and line is fast, progress bar may stay hidden.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrtech</div><div class="date">18th February 2005, 21:16</div></div><div class="posttext">I've just notice a little issue with the status returned after downloading.  I've seen this on Win2k &amp; XPsp1 systems so far, what happens is that InetLoad return &quot;1&quot; instead of &quot;Ok&quot; after succesfully downloading a file.  Here's my code snippet that I'm using with 2.05:<br />
  InetLoad::load &quot;${PRODUCT_URL}$WEBFILE&quot; &quot;$TEMP\$WEBFILE&quot;<br />
<br />
  MessageBox MB_YESNO|MB_ICONQUESTION &quot;$0&quot; 0 0<br />
  StrCmp $0 &quot;Ok&quot; 0 dlskip<br />
<br />
  ExecWait '&quot;$TEMP\$WEBFILE&quot; /q'<br />
<br />
  Delete '&quot;$TEMP\$WEBFILE&quot;'<br />
dlskip:<br />
<br />
<br />
Had to change &quot;Ok&quot; to &quot;1&quot; to get it to work again.  Using the archive 1/18/2005 build.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">robber98</div><div class="date">18th February 2005, 22:56</div></div><div class="posttext">Originally posted by mrtech <br />
I've just notice a little issue with the status returned after downloading.  I've seen this on Win2k &amp; XPsp1 systems so far, what happens is that InetLoad return &quot;1&quot; instead of &quot;Ok&quot; after succesfully downloading a file.  Here's my code snippet that I'm using with 2.05:<br />
  InetLoad::load &quot;${PRODUCT_URL}$WEBFILE&quot; &quot;$TEMP\$WEBFILE&quot;<br />
<br />
  MessageBox MB_YESNO|MB_ICONQUESTION &quot;$0&quot; 0 0<br />
  StrCmp $0 &quot;Ok&quot; 0 dlskip<br />
<br />
  ExecWait '&quot;$TEMP\$WEBFILE&quot; /q'<br />
<br />
  Delete '&quot;$TEMP\$WEBFILE&quot;'<br />
dlskip:<br />
<br />
<br />
Had to change &quot;Ok&quot; to &quot;1&quot; to get it to work again.  Using the archive 1/18/2005 build.  <br />
<br />
Don't you have to pop the return value after InetLoad?  I don't see it from your code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrtech</div><div class="date">19th February 2005, 00:24</div></div><div class="posttext">oops, thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">21st February 2005, 12:48</div></div><div class="posttext">2 updates: Resume option (for really bad connections :) ) and ftp &quot;file not found&quot; check out. If resume option set (/RESUME &quot;Do u want to retry?&quot;) and error occure (except &quot;not found&quot;), plug-in first asks user to check connection. Many thanks to Afrow UK and azmoviez for ideas and help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yurik</div><div class="date">2nd March 2005, 15:17</div></div><div class="posttext">Takhir,<br />
is it possible to set proxy settings (proxy/port/user/password) for your plugin inside the NSIS script?<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">3rd March 2005, 12:36</div></div><div class="posttext">Proxy authorization support added. New command line options:<br />
<br />
/PROXY IP:PORT   - overwrites current proxy settings, not required in most cases, because IE settings will be used by default.<br />
/USERNAME LOGIN  - proxy username<br />
/PASSWORD PASSWD - proxy password<br />
<br />
For example<br />
   InetLoad::load /PROXY 55.55.55.55:8080 /USERNAME nick /PASSWORD jagger ....<br />
<br />
BTW URL can also include target server login/password, CrackUrl function recognizes it, something like this (remove spaces after : , :+p= :p ) : http://username: password@www.whatever.com/secret/eyesonly.htm<br />
<br />
Many thanks to Yurik for tests.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">9th March 2005, 09:44</div></div><div class="posttext">I have few similar requests, so new option:<br />
/POPUP PREFIX<br />
sets  first part of the popup dialog caption (prefix), for example<br />
/POPUP &quot;Some text&quot;<br />
displays:<br />
Some text - Connecting...<br />
You cannot skip this parameter, but can use <br />
/POPUP &quot;&quot;<br />
for default (&quot;InetLoad plug-in&quot;).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th March 2005, 12:00</div></div><div class="posttext">I have tested the plug-in on Windows XP SP2. The HTTP download went well, but the FTP download failed. I have Windows Firewall turned on and it popped up a message asking me if I want to allow the installer to connect. InetLoad gave me an error message before I could unblock it. When I tried it again, after it was unblocked, it just failed with the same error message - &quot;Open URL Error&quot;. The URL in the example seems OK. I was able to open it using Firefox.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">25th March 2005, 13:49</div></div><div class="posttext">Now I work on XP Pro SP2 too, new project http://www.modya.com requires this :(<br />
MS Firewall bihaviour is so strange :) I deleted InetLoad from exclusions list, firewall popuped &quot;restricted access&quot; dialog, but I could see on the NSIS window under this dialog (I not closed it) that 25 MB download was continued and finished with OK status ...<br />
Nevertheless, first question - MS Firewall connection error, simple patch: /RESUME &quot;&quot; option, I re-tested this, plug-in popups messagebox and continued download attempts after I clicked &quot;Retry&quot;. Better way - specific firewall error, this case plug-in can auto-enable resume option (if install is not 'silent'). I wrote above that I could not reproduce situation, so KichiK please test attached dll, it should display messagebox with lasterror and InternetGetLastResponseInfo (if any). The only code I saw in the similar situations earlier with other programs was 12002 (when Firewall threated conection as virus atack).<br />
Second question - InetLoad is in the Firewall list, but still connect error occure - no ideas right now..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th March 2005, 15:16</div></div><div class="posttext">I didn't get any new message box using the attached DLL. Still the same &quot;Download Status: Open URL Error&quot;. I should have included the &quot;Download Status:&quot; part in the last message. It seems the download does start because it updates the file size field (17kb). But then the firewall dialog opens and the failure message pops up.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dujuan</div><div class="date">26th March 2005, 01:30</div></div><div class="posttext">Great plugin!<br />
Does this plugin support timeout parameter like nsisdl ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">26th March 2005, 13:47</div></div><div class="posttext">Attached version supports ;)<br />
InternetSetOption flags include few timeout parameters, but I guess connect is what you want.<br />
Also: <br />
1. ftp client works in the passive mode, all modern servers support this.<br />
2. On firewall error plug-in (if not in the silent mode) auto-enables Resume option and displays message box, so user can solve firewall problem and click Retry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">delboy</div><div class="date">28th March 2005, 15:01</div></div><div class="posttext">Really cool, will set about updating our installers!<br />
Quick question - when i used NSISDL i hacked together a method of allowing the user to quit out of the installer and pick up the download when they reran it (not very pretty but it helps for people downloading large files over dial up)<br />
Is there a way of doing this more elegantly using the retry functionality you have in here (ie is there some way of persisting the status of download and picking it up again)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">28th March 2005, 16:28</div></div><div class="posttext">1. If connection to server was lost, but some data were received during last session, plug-in makes a short pause, reconnects and continues download from the current position. A some kind of re-get.<br />
2. If /RESUME &quot;&quot; option set, plug-in on any error except &quot;file not found&quot; first asks user (retry-cancel), this helps on dial-up connection and firewall problems.<br />
2.5 On GetLastError()==12002 or 12003 (in most cases firewall related) plug-in auto-enables /RESUME option, but please note that english default text will be used in the message box (many thanks again to Stu from Shropshire for the great text :) ).<br />
Finally plug-in returns &quot;OK&quot; or error description string (full set of strings in the InetLoad.cpp file), so on error you can ask user again or terminate installation. You can find all plug-in command line options in the Readme.txt (including 3 display modes).<br />
I hope all these tricks may help to solve some common download problems :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">delboy</div><div class="date">1st April 2005, 14:04</div></div><div class="posttext">Hi Takhir, Is persisting the download session possible, such that a user may actually quit out of the installation and on the next run auto resume the download? obviosuly the logic behind this would be in the nsis script itself, but its more a question of how easy it would be to have say a retry now retry later and cancel options on that connection failure box.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">seniorquico</div><div class="date">14th April 2005, 05:03</div></div><div class="posttext">I've got an interesting problem with Inetload. I haven't really found any info on something like this, but I've been scratching my head for a few hours and I just can't seem to figure it out. I copied the Inetload command from the example in the plugin archive and added a file of my own on a new command right after it, just like so (on multiple lines to try not to break page's design):<br />
InetLoad::load /POPUP &quot;http://www.dreamgirlswallpaper.co.uk/<br />
    fiveyearsonline/wallpaper/Cameron_Diaz/camerond09big.JPG&quot;<br />
     &quot;$EXEDIR\cd.jpg&quot;<br />
InetLoad::load /POPUP &quot;ftp://my_server/patches/patch1.exe&quot; &quot;$EXEDIR\patch1.exe&quot;<br />
<br />
The above code WORKS without any problems. But now the interesting thing (at least to me), the moment I delete the first line, the Cameron Diaz pic dl, the whole thing stops working! To be more specific, the installer downloads the file just like it did previously, but as soon as it obtains the file, the installer crashes! I started to play around with this some more, and I further came to the conclusion that if I even change the Cameron Diaz pic to ANYTHING else, the installer crashes after obtaining the files. Now, I don't know if this is a cruel joke to make us all download that file, but I really can't figure this problem out. But, I'm just a &quot;simple&quot; web programmer so what do I know about these complex NSIS scripts and plugins. Any help would be GREATLY appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">14th April 2005, 07:29</div></div><div class="posttext">First of all if you are using latest plug-in version, popup parameter includes 'prefix' text, to use default it should be /POPUP &quot;&quot;<br />
Code above should not work because first download result - 'OK' string (from Cameron :) ) is in the stack yet, please use Pop $1 (for example) after every download to clean stack. Otherwise 'OK' string will be first parameter for the next plug-in call. If you are using stack for other vars, use /END parameter (see Readme) to stop plug-in's stack reading at the end of this command line. Plug-in also supports few downloads from one command line.<br />
And now some single ftp download, re-tested:<br />
<br />
Section &quot;Dummy Section&quot; SecDummy<br />
<br />
    InetLoad::load /POPUP &quot;Readme.txt from MS FTP&quot; &quot;ftp://ftp.microsoft.com/MISC/ReadMe1.txt&quot; &quot;$EXEDIR\rm.txt&quot; /END<br />
    Pop $0 # return value = exit code, &quot;OK&quot; if OK<br />
    MessageBox MB_OK &quot;Download Status: $0&quot;<br />
<br />
SectionEnd<br />
<br />
<br />
Status 'OK', file looks correct too. I aslo tested big ftp download with login:password in the LAN, and not found any problems. And I hope that bad syntax only might cause crash :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dujuan</div><div class="date">15th April 2005, 10:55</div></div><div class="posttext">Does this plug support rtsp or mms protocol ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">15th April 2005, 11:23</div></div><div class="posttext">http and ftp only. rtsp(tcp) - no, rtsp over http - I am not sure, but if you want (and can) save all content to file (using http as transport) - may be (not tested). But please note, http and ftp support GET method only. Probably the same with mms.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">18th April 2005, 09:10</div></div><div class="posttext">CrackUrl() string buffers length bug fixed (256-&gt;NSIS string_size).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">23rd April 2005, 13:01</div></div><div class="posttext">Hey Takhir, just wondering why with InetLoad I only get a maximum of 30kbps download speeds on all servers when through browsers I usually get 80-120kbps.<br />
<br />
Other people have the same problem too.<br />
<br />
Edit: Same problem with NSISdl too :(<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">23rd April 2005, 20:18</div></div><div class="posttext">I was wondering if you could implement the NXS progress banner into InetLoad, so we could have just a simple progress bar when downloading small files between pages.<br />
<br />
Also, how easy would it be to write a BitTorrent plugin that works. I've tried the one on the archive (written in Python) but it doesn't seem to work at all.<br />
The actual example is very poor too.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">23rd April 2005, 22:18</div></div><div class="posttext">Now I'm trying to get InetLoad to execute a PHP script on the internet. Everytime it says File Open Error, when the script is executed fine through my browser.<br />
I've even tried setting the Content-length header and then it works in NSISdl, but still not with InetLoad.<br />
<br />
I tried the post example script you made, but that doesn't work for me either. I'm wondering if it's the server, but if it works with NSISdl then surely it can't be...<br />
<br />
Please help :(<br />
<br />
Edit: LOL now it's working. Because I'm using CallInstDLL to call the plugin, I had the URL and local file Push order swapped :p<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">25th April 2005, 21:43</div></div><div class="posttext">Originally posted by Afrow UK <br />
Hey Takhir, just wondering why with InetLoad I only get a maximum of 30kbps download speeds on all servers when through browsers I usually get 80-120kbps.<br />
<br />
Other people have the same problem too.<br />
<br />
Edit: Same problem with NSISdl too :(<br />
<br />
-Stu  <br />
Stu, I just tested it on my work PC, i was getting around 1360kbps which is about 90% of our T1.  I'm using the InetLoad from 3/3/05, which is probably this one (http://forums.winamp.com/attachment.php?s=&amp;postid=1606030).  Hope this helps.<br />
<br />
Jnuw</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th April 2005, 13:53</div></div><div class="posttext">Thanks, I'll try it.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tbrandner</div><div class="date">6th May 2005, 18:59</div></div><div class="posttext">Wow, inetload is a great plug-in!<br />
<br />
I have a packaged installer that grabs a file over the 'net, and it's working great aside from a small problem that happens after a successful download.<br />
<br />
After a successful download, there is about a 50 second delay before the installer continues. I've put message box popups at each step of the installer, and the delay is immediately after the inetload:load command.<br />
<br />
Any idea where this delay is coming from? It doesn't seem to have anything to do with the size of the download...?<br />
<br />
Thanks,<br />
<br />
Tony</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">10th May 2005, 20:14</div></div><div class="posttext">Now I am online again and I'll check all problems tomorrow. <br />
tbrandner: I saw delay on the plug-in exit (cannot remember precisely when &amp; where), but this happened after last plug-in operator (probably in the NSIS code). Can you give me script sample?<br />
Afrow UK: last version worked with my office 8 Mbit/sec line. I can test script sample if required. And I need to understand bittorent protocol first, I'll try :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th May 2005, 21:43</div></div><div class="posttext">Thanks Takhir. If you can get BitTorrent to work, that would be amazing!<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th May 2005, 13:23</div></div><div class="posttext">It's ok Takhir, thanks to immadster the author of XBTT http://sourceforge.net/projects/xbtt/ has agreed to make a BitTorrent plugin for NSIS.<br />
<br />
Not sure exactly how long it will take though.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">12th May 2005, 09:59</div></div><div class="posttext">i'm just switched from NSISdl to InetLoad, as NSISdl does not support URL encoded login/password. i'm using a function that reads a set of URLs from a text-file and downloads one file after another. i experienced that InetLoad uses to crashes my installer quite often, without a recognizable pattern.<br />
<br />
edit: this only seems to happen when running InetLoad in a loop. when i downloaded 10 files with 10 InetLoad commands i experience no problems. any fix or workaround?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">12th May 2005, 11:38</div></div><div class="posttext">Yathosho: This may be blank space in the URL or \r - \n at the end of line. I can fix, but I'd like to understand the problem first. Script sample? :)<br />
Afrow UK: Just tested SP download 130 MB - 13 sec in the 100 Mb LAN.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">12th May 2005, 12:09</div></div><div class="posttext">Originally posted by Afrow UK<br />
I was wondering if you could implement the NXS progress banner into InetLoad, so we could have just a simple progress bar when downloading small files between pages.<br />
<br />
Following &quot;banner&quot; mode has not Cancel button (but Esc key works):<br />
<br />
/BANNER CAPTION TEXT<br />
<br />
For example:<br />
InetLoad::load /banner &quot;Cameron Diaz&quot; &quot;coming soon&quot; &quot;ftp://....&quot;<br />
<br />
I cannot remeber right now why I removed x button from the banner dialog, but I can put it back :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">12th May 2005, 12:25</div></div><div class="posttext">afrow: could this be a Qos (http://www.tweakxp.com/display.aspx?id=282) related problem?<br />
<br />
takhir: send you a private message!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th May 2005, 17:40</div></div><div class="posttext">Yathosho I couldn't find anything related on that link...<br />
<br />
And thanks for the banner Takhir, I'll have a look at that now.<br />
<br />
Edit: Oh it doesn't have a progress bar though. I've already got a banner showing but a progress bar would be nice too.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wishdoctor</div><div class="date">18th May 2005, 00:56</div></div><div class="posttext">Hello all,<br />
<br />
I am a poor downtrodden Senior Tech (well..thats how I feel at the moment anyway).  Have been using NSIS for +-8 months to convert those pesky batch files to something even my junior engineers couldn't mess up..  then came SALESmen...who saw what I could do and asked a favour...could I create an installer for an offering that installs multiple 3rd party apps silently...no problem I say...and I get it working...THEN they change the goalposts with a live demo ...TOMORROW!!!<br />
Just had to tell the story as I feel a lot of techs and devs will have had the same experience...anyway...goalpost change was to download the installers from an FTP site rather than sending out disks to the client...great, but there are multiple files in the ftp locations.<br />
<br />
And here is the question...maybe I am just tired and cranky...inetload is excellent but I can't find a way to download all the files in an FTP location without specifying them individually...please tell me I am missing something and it is easy - either way, I think I will go and apply a hammer to the frontal lobe while I wait for a response.  The way my brain is working, some example basic code would help.<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">18th May 2005, 07:12</div></div><div class="posttext">Afrow UK: progress bar appears on the banner if file size info is available. May not appera on the short files (&lt;8 kB). Known problem - this is not 'cross page' banner (like nxs is), plug-in returns when download is complitted only (or error occure).<br />
<br />
Wishdoctor:<br />
&gt; TOMORROW!!!<br />
Not implemented :(<br />
This require ftp 'mput' command, but I don't know (right now) how to handle ftp control and data connections in this case. Needs some investigation.<br />
You can also pack server files to the single archive file and use one of NSIS decompression plug-ins.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th May 2005, 15:23</div></div><div class="posttext">Don't know if this is a bug or by design but calling the plugin from a Section in /silent mode still brings up &quot;InetLoad plugin&quot; in the details text label at the top.<br />
<br />
I'd like to display &quot;Downloading [file]...&quot; (w/ DetailPrint) there instead which just gets overwritten.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">25th May 2005, 06:51</div></div><div class="posttext">This is option. You can change this with following code beginning line 832 of InetLoad.cpp<br />
<br />
   if(hwndParent != NULL &amp;&amp;<br />
      (childwnd = FindWindowEx(hwndParent, NULL, &quot;#32770&quot;, NULL)) != NULL)<br />
{<br />
      if(!silent) SetDlgItemText(childwnd, 1006, PLUGIN_NAME);<br />
}<br />
   else InitCommonControls();<br />
<br />
And rebuild project (Release).<br />
Idea was to left &quot;InetLoad&quot; word somewhere :) May be I'll remove it in the next version (with POST option support, if it will be successfully tested not on my comp only).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th May 2005, 11:15</div></div><div class="posttext">Umm I'm using Visual C++ 2003 and I get these errors on compile:<br />
d:\Program Files\NSIS\Contrib\inetload\InetLoad.cpp(48): error C2365: 'FtpCommandA' : redefinition; previous definition was a 'function'<br />
d:\Program Files\NSIS\Contrib\inetload\InetLoad.cpp(521): error C2659: '=' : overloaded function as left operand<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">25th May 2005, 19:46</div></div><div class="posttext">Special build - text for 1006 control as /silent 'some text' option. It looks like NSIS cleans this field before plug-in call, so you cannot use script to set text. Usage sample in the attached file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th May 2005, 21:36</div></div><div class="posttext">Mmm I tried that DLL and I think it's taking 'some text' as a download URL.<br />
<br />
If I use /SILENT &quot;blah&quot; [url] download fails but if I use /SILENT [url] it does not fail.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">26th May 2005, 16:34</div></div><div class="posttext">Sorry, wrong file :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MichaelFlya</div><div class="date">27th May 2005, 14:56</div></div><div class="posttext">I need this To Work With InetLoad.<br />
<br />
<br />
    Pop $0<br />
<br />
         MessageBox MB_YESNOCANCEL &quot;Message&quot; IDYES LABEL1 IDNO LABLE2<br />
                 Quit<br />
<br />
<br />
What do I Say After Pop $0 to Get it to<br />
Pass The MessageBox and Quit Code if<br />
Successful?<br />
<br />
-MichaelFlya-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th May 2005, 15:34</div></div><div class="posttext">Pop $R0<br />
StrCmp $R0 ok +3<br />
MessageBox MB_YESNOCANCEL &quot;Message&quot;<br />
 Quit<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MichaelFlya</div><div class="date">27th May 2005, 16:05</div></div><div class="posttext">Thx Works Well !!<br />
<br />
-MichaelFlya-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">6th June 2005, 09:47</div></div><div class="posttext">Updated - not skips current download if &quot;Enter&quot; key was pressed.<br />
And /SILENT now with text parameter, use <br />
/SILENT &quot;&quot;<br />
to display default &quot;InetLoad plug-in&quot; in the 1006 control (install progress text on the top of the NSIS window).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MichaelFlya</div><div class="date">6th June 2005, 17:00</div></div><div class="posttext">Great Thanks Takhir !!! &quot;Enter&quot; Button seems to no longer<br />
be a problem.<br />
<br />
(Please help me troubleshoot.)<br />
<br />
While in /BANNER mode, on the Banner it will show what I<br />
want, but above the loading bar it just shows &quot;InetLoad<br />
plug-in&quot;, I'd rather it be what I want.<br />
<br />
I may be wrong, you may have put it in some how. It seems<br />
you need one more text input for the dialog shown above<br />
the details while in the Banner mode. like the Silent mode<br />
now has. If you have it already how would you do it?<br />
<br />
<br />
    InetLoad::load /BANNER &quot;Displays on banner.&quot; &quot;Displays on banner.&quot; &quot;URL for file&quot; &quot;Directory for file&quot;<br />
<br />
<br />
You have two text fields available, can you add three?<br />
<br />
I think it is &quot;Set TEXT2DISPLAY to 1006 control&quot;. I don't<br />
know how to set that manually. How would I?<br />
<br />
 -MichaelFlya-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">6th June 2005, 18:03</div></div><div class="posttext">In the Banner or Popup modes this text appears on the background window (NSIS dialog), so user can see:  1) installer's Fileinst page; 2) files installation step - &quot;InetLoad plug-in&quot; text in the 1006 field; 3) Inet file download progress on the popup or banner window. In the NSISdl or Silent modes level (3) is absent and details can be moved to second level, but IMHO this is not realy need for Popup and Banner. And I'd like to left &quot;InetLoad&quot; text somewhere on the screen ;)<br />
It looks like installer (NSIS) clears this field before plug-in call, so it is not possible to set 1006 control text from script - it will be removed.<br />
But, any case, thanks, I'll think about you idea :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MichaelFlya</div><div class="date">6th June 2005, 18:53</div></div><div class="posttext">Oh ok. It would be nice to say something besides InetLoad<br />
the user doesn't need to see that. On long downloads it is<br />
there for a long time. It is off topic for the installation.<br />
Thank you very much for taking the time to respond. :)<br />
<br />
Here is an idea that I would need somewhere down the line<br />
and saves time. Your idea is to tell the plug-in to go to a <br />
url then specify it's place on the hard drive to download to.<br />
 Then do it again for another file on the same line.<br />
<br />
I think you should have another mode that allows you to<br />
tell the plug-in to grab files from one url on the Internet<br />
then without having to type the directory or url again just<br />
specify the files.<br />
<br />
so something like this:<br />
<br />
<br />
InetLoad::load /NewSwitch /ExistingSwitch &quot;Text&quot; &quot;Text&quot; &quot;URL&quot; &quot;Directory to download to&quot; &quot;File_01&quot; &quot;File_02&quot; &quot;File_03&quot; &quot;File_04/Etc&quot;<br />
<br />
<br />
That way you do not have to say &quot;URL for file&quot;<br />
or &quot;Directory for file&quot; again, over and over.<br />
<br />
I know you can rewrite the name with a second field after<br />
the file, but in this case it could just keep the same name.<br />
<br />
Could make one more Switch for those who want to rename<br />
like this:<br />
<br />
<br />
&quot;File_01&quot; &quot;Rename&quot; &quot;File_02&quot; &quot;Rename&quot; &quot;File_03&quot; &quot;Rename&quot; &quot;File_04&quot; &quot;Rename/Etc&quot;<br />
<br />
<br />
<br />
-MichaelFlya-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MuskieMikie</div><div class="date">13th June 2005, 22:03</div></div><div class="posttext">I'm experiencing the 50 sec delay after inetload downloads the file.  This only occurs when downloading from ftp.  http is fine.<br />
<br />
Section &quot;MainSection&quot; SEC01<br />
    SetOutPath $INSTDIR<br />
    InetLoad::load &quot;ftp://ftpsdk:Rfloatpt@ftp.ati.com/AdbeRdr70_enu.exe&quot; &quot;AdbeRdr70_enu.exe&quot;<br />
    ExecWait '&quot;AdbeRdr70_enu.exe&quot;'<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">14th June 2005, 07:27</div></div><div class="posttext">This is second request with 50 sec delay problem, but I still cannot reproduce it. Right now I tested following code and Adobe installation started immediately after download was completed (12.8 MB :) ):<br />
<br />
Section &quot;Dummy Section&quot; SecDummy<br />
SetOutPath $INSTDIR<br />
InetLoad::load &quot;ftp://ftpsdk:Rfloatpt@ftp.ati.com/AdbeRdr70_enu.exe&quot; &quot;AdbeRdr70_enu.exe&quot; /end<br />
ExecWait '&quot;AdbeRdr70_enu.exe&quot;'<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">21st June 2005, 16:51</div></div><div class="posttext">2 new options: /NOCANCEL and /NOPROXY<br />
First option prevents download from being interupted by user (locks Esc, Alt-F4, Cancel handling).<br />
Second - disables proxy settings for this connection (if any). InternetOpen() uses INTERNET_OPEN_TYPE_DIRECT instead of default INTERNET_OPEN_TYPE_PRECONFIG.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mæster</div><div class="date">21st June 2005, 17:54</div></div><div class="posttext">InternetOpen() uses INTERNET_OPEN_TYPE_DIRECT instead of default INTERNET_OPEN_TYPE_PRECONFIG. <br />
So this will bypass any proxy?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">21st June 2005, 18:24</div></div><div class="posttext">Not tested, because I have not proxy at home :), but looks simple, and MSDN says this flag &quot;INTERNET_OPEN_TYPE_DIRECT - Resolves all host names locally.&quot; <br />
&quot;INTERNET_OPEN_TYPE_PRECONFIG - Retrieves the proxy or direct configuration from the registry.&quot;<br />
BTW it is possible to disable proxy using HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings ProxyEnable, but plug-in's parameter limits changes with this session only.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mæster</div><div class="date">21st June 2005, 19:03</div></div><div class="posttext">&quot;INTERNET_OPEN_TYPE_PRECONFIG - Retrieves the proxy or direct configuration from the registry.&quot;<br />
BTW it is possible to disable proxy using HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings ProxyEnable, but plug-in's parameter limits changes with this session only. <br />
<br />
Seems, that all that stuff (only) deals with the internet explorer proxy settings. So if the proxy settings are not set within ie (registry) that probably wont work with other external proxies. But thats all theory, I dont have a proxy for myself - so I couldnt test it.<br />
<br />
Because writing an Internet Updater with NSIS I am searching a long time for a nsisdl solution (or something similar) which can handle proxies which are not specified inside the ie settings (in the usually registry keys).<br />
<br />
Regards,<br />
Mæster.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">21st June 2005, 19:53</div></div><div class="posttext">InetLoad uses WinInet API, by default IE proxy settings will be used. But /PROXY &quot;IP:PORT&quot; option (string will be used as a part of INTERNET_PROXY_INFO structure) option can change proxy list for plug-in.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Megiddo_Guest</div><div class="date">25th June 2005, 03:53</div></div><div class="posttext">Can you make it so it won't take the focus ( comes to the front ) every time it downloads a file? I'm making a system that downloads about 6000 (small) files in a row, and it quite effectively keeps you from doing anything else.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">26th June 2005, 13:21</div></div><div class="posttext">Megiddo_Guest<br />
At the very beginnig this feature was requested by Jnum for silent mode, but I did it for all cases. OK, please test attached version - should be not so annoying in non-silent mode.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mario Jr.</div><div class="date">26th June 2005, 15:45</div></div><div class="posttext">Is it possible to create something like a patch client to download the latest version using nsis and this plugin? If so can someone maybe give me an hint?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">26th June 2005, 16:22</div></div><div class="posttext">1. Create installer without uninstall section, for example Updater.exe with package download and install functionality. Include it to your distribution package, add link to Start menu. Or execute it in the silent mode once a week from your application. It should send request to server with current version number, server can return new package or &quot;no version yet&quot;\ :)<br />
2. Afrow UK wrote above about bittorent http://sourceforge.net/projects/xbtt/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mario Jr.</div><div class="date">26th June 2005, 16:38</div></div><div class="posttext">Originally posted by Takhir <br />
1. Create installer without uninstall section, for example Updater.exe with package download and install functionality. Include it to your distribution package, add link to Start menu. Or execute it in the silent mode once a week from your application. It should send request to server with current version number, server can return new package or &quot;no version yet&quot;\ :)<br />
 <br />
<br />
I'd like something like download a text file from a server in which you see the version required and if lower it downloads and installs what's needed, is this possible?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th June 2005, 18:17</div></div><div class="posttext">Yeh sure it is!<br />
<br />
Use InetLoad to download the file, then use FileOpen, FileRead to get the version info out. Remember to use TrimNewLines on the stuff you read in case there are any (new lines). Finally compare read value using StrCmp with value in registry or in define (for example).<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mæster</div><div class="date">26th June 2005, 18:42</div></div><div class="posttext">Need some example for an internet updater? Take a look at the &quot;old&quot; NSIS Update Script: http://cvs.sourceforge.net/viewcvs.py/nsis/NSIS/Contrib/NSIS%20Update/Attic/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mæster</div><div class="date">26th June 2005, 19:03</div></div><div class="posttext">Just one thing for better organisation of inetload plugin. <br />
@Takhir:<br />
Would be great if you just would use the already existing wiki page http://nsis.sourceforge.net/wiki/InetLoad to store the newest version of the initload.zip. Please dont use a link to the forum for the download. I had done those changes to the wiki but i am really unable to find the latest official realease here in the forum in more than 150 replies. A central place for downloading the newest release (the wiki page) is much more better than posting a new reply with a new attachment here in the forum, dont you think so?<br />
<br />
Thank you, great work as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">26th June 2005, 19:23</div></div><div class="posttext">having a problem with the following code. works only when i use it without login : password<br />
FTPdl::download &quot;ftp://myLogin:myPassword@ftp.myftp.xx/Clip(15).3gp&quot; &quot;$Desktop\Clip(15).3gp&quot; &quot;&quot; &quot;&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">27th June 2005, 06:47</div></div><div class="posttext">Wrong thread or syntax? :)<br />
<br />
InetLoad::load &quot;ftp://username:password@ftp.myftp.xx/Clip(15).3gp&quot; &quot;$Desktop\Clip(15).3gp&quot; /end</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">27th June 2005, 12:32</div></div><div class="posttext">Originally posted by Takhir <br />
Wrong thread or syntax? :)<br />
got me there, sorry :rolleyes:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">2nd July 2005, 14:23</div></div><div class="posttext">I've currently got the 50 second delay... This happens to my script and to the example enclosed with the InetLoad package. Perhaps the delay has something more to do with the system than the script?<br />
<br />
I turned off my AV/SW and FW on XPSP2. Not sure what the cause is... Any ideas? Have anyone solved it yet?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">5th July 2005, 07:54</div></div><div class="posttext">It looks like &quot;delay on plug-in exit&quot; problem comes from WinInet.dll DETACH state (time_wait). I added fix, vbgunz reported that it works now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lightning20</div><div class="date">8th July 2005, 16:30</div></div><div class="posttext">Hi ! (sorry if my explanations aren't clear i'm french)<br />
<br />
Well, I don't know if this problem has been quoted before.<br />
I'm using InetLoad with MUI to download some files from ftp. There is a focus problem in silent install mode.<br />
<br />
Let's say that there is other windows opened when I run the install like explorer, nsis compiler or any other. Each time a file is downloaded in silentmode, the opened windows are focusing each after each. What can i do to avoid that? Did i miss something in the documentation? Because a beginner user will say &quot;hey my pc is going mad!&quot; when he will see the windows changing without doing anything :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">8th July 2005, 18:17</div></div><div class="posttext">Jnum requested this feature (on the first thread page ;) ), but it looks like most of developers are not happy with it :( OK, I commented &quot;set foreground&quot; call, please test attached version.<br />
And Jnum can use BringToFront NSIS instruction to keep banner foreground :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lightning20</div><div class="date">11th July 2005, 08:35</div></div><div class="posttext">Thank you very much :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">11th July 2005, 10:38</div></div><div class="posttext">Hello Takhir,<br />
<br />
If I could make a request it'll be to see an option to add a banner to the default download status window. An option to show a support banner image below the details.<br />
<br />
It would be great if the banner could be found either locally on a users drive or preferably linked to on the net somewhere. Is this possible?<br />
<br />
Thanks Takhir!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">11th July 2005, 18:39</div></div><div class="posttext">Looking from my corner it would be better to write a new plug-in adding child window with image to INSTFILES (or any other) page (if I correctly understood your idea). Something like AdvSplash (or NewAdvSplash :) ) but for installer pages. This is probably available on custom pages and using InstallOptionsEx (hand cursor and banner link). Another words - this (new plug-in or one of old ones with new option)) may be usefull not only with InetLoad plug-in and not only on the INSTFILES page ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">12th July 2005, 05:58</div></div><div class="posttext">Hello Takhir,<br />
<br />
The idea was to add a banner below the InetLoad download status dialog box. It would be a part of that dialog box and wouldn't show up seperately...<br />
<br />
The reason behind the idea is pretty simple. Since I have plenty of mirrors in which my files could be downloaded, I would like to try and give credit where credit is due.<br />
<br />
Instead of packaging these banners into the installer, it would be nice if they can simply be linked to from a website. In the case a banner from the net doesn't wish to show up, it'll be nice to replace it with a sort of default banner.<br />
<br />
The best part is if you can make it possible to click the banner itself so the user can visit the mirror in which they're getting the download.<br />
<br />
I hope I made sense. Thank you Takhir, I'd love to hear your idea on this. Perhaps Advanced InetLoad?<br />
<br />
:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">29th July 2005, 18:26</div></div><div class="posttext">Hi Takhir :)<br />
is it possible for inetload to show a repeating progress bar when the files are too small to show real progress.<br />
;<br />
In my case, I am downloading an xml file to check for updates. Is it possible for the progress bar to show a repeating or indeterminate time to download the file ?  That way you would not have to use nxs or msibanner for small downloads of this type....<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">30th July 2005, 07:13</div></div><div class="posttext">Hi grahama!<br />
&gt;The idea was to add a banner below the InetLoad download<br />
&gt;status dialog box. It would be a part of that dialog box <br />
&gt;and wouldn't show up seperately...<br />
<br />
IMHO this is element of browser window, one level higher then InetLoad stays :)<br />
<br />
&gt;is it possible for inetload to show a repeating progress <br />
&gt;bar when the files are too small to show real progress.<br />
<br />
What base can you offer for progress bar position if a whole file comes from server with a single message? Time stamps? Or number of files downloaded (may be interesting :) )? <br />
/POPUP window (now with translation - see wiki page (http://nsis.sourceforge.net/wiki/InetLoad) ) shows total download time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">30th July 2005, 16:48</div></div><div class="posttext">Hi Tahkir<br />
;<br />
In my case, the first 'non-eyecandy/useful' thing the user sees is a banner stating...checking for updates...please wait. <br />
;<br />
InetLoad downloads an xml file created from a php/mysql query. And, msibanner is faking progress of that query and download. <br />
Specifically, I move Msibanner forward 10 Times to 50%, inetLoad [silent mode] the file, and then move Msibanner forwards 10 Times to 100%. Very Kludgy but it works.<br />
;<br />
Usually, the query takes longer than the file download.<br />
If InetLoad could simulate a spinning/repeating/connecting to database graphic then I would not need msibanner or nxs [which I will use in all future version as it is way better than msibanner :)].<br />
;<br />
So there really is no file size or timestamp.  Basically, you are waiting for mysql/php to spit out an answer. <br />
;<br />
I guess that would be an extra parameter within inetLoad...<br />
;<br />
I do use inetLoad for actual files too. And, it works fantastic.  Adding a 'Indeterminate' parameter would make it easier to communicate with  users when NSIS is talking with php/mysql :) <br />
;<br />
does that make more sense ?<br />
;<br />
and, out of curiosity, what is the technical name for 'connecting to database' type progress bars ?<br />
;<br />
thanks for such great work Tahkir :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lightning20</div><div class="date">18th August 2005, 11:01</div></div><div class="posttext">Hi Takhir !<br />
<br />
Does your plugin support an https syntax? <br />
e.g. https://www.blahblahblah.com/file_to_download.exe<br />
Because it doesn't work with my script so i'd like to know where the problem come from.<br />
Thx :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Megiddo_Guest</div><div class="date">21st August 2005, 06:32</div></div><div class="posttext">Since IE removed the format http://username:password@site.com/ , is there any other way to log into a website?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">22nd August 2005, 08:26</div></div><div class="posttext">Lightning20 &amp; Megiddo_Guest<br />
Can you attach a short script sample to forum post or PM? Looking from my corner both https and site logging should be supported by WinInet API (even if IE not allows this).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lightning20</div><div class="date">22nd August 2005, 09:15</div></div><div class="posttext">Well, I'm just trying to download a file from the internet. I tried with http files, ftp files to make sure nothing was wrong in my script, and when I tried to download from e.g. https://www.blah-website.com/myfile.exe, it gives me an downloading error. <br />
Does the problem comes from a missing component on the computer or is it simply unsupported at the moment by your plugin?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">22nd August 2005, 10:39</div></div><div class="posttext">Lightning20<br />
Please test attached version, if this is OK, I'll update wiki page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lightning21</div><div class="date">22nd August 2005, 11:09</div></div><div class="posttext">Ok, thanks for your rapidity :) <br />
I have tried several times to download this page:<br />
https://adwords.google.com/select/steps.html<br />
It didn't work.<br />
<br />
I also tried http://adwords.google.com/select/steps.html that automatically redirect to https://adwords.google.com/select/steps.html and it works. <br />
So wininet or the plugin has a problem with the https syntax. It seems it doesn't even manage to connect.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">22nd August 2005, 12:53</div></div><div class="posttext">I tested last version (with fixed &quot;Type of service to access parameter&quot;) with one https connection and it worked. It looks like your server require additional http header because I see SendRequest error. I'll try to understand this later today. Or may be you know what header required?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lightning21</div><div class="date">22nd August 2005, 13:13</div></div><div class="posttext">Sorry I'm a perfect n00b in this domain. I'm just able to write some dummy lines with NSIS :)<br />
<br />
But you mean that each https server has its own parameters? Each different server will require a modified version of your plugin?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">22nd August 2005, 16:23</div></div><div class="posttext">This only means that I not worked with https connections earlier :)<br />
With INTERNET_FLAG_SECURE I could download page from your link. Please test attached plug-in.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lightning21</div><div class="date">22nd August 2005, 19:09</div></div><div class="posttext">Great, it works fine with https, but... (because there's always a but:) ) it doesn't work when the https certificate is outdated ! (You know, when ie or firefox asks you if you want to continue or not)<br />
<br />
Do you think is it possible to avoid this little problem?<br />
<br />
e.g with this link here:<br />
https outdated (https://svr-web.esiee-amiens.fr/opacweb/index.htm)<br />
<br />
If not, I will have to use it as it is.<br />
You already did a lot Takhir thank you :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">23rd August 2005, 07:30</div></div><div class="posttext">Ignore_sertificate CN_INVALID &amp; DATE_INVALID as default now, new version is available from the wiki page (http://nsis.sourceforge.net/wiki/InetLoad)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lightning21</div><div class="date">23rd August 2005, 08:53</div></div><div class="posttext">Thank you so very much Takhir ! Thanks to you my boss won't cut my throat ! No i'm joking btw your plugin is great :) Keep up the good work!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lightning21</div><div class="date">10th September 2005, 13:19</div></div><div class="posttext">Hi Thakir !<br />
<br />
I'm facing a strange problem with https. All works fine on my laptop with xp sp2. I tried on another pc with win xp, and also with one under win2k, the download from an https url with an outdated certificate doesn't work. Do you have an idea where the problem can come from? Is there any programs or libraries needed to be installed for the working-good of your plugin??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">30th September 2005, 09:39</div></div><div class="posttext">I have sent PM to Lightning21 some time ago asking to test my updates, but I have not any replies :( So new version (http://nsis.sourceforge.net/wiki/InetLoad) uploaded, I am the only tester, but code changes were local and (I hope) not added new bugs :)<br />
Updates:<br />
1. https on Win98 (IE 4.0, 40 bit) now works better with invalid server certificate (sample script with URL included).<br />
2. 403 (Forbidden) error code handling added.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Whilstapork</div><div class="date">2nd October 2005, 05:15</div></div><div class="posttext">Having a problem compiling it - it's expecting a file called exdll.h - is that hiding someplace that I'm unaware of? Doesn't seem to be in the zip file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">2nd October 2005, 07:06</div></div><div class="posttext">Sorry, I forgot that kichik excluded source code from NSIS package. You can take file from latest sources package (http://nsis.sourceforge.net/index.php?id=2&amp;backPID=2&amp;tt_news=28) or just use a file I am attaching to this post (path Contrib\ExDll).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mæster</div><div class="date">5th October 2005, 11:45</div></div><div class="posttext">Got a problem with InetLoad today.<br />
<br />
I use it the following way inside a function:<br />
<br />
InetLoad::load /PROXY $Proxy /USERNAME $ProxyUser /PASSWORD $ProxyPass /POPUP &quot;$(Txt24)&quot; &quot;$R2&quot; &quot;$R1&quot; /END<br />
<br />
Seems to work only this way (only with /POPUP parameter). If I omitt the '/POPUP' parameter or if i try to use the '/BANNER' parameter the download fails with error 'Connection error'. <br />
<br />
Any ideas?<br />
<br />
Btw:<br />
The delay problem seems to be not a plugin but a wininet issue. If I call the wininet.dll from inside a VB6 program the same delay occurs. The first initiation comes with 60s delay, the following not.<br />
<br />
Regards,<br />
Mæster.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">5th October 2005, 12:14</div></div><div class="posttext">Might be better to send 'problem' code :)<br />
<br />
InetLoad::load /BANNER &quot;Cameron Diaz&quot; &quot;Coming soon$\nto NSIS$\nwow&quot; <br />
&quot;http://www.dreamgirlswallpaper.co.uk/pheonixnightskicksass/wallpaper/Cameron_Diaz/camerond04big.JPG&quot; &quot;$EXEDIR\cd.jpg&quot;<br />
<br />
works fine on my comp. Please note, <br />
/BANNER CAPTION TEXT - 2 parameters, banner caption (1 string) and text near icon (up to 3 lines using $\n).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mæster</div><div class="date">12th October 2005, 07:19</div></div><div class="posttext">Takhir <br />
Please note, <br />
/BANNER CAPTION TEXT - 2 parameters, banner caption (1 string) and text near icon (up to 3 lines using $\n). [/B] <br />
Oh thanks, forgot one parameter :rolleyes: <br />
<br />
Another question: <br />
In the past i used the nsisdlSmooth-plugin (http://nsis.sourceforge.net/wiki/NSISdl_Smooth) to display an embedded nsis-download-dialog with progress bar in my Modern_UI_NSIS_Installer. I wish this could be done with the InetLoad plugin too.<br />
<br />
BTW:<br />
What means the PREFIX parameter following the /POPUP parameter? Seems currently not to be explained in the wiki.<br />
<br />
Another hint:<br />
Currently the InetLoad is easy to influence by the global IE settings. For instance, if the IE is set into the offline mode (FILE &gt; Offline Mode) the download with the plugin will fail.<br />
I dont know exactly if there are some wininet.dll flags to overcome these settings but if, it would be nice to implement them in the Inetload plugin. Its really hard to explain every installer user to configure the IE right before he/she is able to use the installer ;) <br />
<br />
Best regards,<br />
Mæster.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">12th October 2005, 08:52</div></div><div class="posttext">Thanks, Mæster.<br />
1. I updated /POPUP description on the wiki page, PREFIX parameter sets left side of the popup dialog caption, for example <br />
/popup &quot;Win2007 setup&quot;<br />
gives something like this:<br />
Win2007 setup - Downloading, 54%<br />
Default &quot;InetLoad plug-in&quot; if /popup &quot;&quot; was used.<br />
2. If both /popup and /banner were omitted, embedded NSISdl progress bar appears on the NSIS dialog (was re-tested right now). May be without smoothing :)<br />
3. New version (http://nsis.sourceforge.net/wiki/InetLoad) checks INTERNET_STATE_DISCONNECTED_BY_USER (offline) and sets IE state 'connected' this case. To initiate dial-up connection (if user is 'really' offline) you can use /RESUME option.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gultig</div><div class="date">13th December 2005, 22:28</div></div><div class="posttext">I know it's been a couple months since the last post on this thread, but would it be possible to add ftp _upload_ to this plug-in?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">14th December 2005, 07:12</div></div><div class="posttext">I am overloaded with current programming, so big changes of code may be done next month only :(<br />
May be you saw Margo' ftp plug-in (http://forums.winamp.com/showthread.php?s=&amp;threadid=174093&amp;highlight=ftp), but (from Yatosho post) &quot;unfortunately the plugin seems to crash occassionally without any further notice. however, when it crashes, it does so after being successfully executed.&quot; May be it is possible to find and update it's code. Finally I like the idea of good ftp plug-in. May be later I'll find code of my full-functional ftp backup client (with file versioninng and server' disk&lt;-&gt;tape migration status support, written 6 years ago for ADIC, tested on up to 100,000 files in single backup queue ;) ) and will do something, but I am not sure how soon this may happen. You can also use Windows ftp client with -s option in the command line (decorated with ExecDos on nsExec plugin), but it still not works in the 'passive' mode (many thanks to MS again :( ). But compact and free ftp console client may be found in Net (I hope).<br />
Yes, long, long explanations instead of working code :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gultig</div><div class="date">14th December 2005, 16:42</div></div><div class="posttext">Not a problem.  I did see the other component, and the specific issue you pointed to.  There's always another way.<br />
<br />
Yes, microsoft is both a blessing and a curse.  I am currently also figuring out a good (reliable) way to detect and install/remove/configure network adapters for my install application.  Who knows, maybe I'll write a plug-in also! :)<br />
<br />
Thank you for your amazingly quick response.  I look forward to seeing future works from you.<br />
<br />
David</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">20th December 2005, 14:02</div></div><div class="posttext">I added some code to InetLoad, but still have not time for good testing. After brief test: files download looks OK, ftp upload works in my office LAN and Inet. Change pwd and names in the included sample. http 'put' code also written, but not tested at all :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">23rd December 2005, 14:43</div></div><div class="posttext">Previous version worked 'almost' correct with http PUT, but new one also gets error code for this method (if any). http server first receives and stores uploaded file to tmp dir (progress bar appeares) and reports &quot;method not allowed (405)&quot; after this only if server is misconfigured :) So big files uploading may looks confusing sometimes :) I also had problems with http PUT if file size is &gt; 500 kB, but this looks like my apache (or php script I used) limitation.<br />
I still hope to get testing results from developers - after this I plan to replace InetLoad archive page :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nickie12</div><div class="date">15th January 2006, 21:31</div></div><div class="posttext">Hi!<br />
I've got a problem. I want to send data via a post connection. I know how. But I don't now how to send data via a post connection from variables &gt;.&lt;<br />
My variable is a var in the scheme ${varname} and is declared with !define varname $R0 and the content comes from an InstallOptions-Script: ,ReadINIStr ${TEMP1} &quot;register-ger.ini&quot; &quot;Field 1&quot; &quot;State&quot;´</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">15th January 2006, 21:51</div></div><div class="posttext">${varname},${TEMP1} are not variables. These are defines created during compile time. A variable is declared like so.Var varname<br />
Var TEMP1Those are variables...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th January 2006, 22:16</div></div><div class="posttext">Actually !define varname $R0 will work also, but unless you have !defined TEMP1 as a variable just like varname then you will get a compiler error.<br />
${varname} -&gt; $R0<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">16th January 2006, 07:18</div></div><div class="posttext">Following code should work. I used state=value for php. You can use MessageBox to check out intermediate results<br />
Section<br />
ReadINIStr $0 &quot;register-ger.ini&quot; &quot;Field 1&quot; &quot;State&quot;<br />
#StrCpy $0 &quot;test string&quot; ; for test<br />
InetLoad::load /post &quot;state=$0&quot; &quot;http://www.mypostserver.com/post.php&quot; &quot;$EXEDIR\post_reply.htm&quot;<br />
Pop $0 # return value = exit code, &quot;OK&quot; means OK :)<br />
MessageBox MB_OK &quot;Post Status: $0&quot;<br />
SectionEnd<br />
Server reply should appear in the post_reply.htm.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nickie12</div><div class="date">16th January 2006, 17:58</div></div><div class="posttext">Err, this is my code now:<br />
Var var1<br />
Var var2<br />
Var var3<br />
Var var4<br />
;--------------------------------<br />
; General Attributes<br />
<br />
!define TEMP1 $R0 <br />
!define TEMP2 $R0 <br />
!define TEMP3 $R0 <br />
!define TEMP4 $R0 <br />
<br />
Name &quot;VIRUS-Member&quot;<br />
OutFile &quot;register-ger.exe&quot;<br />
<br />
ReserveFile &quot;${NSISDIR}\Plugins\InstallOptions.dll&quot;<br />
ReserveFile &quot;register-ger.ini&quot;<br />
<br />
Page custom register-ger<br />
<br />
<br />
  !include &quot;MUI.nsh&quot;<br />
  !define MUI_ICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-install-colorful.ico&quot;<br />
  !insertmacro MUI_PAGE_WELCOME<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_PAGE_FINISH<br />
  !insertmacro MUI_LANGUAGE &quot;German&quot;<br />
<br />
Section &quot;register&quot;<br />
<br />
ReadINIStr $var1 &quot;register-ger.ini&quot; &quot;Field 1&quot; &quot;State&quot;<br />
ReadINIStr $var2 &quot;register-ger.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
ReadINIStr $var3 &quot;register-ger.ini&quot; &quot;Field 6&quot; &quot;State&quot;<br />
ReadINIStr $var4 &quot;register-ger.ini&quot; &quot;Field 5&quot; &quot;State&quot;<br />
  <br />
    InetLoad::load /post &quot;login=$var1&amp;password=$var2&amp;cracker=$var3&amp;beschuetzer=$var4&amp;create=1&quot; &quot;http://ollernick.ol.funpic.de/registerforgame.php&quot; &quot;success.html&quot;<br />
    Pop $0 # return value = exit code, &quot;OK&quot; if OK<br />
    MessageBox MB_OK &quot;Registrationsstatus: $0&quot;<br />
SectionEnd<br />
<br />
Function .onInit<br />
<br />
  ;Extract InstallOptions INI files<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;register-ger.ini&quot;<br />
<br />
  <br />
FunctionEnd<br />
<br />
LangString TEXT_IO_TITLE ${LANG_GERMAN} &quot;Registration&quot;<br />
LangString TEXT_IO_SUBTITLE ${LANG_GERMAN} &quot;Reggt euch doch ^^&quot;<br />
<br />
Function register-ger<br />
!insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;register-ger.ini&quot;<br />
FunctionEnd<br />
<br />
<br />
It wouldn't run :(<br />
(If you see &quot;Cracker&quot; and &quot;VIRUS&quot;, it's just a game</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">16th January 2006, 18:19</div></div><div class="posttext">I had not your ini file, so I tested script with fixed parameters    StrCpy $var1 aaaaa<br />
StrCpy $var2 bbbbb<br />
StrCpy $var3 ccccc<br />
StrCpy $var4 ddddd<br />
<br />
;MessageBox MB_OK &quot;login=$var1&amp;password=$var2&amp;cracker=$var3&amp;beschuetzer=$var4&amp;create=1&quot;<br />
    InetLoad::load /post &quot;login=$var1&amp;password=$var2&amp;cracker=$var3&amp;beschuetzer=$var4&amp;create=1&quot; &quot;http://ollernick.ol.funpic.de/registerforgame.php&quot; &quot;success.html&quot;<br />
<br />
and found in the success.html aaaaabbbbbcccccddddd1<br />
You can check vars using <br />
;MessageBox MB_OK &quot;login=$var1&amp;password=$var2&amp;cracker=$var3&amp;beschuetzer=$var4&amp;create=1&quot;<br />
and ini file content in this pause.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nickie12</div><div class="date">16th January 2006, 19:02</div></div><div class="posttext">Yeah, that runs<br />
But not from InstallOptions &gt;-&lt;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th January 2006, 23:38</div></div><div class="posttext">Use !insertmacro MUI_INSTALLOPTIONS_READ instead of ReadINIStr.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MinterWute</div><div class="date">5th March 2006, 01:13</div></div><div class="posttext">Originally posted by Takhir <br />
Previous version worked 'almost' correct with http PUT, but new one also gets error code for this method (if any). http server first receives and stores uploaded file to tmp dir (progress bar appeares) and reports &quot;method not allowed (405)&quot; after this only if server is misconfigured :) So big files uploading may looks confusing sometimes :) I also had problems with http PUT if file size is &gt; 500 kB, but this looks like my apache (or php script I used) limitation.<br />
I still hope to get testing results from developers - after this I plan to replace InetLoad archive page :) <br />
<br />
Thanks for this update, I've been using this for downloading updated files in my devkitPro installer ( http://www.devkitpro.org ) and also the MinGW ( http://www.mingw.org ) installer I've been working on. This one has proved to be much better at connecting to the sourceforge sites on Windows XP sp2 than the previous version.<br />
<br />
I do have one question. One user has problems with a proxy that requires him to log in. Are there any environment variables that can be set if the plugin isn't picking up the IE proxy settings? Being honest I'm not 100% sure if IE holds these settings for him, the problem report was fairly minimal. <br />
<br />
http://sourceforge.net/forum/forum.php?thread_id=1445111&amp;forum_id=539405<br />
<br />
Thanks for all your hard work<br />
Dave</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">5th March 2006, 11:24</div></div><div class="posttext">Good question. Both InetLoad/inetc have the same parameters set including [/PROXY IP:PORT] [/USERNAME PROXY_LOGIN /PASSWORD PROXY_PASSWD] (INTERNET_OPEN_TYPE_PROXY, INTERNET_OPTION_PROXY_USERNAME and INTERNET_OPTION_PROXY_PASSWORD). But for local proxies user-specific values required (if parameters not come with IE pre-sets). Currently I have not information about env. vars for local proxy settings, but on the proxy error plug-in should return &quot;Proxy Error (407)&quot; string in the Pop, this case we can ask user - display custom dialog for login/password. The simplest way I see is plug-in with auth request (http://nsis.sourceforge.net/File:Auth.zip) for 'in section' usage (I wrote this 5 minutes ago, so test it first ;) ), this may be universal approach - not for InetLoad/inetc only. Finally, if you see specific proxy error in InetLoad exit, ask user and call InetLoad again.<br />
Edited And you should handle installer' silent mode in script by skipping dialog in the silent mode.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">12th March 2006, 12:32</div></div><div class="posttext">I updated InetClient plug-in (http://nsis.sourceforge.net/Inetc_plug-in) to use WinInet internal authentication dialog for server and proxy auth. request. Tonight I'll add the same changes to InetLoad.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MinterWute</div><div class="date">17th May 2006, 21:15</div></div><div class="posttext">I'm having an issue with the inetc plugin crashing when using resume and the user clicks cancel on the retry/cancel messagebox. The following script shows the problem.<br />
<br />
;--------------------------------<br />
; General Attributes<br />
<br />
Name &quot;inetc test&quot;<br />
OutFile &quot;inetctest.exe&quot;<br />
ShowInstDetails show<br />
<br />
;--------------------------------<br />
;Interface Settings<br />
<br />
  !include &quot;MUI.nsh&quot;<br />
  !define MUI_ICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-install-colorful.ico&quot;<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
;--------------------------------<br />
;Installer Sections<br />
Section &quot;Dummy Section&quot; SecDummy<br />
<br />
    inetc::get /resume &quot;&quot; &quot;http://www.bogus.com/bogus.txt&quot; &quot;$EXEDIR\mirrorlist.html&quot; /END<br />
    pop $0<br />
    detailprint $0<br />
<br />
SectionEnd<br />
<br />
<br />
If I use this code instead then it works as expected.<br />
<br />
    inetc::get /popup &quot;&quot; /resume &quot;&quot; &quot;http://www.bogus.com/bogus.txt&quot; &quot;$EXEDIR\mirrorlist.html&quot; /END</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">18th May 2006, 06:51</div></div><div class="posttext">Could not reproduce this on my XP Pro SP2 + IE 6.0. Not crashes, DetailPrint: <br />
 SendRequest Error<br />
 Completed<br />
I'll inspect code later today, but may be you can give me more details about your test (system configuration, etc.)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MinterWute</div><div class="date">18th May 2006, 16:23</div></div><div class="posttext">Win2k Pro SP4, IE 6.0.2800.1106, NSIS 2.16, AMD Sempron 2600<br />
<br />
The annoying thing is if I set a breakpoint at the pushstring in the get function and step with the VS debugger then I don't get a crash either :/ Is it perhaps some sort of timing issue?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">18th May 2006, 18:34</div></div><div class="posttext">I improved few suspicious places, but I still cannot reproduce am not sure in the new version, please test.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shaunb</div><div class="date">19th May 2006, 16:51</div></div><div class="posttext">Might be a silly question,<br />
<br />
If I point this at a url of a webscript such as CF in silent mode, will it execute the script silently? e.g if I pointed it to the url <br />
<br />
http://localhost/adminAPI/dowork.cfm<br />
<br />
it'll just execute the script contents without bringing up a browser window? hmm sounds like it would .. I'll have to give it a try.<br />
<br />
thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MinterWute</div><div class="date">20th May 2006, 17:40</div></div><div class="posttext">Originally posted by Takhir <br />
I improved few suspicious places, but I still cannot reproduce am not sure in the new version, please test.  <br />
<br />
Sorry, still crashes, is there anything I can do with a debugger that might help you?<br />
<br />
It looks like it's some sort of stack issue - when it crashes it seems to be executing somewhere random.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">24th May 2006, 08:09</div></div><div class="posttext">I have sent personal message (http://forums.winamp.com/usercp.php) with inetc debug build and comments. Crash still not repeats even on W2K with you configuration. Strange thing - plug-in reports about &quot;Server Error&quot; on W2K and &quot;SendRequest Error&quot; on WinXP.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">12th June 2006, 07:12</div></div><div class="posttext">Inetc update: new /CAPTION TEXT parameter (zeeh3 request). Mainly for RESUME message box header in the &quot;old style&quot; output, i.e. if caption not defined and plug-in uses default and english &quot;InetClient plug-in&quot;. As a result /POPUP and /SILENT now go without (caption) parameter, and /BANNER has single one (window body text). This not touchs InetLoad yet, may be later, after some test period, so please read wiki page when download new version. Also may be in the SILENT mode plug-in should not display message above progress bar, but for now I left it as it is.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">polygonansigt</div><div class="date">23rd July 2006, 20:50</div></div><div class="posttext">I am trying to download a list of files, but something fails, i am probably doing something that is not possible :-)<br />
<br />
StrCpy $test '&quot;http://testserver.com/files/tmp.exe&quot; &quot;$TEMP\tmp.exe&quot;'<br />
<br />
InetLoad::load /popup &quot;test load&quot; $test<br />
<br />
This is producing nothing, am i doing something real odd, or is this just impossible. My goal is to be able to build a &quot;list&quot; of files to be downloaded.<br />
<br />
StrCpy $test '&quot;http://testserver.com/files/tmp.exe&quot; &quot;$TEMP\tmp.exe&quot; &quot;http://testserver.com/files/tmp2.exe&quot; &quot;$TEMP\tmp2.exe&quot;' :-)<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">24th July 2006, 07:03</div></div><div class="posttext">Multiple download sample was tested many times. In your script NSIS might put $test as a single string to stack. Please test &quot;long&quot; command line first (without strcpy) and check exit code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">polygonansigt</div><div class="date">24th July 2006, 19:47</div></div><div class="posttext">Originally posted by Takhir <br />
Multiple download sample was tested many times. In your script NSIS might put $test as a single string to stack. Please test &quot;long&quot; command line first (without strcpy) and check exit code. <br />
<br />
I didn't realize the way the commandline and the stack worked. You were correct that $test was put onto the stack as a single line. I managed to get it to work by push'ing the data to the stack in a loop and calling InetLoad::load /popup to have it pick up the parameters from the stack. Seems to work like a charm :-) Thanx for pointing me in that direction.<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pedroac</div><div class="date">25th July 2006, 17:42</div></div><div class="posttext">Hi everybody<br />
<br />
Is there a way to make the dialog freeze while the download is being made?<br />
<br />
Currently, the download uses the proxy settings correctly, but the user is able to press &quot;Back&quot;, &quot;Next&quot; and &quot;Cancel&quot; and I don't want it to happen.<br />
<br />
Any idea?<br />
Thanks in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th July 2006, 17:47</div></div><div class="posttext">You can disable the buttons yourself with GetDlgItem and EnableWindow:<br />
<br />
GetDlgItem $R0 $HWNDPARENT 1<br />
EnableWindow $R0 0<br />
GetDlgItem $R0 $HWNDPARENT 2<br />
EnableWindow $R0 0<br />
GetDlgItem $R0 $HWNDPARENT 3<br />
EnableWindow $R0 0<br />
<br />
This will disable all three buttons.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pedroac</div><div class="date">25th July 2006, 18:56</div></div><div class="posttext">Thanks a lot, now it works just fine!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stone_j</div><div class="date">17th August 2006, 23:05</div></div><div class="posttext">Hi.<br />
I'm getting faimilar with inect but I have one questiona, as I cant find answer for it. Is it possible to upload on serwer whole directory structure?<br />
Thanks for help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">18th August 2006, 06:36</div></div><div class="posttext">No. Use FindFirst, FindNext, FindClose to scan dir.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bar10dr</div><div class="date">25th September 2006, 12:15</div></div><div class="posttext">Is the DLL made in .NET ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">25th September 2006, 12:38</div></div><div class="posttext">Nope, .NET not required. Functions are classic dll entry points (__far __pascal == WINAPI). But you can build project under VS 2005 as well - no difference with VS 6.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rjch_au</div><div class="date">24th October 2006, 06:10</div></div><div class="posttext">Just got a quick question... I'm using an NSIS installer with the inetload plugin (bloody wonderful plug-in that it is!) to reduce the pain involved in upgrading software on several hundred machines by having the installer download the necessary updates - one of which is the dotNET framework - all 23mb of it.  Dialup sites have a bad habit of regularly failing to the point that they can never finish the download in one go.<br />
<br />
I'm trying to use the following line of code to silently download (with resume) the update, but in silent mode, resume does not seem to work.  It works fine in normal mode, but the problem is that there *isn't* someone watching the machine to click the Retry button.<br />
<br />
		inetload::load /resume &quot;&quot; /silent &quot;Downloading dotNET framekwork...&quot; /popup &quot;Downloading...&quot; &quot;http://172.25.254.151/appupdates/updatepacks/dotnetsilent_adbox.exe&quot; &quot;$OUTDIR\dotnetsilent_adbox.exe&quot;<br />
<br />
Can anyone give me any ideas how I might resolve this problem?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">24th October 2006, 07:12</div></div><div class="posttext">Try to comment line 976 in InetLoad.cpp source code and rebuild project, should be (not tested)<br />
//   if(silent) resume = false;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rjch_au</div><div class="date">24th October 2006, 07:36</div></div><div class="posttext">Thanks for your quick suggestion Takhir, however I'm now running in to a problem previously posted on the forum that I can't spot a solution for - namely, I'm getting the following compile errors:-<br />
<br />
error C2365: 'FtpCommandA' : redefinition; previous definition was a 'function' (@ line 64)<br />
C2659: '=' : overloaded function as left operand (@ line 633)<br />
<br />
C++ isn't my specialty - I *can* program, but it's not what I do for a living and for that reason, whenever I need to knock something together I either use NSIS or VB.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">24th October 2006, 08:32</div></div><div class="posttext">Just replace FtpCommand with myFtpCommand, use &quot;whole word&quot; option on replace. It is important for this line:<br />
  myFtpCommand = (FTP_CMD)GetProcAddress(hInstance, &quot;FtpCommandA&quot;);</div></div><hr />


<div class="post"><div class="posttop"><div class="username">********</div><div class="date">14th December 2006, 08:07</div></div><div class="posttext">Is it possible to RESUME download of already existing file?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">14th December 2006, 08:24</div></div><div class="posttext">Is it possible to RESUME download of already existing file?<br />
No. Please use 4.9.4.10 IfFileExists jumps to handle the situation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">********</div><div class="date">14th December 2006, 13:35</div></div><div class="posttext">That's a pity even though inetc is not a download manager. Still there is another bug not connected with RESUME:<br />
<br />
When inetc is called in .onInit installer window is started in background and BringToFront doesn't work afterrwards.<br />
<br />
The command used is<br />
<br />
inetc::get  &quot;http://www.mingw.org/mingw.ini&quot; &quot;$EXEDIR\\mingw.ini&quot; /END</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">14th December 2006, 14:16</div></div><div class="posttext">NSIS BringToFront manual notes this new OSes behaviour. Use /banner or /popup to keep focus.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">********</div><div class="date">14th December 2006, 14:37</div></div><div class="posttext">I haven't found the instructions. It is said that  If an application was executed that shows itself in front of the installer, a BringToFront would bring the installer back in focus. But AFAICU there is not separate application executed. In fact the inetc command above is meant to be launched with /SILENT key for quick check if there is a newer version of installer available. Maybe it is possible to do something so installer will not lose the focus?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">14th December 2006, 15:05</div></div><div class="posttext">4.9.14.1 BringToFront<br />
...<br />
Recent Windows versions restrict the setting of foreground windows. If the user is working with another application during installation, the user may be notified using a different method.&quot;<br />
<br />
Finally this means that none of SetForegroundWindow, SetActiveWindow, SetWindowPos can sets window to foreground and give it keyboard focus (now). Taskbar button flashes instead. But Inetc sources include commented sf() function - this worked but was removed later. You need to call this directly from installer, may be using System plug-in.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">********</div><div class="date">14th December 2006, 21:07</div></div><div class="posttext">Still can't get the logic. Installer does not execute any external programs to lose focus - it merely calls a function from DLL. In addition I do not have any recent windows version (W2K only), so this should work for me, but BringToFront doesn't work after a call to inetc.<br />
<br />
Maybe there is a misconception in inetc which tries to operate with some of its windows even with the /SILENT switch - this causes installer to lose focus to these windows and they fail to return it back? Could this be possible?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">15th December 2006, 07:01</div></div><div class="posttext">This is not Inetc related problem, the same (under some conditions) happen with splash windows, banners and even outside NSIS ;) http://forums.winamp.com/showthread.php?s=&amp;threadid=157907&amp;highlight=BringToFront<br />
Please use forum search - you are not first :) and most of questions already have answers..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">27th December 2006, 07:38</div></div><div class="posttext">BTW, I did't want to mess on the other thread (http://forums.winamp.com/showthread.php?s=&amp;threadid=262506), the plugin is just incredible!<br />
Thank you!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">27th December 2006, 09:41</div></div><div class="posttext">Thanks, Red Wine :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dannyoneill</div><div class="date">21st January 2007, 11:11</div></div><div class="posttext">Hi, Im having a few problems, when i run my download installer I dont receive a dialog box with the download progress. However I did with the older version in the quote below. The latest one does download the file but totally silent.<br />
<br />
My line reads as follows<br />
<br />
InetLoad::load ${PDFURL} $PROGRAMDIRECTORY\CoolPDF.exe<br />
<br />
As I said, it worked fine with older versions but the latest just doesnt show any progress.<br />
<br />
Thanks<br />
<br />
<br />
Originally posted by Takhir <br />
Itï¿½s not easy to debug program if you cannot touch the problem with your own hands J<br />
I made one minor improvement for error 407 (proxy authorization), might be good to test it. But the main question is in explicit proxy authorization if IE registry parameters (already used) are not enough for connection. This require user_name and password. I see  2 simple ways to resolve the problem, silent InternetSetOption(INTERNET_OPTION_PROXY_PASSWORD + INTERNET_OPTION_PROXY_USERNAME) if these  parameters presents in the plug-in call (something like ï¿½load /PASSWD=passwd ï¿½ï¿½)  or popup dialog (InternetErrorDlg for example), where user can enter name and passwd for proxy auth (not works in the silent mode). Both variants may present in program, of course. First is good for corporate network distribution, second ï¿½ for Inet downloads. If this is what you need ï¿½ Iï¿½ll be in office in Monday and can make changes next week.<br />
Also few words about http server authorization (error 401) ï¿½ it is possible to define name and password in the URL, program extracts both parameters (if any. I did this for FTP if anonymous user is not accepted).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">21st January 2007, 13:47</div></div><div class="posttext">I re-tested InetLoad and could see correct download progress (Nov 4 2006 version, XP Pro). You can download and test old version from http://nsis.sourceforge.net/File:InetLoad.zip or try to use Inetc (http://nsis.sourceforge.net/Inetc_plug-in) - function name is get (Inetc::get) and embedded dialog code was improved there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dannyoneill</div><div class="date">21st January 2007, 18:59</div></div><div class="posttext">Its weird, use the old version in the post above and all works, use the latest and it just wont show.<br />
<br />
Do I need any other commands to make it show or should<br />
<br />
InetLoad::load ${PDFURL} $PROGRAMDIRECTORY\CoolPDF.exe<br />
<br />
work?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">22nd January 2007, 07:21</div></div><div class="posttext">I compared last source with March 12, 2006 version and don't see any related code changes. What is your 'old' version? And (again :) ) Inetc behaviour is more stable in old (NSISdl) display mode.<br />
In your code following might be better (the same for Inetc)<br />
InetLoad::load ${PDFURL} &quot;$PROGRAMDIRECTORY\CoolPDF.exe&quot; /end<br />
Pop $R0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Backland</div><div class="date">22nd January 2007, 12:41</div></div><div class="posttext">dannyoneill,<br />
<br />
Are you by any chance making multiple calls to the plugin? e.g. downloading more than 1 file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dannyoneill</div><div class="date">24th January 2007, 08:06</div></div><div class="posttext">at the moment im downloading one then later another. But I have tried it with just one file. Old plugin fine, new one nope. <br />
<br />
I can make the full script available if thats of any help. Its for CoolPDF Portable.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Backland</div><div class="date">24th January 2007, 14:01</div></div><div class="posttext">hmmm... I have had similar problems with Inetc and downloading more than 1 file where the progress is not displayed at all.<br />
<br />
Attaching your script is probably a good idea.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">24th January 2007, 14:12</div></div><div class="posttext">Good idea is to attach a short script reproducing the problem ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">24th January 2007, 14:16</div></div><div class="posttext">I have had similar problems with Inetc and downloading more than 1 file where the progress is not displayed at all Are you using Inetc in NSISdl mode? Some servers do not supply the size information so Inetc cannot provide a progress bar which &quot;moves&quot; (because it does not know how big the file is). The progress bar stays &quot;empty&quot;.<br />
<br />
Try using Inetc's POPUP mode - in the popup the plugin will tell you if the size is unavailable but it will show you how much data is being downloaded so you can tell something is happening.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">24th January 2007, 14:27</div></div><div class="posttext">I forgot to note that progress bar may not appear if file size is less then 8 kB (data bufer).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Backland</div><div class="date">24th January 2007, 15:08</div></div><div class="posttext">I'm using Inetc in NSISdl mode, file is &gt; 8kb and server definitely sends filesize as 90% of the time the progressbar shows up for the first download, but completely disappears for the second one and any others after that.<br />
<br />
The label showing status message always works fine though.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">michael.hejwosz</div><div class="date">27th January 2007, 10:01</div></div><div class="posttext">I am using your wonderful plugin yet I seem to be having a little problem I do not know what it is related to.<br />
<br />
I am using the /TRANSLATE switch with the following, among a few, text: &quot;Downloading SuperMemo 2006 (13.01 Beta I from Jan 22, 2007)...&quot; (skip the quotation marks)<br />
Yet the text displayed about the first progress bar sheds the last 4 chars: &quot;)...&quot;<br />
Could you please tell me what the reason is??<br />
<br />
Thank you in advance,<br />
Mike</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">27th January 2007, 16:30</div></div><div class="posttext">I've put to wiki new version with increased string buffers. Next time please attach a short sample demonstrating the problem, it's not easy to find situation basing on the text 'among a few' :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">michael.hejwosz</div><div class="date">27th January 2007, 18:29</div></div><div class="posttext">Thank you. Unfortunately, the problem persists.<br />
<br />
Here can you find a more detailed description with a screenshot: http://forums.winamp.com/showthread.php?s=&amp;threadid=264467<br />
Thank you for your help.<br />
Mike</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cbexaminr</div><div class="date">30th January 2007, 03:34</div></div><div class="posttext">Making mention of this here in case it comes to appropriate individuals attention sooner than the actual bug report...<br />
<br />
For description of possible problem, please see:<br />
http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1647321&amp;group_id=22049&amp;atid=373085<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">30th January 2007, 07:19</div></div><div class="posttext">I added KillTimer to wiki release, but probably you used pre Sep 7, 2006 version in NSISdl mode. System should kill all timers and messages queue when window destroyed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">michael.hejwosz</div><div class="date">30th January 2007, 10:28</div></div><div class="posttext">I have managed to solve my problem. The original line of source code looks as follows:<br />
Downloading SuperMemo ${strSMYear4D} ($strSMVerTag from $strSMVerDate)...<br />
The values of the last two variables (i.e. $strSMVerTag and $strSMVerDate) are read from a text file downloaded from the web. The reason why &quot;)...&quot; kept being truncated was that the value of $strSMVerDate had new line at the end of it.<br />
It is solved now. Thank you for your help.<br />
<br />
On a related topic. The InetLoad readme text file advises to peek into the source code (i.e. InetLoad.cpp) for a full set of status strings. I am particularly interested in error status codes. I did look into the code but found not entirely satisfactory for an FAQ I am planning to write accompanying the installer. Since InetLoad is based on WinInet API, is there somewhere a list of error codes I could be referred to??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cbexaminr</div><div class="date">30th January 2007, 10:51</div></div><div class="posttext">The release I have contains last comment dated 1-jan-2007.  (This may not be what was used in the actual build of the released mingw installer - I didn't build that one, I'm just trying to figure out why it sometimes crashes on me.)<br />
<br />
But, for the wiki release...<br />
<br />
I see no mention of a KillTimer() call in inetc.cpp.<br />
<br />
I searched everything expanded from the archive, and get no hits on &quot;KillTimer&quot;.<br />
<br />
I do see a call and comment that is presumably used to generate an extra call to WM_TIMER functionality, i.e. PostMessage(hDlg, WM_TIMER, 1, 0); // show url &amp; fn, do it sync<br />
<br />
(The comment mentions &quot;sync&quot;, however I believe to be synchronous, would need to be using SendMessage(), not PostMessage().)<br />
<br />
***Where are the changes that actually kill the timer?  Is it done by some means other than KillTimer()?  What changes were made in the sep 7, 2006 to accomplish this?  (Failed to find inetc in NSIS CVS to explore myself...)<br />
<br />
Thanks in advance for the info.<br />
<br />
(The crash address appears to be inside of progress_callback(), which appears to only be invoked from the WM_TIMER handling code.  As I've tried to re-build the installer locally, obtaining all correct versions (except maybe add-ins, which I apparently can't obtain), and have failed to reproduce the crash, (although I get a display problem possibly from inetc), I'll acknowledge it may indeed be fixed...  But I'm interested in knowing how it was addressed/fixed, since I don't see how the timer is being destroyed.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">30th January 2007, 11:58</div></div><div class="posttext">2 michael.hejwosz: you can find errors in inetc.cpp file.<br />
<br />
2 cbexaminr: Thanks for your help. InetLoad/Inetc crashes in NSISdl (no popup) mode found earlier but I supposed sutiation was fixed with Backland help in september. All versions are here http://nsis.sourceforge.net/File:Inetc.zip Unfortunatelly I could not reproduce crash on my comp, so please let me know if you can find 'problem' line in code.<br />
In the today's morning (MSK) version KillTimer was line 953. WM_TIMER handler additionally includes now IsWindow() check for (IMHO weird) situation when window already destroyed, but message loops still delivers events. PostMessage is called at the very beginning of download and should not cause crash, but any way this should be fixed now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">michael.hejwosz</div><div class="date">30th January 2007, 11:58</div></div><div class="posttext">Can someone help me map the error messages found @ http://msdn2.microsoft.com/en-us/library/aa385465.aspx to the following piece of the source code??<br />
enum STATUS_CODES {<br />
   ST_OK = 0,<br />
   ST_CONNECTING,<br />
   ST_DOWNLOAD,<br />
   ST_CANCELLED,<br />
   ST_URLOPEN,<br />
   ST_PAUSE,<br />
   ERR_TERMINATED,<br />
   ERR_DIALOG,<br />
   ERR_INETOPEN,<br />
   ERR_URLOPEN,<br />
   ERR_TRANSFER,<br />
   ERR_FILEOPEN,<br />
   ERR_FILEWRITE,<br />
   ERR_REGET,<br />
   ERR_CONNECT,<br />
   ERR_OPENREQUEST,<br />
   ERR_SENDREQUEST,<br />
   ERR_CRACKURL,<br />
   ERR_NOTFOUND,<br />
   ERR_THREAD,<br />
   ERR_PROXY,<br />
   ERR_FORBIDDEN,<br />
   ERR_REQUEST,<br />
   ERR_SERVER,<br />
   ERR_AUTH<br />
};<br />
Thank you in advance,<br />
Mike</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MinterWute</div><div class="date">2nd February 2007, 16:06</div></div><div class="posttext">Takhir: I've just been trying the latest inetc with NSIS 2.23 and the progress dialog is not being redrawn properly for some reason. This is on Windows 2000 Pro.<br />
<br />
Does something need changed for the latest NSIS? I did try rebuilding with the latest exdll header without success.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Backland</div><div class="date">2nd February 2007, 17:07</div></div><div class="posttext">MinterWute,<br />
<br />
I have similar problems with this as well on both XP/2000. I'm still working on a script to reproduce the issue for Takhir.<br />
<br />
Its not a bad idea that you attach your script for examination. Please also note Inetc is last updated on 30th of Jan.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">2nd February 2007, 18:29</div></div><div class="posttext">Thanks, Backland, script may help. Right now I re-tested latest inetc on my home XP Pro with following scriptSetDetailsView hide<br />
 inetc::get &quot;http://ineum.narod*****spr_2004.htm&quot; &quot;$EXEDIR\spr4.htm&quot; \<br />
  &quot;http://ineum.narod*****spr_2005.htm&quot; &quot;$EXEDIR\spr5.htm&quot;<br />
Pop $0<br />
 inetc::get &quot;http://ineum.narod*****spr_2006.htm&quot;  &quot;$EXEDIR\spr6.htm&quot;<br />
Pop $2but could not reproduce redraw issue :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cbexaminr</div><div class="date">3rd February 2007, 03:00</div></div><div class="posttext">1) Redraw issue<br />
I and another individual (who I guess is the maintainer of the mingw installer) also have the redraw problem.<br />
<br />
You can grab the mingw installer source, and probably see the issue.  To the best of my knowledge neither of us have done anything but use a different (latest) inetc - the script code is apparently the same.  The url to browse that stuff is:<br />
http://mingw.cvs.sourceforge.net/mingw/MinGW/<br />
<br />
The instructions to check it out with command line cvs are at:<br />
http://sourceforge.net/cvs/?group_id=2435<br />
<br />
2)earlier reported crash - older version of inetc<br />
I have learned that the crashing version of inetc was the 10 june version.  Further research indicates that the crash was occurring at the location where a routine ParentWndProc() should have been (before the pages were released.)<br />
<br />
It appears that this routine is no longer part of the current inetc source, and so I will assume that problem is no longer a problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">3rd February 2007, 08:17</div></div><div class="posttext">OK, redraw is the only problem in current version, so let's find where and why :) OS, IE ver., NSIS ver, latest Inetc, short script reproducing the problem. To test this I have XP Pro and win98 with home dial-up and all OSes and most of connection types in office. Please attach script to post.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Meefer</div><div class="date">4th February 2007, 12:11</div></div><div class="posttext">http://Jennifer-Lopez-Doing-A-Huge-Black-Man.info</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Backland</div><div class="date">4th February 2007, 12:18</div></div><div class="posttext">seems the forum is blocking external links, can you guys post your links as plain text (probably by removing the http://www)<br />
<br />
google.com</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">4th February 2007, 12:24</div></div><div class="posttext">@ Backland, the forum blocks external links that added from new registered users ;)<br />
I bet the blocked link above is just spammers attempt to add their craps in this forum.<br />
<br />
If for instance you try to submit an external link, I bet won't be blocked ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Backland</div><div class="date">4th February 2007, 12:35</div></div><div class="posttext">Thanks Red Wine, testing http://www.google.com<br />
<br />
cbexaminr added 2 links just a few posts above, i think those were to the installer which has the redraw issues.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">4th February 2007, 12:44</div></div><div class="posttext">Originally posted by Backland <br />
Thanks Red Wine, testing http://www.google.com<br />
<br />
cbexaminr added 2 links just a few posts above, i think those were to the installer which has the redraw issues.  You probably realize that a strong protection from spammers requires some patience from the rest of new registered users ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cbexaminr</div><div class="date">5th February 2007, 10:14</div></div><div class="posttext">browse mingw installer source tree:<br />
mingw.cvs.sourceforge.net/mingw/MiGW/<br />
<br />
to checkout mingw installer source follow instructions at:<br />
sourceforge.net/cvs/?group_id=2435<br />
<br />
Sorry it's not &quot;reduced script&quot; - but it's what I can point you toward.<br />
<br />
(hope these &quot;links&quot; pass the filtering - funny, I don't think the &quot;preview&quot; showed the links blacked out in original post.  There is no www on the items, just h t t p : / / .)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MinterWute</div><div class="date">5th February 2007, 16:59</div></div><div class="posttext">Using SetDetailsView show gives the redraw error for me with your small script. This used to work with previous versions but maybe it's something that I shouldn't have been doing?<br />
<br />
<br />
  SetDetailsView show<br />
  inetc::get /RESUME &quot;&quot; &quot;http://downloads.sourceforge.net/devkitpro/libnds-20060719.tar.bz2&quot; &quot;$EXEDIR\libnds-20060719.tar.bz2&quot; /END<br />
  Pop $0<br />
  MessageBox MB_OK &quot;Download Status: $0&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">6th February 2007, 09:23</div></div><div class="posttext">I tested script from my previous post on the following OSes: Win98 SE (IE5), Win2000 SP2, WinXP Pro SP2, Win2003 SP1, Vista Ultimate Final Release (IE7) - no problems with redraw. Last Inetc Jan 30, 2007. NSIS 2.22. With 'SetDetailsView show' dialog looks ugly (tested on XP), but redraw was correct. May be progress bar smothing in not-XP style would be better.<br />
Edited: I used 2 versions of dotnetfx.exe (20 MB) for LAN downloads.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">19th February 2007, 10:12</div></div><div class="posttext">New Inetc (http://nsis.sourceforge.net/Inetc_plug-in) version.<br />
1. /POPUP option now with text (again), /POPUP &quot;HOST_ALIAS&quot;  - this allow to hide real URL in popup mode and (if encoded) login/password(!). <br />
2. Transfer speed calculation improved (for paused state mainly).<br />
3. Redirection sample added (I received request for HTTP 301/302, and even added code, but finally found that WinInet does this internally). But redirection prohibitted for https (right now I cannot remember why :) ).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pedroac</div><div class="date">19th February 2007, 20:20</div></div><div class="posttext">In my tests, this DOES NOT WORK if you don't have .NET installed</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">20th February 2007, 08:20</div></div><div class="posttext">I tested last build at home on XP Pro, without .NET and now in office on Win98 and Win2000 (no .NET as well), Inetc works correct on all these comps. If you have problem with all plug-ins (NSISdl, InetLoad, Inetc) it's a good time to check your own script ;)<br />
BTW did you built NSIS from sources?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mr Inches</div><div class="date">24th February 2007, 01:22</div></div><div class="posttext">The .NET install usually includes versions of the MS C Runtime libraries (DLLs).<br />
<br />
Is it possible that one of these is getting clobbered and causing the problem? (assuming that the problem is only evident on computer with the .NET framework installed.)<br />
<br />
What about the presence of VS 2005, it uses a different version of the MS CRT again (8.0)?<br />
<br />
Duncan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pedroac</div><div class="date">26th February 2007, 10:03</div></div><div class="posttext">I concluded that this problem was only happening in a single PC, there must be something wrong with the .NET libraries (the problem is that even with all the .NET versions unistalled the problem keeps happening...)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ts77</div><div class="date">1st March 2007, 12:20</div></div><div class="posttext">Is there a chance to use the &quot;chmod&quot; command if uploading with ftp?<br />
I'm building an installer for a webapp using this great plugin but I couldn't find a way to call chmod remotely :( (beside using a plain ftp-client ;)).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">empezar</div><div class="date">25th March 2007, 12:47</div></div><div class="posttext">InetLoad steals focus everytime it downloads a new file, even if I minimize the installer, it grabs the focus.<br />
<br />
Extremely annoying.<br />
<br />
Other than that, InetLoad has saved me :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">25th March 2007, 15:46</div></div><div class="posttext">ts77<br />
all is possible, only time is a problem :(<br />
<br />
empezar<br />
Looks like you are using very old InetLoad version.. This feature was removed more then year ago (sf() function). While some focus tricks still may present in NSISdl display mode. Try to use http://nsis.sourceforge.net/Inetc_plug-in<br />
You can also put more url/file pairs to stack and download all you need in 'single' InetLoad/Inetc session. /NOUNLOAD option in the command line may help as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">empezar</div><div class="date">25th March 2007, 16:08</div></div><div class="posttext">what's the difference between inetc and inetload?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">empezar</div><div class="date">26th March 2007, 18:15</div></div><div class="posttext">My installer is crashing all over the place with both this and inetc plugin.<br />
<br />
I'm downloading about 82 files using this macro:<br />
<br />
!macro DownloadDistfile PACKAGE<br />
  StrCpy $R0 ${PACKAGE}<br />
  ${Unless} ${FileExists} &quot;$DISTFILES_PATH\$R0&quot;<br />
    FileWrite $DISTLOG &quot;$R0$\r$\n&quot;<br />
    inetc::get &quot;$DISTFILES_URL/$R0&quot; &quot;$DISTFILES_PATH\$R0&quot;<br />
    Pop $0<br />
    ${Unless} $0 == &quot;OK&quot;<br />
      ${If} $0 == &quot;Cancelled&quot;<br />
        call .abortDownload<br />
      ${Else}<br />
        DetailPrint &quot;Error downloading: $R0&quot;<br />
      ${EndIf}<br />
    ${Else}<br />
      DetailPrint &quot;Successfully downloaded: $R0&quot;<br />
    ${EndUnless}<br />
  ${Else}<br />
    DetailPrint &quot;Skipping: $R0&quot;<br />
  ${EndUnless}<br />
!macroend<br />
<br />
and calling them all like this:<br />
<br />
!insertmacro DownloadDistfile package.zip<br />
<br />
in 82 different sections.<br />
<br />
this is the only code in each section, so this is all the code used from the start of the installer to the end, and it crashes after a while, not always during the same download!<br />
<br />
<br />
oh and by the way, that focus thing still bothers me. even with the inetc plugin.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">26th March 2007, 19:06</div></div><div class="posttext">I re-tested serial download of 3 12MB files<br />
SetDetailsView hide<br />
inetc::get &quot;http://localhost/IMG_0188.tif&quot; &quot;$EXEDIR\IMG_0188.tif&quot; /END<br />
Pop $0<br />
DetailPrint &quot;Downloading: $0&quot;<br />
inetc::get &quot;http://localhost/IMG_0189.tif&quot; &quot;$EXEDIR\IMG_0189.tif&quot; /END<br />
Pop $1<br />
DetailPrint &quot;Downloading: $1&quot;<br />
inetc::get &quot;http://localhost/IMG_0190.tif&quot; &quot;$EXEDIR\IMG_0190.tif&quot; /END<br />
Pop $2<br />
DetailPrint &quot;Downloading: $2&quot;<br />
MessageBox MB_OK &quot;Download Status: $0, $1, $2&quot;<br />
with minimized installer, all the time I had notepad opened and it never losed focus during download. So bothering<br />
problem not reproduces with my Apache.<br />
Crashes also not happened. I never tested 82 sections, this may be NSIS problem as well. Do you see any minimum sections number when the problem appear?<br />
Can you test your script with &quot;inetc::get /NOUNLOAD ... /END&quot;? this should decrease number of dll loads/unloads.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">empezar</div><div class="date">26th March 2007, 23:15</div></div><div class="posttext">thanks, that solved it!<br />
<br />
also, forget what I said about the focus thing - i was testing with an old installer :D my bad.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabiochelly</div><div class="date">27th March 2007, 22:22</div></div><div class="posttext">Hi,<br />
<br />
is it possible to add a function to list files in a ftp directory?<br />
<br />
In fact, I need to download the list of existing files (with their dates) in a specific FTP directory.<br />
After that, I will display this list to the user so he can choose what file he wants to download.<br />
<br />
Is it possible to add a new method InetLoad::list?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">empezar</div><div class="date">28th March 2007, 17:14</div></div><div class="posttext">is it possible to pause downloading? say if a user presses Cancel, I want to display &quot;Are you sure?&quot; and have the download PAUSE. if they then press NO, the download should resume. I've only succeeded in making the download re-download, but that is not very good when we're talking 100MB+ files :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">28th March 2007, 18:32</div></div><div class="posttext">Not in current version. BTW if plug-in loses connection it re-gets file from the current position, on permanent problems it displays customizable /resume message and also correctly continue download, but on Cancel (may be disabled) it even deletes local file.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>