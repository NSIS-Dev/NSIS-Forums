<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Usint Active Desktop Instances in NSIS, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Usint Active Desktop Instances in NSIS NSIS Discussion" />
	
	<title> Usint Active Desktop Instances in NSIS [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Usint Active Desktop Instances in NSIS</div>
<hr />
<div class="pda"><a href="t-318976.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318976">Usint Active Desktop Instances in NSIS</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">santana108</div><div class="date">6th May 2010, 10:14</div></div><div class="posttext">Maybe someone can help me with this.  In my installer, I need to use the Remote API to communicate with a Windows CE device.  To do this I need to create some class instances for the remote API.  There is some sample code for creating and using class instances on the NSIS wiki.  I have some questions about this code.  The code is given below:<br />
<br />
!define CLSCTX_INPROC_SERVER 1<br />
!define CLSID_ActiveDesktop {75048700-EF1F-11D0-9888-006097DEACF9}<br />
!define IID_IActiveDesktop {F490EB00-1240-11D1-9888-006097DEACF9}<br />
# create IActiveDesktop interface<br />
System::Call &quot;ole32::CoCreateInstance( \<br />
	g '${CLSID_ActiveDesktop}', p 0, \<br />
	i ${CLSCTX_INPROC_SERVER}, \<br />
	g '${IID_IActiveDesktop}', *p .r0) i.r1&quot;<br />
StrCmp $1 0 0 end<br />
# call IActiveDesktop-&gt;GetWallpaper<br />
System::Call &quot;$0-&gt;4(w .r2, i ${NSIS_MAX_STRLEN}, i 0)&quot;<br />
# call IActiveDesktop-&gt;Release<br />
System::Call &quot;$0-&gt;2()&quot;<br />
<br />
<br />
The first question that I have is where do the GUIDs CLSID_ActiveDesktop  and IID_IActiveDesktop  come from? <br />
<br />
The second question that I have is how to determine the methods in an active desktop instance.  The methods of the active desktop are being referenced by numbers.  How does one know what number is associated with what method?<br />
<br />
If I know the answers to these questions I will be able to use the RAPI2 interfaces for my install program.<br />
<br />
If anyone knows the answer to these questions a reply would be greatly appreciated.<br />
<br />
Thanks,<br />
<br />
Chris Lustig</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th May 2010, 10:57</div></div><div class="posttext">The class id is defined in the same library that defines e.g. ActiveDesktop/IActiveDesktop in shlobj.h/shell32.dll. As for the numbers, those are the methods in their order. Release is #2 because it is the 2nd method in IUnknown (which IActiveDesktop inherits). GetWallpaper is #4 because it is the 2nd method in IActiveDesktop.<br />
<br />
Edit: MSDN is your friend :)<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>