<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Custom Page refreshes slow, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Custom Page refreshes slow NSIS Discussion" />
	
	<title> Custom Page refreshes slow [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Custom Page refreshes slow</div>
<hr />
<div class="pda"><a href="t-257825.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257825">Custom Page refreshes slow</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">carlosfocker</div><div class="date">18th October 2006, 18:18</div></div><div class="posttext">I got an interesting one for you.  I am running a sql script that query's a record in a table located by default in the master database. I pop the response back to see if it was successful. This is used to verify that SQL is install and running. (This does work well for me but If anyone knows a better way to do this please inform). The sa password and sql server name is retrieved from the user using a custom page.  Once the user leaves that page the sql script is ran using a function called componentsLeave:<br />
<br />
-------------------------------------<br />
nsExec::ExecToStack &quot;$SYSDIR\cmd.exe /c osql.exe /c -U  $SqlUser -P $SqlPass -S $SQLSVR -i \ $PLUGINSDIR\SqlTest.sql&quot;<br />
<br />
Pop $0<br />
<br />
${If} $0 = 1<br />
<br />
MessageBox MB_OK &quot;Unable to connect to SQL Server. Please check the username and$\npassword, or \ verify that SQL Server is working properly.&quot;<br />
<br />
abort<br />
${EndIf}<br />
---------------------------------------------------<br />
<br />
The problem is that the page seems to freeze or become stuck for sometimes up to a minute. If the user clicks away from the installer and then clicks agian on the installer, the page refreshes faster.  Kind of weird. Any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">18th October 2006, 18:20</div></div><div class="posttext">Nope. You can display a banner though with the Banner plugin.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">carlosfocker</div><div class="date">18th October 2006, 20:30</div></div><div class="posttext">I tried MXSBanner but doesn't seem to work in a function.  When you destroy the banner it crashes the installer. EBanner seems to be for images(which i want to avoid using)and is for use in a section. Any suggestion on displaying a message(no buttons) in a the componentsLeave function thats run after the user clicks next.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">18th October 2006, 21:08</div></div><div class="posttext">The standard Banner plugin is included with NSIS.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">carlosfocker</div><div class="date">18th October 2006, 21:29</div></div><div class="posttext">your right, im srry. That documentation is hard to locate sometimes :). thank you</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>