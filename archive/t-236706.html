<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Test failure on debian sparc (big endian), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Test failure on debian sparc (big endian) NSIS Discussion" />
	
	<title> Test failure on debian sparc (big endian) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Test failure on debian sparc (big endian)</div>
<hr />
<div class="pda"><a href="t-236706.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=236706">Test failure on debian sparc (big endian)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">30th January 2006, 06:39</div></div><div class="posttext">http://experimental.ftbfs.de/fetch.php?&amp;pkg=nsis&amp;ver=2.14-2&amp;arch=sparc&amp;stamp=1138450073&amp;file=log&amp;as=rawg++ -o build/release/tests/endian.o -c Source/Tests/endian.cpp<br />
Source/Tests/endian.cpp:36:47: warning: no newline at end of file<br />
g++ -o build/release/tests/mmap.o -c Source/Tests/mmap.cpp<br />
g++ -o build/release/tests/specmatch.o -c Source/Tests/specmatch.cpp<br />
g++ -o build/release/tests/textrunner.o -c Source/Tests/textrunner.cpp<br />
Source/Tests/textrunner.cpp:22:2: warning: no newline at end of file<br />
g++ -o build/release/tests/required/dirreader.o -c Source/dirreader.cpp<br />
g++ -o build/release/tests/required/growbuf.o -c Source/growbuf.cpp<br />
g++ -o build/release/tests/required/mmap.o -c Source/mmap.cpp<br />
g++ -o build/release/tests/test build/release/tests/endian.o build/release/tests/mmap.o build/release/tests/specmatch.o build/release/tests/textrunner.o build/release/tests/required/dirreader.o build/release/tests/required/growbuf.o build/release/tests/required/mmap.o -ldl -lcppunit<br />
/build/buildd/nsis-2.14/build/release/tests/test<br />
..F..<br />
<br />
endian.cpp:31:Assertion<br />
Test name: EndianTest::testFixEndian<br />
equality assertion failed<br />
- Expected: 2018915346<br />
- Actual  : 305419896<br />
<br />
Failures !!!<br />
Run: 4   Failure total: 1   Failures: 1   Errors: 0...Install file: &quot;Source/exehead/uninst.ico&quot; as &quot;.test/Stubs/uninst&quot;<br />
Install file: &quot;build/release/stub_zlib/stub_zlib.exe&quot; as &quot;.test/Stubs/zlib&quot;<br />
Install file: &quot;build/release/stub_zlib_solid/stub_zlib.exe&quot; as &quot;.test/Stubs/zlib_solid&quot;<br />
Install file: &quot;Source/Tests/preprocessor.nsi&quot; as &quot;.test/Tests/preprocessor.nsi&quot;<br />
Install file: &quot;license.txt&quot; as &quot;.test/license.txt&quot;<br />
Install file: &quot;build/release/makensis/makensis&quot; as &quot;.test/makensis&quot;<br />
Install file: &quot;nsisconf.nsh&quot; as &quot;.test/nsisconf.nsh&quot;<br />
test_scripts([&quot;test-scripts.log&quot;], [&quot;.test&quot;])<br />
.test/makensis .test/Examples/FileFunc.nsi<br />
Error initalizing CEXEBuild: invalid default uninstall icon<br />
scons: *** [.test/Examples/FileFunc] Error 1<br />
.test/makensis .test/Examples/FileFuncTest.nsi<br />
Error initalizing CEXEBuild: invalid default uninstall icon<br />
scons: *** [.test/Examples/FileFuncTest] Error 1<br />
.test/makensis .test/Examples/Library.nsi<br />
Error initalizing CEXEBuild: invalid default uninstall icon<br />
scons: *** [.test/Examples/Library] Error 1...<br />
<br />
The first error is caused because -D__BIG_ENDIAN__ isn't passed to the compiler when compiling the tests. I'm not sure how to share results of the existing endianness test with the sconscript that builds and runs the tests.<br />
<br />
The second error is fairly weird, I guess it is caused by not byte-swapping results from fread in generate_uninstall_icon_data?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st January 2006, 18:05</div></div><div class="posttext">The first can be solved by possibly adding test_env in the configuration scripts (SCons/config) and setting -D__BIG_ENDIAN__ to it, just like makensis_env.<br />
<br />
The second is simply makensis not being endianity friendly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">1st February 2006, 06:02</div></div><div class="posttext">Committed a fix for the former problem, will try and get access to a big endian debian machine for the latter. I notice that there is a patch for partial big-endian support, any reason that isn't applied yet?<br />
<br />
http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1156354&amp;group_id=22049&amp;atid=373087</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">1st February 2006, 12:12</div></div><div class="posttext">Yep, this patch will not fix it all. I just takes a lot of work to get it working.<br />
<br />
I could do it on my Apple, but sadly there are so may other higher priority Opensource tasks I want to solve first.<br />
<br />
So feel free to pick it up but be prepared for a heavy adventure...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">2nd February 2006, 01:31</div></div><div class="posttext">What do you have installed on your apple? Perhaps I could get user level access to it if you install mingw/scons?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">2nd February 2006, 12:45</div></div><div class="posttext">Yes, I do have mingw, scons, pyton installed, and many other developemnt tools, but the machine is in and off regular basis.<br />
<br />
Better buy a secondhand sparcstation will not cost more then $50, e.g. 270 Mhz UltraSparc IIi even with 20&quot; screen.<br />
<br />
( Which I gladly pay for you if you will invest time getting endian problems solved and native NSIS build on Solaris, Linux, BSD based OS possible. )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pabs</div><div class="date">3rd February 2006, 02:30</div></div><div class="posttext">Hmm, shipping to Perth might cost more than the box itself.<br />
<br />
Anyways, I would be more than happy to receive a sparc box in exchange for porting NSIS to big endian machines. I can only do it where mingw is available though - I don't want to have to go futzing around with trying to make a cross-compiler - Linux and FreeBSD have that, dunno about Solaris.<br />
<br />
As an aside, I don't really care for Sun's attitude toward FOSS, and I'm not too enthusiastic about OpenSolaris hype and licencing, so I might just give Solaris a miss. Zealotry here I come!! :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd February 2006, 11:37</div></div><div class="posttext">That patch only fixes one problem in Plugins.cpp. There are many many more. The ones that don't cause a crash will create invalid installers. All of the installer structures are written as is from memory to file.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>