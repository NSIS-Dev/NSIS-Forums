<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Mui_page_drive, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Mui_page_drive NSIS Discussion" />
	
	<title> Mui_page_drive [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Mui_page_drive</div>
<hr />
<div class="pda"><a href="t-262165.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=262165">Mui_page_drive</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Boyito</div><div class="date">20th December 2006, 20:05</div></div><div class="posttext">Hello, its me again<br />
<br />
There is a way to use something like MUI_PAGE_DIRECTORY but not to select directories, I need to select the disc drive letter where im going to install ( something like I put in the subject of this post )?<br />
<br />
TIA</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">20th December 2006, 20:11</div></div><div class="posttext">Build a custom page with DirRequest. See InstallOptions manual (http://nsis.sourceforge.net/Docs/InstallOptions/Readme.html) and examine included InstallOptions examples.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">20th December 2006, 20:16</div></div><div class="posttext">you could simply customize the directory page.<br />
<br />
first, you'll need to do &quot;AllowRootDirInstall true&quot;, then you need to write a function:<br />
<br />
<br />
Function .onVerifyInstDir<br />
  IfFileExists $INSTDIR\*.* 0 invalid<br />
  StrLen $0 $INSTDIR<br />
  IntCmpU $0 3 0 0 invalid<br />
  Return<br />
  invalid:<br />
  Abort<br />
FunctionEnd<br />
<br />
<br />
this will make users to select valid drives only :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Boyito</div><div class="date">20th December 2006, 20:59</div></div><div class="posttext">Thanks RW &amp; Comm@nder21 <br />
<br />
I will try</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Boyito</div><div class="date">20th December 2006, 21:02</div></div><div class="posttext">Excellent Comm@nder21 <br />
Works like i need<br />
<br />
Thanks again</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">22nd December 2006, 15:21</div></div><div class="posttext">:) you're welcome!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">22nd December 2006, 21:27</div></div><div class="posttext">I didn't realise that you were talking about the standard directory page, sorry, I thought you're trying to achieve a custom directory request.<br />
For the standard directory page you don't need the .onVerifyInstDir function, because when you browse/type for a directory, the standard directory page automatically checks if the directory is valid and if there is enough disk space, and then enables the next/install button. It's not possible to proceed if you browse/type for an invalid/out of space directory. All you need is the &quot;allowrootdirinstall true&quot;, in order to install on the root of a valid drive.<br />
The .onVerifyInstDir function as described in NSIS manual (4.7.2.1.10 .onVerifyInstDir) is suitable for some special actions, e.g. if you want to verify that the selected directory contains some specific file(s). This means that the function does not verify the selected directory, instead at the time when users have browse/type a directory, the function verifies either the existence of a specific file or the entire directory.<br />
You may add the function of the following example to set the directory dialog pointing on target's system drive.<br />
outfile test.exe<br />
showinstdetails show<br />
allowrootdirinstall true<br />
<br />
!include WinMessages.nsh<br />
<br />
page directory &quot;&quot; dir_show<br />
page instfiles<br />
<br />
<br />
section<br />
SetOutPAth '$INSTDIR'<br />
file ; your file here<br />
file ; your file here<br />
SetOutPAth '$INSTDIR\Boo'<br />
File ; your file here<br />
sectionend<br />
<br />
Function dir_show<br />
ExpandEnvStrings $R0 '%SYSTEMDRIVE%'<br />
FindWindow $R1 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
GetDlgItem $R2 $R1 '1019'<br />
SendMessage $R2 ${WM_SETTEXT} 1 &quot;STR:$R0\&quot;<br />
FunctionEnd<br />
Happy Holidays!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">23rd December 2006, 16:02</div></div><div class="posttext">you did not understand what he wanted to achieve.<br />
<br />
he does not want to LET the user install the program on a partition root, but FORCE him to :)<br />
<br />
therefore you need .onVerifyInstDir<br />
<br />
and you're wrong. the function is named correctly, because in this function, you can define your own method of verifying if the user chose a correct/valid installation directory.<br />
this can happen by check for existing files, but also by checking for a special layout of the path, e.g. it would be possible to let the user install only to pathnames that include the character 'g' in it :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th December 2006, 01:11</div></div><div class="posttext">you did not understand what he wanted to achieve.<br />
<br />
he does not want to LET the user install the program on a partition root, but FORCE him to<br />
Ah! apologies...  that was very dumb of me. <br />
<br />
and you're wrong. the function is named correctly, because in this function, you can define your own method of verifying if the user chose a correct/valid installation directory.<br />
Even with my sad english...<br />
Did I mention something different up there?<br />
<br />
Happy Holidays!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th December 2006, 09:53</div></div><div class="posttext">The .onVerifyInstDir function as described in NSIS manual (4.7.2.1.10 .onVerifyInstDir) is suitable for some special actions, e.g. if you want to verify that the selected directory contains some specific file(s). This means that the function does not verify the selected directory, instead at the time when users have browse/type a directory, the function verifies either the existence of a specific file or the entire directory. <br />
Sorry... Wrong expression! instead -&gt; indeed.<br />
Again Happy Holidays</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">24th December 2006, 12:41</div></div><div class="posttext">This means that the function does not verify the selected directory, instead at the time when users have browse/type a directory,<br />
this is what iritated me :)<br />
<br />
but yes, merry christmas!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mtech</div><div class="date">28th February 2007, 15:23</div></div><div class="posttext">Hi,<br />
   I want a similar environment. The only difference is the User just selects the Hard-drive and that's it. he cant select any other directories only the root hard-drives..<br />
<br />
thanks</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>