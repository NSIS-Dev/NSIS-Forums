<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Conditional License Agreement Page based on Component Selection?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Conditional License Agreement Page based on Component Selection? NSIS Discussion" />
	
	<title> Conditional License Agreement Page based on Component Selection? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Conditional License Agreement Page based on Component Selection?</div>
<hr />
<div class="pda"><a href="t-291423.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291423">Conditional License Agreement Page based on Component Selection?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mrmagik</div><div class="date">7th May 2008, 17:44</div></div><div class="posttext">Just as the topic title asks,<br />
<br />
I'm sure it's possible, but I'm not sure how I would go about inserting a License Agreement Page (MUI) depending on whether or not a specific Component had been selected for installation.<br />
<br />
If you need further details, I'd be happy to provide. I've searched but all the answers and/or relevant examples a slightly off of what I'm looking for. I'm sorry if I missed anything that directly relates to this question. Please excuse my ignorance.<br />
<br />
Thanks in advance for any and all help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">7th May 2008, 20:56</div></div><div class="posttext">Do you show your license page after your components page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrmagik</div><div class="date">8th May 2008, 14:56</div></div><div class="posttext">Yes, that is what I want to do.<br />
<br />
If Component X is selected, show License page for Component X.<br />
If Component X is not selected, do now show License page for Component X.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">8th May 2008, 15:10</div></div><div class="posttext">I just tried it, this is possible:<br />
<br />
  !include &quot;MUI.nsh&quot;<br />
  !include &quot;LogicLib.nsh&quot;<br />
  Name &quot;Example&quot;<br />
  OutFile &quot;example.exe&quot;<br />
<br />
  !insertmacro MUI_PAGE_COMPONENTS<br />
  !define MUI_PAGE_CUSTOMFUNCTION_PRE SkipLicense<br />
  !insertmacro MUI_PAGE_LICENSE &quot;license.txt&quot;<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
Section &quot;test1&quot;<br />
SectionEnd<br />
<br />
Section &quot;test2&quot;<br />
SectionEnd<br />
<br />
Function SkipLicense<br />
  ${IfNot} ${SectionIsSelected} test1<br />
    abort  ;skip license if test1 was not enabled<br />
  ${EndIf}<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">8th May 2008, 15:29</div></div><div class="posttext">I think you will need 2 license pages.  This is what I would try, but I'm not sure declaring two license pages is supported.<br />
<br />
So if you have two different license pages and you want to show one or the other, then declare both pages, each with it's own pre function, and use the pre function to decide whether to show that license page or not.  If the logic is structured correctly then it will only show one of the two pages for any given scenario.<br />
<br />
Edit: I think I misunderstood.  for some reason I thought you had two different licenses.  My bad.  The example above with the pre function is probably what you want.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrmagik</div><div class="date">8th May 2008, 15:44</div></div><div class="posttext">That works for that example, but it doesn't seem to work when I try incorporating that into my current script. I have no idea why since it seems identical. I will post back here with updates as soon as I figure something out or reach a road block.<br />
<br />
Thanks for the reply.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrmagik</div><div class="date">8th May 2008, 15:48</div></div><div class="posttext">Originally posted by AaronLS <br />
I think you will need 2 license pages.  This is what I would try, but I'm not sure declaring two license pages is supported.<br />
<br />
So if you have two different license pages and you want to show one or the other, then declare both pages, each with it's own pre function, and use the pre function to decide whether to show that license page or not.  If the logic is structured correctly then it will only show one of the two pages for any given scenario.<br />
<br />
Edit: I think I misunderstood.  for some reason I thought you had two different licenses.  My bad.  The example above with the pre function is probably what you want.  <br />
<br />
I actually do have multiple license pages (3 to be exact). 2 are shown at the beginning (before component selection since their respective components are required for installation) and 1 post-component selection because it's respective component is not required for installation.<br />
<br />
This example code with multiple license pages works fine (adapted from MSG):<br />
<br />
<br />
  !include &quot;MUI.nsh&quot;<br />
  !include &quot;LogicLib.nsh&quot;<br />
  Name &quot;Example&quot;<br />
  OutFile &quot;example.exe&quot;<br />
<br />
  !insertmacro MUI_PAGE_LICENSE &quot;pre-license.txt&quot;<br />
  !insertmacro MUI_PAGE_COMPONENTS<br />
  !define MUI_PAGE_CUSTOMFUNCTION_PRE SkipLicense<br />
  !insertmacro MUI_PAGE_LICENSE &quot;license.txt&quot;<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
Section /o &quot;test one section&quot; SEC001<br />
    MessageBox MB_OK &quot;Test 1 Section&quot;<br />
SectionEnd<br />
<br />
Section &quot;test2&quot;<br />
SectionEnd<br />
<br />
Function SkipLicense<br />
  ${IfNot} ${SectionIsSelected} &quot;test one section&quot;<br />
    MessageBox MB_OK &quot;Test 1 Section SKIP&quot;<br />
    abort  ;skip license if test1 was not enabled<br />
  ${EndIf}<br />
FunctionEnd<br />
<br />
<br />
I put in some message boxes just to make sure I understood the flow.<br />
<br />
So, the example there works perfectly fine, however, when I implement that same logic in my script it does not seem to work at all. The 'conditional' license page still shows every time no matter the selection.<br />
<br />
Thanks for your help so far guys, hopefully I can get to the bottom of this soon...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrmagik</div><div class="date">8th May 2008, 16:19</div></div><div class="posttext">I'm really stumped here. The PRE function (SkipLicense) is being called correctly, but the If statement does not get evaluated.<br />
<br />
<br />
Function SkipLicense<br />
    MessageBox MB_OK &quot;Skip?&quot;<br />
    ${IfNot} ${SectionIsSelected} &quot;Section to Skip&quot;<br />
        MessageBox MB_OK &quot;Skipping!&quot;<br />
        Abort ;skip license if component not selected<br />
    ${EndIf}<br />
FunctionEnd<br />
<br />
<br />
The first message box shows up, but the second doesn't. It's having trouble evaluating if the SectionIsSelected for &quot;Section to Skip&quot; I guess. I'm not sure what else to do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrmagik</div><div class="date">8th May 2008, 16:30</div></div><div class="posttext">Aha!! Got it. You need to reference the section by the section ID inside variable braces like so:<br />
<br />
<br />
Function SkipLicense<br />
    MessageBox MB_OK &quot;SkipLicense Function Called&quot;<br />
    ${IfNot} ${SectionIsSelected} ${SEC001}<br />
        MessageBox MB_OK &quot;Skipping!&quot;<br />
        Abort ;skip license if component not selected<br />
    ${EndIf}<br />
FunctionEnd<br />
<br />
<br />
I guess that is necessary for when you have a large number of sections ? (I have about 15 or so)...<br />
<br />
Anyway, works well now, thanks!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>