<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Passing string parameter to a dll (a plugin actually), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Passing string parameter to a dll (a plugin actually) NSIS Discussion" />
	
	<title> Passing string parameter to a dll (a plugin actually) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Passing string parameter to a dll (a plugin actually)</div>
<hr />
<div class="pda"><a href="t-279871.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=279871">Passing string parameter to a dll (a plugin actually)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">giriraj</div><div class="date">24th October 2007, 13:51</div></div><div class="posttext">Hi .<br />
I am trying to pass a string argument to a dll(plugin) and  then trying to write the same to a text file.<br />
This is declaration in the header file of my dll<br />
<br />
DECLDIR void writeToFile(char *str);<br />
<br />
and following is the function definition in a cpp file.<br />
<br />
void __declspec(dllexport) writeToFile(TCHAR data[])<br />
{<br />
}<br />
When i run it through the nsi file ;i get &quot;An unhandled win32 exception in the application&quot;<br />
<br />
Kindly help me sort this out.<br />
This is quite urgent.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">24th October 2007, 14:29</div></div><div class="posttext">when you say plugin, do you mean NSIS plugin (if so, exported functions have a specific format, checkout the source for one of the plugins that ship with nsis)<br />
<br />
if not, you must use the system plugin, something like:<br />
system::call 'yourplugin::writeToFile(t &quot;foo&quot;)'<br />
<br />
(if your export is not stdcall(i would guess yours is cdecl), you must use the &quot;?c&quot; option (read the system readme))</div></div><hr />


<div class="post"><div class="posttop"><div class="username">giriraj</div><div class="date">24th October 2007, 14:35</div></div><div class="posttext">Anders,<br />
By dll i mean a sample NSIS plugin i created using Microsoft Visual C++ 2005.<br />
I am just not able to pass the string to the dll i created.<br />
Is there any way to access the string in my dll.<br />
i tried collecting the string into a char * variable,but it didn't work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th October 2007, 14:50</div></div><div class="posttext">When you say an NSIS plug-in, have you based it on exdll? You'd have to use popstring().<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">giriraj</div><div class="date">24th October 2007, 15:01</div></div><div class="posttext">i don't understand by &quot;based on exdll&quot;.<br />
sorry for being a novice.<br />
i made a dll using Microsoft Visual C++ 2005 dll creation wizard.<br />
It contains a .h file and a .cpp file in place.<br />
then i made a dll out of it.<br />
i am able to make function calls which does not involve passing of parameters.<br />
but i am not able to access a string that i pass to a LPWSTR variable or a char* variable.<br />
<br />
Regards,<br />
Giriraj</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">24th October 2007, 19:12</div></div><div class="posttext">To use dll as nsis plugins you need to get the exdll header and see the function creation protocal in order to use with nsis...Grab the nsis source code @ main page and look @ Contrib\exdll</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th October 2007, 20:49</div></div><div class="posttext">It's also available in Examples\Plugin when you install the NSIS package.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">giriraj</div><div class="date">30th October 2007, 13:19</div></div><div class="posttext">i had a look at the example in Examples\Plugin but i wasn't able to decipher it.<br />
i followed the process as explained in the sample project in Examples\Plugin.<br />
but i couldn't retrieve the parameter i passed.<br />
I mean isn't there a simple way to pass a string to a dll and retrieve it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th October 2007, 13:28</div></div><div class="posttext">Yes like I said, in NSIS use MyPlugin::Function &quot;hello&quot; then in the plug-in use:<br />
<br />
char *param = (char*)LocalAlloc(LPTR, string_size);<br />
popstring(param);<br />
...<br />
// param == &quot;hello&quot;<br />
LocalFree(param);<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>