<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Can I use NSIS  for this?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Can I use NSIS  for this? NSIS Discussion" />
	
	<title> Can I use NSIS  for this? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Can I use NSIS  for this?</div>
<hr />
<div class="pda"><a href="t-203554.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=203554">Can I use NSIS  for this?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">zhatka</div><div class="date">31st December 2004, 17:18</div></div><div class="posttext">I currently have a .bat file I use for an unistaller that simply unregisters some dlls, deletes some files, removes directories, then calls to an external .reg file to remove registry keys. It works, but it's ugly. <br />
<br />
I was wandering around online last night and stumbled upon NSIS. After spending some time in the documentation, examples, and this forum I was beginning to wonder if I could make an executable with NSIS that would perform these 'uninstall' steps.<br />
<br />
So I guess my question is:<br />
<br />
Can NSIS be used to just perform 'batch' functions like this?<br />
<br />
I just want to make sure I am in the ballpark before I begin studying up and trying to drive a nail with a screwdriver.<br />
<br />
Thanks!<br />
<br />
Z</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">31st December 2004, 19:24</div></div><div class="posttext">Yeah, you should be able to do everyting with NSIS, won't need that .reg file either.<br />
<br />
Right out of the Help file:<br />
<br />
4.9.3.14 UnRegDLL<br />
dllfile<br />
Loads the specified DLL and calls DllUnregisterServer. The error flag is set if an error occurs (i.e. it can't load the DLL, initialize OLE, find the entry point, or the function returned anything other than ERROR_SUCCESS (=0)).<br />
<br />
<br />
4.9.1.1 Delete<br />
[/REBOOTOK] file<br />
Delete file (which can be a file or wildcard, but should be specified with a full path) from the target system. If /REBOOTOK is specified and the file cannot be deleted then the file is deleted when the system reboots -- if the file will be deleted on a reboot, the reboot flag will be set. The error flag is set if files are found and cannot be deleted. The error flag is not set from trying to delete a file that does not exist.<br />
<br />
Delete $INSTDIR\somefile.dat<br />
<br />
<br />
<br />
4.9.1.8 RMDir<br />
[/r] [/REBOOTOK] directory_name<br />
Remove the specified directory (which should be a full path). Without /r, the directory will only be removed if it is completely empty. If /r is specified, the directory will be removed recursively, so all directories and files in the specified directory will be removed. If /REBOOTOK is specified, any file or directory which could not have been removed during the process will be removed on reboot -- if any file or directory will be removed on a reboot, the reboot flag will be set. The error flag is set if any file or directory cannot be removed.<br />
<br />
RMDir $INSTDIR<br />
RMDir $INSTDIR\data<br />
RMDir /r /REBOOTOK $INSTIDR<br />
RMDir /REBOOTOK $INSTDIR\DLLs<br />
<br />
<br />
<br />
4.9.2.3 DeleteRegKey<br />
[/ifempty] root_key subkey<br />
Deletes a registry key. If /ifempty is specified, the registry key will only be deleted if it has no subkeys (otherwise, the whole registry tree will be removed). Valid values for root_key are listed under WriteRegStr. The error flag is set if the key could not be removed from the registry (or if it didn't exist to begin with).<br />
<br />
DeleteRegKey HKLM &quot;Software\My Company\My Software&quot;<br />
DeleteRegKey /ifempty HKLM &quot;Software\A key that might have subkeys&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zhatka</div><div class="date">1st January 2005, 01:36</div></div><div class="posttext">I got all of the commands down. I think where I am having a hard time is with the actual uninstaller bit. From what I am reading, you have your installer, then the option to install an Uninstaller along with the install. <br />
<br />
Since I am simply executing an Uninstall routine, should I use the calls for the installer, but use all of the commands listed above to remove the components from the machine?<br />
<br />
I think what I am asking is:<br />
<br />
Should I just make a basic installer, but use commands that delete the necessary files, and then it finishes?<br />
<br />
thanks again....this NSIS is something else.<br />
<br />
(/me dives back into the books)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zhatka</div><div class="date">1st January 2005, 02:09</div></div><div class="posttext">After some thinking....<br />
<br />
Where would I be able to see the source (.nsi) for the uninstaller that is normally compiled with an installer?<br />
<br />
I am sure this would point me in the right direction. I am digging through the forums and manual now to see if I can find what I am looking for, but figured I would drop a hook here as well.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st January 2005, 13:49</div></div><div class="posttext">The uninstall code would go in:<br />
Section &quot;Uninstall&quot;<br />
...<br />
SectionEnd<br />
<br />
Though like you said, you can just make an installer to do the 'uninstall' routine.<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>