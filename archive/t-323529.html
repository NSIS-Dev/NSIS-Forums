<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Icon for a Start Menu item generated by CreateDirectory, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Icon for a Start Menu item generated by CreateDirectory NSIS Discussion" />
	
	<title> Icon for a Start Menu item generated by CreateDirectory [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Icon for a Start Menu item generated by CreateDirectory</div>
<hr />
<div class="pda"><a href="t-323529.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=323529">Icon for a Start Menu item generated by CreateDirectory</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Sooz24</div><div class="date">27th October 2010, 20:41</div></div><div class="posttext">I'm sure there is a simple answer to this...<br />
<br />
I have an install that creates the following entries in the Start Menu<br />
<br />
MyApp<br />
    Run MyApp<br />
    Uninstall MyApp<br />
<br />
Both Run MyApp and Uninstall MyApp correctly show their icons. The parent 'MyApp' does not.<br />
<br />
I'm using the following definition<br />
    CreateDirectory &quot;$SMPROGRAMS\$StartMenuFolder&quot;<br />
     CreateShortCut &quot;$SMPROGRAMS\$StartMenuFolder\MyApp.lnk&quot; &quot;$INSTDIR\System\MyApp.exe&quot; \<br />
	&quot; &quot; &quot;$INSTDIR\System\MyApp.ico&quot; &quot;&quot; SW_SHOWMINIMIZED<br />
    CreateShortCut &quot;$SMPROGRAMS\$StartMenuFolder\Uninstall MyApp.lnk&quot; &quot;$INSTDIR\Uninstall.exe&quot; \<br />
	&quot; &quot; &quot;$INSTDIR\System\MyApp.ico&quot; &quot;&quot;<br />
<br />
How do I specify the missing icon?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th October 2010, 20:50</div></div><div class="posttext">Since when did start menu folders have program specific icons (by default)?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">27th October 2010, 21:51</div></div><div class="posttext">It is possible by placing a desktop.ini file in your folder. Give the file the attributes &quot;hidden&quot; and &quot;system&quot;.<br />
Inside desktop.ini, write the following: (with your NSIS script, so you can use the $INSTDIR)<br />
[.ShellClassInfo]<br />
IconResource=C:\YourPath\MyProgram.exe,0<br />
<br />
(you can use an EXE, DLL or ICO file. See also http://msdn.microsoft.com/en-us/library/cc144102%28VS.85%29.aspx) <br />
<br />
Apparently, you must also set the attribute &quot;Read-only&quot; on your folder. (only, not on the files inside)<br />
<br />
And please make sure your custom folder icon still looks like a folder, otherwise the user would feel strange..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">28th October 2010, 00:59</div></div><div class="posttext">I think the attributes you need to set can vary (IIRC there is a registry setting for it) and the page you link to tells you which documented function to call (Or just set system and read-only to be on the safe side)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jiake</div><div class="date">28th October 2010, 13:23</div></div><div class="posttext">Maybe he said that one of the shortcuts created in start menu folder by his installer doesn't have an icon, that likes an executable file without any icon resource. He wants to show the icon he set in script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">31st October 2010, 08:14</div></div><div class="posttext">Making Icons for folders is a nice thing especially in a corporate environment. This way users can distinguish between start menu entries provided by IT department from the rest.<br />
<br />
I ues this construct fairly often, it even works with limited user rights:<br />
<br />
<br />
!define PathMakeSystemFolder &quot;!insertmacro PATH_MAKE_SYSTEM_FOLDER&quot;<br />
!macro PATH_MAKE_SYSTEM_FOLDER pszPath<br />
    System::Call    &quot;shlwapi::PathMakeSystemFolder(t '${pszPath}') i.&quot;<br />
!macroend<br />
<br />
Section &quot;Make Shortcuts&quot;<br />
  WriteINIStr &quot;$SMPROGRAMS\Some Folder\Desktop.ini&quot; &quot;.ShellClassInfo&quot; &quot;IconFile&quot; &quot;$SYSDIR\shell32.dll&quot;<br />
  WriteINIStr &quot;$SMPROGRAMS\Some Folder\Desktop.ini&quot; &quot;.ShellClassInfo&quot; &quot;IconIndex&quot; &quot;188&quot;<br />
  ${PathMakeSystemFolder} &quot;$SMPROGRAMS\Some Folder&quot;<br />
SectionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>