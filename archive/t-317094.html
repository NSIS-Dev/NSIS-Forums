<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Order of Start Menu Shortcuts, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Order of Start Menu Shortcuts NSIS Discussion" />
	
	<title> Order of Start Menu Shortcuts [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Order of Start Menu Shortcuts</div>
<hr />
<div class="pda"><a href="t-317094.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=317094">Order of Start Menu Shortcuts</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ignacioalex</div><div class="date">17th February 2010, 22:09</div></div><div class="posttext">Hi all,<br />
<br />
I'd like to configure the order of the shortcuts created in my application's group in the start menu, since Windows is placing them in alphabetical order instead of following the order defined in my script.<br />
<br />
I followed the instructions in this post:<br />
<br />
http://forums.shoutcast.com/showthread.php?postid=2239145<br />
<br />
which instructs to write a binary value to the registry:<br />
WriteRegBin HKCU &quot;Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder\Start Menu\Programs\XYZ&quot; &quot;Order&quot; 00890888003.....<br />
<br />
However this does not fully solve my problem, as I would like to configure the menu order for all users of the machine. Simply writing to the HKLM instead of HKCU does not work as expected, so it seems that Windows does not check this key. Is there any other key I could write to that would affect all users of the machine?<br />
<br />
I also had to make a slight modification to make it work: in my case the correct key is ...\Start Menu2\... instead of ...\Start Menu\... . How confident should I be that this will work accross all Windows versions? :igor:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">17th February 2010, 22:17</div></div><div class="posttext">You need enumusersreg.nsh.<br />
<br />
As for Start Menu2... No idea there. Tried google?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">18th February 2010, 00:03</div></div><div class="posttext">I'm guessing &quot;Start Menu&quot; is the 2000 style start menu (hidden items) and &quot;Start Menu2&quot; is the XP style</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ignacioalex</div><div class="date">18th February 2010, 18:09</div></div><div class="posttext">I've successfully used EnumRegUsers.nsh to implement the start menu ordering for all users of the machine. It's still not yet a complete solution, as user accounts created after the application installation won't be affected. Anyway that's a big improvement over the previous solution, as now only such user accounts will have their start menu items messed up. Perhaps we can't completely fix this issue if Windows doesn't check for any key in HKLM.<br />
<br />
I had to make a few minor changes to EnumRegUsers.nsh in order to allow using it from uninstaller sections. Maybe these should be useful to others, so I commited them to the wiki page.<br />
<br />
You are right about the ...\Start Menu2\... key: ...\Start Menu\... configures the order of start menu items in classic menus, whereas ...\Start Menu2\... configures the order in modern menus.<br />
<br />
Thank you very much for your comments.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>