<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Registry substring search, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Registry substring search NSIS Discussion" />
	
	<title> Registry substring search [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Registry substring search</div>
<hr />
<div class="pda"><a href="t-248109.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=248109">Registry substring search</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">JoeMcC00L</div><div class="date">7th June 2006, 21:19</div></div><div class="posttext">Hello,<br />
<br />
I'm using the Registry plugin to search for installed items in HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall. Here is the algorithm:<br />
<br />
<br />
        ${registry::Open} &quot;HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall&quot; &quot;/K=0 /V=0 /S=1 /B=1 /N='Apache HTTP Server 1.3.33'&quot; $HANDLE<br />
        ${registry::Find} &quot;$HANDLE&quot; $PATH $VALUE $STRING $TYPE<br />
        ${If} $TYPE == &quot;&quot;<br />
            MessageBox MB_OK &quot;Status: Apache HTTP Server 1.3.33 was not found!&quot;<br />
        ${Else}<br />
            MessageBox MB_OK &quot;Status: Apache HTTP Server 1.3.33 was found! $\n \<br />
                              $$PATH = $PATH $\n \<br />
                              $$VALUE = $VALUE $\n \<br />
                              $$STRING = $STRING $\n \<br />
                              $$TYPE = $TYPE&quot;<br />
        ${EndIf}<br />
        ${registry::Close} &quot;$HANDLE&quot;<br />
<br />
<br />
I would just use the key name, except in this case it's assigned to the GUID.<br />
<br />
The algorithm works to find the Apache server, but I want to implement functionality to find any version of Apache. This is to determine if the software version that's installed is supported by my software. If not, I will prompt them to upgrade (which should be trivial). Is there a way to search for substrings in the registry, i.e., search for the string &quot;Apache&quot;?<br />
<br />
Thanks,<br />
Joe<br />
<br />
EDIT:<br />
:: Embarassed :: My apologies... as soon as I posted this I figured out a possible solution. Here's the algorithm:<br />
<br />
<br />
        ${registry::Open} &quot;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall&quot; &quot;/K=0 /V=1 /S=0 /B=1 /N='DisplayName'&quot; $HANDLE<br />
        ${Do}<br />
            ${registry::Find} &quot;$HANDLE&quot; $PATH $VALUE $STRING $TYPE<br />
            StrCpy $R0 $STRING 6<br />
            ${If} $R0 == &quot;Apache&quot;<br />
                MessageBox MB_OK &quot;Status: Apache is installed!&quot;<br />
                ${ExitDo}<br />
            ${EndIf}<br />
        ${LoopUntil} $TYPE == &quot;&quot;<br />
        ${If} $TYPE == &quot;&quot;<br />
             MessageBox MB_OK &quot;Status: Apache is not installed!&quot;<br />
             call InstallApache<br />
        ${Endif}<br />
<br />
<br />
This is kind of a pain, and it's not the most efficient algorithm. If any of you can think of something quicker, let me know.<br />
<br />
Thanks again,<br />
Joe</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>