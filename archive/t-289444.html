<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait don't wait ? Can't lunch 2.exe :(, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait don't wait ? Can't lunch 2.exe :( NSIS Discussion" />
	
	<title> ExecWait don't wait ? Can't lunch 2.exe :( [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait don't wait ? Can't lunch 2.exe :(</div>
<hr />
<div class="pda"><a href="t-289444.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289444">ExecWait don't wait ? Can't lunch 2.exe :(</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">DraGula0</div><div class="date">1st April 2008, 14:15</div></div><div class="posttext">Hello,<br />
<br />
I am a newbie in NSIS, and I acknowledge that I do not understand my error.<br />
Especially how my script is really simple!!<br />
I will try to explain me with my English of 3 year old child.<br />
<br />
It is broken up into 3 files NSI. (Thus 3.exe)<br />
<br />
&gt; The first (1.nsi), allows to uninstall an application, write a key of register (to launch the 2nd .exe): Function well!<br />
&gt; The second (2.nsi) start on Windows logon. An installation is carried out (functions well!) and with the end (3.nsi), the achievable last would have started. But it is not the case!<br />
<br />
PS: If ever I launch my 3rd file .exe (3.nsi)  the functions included in script functions well. I do not include/understand why it cannot be launched by my second scriptâ€¦<br />
<br />
I hope to be sufficiently clearâ€¦<br />
<br />
Here my 3 small script in attached file.<br />
1.nsi<br />
2.nsi<br />
3.nsi<br />
<br />
Thank for your help !!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">1st April 2008, 18:04</div></div><div class="posttext">Where in your script did you create BEW.exe?<br />
<br />
In 2.nsi you have this:<br />
Section &quot;Global-package&quot;<br />
<br />
  SetOutPath &quot;$TEMP&quot;<br />
<br />
  #Install BE + RÃ©cupÃ©ration data<br />
  ExecWait '&quot;$TEMP\BEW.exe&quot; /q /cfg:&quot;last.eac&quot; /t /l:us' $0<br />
  DetailPrint &quot;Erreurs $0&quot;<br />
  ExecWait '&quot;$TEMP\test.exe&quot;'<br />
<br />
SectionEnd<br />
Where does BEW.exe come from?  Don't you need to extract it first? :<br />
Section &quot;Global-package&quot;<br />
<br />
  SetOutPath &quot;$TEMP&quot;<br />
  File &quot;Installers\BEW.exe&quot;<br />
<br />
  #Install BE + RÃ©cupÃ©ration data<br />
  ExecWait '&quot;$TEMP\BEW.exe&quot; /q /cfg:&quot;last.eac&quot; /t /l:us' $0<br />
  DetailPrint &quot;Erreurs $0&quot;<br />
  ExecWait '&quot;$TEMP\test.exe&quot;'<br />
<br />
SectionEnd<br />
Or better yet, to avoid filename conflicts and problems due to locked files, I use GetTempFileName like this:<br />
Section &quot;Global-package&quot;<br />
<br />
  SetOutPath &quot;$TEMP&quot;<br />
  <br />
  Var /GLOBAL _1_BewExe<br />
  GetTempFileName $_1_BewExe<br />
  File /oname=$_1_BewExe &quot;Installers\BEW.exe&quot;    <br />
  <br />
  #Install BE + RÃ©cupÃ©ration data<br />
  ExecWait '&quot;$_1_BewExe&quot; /q /cfg:&quot;last.eac&quot; /t /l:us' $0<br />
  DetailPrint &quot;Erreurs $0&quot;<br />
  ExecWait '&quot;$TEMP\test.exe&quot;'<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DraGula0</div><div class="date">3rd April 2008, 10:02</div></div><div class="posttext">Thank for your feedback,<br />
<br />
In fact, BEW.exe is an external executable.<br />
2.nsi is launch by 1.nsi -&gt; Theses actions is functional<br />
<br />
But 3.nsi (test.exe) donâ€™t start automatically. If I launch manually test.exe, actions are successful.<br />
I donâ€™t understand why my â€œ2.nsiâ€ canâ€™t start this executable (ExecWait '&quot;$TEMP\test.exe&quot;')<br />
<br />
Strange, no ? :p</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ttworc</div><div class="date">3rd April 2008, 15:08</div></div><div class="posttext">Originally posted by DraGula0 <br />
Hello,<br />
<br />
I am a newbie in NSIS, and I acknowledge that I do not understand my error.<br />
Especially how my script is really simple!!<br />
I will try to explain me with my English of 3 year old child.<br />
<br />
It is broken up into 3 files NSI. (Thus 3.exe)<br />
<br />
&gt; The first (1.nsi), allows to uninstall an application, write a key of register (to launch the 2nd .exe): Function well!<br />
&gt; The second (2.nsi) start on Windows logon. An installation is carried out (functions well!) and with the end (3.nsi), the achievable last would have started. But it is not the case!<br />
<br />
PS: If ever I launch my 3rd file .exe (3.nsi)  the functions included in script functions well. I do not include/understand why it cannot be launched by my second scriptâ€¦<br />
<br />
I hope to be sufficiently clearâ€¦<br />
<br />
Here my 3 small script in attached file.<br />
1.nsi<br />
2.nsi<br />
3.nsi<br />
<br />
Thank for your help !!!  <br />
<br />
i wrote a this header that would allow build multiple script in one... you can exec any single section by command line. the parameter refer to section name.<br />
this needed &quot;NSISArray&quot; to complie</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">3rd April 2008, 15:18</div></div><div class="posttext">In fact, BEW.exe is an external executable. <br />
<br />
I understand it's external.  My point is, are you sure it even exists in $TEMP at runtime.  Because $TEMP is a variable, I wouldn't just assume that it is C:\Windows\Temp.  $TEMP might be Docs&amp;Settings\Local Data\Temp or something like that.<br />
<br />
This is why I feel strongly that if you want to be absolutely sure BEW.exe or test.exe exists at runtime in the expected location, then you should just use the File isntruction to extract them as I did in my example.  Or at the very least use FileExists to verify it exists before trying to run.<br />
<br />
You could do this for testing:<br />
<br />
!include &quot;LogicLib.nsh&quot;<br />
<br />
${If} ${FileExists} &quot;$TEMP\test.exe&quot;<br />
  MessageBox MB_OK &quot;test.exe found&quot;<br />
${Else}<br />
  MessageBox MB_OK &quot;test.exe NOT found&quot;<br />
${EndIf}<br />
<br />
If you get the second message, then the file doesn't even exist at that path, which would be why ExecWait fails.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DraGula0</div><div class="date">4th April 2008, 16:58</div></div><div class="posttext">Hi !<br />
<br />
AaronLS, I've add your code for testing :<br />
<br />
Result : test.exe found <br />
<br />
Good ! But test.exe is not executed :weird:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DraGula0</div><div class="date">4th April 2008, 17:17</div></div><div class="posttext">ttworc &gt; I will try your script soon, thank for your help :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">4th April 2008, 18:43</div></div><div class="posttext">If you don't have any luck with that, here's one other diagnostic, checking to see if NSIS detected an error.  Use ClearErrors just before to ensure flag is cleared, and then check errors right  after:<br />
Section &quot;Global-package&quot;<br />
<br />
  SetOutPath &quot;$TEMP&quot;<br />
<br />
  #Install BE + RÃ©cupÃ©ration data<br />
  ExecWait '&quot;$TEMP\BEW.exe&quot; /q /cfg:&quot;last.eac&quot; /t /l:us' $0<br />
  DetailPrint &quot;Erreurs $0&quot;<br />
  ClearErrors<br />
  ExecWait '&quot;$TEMP\test.exe&quot;'<br />
  ${If} ${Errors}<br />
    DetailPrint &quot;Error executing test.exe&quot;<br />
  ${EndIf}<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DraGula0</div><div class="date">7th April 2008, 09:08</div></div><div class="posttext">AaronLS,<br />
<br />
Yes, I'm not lucky...<br />
<br />
I have add your modification in &quot;2.nsi&quot;. <br />
There is no message on screen, and no executing of test.exe.<br />
<br />
And... If I launch test.exe manually, result is good.<br />
<br />
<br />
I'm desperate !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DraGula0</div><div class="date">16th April 2008, 12:10</div></div><div class="posttext">No id ? :-(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th April 2008, 23:10</div></div><div class="posttext">If test.exe is silent, how can you be sure it really isn't executed? It looks like test.exe is trying to copy over some additional files into what BEW.exe creates. If ExecWait doesn't really wait for BEW.exe because it's a special installer, the directory where test.exe should write its files doesn't exist and so it fails.<br />
<br />
BTW, you can use $SYSDIR instead of C:\Windows\system32 and C:\WinNT\system32.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>