<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Need Help Reading Registry, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Need Help Reading Registry NSIS Discussion" />
	
	<title> Need Help Reading Registry [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Need Help Reading Registry</div>
<hr />
<div class="pda"><a href="t-265470.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=265470">Need Help Reading Registry</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">wogman75</div><div class="date">9th February 2007, 17:25</div></div><div class="posttext">I am new to NSIS but things been going pretty smooth up until I been trying to read the registry. I tried the built in method ReadRegStr and the Registry.nsh plugin method but keep getting null. Its got to be something simple. I am able to write to the registry fine, but when I try to read I get null. Here is a sample I tried.<br />
<br />
!include Registry.nsh<br />
        ${registry::Read} &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader\7.0&quot; &quot;InstallPath&quot; $0 $1<br />
<br />
Messagebox MB_OK $0<br />
Messagebox MB_OK $1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th February 2007, 17:30</div></div><div class="posttext">try this,<br />
ReadRegStr $0 HKLM &quot;Software\NSIS&quot; &quot;&quot;<br />
Messagebox MB_OK &quot;$0&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wogman75</div><div class="date">9th February 2007, 17:34</div></div><div class="posttext">That works, So what am I doing wrong.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th February 2007, 17:40</div></div><div class="posttext">Try to change this,<br />
&quot;HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader\7.0&quot; &quot;InstallPath&quot;<br />
<br />
With this,<br />
HKEY_LOCAL_MACHINE &quot;SOFTWARE\Adobe\Acrobat Reader\7.0&quot; &quot;InstallPath&quot;<br />
<br />
or,<br />
HKLM &quot;SOFTWARE\Adobe\Acrobat Reader\7.0&quot; &quot;InstallPath&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wogman75</div><div class="date">9th February 2007, 17:46</div></div><div class="posttext">I tried both and that doesn't work. It seems like anything more than the basic bellow won't work.<br />
<br />
ReadRegStr $0 HKLM &quot;Software\NSIS&quot; &quot;&quot;<br />
Messagebox MB_OK &quot;$0&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th February 2007, 17:50</div></div><div class="posttext">provided that Acrobat is installed on your system and the registry record you're trying to read exists and there isn't any typo, this is the code,<br />
<br />
ReadRegStr $0 HKLM &quot;SOFTWARE\Adobe\Acrobat Reader\7.0&quot; &quot;InstallPath&quot;<br />
Messagebox MB_OK &quot;$0&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wogman75</div><div class="date">9th February 2007, 18:03</div></div><div class="posttext">I figured I was doing everything right. If you have adobe installed try this. I wonder if its just my PC or is something buggy.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th February 2007, 18:11</div></div><div class="posttext">Unfortunately there isn't acrobat in my system, I'm satisfied with Foxit reader :)<br />
Anyway you might want to check this example<br />
WriteRegStr HKCU &quot;Software\My Application&quot; &quot;InstallPath&quot; &quot;Hey my application install path should be here&quot;<br />
ClearErrors<br />
ReadRegStr $0 HKCU &quot;Software\My Application&quot; &quot;InstallPath&quot;<br />
IfErrors +2<br />
MessageBox MB_OK &quot;$0&quot; IDOK next<br />
MessageBox MB_OK &quot;Error no such registry record&quot;<br />
next:<br />
ClearErrors<br />
ReadRegStr $0 HKEY_LOCAL_MACHINE &quot;SOFTWARE\Adobe\Acrobat Reader\7.0&quot; &quot;InstallPath&quot;<br />
IfErrors +2<br />
MessageBox MB_OK &quot;$0&quot; IDOK end<br />
MessageBox MB_OK &quot;Error no such registry record&quot;<br />
end:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wogman75</div><div class="date">9th February 2007, 18:40</div></div><div class="posttext">The First Read works the second one doesn't. I thought it was the &quot;.&quot; period, but I tried some simple examples that have periods that work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th February 2007, 18:56</div></div><div class="posttext">There is not problem with periods, should be a typo, no other explanation.<br />
Looking in my registry (I have Audition installed) it is,<br />
HKLM &quot;SOFTWARE\Adobe\Audition\2.0&quot; &quot;ApplicationPath&quot;<br />
Maybe it is also &quot;ApplicationPath&quot; for Acrobat and not &quot;InstallPath&quot;?<br />
<br />
Talking about managing registry, a couple of weeks ago I've posted some examples to help a user, you might find them useful as well.<br />
<br />
http://forums.winamp.com/attachment.php?s=&amp;postid=2087784</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wogman75</div><div class="date">9th February 2007, 19:08</div></div><div class="posttext">Hmmm, I copied the Key right out of the registry so I don't see how it could be a typo. Here it is from an export.<br />
<br />
Windows Registry Editor Version 5.00<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader\7.0\InstallPath]<br />
@=&quot;C:\\Program Files\\Adobe\\Acrobat 7.0\\Reader&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th February 2007, 19:13</div></div><div class="posttext">Now we got it, here it is<br />
ReadRegStr $0 HKLM &quot;SOFTWARE\Adobe\Acrobat Reader\7.0\InstallPath&quot; &quot;&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wogman75</div><div class="date">9th February 2007, 19:24</div></div><div class="posttext">Ok, that worked. <br />
<br />
Now Help me do understand the difference. When do you uses pass the third parm and when do you include it in the second parm?<br />
<br />
Thanks for all your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th February 2007, 19:36</div></div><div class="posttext">I shaw it in the regedit export.<br />
InstallPath isn't a value name, it is a key and the value data is added to (default) @=(default).<br />
<br />
When we read from registry within NSIS we need to quote all the keys sequence e.g &quot;SOFTWARE\Adobe\Acrobat Reader\7.0\InstallPath&quot; then quote the value name which contains the value data we want to read. When there isn't value name -this is the (default)- then we add empty quotes.<br />
<br />
The same goes when we want to write data to (default).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>