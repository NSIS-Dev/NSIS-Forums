<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" UAC plugin, return value from process, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  UAC plugin, return value from process NSIS Discussion" />
	
	<title> UAC plugin, return value from process [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  UAC plugin, return value from process</div>
<hr />
<div class="pda"><a href="t-329850.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=329850">UAC plugin, return value from process</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">darasan</div><div class="date">20th April 2011, 11:11</div></div><div class="posttext">Hi,<br />
<br />
I searched the forums about this but couldnt find any information.<br />
<br />
I am using the UAC plugin with my NSIS script.<br />
To install the Visual Studio 2010 Redistributable, I call this function:<br />
<br />
!insertmacro UAC_AsUser_ExecShell &quot;&quot; &quot;vcredist_x86.exe&quot; &quot;&quot; &quot;&quot; &quot;&quot;<br />
<br />
I want to be able to check the return value of this exe. I looked at the macro itself and it<br />
calls ExecShell, but I want it to call ExecWait instead and return the value to my script.<br />
I tried to modify it to do this, but I can't get it to work.<br />
<br />
Has anybody tried this before?<br />
<br />
Thanks,<br />
<br />
Daire</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">20th April 2011, 17:34</div></div><div class="posttext">Try making a function that execwaits, and call that function as user. (Note that variables like $TEMP might be different between the inner and outer processes.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">20th April 2011, 19:07</div></div><div class="posttext">Um, don't you have to be admin to run vcredist_x86.exe?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">20th April 2011, 21:02</div></div><div class="posttext">Hahaha, good point, that. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">darasan</div><div class="date">27th April 2011, 10:55</div></div><div class="posttext">Hi, thanks for your replies.<br />
<br />
Try making a function that execwaits, and call that function as user. (Note that variables like $TEMP might be different between the inner and outer processes.) <br />
<br />
So you mean to just call a function, containing an ExecWait command, in the usual NSIS way? Not using any of the UAC plug-in macros? Doesn't this defeat the purpose of using the plug-in?<br />
<br />
And if I need to be admin to install the vcredist package, what command should I use?<br />
I can only see a macro for UAC_AsUser_ExecShell...<br />
<br />
Sorry for my lack of understanding, I can't find any documentation on this?<br />
Many thanks for your help!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">27th April 2011, 12:01</div></div><div class="posttext">The UAC plugin is not for running things as admin. Use http://pastebin.com/EvMkyLLt</div></div><hr />


<div class="post"><div class="posttop"><div class="username">darasan</div><div class="date">28th April 2011, 11:09</div></div><div class="posttext">OK, so I've misunderstood the purpose of this plugin.<br />
The main page description says:<br />
<br />
&quot;For example, you can have an admin level installer launch another process at a user level. Or you can have an admin level installer create shortcuts at a user level.&quot;<br />
<br />
Why would I want to do this? Why not run everything at the admin level (using RequestExecutionLevel admin), when installing?<br />
<br />
Would that make un-installing more difficult? Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">28th April 2011, 11:24</div></div><div class="posttext">First off, I did not write the wiki page so I can't really comment on its content.<br />
<br />
The only real purpose of the UAC plugin is to handle the run checkbox on the finish page. People use it for other things, and yes, it makes it harder to uninstall if you do that...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>