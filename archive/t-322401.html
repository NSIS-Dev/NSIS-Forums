<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MUI_HWND not recognised, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MUI_HWND not recognised NSIS Discussion" />
	
	<title> MUI_HWND not recognised [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MUI_HWND not recognised</div>
<hr />
<div class="pda"><a href="t-322401.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322401">MUI_HWND not recognised</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">JohaViss</div><div class="date">14th September 2010, 15:34</div></div><div class="posttext">Hello,<br />
<br />
I am trying to hide the 'RUN' checkbox on the finishpage on a condition.<br />
<br />
Using the following function:<br />
<br />
Function HideCheckbox<br />
  ${If} $InstallationChoice == &quot;deinstall&quot;<br />
      GetDlgItem $R9 $MUI_HWND &quot;1203&quot;  <br />
      ShowWindow $R9 ${SW_HIDE}<br />
  ${EndIf}<br />
FunctionEnd<br />
<br />
Defined like this:<br />
  !define MUI_PAGE_CUSTOMFUNCTION_SHOW                HideCheckbox<br />
But, the compiler give me a warning:<br />
  unknown variable/constant &quot;MUI_HWND&quot; detected, ignoring (installatie_keuze.nsh:63)<br />
<br />
And the function doesn't work.<br />
The function is called and the condition is true, but $R9 is always 0<br />
<br />
Am I missing something?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th September 2010, 15:42</div></div><div class="posttext">If you're using MUI2 there's no longer a MUI_HWND variable. Instead you want $mui.FinishPage (or for the check boxes; $mui.FinishPage.Run or $mui.FinishPage.ShowReadme).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JohaViss</div><div class="date">14th September 2010, 15:53</div></div><div class="posttext">I am using MUI 1<br />
<br />
!include &quot;MUI.nsh&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th September 2010, 16:16</div></div><div class="posttext">Switch to MUI2?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JohaViss</div><div class="date">15th September 2010, 08:49</div></div><div class="posttext">Same problem.<br />
<br />
Johan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th September 2010, 10:39</div></div><div class="posttext">In which case you must be using the variables before they are defined in the script.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JohaViss</div><div class="date">15th September 2010, 10:56</div></div><div class="posttext">I don't think so.<br />
<br />
I include the NSIS .nsh files before I include my own .nsh files.<br />
<br />
The function 'HideCheckbox' is in a seperate .nsh file that's included after the MUI.nsh<br />
<br />
I don't have to define the $MUI_HWND variable in my script?<br />
<br />
Johan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th September 2010, 11:03</div></div><div class="posttext">The MUI_HWND variable is defined when you !insertmacro MUI_PAGE_WELCOME or !insertmacro MUI_PAGE_FINISH. You cannot reference it before. And seriously, unless you are using InstallOptions in your installer, you should switch to MUI2. It uses nsDialogs for its custom pages which is a lot faster than InstallOptions (and has less overhead).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JohaViss</div><div class="date">15th September 2010, 12:34</div></div><div class="posttext">Switched to MUI2.<br />
<br />
Changed $MUI_HWND  to $mui.FinishPage.Run<br />
<br />
Getting warning:<br />
  unknown variable/constant &quot;mui.FinishPage.Run&quot; detected, ignoring (installatie_functies.nsh:89)<br />
<br />
<br />
Order of includes and pages:<br />
  <br />
....<br />
!define MUI_LANGDLL_REGISTRY_ROOT                   &quot;${PRODUCT_UNINST_ROOT_KEY}&quot;<br />
  !define MUI_LANGDLL_REGISTRY_VALUENAME              &quot;NSIS:Language&quot;<br />
  !define MUI_FINISHPAGE_TITLE_3LINES                                           <br />
  !insertmacro MUI_PAGE_WELCOME<br />
<br />
; License page<br />
  !define MUI_LICENSEPAGE_CHECKBOX                                             <br />
  !insertmacro MUI_PAGE_LICENSE ${LICENCEFILE}                              <br />
;--------------------------------------------------------------------------------------------------<br />
<br />
; custom pages<br />
  Page custom InstallChoiceInit                InstallChoiceValidate<br />
  Page custom InstallTypeInit                  InstalTypeValidate<br />
 .... More pages <br />
<br />
<br />
; Finish page<br />
  !define MUI_FINISHPAGE_RUN                          <br />
  !define MUI_FINISHPAGE_RUN_TEXT                     &quot;Start MyApp&quot;<br />
  !define MUI_FINISHPAGE_RUN_FUNCTION                 RunApplication<br />
  <br />
  !define MUI_FINISHPAGE_SHOWREADME                   <br />
  !define MUI_FINISHPAGE_SHOWREADME_TEXT              &quot;View Log&quot;<br />
  !define MUI_FINISHPAGE_SHOWREADME_FUNCTION          ShowLogFile <br />
  !define MUI_PAGE_CUSTOMFUNCTION_SHOW                HideCheckbox<br />
  <br />
  !insertmacro MUI_DEFAULT MUI_FINISHPAGE_TITLE       &quot;Completing installation.&quot;<br />
  !insertmacro MUI_DEFAULT MUI_FINISHPAGE_TEXT        &quot;The installation completed.&quot;           <br />
  !insertmacro MUI_PAGE_FINISH<br />
  <br />
<br />
The functions 'RunApplication', 'ShowLogFile' and 'HideCheckbox' are placed in a seperate file (Install_Functions.nsh)<br />
<br />
Johan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">15th September 2010, 14:18</div></div><div class="posttext">Then you're probably including your Install_Functions.nsh before you're inserting the page macros.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JohaViss</div><div class="date">15th September 2010, 15:13</div></div><div class="posttext">Had to split my 'Install_Functions.nsh' into 2 files.<br />
Moved the split off part to a position after the Finish_Page definition.<br />
<br />
Then it works.<br />
<br />
I am not happy to have include files on more than 1 place in the code.:down:<br />
It's getting  to be a mess. (I have just under 200 include files, and the .NSI alone is over 15.000 lines)<br />
<br />
B.T.W.<br />
Are there rules where to place certain parts of code? The help isn't clear about that.<br />
We want to have equal call grouped together:<br />
   First all constants<br />
   Second all variables<br />
   Next all includes (Split into NSIS internal, Project specific, Custom pages)<br />
   Next all page definitions<br />
   Finally _PRE, _SHOW and _LEAVE functions<br />
<br />
Johan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th September 2010, 15:54</div></div><div class="posttext">There are no rules, (except for the order of MUI macro/defines for example) it's just a matter of getting it right so that it builds OK. However I would always place functions after page definitions (and sometimes after sections too). How about moving your page definitions to another include?<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>