<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Forcefully Aborting installation, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Forcefully Aborting installation NSIS Discussion" />
	
	<title> Forcefully Aborting installation [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Forcefully Aborting installation</div>
<hr />
<div class="pda"><a href="t-223065.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=223065">Forcefully Aborting installation</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Sajida_cts</div><div class="date">1st August 2005, 11:20</div></div><div class="posttext">Hi, <br />
  I have just shipped my installer for testing. One of the major bugs which came up was that during installation if the installer is forcefully aborted by going to Task Manager-&gt;Processes, the installation wont happen again during a subsequent double-click. Which is understandable considering that I'm putting in a registry key check at the beginning of installationa nd taking it off only if the installation succeeds or the user cancels the installation. Is there any way I can handle the forceful abortion of the installation?? <br />
I know it is a stupid bug, but please help me out...<br />
Thanks,<br />
Saaji</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st August 2005, 11:48</div></div><div class="posttext">I don't think it's possible from the installer side, because when you terminate a program from task manager, you're killing  the process, hence the process is no longer running.<br />
What you could do is write another installer which has code in .onInit only (so it's hidden) which has an infinite loop (with say Sleep 5000 in it) which constantly checks if your installer is running (with FindWindow). If it isn't then it changes the registry key and exits (Abort). Obviously you want to compress this into your main installer, and extract it and run it from .onInit too.<br />
<br />
Edit: If you don't want the user to run the installer twice (at the same time) you can use a Mutex:<br />
<br />
 System::Call 'kernel32::CreateMutexA(i 0, i 0, t &quot;my install&quot;) i .r1 ?e'<br />
  Pop $R0<br />
<br />
 StrCmp $R0 0 +2<br />
  Abort		; abort if another install is running<br />
<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>