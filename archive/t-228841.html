<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Dynamically update label text in an InstalOptions Page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Dynamically update label text in an InstalOptions Page NSIS Discussion" />
	
	<title> Dynamically update label text in an InstalOptions Page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Dynamically update label text in an InstalOptions Page</div>
<hr />
<div class="pda"><a href="t-228841.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228841">Dynamically update label text in an InstalOptions Page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">neil.benn</div><div class="date">19th October 2005, 21:51</div></div><div class="posttext">Hello,<br />
<br />
       I'm trying to dynamically update a label in an installoptions page so I can have something similar to the DetailPrint in an install dialog.  I can#t force the dialog to redraw by calling abort because that would be a pain.  I'm aware of SendMessage but I'm not quite sure how to getthe hwnd of a control using InstallOPtion and a the ModernUI.<br />
<br />
  Is ther an example of how to do this anywhere?<br />
<br />
Cheers,<br />
<br />
Neil</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">20th October 2005, 01:29</div></div><div class="posttext">You can't change the label while the dialog is visible.<br />
You can only do it before it has been displayed either by modifying the INI file or by getting the HWND between the InstallOptions::initDialog and InstallOptions::show functions and then calling SendMessage to change the label.<br />
A similar problem was discussed in detail some time ago.<br />
<br />
Can you explain exactly what you want to do? Maybe there is another solution.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">neil.benn</div><div class="date">20th October 2005, 11:16</div></div><div class="posttext">Hello,<br />
<br />
      Thanks for the reply.  I have a licence page using InsallOptions, it goes through the following steps in the leavefunction of the Page:<br />
<br />
 * Prompts the user for the licence key and checks to see if it is well formed (ie matches the licence key pattern we have chosen)<br />
 * Chcek to see if the handheld is connected to the PC<br />
 * Downloads an application to an iPaq<br />
 * Excutes the applicaiton on the iPaq<br />
 * Retrieves the output of that which contains the processor ID of the handheld<br />
 * Reads the local PC file and gets this information into a variable in NSIS<br />
 * Deletes those files from the handheld<br />
 * Checks for internet connection<br />
 * Gets the licence key and procssorID and sends this off to a JSP servlet running somewhere<br />
 * Receives a file which is the licence file to be installed on the handheld in the instlal page<br />
<br />
If any of these fails, it shows a message bos to the user and calls abort, thereby leaving me on this page until they either fix the problem or click abort.  This is working nice but the problem is that the above steps take ~1 minute to process and I have no feedback to the user that something is happening and they may start giving the thing three fingered salutes (this is shipping to scientists who are notorioulsy impatient!!).<br />
<br />
  So that's it really give them feedback when this is happening to let them know that it hasn;t simply hung.<br />
<br />
    All help greatly appreciated.<br />
<br />
Cheers,<br />
<br />
Neil</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">20th October 2005, 12:58</div></div><div class="posttext">Attached code works on the INSTFILES page, so this may work on InstallOptions as well, finally you can add RedrawWindow call to update label. I saw a lot of samples for text/color manipulations in wiki. But Marquee (http://nsis.sourceforge.net/wiki/Marquee_text_scroll) may be even better ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">20th October 2005, 16:21</div></div><div class="posttext">neil.benn:<br />
Actually, what you want to do should be possible using SendMessage and RedrawWindow calls.<br />
IMHO, it would be easier to just use the Banner plugin.<br />
You can update the text in the plugin between operations so that the user knows what is happening.<br />
If something fails, close the plugin, show your MessageBox and Abort and you will still be on the IO page.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>