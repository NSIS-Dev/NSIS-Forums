<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MSSQL_OLEDB Problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MSSQL_OLEDB Problem NSIS Discussion" />
	
	<title> MSSQL_OLEDB Problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MSSQL_OLEDB Problem</div>
<hr />
<div class="pda"><a href="t-275961.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=275961">MSSQL_OLEDB Problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">is99</div><div class="date">15th August 2007, 15:32</div></div><div class="posttext">I'm using this plugin to run SQL script.<br />
I'm able to logon to the server, but when after it I run<br />
MSSQL_OLEDB::SQL_ExecuteScript /NOUNLOAD &quot;$3&quot;<br />
<br />
my installer crash.<br />
<br />
Any ideas why?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">21st August 2007, 22:20</div></div><div class="posttext">As written before, the script must contain only a SQL statement or, in other words, only one resource set is admitted.<br />
If the script returns more than a result set, split it.<br />
otherwise post the script and i'll check it</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">25th August 2007, 23:12</div></div><div class="posttext">An update,<br />
I did some testing with complex scripts (even with more than a statement, and everything works fine)<br />
I did something like this:<br />
MSSQL_OLEDB::SQL_Execute /NOUNLOAD &quot;create database test&quot;<br />
MSSQL_OLEDB::SQL_Execute /NOUNLOAD &quot;use test&quot;<br />
MSSQL_OLEDB::SQL_ExecuteScript /NOUNLOAD &quot;$PLUGINSDIR\test.sql&quot;<br />
<br />
and test.sql is (copy and paste from MSSQL help online):<br />
/* ************************** jobs table ************************** */<br />
CREATE TABLE jobs<br />
(<br />
   job_id  smallint<br />
      IDENTITY(1,1)<br />
      PRIMARY KEY CLUSTERED,<br />
   job_desc        varchar(50)     NOT NULL<br />
      DEFAULT 'New Position - title not formalized yet',<br />
   min_lvl tinyint NOT NULL<br />
      CHECK (min_lvl &gt;= 10),<br />
   max_lvl tinyint NOT NULL<br />
      CHECK (max_lvl &lt;= 250)<br />
)<br />
<br />
/* ***************** publishers table ******************** */<br />
CREATE TABLE publishers<br />
(<br />
   pub_id  char(4) NOT NULL <br />
         CONSTRAINT UPKCL_pubind PRIMARY KEY CLUSTERED<br />
         CHECK (pub_id IN ('1389', '0736', '0877', '1622', '1756')<br />
            OR pub_id LIKE '99[0-9][0-9]'),<br />
   pub_name      varchar(40)     NULL,<br />
   city         varchar(20)     NULL,<br />
   state      char(2) NULL,<br />
   country      varchar(30)     NULL<br />
            DEFAULT('USA')<br />
)<br />
<br />
/* ************************* employee table ************************* */<br />
CREATE TABLE employee <br />
(<br />
   emp_id  char(8)<br />
      CONSTRAINT PK_emp_id PRIMARY KEY NONCLUSTERED<br />
      CONSTRAINT CK_emp_id CHECK (emp_id LIKE <br />
         '[A-Z][A-Z][A-Z][1-9][0-9][0-9][0-9][0-9][FM]' or<br />
         emp_id LIKE '[A-Z]-[A-Z][1-9][0-9][0-9][0-9][0-9][FM]'),<br />
      /* Each employee ID consists of three characters that <br />
      represent the employee's initials, followed by a five <br />
      digit number ranging from 10000 through 99999 and then the <br />
      employee's gender (M or F). A (hyphen) - is acceptable <br />
      for the middle initial. */<br />
   fname   varchar(20)     NOT NULL,<br />
   minit   char(1) NULL,<br />
   lname   varchar(30)     NOT NULL,<br />
   job_id  smallint        NOT NULL<br />
      DEFAULT 1<br />
      /* Entry job_id for new hires. */<br />
      REFERENCES jobs(job_id),<br />
   job_lvl tinyint<br />
      DEFAULT 10,<br />
      /* Entry job_lvl for new hires. */<br />
   pub_id  char(4) NOT NULL<br />
      DEFAULT ('9952')<br />
      REFERENCES publishers(pub_id),<br />
      /* By default, the Parent Company Publisher is the company<br />
      to whom each employee reports. */<br />
   hire_date       datetime        NOT NULL<br />
      DEFAULT (getdate())<br />
      /* By default, the current system date is entered. */<br />
)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>