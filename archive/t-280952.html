<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ListBox and selected value, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ListBox and selected value NSIS Discussion" />
	
	<title> ListBox and selected value [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ListBox and selected value</div>
<hr />
<div class="pda"><a href="t-280952.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=280952">ListBox and selected value</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">andyb2000</div><div class="date">7th November 2007, 12:18</div></div><div class="posttext">Hello all,<br />
I've been dabbling with NSIS for a bit now, and have a couple of decent installers working.<br />
<br />
However this last one is really confusing me! I have a ListBox on a page, that I populate then need to retrieve the value on the subsequent page. I cannot see to figure out the right query, as tried many, those from forums, etc and don't seem to get it right!<br />
<br />
<br />
	nsDialogs::Create /NOUNLOAD 1018<br />
	Pop $0<br />
<br />
	${NSD_CreateText} 0 47 30% 12u 200<br />
	Pop $EDIT<br />
${NSD_CreateListBox} 0 87 40% 32u &quot;&quot;<br />
	Pop $huntgroup<br />
	SendMessage $huntgroup ${LB_ADDSTRING} 0 &quot;STR:entry1&quot;<br />
	SendMessage $huntgroup ${LB_ADDSTRING} 0 &quot;STR:entry2&quot;<br />
	SendMessage $huntgroup ${LB_ADDSTRING} 0 &quot;STR:entry3&quot;<br />
<br />
	${NSD_CreateLabel} 0 10u 75% 40u &quot;Select your hunt group from the drop down menu&quot;<br />
	Pop $0<br />
<br />
<br />
	${NSD_GetText} $EDIT $myvar1<br />
	<br />
	SendMessage $huntgroup ${LB_GETSEL} 0 0 $huntgroup<br />
<br />
<br />
I have tried several different ways of getting the value and all either return 0 or return a 4 or 5 digit number (hwid perhaps?)<br />
<br />
Thanks in advance for anyone who can help!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th November 2007, 19:38</div></div><div class="posttext">SendMessage $huntgroup ${LB_GETSEL} 0 0 $0<br />
System::Call user32::SendMessage(i$huntgroup,i${LB_GETTEXT},ir0,t.r0)<br />
MessageBox MB_OK $0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">28th November 2007, 22:02</div></div><div class="posttext">I don't understand it. I've tried kichik's tip and it didn't work. Sorry, but I'll post whole script. The messagebox shows empty value.<br />
!include nsDialogs.nsh<br />
<br />
Name &quot;NSD: Listbox&quot;<br />
OutFile &quot;listbox.exe&quot;<br />
<br />
Page custom nsDialogsPage<br />
Page custom validate<br />
Page instfiles<br />
<br />
Var LISTBOX_1<br />
<br />
Function nsDialogsPage<br />
  nsDialogs::Create /NOUNLOAD 1018<br />
  Pop $0<br />
  ${NSD_CreateListBox} 200 35 20% 12u &quot;&quot;<br />
  Pop $LISTBOX_1<br />
  SendMessage $LISTBOX_1 ${LB_ADDSTRING} 0 &quot;STR:0&quot;<br />
  SendMessage $LISTBOX_1 ${LB_ADDSTRING} 0 &quot;STR:1&quot;<br />
  SendMessage $LISTBOX_1 ${LB_ADDSTRING} 0 &quot;STR:2&quot;<br />
  SendMessage $LISTBOX_1 ${LB_ADDSTRING} 0 &quot;STR:3&quot;<br />
  nsDialogs::Show<br />
FunctionEnd<br />
<br />
Function Validate<br />
  SendMessage $LISTBOX_1 ${LB_GETSEL} 0 0 $1<br />
  System::Call user32::SendMessage(i$LISTBOX_1,i${LB_GETTEXT},ir1,t.r1)<br />
  MessageBox MB_OK $1<br />
FunctionEnd<br />
<br />
Section<br />
SectionEnd<br />
<br />
<br />
I also tried the LB_GETCURSEL message but it returns '0'. Where is the problem and how does it work?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th November 2007, 22:16</div></div><div class="posttext">The page, including the list box, is destroyed by the time the validate function is called. You must use that code in the leave callback function of the page.Page custom nsDialogsPage validateYou also need to replace LB_GETSEL with LB_GETCURSEL.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">28th November 2007, 22:20</div></div><div class="posttext">Thank you very much!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">28th November 2007, 22:34</div></div><div class="posttext">And how can I create ComboBox? I tried to change ${NSD_CreateListBox} -&gt; ${NSD_CreateComboBox} and rename all messages LB_ -&gt; CB_, but combobox is empty. Is there something special to do when creating combobox?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th November 2007, 22:55</div></div><div class="posttext">That's probably because the combo is too short to display the selection and can only display the text field. Try 50u instead of 12u.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">29th November 2007, 06:58</div></div><div class="posttext">Aaah, I see! Actually, I am interested in &quot;Drop-down list&quot; :-) Is it possible to mix listboxes and dropdown lists on one page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">29th November 2007, 08:44</div></div><div class="posttext">I have combobox with dropdown list style, but I had to edit nsDialogs.nsh and add |${CBS_DROPDOWNLIST} at the end of !define __NSD_ComboBox_STYLE. Can I change (combobox control) style from script, not from .nsh file?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">29th November 2007, 12:08</div></div><div class="posttext">And another question - is there any difference when sending &quot;gettext&quot; message to listbox or combobox? I have combobox and all CB_GETTEXT, LB_GETTEXT and CB_GETLBTEXT return empty value.<br />
Function validatePage <br />
  SendMessage $CB_kontrola ${CB_GETCURSEL} 0 0 $kontrola ### index is OK<br />
  System::Call user32::SendMessage(i$CB_kontrola,i${CB_GETLBTEXT},i$kontrola,t.$1)<br />
  messagebox mb_ok &quot;$kontrola $1&quot; <br />
  System::Call <br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th November 2007, 17:05</div></div><div class="posttext">Currently, you can only call nsDialogs::CreateItem manually to add extra styles to the defaults defined in nsDialogs.nsh.<br />
<br />
The problem with your text retrieval mechanism is that you pass $1 instead of r1. $1 is translated to the actual value of $1 and so the System plug-in doesn't know it needs to write something into $1.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">30th November 2007, 12:30</div></div><div class="posttext">Sorry kichik, I tried $r1 and it is still empty. :confused:<br />
My code is below:<br />
SendMessage $CB_kontrola ${CB_GETCURSEL} 0 0 $kontrola ### index OK<br />
System::Call user32::SendMessage(i$CB_kontrola,i${CB_GETLBTEXT},i$kontrola,t.$r1)<br />
messagebox mb_ok &quot;$kontrola $r1&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th November 2007, 12:32</div></div><div class="posttext">r1, not $r1.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">30th November 2007, 12:35</div></div><div class="posttext">THANKS! :up:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">doniking</div><div class="date">4th April 2010, 16:47</div></div><div class="posttext">please show us the correct codes for your listbox and combobox page</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>