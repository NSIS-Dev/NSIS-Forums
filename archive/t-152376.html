<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Using the SearchPath command ..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Using the SearchPath command ... NSIS Discussion" />
	
	<title> Using the SearchPath command ... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Using the SearchPath command ...</div>
<hr />
<div class="pda"><a href="t-152376.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=152376">Using the SearchPath command ...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Cdzitu</div><div class="date">12th October 2003, 14:07</div></div><div class="posttext">Hi! For sometime i'm trying to use to SearchPath command but without sucess ... I've read the NSIS manual but my english isn't that good so i can't get the syntax right ... <br />
<br />
I'm trying to use like this:<br />
<br />
SearchPath $(APP) app.exe <br />
<br />
And always get an error message ... <br />
<br />
Anyone can help me?! Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">12th October 2003, 14:22</div></div><div class="posttext">SearchPath $R0 app.exe <br />
<br />
or<br />
<br />
Var APP<br />
SearchPath $APP app.exe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cdzitu</div><div class="date">14th October 2003, 18:21</div></div><div class="posttext">Hi! I'm back. Well, i did like you said. It compiled without any problem but i could not make it work ... <br />
<br />
That's what I'm trying:<br />
<br />
SetOutPath &quot;$INSTDIR&quot;<br />
File &quot;C:\anything.dll&quot;<br />
SearchPath $R0 app.exe<br />
CopyFiles /SILENT &quot;$INSTDIR\anything.dll&quot; &quot;$R0\Plugins&quot;<br />
<br />
But it does not copy the file ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th October 2003, 18:23</div></div><div class="posttext">It will only work if app.exe is stored in one of the system directories, it does not search the whole drive.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cdzitu</div><div class="date">14th October 2003, 22:01</div></div><div class="posttext">Sorry about taking your time Joost ... But, would you know how to do this ? I mean, I'm trying to copy a file from the $INSTDIR to the plugins' directory of Winamp if the user has Winamp. So I need a way to know if the user has Winamp installed and where is it ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th October 2003, 23:20</div></div><div class="posttext">See the waplugin.nsi example in your local Examples folder.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cdzitu</div><div class="date">16th October 2003, 23:14</div></div><div class="posttext">Hi kichik! I've read the waplugin.nsi file ... But i don't think that it can help me ... That's because in the example file the user that installs it have to set the WA directory with the directory page ... On my installer, the install directory has nothing to do with the Winamp directory, otherwise it would be easy. =P But I must find a way to detect the plugins' directory of Winamp to extract one file to this directory if the user has Winamp installed ... In the last case i think i'll suppose that the user has installed Winamp in $PROGRAMFILES\Winamp. So if WA isn't there, what can i do ? =P</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">16th October 2003, 23:17</div></div><div class="posttext">It only gives the user the option to choose another directory, it detects the Winamp folder.<br />
<br />
You can use two directory pages if you want.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cdzitu</div><div class="date">20th October 2003, 01:01</div></div><div class="posttext">Hi! Well, i've read the waplugin.ini file again and i put this part of it in my script:<br />
<br />
Function GetWinampInstPath<br />
<br />
  Push $0<br />
  Push $1<br />
  Push $2<br />
  ReadRegStr $0 HKLM \<br />
     &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\Winamp&quot; \ <br />
     &quot;UninstallString&quot;<br />
  StrCmp $0 &quot;&quot; fin<br />
<br />
    StrCpy $1 $0 1 0<br />
    StrCmp $1 '&quot;' &quot;&quot; getparent <br />
    <br />
      StrCpy $0 $0 &quot;&quot; 1<br />
      StrCpy $1 0<br />
      rqloop:<br />
        StrCpy $2 $0 1 $1<br />
        StrCmp $2 '&quot;' rqdone<br />
        StrCmp $2 &quot;&quot; rqdone<br />
        IntOp $1 $1 + 1<br />
        Goto rqloop<br />
      rqdone:<br />
      StrCpy $0 $0 $1<br />
    getparent:<br />
    <br />
    StrCpy $1 -1<br />
    gploop:<br />
      StrCpy $2 $0 1 $1<br />
      StrCmp $2 &quot;&quot; gpexit<br />
      StrCmp $2 &quot;\&quot; gpexit<br />
      IntOp $1 $1 - 1<br />
      Goto gploop<br />
    gpexit:<br />
    StrCpy $0 $0 $1<br />
<br />
    StrCmp $0 &quot;&quot; fin<br />
    IfFileExists $0\winamp.exe fin<br />
      StrCpy $0 &quot;&quot;<br />
  fin:<br />
  Pop $2<br />
  Pop $1<br />
  Exch $0<br />
  <br />
FunctionEnd<br />
<br />
And has tried to use that function in this part ... <br />
<br />
Section &quot;&quot; SecCopyUI<br />
<br />
Call GetWinampInstPath<br />
<br />
CopyFiles /SILENT &quot;$INSTDIR\example\anything.dll&quot; &quot;$0\Plugins&quot;<br />
<br />
SectionEnd<br />
<br />
But it didn't work ... The var $0 is read just as 0 ... =[ <br />
<br />
Any hint? Thank you again guys for helping ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">20th October 2003, 11:55</div></div><div class="posttext">You have to get the value from the stack after calling the function:<br />
<br />
Pop $0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cdzitu</div><div class="date">20th October 2003, 21:50</div></div><div class="posttext">Well, I'm just posting here again to thank you guys for your time since it worked now!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">20th October 2003, 21:54</div></div><div class="posttext">YYYYYYYYYEEEEEEEEEEEEEAAAAAAAAAAAAHHHHHHHHHHH!!!!!!!!!!!!!! UHHHHHHHHHUUUUUUUUUUUU!!! Someone from Brazil!!!!!!!! I'm too!!!!!!!!<br />
<br />
(Rarely this happened before)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cdzitu</div><div class="date">20th October 2003, 23:02</div></div><div class="posttext">Hehehe! Hi deguix! A lot a people use NSIS here too. =P And as you can see, not only here, but in many parts of the world! When I saw that kichik is from Israel I thought &quot;- Ow, I'm talking to someone in Israel. =O&quot;. Internet RULES =P ...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>