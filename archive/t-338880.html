<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" System: create structure in preallocated memory?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  System: create structure in preallocated memory? NSIS Discussion" />
	
	<title> System: create structure in preallocated memory? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  System: create structure in preallocated memory?</div>
<hr />
<div class="pda"><a href="t-338880.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=338880">System: create structure in preallocated memory?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">6th December 2011, 18:12</div></div><div class="posttext">I know how to create structures with System plugin but how do I create one at a given memory address?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th December 2011, 19:12</div></div><div class="posttext">The usage example for System::Copy at the top of the plug-in readme shows how to do it.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">6th December 2011, 19:16</div></div><div class="posttext">System::Call '*$0(i 666,i 1337)' in the memory starting at $0 (The set struct members syntax)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">6th December 2011, 19:51</div></div><div class="posttext">I studied that part in System readme before posting but I must be getting something wrong. What I need is to create a blank POINT structure in another process' memory and pass the pointer with SendMessage. Is System::Call &quot;*$0(&amp;i4, &amp;i4)&quot; ok, $0 being an existing address?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">6th December 2011, 20:42</div></div><div class="posttext">To write to the memory in another process you would first create the struct locally inside the nsis process normally with system and then you would have to call OpenProcess, VirtualAllocEx and WriteProcessMemory (This is not going to be pretty, and it sounds like you are doing something hacky)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">6th December 2011, 21:11</div></div><div class="posttext">I'm not a coder so pretty much everything's hacky to me but what i'm trying do is save/restore desktop icons layout. Found the code in Delphi, now I'm trying to port it to nsis. I already did the OpenProcess &amp; VirtualAllocEx part but &quot;first create the struct locally&quot; is the thing I needed to hear. Thanks for pointing me in the right direction, I'll let you know if I was successful, or stuck again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">6th December 2011, 23:28</div></div><div class="posttext">Woohoo! Did it. My main problem was failing to understand that System can't directly manage the memory of another process. It probably goes without saying for someone with proper knowledge but I'm just learning as I go along. Still got scripting ahead of me to achieve what I want but the bricks are here, all I got to do now is build. Thanks again, Anders.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>