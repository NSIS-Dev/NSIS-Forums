<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Change Power configuration, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Change Power configuration NSIS Discussion" />
	
	<title> Change Power configuration [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Change Power configuration</div>
<hr />
<div class="pda"><a href="t-320677.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=320677">Change Power configuration</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">The Raddish</div><div class="date">9th July 2010, 18:21</div></div><div class="posttext">Has anyone figured out a way to change the 'Advanced' settings in the 'Power Options Properties' of a Windows XP machine from an installer?<br />
<br />
Powercfg works for the 'Power Schemes', but not for anything in the 'Advanced' tab.  I've googled and googled and have come up short.<br />
<br />
As a workaround, I have the following in my script, but I don't like this method and I'd really prefer to make it automated if at all possible.<br />
<br />
<br />
Section<br />
  ExecShell &quot;&quot; &quot;$SYSDIR\Powercfg.cpl&quot;<br />
  MessageBox MB_OK &quot;Click on the 'Advanced' tab.  In the 'Power Buttons' heading, \<br />
  change the option for 'When I close the lid of my portable computer:' to 'Do Nothing'. \<br />
  Then click 'Apply' and close the window.  The installation will then continue.&quot;<br />
	<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zinthose</div><div class="date">9th July 2010, 21:31</div></div><div class="posttext">The power settings are stored in the RegBinary value:HKCU\Control Panel\PowerCfg\GlobalPowerPolicy\Policies<br />
<br />
I don't know exactly what needs changed but you can do a before and after comparison easily enough.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">The Raddish</div><div class="date">12th July 2010, 14:39</div></div><div class="posttext">Yeah, I've done this over and over.  Changing here doesn't work.<br />
<br />
I've used RegShot (http://sourceforge.net/projects/regshot/) to see the differences and changed them, but testing shows that while the registry entries are indeed changed, the actual power configuration on the 'Advanced' tab is not.  This seems to be a common theme all across the interwebz.<br />
<br />
I was just hoping that someone here had figured out a way to do it from within NSIS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">14th July 2010, 13:38</div></div><div class="posttext">Technically, you'd have to change the power policy - lots of System plugin interaction - nom.  See:<br />
edit: the link gets killed because it's a .info site - go figure :)<br />
http://www.databaseforum[dot]info/30/648583.aspx<br />
<br />
I'm not sure if there's a simpler API call that just lets windows pick up on the new registry settings - I would suspect those values are written as a result of policy changes, rather than used as a reference (except after a reboot, maybe).<br />
The system itself sends WM_POWERBROADCAST PBT_POWERSETTINGCHANGE ... to applications to signal setting changes.  I presume you've already googled those to death, though.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zinthose</div><div class="date">15th July 2010, 19:19</div></div><div class="posttext">I found the APIs to use and have them working in AutoIt... I just need to convert them to NSIS.<br />
<br />
I haven't abandoned you.. it's just more complicated than I thought..  ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th July 2010, 10:03</div></div><div class="posttext">Put them in an executable or DLL and run it. Simples!<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zinthose</div><div class="date">16th July 2010, 14:34</div></div><div class="posttext">It's only simple if you know how to program in a VC++ environment.  It's on my todo list to learn though. ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">The Raddish</div><div class="date">16th July 2010, 18:22</div></div><div class="posttext">I kept playing with it too, but no matter what resource I used I couldn't get it to work.<br />
<br />
I'm using my workaround at the moment, but my goal is to make the installer unattended in the long run so I'm anxious to get it working.<br />
<br />
I absolutely appreciate any work you put in to making this work, as I am sure does the rest of the internetz.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">The Raddish</div><div class="date">22nd July 2010, 18:30</div></div><div class="posttext">I got to thinking about this a bit.  AutoIt can compile standalone executable from the scripts.  Why not just create the exe and call it from NSIS?<br />
<br />
If you have a working AutoIt script, can you post the script here?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">22nd July 2010, 21:39</div></div><div class="posttext">isn't AutoIt rather UI-dependent?  I.e. you tell it to &quot;click this button, now click this one, now click in this field and 'type' this number&quot;, etc.  Given the power scheme bits and pieces vary between Windows versions, that doesn't seem like a prudent path.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>