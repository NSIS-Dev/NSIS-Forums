<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to launch an executable on the end of installation correctly?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to launch an executable on the end of installation correctly? NSIS Discussion" />
	
	<title> How to launch an executable on the end of installation correctly? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to launch an executable on the end of installation correctly?</div>
<hr />
<div class="pda"><a href="t-361405.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=361405">How to launch an executable on the end of installation correctly?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Shark321</div><div class="date">15th May 2013, 03:57</div></div><div class="posttext">I'm launching my Windows application this way after the installation completes:<br />
    !define MUI_FINISHPAGE_RUN_FUNCTION &quot;LaunchApplication&quot;<br />
<br />
    ...<br />
<br />
    Function LaunchApplication<br />
        ExecShell &quot;&quot; &quot;$INSTDIR\Application.exe&quot;<br />
    FunctionEnd<br />
<br />
But this has a strange and undesired side-effect. Apparently is my application launched with admin rights.<br />
<br />
I cannot drag &amp; drop any data between a web browser (tested with Firefox and IE) and my application.<br />
<br />
If I quit my application (the session started from NSIS), and restart it from the start menu icon everything works! - I can drag &amp; drop to the browsers without problems.<br />
<br />
So I suspect since in the beginning of installation there is a UAC request, somehow UAC rights are transferred to the process I'm launching after installation. Since the browsers run in a low security process Windows refuses to exhange any data with them (in the process instance that is launched with NSIS).<br />
<br />
How to launch an exe from NSIS, so that this UAC/security problem does not happen?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th May 2013, 10:33</div></div><div class="posttext">You have to use the UAC plug-in to resolve this.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Shark321</div><div class="date">15th May 2013, 11:32</div></div><div class="posttext">Afrow, I'm already using the UAC plugin to elevate in the first place. What do I need to do additionally?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">15th May 2013, 13:01</div></div><div class="posttext">You can elevate without the UAC plugin the plugin gives you the ability to go &quot;back down&quot;...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Shark321</div><div class="date">15th May 2013, 18:33</div></div><div class="posttext">How to back down? Unfortunately there is no documentation, because the UAC plugin is not available anymore on the nsis plugin page:<br />
<br />
http://nsis.sourceforge.net/UAC_plug-in</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>