<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Windows 64 bit issues, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Windows 64 bit issues NSIS Discussion" />
	
	<title> Windows 64 bit issues [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Windows 64 bit issues</div>
<hr />
<div class="pda"><a href="t-306069.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=306069">Windows 64 bit issues</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">xsinx</div><div class="date">5th May 2009, 18:23</div></div><div class="posttext">Hello everyone!<br />
<br />
I'm having an issue getting my app to run on Windows 64 platforms. Until recently we were using WISE to install our software and since they lack Unicode support, we decided to move over to NSIS. We are using the Unicode version, but I'm going by the assumption that is irrelevant to the issue at hand.<br />
<br />
Lets jump right to the juice. The problem I'm having is that my app is not able to use COM classes defined in some of the DLL's I'm installing. The error code I'm getting is 80040154. At first I was registering the DLL using RegDLL in NSIS, nothing fancy. Then I found out about the SysWoW64 version of regsvr32 so I figured maybe, just maybe, NSIS wasn't using the right version so I modified my installer to use the regsvr32 manually, using the right one depending on 32 vs 64 bit OS. Still the same error.<br />
<br />
So I went to the command prompt (in admin-mode) and registered all my DLL's using one version of regsvr32, tried the app, then the other version, tried the app again. Always the same message no matter what.<br />
<br />
I have then used regedit to look up the registry. The classes seem to be registered properly, I can't see anything wrong with it. Also, the user I'm using to run these test is a local admin. I have made sure he has access to all the keys relating to the DLL in question and he has &quot;Full Control&quot; over everything, from registry entries to the app folder, files, etc.<br />
<br />
I have tried running the installer, as well as the application w/ admin override (Run As administrator) and still the same thing.<br />
<br />
Does anyone have any idea of what might be wrong? I can't tell if it's the installation process or something else that's the problem. I'm running out of options fast.<br />
<br />
Any help would be appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xsinx</div><div class="date">5th May 2009, 21:07</div></div><div class="posttext">Ah! Found the problem but not sure I'm understanding it fully. It's not NSIS related. My app is composed of a mix of VB.NET and C++ (COM and plain, no DOTNET) and my VB apps/DLL's were configured to compile for &quot;AnyCPU&quot;. Apparently, this was causing the app to not be able to load the 32 bit COM objects. I'm guessing all my VB layer was defaulting to 64 bits and trying to load 64 bit versions of my COM objects (which do not exist).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>