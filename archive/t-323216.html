<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS run as admin!!!, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS run as admin!!! NSIS Discussion" />
	
	<title> NSIS run as admin!!! [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS run as admin!!!</div>
<hr />
<div class="pda"><a href="t-323216.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=323216">NSIS run as admin!!!</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">floydmovie</div><div class="date">18th October 2010, 13:49</div></div><div class="posttext">I need help by my NSIS project.<br />
<br />
Is it possible for NSIS to be executed automatically as admin.<br />
<br />
The problem is on Windows 7 and Vista, there is an error.<br />
<br />
For my clients it is too complicated to run as Admin.<br />
<br />
<br />
Thanks...<br />
<br />
<br />
Grz Floydmovie</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">18th October 2010, 14:04</div></div><div class="posttext">NSIS run as admin (http://lmgtfy.com/?q=NSIS+run+as+admin)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">18th October 2010, 14:10</div></div><div class="posttext">mmh in this case, Google doesn't give the first trivial answer to floydmovie's question:<br />
<br />
Just use RequestExecutionLevel admin in your script and your users will be automatically prompted to let your installer run as admin.<br />
No need of plugins for this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">floydmovie</div><div class="date">18th October 2010, 14:34</div></div><div class="posttext">Thanks for the quick reply.<br />
<br />
Can you do me a small example?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">18th October 2010, 14:48</div></div><div class="posttext">Just use RequestExecutionLevel admin in your script and your users will be automatically prompted to let your installer run as admin.<br />
No need of plugins for this.<br />
<br />
Sadly this is not true, RequestExecutionLevel is only half the job<br />
<br />
See http://nsis.pastebin.com/63tS3AS2 for a proper example.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">18th October 2010, 16:42</div></div><div class="posttext">Oh, I thought floydmovie expected his installer to be run only on Windows 7 &amp; Vista. My bad.<br />
<br />
Of course there can be problems with non-admin accounts on prior version of Windows, but floydmovie said he didn't have any problem on prior versions...<br />
<br />
This is probably because 90% of users of these older versions of Windows have admin accounts.<br />
If you want to deal with the 10% users left, you can use the link given by Anders for a solution.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">18th October 2010, 17:15</div></div><div class="posttext">Oh, I thought floydmovie expected his installer to be run only on Windows 7 &amp; Vista. My bad.<br />
<br />
Of course there can be problems with non-admin accounts on prior version of Windows, but floydmovie said he didn't have any problem on prior versions...<br />
<br />
This is probably because 90% of users of these older versions of Windows have admin accounts.<br />
If you want to deal with the 10% users left, you can use the link given by Anders for a solution.<br />
<br />
Wrong again! On vista when UAC is off, RequestExecutionLevel has no effect!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">18th October 2010, 17:57</div></div><div class="posttext">Wrong again! On vista when UAC is off, RequestExecutionLevel has no effect!<br />
<br />
Ok, when UAC is off, and your account is non-admin, there is not much you can do anyway.. and the user probably already knows he can't install programs..<br />
I have faced this case, and there is no possibility for an installer to obtain admin rights, even asking for a admin account.<br />
So NSIS will fail anyway, sooner or later.<br />
If you want to be nice, all you can do is detect this case and display a MessageBox saying &quot;you're screwed!&quot;<br />
<br />
<br />
PS: Of course I'm not talking about programs that can be installed completely using user-only folder/registry</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">18th October 2010, 21:34</div></div><div class="posttext">If you want to be nice, all you can do is detect this case and display a MessageBox saying &quot;you're screwed!&quot;<br />
And that is exactly what you have to do, because otherwise the installer will fail halfway when trying to do something restricted to admin users, and the user will come complaining that your installer is broken.<br />
<br />
Anders is absolute correct in his statements.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">20th October 2010, 03:32</div></div><div class="posttext">Sure, and that's what I personally do in my own installers..<br />
But I just don't expect every NSIS users to be ready to go to this extent of covering every cases, especially this (rare in my opinion) case of a non-admin users trying to install a program while UAC is disabled.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">20th October 2010, 12:06</div></div><div class="posttext">But I just don't expect every NSIS users to be ready to go to this extent of covering every cases, especially this (rare in my opinion) case of a non-admin users trying to install a program while UAC is disabled.<br />
<br />
They will if we tell them the correct way from the start. <br />
<br />
Besides, the number of users still on XP is pretty high. Even if the first post only talks about Vista/7, you can assume that the same problem exists on NT4+ and that they have just not tested as non admins.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>