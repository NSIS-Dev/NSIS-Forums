<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" VISTA Compatibility, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  VISTA Compatibility NSIS Discussion" />
	
	<title> VISTA Compatibility [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  VISTA Compatibility</div>
<hr />
<div class="pda"><a href="t-291114.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291114">VISTA Compatibility</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ecaste</div><div class="date">1st May 2008, 08:24</div></div><div class="posttext">Dears,<br />
I'm facing to a **** problem since I've tested the installation of my script on VISTA with a non administrator account:<br />
the installation is perfect but as soon as the user wants to execute my installed program, VISTA is asking for account elevation.<br />
It seems that the user needs to be an administrator to run my application.<br />
<br />
I've tested several things, with no success:<br />
 - When I'm using RequestExecutionLevel user: the installer can't copy files in PROGRAM FILES<br />
<br />
 - And unfortunatly, when I'm using RequestExecutionLevel admin: the user needs to be admin to execute the program.<br />
<br />
 - When I'm combined both, RequestExecutionLevel user with the UAC_Plugin: the user still needs to be admin to execute the program.<br />
<br />
Today I'm totally stuck, does anybody can help me ?<br />
<br />
Thanks by advance.<br />
<br />
Man'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">1st May 2008, 09:10</div></div><div class="posttext">you can't have it both ways, if you want to put files in $programfiles, you need to be admin. If you want a non admin installer, put the files in $localappdata or something like that</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ecaste</div><div class="date">1st May 2008, 09:16</div></div><div class="posttext">Hi Anders,<br />
thanks for you reply, but how can I install my application in Pgrm Files AND let a standard user execute my application (without elevation to admin account) ? Is that possible ?<br />
<br />
Thanks.<br />
Man'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LordDaimos</div><div class="date">1st May 2008, 09:18</div></div><div class="posttext">Standard users can execute in Program Files but you can't have your application writing files (such as settings) there. For that there is %appdata%.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ecaste</div><div class="date">1st May 2008, 09:25</div></div><div class="posttext">Originally posted by LordDaimos <br />
Standard users can execute in Program Files but you can't have your application writing files (such as settings) there. For that there is %appdata%.  <br />
<br />
That's my point, I'm totally agree with you in theorie...<br />
<br />
Before NSIS, I was using standard MSI installer to install my application in Program Files directory, and all was working fine:<br />
- installation: ok<br />
- running the application as a standard user: ok<br />
<br />
But I wanted to move from that MSI installer, and started to learn about nsis, which is perfect for our usage. <br />
<br />
But now, I'm facing on the pb described, problem I didn't have before with the msi installer....:<br />
Why should Vista asks everytime for elevation on admin account when I'm trying to run my application...? <br />
<br />
Is it in my application level (strange...) or is it due to my installation procedure...<br />
<br />
Anyway, thanks for help<br />
<br />
Man'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NEHOG</div><div class="date">1st May 2008, 20:11</div></div><div class="posttext">Originally posted by ecaste <br />
Is it in my application level (strange...) or is it due to my installation procedure...<br />
<br />
Anyway, thanks for help<br />
<br />
Man' [/B] <br />
<br />
I think you will find that your application's manifest is marked 'requireAdministrator' which is why the user is being prompted. Set the manifest to 'asInvoker' and that problem may go away.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">1st May 2008, 20:28</div></div><div class="posttext">Originally posted by NEHOG <br />
I think you will find that your application's manifest is marked 'requireAdministrator' which is why the user is being prompted. Set the manifest to 'asInvoker' and that problem may go away.  <br />
<br />
asInvoker is NEVER the right thing to use, either use admin or user</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NEHOG</div><div class="date">1st May 2008, 20:42</div></div><div class="posttext">Originally posted by Anders <br />
asInvoker is NEVER the right thing to use, either use admin or user  <br />
<br />
Oh? And what is the right thing to use for a non-administrator program?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd May 2008, 06:29</div></div><div class="posttext">sorry, I messed up (the MS names vs. the nsis names for this stuff always confuses me)<br />
<br />
for a non admin app, you want user aka asInvoker, and never highest aka highestAvailable</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ecaste</div><div class="date">5th May 2008, 12:53</div></div><div class="posttext">Hi,<br />
Thanks guys for your inputs...but unfortunatly I have still my pb: when installed in $PROGRAMFILES using NSIS, myApp.exe has a shield on its icon, and I need to launch it with admmin account! <br />
<br />
I've set the manifest of my application using asInvoker...with no success, but:<br />
- if I change the installation repository, for ex. in $APPDATA instead of $PROGRAMFILES, I can set with success the security in the manifest file (either requireAdministrator, or asInvoker).<br />
- if I copy manually all needed files in $PROGRAMFILES, I can then run with my standard user account myApp.exe.<br />
<br />
Any idea? <br />
<br />
Because I can of course put all my files in $APPDATA, but it seems that the recommended location for executable files is in $PROGRAMFILES...<br />
<br />
Thanks.<br />
Manu.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">6th May 2008, 08:09</div></div><div class="posttext">- When I'm using RequestExecutionLevel user: the installer can't copy files in PROGRAM FILES<br />
It looks like you're forgetting ${UAC.I.Elevate.AdminOnly} . Use it, in combination with RequestExecutionLevel user, in .onInit to have Vista ask for the Admin password during install AND run the installed application as a user.<br />
<br />
Hmm... At least, I *think* it runs it as a user in that case... Anders would know, he designed the plugin. Anyway, I don't think this solves the problem of Vista thinking the application needs Admin priviledges, but I just thought I'd mention it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">6th May 2008, 10:27</div></div><div class="posttext">I think we are confusing installer and programs here. If your application has a manifest with asInvoker, if you still have problems, maybe you don't have execute rights or something in $programfiles, try using the AccessControl plugin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NEHOG</div><div class="date">7th May 2008, 01:10</div></div><div class="posttext">Originally posted by ecaste <br />
Hi,<br />
Thanks guys for your inputs...but unfortunatly I have still my pb: when installed in $PROGRAMFILES using NSIS, myApp.exe has a shield on its icon, and I need to launch it with admmin account! <br />
 <br />
<br />
In this case either your program has a bad name (the name of the executable has either 'setup' or 'install' in it) or your application has a manifest that indicates that administrator privileges are required. <br />
<br />
You can post your manifest file and we can look at that and maybe see the problem... <br />
<br />
IMHO, this has nothing to do with NSIS or installation, but is what your application is configured to do by the building platform. (.NET by chance?)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>