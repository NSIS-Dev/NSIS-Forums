<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecDos parameters syntax?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecDos parameters syntax? NSIS Discussion" />
	
	<title> ExecDos parameters syntax? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecDos parameters syntax?</div>
<hr />
<div class="pda"><a href="t-231097.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=231097">ExecDos parameters syntax?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">thelliez</div><div class="date">15th November 2005, 20:50</div></div><div class="posttext">How does one pass parameters to a command using ExecDos.<br />
<br />
The following does not work:<br />
ExecDos::Exec '&quot;sc&quot; config &quot;Apache Tomcat 4.1&quot; obj= .\$R8 password= $R6)' &quot;&quot; &quot;&quot;<br />
           <br />
It seems that ExecDos is great at managing stdin and stdout, but what about parameters?<br />
<br />
Thanks,<br />
Thierry</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">16th November 2005, 09:12</div></div><div class="posttext">It not manages command line parameters. ExeDos uses CreateProcess() with first plug-in parameter as lpCommandLine parameter for this call. In your case this is<br />
&quot;sc&quot; config &quot;Apache Tomcat 4.1&quot; obj= .\$R8 password= $R6)<br />
where sc is module to execute and other strings are parameters. <br />
MSDN: &quot;First quoted string indicates where the filename ends and the arguments begin.&quot; I see 6 or more (argc, argv) parameters in your command line (more if $R8 or $R6 include spaces). Are you sure that spaces after '=' required?<br />
And again from MSDN: &quot;If the process to be created is an MS-DOS - based or 16-bit Windows-based application, lpCommandLine should be a full command line in which the first element is the application name. Because this also works well for Win32-based applications, it is the most robust way to set lpCommandLine.&quot; So better use full path.<br />
BTW your parameters differ from sc.exe 'usage' I see on my WinXP. Is '$R8)' correct parameter? And you can use log file to check process output (last plug-in parameter).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thelliez</div><div class="date">16th November 2005, 17:11</div></div><div class="posttext">Thanks for your answer.<br />
<br />
My initial string was not totally correct. I forgot one '(', and below I made the var names more obious:<br />
<br />
<br />
(&quot;sc&quot; config &quot;Apache Tomcat 4.1&quot; obj= .\$USER password= $PASSWORD) <br />
<br />
Yes the spaces before obj and password are required. I know, that's a word syntax... but there are plenty of examples on the web doing that. I was able to validate that from the cmd command line.<br />
<br />
The parenthesis were added as an attempt to work with ExecDos (I also tried nsExec). The multiple double quotes could be an issue. The parenthesis work fine under MS-DOS and Windwos 2003.<br />
<br />
From your message I gather that the following should work:<br />
ExecDos::Exec '(&quot;sc&quot; config &quot;Apache Tomcat 4.1&quot; obj= .\$USER password= $PASSWORD)' &quot;&quot; &quot;&quot; <br />
<br />
But it did not...<br />
Thierry</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">16th November 2005, 18:21</div></div><div class="posttext">I changed vars to strings for my test only, and both in the black console window (with and without () )<br />
&gt;&quot;sc&quot; config &quot;Apache Tomcat 4.1&quot; obj= .\USER password= PASSWORD<br />
and in the ExecDos stdout.log <br />
ExecDos::Exec '&quot;$SYSDIR\sc.exe&quot; config &quot;Apache Tomcat 4.1&quot; obj= .\USER password= PASSWORD' &quot;&quot; &quot;$EXEDIR\stdout.log&quot;<br />
Pop $1 ; bat exit code<br />
MessageBox MB_OK &quot;Exit code=$1&quot;<br />
<br />
I had the same result:<br />
[SC] OpenService FAILED 1060:<br />
This means that sc.exe starts. And you can try to understand the problem with parameters using stdout. BTW my XP offers another sc command line, but, probably &lt;server&gt; parameter is optional:<br />
sc &lt;server&gt; config [service name] &lt;option1&gt; &lt;option2&gt;...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">16th November 2005, 18:39</div></div><div class="posttext">This line successfully executes sc (not your command, but I can test this on my home PC)<br />
    ExecDos::Exec /TIMEOUT=3000 '&quot;$SYSDIR\sc.exe&quot; qc dnscache 1024' &quot;&quot; &quot;$EXEDIR\stdout.log&quot;<br />
[SC] GetServiceConfig SUCCESS<br />
...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>