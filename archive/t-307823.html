<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstaller Issues, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstaller Issues NSIS Discussion" />
	
	<title> Uninstaller Issues [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstaller Issues</div>
<hr />
<div class="pda"><a href="t-307823.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=307823">Uninstaller Issues</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">wintergreen53</div><div class="date">30th June 2009, 14:57</div></div><div class="posttext">Hi all,<br />
<br />
I'm having a very strange problem with the uninstaller. Here's the flow of the problem: <br />
1) User installs program<br />
2) User uninstalls program, doesn't reboot<br />
3) User installs program again<br />
4) User reboots system. <br />
<br />
When the system starts up again the application files the uninstaller was supposed to delete get deleted. Unfortunately, the files it deletes are the newly installed ones! Is there any way to prevent this from happening?<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th June 2009, 16:18</div></div><div class="posttext">If HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\PendingFileRenameOperations value exists then you can prompt the user to reboot first.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wintergreen53</div><div class="date">2nd July 2009, 19:36</div></div><div class="posttext">But my application isn't the only thing that can write to that key from what I understand, checking for it's existence wouldn't solve my issue completely. <br />
<br />
Is there a way I can parse the registry string to see if it contains the file I'm looking for?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th July 2009, 14:27</div></div><div class="posttext">Only installations should ever write to that registry key in theory, but if you really have to check the values I'm sure you can loop through the entries using EnumRegValue. I cannot remember the format off the top of my head.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thek</div><div class="date">6th July 2009, 15:32</div></div><div class="posttext">What about controlling it manually?<br />
<br />
the uninstaller could create a file or regkey if he has to reboot. This flag can be checked by the installer (and reset if not needed any more).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th July 2009, 16:25</div></div><div class="posttext">But then you'd need to delete the registry value after the reboot (maybe another executable run via RunOnce).<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>