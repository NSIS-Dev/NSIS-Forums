<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait problem with Installshield uninstalls, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait problem with Installshield uninstalls NSIS Discussion" />
	
	<title> ExecWait problem with Installshield uninstalls [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait problem with Installshield uninstalls</div>
<hr />
<div class="pda"><a href="t-308381.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=308381">ExecWait problem with Installshield uninstalls</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">todd_ingr</div><div class="date">15th July 2009, 19:17</div></div><div class="posttext">Greetings!<br />
<br />
I'm creating an installer that silently uninstalls previous versions of certain applications installed on a machine.  Those products use Installshield.<br />
<br />
Here's my problem.  When I run an ExecWait statement for the silent uninstall of the products, ExecWait moves to the next line prematurely.  This is because Installshield installers and uninstallers spawn a couple of windows during their processes.<br />
<br />
My question is this.  How can I successfully wait for the silent uninstall to finish before moving on?  I can't use a Sleep statement because that's just masking the problem and times vary based upon the individual machines I'm working with.<br />
<br />
At any rate, here's my ExecWait code.<br />
ReadINIStr ${TEMP1} &quot;$PLUGINSDIR\test.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
  ${If} ${TEMP1} == &quot;1&quot;<br />
            ExecWait '&quot;C:\Program Files\InstallShield Installation Information\${guid}\setup.exe&quot; /w /s /f1$PLUGINSDIR\uninstall.iss /runfromtemp /l0x0409 /removeonly'<br />
  ${EndIf}<br />
<br />
Thanks for any input!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">15th July 2009, 20:11</div></div><div class="posttext">According to http://www.appdeploy.com/tips/detail.asp?id=18 you should add the /SMS switch.<br />
See http://www.appdeploy.com/articles/InstallShield%20Setup%20Parameters.pdf for even more switches.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">todd_ingr</div><div class="date">15th July 2009, 20:36</div></div><div class="posttext">Originally posted by jpderuiter <br />
According to http://www.appdeploy.com/tips/detail.asp?id=18 you should add the /SMS switch.<br />
See http://www.appdeploy.com/articles/InstallShield%20Setup%20Parameters.pdf for even more switches. <br />
<br />
Yeah, I have tried that.  It appears that it only works for InstallScript MSI projects.  Which mine don't appear to be.<br />
<br />
http://kb.acresso.com/doc/Helpnet/installshield15helplib/IHelpSetup_EXECmdLine.htm</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">15th July 2009, 22:03</div></div><div class="posttext">Hmm, OK.<br />
And the /w switch doesn't work either appearantly.<br />
<br />
What program are you uninstalling?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">todd_ingr</div><div class="date">15th July 2009, 22:21</div></div><div class="posttext">Originally posted by jpderuiter <br />
What program are you uninstalling?  <br />
<br />
Proprietary software.  Unfortunately, it's not something available to you.  <br />
<br />
I'm in software testing and each build of our product requires all other versions to be uninstalled.  It's a painstaking process of uninstall them manually.  So I am looking for a method to uninstall them quietly.  And while I can execute the individual uninstallers quietly, I can't seem to get NSIS to wait.  <br />
<br />
I'm to the point now where I don't know if I can get this accomplished.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">15th July 2009, 23:18</div></div><div class="posttext">Hmm, there are two things I can think of, but neither one is pretty:<br />
1 - wait until a certain file or registry entry is deleted<br />
2 - wait until a certain process stopped (with Processes Plugin)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th July 2009, 01:30</div></div><div class="posttext">If it's an InstallShield setup you should be able to extract the MSI file from it and run that. The reason it isn't waiting is probably because the wrapper executable is running msiexec.exe and then exiting.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">16th July 2009, 10:39</div></div><div class="posttext">Yes, but that's what the SMS switch is for.<br />
<br />
Extracting the MSI might be a good idea, but since it doesn't appear to be a InstallScript MSI installer, this will probably fail as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th July 2009, 11:21</div></div><div class="posttext">You've got an installer in 'InstallShield Installation Information' but you don't think it's an InstallShield setup? InstallScript is just the scripting language used for InstallShield setups so /sms should work in combination with /s.<br />
<br />
Otherwise for extracting the MSI, if you run the setup you should see an MSI file appear in %TEMP%.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">todd_ingr</div><div class="date">16th July 2009, 14:26</div></div><div class="posttext">Originally posted by Afrow UK <br />
You've got an installer in 'InstallShield Installation Information' but you don't think it's an InstallShield setup? InstallScript is just the scripting language used for InstallShield setups so /sms should work in combination with /s.<br />
<br />
Otherwise for extracting the MSI, if you run the setup you should see an MSI file appear in %TEMP%.<br />
<br />
Stu  <br />
<br />
The /SMS and /s in combination do not cause the installer to wait.  So my best option seems to be extracting that MSI.<br />
<br />
When I run the MsiExec.exe /I{guid}, I get the following error:<br />
<br />
&quot;This installation can not be run by directly launching the MSI package; you must run setup.exe.&quot;</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>