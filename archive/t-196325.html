<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Is the computer connected, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Is the computer connected NSIS Discussion" />
	
	<title> Is the computer connected [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Is the computer connected</div>
<hr />
<div class="pda"><a href="t-196325.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=196325">Is the computer connected</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">KenA</div><div class="date">11th October 2004, 17:19</div></div><div class="posttext">Hi,<br />
<br />
I didn't find anything like this in the archives, so this is my humble contribution to the NSIS community, a code snippet to determine if the computer is connected through a LAN, by modem or by proxy.<br />
<br />
Unfortunately, if the computer is connected to a router, it will still count as a valid connection, even if the router itself isn't connected to the internet. :( Some may still find it useful.<br />
<br />
Comments are of course welcome. :)<br />
<br />
KenA</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th October 2004, 17:21</div></div><div class="posttext">What's wrong with the Dialer plug-in?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">KenA</div><div class="date">11th October 2004, 17:32</div></div><div class="posttext">Originally posted by kichik <br />
What's wrong with the Dialer plug-in? <br />
D'oh ! Nothing at all. It's just me making a fool of myself by re-inventing the wheel. :o <br />
<br />
KenA</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">12th October 2004, 09:30</div></div><div class="posttext">Originally posted by kichik <br />
What's wrong with the Dialer plug-in? <br />
<br />
Dialer plug-in size is 4 kB.  <br />
<br />
If installer already uses System plug-in, 'pure' script variant decreases package size.<br />
<br />
BTW my MSDN says that first parameter is &quot;OUT LPDWORD lpdwFlags&quot;, so you can skip it's initialization. Simply:<br />
<br />
System::Call 'wininet.dll::InternetGetConnectedState(*i .r11, i 0) .r10'<br />
StrCmp $R0 &quot;0&quot; 0 +2<br />
MessageBox  ...<br />
Quit</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">14th October 2004, 00:46</div></div><div class="posttext">I use this function:<br />
pardon the text formatting.....<br />
<br />
Function InternetConnection<br />
;Check Internet Connection by calling Explorer with the System Plugin<br />
<br />
Banner::show /NOUNLOAD /set 76 &quot;Checking for an Internet connection.&quot; &quot;Please Wait&quot;<br />
<br />
System::Call &quot;wininet::InternetCheckConnection( \<br />
  t 'http://www.google.com/', \<br />
  i ${FLAG_ICC_FORCE_CONNECTION}, i 0) i .r0&quot;<br />
StrCmp $0 &quot;error&quot; noie3 +1<br />
StrCmp $0 &quot;0&quot; noconnection success<br />
 <br />
<br />
noie3:<br />
      Banner::Destroy<br />
MessageBox MB_OK|MB_ICONSTOP &quot;Please Connect the Internet to see the Fonovisa Player.&quot;<br />
       abort ;Quit ;This will quit the installer. You might want to add your own error handling.<br />
<br />
noconnection:<br />
      Banner::Destroy<br />
MessageBox MB_OK|MB_ICONSTOP &quot;Please Connect the Internet to see the Fonovisa Player.&quot;<br />
       abort ;Quit ;This will quit the installer. You might want to add your own error handling.<br />
<br />
success:<br />
Banner::Destroy<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">14th October 2004, 13:07</div></div><div class="posttext">MSDN, InternetCheckConnection: &quot;If lpszUrl is non-NULL, the host value is extracted from it and used to ping that specific host.&quot; Some sysadmins just close ICMP (ping) traffic on firewall, so this may not work for a big part of users. And you must be sure that host will answer - this is not constant value too, google may be down or they can turn off ICMP after DOS atack. <br />
So better use your real destination host URL, but this still not gives 100% guarantee.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">14th October 2004, 22:27</div></div><div class="posttext">so what would you recommend?<br />
<br />
System::Call 'wininet.dll::InternetGetConnectedState(*i .r11, i 0) .r10'<br />
StrCmp $R0 &quot;0&quot; 0 +2<br />
MessageBox ...<br />
Quit<br />
<br />
or<br />
<br />
using NSISDL::download with a timeout ?<br />
<br />
many thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">28th June 2005, 13:10</div></div><div class="posttext">InternetCheckConnection crashed installer on Win98. Is there another way to ping server?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">28th June 2005, 13:37</div></div><div class="posttext">Yep, because wininet.dll is not always available on all os's</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">28th June 2005, 14:42</div></div><div class="posttext">From MSDN (about InternetCheckConnection):<br />
<br />
Function Information<br />
<br />
Windows NT Use version 4.0. Implemented as ANSI and Unicode functions. <br />
Windows Use Windows 95 and later. Implemented as ANSI and Unicode functions. <br />
Header Wininet.h <br />
Import library Wininet.lib <br />
Minimum availability Internet Explorer 3.0 (ANSI only), 5 (ANSI and Unicode) <br />
<br />
The same problem: link (http://www.msusenet.com/archive/index.php/t-2694640.html).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">28th June 2005, 15:28</div></div><div class="posttext">onad <br />
Yep, because wininet.dll is not always available on all os's <br />
This dll came with IE in old Windows versions Minimum availability Internet Explorer 3.0, the only OS without wininet I remember is Win95 Gold :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">12th July 2005, 16:42</div></div><div class="posttext">What about Windows ME? Can somebody check work of this function on this platform?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>