<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Verifying Directories, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Verifying Directories NSIS Discussion" />
	
	<title> Verifying Directories [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Verifying Directories</div>
<hr />
<div class="pda"><a href="t-209626.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=209626">Verifying Directories</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">howser123</div><div class="date">6th March 2005, 01:12</div></div><div class="posttext">Hi<br />
Im trying to verify a file exsists within a directory that the user selects. Basically the program Im installing needs to know where msacess.exe is, so I have used PageEX directory to create a selection page that stores the directory in variable $acessdir. However, I cant for the life of me figure out how to verify that msacess.exe exists within the directory the user has chosen, and thus allow them to progress to the next page (ie. next&gt; button is enabled).<br />
<br />
Im a bot of a novice, so Im sure its an easy question....<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">howser123</div><div class="date">6th March 2005, 10:43</div></div><div class="posttext">While I was waiting for a perly I decided to search the archives, and found a few handy scripts to find access versions etc. I also thought that perhaps I could search for access in the registry, and make its path the default when the 'Choose location of msaccess.exe' page comes up. However, can I do this using PageEX, or will I have to use a custom page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th March 2005, 11:14</div></div><div class="posttext">You need to create a custom page using InstallOptions.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">howser123</div><div class="date">6th March 2005, 22:26</div></div><div class="posttext">Thnaks Stu, Will give it a try....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Fred4711</div><div class="date">17th March 2005, 08:56</div></div><div class="posttext">@Afrow UK<br />
i dont know how to create a custom page for this Problem.<br />
Can you give us an example ?? Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">17th March 2005, 09:17</div></div><div class="posttext">Oh sorry, you can still use your PageEx if you want a simple solution.<br />
Inside your PageEX block, use:<br />
PageCallbacks &quot;&quot; &quot;&quot; msaLeave<br />
<br />
Then outside create a...<br />
Function msaLeave<br />
 IfFileExists &quot;$accessdir\msacess.exe&quot; +3<br />
  MessageBox MB_OK|MB_ICONEXCLAMATION &quot;msaccess.exe is not located in that folder!&quot;<br />
  Abort<br />
FunctionEnd<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Fred4711</div><div class="date">17th March 2005, 10:38</div></div><div class="posttext">Thanx a lot, works fine<br />
now only a little Question when i use the Browse Button to select the Directory, the Installer change the Directory when i select c:\temp to c:\temp\installdir.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>