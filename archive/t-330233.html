<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ARP registry - quotes or no quotes, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ARP registry - quotes or no quotes NSIS Discussion" />
	
	<title> ARP registry - quotes or no quotes [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ARP registry - quotes or no quotes</div>
<hr />
<div class="pda"><a href="t-330233.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330233">ARP registry - quotes or no quotes</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">2nd May 2011, 06:55</div></div><div class="posttext">This has bothered me for some time now. In the wiki: http://nsis.sourceforge.net/Add_uninstall_information_to_Add/Remove_Programs<br />
Some guy says that &quot;you should always quote the path to make sure spaces in the path will not disrupt Windows to find the uninstaller.&quot; So the wiki example ends up with this:<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\ImageMaker&quot; &quot;UninstallString&quot; &quot;$\&quot;$INSTDIR\uninstall.exe$\&quot;&quot;<br />
<br />
As far as I can judge this is just plain wrong. I never quote the path, and it works just fine. Is there some legacy reason why one would add quotes to the regstring? Because if not, I'm going to delete this erroneous info from the wiki.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd May 2011, 09:51</div></div><div class="posttext">You should add quotes in case the path contains spaces. ExecWait in the docs explains why.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smurge</div><div class="date">2nd May 2011, 10:57</div></div><div class="posttext">Windows itself does not need any &quot;&quot; on path or any value in the registry, as far as i know.<br />
<br />
I have tested an installation without &quot;&quot;  after the &quot;InstallPath&quot; and used  ()+´á#  and space in the install path. It deinstalled without error.<br />
Maybe it depends on the app itself if &quot;&quot; is needed or not. e.g. for switches or functions of the .exe!?<br />
<br />
ExecWait starts an application outside the installer. This have nothing to do with the Registry entry.<br />
I guess it need quotesin this case, because it calls the .exe similar as cmd.exe does...<br />
<br />
bye</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd May 2011, 11:27</div></div><div class="posttext">Windows itself does not need any &quot;&quot; on path or any value in the registry, as far as i know.<br />
<br />
You know this is not true, but lets stick to uninstall in this thread...<br />
<br />
<br />
I have tested ...<br />
But did you test on Win95 and NT4? I'm sure it tells you to use quotes for a reason.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd May 2011, 11:35</div></div><div class="posttext">Add/remove programs handles the path fine on newer OSs with or without quotes probably because it has to deal with the people who have not used them. But one issue goes to your own installer which may want to read the registry value to uninstall a previously installed version. If you've missed quotes from the path and then add /S, it could fail.<br />
<br />
ExecWait starts an application outside the installer. This have nothing to do with the Registry entry.Well of course, but ExecWait uses the CreateProcess API which recommends you should use quotes:If you are using a long file name that contains a space, use quoted strings to indicate where the file name ends and the arguments begin; otherwise, the file name is ambiguous. For example, consider the string &quot;c:\program files\sub dir\program name&quot;. This string can be interpreted in a number of ways. The system tries to interpret the possibilities in the following order:<br />
<br />
    c:\program.exe files\sub dir\program name<br />
    c:\program files\sub.exe dir\program name<br />
    c:\program files\sub dir\program.exe name<br />
    c:\program files\sub dir\program name.exeStu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smurge</div><div class="date">2nd May 2011, 11:42</div></div><div class="posttext">But did you test on Win95 and NT4? I'm sure it tells you to use quotes for a reason. <br />
ähm, i tested it on 98SE. I thought this is the oldest version anyone will use... but maybe im wrong ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd May 2011, 11:50</div></div><div class="posttext">ähm, i tested it on 98SE. I thought this is the oldest version anyone will use... but maybe im wrong ;)<br />
<br />
You're arguing with Microsoft, not us lol.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">2nd May 2011, 18:56</div></div><div class="posttext">Stu, thanks for clearing that up, I had not thought of the parameter ambiguity problem. And even without params, if it's officially required by MS then the wiki info is technically correct.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd May 2011, 20:41</div></div><div class="posttext">I could not actually find MS docs that state that the path should be quoted but MSDN is 2000+ these days, and the uninstall info is MSI specific :(</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>