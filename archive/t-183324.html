<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Wrestling with Sections.nsh macros, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Wrestling with Sections.nsh macros NSIS Discussion" />
	
	<title> Wrestling with Sections.nsh macros [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Wrestling with Sections.nsh macros</div>
<hr />
<div class="pda"><a href="t-183324.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=183324">Wrestling with Sections.nsh macros</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Namrok</div><div class="date">14th June 2004, 20:23</div></div><div class="posttext">For the life of me I can't get any of these working.<br />
<br />
I'd assume these lines would unselect these hidden sections<br />
<br />
!insertmacro ClearSectionFlag -FLIGHTWEATHERDATA 1 	<br />
!insertmacro ClearSectionFlag -FLIGHTVPFDATA 1<br />
<br />
Instead they unselect a subsection called FCMAIN which they are not even in!<br />
<br />
And when trying to check if a section is selected or not, I assumed this macro would do that...<br />
<br />
!insertmacro SectionFlagIsSet HOME 1 0 NoHome<br />
<br />
But when one fails, all the rest I macro in fail no matter what.  And when one succeeds, they all do, regardless of the state of the actual section.<br />
<br />
Also, I don't think SectionGetSize picks up on any AddSizes you have in that section.  Unless I'm using all that wrong as well.  I have my SectionGetSize before my AddSize stuff</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">14th June 2004, 21:27</div></div><div class="posttext">Attach your script, or at least a minimal working version. Then maybe someone can tell you what's going wrong.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Namrok</div><div class="date">15th June 2004, 14:14</div></div><div class="posttext">Ok, here is my script.  This is a callback after the components page.  My setup has 3 different directories to install components too, so I want the directory pages to display 3 difference &quot;Space Required&quot; things.  Thats another problem though.  Right now, I can't get this to have the right drive spaces by the end.  Either they all pass, or they all fail.  My sections are set up like this.<br />
<br />
FCMAIN<br />
   HOME<br />
   DATA<br />
FLIGHTWEATHER<br />
-FLIGHTWEATHERDATA<br />
FLIGHTVPF<br />
-FLIGHTVPFDATA<br />
Help<br />
<br />
I only want the hidden sections which are paired with the nonhidden sections (FLIGHTVPF and -FLIGHTVPFDATA for example) to be installed if their non hidden counterpart is installed.  Also, those powers of 2 I added to the drive totals, I only did that so far so I could test this out without having to add actual files.  It will be replaced with the $R0 that is filled with the SectionGetSize<br />
<br />
So far I think the core of my problem is that no matter what, those section.nsh macros always just check that FCMAIN subsection.  If HOME or DATA are not selected, all the macros fail and my drives all end up at 0.  If they are both selected, all my drives always end up at 85, 10, and 32 (meaning all the components are going to be installed) even if FLIGHTVPF or HELP or something is disabled.  What I don't get is, I know I'm passing it in right, because I even added messageboxes to the macros for a little while so that I knew the parameters were getting passed correctly.  Any help here?  Also, those ClearSectionFlag macros always clear FCMAIN instead of the sections I specified.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">15th June 2004, 15:35</div></div><div class="posttext">You were calling all Section commands (macro or otherwise), incorrectly.<br />
Make sure that you set the section indexes for your sections as well.<br />
See the attached script and make the necessary changes to your script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Namrok</div><div class="date">15th June 2004, 16:47</div></div><div class="posttext">Thanks, that got it.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>