<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MD5 plugin, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MD5 plugin NSIS Discussion" />
	
	<title> MD5 plugin [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MD5 plugin</div>
<hr />
<div class="pda"><a href="t-117789.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=117789">MD5 plugin</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">IGx89</div><div class="date">14th December 2002, 00:22</div></div><div class="posttext">I needed a MD5 plugin for an auto-updater (see it in action here (http://www.wulfram.com/download.php)) I've made with NSIS, and since I didn't find any, I made my own :). I haven't renamed a bunch of stuff from the original exdll, so just ignore that. I used MSVC++ .NET to make it, so if you have VC++ 6, you might have to convert it using the converter over at www.CodeProject.com, or start the project from scratch.<br />
<br />
The final size of the dll is 40.5kb using VC++ .NET Standard, and 22.5kb after packing it with UPX. I've tried to make it smaller, with no avail. If anyone can cut in half (or more :)) its size, you have my undying gratitude :)<br />
<br />
Enjoy!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th December 2002, 14:19</div></div><div class="posttext">I don't know how this is done with VC7, but you shouldn't link to the default libraries (libc). If you do this you won't be able to use any libc functions including memset (use mini_memset from NSIS sources), sprintf (use wsprintf), strncat (use lstrcat instead [no n, but this can be done manually]), strcpy (use lstrcpy), new and delete (you will have to define your own [IO does that]), strlen (use lstrlen instead), fopen and friends (use CreateFile, CloseFile, ReadFile and WriteFile instead), and memcpy (use mini_memcpy or my_memcpy from one of NSIS contribs). There are more functions you can't use, but those are the ones I have found in your source code. After you dump libc your DLL will be cut at least in half.<br />
<br />
You should also rename DllMain back to _DllMainCRTStartup and set the entry point to _DllMainCRTStartup.<br />
<br />
Nice idea BTW, submit it to Sunjammer's NSIS Archive when it's ready (and the new archive is ready too).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">IGx89</div><div class="date">14th December 2002, 15:13</div></div><div class="posttext">Thanks for the tips! I actually did specify no default, and then manually added in libc.lib. That brought it down from 50kb to 40kb. I'll try what you said, and see if I can get it to work :)<br />
<br />
BTW, why did you suggest for me to rename the entry point? What does that do?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th December 2002, 15:25</div></div><div class="posttext">It makes it smaller too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">IGx89</div><div class="date">14th December 2002, 16:13</div></div><div class="posttext">Goody :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">IGx89</div><div class="date">15th December 2002, 18:35</div></div><div class="posttext">It won't let me use new or delete, either; I think I'll let someone else do the conversion. I'm not THAT desperate :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th December 2002, 18:43</div></div><div class="posttext">new and delete (you will have to define your own [IO does that])<br />
<br />
;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">30th May 2005, 16:29</div></div><div class="posttext">Matthew &quot;IGx89&quot; Lieder<br />
  Author<br />
<br />
KJD (archive (http://nsis.sourceforge.net/archive/viewpage.php?pageid=413))<br />
  -Modified to reduce size and use exdll.h<br />
   (reduced to about 6KB uncompressed, by removing CRTL dependency)<br />
<br />
Davy Durham<br />
  -MD5.cpp fix (correct for loop used to replace memset, exceeded bounds)<br />
<br />
Shengalts Aleksander aka Instructor<br />
  -New command: &quot;GetMD5Random&quot; for generate random MD5sum<br />
  -Changed names: &quot;GetFileMD5&quot; -&gt; &quot;GetMD5File&quot;, &quot;GetMD5&quot; -&gt; &quot;GetMD5String&quot;<br />
  -Fixed: string lenght error<br />
<br />
<br />
md5dll 0.3</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Clammerz</div><div class="date">16th December 2006, 11:43</div></div><div class="posttext">Apologies for the huge bump, but I was wondering if it was possible to see some sort of progress while calculating a checksum?<br />
<br />
On older machines, it could take quite some time to calculate a checksum for a file in the 10's of MB range, let alone larger files. So it would be nice if such progress display could be added.<br />
<br />
I will probably use a Banner of some sort displaying &quot;Verifying files, please wait...&quot; or something in the meantime though, but it's not a solution I'm all that happy about : P<br />
<br />
I feel like the user should know at all times that the installer is progressing.<br />
<br />
Thank you very much for your time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cobra300</div><div class="date">18th March 2009, 01:53</div></div><div class="posttext">version 1.1 seems has a bug: the result can only be pop to $0. I tried the following code:<br />
<br />
    StrCpy $0 &quot;D0&quot;<br />
    StrCpy $1 &quot;D1&quot;<br />
    Crypto::HashFile &quot;MD5&quot; &quot;$WINDIR\notepad.exe&quot;<br />
    Pop $1<br />
    DetailPrint $0<br />
    DetailPrint $1<br />
<br />
The output is:<br />
<br />
DAF60E13E96ECB67F0EDAA89C6B01B8D<br />
D1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">18th March 2009, 03:39</div></div><div class="posttext">you're referring to the Crypto plugin.  This thread is for the MD5 plugin.  For the Crypto thread, see:<br />
http://forums.winamp.com/showthread.php?postid=1346355<br />
<br />
Plugin URLs:<br />
Crypto: http://nsis.sourceforge.net/Crypto_plug-in<br />
MD5: http://nsis.sourceforge.net/MD5_plugin<br />
<br />
For what it's worth - I did duplicate the behavior you saw - the Crypto thread seems to have other posts referring to the 'empty' result as well.  I'd guess that nothing actually gets set on the stack (as the Pop results in the Errors flag being set) and instead the Crypto plugin dumps its result in $0 directly.  Not a huge issue (although not encouraged), but something that should probably be noted in the docs.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>