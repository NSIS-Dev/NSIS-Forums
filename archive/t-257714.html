<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Why ExecWait wont wait while installation is in progress, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Why ExecWait wont wait while installation is in progress NSIS Discussion" />
	
	<title> Why ExecWait wont wait while installation is in progress [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Why ExecWait wont wait while installation is in progress</div>
<hr />
<div class="pda"><a href="t-257714.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257714">Why ExecWait wont wait while installation is in progress</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mutantbc</div><div class="date">17th October 2006, 07:12</div></div><div class="posttext">Hi,<br />
<br />
I am trying to setup an NSIS script to install 2 third party and 1 application.<br />
<br />
- JDK<br />
- Mysql<br />
- My java app<br />
<br />
<br />
NSIS script:<br />
<br />
    SetOutPath $INSTDIR\installer<br />
    File /r deploy\installer\*<br />
    nsExec::ExecToStack '&quot;$INSTDIR\installer\java\jdk-1_5_0_06-windows-i586-p.exe&quot; /s'<br />
    ; ExecWait - does this wait for mysql.exe to finish the installation? Coz it doesnt wait, it will proceed to install myjarfile.jar.<br />
    ExecWait $INSTDIR\installer\mysql.exe<br />
    <br />
    SetOutPath $INSTDIR<br />
    SetOverwrite on<br />
    File deploy\myjarfile.jar<br />
<br />
<br />
Please advise. Im still new and I've look into the forum and cant find what I want...all is pointing to ExecWait example, am i missing something?<br />
<br />
<br />
Thanks,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n_baua</div><div class="date">17th October 2006, 10:18</div></div><div class="posttext">Hi mutantbc,<br />
<br />
I guess the problem is with your execwait statment<br />
it should look like<br />
ExecWait '&quot;$INSTDIR\installer\mysql.exe&quot;'<br />
<br />
Please try this with all the other installers.<br />
wish you a luck.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th October 2006, 10:24</div></div><div class="posttext">The executed installer probably extracts another installer and executes it without waiting for it. You can use Unattended resources (http://unattended.sourceforge.net/installers.php) to find out how to make it wait for the other installer. For example, InstallShield waits if you pass /SMS on the command line.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mutantbc</div><div class="date">17th October 2006, 10:52</div></div><div class="posttext">Hi kichik,<br />
<br />
Thank you for providing the Unattended resources, but I dont know which system used to create the installer. Is there any other way?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th October 2006, 10:59</div></div><div class="posttext">That site has information about identifying the system used to create the installer. It's usually enough to look under the Version tab in the properties dialog of the executable.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sunlight112</div><div class="date">18th October 2006, 04:40</div></div><div class="posttext">I have the same question so I must post here.<br />
I use ziptoexe to pack these file zip and install it in my folder which I choose. I use command &quot;execwait&quot;.Execwait still work but it is just extract my test_game.exe and not execute file it to set up.<br />
My code here:<br />
Section &quot;TEST_GAME&quot;<br />
  SetOutPath $PLUGINSDIR<br />
  File &quot;c:\test_game.exe&quot;<br />
  Execwait '&quot;test_game.exe&quot;'<br />
  Delete '&quot;test_game.exe&quot;'<br />
  MessageBox MB_OK &quot;Test_Game is installed&quot;<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mutantbc</div><div class="date">18th October 2006, 05:56</div></div><div class="posttext">Hi Kichik,<br />
<br />
Thank you for the information, but unfortunately I've check the jdk installer which is an installshield package and I try to used /s and /sms. It said that it will pause until the installation completes but it didnt. <br />
<br />
Am i lacking something?<br />
<br />
DetailPrint &quot;Launching Java setup&quot; ;I tried to print this message to ensure that java installer is called but it didnt install on my system, why?<br />
nsExec::ExecToStack '&quot;$INSTDIR\installer\java\jdk-1_5_0_06-windows-i586-p.exe&quot; /s /sms /v\&quot;/qn ADDLOCAL=ALL IEXPLORER=1'<br />
DetailPrint &quot;Java Setup finished&quot;<br />
<br />
Please advise.<br />
<br />
Danke</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CancerFace</div><div class="date">18th October 2006, 10:13</div></div><div class="posttext">jdk-1_5_0_06-windows-i586-p.exe is an MSI wrapper which means that when executed it will extract an MSI file in your %TEMP% folder which you can retrieve and use instead of the above EXE.<br />
<br />
Assuming that you include this MSI file in your installation, extract it and launch it directly usingSetOutPath $PLUGINSDIR<br />
File &quot;jdk.msi&quot;<br />
ExecWait '$SYSDIR\msiexec.exe /qb-! /i &quot;$PLUGINSDIR\jdk.msi&quot; ADDLOCAL=ALL IEXPLORER=1'If you don't want to have any windows popping up useExecWait '$SYSDIR\msiexec.exe /qn /i &quot;$PLUGINSDIR\jdk.msi&quot; ADDLOCAL=ALL IEXPLORER=1'<br />
<br />
You may have to add REBOOT=ReallySupress in case it tries to reboot your system<br />
Hope this helps<br />
<br />
CF</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mutantbc</div><div class="date">18th October 2006, 11:50</div></div><div class="posttext">I've check the jdk and it says InstallShield Software Corp on the version tab.<br />
<br />
when I tried to install the jdk, it wont extract the msi to the temp.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CancerFace</div><div class="date">18th October 2006, 12:54</div></div><div class="posttext">when I tried to install the jdk, it wont extract the msi to the tempSure it does. It will first extract the MSI and then execute it.<br />
<br />
I posted my reply after downloading jdk-1_5_0_06-windows-i586-p.exe and running it. It extracts an MSI file in my %TEMP% folder, which I copied over to a new location, renamed as jdk.msi and run it by hand.<br />
CF</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mutantbc</div><div class="date">18th October 2006, 13:36</div></div><div class="posttext">Hi CancerFace,<br />
<br />
I was able to extract the MSI, but i tries to look for COPYRIGHT file located at c:\progra~1\java\...<br />
<br />
On my previous post, I was able to make it work but not in silent installation. Even though I specified the /s for silent mode but /sms work for waiting the installation to complete.<br />
<br />
ExecWait '&quot;$INSTDIR\installer\java\jdk-1_5_0_06-windows-i586-p.exe&quot; /s /sms'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mutantbc</div><div class="date">18th October 2006, 13:55</div></div><div class="posttext">Hi CancerFace,<br />
<br />
Thank you for the input, but the msi(jdk) didnt launch. Here's the script i used:<br />
<br />
ExecWait '$SYSDIR\msiexec.exe /qn /i &quot;$INSTDIR\jdk-1_5_0_06-windows-i586-p.msi&quot; ADDLOCAL=ALL IEXPLORER=1'<br />
<br />
<br />
I've used below syntax to extract the jdk msi:<br />
<br />
jdk-1_5_0_06-windows-i586-p.exe -a -r -f1c:\jdk-1_5_0_06-windows-i586-p.iss<br />
<br />
but the *.iss is no where to be found on drive c:\ but different java msi filename is extracted at c:\</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CancerFace</div><div class="date">18th October 2006, 14:49</div></div><div class="posttext">I think you have confused the use of InstallShield. The command that you issuedjdk-1_5_0_06-windows-i586-p.exe -a -r -f1c:\jdk-1_5_0_06-windows-i586-p.iss<br />
starts an administrative installation and records your answers to an ISS file, however this is used only in InstallScript driven products. JDK comes as an MSI, wrapped in an EXE that starts it up and no InstallScript engine is required. Upon execution of the EXE an MSI file is extracted in your temporery folder and then msiexec.exe is called and executes the extracted MSI.<br />
<br />
What you should do is run the jdk-1_5_0_06-windows-i586-p.exe file, and after it extracts the MSI, without stopping the installation, copy the extracted file to a new location. Rename the extracted MSI file as you like and call it from your installer usingExecWait '$SYSDIR\msiexec.exe /qn /i &quot;&lt;your_folder_with_the_jdk&gt;\jdk.msi&quot; ADDLOCAL=ALL IEXPLORER=1'<br />
<br />
You may want to check out the command line parameters (http://documentation.installshield.com/robo/projects/helplib/IHelpSetup_EXECmdLine.htm) of InstallShield products. You may also look at the JRE silent install instructions (http://appdeploy.com/packages/detail.asp?id=638) to get an idea of what you're after in case you do not want to extract the MSI.<br />
<br />
CF<br />
<br />
PS In your code you are calling an MSI file called jdk-1_5_0_06-windows-i586-p.msi from $INSTDIR and you claim that it does not work. Thinks to check:<br />
1. Did you extract a file called jdk-1_5_0_06-windows-i586-p.msi to $INSTDIR?<br />
2. If yes, did the file actually make it into that folder?<br />
3. Is it called jdk-1_5_0_06-windows-i586-p.msi?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th October 2006, 10:06</div></div><div class="posttext">If it's Java, a simple Google search will give you the best explanation there is. An explanation from Java:<br />
<br />
http://java.sun.com/j2se/1.5.0/docs/guide/deployment/deployment-guide/silent.html<br />
<br />
sunlight112, ExecWait waits in your case, so your question is not related. But the answer is that you've not specified a full path to test_game.exe, so it can't find it. Use ExecWait $PLUGINSDIR\test_game.exe.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mutantbc</div><div class="date">26th October 2006, 02:01</div></div><div class="posttext">Hi CancerFace,<br />
<br />
Thank you for the information provided, i will try it again.<br />
<br />
Originally posted by CancerFace <br />
I think you have confused the use of InstallShield. The command that you issuedjdk-1_5_0_06-windows-i586-p.exe -a -r -f1c:\jdk-1_5_0_06-windows-i586-p.iss<br />
starts an administrative installation and records your answers to an ISS file, however this is used only in InstallScript driven products. JDK comes as an MSI, wrapped in an EXE that starts it up and no InstallScript engine is required. Upon execution of the EXE an MSI file is extracted in your temporery folder and then msiexec.exe is called and executes the extracted MSI.<br />
<br />
What you should do is run the jdk-1_5_0_06-windows-i586-p.exe file, and after it extracts the MSI, without stopping the installation, copy the extracted file to a new location. Rename the extracted MSI file as you like and call it from your installer usingExecWait '$SYSDIR\msiexec.exe /qn /i &quot;&lt;your_folder_with_the_jdk&gt;\jdk.msi&quot; ADDLOCAL=ALL IEXPLORER=1'<br />
<br />
You may want to check out the command line parameters (http://documentation.installshield.com/robo/projects/helplib/IHelpSetup_EXECmdLine.htm) of InstallShield products. You may also look at the JRE silent install instructions (http://appdeploy.com/packages/detail.asp?id=638) to get an idea of what you're after in case you do not want to extract the MSI.<br />
<br />
CF<br />
<br />
PS In your code you are calling an MSI file called jdk-1_5_0_06-windows-i586-p.msi from $INSTDIR and you claim that it does not work. Thinks to check:<br />
1. Did you extract a file called jdk-1_5_0_06-windows-i586-p.msi to $INSTDIR?<br />
2. If yes, did the file actually make it into that folder?<br />
3. Is it called jdk-1_5_0_06-windows-i586-p.msi?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mutantbc</div><div class="date">26th October 2006, 02:07</div></div><div class="posttext">Hi Kichik,<br />
<br />
Maybe your right, the path i specified is incorrect. i will try and double check the script.<br />
<br />
Thanks for your help. i'll get back to this thread if i still have more questions :D<br />
<br />
Originally posted by kichik <br />
If it's Java, a simple Google search will give you the best explanation there is. An explanation from Java:<br />
<br />
http://java.sun.com/j2se/1.5.0/docs/guide/deployment/deployment-guide/silent.html<br />
<br />
sunlight112, ExecWait waits in your case, so your question is not related. But the answer is that you've not specified a full path to test_game.exe, so it can't find it. Use ExecWait $PLUGINSDIR\test_game.exe.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jakorsme</div><div class="date">11th January 2007, 22:12</div></div><div class="posttext">Here is a direct copy/paste from our install script for Java<br />
-----------------<br />
<br />
Function InstallJavaPageLeave<br />
StrCpy $0 &quot;SOFTWARE\JavaSoft\Java Runtime Environment\${JAVA_VERSION}&quot; ; Check if correct Java is installed<br />
# Get JRE installed version<br />
ReadRegStr $2 HKLM $0 JavaHome<br />
StrCmp $2 &quot;C:\Program Files\Java\jre${JAVA_VERSION}&quot; JavaInstalled<br />
;InstallJava:<br />
Banner::show /NOUNLOAD /set 76 &quot;Installing Java Runtime ${JAVA_VERSION}&quot; &quot;Please be patient...&quot; &quot;&quot;<br />
SetOutPath &quot;$TEMP&quot;<br />
File &quot;jre-1_5_0_10-windows-i586-p.exe&quot;<br />
ExecWait '$TEMP\jre-1_5_0_10-windows-i586-p.exe /s /v&quot;/qn ADDLOCAL=jrecore REBOOT=Suppress JAVAUPDATE=0 WEBSTARTICON=0&quot;'<br />
Banner::destroy<br />
Return<br />
<br />
JavaInstalled:<br />
Banner::show /NOUNLOAD /set 76 &quot;Java ${JAVA_VERSION} is already installed&quot; &quot;Continuing...&quot; &quot;&quot;<br />
Sleep 1000<br />
Banner::destroy<br />
;MessageBox MB_OK|MB_ICONEXCLAMATION &quot;Java 1.5 Already Installed - Continuing&quot;<br />
<br />
FunctionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>