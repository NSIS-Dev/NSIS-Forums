<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" log windows is empty when using nsexec, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  log windows is empty when using nsexec NSIS Discussion" />
	
	<title> log windows is empty when using nsexec [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  log windows is empty when using nsexec</div>
<hr />
<div class="pda"><a href="t-297795.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=297795">log windows is empty when using nsexec</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">sofaelch</div><div class="date">24th September 2008, 11:53</div></div><div class="posttext">Hi,<br />
<br />
has someone observed the same behaviour as me.<br />
<br />
When using nsexec the log window (under the progress bar) is always empty.<br />
Not one instrcution is logged there even if the instruction<br />
is something like &quot;CreateShortCut&quot; or &quot;Delete&quot; which are not used with nsexec.<br />
<br />
My nsi script uses modern UI (mui.msh) with multilanguages.<br />
<br />
Thanks in advance for any hint.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">24th September 2008, 12:23</div></div><div class="posttext">Are you using nsExec::ExecToLog?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sofaelch</div><div class="date">24th September 2008, 12:28</div></div><div class="posttext">Sorry, I've forgotton to say that neither nsexec::exec nor nsexec::exectolog are making a difference.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">24th September 2008, 12:29</div></div><div class="posttext">Can you attach script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sofaelch</div><div class="date">24th September 2008, 15:49</div></div><div class="posttext">in the attached zip file is a nsh file used by nsi script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">25th September 2008, 07:49</div></div><div class="posttext">Does the file D:\Service\subinacl.exe exists? Does it make output to command line?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sofaelch</div><div class="date">25th September 2008, 07:58</div></div><div class="posttext">Of course the file exists. It is fro changing the access right on file/directory and can be downloaded from Microsoft.<br />
I think it is part of one of the resource kits.<br />
<br />
Yes, subinacl.exe does make output to the command line like the log.exe which is called in the *.nsh file.<br />
But this output is what I want to hide. <br />
But I do not want to hide all other output produced by the NSIS commands like &quot;delete, rmdir ...&quot; or at the end the line completed</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">25th September 2008, 08:23</div></div><div class="posttext">I see where is the problem. SubInACL's output to command line is in some extended mode (coloured text) and I think, that nsExec plugin can't handle it. You can try it yourself: subinacl.exe /? or subinacl.exe /? &gt; output.txt (weird output too). I tried to nsExec::ExecToLog 'subinacl.exe /?' (attached) and it returns different values each time (why?).<br />
<br />
My solution: Try to redirect output to file and parse/print that file<br />
 OR<br />
you can use SubInACL's /outputlog switch.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sofaelch</div><div class="date">29th September 2008, 07:45</div></div><div class="posttext">Subinacl.exe ist not the problem nor is nsexec (in all variantes).<br />
<br />
So I debugged a bit further and I found out that the problem is caused by the macro ${locate} from Usefull FileFuncs.snh used in my *.nsh file. <br />
<br />
If I use instead of this &quot;locate macro&quot; the plugin variante from NSIS homepage with ${loacte::open} and ${loacte::finde} etc. Then every works fine!<br />
<br />
Please do not ask me why. I have no clue.<br />
<br />
If you set SetDetailPrint both after the ${Locate} call everything works fine also.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">29th September 2008, 07:54</div></div><div class="posttext">OK, but why is nsExec giving weird output each time when executing subinacl.exe /?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sofaelch</div><div class="date">29th September 2008, 09:02</div></div><div class="posttext">No idea, but it works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">29th September 2008, 09:16</div></div><div class="posttext">Excuse me, my attached script gives you right output (Subinacl's command line help)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">2nd October 2008, 07:42</div></div><div class="posttext">Some programs require terminal emulation and do not work with simple plug-ins for CLI input-output redirection (nsExec, ExecDos). Colored text is a terminal feature, so subinacl will not work here. 'Usage' printout may work in a 'short loop' and just puts text to stdout, not sends any escape sequences (but on my comp I see grayed text for /help as well).<br />
Another example of such utility is telnet.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>