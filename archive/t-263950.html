<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Locate and return names multiple similar files, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Locate and return names multiple similar files NSIS Discussion" />
	
	<title> Locate and return names multiple similar files [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Locate and return names multiple similar files</div>
<hr />
<div class="pda"><a href="t-263950.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=263950">Locate and return names multiple similar files</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">carlosfocker</div><div class="date">18th January 2007, 20:49</div></div><div class="posttext">MY goal is to be able to look in the Microsoft SQL data folder for databases file that my installer detached and tagged (file tage=&lt;Dbname&gt;_DateTimeStamp.mdf) when the software was uninstalled and display them to the user when they are reinstalling so they can select if they want to use them or not.<br />
<br />
So far I am able to do this for one file but I need to display all DB files in the SQL data directory. I'm have problems figuring out how to do this with the locate function.  It only returns the last found file.  Is there a way to loop the locate function and return the file name for each file it finds until there are no more file by the name its searching? I have been searching like this:<br />
<br />
${Locate} &quot;c:\test&quot; &quot;/L=F /M=dbname2311*.mdf&quot; &quot;FileParse&quot;<br />
<br />
Also, Is there a string function that allows you to insert characters at a specific point in a string. Like this. <br />
<br />
String = &quot;11122006&quot;<br />
<br />
insert &quot;/&quot; after 2 charactor<br />
<br />
Now I Have 11/122006</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">18th January 2007, 20:59</div></div><div class="posttext">Is there a way to loop the locate function and return the file name for each file it finds until there are no more file by the name its searching?I believe this is similar with the given example on the following forum thread.<br />
All you need to do is to change the empty folders to files.<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=263445</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">18th January 2007, 20:59</div></div><div class="posttext">Also, Is there a string function that allows you to insert characters at a specific point in a string. Like this.<br />
<br />
String = &quot;11122006&quot;<br />
<br />
insert &quot;/&quot; after 2 charactor<br />
<br />
Now I Have 11/122006<br />
StrCpy $0 &quot;11122006&quot; # $0 is 11122006<br />
StrCpy $1 $0 2       # $1 is 11<br />
StrCpy $1 &quot;$1/&quot;      # $1 is 11/<br />
StrCpy $1 $0 &quot;&quot; 2    # $1 is 11/122006</div></div><hr />


<div class="post"><div class="posttop"><div class="username">carlosfocker</div><div class="date">19th January 2007, 15:31</div></div><div class="posttext">Originally posted by Comm@nder21 <br />
StrCpy $0 &quot;11122006&quot; # $0 is 11122006<br />
StrCpy $1 $0 2       # $1 is 11<br />
StrCpy $1 &quot;$1/&quot;      # $1 is 11/<br />
StrCpy $1 $0 &quot;&quot; 2    # $1 is 11/122006 <br />
<br />
That didnt work it returns 122006<br />
<br />
This works tho:<br />
      StrCpy $0 &quot;11122006&quot; # $0 is 11122006<br />
StrCpy $1 $0 2       # $1 is 11 <br />
StrCpy $3 $0 &quot;&quot; 2    # $3 is 122006<br />
StrCpy $1 &quot;$1/&quot;      # $1 is 11/<br />
StrCpy $4 &quot;$1$3&quot;     # $4 is 11/122006</div></div><hr />


<div class="post"><div class="posttop"><div class="username">carlosfocker</div><div class="date">19th January 2007, 18:40</div></div><div class="posttext">Heres what I ended up doing for anyone who is interested. Forgive me for the poor commenting I have a deliverable to meet.;)I will update at later time if anyone cares.<br />
<br />
This takes a directory path specified in $SQLDATA searches through it for the file value you specified (expamle: watchdb2311*.mdf) and as long as the file is in this format (&lt;name&gt;_MMDDYYYYmmss) it will extract the data and time in the file and return it as MM/DD/YYYY mm:ss to the field number for a DropList you specify in a custom page. <br />
<br />
<br />
Function FileParse<br />
<br />
         Push &quot;_&quot; #divider char<br />
         Push $R7 #input string<br />
         Call SplitFirstStrPart<br />
         Pop $Split0 #1st part(Garbage)<br />
         Pop $R4 #rest<br />
<br />
         Push &quot;.&quot; #divider char<br />
         Push $R4 #input string<br />
         Call SplitFirstStrPart<br />
         Pop $R5 #1st part<br />
         Pop $Split3 #rest (Garbage)<br />
<br />
         StrCpy $0 &quot;$R5&quot;      # $0 is 11122006<br />
         StrCpy $1 $0 2       # $1 is 11<br />
         StrCpy $2 $0 &quot;&quot; 2    # $3 is 122006<br />
         StrCpy $1 &quot;$1/&quot;      # $1 is 11/<br />
         StrCpy $3 &quot;$1$2&quot;     # $4 is 11/122006<br />
<br />
         StrCpy $4 &quot;$3&quot; 5     <br />
         StrCpy $5 $3 &quot;&quot; 5<br />
         StrCpy $4 &quot;$4/&quot;<br />
         StrCpy $6 &quot;$4$5&quot;<br />
<br />
         StrCpy $7 &quot;$6&quot; 10     <br />
         StrCpy $8 $6 &quot;&quot; 10<br />
         StrCpy $7 &quot;$7 &quot;<br />
         StrCpy $9 &quot;$7$8&quot;<br />
<br />
         StrCpy &quot;$1&quot; &quot;$9&quot; 13     <br />
         StrCpy &quot;$2&quot; $9 &quot;&quot; 13<br />
         StrCpy &quot;$1&quot; &quot;$1:&quot;<br />
         StrCpy &quot;$3&quot; &quot;$1$2&quot;<br />
         <br />
         StrCpy $DBDATESTATE $3<br />
         StrCpy $DBDATE &quot;$3|$DBDATE&quot;<br />
         <br />
         Push $R0<br />
FunctionEnd<br />
<br />
Function GetDBFiles<br />
<br />
    Pop $FieldNumber<br />
    Pop $FileName <br />
<br />
    StrCpy $R2 0<br />
	StrCpy $R3 0<br />
	loop:<br />
	StrCpy $R1 0<br />
    ${Locate} &quot;$SQLDATA&quot; &quot;/L=F /M=$FileName&quot; &quot;FileParse&quot;<br />
	IntOp $R3 $R3 + 1<br />
	IntOp $R2 $R2 + $R1<br />
	StrCmp $R1 0 0 loop<br />
<br />
    WriteINIStr &quot;$PLUGINSDIR\DBCreate.ini&quot; &quot;Field $FieldNumber&quot; &quot;State&quot; &quot;$DBDATESTATE&quot;<br />
    WriteINIStr &quot;$PLUGINSDIR\DBCreate.ini&quot; &quot;Field $FieldNumber&quot; &quot;ListItems&quot; &quot;$DBDATE&quot;<br />
FunctionEnd<br />
<br />
Function .onInit<br />
<br />
         Push &quot;dbnameA2311*.mdf&quot;<br />
         Push &quot;3&quot;<br />
         call GetDBFiles<br />
<br />
         StrCpy $DBDATESTATE &quot;&quot;<br />
         StrCpy $DBDATE &quot;&quot;<br />
         Push &quot;dbnameB2311*.mdf&quot;<br />
         Push &quot;5&quot;<br />
         call GetDBFiles<br />
<br />
FunctionEnd<br />
;);) ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">19th January 2007, 19:20</div></div><div class="posttext">sry, there was a small typo in my script, this one is correct:<br />
<br />
StrCpy $0 &quot;11122006&quot; # $0 is 11122006<br />
StrCpy $1 &quot;$0&quot; 2     # $1 is 11<br />
StrCpy $1 &quot;$1/&quot;      # $1 is 11/<br />
StrCpy $0 &quot;$0&quot; &quot;&quot; 2  # $0 is 122006<br />
StrCpy $1 &quot;$1$0&quot;     # $1 is 11/122006</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>