<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" flash play during installation, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  flash play during installation NSIS Discussion" />
	
	<title> flash play during installation [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  flash play during installation</div>
<hr />
<div class="pda"><a href="t-267685.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267685">flash play during installation</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">aditu.g</div><div class="date">13th March 2007, 11:14</div></div><div class="posttext">I search trough the forum but unfortunately I did not manage to find a solution on this. I am trying to use nsWeb to insert a flash movie and inetc to download a file. What I am not able to do is to merge the two of them in the install page, because nsWeb is using custom page to display the flash and inetc is using the install page. Is there a way to have an installation page displaying the download progress bar inside of it and also to play the flash inside the same page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th March 2007, 19:53</div></div><div class="posttext">Doesn't inetc have an option to download in a pop-up window?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aditu.g</div><div class="date">15th March 2007, 12:04</div></div><div class="posttext">Yes, inetc has banner option.<br />
Still I am not able to run them (nsweb and inetc) simultaneously ... maybe is so easy but I could not figure it out ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">15th March 2007, 13:58</div></div><div class="posttext">Not flash.. but http://nsis.sourceforge.net/AnimGif_plug-in can do the trick with animated gif.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aditu.g</div><div class="date">15th March 2007, 14:25</div></div><div class="posttext">yes. AnimGif does the trick but what if I want to use flash movie. It should be a combination between AnimGif and nsWeb (use the way that AnimGif use the install window to display and make this work on nsWeb. But I'm too stupid to make that.<br />
I think there are few people that will use and enjoy this flash movie play at installation time if someone can fix nsWeb to use not only custom pages to display iself but also the instpage ....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">15th March 2007, 15:30</div></div><div class="posttext">Originally posted by aditu.g <br />
if someone can fix nsWeb to use not only custom pages to display iself but also the instpage .... <br />
There's a popup method in my plugin, see the examples.<br />
BTW: You forgot the write the magic word... &quot;please&quot; ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">15th March 2007, 15:33</div></div><div class="posttext">You may try this (not tested though), create a 2nd 'installer' which include only the custom page the nsWeb and the flash movie and extract it in $PLUGINSDIR, execute it just before launch inetc in banner mode and close it once inetc has finished.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aditu.g</div><div class="date">16th March 2007, 11:04</div></div><div class="posttext">Originally posted by Joel <br />
There's a popup method in my plugin, see the examples.<br />
BTW: You forgot the write the magic word... &quot;please&quot; ;)  <br />
<br />
Please, please, please. Could you be so kind</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">16th March 2007, 19:35</div></div><div class="posttext">Originally posted by aditu.g <br />
Please, please, please. Could you be so kind  <br />
Do you actually read the plugin examples? :mad:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aditu.g</div><div class="date">17th March 2007, 11:51</div></div><div class="posttext">My need is to display the html page (having flash inside) during installation. I can use the popup way but the window will show over installation window and only when is closed will continue the installation process.<br />
I was thinking if there is a way to insert with resource hacker a control in the installation page (106 I think) and make nsweb use this one instead of 1018 from 105. I mean to place a control for the html in the usual place of the show details.<br />
In this way html is inside the installation page...<br />
But like I said I too dumb to figure out a way to do this. Please :rolleyes: help me</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aditu.g</div><div class="date">21st March 2007, 09:29</div></div><div class="posttext">No ideas? If I try to launch the flash and nsweb in popup, the flash is waiting to be close and after that the download is started ... I have made 2 exe: one is displaying the flash in popup, the other is download the files. Is there a way to close the flash popup when download was ended?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">21st March 2007, 09:59</div></div><div class="posttext">I have made 2 exe: one is displaying the flash in popup, the other is download the files.Does this actually work as expected?<br />
I haven't yet the time to compile and test this suggestion, would be nice if you post a minimal example about :)<br />
Is there a way to close the flash popup when download was ended?You could use Takhir's function when download is finished,<br />
http://nsis.sourceforge.net/Find_and_Close_or_Terminate</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aditu.g</div><div class="date">21st March 2007, 12:48</div></div><div class="posttext">Yes, it is working. In the same ugly way I can just taskill the showHTML.exe process instead of kill the window. I still hope that there is another nice way to use together both plugins. here is the example</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">21st March 2007, 13:13</div></div><div class="posttext">Code should reside in section. Below script works as expected,<br />
#Find and Close or Terminate<br />
!define APP_NAME find_close_terminate<br />
!define WND_CLASS &quot;Internet Explorer_TridentDlgFrame&quot;<br />
!define WND_TITLE &quot;&quot;<br />
!define TO_MS 2000<br />
!define SYNC_TERM 0x00100001<br />
!include WinMessages.nsh<br />
<br />
LangString termMsg ${LANG_ENGLISH} &quot;Installer cannot stop running ${WND_TITLE}.\<br />
$\nDo you want to terminate process?&quot;<br />
LangString stopMsg ${LANG_ENGLISH} &quot;Stopping ${WND_TITLE} Application&quot;<br />
<br />
!macro TerminateApp<br />
    Push $0 ; window handle<br />
    Push $1<br />
    Push $2 ; process handle<br />
    DetailPrint &quot;$(stopMsg)&quot;<br />
    FindWindow $0 '${WND_CLASS}' ''<br />
    IntCmp $0 0 done<br />
    System::Call 'user32.dll::GetWindowThreadProcessId(i r0, *i .r1) i .r2'<br />
    System::Call 'kernel32.dll::OpenProcess(i ${SYNC_TERM}, i 0, i r1) i .r2'<br />
    SendMessage $0 ${WM_CLOSE} 0 0 /TIMEOUT=${TO_MS}<br />
    System::Call 'kernel32.dll::WaitForSingleObject(i r2, i ${TO_MS}) i .r1'<br />
    IntCmp $1 0 close<br />
    MessageBox MB_YESNOCANCEL|MB_ICONEXCLAMATION &quot;$(termMsg)&quot; /SD IDYES \<br />
    IDYES terminate IDNO close<br />
    System::Call 'kernel32.dll::CloseHandle(i r2) i .r1'<br />
    Quit<br />
  terminate:<br />
    System::Call 'kernel32.dll::TerminateProcess(i r2, i 0) i .r1'<br />
  close:<br />
    System::Call 'kernel32.dll::CloseHandle(i r2) i .r1'<br />
  done:<br />
    Pop $2<br />
    Pop $1<br />
    Pop $0<br />
!macroend<br />
<br />
!include &quot;MUI.nsh&quot;<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
AutoCloseWindow false<br />
OutFile `download.exe`<br />
<br />
function .onInit<br />
   InitPluginsDir<br />
   File /oname=$PLUGINSDIR\showHTML.exe &quot;showHTML.exe&quot;<br />
functionend<br />
<br />
Section &quot;Dummy Section&quot; SecDummy<br />
   HideWindow<br />
<br />
   exec &quot;$PLUGINSDIR\showHTML.exe&quot;<br />
   sleep 1000<br />
<br />
   inetc::get /caption &quot;Getting main installation&quot; /banner \<br />
   &quot;Please wait ... $\nWinRar is downloading necesary files&quot; \<br />
   &quot;http://www.rarlab.com/rar/wrar37b5.exe&quot; &quot;$PLUGINSDIR\winrar.exe&quot;<br />
<br />
   Pop $R1<br />
   MessageBox MB_OK &quot;Plugin return code: $R1&quot;<br />
<br />
   !insertmacro TerminateApp<br />
<br />
   exec &quot;$PLUGINSDIR\winrar.exe&quot;<br />
<br />
   BringToFront<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aditu.g</div><div class="date">4th April 2007, 12:01</div></div><div class="posttext">Is there a way to put the banner inetc plugin download on the bottom of the popup window of the nsweb html page? I need to integrate somehow the 2 plugins (inetc and nsweb) and display the html flash content and the download progress bar in the bottom of that window. Any help would be greatly appreciated. thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">4th April 2007, 14:47</div></div><div class="posttext">Since nsweb html page, its boundries is all the dialog window, you'll have to change the source code, to reduce the size.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aditu.g</div><div class="date">4th April 2007, 16:31</div></div><div class="posttext">I used Inetc plugin source code and modify resources in the IDDialog2 (used for the banner method). I inserted there a shockwave flash object. Everything looks ok (I test the dialog in MsVC++ with ctrl+T and it is displaying the flash). After I compiled the dll and call the plugin from the installer nothing happen. Please  can someone can take a look and tell me what is wrong ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">4th April 2007, 18:43</div></div><div class="posttext">Looks like common Win32 methods in the DialogBox() call cannot create shockwave flash object in the dialog, this is why plug-in returns &quot;Dialog Error&quot;, to see this pleasePop $0<br />
MessageBox MB_OK $0after plug-in call (present in all samples :) ). You can search internet for samples, this is what I found right now http://www.codeproject.com/useritems/FlashGui.asp</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">6th April 2007, 19:41</div></div><div class="posttext">Attached is a flash player sample for Win32 dialog. Finally you need few lines of code in OnInitDialog function only. I am not sure how good this will be on all platforms, but dialog worked fine during 10 minutes I played with it on XP. You can modify Inetc in the same manner. Please note that player require a full path to swf file (may be set in the command line in this sample).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>