<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Work with $DOCUMENTS, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Work with $DOCUMENTS NSIS Discussion" />
	
	<title> Work with $DOCUMENTS [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Work with $DOCUMENTS</div>
<hr />
<div class="pda"><a href="t-314718.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=314718">Work with $DOCUMENTS</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">CG!</div><div class="date">19th November 2009, 12:13</div></div><div class="posttext">As the thread title says, my installer works with the $DOCUMENT folder by extracting some files there and starting an program afterwards (detected by reading the registry) wich is working with the installed files.<br />
But the program always says &quot;fail&quot;.<br />
So i tried the UAC plugin. No change.<br />
i did set __COMPAT_LAYER env-var for the installer and program started by it only. Still no change.<br />
i even tried to add &quot;ELEVATECREATEPROCESS&quot; to the corresponding registry keys. But still no change.<br />
i can call the prog without problems using java and &quot;state.gThread = new GameEXEThread(cmds);&quot;.<br />
But i don't want to use java but only NSiS instead.<br />
<br />
Anyone having an idea what i'm doing wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zinthose</div><div class="date">24th November 2009, 13:53</div></div><div class="posttext">&lt;insert Guess/Observation&gt;I think it has something to do with executing the program after installation since it was spawned from the original process tree.&lt;/insert&gt;<br />
<br />
I personally try to avoid executing the program after installation as it typically will retain the rights of the installer and is not always desirable.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CG!</div><div class="date">24th November 2009, 15:18</div></div><div class="posttext">i tried to start the program on it's own and with set admin rights but still no change.<br />
i know a java program that starts the same prog with the above mentioned command and it works like a charm.<br />
But due to the fact that i don't want to force the user to have java installed, i thought there is a pure NSiS solution.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zinthose</div><div class="date">24th November 2009, 15:37</div></div><div class="posttext">Is this the error your getting?<br />
<br />
http://colinnewell.files.wordpress.com/2008/06/program-compatibility-assistant.pngImage Source (http://colinnewell.wordpress.com/2008/06/08/nsis-installers-and-windows-vista/)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">24th November 2009, 19:25</div></div><div class="posttext">do you have RequestExecutionLevel in your script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CG!</div><div class="date">24th November 2009, 19:31</div></div><div class="posttext">@Zinthose:<br />
Nope. The prog just says &quot;failed to install&quot;. No UAC or other Windows based message.<br />
it's installing out of $DOCUMENTS by default so there's no way i can change it.<br />
<br />
@Anders:<br />
Yep and it's set to user, which is needed when using the UAC plugin.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">24th November 2009, 19:52</div></div><div class="posttext">are you adding uninstall registry keys?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CG!</div><div class="date">24th November 2009, 21:58</div></div><div class="posttext">No, because they are not needed.<br />
But i don't think this would solve my problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">24th November 2009, 22:33</div></div><div class="posttext">No, because they are not needed.<br />
But i don't think this would solve my problem.I think you are wrong about this. Here is what MSDN has to say about the Program Compatibility Assistant (PCA) The logic used by PCA is to detect if a setup did not complete successfully. It monitors a program detected as setup by Windows Vista and Windows Server 2008 and checks whether the program registers an entry in Add or Remove Programs (ARP). If no entries are created in ARP, PCA concludes that the installer did not complete successfully. It will then wait for the install program to terminate before displaying the UI. If it is an uninstaller, the detection looks for whether an entry was deleted from ARP.The UI it refers to is similar to the screenshot Zinthose supplied. See Application Compatibility: Program Compatibility Assistant (PCA):<br />
<br />
http://msdn.microsoft.com/en-us/library/bb756937.aspx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CG!</div><div class="date">25th November 2009, 03:22</div></div><div class="posttext">Erm... i don't have this problem.<br />
The installation finishes successfull.<br />
But i start a program which is detected by it's registry entry.<br />
This program is meant to import the installed files into the detected program by calling it using the right parameters.<br />
But the program says fail when trying to import the files that was placed in $DOCUMENTS using NSiS.<br />
if i start this program using a java program it works just perfect by using the command mentioned in my first post.<br />
<br />
And no, there's no way to force the program to import the files from a different directory and that's the problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">25th November 2009, 10:51</div></div><div class="posttext">Erm... i don't have this problem.Sorry, I didn't notice your earlier Nope. The prog just says &quot;failed to install&quot; reply.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">25th November 2009, 11:01</div></div><div class="posttext">Originally posted by CG! <br />
Erm... i don't have this problem.<br />
But i start a program which is detected by it's registry entry.<br />
This program is meant to import the installed files into the detected program by calling it using the right parameters.<br />
But the program says fail when trying to import the files that was placed in $DOCUMENTS using NSiS.<br />
if i start this program using a java program it works just perfect by using the command mentioned in my first post.<br />
 <br />
<br />
I don't know what the hell you are even talking about. Could you explain a little better? Is this &quot;program&quot; written in NSIS?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">25th November 2009, 11:19</div></div><div class="posttext">I agree with Anders. CG!, please try to rephrase what you want to accomplish, what you have, and what you need.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CG!</div><div class="date">2nd December 2009, 00:02</div></div><div class="posttext">OK. Sorry for my bad explanation trys but as all of you can see, english is not my native language.<br />
i'll try to explain how it works step-by-step.<br />
<br />
1. NSiS installs files to $DOCUMENTS\Program\Plugins<br />
2. NSiS starts the local software (found using the registry)<br />
3. the started software accesses $DOCUMENTS\Program\Plugins<br />
4. the software tries to install the Plugins<br />
5. the software tells the user that it failed installing<br />
<br />
A similar fan-made program, that is written in java, uses the in the first post mentioned command and it works.<br />
if i start the program myself (with admin rights), it fails.<br />
if i use the NSiS UAC plugin, it fails too.<br />
Same if i set the __COMPAT_LAYER variable and the corresponding registry keys to elevate the process.<br />
<br />
Hope i could make things more clear now.<br />
<br />
<br />
And sorry for the late answer, but i switched my iSP and it didn't works as seemless as planed because my old iSP dc'ed me 5 days to earlie.<br />
Sorry again, but sh... things happen.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>