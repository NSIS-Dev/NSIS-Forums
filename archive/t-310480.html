<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Easy, automated download and installation for Java Runtime, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Easy, automated download and installation for Java Runtime NSIS Discussion" />
	
	<title> Easy, automated download and installation for Java Runtime [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Easy, automated download and installation for Java Runtime</div>
<hr />
<div class="pda"><a href="t-310480.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=310480">Easy, automated download and installation for Java Runtime</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">trumpetinc</div><div class="date">22nd August 2009, 00:23</div></div><div class="posttext">The attached makes adding auto-JRE detection, download and installation easy.<br />
<br />
See JREDyna Wiki Page (http://nsis.sourceforge.net/Java_Runtime_Environment_Dynamic_Installer) for details<br />
<br />
<br />
I look forward to comments and suggestions for improvements.<br />
<br />
- Kevin<br />
<br />
PS - I can't seem to figure out how to get that URL link to work!  Here's the link without http just to get it working:  nsis.sourceforge.net/Java_Runtime_Environment_Dynamic_Installer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">22nd August 2009, 03:59</div></div><div class="posttext">Yeah, you need x number of posts before you can post URL's<br />
<br />
http://nsis.sourceforge.net/Java_Runtime_Environment_Dynamic_Installer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">trumpetinc</div><div class="date">24th August 2009, 22:21</div></div><div class="posttext">Thanks, Anders - that makes sense (although it would have been nice if the forum software issued a warning, eh?)<br />
<br />
I spent a lot of time fighting the system trying to get the Wiki page looking right, and the forum post.  It's a shame that there isn't an easily accessible primer for this sort of thing (just figuring out how to upload a file for the Wiki took quite some doing).  This has to be some level of barrier to entry for folks wanting to share their work.  But I know that we all do what we can - and for this particular contribution, I was more than willing to go through the learning curve.<br />
<br />
Maybe I should put together a Wiki page on tips and tricks to share solutions on the Wiki :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">24th August 2009, 22:45</div></div><div class="posttext">NSIS main page, click FAQ: http://nsis.sourceforge.net/FAQ (At the bottom you will find &quot;Uploading files&quot;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tdcolvin</div><div class="date">18th January 2012, 19:07</div></div><div class="posttext">Hi,<br />
<br />
Registered here just to say -- Windows 2003 seems to require lowercase /s and /l arguments. Otherwise you just get an ugly Windows Installer dialog saying &quot;Invalid command line parameters&quot;.<br />
<br />
So I changed the ExecWait line to:<br />
<br />
  ExecWait '&quot;$TEMP\jre_setup.exe&quot; /s REBOOT=Suppress JAVAUPDATE=0 WEBSTARTICON=0 /l \&quot;$TEMP\jre_setup.log\&quot;' $0<br />
<br />
And it now works fine. Not sure how to upload yet, but hope that helps.<br />
<br />
- Tom</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EolSC</div><div class="date">19th April 2012, 07:19</div></div><div class="posttext">Hi, Kevin!<br />
I've used your script for my open-source application installer, thank you for your great work. But I had to improve it a little to work on modern OS.<br />
For example, I added check if we' re running installer on x64 so we should <br />
read registry in x64 mode. <br />
${If} ${RunningX64} ;if it's x64 OS<br />
  SetRegView 64 ; change registry view mode for proper x64 JRE detection<br />
 ${EndIf}<br />
<br />
  ReadRegStr $1 HKLM &quot;SOFTWARE\JavaSoft\Java Runtime Environment&quot; &quot;CurrentVersion&quot;<br />
  StrCmp $1 &quot;&quot; DetectTry2<br />
  ReadRegStr $2 HKLM &quot;SOFTWARE\JavaSoft\Java Runtime Environment\$1&quot; &quot;JavaHome&quot;<br />
  StrCmp $2 &quot;&quot; DetectTry2<br />
  Goto GetJRE<br />
  ; lots of detection code skipped <br />
  .<br />
  .<br />
  .<br />
DetectJREEnd:<br />
<br />
${If} ${RunningX64} <br />
  SetRegView 32 ; return to x32 view mode<br />
 ${EndIf}<br />
So, post me a message if you are interested, I 'd like to share my improvements with others and add modified version to nsis.wiki</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th April 2012, 12:08</div></div><div class="posttext">You do not need to do the RunningX64 test as SetRegView has no effect on a 32-bit OS (you're just adding 2 unnecessary System plug-in calls per usage).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">trumpetinc</div><div class="date">19th April 2012, 16:51</div></div><div class="posttext">EolSC - I've thought on this a bit...<br />
<br />
There are times when detecting 32 bit JVM is desirable, even on 64 bit systems (for example, we have a number of applications that use 32 bit JNI dlls).  To incorporate this, we'd need to be somewhat intelligent about when we do or do not do the check in the 64 bit registry branches.<br />
<br />
It seems to me that if your installer is wanting the 64 bit JVM installed, then you probably want the entire installer working with the 64 bit area of the registry.  If that's the case, then you should probably be calling SetRegView 64 in the main installer (and not having this call in the area specific to download of the 64 bit JVM)...<br />
<br />
Further, explicitly changing the registry view in a library like this could mess people up who *have* set the registry view elsewhere.  If we are going to do this inside the library, then we'd have to capture the registry view before and set it back to it's prior state afterwards.<br />
<br />
Is there really a need to do this check inside the library itself?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EolSC</div><div class="date">20th April 2012, 07:14</div></div><div class="posttext">Thanks for your replies, now I understand where I'm missing the point. Surely it was a bad idea to mess up library code, I'll move all checks to main installer and clean up unnecessary checks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">trumpetinc</div><div class="date">20th April 2012, 14:31</div></div><div class="posttext">Hah - in this particular case, it's probably best to do the check elsewhere, but there is *nothing* wrong with messing with the library code, trying out new things, then discussing them in these forums.  That's where cool new ideas came from, and I'm delighted that you are willing to poke at it and share your results!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>