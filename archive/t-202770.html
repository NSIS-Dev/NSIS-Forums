<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Matching Start In folder with Target, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Matching Start In folder with Target NSIS Discussion" />
	
	<title> Matching Start In folder with Target [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Matching Start In folder with Target</div>
<hr />
<div class="pda"><a href="t-202770.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=202770">Matching Start In folder with Target</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Artmageddon</div><div class="date">22nd December 2004, 17:06</div></div><div class="posttext">Hey, I'm a bit of a newbie here, so I hope I won't get flamed too badly for asking this question here :)<br />
<br />
Ok, I'm trying to install two applications with a single installer. I want them to have the same root folder $INSTDIR(C:\Program  Files\My Game Bundle), where Game1 would be <br />
<br />
$INSTDIR\Game1<br />
and Game2 would be<br />
$INSTDIR\Game2<br />
<br />
The game files for each game would be in their respective directories, with the uninstaller lying in the top level folder($INSTDIR). While I can get the files copied to the correct location, the problem I'm having is with the shortcuts. With windows shortcuts, you have a &quot;Target&quot; path which links directly to the executable. The &quot;Start In&quot; shortcut links to the top level folder, $INSTDIR. This doesn't work out correctly with Game1, which needs to point directly at the folder in which the exe is located(it has to do with the way the game engine looks for files). How do I make the &quot;Start In&quot; folder point at the same folder the &quot;Target&quot; path is at?<br />
<br />
Yes, I did try searching for this too...but otherwise, have mercy :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">22nd December 2004, 17:18</div></div><div class="posttext">Use SetOutPath first.<br />
<br />
E.g.<br />
SetOutPath &quot;C:\blah&quot;<br />
CreateShortcut &quot;$SMPROGRAMS\blah.lnk&quot; &quot;C:\blah\blah2k.exe&quot;<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Artmageddon</div><div class="date">22nd December 2004, 17:27</div></div><div class="posttext">Well, I'm using SetOutPath to copy all the files and what not, and I install all of the files before creating the shortcut. Now the shortcut finds the exe just fine. The problem is though with the way the game engine is, we need both the &quot;start in&quot; path to directly match the target path. Not to question your wisdom, but I don't know if what you mentioned will be enough.. :)<br />
<br />
(What you have written is pretty much how my Shortcut is made, with the exception that I'm doing the SetOutPath a few lines earlier in the script. I don't think that should make a difference though.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">22nd December 2004, 17:44</div></div><div class="posttext">So basically you want your shortcut to target C:\blah\blah.exe and to start in C:\blah\blah.exe?<br />
<br />
Try to use:<br />
SetOutPath &quot;C:\blah\blah.exe&quot;<br />
<br />
Be warned though that NSIS will create a folder called &quot;C:\blah\blah.exe&quot; :D<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>