<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Disable text box and show default text, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Disable text box and show default text NSIS Discussion" />
	
	<title> Disable text box and show default text [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Disable text box and show default text</div>
<hr />
<div class="pda"><a href="t-289435.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289435">Disable text box and show default text</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kyleprager</div><div class="date">1st April 2008, 09:33</div></div><div class="posttext">Hi, I'm trying to create a screen for my installer that takes user input.  In doing so I need to be able to have the user select a checkbox which will disable a text box and fill it with default text, overwriting whatever was in there when the user selected the checkbox (ie the checkbox will set the textbox to a default value, but it will be visually apparent to the user).  I have figured out how to make the checkbox callback so I can disable the textbox, but I don't know how to put text in the textbox at the same time.  What seems to be a valid command will not work.  Here's the function that the page call to show:<br />
<br />
Function userInput<br />
    InstallOptions::dialog /NOUNLOAD $PLUGINSDIR\inputpage.ini<br />
FunctionEnd<br />
<br />
Here's the funtion I use to validate/callback:<br />
<br />
Function onPageExit<br />
<br />
    push $0<br />
    push $1<br />
    push $R0<br />
    push $R1<br />
    <br />
    # Read which field was changed into $R1<br />
    # Other code that does the same as the &quot;ReadIniStr&quot; line below<br />
    # Code: !insertmacro MUI_INSTALLOPTIONS_READ $R1 &quot;inputpage.ini&quot; &quot;Settings&quot; &quot;State&quot;<br />
    ReadIniStr $R1 &quot;$PLUGINSDIR\inputpage.ini&quot; &quot;Settings&quot; &quot;State&quot;<br />
<br />
    # Goto changestate if a field I care about gets selected<br />
    ${if}     $R1 == 1<br />
        goto changestate<br />
    ${elseif} $R1 == 3<br />
        goto changestate<br />
    ${else}<br />
        goto exit<br />
    ${endif}<br />
    <br />
    # Change state to disabled if enabled and bisa versa<br />
    changestate:<br />
        # Add 1 to $R1 to get the number of the field that will be disabled<br />
        intop $R2 $R1 + 1<br />
        <br />
        # Get handle for field to be disabled/enabled and get<br />
        # the current state of the checkbox that is causing it<br />
        ReadIniStr $0 &quot;$PLUGINSDIR\inputpage.ini&quot; &quot;Field $R2&quot; &quot;HWND&quot;<br />
        ReadIniStr $1 &quot;$PLUGINSDIR\inputpage.ini&quot; &quot;Field $R1&quot; &quot;state&quot;<br />
        <br />
        # Enable if disable, and bisa versa<br />
        StrCmp $1 1 disable enable<br />
    <br />
    disable:<br />
        EnableWindow $0 0<br />
        WriteIniStr &quot;$PLUGINSDIR\inputpage.ini&quot; &quot;Field $R2&quot; &quot;Flags&quot; &quot;DISABLED&quot;<br />
        WriteIniStr &quot;$PLUGINSDIR\inputpage.ini&quot; &quot;Field 2&quot; &quot;State&quot; &quot;DISABLED TEXT BOX&quot;<br />
        pop $R1<br />
        pop $R0<br />
        pop $1<br />
        pop $0<br />
        abort<br />
    <br />
    enable:<br />
        EnableWindow $0 1<br />
        WriteIniStr &quot;$PLUGINSDIR\inputpage.ini&quot; &quot;Field $R2&quot; &quot;Flags&quot; &quot;&quot;<br />
        pop $R1<br />
        pop $R0<br />
        pop $1<br />
        pop $0<br />
        abort   <br />
       <br />
    # Just used to exit the function when we want to leave<br />
    exit:<br />
        pop $R1<br />
        pop $R0<br />
        pop $1<br />
        pop $0<br />
   <br />
FunctionEnd<br />
<br />
<br />
=================<br />
<br />
I've highlighted the line that I think should work but isn't working in RED.  &quot;Field 2&quot; in this case is a text box.  Here's the code from my INI file:<br />
<br />
; Auto-generated by EclipseNSIS InstallOptions Script Wizard<br />
; Feb 22, 2008 8:09:23 PM<br />
[Settings]<br />
NumFields=4<br />
Title=User Input Page<br />
<br />
[Field 2]<br />
Type=Text<br />
Left=103<br />
Top=41<br />
Right=258<br />
Bottom=54<br />
State=<br />
Flags=<br />
<br />
[Field 1]<br />
Type=CheckBox<br />
Left=49<br />
Top=42<br />
Right=94<br />
Bottom=52<br />
Text=Default<br />
State=0<br />
Flags=NOTIFY<br />
<br />
[Field 3]<br />
Type=CheckBox<br />
Left=49<br />
Top=65<br />
Right=94<br />
Bottom=75<br />
Text=Default<br />
State=0<br />
Flags=NOTIFY<br />
<br />
[Field 4]<br />
Type=Text<br />
Left=103<br />
Top=63<br />
Right=258<br />
Bottom=76<br />
<br />
<br />
=================<br />
<br />
What's especially weird is that the highlighted line of code from earlier works if I run it inside of my page-show function just before I show the INI page with InstallOptions.  Here's what I mean:<br />
<br />
<br />
Function userInput<br />
    WriteIniStr &quot;$PLUGINSDIR\inputpage.ini&quot; &quot;Field 2&quot; &quot;State&quot; &quot;DISABLED TEXT BOX&quot;<br />
    InstallOptions::dialog /NOUNLOAD $PLUGINSDIR\inputpage.ini<br />
FunctionEnd<br />
<br />
==============<br />
<br />
That will set my textbox to have the text &quot;DISABLED TEXT BOX&quot; initially, but that line doesn't work when called inside the &quot;onPageExit&quot; function.<br />
<br />
What I want to do is to be able to either put text in the textbox with the checkbox unchecked, or when the checkbox is checked fill the textbox with the text of my choice (in this case it will be a port number).<br />
<br />
Any ideas?  Any help will be much appreciated!  ...Also please let me know if you need any more info or if I've been vague anywhere in this post.  Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">1st April 2008, 09:45</div></div><div class="posttext">You must SendMessage with ${WM_SETTEXT}.<br />
Check the included example testnotify.nsi, it explains everything.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kyleprager</div><div class="date">1st April 2008, 10:16</div></div><div class="posttext">Thank you!  That worked perfectly!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>