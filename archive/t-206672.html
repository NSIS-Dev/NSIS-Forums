<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ReadEnvStr problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ReadEnvStr problem NSIS Discussion" />
	
	<title> ReadEnvStr problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ReadEnvStr problem</div>
<hr />
<div class="pda"><a href="t-206672.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=206672">ReadEnvStr problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">geoffrey_4js</div><div class="date">2nd February 2005, 15:18</div></div><div class="posttext">Hi!<br />
<br />
I'm using ReadEnvStr to get the environement variable PATH (local user).<br />
<br />
The problem is that ReadEnvStr seems to double the PATH (if PATH is C:\WinNT;C:\toto, i get C:\WinNT;C:toto;C:\WinNT;C:\toto)<br />
<br />
<br />
ReadEnvStr $R0 PATH<br />
MessageBox MB_OK &quot;PATH : $R0&quot;<br />
<br />
<br />
How can I make it work ?<br />
<br />
EDIT : in fact ReadEnvStr add the system environement variable PATH to the current user environement variable PATH ! Is it something I miss to make ReadEnvStr only get the current user environement variable ?<br />
<br />
Geoffrey</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd February 2005, 17:24</div></div><div class="posttext">Try ExpandEnvStrings<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd February 2005, 17:28</div></div><div class="posttext">ReadEnvStr $R0 PATH works find for me.<br />
This is the value of PATH for me:<br />
C:\usr\bin\;C:\Perl\bin\;C:\WINDOWS\SYSTEM32;C:\WINDOWS;C:\WINDOWS\SYSTEM32\WBEM;C:\PROGRAM FILES\ATI TECHNOLOGIES\ATI CONTROL PANEL;C:\Program Files\Panda Software\Panda Antivirus Titanium\;C:\Program Files\Panda Software\Panda Titanium Antivirus 2004\;C:\Program Files\Common Files\Autodesk Shared\;C:\Program Files\ATI Technologies\ATI.ACE\;C:\BITWARE\;;C:\PROGRA~1\COMMON~1\AUTODE~1<br />
<br />
No repetitions...<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">geoffrey_4js</div><div class="date">2nd February 2005, 17:36</div></div><div class="posttext">Here is the part of code <br />
ReadEnvStr $R2 PATH<br />
  ${WriteEnvStr} $R7 &quot;PATH&quot; &quot;$R1\fgl\bin;$R1\mysql\bin;$R2&quot;<br />
<br />
And the values I get :<br />
<br />
BEFORE INSTALL :<br />
PATH --&gt; LOCAL USER<br />
C:\Program Files\CVS\CVS\Tcl\bin;C:\WINNT\system32;C:\WINNT;C:\WINNT\System32\Wbem;C:\Program Files\UltraEdit;C:\Program Files\Informix\Client-SDK\bin<br />
PATH --&gt; SYSTEM<br />
C:\Program Files\CVS\CVS\Tcl\bin;C:\WINNT\system32;C:\WINNT;C:\WINNT\System32\Wbem;C:\Program Files\UltraEdit;C:\Program Files\Informix\Client-SDK\bin<br />
<br />
AFTER INSTALL :<br />
PATH --&gt; LOCAL USER<br />
C:\PROGRA~1\FourJs\gep\fgl\bin;C:\PROGRA~1\FourJs\gep\mysql\bin;C:\Program Files\FourJs\gep 1.00.1c\mysql\bin;C:\Program Files\FourJs\gep 1.00.1c\fgl\bin;C:\Program Files\CVS\CVS\Tcl\bin;C:\WINNT\system32;C:\WINNT;C:\WINNT\System32\Wbem;C:\Program Files\UltraEdit;C:\Program Files\Informix\Client-SDK\bin;C:\Program Files\FourJs\gep 1.00.1c\mysql\bin;C:\Program Files\FourJs\gep 1.00.1c\fgl\bin;C:\Program Files\CVS\CVS\Tcl\bin;C:\WINNT\system32;C:\WINNT;C:\WINNT\System32\Wbem;C:\Program Files\UltraEdit;C:\Program Files\Informix\Client-SDK\bin<br />
PATH --&gt; SYSTEM<br />
C:\Program Files\CVS\CVS\Tcl\bin;C:\WINNT\system32;C:\WINNT;C:\WINNT\System32\Wbem;C:\Program Files\UltraEdit;C:\Program Files\Informix\Client-SDK\bin<br />
<br />
It doubles everything.<br />
<br />
I've find a way to escape this but i'm not sure it's clean but it works :<br />
ReadRegStr $R2 HKCU &quot;Environment&quot; PATH<br />
  ${WriteEnvStr} $R7 &quot;PATH&quot; &quot;$R1\fgl\bin;$R1\mysql\bin;$R2&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd February 2005, 18:47</div></div><div class="posttext">There is a special piece (http://nsis.sourceforge.net/archive/viewpage.php?pageid=91) of code for handling the PATH variable. Use that instead of WriteEnvStr.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">geoffrey_4js</div><div class="date">7th February 2005, 11:15</div></div><div class="posttext">Thx kichik, i'll try that.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>