<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" System::Call to run file, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  System::Call to run file NSIS Discussion" />
	
	<title> System::Call to run file [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  System::Call to run file</div>
<hr />
<div class="pda"><a href="t-212022.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=212022">System::Call to run file</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">DennisFeiock</div><div class="date">1st April 2005, 21:51</div></div><div class="posttext">Ok, Im having a hard time here...  I know there is a way to use System::Call to run a file, but I cant seem to find where I saw it at.<br />
<br />
If only psexec would support UNC paths... :rolleyes: <br />
<br />
Anyone have suggestions?<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st April 2005, 22:15</div></div><div class="posttext">Why use System::Call instead of Exec, ExecWait, ExecShell or nsExec? What's psexec?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DennisFeiock</div><div class="date">4th April 2005, 13:33</div></div><div class="posttext">kichik,<br />
<br />
I need to use System::Call to execute a batch file that points to a network share to execute other files.<br />
<br />
PSExec is a small application that lets you run commands on a remote system.  Personally, I use that to push out the applications I create with NSIS (using the -icf switch).  The one big drawback to it is that it does not support network references when using the application.<br />
<br />
What I was hoping to do is to put in the System::Call at the end of my NSIS script to execute a file on a network resource.  Hopefully by using System::Call, it will trick windows into executing the batch file as the current user that is logged in and not as the LocalService account that PSExec uses.<br />
<br />
Heres the link for PSExec for any that are interested:<br />
http://www.sysinternals.com/ntw2k/freeware/psexec.shtml<br />
<br />
 - DF</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">4th April 2005, 15:42</div></div><div class="posttext">System::Call does NOT execute files, it calls FUNCTIONS from dll files. it'll never work, unless you use a windows api function with system::call that runs batches, like ShellExecute.<br />
but this is unnecessary, as you already have a script command available for this.<br />
<br />
for executing files use Exec, ExecWait, ExecShell and nsExec.<br />
<br />
@hesung: post to a new topic plz :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DennisFeiock</div><div class="date">4th April 2005, 16:21</div></div><div class="posttext">Comm@nder21,<br />
<br />
would you happen to know the syntax for ShellExecute?<br />
<br />
I have tried using Exec, ExecWait, ExecShell and nsExec.  The problem is that the application I am using to run the installs remotely, psexec, does not support networking.<br />
<br />
The only thing that I could think of would to be to trick windows into thinking that the user ran the necessary batch file, and not the install executable.<br />
<br />
 - DF</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>