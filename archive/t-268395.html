<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Progress Bar color or style, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Progress Bar color or style NSIS Discussion" />
	
	<title> Progress Bar color or style [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Progress Bar color or style</div>
<hr />
<div class="pda"><a href="t-268395.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=268395">Progress Bar color or style</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">paragrane</div><div class="date">26th March 2007, 08:57</div></div><div class="posttext">Hello !!!!!<br />
<br />
I am using UMUI interface. I want to change the color or style of Pogress bar on MUI_PAGE_INSTFILES page. How to do this?<br />
 I have tried this-----<br />
!define MUI_INSTALLCOLORS &quot;FF0000 00FF00&quot;<br />
!define MUI_INSTFILESPAGE_PROGRESSBAR &quot;colored&quot;<br />
<br />
But it's not working. The error I am getting is-------<br />
&quot;MUI_INSTFILESPAGE_PROGRESSBAR already define&quot; but I cheked that It is defined only one time. I am not getting why the error is comming?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">paragrane</div><div class="date">27th March 2007, 14:13</div></div><div class="posttext">Hello !!!!!<br />
<br />
I am using UMUI interface. I want to change the color or style of Pogress bar on MUI_PAGE_INSTFILES page. How to do this?<br />
I have tried this-----<br />
!define MUI_INSTALLCOLORS &quot;FF0000 00FF00&quot;<br />
!define MUI_INSTFILESPAGE_PROGRESSBAR &quot;colored&quot;<br />
<br />
But it's not working. The error I am getting is-------<br />
&quot;MUI_INSTFILESPAGE_PROGRESSBAR already defined&quot; but I cheked that It is defined only one time. I am not getting why the error is comming?<br />
<br />
Please Help me how to do this</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">27th March 2007, 14:22</div></div><div class="posttext">be sure to define those ABOVE the !insertmacro MUI_PAGE_INSTFILES command.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">paragrane</div><div class="date">28th March 2007, 05:38</div></div><div class="posttext">Hi Comm@nder21<br />
I tried what you said.<br />
!define MUI_INSTFILESPAGE_PROGRESSBAR &quot;colored&quot;<br />
But the above statement give me same error as follows<br />
    &quot;MUI_INSTFILESPAGE_PROGRESSBAR already defined&quot; but I cheked that It is defined only one time. I am not getting why the error is comming?<br />
After that I commented that Statement and I run the program with only  one statement as follows-----<br />
!define MUI_INSTALLCOLORS &quot;FF0000 00FF00&quot;<br />
It does not give any error but it does not change the color of Progress Bar.<br />
So can you give me some code or logic to do that?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SteveRussell</div><div class="date">3rd April 2007, 23:29</div></div><div class="posttext">I am having the same problem.  What is the answer?  Is something wrong with the following?<br />
<br />
!define MUI_INSTFILESPAGE_PROGRESSBAR<br />
!insertmacro MUI_PAGE_INSTFILES</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th April 2007, 16:42</div></div><div class="posttext">Define it above the first page insertion.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SteveRussell</div><div class="date">8th April 2007, 16:53</div></div><div class="posttext">I should have posted that I did finally figure it out, though it was not clear to me why this is required.  Thanks for the confirmation, kichik!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mvisual</div><div class="date">7th September 2011, 23:06</div></div><div class="posttext">I was having problems with this exact issue. Is there any way you can post what you have troubleshooted? <br />
<br />
FYI:<br />
<br />
This is what I'm currently working on troublshooting:<br />
<br />
!include &quot;WinMessages.nsh&quot;<br />
!include &quot;MUI2.nsh&quot;<br />
!include &quot;nsDialogs.nsh&quot;<br />
<br />
OutFile &quot;test.exe&quot;<br />
<br />
Section<br />
SectionEnd<br />
<br />
Var dialog<br />
Var hwnd<br />
Var null<br />
<br />
!define /math PBM_SETRANGE32 ${WM_USER} + 6<br />
<br />
!define MUI_INSTFILESPAGE_PROGRESSBAR &quot;color&quot;<br />
!define RED &quot;0xD0A8A8&quot;<br />
/*!insertmacro MUI_PAGE_INSTFILES*/<br />
<br />
Page Custom page.custom<br />
Function page.custom<br />
    nsDialogs::Create 1018<br />
    Pop $dialog<br />
<br />
    ${NSD_CreateProgressBar} 0 0 100% 15 &quot;0xD0A8A8&quot;<br />
        Pop $hwnd<br />
<br />
     ${NSD_CreateTimer} NSD_Timer.Callback 10<br />
<br />
    nsDialogs::Show<br />
FunctionEnd<br />
<br />
/*Function ProgressBar.Color<br />
!define RED &quot;0xD0A8A8&quot;<br />
!define PINK &quot;0x831618&quot;<br />
FunctionEnd*/<br />
<br />
Function NSD_Timer.Callback<br />
    ${NSD_KillTimer} NSD_Timer.Callback<br />
    SendMessage $hwnd ${PBM_SETRANGE32} 0 100<br />
<br />
    SendMessage $hwnd ${PBM_SETPOS} 1 0<br />
    Sleep 2000<br />
    SendMessage $hwnd ${PBM_SETPOS} 100 0<br />
FunctionEnd<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">8th September 2011, 05:59</div></div><div class="posttext">@mvisual: try to set XPStyle off<br />
 XP themes force their own color on the progress bar. <br />
<br />
Did you tried this? ::<br />
<br />
!define MUI_INSTALLCOLORS &quot;FF0000 00FF00&quot;<br />
!define MUI_INSTFILESPAGE_PROGRESSBAR &quot;colored&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">C_10</div><div class="date">9th February 2012, 13:48</div></div><div class="posttext">Hi, I have the same problem.<br />
<br />
I tried:<br />
!include &quot;LogicLib.nsh&quot;<br />
!include &quot;MUI2.nsh&quot;<br />
!include &quot;nsDialogs.nsh&quot;<br />
!include &quot;Sections.nsh&quot;<br />
!include &quot;WinMessages.nsh&quot;<br />
<br />
!define MUI_INSTALLCOLORS &quot;000000 3F48CC&quot;<br />
!define MUI_INSTFILESPAGE_PROGRESSBAR colored<br />
<br />
XPStyle off<br />
Name &quot;Progressbar&quot;<br />
OutFile &quot;Progressbar.exe&quot;<br />
ShowInstDetails show<br />
<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_INSTFILES<br />
<br />
Section Test<br />
Sleep 100<br />
SectionEnd<br />
<br />
...but the progressbar is still green (Windows7) and green + XPStyle (WindowsXP)<br />
<br />
How can I change the color? What is my mistake?<br />
Please help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gfm688</div><div class="date">9th February 2012, 14:24</div></div><div class="posttext">!define MUI_PAGE_CUSTOMFUNCTION_SHOW InstShow<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
!define PBM_SETBARCOLOR 0x0409<br />
!define PBM_SETBKCOLOR 0x2001<br />
<br />
Function InstShow<br />
  FindWindow $0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
  GetDlgItem $0 $0 1004<br />
  System::Call UxTheme::SetWindowTheme(i,w,w)i(r0,&quot;&quot;,&quot;&quot;)<br />
  SendMessage $0 ${PBM_SETBARCOLOR} 0 0x000000<br />
  SendMessage $0 ${PBM_SETBKCOLOR} 0 0x3F48CC<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">C_10</div><div class="date">9th February 2012, 15:23</div></div><div class="posttext">Thanks gfm688 for your answer!!! :)<br />
<br />
I don't understand, why my code is wrong...but your code works excellent;)<br />
Can you please explain the line to me?<br />
System::Call UxTheme::SetWindowTheme(i,w,w)i(r0,&quot;&quot;,&quot;&quot;)<br />
What does (i,w,w)i(r0,&quot;&quot;,&quot;&quot;) mean?<br />
Is this line treated like a constant or can I change it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">9th February 2012, 15:33</div></div><div class="posttext">Thanks gfm688 for your answer!!! :)<br />
<br />
I don't understand, why my code is wrong...but your code works excellent;)<br />
Can you please explain the line to me?<br />
<br />
What does (i,w,w)i(r0,&quot;&quot;,&quot;&quot;) mean?<br />
Is this line treated like a constant or can I change it?<br />
<br />
http://msdn.microsoft.com/en-us/library/windows/desktop/bb759827%28v=vs.85%29.aspx meaning, you can change the two empty strings (You don't want to, but you could :) )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">C_10</div><div class="date">9th February 2012, 15:57</div></div><div class="posttext">OK :D<br />
Thanks Anders</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>