<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Shortcut with arguments on windows 7, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Shortcut with arguments on windows 7 NSIS Discussion" />
	
	<title> Shortcut with arguments on windows 7 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Shortcut with arguments on windows 7</div>
<hr />
<div class="pda"><a href="t-340397.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=340397">Shortcut with arguments on windows 7</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Zenopus</div><div class="date">10th January 2012, 16:49</div></div><div class="posttext">I am having some issues <br />
creating start menu shortcuts with arguments<br />
on vista and windows 7.<br />
<br />
The installer<br />
installs all files correctly on w2k, xp, vista, windows 7<br />
desktop shortcuts including arguments are correct on w2k, xp, vista, windows 7<br />
start menu shortcuts including arguments are correct on w2k, xp<br />
but on vista and windows 7 start menu shortcut do not have arguments set.<br />
<br />
I upgraded to NSIS 2.46 and upgraded ShellLink to v1.2<br />
but this did not make any difference.<br />
<br />
As desktop shortcut arguments are in place <br />
and start menu shortcut arguments are in place on w2k and xp <br />
presumably the syntax is ok.<br />
<br />
Any ideas?<br />
Is there a need to do something subtly different to make start menu shortcuts <br />
with arguments install right on vista and windows 7?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th January 2012, 16:52</div></div><div class="posttext">Please post/attach some code.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zenopus</div><div class="date">10th January 2012, 19:10</div></div><div class="posttext">While putting together an SSCCE based on a random sample I found  http://nsis.sourceforge.net/A_simple_installer_with_start_menu_shortcut_and_uninstaller I found that <br />
<br />
the issue surfaces in this scenario;<br />
<br />
CreateShortCut link.lnk target.file<br />
ShellLink::SetShortCutIconLocation link.lnk &quot;$INSTDIR/logo.ico&quot;<br />
Pop $0<br />
ShellLink::SetShortCutWorkingDirectory link.lnk &quot;$INSTDIR&quot;<br />
Pop $0<br />
ShellLink::SetShortCutShowMode link.lnk SW_SHOWMAXIMIZED<br />
Pop $0<br />
ShellLink::SetShortCutArgs link.lnk '-arg &quot;This is applied on w2k and xp, but not vista or windows 7&quot;'<br />
Pop $0<br />
<br />
and I solved it by doing <br />
<br />
CreateShortCut link.lnk target.file '-arg &quot;This is applied on w2k and xp, and on vista and windows 7&quot;'  &quot;$INSTDIR/logo.ico&quot;<br />
ShellLink::SetShortCutWorkingDirectory link.lnk &quot;$INSTDIR&quot;<br />
Pop $0<br />
ShellLink::SetShortCutShowMode link.lnk SW_SHOWMAXIMIZED<br />
Pop $0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th January 2012, 20:16</div></div><div class="posttext">Why are you using the ShellLink plug-in at all? You don't need to.CreateShortCut link.lnk target.file '-arg &quot;value&quot;' &quot;$INSTDIR/logo.ico&quot; 0 SW_SHOWMAXIMIZEDThe working (start in) directory is set to whatever $OUTDIR is when creating the shortcut (i.e. SetOutPath).<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>