<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" New way to Get Windows Version., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  New way to Get Windows Version. NSIS Discussion" />
	
	<title> New way to Get Windows Version. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  New way to Get Windows Version.</div>
<hr />
<div class="pda"><a href="t-179031.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=179031">New way to Get Windows Version.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">s793016</div><div class="date">5th May 2004, 16:50</div></div><div class="posttext">No meter how many times you patched your windows with WindowsUpdate, there is one file never patched by any update, and it always content correctly OS Version. The file is called &quot;WinVer.EXE&quot;.<br />
<br />
So, now you could use this to make a 100% sure what OS your install is running.<br />
<br />
OutFile &quot;NewWinverTest.exe&quot;<br />
Name &quot;NewWinverTest&quot;<br />
XPStyle &quot;on&quot;<br />
<br />
Section &quot;-bbo&quot; b2<br />
Sectionin RO<br />
;<br />
SectionEnd<br />
<br />
Function &quot;.onInit&quot;<br />
StrCpy $1 &quot;$windir&quot;<br />
IfFileExists &quot;$1\winver.exe&quot; +2<br />
 StrCpy $1 &quot;$sysdir&quot;<br />
GetDllVersion &quot;$1\winver.exe&quot; $R0 $R1<br />
IntOp $R2 $R0 / 0x00010000<br />
IntOp $R3 $R0 &amp; 0x0000FFFF<br />
IntOp $R4 $R1 / 0x00010000<br />
IntOp $R5 $R1 &amp; 0x0000FFFF<br />
;StrCpy $0 &quot;$R2.$R3.$R4.$R5&quot;<br />
messagebox mb_ok &quot;Ver = $R2.$R3.$R4.$R5&quot;<br />
Quit<br />
<br />
;Version List<br />
;=-=-=-=-=-=-=<br />
;2003 = 5.2.3790.0<br />
; XP  = 5.1.2600.0<br />
; 2K  = 5.0.2195.6703<br />
; NT  = ???<br />
; ME  = 4.90.0.3000<br />
;98SE = 4.10.0.2222<br />
; 98  = ???<br />
;95S2 = ???<br />
; 95  = ??? <br />
<br />
FunctionEnd<br />
<br />
All OS I have tested is listed there. Does anyone want to fill those blank value?<br />
<br />
Thank you very much.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">6th May 2004, 00:07</div></div><div class="posttext">;98 = 4.10.0.1998</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lsexton1</div><div class="date">11th May 2004, 22:06</div></div><div class="posttext">Windows NT Workstation Version = 4.0.1381.336</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pompo500</div><div class="date">20th May 2004, 08:38</div></div><div class="posttext">Hello.<br />
<br />
This is my updated code as a whole. I made it a function so it's more modular to use.<br />
<br />
Note that by uncommenting and commenting parts of the last few lines you can control the output of the function.<br />
<br />
; Windows version getter by joonas.loppi@xs.fi<br />
; http://forums.winamp.com/showthread.php?threadid=179031<br />
;<br />
;       Version List<br />
;<br />
; 2003 = 5.2.3790.0<br />
;   XP = 5.1.2600.0<br />
;   2K = 5.0.2195.6703<br />
;   NT = 4.0.1381.336<br />
;   ME = 4.90.0.3000<br />
; 98SE = 4.10.0.2222<br />
;   98 = 4.10.0.1998<br />
; 95S2 = ???<br />
;   95 = 4.00.950<br />
<br />
Function &quot;winVer&quot;<br />
   Push $0<br />
<br />
   StrCpy $1 &quot;$windir&quot;<br />
   IfFileExists &quot;$1\winver.exe&quot; +2<br />
     StrCpy $1 &quot;$sysdir&quot;<br />
   GetDllVersion &quot;$1\winver.exe&quot; $R0 $R1<br />
   IntOp $R2 $R0 / 0x00010000<br />
   IntOp $R3 $R0 &amp; 0x0000FFFF<br />
   IntOp $R4 $R1 / 0x00010000<br />
   IntOp $R5 $R1 &amp; 0x0000FFFF<br />
<br />
    StrCpy $0 &quot;$R2.$R3.$R4.$R5&quot;<br />
   ; -&gt; 4.0.1381.336<br />
<br />
   ; StrCpy $0 $R2<br />
   ; -&gt; 4<br />
<br />
   ; Whee!<br />
   Exch $0<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">20th May 2004, 14:48</div></div><div class="posttext">Aren't XP home and XP Pro have different versions?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>