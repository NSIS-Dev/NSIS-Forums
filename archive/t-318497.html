<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem of NSD_CreateIPAddress.nsh, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem of NSD_CreateIPAddress.nsh NSIS Discussion" />
	
	<title> Problem of NSD_CreateIPAddress.nsh [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem of NSD_CreateIPAddress.nsh</div>
<hr />
<div class="pda"><a href="t-318497.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318497">Problem of NSD_CreateIPAddress.nsh</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jiake</div><div class="date">19th April 2010, 02:18</div></div><div class="posttext">!include &quot;MUI2.nsh&quot;<br />
!include &quot;CreateIPaddress.nsh&quot;<br />
<br />
Name &quot;Program&quot;<br />
OutFile Program.exe<br />
InstallDir $Temp<br />
<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
Page custom CreatePage<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
Section Install<br />
<br />
SectionEnd<br />
<br />
Function CreatePage<br />
	!insertmacro MUI_HEADER_TEXT &quot;Set IP address&quot; &quot;Please input the IP address you want to set&quot;<br />
	nsDialogs::Create 1018<br />
	Pop $0<br />
	${If} $0 == error<br />
		Abort<br />
	${EndIf}<br />
	${NSD_CreateLabel} 0u 2u 64u 8u &quot;Input IP address:&quot;<br />
	${NSD_CreateIPaddress} 70u 0u 80u 12u &quot;&quot;<br />
	nsDialogs::Show<br />
FunctionEnd<br />
On the custom page, click back, then the font of directory selection page turns large:<br />
46797<br />
Click next, the font of the custom page also changes, not the former one.<br />
46798</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">19th April 2010, 12:35</div></div><div class="posttext">huh.. never noticed that before - but confirmed anyway (no idea if it's related to installing XP SP3).  That's a weird bug.<br />
<br />
'fraid that might (depending on whether a cause can be found and addressed) leave you with the alternative options of creating 4 text controls, or using 1 text control and validating input, etc.<br />
<br />
Edit: looks like this is a known problem with SysIPAddress32.  It disposes of the font that's used to create it, originally.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">19th April 2010, 12:43</div></div><div class="posttext">okay, solved thusly... create a new font and set that on the control before display. E.g.<br />
<br />
<br />
    ${NSD_CreateLabel} 0u 0 20% 10% &quot;Input IP address:&quot;<br />
        Pop $0<br />
    ${NSD_CreateIPaddress} 20% 0 80% 10% &quot;127.0.0.1&quot;<br />
        Pop $1<br />
	CreateFont $R0 &quot;$(^Font)&quot; &quot;$(^FontSize)&quot;<br />
	SendMessage $1 ${WM_SETFONT} $R0 1<br />
<br />
I'll adjust the header in the wiki after grabbing the font info elegantly somewhere.<br />
Edit: adjusted post with the proper font langstrings.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">19th April 2010, 13:16</div></div><div class="posttext">Header file in the wiki ( http://nsis.sourceforge.net/NsDialogs_CreateIPaddress ) is now updated.<br />
<br />
End-users: download the new version and your scripts using NSD_CreateIPAddress should continue to work just fine - and the installer font should no longer corrupt.<br />
<br />
Developers: nsDialogs' framework doesn't allow for any particular post-fixing of its defines.  The original define is renamed to NSD_CreateIPAddressControl.  The original NSD_CreateIPAddress define is then re-defined to insert a macro which calls the renamed original and applies the font corruption fix and then pushes the control's handle back onto the stack.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jiake</div><div class="date">20th April 2010, 02:21</div></div><div class="posttext">I tried the fixed header file, it works well. Neither click back or the next button, the font is right.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">20th April 2010, 02:34</div></div><div class="posttext">excellent - glad it's fixed with that :D</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>