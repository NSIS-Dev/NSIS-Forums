<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Closing Explorer Shell!?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Closing Explorer Shell!? NSIS Discussion" />
	
	<title> Closing Explorer Shell!? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Closing Explorer Shell!?</div>
<hr />
<div class="pda"><a href="t-108930.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=108930">Closing Explorer Shell!?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">resista</div><div class="date">8th October 2002, 15:32</div></div><div class="posttext">I want to close the explorer shell!<br />
This doesnt seem to work(-:cry:-):<br />
<br />
<br />
__________________________________________<br />
<br />
FindWindow $R5 &quot;&quot; explorer<br />
StrCmp $R5 0 explorernotrunning<br />
SendMessage $R5 16 &quot;&quot; &quot;&quot;<br />
<br />
__________________________________________<br />
<br />
What should i do? :eek:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th October 2002, 17:39</div></div><div class="posttext">You should search the forum and find:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=100479&amp;highlight=explorer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">resista</div><div class="date">8th October 2002, 18:08</div></div><div class="posttext">I have read that. but it doesnt solve my problem...<br />
<br />
i need the class name of the explorer shell...<br />
and since it doesnt really have a window i cont get it with win32spy!<br />
<br />
How should i do?<br />
<br />
the class name of the tray is Shell_TrayWnd so this could work:<br />
<br />
______________________________________<br />
<br />
FindWindow $R5 Shell_TrayWnd<br />
______________________________________<br />
<br />
and it sorta does, but then i get the Shut Down menu..<br />
<br />
is there any way of getting round this?<br />
a kill command or other way to force it to close?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th October 2002, 18:15</div></div><div class="posttext">Shell_TrayWnd is the class of the tray bar...<br />
<br />
Killing Explorer is never a good idea. There is almost always a better way of doing whatever it is you are trying to do, and if there isn't a restart or logoff/on would be a lot better than killing Explorer.<br />
<br />
If you tell me what exactly you are trying to do I might be able to help you a little better.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">resista</div><div class="date">8th October 2002, 20:09</div></div><div class="posttext">I really have to close explorer since im building a shellswicher for litestep...<br />
<br />
so, when running the program it determines if explorer is running and if it is it should shutdown explorer and start litestep!<br />
<br />
so i have to close explorer!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th October 2002, 21:13</div></div><div class="posttext">Well, <br />
<br />
Killing Explorer is never a good idea. There is almost always a better way of doing whatever it is you are trying to do, and if there isn't a restart or logoff/on would be a lot better than killing Explorer. <br />
<br />
AFAIK there is no clean way of restarting explorer other than a logoff-logon or a reboot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">resista</div><div class="date">11th October 2002, 07:27</div></div><div class="posttext">How do i do to logoff/on?<br />
<br />
I searched the forum and the help files but i couldnt find anything about a 'logoff' command. Is there one? Or is there any other way to logoff, like displaying the shutdown menu or something?<br />
<br />
Sorry if im a pain in the ass:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th October 2002, 12:12</div></div><div class="posttext">You will have to create an extension DLL to do this.<br />
Just have the DLL function call ExitWindowsEx(EWX_LOGOFF, 0);<br />
I suggest you only call this DLL function if the user agrees. You can also call ExitWindowsEx with system.dll but I haven't really tried it yet so you will have to ask brainsucker about its usage.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">resista</div><div class="date">11th October 2002, 12:27</div></div><div class="posttext">i dont have the knowledge required to make an extension dll... :( <br />
you think that someone has already made an extension like that?<br />
<br />
or do yoy know of someone hwo just loves making extension dlls for otherpeople?<br />
<br />
I think that a logoff/of command is something that should be included...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th October 2002, 12:28</div></div><div class="posttext">You can also call ExitWindowsEx with system.dll but I haven't really tried it yet so you will have to ask brainsucker about its usage.<br />
<br />
;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">11th October 2002, 22:19</div></div><div class="posttext">That's damn thing closed all the windows and disconnected me from inet. Sucks, but works...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>