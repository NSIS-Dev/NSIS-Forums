<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Norton System Works, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Norton System Works NSIS Discussion" />
	
	<title> Norton System Works [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Norton System Works</div>
<hr />
<div class="pda"><a href="t-251408.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=251408">Norton System Works</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">albie</div><div class="date">18th July 2006, 17:27</div></div><div class="posttext">Hi, <br />
<br />
I'm new to this forum and a rookie NSIS user. :) <br />
<br />
<br />
After creating a short cut I've run Norton <br />
System Works to check for Errors.  <br />
<br />
Norton says that there are short cut errors.<br />
<br />
\RECYCLER\NPROTECT\00000343.LNK is invalid<br />
The path C:\GNA\Usb\Uninstall.exe used by this<br />
short cut is wrong.<br />
<br />
Also says the program short cut I've installed is <br />
also invalid.<br />
<br />
Does anyone know why this would be?<br />
It doesn't seem to effect anything. <br />
I just want to clean stuff up...<br />
<br />
Thanks, Mike</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">18th July 2006, 20:54</div></div><div class="posttext">The path first path you gave starts with &quot;\recycler..&quot;.  The recycler is usually the folder windows uses for the recyle bin. Can you verify?<br />
<br />
As for the rest of your shortcuts, I'm not sure.  Perhaps it's missing an icon resource or some such thing.  (I assume the shortcuts work, correct?)  Might help to post the actual shortcut commands you used.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">albie</div><div class="date">18th July 2006, 22:07</div></div><div class="posttext">Thanks for responding!<br />
<br />
Here are my short cuts... <br />
<br />
CreateShortCut &quot;$DESKTOP\${MUI_PRODUCT}.lnk&quot;&quot;$INSTDIR\${MUI_FILE}.exe&quot; &quot;&quot;<br />
<br />
# Create Start-Menu Items<br />
CreateDirectory &quot;$SMPROGRAMS\${MUI_PRODUCT}&quot;<br />
<br />
CreateShortCut &quot;$SMPROGRAMS\${MUI_PRODUCT}\Uninstall.lnk&quot; &quot;$INSTDIR\Uninstall.exe&quot; &quot;&quot; &quot;$INSTDIR\Uninstall.exe&quot; 0<br />
<br />
CreateShortCut &quot;$SMPROGRAMS\${MUI_PRODUCT}\${MUI_PRODUCT}.lnk&quot; &quot;$INSTDIR\${MUI_FILE}.exe&quot; &quot;&quot; &quot;$INSTDIR\${MUI_FILE}.exe&quot; 0<br />
<br />
<br />
Mike</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">19th July 2006, 00:53</div></div><div class="posttext">hmmm... I don't see anything wrong with your commands. <br />
<br />
Just on a whim, try issuing the following command at the end of your install:  <br />
<br />
System::Call 'shell32::SHChangeNotify(i 0x08000000, i 0, i 0, i 0)'<br />
<br />
(You can also use the ${RefreshShellIcons} call included in FileFunc.nsh.  Its usage is explained in NSIS help under Appendix E under the File Functions header section.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">albie</div><div class="date">19th July 2006, 02:22</div></div><div class="posttext">I tried the system call. Didn't seem to have <br />
any effect.<br />
<br />
------------------ Compile output -------------------<br />
File: &quot;System.dll&quot;-&gt;&quot;$PLUGINSDIR\System.dll&quot; [compress] 5942/10240 bytes<br />
Plugin Command: Call shell32::SHChangeNotify(i 0x08000000, i 0, i 0, i 0)<br />
<br />
When you mentioned the Recyle Bin got me thinking.<br />
I've had a little more time now to do some <br />
thinking and some experimenting.  <br />
<br />
I've ran Norton after the install and <br />
found it had no errors.<br />
<br />
Then after the uninstall and that's where <br />
the problem is.  It makes sence now.<br />
<br />
I did some searching through the files and<br />
directories looking for &quot;RECYCLER&quot; or <br />
&quot;NPROTECT&quot;.  Thinking that it is something<br />
I need to remove during the uninstall. But <br />
I could not find anything.  ? Not sure where<br />
this information or file links are.<br />
<br />
This is the delete code.<br />
<br />
  Delete &quot;$DESKTOP\${ANS_PRODUCT}.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\${ANS_PRODUCT}\*.*&quot;<br />
  RmDir  &quot;$SMPROGRAMS\${ANS_PRODUCT}&quot;<br />
<br />
<br />
Am I missing something in the removal of the <br />
regular short cuts I've made.  Or do I <br />
remove the contents of the Recycler? Where <br />
ever that is...<br />
<br />
Mike</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galil</div><div class="date">19th July 2006, 03:03</div></div><div class="posttext">Don't over-concern yourself with Norton's recycle bin enhancements.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>