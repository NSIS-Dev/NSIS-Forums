<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Library.nsh and the docu, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Library.nsh and the docu NSIS Discussion" />
	
	<title> Library.nsh and the docu [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Library.nsh and the docu</div>
<hr />
<div class="pda"><a href="t-241016.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=241016">Library.nsh and the docu</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">coco_vc</div><div class="date">16th March 2006, 13:31</div></div><div class="posttext">Hi all,<br />
<br />
I plan to have my installer script built on Linux for getting a Windows binary. I need to use the Library.nsh features and in the docu for Library.nsh I read &quot;Note that you can only compile scripts using this system on Windows systems. It is not possible to compile on Linux etc.&quot;.<br />
I don't have any Linux to test this so I'll ask here: this statement doesn't really suggest that you can't build a Windows binary on a Linux system if Library.nsh calls have been used right? (I assume that statement is trying to state that a linux binary can't be obtained if Library.nsh feature are used, but I want to be 100% sure about this.)<br />
<br />
Thx,<br />
Viv</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th March 2006, 18:09</div></div><div class="posttext">It does state that you can't use Library macros on Linux. The Library macros need to read version information and type library version information from files. While version information can probably be easily read using the already available resource editor class, reading type library version information requires some work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">coco_vc</div><div class="date">16th March 2006, 20:39</div></div><div class="posttext">Hi kichik,<br />
<br />
Thanks for your answer, but I still am not sure if I have a problem or not. So I rephrase the question in order for you to be able to answer just a yes or no (maybe I'm just too dumb or too tired now):<br />
If I use Library.nsh features/calls in my script can I then successfully build a Windows binary on a Linux machine using NSIS?<br />
<br />
Thx,<br />
Viv</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">16th March 2006, 20:43</div></div><div class="posttext">as stated in the docs:<br />
NO! unfortunately not.<br />
<br />
it would require to alter the whole library.nsh, if even possible...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">coco_vc</div><div class="date">17th March 2006, 11:38</div></div><div class="posttext">Ok, then what can I do in case I need the following 2 features:<br />
- build a windows installer on a Linux system<br />
and<br />
- use the Library calls (b/c I need to update dlls in-use)<br />
?<br />
<br />
Thx,<br />
Viv</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th March 2006, 11:52</div></div><div class="posttext">You can modify Library.nsh a bit so it won't use LibraryLocal.exe. It won't work with type libraries and will fail if the DLL doesn't contain version information, but I guess it's better than nothing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">coco_vc</div><div class="date">17th March 2006, 14:14</div></div><div class="posttext">Thanks kichik,<br />
<br />
Another way: I think in case it's mandatory to build on a Linux system that I could also use the File, Delete, Rename calls with /REBOOTOK flag instead of using Library calls, for my dlls that don't need to be registered and are not shared right? I could somehow do an update of an in use dll with these function without having Library call correct?<br />
<br />
Thx,<br />
Viv</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th March 2006, 14:17</div></div><div class="posttext">Yes, you can use UpgradeDLL (http://nsis.sourceforge.net/Special:Search?search=upgradedll) which does just that. It also uses GetDLLVersionLocal like the new Library.nsh version I've attached above.<br />
<br />
The problem with Linux and the Library is only with the version information. If you get rid of it, or put some limits on what can be done, it can be used.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">coco_vc</div><div class="date">17th March 2006, 14:59</div></div><div class="posttext">Or, I could use Library calls and use wine on Linux to build the script. I'll have to see for one of these solutions ...<br />
<br />
Thx,<br />
Viv</div></div><hr />


<div class="post"><div class="posttop"><div class="username">coco_vc</div><div class="date">17th March 2006, 16:37</div></div><div class="posttext">btw, where can I find some docu about UpgradeDLL? I found in the installed package the UpgradeDLL.nsh but couldn't find any docu about this one.<br />
Would I need for using UpgradeDLL the dll to have version information?<br />
<br />
Thx,<br />
Viv</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th March 2006, 16:46</div></div><div class="posttext">It needs version information but you can use it as a script example.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">coco_vc</div><div class="date">17th March 2006, 18:19</div></div><div class="posttext">Thx kichik.<br />
<br />
And where could I find some UpgradeDLL docu?<br />
<br />
Thx,<br />
Viv</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th March 2006, 19:48</div></div><div class="posttext">There's none. It's deprecated. But the code is pretty short and self explanatory.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stb</div><div class="date">20th March 2006, 08:58</div></div><div class="posttext">@coco_vc:<br />
<br />
If the DLLs do not often change (e.g. MS DLLs) you could think about building some separate DLL installer package on Windows and using this helper package within your main installer  (call it with &quot;Exec&quot;/&quot;ExecWait&quot; ...)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">coco_vc</div><div class="date">21st March 2006, 16:15</div></div><div class="posttext">kichik --<br />
<br />
Thx for your changed library.nsh and your suggestions. I can't use your modified library.nsh file as one of my requirements is that anybody should be able to compile my script with the NSIS version specified in the docu, so I can't deploy the modified library.nsh also.<br />
So I'll try to understand the UpgradeDLL and go that way. When I'll do so I might come back with other questions :)<br />
<br />
btw, can't in future versions, library.nsh be modified so that when a specific param is specified no versioning is involved so the script would be then:<br />
- compilable on linux system<br />
and<br />
- the call won't fail if the dll doesn't hold any version<br />
?<br />
<br />
stb --<br />
<br />
The dll I'm talking about is changing with almost every version, so I will have to upgrade it along with the other binaries.<br />
<br />
Thx,<br />
Viv</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st March 2006, 17:59</div></div><div class="posttext">You can distribute the modified Library.nsh along with your script. If you use &quot;!include Library.nsh&quot;, it'll first search the script's directory. You can also wait for version 2.16 which will include a modified Library.nsh.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">coco_vc</div><div class="date">22nd March 2006, 09:44</div></div><div class="posttext">&gt; You can also wait for version 2.16 which will include a modified Library.nsh.<br />
<br />
Are you saying that:<br />
a) the NSIS version 2.16 will include your already modified Library.nsh (the one that fails if the dll doesn't have a version)?<br />
or<br />
b) it will actually include the change so that it will be compilable on linux and won't fail if the dll doesn't hold a version?<br />
<br />
Thx,<br />
Viv</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd March 2006, 18:07</div></div><div class="posttext">It'll still fail for DLLs without version history. Only on Linux, of course.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">coco_vc</div><div class="date">10th April 2006, 13:44</div></div><div class="posttext">Hi *,<br />
<br />
I noticed that indeed this was implemented for version 2.16 &quot;Library now available on non-Windows platforms as well, although it requires the installed DLL to have version information&quot; which is nice, but I want to ask something: isn't there any way, in future versions, to make it run (build windows binary on linux) even if the dll doesn't have a version? Like having one more param saying &quot;I really don't care about version&quot; and in that case no version checking to be done?<br />
<br />
Thx,<br />
Viv</div></div><hr />


<div class="post"><div class="posttop"><div class="username">coco_vc</div><div class="date">26th June 2006, 13:36</div></div><div class="posttext">Hi kichik,<br />
<br />
Don't want to be pushy, but I would like to know the answer to the above question. I mean would, in future versions, exist the possibility to: use Library calls and in the same time to build the code on linux, in case the version is not interesting at all?<br />
For instance:<br />
<br />
!insertmacro InstallLib DLL NOTSHARED REBOOT_NOTPROTECTED &quot;Files\lolo.exe&quot; &quot;$SYSDIR\lolo.exe&quot; &quot;$SYSDIR&quot; VERSION_NOT_CARE</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th June 2006, 09:30</div></div><div class="posttext">It's a feature that would be nice to have, so of course it should be in a future version. Which version is another question. You could speed up the process by submitting a patch for this.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>