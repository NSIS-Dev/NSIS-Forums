<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" TaskDialog in Windows Vista, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  TaskDialog in Windows Vista NSIS Discussion" />
	
	<title> TaskDialog in Windows Vista [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  TaskDialog in Windows Vista</div>
<hr />
<div class="pda"><a href="t-278365.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=278365">TaskDialog in Windows Vista</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bradharding</div><div class="date">6th October 2007, 01:16</div></div><div class="posttext">Hi!<br />
<br />
Is it at all possible that someone could please show me (with an example) how to implement Windows Vista's TaskDialog API function using the System plugin?<br />
<br />
HRESULT TaskDialog(HWND hWndParent,<br />
    HINSTANCE hInstance,<br />
    PCWSTR pszWindowTitle,<br />
    PCWSTR pszMainInstruction,<br />
    PCWSTR pszContent,<br />
    TASKDIALOG_COMMON_BUTTON_FLAGS dwCommonButtons,<br />
    PCWSTR pszIcon,<br />
    int *pnButton<br />
);<br />
<br />
I have no idea where to start, so any help would be immensely appreciated!<br />
<br />
Thanks in advance,<br />
Brad.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th October 2007, 19:39</div></div><div class="posttext">Untested.!define TDCBF_OK_BUTTON 0x1<br />
!define TDCBF_YES_BUTTON 0x2<br />
!define TDCBF_NO_BUTTON 0x4<br />
!define TDCBF_CANCEL_BUTTON 0x8<br />
!define TDCBF_RETRY_BUTTON 0x10<br />
!define TDCBF_CLOSE_BUTTON 0x20<br />
<br />
!define TD_WARNING_ICON -1<br />
!define TD_ERROR_ICON -2<br />
!define TD_INFORMATION_ICON -3<br />
!define TD_SHIELD_ICON -4<br />
<br />
!define IDOK 1<br />
!define IDCANCEL 2<br />
!define IDABORT 3<br />
!define IDRETRY 4<br />
!define IDIGNORE 5<br />
!define IDYES 6<br />
!define IDNO 7<br />
<br />
System::Call &quot;comctl32::TaskDialog(i $HWNDPARENT, i 0, \<br />
  w 'title', w 'instruction', w 'content', \<br />
  i ${TDCBF_YES_BUTTON}|${TDCBF_NO_BUTTON}, \<br />
  i ${TD_INFORMATION_ICON}, *i .r0)&quot;<br />
<br />
${If} $0 == ${IDYES}<br />
  MessageBox MB_OK yes<br />
${ElseIf} $0 == ${IDNO}<br />
  MessageBox MB_OK no<br />
${EndIf}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bradharding</div><div class="date">16th October 2007, 05:52</div></div><div class="posttext">Thanks for your hep, Kichik! (Sorry it has taken me a while to respond.)<br />
<br />
Unfortunately, though, the code causes my installer to crash... :(  Any other ideas?<br />
<br />
Thanx again,<br />
Brad.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th October 2007, 22:59</div></div><div class="posttext">Seems like it hates the icon. Replace ${TD_INFORMATION_ICON} with 0.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bradharding</div><div class="date">17th October 2007, 00:26</div></div><div class="posttext">That's it, thank you! Any way of getting that icon to work, though?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th October 2007, 19:36</div></div><div class="posttext">Don't know, you'll have to dig into MSDN.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bradharding</div><div class="date">18th October 2007, 05:22</div></div><div class="posttext">And then, after a bit of playing around, we now have:<br />
<br />
!define TD_WARNING_ICON 84<br />
!define TD_ERROR_ICON 98<br />
!define TD_INFORMATION_ICON 81<br />
!define TD_SHIELD_ICON 78<br />
 <br />
<br />
This'll now work as expected... :D <br />
<br />
Brad.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>