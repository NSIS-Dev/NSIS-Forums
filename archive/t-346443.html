<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Rename not recursiv?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Rename not recursiv? NSIS Discussion" />
	
	<title> Rename not recursiv? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Rename not recursiv?</div>
<hr />
<div class="pda"><a href="t-346443.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=346443">Rename not recursiv?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">sally91</div><div class="date">18th July 2012, 12:04</div></div><div class="posttext">Hello guys<br />
<br />
I've a strange behaviour...want to save a directory during uninstall the complete $INSTDIR. I thought I could move my directory to $TEMP and I could move it back.<br />
<br />
These are my lines:<br />
<br />
Rename $INSTDIR\${ApplicationDatabaseDirectory} $TEMP\${ApplicationDatabaseDirectory} (1)<br />
<br />
SetOutPath $TEMP${ApplicationDatabaseDirectory} (2)<br />
		<br />
RMDir /r $INSTDIR		<br />
CreateDirectory $INSTDIR<br />
		<br />
Rename $TEMP\${ApplicationDatabaseDirectory} (3) $INSTDIR\${ApplicationDatabaseDirectory}<br />
<br />
SetOutPath $INSTDIR\${ApplicationDatabaseDirectory}<br />
<br />
What do I get:<br />
<br />
(1)<br />
The ApplicationDatabaseDirectory is moved to $TEMP without any contained files. Why without...?<br />
<br />
(2)<br />
Without the move (1) won't happen.<br />
<br />
(3)<br />
&quot;Move&quot; of ApplicationDatabaseDirectory happens, but $TEMP${ApplicationDatabaseDirectory} will not deleted. Why?<br />
<br />
Thx for any hints<br />
Sally</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">18th July 2012, 12:07</div></div><div class="posttext">Try using $PLUGINSDIR instead of $TEMP. Are you sure no files are locked in your folder being moved?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sally91</div><div class="date">18th July 2012, 12:15</div></div><div class="posttext">Thx,<br />
<br />
I made a try with $PLUGINSDIR - without success.<br />
Files are not locked.<br />
<br />
My 1st general question is: NSIS:Rename does work recursively? It moves all subfolders and contained files per default, right?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">18th July 2012, 14:43</div></div><div class="posttext">Rename just uses the Windows MoveFileEx API I believe. It has always been recursive in my experience.<br />
<br />
By the way actually I would not recommend using $TEMP or $PLUGINSDIR for the temporary location. If they are located on another drive to $INSTDIR then it will probably fail. The manual states that it will only move folders on the same drive.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">18th July 2012, 15:42</div></div><div class="posttext">Also note that using RmDir /r in an uninstaller is extremely dangerous. You should never ever use it. Suppose the user installed to an existing directory (D:\MyApps) instead of to a unique subfolder, you would end up deleting all his files. Or suppose the user added some files to your installation folder, he/she will NOT expect you to delete those files, because they don't belong to your installation. Or, even worse: suppose that the user moved your uninstall.exe to another folder. Your uninstaller will then delete everything from this new folder, because $instdir == $exedir in the uninstaller!<br />
<br />
Instead of just blindly removing stuff, you should only remove what you know you want to remove. So, Delete &quot;$INSTDIR\MyUniqueFilename.ext&quot; for each file.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>