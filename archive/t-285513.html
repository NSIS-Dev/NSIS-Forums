<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Double cancel on custom page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Double cancel on custom page NSIS Discussion" />
	
	<title> Double cancel on custom page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Double cancel on custom page</div>
<hr />
<div class="pda"><a href="t-285513.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=285513">Double cancel on custom page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pcrowley</div><div class="date">23rd January 2008, 16:35</div></div><div class="posttext">I have a simple custom page with a cancel button on it.  Clicking the cancel button prompts the user if they really want to abort, just like normal.  Clicking Yes returns to the custom page.  Clicking the Cancel button again again prompts and then finally cancels.<br />
<br />
It is not getting into the Leave function for the page, I checked that.  Very little customization has been done from a HMEdit-wizard created script.<br />
<br />
There is a custom function for UserAbort which when removed drops all prompting - you still need to click cancel twice.<br />
<br />
I've done a bunch of searching but I can't find anything about this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">23rd January 2008, 17:21</div></div><div class="posttext">Seems MUI_ABORTWARNING is defined, also seems you're checking the return value of the dialog.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pcrowley</div><div class="date">23rd January 2008, 19:48</div></div><div class="posttext">I've gone through a couple of iterations of this.<br />
<br />
There is a wizard-added UserAbort function that was referenced by MUI_CUSTOMFUNCTION_ABORT.  What I have now is the following:<br />
<br />
; MUI Settings<br />
!define MUI_ABORTWARNING<br />
;!define MUI_CUSTOMFUNCTION_ABORT &quot;UserAbort&quot;<br />
<br />
I'm not checking any result from the custom page:<br />
<br />
Function DisplayCustomerInformation<br />
    StrCpy $REGSERIAL &quot;&quot;<br />
    StrCpy $REGEMAIL &quot;&quot;<br />
    !insertmacro MUI_HEADER_TEXT &quot;Customer Information&quot; &quot;Customer Information&quot;<br />
    !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;CustomerRegistration.ini&quot;<br />
    Push $9<br />
    InstallOptions::dialog &quot;$PLUGINSDIR\CustomerRegistration.ini&quot;<br />
    Pop $9 ; must pop this back off the stack, it contains the last button clicked<br />
<br />
    Return<br />
FunctionEnd<br />
<br />
I put in a MessageBox after the Pop at the end of this to just say &quot;Hi there&quot; and it comes out after the SECOND cancel.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pcrowley</div><div class="date">23rd January 2008, 20:19</div></div><div class="posttext">There is validation on this page with fields that must have content in them.<br />
<br />
Could this be the problem?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th January 2008, 12:58</div></div><div class="posttext">Remove that Return call. Shouldn't make any difference but you don't need it nonetheless.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>