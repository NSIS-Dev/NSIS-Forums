<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Building NSIS, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Building NSIS NSIS Discussion" />
	
	<title> Building NSIS [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Building NSIS</div>
<hr />
<div class="pda"><a href="t-299149.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=299149">Building NSIS</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">25th October 2008, 21:40</div></div><div class="posttext">I am attempting to compile NSIS.  Compiling the first time is always the hardest thing for me when trying to get an open source project setup.<br />
<br />
I downloaded and extracted nsis-2.40-src.tar<br />
<br />
Via the links on this page:<br />
http://nsis.sourceforge.net/Building_NSIS_from_SVN<br />
<br />
I have installed:<br />
Platform SDK 2003 R2 with all options checked.<br />
SCons v1.1 (I forget what the problem was, but the older version gave me errors about it not being a new enough version, so I installed v1.1)<br />
Python 2.5.1<br />
<br />
I already have Visual Studio Team System 2008 SP1 installed with Microsoft Visual Studio C++ 2008 as one of the components.  However, when installing I chose the C# developer profile, so I'm not sure if this would affect the build scripts ability to find what it needs.<br />
<br />
I was going to install Visual Studio 2005 Express as well, but all roads on microsoft's website lead to Visual Studio 2008 Express.<br />
<br />
This is my command prompt log:<br />
L:\Development\Code\Nsis\nsis-2.40-src&gt;scons<br />
scons: Reading SConscript files ...<br />
Delete(&quot;nsis-25-Oct-2008.cvs&quot;)<br />
Delete(&quot;.instdist&quot;)<br />
Delete(&quot;.test&quot;)<br />
Using Microsoft tools configuration<br />
*** Couldn't find a good version of libcp.lib<br />
<br />
L:\Development\Code\Nsis\nsis-2.40-src&gt;<br />
<br />
Any help would be greatly appreciated as usual.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">26th October 2008, 05:25</div></div><div class="posttext">I was going to install Visual Studio 2005 Express as well, but all roads on microsoft's website lead to Visual Studio 2008 Express.Here's the Microsoft url: Visual Studio 2005 Express (http://www.microsoft.com/express/2005/)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">26th October 2008, 07:19</div></div><div class="posttext">Thanks.  That seemed to do the trick.  Now it can't find windows.h though.  Is the script looking for it based on the include directories configuration in VS C++ Express?  Or do I need to add that to the path?<br />
<br />
Also, is this the correct version of the windows SDK that it needs?<br />
&quot;C:\Program Files\Microsoft SDKs\Windows\v6.1\Include&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">26th October 2008, 08:46</div></div><div class="posttext">L:\Development\Code\Nsis\nsis-2.40-src&gt;scons<br />
scons: Reading SConscript files ...<br />
Delete(&quot;nsis-26-Oct-2008.cvs&quot;)<br />
Delete(&quot;.instdist&quot;)<br />
Delete(&quot;.test&quot;)<br />
Using Microsoft tools configuration<br />
Checking for memset requirement... (cached) yes<br />
Checking for C library gdi32... (cached) no<br />
Checking for C library user32... (cached) no<br />
Checking for C library pthread... (cached) no<br />
Checking for C library iconv... (cached) no<br />
Checking for C library version... (cached) no<br />
Checking for C library dl... (cached) no<br />
Checking for C library gdi32... (cached) no<br />
Checking for C library iconv... (cached) no<br />
Checking for C library pthread... (cached) no<br />
Checking for C library user32... (cached) no<br />
Checking for C library version... (cached) no<br />
Checking for C++ library cppunit... (cached) no<br />
scons: done reading SConscript files.<br />
scons: Building targets ...<br />
cl /Fobuild\release\AdvSplash\advsplash.obj /c Contrib\AdvSplash\advsplash.c /no<br />
logo /GS- /O1 /W3 /D_CRT_SECURE_NO_WARNINGS /D_CRT_NONSTDC_NO_WARNINGS<br />
advsplash.c<br />
Contrib\AdvSplash\advsplash.c(4) : fatal error C1083: Cannot open include file:<br />
'windows.h': No such file or directory<br />
scons: *** [build\release\AdvSplash\advsplash.obj] Error 2<br />
scons: building terminated because of errors.<br />
<br />
L:\Development\Code\Nsis\nsis-2.40-src&gt;SET INCLUDE=%INCLUDE%;C:\Program Files\Microsoft SDKs\Windows\v6.1\Include<br />
<br />
L:\Development\Code\Nsis\nsis-2.40-src&gt;scons<br />
scons: Reading SConscript files ...<br />
Delete(&quot;nsis-26-Oct-2008.cvs&quot;)<br />
Delete(&quot;.instdist&quot;)<br />
Delete(&quot;.test&quot;)<br />
Using Microsoft tools configuration<br />
Checking for memset requirement... (cached) yes<br />
Checking for C library gdi32... (cached) no<br />
Checking for C library user32... (cached) no<br />
Checking for C library pthread... (cached) no<br />
Checking for C library iconv... (cached) no<br />
Checking for C library version... (cached) no<br />
Checking for C library dl... (cached) no<br />
Checking for C library gdi32... (cached) no<br />
Checking for C library iconv... (cached) no<br />
Checking for C library pthread... (cached) no<br />
Checking for C library user32... (cached) no<br />
Checking for C library version... (cached) no<br />
Checking for C++ library cppunit... (cached) no<br />
scons: done reading SConscript files.<br />
scons: Building targets ...<br />
cl /Fobuild\release\AdvSplash\advsplash.obj /c Contrib\AdvSplash\advsplash.c /no<br />
logo /GS- /O1 /W3 /D_CRT_SECURE_NO_WARNINGS /D_CRT_NONSTDC_NO_WARNINGS<br />
advsplash.c<br />
Contrib\AdvSplash\advsplash.c(4) : fatal error C1083: Cannot open include file:<br />
'windows.h': No such file or directory<br />
scons: *** [build\release\AdvSplash\advsplash.obj] Error 2<br />
scons: building terminated because of errors.<br />
<br />
<br />
I've used the Windows SDK Configuration tool to set me version to 6.1.  I've added &quot;&quot;C:\Program Files\Microsoft SDKs\Windows\v6.1\Include&quot; to the Include paths in Visual Studio 2005.<br />
<br />
I've also tried running scons from the the Windows SDK command prompt, the VS 2005 command prompt, and the VS 2008 command prompt.<br />
<br />
What is the method scons uses to search for includes?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">26th October 2008, 15:35</div></div><div class="posttext">I've never tried to compile NSIS and I don't have SCONS, so I don't know the answer to your questions about the SDK version and how SCONS includes are set up.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pawel</div><div class="date">26th October 2008, 23:45</div></div><div class="posttext">Originally posted by AaronLS <br />
L:\Development\Code\Nsis\nsis-2.40-src&gt;scons<br />
scons: Reading SConscript files ...<br />
Delete(&quot;nsis-26-Oct-2008.cvs&quot;)<br />
Delete(&quot;.instdist&quot;)<br />
Delete(&quot;.test&quot;)<br />
...<br />
 <br />
<br />
Hello,<br />
I am also trying to compile this sources... But, dont know why, Scons can't be found. So, I dont see this:<br />
&quot;scons: Reading SConscript files ...&quot;.<br />
Could you write here what did you do to compile it (try to compile)?<br />
I mean, what programs did you installed (versions), what environments path did you add, etc...<br />
I am looking for a simple description how to build this sources on Windows (XP) platform. I wanted to translate NSIS to my language (program + docs), but It is impossible without possibility to build it... (have to say, that there was time I did it, with NSIS 2.23 version... and now I cant do it, don't know what am I doiing wrong).<br />
<br />
Ps: Kichik, maybe you will find some time to write some simple guide?<br />
<br />
Regards,<br />
-Pawel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">27th October 2008, 01:54</div></div><div class="posttext">I installed these things:<br />
Platform SDK 2003 R2 with all options checked.<br />
SCons v1.1 <br />
Python 2.5.1<br />
Visual Studio 2005 Express<br />
<br />
I was following this guide:<br />
http://nsis.sourceforge.net/Building_NSIS_from_SVN<br />
<br />
It seems my issue might be related to this, but not knowing much about python or scons, I'm not sure how to work around it.  <br />
http://www.nabble.com/Installing-Windows-2008-SDK-broke-building-with-VC8-td15966956.html<br />
<br />
I may just need to setup a virtual machine for the build.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">27th October 2008, 02:17</div></div><div class="posttext">Pepe, also, after installing Python and Scons, you have to add them to your PATH environment variables.  Somewhere under the Python directory there is a subdirectory with a scons batch file in it.  You have to add that path to your &quot;PATH&quot; environment variable.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">27th October 2008, 06:03</div></div><div class="posttext">I think I figured out the problem.  I installed the &quot;Windows Server 2008&quot; version of the paltform SDK accidentally.  The download page for the 2003 version has a &quot;Web Install&quot; link that I clicked and it downloaded the 2008 version, because I didn't read he note next to the link saying it was for 2008 because it &quot;superceded&quot; the 2003.  If I had been paying attention I would have seen the correct version was at the bottom of the page.<br />
<br />
I'll know for sure if this was it after I get the virtual pc setup.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">27th October 2008, 06:47</div></div><div class="posttext">Bah, that didn't do it.  Still the same windows.h error.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pawel</div><div class="date">27th October 2008, 08:01</div></div><div class="posttext">Originally posted by AaronLS <br />
Pepe, also, after installing Python and Scons, you have to add them to your PATH environment variables.  Somewhere under the Python directory there is a subdirectory with a scons batch file in it.  You have to add that path to your &quot;PATH&quot; environment variable.  <br />
<br />
Could you write it more detail. What directory?<br />
What is this path exactly.<br />
And to run compilation we are going to main folder of NSIS, or NSIS source folder? (to write in console the &quot;Scons&quot; command).  <br />
Regards,<br />
-Pawel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">27th October 2008, 14:39</div></div><div class="posttext">I have been running scons in the nsis source folder, where the sconstruct file is.  Not sure if this is right or not.<br />
<br />
Here's a guide on environment variables:<br />
http://vlaurie.com/computers2/Articles/environment.htm</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pawel</div><div class="date">27th October 2008, 14:47</div></div><div class="posttext">Originally posted by AaronLS <br />
Here's a guide on environment variables:<br />
http://vlaurie.com/computers2/Articles/environment.htm  <br />
<br />
Thanks, but I know what are environment variables.<br />
I thought, you will write in this thread your variables, that you have added. Then, I could be sure it will work on my computer too.<br />
-Pawel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">28th October 2008, 04:32</div></div><div class="posttext">The only thing that seems to have done any good is this:<br />
C:\Python25\Scripts<br />
<br />
I found this as well and have gotten a little further:<br />
http://nsis.sourceforge.net/Docs/AppendixG.html<br />
<br />
I've gotten a little further I guess, but I'm not sure if I'm setting the VCToolkitInstallDir correctly.<br />
<br />
C:\nsis-2.40-src&gt;set VCToolkitInstallDir=C:\Program Files\Microsoft Visual Studio 8\.<br />
<br />
C:\nsis-2.40-src&gt;set MSSDK=C:\Program Files\Microsoft Platform SDK<br />
<br />
C:\nsis-2.40-src&gt;scons MSTOOLKIT=yes<br />
scons: Reading SConscript files ...<br />
Delete(&quot;nsis-28-Oct-2008.cvs&quot;)<br />
Delete(&quot;.instdist&quot;)<br />
Delete(&quot;.test&quot;)<br />
Using Microsoft tools configuration<br />
Checking for memset requirement... (cached) yes<br />
Checking for C library gdi32... (cached) yes<br />
Checking for C library user32... (cached) yes<br />
Checking for C library pthread... (cached) no<br />
Checking for C library iconv... (cached) no<br />
Checking for C library version... (cached) yes<br />
Checking for C library dl... (cached) no<br />
Checking for C library gdi32... (cached) yes<br />
Checking for C library iconv... (cached) no<br />
Checking for C library pthread... (cached) no<br />
Checking for C library user32... (cached) yes<br />
Checking for C library version... (cached) yes<br />
Checking for C++ library cppunit... (cached) no<br />
scons: done reading SConscript files.<br />
scons: Building targets ...<br />
&quot;C:\Program Files\Microsoft Platform SDK\bin\Win64\link.exe&quot; /nologo /opt:nowin9<br />
8 /map /entry:DllMain /NODEFAULTLIB /dll /out:build\release\AdvSplash\AdvSplash.<br />
dll kernel32.lib user32.lib gdi32.lib winmm.lib build\release\AdvSplash\advsplas<br />
h.obj build\release\AdvSplash\SHLIBEMITTER.obj<br />
   Creating library build\release\AdvSplash\AdvSplash.lib and object build\relea<br />
se\AdvSplash\AdvSplash.exp<br />
advsplash.obj : error LNK2019: unresolved external symbol ___security_cookie ref<br />
erenced in function _WndProc@16<br />
advsplash.obj : error LNK2019: unresolved external symbol @__security_check_cook<br />
ie@4 referenced in function _WndProc@16<br />
build\release\AdvSplash\AdvSplash.dll : fatal error LNK1120: 2 unresolved extern<br />
als<br />
scons: *** [build\release\AdvSplash\AdvSplash.dll] Error 1120<br />
scons: building terminated because of errors.<br />
<br />
C:\nsis-2.40-src&gt;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pawel</div><div class="date">28th October 2008, 23:42</div></div><div class="posttext">Originally posted by AaronLS <br />
The only thing that seems to have done any good is this:<br />
C:\Python25\Scripts<br />
 <br />
<br />
I got this error, when I have added some variables...<br />
<br />
C:\Program Files\NSIS\src&gt;scons<br />
scons: Reading SConscript files ...<br />
Delete(&quot;nsis-28-Oct-2008.cvs&quot;)<br />
Delete(&quot;.instdist&quot;)<br />
Delete(&quot;.test&quot;)<br />
Using Microsoft tools configuration<br />
Checking for memset requirement... (cached) yes<br />
Checking for C library gdi32... (cached) no<br />
Checking for C library user32... (cached) no<br />
Checking for C library pthread... (cached) no<br />
Checking for C library iconv... (cached) no<br />
Checking for C library version... (cached) no<br />
Checking for C library dl... (cached) no<br />
Checking for C library gdi32... (cached) no<br />
Checking for C library iconv... (cached) no<br />
Checking for C library pthread... (cached) no<br />
Checking for C library user32... (cached) no<br />
Checking for C library version... (cached) no<br />
Checking for C++ library cppunit... (cached) no<br />
scons: done reading SConscript files.<br />
scons: Building targets ...<br />
cl /nologo /GS- /O1 /W3 /D_CRT_SECURE_NO_WARNINGS /D_CRT_NONSTDC_NO_WARNINGS /c<br />
Contrib\AdvSplash\advsplash.c /Fobuild\release\AdvSplash\advsplash.obj<br />
advsplash.c<br />
Contrib\AdvSplash\advsplash.c(4) : fatal error C1083: Cannot open include file:<br />
'windows.h': No such file or directory<br />
scons: *** [build\release\AdvSplash\advsplash.obj] Error 2<br />
scons: building terminated because of errors.<br />
<br />
Any idea why my system cant find this file? (I have added the path to directory with this file to Visual Studio Include)<br />
-Pawel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">29th October 2008, 00:59</div></div><div class="posttext">That was the error I was originally getting.<br />
<br />
I isntalled the Platofrm SDK for Windows 2003 and C++ 2005 Express, then followed the direction from the link above.  Here it is again:<br />
http://nsis.sourceforge.net/Docs/AppendixG.html<br />
<br />
The specific steps from that page I followed was to run these three commands:<br />
set MSSDK=C:\Path\To\Platform SDK<br />
set VCToolkitInstallDir=C:\Path\To\VCToolkit<br />
scons MSTOOLKIT=yes<br />
<br />
Where C:\Path\To\Platform SDK is something like C:\Program Files\Microsoft Platform SDK\, you'll have to browse around for it.<br />
<br />
I don't know what VCToolkitInstallDir is supposed to be set to.  I tried setting it to my VS C++ 2005 isntall directory.<br />
<br />
I now get the linking errors above.  I also tried the parameter to skip all plugins, and it gets alot further, but eventually I get the same link error again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th November 2008, 22:27</div></div><div class="posttext">VCToolkitInstallDir is only for the very old and probably no longer available VC Toolkit. I use it to build the nightly build because it's a standalone version which doesn't require the GUI and runs fine on WINE. For Visual C++ Express, it should just work once you properly install the latest Platform SDK. Missing windows.h means you haven't properly installed and configured Platform SDK.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">7th November 2008, 22:41</div></div><div class="posttext">Yes, you are correct, the Windows.h error was because I was installing the wrong 2008 platform SDK instead of the 2003 version.  I've gotten past that, but haven't been able to proceed beyond the error &quot;advsplash.obj : error LNK2019: unresolved external symbol ___security_cookie referenced in function _WndProc@16&quot;<br />
<br />
I have tried this on a couple different setups on clean WinXP virtual machines.<br />
<br />
I will verify this evening, but I think if I don't set VCToolkitInstallDir then I get an error about it not being set.  These are the commands I am using:<br />
<br />
C:\nsis-2.40-src&gt;set VCToolkitInstallDir=C:\Program Files\Microsoft Visual Studio 8\.<br />
<br />
C:\nsis-2.40-src&gt;set MSSDK=C:\Program Files\Microsoft Platform SDK<br />
<br />
C:\nsis-2.40-src&gt;scons MSTOOLKIT=yes<br />
<br />
I have also tried:<br />
set VCToolkitInstallDir=C:\Program Files\Microsoft Visual Studio 8\VC\.<br />
<br />
Edit: Also I have tried the option to skip compiling plugins, but I still get the same error on a different obj file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th November 2008, 22:55</div></div><div class="posttext">Again, VCToolkitInstallDir is only for VC Toolkit and should not be used for Visual C++ Express 2008. Platform SDK 2003 is also very old and you should install the latest to make sure it works best with Visual C++ Express 2008. Once you get SCons to properly recognize you're using 2008 version by not using VCToolkitInstallDir, it'll automatically add /GS- which should disable the security cookie.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">7th November 2008, 23:24</div></div><div class="posttext">Thanks.  I was getting the link error using VS C++ 2005(not 2008) with the Windows Server 2003 platform SDK.<br />
<br />
I will try 2008 C++ Express with the Windows Server 2008 Platform SDK.  I'm not sure if scons supports this yet though, because I saw some others having issues with the 2008 Platform SDK because the directory structure has been changed around.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>