<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" .onInstSuccess question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  .onInstSuccess question NSIS Discussion" />
	
	<title> .onInstSuccess question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  .onInstSuccess question</div>
<hr />
<div class="pda"><a href="t-256847.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=256847">.onInstSuccess question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">corm01</div><div class="date">4th October 2006, 20:13</div></div><div class="posttext">What's going on...I have an nsi file that has a .onInstSuccess function.  In it, I attempt to change the permissions on some of the files installed.  The install part is fine, but the changing of permissions on the installed files is not.  <br />
<br />
I'm attempting this on XP, using MakeNSISW version 2.1 to do the compiles.  <br />
<br />
In doing some debugging I notice the following things:<br />
<br />
1). It only works when the files are already there(i.e. I run the installer twice).<br />
<br />
2). more perplexing, when I run that second time, if I do it running the install 'exe' produced by the compiler, it does not work, but if that second time I use the GUI tool and click the recompile and test button, then it works.<br />
<br />
3). I am changing perms via !system calls<br />
<br />
4). below is the a snippet of the log when I compiled, as it shows there are no issues.<br />
<br />
Function: &quot;.onInit&quot;<br />
InitPluginsDir<br />
File: &quot;WFXForm.ini&quot;-&gt;&quot;$PLUGINSDIR\WFXForm.ini&quot; [compress] 432/977 bytes<br />
FunctionEnd<br />
Function: &quot;.onInstSuccess&quot;<br />
!system: &quot;CACLS C:\CSGSystems /t /e /r Users&quot;<br />
processed dir: C:\CSGSystems<br />
processed file: C:\CSGSystems\launch.bat<br />
processed file: C:\CSGSystems\launcher.ico<br />
processed dir: C:\CSGSystems\vcmc<br />
processed dir: C:\CSGSystems\vcmc\20040607<br />
processed file: C:\CSGSystems\vcmc\20040607\CMD.EXE<br />
processed file: C:\CSGSystems\vcmc\20040607\half3.gif<br />
processed file: C:\CSGSystems\vcmc\20040607\launch.bat<br />
processed file: C:\CSGSystems\vcmc\20040607\launch.lnk<br />
processed file: C:\CSGSystems\vcmc\20040607\launcher.ico<br />
processed file: C:\CSGSystems\vcmc\20040607\msvcr71.dll<br />
processed file: C:\CSGSystems\vcmc\20040607\tci.ini<br />
processed file: C:\CSGSystems\vcmc\20040607\vcmc.exe<br />
processed file: C:\CSGSystems\vcmc\20040607\vcmcins.bat<br />
processed file: C:\CSGSystems\vcmc\20040607\vcmcins2k.bat<br />
!system: returned 0<br />
!system: &quot;CACLS C:\CSGSystems /t /e /g Users:f&quot;<br />
processed dir: C:\CSGSystems<br />
processed file: C:\CSGSystems\launch.bat<br />
processed file: C:\CSGSystems\launcher.ico<br />
processed dir: C:\CSGSystems\vcmc<br />
processed dir: C:\CSGSystems\vcmc\20040607<br />
processed file: C:\CSGSystems\vcmc\20040607\CMD.EXE<br />
processed file: C:\CSGSystems\vcmc\20040607\half3.gif<br />
processed file: C:\CSGSystems\vcmc\20040607\launch.bat<br />
processed file: C:\CSGSystems\vcmc\20040607\launch.lnk<br />
processed file: C:\CSGSystems\vcmc\20040607\launcher.ico<br />
processed file: C:\CSGSystems\vcmc\20040607\msvcr71.dll<br />
processed file: C:\CSGSystems\vcmc\20040607\tci.ini<br />
processed file: C:\CSGSystems\vcmc\20040607\vcmc.exe<br />
processed file: C:\CSGSystems\vcmc\20040607\vcmcins.bat<br />
processed file: C:\CSGSystems\vcmc\20040607\vcmcins2k.bat<br />
!system: returned 0<br />
<br />
MessageBox: 0: &quot;Install completed successfully.&quot;<br />
FunctionEnd<br />
<br />
<br />
SO my questions are:<br />
1). Is it wrong to expect that by the time .onInstSuccess is executed the files to be installed are not there yet?<br />
<br />
2). Given the same nsi file, isn't the 'recompile and test' in the GUI the same as executing the install 'exe' produced by the compile??? Because as stated above I am getting different behaviour when the files already exist.<br />
<br />
<br />
<br />
Sorry about the lengthy post, any help would be appreciated</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">4th October 2006, 20:43</div></div><div class="posttext">I think you're confused. !system is a compile time instruction. It will be executed when you build the installer, not when you run it.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">corm01</div><div class="date">4th October 2006, 22:48</div></div><div class="posttext">Thank You...yes, I am confused...so how would you approach doing any kind of 'post install' file manipulation??  Executing a script on the back end??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mr Inches</div><div class="date">5th October 2006, 11:33</div></div><div class="posttext">One of the Exec functions/plugins should do what you want e.g. NsExec or Exec (nsExec will hide the console window that is normally displayed when running a command line program.)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>