<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installing .NET managed dll's into the GAC, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installing .NET managed dll's into the GAC NSIS Discussion" />
	
	<title> Installing .NET managed dll's into the GAC [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installing .NET managed dll's into the GAC</div>
<hr />
<div class="pda"><a href="t-272505.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=272505">Installing .NET managed dll's into the GAC</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">helix400</div><div class="date">8th June 2007, 18:41</div></div><div class="posttext">I'm about a month or two away from deploying .net managed dll's into customers GAC's, so I looked into what it would take to do it right.<br />
<br />
So far, I'm a bit confuse how this would be done.  I did find this:<br />
<br />
http://nsis.sourceforge.net/Register_a_managed_.NET_DLL_in_the_GAC<br />
<br />
But it mentions that if the user doesn't have the SDK installed, then gacutil probably won't exist on the users machine (the 2.0 version of GACUtil only exists on my machine because of Visual Studio).  That makes the solution worthless.<br />
<br />
It also mentioned that instead of using NSIS to deploy the .NET dll, you use some C# app to do it for you.  But that has issus with Windows Vista users who don't have admin access (and I'd assume any non-admin user).<br />
<br />
Another thread (http://forums.winamp.com/showthread.php?s=&amp;threadid=263459&amp;highlight=gac),   talked about this too, and it seemed a solution was to package gacutil with the install.  But, then 	<br />
mayevski chimed in and said you're not allowed to do that.<br />
<br />
So I'm just stuck and asking for help.  Are there any clean methods for installing a .NET dll into the GAC?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n_baua</div><div class="date">12th June 2007, 07:51</div></div><div class="posttext">Hi,<br />
<br />
I guess this is not the easy task even either.<br />
First you would have to look around all the requirements and if they are available then install the  .net dll to GAC<br />
<br />
The steps should be as under;<br />
<br />
1&gt; Check if supported OS.. (if No skip installation else proceed)<br />
<br />
2&gt; Check if Admin Rights are available..<br />
. [if No skip installation else proceed]<br />
3&gt; Check if required framework installed.... (if No you can launch installer from your installation disk OR  redirect user to online for download OR proceed)<br />
4&gt; To install the .Net dll proceed as normal with the GacUtil.exe (Make sure you have sn.exe to strong name the same dlls or better you have them strong name before you ship).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">helix400</div><div class="date">12th June 2007, 20:57</div></div><div class="posttext">Thanks n_baua for the update.  Your approach would work, but like you said, it's not an easy task.  <br />
<br />
It seems the best approach would be to create a plugin that uses C++ code to work with Fusion to do all of this the Microsoft recommended way.<br />
<br />
A couple good sites that show how to do it are:<br />
<br />
http://www.codeguru.com/csharp/.net/net_general/assemblies/article.php/c12793/<br />
<br />
and <br />
<br />
http://support.microsoft.com/kb/317540<br />
<br />
Unfortunately, my C++ skills are weak.  :(  <br />
<br />
Our alternate approach is to just install all of our applications to a common folder.  That way, they can all share the same bin folder, and no GAC registeration is necessary.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n_baua</div><div class="date">13th June 2007, 06:49</div></div><div class="posttext">Hi Helix,<br />
<br />
I am not seeing the following thing as a good practice,<br />
<br />
Our alternate approach is to just install all of our applications to a common folder. That way, they can all share the same bin folder, and no GAC registeration is necessary.<br />
 <br />
<br />
The objective to use the GAC is to have a system wide usage and not just with the projects which we have created, another issue is if we choose to use c:\myFolder or some other static location as a prefered common directory, some one may tamper it or possibilities are the directory it self can be deleted, this is not possible with the GAC.<br />
<br />
in short the question is about the Security.<br />
<br />
BTW I am also not good in C++ ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jocker</div><div class="date">16th June 2007, 17:25</div></div><div class="posttext">the only good &amp; official way to put dlls into the GAC is to use a windows installer setup program.<br />
But there's an alternative, written in c# that uses fusion, as it was said before on this thread: gacutil2 by Christoph Wille<br />
http://chrison.net/OnlyColdFusionCanBeMoreComplicated.aspx<br />
it does not implement everything of gacutil, but at least it seems usable.<br />
<br />
good luck<br />
<br />
EDIT: why this board does not let me add links??<br />
chrison.net/OnlyColdFusionCanBeMoreComplicated.aspx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">16th June 2007, 22:22</div></div><div class="posttext">Stupid spam protection for new users<br />
<br />
http://chrison.net/OnlyColdFusionCanBeMoreComplicated.aspx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">helix400</div><div class="date">18th June 2007, 17:41</div></div><div class="posttext">Don't use the url block tags.  It doesn't work for me.  Just keep the URL as plain text, and the board will convert it.<br />
<br />
Btw, thanks for the link.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>