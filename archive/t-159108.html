<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" writing database scripts (SQLServer), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  writing database scripts (SQLServer) NSIS Discussion" />
	
	<title> writing database scripts (SQLServer) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  writing database scripts (SQLServer)</div>
<hr />
<div class="pda"><a href="t-159108.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=159108">writing database scripts (SQLServer)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">icebrrrg</div><div class="date">9th December 2003, 18:36</div></div><div class="posttext">got an email from someone reading the boards ...<br />
<br />
I need to create an installer which deploys a web application and then runs a couple scripts on an SQL server 2000 database.<br />
<br />
Iâ€™ve got the first part covered, but I really am no too sure how to run a script on the SQL server 2000 database.<br />
<br />
Can you provide any assistance?<br />
<br />
i've done this in my installer. i've set up a SQLServer database, logins, scheduled jobs, linked servers, created tables, stored procedures, etc. the best way to do this (IMHO) is to use the nsExec plugin.<br />
<br />
after you've checked to make sure SQLServer and the SQLServer tools are installed on the destination server (see the archives for how to do this), you can use the &lt;b&gt;osql.exe&lt;/b&gt; command to run scripts. here's an example:<br />
<br />
nsExec::Exec /TIMEOUT=20000 '&quot;$SQLTOOLS_PATH\osql.exe&quot; -U sa<br />
-P $SA_PWD -i &quot;$INSTDIR\db\CREATE_DB.sql&quot; -o &quot;$INSTDIR\db\CREATE_DB.log&quot;'<br />
<br />
... will allow you to execute a T-SQL script from the command line, using nsExec, all silently with output going to the details window.<br />
<br />
for one-off SQL statements, try:<br />
<br />
nsExec::ExecToLog /TIMEOUT=20000 `&quot;$SQLTOOLS_PATH\osql.exe&quot; -U sa<br />
-P $SA_PWD -d &quot;master&quot; -Q<br />
&quot;IF EXISTS (SELECT srvname FROM master.dbo.sysservers <br />
WHERE srvname = N'MYREMOTESERVER' AND isremote=1) 	<br />
EXEC sp_dropserver @server='MYREMOTESERVER', @droplogins = 'droplogins'&quot;`<br />
<br />
please ignore the line breaks in the above examples. hope this helps ... and please post questions here, don't email me personally. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ehi</div><div class="date">9th December 2003, 21:20</div></div><div class="posttext">You said :<br />
i've done this in my installer. i've set up a SQLServer database, logins, scheduled jobs, linked servers, created tables, stored procedures, etc. the best way to do this (IMHO) is to use the nsExec plugin.  <br />
<br />
Where can I find your installer.?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">icebrrrg</div><div class="date">7th January 2004, 17:28</div></div><div class="posttext">i haven't posted it; just posted the examples, and referred to my installer to show that i'm using said code. :)<br />
<br />
also, i don't think the backslashes are showing up in the code; need to check that.<br />
<br />
-m-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">7th January 2004, 18:03</div></div><div class="posttext">You should not use PHP but CODE to display backslashes.<br />
<br />
Why not create a NSIS Archive page with your examples?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>