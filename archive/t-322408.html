<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Processes plugin used on Win server 2008 x64, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Processes plugin used on Win server 2008 x64 NSIS Discussion" />
	
	<title> Processes plugin used on Win server 2008 x64 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Processes plugin used on Win server 2008 x64</div>
<hr />
<div class="pda"><a href="t-322408.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322408">Processes plugin used on Win server 2008 x64</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jammusi</div><div class="date">14th September 2010, 23:25</div></div><div class="posttext">Hi,<br />
<br />
I am using the Processes pluin in order to find when does the explorer process finished its loading after system reboot.<br />
It works perfect for Windows 7 (x86) and xp <br />
<br />
When running on Windows server x2008 x64 machine it does not discover the explorer process.<br />
<br />
I saw this plugin has another version for vista OS x64 platform (http://nsis.sourceforge.net/Processes_plug-in)<br />
<br />
1. Does this support any x64 platform (for instance Windows server 2008) ?<br />
2. Does it also support a x86 machines?<br />
   That is: Can I use this version of the plugin to compile the setup script on x86 machine as well as to be executed there?<br />
<br />
Tx<br />
<br />
Oren</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th September 2010, 00:32</div></div><div class="posttext">You cannot query a 64-bit process name (GetModuleBaseName) from a 32-bit process. You have to use something like WMI instead (there is a plug-in for this).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jammusi</div><div class="date">15th September 2010, 09:55</div></div><div class="posttext">Hi,<br />
<br />
I am not sure I understand what you mean. Are you talking about NSIS or is it a general limitation?<br />
<br />
I wrote a simple c# application compiled for x86 machine on a x86 machine.<br />
<br />
The application list all processes on the machine it runs on.<br />
<br />
I have executed this on the x64 machine and it showed everything (including the explorer process)<br />
<br />
tx<br />
<br />
Oren</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">15th September 2010, 10:15</div></div><div class="posttext">C# works differently as most C# assemblies contain what's needed to allow them to run as x86 or x64 as needed. with the NSIS processes plug-in, as it's a x86 only plug-in (and with NSIS being a x86 only program) it's not able to access certain x64 specific features (is just how it works).<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th September 2010, 10:35</div></div><div class="posttext">Also the .NET System.Diagnostics.Process class uses WMI to get its processes (which is why I said to use WMI) so it doesn't matter whether it's running as x86 or x64.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">15th September 2010, 10:47</div></div><div class="posttext">ah didn't know that's what it uses, thanks for that stu (shows i'm still a right noob when it comes to C# though i've only done a month of using it actively so far, heh).<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jammusi</div><div class="date">15th September 2010, 11:15</div></div><div class="posttext">Cool tx<br />
<br />
Is there any way to write NSIS plugins with c# or only C/  C++?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th September 2010, 11:34</div></div><div class="posttext">There is the CLR plug-in (search for it) but of course the destination machine must have .NET installed.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jammusi</div><div class="date">15th September 2010, 12:12</div></div><div class="posttext">tx<br />
<br />
I'll look it later</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th September 2010, 15:56</div></div><div class="posttext">You are better off using the WMI plug-in as I have already suggested. WMI is not part of .NET.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jammusi</div><div class="date">15th September 2010, 21:02</div></div><div class="posttext">Hi Stu,<br />
<br />
1. The Installer I am handling already have a .NET class performing many other tasks. <br />
This interface between the NSIS installer and the class is already &quot;live a kicking&quot; for a long time ans adding the FindProcess functionality was smooth.<br />
The .NET limitation is not an issue as the installed product nneds .NET runtime and it is pre-requisite for the setup any how.<br />
<br />
<br />
2. Before using this type of implementation - I briefly looked at the WMI plugin and didn't find processes related functionality. Adding the fact you said before:<br />
You have to use something like WMI instead (there is a plug-in for this).<br />
  I assumed that this plugin does not support that. <br />
<br />
Am I wrong?<br />
<br />
Tx<br />
<br />
Oren</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th September 2010, 21:31</div></div><div class="posttext">WMI (Windows Management Instrumentation) allows you to programmatically query the OS using WQL (a lot like SQL). The System.Management namespace in .NET provides WMI methods. For querying processes with WMI you'd use the Win32_Process WMI class (http://msdn.microsoft.com/en-us/library/aa394372%28VS.85%29.aspx). Just had a look at the WmiInspector plug-in and it does look very limited. The only option the plug-in gives is limited (WmiInspector::Request which may not be enough for what you are after). If .NET is a prerequisite then you might as well use that (and use the Process class).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jammusi</div><div class="date">15th September 2010, 21:37</div></div><div class="posttext">yes - this is exactly what i am doing <br />
<br />
<br />
:up:<br />
<br />
tx</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>