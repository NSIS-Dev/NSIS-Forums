<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to access a SysListView32 control, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to access a SysListView32 control NSIS Discussion" />
	
	<title> How to access a SysListView32 control [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to access a SysListView32 control</div>
<hr />
<div class="pda"><a href="t-319407.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=319407">How to access a SysListView32 control</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jiake</div><div class="date">24th May 2010, 08:16</div></div><div class="posttext">I write a script to create a SysListView32 control using nsDialogs, but it could only show a box. I want to insert columns and items into it, but after read the Messages of SysListView32 control at MSDN, I know that I must use API to access this control as some of the messages need &quot;the pointer to an LVCOLUMN structure that contains the attributes of the new column&quot;.<br />
http://forums.winamp.com/attachment.php?attachmentid=47008&amp;stc=1&amp;d=1274685598<br />
I don't know how to use System plug-in to access it. I hope that nsDialogs provide more controls support, such as msctls_trackbar32, SysListView32, SysTreeView32 etc. in future.<br />
!include &quot;MUI2.nsh&quot;<br />
;!include &quot;UsefulLib.nsh&quot;<br />
<br />
Name &quot;List View&quot;<br />
OutFile SysListView32.exe<br />
InstallDir $TEMP<br />
<br />
ShowInstDetails Show<br />
<br />
Page custom CreatePage<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
Section Install<br />
<br />
SectionEnd<br />
<br />
Function CreatePage<br />
<br />
    !insertmacro MUI_HEADER_TEXT &quot;List view control&quot; &quot;A SysListView32 control created by nsDialogs plugin&quot;<br />
<br />
    nsDialogs::Create 1018<br />
    Pop $0<br />
    ${If} $0 == error<br />
        Abort<br />
    ${EndIf}<br />
    <br />
    ${NSD_CreateLabel} 0u 0u 300u 8u &quot;Please specify the target folder where to install this software:&quot;<br />
    Pop $1<br />
    ${NSD_CreateFileRequest} 0u 12u 232u 12u &quot;D:\TTPlayer&quot;<br />
    Pop $2<br />
    ${NSD_CreateBrowseButton} 240u 12u 60u 12u &quot;&amp;Browse...&quot;<br />
    Pop $3<br />
    ${NSD_OnClick} $3 DirSelect<br />
    ${NSD_CreateGroupBox} 0u 28u 300u 112u &quot;Drive space:&quot;<br />
    Pop $4<br />
    !define IDC_LISTVIEW        1600<br />
    !define LVS_REPORT          0x00000001<br />
    !define LVS_SINGLESEL       0x00000004<br />
    !define LVM_SETBKCOLOR      0x00001001<br />
    !define LVM_INSERTITEM      0x00001007<br />
    !define LVM_INSERTCOLUMN    0x0000101B<br />
    !define LVM_SETCOLUMNWIDTH  0x0000101E<br />
    ; Using nsDialogs<br />
    nsDialogs::CreateControl /NOUNLOAD SysListView32 ${DEFAULT_STYLES}|${WS_TABSTOP}|${LVS_REPORT}|${LVS_SINGLESEL} ${WS_EX_CLIENTEDGE} 5u 40u 290u 95u &quot;ListView&quot;<br />
    Pop $5<br />
    ; Using Win32 API<br />
    # FindWindow $0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
    # System::Call 'kernel32::GetModuleHandle(i 0) i.r5'<br />
    # System::Call 'user32::CreateWindowEx(i ${WS_EX_CLIENTEDGE}, t &quot;SysListView32&quot;, t &quot;&quot;, i ${DEFAULT_STYLES}|${WS_TABSTOP}|${LVS_REPORT}|${LVS_SINGLESEL}, i 8, i 65, i 434, i 154, i $0, i ${IDC_LISTVIEW}, i r5, i 0) i.r5'<br />
    SendMessage $5 ${LVM_SETBKCOLOR} 0 0xC7EDCC<br />
    nsDialogs::Show<br />
FunctionEnd<br />
<br />
Function DirSelect<br />
<br />
    ${NSD_GetText} $2 $R0<br />
    nsDialogs::SelectFolderDialog &quot;$(^DirBrowseText)&quot; &quot;$R0&quot;<br />
    Pop $R0<br />
    ${IfNot} $R0 == error<br />
        ${NSD_SetText} $2 $R0<br />
    ${EndIf}<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">24th May 2010, 11:54</div></div><div class="posttext">until somebody abstracts the System plugin calls to manipulate these, you might be easier off with either http://nsis.sourceforge.net/EmbeddedLists_plug-in or http://nsis.sourceforge.net/InstallOption****plug-in</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jiake</div><div class="date">1st July 2010, 03:29</div></div><div class="posttext">Hey, a person (username gfm688) in Dreams8.com write it to access the ListView control, and I made a demo using it:<br />
http://forums.winamp.com/attachment.php?attachmentid=47188</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JohaViss</div><div class="date">1st July 2010, 10:08</div></div><div class="posttext">Hi Jiake,<br />
<br />
This looks great.:cool:<br />
Any chance to provide the source to this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jiake</div><div class="date">1st July 2010, 13:21</div></div><div class="posttext">Hi Jiake,<br />
<br />
This looks great.:cool:<br />
Any chance to provide the source to this?<br />
<br />
See this thread:<br />
http://forums.winamp.com/showthread.php?p=2676715</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>