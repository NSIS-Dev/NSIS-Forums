<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" really needs to get done, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  really needs to get done NSIS Discussion" />
	
	<title> really needs to get done [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  really needs to get done</div>
<hr />
<div class="pda"><a href="t-253752.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=253752">really needs to get done</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Potz</div><div class="date">21st August 2006, 18:44</div></div><div class="posttext">Hey I am having problems with my installer.  I added a new page to edit a Registry file.  This is before it is put into regedit.  I get to this point and it stalls the installer.  I was wondering if anyone can tell me how to fix this.  Here is my code....<br />
<br />
I really need this to be finished up as soon as possible so any info would be greatly apreciated.  Thanks<br />
<br />
<br />
;show regEdit gui---------------------------<br />
Function regEdit<br />
<br />
!insertmacro MUI_HEADER_TEXT &quot;Edit the Registry,&quot; &quot;read instruction below for this step.&quot;<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;RegEditing.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;RegEditing.ini&quot;<br />
<br />
FunctionEnd<br />
;-----------------------------------------------------<br />
<br />
;Edit Generic NBC Reg Key------------------------------<br />
Function leaveRegEdit<br />
<br />
ReadINIStr $7 &quot;$PLUGINSDIR\Regedit.ini&quot; &quot;Field 2&quot; &quot;State&quot;<br />
ReadINIStr $6 &quot;$PLUGINSDIR\Regedit.ini&quot; &quot;Field 1&quot; &quot;State&quot;<br />
<br />
Call Regedit1<br />
Call Regedit2<br />
<br />
FunctionEnd<br />
;------------------------------------------------------------<br />
<br />
;------------------------------------------------------------<br />
Function Regedit1<br />
<br />
StrCpy $0 &quot;$6&quot; # set your custom string<br />
StrCpy $1 &quot;/&quot; # set the character to insert<br />
StrLen $2 $0 # get the length of your string to loop through it<br />
StrCpy $3 &quot;0&quot; # init the loop counter<br />
StrCpy $4 &quot;&quot; # init output var<br />
<br />
loop: # begin of the loop<br />
StrCpy $5 $0 1 $3 # copy one character of your string to a temp var (offset $3 counts up)<br />
StrCpy $4 &quot;$4$1$5&quot; # add the character extracted and the one to insert everytime<br />
IntOp $3 $3 + 1 # increase counter/offset<br />
IntCmp $2 $3 end loop #stop the loop if end of string reached, else continue<br />
end:<br />
# at this stage, $4 will be &quot;/C/o/m/p/a/n/y&quot;<br />
<br />
Push &quot;/I/I/M/S&quot; #text to be replaced<br />
Push $4 #replace with<br />
Push all #replace all occurrences<br />
Push all #replace all occurrences<br />
Push &quot;$INSTDIR\WARN\Dashboard\NBC\Generic NBC reg keys.reg&quot; #file to replace in<br />
Call AdvReplaceInFile<br />
FunctionEnd<br />
;------------------------------------------------------------<br />
<br />
;------------------------------------------------------------<br />
Function Regedit2<br />
<br />
StrCpy $0 &quot;$7&quot; # set your custom string<br />
StrCpy $1 &quot;/&quot; # set the character to insert<br />
StrLen $2 $0 # get the length of your string to loop through it<br />
StrCpy $3 &quot;0&quot; # init the loop counter<br />
StrCpy $4 &quot;&quot; # init output var<br />
<br />
loop1: # begin of the loop<br />
StrCpy $5 $0 1 $3 # copy one character of your string to a temp var (offset $3 counts up)<br />
StrCpy $4 &quot;$4$1$5&quot; # add the character extracted and the one to insert everytime<br />
IntOp $3 $3 + 1 # increase counter/offset<br />
IntCmp $2 $3 end loop1 #stop the loop if end of string reached, else continue<br />
end:<br />
# at this stage, $4 will be &quot;/C/o/m/p/a/n/y&quot;<br />
<br />
Push &quot;/C/A/S/P/O/D&quot; #text to be replaced<br />
Push $4 #replace with<br />
Push all #replace all occurrences<br />
Push all #replace all occurrences<br />
Push &quot;$INSTDIR\WARN\Dashboard\NBC\Generic NBC reg keys.reg&quot; #file to replace in<br />
Call AdvReplaceInFile<br />
FunctionEnd<br />
;------------------------------------------------------</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">21st August 2006, 22:28</div></div><div class="posttext">Did you notice that you have the same label in both functions? &quot;end:&quot; is not needed in either function. replace the references to it with a 0 (a placeholder) since you don't need them.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Potz</div><div class="date">21st August 2006, 22:49</div></div><div class="posttext">What do you mean Refereces?  just put a &quot;0&quot; instead of a &quot;end:&quot;?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">22nd August 2006, 00:16</div></div><div class="posttext">References are the places where you used the label, the IntCmp instructions. You take out the label name and put in a zero:<br />
<br />
IntCmp $2 $3 0 loop1 #stop the loop if end of string reached, else continue<br />
# at this stage, $4 will be &quot;/C/o/m/p/a/n/y&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">22nd August 2006, 02:34</div></div><div class="posttext">It's OK to have the lables named the same--they are in different functions, so there won't be any confusion in doing do.<br />
<br />
But, you should extract the page file during .onInit, not in the page's display function.  As you have it written, the custom page will be overwritten (set back to default) each time it's displayed becuase you're re-extracting the file at the beginning of the show function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Potz</div><div class="date">24th August 2006, 03:32</div></div><div class="posttext">so would you know why it would be stalling?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">24th August 2006, 04:49</div></div><div class="posttext">Did you read the 2nd part of my post?<br />
<br />
[edit]<br />
Also: <br />
change your IntCmp functions to this:<br />
<br />
IntCmp $2 $3 end loop loop<br />
<br />
Without the last parameter, it was stopping the loop when $2 was greater than $3 (which would have been all the time when starting the loop).  With your original code, you would have had $4 = &quot;/c&quot; and not &quot;/C/o/m/p/a/n/y&quot;.<br />
[end edit]</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>