<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Issues with ListBox, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Issues with ListBox NSIS Discussion" />
	
	<title> Issues with ListBox [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Issues with ListBox</div>
<hr />
<div class="pda"><a href="t-330497.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330497">Issues with ListBox</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ksps1024</div><div class="date">10th May 2011, 21:39</div></div><div class="posttext">Hi,<br />
<br />
I'm having issues with the listbox control.  I have created a custom page with a listbox, and am populating it with strings read from a file(&gt;1000 lines).  The problem I'm experiencing is that while the items are being inserted into the listbox, I do not see them there until the process completes.  Now the interesting part is that I can see the vertical scrollbar shrink.  Once the file read is complete, then it displays the items in the listbox.....<br />
<br />
Below is excerpt for the insertion of the strings.<br />
<br />
<br />
${NSD_CreateListBox} 0 25 100% 80% &quot; &quot;<br />
pop $listbox<br />
<br />
SendMessage $listbox ${LB_INSERTSTRING} -1 &quot;STR:Delete: $R0&quot;<br />
<br />
<br />
<br />
Any ideas how to get around this?<br />
<br />
I'm trying to accomplish something similar to the install part where you can see the details of the installation.<br />
<br />
Thanks in advance....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">11th May 2011, 07:33</div></div><div class="posttext">I do not see them there until the process completes<br />
<br />
This is OK, because painting of the control is locked and whole control is repainted at the end.<br />
Try to send WM_REDRAW message after each LB_INSERTSTRING - but you will lose a lot of performance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ksps1024</div><div class="date">11th May 2011, 14:10</div></div><div class="posttext">How is this done in the MUI_PAGE_INSTFILES where you can see the items being inserted in the details box (I assume WM_REDRAW is being sent??)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th May 2011, 14:13</div></div><div class="posttext">That uses a list view control and inserts items from another thread separate to the UI thread.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ksps1024</div><div class="date">11th May 2011, 14:28</div></div><div class="posttext">Are there any examples out there that mimic the INSTFILES page?  If not can you point me in the right direction with the listview?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th May 2011, 17:16</div></div><div class="posttext">Search Google for &quot;nsis listview&quot;.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vicokoby</div><div class="date">11th June 2011, 00:03</div></div><div class="posttext">Please teachme how to get the selected strings in a ListBox with the style ${LBS_MULTIPLESEL}<br />
<br />
${NSD_LB_GetSelection} return only a item, I want recover several items.<br />
<br />
Please helpme!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th June 2011, 16:42</div></div><div class="posttext">These are the messages you can send: http://msdn.microsoft.com/en-us/library/ff485967%28v=vs.85%29.aspx<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vicokoby</div><div class="date">16th June 2011, 18:32</div></div><div class="posttext">Please helpme with this issue,<br />
<br />
This is a try to get the selected items<br />
<br />
!macro Show_Selected_Items ListBox_HWND<br />
  <br />
  StrCpy $0 ${ListBox_HWND} ; $0 = ListBox handle<br />
  <br />
  System::Alloc 1024<br />
  Pop $1<br />
  StrCpy $2 $1 ; $2 = buffer to store the selected items.<br />
  <br />
  System::Call 'user32::SendMessage(i, i, i, i) i(r0, ${LB_GETSELITEMS}, 100, r2) .r3' ; $3 = Number of selected items; (Max capacity: 100)<br />
  StrCpy $4 0 ; $4 = Counter<br />
  <br />
  Next:<br />
    IntCmp $4 $3 Done ShowItem Done <br />
  <br />
  ShowItem:<br />
    ; Here is my problem<br />
    ; My problem is that not you how to pass the elements from the buffer to the message<br />
    ; The enclosed Code line is incorrect please helps me to fix it<br />
    ; That line returns any element of the listbox, not the selected items.<br />
    <br />
    ;-------------------------------------------------------------------------------<br />
    System::Call 'user32::SendMessage(i, i, i, t) i(r0, ${LB_GETTEXT}, r4, .s) .r6' <br />
    ;-------------------------------------------------------------------------------<br />
    <br />
    Pop $5 ; $5 = Selected Item (It is what wanted)<br />
    MessageBox MB_YESNO &quot;Selected Item: $5 Size: $6$\n$\nDo you want to continue?&quot; IDNO Done<br />
    IntOp $4 $4 + 1<br />
    Goto Next<br />
  <br />
  Done:<br />
    System::Free $1<br />
<br />
!macroend<br />
<br />
<br />
<br />
<br />
Example complete: 48913<br />
<br />
<br />
Please give me more help!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">16th June 2011, 21:16</div></div><div class="posttext">Your LB_GETTEXT code is ok, but you need to get the item index out of the array you filled with LB_GETSELITEMS<br />
<br />
!macro Show_Selected_Items ListBox_HWND<br />
  <br />
  StrCpy $0 ${ListBox_HWND} ; $0 = ListBox handle<br />
  <br />
  System::Alloc 1024 ; max items would be 1024/4, not 100...<br />
  Pop $2<br />
  <br />
  <br />
  System::Call 'user32::SendMessage(i, i, i, i) i(r0, ${LB_GETSELITEMS}, 100, r2) .r3'<br />
  StrCpy $4 0 ; $4 = Counter<br />
  <br />
  Next:<br />
    IntCmp $4 $3 Done ShowItem Done <br />
<br />
  ShowItem:<br />
    IntOp $5 $4 * 4<br />
    IntOp $5 $5 + $2<br />
    System::Call '*$5(i.r5)'<br />
    <br />
    System::Call 'user32::SendMessage(i, i, i, t) i(r0, ${LB_GETTEXT}, r5, .r5) .r6' <br />
    MessageBox MB_YESNO &quot;Selected Item: $5 Size: $6$\n$\nDo you want to continue?&quot; IDNO Done<br />
    <br />
    IntOp $4 $4 + 1<br />
    Goto Next<br />
  Done:<br />
    System::Free $2<br />
!macroend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vicokoby</div><div class="date">17th June 2011, 15:36</div></div><div class="posttext">Thank you very much!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>