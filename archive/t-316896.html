<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" CopyFiles problem with Windows 2008 Server, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  CopyFiles problem with Windows 2008 Server NSIS Discussion" />
	
	<title> CopyFiles problem with Windows 2008 Server [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  CopyFiles problem with Windows 2008 Server</div>
<hr />
<div class="pda"><a href="t-316896.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=316896">CopyFiles problem with Windows 2008 Server</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">rsvargas</div><div class="date">8th February 2010, 20:48</div></div><div class="posttext">I have a script that worked fine for Windows 2000 and Windows XP and 2003 Server, I haven't tested it on vista, but on 2008 Server the CopyFiles command is always failing.<br />
<br />
this is my script:<br />
<br />
  ClearErrors<br />
  CopyFiles &quot;$INSTDIR\\Server\\myLib.dll&quot; &quot;$INSTDIR\\Server\\myLib-w.dll&quot;<br />
  IfErrors 0 +2<br />
    Abort &quot;Error copying Server Library&quot;<br />
<br />
<br />
And it always fall in the IfErrors clause<br />
<br />
<br />
Any ideas on what to do?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">8th February 2010, 21:33</div></div><div class="posttext">Check if the file even exists in the first place. And check if you have sufficient access privileges to write to that subdir. The directory might also need to exist before you start copying.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsvargas</div><div class="date">9th February 2010, 00:13</div></div><div class="posttext">The directory exists, and i'm running the installer as administrator (the original file was created with another installer which as run as the administrator as well), if I run these commands:<br />
<br />
<br />
  Rename    &quot;$INSTDIR\Server\myLib.pdb&quot; &quot;$INSTDIR\Server\myLib-w.pdb&quot;<br />
  IfErrors 0 +2<br />
    Abort &quot;Error copying DLL's PDB&quot;<br />
  ClearErrors<br />
  File &quot;files\myLib-wrapper.dll&quot; &quot;$INSTDIR\Server\myLib.dll&quot;<br />
  IfErrors 0 +2<br />
    Abort &quot;Error installing wrapper&quot;<br />
<br />
<br />
then it runs OK...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">9th February 2010, 08:29</div></div><div class="posttext">I'm noticing a distinct lack of backslashes in that code... o__O</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsvargas</div><div class="date">9th February 2010, 10:52</div></div><div class="posttext">The first one i've reviewed and scaped the backslashes, this one I didn't notice before it was too late (I can't edit it anymore). But the backslashes are there...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">9th February 2010, 16:00</div></div><div class="posttext">You possibly have the installer set to not overwrite existing files?<br />
http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.2.8</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsvargas</div><div class="date">9th February 2010, 16:15</div></div><div class="posttext">The destination file does not exist (but the origin file exists, as well as the destination folder)<br />
<br />
Anyway, the overwrite was set with<br />
<br />
<br />
  SetOverwrite try<br />
<br />
<br />
in a previous (not optional) section.<br />
<br />
Is there any register with the error cause? Or any other ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">9th February 2010, 22:11</div></div><div class="posttext">Eh? If the file doesn't already exist, why does renaming the existing file have any influence?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rsvargas</div><div class="date">10th February 2010, 00:16</div></div><div class="posttext">It doesn't, I just said that renaming works to demonstrate that I have permissions on the folder.<br />
<br />
I'm curious to know why it worked fine on XP, 2K and 2003 Server and doesn't work on 2008 Server...<br />
<br />
CopyFiles uses a superseeded Windows API, but I don't think that's the reason...<br />
<br />
When it fails it just log that's failed, it doesn't log why...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">10th February 2010, 08:14</div></div><div class="posttext">I suppose you could dive into the code, see which API call is made for CopyFiles, and then call it yourself using the system plugin. You might just be able to get a more detailed returncode from that.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>