<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" DirRequest only with local drives?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  DirRequest only with local drives? NSIS Discussion" />
	
	<title> DirRequest only with local drives? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  DirRequest only with local drives?</div>
<hr />
<div class="pda"><a href="t-265372.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=265372">DirRequest only with local drives?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">EmL</div><div class="date">8th February 2007, 09:27</div></div><div class="posttext">Hi,<br />
<br />
i've created a custom page via installoptions using the dirrequest control. Is there a way only to show local drives (no Network and exchangeable/removeable Disks)?<br />
<br />
Bye</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">8th February 2007, 10:44</div></div><div class="posttext">Could Root to be a work around this?<br />
<br />
Used by DirRequest controls to specify the root directory of the search. By default, this allows the user to browse any directory on the computer. This will limit the search to a particular directory on the system.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EmL</div><div class="date">8th February 2007, 12:49</div></div><div class="posttext">Unfortunaly not, cause if there are 2 Drives (e.g. C:\and D:\ are installed on the System i would not be able to select D:\ as a destiation if i'd configurd C:\ as Root.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EmL</div><div class="date">9th February 2007, 11:34</div></div><div class="posttext">So ... does anybody know if it's possible with InstallOptions or maybe can i call a Windows System Dialog as a workaround?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th February 2007, 12:13</div></div><div class="posttext">As far as I know, that's not possible with SHBrowseForFolder and therefore not possible with InstallOptions.<br />
<br />
ROOT allows you to set virtual folders as roots as well, so there might be some virtual folder for local drives that I do not know of. For example, ::{20D04FE0-3AEA-1069-A2D8-08002B30309D} is My Computer.<br />
<br />
The simplest solution I can suggest is verifying the user's selection in the leave function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">9th February 2007, 12:32</div></div><div class="posttext">what about this:<br />
<br />
BIF_RETURNONLYFSDIRS<br />
    Only return file system directories. If the user selects folders that are not part of the file system, the OK button is grayed.<br />
<br />
http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/reference/structures/browseinfo.asp</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th February 2007, 12:41</div></div><div class="posttext">That's already used by default and doesn't limit the selection of files under network or removable drives.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EmL</div><div class="date">10th February 2007, 13:01</div></div><div class="posttext">Thx for the replies ... i think i will do the check within the leave function as suggested by kichik. However this would may be a useful feature in future!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>