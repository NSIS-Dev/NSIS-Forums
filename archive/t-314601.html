<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS Install Script Wipes Out Desktop Icons, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS Install Script Wipes Out Desktop Icons NSIS Discussion" />
	
	<title> NSIS Install Script Wipes Out Desktop Icons [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS Install Script Wipes Out Desktop Icons</div>
<hr />
<div class="pda"><a href="t-314601.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=314601">NSIS Install Script Wipes Out Desktop Icons</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ahingeveld</div><div class="date">14th November 2009, 15:29</div></div><div class="posttext">Please Help. I utilized one of the example scripts to develop a rather complex installer for a VB6 application. Unfortunately, it has the habit of wiping out all the users desktop shortcuts during the &quot;install&quot; phase on XP systems. Folders are not affected. The only scripting related to the createshortcuts commands are...<br />
 <br />
CreateShortCut &quot;$SMPrograms\Sheriffs Applications\Storm.lnk&quot; &quot;$InstDir\bin\Storm.exe&quot;<br />
CreateShortCut &quot;$SMPrograms\Sheriffs Applications\Uninstall Storm.lnk&quot; &quot;$InstDir\uninstall.exe&quot;<br />
<br />
These shortcuts are properly added to the start menu and work properly. They are also properly deleted during uninstall. I've gone through and remarked out most of the lines and reviewed each command without success. <br />
<br />
Please, any ideas on what would cause this would be appreciated.<br />
<br />
:cry: :cry: :cry:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zinthose</div><div class="date">14th November 2009, 15:34</div></div><div class="posttext">Not enough information..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ahingeveld</div><div class="date">14th November 2009, 16:08</div></div><div class="posttext">Attached is the .nsi script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">14th November 2009, 21:51</div></div><div class="posttext">I can't find any code line that might affect the desktop, so either it's not caused by the installer at all, or it's in one of the macros or external applications you execute.<br />
<br />
<br />
Anyway, your line<br />
    IfFileExists &quot;C:\Program Files\Adobe\Reader 9.0\Reader\AcroRd32.exe&quot; endAdobe beginAdobe<br />
is so extremely wrong, I hardly know where to begin... First of all, this won't work on any non-English Windows version. Second, it won't work on any x64 system either. Third, some people WILL install Adobe to another directory than the default. Fourth, there exist other pdf readers than just Adobe.....<br />
<br />
I could probably find many more reasons, but you get the idea. Forcing people to install Adobe is not only extremely arrogant, it will cause you to lose customers.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>