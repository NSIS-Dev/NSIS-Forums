<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" problem in auto-uninstalling old application before installing new application, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  problem in auto-uninstalling old application before installing new application NSIS Discussion" />
	
	<title> problem in auto-uninstalling old application before installing new application [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  problem in auto-uninstalling old application before installing new application</div>
<hr />
<div class="pda"><a href="t-178900.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=178900">problem in auto-uninstalling old application before installing new application</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ptgoel</div><div class="date">4th May 2004, 13:06</div></div><div class="posttext">Hi,<br />
<br />
I am trying http://nsis.sourceforge.net/archive/nsisweb.php?page=385<br />
<br />
to Auto-uninstall old application before installing new application.<br />
<br />
My Script looks like this<br />
--------<br />
Function .onInit<br />
		System::Call 'kernel32::CreateMutexA(i 0, i 0, t &quot;1234&quot;) i .r1 ?e' <br />
		Pop $R0 <br />
		StrCmp $R0 0 +3 <br />
			MessageBox MB_OK &quot;Installer is already running. Press OK to exit&quot; <br />
			Abort<br />
		<br />
		ReadRegStr $R0 HKLM \<br />
		&quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}&quot; \<br />
		&quot;UninstallString&quot;<br />
		StrCmp $R0 &quot;&quot; done<br />
<br />
		MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />
		&quot;${APPNAME} is already installed. $\n$\nClick `OK` to remove the \<br />
		previous version or `Cancel` to cancel this upgrade.&quot; \<br />
		IDOK uninst<br />
		Abort<br />
		<br />
		uninst:<br />
		ClearErrors<br />
		ExecWait '$R0 _?=$INSTDIR' ;Do not copy the uninstaller to a temp file<br />
		<br />
		IfErrors no_remove_uninstaller<br />
		<br />
		Goto uninstaller<br />
    ;components page, make sure all sections are uninstalled.<br />
		<br />
		no_remove_uninstaller:<br />
				<br />
		done:<br />
  <br />
FunctionEnd<br />
<br />
Section Uninstall<br />
	uninstaller:<br />
	<br />
	;Remove from registry...<br />
	DeleteRegKey HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}&quot;<br />
	DeleteRegKey HKLM &quot;SOFTWARE\${APPNAME}&quot;<br />
<br />
	; Delete self<br />
	Delete &quot;$INSTDIR\uninstall.exe&quot;<br />
<br />
SectionEnd<br />
--------------------<br />
This script is not working because of some problem in uninstaller section.<br />
<br />
I have written an uninstaller section seperately and i want control to jump to that section for uninstallation.<br />
<br />
what is the problem there??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evilO</div><div class="date">4th May 2004, 13:46</div></div><div class="posttext">Hi :)<br />
<br />
Well, I didn't go in details through the whole script but I think you've missed the point of the example:<br />
<br />
i want control to jump to that section for uninstallation.<br />
<br />
An installer don't jump to the Uninstall Section'. This special section is called automatically when the uninstaller is executed.<br />
<br />
Therefore in the '.onInit' function of your application you just have to execute the uninstaller of the previous version, providing that the 'Uninstall Section' of the previous version contains the code required to remove it. Not the 'Uninstall Section' of this version.<br />
<br />
<br />
evilO/Olive</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ptgoel</div><div class="date">5th May 2004, 05:34</div></div><div class="posttext">Thanks for the reply.<br />
<br />
Didn't thought in that direction :(<br />
<br />
:) Done.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>