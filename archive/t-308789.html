<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Unicode NSIS - Plugins Trouble, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Unicode NSIS - Plugins Trouble NSIS Discussion" />
	
	<title> Unicode NSIS - Plugins Trouble [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Unicode NSIS - Plugins Trouble</div>
<hr />
<div class="pda"><a href="t-308789.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=308789">Unicode NSIS - Plugins Trouble</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jr_spurs</div><div class="date">23rd July 2009, 10:15</div></div><div class="posttext">Hi everyone,<br />
<br />
I am currently using the Unicode NSIS branch and need to get some of the ANSI plugins working within my installer. <br />
<br />
I have been beavering away at trying to recompile/recode some existing plugins to get them working with Unicode NSIS.<br />
<br />
The three in particular that I need to get working are<br />
<br />
FontName - http://nsis.sourceforge.net/FontName_plug-in<br />
ButtonEvent - http://nsis.sourceforge.net/ButtonEvent_plug-in<br />
dialogsEx   - http://nsis.sourceforge.net/Dialog****plug-in<br />
<br />
Do you know are there unicode versions of these? <br />
<br />
Alternatively does anyone know of any step by step documentation on NSIS plugin development as I seem to be getting the same errors when I try to build the solution in Visual Studio 2005? <br />
<br />
I have using the Unicode pluginapi.h and pluginapi.lib files from the Unicode Plugin example when building.<br />
<br />
1&gt;   Creating library .\Debug/ButtonEvent.lib and object .\Debug/ButtonEvent.exp<br />
1&gt;ButtonEvent.obj : error LNK2019: unresolved external symbol __RTC_CheckEsp referenced in function &quot;void __cdecl ExecNSISFunc(int)&quot; (?ExecNSISFunc@@YAXH@Z)<br />
1&gt;ButtonEvent.obj : error LNK2001: unresolved external symbol __RTC_Shutdown<br />
1&gt;ButtonEvent.obj : error LNK2001: unresolved external symbol __RTC_InitBase<br />
1&gt;ButtonEvent.obj : error LNK2019: unresolved external symbol _popstring@4 referenced in function _AddEventHandler<br />
1&gt;ButtonEvent.obj : error LNK2001: unresolved external symbol _g_variables<br />
1&gt;ButtonEvent.obj : error LNK2001: unresolved external symbol _g_stacktop<br />
1&gt;ButtonEvent.obj : error LNK2001: unresolved external symbol _g_stringsize<br />
1&gt;ButtonEvent.obj : error LNK2019: unresolved external symbol _pushstring@4 referenced in function _WhichButtonId<br />
1&gt;ButtonEvent.obj : error LNK2019: unresolved external symbol ___security_cookie referenced in function _WhichButtonId<br />
1&gt;ButtonEvent.obj : error LNK2019: unresolved external symbol @__security_check_cookie@4 referenced in function _WhichButtonId<br />
1&gt;ButtonEvent.obj : error LNK2019: unresolved external symbol @_RTC_CheckStackVars@8 referenced in function _WhichButtonId<br />
1&gt;LINK : error LNK2001: unresolved external symbol __DllMainCRTStartup@12<br />
1&gt;.\Debug/ButtonEvent.dll : fatal error LNK1120: 12 unresolved externals<br />
<br />
Apolologies for the massive post. Any help here would be greatly appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">23rd July 2009, 13:04</div></div><div class="posttext">Hello,<br />
I ported my plugin (MSSQL_OLEDB) to 64bit.<br />
I am using VS2005 too.<br />
I had to add pluginapi.c to the project instead of using pluginapi.lib (there were some problems with functions decoration, the unicode version is compiled with vs2008).<br />
All char variables are to be defined TCHAR and all string functions must be modified to be Unicode aware (_sprintf_s or similar).<br />
If the plugins uses VARIANT or similar it could be a little more tricky.<br />
Feel free to check the source code of the plugin. That code works both for 32 and 64 bit.<br />
Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jr_spurs</div><div class="date">23rd July 2009, 15:17</div></div><div class="posttext">Thanks a million sgiustto. Ill give the pluginapi.c a try later.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gringoloco023</div><div class="date">20th February 2010, 12:07</div></div><div class="posttext">Did you have any luck in recompiling 'DialogsEx' ?<br />
<br />
I would be very interested in a unicode version.<br />
<br />
thanx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">20th February 2010, 16:19</div></div><div class="posttext">The __RTC_CheckEsp and ___security_cookie stuff should be disabled, search the forum for threads about compiling with VS2005<br />
<br />
g_stacktop and friends is in the .lib or one of the (nsis) plugin files, can't remember exactly where off the top of my head</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PerditionC</div><div class="date">22nd February 2010, 23:16</div></div><div class="posttext">DialogEx for Unicode can be found at http://www.fdos.org/win32/nsis/plugins/others/joel/dialogsex.3.zip<br />
<br />
For nsis plugins, generally disable all runtime checks, exceptions, etc, don't include default libs, then enable optimizations, link with pluginapi.c (in unicode nsis source), change most char to TCHAR, check for any calls to windows functions explicitly ending with A, they may be ok or may need to drop the A, wrap character and string constants with _T() or equiv, if it has exdll.h replace it with an include to pluginapi.h, either supply a mini-c-library or replace c library calls with the equiv from standard windows DLLs, eg #define strcpy lstrcpy; after some minor review &amp; fixes, test to ensure everything works as expected and you will have a plugin that can be compiled as ANSI or (by defining UNICODE) as UNICODE.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gringoloco023</div><div class="date">16th November 2010, 16:16</div></div><div class="posttext">As I was searching for the source of the dialogex plug-in for the reason that (I think) I found a bug with the unicode version of ${InputPwdBox}.<br />
<br />
I realized that the whole actual plug-in seems to be lost. I am just getting a 404 with either the above link from perditionC or the link from the nsis sourceforge plug-in page.<br />
<br />
Can anybody confirm this ?<br />
<br />
If so, does anybody have a copy of the source ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">16th November 2010, 16:39</div></div><div class="posttext">http://nsis.sourceforge.net/mediawiki/images/c/c6/Joel_plugins_src.7z</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gringoloco023</div><div class="date">16th November 2010, 18:24</div></div><div class="posttext">and to clarify, the (unicode) script I was using when I thought I found a bug, added the ansi version of the dialogex plug-in which was located in the scripts folder.<br />
<br />
So that's solved, no bug.<br />
<br />
Still, it's a bit odd that both the ansi &amp; unicode version of this plug-in seem to be lost :(</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>