<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Calling External Dll Text Parameters, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Calling External Dll Text Parameters NSIS Discussion" />
	
	<title> Calling External Dll Text Parameters [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Calling External Dll Text Parameters</div>
<hr />
<div class="pda"><a href="t-142495.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=142495">Calling External Dll Text Parameters</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">SNorthmore</div><div class="date">17th July 2003, 05:01</div></div><div class="posttext">I'm new to the NSIS Installer but so far it's worked great.<br />
I'm doing a Palm Application Install based on the example external system dll code. I'm using the Palm File Installer DLL Instaide.dll.<br />
Most calls are working fine. <br />
<br />
However I am having trouble with the call to PltInstallFile() which takes 2 text parameters as input. Here's the code snippit I am trying. <br />
;;;;;;;;;;;;;;;;;;;;;;;; <br />
  StrCpy $R0 &quot;0&quot;          ; assign memory to $0<br />
  System::Alloc 1024	; allocate space for username<br />
  Pop $1<br />
<br />
  ;Get User is working<br />
  System::Call 'Instaide::PltGetUser(i $R0, t, *i) i(.r0, .r1, r2).r3'<br />
  DetailPrint 'User: &quot;$1&quot;'<br />
  DetailPrint &quot;Path length: $2&quot;<br />
  DetailPrint &quot;Return value: $3&quot;<br />
<br />
  DetailPrint 'User Num: &quot;$R0&quot;'<br />
  DetailPrint 'User Name: &quot;$1&quot;'<br />
<br />
  System::Alloc 1024	; allocate space for filename<br />
  Pop $2<br />
<br />
  ; yes this file is there<br />
  StrCpy $2 &quot;$INSTDIR\PalmOS\MathLib.prc&quot;<br />
  DetailPrint 'Install File: &quot;$2&quot;'<br />
<br />
  System::Call 'Instaide::PltInstallFile(t, t) i(.r1, .r2).r3'<br />
  DetailPrint &quot;Return value: $3&quot;<br />
;;;;;;;;;;;;;;;<br />
<br />
The return value I get is alweays -554 or ERR_PILOT_BAD_FILENAME<br />
Is there a syntax error or somthing missing here?<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">17th July 2003, 16:01</div></div><div class="posttext">1. You don't need to allocate space for text variables (system does it).<br />
2. In plt install file you used .r1 and .r2, indicating to system you want this variables to receive values after function call, but in fact you need to pass the boss values TO function (not FROM).<br />
<br />
StrCpy $R0 &quot;0&quot;<br />
StrCpy $2 &quot;${NSIS_MAX_STRLEN}&quot;<br />
<br />
System::Call 'Instaide::PltGetUser(i $R0, t .r1, *i r2 r2) i.r3' <br />
<br />
StrCpy $2 &quot;$INSTDIR\PalmOS\MathLib.prc&quot; <br />
System::Call 'Instaide::PltInstallFile(t r1, t r2) i.r3' <br />
<br />
<br />
Hope this will help...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SNorthmore</div><div class="date">17th July 2003, 19:41</div></div><div class="posttext">Works now,<br />
Thanks!<br />
(BTW. The docs are very confusing)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">17th July 2003, 20:23</div></div><div class="posttext">What's so confusing in the docs? Any suggestions for improvement?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">17th July 2003, 20:42</div></div><div class="posttext">System DLL readme -&gt; HTML.<br />
<br />
-Stu :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">17th July 2003, 20:52</div></div><div class="posttext">yes please :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">17th July 2003, 21:30</div></div><div class="posttext">Section C.5 of the documentation is already a good tutorial, but brainsucker could indeed improve the System DLL reference.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>