<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem compiling with mstoolkit.py v1.3, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem compiling with mstoolkit.py v1.3 NSIS Discussion" />
	
	<title> Problem compiling with mstoolkit.py v1.3 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem compiling with mstoolkit.py v1.3</div>
<hr />
<div class="pda"><a href="t-228251.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228251">Problem compiling with mstoolkit.py v1.3</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">WebMatze</div><div class="date">12th October 2005, 15:17</div></div><div class="posttext">Hello,<br />
<br />
i'm having problem to compile NSIS with the latest version of MSTOOLKIT.py (1.3), it works perfectly with the previous version... here is the log<br />
<br />
D:\Scripts NSIS\NSIS-20051011&gt;scons -j4 MSTOOLKIT=YES<br />
scons: Reading SConscript files ...<br />
Delete(&quot;nsis-12-Oct-2005.cvs&quot;)<br />
Delete(&quot;.instdist&quot;)<br />
Delete(&quot;.test&quot;)<br />
Using Microsoft tools configuration<br />
Checking for main() in C library gdi32... (cached) yes<br />
Checking for main() in C library user32... (cached) yes<br />
Checking for main() in C library version... (cached) yes<br />
Checking for main() in C library pthread... (cached) no<br />
Checking for main() in C library stdc++... (cached) no<br />
Checking for main() in C library iconv... (cached) no<br />
Checking for main() in C library dl... (cached) no<br />
Checking for main() in C++ library cppunit... (cached) no<br />
scons: done reading SConscript files.<br />
scons: Building targets ...<br />
&quot;C:\Progra~1\Installers\MS-Platform-SDK\\bin\Win64\link.exe&quot; /nologo /opt:nowin9<br />
8 /map /entry:DllMain /NODEFAULTLIB /dll /out:build\release\InstallOptions\Insta<br />
llOptions.dll kernel32.lib user32.lib gdi32.lib shell32.lib comdlg32.lib build\r<br />
elease\InstallOptions\InstallerOptions.obj build\release\InstallOptions\ioptdll.<br />
res<br />
&quot;C:\Progra~1\Installers\MS-Platform-SDK\\bin\Win64\link.exe&quot; /nologo /opt:nowin9<br />
8 /map /OUT:build\release\Library\LibraryLocal\LibraryLocal.exe kernel32.lib ole<br />
aut32.lib version.lib build\release\Library\LibraryLocal\LibraryLocal.obj<br />
LibraryLocal.obj : error LNK2019: unresolved external symbol &quot;__int64 std::_Fpz&quot;<br />
 (?_Fpz@std@@3_JA) referenced in function &quot;protected: virtual class std::fpos&lt;in<br />
t&gt; __thiscall std::basic_streambuf&lt;char,struct std::char_traits&lt;char&gt; &gt;::seekoff<br />
(long,int,int)&quot; (?seekoff@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE?AV?<br />
$fpos@H@2@JHH@Z)<br />
LibraryLocal.obj : error LNK2019: unresolved external symbol &quot;long const std::_B<br />
ADOFF&quot; (?_BADOFF@std@@3JB) referenced in function &quot;protected: virtual class std:<br />
:fpos&lt;int&gt; __thiscall std::basic_streambuf&lt;char,struct std::char_traits&lt;char&gt; &gt;:<br />
:seekoff(long,int,int)&quot; (?seekoff@?$basic_streambuf@DU?$char_traits@D@std@@@std@<br />
@MAE?AV?$fpos@H@2@JHH@Z)<br />
LibraryLocal.obj : error LNK2019: unresolved external symbol &quot;public: void __thi<br />
scall std::_String_base::_Xran(void)const &quot; (?_Xran@_String_base@std@@QBEXXZ) re<br />
ferenced in function &quot;public: int __thiscall std::basic_string&lt;char,struct std::<br />
char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt;::compare(unsigned int,unsigned in<br />
t,char const *,unsigned int)const &quot; (?compare@?$basic_string@DU   Creating libra<br />
ry build\release\Insta?$char_traits@D@stllOptions\InstallOd@@V?$allocator@D@ptio<br />
ns.lib and obj2@@std@@QBEHIIPBDIect build\release\@Z)<br />
LibraryLocal.oInstallOptions\Insbj : error LNK2019tallOptions.exp<br />
: unresolved external symbol &quot;public: void __thiscall std::locale::facet::_Regis<br />
ter(void)&quot; (?_Register@facet@locale@std@@QAEXXZ) referenced in function &quot;class s<br />
td::ctype&lt;char&gt; const &amp; __cdecl std::use_facet&lt;class std::ctype&lt;char&gt; &gt;(class st<br />
d::locale const &amp;)&quot; (??$use_facet@V?$ctype@D@std@@@std@@YAABV?$ctype@D@0@ABVloca<br />
le@0@@Z)<br />
LibraryLocal.obj : error LNK2019: unresolved external symbol &quot;public: class std:<br />
:locale::facet const * __thiscall std::locale::_Getfacet(unsigned int)const &quot; (?<br />
_Getfacet@locale@std@@QBEPBVfacet@12@I@Z) referenced in function &quot;class std::cty<br />
pe&lt;char&gt; const &amp; __cdecl std::use_facet&lt;class std::ctype&lt;char&gt; &gt;(class std::loca<br />
le const &amp;)&quot; (??$use_facet@V?$ctype@D@std@@@std@@YAABV?$ctype@D@0@ABVlocale@0@@Z<br />
)<br />
LibraryLocal.obj : error LNK2019: unresolved external symbol &quot;public: void __thi<br />
scall std::_String_base::_Xlen(void)const &quot; (?_Xlen@_String_base@std@@QBEXXZ) re<br />
ferenced in function &quot;protected: bool __thiscall std::basic_string&lt;char,struct s<br />
td::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt;::_Grow(unsigned int,bool)&quot; (?<br />
_Grow@?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@IAE_NI_N@Z)<br />
LibraryLocal.obj : error LNK2019: unresolved external symbol &quot;public: void __thi<br />
scall std::ios_base::_Addstd(void)&quot; (?_Addstd@ios_base@std@@QAEXXZ) referenced i<br />
n function &quot;protected: void __thiscall std::basic_ios&lt;char,struct std::char_trai<br />
ts&lt;char&gt; &gt;::init(class std::basic_streambuf&lt;char,struct std::char_traits&lt;char&gt; &gt;<br />
 *,bool)&quot; (?init@?$basic_ios@DU?$char_traits@D@std@@@std@@IAEXPAV?$basic_streamb<br />
uf@DU?$char_traits@D@std@@@2@_N@Z)<br />
LibraryLocal.obj : error LNK2019: unresolved external symbol &quot;struct _iobuf * __<br />
cdecl std::_Fiopen(char const *,int,int)&quot; (?_Fiopen@std@@YAPAU_iobuf@@PBDHH@Z) r<br />
eferenced in function &quot;public: class std::basic_filebuf&lt;char,struct std::char_tr<br />
aits&lt;char&gt; &gt; * __thiscall std::basic_filebuf&lt;char,struct std::char_traits&lt;char&gt;<br />
&gt;::open(char const *,int,int)&quot; (?open@?$basic_filebuf@DU?$char_traits@D@std@@@st<br />
d@@QAEPAV12@PBDHH@Z)<br />
build\release\Library\LibraryLocal\LibraryLocal.exe : fatal error LNK1120: 8 unr<br />
esolved externals<br />
cl /nologo /O2 /GX /W3 /TP /D_WIN32_IE=0x0500 /DNSIS_MAX_STRLEN=1024 /DNSIS_MAX_<br />
INST_TYPES=32 /DNSIS_DEFAULT_LANG=1033 /DNSIS_CONFIG_UNINSTALL_SUPPORT /DNSIS_CO<br />
NFIG_LICENSEPAGE /DNSIS_CONFIG_COMPONENTPAGE /DNSIS_CONFIG_SILENT_SUPPORT /DNSIS<br />
_CONFIG_VISIBLE_SUPPORT /DNSIS_CONFIG_ENHANCEDUI_SUPPORT /DNSIS_CONFIG_COMPRESSI<br />
ON_SUPPORT /DNSIS_COMPRESS_BZIP2_LEVEL=9 /DNSIS_CONFIG_CRC_SUPPORT /DNSIS_SUPPOR<br />
T_BGBG /DNSIS_SUPPORT_CODECALLBACKS /DNSIS_SUPPORT_MOVEONREBOOT /DNSIS_SUPPORT_A<br />
CTIVEXREG /DNSIS_SUPPORT_INTOPTS /DNSIS_SUPPORT_STROPTS /DNSIS_SUPPORT_STACK /DN<br />
SIS_SUPPORT_FILEFUNCTIONS /DNSIS_SUPPORT_FINDFIRST /DNSIS_SUPPORT_CREATESHORTCUT<br />
 /DNSIS_SUPPORT_INIFILES /DNSIS_SUPPORT_REGISTRYFUNCTIONS /DNSIS_SUPPORT_COPYFIL<br />
ES /DNSIS_SUPPORT_REBOOT /DNSIS_SUPPORT_FNUTIL /DNSIS_SUPPORT_EXECUTE /DNSIS_SUP<br />
PORT_SHELLEXECUTE /DNSIS_SUPPORT_GETDLLVERSION /DNSIS_SUPPORT_GETFILETIME /DNSIS<br />
_SUPPORT_HWNDS /DNSIS_SUPPORT_ENVIRONMENT /DNSIS_SUPPORT_RMDIR /DNSIS_SUPPORT_FI<br />
LE /DNSIS_SUPPORT_DELETE /DNSIS_SUPPORT_RENAME /DNSIS_SUPPORT_MESSAGEBOX /DNSIS_<br />
SUPPORT_VERSION_INFO /DNSIS_SUPPORT_STANDARD_PREDEFINES /DNSIS_LOCKWINDOW_SUPPOR<br />
T /DNSIS_CONFIG_PLUGIN_SUPPORT /DNSIS_VERSION=v12-Oct-2005.cvs /c Source\build.c<br />
pp /Fobuild\release\makensis\build.obj<br />
scons: *** [build\release\Library\LibraryLocal\LibraryLocal.exe] Error 1120<br />
build.cpp<br />
scons: building terminated because of errors.<br />
<br />
Can someone please help me to find where the problem is?<br />
Thanks in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th October 2005, 15:40</div></div><div class="posttext">It compiles just fine for me, and all that changed in 1.3 (http://cvs.sourceforge.net/viewcvs.py/nsis/NSIS/SCons/Tools/mstoolkit.py.diff?r1=1.2&amp;r2=1.3) is the order of the lib and include directories. Are you sure nothing else has changed? Have you tried cleaning up LibraryLocal before trying to build it again? Try:scons MSTOOLKIT=yes -c LibraryLocal</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WebMatze</div><div class="date">12th October 2005, 16:38</div></div><div class="posttext">I tried what you wrote, but i still get the same error...<br />
and i did'nt change anything, qith 1.2 it works but not with 1.3.<br />
Any idea?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th October 2005, 16:41</div></div><div class="posttext">Do you have files named iostream, istream, ostream, fstream, streambuf, ios or iosfwd in %MSSDK%\Include?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WebMatze</div><div class="date">12th October 2005, 16:57</div></div><div class="posttext">No, there is none of these files in that folder...<br />
Are they required to compile correctly? And where can i get them?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th October 2005, 17:04</div></div><div class="posttext">No, they shouldn't be there. They should be in VC Toolkit include directory. Their presence could have explained this error.<br />
<br />
Are you using cygwin or something similar to build NSIS?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WebMatze</div><div class="date">12th October 2005, 17:13</div></div><div class="posttext">No i'm using the ms platform sdk and the vc++ toolkit 2003 they are installed in :<br />
C:\Program Files\Installers\MS-Platform-SDK<br />
C:\Program Files\Installers\MS-VisualC++Toolkit2003<br />
Python is installed in<br />
C:\Program Files\Installers\python24<br />
and scons is also in the python dir.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th October 2005, 17:16</div></div><div class="posttext">But are you running it from a cygwin or msys shell? That could explain the problem, because os.sep would be a colon and not semi-colon. Try this one.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WebMatze</div><div class="date">12th October 2005, 17:23</div></div><div class="posttext">But are you running it from a cygwin or msys shell?<br />
<br />
I d'ont know what does it mean, but i tried your file and it didn't work...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th October 2005, 17:37</div></div><div class="posttext">Can you attach the directory listings of %MSSDK%\lib, %MSSDK%\include, %VCToolkitInstallDir%\lib and %VCToolkitInstallDir%\include?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WebMatze</div><div class="date">12th October 2005, 17:54</div></div><div class="posttext">Here is the list</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th October 2005, 18:16</div></div><div class="posttext">It's libcp.lib. The same thing happened in this thread (http://forums.winamp.com/showthread.php?s=&amp;threadid=223417). I wonder if it's just a one time bug with one of the Platform SDK versions, or if this file is always included in new versions. Do you mind uninstalling the current PSDK you have, installing the latest one and letting me know if that file is still there? Can you also attach this file? Even though it shouldn't be there, it should still contain all of those objects that weren't found in it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">12th October 2005, 18:36</div></div><div class="posttext">I have the same problem, it exists in the latest Platform SDK.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WebMatze</div><div class="date">12th October 2005, 18:40</div></div><div class="posttext">ok i'll try with a new PSDK...<br />
the file is too big to be attached (even if I 7zip it...)<br />
Thanks for your help, i'll let you know if with the new PSDK it works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WebMatze</div><div class="date">12th October 2005, 21:45</div></div><div class="posttext">Ok I've tested with the latest PSDK a i still get the error, the only way to correct it is to rename libcp.lib...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">13th October 2005, 00:22</div></div><div class="posttext">I also have &quot;%MSSDK%\Lib\LIBCP.LIB&quot;, but there is no problem with compiling NSIS (Windows Server 2003 SP1 SDK)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WebMatze</div><div class="date">13th October 2005, 06:02</div></div><div class="posttext">That's strange, for me the only way to make it work is to rename the file... I Also use the Windows Server 2003 SP1 SDK...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th October 2005, 13:12</div></div><div class="posttext">WebMatze, can you attach the list of the include folder of the Platform SDK as well?<br />
<br />
Instructor, are you using the latest CVS version? The fix that I've added for your problem is currently available only there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th October 2005, 14:16</div></div><div class="posttext">I've added a workaround that searches for a good version of libcp.lib and uses it. The file 'ms' goes into SCons\Config.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th October 2005, 14:31</div></div><div class="posttext">And a little fix.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WebMatze</div><div class="date">13th October 2005, 15:40</div></div><div class="posttext">Hello,<br />
<br />
you fix doesn't seem to work<br />
<br />
<br />
D:\Scripts NSIS\NSIS-20051012&gt;scons -j4 MSTOOLKIT=YES CHMDOCS=YES VERSION=2.10 dist-installer<br />
scons: Reading SConscript files ...<br />
Delete(&quot;nsis-2.10&quot;)<br />
Delete(&quot;.instdist&quot;)<br />
Delete(&quot;.test&quot;)<br />
Using Microsoft tools configuration<br />
ValueError: list.remove(x): x not in list:<br />
  File &quot;SConstruct&quot;, line 189:<br />
    envs = SConscript('SCons/Config/ms')<br />
  File &quot;C:\Program Files\Installers\Python24\scons-0.96.91\SCons\Script\SConscri<br />
pt.py&quot;, line 557:<br />
    return apply(method, args, kw)<br />
  File &quot;C:\Program Files\Installers\Python24\scons-0.96.91\SCons\Script\SConscri<br />
pt.py&quot;, line 494:<br />
    return apply(_SConscript, [self.fs,] + files, {'exports' : exports})<br />
  File &quot;C:\Program Files\Installers\Python24\scons-0.96.91\SCons\Script\SConscri<br />
pt.py&quot;, line 226:<br />
    exec _file_ in call_stack[-1].globals<br />
  File &quot;SCons\Config\ms&quot;, line 47:<br />
    libdirs.remove(Dir('#/.sconf_temp').abspath);<br />
D:\Scripts NSIS\NSIS-20051012&gt;<br />
<br />
<br />
Here is the error.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th October 2005, 15:48</div></div><div class="posttext">Thanks, fixed. Remove the libdirs.remove line, it's no longer needed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WebMatze</div><div class="date">13th October 2005, 15:54</div></div><div class="posttext">Here is the list of the include dir</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th October 2005, 16:00</div></div><div class="posttext">Thanks, that confirms libcp.lib should not be included in the Platform SDK. They must have put it there by mistake. There are no matching haeder files for it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WebMatze</div><div class="date">13th October 2005, 16:05</div></div><div class="posttext">YES!!!<br />
It works<br />
<br />
thanks a lot kichik</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>