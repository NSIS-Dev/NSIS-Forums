<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Calling Uninstaller from Installer..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Calling Uninstaller from Installer... NSIS Discussion" />
	
	<title> Calling Uninstaller from Installer... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Calling Uninstaller from Installer...</div>
<hr />
<div class="pda"><a href="t-143499.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=143499">Calling Uninstaller from Installer...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jcagle</div><div class="date">25th July 2003, 02:42</div></div><div class="posttext">Can someone give me a hand? I want to run the uninstaller from my installer, then continue with the installation. The catch is, if I call the uninstaller from the installer, I want to skip some things in the uninstaller. If I double click the uninstaller, I want to do everything in the uninstaller. So, below is what I have attempted. However, it doesn't appear to call the uninstaller. Any suggestions would be very welcomed!!! Thanks in advance!!!<br />
<br />
In the Uninstall Section...<br />
  Call un.GetParameters<br />
  Pop $0<br />
  StrCmp $0 &quot;upgrade&quot; skipit<br />
    MessageBox MB_OK &quot;I am here&quot;<br />
skipit:<br />
<br />
Here is the call from the installer...<br />
  ExecWait '&quot;$INSTDIR\uninstall.exe upgrade&quot; _?=$INSTDIR'<br />
<br />
I put the &quot;_?=$INSTDIR&quot; on this line because I read somewhere that that is needed to make the installer script wait for the uninstaller to finish. If that's not the case, please let me know.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th July 2003, 11:03</div></div><div class="posttext">Get the word upgrade outside of the quotes, it's not part of the executable path.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jcagle</div><div class="date">25th July 2003, 13:58</div></div><div class="posttext">Outside of the double quotes...correct? Not the single quotes?<br />
<br />
Also, is it correct to have &quot;_?=$INSTDIR&quot;? I would like to delete the directory at the end of the uninstall...but, this might not allow it because the directory is not empty???</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th July 2003, 14:04</div></div><div class="posttext">Yes, outside of the double quotes. It should look like this:<br />
<br />
ExecWait '&quot;$INSTDIR\uninstall.exe&quot; update _?=$INSTDIR'<br />
<br />
It's OK to have the _?= part, and it must be there if you want the installer to really wait for the uninstaller. You won't be able to delete $INSTDIR from the uninstaller because the uninstaller won't copy itself because of the _?= part. If you want to delete it, copy the uninstaller to $TEMP yourself and then call it with _?= from temp. For example:<br />
<br />
GetTempFileName $0<br />
CopyFiles /SILENT $INSTDIR\uninstall.exe $0<br />
ExecWait '&quot;$0&quot; update _?=$INSTDIR'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jcagle</div><div class="date">25th July 2003, 14:07</div></div><div class="posttext">Cool, that actually makes sense to me!?!?!?! (I'm new, if you can't tell) :D<br />
<br />
Is GetTempFilename a built-in function, or is it a function I must put in my script?<br />
<br />
Thanks so much!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th July 2003, 14:16</div></div><div class="posttext">GetTempFileName is a built-in instruction. Functions that are not built-in are called using the Call instruction. For example:<br />
<br />
Call myFunction<br />
<br />
Another possibility of something that's not built-in is plug-ins. For example:<br />
<br />
PluginName::FunctionName</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th July 2003, 14:23</div></div><div class="posttext">There are all the cool functions and plugins on the NSIS Archive:<br />
http://nsis.sourceforge.net/archive<br />
<br />
-Stu :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">31st January 2005, 18:10</div></div><div class="posttext">hello... I'm sorry to &quot;up&quot; this topic, but I don't understand it really...<br />
<br />
this is my code :<br />
<br />
<br />
SetOutPath &quot;$TEMP&quot;<br />
	WriteUninstaller &quot;$TEMP\setup_KTV_tmp.exe&quot;<br />
<br />
;écrit dans le KTVsetup.ini qu'il est en train d'installer<br />
<br />
<br />
	WriteIniStr &quot;$TEMP\KTVsetup.ini&quot; &quot;setup&quot; &quot;type&quot; &quot;install&quot;<br />
<br />
;Lance le désinstalleur en fenêtre, cache l'autre fenêtre (qui de toute façon est déjà cachée avec le silentinstall silent)<br />
<br />
	HideWindow<br />
	ClearErrors<br />
	ExecWait '$TEMP\setup_KTV_tmp.exe _?=$TEMP'<br />
	IfErrors no_remove_uninstaller<br />
	ReadRegStr $0 HKLM Software\K!TV &quot;&quot;<br />
	StrCpy $INSTDIR &quot;$0&quot;<br />
	SetOutPath $INSTDIR<br />
	WriteUninstaller &quot;$INSTDIR\UninstKTV.exe&quot;<br />
	BringToFront<br />
<br />
no_remove_uninstaller:<br />
	Delete &quot;$TEMP\setup_KTV_tmp.exe&quot;<br />
<br />
and my execwait doesn't wait :L<br />
<br />
<br />
where is my error ?<br />
<br />
thx for your answers ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">31st January 2005, 18:17</div></div><div class="posttext">sorry....<br />
<br />
<br />
this works :) :<br />
<br />
<br />
	ExecWait '&quot;$TEMP\setup_KTV_tmp.exe&quot; _?=$TEMP'<br />
<br />
<br />
<br />
(quoting problem)<br />
(i'm really dumb :D )</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>