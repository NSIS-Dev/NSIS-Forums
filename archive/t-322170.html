<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" [Help] Regarding Reading/Writing Unicode Files, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  [Help] Regarding Reading/Writing Unicode Files NSIS Discussion" />
	
	<title> [Help] Regarding Reading/Writing Unicode Files [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  [Help] Regarding Reading/Writing Unicode Files</div>
<hr />
<div class="pda"><a href="t-322170.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322170">[Help] Regarding Reading/Writing Unicode Files</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">GaNi</div><div class="date">3rd September 2010, 06:46</div></div><div class="posttext">I was just wandering if there was a possibility to Find and replace strings within a Loaded Unicode File from a ANSI NSIS.<br />
<br />
I want to replace the string found with a bunncha big content... or could i import a File(Content) to be replaced with?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">3rd September 2010, 16:27</div></div><div class="posttext">Take a look at my nsisFile plugin (http://wiz0u.free.fr/prog/nsisFile/).<br />
You can use it to search and replace any sequence of bytes.<br />
<br />
In your case, make sure you specify a sequence of bytes that represents Unicode characters (like 480065006C006C006F00 for &quot;Hello&quot;)<br />
<br />
Use bin version for ANSI NSIS<br />
(binU version is for Unicode NSIS)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gringoloco023</div><div class="date">3rd September 2010, 17:52</div></div><div class="posttext">Or you can try this plug-in !<br />
It's based on the original textreplace plug-in by Instructor but can deal with utf-16LE files.<br />
<br />
We have used the replace function for a while now in several projects, but never done much testing on the find function<br />
<br />
Just set option /U=1  for UTF-16LE, see the readme for additional details !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GaNi</div><div class="date">3rd September 2010, 18:18</div></div><div class="posttext">Or you can try this plug-in !<br />
It's based on the original textreplace plug-in by Instructor but can deal with utf-16LE files.<br />
<br />
We have used the replace function for a while now in several projects, but never done much testing on the find function<br />
<br />
Just set option /U=1  for UTF-16LE, see the readme for additional details !<br />
<br />
<br />
I used UNICODE PLUGIN.<br />
Unicode(UTF-16LE) -&gt; ANSI Failed.<br />
<br />
So i decided to convert UTF-16LE -&gt; UTF-8 and UTF-8 -&gt; ANSI and worked.<br />
And used text replace on it. :D<br />
<br />
Thank you anways. Will try the new plugin now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GaNi</div><div class="date">3rd September 2010, 18:45</div></div><div class="posttext">Or you can try this plug-in !<br />
It's based on the original textreplace plug-in by Instructor but can deal with utf-16LE files.<br />
<br />
We have used the replace function for a while now in several projects, but never done much testing on the find function<br />
<br />
Just set option /U=1  for UTF-16LE, see the readme for additional details !<br />
<br />
It correctly reads on Unicode files but doesnt write on Unicode with ANSI NSIS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gringoloco023</div><div class="date">3rd September 2010, 19:17</div></div><div class="posttext">You confuse me... <br />
<br />
I used UNICODE PLUGIN.<br />
Unicode(UTF-16LE) -&gt; ANSI Failed.<br />
<br />
So i decided to convert UTF-16LE -&gt; UTF-8 and UTF-8 -&gt; ANSI and worked.<br />
It's called newtextreplace plug-in, and doesn't need any converting ! It does exactly the same as the textreplace plug-in and is used in the same way, but deals with utf-16 files if you add option /U=1<br />
  ${textreplace::ReplaceInFile} &quot;C:\input.txt&quot; &quot;C:\output.txt&quot; &quot;abc&quot; &quot;xyz&quot; &quot;/U=1&quot; $0<br />
<br />
One thing I forgot to mention is that case-insensitive is not working for non-ansi characters. (As we had a need to replace just ansi characters in binary files, and to do case-insensitive in binary files got a bit complicated to the code)<br />
It correctly reads on Unicode files but doesnt write on Unicode with ANSI NSIS. <br />
Be sure to use the ansi version of the plug-in, 'NewTextReplace_v0.4.1\Ansi\Plugin\newtextreplace.dll'<br />
Could you send (part of) the script your using</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GaNi</div><div class="date">4th September 2010, 05:54</div></div><div class="posttext">${textreplace::FillReadBuffer} &quot;$INSTDIR\update\modder\resource\l4d360ui_info.txt&quot; $0<br />
<br />
	${textreplace::ReplaceInFile} &quot;$INSTDIR\update\modder\resource\l4d360ui_tu_english.txt&quot; &quot;$INSTDIR\update\modder\resource\l4d360ui_tu_english.txt&quot; &quot;// -- End Game Lobby Changes&quot; &quot;$0&quot; &quot;/U=1 /PO=1&quot; $1<br />
<br />
	${textreplace::FreeReadBuffer} &quot;$0&quot;<br />
	${textreplace::Unload}<br />
<br />
;-------------------------------------------------<br />
	<br />
	${textreplace::FillReadBuffer} &quot;$INSTDIR\update\modder\resource\ui\l4d360ui\bloginfo.txt&quot; $0<br />
<br />
	${textreplace::ReplaceInFile} &quot;$INSTDIR\update\modder\resource\ui\l4d360ui\blogpost.txt&quot; &quot;$INSTDIR\update\modder\resource\ui\l4d360ui\blogpost.txt&quot; &quot;***text02&quot; &quot;$0&quot; &quot;/U=1 /PO=1&quot; $1<br />
<br />
	${textreplace::FreeReadBuffer} &quot;$0&quot;<br />
	${textreplace::Unload}	<br />
<br />
;------------------------------------ EOF<br />
<br />
	<br />
I tried the ANSI Plugin with newtextreplace.nsh, it didn't replace the file content i needed in the unicode file infact it put some Chinese characters.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gringoloco023</div><div class="date">4th September 2010, 08:06</div></div><div class="posttext">I would need the actual text files you are using, to reproduce this. <br />
<br />
Could you please zip them up and supply a link ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GaNi</div><div class="date">4th September 2010, 09:20</div></div><div class="posttext">I would need the actual text files you are using, to reproduce this. <br />
<br />
Could you please zip them up and supply a link ?<br />
<br />
Here they are. <br />
<br />
I repeat, i try to implement a whole content of a file(ANSI text file) in these unicode text Files.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gringoloco023</div><div class="date">4th September 2010, 09:32</div></div><div class="posttext">There you go, it would basically be impossible to implement a whole content of an ANSI text file into a unicode text Files. You would end up with 'Chinese' characters :) . I suggest you to re-code the ansi text file to unicode first.<br />
<br />
As soon as I find some time I will have a look into it as well</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GaNi</div><div class="date">4th September 2010, 09:47</div></div><div class="posttext">There you go, it would basically be impossible to implement a whole content of an ANSI text file into a unicode text Files. You would end up with 'Chinese' characters :) . I suggest you to re-code the ansi text file to unicode first.<br />
<br />
As soon as I find some time I will have a look into it as well<br />
<br />
oh lol so you mean ANSI to Unicode doesnt work ? <br />
<br />
awright, i will try using unicode to unicode Writing.<br />
<br />
Thank you :D<br />
<br />
Edit: Even Unicode to unicode failed :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GaNi</div><div class="date">4th September 2010, 10:12</div></div><div class="posttext">I even tried to <br />
ReadBuffer from a unicode file and paste it over an Unicode file. it copies few texts and fonts change to something else. Donot know what to do-.-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gringoloco023</div><div class="date">4th September 2010, 23:59</div></div><div class="posttext">Sorry about this (I'm still learning C ). What I done wrong is that it was taking the string length from the handle number, instead of the text file in the buffer.<br />
<br />
As well I fixed a bug what was including the BOM into the ReadBuffer, which then ended up in the middle of your resulting text file.<br />
<br />
We never used anything else than just replacing basic strings, so I never realized these bugs.<br />
<br />
Anyway, it should be fixed now :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GaNi</div><div class="date">10th September 2010, 12:06</div></div><div class="posttext">Sorry about this (I'm still learning C ). What I done wrong is that it was taking the string length from the handle number, instead of the text file in the buffer.<br />
<br />
As well I fixed a bug what was including the BOM into the ReadBuffer, which then ended up in the middle of your resulting text file.<br />
<br />
We never used anything else than just replacing basic strings, so I never realized these bugs.<br />
<br />
Anyway, it should be fixed now :)<br />
<br />
thanks, will test now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gringoloco023</div><div class="date">16th October 2010, 15:19</div></div><div class="posttext">FYI, I totally rewrote the newtextreplace plugin and now there is no problem anymore to replace in one encoding with another encoding. Also the issue with case-insensative for non-ansi characters is solved. <br />
<br />
So no more chinese letters for you :)<br />
<br />
http://forums.winamp.com/showthread.php?t=322832&amp;highlight=newtextreplace<br />
<br />
please let me know if you have any issues with the plug-in.<br />
<br />
regards</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>