<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to close explorer.exe during the installation, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to close explorer.exe during the installation NSIS Discussion" />
	
	<title> How to close explorer.exe during the installation [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to close explorer.exe during the installation</div>
<hr />
<div class="pda"><a href="t-182655.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=182655">How to close explorer.exe during the installation</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Hamister</div><div class="date">8th June 2004, 04:37</div></div><div class="posttext">Hi IÂ´m noob on NSIS, I made a modification on Windows DLLs so I need little help...<br />
<br />
TO replace the dlls the explorer should be closed, so how can I add this to the script?<br />
<br />
Other questions too How can I make a backup of the files that are installed? and how to execute cmd(DOS) programs during the installation?<br />
<br />
I Really need your help!<br />
<br />
Thanks a lot</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">9th June 2004, 01:12</div></div><div class="posttext">explorer is also the &quot;shell&quot; (taskbar and that stuff) so just closing all exlorer windows probably wont help(+that most of the dlls are not unloaded right away) but if u still want to do it u have to use EnumWindows (i think i saw an example of this in the system plugin docs) and close all windows with the classname CabinetWindow(or something like that)<br />
<br />
open dos commands with the normal exec functions or the exectostack thingie plugin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">9th June 2004, 03:17</div></div><div class="posttext">I think you should restart the computer as normally programs do which is recommended.<br />
<br />
How can I make a backup of the files that are installed?<br />
<br />
Use SetOutPath to somewhere else to install another copy of the files (using same File commands. Or if you meant &quot;backup of old files&quot; you can use CopyFiles command.<br />
<br />
how to execute cmd(DOS) programs during the installation?<br />
<br />
You can run .bat files (made by you or by the installer). To make .bat files with the installer, you can simply use FileOpen, FileWrite and FileClose commands.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hamister</div><div class="date">9th June 2004, 03:55</div></div><div class="posttext">Originally posted by Anders <br />
explorer is also the &quot;shell&quot; (taskbar and that stuff) so just closing all exlorer windows probably wont help(+that most of the dlls are not unloaded right away) but if u still want to do it u have to use EnumWindows (i think i saw an example of this in the system plugin docs) and close all windows with the classname CabinetWindow(or something like that)<br />
<br />
open dos commands with the normal exec functions or the exectostack thingie plugin  <br />
<br />
Oh could you make a sample for me please?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>