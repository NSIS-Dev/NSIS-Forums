<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with a Simple LabVIEW Installer using the Nullsoft Install System (NSIS), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with a Simple LabVIEW Installer using the Nullsoft Install System (NSIS) NSIS Discussion" />
	
	<title> Problem with a Simple LabVIEW Installer using the Nullsoft Install System (NSIS) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with a Simple LabVIEW Installer using the Nullsoft Install System (NSIS)</div>
<hr />
<div class="pda"><a href="t-285663.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=285663">Problem with a Simple LabVIEW Installer using the Nullsoft Install System (NSIS)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bonzo3671</div><div class="date">25th January 2008, 19:52</div></div><div class="posttext">Hello there,<br />
<br />
My first posting to this group and my first use of using NSIS in earnest.<br />
<br />
I'm trying to build a simple multiple part installer. I've been through the very through example of merging various installers here:<br />
<br />
http://nsis.sourceforge.net/Embedding_other_installers<br />
<br />
The particular installer (setup.exe) I'm having trouble with is built using National Instruments LabVIEW 8.2.1. Their installer is based on MSI. I created my LabVIEW executable, created their MSI wrapper installer and tried to call it with the simple wizard installer created using HM NIS Editor 2.0.3. I'm using NSIS 2.34<br />
<br />
When I run my three part NSIS installer, the first two parts install correctly but the LabVIEW MSI installer bugs out when it trys to run the &quot;setup.exe&quot;. The dialog prompts with the following:<br />
<br />
&quot;Fatal Error. Unable to find initialization file.<br />
<br />
.\ConfigInfo.cpp(2642): IInstallerError 11005<br />
Fatal Error. Unable to find initialization file.<br />
File C:\Program Files\My application\setup.ini not found.&quot;<br />
<br />
It seems to be pointing to a setup.ini in the destination directory, I don't reference this in my NSIS installer. In my LabVIEW MSI installer, the setup.exe is paired with two files nidist.id and setup.ini. The nidist.id contains the DistributionGUID and DistPackageGUID. The setup.ini is National Instruments MSI configuration and it makes a requiremetn to have WindowsInstaller-KB893803-v2-x86.exe version 3.0.0.0 installed.<br />
<br />
Here's a snippet of my .nsi script file:<br />
<br />
Section &quot;My NSIS test application&quot; SEC03<br />
  File &quot;setup.exe&quot;<br />
  ExecWait &quot;$INSTDIR\setup.exe&quot;<br />
; ExecWait '&quot;msiexec&quot; /i &quot;$INSTDIR\setup.exe&quot; /passive'<br />
; ExecWait &quot;$INSTDIR\setup.exe /s /v&quot;/qb&quot;<br />
SectionEnd<br />
<br />
I've tried changing the ExecWait command to see if this makes the difference (see commented out lines) but to no avail. Which one should I be using for MSI's?<br />
<br />
Can anyway point me in the right direction here?<br />
<br />
Many thanks,<br />
Chroma</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bonzo3671</div><div class="date">25th January 2008, 19:54</div></div><div class="posttext">The link seems to have been ommitted:<br />
<br />
nsis.sourceforge.net/Embedding_other_installers</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th January 2008, 20:57</div></div><div class="posttext">Maybe you could figure out where it looks for setup.ini using FileMon (http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx) and put it there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bonzo3671</div><div class="date">31st January 2008, 00:01</div></div><div class="posttext">Note sure I understand. I am very familiar with FileMon. When the installer runs it creates a temp dir in my Local settings dir, with the following files:<br />
<br />
modern-wizard.bmp<br />
ioSpecial.ini<br />
InstallOptions.dll<br />
<br />
It then yields the error as I mentioned previously, <br />
<br />
&quot;.\ConfigInfo.cpp(2642): IInstallerError 11005<br />
Fatal Error. Unable to find initialization file.<br />
File C:\Program Files\Metrosol\setup.ini not found.&quot;<br />
<br />
These temp files are then removed. <br />
<br />
The other two installers that I kick off before this installer do not have setup.ini files associated with them. These installers work fine and I based the NSIS installer on the NSIS example link I sighted earlier. <br />
<br />
If I place the third installers setup.ini file in the required destination folder (C:\Program Files\xxx), it yields the following error<br />
<br />
&quot;.\ConfigInfo.cpp(2653): IInstallerError 11006<br />
Developer Error. The following errors were found in your ini file:<br />
1. Specified file not found: [MsiEngine] WinNTPath = supportfiles\WindowsInstaller-KB893803-v2-x86.exe<br />
<br />
Correct the ini file and try again.<br />
&lt;No Debug Message&gt;&quot;<br />
<br />
I seem to be no further forward.<br />
<br />
Questions:<br />
<br />
1) Am I missing something with regard to how I am calling ExecWait in the NSIS install script?<br />
2) Where is the original error coming from? Is is NSIS or the National Instruments NSI installer?<br />
3) Are there any tools I can use to log the NSIS installer as it fires? <br />
<br />
Any help greatly appreciated.<br />
<br />
Many thanks,<br />
Chroma</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st February 2008, 13:16</div></div><div class="posttext">The problem here is not with ExecWait, it's with the executed installer. All of these errors are generated by it. It seems like it's missing some files, like setup.ini and a folder called supportfiles. I made that comment about FileMon because I've assumed you've extracted those files in the wrong folder and the installer couldn't find them.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bonzo3671</div><div class="date">1st February 2008, 20:04</div></div><div class="posttext">I have the following folders in my NSIS installer executable directory:<br />
<br />
\MyInstall.exe - my NSIS, named changed to protect innocent!<br />
\nidist.id - NI Distribution and DistPackage GUIDs config file<br />
\setup.exe - the NI SETUP I'm trying to execute<br />
\setup.ini - NI file<br />
\supportfiles - NI misc files (dir)<br />
\license - NI Released License Agreement (dir)<br />
\bin - National Instruments Installer packages (dir)<br />
\installers - my other installers (dir)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st February 2008, 20:17</div></div><div class="posttext">But according to the error, they're looked for in $INSTDIR and not $EXEDIR. Put them there instead.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bonzo3671</div><div class="date">1st February 2008, 20:49</div></div><div class="posttext">I'm not sure I understand. Isn't the installer supposed to dynamically create the output EXE directory? Are you asking me to create this in advance of running the main NSIS installer? <br />
<br />
Perhaps I'm getting the wrong end of the stick here, but which files do you suggest I move around? Please note that I used the NSIS example link, as my template and none of the other installer in that example have a setup.ini<br />
<br />
-Chroma</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st February 2008, 20:56</div></div><div class="posttext">OK, then we'll start from the beginning. Those errors you are getting have nothing to do with your NSIS installer. You're getting them because the installer your installer is executing can't find some files.<br />
<br />
You said all the required files are located right besides your installer, which is $EXEDIR. But you execute the other installer from $INSTDIR.<br />
<br />
Assuming both the other installer and the files it's looking for should be in one place, you only have two options. Either execute the other installer from $EXEDIR or move the files to $INSTDIR.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bonzo3671</div><div class="date">1st February 2008, 21:29</div></div><div class="posttext">I greatly appreciate your patience on this issue!<br />
<br />
Here's currently what I have:<br />
<br />
Section &quot;installer1&quot; SEC01<br />
  File &quot;installers\installer1.exe&quot;<br />
  ExecWait &quot;$INSTDIR\installer1.exe&quot;<br />
SectionEnd<br />
;------------------------------------------------------------------------------------------------------<br />
Section &quot;installer2&quot; SEC02<br />
  File &quot;installers\installer2.exe&quot;<br />
  ExecWait &quot;$INSTDIR\installer2.exe&quot;<br />
SectionEnd<br />
;------------------------------------------------------------------------------------------------------<br />
Section &quot;My NI LabVIEW App Installer&quot; SEC03<br />
  File &quot;setup.exe&quot;<br />
  ExecWait &quot;$INSTDIR\setup.exe&quot;<br />
<br />
<br />
You're suggesting I change the above script to this:<br />
<br />
  Section &quot;installer1&quot; SEC01<br />
  File &quot;installers\installer1.exe&quot;<br />
  ExecWait &quot;$INSTDIR\installer1.exe&quot;<br />
SectionEnd<br />
;------------------------------------------------------------------------------------------------------<br />
Section &quot;installer2&quot; SEC02<br />
  File &quot;installers\installer2.exe&quot;<br />
  ExecWait &quot;$INSTDIR\installer2.exe&quot;<br />
SectionEnd<br />
;------------------------------------------------------------------------------------------------------<br />
Section &quot;My NI LabVIEW App Installer&quot; SEC03<br />
  File &quot;setup.exe&quot;<br />
  ExecWait &quot;$EXEDIR\setup.exe&quot;<br />
<br />
Is this correct?<br />
<br />
-Chroma</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st February 2008, 21:35</div></div><div class="posttext">No, that would not be enough. Executing the installer from $EXEDIR won't work if you still extract it to $INSTDIR. Setting the working directory to $EXEDIR might work though... SetOutPath also sets the working directory. So try extracting the installer to $INSTDIR, setting the working directory to $EXEDIR and executing the installer from $INSTDIR. If that doesn't work, extract the installer to $EXEDIR or just don't compress it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bonzo3671</div><div class="date">1st February 2008, 22:52</div></div><div class="posttext">I tried the changes you suggested (changing the line  ExecWait &quot;$INSTDIR\setup.exe&quot; to ExecWait &quot;$EXEDIR\setup.exe&quot;, as shown). This seems to work. For the record, my SetOutPath is &quot;$INSTDIR&quot;.<br />
<br />
<br />
Could you illustrate the two scenarios you suggested in terms of the NSIS script I currently use? I don't won't to make any mistakes, having come so far on this one! Apologies for being a burden here!<br />
<br />
-Chroma</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st February 2008, 22:59</div></div><div class="posttext">I'm not sure I understand what you're asking me to explain and how. The two scenarios I've described are related to the way the other installer (not a NSIS installer) deals with the files it needs.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bonzo3671</div><div class="date">1st February 2008, 23:13</div></div><div class="posttext">Yes, I understand what you are saying regarding the other installer (the non-NSIS installer). What I was looking for was  the two scenarios explained in terms of the script snippet I described.<br />
<br />
 Section &quot;installer1&quot; SEC01<br />
File &quot;installers\installer1.exe&quot;<br />
ExecWait &quot;$INSTDIR\installer1.exe&quot;<br />
SectionEnd<br />
;------------------------------------------------------------------------------------------------------<br />
Section &quot;installer2&quot; SEC02<br />
File &quot;installers\installer2.exe&quot;<br />
ExecWait &quot;$INSTDIR\installer2.exe&quot;<br />
SectionEnd<br />
;------------------------------------------------------------------------------------------------------<br />
Section &quot;My NI LabVIEW App Installer&quot; SEC03<br />
File &quot;setup.exe&quot;<br />
ExecWait &quot;$EXEDIR\setup.exe&quot;<br />
<br />
This seems to work for me, but is this the best practice way of doing an installer of this type (a multi-part mixed installer)?<br />
<br />
-Chroma</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st February 2008, 23:21</div></div><div class="posttext">Well, if you have files beside your installer which are not compressed into the installer, I assume you're using a CD distribution or something similar. In that case, it's recommended you don't compress the other installers into your installer. That would only take time compressing and decompressing something that's already compressed. This way, you can also make sure the right directory structure is kept without any scripting.<br />
<br />
There is no one recommended way for an installer that executes other installers. It depends on the end result you're looking for and the executed installers.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bonzo3671</div><div class="date">2nd February 2008, 21:56</div></div><div class="posttext">I think I have enough information to continue developing my application. Thanks for all your assistance and patience, it's greatly appreciated.<br />
<br />
-Chroma</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>