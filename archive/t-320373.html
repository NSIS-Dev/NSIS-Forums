<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installer works on XP, not on Server 2003, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installer works on XP, not on Server 2003 NSIS Discussion" />
	
	<title> Installer works on XP, not on Server 2003 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installer works on XP, not on Server 2003</div>
<hr />
<div class="pda"><a href="t-320373.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=320373">Installer works on XP, not on Server 2003</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">drmth</div><div class="date">29th June 2010, 15:03</div></div><div class="posttext">Hi folks,<br />
<br />
I did an installer, in which I use the variable $INSTDIR. Through a command line, I can change it (using /D=). Everything is doing well under XP.<br />
<br />
Unfortunately, under Server 2003, the variable $INSTDIR is not set and when I print its value, it returns ${INSTDIR}.<br />
<br />
Do somebody know why under Server 2003 the installer is going crazy?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drmth</div><div class="date">30th June 2010, 09:14</div></div><div class="posttext">Hi,<br />
<br />
I checked one time again, and the problem is the same... Do anybody know what is happening to the installer?<br />
<br />
I will try on a new Server 2003. But, i am not sure it will solve the problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">30th June 2010, 14:08</div></div><div class="posttext">${INSTDIR} would be a define, even if $INSTDIR (a variable, not a define) was broken, it would not print ${INSTDIR} (with those braces)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drmth</div><div class="date">30th June 2010, 14:27</div></div><div class="posttext">I completely agree with you... This thing is weird. I tried the installer on another machine this morning (still using Server 2003) but the result was the same.<br />
<br />
After, I did some tests and $INSTDIR returns a good value when for example, in the command line i write: Installer.exe /D=C:\blablabla<br />
Here, $INSTDIR is C:\blablabla<br />
<br />
but if I write: $INSTDIR is C:\ , the value of $INSTDIR will be ${INSTDIR}. <br />
<br />
In fact, it takes a good value only if I do not direct $INSTDIR to the root of the disk... <br />
<br />
Unfortunaltely, I need to leave $INSTDIR as C:\</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">30th June 2010, 14:43</div></div><div class="posttext">AllowRootDirInstall</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drmth</div><div class="date">30th June 2010, 14:57</div></div><div class="posttext">it seems to be what i'm looking for.... <br />
<br />
I gonna give it a try<br />
<br />
thx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drmth</div><div class="date">30th June 2010, 16:30</div></div><div class="posttext">Unfortunately, the problem is still there. <br />
<br />
it does not work on Server 2003. I am going to make another program to know if the problem comes from my program or if Server is a tricky environment.... Because it works on XP...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">30th June 2010, 16:58</div></div><div class="posttext">Can you show us a minimalistic script that does the strange ${INSTDIR} thingiemajigger?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drmth</div><div class="date">1st July 2010, 10:14</div></div><div class="posttext">Hi, <br />
<br />
I did some change into the code and finally, I am able to set $INSTDIR.<br />
<br />
Just to remind the way I proceed:<br />
<br />
In the headers of the code:<br />
AllowRootDirInstall true  (thx to Anders!!)<br />
<br />
In the function .onINIT:<br />
SetOutPath $INSTDIR<br />
    ${IF} &quot;$INSTDIR&quot; == &quot;&quot;<br />
    ${ORIF} &quot;$INSTDIR&quot; == &quot;${INSTDIR}&quot;<br />
          Strcpy $INSTDIR &quot;C:\&quot;<br />
    ${ENDIF}<br />
<br />
This is the way I did. In you see any mistake do not hesitate to let me know.<br />
I did a little test to know what is inside $INSTDIR, and it seems that if you do not fix it somewhere in your code, it takes some weird values...<br />
<br />
Thank you Anders and MSG.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drmth</div><div class="date">1st July 2010, 10:15</div></div><div class="posttext">But the mystery remains the same, why the program was running under XP and not Server 2003....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">1st July 2010, 15:29</div></div><div class="posttext">You should not be calling SetOutPath $instdir in .oninit since it will create the directory, remove the SetOutPath call</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drmth</div><div class="date">2nd July 2010, 13:08</div></div><div class="posttext">Ok I remodeved it from the code...<br />
<br />
Now, i'm having trouble to set $Instdir into the code. <br />
<br />
It is ok using the command line, but I'd like that if I do not set $Instdir from the command line, $INSTDIR = S:\ by default<br />
<br />
I tried to change it into the piece of code i wrote above (by changing C:\ with S:\) but the installer set it directly to C:\ <br />
<br />
Dou you have any idea?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd July 2010, 18:17</div></div><div class="posttext">Does S:\ exist?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drmth</div><div class="date">5th July 2010, 09:11</div></div><div class="posttext">S:\ does not exist on every machine I am going to use. But I must have $INSTDIR set to S:\ by default. <br />
<br />
I tried to set it by using Strcpy, but then, the command line is not taken into account.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>