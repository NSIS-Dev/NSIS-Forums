<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" CustomLicense with MUI?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  CustomLicense with MUI? NSIS Discussion" />
	
	<title> CustomLicense with MUI? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  CustomLicense with MUI?</div>
<hr />
<div class="pda"><a href="t-283992.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=283992">CustomLicense with MUI?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">29th December 2007, 18:14</div></div><div class="posttext">i have a problem adapting the CustomLicense example for a MUI installer. has anybody used it? please upload script!<br />
<br />
i'm using<br />
  Function PreLicense<br />
    ReadINIStr $LicenseType &quot;$PLUGINSDIR\pimp.ini&quot; &quot;Installer&quot; &quot;LicenseType&quot;<br />
    IfFileExists &quot;$PLUGINSDIR\license.$LicenseType&quot; +2<br />
    Abort<br />
  FunctionEnd<br />
<br />
  Function SwitchLicense<br />
    FindWindow $0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
    GetDlgItem $0 $0 1000<br />
    CustomLicense::LoadFile &quot;$PLUGINSDIR\license.$LicenseType&quot; $0<br />
  FunctionEnd<br />
<br />
pages look like this:<br />
  ;Modern UI Configuration<br />
  !define MUI_CUSTOMPAGECOMMANDS<br />
  #!ifdef LICENSE<br />
    !define MUI_PAGE_CUSTOMFUNCTION_PRE PreLicense<br />
    !define MUI_PAGE_CUSTOMFUNCTION_LEAVE SwitchLicense<br />
    !define MUI_LICENSEPAGE<br />
    !define MUI_LICENSEPAGE_BGCOLOR &quot;FFFFFF&quot;<br />
  #!endif<br />
  !define MUI_DIRECTORYPAGE<br />
  !define MUI_COMPONENTSPAGE<br />
  !define MUI_ABORTWARNING</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">29th December 2007, 21:16</div></div><div class="posttext">Hi there!<br />
<br />
There is a nice example on the wiki page.<br />
<br />
http://nsis.sourceforge.net/CustomLicense_plug-in<br />
<br />
And... I think you should set the license in the pre function call as well. The leave function is too late!<br />
<br />
If you can't solve your problem, describe the problem exactly.<br />
<br />
Cheers!<br />
<br />
Bruno</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">29th December 2007, 22:48</div></div><div class="posttext">the installer worked perfectly before switching to MUI, here's the code i've used<br />
<br />
pages:<br />
;Pages<br />
  Page License PreLicense SwitchLicense<br />
  Page Directory<br />
  Page Components<br />
  Page InstFiles<br />
<br />
functions:<br />
  Function PreLicense<br />
    ReadINIStr $LicenseType &quot;$PLUGINSDIR\pimp.ini&quot; &quot;Installer&quot; &quot;LicenseType&quot;<br />
    IfFileExists &quot;$PLUGINSDIR\license.$LicenseType&quot; +2<br />
    Abort<br />
  FunctionEnd<br />
<br />
  Function SwitchLicense<br />
    FindWindow $0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
    GetDlgItem $0 $0 1000<br />
    CustomLicense::LoadFile &quot;$PLUGINSDIR\license.$LicenseType&quot; $0<br />
  FunctionEnd<br />
<br />
i don't see what i'm doing wrong handling the custom pages the same way. for my understanding, my code should do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th December 2007, 22:52</div></div><div class="posttext">You've set SwitchLicense as the leave function of the page instead of its show function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">30th December 2007, 14:34</div></div><div class="posttext">i've tried that, kichik - didn't work. i have another assumption that my mistake lies in the following:<br />
;Pages<br />
  ##Page custom PreLicense<br />
  #Page License PreLicense SwitchLicense<br />
  #Page Directory<br />
  #Page Components<br />
  #Page InstFiles<br />
<br />
 <br />
    !define MUI_PAGE_CUSTOMFUNCTION_SHOW &quot;SwitchLicense&quot; #SwitchLicense<br />
    !define MUI_PAGE_CUSTOMFUNCTION_LEAVE &quot;PreLicense&quot;<br />
    !insertmacro MUI_PAGE_LICENSE &quot;dummy.txt&quot;<br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  !insertmacro MUI_PAGE_COMPONENTS<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
preceded by this code<br />
  ;Modern UI Configuration<br />
  ##SKIN##!define MUI_CUSTOMFUNCTION_GUIINIT myGuiInit<br />
  ##SKIN##!define MUI_PAGE_CUSTOMFUNCTION_SHOW CompColor<br />
  !define MUI_CUSTOMPAGECOMMANDS<br />
  #!ifdef LICENSE<br />
  #  !define MUI_PAGE_CUSTOMFUNCTION_PRE &quot;PreLicense&quot;<br />
  #  !define MUI_PAGE_CUSTOMFUNCTION_LEAVE &quot;SwitchLicense&quot;<br />
  #  !define MUI_LICENSEPAGE<br />
    !define MUI_LICENSEPAGE_BGCOLOR &quot;FFFFFF&quot;<br />
  #!endif<br />
  !define MUI_DIRECTORYPAGE<br />
  !define MUI_COMPONENTSPAGE<br />
  !define MUI_ABORTWARNING<br />
<br />
  !define MUI_ICON &quot;icons\pimpbot_runtime.ico&quot;<br />
  !define MUI_COMPONENTSPAGE_CHECKBITMAP &quot;ui\yi-nusimple.bmp&quot;<br />
  !define MUI_INSTFILESPAGE_COLORS &quot;000000 FFFFFF&quot;<br />
  !define MUI_INSTFILESPAGE_PROGRESSBAR &quot;colored smooth&quot;<br />
<br />
am i putting the code in the wrong part of my source?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bholliger</div><div class="date">30th December 2007, 16:32</div></div><div class="posttext">Try this:<br />
<br />
    !define MUI_PAGE_CUSTOMFUNCTION_PRE &quot;PreLicense&quot;<br />
    !define MUI_PAGE_CUSTOMFUNCTION_SHOW &quot;SwitchLicense&quot;     <br />
    !insertmacro MUI_PAGE_LICENSE &quot;dummy.txt&quot;<br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  !insertmacro MUI_PAGE_COMPONENTS<br />
  !insertmacro MUI_PAGE_INSTFILES</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">30th December 2007, 16:45</div></div><div class="posttext">great, it works. thank you!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>