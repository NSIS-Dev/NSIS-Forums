<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" .nsi extention not registered!, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  .nsi extention not registered! NSIS Discussion" />
	
	<title> .nsi extention not registered! [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  .nsi extention not registered!</div>
<hr />
<div class="pda"><a href="t-177859.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=177859">.nsi extention not registered!</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mdlazreg</div><div class="date">24th April 2004, 22:59</div></div><div class="posttext">I have two windows machines both of them are XP (one home one at work). When I installed NSIS on both of them however only one of them could register the .nsi extention to be able to automatically open it with  notepad.exe. The other machine (at work) could not!.<br />
<br />
Any ideas what difference could have trigered this behaviour?<br />
<br />
Thanks a lot!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">24th April 2004, 23:30</div></div><div class="posttext">The .nsi extension was probably already registered by another tool.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mdlazreg</div><div class="date">24th April 2004, 23:45</div></div><div class="posttext">Thanks Joost for your reply.<br />
<br />
I can garantie to you that it was not. My computer did not know anything about .nsi before I installed NSIS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">25th April 2004, 00:14</div></div><div class="posttext">So there is no .nsi key in the HKEY_CLASSES_ROOT registry hive at all?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tommy916</div><div class="date">25th April 2004, 05:13</div></div><div class="posttext">Right click the file of .nsi, choose &quot;Open with&quot; &gt; &quot;Choose Program&quot; &gt; Select the program from a list &gt; Checkbox &quot;Always use the selected program to open this kind of file&quot;. I use TextPad to open.<br />
<br />
or re-install again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VegetaSan</div><div class="date">25th April 2004, 12:43</div></div><div class="posttext">maybe you should try this .. got it from the NSIS example:<br />
<br />
<br />
<br />
Outfile &quot;RegNSI.exe&quot;<br />
Name &quot;REGISTER :)&quot;<br />
<br />
<br />
Section <br />
<br />
  ReadRegStr $R0 HKCR &quot;.nsi&quot; &quot;&quot;<br />
  StrCmp $R0 &quot;NSISFile&quot; 0 +2<br />
    DeleteRegKey HKCR &quot;NSISFile&quot;<br />
<br />
  WriteRegStr HKCR &quot;.nsi&quot; &quot;&quot; &quot;NSIS.Script&quot;<br />
  WriteRegStr HKCR &quot;NSIS.Script&quot; &quot;&quot; &quot;NSIS Script File&quot;<br />
  WriteRegStr HKCR &quot;NSIS.Script\DefaultIcon&quot; &quot;&quot; &quot;$INSTDIR\makensisw.exe,1&quot;<br />
  ReadRegStr $R0 HKCR &quot;NSIS.Script\shell\open\command&quot; &quot;&quot;<br />
  StrCmp $R0 &quot;&quot; 0 no_nsiopen<br />
    WriteRegStr HKCR &quot;NSIS.Script\shell&quot; &quot;&quot; &quot;open&quot;<br />
    WriteRegStr HKCR &quot;NSIS.Script\shell\open\command&quot; &quot;&quot; 'notepad.exe &quot;%1&quot;'<br />
  no_nsiopen:<br />
  WriteRegStr HKCR &quot;NSIS.Script\shell\compile&quot; &quot;&quot; &quot;Compile NSIS Script&quot;<br />
  WriteRegStr HKCR &quot;NSIS.Script\shell\compile\command&quot; &quot;&quot; '&quot;$INSTDIR\makensisw.exe&quot; &quot;%1&quot;'<br />
  WriteRegStr HKCR &quot;NSIS.Script\shell\compile-compressor&quot; &quot;&quot; &quot;Compile NSIS Script (Choose Compressor)&quot;<br />
  WriteRegStr HKCR &quot;NSIS.Script\shell\compile-compressor\command&quot; &quot;&quot; '&quot;$INSTDIR\makensisw.exe&quot; /ChooseCompressor &quot;%1&quot;'<br />
<br />
  ReadRegStr $R0 HKCR &quot;.nsh&quot; &quot;&quot;<br />
  StrCmp $R0 &quot;NSHFile&quot; 0 +2<br />
    DeleteRegKey HKCR &quot;NSHFile&quot;<br />
<br />
  WriteRegStr HKCR &quot;.nsh&quot; &quot;&quot; &quot;NSIS.Header&quot;<br />
  WriteRegStr HKCR &quot;NSIS.Header&quot; &quot;&quot; &quot;NSIS Header File&quot;<br />
  WriteRegStr HKCR &quot;NSIS.Header\DefaultIcon&quot; &quot;&quot; &quot;$INSTDIR\makensisw.exe,1&quot;<br />
  ReadRegStr $R0 HKCR &quot;NSIS.Header\shell\open\command&quot; &quot;&quot;<br />
  StrCmp $R0 &quot;&quot; 0 no_nshopen<br />
    WriteRegStr HKCR &quot;NSIS.Header\shell&quot; &quot;&quot; &quot;open&quot;<br />
    WriteRegStr HKCR &quot;NSIS.Header\shell\open\command&quot; &quot;&quot; 'notepad.exe &quot;%1&quot;'<br />
  no_nshopen:<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pidgeot</div><div class="date">25th April 2004, 17:29</div></div><div class="posttext">If a user installs NSIS without having administrative rights, it will still install, but associations can't be made. My guess would be that this is the case.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mdlazreg</div><div class="date">25th April 2004, 21:33</div></div><div class="posttext">Thanks for all the reply.<br />
<br />
I will answer your question on monday Joost, (the machine at work...).<br />
<br />
I think however that Pidgeot's suggestion is right because indeed I do not have admin permissions on the machine that does not register the extension. And I do have admin premissions on my home machine.<br />
<br />
If that is the case. Is there anyway to register the extension even for a non admin user installing?<br />
<br />
Thanks again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pidgeot</div><div class="date">26th April 2004, 08:31</div></div><div class="posttext">AFAIK, you can't have seperate associations for extensions on a per-user basis. Therefore, you'd have to modify the extension for everybody, and that requires administrative rights.<br />
<br />
You could ask someone who is an admin to install it, though I doubt that (s)he'll do it. Or you can make a shortcut to Notepad in the folder you keep your scripts, and drag them onto there to edit. Can save a little time compared to using File|Open.<br />
<br />
Of course, opening such files in the &quot;traditional&quot; way (through File|Open...) is also a possibility.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mdlazreg</div><div class="date">26th April 2004, 15:41</div></div><div class="posttext">Thanks Pidgeot.<br />
<br />
To answer Joost's question:<br />
<br />
The .nsi key does exist in the HKEY_CLASSES_ROOT registry hive. But I noticed that the &quot;NSIS.Script&quot; does not!.<br />
<br />
Which maybe means that only the first line of :<br />
WriteRegStr HKCR &quot;.nsi&quot; &quot;&quot; &quot;NSIS.Script&quot;<br />
WriteRegStr HKCR &quot;NSIS.Script&quot; &quot;&quot; &quot;NSIS Script File&quot;<br />
<br />
is executed while running makensis.nsi</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th April 2004, 16:04</div></div><div class="posttext">Both lines are always executed, it must be a system problem or an another program that has deleted it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mdlazreg</div><div class="date">26th April 2004, 22:05</div></div><div class="posttext">Hi Joost,<br />
<br />
Sorry I mislead you when I said that &quot;The .nsi key does exist in the HKEY_CLASSES_ROOT registry hive&quot; actually I found out that it was added not by the NSIS installer but later on when I manually choose netpad.exe as the default opener of .nsi files, it even created another key &quot;nsi_auto_file&quot;. Apprently windows does this automatically...<br />
<br />
My conclusion is that only an admin can register an extension because a regular user can not write to the HKCR hive.<br />
<br />
My question now, what if I use HKCU in VegetaSan's code above? would it register the extension for at least the current user?<br />
<br />
Thanks all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th April 2004, 22:54</div></div><div class="posttext">File associations can only be stored in HKCR.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mdlazreg</div><div class="date">26th April 2004, 23:15</div></div><div class="posttext">I found a solution but I am surprised it works :<br />
<br />
Function RegFlowizardExt<br />
	WriteRegStr HKCU &quot;Software\Classes\.flowizard&quot; &quot;&quot; &quot;flowizardfile&quot;<br />
	DetailPrint &quot;Registering .flowizard extenstion&quot;<br />
	WriteRegStr HKCU &quot;Software\Classes\flowizardfile\DefaultIcon&quot; &quot;&quot; &quot;$INSTDIR\${FLUENT_INC}\license\flowizard.ico&quot;<br />
	WriteRegStr HKCU &quot;Software\Classes\flowizardfile&quot; &quot;&quot; &quot;shell&quot;<br />
	WriteRegStr HKCU &quot;Software\Classes\flowizardfile\shell&quot; &quot;&quot; &quot;open&quot;<br />
	WriteRegStr HKCU &quot;Software\Classes\flowizardfile\shell\open\command&quot; &quot;&quot; &quot;$INSTDIR\${FLUENT_INC}\bin\ntx86\flowizard.exe&quot;<br />
FunctionEnd<br />
<br />
If I call this function and even if I am not admin, it does create File associations even if I am not using HKCR but HKCU instead!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th April 2004, 23:23</div></div><div class="posttext">You're right. This feature has been introduced in Windows 2000.<br />
<br />
http://support.microsoft.com/default.aspx?scid=kb;EN-US;q257592</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mdlazreg</div><div class="date">27th April 2004, 00:30</div></div><div class="posttext">Great!<br />
<br />
Here is my final solution for anyone to use :<br />
<br />
Function RegFlowizardExt<br />
	DetailPrint &quot;Registering .flowizard extenstion&quot;<br />
	WriteRegStr HKCR &quot;Software\Classes\.flowizard&quot; &quot;&quot; &quot;flowizardfile&quot;<br />
	IfErrors UseHKCU UseHKCR<br />
	UseHKCU:<br />
	WriteRegStr HKCU &quot;Software\Classes\.flowizard&quot; &quot;&quot; &quot;flowizardfile&quot;<br />
	WriteRegStr HKCU &quot;Software\Classes\flowizardfile\DefaultIcon&quot; &quot;&quot; &quot;$INSTDIR\${FLUENT_INC}\license\flowizard.ico&quot;<br />
	WriteRegStr HKCU &quot;Software\Classes\flowizardfile&quot; &quot;&quot; &quot;shell&quot;<br />
	WriteRegStr HKCU &quot;Software\Classes\flowizardfile\shell&quot; &quot;&quot; &quot;open&quot;<br />
	WriteRegStr HKCU &quot;Software\Classes\flowizardfile\shell\open\command&quot; &quot;&quot; &quot;$INSTDIR\${FLUENT_INC}\bin\ntx86\flowizard.exe&quot;<br />
	UseHKCR:<br />
	WriteRegStr HKCR &quot;Software\Classes\flowizardfile\DefaultIcon&quot; &quot;&quot; &quot;$INSTDIR\${FLUENT_INC}\license\flowizard.ico&quot;<br />
	WriteRegStr HKCR &quot;Software\Classes\flowizardfile&quot; &quot;&quot; &quot;shell&quot;<br />
	WriteRegStr HKCR &quot;Software\Classes\flowizardfile\shell&quot; &quot;&quot; &quot;open&quot;<br />
	WriteRegStr HKCR &quot;Software\Classes\flowizardfile\shell\open\command&quot; &quot;&quot; &quot;$INSTDIR\${FLUENT_INC}\bin\ntx86\flowizard.exe&quot;<br />
FunctionEnd<br />
<br />
This function can register my extension as a regular user and as admin.<br />
<br />
Thanks all:).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eccles</div><div class="date">27th April 2004, 13:33</div></div><div class="posttext">You should add &quot;Goto end&quot; before &quot;UseHKCR:&quot; and then &quot;end:&quot; before &quot;FunctionEnd&quot;. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mdlazreg</div><div class="date">27th April 2004, 14:56</div></div><div class="posttext">Ah! I did not know that the excution continue to the next label!... Thanks for the fix;).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>