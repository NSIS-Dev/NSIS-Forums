<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" installer doesn't work on Windows 98, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  installer doesn't work on Windows 98 NSIS Discussion" />
	
	<title> installer doesn't work on Windows 98 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  installer doesn't work on Windows 98</div>
<hr />
<div class="pda"><a href="t-179555.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=179555">installer doesn't work on Windows 98</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bramm</div><div class="date">10th May 2004, 20:50</div></div><div class="posttext">The installer for Vim 6.3a, generated with NSIS 2, works fine on Windows XP but several people reported it hangs on the license page when using Windows 98. That page then is blank, no text and no buttons to click on.  Cursor turns into an hourglass.<br />
<br />
I'm not sure if this is a bug or something I'm doing wrong.  Currently I guess it's a bug, because it worked fine with NSIS 1.92.<br />
<br />
You can find the file here: ftp://ftp.vim.org/pub/vim/unstable/pc/gvim63a.exe<br />
The installer script gvim.nsi can be found here: http://cvs.sourceforge.net/viewcvs.py/vim/vim/nsis<br />
<br />
I'm using LZMA compression, could that be a reason?<br />
<br />
I currently don't have a Windows 98 system, thus can't do debugging.<br />
Suggestions are welcome!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th May 2004, 21:53</div></div><div class="posttext">I can reproduce this issue. It occurs once in a while on a Windows 98 installation.<br />
<br />
I think your actions in .onInit may interfere with the interface. Try running the external application silently using the nsExec plug-in.<br />
<br />
Your script also uses deprecated NSIS 1 commands. This is not related to this issue, but using page commands and the standard language files is recommended.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bramm</div><div class="date">11th May 2004, 12:11</div></div><div class="posttext">Originally posted by Joost Verburg <br />
I can reproduce this issue. It occurs once in a while on a Windows 98 installation.<br />
<br />
I am glad you are able to reproduce the problem.<br />
<br />
I think your actions in .onInit may interfere with the interface. Try running the external application silently using the nsExec plug-in.<br />
<br />
I am afraid I cannot run this application silently.  When a previous installation of Vim is detected the user will be prompted if it should be uninstalled.<br />
<br />
Perhaps there is another way to run the application that works around the problem?  Note that it worked just fine with NSIS 1.<br />
<br />
Your script also uses deprecated NSIS 1 commands. This is not related to this issue, but using page commands and the standard language files is recommended.  <br />
<br />
I did convert the NSIS 1 script to NSIS 2, fixing what didn't work. What deprecated commands are still there?  A pointer to the relevant documentation would be sufficient.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th May 2004, 12:34</div></div><div class="posttext">NSIS 2 has a new page system. You only have to add page commands, there is no need to set texts like DirText etc. yourself.<br />
<br />
I notice that the background gradient does not show when the license page is blank. The only interface-related command in .onInit is BringToFront, try whether that one makes any difference.<br />
<br />
Also try with and without background gradient.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bramm</div><div class="date">11th May 2004, 14:10</div></div><div class="posttext">I finally decided to reboot into Windows 98 (have to bring down my Unix system, don't like that) and try it out myself.  Unfortunately it works fine on my system.  That means I cannot even try debugging it.<br />
<br />
I have uploaded another installer, with the gradient and the BringToFront removed.  Please give it a try: ftp://ftp.vim.org/pub/vim/unstable/pc/gvim63a1.exe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th May 2004, 14:27</div></div><div class="posttext">This one seems to work fine, please ask the users who reported the problem to test it too.<br />
<br />
Btw, why not integrate the uninstallation etc. in the NSIS installer?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bramm</div><div class="date">11th May 2004, 16:27</div></div><div class="posttext">Originally posted by Joost Verburg <br />
This one seems to work fine, please ask the users who reported the problem to test it too. <br />
<br />
I'm glad this works.  Would you like me to make a version with only the background gradient removed, so that we know that causes the problem?  Or do you already know that omitting BringToFront is not relevant?  It should be reported as a bug anyway.<br />
<br />
Btw, why not integrate the uninstallation etc. in the NSIS installer?  <br />
<br />
It is rather complicated and must also be available when not using NSIS.  Thus duplicating this code or even re-implementing it in NSIS script is unattractive.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th May 2004, 16:47</div></div><div class="posttext">Please create four small installers without any files included (except those used in .onInit).<br />
<br />
1) With all features<br />
2) Without BringToFront<br />
3) Without background gradient<br />
4) Without both</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bramm</div><div class="date">11th May 2004, 17:10</div></div><div class="posttext">OK, you can find four executables here: ftp://ftp.vim.org/pub/vim/unstable/tryout<br />
<br />
The first &quot;yes&quot; or &quot;no&quot; is for BGGradient, the second for BringToFront.<br />
<br />
Hopefully you can reproduce the problem with these mutilated installers!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">12th May 2004, 10:14</div></div><div class="posttext">Only yes_yes seems to cause the problem.<br />
<br />
The usage of BringToFront is no a good idea anyway in combination with a background gradient, because everything goes to the background.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>