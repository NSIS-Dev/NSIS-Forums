<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to get process info by name, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to get process info by name NSIS Discussion" />
	
	<title> How to get process info by name [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to get process info by name</div>
<hr />
<div class="pda"><a href="t-341621.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=341621">How to get process info by name</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">2nd February 2012, 10:57</div></div><div class="posttext">I need to know the process id knowing only its name.<br />
I need its pid so I can kill the right instance because of I have many processes with the same name. My idea was to run the process,  takes its id and store it. Then when I need, I run another time the same process and I kill the last instance of it by pid. <br />
If you can tell me how to make with System32 call I think it's better if it isn't so difficult. I saw ProcFunc.nsh but I can't download it. My download is blocked. I saw also GetProcessInfo.nsh but I think it work only for the current process and not for others.<br />
<br />
Thanks in advance<br />
<br />
p.s. <br />
Also using GetProcessInfo, obtaining my pid, passing it in someway to the main setup. I need to kill it by pid. And I still don't know how to do it with nsis.T.T</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">2nd February 2012, 14:22</div></div><div class="posttext">I'm sorry for the useless thread. I found procfunc.nsh  in google docs -.-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">2nd February 2012, 17:49</div></div><div class="posttext">procfunc dont run on 64bit IMO, use WMIC (windows built in) instead.<br />
<br />
type for more --&gt; wmic process get /?<br />
  nsExec::Exec &quot;wmic /OUTPUT:C:\proclist.txt PROCESS get Caption,Commandline&quot;<br />
<br />
note: &quot;name&quot; and &quot;caption&quot; and &quot;description&quot; seems equal<br />
output is in UTF-8 - converter:<br />
  ;convert text<br />
  FileOpen $0 &quot;C:\proclist.txt&quot; r<br />
  FileOpen $1 &quot;C:\proclist.new&quot; w<br />
    FileReadByte $0 $2<br />
    FileReadByte $0 $2<br />
  init02:<br />
  ClearErrors<br />
    FileReadByte $0 $2<br />
  IfErrors init03<br />
  IntCmp $2 0x00 init02 0 0<br />
    FileWritebyte $1 $2<br />
    Goto init02<br />
  init03:<br />
  FileClose $1<br />
  FileClose $0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">3rd February 2012, 07:50</div></div><div class="posttext">Ok thank you very much for the help. =) <br />
<br />
I used<br />
nsExec::ExecToStack &quot;wmic process where name='myprocname.exe' get processid /VALUE&quot;<br />
<br />
I obtain &quot;processid=&lt;PROC_ID&gt;&quot; so I have only to split it.<br />
Anyway thank you again for your suggestion =)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">6th February 2012, 17:53</div></div><div class="posttext">so I have only to split it.<br />
same here - i read line and cut the details for me.<br />
StrStr may help -&gt; http://nsis.sourceforge.net/StrStr</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>