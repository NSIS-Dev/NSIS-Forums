<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Install Options HELP, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Install Options HELP NSIS Discussion" />
	
	<title> Install Options HELP [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Install Options HELP</div>
<hr />
<div class="pda"><a href="t-339288.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=339288">Install Options HELP</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">darkvision</div><div class="date">13th December 2011, 03:20</div></div><div class="posttext">Hi I need some help with having mutiple install options that can be entered as a commandline and be pushed thru group policy the installed installs the files needed they are all msi installers i need to pass thru agruments into the nsis installer that then change the arguements of the msis within the installer i am quite new to nssi coding i have read thru many forums and guides and am lost any help would be appreicated here is the code<br />
<br />
all the files are in a folder i can answer any questions thank you<br />
<br />
#---------------------------------------------------<br />
# Important Stuff - Checks for Admin<br />
#---------------------------------------------------<br />
Name &quot;Technology One ECM 4.02&quot;<br />
OutFile &quot;Installer.exe&quot;<br />
InstallDir &quot;$PROGRAMFILES\T1\&quot;<br />
#---------------------------------------------------<br />
<br />
!include 			&quot;MUI.nsh&quot;<br />
!define 		MUI_ICON &quot;techone.ico&quot;<br />
!define 		MUI_ABORTWARNING<br />
!insertmacro 	MUI_PAGE_WELCOME<br />
!insertmacro 	MUI_PAGE_DIRECTORY<br />
!insertmacro 	MUI_PAGE_INSTFILES<br />
!insertmacro 	MUI_PAGE_FINISH<br />
!define 		MUI_FINISHPAGE_SHOWREADME $INSTDIR<br />
!insertmacro 	MUI_LANGUAGE &quot;English&quot;<br />
<br />
Function dotnetfx35<br />
	IfFileExists &quot;$WINDIR\Microsoft.NET\Framework\v3.5&quot; FOUND<br />
	DetailPrint &quot;Could not find .NET 3.5 Installing now&quot;<br />
	DetailPrint &quot;--------------------------------------&quot;<br />
	ExecWait '&quot;$EXEDIR\files\dotnetfx35.exe&quot; /q'<br />
	Goto FINISH<br />
	FOUND:<br />
		DetailPrint &quot;Found .NET 3.5&quot;	<br />
	FINISH:	<br />
FunctionEnd<br />
<br />
Function crystal2008<br />
	IfFileExists &quot;$PROGRAMFILES\Business Objects\Common\4.0\*.*&quot; FOUND FINISH<br />
	FOUND:<br />
		DetailPrint &quot;Found Crystal 2008 Runtime&quot;<br />
		DetailPrint &quot;Now Uninstalling&quot;<br />
		ExecWait 'msiexec /x &quot;$EXEDIR\files\crruntime_12_1_mlb.msi&quot; /passive'<br />
	FINISH:<br />
		DetailPrint &quot;Now Installing&quot;<br />
		ExecWait 'msiexec /i &quot;$EXEDIR\files\crruntime_12_1_mlb.msi&quot; /passive'<br />
FunctionEnd<br />
<br />
Function crystal2008viewer<br />
	IfFileExists &quot;$PROGRAMFILES\T1\CrystalViewer\*.*&quot; FOUND FINISH<br />
	FOUND:<br />
		DetailPrint &quot;Found Crystal 2008 Viewer&quot;<br />
		DetailPrint &quot;Now Uninstalling&quot;<br />
		ExecWait 'msiexec /x &quot;$EXEDIR\files\t1inscrv.msi&quot; /passive'<br />
	FINISH:<br />
		DetailPrint &quot;Now Installing&quot;<br />
		ExecWait 'msiexec /i &quot;$EXEDIR\files\t1inscrv.msi&quot; /passive'<br />
FunctionEnd<br />
<br />
Function xlone<br />
	IfFileExists &quot;$PROGRAMFILES\T1\XLOne 6.12\*.*&quot; FOUND FINISH<br />
	FOUND:<br />
		DetailPrint &quot;Found Crystal XLOne 6.12&quot;<br />
		DetailPrint &quot;Now Uninstalling&quot;<br />
		ExecWait 'msiexec /x &quot;$EXEDIR\files\xl1setup.msi&quot; /passive'<br />
	FINISH:<br />
		DetailPrint &quot;Now Installing&quot;<br />
		ExecWait 'msiexec /i &quot;$EXEDIR\files\xl1setup.msi&quot; /passive'<br />
FunctionEnd<br />
<br />
Function cilinksetup<br />
	IfFileExists &quot;$PROGRAMFILES\T1\CiLinkLauncher\*.*&quot; FOUND FINISH<br />
	FOUND:<br />
		DetailPrint &quot;Found Ci Link Launcher&quot;<br />
		DetailPrint &quot;Now Uninstalling&quot;<br />
		ExecWait 'msiexec /x &quot;$EXEDIR\files\cilinksetup.msi&quot; /passive'<br />
	FINISH:<br />
		DetailPrint &quot;Now Installing&quot;<br />
		ExecWait 'msiexec /i &quot;$EXEDIR\files\cilinksetup.msi&quot; /passive'<br />
FunctionEnd<br />
<br />
Function ssceruntime<br />
	<br />
	IfFileExists &quot;$PROGRAMFILES\Microsoft SQL Server Compact Edition\v3.5\System.Data.SqlServerCe.Entity.dll&quot; FOUND FINISH<br />
	FOUND:<br />
		DetailPrint &quot;Found SQL Server Compact Edition&quot;<br />
		DetailPrint &quot;Now Uninstalling&quot;<br />
		ExecWait 'msiexec /x &quot;$EXEDIR\files\ssceruntime-enu-x86.msi&quot; /passive'<br />
	FINISH:<br />
		DetailPrint &quot;Now Installing&quot;<br />
		ExecWait 'msiexec /i &quot;$EXEDIR\files\ssceruntime-enu-x86.msi&quot; /passive'<br />
FunctionEnd<br />
<br />
Function trust<br />
		DetailPrint &quot;Checking if Repairing or installing is needed&quot;<br />
		ExecWait 'msiexec /i &quot;$EXEDIR\files\Trust-t1.msi&quot; /passive'<br />
FunctionEnd<br />
<br />
Function pia<br />
	Push $R0<br />
	Push $R1<br />
	StrCpy $R0 &quot;&quot;<br />
	StrCpy $R1 &quot;&quot;<br />
	ReadRegStr $R1 HKLM &quot;SOFTWARE\Microsoft\Office\11.0\Common\InstallRoot&quot; &quot;Path&quot;<br />
	strcmp $R1 &quot;&quot; Nine CheckEight<br />
	CheckEight:<br />
		IfFileExists &quot;$R1\winword.exe&quot; 0 Nine<br />
		ExecWait 'msiexec /i &quot;$EXEDIR\files\o2003pia.msi&quot; ALLUSER=1 /qn'<br />
		DetailPrint &quot;2003 Found&quot;<br />
	Nine:<br />
		ReadRegStr $R1 HKLM &quot;SOFTWARE\Microsoft\Office\12.0\Common\InstallRoot&quot; &quot;Path&quot;<br />
		strcmp $R1 &quot;&quot; None CheckNine<br />
	CheckNine:<br />
		IfFileExists &quot;$R1\winword.exe&quot; 0 <br />
		ExecWait 'msiexec /i &quot;$EXEDIR\files\o2007pia.msi&quot; ALLUSER=1 /qn'<br />
		DetailPrint &quot;2007 Found&quot;	<br />
	None:<br />
		DetailPrint &quot;Finished installing PIAs&quot;<br />
	<br />
FunctionEnd<br />
<br />
Function vstor<br />
	IfFileExists &quot;$PROGRAMFILES\Common Files\microsoft shared\VSTO\8.0\Microsoft Visual Studio 2005 Tools for Office Runtime\*.*&quot; FOUND FINISH<br />
	FOUND:<br />
		DetailPrint &quot;Found Visual Studio Tools 2005&quot;<br />
		DetailPrint &quot;Now Uninstalling&quot;<br />
		ExecWait '&quot;$EXEDIR\files\vstor.exe&quot; /qu'<br />
	FINISH:<br />
		ExecWait '&quot;$EXEDIR\files\vstor.exe&quot; /q'<br />
FunctionEnd<br />
<br />
Function ecm<br />
	IfFileExists &quot;$PROGRAMFILES\Technology One\ECM - Classic Components\*.*&quot; QUESTION<br />
	Goto INSTALL<br />
	QUESTION:<br />
		MessageBox MB_YESNO &quot;You seem to have a previous copy of the ECM client already installed. Would you like to remove such client and replace it with the latest version?&quot; IDYES UNINSTALL IDNO FINISH<br />
	#END QUESTION<br />
	UNINSTALL:<br />
	<br />
		DetailPrint &quot;Now uninstalling any traces of ECM 3.08&quot;<br />
		ExecWait '&quot;msiexec&quot; /x &quot;$EXEDIR\files\dwclassic308.msi&quot; /passive'<br />
	<br />
		DetailPrint &quot;Now uninstalling any traces of ECM 4.02&quot;<br />
		ExecWait '&quot;msiexec&quot; /x &quot;$EXEDIR\files\dwclassic.msi&quot; /passive'<br />
	#END UNINSTALL	<br />
	INSTALL:<br />
		ExecWait '&quot;msiexec&quot; /i &quot;$EXEDIR\files\dwclassic.msi&quot; /qf'<br />
		DetailPrint &quot;Now installing ECM 4.02&quot;<br />
	#END INSTALL	<br />
	FINISH:<br />
		#HERE TO SKIP<br />
	#END FINISH	<br />
FunctionEnd<br />
 #------------------------------------------------------------------------------------------------------------<br />
 <br />
Section<br />
<br />
	#---------------------------------------------------<br />
	# Important Stuff - Checks for Admin<br />
	#---------------------------------------------------<br />
	userInfo::getAccountType<br />
	pop $2<br />
	StrCmp $2 &quot;Admin&quot; +3<br />
	MessageBox MB_OK &quot;Please try again as Admin&quot;<br />
	Return<br />
	SetOutPath $INSTDIR<br />
	LogSet on<br />
	#---------------------------------------------------<br />
	<br />
	Call dotnetfx35<br />
	Call crystal2008<br />
	Call crystal2008viewer<br />
	Call xlone<br />
	Call cilinksetup<br />
	Call ssceruntime<br />
	Call trust<br />
	Call pia<br />
	Call vstor<br />
	Call ecm<br />
	<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th December 2011, 10:30</div></div><div class="posttext">Please edit your post and attach the script as a file attachment. You can use GetParameters and GetOptions to parse/read command line arguments. Also I would recommend switching to MUI2 (just !include MUI2.nsh).<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>