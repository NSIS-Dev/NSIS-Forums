<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" WriteRegStr Problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  WriteRegStr Problem NSIS Discussion" />
	
	<title> WriteRegStr Problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  WriteRegStr Problem</div>
<hr />
<div class="pda"><a href="t-328683.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=328683">WriteRegStr Problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ukandrewc</div><div class="date">20th March 2011, 14:29</div></div><div class="posttext">I have a weird problem with this entry, causing the installer to freeze:<br />
<br />
WriteRegStr HKLM &quot;Software\Microsoft\Internet Explorer\Extensions\{5ABDF6B0-336E-41e8-ADF2-76629F963BD6}&quot; &quot;MenuText&quot; &quot;Queue Sales Records&quot;<br />
<br />
<br />
This entry works OK.<br />
WriteRegStr HKLM  &quot;SOFTWARE\Microsoft\Internet Explorer\Low Rights\ElevationPolicy\{ED1FA840-C3FD-11dd-AB02-00045A7930B1}&quot; &quot;Policy&quot; &quot;3&quot;<br />
<br />
An additional oddity is that if OutFile is install.exe I get the problem, if it is setup.exe I don't.<br />
<br />
Anyone got any ideas?<br />
<br />
Thanks<br />
<br />
Andrew</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ukandrewc</div><div class="date">20th March 2011, 15:44</div></div><div class="posttext">I have just discovered that this is only on XP. On Windows 7 they both freeze the installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th March 2011, 16:04</div></div><div class="posttext">Do you have RequestExecutionLevel admin?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ukandrewc</div><div class="date">20th March 2011, 16:28</div></div><div class="posttext">Thanks Stu<br />
<br />
I do now but it hasn't changed anything.<br />
<br />
I thought I'd write to a .reg file and run that but I would need to escape  \ characters in file names.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ukandrewc</div><div class="date">20th March 2011, 16:40</div></div><div class="posttext">It's definitely to do with the braces as removing them fixes it.<br />
<br />
I suspect a problem in the string parser but don't know why that wouldn't have cropped up before?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ukandrewc</div><div class="date">20th March 2011, 17:12</div></div><div class="posttext">In fact just removing the right brace solves it.<br />
<br />
Any ideas?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ukandrewc</div><div class="date">20th March 2011, 17:23</div></div><div class="posttext">It seems that it is interfering with the execution. The value is written and if I put MessageBox MB_OK &quot;Hello&quot; straight after, the system beeps, the message box shows and then freezes.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ukandrewc</div><div class="date">20th March 2011, 17:26</div></div><div class="posttext">Definitely something in the string parser, if I change the Key from ...\Extensions\{... to ...\Extension\{... it works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">20th March 2011, 21:53</div></div><div class="posttext">OutFile test.exe<br />
RequestExecutionLevel admin<br />
page instfiles<br />
Section<br />
WriteRegStr HKLM &quot;Software\Microsoft\Internet Explorer\Extensions\{5ABDF6B0-336E-41e8-ADF2-76629F963BD6}&quot; &quot;MenuText&quot; &quot;Queue Sales Records&quot;<br />
SectionEnd<br />
Does this crash?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ukandrewc</div><div class="date">21st March 2011, 10:54</div></div><div class="posttext">Thanks Anders<br />
<br />
Unfortunately no. I've tried it in isolation but it doesn't cause any problem.<br />
<br />
I'll do some more tests.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ukandrewc</div><div class="date">21st March 2011, 11:04</div></div><div class="posttext">I think I'll have to leave this for the moment. If I remove everything except the WriteRegStr lines from the installer, it works OK.<br />
<br />
I've now got a workaround by writing to a .reg file but at some pount I'll go through and see what combination causes the problem.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st March 2011, 14:30</div></div><div class="posttext">You could also try putting the key in a variable. Either way it shouldn't crash so yeh when you get back to it it'll be nice to find out what is causing it. I've never seen this problem.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ukandrewc</div><div class="date">22nd March 2011, 23:44</div></div><div class="posttext">I have discovered that removing this:<br />
<br />
SetOverwrite ifnewer<br />
SetOutPath $SYSDIR<br />
File &quot;SystemCpy\*.*&quot;<br />
<br />
and replacing them with calls to InstallLib removes the problem.<br />
<br />
But I simply haven't been able to reproduce this in isolation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ukandrewc</div><div class="date">23rd March 2011, 00:51</div></div><div class="posttext">Forgot to mention that the important line is SetOutPath, if that isn't set to $SYSDIR everything works.<br />
<br />
The DLL's being in use or not when I installed didn't seem relevant.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>