<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" run uninstaller if exec fails, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  run uninstaller if exec fails NSIS Discussion" />
	
	<title> run uninstaller if exec fails [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  run uninstaller if exec fails</div>
<hr />
<div class="pda"><a href="t-272672.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=272672">run uninstaller if exec fails</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">starsign</div><div class="date">11th June 2007, 22:03</div></div><div class="posttext">Hi,<br />
<br />
As part of my installation I call execwait to run a c# exe.  If this fails the user is notified and I would like to run unnstall.  I have tried calling ExecWait &quot;$INSTDIR/uninst.exe&quot;, however this then asks the user if they want to cancel (needed for std uninstall), when I don't want to give the user a choice.<br />
<br />
I would also like to do this if there is an error in the install generally.  I clear errors at the start and can test if there are errors at the end, so I guess the calling of the uninstaller would be the same as the above?<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">11th June 2007, 22:12</div></div><div class="posttext">1. It goes with the /S (silent) switch however ExecWait &quot;$INSTDIR/uninst.exe&quot; would not operate properly.<br />
The method on how to call the uninstaller from the installer explained in the included example makensis.nsi, I'd suggest follow that method.<br />
<br />
2. Normally would be the same, you have to try though.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">starsign</div><div class="date">11th June 2007, 22:52</div></div><div class="posttext">Thanks for your comments.  I have taken the example code you mentioned and now have the following code in the  _Post section of my installer (this is where I run my .exe, as I need to know that the registry info has been set up...if there is a better place to have it then let me know):<br />
<br />
I can't get the messageboxes to turn off by using the /S switch...I just create an error...how should I implement that?<br />
<br />
Silent_Uninstall:<br />
  ReadRegStr $R1 HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\SmartChart&quot; &quot;UninstallString&quot;<br />
<br />
  ;Run uninstaller<br />
  HideWindow<br />
<br />
    ClearErrors<br />
    ExecWait '$R1 _?=$INSTDIR'<br />
<br />
    IfErrors no_remove_uninstaller<br />
    ;IfFileExists &quot;$INSTDIR\SmartChart.exe&quot; no_remove_uninstaller<br />
      Delete $R1<br />
      RMDir $INSTDIR<br />
<br />
    no_remove_uninstaller:<br />
    Quit<br />
<br />
  <br />
done:<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">11th June 2007, 22:58</div></div><div class="posttext">You'd need the /SD switch for the message boxes, refer to NSIS documentation about.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>