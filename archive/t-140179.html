<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Can I use the DLL advsplash.dll in an ohter program ?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Can I use the DLL advsplash.dll in an ohter program ? NSIS Discussion" />
	
	<title> Can I use the DLL advsplash.dll in an ohter program ? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Can I use the DLL advsplash.dll in an ohter program ?</div>
<hr />
<div class="pda"><a href="t-140179.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=140179">Can I use the DLL advsplash.dll in an ohter program ?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Meduse</div><div class="date">26th June 2003, 10:50</div></div><div class="posttext">Hello, <br />
<br />
I would like to know if i can use the dll advsplah.dll in a personnal program written in VB. Will it work or not ? <br />
<br />
Where can i get API definitions ? <br />
<br />
Thanks for your answers<br />
<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">26th June 2003, 12:05</div></div><div class="posttext">All plugin functions have the same API definition:void __declspec(dllexport) show(HWND hwndParent, int string_size, char *variables, stack_t **stacktop)<br />
Where stack_t is a c structure inside NSIS which you'd have to mimic somehow from VB (but how would you do that? VB doesn't deal in plain character arrays but uses BSTRs AFAIK).typedef struct _stack_t {<br />
  struct _stack_t *next;<br />
  char text[1]; // this should be the length of string_size<br />
} stack_t;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th June 2003, 12:07</div></div><div class="posttext">It's possible, but I think it would be easier to tweak the code a bit and make it accept the parameters on the normal stack (function parameters) instead of the NSIS stack. This way you won't need to implement the stack on your end.<br />
<br />
Otherwise the function prototype is:<br />
<br />
void show(HWND hwndParent, int string_size, char *variables, stack_t **stacktop)<br />
<br />
hwndParent and variables aren't used by this plug-in so you can just pass NULL. string_size is the size of each string on the stack, and stack_t is defined as:<br />
<br />
struct _stack_t {<br />
  struct _stack_t *next;<br />
  char text[NSIS_MAX_STRLEN];<br />
};<br />
<br />
NSIS_MAX_STRLEN is 1024 by default and is the value you should pass as string_size.<br />
<br />
Variables you need to push on the NSIS stack are described in the readme for AdvSplash.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Meduse</div><div class="date">26th June 2003, 12:12</div></div><div class="posttext">thank you for your answer<br />
<br />
i will test your explication<br />
<br />
<br />
Thanks again<br />
<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Meduse</div><div class="date">26th June 2003, 12:36</div></div><div class="posttext">My code doesn t work :-((<br />
<br />
my script test is:<br />
<br />
Option Explicit<br />
<br />
Private Declare Function show1 Lib &quot;c:\advsplash.dll&quot; Alias &quot;show&quot; (hwnd As variant, string_size As integer, vars As variant, param As String)<br />
<br />
<br />
Private Sub Form_Load()<br />
show1 &quot;&quot;, 1024, &quot;&quot;, &quot;1000 600 400 -1 c:\splash&quot;<br />
<br />
End Sub<br />
<br />
...<br />
<br />
My VB environnment is bugging<br />
<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th June 2003, 12:55</div></div><div class="posttext">Imo it's way easier to create a splash screen using VB.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>