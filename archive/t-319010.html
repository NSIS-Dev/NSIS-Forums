<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" unfocus a control, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  unfocus a control NSIS Discussion" />
	
	<title> unfocus a control [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  unfocus a control</div>
<hr />
<div class="pda"><a href="t-319010.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=319010">unfocus a control</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bnicer</div><div class="date">7th May 2010, 14:26</div></div><div class="posttext">To unset the focus on the location on the Directory page, is the only way to set the focus on another control?<br />
<br />
GetDlgItem $0 $mui.DirectoryPage &quot;1020&quot; ; Groupbox control<br />
System::Call 'user32::SetFocus(i r0)' ; unfocus 1019, Edit control (location input)<br />
<br />
It seems harmless enough, but it might be even better to set the focus on nothing, to blur.<br />
<br />
Can that be done? My apologies for the trivial nature of the question.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th May 2010, 16:52</div></div><div class="posttext">I'm not certain but I think the only way is to move focus to another control.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">7th May 2010, 17:30</div></div><div class="posttext">From my understanding of Win32, at least one control will have focus when an app is active unless every control is disabled (though not 100% on that). So something will have to have focus unless the installer is unfocused (which will defeat what you're trying to do).<br />
<br />
Though i'm not too sure where the need for a requirement to not have the directory edit control focused, a bit more info of what you're trying to achieve may make it easier to give you a better answer.<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">7th May 2010, 18:59</div></div><div class="posttext">There are two levels when it comes to focus, the window manager and on top of that, the dialog manager. When you call SetFocus you are bypassing the dialog manager and talking directly to the window manager. This could be problematic since the dialog manager is actually responsible for the tab order. See http://blogs.msdn.com/oldnewthing/archive/2004/08/02/205624.aspx for more.<br />
<br />
But like Dro, I feel we need more info about what you really want...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bnicer</div><div class="date">7th May 2010, 21:46</div></div><div class="posttext">I noticed some quirkiness with the tab-order at first -- e.g. alt-N, alt-B not responding -- but something I did seems to have fixed it. I was experimenting with different controls ...<br />
<br />
The installer's behavior is that when a destination is full, the path cannot be installed to and the input text is selected, showing the path is taken. Otherwise, the input text is unselected, showing that the destination is available. <br />
<br />
Moving the caret to the beginning of the path text would achieve that the text is unselected while the caret flashes. When the focus is set to another control, the caret is also removed. No flashing.<br />
<br />
On the Startmenu Page, if the group name that displays in the Edit control is in use, the text is selected. If the group name is free, the text is unselected.<br />
<br />
The code is below. DirState checks if the folder is full, empty or exists.<br />
<br />
<br />
Function StartMenuPageShow<br />
  !ifdef MUI_STARTMENUPAGE_INTERFACE<br />
    GetDlgItem $0 $mui.StartMenuPage &quot;1002&quot; ; Edit control<br />
    GetDlgItem $1 $mui.StartMenuPage &quot;1003&quot; ; Label control<br />
  !else<br />
    GetDlgItem $0 $MUI_HWND &quot;1002&quot;<br />
    GetDlgItem $1 $MUI_HWND &quot;1003&quot;<br />
  !endif<br />
  Call check_sm_folder<br />
FunctionEnd<br />
<br />
Function check_sm_folder<br />
  System::Call 'user32::GetWindowText(i r0, t .R0, i 256)'<br />
  ${If} $REM != &quot;firsttime&quot;<br />
  ${AndIf} ${TEMP1} == $ICONS_PATH<br />
  ${AndIf} $PATH == $INSTDIR<br />
    StrCpy $R1 2 #<br />
  ${Else}<br />
    SetShellVarContext current<br />
    Push $SMPROGRAMS\${TEMP1}<br />
    Call DirState<br />
    Pop $R1<br />
    ${If} $R1 != 1<br />
      SetShellVarContext all<br />
      Push $SMPROGRAMS\${TEMP1}<br />
      Call DirState<br />
      Pop $R1<br />
    ${EndIf}<br />
  ${EndIf}<br />
  ${If} $R1 == 1<br />
    System::Call 'user32::SetFocus(i r0)'<br />
    SendMessage $0 ${EM_SETSEL} 0 -1 ; select location input<br />
  ${Else}<br />
    System::Call 'user32::SetFocus(i r1)'<br />
  ${EndIf}<br />
FunctionEnd<br />
<br />
Function StartMenuPageLeave<br />
  Call check_sm_folder<br />
  ${If} $R1 == 1<br />
    MessageBox MB_USERICON|MB_OK &quot;$(MESSAGE_SMF_USED)&quot;<br />
    Abort ; smfolder not empty<br />
  ${EndIf}<br />
FunctionEnd<br />
<br />
<br />
<br />
Tab-order appears to be unaffected.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>