<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" WordReplace - replace only one occurrence, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  WordReplace - replace only one occurrence NSIS Discussion" />
	
	<title> WordReplace - replace only one occurrence [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  WordReplace - replace only one occurrence</div>
<hr />
<div class="pda"><a href="t-314800.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=314800">WordReplace - replace only one occurrence</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ChocJunkie</div><div class="date">23rd November 2009, 09:44</div></div><div class="posttext">Hi,<br />
<br />
I would like to replace the colons of a time string usinh 'h' for the first, 'm' for the second and 's' for the third colon.<br />
If tryed using<br />
      ${WordReplace} &quot;$R1&quot; &quot;:&quot; &quot;h&quot; &quot;E+1&quot; $R1<br />
If the input is &quot;10:20:30&quot; the output is &quot;10h2030&quot;.<br />
My question is: How can I get 10h20m30s from the input?<br />
<br />
Thanks :)<br />
<br />
CJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">23rd November 2009, 10:35</div></div><div class="posttext">I think this should be it:<br />
<br />
!macro _ReplaceFirstByteOccurance _outvar _input _orig _replace<br />
  Push $R0   ;max loopcounter<br />
  Push $R1   ;loopcounter<br />
  Push $R2<br />
  !define Lprefix L${__LINE__}<br />
  StrLen $R0 ${_input}<br />
  StrCpy $R1 0<br />
  ${Lprefix}Loop:<br />
    StrCpy $R2 ${_input} 1 $R1<br />
    StrCmp $R2 ${_orig} 0 ${Lprefix}NoMatch<br />
      StrCpy $R2 ${_input} $R1<br />
      StrCpy $R2 $R2${_replace}<br />
      IntOp $R1 $R1 + 1<br />
      StrCpy $R0 ${_input} &quot;&quot; $R1<br />
      StrCpy $R2 $R2$R0<br />
      goto ${Lprefix}End<br />
    ${Lprefix}NoMatch:<br />
    IntOp $R1 $R1 + 1<br />
    StrCmp $R1 $R0 0 ${Lprefix}loop<br />
    StrCpy $R2 ${_input}  ;nothing found, return original string.<br />
  ${Lprefix}End:<br />
  !undef Lprefix<br />
  Push $R2<br />
  Exch 3<br />
  pop $R0<br />
  pop $R2<br />
  pop $R1<br />
  pop ${_outvar}<br />
!macroend<br />
!define ReplaceFirstByteOccurance `!insertmacro _ReplaceFirstByteOccurance`<br />
<br />
${ReplaceFirstByteOccurance} $1 $1 &quot;:&quot; &quot;h&quot;<br />
${ReplaceFirstByteOccurance} $1 $1 &quot;:&quot; &quot;m&quot;<br />
StrCpy $1 &quot;$1s&quot;<br />
<br />
Learn to use StrCmp/StrCpy/StrLen etc. They're very helpful commands.<br />
<br />
<br />
Edit2: Doh, can't use $R1 as parameter to a macro that uses $R1, obviously.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ChocJunkie</div><div class="date">23rd November 2009, 10:48</div></div><div class="posttext">Thanks for your solution/hint! :)<br />
I've got an idea now, how to implement my what I'm thinking about. ^^<br />
<br />
Just because I'm curious:<br />
So it's not possible using WordReplace for this!?<br />
I understood its functionality for problems like this in first place... -.-<br />
<br />
CJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">23rd November 2009, 11:01</div></div><div class="posttext">Oh, I'm sure it can be done with WordReplace or some other macro like it. But why use a bulky general-purpose script when a tiny little macro of your own will suffice?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st December 2009, 07:37</div></div><div class="posttext">WordReplace is good enough. I don't see how the code you've posted would result in the wrong output. This works fine for me.StrCpy $R1 20:30:10<br />
${WordReplace} &quot;$R1&quot; &quot;:&quot; &quot;h&quot; &quot;E+1&quot; $R1<br />
DetailPrint $R1 # 20h30:10<br />
${WordReplace} &quot;$R1&quot; &quot;:&quot; &quot;m&quot; &quot;E+1&quot; $R1<br />
DetailPrint $R1 # 20h30m10</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>