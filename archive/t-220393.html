<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Secondary Installation Directory, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Secondary Installation Directory NSIS Discussion" />
	
	<title> Secondary Installation Directory [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Secondary Installation Directory</div>
<hr />
<div class="pda"><a href="t-220393.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=220393">Secondary Installation Directory</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Jaymach</div><div class="date">1st July 2005, 11:23</div></div><div class="posttext">Hi...I was wandering if it was possible to make a sort of secondary installation directory? (Note: I'm a complete n00b at NSIS.) I'm wanting something like...<br />
<br />
InstallDirRegKey HKLM &quot;SOFTWARE\Microsoft\MSNMessenger&quot; &quot;InstallationDirectory&quot;<br />
InstallDir2RegKey HKLM &quot;SOFTWARE\Patchou\MsgPlus2&quot; &quot;InstallationDirectory2&quot;<br />
<br />
Now I know that won't work like that...but is there any way to do it? Even if I had to download some sort of plugin, I'd be happy to do so.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">1st July 2005, 12:40</div></div><div class="posttext">You can read this key inside .onInit function and store it in user variable.<br />
Var InstDir2<br />
...<br />
ReadRegStr $InstDir2 $HKLM &quot;SOFTWARE\Patchou\MsgPlus2&quot; &quot;InstallationDirectory2&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jaymach</div><div class="date">1st July 2005, 13:22</div></div><div class="posttext">Thanks for the quick reply...unfortunately it's giving me errors :( (As I said...I'm a complete n00b so it's entirely possible I've made an obvious mistake). I'm attaching my script so you can see if I've done it right...just tell me if I've been a complete idiot. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">1st July 2005, 13:47</div></div><div class="posttext">Originally posted by Jaymach <br />
Thanks for the quick reply...<br />
:) Very quick - 1 hour. :D<br />
Add before section instfiles Var InstDir2.<br />
And my typo<br />
ReadRegStr $InstDir2 HKLM &quot;SOFTWARE\Patchou\MsgPlus2&quot; &quot;InstallationDirectory2&quot;<br />
Try this. Post if will other errors.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jaymach</div><div class="date">1st July 2005, 13:50</div></div><div class="posttext">Lol...it was quick by my standards seeing as I usually wait about a day to get help. :P When I add it before instfiles I get<br />
<br />
Error: command ReadRegStr not valid outside section or function</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">1st July 2005, 13:54</div></div><div class="posttext">Leave ReadRegStr in section. Add this line before section Var InstDir2</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jaymach</div><div class="date">1st July 2005, 14:38</div></div><div class="posttext">Sorry about not replying sooner. :) Working perfectly apart from me calling the wrong part of the registry lol...thanks once more for the help. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st July 2005, 20:34</div></div><div class="posttext">Did you end up putting it in a section?<br />
If so, then you should put it in your second directory page's Pre function:<br />
<br />
Var INSTDIR2<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE getInstDir<br />
!define MUI_DIRECTORYPAGE_VARIABLE $INSTDIR2<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
<br />
Now put that code in a Function named getInstDir.<br />
This will put the value of $INSTDIR2 into your Directory path box.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jaymach</div><div class="date">2nd July 2005, 08:40</div></div><div class="posttext">Well I...uh...have no idea how to do that. :)...but a new problem...is there any way for me to get the installer to look for 2 entries in the Registry? I need it to look in both HKEY_LOCAL_MACHINE\SOFTWARE\Patchou\MsgPlus2 and HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Patchou\MsgPlus2 as on my Windows XP x64 edition, the 1st location isn't there, and has been moved to the 2nd location. I'm trying to make my installer run on both versions, so is there any way for me to try to detect both?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd July 2005, 12:35</div></div><div class="posttext">Easier than you think.<br />
<br />
Var INSTDIR2<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE getInstDir<br />
!define MUI_DIRECTORYPAGE_VARIABLE $INSTDIR2<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
<br />
Function getInstDir<br />
 ReadRegStr $INSTDIR2 HKLM &quot;SOFTWARE\Patchou\MsgPlus2&quot; &quot;keyname&quot;<br />
 StrCmp $INSTDIR2 &quot;&quot; 0 +2<br />
 ReadRegStr $INSTDIR2 HKLM &quot;SOFTWARE\Wow6432Node\Patchou\MsgPlus2&quot; &quot;keyname&quot;<br />
 StrCmp $INSTDIR2 &quot;&quot; 0 +2<br />
  StrCpy $INSTDIR2 &quot;C:\default install dir&quot;<br />
FunctionEnd<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>