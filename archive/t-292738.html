<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSDialogs Help, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSDialogs Help NSIS Discussion" />
	
	<title> NSDialogs Help [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSDialogs Help</div>
<hr />
<div class="pda"><a href="t-292738.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=292738">NSDialogs Help</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">T_LOKZz</div><div class="date">4th June 2008, 23:59</div></div><div class="posttext">Let me start off by saying I'm kind of a noob :P<br />
<br />
I've made an installer for a program I've created. It's an addon for a game and it checks for certain files and copies them over from a CD if one is missing. I've got all the functions completed but trying to make a page strictly for this and it shows details and a dirrequest for the CD...<br />
<br />
also I'm playing on adding a button to say start the CD copy function... and a text below showing witch CD they need and what file it found missing... I used installoptions first but most of this couln't be accomplished due to can't be called back.. well maybe :(<br />
<br />
Var DIRREQ<br />
Function MPQCheck <br />
    nsDialogs::Create /NOUNLOAD 1018<br />
<br />
    ${NSD_CreateDirRequest} 0 0 75% 12u &quot;$PROGRAMFILES\Awesom-O&quot;<br />
    Pop $DIRREQ<br />
    GetFunctionAddress $0 DIREC<br />
    nsDialogs::OnChange /NOUNLOAD $DIRREQ $0<br />
    <br />
    ${NSD_CreateBrowseButton} 345 0 15% 12u &quot;Browse&quot;<br />
    Pop $DIRREQ<br />
    GetFunctionAddress $0 DIREC<br />
    nsDialogs::GetText /NOUNLOAD $DIRREQ $0<br />
<br />
    nsDialogs::Show<br />
FunctionEnd<br />
<br />
Function DIREC<br />
    Pop $0 # HWND<br />
<br />
    System::Call user32::GetWindowText(i$DIRREQ,t.r0,i${NSIS_MAX_STRLEN})<br />
<br />
    StrCpy $INSTDIR &quot;$0&quot;<br />
FunctionEnd<br />
<br />
That's what I tried and failing at trying to get the browse button to work and also getting it to show up in the DirRequest</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sheik</div><div class="date">5th June 2008, 04:17</div></div><div class="posttext">Well, I can give you an example that I am using today...<br />
Hopefully it doesn't cut/paste too badly...<br />
(I basically leeched it from the InstallOptions -&gt; nsdialog code)<br />
<br />
<br />
<br />
		${NSD_CreateDirRequest} 20 70 248 18 &quot;&quot;<br />
		Pop $DIGI.DestinationLocations.DirRequest1<br />
		${NSD_SetText} $DIGI.DestinationLocations.DirRequest1 &quot;$ESP_LOCATION&quot;<br />
<br />
		${NSD_CreateBrowseButton} 270 69 24 18 &quot;...&quot;<br />
		Pop $DIGI.DestinationLocations.Button1<br />
		${NSD_OnClick} $DIGI.DestinationLocations.Button1 OnDirBrowseButton<br />
<br />
<br />
<br />
	Function OnDirBrowseButton<br />
		Pop $R0<br />
<br />
		${If} $R0 == $DIGI.DestinationLocations.Button1<br />
<br />
			${NSD_GetText} $DIGI.DestinationLocations.DirRequest1 $R0<br />
<br />
			nsDialogs::SelectFolderDialog /NOUNLOAD &quot;&quot; $R0<br />
			Pop $R0<br />
<br />
			${If} $R0 != error<br />
				${NSD_SetText} $DIGI.DestinationLocations.DirRequest1 &quot;$R0&quot;<br />
			${EndIf}<br />
<br />
<br />
<br />
<br />
In your &quot;LEAVE&quot; function, you can get the text by doing:<br />
		${NSD_GetText} $DIGI.DestinationLocations.DirRequest1 $R0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T_LOKZz</div><div class="date">5th June 2008, 05:05</div></div><div class="posttext">Well I added that to what I believed wut u meant but errors on compiling<br />
<br />
specifically:<br />
Pop $DIGI.DestinationLocations.DirRequest1<br />
<br />
what i did:<br />
Function MPQCheck <br />
    nsDialogs::Create /NOUNLOAD 1018<br />
<br />
    ${NSD_CreateDirRequest} 20 70 248 18 &quot;&quot;<br />
    Pop $DIGI.DestinationLocations.DirRequest1<br />
    ${NSD_SetText} $DIGI.DestinationLocations.DirRequest1 &quot;$ESP_LOCATION&quot;<br />
<br />
    ${NSD_CreateBrowseButton} 270 69 24 18 &quot;...&quot;<br />
    Pop $DIGI.DestinationLocations.Button1<br />
    ${NSD_OnClick} $DIGI.DestinationLocations.Button1 OnDirBrowseButton<br />
<br />
    nsDialogs::Show<br />
FunctionEnd<br />
<br />
Function OnDirBrowseButtonn<br />
    Pop $R0<br />
<br />
    ${If} $R0 == $DIGI.DestinationLocations.Button1<br />
<br />
    ${NSD_GetText} $DIGI.DestinationLocations.DirRequest1 $R0<br />
<br />
    nsDialogs::SelectFolderDialog /NOUNLOAD &quot;&quot; $R0<br />
    Pop $R0<br />
<br />
    ${If} $R0 != error<br />
        ${NSD_SetText} $DIGI.DestinationLocations.DirRequest1 &quot;$R0&quot;<br />
    ${EndIf}<br />
FunctionEnd<br />
<br />
Function MPQCheckLeave<br />
    ${NSD_GetText} $Text $Text_State<br />
    ${NSD_GetState} $Checkbox $Checkbox_State<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sheik</div><div class="date">5th June 2008, 05:09</div></div><div class="posttext">Yes, I didn't do too good of job cutting/pasting. =)<br />
<br />
I assume you have declared the VARs, ie:<br />
		Var DIGI.DestinationLocations.Button1<br />
		Var DIGI.DestinationLocations.DirRequest1<br />
<br />
?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T_LOKZz</div><div class="date">5th June 2008, 05:34</div></div><div class="posttext">Now I get no label logiclib sumden<br />
<br />
what I have now:<br />
<br />
Var DIGI.DestinationLocations.Button1<br />
Var DIGI.DestinationLocations.DirRequest1<br />
<br />
Function MPQCheck <br />
    nsDialogs::Create /NOUNLOAD 1018<br />
<br />
    ${NSD_CreateDirRequest} 20 70 248 18 &quot;&quot;<br />
    Pop $DIGI.DestinationLocations.DirRequest1<br />
    ${NSD_SetText} $DIGI.DestinationLocations.DirRequest1 &quot;$ESP_LOCATION&quot;<br />
<br />
    ${NSD_CreateBrowseButton} 270 69 24 18 &quot;...&quot;<br />
    Pop $DIGI.DestinationLocations.Button1<br />
    ${NSD_OnClick} $DIGI.DestinationLocations.Button1 OnDirBrowseButton<br />
<br />
    nsDialogs::Show<br />
FunctionEnd<br />
<br />
Function OnDirBrowseButton<br />
    Pop $R0<br />
<br />
    ${If} $R0 == $DIGI.DestinationLocations.Button1<br />
<br />
    ${NSD_GetText} $DIGI.DestinationLocations.DirRequest1 $R0<br />
<br />
    nsDialogs::SelectFolderDialog /NOUNLOAD &quot;&quot; $R0<br />
    Pop $R0<br />
    <br />
    ${If} $R0 != error<br />
        ${NSD_SetText} $DIGI.DestinationLocations.DirRequest1 &quot;$R0&quot;<br />
    ${EndIf}   <br />
FunctionEnd<br />
<br />
Function MPQCheckLeave<br />
    ${NSD_GetText} $DIGI.DestinationLocations.DirRequest1 $R0<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sheik</div><div class="date">5th June 2008, 05:43</div></div><div class="posttext">Make sure you include logiclib at the top of your script:<br />
<br />
!include &quot;LogicLib.nsh&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T_LOKZz</div><div class="date">5th June 2008, 05:56</div></div><div class="posttext">Had that<br />
<br />
compile error:<br />
<br />
Error: could not resolve label &quot;_LogicLib_Label_10&quot; in function &quot;OnDirBrowseButton&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">5th June 2008, 14:21</div></div><div class="posttext">Originally posted by Sheik <br />
Make sure you include logiclib at the top of your script:<br />
<br />
!include &quot;LogicLib.nsh&quot;  <br />
LogicLib.nsh is included by nsDialogs.nsh, when you use nsDialogs you don't have to &quot;!include&quot; LogicLib.nsh again.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sheik</div><div class="date">5th June 2008, 17:06</div></div><div class="posttext">I think you are missing an $(EndIf}<br />
<br />
Change this:<br />
<br />
...<br />
${If} $R0 != error<br />
${NSD_SetText} $DIGI.DestinationLocations.DirRequest1 &quot;$R0&quot;<br />
${EndIf} <br />
FunctionEnd<br />
<br />
To:<br />
<br />
...<br />
${If} $R0 != error<br />
${NSD_SetText} $DIGI.DestinationLocations.DirRequest1 &quot;$R0&quot;<br />
${EndIf} <br />
${EndIf} <br />
FunctionEnd<br />
<br />
Too bad we can't see indents here, it would be more obvious. =)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T_LOKZz</div><div class="date">5th June 2008, 18:38</div></div><div class="posttext">Ok that worked perfectly... Now how do you refresh the Custom Page since when going through my functions it should add information into the Variables $MPQNFO and $DISC but yet after going through my function and pausing for the second one it does not update my label<br />
<br />
Var DIGI.DestinationLocations.Button1<br />
Var DIGI.DestinationLocations.DirRequest1<br />
Var BUTTON<br />
Var INFO<br />
<br />
Function MPQCheck<br />
    ReadINIStr $MPQ &quot;$PLUGINSDIR\Setup.ini&quot; &quot;Field 4&quot; &quot;State&quot;<br />
    StrCmp $MPQ &quot;1&quot; yes no<br />
    yes:<br />
    cdrom::FindNext /NOUNLOAD .r0<br />
    cdrom::FindClose<br />
    nsDialogs::Create /NOUNLOAD 1018<br />
<br />
    ${NSD_CreateDirRequest} 0 25 75% 12u &quot;&quot;<br />
    Pop $DIGI.DestinationLocations.DirRequest1<br />
    ${NSD_SetText} $DIGI.DestinationLocations.DirRequest1 &quot;$0&quot;<br />
<br />
    ${NSD_CreateBrowseButton} 340 25 8% 12u &quot;...&quot;<br />
    Pop $DIGI.DestinationLocations.Button1<br />
    ${NSD_OnClick} $DIGI.DestinationLocations.Button1 OnDirBrowseButton<br />
    <br />
    ${NSD_CreateButton} 0 100 8% 12u Ok<br />
    Pop $BUTTON<br />
    GetFunctionAddress $0 OnClick<br />
    nsDialogs::OnClick /NOUNLOAD $BUTTON $0<br />
    <br />
    ${NSD_CreateLabel} 0 0u 75% 40u &quot;$INFO&quot;<br />
    Pop $0<br />
    <br />
    nsDialogs::Show<br />
    no:<br />
FunctionEnd<br />
<br />
Function OnDirBrowseButton<br />
    Pop $R0<br />
<br />
    ${If} $R0 == $DIGI.DestinationLocations.Button1<br />
<br />
    ${NSD_GetText} $DIGI.DestinationLocations.DirRequest1 $R0<br />
<br />
    nsDialogs::SelectFolderDialog /NOUNLOAD &quot;&quot; $R0<br />
    Pop $R0<br />
    <br />
        ${If} $R0 != error<br />
            ${NSD_SetText} $DIGI.DestinationLocations.DirRequest1 &quot;$R0&quot;<br />
        ${EndIf}<br />
    ${EndIf}<br />
FunctionEnd<br />
<br />
Function OnClick<br />
    Sleep 1000<br />
    Pop $0 # HWND<br />
    Call Controller<br />
FunctionEnd<br />
<br />
Function MPQCheckLeave<br />
    ${NSD_GetText} $DIGI.DestinationLocations.DirRequest1 $R0<br />
FunctionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>