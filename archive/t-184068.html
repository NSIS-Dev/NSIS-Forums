<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Dialer bug with windows 98, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Dialer bug with windows 98 NSIS Discussion" />
	
	<title> Dialer bug with windows 98 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Dialer bug with windows 98</div>
<hr />
<div class="pda"><a href="t-184068.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=184068">Dialer bug with windows 98</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">delboy</div><div class="date">21st June 2004, 13:52</div></div><div class="posttext">Or rather windows 98 bug ;) <br />
<br />
I'm writing a script which is making repeated calls to the dialer plugin, and so I decided to leave the dll loaded to be less of a resource hog.<br />
<br />
This works fine on 2000 and XP but on  windows 98 the dll seems to get in a flap. Specifically if I use the autodialonline function and later use the autodialhangup, then subsequent calls to autodialonline manage to create a connection but they return 'offline' (getconnectedstate is similarly broken after this).<br />
<br />
Having googled and searched around I cant find anyone else having this problem though i guess you all let the dll unload!<br />
Is there a simple work around / tweak to the dialer.dll that anyone already knows about or is unloading the only route for me?<br />
<br />
Cheers</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">21st June 2004, 14:35</div></div><div class="posttext">What Internet Explorer version do you have in your Win 98?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">delboy</div><div class="date">21st June 2004, 14:44</div></div><div class="posttext">Originally posted by deguix <br />
What Internet Explorer version do you have in your Win 98?  <br />
<br />
Its IE 5.0<br />
So its above the spec required... wininet does support the calls, but something gets confused somewhere.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">21st June 2004, 15:16</div></div><div class="posttext">From delboy:<br />
Specifically if I use the autodialonline function and later use the autodialhangup, then subsequent calls to autodialonline manage to create a connection but they return 'offline' (getconnectedstate is similarly broken after this).From MSDN:<br />
InternetAutodial does not support double-dial connections, SmartCard authentication, or connections that require registry-based certification.Does AutoDialHangup hang up correctly? Does GetConnectedState return &quot;online&quot; after you call AutoDialOnline for the second time?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">delboy</div><div class="date">21st June 2004, 15:39</div></div><div class="posttext">Heres a typical sequence.<br />
<br />
Call autodialonline - connection made and returns online<br />
call getconnectedstate - returns online<br />
call autodialhangup - returns success (and is successful!)<br />
call getconnectedstate - returns offline<br />
<br />
Call autodialonline - connection made BUT returns offline<br />
call getconnectedstate - returns offline (incorrectly)<br />
call autodialhangup - returns success (though connection still exists)<br />
call getconnectedstate - returns offline (though  connection still exists)<br />
<br />
Call autodialonline - connection is promted even though there is already an active one... hitting cancel OR connect results in 'offline' being returned.<br />
<br />
<br />
If i then unload the dll it all starts working again...<br />
<br />
very odd huh?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">delboy</div><div class="date">21st June 2004, 16:22</div></div><div class="posttext">oh and btw that self same sequence will behave itself on windows 2000 or xp. I think the double-dial connection thing quoted on msdn is where the modem has to make a call, connect to a machine then make another dial out to complete the connection.<br />
<br />
Its not that this shouldn't work, it should but its not doing! - i can attatch the script to make this sort of sequence if anyone has windows 98 and is interested!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">21st June 2004, 17:20</div></div><div class="posttext">It can be the time after you disconnect and before you connect again. Sometimes the Modem response is slow. Try to put a Sleep command between those. But I think it's not a NSIS problem, as by the source code of the plugin says.<br />
<br />
i can attatch the script to make this sort of sequence if anyone has windows 98 and is interested!Sorry, I have Win XP Home Edition.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">delboy</div><div class="date">21st June 2004, 18:34</div></div><div class="posttext">Thanks for thinking about it. I think you're right its certainly wininet.dll thats broken, but I guess unloading the dll seems to fix whatever problem there is and that'll have to do. <br />
Interesting problem though if anyone wants to know more about how broken 98 was!<br />
Cheers</div></div><hr />


<div class="post"><div class="posttop"><div class="username">delboy</div><div class="date">21st June 2004, 18:40</div></div><div class="posttext">sorry, just to clarify the sleeping doesnt help, wininet just starts going crazy if the dialer.dll doesnt get unloaded</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>