<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait for a VBScript, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait for a VBScript NSIS Discussion" />
	
	<title> ExecWait for a VBScript [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait for a VBScript</div>
<hr />
<div class="pda"><a href="t-289410.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289410">ExecWait for a VBScript</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jb53403</div><div class="date">31st March 2008, 21:49</div></div><div class="posttext">Hi all,<br />
<br />
I have a short VBScript that enables an Excel add-in, and it runs beautifully when I double-click the icon.  I want my NSIS-made installer to execute the VBS, but the it doesn't seem to be working.  What could be wrong?<br />
<br />
Below are the relevant lines of my NSIS script.<br />
<br />
Section<br />
   CreateDirectory &quot;C:\dir\&quot;<br />
   SetOutPath &quot;C:\dir\&quot;<br />
   File /r &quot;C:\dir\install_xla.vbs&quot;<br />
   File /r &quot;C:\dir\theExcelAddIn.xla&quot;<br />
   ExecWait &quot;C:\dir\install_xla.vbs&quot;<br />
SectionEnd<br />
<br />
Thanks for any help you can give!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">31st March 2008, 22:05</div></div><div class="posttext">If you don't need to wait, ExecShell would work, if not:<br />
<br />
ExecWait '&quot;$sysdir\wscript.exe&quot; &quot;C:\dir\install_xla.vbs&quot;' or something like that (.vbs is not a executable format, you need to invoke its script parser)<br />
<br />
Windows could be set to use the console version as the default, if you really want to have it behave as the host system no matter what, the UAC plugin has ExecShellWait (the default action could be to edit the script aswell, so it might not be the best option)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jb53403</div><div class="date">31st March 2008, 23:46</div></div><div class="posttext">Sweet, that's just what I needed to know!  Thanks for the help.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>