<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Version Information, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Version Information NSIS Discussion" />
	
	<title> Version Information [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Version Information</div>
<hr />
<div class="pda"><a href="t-357003.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=357003">Version Information</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Ctc1989</div><div class="date">8th March 2013, 14:51</div></div><div class="posttext">I am trying to grab the value of a user defined field from the Version tab in File Properties.  From searching, I have found VIAddVersionKey, which does the exact opposite of what I want.  Instead of setting these keys, is there any way to read them?  I know there is a plug-in for this (MoreInfo), but I am not allowed to use plug-ins, so I was hoping to do it within base NSIS.  Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">8th March 2013, 15:11</div></div><div class="posttext">The only native NSIS instruction is GetDllVersion and it only grabs the version number.<br />
<br />
You could call VerQueryValue and friends with the system plugin but that is a lot of work just to avoid a 3rd party plugin...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ctc1989</div><div class="date">8th March 2013, 16:33</div></div><div class="posttext">First time using a plug-in, I've downloaded and extracted the MoreInfo.zip, have moved MoreInfo.dll into C:\Program Files\NSIS\plugins, but don't see any .nsh files to move into C:\Program Files\NSIS\Include.  Am I missing something, or maybe my extract didn't work correctly?<br />
<br />
Also, is there a specific !include line I need to include in my .nsi file?  Thanks :winamp:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">8th March 2013, 21:07</div></div><div class="posttext">Not every plugin has a .nsh, the wiki or included readme should have examples...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ctc1989</div><div class="date">8th March 2013, 21:09</div></div><div class="posttext">Here's what I have right now that's not working:<br />
<br />
MoreInfo::GetUserDefined &quot;$INSTDIR\BEP.exe&quot; &quot;BuildLabel&quot;<br />
Pop $0<br />
MessageBox MB_OK $0<br />
<br />
MoreInfo.dll has been moved to plugin folder, no !includes up top, from what I've read what I have should output &quot;3.2.0.1&quot; in my messagebox, but a blank string is being displayed.  Any thoughts?  In all the threads containing &quot;MoreInfo&quot; everyone seems to get it working right away, too frustrating! :igor:<br />
<br />
Have gone through examples, my paths are correct, BuildLabel is correct,....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">9th March 2013, 01:49</div></div><div class="posttext">I know there is a plug-in for this (MoreInfo), but I am not allowed to use plug-ins, so I was hoping to do it within base NSIS.<br />
<br />
No plug-ins at all? Or no plug-ins that that don't ship with the &quot;official&quot; NSIS installer?<br />
<br />
In the former case will probably notice that your installer already is using plug-ins, because many (basic) things in NSIS need plug-ins. Especially if you use MUI or MUI2, you installer definitely does use plug-ins. And that's not a bad thing, it's simply how things work.<br />
<br />
In the second case, why not use plug-in that does exactly what you need? Trying to emulate the same thing with the System plug-in of NSIS is much more difficult and more error prone! I'd rather trust a third-party plug-in than reinvent the wheel.<br />
<br />
Anyway, if using third-party plug-ins isn't possible for whatever reason, writing your own plug-ins for NSIS isn't rocked science. If you already have a basic knowledge about C/C++ and you know how to use Visual Studio, you can probably implement it yourself in one hour. What you'd need is GerFileVersionInfo (GetFileVersionInfo) plus VerQueryValue (http://msdn.microsoft.com/en-us/library/windows/desktop/ms647464%28v=vs.85%29.aspx) and that's it.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>