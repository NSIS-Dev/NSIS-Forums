<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" DAO setup, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  DAO setup NSIS Discussion" />
	
	<title> DAO setup [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  DAO setup</div>
<hr />
<div class="pda"><a href="t-60554.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=60554">DAO setup</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ractive</div><div class="date">21st September 2001, 17:39</div></div><div class="posttext">Hi<br />
<br />
Does anyone have a nsi file that installs DAO?<br />
<br />
Plese let me know before I start reinventing the wheel ;) <br />
<br />
Regards<br />
<br />
James</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DuaneJeffers</div><div class="date">21st September 2001, 21:34</div></div><div class="posttext">It would help to know what DAO is. Then I would be able to help you. I have a whole bunch of NSI sources that I just keep to see how people do certain things with certain ways. And if it was a program that used NSIS, then I would know how they did it.<br />
<br />
-Duane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ractive</div><div class="date">25th September 2001, 00:36</div></div><div class="posttext">Hi Duane<br />
<br />
DAO stands for &quot;Data Access Object&quot; and is used by the MS Jet Database architecture.<br />
<br />
Installing DAO (a couple of DLLs) is not soo simple, cause it requires a lot of checking if there is already a version installed, what version, if you can update it, if DCOM is installed, etc. etc.<br />
<br />
Therefore I asked if someone already included this in his own installation procedure...<br />
<br />
Regards<br />
<br />
James</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DuaneJeffers</div><div class="date">25th September 2001, 03:44</div></div><div class="posttext">I'm sure they didn't include it, so you are on your own, but someone could come out later sayin' they did, so keep it open.<br />
<br />
-Duane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sealite</div><div class="date">6th February 2003, 11:03</div></div><div class="posttext">Hi,<br />
  I need DAO installation too, but I don't have the time to do it so I include the kit in NSIS and install it silently.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">6th February 2003, 20:23</div></div><div class="posttext">Installing DAO (a couple of DLLs) is not soo simple, cause it requires a lot of checking if there is already a version installed, what version, if you can update it, if DCOM is installed, etc. etc.<br />
 <br />
<br />
Yes, I think, as you wrote, installing DAO can be a hard work but not impossible....<br />
<br />
so we need to check if there is a pre-installed version, you can use:<br />
<br />
ReadRegStr for reading from the registry is there is a version.<br />
IfFileExists $SYSDIR\adaofile.dll , for example, if there are some files in the SYSTEM Directory<br />
<br />
Read the Chapter 3 of Nsis Users Manual for more properties of these and more instructions that you might need....<br />
http://nsis.sourceforge.net/Docs/<br />
<br />
Hope this help :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ategen</div><div class="date">23rd April 2003, 05:23</div></div><div class="posttext">I'm also interested in this.  I'm trying to make an install whose only requirements are win95 (or better) or WinNT 4.0 (or better).<br />
<br />
Here are the things I've picked up so far:<br />
<br />
- 50comupd.exe will update the common controls dll.  (A clean Win95 install doesn't have IE at all)<br />
<br />
- DCOM95 is needed at least on Win95.  Supposedly, you can check which version is previously install by the following registry key:<br />
HKEY_CLASSES_ROOT\CLSID\{bdc67890-4fc0-11d0-a805-00aa006d2ea4}\InstalledVersion<br />
which is in the format of a.b.c.d<br />
<br />
- MDAC_TYP can be used to install DAO (or is it ADO, I forget), but requires DCOM95.<br />
<br />
Ideally, I'm going to try to make my setup only require one reboot, but I'm not sure thats feasable.  Has anyone had any luck with any of these items?  I didn't see any other postings.<br />
<br />
If I have luck, I'll post my findings.<br />
<br />
Adam</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sealite</div><div class="date">23rd April 2003, 07:13</div></div><div class="posttext">At the present I use the following method for installing DAO components. I install IE55 for Win95 or IE60 for other OS. Then I install last version of MDAC, then JET4SP3, then JET4SP5.<br />
After this long (only if they are not already installed) processes we have an updated OS ready to run.<br />
<br />
The DAO installation kit provided by Microsoft is obsolete and it doen't work well on any platform. We already tested it and it is a bulls**t.<br />
<br />
We've made an smart kit that doen't include these components and it looks for them in the directory where the intaller is located and if it doesn't find them it will try to download them from the net.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ategen</div><div class="date">24th April 2003, 05:30</div></div><div class="posttext">I've attached the DAO 3.5 (Access 97 databases) install that I got working.  I made it into a .nsh file.<br />
<br />
I've included some of the sites I've found with (incomplete) information on them:<br />
<br />
http://www.peter3.com/Artiklar/DAO_manualinstall.htm<br />
<br />
http://support.microsoft.com/default.aspx?scid=http://support.microsoft.com:80/support/kb/articles/Q167/5/23.ASP&amp;NoWebContent=1<br />
<br />
http://support.microsoft.com/default.aspx?scid=http://support.microsoft.com:80/support/kb/articles/Q240/3/77.ASP&amp;NoWebContent=1<br />
<br />
http://support.microsoft.com/default.aspx?scid=http://support.microsoft.com:80/support/kb/articles/Q233/0/02.ASP&amp;NoWebContent=1<br />
<br />
Its possible I introduced a bug or too when cleaning up the code for this website.  Prior to that, I've tested it on a clean Win95 box, as well as a clean Win95OSR2, and a clean Win98 box.  Win98SE as well as WinXP and WinNT 4.0 testing should happen within the week.  (I don't have a copy of Win2K, sorry folks).<br />
<br />
Please post if you have any issues with the install.  I found that the easiest way to make an install (since MS docs seem to be lacking), is to:<br />
<br />
1) dir c:\ /s &gt; preinstall<br />
<br />
2) do an install of the DAO SDK (found on the first MSDEV disk, I think).<br />
<br />
3) dir c:\ /s &gt; postinstall<br />
<br />
4) do a diff on preinstall and postinstall</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ategen</div><div class="date">24th April 2003, 05:31</div></div><div class="posttext">Here is the Shared DLL header that will be needed</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ategen</div><div class="date">24th April 2003, 05:32</div></div><div class="posttext">And an example file.  Unfortunately, a zip file with the actual dao files (2MB) exceeds my posting limit of 1MB.  Sorry about that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sealite</div><div class="date">24th April 2003, 06:15</div></div><div class="posttext">From my experience with DAO installation (over 5 years) I've come to this conclusion: The BEST way to install DAO is to install LAST version of:<br />
- DCOM (included in IE)<br />
- MDAC 2.7<br />
- JET 4.0 SP3<br />
- JET 4.0 SP5 (requires SP3)<br />
<br />
No other way can guarantee to a good working installation, especially if you want Jet 4.0 (Access 2000 and XP support).<br />
<br />
I recommend you to check the presense in the main kit and put the installation files outside the kit. You can also add the download options from your web site if they do not have one ore more components.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ategen</div><div class="date">24th April 2003, 06:44</div></div><div class="posttext">I used standard MFC classes in MSVC 6.0 (SP5) to do database access in the particular application I'm installing.  To the best of my knowledge, I need JET 3.5 for this and jet 4.0+ will not work.<br />
<br />
Any ideas why MSVC 6.0 (and its corresponding MFC libs) work this way?<br />
<br />
Adam</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sealite</div><div class="date">24th April 2003, 06:49</div></div><div class="posttext">It's Microsoft way ! But you can make it work with jet 4.0 if you do a trick in VC6 (In VC7 you don't need it).<br />
It's something with Afx... set version of MFC to 0x0601 i thik. You should do this at runtime. You'll find the line on the web or at microsoft's knowledge base.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ska_milano77</div><div class="date">12th November 2008, 10:56</div></div><div class="posttext">Does anyone have a nsh file (with related instruction) to installa JET 4.0 and Dao 3.6?<br />
<br />
The ategen's sample is very useful, but I need it for DAO 3.6 instead of 3.5<br />
<br />
Any help would be appreciated.<br />
Bye all</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>