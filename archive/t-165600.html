<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS System Plugin, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS System Plugin NSIS Discussion" />
	
	<title> NSIS System Plugin [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS System Plugin</div>
<hr />
<div class="pda"><a href="t-165600.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=165600">NSIS System Plugin</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Damien_Inferno</div><div class="date">19th January 2004, 11:10</div></div><div class="posttext">Hi there,<br />
<br />
I need some help on a probably simple issue. I am using the NSIS system plugin to get info about the users disk space. <br />
<br />
In the example system.nsi i found a function that displays the users diskspace in a pop-up window. I want that information to be put in a .txt-file.<br />
<br />
this is code for the popup window:<br />
<br />
    System::Call '${sysMessageBox}($HWNDPARENT, s, &quot;System Example 2&quot;, ${MB_OKCANCEL})' &quot;$7&quot;<br />
<br />
I have read the helpfile from the system plugin, but i can't follow it. can someone enlighten me?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">19th January 2004, 12:56</div></div><div class="posttext">i guess $7 is the variable storing the disk space info. you can use the file instructions (http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.5) to put that in a .txt file (there's an example either with nsis or in the archive)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Damien_Inferno</div><div class="date">19th January 2004, 13:07</div></div><div class="posttext">Thanks,<br />
<br />
yes, i figured that out too... the only thing is that &quot;$7&quot; contains more data than i need. i just want to know the free space on c:\ <br />
<br />
&quot;$7&quot; contains a string which is designed to fit into a &quot;scheme&quot;, therefore it is &quot;polluted&quot; with lots of spaces.<br />
Is there a string-command to remove spaces?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">blayde</div><div class="date">19th January 2004, 13:18</div></div><div class="posttext">Using StrCpy to trim the string might be a start.  you might also find the function StrStr usefull, for searching for one string within another.<br />
<br />
both are in the NSIS Documentation</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Damien_Inferno</div><div class="date">19th January 2004, 14:06</div></div><div class="posttext">thanx guys, you helped me out</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">19th January 2004, 22:24</div></div><div class="posttext">look between ;------ lines<br />
<br />
     ; Memory for paths   <br />
     System::Alloc 1024<br />
     Pop $1<br />
     ; Get drives   <br />
     System::Call '${sysGetLogicalDriveStrings}(1024, r1)'<br />
enumok:<br />
     ; One more drive?   <br />
     System::Call '${syslstrlen}(i r1) .r2'<br />
     IntCmp $2 0 enumex<br />
<br />
     ; Is it DRIVE_FIXED?<br />
     System::Call '${sysGetDriveType} (i r1) .r3'<br />
     StrCmp $3 ${DRIVE_FIXED} 0 enumnext<br />
<br />
     ; Drive space   <br />
     System::Call '${sysGetDiskFreeSpaceEx}(i r1, .r3, .r4, .r5)'<br />
<br />
     ; Get pretty drive path string   <br />
     System::Call '*$1(&amp;t1024 .r6)'<br />
<br />
; -------------------------------------------<br />
; here $6 - drive path, <br />
; $3 - full disk space in bytes<br />
; $4 - free disk space in bytes<br />
; -------------------------------------------<br />
<br />
enumnext:<br />
     ; Next drive path       <br />
     IntOp $1 $1 + $2<br />
     IntOp $1 $1 + 1<br />
     goto enumok   <br />
enumex: ; End of drives or user cancel<br />
     ; Free memory for paths   <br />
     System::Free $1</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>