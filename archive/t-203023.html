<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to read regvalue ant to set sections parametrs, based on it, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to read regvalue ant to set sections parametrs, based on it NSIS Discussion" />
	
	<title> How to read regvalue ant to set sections parametrs, based on it [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to read regvalue ant to set sections parametrs, based on it</div>
<hr />
<div class="pda"><a href="t-203023.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=203023">How to read regvalue ant to set sections parametrs, based on it</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Dkom</div><div class="date">25th December 2004, 13:39</div></div><div class="posttext">If I install over previous version - I want to make one section readonly (or invisible).<br />
If it's clean install - user can check/unckeck this section.<br />
<br />
So I think, that it is possible to read some registry value: if it presents - the section becomes readonly (or invisible). If not - this section looks like others.<br />
<br />
But I don't now, how to do this. For example:<br />
<br />
Section &quot;some_name&quot; Sec01<br />
...some_commands<br />
ReadRegDWORD $R3 ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;somevalue&quot;<br />
StrCmp $R3 &quot;1&quot; yes no<br />
yes:<br />
StrCpy $R4 &quot;-blablabla&quot;<br />
goto q<br />
no:<br />
StrCpy $R4 &quot;blablabla&quot;<br />
q:<br />
SectionEnd<br />
<br />
Section /o $R4 SEC02<br />
...<br />
some_commands<br />
SectionEnd<br />
<br />
But it doesn't work. Checkbox always visible, and section name invisible.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th December 2004, 15:33</div></div><div class="posttext">Use SectionSetText.<br />
Or you can use the Section macro's in Sections.nsh if you need them.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Dkom</div><div class="date">25th December 2004, 18:28</div></div><div class="posttext">Maybe it's not difficult but I can't understand how to apply SectionSetText to section.<br />
When I use<br />
Section /o &quot;Name&quot; SEC02<br />
SectionSetText &quot;SEC02&quot; &quot;&quot; (&quot;&quot; - to make section invisible)<br />
some_commands<br />
SectionEnd<br />
nothing hapens. Maybe it's because of Modern UI?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">26th December 2004, 02:12</div></div><div class="posttext">SectionSetText ${SEC02} ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Dkom</div><div class="date">26th December 2004, 08:02</div></div><div class="posttext">Nothing again. When I put SectionSetText ${SEC02} &quot;&quot; in .onInit it shows &quot;unknown variable/constant &quot;{SEC02}&quot; detected, ignoring&quot; and section SEC01 is invisible (but not SEC02).<br />
Another interesting thing: when I write<br />
Section &quot;&quot; SEC02 - it's invisible<br />
but when I write <br />
Function .onInit<br />
StrCpy $0 &quot;&quot;<br />
...<br />
FunctionEnd<br />
Section &quot;$0&quot; SEC02 - checkbox always visible<br />
<br />
Here is my script http://www.046*****~komarov/script.zip  How to make section SEC02 invisible (to read regkey, if it is =1 then invisible, if it's not present - then visible).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">26th December 2004, 10:43</div></div><div class="posttext">Ìîæåò ïî-ðóññêè íàïèñàòü? :) My English is terrible. :D<br />
<br />
Try to insert .onInit-function after sections declaration.<br />
<br />
Maybe this example helps you.<br />
<br />
<br />
ClearErrors<br />
ReadRegStr $0 HKLM &quot;Your Software&quot; &quot;your key&quot;<br />
IfErrors hide 0<br />
strcmp $0 1 hide good<br />
hide:<br />
SectionSetText ${SEC02} &quot;&quot;<br />
; ... another action when hide section<br />
good:<br />
<br />
<br />
But I can mistake (ìåñòàìè). ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Dkom</div><div class="date">26th December 2004, 18:11</div></div><div class="posttext">To glory_man (in Russian)<br />
Äà,äîáàâëåíèå onInit ïîñëå ñàìèõ ñåêöèé ïîìîãëî. À êàê ðàñïîëîæåíèå onInit ìîæåò ïîâëèÿòü íà ðàáîòó èíñòàëëÿòîðà (äî èëè ïîñëå îïèñàíèÿ ñåêöèé)?. À îáÿçÿòåëüíî ñòàâèòü <br />
ClearErrors è IfErrors. Â òâîåì æå ïðèìåðå îí âñåãäà çàïðåùàåò ñåêöèþ (åñëè êëþ÷à íåò, çíà÷èò áóäåò error-&gt;hide åñëè åñòü - òî 1 è îïÿòü hide. Ó ìåíÿ êëþ÷ åñëè åñòü, òî îí âñåãäà 1 èëè åãî âîîáùå íåò, òàê ÷òî âðîäå ðàáîòàåò è áåç ClearErrors è IfErrors.<br />
<br />
To others: I moved Function .onInit after all sections, and this one works:<br />
<br />
Section &quot;name&quot; SEC01<br />
...some commands<br />
SectionEnd<br />
Section &quot;Name2&quot; SEC02<br />
...some commands<br />
SectionEnd<br />
Function on.Init<br />
...some commands<br />
ReadRegDword $9 ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;NoModify&quot;<br />
StrCmp $9 &quot;1&quot; not_visible visible<br />
not_visible:<br />
SectionSetText ${SEC02} &quot;&quot;<br />
visible:<br />
FunctionEnd<br />
<br />
Thanks to all. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">27th December 2004, 19:11</div></div><div class="posttext">To Dkom (in Russian).<br />
Âîîáùå òî, íàâåðíîå, áîëåå ïðàâèëüíî èñïîëüçîâàòü ôëàã îøèáêè äëÿ ïåðåõîäà. Ò.å. åñëè êëþ÷ îòñóòñâóåò, òî ïðè åãî ÷òåíèè óñòàíîâèñòÿ ýòîò ôëàã. À åñëè êëþ÷ åñòü, è íå íóæíî çíàòü åãî çíà÷åíèå, òî äåëàé ïåðåõîä. Õîòÿ âîçìîæíî ýòî è âñå ðàâíî. Âåäü åñëè êëþ÷à íåò, òî ïåðåìåííîé ïðèñâîèòñÿ çíà÷åíèå &quot;&quot;.<br />
È äåëî â ðàñïîëîæåíèè ñåêöèé, à íå ôóíêöèè. Ïî-ìîåìó.<br />
È, íàâåðíîå, ëó÷øå ïèñàòü ïî àíãëèéñêè - àòî íå ïîéìóò.<br />
<br />
Dkom asked - How onInit placement influences istallation-programm work. I think the problem is in section placement but not in .onInit function placement. As at sections description the announcement and giving of a section_index_ouput is made. Therefore at compilation of the project all over again it is necessary to define these variables (section_index_ouputis) and then use them.<br />
<br />
Am I right? (old Users).<br />
<br />
Sorry my English.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">28th December 2004, 07:22</div></div><div class="posttext">Î, áëÿ, ðóññêèå êîðåøà. ß óæ äóìàë ìû òóò ñ Takhir'îì îäíè.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">29th December 2004, 13:35</div></div><div class="posttext">Íàñ ìàëî, íî ìû â òåëüíÿøêàõ :D.<br />
<br />
È âñå-òàêè ïðàâ ÿ èëè íåò â ñâîåì ïðåäûäóùåì ïîñòå.<br />
<br />
Old users - where are you?<br />
Look my previous post. Am I right?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>