<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to get JRE version using NSIS?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to get JRE version using NSIS? NSIS Discussion" />
	
	<title> How to get JRE version using NSIS? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to get JRE version using NSIS?</div>
<hr />
<div class="pda"><a href="t-363640.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=363640">How to get JRE version using NSIS?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ilaiyaraja</div><div class="date">13th June 2013, 07:27</div></div><div class="posttext">ReadRegStr $2 HKLM &quot;SOFTWARE\JavaSoft\Java Runtime Environment&quot; &quot;CurrentVersion&quot;<br />
 DetailPrint $2<br />
<br />
It will display which version only.that is either 1.6 or 1.7.<br />
<br />
But i want to display which version jre1.6.that is 1.6.0_33.I need this version.<br />
<br />
How to get this version from register key?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">13th June 2013, 08:52</div></div><div class="posttext">You can use string value Java6FamilyVersion  which contains exactly 1.6.0_33.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ilaiyaraja</div><div class="date">13th June 2013, 10:50</div></div><div class="posttext">Thanks slappy.yes.its working fine.but the problem occurs following situation:<br />
If i installed two jre versions(like 32,36) then familyverision will display higher versions only(36).but in the same time registry will take 32 version.because regedit view sequence order.so there is a mismatch occur.<br />
<br />
How to take specific version of JRE?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">13th June 2013, 14:57</div></div><div class="posttext">I've made a small script a while back that may or may not be of use to you, depending on your final goal. The script checks if the machine has the latest available JRE installed.<br />
OutFile &quot;JREchk.exe&quot;<br />
Caption &quot;JREchk&quot;<br />
RequestExecutionLevel User<br />
!include TextFunc.nsh<br />
<br />
        Function .onInit<br />
ReadRegStr $R0 HKLM &quot;SOFTWARE\JavaSoft\Java Runtime Environment&quot; &quot;CurrentVersion&quot;<br />
IfErrors 0 CheckLatestJRE<br />
SetRegView 64<br />
ReadRegStr $R0 HKLM &quot;SOFTWARE\JavaSoft\Java Runtime Environment&quot; &quot;CurrentVersion&quot;<br />
IfErrors 0 CheckLatestJRE<br />
MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION|MB_TOPMOST &quot;Java Runtime Environment is not installed.$\nYou will now be taken to the download page.&quot; IDOK DlPage IDCANCEL Exit<br />
CheckLatestJRE:<br />
inetc::get /silent &quot;http://java.com/applet/JreCurrentVersion2.txt&quot; &quot;$PLUGINSDIR\JREchk.tmp&quot; /end<br />
Pop $0<br />
StrCmp $0 &quot;OK&quot; +2<br />
MessageBox MB_RETRYCANCEL|MB_ICONSTOP|MB_TOPMOST &quot;Error checking java.com for latest JRE version.$\nMake sure that Internet connection is available.&quot; IDRETRY CheckLatestJRE IDCANCEL Exit<br />
FileOpen $R0 &quot;$PLUGINSDIR\JREchk.tmp&quot; &quot;r&quot;<br />
IfErrors VerChkError<br />
FileRead $R0 $0<br />
FileClose $R0<br />
IfErrors VerChkError<br />
StrCmp $0 &quot;&quot; VerChkError<br />
${TrimNewLines} &quot;$0&quot; $0<br />
ReadRegStr $R0 HKLM &quot;SOFTWARE\JavaSoft\Java Runtime Environment\$0&quot; &quot;JavaHome&quot;<br />
IfErrors 0 +2<br />
MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION|MB_TOPMOST &quot;You do not have the latest version of Java Runtime Environment installed.$\nYou will now be taken to the download page.&quot; IDOK DlPage IDCANCEL Exit<br />
MessageBox MB_OK|MB_ICONINFORMATION|MB_TOPMOST &quot;You have the latest version of Java Runtime Environment installed ($0).&quot; IDOK Exit<br />
VerChkError:<br />
MessageBox MB_OK|MB_ICONSTOP|MB_TOPMOST &quot;Unable to check for latest JRE version.&quot; IDOK Exit<br />
DlPage:<br />
ExecShell &quot;open&quot; &quot;http://java.com/en/download/index.jsp&quot;<br />
Exit:<br />
Abort<br />
FunctionEnd<br />
<br />
Section Blank<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">13th June 2013, 17:14</div></div><div class="posttext">Sorry, I guess I was distracted while reading the thread, it is now clear what you want.<br />
Checking HKLM\SOFTWARE\JavaSoft\Java Runtime Environment\1.6.0_33\JavaHome will tell you if 1.6.0_33 is installed or not, regardless of whether other versions are installed.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>