<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" reservfile extraction to certain dir..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  reservfile extraction to certain dir... NSIS Discussion" />
	
	<title> reservfile extraction to certain dir... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  reservfile extraction to certain dir...</div>
<hr />
<div class="pda"><a href="t-152494.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=152494">reservfile extraction to certain dir...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">atsuk</div><div class="date">13th October 2003, 18:07</div></div><div class="posttext">situation:<br />
ReserveFile &quot;file.ini&quot; extracts file to the uncertain $TEMP subdirectory, now it extracted it to $TEMP\nsy67.tmp\file.ini . But i need it to write a variable afther .oninit to file.ini. So how could i extract it to $TEMP?<br />
i tried in .oninit  function<br />
SetOutPath $TEMP<br />
File &quot;${INSTALLER}\file.ini&quot;<br />
, but guess, that it's no use?<br />
could you suggest something? tnx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th October 2003, 18:44</div></div><div class="posttext">File &quot;/oname=$TEMP\file.ini&quot; &quot;file.ini&quot;<br />
That's if file.ini is located in the same directory that contains your nsi script.<br />
<br />
If file.nsi is elsewhere, say in the NSIS dir, use:<br />
File &quot;/oname=$TEMP\file.ini&quot; &quot;${NSISDIR}\file.ini&quot;<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th October 2003, 19:14</div></div><div class="posttext">ReserveFile does not extract a file.<br />
<br />
Can you please give more details about what you are trying to do?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">atsuk</div><div class="date">13th October 2003, 20:05</div></div><div class="posttext">ok...oninit funciton calls function, that writes HD names into variables...Afther that i want to write those variables to ini file(as a state), witch is used in custompage. Those HD names will be used in directory selection on custompage.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th October 2003, 20:11</div></div><div class="posttext">Personally, I don't use ReserveFile (I've never used it before).<br />
I simply extract my ini file to the $TEMP dir, then call the dialog straight from there.<br />
I can easily write to it and read from it (WriteINIStr and ReadINIStr) because I know exactly where it is.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">atsuk</div><div class="date">13th October 2003, 20:15</div></div><div class="posttext">a part of script that is involved with file.ini<br />
ReserveFile &quot;file.ini&quot;<br />
Function .onInit<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;file.ini&quot;<br />
Call kettad ;detects HD names and puts them inot variables<br />
FunctionEnd<br />
Function SetVinstall<br />
  !insertmacro MUI_HEADER_TEXT &quot;&quot; &quot;choose dir&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;file.ini&quot;<br />
FunctionEnd<br />
(in function kettad:<br />
  WriteINIStr &quot;file.ini&quot;  &quot;Field 4&quot; &quot;State&quot; &quot;${KETAS1}TRPvk-d&quot; ;output is i.e. c:\TRPvk-d)<br />
;custompage function has theese lines:<br />
!insertmacro MUI_INSTALLOPTIONS_READ $4 &quot;file.ini&quot; &quot;Field 4&quot; &quot;State&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_READ $5 &quot;file.ini&quot; &quot;Field 6&quot; &quot;State&quot;<br />
...ok..hope you got what i'm doing<br />
(i got this whole thing working, when i tried to write &quot;${KETAS1}TRPvk-d&quot; into $TEMP\testfile.ini, but not when tried to write in file.ini, that is extracted)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">atsuk</div><div class="date">13th October 2003, 20:18</div></div><div class="posttext">-&gt;Afrow UK<br />
ok, but does it do all that ReserveFile MUI_INSTALLOPTIONS_EXTRACT do? or is there some particular reasons to use them?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th October 2003, 20:20</div></div><div class="posttext">If you have any File commands in sections above your .onInit function, put ReserveFile above the sections if you are using BZIP2 compression.<br />
<br />
It will make your installer start faster, that's all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">atsuk</div><div class="date">13th October 2003, 20:36</div></div><div class="posttext">1.) i don't use BZIP2 compression(what are the advantages?)<br />
2.) when i used :<br />
SetOutPath $TEMP<br />
File &quot;file.ini&quot;<br />
#loading of custompage failed while trying just file instead of reserve and extract <br />
Function SetVinstall<br />
!insertmacro MUI_HEADER_TEXT &quot;text&quot; &quot;choose dir&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;$TEMP\file.ini&quot;<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th October 2003, 20:54</div></div><div class="posttext">It not using BZIP2 compression, you don't have to use ReserveFile.<br />
<br />
Of course, you should still use MUI_INSTALLOPTIONS_EXTRACT (and not $TEMP).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">atsuk</div><div class="date">13th October 2003, 20:58</div></div><div class="posttext">ok, but how to tell installer to extract file to temp dir?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th October 2003, 21:24</div></div><div class="posttext">The Modern UI InstallOptions macros automatically use a unique temporary directory.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">atsuk</div><div class="date">14th October 2003, 05:44</div></div><div class="posttext">jeah, that's the problem, that it uses a unique temporary dir in $TEMP directory, but i really need to know where this file is, because i need to write into ini file a variable.<br />
maybe there is a way to detect this dir and put dir into variable, so i know where is this file located during installation, if i don't konw exactly where it is, i can't write anything into it. and if i use this line:<br />
WriteINIStr &quot;file.ini&quot; &quot;Field 4&quot; &quot;State&quot; &quot;${KETAS1}TRPvk-d&quot; ;it CREATES file.ini to the $WINDIR ($WINDIR\file.ini and DOESN'T ADD text to the file.ini in unique temp.dir as i would like) and the text in it is c:\TRPvk-d).<br />
i hope you got my problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th October 2003, 13:49</div></div><div class="posttext">You should use the MUI_INSTALLOPTIONS_WRITE macro. See the examples &amp; Readme.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">atsuk</div><div class="date">14th October 2003, 20:06</div></div><div class="posttext">tnx:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dëëjayz</div><div class="date">27th October 2003, 18:26</div></div><div class="posttext">Use $PLUGINSDIR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dëëjayz</div><div class="date">27th October 2003, 19:05</div></div><div class="posttext">I got another problem with ReserveFile<br />
<br />
When I use some files within the same dir as my nsi file it work great! Ex:<br />
<br />
ReserveFile &quot;Client.ini&quot;<br />
!insertmacro MUI_RESERVEFILE_INSTALLOPTIONS<br />
<br />
.<br />
.<br />
.<br />
<br />
Function .onInit <br />
!insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;Client.ini&quot;<br />
FunctionEnd<br />
<br />
For not having all the files in the same dir, I put only the nsi file in the &quot;root&quot; dir and all the other files in &quot;root\Include&quot; dir. Ex:<br />
<br />
ReserveFile &quot;Include\Client.ini&quot;<br />
!insertmacro MUI_RESERVEFILE_INSTALLOPTIONS<br />
<br />
.<br />
.<br />
.<br />
<br />
Function .onInit <br />
!insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;Include\Client.ini&quot;<br />
FunctionEnd<br />
<br />
This is compiling great, but when running it never find the file &quot;$PLUGINSDIR\Client.ini&quot; or $PLUGINSDIR\Include\Client.ini&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">27th October 2003, 20:59</div></div><div class="posttext">Use MUI_INSTALLOPTIONS_EXTRACT_AS (see Modern UI Readme).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dëëjayz</div><div class="date">27th October 2003, 21:10</div></div><div class="posttext">Thx It is working perfectly!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>