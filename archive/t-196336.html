<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Does WriteINIStr command work on Win98???, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Does WriteINIStr command work on Win98??? NSIS Discussion" />
	
	<title> Does WriteINIStr command work on Win98??? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Does WriteINIStr command work on Win98???</div>
<hr />
<div class="pda"><a href="t-196336.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=196336">Does WriteINIStr command work on Win98???</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">11th October 2004, 19:48</div></div><div class="posttext">I was using the WriteINIStr command to add some text to an ini file on my Win2k machine.  It was working great.  However, when I tested my installer on a Win98 PC, the WriteINIStr command did absolutely nothing.  In fact, it seems to prevent the next 1 or 2 commands from working.  Here is the code:<br />
<br />
WriteINIStr &quot;$INSTDIR\ULogs\ULog.ini&quot; &quot;Info&quot; &quot;bla bla&quot; &quot;1&quot;<br />
Delete &quot;$INSTDIR\ULogs\$ULogLM&quot;<br />
Rename &quot;$INSTDIR\ULogs\ULog.ini&quot; &quot;$ULogLM&quot;<br />
<br />
The Rename command would rename the ini into the ULogLM string, but would leave the Ulog.ini file, as if it was locked by the failing WriteINIStr command.  Any ideas?<br />
<br />
Thanks much all!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scully13</div><div class="date">11th October 2004, 19:54</div></div><div class="posttext">If you are copying the ULog.ini file from a CD make sure you remove it's read-only attribute before you use WriteINIStr.  Win98 makes files read-only when they are copied from a CD.  If you are not copying the file from a CD then ignore me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">11th October 2004, 20:08</div></div><div class="posttext">Not copying from a CD, and double checked the files, they are not read only, but thank you very much for the advice. When I comment out the WriteINIStr line, everything works fine, so I think it has something to do with the WriteINIStr command and Win98.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th October 2004, 20:11</div></div><div class="posttext">Maybe try FlushINI first.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">11th October 2004, 20:38</div></div><div class="posttext">Thanks Afrow UK, should I put the FlushINI command right before, or right after the WriteINIStr command?  Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th October 2004, 21:10</div></div><div class="posttext">Right after WriteINIStr.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">11th October 2004, 21:58</div></div><div class="posttext">Nope, no luck with the FlushINI as far as actually writing to the ini, however the next commands (Delete and Rename) do work now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">11th October 2004, 22:39</div></div><div class="posttext">Every change you do to an INI file will only be updated when you use &quot;FlushINI&quot; (on Win9x). So if you write something to the INI file and you want to read it correctly you should use &quot;FlushINI&quot; before reading, deleting or renaming an INI file.<br />
<br />
Logically, if you try to open an INI file after writting and before flushing it, you'll see that the INI file didn't change at all.<br />
<br />
This sometimes should be looked as a feature, because with this you don't need to backup the file -&gt; even when you try to write, you can still read the intact old version...:)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>