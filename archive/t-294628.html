<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" easiest way to share info between installer and uninstaller?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  easiest way to share info between installer and uninstaller? NSIS Discussion" />
	
	<title> easiest way to share info between installer and uninstaller? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  easiest way to share info between installer and uninstaller?</div>
<hr />
<div class="pda"><a href="t-294628.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=294628">easiest way to share info between installer and uninstaller?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">patelb</div><div class="date">16th July 2008, 18:55</div></div><div class="posttext">Im building an installer for a web application.  This installer will be used for many of our different web applications because there installed the same way.  Everytime the user installs one of our web apps it will add another entry in the add/remove programs in the control panel.  So in the install i have these lines:<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\mysoftwarecompany$appName&quot; &quot;DisplayName&quot; &quot;GeoPrise Shell - $appName&quot;<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\mysoftwarecompany$appName&quot; &quot;UninstallString&quot; &quot;$INSTDIR\$appname\uninstall.exe&quot;<br />
<br />
$appName is the name of application they are installing, its set by the user during installation.<br />
<br />
During uninstall I have to call a vbs script that removes the application from IIS(web server).  That script needs to know the name of the application(the value of $appName).  I also have to delete the registry keys for the application and in order to do that I need to know the value of $appName again.  So I thought I would just write a .nsh file with these commands and then just include them in the unistaller.  But that would require me to create a .nsh file for each web app.  Any ideas of how I can get the application name in the uninstaller?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">16th July 2008, 19:08</div></div><div class="posttext">you already know what $appName is in the installer, is the source of this value not just a define or something that will work in the installer aswell?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">patelb</div><div class="date">16th July 2008, 19:15</div></div><div class="posttext">$appName is set by the user during the install.  They are prompted to enter an application name that will be used to create the virtual directories and such.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">patelb</div><div class="date">16th July 2008, 19:55</div></div><div class="posttext">Nevermind, I figured it out.  I took the low tech way and just wrote the application name to a file and then read from it during uninstall.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>