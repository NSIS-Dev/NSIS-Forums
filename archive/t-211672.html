<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Multiple Users &amp; Registry, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Multiple Users &amp; Registry NSIS Discussion" />
	
	<title> Multiple Users &amp; Registry [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Multiple Users &amp; Registry</div>
<hr />
<div class="pda"><a href="t-211672.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=211672">Multiple Users &amp; Registry</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">gruntz</div><div class="date">29th March 2005, 11:04</div></div><div class="posttext">Hello there,<br />
<br />
I'm currently writing an installer for an application which is used by only one user, called &quot;info&quot;.<br />
<br />
Since I have some tools and batch scripts which are placed in HKLM / ... / Run (Autorun for all users), I have to start the<br />
installer with admin rights with &quot;Run as&quot;. The installer detects if the current user (&quot;info&quot; for example, has no admin rights!) has no admin rights and aborts the execution.<br />
<br />
Now my problem: I need to add the main application in the user autostart in registry, but just for user &quot;info&quot;! <br />
<br />
The &quot;admin&quot; acount only has the HKLM / ... / Run tools &amp; scripts.<br />
<br />
The user &quot;info&quot; should have some additional things like start menu entries (main app, uninstall etc.).<br />
<br />
How can I achieve to write to different user acounts in registry?<br />
SetShellVarContext won't help me :-(<br />
<br />
Any ideas?<br />
<br />
Thanks,<br />
Gruntz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th March 2005, 20:22</div></div><div class="posttext">This thread (http://forums.winamp.com/showthread.php?s=&amp;threadid=206484&amp;highlight=user+admin) seems to have a partial solution to the problem. You can make the registering executable just exit without setting anything if the user is not &quot;info&quot;.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>