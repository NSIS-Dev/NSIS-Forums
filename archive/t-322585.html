<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with language, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with language NSIS Discussion" />
	
	<title> Problem with language [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with language</div>
<hr />
<div class="pda"><a href="t-322585.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322585">Problem with language</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">need_a_help</div><div class="date">20th September 2010, 20:32</div></div><div class="posttext">Hello everybody,<br />
<br />
I start build my install program and I have little problem when i want add language. I have message that I must put UMUI_MULTILANG_GET. So I add this value after another function, but now I have error that I have two the same Function .onInit Can someone help me? I change value to !system 'echo but not work ;/<br />
<br />
Ps. Can I add registry option which find add and next time find key language?<br />
<br />
Regards,<br />
Lukas<br />
<br />
;NSIS Ultra Modern User Interface<br />
;Basic Example Script<br />
;Originally Written by Joost Verburg<br />
;--------------------------------<br />
<br />
!system 'echo !insertmacro UMUI_MULTILANG_GET &gt; $%TEMP%\descs.nsh' <br />
<br />
Name &quot;AdvSplash.dll test&quot;<br />
<br />
OutFile &quot;AdvSplash Test.exe&quot;<br />
<br />
XPStyle on<br />
<br />
Function .onInit<br />
        # the plugins dir is automatically deleted when the installer exits<br />
        InitPluginsDir<br />
        File /oname=$PLUGINSDIR\splash.bmp &quot;c:\screen1600.bmp&quot;<br />
        #optional<br />
        #File /oname=$PLUGINSDIR\splash.wav &quot;C:\myprog\sound.wav&quot;<br />
<br />
        advsplash::show 2500 600 400 -1 $PLUGINSDIR\splash<br />
<br />
        Pop $0          ; $0 has '1' if the user closed the splash screen early,<br />
                        ; '0' if everything closed normally, and '-1' if some error occurred.<br />
<br />
        Delete $PLUGINSDIR\splash.bmp<br />
FunctionEnd<br />
<br />
<br />
<br />
Section<br />
SectionEnd<br />
;--------------------------------<br />
;General<br />
<br />
  ;Name and file<br />
  Name &quot;Test&quot;<br />
  OutFile &quot;1_test.exe&quot;<br />
!define PRODUCT_VERSION &quot;1.0&quot;<br />
!define PRODUCT_PUBLISHER &quot;Lukas&quot;<br />
!define PRODUCT_WEB_SITE &quot;http://www.&quot;<br />
<br />
<br />
  ;Default installation folder<br />
  InstallDir &quot;c:\Game\&quot;<br />
  <br />
  ;Get installation folder from registry if available<br />
  InstallDirRegKey HKLM &quot;Software\Game\Lukas&quot; &quot;Install Dir&quot; <br />
<br />
  <br />
;--------------------------------<br />
;Include ******odernUI<br />
<br />
  !include &quot;UMUI.nsh&quot;<br />
;  !include &quot;MUIEx.nsh&quot;<br />
<br />
;--------------------------------<br />
;Interface Settings<br />
<br />
 !define UMUI_SKIN &quot;gray2&quot;<br />
 !define UMUI_BGSKIN &quot;blue&quot;<br />
 <br />
 !define UMUI_USE_INSTALLOPTIONSEX<br />
 <br />
 !define MUI_ABORTWARNING<br />
 !define MUI_UNABORTWARNING<br />
 <br />
    !define UMUI_PAGEBGIMAGE<br />
    !define UMUI_UNPAGEBGIMAGE<br />
    <br />
;--------------------------------<br />
;Pages<br />
<br />
  !insertmacro UMUI_PAGE_MULTILANGUAGE<br />
  !insertmacro MUI_PAGE_WELCOME<br />
  !define UMUI_INFORMATIONPAGE_USE_RICHTEXTFORMAT<br />
  !insertmacro UMUI_PAGE_INFORMATION &quot;${NSISDIR}\Docs\******odernUI\new1045.txt&quot;<br />
;  !insertmacro UMUI_PAGE_INFORMATION &quot;${NSISDIR}\Docs\******odernUI\License.txt&quot;<br />
  !insertmacro MUI_PAGE_LICENSE &quot;c:\Licencja.txt&quot;<br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
 <br />
<br />
;--------------------------------<br />
;Languages<br />
 <br />
 ; first language is the default language if the system language is not in this list<br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
; Other UMUI translated languages<br />
  !insertmacro MUI_LANGUAGE &quot;Polish&quot;<br />
<br />
;--------------------------------<br />
;Installer Sections<br />
<br />
Section &quot;Dummy Section&quot; SecDummy<br />
<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  <br />
  ;ADD YOUR OWN FILES HERE...<br />
  <br />
  ;Store installation folder<br />
  WriteRegStr HKCU &quot;Software\Modern UI Test&quot; &quot;&quot; $INSTDIR<br />
  <br />
  ;Create uninstaller<br />
  WriteUninstaller &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
SectionEnd<br />
<br />
;--------------------------------<br />
;Descriptions<br />
<br />
  LangString FILE ${LANG_ENGLISH} &quot;English.txt&quot;<br />
LangString FILE ${LANG_Polish} &quot;Polish.txt&quot;<br />
!insertmacro UMUI_PAGE_INFORMATION &quot;${FILE}&quot;<br />
<br />
;--------------------------------<br />
;Uninstaller Section<br />
<br />
Section &quot;Uninstall&quot;<br />
<br />
  ;ADD YOUR OWN FILES HERE...<br />
<br />
  Delete &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
  RMDir &quot;$INSTDIR&quot;<br />
<br />
  DeleteRegKey /ifempty HKCU &quot;Software\Modern UI Test&quot;<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">need_a_help</div><div class="date">22nd September 2010, 19:18</div></div><div class="posttext">Someone explain me how I can add two function .onInit ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">22nd September 2010, 19:36</div></div><div class="posttext">Instead of starting with Ultra Modern UI, just use MUI2. UMUI is not official and therefore you're not as likely to get help for it.<br />
<br />
As for your question, UMUI probably uses .onInit internally, so you need to find a !define that lets you specify your own .onInit function (i.e. MUI has a MUI_CUSTOMFUNCTION_GUIINIT define to specify your own .onGUIInit function).<br />
<br />
Also in future please post scripts as file attachments or use pastebin.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">need_a_help</div><div class="date">25th September 2010, 17:45</div></div><div class="posttext">Hi,<br />
<br />
I change system to MUI2 and try usage MUI_CUSTOMFUNCTION_GUIINIT but still have error ;/ What I doing wrong someone tell me?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">26th September 2010, 01:44</div></div><div class="posttext">... you didn't attach your MUI2 version.<br />
<br />
Line 6, change<br />
Function .onGUIInit<br />
to (example)<br />
Function myOnGUIInit<br />
<br />
Line 48, change<br />
!define MUI_CUSTOMFUNCTION_GUIINIT<br />
to<br />
!define MUI_CUSTOMFUNCTION_GUIINIT myOnGUIInit<br />
<br />
That will allow it to compile.  There's still some remaining errors, but you can figure 'm out (or open new threads).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">need_a_help</div><div class="date">26th September 2010, 08:33</div></div><div class="posttext">Thanks for help. But when I add<br />
<br />
Function myOnGUIInit<br />
        InitPluginsDir<br />
        File /oname=$PLUGINSDIR\splash.bmp &quot;c:\wgp1600.bmp&quot;<br />
     <br />
        advsplash::show 2500 600 400 -1 $PLUGINSDIR\splash<br />
<br />
        Pop $0          ; $0 has '1' if the user closed the splash screen early,<br />
                        ; '0' if everything closed normally, and '-1' if some error occurred.<br />
<br />
        Delete $PLUGINSDIR\splash.bmp<br />
FunctionEnd<br />
<br />
This splash show me in the frame. So I change myOnGUIInit to .onInit and give Function myOnGUIInit<br />
  !insertmacro UMUI_MULTILANG_GET<br />
FunctionEnd<br />
<br />
But when I  select change language &quot; English&quot; I still have the same (Polish)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">26th September 2010, 13:52</div></div><div class="posttext">not sure what problem you're seeing..<br />
<br />
When I run the installer, I first get an English UI.  Clicking through that shows English for all other pages as well.  If I change to Polish on the first page, all the other pages are Polish.  Were you expecting the language selection page itself to change immediately after selecting a different language?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">need_a_help</div><div class="date">26th September 2010, 15:04</div></div><div class="posttext">Yes work when I set function onInit for UMUI_MULTILANG_GET but splash have frame. When I give <br />
Function myOnGUIInit<br />
  !insertmacro UMUI_MULTILANG_GET<br />
FunctionEnd <br />
<br />
I can't change language. So can I delete frame when the splash start or can I change some value to change languages with function myOnGUIInit. Sorry for problems</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">26th September 2010, 15:35</div></div><div class="posttext">ahhhh now I understand.  Yes - simply move the Splash code to .onInit, -before- UMUI_MULTILANG_GET.<br />
<br />
So...<br />
<br />
Function .onInit<br />
        InitPluginsDir<br />
        File /oname=$PLUGINSDIR\splash.bmp &quot;c:\wgp1600.bmp&quot;<br />
<br />
        advsplash::show 2500 600 400 -1 $PLUGINSDIR\splash<br />
<br />
        Pop $0          ; $0 has '1' if the user closed the splash screen early,<br />
                        ; '0' if everything closed normally, and '-1' if some error occurred.<br />
<br />
        Delete $PLUGINSDIR\splash.bmp<br />
  !insertmacro UMUI_MULTILANG_GET<br />
FunctionEnd<br />
<br />
<br />
<br />
Function myOnGUIInit<br />
<br />
can be removed entirely, unless you have something else you'd want to initialize at GUI init.<br />
<br />
and<br />
<br />
!define MUI_CUSTOMFUNCTION_GUIINIT myOnGUIInit  <br />
<br />
should be removed as well.<br />
<br />
Keep in mind that if you plan on supporting a silent installer, you should make sure that splash does -not- show up when running silent.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">need_a_help</div><div class="date">26th September 2010, 20:42</div></div><div class="posttext">When I do what you say i have error &quot;Delete: &quot;!insertmacro: macro named &quot;UMUI_MULTILANG_GET&quot; not found!&quot;.<br />
<br />
Ps. Silent running? Can you explain me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">27th September 2010, 00:41</div></div><div class="posttext">not sure what edit you made.. I'm attaching my version.<br />
<br />
&quot;silent&quot; meaning that the user never gets to see the installer interface.. usually used by administrators or other installers that wrap your installer so that no user interaction is needed.  I'm guessing you won't be needing that ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">need_a_help</div><div class="date">27th September 2010, 21:50</div></div><div class="posttext">Thanks so much for help. But I have another question about some option.<br />
<br />
1. I add new function<br />
<br />
Function .onInstSuccess<br />
    MessageBox MB_OK &quot;Now run another program&quot; IDNO NoReadme<br />
      Exec $INSTDIR\File2.exe ; open link<br />
    NoReadme:<br />
  FunctionEnd<br />
<br />
Can I add this text with other language and when installer check version automatic give this text with language what he select? <br />
<br />
2. I want add new command Get File Version. I read about this option on the forum and wiki documentation but example is not good. I don't know how doing something like this.<br />
<br />
When installer start check file GetFileVersion &quot;${INSTDIR\Baza.exe}&quot;.<br />
If this file don't have version 1.0.0.2 he give message: &quot;You must install...&quot;<br />
But when every thing is ok he run<br />
<br />
Ps. You've guessed right I don't want silent install ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">27th September 2010, 22:12</div></div><div class="posttext">1. I add new function<br />
<br />
Function .onInstSuccess<br />
    MessageBox MB_OK &quot;Now run another program&quot; IDNO NoReadme<br />
      Exec $INSTDIR\File2.exe ; open link<br />
    NoReadme:<br />
  FunctionEnd<br />
<br />
Can I add this text with other language and when installer check version automatic give this text with language what he select?<br />
Yes.. use LangString:<br />
e.g.<br />
<br />
LangString runAnotherProgram ${LANG_ENGLISH} &quot;Now run another program&quot;<br />
LangString runAnotherProgram ${LANG_GERMAN} &quot;Jetzt ein anderes Programm ausf√ºhren&quot;<br />
<br />
<br />
Then replace...<br />
MessageBox MB_OK &quot;Now run another program&quot; IDNO NoReadme<br />
...with...<br />
MessageBox MB_OK &quot;$(runAnotherProgram)&quot; IDNO NoReadme<br />
note that langstring defines use parentheses (), nor curly braces {} like regular defines.<br />
<br />
<br />
2. I want add new command Get File Version. I read about this option on the forum and wiki documentation but example is not good.<br />
Not sure what's in the wiki - but read the one in your NSIS documentation instead:<br />
E.1.8 GetFileVersion<br />
<br />
Basically:<br />
<br />
!include &quot;FileFunc.nsh&quot; /* contains ${GetFileVersion} */<br />
<br />
[...]<br />
<br />
${GetFileVersion} &quot;$INSTDIR\Baza.exe&quot; $0<br />
/* $0 now contains the file version in #.#.#.# format */<br />
<br />
<br />
If this file don't have version 1.0.0.2 he give message<br />
<br />
For that, you can then use ${VersionCompare}:<br />
<br />
!include &quot;FileFunc.nsh&quot;<br />
!include &quot;WordFunc.nsh&quot; /* contains ${VersionCompare} */<br />
[...]<br />
<br />
${GetFileVersion} &quot;$INSTDIR\Baza.exe&quot; $0<br />
${VersionCompare} &quot;$0&quot; &quot;1.0.0.2&quot; $1<br />
/*<br />
  $1 now contains one of:<br />
    1: Existing $INSTDIR\Baza.exe version is HIGHER than 1.0.0.2<br />
    2: Existing $INSTDIR\Baza.exe version is LOWER than 1.0.0.2<br />
    0: Existing $INSTDIR\Baza.exe version IS 1.0.0.2<br />
*/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">need_a_help</div><div class="date">28th September 2010, 11:40</div></div><div class="posttext">I add other languages how you write and everything is ok. But still have problem with get file version. I copy your code and paste to my file and compilation ( any errors and warnings) but when I lunch installation nothing happens.<br />
<br />
Section<br />
!include &quot;FileFunc.nsh&quot; /* contains ${GetFileVersion} */<br />
<br />
${GetFileVersion} &quot;$INSTDIR\Baza.exe&quot; $0<br />
/* $0 now contains the file version in #.#.#.# format */  <br />
<br />
!include &quot;FileFunc.nsh&quot;<br />
!include &quot;WordFunc.nsh&quot; /* contains ${VersionCompare} */<br />
<br />
${GetFileVersion} &quot;$INSTDIR\Baza.exe&quot; $0<br />
${VersionCompare} &quot;$0&quot; &quot;1.0.0.2&quot; $1<br />
/*<br />
  $1 now contains one of:<br />
    1: Existing $INSTDIR\Baza.exe version is HIGHER than 1.0.0.2<br />
    2: Existing $INSTDIR\Baza.exe version is LOWER than 1.0.0.2<br />
    0: Existing $INSTDIR\Baza.exe version IS 1.0.0.2<br />
*/  <br />
SectionEnd<br />
<br />
Thanks for patience ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">28th September 2010, 12:06</div></div><div class="posttext">well the code was only to show you how you might check the version - you still have to add code based on the last comments to actually -do- something :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">need_a_help</div><div class="date">29th September 2010, 09:40</div></div><div class="posttext">Hi I do and everything work good but I have one question ;p When version is higher I add message Currently you have a higher version which could cause problems with patch. Do you want to proceed anyway?<br />
<br />
MessageBox MB_YESNO '$(Message1)'/SD IDNO<br />
     Abort<br />
<br />
And if I click in the installer &quot;Yes&quot;  I have abort installation.<br />
<br />
Thanks for help :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">29th September 2010, 12:27</div></div><div class="posttext">MessageBox MB_YESNO '$(Message1)'/SD IDNO<br />
Abort<br />
<br />
And if I click in the installer &quot;Yes&quot;  I have abort installation.<br />
<br />
the /SD flag sets the Silent Default option.  What you want is something like:<br />
<br />
<br />
MessageBox MB_YESNO|MB_ICONQUESTION &quot;Continue?&quot; IDYES _yes<br />
  /* IDNO assumed here, as that's the only other option */<br />
  Abort /* abort installation */<br />
<br />
_yes:<br />
/* continue with installation */</div></div><hr />


<div class="post"><div class="posttop"><div class="username">need_a_help</div><div class="date">4th October 2010, 17:22</div></div><div class="posttext">Hi everything right now is ok :) But I forgot ask you about  one option<br />
1. In the install system I use UMUI_PARAMS_REGISTRY_KEY, this key give my parameters $INSTDIR. Can I change him after choose language? e.g. I want install file baza.exe to: my documents\my games\Polish name (key give me only information about my documents so I must add $INSTDIR\my games\Polish name) but when i select english I want install this same file to $INSTDIR\my games\English name . How I can do this?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>