<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Updating progressbar via external process, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Updating progressbar via external process NSIS Discussion" />
	
	<title> Updating progressbar via external process [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Updating progressbar via external process</div>
<hr />
<div class="pda"><a href="t-214195.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=214195">Updating progressbar via external process</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dimator</div><div class="date">26th April 2005, 04:56</div></div><div class="posttext">Hi,<br />
I'm curious about the best way to do this:<br />
<br />
I need to update a progressbar based on the progress of an external executable, which handles the actual install work.  <br />
<br />
I'm using the progressbar in InstallOptionsEx.  I know that in my PageUpdate function, I can have a loop that &quot;polls&quot; the external process (via nsexec), and updates the progressbar.  However, such a loop would block other UI activity, so for example, the user would not be able to click cancel or stop the installer, until it either failed or succeeded completely.<br />
<br />
Is there a non-blocking type of &quot;sleep&quot; function maybe, that will callback a function I specify after N msecs?  I think something like that would solve my problem, but maybe there is a better way of doing what I'm trying to do?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th April 2005, 20:28</div></div><div class="posttext">If the external process is under your control, it'd be simpler to it change the progress bar itself. If not, you can set a timer using the System plug-in and use System callbacks. There is one example in the System plug-in documentation for callbacks and one in the examples.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dimator</div><div class="date">27th April 2005, 22:06</div></div><div class="posttext">I've tried gleaming what I need to know out of the System plug-in examples, but no dice.  I am trying:<br />
<br />
<br />
System::Call &quot;${sysSetTimer} (r2, 1, r8,)&quot;<br />
!insertmacro SINGLE_CALLBACK 20 $5 1 MyCallBack<br />
<br />
<br />
Where r2 is $HWNDPARENT and r8 is the delay in msecs.  MyCallBack is never called.  Am I doing this the right way?<br />
<br />
The plug-in example (System.nsi) has all kinds of other System::Call's, but they all seem to deal with creating the splash window, which I don't need.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th April 2005, 18:14</div></div><div class="posttext">You have to call something with System::Call and have it return its value on the stack to use SINGLE_CALLBACK. Calling Sleep would probably be the simplest.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">20th February 2011, 16:47</div></div><div class="posttext">Hi<br />
I have the same problem: I need to create Timer in regular page (in MUI2 in PRE or SHOW), no with nsDialogs!<br />
Syntax is quite simple:<br />
System::Call &quot;User32::SetTimer(i, i, i, k) i <br />
(HWND hWnd, UINT_PTR nIDEvent, UINT uElapse, TIMERPROC lpTimerFunc) UINT_PTR&quot;<br />
<br />
I have only problem with that k parameter - TIMERPROC<br />
<br />
All I need is to execute my function every uElapse miliseconds:<br />
Function TimerTick<br />
MessageBox MB_OK &quot;Timer tick!&quot;<br />
FunctionEnd<br />
<br />
I tried GetFunctionAddress $0 TimerTick for that k parameter but no success.<br />
<br />
Maybe I must use callback as mentioned in System plugin readme http://nsis.sourceforge.net/System_plug-in_readme#Callbacks.<br />
System::Get &quot;(i .r0, i .r1) isR0&quot;<br />
Pop $0<br />
System::Call &quot;dll::UseCallback(k r0)&quot;<br />
<br />
but I am confused from that example.<br />
I also saw included system examle, but it is even more complicated.<br />
Can you explain me how ho call Function TimerTick with that callback?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>