<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Skip Pages, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Skip Pages NSIS Discussion" />
	
	<title> Skip Pages [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Skip Pages</div>
<hr />
<div class="pda"><a href="t-181061.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181061">Skip Pages</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">24th May 2004, 20:53</div></div><div class="posttext">Hi,<br />
<br />
i write the install path in the registry if a user installs my software. Now if a newer version of my software is available he user should not choose the install-directory if he updates his version.<br />
<br />
To do this I must decide if the MUI_PAGE_DIRECTORY should be shown or not. I tried it in the configuration with a seperate function but calling seperate functions isn´t allowed in the configuration. I don´t know how to do this. In pseudo code it must be something like this. <br />
<br />
---------------<br />
  !insertmacro MUI_PAGE_WELCOME<br />
  !insertmacro MUI_PAGE_LICENSE &quot;license.txt&quot;<br />
<br />
  if doupdate_check then<br />
    $INSTDIR = readregstr foo<br />
  else<br />
    !insertmacro MUI_PAGE_DIRECTORY<br />
<br />
  !insertmacro MUI_PAGE_FINISH<br />
----------------<br />
<br />
Does anybody know how to do this?<br />
<br />
Best Regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">24th May 2004, 22:07</div></div><div class="posttext">if doupdate_check then<br />
$INSTDIR = readregstr foo<br />
else<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
<br />
!define doupdate_check if you want to enable changing $INSTDIR: <br />
<br />
<br />
!if doupdate_check<br />
  InstallDirRegKey &quot;root_key&quot; &quot;subkey&quot; &quot;key_name&quot;<br />
!else<br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
!endif<br />
<br />
If you already used InstallDirRegKey you can put it inside !else part.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">25th May 2004, 18:23</div></div><div class="posttext">Hi,<br />
<br />
thanks for your answer. !if and so on are compile time commands but I think I need it at runtime. The decision to show the &quot;!insertmacro MUI_PAGE_DIRECTORY&quot; is by an registry entry on the enduser machine. &quot;docheckupdate&quot; must be a function and not a compiler flag. So is it the right way to do this?<br />
<br />
Best Regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">25th May 2004, 22:36</div></div><div class="posttext">Oh, I thought that was compile time... So try this one (try to give more necessary details here):<br />
<br />
<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
<br />
MUI_PAGE_CUSTOMFUNCTION_PRE DirectoryPre<br />
<br />
Function DirectoryPre<br />
<br />
ReadRegStr $0 &quot;root_key&quot; &quot;subkey&quot; &quot;key_name&quot;<br />
<br />
# How do I call docheckupdate?<br />
; Guessing:<br />
;<br />
; Supose the Input is the version in the registry.<br />
; And Output is 2 for NEW, 1 for SAME, 0 for OLD.<br />
<br />
Push $0<br />
Call docheckupdate<br />
Pop $0<br />
<br />
# If it is NEW, skip the page<br />
<br />
StrCmp $0 2 0 +2<br />
  Abort<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">26th May 2004, 13:26</div></div><div class="posttext">Hi,<br />
<br />
thanks for your answer again. I tried this but the &quot;Abort&quot; isn´t correct because the other installer pages where skipped. I don´t want abort the installation if the installer detects and older version. I only want to skip the &quot;!insertmacro MUI_PAGE_DIRECTORY&quot; command if an older version exits. If an older version exists i get the installpath from the registry so i don´t need the &quot;!insertmacro MUI_PAGE_DIRECTORY&quot;. if no version exists the &quot;&quot;!insertmacro MUI_PAGE_DIRECTORY&quot; should be executed.<br />
<br />
I hope you understand me ;)<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tma</div><div class="date">26th May 2004, 19:44</div></div><div class="posttext">; define pre function <br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE skipCondition<br />
; insert page<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
<br />
<br />
; show or not to show function<br />
Function skipCondition<br />
;  if don't want show page call Abort <br />
EndFunction<br />
<br />
Tomas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">26th May 2004, 21:21</div></div><div class="posttext">Hi,<br />
<br />
ok that works. I don´t know why it doesn´t work on lunch but know it works.<br />
<br />
Thx<br />
<br />
Best Regards</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>