<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" SetDefaultPrinter call via System Plug-in, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  SetDefaultPrinter call via System Plug-in NSIS Discussion" />
	
	<title> SetDefaultPrinter call via System Plug-in [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  SetDefaultPrinter call via System Plug-in</div>
<hr />
<div class="pda"><a href="t-267221.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267221">SetDefaultPrinter call via System Plug-in</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">TJK</div><div class="date">5th March 2007, 22:28</div></div><div class="posttext">Hello<br />
<br />
I'm trying to use the System plug-in to call the SetDefaultPrinter function (which I understand is availabel on my Windows XP system), but I'm not having much success.<br />
<br />
I found an earlier posting (here (http://forums.winamp.com/showthread.php?postid=1818700)) and decided to start by copying the GetDefaultPrinter example, but when I use the following:<br />
<br />
System::Call 'winspool::GetDefaultPrinter(t .r0, *i ${NSIS_MAX_STRLEN})'<br />
MessageBox MB_OK $0<br />
I just get an empty message box ($0=NULL).<br />
<br />
Similarly when I try the following:<br />
<br />
System::Call 'winspool::SetDefaultPrinter(*t &quot;PrinterName&quot;)'<br />
The default printer doesn't change.<br />
<br />
This is the first time I've use the System plug-in, and though I've read the help and tutorial I'm afraid I don't seem to be grasping it.<br />
<br />
Any help and suggestions to point me in the right direction would be gratefully received.<br />
<br />
TIA<br />
<br />
Tim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">6th March 2007, 03:26</div></div><div class="posttext">Here is one way to do it:<br />
<br />
ExecWait 'rundll32 printui.dll,PrintUIEntry /y /n &quot;HP LaserJet 4240 PCL 6&quot;'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">6th March 2007, 03:48</div></div><div class="posttext">Here is one way to do it:<br />
<br />
ExecWait 'rundll32 printui.dll,PrintUIEntry /y /n &quot;HP LaserJet 4240 PCL 6&quot;'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TJK</div><div class="date">6th March 2007, 09:18</div></div><div class="posttext">Thanks cchian<br />
<br />
That works a lot better.<br />
<br />
Regards<br />
<br />
Tim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CancerFace</div><div class="date">6th March 2007, 14:00</div></div><div class="posttext">Looking at this (http://msdn2.microsoft.com/en-us/library/ms535475.aspx) MSDN page I think that the correct syntax for the GetDefaultPrinter function should be:System::Call 'winspool::GetDefaultPrinterA(*t .r0,i ${NSIS_MAX_STRLEN})i.r1'and you should get a non-zero value at $1 if the function succeeds, along with the printer name at $0. You could try adding ?e at the end to get extended error information (on $2):System::Call 'winspool::GetDefaultPrinterA(*t .r0, i ${NSIS_MAX_STRLEN})i.r1 ?e'<br />
Pop $2Also the SetDefaultPrinter (http://msdn2.microsoft.com/en-us/library/ms535468.aspx) call should like this:System::Call 'winspool::SetDefaultPrinterA(*t &quot;PrinterName&quot;)i.r0'and I think you would have to experiment a bit with both functions to figure out the format of PrinterName<br />
Hope this helps ...<br />
CF</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>