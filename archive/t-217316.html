<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Isolated components prevent DLL conflicts, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Isolated components prevent DLL conflicts NSIS Discussion" />
	
	<title> Isolated components prevent DLL conflicts [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Isolated components prevent DLL conflicts</div>
<hr />
<div class="pda"><a href="t-217316.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=217316">Isolated components prevent DLL conflicts</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MrPeacock</div><div class="date">28th May 2005, 19:48</div></div><div class="posttext">Thought this might be of interest as it is not mentioned in the NSIS manual or the forum ... <br />
<br />
from Microsoft knowledgebase http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/isolated_components.asp <br />
<br />
Authors of installation packages can specify that the installer copy the shared files (commonly shared DLLs) of an application into that application's folder rather than to a shared location. This private set of files (DLLs) are then used only by the application. Isolating the application together with its shared components in this manner has the following advantages:<br />
<br />
The application always uses the versions of the shared files with which it was deployed. <br />
Installing the application does not overwrite other versions of the shared files by other applications. <br />
Subsequent installations of other applications using different versions of the shared files cannot overwrite the files used by this application. <br />
Because the current implementation of COM keeps a single full path in the registry for each CLSID/Context pair, it forces all applications to use the same version of a shared DLL. To enable an application to keep a private copy of a COM server, the system loader in Windows 98 and Windows 2000 checks for the presence of a .LOCAL file in the application's folder. If the system loader detects a .LOCAL file, it alters its search logic to prefer DLLs located in the same folder as the application.<br />
<br />
When Windows Installer version 1.1 and later versions execute the IsolateComponents action they copy the files of the component (commonly a shared DLL) specified in the Component_Shared column of the IsolatedComponent table into the same folder as the component (commonly an .exe file) specified in the Component_Application column. The installer creates a file in this directory, zero bytes in length, having the short file name of the key file for Component_Application (typically the name is the same as the application's .exe) appended with .LOCAL. The installer uses the registration for the component in its shared location and does not write any registration information for the copy of the component in the private location. The IsolatedComponent action and table are not available with Windows Installer version 1.0.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th May 2005, 20:04</div></div><div class="posttext">Please create a Wiki (http://nsis.sf.net/wiki) page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RossW</div><div class="date">24th November 2006, 19:53</div></div><div class="posttext">Does anyone have a code example for this? I'd be very interested to see how exactly this is done.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th November 2006, 09:43</div></div><div class="posttext">What I could gather from this, is that you need to create an empty file named app.exe.local and put all the COM DLL files in the same directory. You can create that file using FileOpen.<br />
<br />
A quick search on my computer showed TortoiseCVS uses that. You can take a look at its installer script (http://tortoisecvs.cvs.sourceforge.net/tortoisecvs/TortoiseCVS/build/TortoiseCVS.iss?revision=1.104&amp;view=markup). It seems to do nothing more than create that file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MrPeacock</div><div class="date">25th November 2006, 09:46</div></div><div class="posttext">This is the interesting part of the script that I mailed to you, I can't tell if everything works as it should however, so no guarantees ! :p<br />
<br />
...<br />
Section &quot;System&quot; SEC03<br />
  SetOverwrite on<br />
  SetOutPath &quot;$SYS_FOLDER&quot;<br />
  ;  RdP: hele directory met DLL, OCX etc. kopieeren naar bijv. \Windows\system32<br />
  File /r &quot;E:\CD\system\&quot;<br />
  ;  RdP: LET OP: indien .exe en .dll's in een directory (isolated components),<br />
  ;       dan &quot;Zwfina.local&quot; bestand aanmaken en DLL's niet registreren !<br />
  StrCmp $SYS_FOLDER $INSTDIR 0 lblRegistreren<br />
    File &quot;E:\CD\program\${PRODUCT_NAME}.local&quot;<br />
    Return<br />
<br />
  lblRegistreren:<br />
  ;  RdP: registreer VB6 .dll's<br />
  ;  RegDLL $SYS_FOLDER\*.dll<br />
 :p :p</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>