<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Updating and Overwriting OCX, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Updating and Overwriting OCX NSIS Discussion" />
	
	<title> Updating and Overwriting OCX [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Updating and Overwriting OCX</div>
<hr />
<div class="pda"><a href="t-155590.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=155590">Updating and Overwriting OCX</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">alan93</div><div class="date">8th November 2003, 23:10</div></div><div class="posttext">I have a few questions that I couldn not find or understand in the documentation was wondering if i could ask here.<br />
<br />
I am wanting to overwrite some OCX if newer, currently when the installer runs and it tries to install when the OCX is already there, it throws up a message box to Retry, Ignore, or Cancel.<br />
<br />
<br />
So i use <br />
 SetOverwrite ifnewer<br />
<br />
fine<br />
<br />
Does this only have to be done before File command once? or in each Section where File command is used?<br />
<br />
and I only want to install install the OCX if it doesn't exist or if its newer.<br />
<br />
so tyring to understand examples I saw<br />
<br />
IfFileExists &quot;$INSTDIR\NSIS.exe&quot; 0 +3<br />
<br />
What's the 0 and what's the +3?<br />
<br />
Also , should I unregister an OCX if I am updating it then re-register it after its updated or overwritten?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">8th November 2003, 23:22</div></div><div class="posttext">The 0 means that the script continues on the next line and +3 means the script will continue from the third line from this point, skipping 2 line.  You could also replace these numbers with labels so the script is more resistant to modification.  i.e. if you add extra lines you would not need to change the amount of line to skip.<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alan93</div><div class="date">8th November 2003, 23:42</div></div><div class="posttext">Tried to delete this post but couldn't so I changed it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">9th November 2003, 08:59</div></div><div class="posttext">look in the docs at &quot;appedinx B : Useful functions&quot;. you will find &quot;Add a shared DLL&quot;, &quot;Remove a shared DLL&quot; and &quot;Upgrade a DLL&quot;. i use them. they work very good.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alan93</div><div class="date">10th November 2003, 13:48</div></div><div class="posttext">Great I'll check that out.  I am just overwriting with &quot;ifnewer&quot; and I no longer get the &quot;cancel/abort/ignore&quot; message.<br />
<br />
I guess I dont need to re-register an OCX when overwriting. I am unregistering it on uninstall though.<br />
<br />
One strange thing I notice is that when I have Regdll in a section named &quot;&quot; it doesn't HIDE the process.<br />
<br />
Not sure what &quot;&quot; for a section name hides exactly. ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th November 2003, 15:34</div></div><div class="posttext">I recommend you to use UpgradeDLL. If you just overwrite a shared OCX it might break other applications in the future.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alan93</div><div class="date">10th November 2003, 16:24</div></div><div class="posttext">This happens to be an OCX that is exclusive to my program that I am distributing, but I will check out UpgradeDLL aslo<br />
<br />
thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alan93</div><div class="date">10th November 2003, 16:29</div></div><div class="posttext">This was supposed to be a reply to another message but got diverted when i logged in.<br />
<br />
Can't even delete it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th November 2003, 17:04</div></div><div class="posttext">If it's exclusive for your application and the OCX is distributed with the application, there is no need to use UpgradeDLL.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>