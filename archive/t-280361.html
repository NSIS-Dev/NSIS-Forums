<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecShell not detecting program already installed, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecShell not detecting program already installed NSIS Discussion" />
	
	<title> ExecShell not detecting program already installed [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecShell not detecting program already installed</div>
<hr />
<div class="pda"><a href="t-280361.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=280361">ExecShell not detecting program already installed</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">chamakits</div><div class="date">30th October 2007, 20:16</div></div><div class="posttext">I'm currently having a problem with ExecShell.<br />
<br />
The thing is, the progamming i'm making an installer for depends on SQL Server 2005 and SQL Manager.<br />
<br />
My installer installs SQL Server 2005 silently, and SQL Manager as well.  When SQL Server gets installed, the sqlcmd command can be accessed, because the SQL Server installer automatically includes its ..Tools\Binn folder into the path.  However, i'm trying to access sqlcmd through NSIS and its just not working.  I made an .exe that was solely in charge of using sqlcmd for a couple of commands, and when the window pops up with the .exe running, the message appears that &quot;sqlcmd is not a valid command...&quot;, as if sqlcmd wasn't available through the system path.  However, when I execute the program after the whole instalation is through, it works perfectly.<br />
Anybody has any idea why this could be happening?<br />
<br />
PS.  I THINK, that it could be that it takes it a while to include sqlcmd into the path, so i should maybe wait a bit after the SQL server 2005 installer is done.  Is there any way to wait an amount of x seconds with the NSIS installer?  I'm already waiting for the whole installer to finish with ExecWait, but is there a way to wait more?<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th October 2007, 20:38</div></div><div class="posttext">Sleep [milliseconds]<br />
<br />
Perhaps you need to set a different working directory first with SetOutPath.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">30th October 2007, 22:19</div></div><div class="posttext">Environment variables are loaded when the program (your NSIS installer) starts and won't be updated when the SQLServer installer changes them. You probably need to use the complete path for the sqlcmd you want to run.<br />
<br />
It executes OK after the whole installer is done because you start a new program that gets the current environment variables which now include ...\Tools\Binn.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chamakits</div><div class="date">1st November 2007, 16:12</div></div><div class="posttext">I don't believe the setout path affects it really, because i'm trying to execute something thats a system variable, and I'll try the whole path to see my Luck with that.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>