<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Error in the script, but why?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Error in the script, but why? NSIS Discussion" />
	
	<title> Error in the script, but why? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Error in the script, but why?</div>
<hr />
<div class="pda"><a href="t-249613.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=249613">Error in the script, but why?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ghola2</div><div class="date">25th June 2006, 16:23</div></div><div class="posttext">Hy!<br />
<br />
I am trying to make a custom page, who has 2 textboxes, and init these textboxes with values from in.ini file if exist. The problem is that in the function where should be the init, i can't even make a strcpy, because it throws an error, that i am not using the correct sintax... (same problem with MUI_INSTALLOPTIONS_READ, or ReadINIStr, Pop )<br />
What I am doing wrong? Can anybody help me? <br />
<br />
Thanks in advance<br />
<br />
<br />
<br />
<br />
<br />
;--------------------------------<br />
;Include Modern UI<br />
<br />
  !include &quot;MUI.nsh&quot;<br />
	!include &quot;TextFunc.nsh&quot;<br />
<br />
	<br />
	ReserveFile &quot;ServerPort.ini&quot;<br />
  !insertmacro MUI_RESERVEFILE_INSTALLOPTIONS<br />
<br />
;--------------------------------<br />
;General<br />
<br />
  ;Name and file<br />
  Name &quot;Modern UI Test&quot;<br />
  OutFile &quot;Basic.exe&quot;<br />
<br />
  ;Default installation folder<br />
  InstallDir &quot;$PROGRAMFILES\Modern UI Test&quot;<br />
  <br />
  ;Get installation folder from registry if available<br />
  InstallDirRegKey HKCU &quot;Software\Modern UI Test&quot; &quot;&quot;<br />
<br />
;--------------------------------<br />
;Interface Settings<br />
<br />
  !define MUI_ABORTWARNING<br />
<br />
<br />
;--------------------------------<br />
;Pages<br />
<br />
   <br />
	 !insertmacro MUI_PAGE_WELCOME<br />
	 <br />
  <br />
<br />
<br />
  !insertmacro MUI_PAGE_COMPONENTS<br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
	  Page custom ServerPage<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
 <br />
	<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_UNPAGE_INSTFILES<br />
  <br />
;--------------------------------<br />
;Languages<br />
 <br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
;--------------------------------<br />
;Installer Sections<br />
<br />
Section &quot;Dummy Section&quot; SecDummy<br />
<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  <br />
  ;ADD YOUR OWN FILES HERE...<br />
  <br />
  ;Store installation folder<br />
  WriteRegStr HKCU &quot;Software\Modern UI Test&quot; &quot;&quot; $INSTDIR<br />
  <br />
  ;Create uninstaller<br />
  WriteUninstaller &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
SectionEnd<br />
<br />
;--------------------------------<br />
;Descriptions<br />
<br />
  ;Language strings<br />
	LangString USERPASS_TITLE ${LANG_ENGLISH} &quot;Enter your Username and Password.&quot;<br />
	LangString USERPASS_SUBTITLE ${LANG_ENGLISH} &quot; &quot;<br />
  LangString DESC_SecDummy ${LANG_ENGLISH} &quot;A test section.&quot;<br />
<br />
  ;Assign language strings to sections<br />
  !insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />
    !insertmacro MUI_DESCRIPTION_TEXT ${SecDummy} $(DESC_SecDummy)<br />
  !insertmacro MUI_FUNCTION_DESCRIPTION_END<br />
<br />
;--------------------------------<br />
;Uninstaller Section<br />
<br />
Section &quot;Uninstall&quot;<br />
<br />
  ;ADD YOUR OWN FILES HERE...<br />
<br />
  Delete &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
  RMDir &quot;$INSTDIR&quot;<br />
<br />
  DeleteRegKey /ifempty HKCU &quot;Software\Modern UI Test&quot;<br />
<br />
SectionEnd<br />
<br />
<br />
<br />
Function .OnInit<br />
<br />
<br />
!insertmacro MUI_INSTALLOPTIONS_EXTRACT_AS &quot;ServerPort.ini&quot; &quot;ServerPort.ini&quot;<br />
<br />
FunctionEnd<br />
<br />
<br />
<br />
# CUSTOM PAGE.<br />
# =========================================================================<br />
# Get the Username and Password.<br />
Function ServerPage<br />
<br />
   !insertmacro MUI_HEADER_TEXT &quot;$(USERPASS_TITLE)&quot; &quot;$(USERPASS_SUBTITLE)&quot;<br />
  <br />
;ReadINIStr $serverPort &quot;$INSTDIR\in.ini&quot; &quot;Server&quot; &quot;Port&quot; ; generates error, why?!<br />
<br />
<br />
;StrCpy $R99 &quot;semmi kozod!!!!&quot; ;GENERATES ERROR WHY?!<br />
<br />
	 <br />
	 <br />
	<br />
	 !insertmacro MUI_INSTALLOPTIONS_WRITE  &quot;ServerPort.ini&quot; &quot;Field 2&quot; &quot;State&quot; &quot;alma&quot;;&quot;$serverName&quot;<br />
	 !insertmacro MUI_INSTALLOPTIONS_WRITE  &quot;ServerPort.ini&quot; &quot;Field 4&quot; &quot;State&quot; &quot;12&quot;;&quot;$serverPort&quot;<br />
   # Display the page.<br />
   !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;ServerPort.ini&quot;<br />
<br />
   # Get the user entered values.<br />
	<br />
	!insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;ServerPort.ini&quot; &quot;Field 2&quot; &quot;State&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R1 &quot;ServerPort.ini&quot; &quot;Field 4&quot; &quot;State&quot;<br />
	<br />
	<br />
<br />
MessageBox MB_OK &quot;{$R0}+ $R1&quot; <br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th June 2006, 17:56</div></div><div class="posttext">You need to declare variables with the Var instruction.<br />
Variables $0-$9 and $R0 to $R9 are predeclared by the compiler.<br />
<br />
e.g.<br />
Var serverPort<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>