<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" File Write Issue, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  File Write Issue NSIS Discussion" />
	
	<title> File Write Issue [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  File Write Issue</div>
<hr />
<div class="pda"><a href="t-307867.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=307867">File Write Issue</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ryanpager</div><div class="date">1st July 2009, 18:32</div></div><div class="posttext">Okay, so ive got everythign in the installer, and when I was debugging it to make sure everything worked I noticed that it wasnt writing the files with the correct information;<br />
<br />
My code for the write file is the following:<br />
<br />
Function asimbridge<br />
<br />
         !macro WriteLineB LineB<br />
         FileWrite $R0 `${LineB}$\r$\n`<br />
         !macroend<br />
         !define WriteLineB `!insertmacro WriteLine`<br />
<br />
         Push $R0<br />
         FileOpen $R0 `$INSTDIR\ASIMBridge.bat` w<br />
         ${WriteLineB} '@echo off'<br />
         ${WriteLineB} 'rem bridge file created Thu, 25 Jun 2009 14:49:20 -0500 by user $uNameRem'<br />
         ${WriteLineB} 'rem install option: normal install'<br />
         ${WriteLineB} 'rem browser path:  C:\Program Files\Internet Explorer\iexplore.exe'<br />
         ${WriteLineB} 'rem company directory:  $INSTDIR'<br />
         ${WriteLineB} 'rem automatic login:  on'<br />
         ${WriteLineB} ''<br />
         ${WriteLineB} 'set PHPRC=&quot;$INSTDIR\&quot;'<br />
         ${WriteLineB} 'if not exist &quot;$INSTDIR\php.exe&quot; GOTO PHPERR'<br />
         ${WriteLineB} 'if not exist &quot;$INSTDIR\%1&quot; GOTO BRGERR'<br />
         ${WriteLineB} ''<br />
         ${WriteLineB} 'GOTO PHPEXEC'<br />
         ${WriteLineB} ''<br />
         ${WriteLineB} ':PHPEXEC'<br />
         ${WriteLineB} '&quot;$INSTDIRphp.exe&quot; &quot;$INSTDIR\upload_bridge_file.php&quot; &quot;$INSTDIR\%1&quot;'<br />
         ${WriteLineB} 'if ERRORLEVEL 1 GOTO RETERR'<br />
         ${WriteLineB} 'GOTO END'<br />
         ${WriteLineB} ''<br />
         ${WriteLineB} ':PHPERR'<br />
         ${WriteLineB} 'echo $INSTDIR\php.exe does not exist - please check your bridge configuration'<br />
         ${WriteLineB} 'GOTO PAUSEX'<br />
         ${WriteLineB} ''<br />
         ${WriteLineB} ':BRGERR'<br />
         ${WriteLineB} 'echo $INSTDIR\%1 does not exist - please check your bridge configuration'<br />
         ${WriteLineB} 'GOTO PAUSEX'<br />
         ${WriteLineB} ''<br />
         ${WriteLineB} ':PAUSEX'<br />
         ${WriteLineB} 'PAUSE'<br />
         ${WriteLineB} 'GOTO END'<br />
         ${WriteLineB} ''<br />
         ${WriteLineB} ':RETERR'<br />
         ${WriteLineB} 'echo &quot;Bridge upload failed with error code %ERRORLEVEL%&quot;'<br />
         ${WriteLineB} 'GOTO PAUSEX'<br />
         ${WriteLineB} ''<br />
         ${WriteLineB} ':END'<br />
         ${WriteLineB} 'EXIT'<br />
         ${WriteLineB} ''<br />
         ${WriteLineB} 'EXIT'<br />
         FileClose $R0<br />
         Pop $R0<br />
FunctionEnd<br />
<br />
<br />
<br />
Now the file is writing correctly, but anywhere it says $instdir it does teh following;<br />
<br />
If install directory = C:\ASIM<br />
<br />
it will write to the file as: C:\ASIM\ASIM\*<br />
<br />
<br />
Is there a way to get rid of this duplication?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st July 2009, 23:03</div></div><div class="posttext">Check the value of $INSTDIR using a message box. Also your WriteLineB define is inserting the WriteLine macro.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ryanpager</div><div class="date">2nd July 2009, 14:15</div></div><div class="posttext">Yea I ran the MB, and it was correct with the install path....however it is NOT writing to my .bat file.<br />
<br />
<br />
Is it not possible to write to an executable bat file?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ryanpager</div><div class="date">2nd July 2009, 14:39</div></div><div class="posttext">got it......stupid plaguing typo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ryanpager</div><div class="date">2nd July 2009, 16:38</div></div><div class="posttext">On a ComboBox, how do you retrieve the selection that they make?<br />
<br />
I tried the GetSelection but it just errors out<br />
<br />
Any ideas?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>