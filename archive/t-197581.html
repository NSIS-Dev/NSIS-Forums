<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Checking for Quicktime - bug in script, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Checking for Quicktime - bug in script NSIS Discussion" />
	
	<title> Checking for Quicktime - bug in script [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Checking for Quicktime - bug in script</div>
<hr />
<div class="pda"><a href="t-197581.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=197581">Checking for Quicktime - bug in script</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">noisecrime</div><div class="date">27th October 2004, 10:05</div></div><div class="posttext">Hi,<br />
<br />
I've used the check for Quicktime version scriptf from the archive, and it appeared to work well. However during my testing I discovered that even though i'd uninstalled QT, the script still thought it was installed and the correct version.<br />
<br />
After a little digging in the registry it would appear that the QT uninstaller does not remove the registry keys but sets a new item called 'installstate' to 00 00 00 00 (REG_BINARY)<br />
<br />
so in the script doing<br />
ReadRegDWord $R0 HKLM &quot;SOFTWARE\Apple Computer, Inc.\QuickTime&quot; Version<br />
<br />
Will return a version for QT even though it no longer exists. I've coded up a workaround by following the acrobat version check script using<br />
<br />
	ReadRegStr $R5 HKLM &quot;Software\Microsoft\Windows\CurrentVersion\App Paths\QuickTimePlayer.exe&quot; &quot;&quot; <br />
<br />
As this registry entry is deleted by the QT uninstaller. So if it doesn't exist i'm assuming QT is not installed.<br />
<br />
I have two questions.<br />
<br />
1. Is there a way to read the installstate entry binary? That might be a more elegant solution.<br />
2. Is it safe to use the second check? I mean is there a better registry key to check for? Will QT always be given an entry in 'App paths'?<br />
<br />
cheers</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">27th October 2004, 18:39</div></div><div class="posttext">Yes, I went thru this very thing<br />
Wonderfully, Apple has developed an uninstaller program that does not delete the main registry. Bug or Feature...you decide ;)<br />
I settled on testing for actual files in the Quicktime folder as well as a registry check. Also, you will want to check for a min vs full install...I check for the PictureViewer.exe to determe this</div></div><hr />


<div class="post"><div class="posttop"><div class="username">noisecrime</div><div class="date">28th October 2004, 04:10</div></div><div class="posttext">Thanks grahama,<br />
<br />
Glad to see someone else has seen this behaviour. Any chance of posting your fix? I figured just checking for the app path registry entry would be enough, no need to test for actual files.<br />
<br />
However you min vs full installer is something i'd not taken into account, i'll have to find out exactly what install is required by the appliaction.<br />
<br />
Cheers</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">28th October 2004, 05:00</div></div><div class="posttext">you need to check for it...because you will have all kinds of inexplicable problems with minimum installs...trust me<br />
better to tell the user they do not have QT and reinstall the full install...I'll post my checker and the ini file I use tomorrow <br />
g</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>