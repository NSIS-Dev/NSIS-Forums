<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Changing Root for DirRequest, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Changing Root for DirRequest NSIS Discussion" />
	
	<title> Changing Root for DirRequest [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Changing Root for DirRequest</div>
<hr />
<div class="pda"><a href="t-299150.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=299150">Changing Root for DirRequest</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">25th October 2008, 22:06</div></div><div class="posttext">An InstallOptions related question: is it possible to change the 'Root' value for a DirRequest control without reinitializing the page? Like, when you want to change 'State' (e.g. to append \MyProg after the user selects a dir), it's not enough to change it in .ini, you also need to use SendMessage to display the new string in the box. But 'Root' is not some element for which you can get a HWND, so I'm clueless.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschagottfried</div><div class="date">29th October 2008, 09:39</div></div><div class="posttext">I have used the DirRequest control in one of my setups. You can two things. Switch to using (!include nsDialogs.nsh). This targets the somewhat complicated programming method with using InstallOptions for custom dialogs. The tutorial is quite promising. If you have only one custom dialog, it is worth a try. The next problem you will be facing with InstallOptions, could be not a problem with nsDialogs. <br />
<br />
Or you paste some code into your reply and I try to give you advice looking for similarities in my code. Actually I did not completely understand what you are trying to do. Please show your goal with examples and your problems as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">29th October 2008, 16:30</div></div><div class="posttext">I realize that switching to MUI2 would probably be the best solution but right now I don't have time nor the will to explore nsDialogs, so let's drop that one.<br />
As for InstallOptions:<br />
I've built a custom page for shortcuts selection. It uses DirRequest to select a Start menu folder. The user can also select whether it will be created for all or for current user. Default is set to current, so if the user clicks the 'All users' RadioButton, the script needs:<br />
SetShellVarContext All<br />
!insertmacro MUI_INSTALLOPTIONS_WRITE &quot;shortcuts.ini&quot; &quot;Field 13&quot; &quot;Root&quot; &quot;$SMPROGRAMS&quot;<br />
But InstallOptions doesn't reload values from .ini so it will not take effect unless user reinits the page (i.e. goes &lt;Back and then Next&gt; again). This limitation is generally not much of a problem, you activate the change by getting HWND of the control and using SendMessage or EnableWindow, depending on what you need. But as I said, you can't do that for 'Root', it's not a page element and it has no HWND. I guess it's only handled internally by the plugin but I thought I'd ask anyway. My workaround for the problem is creating two separate DirRequest controls. I'm not completely happy with this solution but it's functional.<br />
Wrote to Santa to bring me money so I have spare time to play around with nsDialogs.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>