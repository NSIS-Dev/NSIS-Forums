<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" how to add scheduled task, or is it possible?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  how to add scheduled task, or is it possible? NSIS Discussion" />
	
	<title> how to add scheduled task, or is it possible? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  how to add scheduled task, or is it possible?</div>
<hr />
<div class="pda"><a href="t-147686.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=147686">how to add scheduled task, or is it possible?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">atsuk</div><div class="date">31st August 2003, 07:46</div></div><div class="posttext">what if i wanted myapp.exe to be launched every monday at 09:00 ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st August 2003, 11:12</div></div><div class="posttext">A little forum search came up with:<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=111976&amp;highlight=schedule</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">31st August 2003, 13:24</div></div><div class="posttext">That would be a good plugin for NSIS.<br />
Do you think it will be made?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st August 2003, 13:26</div></div><div class="posttext">Not by me on the near couple of weeks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">2nd September 2003, 12:14</div></div><div class="posttext">At NT/W2k/Xp system there is command AT.EXE.<br />
at.exe 9:00 /every:monday &quot;c:\test.exe&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">3rd September 2003, 13:06</div></div><div class="posttext">Job could be done using updated system plugin (as soon as exehead will be updated too, for plugin look at &quot;Exehead &amp; Ole&quot; thread). I've included source file with function and use example (since it will be hard to extract information from this page :)<br />
<br />
Usage:<br />
<br />
     push &quot;My Task&quot;<br />
     push &quot;My Task Comment&quot;<br />
     push &quot;c:\Working Dir\My Task Program.exe&quot;<br />
     push &quot;c:\Working Dir&quot;<br />
     push &quot;My Program Args&quot;        <br />
; what that's structure means? look thru attached nsi file, that's information tooks to many place<br />
     push &quot;*(&amp;l2, &amp;i2 0, &amp;i2 2003, &amp;i2 9, &amp;i2 3, &amp;i2 0, &amp;i2 0, &amp;i2 0, &amp;i2 9, &amp;i2 0, i 0, i 0, i 0, i 2, &amp;i2 1, &amp;i2 0x2, &amp;i2 0, i 0, &amp;i2 0) i.s&quot;   <br />
     Call CreateTask<br />
     Pop $0<br />
     MessageBox MB_OK &quot;CreateTask result: $0&quot;<br />
<br />
Realization and TIME_TRIGGER structure description are at attached nsi file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">atsuk</div><div class="date">4th September 2003, 16:01</div></div><div class="posttext">well, i got first example working fine, but i didn't manage to do it with the other one :(<br />
tnx anyway</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">4th September 2003, 18:22</div></div><div class="posttext">first example???? I've posted only one... <br />
<br />
Oh. you mean at.exe. :)<br />
<br />
To utilize second one (it will work at win95-winxp) you'll need the latest CVS (as soon as Kichik will update it for compatibility with system plugin ;).<br />
<br />
So... All together: KICHIK! KICHIK!! KICHIK!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">atsuk</div><div class="date">8th September 2003, 12:44</div></div><div class="posttext">well i still didn't understand second example, but i have a question with the first one. By default this command line<br />
'at.exe 9:00 /every:monday &quot;c:\test.exe&quot;'<br />
gives a name for the scheduled task &quot;at1&quot;. is it possible to give job different name?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th September 2003, 12:49</div></div><div class="posttext">For the second one you need the latest CVS version. As for the name of the task with the first one, if to believe to at.exe /?, you can't.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">8th September 2003, 13:28</div></div><div class="posttext">Somebody checked it beside me? Kichik could you please? ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th September 2003, 13:57</div></div><div class="posttext">Yes, it works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">atsuk</div><div class="date">8th September 2003, 17:39</div></div><div class="posttext">ok got it:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">11th September 2003, 15:42</div></div><div class="posttext">Just a system update.<br />
<br />
release 5, 11 september 2003.<br />
1. u flag - unload dll after procedure call.<br />
2. some changes to asm to turn on Whole Program Optimization.<br />
3. Dll shrinked for 1 kb.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th September 2003, 21:21</div></div><div class="posttext">Uploaded, thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">23rd September 2010, 19:16</div></div><div class="posttext">Before delving deeper into this plug-in, does it use the Task Scheduler API (http://technet.microsoft.com/en-us/library/ee176704.aspx)?<br />
<br />
If so, does it have the same limitation as XP's command line schtasks (http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/schtasks.mspx?mfr=true)?<br />
<br />
By limitation I mean the inability to schedule a task with an empty password (in addition to the fact that it's not available in XP Home).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">23rd September 2010, 23:39</div></div><div class="posttext">Answering myself:<br />
does it use the Task Scheduler API (http://technet.microsoft.com/en-us/library/ee176704.aspx)?Yes! It creates the familiar job files in %WINDIR%\Tasks.<br />
<br />
If so, does it have the same limitation as XP's command line schtasks (http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/schtasks.mspx?mfr=true)?Yes. If the password for the account is empty, then the task would not start and logs the following error:<br />
The attempt to retrieve account information for the specified task failed; therefore, the task did not run. Either an error occurred, or no account information existed for the task.<br />
	The specific error is:<br />
	0x8004130f: No account information could be found in the Task Scheduler security database for the task indicated.<br />
<br />
The behavior of the existing &quot;NSIS Scheduled Tasks&quot; in my test system (XP SP2) is frustratingly unexplainable: The above error would occur if the scheduled job is produced by the script, but if the same exact task is opened via GUI and interactively uncheck-then-check the box &quot;Run only if logged on&quot;, then the task would start.<br />
<br />
Any explanation for that? How do I even begin to troubleshoot a problem like this (aside from looking at the log file and reading what I quoted above)?<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">24th September 2010, 04:40</div></div><div class="posttext">Any explanation for that? How do I even begin to troubleshoot a problem like this (aside from looking at the log file and reading what I quoted above)?This problem is driving me crazy. I've combed the web and found many many posts describing a situation similar to what I described. For example:<br />
<br />
http://forums.winamp.com/showthread.php?t=225449<br />
<br />
http://msdn.microsoft.com/en-us/library/aa381276%28VS.85%29.aspx<br />
<br />
http://social.msdn.microsoft.com/Forums/en-US/vclanguage/thread/291d9722-ccbc-41ff-b33d-5f1af694ae72<br />
<br />
But none of them would provide a clue as to why both NSIS flavors (the original NOT providing username/password &amp; the latest one providing them) will not work on my test system.<br />
<br />
As I was about to give up, I discovered that if I create a password for the Administrator account (under which I am trying to set the scheduled task), and provide both the correct username and password, then the test NSIS script would finally succeed.<br />
<br />
Nice, but isn't the existence of TASK_FLAG_RUN_ONLY_IF_LOGGED_ON (0x2000) supposed to answer exactly a case in which we DON'T want to provide a password in the script?<br />
<br />
Something is not right here, and I don't know whether it's a bug in Windows, a bug in the MSDN documentation, or a bug in the &quot;Scheduled Tasks&quot; script for NSIS.<br />
<br />
Or a bug in my brain. :stare:<br />
<br />
Could you please help?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ronca</div><div class="date">24th September 2010, 16:08</div></div><div class="posttext">This is a secretly undocumented feature by Microsoft. You can't schedule tasks on a Windows account with administrator privileges that has no password.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">24th September 2010, 19:44</div></div><div class="posttext">This is a secretly undocumented feature by Microsoft. You can't schedule tasks on a Windows account with administrator privileges that has no password.What??? This doesn't make sense. If Microsoft wanted to prohibit an Admin account with an empty password, it would have been disabled across the board, not only for the Task Scheduler.<br />
<br />
Besides, Google's Chrome installed quite a few such (working!) scheduled tasks on my test machine having an Admin account with an empty password. Apple's iTunes did the same thing.<br />
<br />
Also, created a scheduled task from the GUI (using the &quot;Run only if logged on&quot; checkbox) also works.<br />
<br />
The problem must by lying elsewhere. I am becoming convinced that there is a bug in both NSIS &quot;Scheduled Tasks&quot; available scripts.<br />
<br />
Has anyone (beside me) tested these scripts on an Admin account with an empty password?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ronca</div><div class="date">26th September 2010, 19:59</div></div><div class="posttext">What??? This doesn't make sense.<br />
Of course it doesn't make sense but that's Microsoft. You don't have to believe me. I don't know if you discovered this already but in task scheduler you can't enter a path with spaces in it. For example if you have something in &quot;C:\Program Files&quot; you must use C:\Progra~1 instead. Makes sense? Of course not but that's Microsoft.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">27th September 2010, 19:51</div></div><div class="posttext">I don't know if you discovered this already but in task scheduler you can't enter a path with spaces in it. For example if you have something in &quot;C:\Program Files&quot; you must use C:\Progra~1 instead. Makes sense? Of course not but that's Microsoft<br />
It turns out you were correct.<br />
<br />
I was hoping that by using the NSIS &quot;Scheduled Tasks&quot; (http://nsis.sourceforge.net/Scheduled_Tasks) script I could avoid prompting the user for entering his password but since it needs the user password, too, I ended up using nsExec::Exec schtasks /create instead, which is documented at least and slightly more predictable.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>