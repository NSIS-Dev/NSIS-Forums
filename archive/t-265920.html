<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Get path of pointing mouse file, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Get path of pointing mouse file NSIS Discussion" />
	
	<title> Get path of pointing mouse file [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Get path of pointing mouse file</div>
<hr />
<div class="pda"><a href="t-265920.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=265920">Get path of pointing mouse file</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Mark Nascimento</div><div class="date">16th February 2007, 10:36</div></div><div class="posttext">Could you teach us how to send to clipboard (or variable)<br />
the full path of a file (in explorer) that the mouse is pointing to, like shell as send to nsis variable, or &quot;send full path to clipboard&quot; or &quot;send full path to nsis $VarApp.exe&quot;.<br />
<br />
Example:<br />
(in explorer, the mouse points to a dll: )<br />
(Shell &gt;  &quot;Unregister dll&quot;)<br />
Then my nsis app.exe will get the $path and execute<br />
Regsvr32 /u $path<br />
;;;;;;<br />
Using classic interface on Windows 98<br />
<br />
<br />
The current Code:<br />
    VIProductVersion 0.0.4.0<br />
    VIAddVersionKey /LANG=1046 &quot;LegalCopyright&quot; &quot;Mark Luis AmÃ³ra do Nascimento&quot;<br />
    VIAddVersionKey /LANG=1046 &quot;FileDescription&quot; &quot;INFARTE - Arte em InformÃ¡tica do Papai Mark&quot;<br />
    VIAddVersionKey /LANG=1046 &quot;Compilado em :&quot; &quot;${__TIMESTAMP__}&quot;<br />
    VIAddVersionKey /LANG=1046 &quot;Programa :&quot; &quot;Executor&quot;<br />
    VIAddVersionKey /LANG=1046 &quot;FileVersion&quot; &quot;1.0&quot;<br />
#_________________________________________________________________________________________<br />
    Name &quot;Executor&quot;<br />
    OutFile &quot;..\Executor.exe&quot;<br />
    xpstyle on<br />
    !verbose 4<br />
    ShowInstDetails show<br />
    !include &quot;${NSISDIR}\Include\WinMessages.nsh&quot;<br />
    LoadLanguageFile &quot;d:\Roteiro\PortugueseBR.nlf&quot;<br />
    Caption &quot;Papai Mark e o Executor &quot;<br />
    var hwnd<br />
    var mem<br />
#_________________________________________________________________________________________<br />
<br />
    Function .onInit<br />
/*    WriteRegStr HKCR &quot;exefile\shell\Executor&quot; &quot;&quot; &quot;Abrir o Executor&quot;<br />
    WriteRegStr HKCR &quot;exefile\shell\Executor\command&quot; &quot;&quot; &quot;$exedir\executor.exe&quot;<br />
    WriteRegStr HKCR &quot;dllfile\shell\Executor&quot; &quot;&quot; &quot;Abrir o Executor&quot;<br />
    WriteRegStr HKCR &quot;dllfile\shell\Executor\command&quot; &quot;&quot; &quot;$exedir\executor.exe&quot;<br />
*/<br />
Push $0<br />
System::Call 'user32::OpenClipboard(i 0)'<br />
System::Call 'user32::GetClipboardData(i 1) t .r0'<br />
System::Call 'user32::CloseClipboard()'<br />
Exch $0<br />
Pop $0<br />
StrCpy $1 $0 2 1<br />
Strcmp $1 &quot;:\&quot; 0 semclip<br />
;MessageBox MB_YesNo|MB_topmost|MB_IconQuestion &quot;Gravar :$\r$0  ?&quot; IdNo semclip<br />
WriteIniStr &quot;$exedir\m.ini&quot; &quot;Field 2&quot; State $0<br />
semclip:<br />
Flushini m.ini<br />
FunctionEnd<br />
<br />
<br />
#_________________________________________________________________________________________<br />
<br />
    Page custom ShowCustom LeaveCustom<br />
    Function ShowCustom<br />
    InstallOptions::initDialog /NOUNLOAD &quot;$exedir\m.ini&quot;<br />
    Pop $hwnd<br />
    InstallOptions::show<br />
    Pop $0<br />
    FunctionEnd<br />
#_________________________________________________________________________________________<br />
    Function LeaveCustom<br />
    ReadINIStr $0 &quot;$exedir\m.ini&quot; &quot;Settings&quot; &quot;State&quot;<br />
    StrCmp $0 0 Done<br />
    StrCmp $0 5 lembrar<br />
    StrCmp $0 7 lembrar<br />
    StrCmp $0 10 lembrar<br />
    StrCmp $0 6 Ler<br />
    StrCmp $0 8 limpar<br />
    StrCmp $0 9 Sobre<br />
    StrCmp $0 12 lembrar<br />
    StrCmp $0 13 lembrar<br />
    StrCmp $0 14 lembrar<br />
    <br />
    Ler:<br />
	ReadINIStr $0 &quot;$exedir\m.ini&quot; &quot;Field 14&quot; &quot;State&quot;<br />
    StrCmp $0 1 0 +2<br />
    advsplash::show 295 1 1 0xc0c0c0 $exedir\splash\bt<br />
    IfFileExists $exedir\Lista.ini +3 0<br />
    MessageBox MB_OK|MB_topmost|MB_Iconinformation &quot; A lista estÃ¡ vazia.&quot;<br />
    Abort<br />
    ExecShell open $exedir\Lista.ini<br />
    abort<br />
    <br />
    Limpar:<br />
	ReadINIStr $0 &quot;$exedir\m.ini&quot; &quot;Field 14&quot; &quot;State&quot;<br />
    StrCmp $0 1 0 +2<br />
    advsplash::show 295 1 1 0xc0c0c0 $exedir\splash\bt<br />
    IfFileExists $exedir\Lista.ini +3<br />
    MessageBox MB_OK|MB_topmost|MB_Iconinformation &quot;A lista jÃ¡ havia sido apagada.&quot;<br />
    Abort<br />
    Delete $exedir\Lista.ini<br />
    MessageBox MB_OK|MB_topmost|MB_Iconinformation &quot; A lista foi apagada.&quot;<br />
    Abort<br />
    <br />
    lembrar:<br />
	ReadINIStr $0 &quot;$exedir\m.ini&quot; &quot;Field 14&quot; &quot;State&quot;<br />
    StrCmp $0 1 0 +2<br />
    advsplash::show 100 1 1 0xc0c0c0 $exedir\splash\cb<br />
    Abort<br />
    <br />
    Sobre:<br />
	ReadINIStr $0 &quot;$exedir\m.ini&quot; &quot;Field 14&quot; &quot;State&quot;<br />
    StrCmp $0 1 0 +2<br />
    advsplash::show 295 1 1 0xc0c0c0 $exedir\splash\bt<br />
    ExecShell open $exedir\Sobre.txt<br />
    abort<br />
    <br />
    Done:<br />
	ReadINIStr $0 &quot;$exedir\m.ini&quot; &quot;Field 14&quot; &quot;State&quot;<br />
    StrCmp $0 1 0 +2<br />
    advsplash::show 480 1 1 0xc0c0c0 $exedir\splash\mv<br />
    FunctionEnd<br />
#_________________________________________________________________________________________<br />
	Page instfiles<br />
#_________________________________________________________________________________________<br />
	Section<br />
	ReadIniStr $2 &quot;$exedir\Lista.ini&quot; &quot;Lista de linhas de comando efetivadas&quot; &quot;Total absoluto de usos&quot;<br />
	IntOp $2 $2 + 1<br />
	WriteIniStr &quot;$exedir\Lista.ini&quot; &quot;Lista de linhas de comando efetivadas&quot; &quot;Total absoluto de usos&quot; $2<br />
<br />
	ReadINIStr $3 &quot;$exedir\m.ini&quot; &quot;Field 2&quot; &quot;State&quot;  ;o arquivo<br />
	ReadINIStr $1 &quot;$exedir\m.ini&quot; &quot;Field 13&quot; &quot;State&quot;  ;o prefixo<br />
StrCmp $1 &quot;&quot; sempref<br />
StrCmp $1 &quot; &quot; sempref<br />
StrCpy $3 &quot;$1 $3&quot;<br />
GoTo semshell<br />
<br />
<br />
sempref:<br />
	ReadINIStr $8 &quot;$exedir\m.ini&quot; &quot;Field 10&quot; &quot;State&quot;  ;Abrir pelo &amp;Shell<br />
	StrCmp $8 1 0 semshell<br />
	ReadINIStr $7 &quot;$exedir\m.ini&quot; &quot;Field 7&quot; &quot;State&quot;  ;Mostrar &amp;Detalhes no final.<br />
    StrCmp $7 1 +2<br />
    hidewindow<br />
	ClearErrors<br />
	ExecShell open '$3'<br />
	IfErrors exeerro certo<br />
	<br />
	semshell:<br />
	ReadINIStr $7 &quot;$exedir\m.ini&quot; &quot;Field 7&quot; &quot;State&quot;  ;Mostrar &amp;Detalhes no final.<br />
    StrCmp $7 1 +2<br />
    hidewindow<br />
	ClearErrors<br />
	Exec '$3'<br />
	IfErrors exeerro certo<br />
	<br />
	<br />
	exeerro:<br />
	ReadINIStr $7 &quot;$exedir\m.ini&quot; &quot;Field 7&quot; &quot;State&quot;<br />
    StrCmp $7 1 +2<br />
    hidewindow<br />
	ReadINIStr $mem &quot;$exedir\m.ini&quot; &quot;Field 5&quot; &quot;State&quot;<br />
	StrCmp $mem 0 +3  ; ou +4, tanto faz<br />
	StrCpy $9 x<br />
	DetailPrint &quot;Erro  gravado  na  lista.&quot;<br />
	StrCpy $mem 0<br />
 	DetailPrint &quot;ERRO    -    E R R O !    -    E R R R R R R O  !&quot;<br />
	DetailPrint &quot;ERRO    -    E R R O !    -    E R R R R R R O  !&quot;<br />
	DetailPrint &quot;ERRO    -    E R R O !    -    E R R R R R R O  !&quot;<br />
	DetailPrint &quot;ERRO    -    E R R O !    -    E R R R R R R O  !&quot;<br />
	ReadINIStr $0 &quot;$exedir\m.ini&quot; &quot;Field 14&quot; &quot;State&quot;<br />
    StrCmp $0 1 0 fim<br />
    advsplash::show 1200 1 1 0x000000 $exedir\splash\er<br />
    Pop $0<br />
    GoTo fim<br />
	certo:<br />
	<br />
	ReadINIStr $mem &quot;$exedir\m.ini&quot; &quot;Field 5&quot; &quot;State&quot;<br />
	StrCmp $mem 0 0 +3<br />
	DetailPrint &quot;NÃ£o foi gravado na Lista.ini&quot;<br />
	GoTo fim<br />
	DetailPrint &quot;O comando foi gravado em $exedir\Lista.ini&quot;<br />
	ReadIniStr $1 &quot;$exedir\Lista.ini&quot; &quot;Lista de linhas de comando efetivadas&quot; &quot;Total absoluto de usos&quot;<br />
	StrCmp $1 100 0 naoapaga<br />
	MessageBox MB_YESNO|MB_ICONQUESTION|MB_Topmost &quot;O arquivo de memÃ³ria jÃ¡ atingiu 100 Ã_tens. Posso apagÃ¡-lo ?&quot; idno naoapaga<br />
	Delete $exedir\Lista.ini<br />
	WriteIniStr &quot;$exedir\Lista.ini&quot; &quot;Lista de linhas de comando efetivadas&quot; &quot;Total absoluto de usos&quot; 1<br />
	naoapaga:<br />
<br />
	StrCpy $6 1<br />
<br />
	next:<br />
	ReadIniStr $4 &quot;$exedir\Lista.ini&quot; &quot;Comandos Corretos&quot; $6<br />
	StrCmp $4 &quot;&quot; 0 cont<br />
	ClearErrors<br />
	WriteIniStr &quot;$exedir\Lista.ini&quot; &quot;Comandos Corretos&quot; $6 $3<br />
	IfErrors 0 +2<br />
	MessageBox MB_OK|MB_ICONstop|MB_Topmost &quot;Hove um erro inesperado ao escrever na lista.&quot;<br />
	GoTo fim<br />
<br />
	cont:<br />
	IntOp $6 $6 + 1<br />
	GoTo next<br />
<br />
	fim:<br />
	StrCmp $9 x 0 semlger<br />
	Strcpy $9 1<br />
	nexter:<br />
	ReadIniStr $5 &quot;$exedir\Lista.ini&quot; &quot;Comandos Errados&quot; $9<br />
	StrCmp $5 &quot;&quot; 0 conter<br />
	WriteIniStr &quot;$exedir\Lista.ini&quot; &quot;Comandos Errados&quot; $9 $3<br />
	GoTo semlger<br />
	conter:<br />
	IntOp $9 $9 + 1<br />
	GoTo nexter<br />
	<br />
	IntOp $5 $5 + 1<br />
	WriteIniStr &quot;$exedir\Lista.ini&quot; &quot;Ãšltimo Comando Errados&quot; $5 $3<br />
	<br />
	semlger:<br />
    ReadINIStr $7 &quot;$exedir\m.ini&quot; &quot;Field 7&quot; &quot;State&quot;<br />
    StrCmp $7 1 +2<br />
    SetAutoClose True<br />
    Sleep 500<br />
    ReadIniStr $7 &quot;$exedir\m.ini&quot; &quot;Field 12&quot; &quot;State&quot;<br />
    StrCmp $7 1 0 +2<br />
    exec $exedir\executor.exe<br />
    SetAutoClose True<br />
    SectionEnd<br />
<br />
<br />
<br />
The Ini file<br />
<br />
[Settings]<br />
NumFields=14<br />
title=EXECUTOR   -   Executar programa composto.<br />
BackEnabled=1<br />
BackButtonText=Pra TrÃ¡s<br />
State=6<br />
<br />
[Field 1]<br />
Type=Groupbox<br />
Left=1<br />
Right=-1<br />
Top=1<br />
Bottom=46<br />
Text=Cole, digite ou abra um arquivo e digite o complemento :<br />
HWND=3044<br />
<br />
[Field 2]<br />
Type=FileRequest<br />
Flags=GROUP|FILE_MUST_EXIST|FILE_EXPLORER|FILE_HIDEREADONLY<br />
State=&quot;ping 200.149.10.50&quot;<br />
Filter=ExecutÃ¡veis|*.exe|Todos|*.*<br />
Left=10<br />
Right=-10<br />
Top=12<br />
Bottom=25<br />
MinLen=8<br />
ValidateText=Entre com um executÃ¡vel composto vÃ¡lido.<br />
HWND=3048<br />
HWND2=3052<br />
<br />
[Field 3]<br />
Type=Groupbox<br />
Left=1<br />
Right=-1<br />
Top=50<br />
Bottom=98<br />
Text=Prefixo :<br />
HWND=3056<br />
<br />
[Field 4]<br />
Type=Label<br />
Left=120<br />
Right=-5<br />
Top=62<br />
Bottom=72<br />
Text=Esta Ã© a primeira parte da linha de comando.<br />
HWND=3060<br />
<br />
[Field 5]<br />
Type=Checkbox<br />
Text=&amp;Anotar na Lista<br />
Flags=NOTIFY<br />
State=1<br />
Left=10<br />
Right=76<br />
Top=105<br />
Bottom=115<br />
HWND=3064<br />
<br />
[FIELD 6]<br />
Type=Button<br />
Flags=NOTIFY<br />
Text=&amp;Ver a Lista<br />
Left=-66<br />
Right=-10<br />
Top=108<br />
Bottom=123<br />
HWND=3068<br />
<br />
[Field 7]<br />
Type=Checkbox<br />
Text=Mostrar &amp;Detalhes no final.<br />
Flags=NOTIFY<br />
State=0<br />
Left=10<br />
Right=110<br />
Top=116<br />
Bottom=126<br />
HWND=3072<br />
<br />
[Field 8]<br />
Type=Button<br />
Flags=NOTIFY<br />
Text=&amp;Limpar a Lista<br />
Left=-127<br />
Right=-71<br />
Top=108<br />
Bottom=123<br />
HWND=3076<br />
<br />
[Field 9]<br />
Type=Button<br />
Flags=NOTIFY<br />
Text=&amp;InformaÃ§Ãµes<br />
Left=-65<br />
Right=-10<br />
Top=28<br />
Bottom=43<br />
HWND=3080<br />
<br />
[Field 10]<br />
Type=Checkbox<br />
Text=Abrir pelo &amp;Shell.  O programa nÃ£o Ã© um executÃ¡vel.<br />
Flags=NOTIFY<br />
State=0<br />
Left=10<br />
Right=-80<br />
Top=30<br />
Bottom=40<br />
HWND=3084<br />
<br />
[Field 11]<br />
Type=Groupbox<br />
Left=1<br />
Right=-1<br />
Top=98<br />
Bottom=130<br />
Text=<br />
HWND=3088<br />
<br />
[Field 12]<br />
Type=Checkbox<br />
Text=&amp;Reabrir<br />
Flags=NOTIFY<br />
State=1<br />
Left=82<br />
Right=122<br />
Top=105<br />
Bottom=115<br />
HWND=3092<br />
<br />
[Field 13]<br />
Type=Combobox<br />
State=&quot;&quot;<br />
ListItems=| |Regsvr32 |Regsvr32 /s |Regedit |Regedit /s |Regsvr32 /u |notepad |command.com /c |<br />
Left=10<br />
Right=110<br />
Top=60<br />
Bottom=-1<br />
Flags=Notify<br />
HWND=3096<br />
<br />
[Field 14]<br />
Type=Checkbox<br />
Text=S&amp;om<br />
Flags=NOTIFY<br />
State=0<br />
Left=10<br />
Right=40<br />
Top=80<br />
Bottom=90<br />
HWND=3108</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">16th February 2007, 19:32</div></div><div class="posttext">Not sure if I got the point of what you're trying to achieve...<br />
Do you want users to select a dll which installer should unregister?<br />
If this is the matter you may do it simply and easily by adding a FileRequest on a custom page where users should browse for the dll which you're able to unregister within NSIS, no need to execute Regsvr32.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mark Nascimento</div><div class="date">17th February 2007, 03:39</div></div><div class="posttext">No. <br />
First, why:<br />
We test, reg and unreg, use parameters.<br />
-------------------------------<br />
Second, What I do NOW:<br />
&gt;Point to notepad.exe<br />
&gt;Right click over notepad.exe.<br />
&gt;Shell opens (open, sendto, cut, copy, Copy this path, etc)<br />
&gt;I click on &quot;Copy this path&quot;  ( a camtech soft, http://camtech2000.net/) and the full path of notepad is sent to clipboard.<br />
&gt;I right click over notepad.exe again and <br />
&gt;Shell opens<br />
<br />
&gt;Now, I click on &quot;Open the Executor&quot; (my app)<br />
&gt;The Executor gets the clipboard data and puts into a listbox. On other listbox, I choose or write the first part of the command line and... Go!<br />
The command (exec, execwait) can be so:<br />
&quot;c:\ExeScope.exe c:\Windows\notepad.exe&quot;<br />
And so, ExeScope will analyse the notepad.exe.<br />
-------------------------------------------------------<br />
Third, What I want to:<br />
Nsis can get clipboard data but can't get the path of a selected file on explorer. I want to do only one right click:<br />
<br />
&gt;Point to notepad.exe<br />
&gt;Right click over notepad.exe.<br />
&gt;Now, I click on &quot;Open with the Executor&quot; (my app)<br />
&gt;The Executor gets the FULL PATH of notepad.exe and puts into a listbox or variable. On other listbox, I choose or write the first part of the command line and... Go!<br />
The command (exec, execwait) can be so:<br />
&quot;c:\ExeScope.exe c:\Windows\notepad.exe&quot;<br />
And so, ExeScope will analyse the notepad.exe.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">17th February 2007, 10:37</div></div><div class="posttext">&gt;Right click over notepad.exe.<br />
&gt;Now, I click on &quot;Open with the Executor&quot; (my app)<br />
&gt;The Executor gets the FULL PATH of notepad.exeThis sounds like you have added &quot;Open with the Executor to the shell command. If you did that, you could have the shell command add the filename that was clicked as a parameter to pass to Executor.<br />
<br />
&quot;%1&quot; after the Executor command will pass the filename with path. Take a look in your registry at an example like NSIS.Script (HKCR\NSIS.Script\shell\compile\command).<br />
<br />
Executor will need to be modified to look at its command line for the filename, instead of looking at the clipboard.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mark Nascimento</div><div class="date">18th February 2007, 05:40</div></div><div class="posttext">Getting closer.<br />
WriteRegStr HKCR &quot;exefile\shell\Executor\command&quot; &quot;&quot; '$exedir\executor.exe &quot;%1&quot;'<br />
YEs, but how the Executor will read %1 ?<br />
<br />
I 've tried and read the help file but nothing. I only find command line to the COMPILER. <br />
<br />
Example, how to get the %1:<br />
_________________________<br />
Outfile Eureka.exe<br />
Name Darmok<br />
Section &quot;In the ocean&quot;<br />
MessageBox MB_OK|MB_topmost|MB_Iconexclamation &quot;Tempa!<br />
when the walls falled %1&quot;<br />
Exec &quot;Command.com /c %1&quot;<br />
SectionEnd<br />
GetOut<br />
_________________________</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">18th February 2007, 09:25</div></div><div class="posttext">In the manual, Section E.1.11 Get Parameters<br />
!include &quot;FileFunc.nsh&quot;<br />
!insertmacro GetParameters<br />
Section<br />
	${GetParameters} $R0<br />
	; $R0=&quot;[parameters]&quot;<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mark Nascimento</div><div class="date">20th February 2007, 04:04</div></div><div class="posttext">When the walls falls<br />
Your eyes uncovered<br />
<br />
THANK YOU!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>