<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Need Quick Criticism... On a Script., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Need Quick Criticism... On a Script. NSIS Discussion" />
	
	<title> Need Quick Criticism... On a Script. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Need Quick Criticism... On a Script.</div>
<hr />
<div class="pda"><a href="t-133117.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=133117">Need Quick Criticism... On a Script.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Tolwyn</div><div class="date">25th April 2003, 18:14</div></div><div class="posttext">Ok. I was being very careful creating this with the help of HM NIS Edit.<br />
<br />
I defined a variable to Hard Code the $Programfiles directory, as I don't want that to change (and don't think I can have the user change it as the files that go here are mutually exclusive of the $INSTDIR folder).<br />
<br />
The files are INSTALLING okay.<br />
I THINK I have the Start Menu shortcuts working okay.<br />
<br />
The problem, I think, is that the Uninstaller is not removing the appropriate files deposited into the $INSTDIR folder, nor is it removing the $SMPROGRAMS shortcuts, either (or the folder that the user specified).<br />
<br />
Could someone take a quick gander at the script and let me know where I dicked up? :)<br />
<br />
The script is to install plane skins into the appropriate folders after the user specifies the game install folder (since I don't know how to populate a variable by checking their Registry for the game, yet).<br />
<br />
However, the administrative information files should NOT go into the game folder (that's why I have specified/hardcoded the $PROGRAMFILES\${PGINST} folder for the basic ReadMe, HomePage URL, etc).<br />
<br />
Thanks, guys (and gals?)... I apprecaite it in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tolwyn</div><div class="date">26th April 2003, 05:04</div></div><div class="posttext">Bump! Please? :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">26th April 2003, 15:22</div></div><div class="posttext">I didn't find possible errors.<br />
Maybe this suggestions.<br />
1. The &quot;LicenseBkColor 0x00e0e0e0&quot; it's an invalid color format.<br />
The LicenseBkColor accept rrggbb format. In your case: &quot;e0e0e0&quot;<br />
2. Instead:<br />
<br />
Delete &quot;$INSTDIR\Paintschemes\skins\bf109e4\JG77512Bf109E4.bmp&quot;<br />
Delete &quot;$INSTDIR\Paintschemes\skins\bf109f4\JG77512Bf109F4.bmp&quot;<br />
Delete &quot;$INSTDIR\Paintschemes\skins\bf109g2\JG77512Bf109G2.bmp&quot;<br />
Delete &quot;$PROGRAMFILES\${PGINST}\7jg77_readme.txt&quot;<br />
Delete &quot;$PROGRAMFILES\${PGINST}\uninst-7jg77skins.exe&quot;<br />
Delete &quot;$PROGRAMFILES\${PGINST}\7-JG77 Black Eagles.url&quot;<br />
Delete &quot;$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\7-JG77.lnk&quot;<br />
Delete &quot;$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\Uninstall.lnk&quot;<br />
Delete &quot;$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\Read Me.lnk&quot;<br />
<br />
Way not:<br />
<br />
RMDir /r &quot;$INSTDIR\&quot;<br />
RMDir /r &quot;$PROGRAMFILES\${PGINST}&quot;<br />
RMDir /r &quot;$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}&quot;<br />
;Will remove all with the parameter /r and the folder</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tolwyn</div><div class="date">26th April 2003, 16:56</div></div><div class="posttext">Since the skins are being installed into a folder that was created by a game, I don't/can't delete the folder, only the specific files installed during this installation.<br />
<br />
At any rate, there is an error in the script as the UNINSTALLER is not uninstalling the *.bmp files, or the Start Menu entries. I can't figure out why.<br />
<br />
So this would be correct on the color thing:<br />
LicenseBkColor 0x0e0e0e0<br />
<br />
Or just 0xe0e0e0 ?<br />
Or just e0e0e0 ?<br />
<br />
I'm using the Hex color string, but don't know the format.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">26th April 2003, 17:06</div></div><div class="posttext">LicenseBkColor E0E0E0<br />
<br />
:)<br />
<br />
But why, in my opinion, left files behind?<br />
Delete all the files, folder and sub's in the $INSTDIR.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tolwyn</div><div class="date">26th April 2003, 17:14</div></div><div class="posttext">Uh, because the game has already installed its default skins there.<br />
Other people have put THERE skins there, etc.<br />
<br />
It would be very malignant of me to remove more than only the files that *I* installed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">26th April 2003, 17:30</div></div><div class="posttext">got it, dude ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">26th April 2003, 18:35</div></div><div class="posttext">I checked you file at this morning and these are the results:<br />
<br />
1)This line below is wrong:<br />
<br />
LicenseBkColor 0x00e0e0e0<br />
<br />
According to documentation, the form to use is RRGGBB, not 0x00RRGGBB, so is:<br />
<br />
LicenseBkColor E0E0E0<br />
<br />
So Lobo Lunar is right here.<br />
<br />
2)Another line wrong:<br />
<br />
WriteIniStr &quot;$PROGRAMFILES\${PGINST}\7-JG77 Black Eagles.url&quot; &quot;InternetShortcut&quot; &quot;URL&quot; &quot;http://www.7jg77.com&quot;<br />
<br />
The right way to create shortcuts to webpages is:<br />
<br />
CreateShortCut &quot;$PROGRAMFILES\${PGINST}\7-JG77 Black Eagles.url&quot; &quot;http://www.7jg77.com&quot;<br />
<br />
3)Instead of (in Section Uninstall):<br />
<br />
  Delete &quot;$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\7-JG77.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\Uninstall.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\Read Me.lnk&quot;<br />
<br />
Should be:<br />
<br />
 !insertmacro MUI_STARTMENU_DELETE_BEGIN &quot;$var&quot;<br />
   Delete &quot;$PROGRAMFILES\$var\7jg77_readme.txt&quot;<br />
   Delete &quot;$PROGRAMFILES\$var\uninst-7jg77skins.exe&quot;<br />
   Delete &quot;$PROGRAMFILES\$var\7-JG77 Black Eagles.url&quot;<br />
 !insertmacro MUI_STARTMENU_DELETE_END<br />
<br />
 If you do this above, remove the lines:<br />
<br />
 ReadRegStr $0 HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PGINST}&quot; &quot;NSIS:StartMenuDir&quot; ;in Section Uninstall<br />
<br />
 and<br />
<br />
 CreateDirectory &quot;$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}&quot; ;in Section &quot;Full Installation&quot;<br />
<br />
4)And a question: For what you want the Components Page if have only one section that is show?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tolwyn</div><div class="date">26th April 2003, 18:47</div></div><div class="posttext">For #4:<br />
<br />
The script isn't final yet.<br />
There will be a choice to install 512x512 skins, 1024x1024 skins, Allied skins, Axis Skins, or all.<br />
<br />
Just haven't finished the sections yet.<br />
<br />
That reminds me...<br />
Will the uninstaller know what to delete automatically depending upon the installation, or do I have to have different sections for the uninstaller, too?<br />
<br />
Is the uninstaller dynamically created based upon the installation?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">26th April 2003, 19:04</div></div><div class="posttext">Is the uninstaller dynamically created based upon the installation?<br />
<br />
<br />
No. You have to put what files you want to remove, reg keys to delete...<br />
<br />
<br />
I have to have different sections for the uninstaller, too? <br />
<br />
<br />
You cannot have different sections for uninstall yet (planned to this version of NSIS, see TODO.txt in NSIS folder for &quot;to do list&quot;).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th April 2003, 17:09</div></div><div class="posttext">Deguix, WriteIniStr works too. Open up a .url file and you'll see this inside of it.<br />
<br />
The uninstaller code is compiled ahead but the uninstaller itself is generated dynamically. The exe header is first written, then the precompiled datablock (along with the script, files, headers, etc.) and then the icons are replaced.<br />
<br />
Your problem with the uninstall is that $INSTDIR is wrong. $INSTDIR isn't transferred from the installer (unless you script it this way), instead the directory that the uninstaller is in is used as $INSTDIR.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tolwyn</div><div class="date">28th April 2003, 04:29</div></div><div class="posttext">Ok.<br />
Kichik...<br />
Based upon that information, where should the OUT path be for the uninstaller?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">28th April 2003, 14:11</div></div><div class="posttext">Wherever you want it to be as long as you make sure you have the right $INSTDIR. That means that if your installer's $INSTDIR is C:\instdir and you put the uninstaller in C:\instdir\uninstall\uninstaller.exe then you'll have to use GetParent to get the right $INSTDIR, or just use Delete ..\file.exe, etc.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tolwyn</div><div class="date">28th April 2003, 19:06</div></div><div class="posttext">Oh god my head hurts.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>