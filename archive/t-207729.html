<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How can I use DetailPrint from within the &quot;leave_function&quot; of a custom page?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How can I use DetailPrint from within the &quot;leave_function&quot; of a custom page? NSIS Discussion" />
	
	<title> How can I use DetailPrint from within the &quot;leave_function&quot; of a custom page? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How can I use DetailPrint from within the &quot;leave_function&quot; of a custom page?</div>
<hr />
<div class="pda"><a href="t-207729.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=207729">How can I use DetailPrint from within the &quot;leave_function&quot; of a custom page?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">NewGuyJoe</div><div class="date">14th February 2005, 02:13</div></div><div class="posttext">I have successfully added a custom page after &quot;Page instfiles&quot; to do some configuration to a file I have just installed. However, I cannot use DetailPrint within my custom page because the green text on black background detail panel is no longer visible when my custom page is displayed! Messagebox is not a good alternative. I would like to use DetailPrint or an equivalent to output lines of text in the same panel used by Page instfiles. Thanks in advance.<br />
<br />
;...<br />
<br />
ShowInstDetails show<br />
<br />
Page components<br />
Page instfiles<br />
Page custom ShowCustom LeaveCustom &quot;: customize&quot;<br />
<br />
; Cannot call Page instfiles twice or it will re-install all files again!<br />
; Page instfiles<br />
;...<br />
Section &quot;Group 2 - Option 3&quot;<br />
  SetOutPath &quot;c:\temp&quot;<br />
  File &quot;C:\stuff\myfile.txt&quot;<br />
SectionEnd<br />
;...<br />
Function LeaveCustom<br />
  ; Fix me<br />
  DetailPrint &quot;This does not display&quot;<br />
FunctionEnd<br />
<br />
;...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">14th February 2005, 04:43</div></div><div class="posttext">Just wondering, but couldn't you take care of the configuration to the file at the end of the &quot;Group 2 - Option 3&quot; section?  Why do you need a custom page?  Are you getting input from the user?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th February 2005, 11:51</div></div><div class="posttext">You could have another InstFiles page, but before you show it you'd have to uncheck all your sections...<br />
!include Sections.nsh<br />
Function UncheckAll<br />
 Push $R0<br />
  StrCpy $R0 0<br />
  Loop: !insertmacro UnselectSection $R0<br />
  StrCmp $R0 ${LastSection} 0 Loop<br />
  !insertmacro SelectSection &quot;${SpecialSection}&quot;<br />
 Pop $R0<br />
FunctionEnd<br />
Your last install Section needs to be like this now:<br />
Section &quot;My last section&quot; LastSection<br />
...<br />
SectionEnd<br />
This'll end the range of your main install sections.<br />
<br />
Now, you need another section under the last one. This'll be unselected at first...<br />
Section /o &quot;&quot; SpecialSection<br />
...<br />
SectionEnd<br />
In here, you want the code that DetailPrint's your configuration details.<br />
<br />
That should do it. There's one problem though. The details printed in your first InstFiles page will not be in your second one. The second one will start off empty.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NewGuyJoe</div><div class="date">15th February 2005, 01:30</div></div><div class="posttext">Thanks for the code snippet! I will try it soon - Removing the sections after the first Page instfiles should certainly give me what I'm after!!<br />
<br />
The reason this cannot be done in a Section is because the Section will execute on the first instfiles. Stu's suggestion circumvents this behavior.<br />
<br />
Thanks, Stu!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NewGuyJoe</div><div class="date">16th February 2005, 00:08</div></div><div class="posttext">Stu,<br />
<br />
HELP!<br />
I was not successful in implementing your UncheckAll function. I added a &quot;Call Uncheckall&quot; to my leave_function and it goes into an infinite loop (apparently there is no access to sections within my custom page leave_function). I'm not sure where to place the function call. I added the second &quot;Page instfiles&quot; command after my &quot;Page custom&quot;. It still installs all the sections over again, since the Uncheckall function never worked. Any advice would be appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NewGuyJoe</div><div class="date">16th February 2005, 00:52</div></div><div class="posttext">I was able to get the whole issue resolved by not using the UncheckAll function and instead manually unchceking sections:<br />
  !insertmacro UnselectSection ${g2o1}<br />
  !insertmacro UnselectSection ${g2o2}<br />
  !insertmacro UnselectSection ${g2o3}<br />
<br />
It would be nice to use Uncheckall for maintenance purposes. It seems like Uncheckall should be calling an api to get a list of all functions before looping through them. My lack of knowledge, I suppose. Stu, should you resolve the section looping issue, all would benefit from a working function.<br />
Thanks for the usage tips on the macros. Where are these documented?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th February 2005, 12:12</div></div><div class="posttext">Uhm yes I see the problem...<br />
!include Sections.nsh<br />
Function UncheckAll<br />
 Push $R0<br />
  StrCpy $R0 0<br />
  Loop: !insertmacro UnselectSection $R0<br />
  IntOp $R0 $R0 +1<br />
  StrCmp $R0 ${LastSection} 0 Loop<br />
  !insertmacro SelectSection &quot;${SpecialSection}&quot;<br />
 Pop $R0<br />
FunctionEnd<br />
<br />
Needed to increment $R0 by one every time.<br />
Each section in an installer has an index; ie the first section is at index 0, the second is at 1 and so on.<br />
When you use<br />
Section &quot;my section&quot; SecID<br />
SectionEnd<br />
${SecID} will be defined as (or rather, it will contain) the section index of that section.<br />
<br />
So the function loops from 0 till it reaches ${LastSection} unselecting each one.<br />
Then I've put in<br />
!insertmacro SelectSection &quot;${SpecialSection}&quot;<br />
to re-select your special section for the 2nd install files page, because it is unselected as default (using the /o switch)<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>