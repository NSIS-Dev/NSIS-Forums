<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Two install dirs ?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Two install dirs ? NSIS Discussion" />
	
	<title> Two install dirs ? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Two install dirs ?</div>
<hr />
<div class="pda"><a href="t-293967.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=293967">Two install dirs ?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">magicpm7</div><div class="date">4th July 2008, 10:11</div></div><div class="posttext">Hi,<br />
<br />
first of all, please excuse my approximative English (Foreign Languages have never been a famous strength of french people ^^)<br />
<br />
I'm using NSIS &amp; MUI to install several software, and I need :<br />
<br />
- to extract data in a temporary folder<br />
- then, to perform the install in a different folder<br />
<br />
So, here's the code I try to use :<br />
<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_DIRECTORY ; choose the directory for extraction<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
!insertmacro MUI_PAGE_DIRECTORY ; choose the directory for installation<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
$INSTDIR is initialized in Function .onInit with the default extraction dir value (let's say C:\Temp) : when the first Directory page appears, C:\Temp is in the textfield. What I'd like to do is to change it after that, so that in the second Directory page, the installation dir (let's say C:\Install) is in the textfield.<br />
<br />
I tried to change $INSTDIR between the two Directories pages, unsuccessfully. The directory remains the same (C:\Temp).<br />
<br />
Any ideas ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Corpio</div><div class="date">4th July 2008, 10:44</div></div><div class="posttext">Hello magicpm7,<br />
<br />
It seems to me you can't use two directory pages in the same installer !!!<br />
Use one directory page (the directory will be stocked in $INSTDIR)<br />
Simulate the second in a custom page using for example nsDialog plugin or InstallOption plugin (the directory will be stocked in a global variable that you will create).<br />
<br />
In your sections, you will be able to switch between the two directories thanks to the SetOutPath function.<br />
<br />
<br />
Look at the next post, there are a better solution with two directory pages.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">4th July 2008, 12:12</div></div><div class="posttext">You can use two directory pages.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pospec</div><div class="date">4th July 2008, 12:16</div></div><div class="posttext">Oh, I forgot an attachment... :rolleyes:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">magicpm7</div><div class="date">7th July 2008, 10:35</div></div><div class="posttext">Actually I changed my mind and used another solution (same root directory, two folders : one for extraction, one for installation) but thanks for the answer !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">magicpm7</div><div class="date">24th July 2008, 10:45</div></div><div class="posttext">I finally had to use your solution pospec... And indeed I don't have 2 but 3 directory pages ! :weird: <br />
<br />
But this brings another question... My script allows the user to choose which products he wabts to install, and depending on the ones he has selected in the !MUI_PAGE_COMPONENTS, I would like to display / hide the corresponding directory page.<br />
<br />
For example, if I have these pages :<br />
<br />
[CODE]<br />
PageEx directory ; Product1 directory selection<br />
  DirText &quot;Set Install Directory for ${Product1_name} :&quot;<br />
  DirVar $Product1<br />
  Caption &quot;: ${Product1_name}&quot;<br />
PageExEnd<br />
<br />
PageEx directory ; Product2 directory selection<br />
  DirText &quot;Set Install Directory for ${Product2_name} :&quot;<br />
  DirVar $Product2<br />
  Caption &quot;: ${Product2_name}&quot;<br />
PageExEnd<br />
[CODE]<br />
<br />
and if the user only ticks Product1 in the !MUI_PAGE_COMPONENTS, how can the page for Product2 NOT be displayed ?<br />
<br />
Thanks !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">24th July 2008, 17:00</div></div><div class="posttext">pospec's example was for a classic install.  If you use MUI, then you should be using the MUI_PAGE_DIRECTORY macros.  Before inserting each macro, define your directory variable using MUI_DIRECTORYPAGE_VARIABLE.<br />
<br />
If you then want to skip one of the directory pages, then use MUI_PAGE_CUSTOMFUNCTION_PRE function.  In your function, you can check for the appropriate condition and then call ABORT if you want to skip the page.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>