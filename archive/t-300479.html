<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" One-click installer: Remove &quot;Installation Complete&quot; close prompt?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  One-click installer: Remove &quot;Installation Complete&quot; close prompt? NSIS Discussion" />
	
	<title> One-click installer: Remove &quot;Installation Complete&quot; close prompt? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  One-click installer: Remove &quot;Installation Complete&quot; close prompt?</div>
<hr />
<div class="pda"><a href="t-300479.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=300479">One-click installer: Remove &quot;Installation Complete&quot; close prompt?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pbenson</div><div class="date">30th November 2008, 20:25</div></div><div class="posttext">Hi! I am not a developer, but I am a Systems Engineer who often has to come up with improvised solutions for others in the field.<br />
<br />
Some of my users have a need for a one-click installation. WinZip's self-extractor has some issues with the package. I discovered NSIS and HM NSIS and was very impressed. So far I've been able to do a lot with NSIS in a very short period of time (a couple of days) despite being a first time user. Yet there is one hurdle I haven't been able to get past and that I have not found an answer to elsewhere (wiki, forum posts, manuals, etc.).<br />
<br />
I can't eliminate the &quot;Installation Complete&quot; screen with a single &quot;Close&quot; button that appears after the package has unloaded all of the files and launched an installation script.<br />
<br />
Here is the script that I am compiling (edited so as not to contain sensitive info):<br />
<br />
; Script generated by the HM NIS Edit Script Wizard.<br />
<br />
; HM NIS Edit Wizard helper defines<br />
!define PRODUCT_NAME &quot;Program&quot;<br />
!define PRODUCT_VERSION &quot;11.30.2008&quot;<br />
!define PRODUCT_PUBLISHER &quot;Company&quot;<br />
!define PRODUCT_WEB_SITE &quot;http://www.website.com&quot;<br />
!define PRODUCT_DIR_REGKEY &quot;Software\Microsoft\Windows\CurrentVersion\App Paths\setup.exe&quot;<br />
<br />
; MUI 1.67 compatible ------<br />
!include &quot;MUI.nsh&quot;<br />
<br />
; MUI Settings<br />
!define MUI_ABORTWARNING<br />
!define MUI_ICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico&quot;<br />
<br />
; Welcome page<br />
; !insertmacro MUI_PAGE_WELCOME<br />
; Instfiles page<br />
!insertmacro MUI_PAGE_INSTFILES<br />
; Finish page<br />
; !define MUI_FINISHPAGE_RUN &quot;$INSTDIR\Install.exe&quot;<br />
; !insertmacro MUI_PAGE_FINISH<br />
<br />
; Language files<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
; MUI end ------<br />
<br />
Name &quot;${PRODUCT_NAME} ${PRODUCT_VERSION}&quot;<br />
OutFile &quot;output.exe&quot;<br />
InstallDir &quot;$TEMP\program&quot;<br />
ShowInstDetails nevershow<br />
<br />
Section &quot;MainSection&quot; SEC01<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  SetOverwrite try<br />
  File &quot;C:\Install.exe&quot;<br />
  Exec &quot;$INSTDIR\Install.exe&quot;<br />
SectionEnd<br />
<br />
As you can see the script is pretty simple. Install.exe is a compiled Auto IT script that does the work. I'm using NSIS to package the files with, and to unpackage the files into the temp directory and then to launch the Install.exe program with.<br />
<br />
I think that my problem is with the MUI_PAGE_INSTFILES macro in the system.nsh file for the Modern UI. <br />
<br />
!macro MUI_PAGE_INSTFILES<br />
<br />
  !verbose push<br />
  !verbose ${MUI_VERBOSE}<br />
<br />
  !insertmacro MUI_PAGE_INIT<br />
<br />
  !insertmacro MUI_SET MUI_${MUI_PAGE_UNINSTALLER_PREFIX}INSTFILESPAGE<br />
<br />
  PageEx ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}instfiles<br />
<br />
    PageCallbacks ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}mui.InstFilesPre_${MUI_UNIQUEID} ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}mui.InstFilesShow_${MUI_UNIQUEID} ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}mui.InstFilesLeave_${MUI_UNIQUEID}<br />
<br />
    Caption &quot; &quot;<br />
<br />
  PageExEnd<br />
<br />
  !insertmacro MUI_FUNCTION_INSTFILESPAGE ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}mui.InstFilesPre_${MUI_UNIQUEID} ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}mui.InstFilesShow_${MUI_UNIQUEID} ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}mui.InstFilesLeave_${MUI_UNIQUEID}<br />
<br />
  !insertmacro MUI_UNSET MUI_INSTFILESPAGE_FINISHHEADER_TEXT<br />
  !insertmacro MUI_UNSET MUI_INSTFILESPAGE_FINISHHEADER_SUBTEXT<br />
  !insertmacro MUI_UNSET MUI_INSTFILESPAGE_ABORTWARNING_TEXT<br />
  !insertmacro MUI_UNSET MUI_INSTFILESPAGE_ABORTWARNING_SUBTEXT<br />
<br />
  !verbose pop<br />
<br />
!macroend<br />
<br />
I could be completely wrong here though and would really appreciate some help. Is there a way to remove this prompt for the installation complete?<br />
<br />
Thanks in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th November 2008, 22:22</div></div><div class="posttext">Use SetAutoClose true in your section.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">30th November 2008, 22:29</div></div><div class="posttext">4.8.1.3 AutoCloseWindow (http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.3) <br />
true|false <br />
Sets whether or not the install window automatically closes when completed. This is overrideable from a section using SetAutoClose.<br />
<br />
<br />
Try adding &quot;AutoCloseWindow true&quot; to your script, perhaps after the &quot;!define PRODUCT...&quot; lines.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st December 2008, 00:53</div></div><div class="posttext">If you are just launching another installer, you might as well just do away with MUI and make a silent installer:<br />
SetCompressor /solid lzma<br />
OutFile silent.exe<br />
SilentInstall silent<br />
<br />
Section<br />
InitPluginsDir<br />
SetOutPath $PLUGINSDIR<br />
SetOverwrite try<br />
File C:\Install.exe<br />
Exec `&quot;$PLUGINSDIR\Install.exe&quot;`<br />
SectionEnd<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pbenson</div><div class="date">1st December 2008, 04:14</div></div><div class="posttext">Thanks! The &quot;SetAutoClose true&quot; instruction did the trick. I'll be looking into the silent install as an improvement for the next version of this little project.<br />
<br />
Again, thanks a lot! I'm sure that I'll be using NSIS a lot more often in the future.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd December 2008, 15:53</div></div><div class="posttext">Note that the above code I posted is a complete script.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>