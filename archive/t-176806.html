<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to close..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to close... NSIS Discussion" />
	
	<title> How to close... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to close...</div>
<hr />
<div class="pda"><a href="t-176806.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=176806">How to close...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Ferekikoo</div><div class="date">16th April 2004, 00:53</div></div><div class="posttext">How can i close a running program before i start copying the new files...<br />
please put a example with the answer!:D :winamp:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">16th April 2004, 03:13</div></div><div class="posttext">1)FindWindow $R0 &quot;ProcessName&quot;<br />
<br />
And after:<br />
<br />
SendMessage $R0 ${WM_QUIT}<br />
<br />
OR<br />
<br />
SendMessage $R0 ${WM_CLOSE}<br />
<br />
Replace &quot;ProcessName&quot; with the name of the process to close (with a window as &quot;WM&quot; means &quot;Window Messages&quot;).<br />
<br />
Note: Sometimes ${WM_CLOSE} has a different effect than ${WM_QUIT}, test both messages to see what happens with the program.<br />
<br />
OR<br />
<br />
2) To follow this way you need the plugin &quot;KillProcDLL&quot; which you can find on the Archive.<br />
<br />
KillProcDLL::KillProc &quot;ProgramToClose.exe&quot;<br />
<br />
Replace &quot;ProgramToClose.exe&quot; with the program you want to close.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ferekikoo</div><div class="date">18th April 2004, 23:43</div></div><div class="posttext">Thanks it work!:D :winamp:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ferekikoo</div><div class="date">20th April 2004, 19:51</div></div><div class="posttext">When i use this code this error appere in the log<br />
<br />
Code:<br />
FindWindow $R0 &quot;ProcessName&quot;<br />
SendMessage $R0 ${WM_QUIT}<br />
 Error:<br />
SendMessage expects 4-6 parameters, got 2.<br />
<br />
:rolleyes: :rolleyes:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">20th April 2004, 20:17</div></div><div class="posttext">Whoops:<br />
<br />
SendMessage $R0 ${WM_QUIT} &quot;&quot; &quot;&quot;<br />
<br />
OR<br />
<br />
SendMessage $R0 ${WM_CLOSE} &quot;&quot; &quot;&quot;<br />
<br />
(I thought these were working because you said so...)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ferekikoo</div><div class="date">20th April 2004, 20:47</div></div><div class="posttext">i'm sorry i ment the KillProcDLL plugin...<br />
Thanks again... :up: :up: :up: :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ferekikoo</div><div class="date">21st April 2004, 00:47</div></div><div class="posttext">I tried it but nothing happend ??#!$ :cry:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">21st April 2004, 03:19</div></div><div class="posttext">Process is not a program file, is a space in memory of an aplication running, in this case you need to know the name of the process that the main window of Winamp.exe is identified. In this case, the process name is &quot;BaseWindow_RootWnd&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ferekikoo</div><div class="date">21st April 2004, 11:15</div></div><div class="posttext">I'm soooooooo sorry but it also didn't work!!!<br />
if you can please write the nsi file &amp; attach it with the answer.... :( :( :( <br />
Also please write how to get the process name for any program...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ferekikoo</div><div class="date">21st April 2004, 11:16</div></div><div class="posttext">I forget the attachment !:D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ferekikoo</div><div class="date">21st April 2004, 12:14</div></div><div class="posttext">I found this and it works with winamp 5  :up:<br />
Close/exit a program (http://nsis.sourceforge.net/archive/viewpage.php?pageid=86)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">21st April 2004, 12:23</div></div><div class="posttext">FindWindow user_var(hwnd output) windowclass [windowtitle]<br />
Second parameter is a top level (if [windowparent] parameter was omitted) window class name, not a process name. Looking from my corner, process may have or may have not window. &quot;BaseWindow_RootWnd&quot; looks like class name, but I am not sure - you can get correct class name using Spy++ utility. If you can close running program using Ctrl-Alt-Del, this trick should work with WM_CLOSE from NSIS script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">21st April 2004, 20:44</div></div><div class="posttext">Whoops, yeah you're right. I need to relax before answering a question, or I get it wrong...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>