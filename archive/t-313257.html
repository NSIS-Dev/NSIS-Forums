<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Is there a way to insert specific macro language with MUI, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Is there a way to insert specific macro language with MUI NSIS Discussion" />
	
	<title> Is there a way to insert specific macro language with MUI [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Is there a way to insert specific macro language with MUI</div>
<hr />
<div class="pda"><a href="t-313257.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=313257">Is there a way to insert specific macro language with MUI</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">webtubbies</div><div class="date">2nd October 2009, 14:36</div></div><div class="posttext">Hello,<br />
<br />
I'm trying to use the '!insertmacro MUI_LANGUAGE &quot;myLMang&quot;' in a specific way.<br />
<br />
First i have one install which store the language the user chose. <br />
<br />
!define MUI_LANGDLL_REGISTRY_ROOT HKLM<br />
!define MUI_LANGDLL_REGISTRY_KEY &quot;SOFTWARE\${Registry}&quot;<br />
!define MUI_LANGDLL_REGISTRY_VALUENAME &quot;${Langinstall}&quot;<br />
<br />
<br />
Then the second installer get the language in the registry (i.e. 1033 for English). The installer doesn't display language  listBox.<br />
So I want insert the right language in the script (here &quot; !insertmacro MUI_LANGUAGE &quot;English&quot; &quot;<br />
<br />
My problem is that I can't use this macro in a function and I can't use switch case out of a function.<br />
<br />
Does anyone got an Idea to help my poor brain...?<br />
Here's my code:<br />
<br />
${Switch} $LANGUAGE<br />
	${Case} '1033'<br />
		!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
		${Break}<br />
	${Case}  '1036'<br />
		!insertmacro MUI_LANGUAGE &quot;French&quot;<br />
		${Break}<br />
	${Default}<br />
		${Break}<br />
${EndSwitch}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">3rd October 2009, 13:37</div></div><div class="posttext">I am not sure what you are trying to do.<br />
<br />
You have two installers. The first one offers a choice of languages (English and French?). This installer stores the selected language in the registry.<br />
<br />
After you have run the first installer you want to run another installer. The second installer is to use whatever language was selected when the first installer was run.<br />
<br />
I think your problem is that you do not know how to make the second installer use the correct language.<br />
<br />
Have you looked at the multi-language MUI example that comes with NSIS?<br />
<br />
Try compiling the Examples\Modern UI\MultiLanguage.nsi script to make the MultiLanguage.exe demo installer.<br />
<br />
The first time I ran MultiLanguage.exe on my English version of Windows it showed a language selection dialog with &quot;English&quot; pre-selected. I used the dialog box to select &quot;French&quot; and ran the demo installer (and all the pages were in French).<br />
<br />
After the installer finished, I ran MultiLanguage.exe again. This time it did not show the language selection dialog so the very first thing that appeared was the License page and that was all in French (even though I was running it on an English version of Windows). This happened because the installer was using the language setting stored in the registry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">3rd October 2009, 18:59</div></div><div class="posttext">leave your macros outside the section, where they belong. to switch the language you just need to do this:<br />
StrCpy $LANGUAGE &quot;1033&quot;<br />
i guess you have to use this before your GUI is initialized (onInit or onGUIInit).<br />
<br />
unless you need the language stores in the registry permanently, i think it's good practice to execut second installer with a parameter (mySetup.exe /L=1033).<br />
<br />
http://nsis.sourceforge.net/Docs/AppendixE.html#E.1.12</div></div><hr />


<div class="post"><div class="posttop"><div class="username">webtubbies</div><div class="date">5th October 2009, 08:56</div></div><div class="posttext">Originally posted by pengyou <br />
I am not sure what you are trying to do.<br />
<br />
You have two installers. The first one offers a choice of languages (English and French?). This installer stores the selected language in the registry.<br />
<br />
After you have run the first installer you want to run another installer. The second installer is to use whatever language was selected when the first installer was run.<br />
  <br />
<br />
Yes that's the point. I have to have a close look to the example MultiLanguage.nsi.<br />
<br />
<br />
to switch the language you just need to do this:<br />
<br />
code:--------------------------------------------------------------------------------StrCpy $LANGUAGE &quot;1033&quot;--------------------------------------------------------------------------------<br />
i guess you have to use this before your GUI is initialized (onInit or onGUIInit).<br />
<br />
<br />
<br />
That's what I've done with no success...<br />
<br />
Use the switch /L with the installer is a good advice. I'll try it. But at this time it's an external program (i.e. I can't handle it) which calls my second installer.<br />
<br />
Thank you both. I'll be back to tell you if i can find a fix  :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">webtubbies</div><div class="date">5th October 2009, 09:55</div></div><div class="posttext">Ok, It's working now.<br />
What I have done in the second installer is:<br />
<br />
Put these lines:<br />
<br />
!define MUI_LANGDLL_REGISTRY_ROOT HKLM <br />
!define MUI_LANGDLL_REGISTRY_KEY &quot;SOFTWARE\${Registry}&quot; <br />
!define MUI_LANGDLL_REGISTRY_VALUENAME &quot;${Langinstall}&quot;<br />
<br />
then in the OnInit:<br />
<br />
!insertmacro MUI_LANGDLL_DISPLAY<br />
<br />
First I thought,that copying the registry value (1033 or 1036) in the $LANGUAGE variable was enough.<br />
According to the MUI documentation: <br />
!If you want the installer to display a language selection dialog (see the the MultiLanguage.nsi example), insert the MUI_LANGDLL_DISPLAY macro in the .onInit function<br />
<br />
So i don't understand why I have to insert this code, because I don't want the language listBox. And in this case it's not shown... Did I miss something?<br />
<br />
Anyhow, it's working now.<br />
<br />
Thank You.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">5th October 2009, 11:13</div></div><div class="posttext">So i don't understand why I have to insert this code, because I don't want the language listBox. And in this case it's not shown... Did I miss something?The language selection dialog will only appear if no language setting is found in the registry. I mentioned this in my earlier message (the first time I ran the demo I saw the dialog but the second time I ran the demo the box did not appear).<br />
<br />
There is another MUI setting you can use if you ALWAYS want the language selection dialog to appear. See the MUI readme:To customize the language selection dialog interface, use these defines before inserting the MUI_LANGDLL_DISPLAY macro.<br />
<br />
MUI_LANGDLL_ALWAYSSHOW<br />
Always show the language selection dialog, even if a language has been stored in the registry. The language stored in the registry will be selected by default.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">webtubbies</div><div class="date">5th October 2009, 11:26</div></div><div class="posttext">Damn,<br />
<br />
I did not read the entire section. Sorry about that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">5th October 2009, 11:36</div></div><div class="posttext">Don't worry about that. I have read the documents lots of times and still find new things in them.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>