<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" UpgradeDLL question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  UpgradeDLL question NSIS Discussion" />
	
	<title> UpgradeDLL question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  UpgradeDLL question</div>
<hr />
<div class="pda"><a href="t-128187.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=128187">UpgradeDLL question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">12th March 2003, 14:02</div></div><div class="posttext">hello again !<br />
<br />
actualy i have 2 questions:<br />
<br />
1. i am using the UpgradeDLL and ShareDLL (as explained on NSIS Dev Site in &quot;how to install vb6 runtime files&quot;). it's very strange, on diferent operating sistems i have diferent errors. ex. i have ususaly 2-3 errors for the &quot;oleaut32.dll&quot;, &quot;olepro32.dll&quot; and sometimes for &quot;stdole2.tlb&quot; and always for &quot;msjet35.dll&quot;. i don't know if the name of the files are important... i saw that the files are installed and registered corectly after reboot (the problem files), so everything is ok except for the error message (abort, retry, ignore)... so my question is : how NOT to show that message??? something to bypass this message ??? eventualy to display it in the install log, but not to stop the install process ??? some ideas ?<br />
<br />
2. i am using multiple languages. i set the default language to english, but i saw that the installer detects the system regional settings and in concluzion the default language is NOT english... how can i set the default language, and to stay that way ?<br />
<br />
thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">12th March 2003, 14:29</div></div><div class="posttext">1. Which error message do you get? File in use? UpgradeDLL inserts SetOverwrite try, so you should not get the error? Did you remove that line?<br />
<br />
2. StrCpy $LANGUAGE ${LANG_ENGLISH}<br />
before the language selection dialog.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">12th March 2003, 15:40</div></div><div class="posttext">the language is ok. thank you.<br />
<br />
i'm ataching a bitmap with the error messages.<br />
<br />
thanks.<br />
<br />
ps: i modified &quot;SetOverwrite Try&quot; to &quot;SetOverwrite IfNewer&quot;. no programs are opened, none in taskbar, and i tried also to reboot the system before the installation - same result.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">12th March 2003, 15:49</div></div><div class="posttext">The macro handles the version check, you should never modify SetOverwrite.<br />
<br />
Set SetOverwrite to whatever you like for your script after inserting the macro.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">12th March 2003, 16:06</div></div><div class="posttext">ok. i tested on 3 pc's - WinXP, Win2000 and Win98 and it seems to work fine. thanks.<br />
<br />
sorry for all this questions...:( <br />
<br />
thanks again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">13th March 2003, 06:57</div></div><div class="posttext">well... it does not work !<br />
<br />
in a clean, just installed Win98SE (interesesting - the 3rd system with 98 that i tested) the installer does not copy not a sigle dll.<br />
<br />
and in WinXP i still have the error for &quot;msjet35.dll&quot; as in the JPG i atached.<br />
<br />
any ideas ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th March 2003, 13:22</div></div><div class="posttext">NSIS doesn't show that message box if the overwrite flag is set to try. Are you sure you didn't try with an old installer?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th March 2003, 15:52</div></div><div class="posttext">Please try again with the original macro.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">13th March 2003, 16:02</div></div><div class="posttext">now it is the original macro.<br />
<br />
the &quot;abort, retry, ignore&quot; messages are gone, but i still have the &quot;the application failed to start ... msjet35.dll...&quot;.<br />
<br />
and there is the other problem: on win9x (the installer except for this message, does not show any errors, and this error only on NT systems - W 2K, W XP) the installer does not show any errors, but some dll files does not register and/or oinstall corectly (i think) because my program (vb) does not start. &quot;class not registered&quot;.<br />
<br />
i'm very confused. <br />
help!<br />
<br />
thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th March 2003, 16:08</div></div><div class="posttext">Do you know that you have to reboot before most of the DLL's will be installed? You should add a Finish page, which will automatically ask for a reboot.<br />
<br />
If you want the installer to start apps that need the new DLL, you should add the filename to the registry to let Windows start it after the reboot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">13th March 2003, 16:10</div></div><div class="posttext">i have a finish page and i do reboot...<br />
<br />
any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th March 2003, 16:10</div></div><div class="posttext">heh, never mind :)<br />
<br />
Are you checking for the reboot flag or using the MUI's finish page? If the reboot flag is set after this macro you must reboot for the registration to complete.<br />
<br />
The MUI's finish page shows a &quot;Are you sure you want to reboot?&quot; message for you if the reboot flag is set.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">14th March 2003, 07:00</div></div><div class="posttext">it's very strange. on a new win98 works corectly, my program works. on another it does not. i will try to figure it out.!?<br />
<br />
thanks again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th March 2003, 08:52</div></div><div class="posttext">So you still get the 'File in use' error? And you are absolutely sure that there is 'SetOverwrite try' in the macro?<br />
<br />
NSIS never complains about a file in use when overwrite is set to try.<br />
<br />
Can you attach the complete script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">14th March 2003, 08:59</div></div><div class="posttext">here is my script.<br />
<br />
one question:<br />
<br />
can i log in a file everything that UpgradeDLL and ShareDLL are trying to copy/upgrade/register ?<br />
<br />
ex: x1.dll -&gt; skiped.<br />
    x2.dll -&gt; registering on reboot.<br />
    x3.dll -&gt; registered.<br />
<br />
is it posible? it would be usefull for  the uninstall process. if one dll was on the system - the uninstaller will not remove it...<br />
<br />
thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th March 2003, 09:06</div></div><div class="posttext">You should never remove VB6 runtime files, even if you have installed them. They are used by many applications and may be used my applications in the future.<br />
<br />
The shared DLL registration does not always work correctly. If an application does not install the DLL's but only asks the user to install the MS runtimes, the application will not be registered as a user of the DLL.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th March 2003, 09:09</div></div><div class="posttext">About your script:<br />
<br />
SetOverwrite try should be inside the macro.<br />
<br />
Please get the complete orignal macro from http://nsis.sourceforge.net/archive/nsisweb.php?page=21. That should work.<br />
<br />
This macro automatically sets overwrite to on after it has been inserted, so you do not have to add 'SetOverwrite on' after inserting the macro. If you want another SetOverwrite value, you still have to set it again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">14th March 2003, 09:20</div></div><div class="posttext">ok. i will try i a few minutes and i'll tell you how it works. thanks for the quick reply.<br />
<br />
thanks again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">14th March 2003, 10:35</div></div><div class="posttext">I FOUND THE ERROR !!! it was ME ...<br />
<br />
well, first i observed that i was getting the error message about a dll when the installer was copying another dll. :weird: <br />
<br />
so, i finaly read the error message. :igor: and the error mesage was not telling me that some dll was not copied/registered corectly, was telling me that the dll was not found! :up: <br />
i have 5 dll files that are linked. changed the order of the files at instalation... and ... DONE! <br />
<br />
i am testing it now. thanks everyone.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>