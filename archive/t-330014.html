<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" nsDialogs checkbox lose its hadle, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  nsDialogs checkbox lose its hadle NSIS Discussion" />
	
	<title> nsDialogs checkbox lose its hadle [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  nsDialogs checkbox lose its hadle</div>
<hr />
<div class="pda"><a href="t-330014.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330014">nsDialogs checkbox lose its hadle</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jammusi</div><div class="date">25th April 2011, 12:00</div></div><div class="posttext">Hi<br />
<br />
<br />
In the custom page I create check box (among  other controls) and keep its handle<br />
<br />
           ${NSD_CreateCheckBox} 0 $3 50% 6% &quot;${RESTORE_DB_CHECKBOX_TEXT}&quot;<br />
	   Pop $checkBoxRestoreDB<br />
	   ;Set default<br />
	   ${NSD_SetState} $checkBoxRestoreDB ${BST_CHECKED} <br />
	   ${NSD_OnClick} $checkBoxRestoreDB DisplayOrHideAdminUserAndPass<br />
<br />
<br />
In the Page leave function there is some logic which might Abort of the page leave and keep displaying the page. <br />
<br />
Under some flows (depend of the user selections) the variable $checkBoxRestoreDB that holds the check box handle  have another value - the name of installer single section<br />
<br />
Renaming the section, and recompiling - and now the variable has the new section name.<br />
Obviously I do not do it myself - setting this variable to hold the section name. as all I have changed is: <br />
<br />
Section &quot;Server Filess&quot; SecServerFiles<br />
<br />
it took some time to find a workaround which is even weirder<br />
<br />
I just added a log print of the handle <br />
If I still write the line without the handle - i have problem again<br />
<br />
The LogPrint macro writes a line to the log file <br />
<br />
<br />
!insertmacro LogPrint &quot;ConnectAndCheckIfDataBaseExist 3: check box handle: $checkBoxRestoreDB&quot;<br />
<br />
!macro LogPrint msg<br />
<br />
	;Open log file for append<br />
	LogEx::Init &quot;$LogFileName&quot;	<br />
	<br />
	;Write log message<br />
	LogEx::Write true true &quot;${msg}&quot;<br />
	<br />
	;Close<br />
	LogEx::Close<br />
	<br />
	;write message to the Log file created by the NSIS special build (LogSet)<br />
	LogText &quot;${msg}&quot;<br />
	<br />
!macroend<br />
<br />
<br />
<br />
This all thing looks very weird to me and I'm sure there is something here which I miss. <br />
Anyone?<br />
<br />
tx<br />
<br />
Oren</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">25th April 2011, 15:49</div></div><div class="posttext">Well you state that you're not touching the variable after you pop it, but that is still the most likely explanation - something you do (or a function/macro does) tells NSIS to store something else in the variable. Please create for us a minimal script that shows this problem. Chances are, you'll find the cause of the problem in the process. If not, it will allow the devs to find out what's happening under the hood.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jammusi</div><div class="date">25th April 2011, 16:22</div></div><div class="posttext">Maybe you're right<br />
yet,<br />
how come simple logging  the handle makes all good?<br />
and another,<br />
the section name - where did it come from?<br />
<br />
I will try to recreate it within a small script<br />
<br />
tx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th April 2011, 16:33</div></div><div class="posttext">Once you have left the nsDialogs page, its controls are destroyed and the handle is no longer valid. You should not be using that variable anywhere else unless you have specifically set it to something else. Otherwise it's just a handle, i.e. an integer value.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jammusi</div><div class="date">25th April 2011, 16:48</div></div><div class="posttext">I am aborting (i.e call the Abort function) the page_leave function. <br />
As I understand - this is not leaving the page. <br />
The creator_page function is not called again and all variables have the proper value.<br />
<br />
Am I wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th April 2011, 22:05</div></div><div class="posttext">Sorry when you mentioned sections I assumed you were reusing the variable there. But no, the handle is still valid in the leave function. Any time after then, it should still have an integer value.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>