<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Is this possible with NSIS?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Is this possible with NSIS? NSIS Discussion" />
	
	<title> Is this possible with NSIS? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Is this possible with NSIS?</div>
<hr />
<div class="pda"><a href="t-248270.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=248270">Is this possible with NSIS?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">prnf</div><div class="date">9th June 2006, 12:16</div></div><div class="posttext">Hello,<br />
<br />
First of all, let me apologize for such a long question. I'm new to NSIS and would like to hear from you before dwelving into the system.<br />
We're finishing a new version of our application built using .NET Framework 2.0 and I would like to know if the following is possible with NSIS:<br />
Our software has an application server for ASP.NET webservices that has to run inside IIS connected to an SQL Server database.<br />
Then it has the client, which is a .NET WinForms application to be distributed in a LAN Intranet.<br />
The ASP.NET server must be updated from time to time and this update will also have to run some SQL scripts on the database, and it should have an option to  auto-update itself from the Web. It may also be needed to update the server manually with an executable that will do the job. Either way, during the server update process, the new client version will also be put into a specific place on the server. Every Client should check if there is a new version on the server, and automatically update itself before launch. This way, clients (which may only have intranet access) always get the update first.<br />
I know this is a bit complex, but we have done this with the previous version of our application in Win32 and we don't want to go into developing it again for .NET.<br />
Is it possible to do this with NSIS?<br />
Thank you very much for your attention.<br />
<br />
Regards,<br />
paulo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">10th June 2006, 18:38</div></div><div class="posttext">NSIS can do just about anything you want it (limited only by your imagination.)  It's up to you (the developer) to decide how to implement each task.  <br />
<br />
Here's a few broad suggestions to get you started:<br />
<br />
 First, you want your ASP.NET application to be able to update itself from the web.  I'd start by looking at the InetLoad plugin (http://nsis.sourceforge.net/InetLoad_plug-in).<br />
<br />
 Next, you say you need your application server to be able to run SQL scripts.  I assume you are using MS SQL?  If so, I'd look into using osql.exe (http://msdn2.microsoft.com/en-us/library/ms162806.aspx) .  This is a command line utility from Microsoft that you can use to issue SQL commands.  If you need to hide the DOS screens, you can use nsExec (included with NSIS) or the ExecDOS (http://nsis.sourceforge.net/ExecDos_plug-in)  plugin.<br />
<br />
 Finally, you say that you'd need the client to automatically update.  For this, I'd put a text file (or INI file) in the client's directory on the server.  Then, just make a 'helper' exe that checks the file for the version number and compares it to what's on the client and then runs an update if necessary.  (There is a nice version compare header included with NSIS.  Look at Appendix E in the help file.)  The 'helper exe' would be nothing more than an NSIS setup program.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">prnf</div><div class="date">12th June 2006, 10:44</div></div><div class="posttext">Hello Comperio,<br />
<br />
Thank you for reply and advice. It is most needed.<br />
<br />
Regards,<br />
paulo</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>