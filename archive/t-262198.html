<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Re:Onclick Installer, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Re:Onclick Installer NSIS Discussion" />
	
	<title> Re:Onclick Installer [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Re:Onclick Installer</div>
<hr />
<div class="pda"><a href="t-262198.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=262198">Re:Onclick Installer</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">hnmurugan</div><div class="date">21st December 2006, 09:46</div></div><div class="posttext">Dear All,<br />
<br />
Just wondering whether my below request can be done using NSIS.<br />
<br />
I am working in a computer DIY hardware shop and most of the time my job always requires me install same softwares like flash player,java,adobe reader,video lan, realplayer and antiirus softwares.<br />
<br />
I am sick of click next buttons and i have to wait for softwares to be installed before start installing other softwares due some softwares don't allow.<br />
<br />
But i have seen those application recovery cd's from HP and it will let you choose the softwares and it will install automatically using silent switches.<br />
<br />
Is it possible to write a NSIS script that can hdo the same job as application recovery cd does?<br />
<br />
Your inputs in this matter is greately appreciated.<br />
<br />
Rgds/Hari</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">21st December 2006, 12:35</div></div><div class="posttext">It's possible and easy with NSIS.<br />
All you have to do is to associate sections with applications that you wish to install (in my thought one section for every application). Find every application's command line switch for sillent installation and add it like this:<br />
ExecWait (http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1) '&quot;$EXEDIR\app_setup.exe&quot; silent_parameters'.<br />
Compile and burn the installer and all needed applications to the root of a removable media.<br />
Last but not least execute the installer from that media and from components page select the applications that you want to install according to the target machine and take your coffee time :-)<br />
<br />
related:<br />
<br />
Instructions (http://nsis.sourceforge.net/Docs/Chapter4.html#4.9)<br />
<br />
Sections (http://nsis.sourceforge.net/Docs/Chapter4.html#4.6)<br />
<br />
Pages (http://nsis.sourceforge.net/Docs/Chapter4.html#4.5)<br />
<br />
Modern UI (http://nsis.sourceforge.net/Docs/Chapter2.html#2.5)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hnmurugan</div><div class="date">22nd December 2006, 01:15</div></div><div class="posttext">thanks for your time and effort.I will try this during weekend .<br />
Rgds/Hari</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hnmurugan</div><div class="date">24th December 2006, 19:33</div></div><div class="posttext">Dear Red Wine,<br />
<br />
I have managed to get my first installer work successfully. Thanks for your help again.Here is my script below<br />
<br />
Name &quot;${PRODUCT_NAME} ${PRODUCT_VERSION}&quot;<br />
OutFile &quot;Setup.exe&quot;<br />
InstallDir &quot;$PROGRAMFILES&quot;<br />
<br />
Section &quot;Java&quot; SEC01<br />
  ExecWait '&quot;Java\Java.exe&quot; /qr'<br />
SectionEnd<br />
<br />
Section &quot;Flash&quot; SEC02<br />
  ExecWait &quot;Flash\Flash.msi&quot;<br />
SectionEnd<br />
<br />
Could you please answer below questions?<br />
<br />
1.If you notice, section 2 got msi file and it does not execute. How do i call msiexec to execute this?<br />
<br />
2.For the status message, it is displaying executing Java\Java.exe. Instead is it possible to replace with installing Java?<br />
<br />
3.Another improvement - How do i compile my install file in to setup.exe and extract to $tmp then start the install from temp, after delete it.<br />
<br />
Sorry to ask too much.<br />
<br />
Rgds</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th December 2006, 20:11</div></div><div class="posttext">You're welcome!<br />
1.If you notice, section 2 got msi file and it does not execute. How do i call msiexec to execute this?<br />
Use ExecShell open 'path_to_file\Flash.msi'<br />
<br />
<br />
2.For the status message, it is displaying executing Java\Java.exe. Instead is it possible to replace with installing Java?<br />
See NSIS documentation 4.9.14.3 DetailPrint, 4.9.14.14 SetDetailsPrint etc.<br />
<br />
<br />
3.Another improvement - How do i compile my install file in to setup.exe and extract to $tmp then start the install from temp, after delete it.<br />
<br />
Function .onInit<br />
InitPluginsDir<br />
File /oname=$PLUGINSDIR\Java.exe 'Local_path\java.exe'<br />
...<br />
...<br />
FunctionEnd<br />
<br />
Section &quot;Java&quot; SEC01<br />
 ExecWait '&quot;$PLUGINSDIR\Java\Java.exe&quot; /qr'<br />
...<br />
...<br />
SectionEnd<br />
<br />
$PLUGINSDIR removed once the installer is terminated.<br />
See NSIS documentation 4.2.3 Constants and search the forum for examples.<br />
Also don't forget wiki! http://nsis.sourceforge.net<br />
<br />
Happy Holidays!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">25th December 2006, 08:25</div></div><div class="posttext">I was not able to add these corrections to my other post above, so I put them here:<br />
1.If you notice, section 2 got msi file and it does not execute. How do i call msiexec to execute this?<br />
If you want to WAIT for the proccess to terminate before continue then use:<br />
ExecWait 'msiexec.exe /options &quot;path_to_file\file.msi&quot;'<br />
<br />
Section &quot;Java&quot; SEC01<br />
ExecWait '&quot;$PLUGINSDIR\Java\Java.exe&quot; /qr'<br />
...<br />
...<br />
SectionEnd<br />
ExecWait '&quot;$PLUGINSDIR\Java.exe&quot; /qr'</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>