<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Flash.ocx does not get installed, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Flash.ocx does not get installed NSIS Discussion" />
	
	<title> Flash.ocx does not get installed [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Flash.ocx does not get installed</div>
<hr />
<div class="pda"><a href="t-233505.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=233505">Flash.ocx does not get installed</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bg123</div><div class="date">19th December 2005, 01:46</div></div><div class="posttext">I am installing flash.ocx using:<br />
!insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED    &quot;${REDISTRIB}\MACROMED\FLASH\Flash.ocx&quot; &quot;$SYSDIR\MACROMED\FLASH\Flash.ocx&quot; &quot;$SYSDIR&quot;<br />
<br />
My other dlls install ok using a similar directive. The flash.ocx does not get put into the target's &quot;install after reboot&quot; list or anything, the file does not even get copied, let alone registered.<br />
<br />
Target does not have any version of flash installed. Does InstallLib require that sysdir\macromed\flash exist on the target?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhaelochon</div><div class="date">19th December 2005, 15:30</div></div><div class="posttext">I think it's a really bad idea for anyone to try to repackage someone else's installs on a file-by-file basis. Rather, you should require that the end-user already have Flash installed, or you should include the Flash installer in your installer. You can then unpack it to $PLUGINSDIR and run it with an ExecWait statement.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bg123</div><div class="date">19th December 2005, 18:39</div></div><div class="posttext">Um, the fact that it is flash.ocx was mentioned so that anyone who knows about InstallLib would say it is special cased, if it is.<br />
<br />
The specific question is &quot;do we need to create the subdirectory off winsys so InstallLib will copy and register it?&quot;.<br />
<br />
<br />
When I was using the old vb Package Wizard, it found the flash.ocx and installed/registered it correctly. It did not see any dependencies. (I switched to NSIS for many other reasons).<br />
<br />
When this installer runs, and app is started, it gets run time error due to no flash.ocx. Copying the flash.ocx file and registering it fixes it.<br />
<br />
This installer is not intended for general distribution to an end user in the conventional sense (i.e. cannot demand that they get flash). It is for setting up app on a special purpose machine. When installing in the factory, they have the CD but no internet access. Macromedia distros are mostly internet based.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bg123</div><div class="date">20th December 2005, 01:55</div></div><div class="posttext">And the answer is: if the directory under system32 exists, the ocx will be extracted into it and registered. If directory does not exist, it says &quot;skipped&quot; and fails to register.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>