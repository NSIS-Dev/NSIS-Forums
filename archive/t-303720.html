<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem in using message box with custom page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem in using message box with custom page NSIS Discussion" />
	
	<title> Problem in using message box with custom page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem in using message box with custom page</div>
<hr />
<div class="pda"><a href="t-303720.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=303720">Problem in using message box with custom page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">nick_goyal</div><div class="date">3rd March 2009, 13:57</div></div><div class="posttext">i am using one custom page to check the &quot;TCP-Port&quot; whether its open or occupied and if it is occupied it is throwing a message saying this port is occupied.<br />
<br />
my problem is when i click &quot;ok&quot; in &quot;message box&quot; the page moved to the next page and i have to come back to the old page  to change the port. Is there any way to stay at the same page  after clicking the &quot;ok&quot; button of the message box. <br />
<br />
My Function for this operation is <br />
<br />
<br />
Function CustomPage<br />
<br />
  InstallOptions::dialog &quot;$PLUGINSDIR\CustomPage.ini&quot;<br />
  ReadINIStr ${TEMP1} &quot;$PLUGINSDIR\CustomPage.ini&quot; &quot;Field 2&quot; &quot;State&quot;<br />
  ${Unless} ${TCPPortOpen} ${TEMP1}<br />
  #MessageBox MB_OK &quot;${TEMP1} port is free&quot;<br />
  ${Else}<br />
  MessageBox MB_OK &quot;${TEMP1} port is occupied please use some other port &quot;<br />
  ${EndIf}<br />
FunctionEnd<br />
<br />
<br />
Truly grateful for any assistance on this issue.<br />
<br />
Thanks a million!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">3rd March 2009, 14:43</div></div><div class="posttext">Abort is the option.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nick_goyal</div><div class="date">4th March 2009, 05:59</div></div><div class="posttext">Thank you for early reply Red Wine But this option is not working (i used Abort just after the Message Box).<br />
Can you please tell me where to put Abort in this function.<br />
<br />
Thanks in Advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">4th March 2009, 07:09</div></div><div class="posttext">http://nsis.sourceforge.net/Docs/Chapter4.html#4.5.3</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nick_goyal</div><div class="date">4th March 2009, 09:34</div></div><div class="posttext">Hi MSG,<br />
<br />
I have gone through this documentation but not able to use them as per my requirement, This Abort is not working under the condition and after clicking on OK (Message Box)it take me to the next page.<br />
<br />
Thanks in Advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">4th March 2009, 11:12</div></div><div class="posttext">might not have read the documentation correctly, then..  you must call Abort in the custom page's Leave function, not in the Create function<br />
<br />
<br />
Page Custom CustomPageCreate CustomPageLave<br />
<br />
Function CustomPageCreate<br />
InstallOptions::dialog &quot;$PLUGINSDIR\CustomPage.ini&quot;<br />
FunctionEnd<br />
<br />
Function CustomPageLeave<br />
ReadINIStr ${TEMP1} &quot;$PLUGINSDIR\CustomPage.ini&quot; &quot;Field 2&quot; &quot;State&quot;<br />
${Unless} ${TCPPortOpen} ${TEMP1}<br />
#MessageBox MB_OK &quot;${TEMP1} port is free&quot;<br />
${Else}<br />
MessageBox MB_OK &quot;${TEMP1} port is occupied please use some other port &quot;<br />
Abort<br />
${EndIf}<br />
FunctionEnd<br />
<br />
<br />
Edit: You might want to check to make sure that the user actually pressed the Next button by checking '&quot;CustomPage.ini&quot; &quot;Settings&quot; &quot;State&quot;'.  If the value of that ini var is 0 (zero), then the user pressed the Next button.<br />
<br />
I highly recommend moving up to nsDialogs, by the way :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>