<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installation for a pocket pc without Admin privileges, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installation for a pocket pc without Admin privileges NSIS Discussion" />
	
	<title> Installation for a pocket pc without Admin privileges [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installation for a pocket pc without Admin privileges</div>
<hr />
<div class="pda"><a href="t-206479.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=206479">Installation for a pocket pc without Admin privileges</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">psrkumar</div><div class="date">31st January 2005, 19:24</div></div><div class="posttext">Hi!<br />
The desktop OS I have is Windows XP Pro and I am trying to build an installer that installs the application cab files on to a Pocket PC 2003 device. The application is developed with .NET compact framework in C#.<br />
I was able to get a decent installer working using NSIS with a sample provided at http://www.pocketpcdn.com/articles/multicabinstall.html<br />
Our users (clients) are mostly nurses and most of them do not have admin privileges. The installer that I have right now won't run without admin privileges. <br />
I tried to find out in the help documentation if there was a way to do it and in the archives too but I didn't find much information related to this scenario.<br />
If anyone has any suggestions, resources or keywords that I should be searching with, then please let me know. I can attach the script file that I am using, if it is needed.<br />
Thank you for your time.<br />
<br />
Regards,<br />
Raj</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st February 2005, 18:12</div></div><div class="posttext">Can you pinpoint exactly what requires admin privileges?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psrkumar</div><div class="date">1st February 2005, 20:29</div></div><div class="posttext">Thank you for responding, Kichik.<br />
In the installer, some registry keys are created in HKLM\software during installation and for uninstallation. I believe the admin privileges are needed for that. After I built the installer with the same script mentioned above and tried to run it with a Standard user account, then I get errors informing that the installer wasn't able to write to the files (eula.txt, readme.html, .ini files or the .cab files). If I run this installer with an administrative account, things go smoothly and the cab files are deployed to the device.<br />
I am attaching the script that I am using for your reference.<br />
Hope I answered your question! Thank you for your time.<br />
<br />
Regards,<br />
Raj</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psrkumar</div><div class="date">2nd February 2005, 16:20</div></div><div class="posttext">I removed the code creating or deleting the registry keys. Instead of using ProgramFiles folder for putting the files, I am using SetOutPath &quot;$TEMP&quot;<br />
Now the installer goes on fine till it comes to the point where it is trying to execute CEAppMgr.exe from the Programfiles folder with a .ini file as input. This .ini file is put in the Temp folder.<br />
The installer fails at this point. I was running the installer with a 'User' permission (no admin privileges).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd February 2005, 18:44</div></div><div class="posttext">It's true that a normal user can't normally write to HKLM, but the errors probably came from trying to install to Program Files.<br />
<br />
What is the error you get from CEAppMgr.exe? Can you run it separately without errors?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psrkumar</div><div class="date">3rd February 2005, 19:57</div></div><div class="posttext">The error I get is titled CEAPPMGR.exe - &quot;The application failed to initialize properly (0xc0000142). Click OK to terminate the app.&quot;<br />
<br />
I used the tools Regmon and Filemon from Sysinternals.com to track what was happening when running the installer. It seems CeAppMgr tries to create some temporary file in the \WINDOWS directory and since the user doesn't have enough permissions, the error appears. The filename looked like c:\WINDOWS\$_hpcst$.hpc. I have no idea what that is.<br />
<br />
From all this, I am inclined to believe that CEAppMgr cannot be run without Admin privileges. For now, we will go with admin installer and maybe later on we will make any changes.<br />
<br />
For the record, NSIS is great! I haven't used a lot of features yet but it is nice. <br />
<br />
Thank you for your time.<br />
Regards,<br />
Raj</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>