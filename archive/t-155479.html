<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" problem with section name, possible bug, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  problem with section name, possible bug NSIS Discussion" />
	
	<title> problem with section name, possible bug [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  problem with section name, possible bug</div>
<hr />
<div class="pda"><a href="t-155479.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=155479">problem with section name, possible bug</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">7th November 2003, 21:21</div></div><div class="posttext">hi there!<br />
i've got a problem with unvisible sections. from the docs i know, that sections name are unvisible, if their namestring is empty, or contains a '-' as first character.<br />
so, i've written the following lines:<br />
(i'm using the latest development snapshot from 7. nov.)<br />
<br />
<br />
#script.nsi<br />
#mainfile, variables and includes<br />
Var	BCDIR<br />
<br />
<br />
# page.nsh<br />
# defining the function, to edit the layout of the componentspage<br />
!define		MUI_PAGE_CUSTOMFUNCTION_SHOW PreComponents<br />
!insertmacro	MUI_PAGE_COMPONENTS<br />
<br />
# functions.nsh<br />
# the function<br />
Function PreComponents<br />
	StrCpy $BCDIR &quot;&quot;<br />
	StrCpy $R0 &quot;&quot;<br />
	ClearErrors<br />
<br />
	ReadRegStr $R0	HKLM &quot;Software\Microsoft\Windows\CurrentVersion\App Paths\bc42.exe&quot; &quot;&quot;<br />
	IfErrors 0 +3<br />
	SectionSetText ${f_b} &quot;&quot;<br />
	Goto End<br />
<br />
	SectionSetText ${f_b} &quot;$(files_bc)&quot;<br />
	GetFullPathName $BCDIR $R0<br />
	End:<br />
FunctionEnd<br />
<br />
<br />
# sections.nsh<br />
# the section<br />
Section /o &quot;&quot; f_b<br />
	SectionIn	2<br />
<br />
	StrCmp $BCDIR &quot;&quot; 0 +3<br />
	StrCpy $R0 &quot;0&quot;<br />
	Goto End<br />
<br />
	Push $OUTDIR<br />
	SetOutPath $BCDIR<br />
	File /nonfatal /r	&quot;.\files_client_full\battlecraft\*.*&quot;<br />
	Pop $OUTDIR<br />
	StrCpy $R0 &quot;1&quot;<br />
<br />
	End:<br />
	WriteRegDWORD	HKLM &quot;Software\${C_COMPANY}\${C_PRODUCT}&quot; &quot;BC1942SupportInstalled&quot;	$R0<br />
SectionEnd<br />
<br />
#lang.nsh<br />
#langstrings<br />
LangString	files_bc	${LANG_ENGLISH}	&quot;Plug-in for Battlecraft42&quot;<br />
LangString	files_bc	${LANG_GERMAN} 	&quot;Plug-In f√ºr Battlecraft42&quot;<br />
 <br />
<br />
(ive splitted the whole script to 8 files, 7* .nsh + 1* .nsi, so its easier for me to read and write.)<br />
<br />
<br />
my problem is, that the section wont get unvisible, neither with '-' nor with empty namestring.<br />
<br />
ps:<br />
for all nsis-scripters interested in my work: i'm currently scripting a comfortable installer for modifications of the game &quot;battlefield 1942&quot;. especially for the stuntfactory modification.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">7th November 2003, 21:42</div></div><div class="posttext">sorry, the description of my problem was uncorrect.<br />
here is the fine version:<br />
- if i define the section with empty name: 'Section &quot;&quot;', it is NEVER shown, even if i change the by 'SectionSetText &quot;abc&quot;'.<br />
- if i define the section with any name: 'Section &quot;abc&quot;', it is ALWAYS shown, even if i change the by 'SectionSetText &quot;-abc&quot;' or 'SectionSetText &quot;&quot;'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th November 2003, 21:43</div></div><div class="posttext">Both specifying an empty name directly after Section and using SectionSetText work fine for me. Check your script for logic errors. Also note that a string that contains just an empty LangString is not an empty string, it has a LangString in it.<br />
<br />
Your latest examples work too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th November 2003, 21:45</div></div><div class="posttext">I looked at the script again. The problem is that you've defined a show function instead of a pre function. When the show function loads the setion names are already loaded and drawn.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>