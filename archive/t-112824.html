<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Using the $Desktop Directive with Delete, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Using the $Desktop Directive with Delete NSIS Discussion" />
	
	<title> Using the $Desktop Directive with Delete [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Using the $Desktop Directive with Delete</div>
<hr />
<div class="pda"><a href="t-112824.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=112824">Using the $Desktop Directive with Delete</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kcostain</div><div class="date">4th November 2002, 21:42</div></div><div class="posttext">Hello,<br />
<br />
I am using NSIS 1.98. I have been trying to delete Desktop shortcuts in my Uninstall section. The following is my code:<br />
<br />
Section Uninstall<br />
SetShellVarContext &quot;Current&quot;<br />
Delete &quot;$DESKTOP\L1.lnk&quot;<br />
Delete &quot;$DESKTOP\L2.lnk&quot;<br />
Delete &quot;$DESKTOP\L1Uninstall.lnk&quot;<br />
DeleteRegKey HKEY_LOCAL_MACHINE &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\L1&quot;<br />
DeleteRegKey HKEY_LOCAL_MACHINE &quot;SOFTWARE\L1&quot;<br />
Delete &quot;$INSTDIR\*.*&quot;<br />
RMDir &quot;$INSTDIR&quot;<br />
SectionEnd<br />
<br />
I am using Windows XP and I have the permission to delete these files. It doesnt matter where the Delete directive is, or if I use the SetShellVarContext, it still fails.<br />
<br />
<br />
Any Ideas?<br />
Kevin Costain</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th November 2002, 15:37</div></div><div class="posttext">Do you get the right directory when you use:<br />
<br />
MessageBox MB_OK $DESKTOP?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kcostain</div><div class="date">5th November 2002, 15:46</div></div><div class="posttext">That was it.. I had the wrong directory, once I fixed that - it worked.. <br />
<br />
Kevin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th November 2002, 15:53</div></div><div class="posttext">I don't understand... Did NSIS get the desktop folder wrong or did you just needed some other folder?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kcostain</div><div class="date">5th November 2002, 16:40</div></div><div class="posttext">If I was to look at it, I was trying to change the Context of the folders assuming that the default context was &quot;All&quot; (I had set this using a SetShellVarContext &quot;All&quot; command in an earlier section), this wasn't working with or without the command:<br />
<br />
SetShellVarContext &quot;Current&quot;<br />
<br />
The key here is, once I used MessageBox to debug the actual directory, I was able to see that the default was &quot;current&quot; and I needed to set &quot;All&quot; again.<br />
<br />
Thanks for the help...<br />
<br />
Kevin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th November 2002, 17:14</div></div><div class="posttext">Please note that there is a bug with SetShellVarContext All and Windows 9x in NSIS 1.98. Instead of falling back to current it will give you the temp folder. This bug has been fixed in NSIS 2.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kcostain</div><div class="date">6th November 2002, 01:05</div></div><div class="posttext">Thanks for the info, how can I get a copy of NSIS 2? I looked at the http://www.nullsoft.com/free/nsis/ page and 1.98 is still there.... ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hotice</div><div class="date">6th November 2002, 01:11</div></div><div class="posttext">Originally posted by kcostain <br />
Thanks for the info, how can I get a copy of NSIS 2? I looked at the http://www.nullsoft.com/free/nsis/ page and 1.98 is still there.... ? <br />
pls visit nsis.sf.net</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kcostain</div><div class="date">6th November 2002, 01:14</div></div><div class="posttext">I've been there... only a pre-release is available.. I guess I could use that but I'm not sure if that will create more problems then its worth...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">virtlink</div><div class="date">6th November 2002, 10:58</div></div><div class="posttext">Originally posted by kcostain <br />
Thanks for the info, how can I get a copy of NSIS 2? I looked at the http://www.nullsoft.com/free/nsis/ page and 1.98 is still there.... ? <br />
Originally posted by hotice <br />
pls visit nsis.sf.net <br />
Originally posted by kcostain <br />
I've been there... only a pre-release is available.. I guess I could use that but I'm not sure if that will create more problems then its worth... <br />
The pre-release version of NSIS 2 works fine. I haven't encountered any bugs yet (except in the documentation). And, any bugs that are found will be fixed immideatly. Download<br />
http://nsis.sourceforge.net/nightly/nsis.zip<br />
for the latest version (NSIS 2.0b). It is updated twice a day!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>