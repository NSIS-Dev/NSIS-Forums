<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" reading reg problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  reading reg problem NSIS Discussion" />
	
	<title> reading reg problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  reading reg problem</div>
<hr />
<div class="pda"><a href="t-268421.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=268421">reading reg problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">albator2000</div><div class="date">26th March 2007, 18:14</div></div><div class="posttext">hi there<br />
<br />
i'm writing an addon installer for world of warcraft and i need to get the WoW install path in order to install addon in the right folder wherever user has installed WoW<br />
<br />
so i wrote this :<br />
<br />
Function .onInit<br />
	ReadRegStr ${InstallPath} HKLM &quot;SOFTWARE\Blizzard Entertainment\World of Warcraft&quot; &quot;InstallPath&quot;<br />
FunctionEnd<br />
<br />
and the i use :<br />
<br />
InstallDir &quot;${InstallPath}\Interface\AddOns&quot;<br />
<br />
but it doesn't work :(<br />
here is my error message :<br />
<br />
Fonction: &quot;_WoWPath&quot;<br />
Usage: ReadRegStr $(var_utilisateur: destination) clÃ©_racine sous_clÃ© entrÃ©e<br />
   clÃ©_racine=(HKCR|HKLM|HKCU|HKU|HKCC|HKDD|HKPD)<br />
Erreur dans le script &quot;stdin&quot; a la ligne 2049 -- abandon du processus de creation<br />
<br />
it seems that my ReadRegStr isn't right but i can't figure out where is my mistake...<br />
<br />
i hope you guys will help me, thx !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">26th March 2007, 18:26</div></div><div class="posttext">This is a compiler definition ${InstallPath}<br />
You need to use a variable instead.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">albator2000</div><div class="date">26th March 2007, 18:44</div></div><div class="posttext">so i need to use the same name without {} ? (i'm beginner so excuse me if my questions are a bit dumb ^^)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">26th March 2007, 18:55</div></div><div class="posttext">If you prefer to use your own variable instead of registers $0-$9 and $R0-$R9 you need to declare it first, e.g.<br />
<br />
var InstallPath ;out of section or function otherwise /global see manual<br />
.......<br />
.......<br />
Function .onInit<br />
ReadRegStr $InstallPath ..............</div></div><hr />


<div class="post"><div class="posttop"><div class="username">albator2000</div><div class="date">27th March 2007, 08:09</div></div><div class="posttext">ok i've done this :<br />
<br />
Function .onInit<br />
	ReadRegStr $R0 HKLM &quot;SOFTWARE\Blizzard Entertainment\World of Warcraft&quot; &quot;InstallPath&quot;<br />
FunctionEnd<br />
<br />
and then :<br />
<br />
InstallDir &quot;$R0\Interface\AddOns&quot;<br />
<br />
i can compile without error but during installation $R0 seems to be blank because the default path is &quot;/Interface/AddOns&quot; without the install patch i've got in registry :rolleyes: (and i've checked twice, the reg key i'm reading is not blank)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th March 2007, 08:44</div></div><div class="posttext">$R0 is used by many NSIS functions to exchange data.<br />
You're better off doing:<br />
<br />
InstallDir &quot;C:\default path\Interface\AddOns&quot;<br />
<br />
Function .onInit<br />
  ReadRegStr $R0 HKLM &quot;SOFTWARE\Blizzard Entertainment\World of Warcraft&quot; &quot;InstallPath&quot;<br />
  StrCmp $R0 &quot;&quot; +2<br />
    StrCpy $INSTDIR &quot;$R0\Interface\AddOns&quot;<br />
FunctionEnd<br />
<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">albator2000</div><div class="date">27th March 2007, 08:58</div></div><div class="posttext">ok thanks ! i'll test this syntax as soon as i can :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">albator2000</div><div class="date">27th March 2007, 18:47</div></div><div class="posttext">ok it works but now here is my problem :<br />
<br />
InstallDir &quot;C:\Program Files\Wolrd Of Warcraft\Interface\AddOns&quot;<br />
<br />
Function .onInit<br />
		ReadRegStr $R0 HKLM &quot;SOFTWARE\Blizzard Entertainment\World of Warcraft&quot; &quot;InstallPath&quot;<br />
		StrCmp $R0 &quot;&quot; +2<br />
    StrCpy $INSTDIR &quot;$R0\Interface\AddOns&quot;<br />
FunctionEnd<br />
<br />
my install path is K:\World of Warcraft\\Interface\AddOns<br />
i tried to use a var like ${test} to avoid the \\ issue (if   i remove the extra \ it undersand $R0Interface like a var) but i can't get it working :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">27th March 2007, 18:55</div></div><div class="posttext">!define MY_PATH &quot;Interface\AddOns&quot;<br />
<br />
.........<br />
.........<br />
.........<br />
<br />
StrCpy $INSTDIR &quot;$R0${MY_PATH}&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">albator2000</div><div class="date">27th March 2007, 19:05</div></div><div class="posttext">ah yes ! :D<br />
<br />
thanks a lot for your help !</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>