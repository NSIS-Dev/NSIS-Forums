<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Install a Windows Component, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Install a Windows Component NSIS Discussion" />
	
	<title> Install a Windows Component [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Install a Windows Component</div>
<hr />
<div class="pda"><a href="t-266294.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=266294">Install a Windows Component</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">technoid</div><div class="date">21st February 2007, 14:58</div></div><div class="posttext">hi guys,<br />
before installing my own application, I need to verify the installation of some Windows Components (Control Panel\Add Remove Programs\Add Remove Windows Components). If they are not already installed I have to start the corresponding setup procedure.<br />
is there a way to start the setup of a needed Windows Component?<br />
thanks in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">21st February 2007, 16:46</div></div><div class="posttext">If you know the exact uninstall registry entry for each component that you want to check, you may want to do it by reading the registry.<br />
If one or more components not already installed, your main options should be either include them in your package/extract in $PLUGINSDIR and install, or download and install. (Both options are regular NSIS feaures).<br />
Also, you may prompt users to install required components before continue with your installation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fishweasel</div><div class="date">22nd February 2007, 11:40</div></div><div class="posttext">To add / remove windows components use 'sysocmgr.exe'<br />
<br />
depending on what you need to install / remove depends on switches and answer files, for example my script needs to install IIS:<br />
<br />
sysocmgr.exe /i:sysoc.inf /u:c:\temp\IIS_answer.txt <br />
(the above holds a switch /u to make it unattended so no interraction required)<br />
<br />
IIS_answer.txt holds the components i wish to have :<br />
<br />
<br />
[Components]<br />
iis_common=on<br />
iis_ftp=on<br />
iis_inetmer=on<br />
iis_smtp=on<br />
iis_internetdataconnector=on<br />
iis_www=on<br />
inetprint-on<br />
<br />
[InternetServer]<br />
<br />
<br />
there is extensive documentation on MS support pages - do a search for unattended windows components.<br />
<br />
Hope that helps</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">22nd February 2007, 13:04</div></div><div class="posttext">Originally posted by fishweasel <br />
To add / remove windows components use 'sysocmgr.exe'<br />
<br />
depending on what you need to install / remove depends on switches and answer files, for example my script needs to install IIS:<br />
<br />
sysocmgr.exe /i:sysoc.inf /u:c:\temp\IIS_answer.txt <br />
(the above holds a switch /u to make it unattended so no interraction required)<br />
<br />
IIS_answer.txt holds the components i wish to have :<br />
<br />
<br />
[Components]<br />
iis_common=on<br />
iis_ftp=on<br />
iis_inetmer=on<br />
iis_smtp=on<br />
iis_internetdataconnector=on<br />
iis_www=on<br />
inetprint-on<br />
<br />
[InternetServer]<br />
<br />
<br />
there is extensive documentation on MS support pages - do a search for unattended windows components.<br />
<br />
Hope that helps  Gee! Could you pass it to NSIS script and post a wiki page (http://nsis.sf.net) as well?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">technoid</div><div class="date">22nd February 2007, 13:05</div></div><div class="posttext">thanks fishweasel! <br />
I found that solution yesterday, searching on Google, but I forgot to post it here :) Now I have to know if there are differences among 2k/XP/2k3 on services I need..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fishweasel</div><div class="date">22nd February 2007, 14:31</div></div><div class="posttext">Not sure about passing direct to nsis - maybe ExecToStack ??<br />
I personally call the sysoc from a bat file and have the answer file included in the section. I will look into a cleaner way of doing it from the script (makes my installer more tidy anyway) and i shall add it to nsis wiki this week. Should i put it in code examples ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">22nd February 2007, 20:12</div></div><div class="posttext">Originally posted by fishweasel <br />
Not sure about passing direct to nsis - maybe ExecToStack ??<br />
I personally call the sysoc from a bat file and have the answer file included in the section. I will look into a cleaner way of doing it from the script (makes my installer more tidy anyway) and i shall add it to nsis wiki this week. Should i put it in code examples ?  That would be very useful for many users, and for me as well :) Looking forward to grab it.<br />
I guess code examples is the right place to go.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fishweasel</div><div class="date">23rd February 2007, 21:20</div></div><div class="posttext">I did a little testing and it runs no problem from NSIS<br />
but you still require an answer file - which thinking about is pretty neat - you can either have the one you specify or use install options to create a more tailored answer file during installation (not needed in mine so i didnt mess with this - but drop boxes radio buttons etc would be easy to do)<br />
<br />
<br />
ExecWait '&quot;sysocmgr.exe&quot; /C /i:sysoc.inf /u:C:\temp\answerfile.txt'<br />
<br />
<br />
I will have a play around to see if i can use the likes of $INSTDIR or $pluginsdir with this, and also to see if i can pass components direct to the command line (looks unlikely) <br />
but for now its friday night and im off home :p<br />
<br />
edit : still trying to figure out how to write wiki page and have it appear in code example category :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">23rd February 2007, 21:32</div></div><div class="posttext">edit : still trying to figure out how to write wiki page and have it appear in code example category<br />
http://nsis.sourceforge.net/Starting_a_new_page<br />
<br />
Also you may take a look at other pages (click edit tab)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>