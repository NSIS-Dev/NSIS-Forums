<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Own Ext-register bud not exec from program, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Own Ext-register bud not exec from program NSIS Discussion" />
	
	<title> Own Ext-register bud not exec from program [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Own Ext-register bud not exec from program</div>
<hr />
<div class="pda"><a href="t-146183.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=146183">Own Ext-register bud not exec from program</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Biarchiv</div><div class="date">18th August 2003, 18:03</div></div><div class="posttext">Hello,<br />
<br />
I have this Code. It run, bud if I start<br />
the file.own from a program (outlook) it do not found a entry.<br />
<br />
Bud I doubleclick in explorer program started with file.<br />
Whats wrong?<br />
<br />
Code:<br />
Section &quot;Shell HKI with WinHKI&quot;  ; SecExtention<br />
  SectionIn 1 2 3<br />
  ; back up old value of .nsi<br />
  ReadRegStr $1 HKCR &quot;.hki&quot; &quot;&quot;<br />
  StrCmp $1 &quot;&quot; Label1<br />
    StrCmp $1 &quot;HKICompress&quot; Label1<br />
    WriteRegStr HKCR &quot;.hki&quot; &quot;backup_val&quot; $1<br />
  Label1:<br />
  WriteRegStr HKCR &quot;.hki&quot; &quot;&quot; &quot;HKICompress&quot;<br />
  ReadRegStr $0 HKCR &quot;HKICompress&quot; &quot;&quot;<br />
  StrCmp $0 &quot;&quot; 0 skipNSIAssoc<br />
	WriteRegStr HKCR &quot;HKICompress&quot; &quot;&quot; &quot;WinHKI File&quot;<br />
	WriteRegStr HKCR &quot;HKICompress\shell&quot; &quot;&quot; &quot;open&quot;<br />
	WriteRegStr HKCR &quot;HKICompress\DefaultIcon&quot; &quot;&quot; $INSTDIR\winhki.exe<br />
  skipNSIAssoc:<br />
  WriteRegStr HKCR &quot;HKICompress\shell\compile&quot; &quot;&quot; &quot;Open WinHKI&quot;<br />
  WriteRegStr HKCR &quot;HKICompress\shell\compile\command&quot; &quot;&quot; '&quot;$INSTDIR\winhki.exe&quot; &quot;%1&quot;'<br />
SectionEnd<br />
<br />
Section &quot;Shell ZIP with WinHKI&quot;  ; SecExtention<br />
  SectionIn 1 2 3<br />
  ; back up old value of .nsi<br />
  ReadRegStr $1 HKCR &quot;.zip&quot; &quot;&quot;<br />
  StrCmp $1 &quot;&quot; Label1<br />
    StrCmp $1 &quot;HKIZCompress&quot; Label1<br />
    WriteRegStr HKCR &quot;.zip&quot; &quot;backup_val&quot; $1<br />
  Label1:<br />
  WriteRegStr HKCR &quot;.zip&quot; &quot;&quot; &quot;HKIZCompress&quot;<br />
  ReadRegStr $0 HKCR &quot;HKIZCompress&quot; &quot;&quot;<br />
  StrCmp $0 &quot;&quot; 0 skipNSIAssoc<br />
	WriteRegStr HKCR &quot;HKIZCompress&quot; &quot;&quot; &quot;WinHKI Zip-File&quot;<br />
	WriteRegStr HKCR &quot;HKIZCompress\shell&quot; &quot;&quot; &quot;open&quot;<br />
	WriteRegStr HKCR &quot;HKIZCompress\DefaultIcon&quot; &quot;&quot; $INSTDIR\winhzip.exe<br />
  skipNSIAssoc:<br />
  WriteRegStr HKCR &quot;HKIZCompress\shell\compile&quot; &quot;&quot; &quot;Open WinHKI&quot;<br />
  WriteRegStr HKCR &quot;HKIZCompress\shell\compile\command&quot; &quot;&quot; '&quot;$INSTDIR\winhzip.exe&quot; &quot;%1&quot;'<br />
SectionEnd<br />
<br />
; Uninstall<br />
ReadRegStr $1 HKCR &quot;.hki&quot; &quot;&quot;<br />
  StrCmp $1 &quot;HKICompress&quot; 0 NoOwn ; only do this if we own it<br />
    ReadRegStr $1 HKCR &quot;.hki&quot; &quot;backup_val&quot;<br />
    StrCmp $1 &quot;&quot; 0 RestoreBackup ; if backup == &quot;&quot; then delete the whole key<br />
      DeleteRegKey HKCR &quot;.hki&quot;<br />
    Goto NoOwn<br />
    RestoreBackup:<br />
      WriteRegStr HKCR &quot;.hki&quot; &quot;&quot; $1<br />
      DeleteRegValue HKCR &quot;.hki&quot; &quot;backup_val&quot;<br />
  NoOwn:<br />
<br />
  ReadRegStr $1 HKCR &quot;.zip&quot; &quot;&quot;<br />
  StrCmp $1 &quot;HKIZCompress&quot; 0 NoOwn2 ; only do this if we own it<br />
    ReadRegStr $1 HKCR &quot;.zip&quot; &quot;backup_val&quot;<br />
    StrCmp $1 &quot;&quot; 0 RestoreBackup2 ; if backup == &quot;&quot; then delete the whole key<br />
      DeleteRegKey HKCR &quot;.zip&quot;<br />
    Goto NoOwn2<br />
    RestoreBackup2:<br />
      WriteRegStr HKCR &quot;.zip&quot; &quot;&quot; $1<br />
      DeleteRegValue HKCR &quot;.zip&quot; &quot;backup_val&quot;<br />
  NoOwn2:<br />
DeleteRegKey HKCR &quot;HKICompress&quot;<br />
DeleteRegKey HKCR &quot;HKIZCompress&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Biarchiv</div><div class="date">22nd August 2003, 14:35</div></div><div class="posttext">Hello,<br />
<br />
Is this Code right or have I forget some?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">22nd August 2003, 15:04</div></div><div class="posttext">If it works in explorer it should be ok. Does it work in other file dialogs?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Biarchiv</div><div class="date">22nd August 2003, 18:08</div></div><div class="posttext">Hello,<br />
<br />
In Explorer is all right.<br />
In a Tool. WinRAR can not open it because<br />
it is not entry as program for this<br />
EXT. No Program for this .EXT.<br />
<br />
Not in: Outlook, Winrar, .... usw</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">22nd August 2003, 18:15</div></div><div class="posttext">Please give more details. When do you get errors? Is a standard Windows common dialog?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Biarchiv</div><div class="date">23rd August 2003, 18:26</div></div><div class="posttext">Hello,<br />
<br />
It run all okay, bad only if I start<br />
my Program registry in an Program.<br />
The program tell me that no entry for my<br />
registry .EXT. Bud If I make double click<br />
with Explorer(Windows) My Program open with the file. All right.<br />
I think that are one writeregistry forget<br />
to write in the code.<br />
<br />
The small window come with all programs<br />
to connect with my .EXT File. Only in the<br />
most programs.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>