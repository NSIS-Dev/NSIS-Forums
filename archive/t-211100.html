<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" link icon with file, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  link icon with file NSIS Discussion" />
	
	<title> link icon with file [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  link icon with file</div>
<hr />
<div class="pda"><a href="t-211100.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=211100">link icon with file</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">aj kwak</div><div class="date">22nd March 2005, 14:30</div></div><div class="posttext">Is it possible to link an icon with a file.<br />
Like you can do manually with <br />
- control panel - directoryproperties - filetypes.<br />
Can you do this with the nsis-script... i have searched and nothing found but ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">22nd March 2005, 14:39</div></div><div class="posttext">Write key to regestry: <br />
WriteRegStr HKCR &quot;\&quot;.filetype&quot;\DefaultIcon\&quot; &quot;&quot; &quot;path_to_icon&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aj kwak</div><div class="date">22nd March 2005, 14:45</div></div><div class="posttext">i have tried :<br />
<br />
Section &quot;nma_link_ico&quot; SEC10<br />
  SetOutPath &quot;$ANOTHER_DIR\Noma\ND_profile.ico&quot;<br />
  File &quot;Noma\Graphics\Icons\&quot;<br />
 WriteRegStr HKCR &quot;\&quot;.nma&quot;\DefaultIcon\&quot; &quot;$ANOTHER_DIR\Nomadisk\ND_profile.ico&quot;<br />
SectionEnd<br />
<br />
AND <br />
<br />
Section &quot;nma_link_ico&quot; SEC10<br />
  SetOutPath &quot;$ANOTHER_DIR\Noma\ND_profile.ico&quot;<br />
  File &quot;Noma\Graphics\Icons\&quot;<br />
 WriteRegStr HKCR &quot;.nma\DefaultIcon\&quot; &quot;&quot; &quot;$ANOTHER_DIR\Nomadisk\ND_profile.ico&quot;<br />
SectionEnd<br />
<br />
none works...(in the regestry there comes .nma with the path)but the link do not work</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">22nd March 2005, 16:53</div></div><div class="posttext">the format is: (ex. for .xxx, the file class is xxxFile)<br />
<br />
HKCR &quot;.xxx&quot; &quot;&quot; &quot;xxxFile&quot;<br />
<br />
HKCR &quot;xxxFile\DefaultIcon\&quot; &quot;&quot; &quot;$pathtoicon&quot;<br />
<br />
http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/programmersguide/shell_basics/shell_basics_extending/fileassociations/fileassoc.asp</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">22nd March 2005, 17:17</div></div><div class="posttext">Yes. Anders right.<br />
I wrote incorrect example. But in my own script I did it (file association) correct (like Anders wrote).<br />
aj kwak sorry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aj kwak</div><div class="date">23rd March 2005, 14:25</div></div><div class="posttext">i does not work :confused: <br />
<br />
;here i copy the ico files to the client computer<br />
SetOutPath &quot;$ANOTHER_DIR\Noma\&quot;<br />
File &quot;Nomafiles\Graphics\Icons\*.ico&quot;<br />
<br />
;i give a name<br />
WriteRegStr HKCR &quot;nmdfile&quot; &quot;&quot; &quot;${PRODUCT_NAME}profile File&quot;<br />
<br />
;i associate the nmdfile with the icon<br />
WriteRegStr HKCR &quot;nmdfile\DefaultIcon\&quot; &quot;&quot; &quot;$ANOTHER_DIR\Noma\ND_profile.ico&quot;<br />
<br />
<br />
;because the associate with the ico doesn't work, i tried this, but i doesn't work also<br />
WriteRegStr HKCR &quot;nmdfile\DefaultIcon\&quot; &quot;&quot; &quot;$ANOTHER_DIR\Noma\NomaClient.exe,-120&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">23rd March 2005, 14:48</div></div><div class="posttext">Add WriteRegStr HKCR &quot;.nmd&quot; &quot;&quot; &quot;nmdfile&quot;,<br />
where .nmd - extension of file.<br />
<br />
EDIT<br />
<br />
In general, you must define file class (see Anders link). For this, first create a registry key for the extension (.ext) under HKCR, and set the key's value to the ProgID for the associated application (WriteRegStr HKCR &quot;.ext&quot; &quot;&quot; &quot;extfile&quot; [extfile may change to any text, for example &quot;ext.document&quot;, &quot;documentext&quot;, &quot;blabla&quot;]).<br />
Next, create a second key under HKCR for the application's ProgID. It's default value describes the application (what you see in - control panel - directoryproperties - filetypes).<br />
Default value of DefaultIcon-subkey describes the default icon that you want to display for file types associated with this PROGID.<br />
So your script must include:<br />
WriteRegStr HKCR &quot;.nmd&quot; &quot;&quot; &quot;nmdfile&quot;<br />
WriteRegStr HKCR &quot;nmdfile\DefaultIcon&quot; &quot;&quot; &quot;path_to_ico&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aj kwak</div><div class="date">23rd March 2005, 15:25</div></div><div class="posttext">Finnaly it works...<br />
<br />
thx glory_man &amp; Anders<br />
<br />
For others :<br />
WriteRegStr HKCR &quot;.nmd&quot; &quot;&quot; &quot;nmdFile&quot;<br />
WriteRegStr HKCR &quot;nmdfile&quot; &quot;&quot; &quot;${PRODUCT_NAME}profile File&quot;<br />
WriteRegStr HKCR &quot;nmdFile\DefaultIcon\&quot; &quot;&quot; &quot;$ANOTHER_DIR\Noma\ND_profile.ico&quot;<br />
<br />
(a minimum of script i think)<br />
<br />
EDIT<br />
<br />
-</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">23rd March 2005, 15:44</div></div><div class="posttext">If you want to associate with file some actions - create additional subkeys.<br />
For example, open file with programm:<br />
WriteRegStr HKCR &quot;nmdFile\Shell\open\command\&quot; &quot;&quot; 'programm_path &quot;%1&quot;'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hesung</div><div class="date">24th March 2005, 18:12</div></div><div class="posttext">It's wonderful here..!!~~<br />
 <br />
Function un.oninit<br />
 <br />
SYSTEM::Call 'kernel32::CreateMutexA(i 0, i 0, t &quot;myMutex&quot;) i .r1 ?e'<br />
Pop $R0<br />
StrCmp $R0 0 +2<br />
Quit<br />
<br />
Call un.cksundir<br />
<br />
FindWindow $0 &quot;Winamp v1.x&quot;<br />
	StrCmp $0 0 +2<br />
	SendMessage $0 ${WM_CLOSE} 0 0<br />
	FindWindow $0 &quot;WinampAgentMain&quot;<br />
	StrCmp $0 0 +2<br />
	SendMessage $0 ${WM_CLOSE} 0 0<br />
<br />
FunctionEnd:igor:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">25th March 2005, 10:45</div></div><div class="posttext">:igor: <br />
Is this question?<br />
:D</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>