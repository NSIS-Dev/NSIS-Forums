<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" progress callback and BgImage, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  progress callback and BgImage NSIS Discussion" />
	
	<title> progress callback and BgImage [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  progress callback and BgImage</div>
<hr />
<div class="pda"><a href="t-205226.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=205226">progress callback and BgImage</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Gosev</div><div class="date">18th January 2005, 07:56</div></div><div class="posttext">Hi<br />
<br />
This is my first post to the WinAMP/NSIS forums :)<br />
<br />
I work for a game company and we've just decide (well, I've just decided) to migrate from InstallShield to NSIS. <br />
<br />
The installation I'm working on at the moment is on 2 CDs, so I'm doing a double installer (the first one asks for the language, the second is copied by the first one to the HD and does most of the work, such as the extractions from the 2 CDs) <br />
<br />
I need to do billboards (I'm using BgImage) that change regulary  during installation (e.g. at 10%, 20%, 30%...) So far what I've done is to separate my files into several zip files that are roughly the same size then I do extract / show BgImage A / extract / show BgImage B and so.<br />
<br />
I was wondering of there was any way to link callbacks to the instfiles progression or something, so that I can call a function every 10 percentage points with the progress value and use that function to change the background image. Or is there another better way to do this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th January 2005, 19:16</div></div><div class="posttext">In NSIS 2.03 or above, you can write plug-ins that will be able to execute NSIS code. Creating a plug-in to listen to Windows messages and execute NSIS code accordingly could cause problems because the NSIS code interpreter is not built for multi-threaded execution. However, if you choose your hooking correctly, it shouldn't be a problem. NSIS uses SendMessage to update the progress bar, so no code should be executed while the progress bar is updating.<br />
<br />
So, if you create a plug-in that hooks the progress bar and listens to PBM_SETPOS, you should be able to call a callback function in your script to update BgImage.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Gosev</div><div class="date">19th January 2005, 07:54</div></div><div class="posttext">Hum, long time no code, but I think I actually understood most of that :) Thanks for taking the time to answer. <br />
<br />
There's just one point on which I'm not clear :<br />
<br />
Originally posted by kichik <br />
In NSIS 2.03 or above, you can write plug-ins that will be able to execute NSIS code. <br />
 <br />
<br />
I had imagined calling the dll with a (script) function name, but basically I don't know which parameters to pass to ExecuteCodeSegment (and more specifically how to translate the function name into ExecuteCodeSegments first parameter). I found it used in \exehead\ui.c and had a look at it in \exehead\exec.c but as I haven't looked at much else in the code I haven't really made any headway making sense of it all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Gosev</div><div class="date">20th January 2005, 18:16</div></div><div class="posttext">Originally posted by kichik on mIRC <br />
 use 2.04 and extra_parameters parameter<br />
 extra-&gt;ExecuteCodeSegment(address, 0);<br />
you can get address using GetFunctionAddress in the script, for example. <br />
Script execution is not thread safe, be careful with it. <br />
 <br />
<br />
Thanks, that's exactly what I needed</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>