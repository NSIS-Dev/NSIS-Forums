<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" DumpLog usage, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  DumpLog usage NSIS Discussion" />
	
	<title> DumpLog usage [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  DumpLog usage</div>
<hr />
<div class="pda"><a href="t-232111.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=232111">DumpLog usage</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">LaneinBC</div><div class="date">28th November 2005, 17:57</div></div><div class="posttext">I am trying to use the DumpLog function as listed below:<br />
<br />
!define LVM_GETITEMCOUNT 0x1004<br />
!define LVM_GETITEMTEXT 0x102D<br />
Function DumpLog<br />
  Exch $5<br />
  Push $0<br />
  Push $1<br />
  Push $2<br />
  Push $3<br />
  Push $4<br />
  Push $6<br />
 <br />
  FindWindow $0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
  GetDlgItem $0 $0 1016<br />
  StrCmp $0 0 exit<br />
<br />
  MessageBox MB_ICONINFORMATION 'Attempting to open the file'<br />
<br />
  FileOpen $5 $5 &quot;w&quot;<br />
  StrCmp $5 &quot;&quot; exit<br />
    SendMessage $0 ${LVM_GETITEMCOUNT} 0 0 $6<br />
    System::Alloc ${NSIS_MAX_STRLEN}<br />
    Pop $3<br />
    StrCpy $2 0<br />
    System::Call &quot;*(i, i, i, i, i, i, i, i, i) i \<br />
      (0, 0, 0, 0, 0, r3, ${NSIS_MAX_STRLEN}) .r1&quot;<br />
    loop: StrCmp $2 $6 done<br />
      System::Call &quot;User32::SendMessageA(i, i, i, i) i \<br />
        ($0, ${LVM_GETITEMTEXT}, $2, r1)&quot;<br />
      System::Call &quot;*$3(&amp;t${NSIS_MAX_STRLEN} .r4)&quot;<br />
      FileWrite $5 &quot;$4$\r$\n&quot;<br />
      IntOp $2 $2 + 1<br />
      Goto loop<br />
    done:<br />
      FileClose $5<br />
      System::Free $1<br />
      System::Free $3<br />
  exit:<br />
    Pop $6<br />
    Pop $4<br />
    Pop $3<br />
    Pop $2<br />
    Pop $1<br />
    Pop $0<br />
    Exch $5<br />
FunctionEnd<br />
<br />
It does not work in my NSIS script. It does not even attempt to open the output file. I put a MessageBox call in the code (see above) and it does not display the message.<br />
<br />
Has anybody else used this function. If so did it work for you. Any ideas on trying to debug what the problem is?<br />
<br />
Thanks<br />
<br />
Lane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">28th November 2005, 18:06</div></div><div class="posttext">1. Did you call it? :)Push &quot;$EXEDIR\install.log&quot;<br />
Call DumpLog<br />
2. Try to put MessageBox after push $6.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LaneinBC</div><div class="date">28th November 2005, 18:11</div></div><div class="posttext">Yes, Here is the code fragment I used:<br />
<br />
  Push &quot;C:\Test.Tmp&quot;<br />
  Call DumpLog<br />
<br />
Again, it is not even trying to create the file.<br />
<br />
Thanks<br />
<br />
Lane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">28th November 2005, 18:18</div></div><div class="posttext">Be sure that you calling it from &quot;Section&quot; or &quot;.onInstSuccess&quot;, but not from &quot;.onGuiEnd&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LaneinBC</div><div class="date">28th November 2005, 18:47</div></div><div class="posttext">Ok, I put the call to DumpLog in a section I have called &quot;Post&quot;. It now created the external log file.<br />
Thanks...!<br />
<br />
What I want'd to do was to catch the log file data at the very end of the install procedure. I have several custom pages that run doing things like downloading firmware to embedded controller boards AFTER the files have all been installed onto the hard drive. Can you suggest what would be the best place (Section of call-back function) to put the call to the Dumplog function to achieve this?<br />
<br />
I'm assuming that calling it from a custom page is where my problem started. Is it possible to modify the Dumplog function to work from a custom page that is placed at the very end of the install?<br />
<br />
Thanks for your help<br />
<br />
Lane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">29th November 2005, 07:55</div></div><div class="posttext">You can use &quot;Function .onInstSuccess&quot;, but DumpLog only dump details of the &quot;page instfiles&quot;. If you want to save details on the custom pages, you can wrote simple macro to write in file. Something like this:Name &quot;Output&quot;<br />
OutFile &quot;Output.exe&quot;<br />
<br />
!include DetailPrint.nsh<br />
<br />
Section<br />
	${OpenDetailPrint} &quot;C:\log.txt&quot;<br />
<br />
	${DetailPrint} &quot;Detial 1&quot;<br />
	${DetailPrint} &quot;Detial 2&quot;<br />
	${DetailPrint} &quot;Detial 3&quot;<br />
<br />
	${CloseDetailPrint}<br />
SectionEnd<br />
P.S. Probably there is someone wrote already such script, but I couldn't remember.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LaneinBC</div><div class="date">29th November 2005, 16:14</div></div><div class="posttext">Yes, I have something like this running now. (An external log file writing system).<br />
<br />
It looks like the &quot;internal log&quot; only applies to the installing/copying of file page. This is what the &quot;Dumplog&quot; is extracting for me now. It took me a while to understand this. I originally thought that the Dumplog would extract and catch all of the &quot;Detailprints&quot; I was doing from my custom pages that where outside, or past the installation of files. I think I have a better understanding of how it works now.<br />
<br />
Regards<br />
<br />
Lane</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>