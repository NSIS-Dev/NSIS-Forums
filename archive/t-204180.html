<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" what is wrong ?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  what is wrong ? NSIS Discussion" />
	
	<title> what is wrong ? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  what is wrong ?</div>
<hr />
<div class="pda"><a href="t-204180.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=204180">what is wrong ?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Darnis</div><div class="date">7th January 2005, 17:13</div></div><div class="posttext">hi<br />
<br />
please help me -<br />
<br />
what is wrong , why i can't display image ?<br />
<br />
  !include &quot;MUI.nsh&quot;<br />
  ;!include &quot;LogicLib.nsh&quot;<br />
  <br />
  <br />
  Name &quot;Modern UI Test&quot;<br />
  OutFile &quot;HeaderBitmap.exe&quot;<br />
  InstallDir &quot;$PROGRAMFILES\Modern UI Test&quot;<br />
  InstallDirRegKey HKCU &quot;Software\Modern UI Test&quot; &quot;&quot;<br />
  <br />
;--------------------------------<br />
;Interface Configuration<br />
Var HWND<br />
ReserveFile          `.\skin0.bmp`<br />
!define STM_SETIMAGE        0x0172<br />
!define STM_GETIMAGE        0x0173<br />
!define IMAGE_BITMAP        0<br />
!define IMAGE_ICON          1<br />
!define IMAGE_CURSOR        2<br />
!define LR_CREATEDIBSECTION 0x2000<br />
!define LR_LOADFROMFILE     0x0010<br />
!define CB_GETCURSEL        0x0147<br />
<br />
<br />
  !define MUI_HEADERIMAGE_BITMAP header.bmp<br />
  !define MUI_HEADERIMAGE_RIGHT<br />
  !define MUI_HEADERIMAGE<br />
  !define MUI_ABORTWARNING<br />
<br />
  ;--------------------------------<br />
;Pages<br />
<br />
  Page custom SetCustom<br />
<br />
  !define MUI_PAGE_HEADER_TEXT &quot;Licencja&quot;<br />
  !define MUI_PAGE_HEADER_SUBTEXT &quot;Licencja&quot;<br />
  !insertmacro MUI_PAGE_LICENSE &quot;${NSISDIR}\Contrib\Modern UI\License.txt&quot;<br />
 <br />
  !define MUI_PAGE_HEADER_TEXT &quot;Komponenty&quot;<br />
  !define MUI_PAGE_HEADER_SUBTEXT &quot;Komponenty&quot;<br />
  !insertmacro MUI_PAGE_COMPONENTS<br />
<br />
<br />
<br />
!macro LoadImage ReslutVar HWND IMG_NAME IMG_TYPE<br />
        File skin0.bmp<br />
        Push `${IMG_NAME}`<br />
	Push ${HWND}<br />
	Exch $0<br />
	Exch<br />
	Exch $1<br />
	Push $2<br />
	System::Call 'user32::LoadImage(i, t, i, i, i, i) i \<br />
	(0, &quot;$1&quot;, ${IMG_TYPE}, 0, 0, ${LR_CREATEDIBSECTION}|${LR_LOADFROMFILE}) .r2'<br />
	SendMessage $0 ${STM_SETIMAGE} ${IMG_TYPE} $2 ;HANDLE<br />
	Push $2<br />
	Exch<br />
	Pop $2<br />
	Exch<br />
	Pop $1<br />
	Exch<br />
	Pop $0<br />
	Pop ${ReslutVar} ;HANDLE<br />
!macroend<br />
<br />
!macro DeleteObject HWND<br />
	System::Call 'Gdi32::DeleteObject(i) i (${HWND})'<br />
!macroend<br />
<br />
<br />
Function SetCustom<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;banner.ini&quot;<br />
  Pop $HWND<br />
  GetDlgItem $1 $HWND 1201<br />
  !insertmacro LoadImage $0 $1 &quot;$PLUGINSDIR\skin0.bmp&quot; ${IMAGE_BITMAP}<br />
  !insertmacro MUI_HEADER_TEXT &quot;A&quot; &quot;A&quot;<br />
;  !insertmacro DeleteObject $0<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;banner.ini&quot;<br />
FunctionEnd<br />
<br />
 ; !insertmacro MUI_PAGE_DIRECTORY<br />
 ; !insertmacro MUI_PAGE_INSTFILES<br />
  <br />
  ;!insertmacro MUI_UNPAGE_CONFIRM<br />
  ;!insertmacro MUI_UNPAGE_INSTFILES<br />
  <br />
;--------------------------------<br />
;Languages<br />
 <br />
  !insertmacro MUI_LANGUAGE &quot;Polish&quot;<br />
<br />
;--------------------------------<br />
;Installer Sections<br />
<br />
Section &quot;Dummy Section&quot; SecDummy<br />
<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  <br />
  ;ADD YOUR OWN FILES HERE...<br />
  <br />
  ;Store installation folder<br />
  WriteRegStr HKCU &quot;Software\Modern UI Test&quot; &quot;&quot; $INSTDIR<br />
  <br />
  ;Create uninstaller<br />
  WriteUninstaller &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
SectionEnd<br />
<br />
;--------------------------------<br />
;Descriptions<br />
<br />
  ;Language strings<br />
  LangString DESC_SecDummy ${LANG_ENGLISH} &quot;A test section.&quot;<br />
<br />
  ;Assign language strings to sections<br />
  !insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />
    !insertmacro MUI_DESCRIPTION_TEXT ${SecDummy} $(DESC_SecDummy)<br />
  !insertmacro MUI_FUNCTION_DESCRIPTION_END<br />
 <br />
;--------------------------------<br />
;Uninstaller Section<br />
<br />
Section &quot;Uninstall&quot;<br />
<br />
  ;ADD YOUR OWN FILES HERE...<br />
<br />
  Delete &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
  RMDir &quot;$INSTDIR&quot;<br />
<br />
  DeleteRegKey /ifempty HKCU &quot;Software\Modern UI Test&quot;<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th January 2005, 17:19</div></div><div class="posttext">You don't need to use LoadImage to display an image on an InstallOptions page. All you need to do is to extract the image and write its location to the Text value of the bitmap field in the INI. Something like:!insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;banner.ini&quot;<br />
File /oname=$PLUGINSDIR\image.bmp blah.bmp<br />
!insertmacro MUI_INSTALLOPTIONS_WRITE &quot;banner.ini&quot; &quot;Field 2&quot; &quot;Text&quot; &quot;$PLUGINSDIR\image.bmp&quot;<br />
!insertmacro MUI_INSTALLOPTIOS_DISPLAY &quot;banner.ini&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Darnis</div><div class="date">7th January 2005, 19:05</div></div><div class="posttext">very thanks<br />
<br />
evrything is ok  , but i dont understand this :<br />
File /oname=$PLUGINSDIR\image.bmp blah.bmp<br />
<br />
blah.bmp - its mein bitmap files<br />
image.bmp - what is it?   <br />
<br />
<br />
thanks a lot</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DJ Shaji</div><div class="date">9th January 2005, 21:54</div></div><div class="posttext">The &quot;image.bmp&quot; is the name of the file when it is extracted in the plugin directory.<br />
<br />
You can use it without the &quot;image.bmp&quot; like this:<br />
<br />
setoutpath &quot;$pluginsdir&quot;<br />
file &quot;blah.bmp&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_WRITE &quot;banner.ini&quot; &quot;Field 2&quot; &quot;Text&quot; &quot;$PLUGINSDIR\blah.bmp&quot;<br />
!insertmacro MUI_INSTALLOPTIOS_DISPLAY &quot;banner.ini&quot;</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>