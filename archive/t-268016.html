<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" &quot;Install&quot; button disabled after verifying directory, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  &quot;Install&quot; button disabled after verifying directory NSIS Discussion" />
	
	<title> &quot;Install&quot; button disabled after verifying directory [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  &quot;Install&quot; button disabled after verifying directory</div>
<hr />
<div class="pda"><a href="t-268016.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=268016">&quot;Install&quot; button disabled after verifying directory</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Azaitchik</div><div class="date">19th March 2007, 00:55</div></div><div class="posttext">I am an NSIS newbie and am stuck. All help appreciated. My NSI file has just a few additions to an example that came with the NSIS distribution, but the &quot;Install&quot; button is now greyed out after I select the target directory. <br />
The entire code of the NSI file is appended below-- quite short. I want the user to select the drive which happens to be assigned to the iPod, I want to verify that this drive is the right one, and I want to set the $INSTDIR (or $OUTDIR) to the &quot;\Notes&quot; folder on that drive. Is there something elementary I am screwing up? I have indeed read the manual and searched this forum, but to no avail. Thanks for any help. BTW, if I hard code the path (e.g. <br />
SetOutPath &quot;F:\Notes\&quot; <br />
it works just fine.<br />
Alan Zaitchik<br />
+========================================+<br />
<br />
; The name of the installer<br />
Name &quot;az1&quot;<br />
; The file to write<br />
OutFile &quot;az1.exe&quot;<br />
; Select and verify installation directory<br />
DirText 'Be sure that your iPod is connected to your computer and appears as an external drive.' 'If you are not sure which drive is your iPod,\r\ncheck to see which drive has the file &quot;._iPod_Control&quot; and a &quot;Notes&quot; folder on it.' 'Browse' 'Select the drive letter for your iPod. The installation will not continue unless a valid drive is selected.'<br />
InstallDir &quot;&quot;<br />
InstallButtonText &quot;Continue&quot;<br />
Var /GLOBAL ipod_drive<br />
Var /GLOBAL notes_dir<br />
<br />
Function .onVerifyInstDir<br />
    IfFileExists $INSTDIR\._iPod_Control PathGood<br />
      Abort <br />
    PathGood:<br />
    StrCpy $ipod_drive $INSTDIR<br />
    StrCpy $notes_dir &quot;\Notes\&quot;<br />
    StrCpy $INSTDIR $ipod_drive$notes_dir<br />
FunctionEnd<br />
;--------------------------------<br />
; Pages<br />
Page directory<br />
Page instfiles<br />
;--------------------------------<br />
; The stuff to install<br />
Section &quot;&quot; ;No components page, name is not important<br />
  SetOutPath $INSTDIR   <br />
  File az1.nsi ;for testing  <br />
SectionEnd ; end the section</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">19th March 2007, 01:19</div></div><div class="posttext">See NSIS manual about AllowRootDirInstall,<br />
<br />
http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.2<br />
<br />
Provided that ._iPod_Control is a valid file name, this should work,<br />
!define NOTES_DIR &quot;Notes&quot;<br />
InstallDir &quot;&quot;<br />
InstallButtonText &quot;Continue&quot;<br />
AllowRootDirInstall true<br />
<br />
Function .onVerifyInstDir<br />
IfFileExists $INSTDIR\._iPod_Control PathGood<br />
MessagrBox MB_OK|MB_ICONSTOP &quot;Bad path&quot;<br />
Abort<br />
PathGood:<br />
;StrCpy $ipod_drive $INSTDIR<br />
;StrCpy $notes_dir &quot;\Notes\&quot;<br />
StrCpy $INSTDIR &quot;$INSTDIR\${NOTES_DIR}&quot;<br />
FunctionEnd<br />
;--------------------------------<br />
; Pages<br />
Page directory<br />
Page instfiles<br />
;--------------------------------<br />
; The stuff to install<br />
Section &quot;&quot; ;No components page, name is not important<br />
SetOutPath &quot;$INSTDIR&quot;<br />
File az1.nsi ;for testing<br />
SectionEnd ; end the section<br />
<br />
PS Of course you can make a bit more pro looking. e.g. you may use ${GetDrives} http://nsis.sourceforge.net/Docs/AppendixE.html#E.1.5 in function .onInit to find the drive with the file ._iPod_Control and add it in $INSTDIR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Azaitchik</div><div class="date">19th March 2007, 03:35</div></div><div class="posttext">Dear Red Wine,<br />
I was able to get it working based on your help. In the end I changed some of the specific testing to make sure it is the iPod in the selected drive, but you got me over the hump! Thanks so much.<br />
Alan</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>