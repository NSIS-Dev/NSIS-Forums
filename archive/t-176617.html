<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Need to set overwrite mode of some files on the fly?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Need to set overwrite mode of some files on the fly? NSIS Discussion" />
	
	<title> Need to set overwrite mode of some files on the fly? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Need to set overwrite mode of some files on the fly?</div>
<hr />
<div class="pda"><a href="t-176617.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=176617">Need to set overwrite mode of some files on the fly?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Mirek Flesko</div><div class="date">14th April 2004, 11:25</div></div><div class="posttext">Hello, I need to set overwrite mode of some files on the fly, I thought it can be possible by setting SetOverwrite command but it seems it can't be altered by evaluating some variable in a section...<br />
<br />
I inserted special page that allows user to choose between <br />
1)overwriting all files<br />
2) overwriting files only if they are newer<br />
<br />
Then I checked the selection and wnat to apply the overwrite mode but it didn't work... Any idea? :) <br />
<br />
I used this code:<br />
<br />
Section &quot;Program files (required)&quot;<br />
<br />
StrCmp $CX_DATA_OVER_MODE  &quot;0&quot; _yes_overwrite _no_overwrite <br />
<br />
_yes_overwrite:<br />
DetailPrint &quot;SetOverwrite on.&quot;<br />
SetOverwrite on ;the script runs here but SetOverwrite does not work of course ...<br />
Goto _done_overwrite<br />
<br />
_no_overwrite:<br />
DetailPrint &quot;SetOverwrite ifnewer.&quot;<br />
SetOverwrite ifnewer ;the script runs here but SetOverwrite does not work of course ...<br />
<br />
Goto _done_overwrite<br />
_done_overwrite:<br />
<br />
SetOutPath $CX_DATA_DIR<br />
File Redistribute\*.*<br />
...<br />
...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evilO</div><div class="date">14th April 2004, 14:08</div></div><div class="posttext">Hi :)<br />
<br />
To solve your problem I think you have to remove the instructions &quot;SetOutPath&quot; and &quot;File&quot; from the label &quot;_done_overwrite&quot;, and to put them both in &quot;_yes_overwrite&quot; and &quot;_no_overwrite&quot; :<br />
<br />
<br />
Section &quot;Program files (required)&quot;<br />
  StrCmp &quot;$CX_DATA_OVER_MODE&quot; &quot;0&quot; _yes_overwrite _no_overwrite<br />
<br />
  _yes_overwrite:<br />
    DetailPrint &quot;SetOverwrite on.&quot;<br />
    SetOverwrite on <br />
    SetOutPath &quot;$CX_DATA_DIR&quot;<br />
    File Redistribute\*.* <br />
    Goto _done_overwrite<br />
<br />
  _no_overwrite:<br />
    DetailPrint &quot;SetOverwrite ifnewer.&quot;<br />
    SetOverwrite ifnewer <br />
    SetOutPath &quot;$CX_DATA_DIR&quot;<br />
    File Redistribute\*.* <br />
    Goto _done_overwrite<br />
<br />
  _done_overwrite:<br />
SectionEnd<br />
<br />
<br />
This should work, let me know if it  doesn't... :D<br />
<br />
evilO/Olive<br />
<br />
PS: and welcome to the forums... ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mirek Flesko</div><div class="date">14th April 2004, 14:55</div></div><div class="posttext">It works, thanks :) However, I have to duplicate the &quot;File&quot; code several times since I have to use that in several sections ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th April 2004, 15:15</div></div><div class="posttext">If the datablock optimizer is on (which is the default) that should be no problem. You also use a function or call a section from the script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evilO</div><div class="date">14th April 2004, 15:18</div></div><div class="posttext">It works, cool :)<br />
<br />
Err, but I'm not too sure to understand that:<br />
<br />
However, I have to duplicate the &quot;File&quot; code several times since I have to use that in several sections <br />
<br />
The &quot;File&quot; instruction will not put your files twice in the installer if that is the problem...<br />
<br />
<br />
<br />
BTW just a little modification (to avoid to &quot;duplicate&quot; one more line):<br />
<br />
<br />
Section &quot;Program files (required)&quot;<br />
SetOutPath &quot;$CX_DATA_DIR&quot;<br />
<br />
StrCmp &quot;$CX_DATA_OVER_MODE&quot; &quot;0&quot; _yes_overwrite _no_overwrite<br />
<br />
_yes_overwrite:<br />
DetailPrint &quot;SetOverwrite on.&quot;<br />
SetOverwrite on<br />
File Redistribute\*.*<br />
Goto _done_overwrite<br />
<br />
_no_overwrite:<br />
DetailPrint &quot;SetOverwrite ifnewer.&quot;<br />
SetOverwrite ifnewer<br />
File Redistribute\*.*<br />
Goto _done_overwrite<br />
<br />
_done_overwrite:<br />
SectionEnd<br />
<br />
<br />
<br />
evilO/Olive</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mirek Flesko</div><div class="date">14th April 2004, 15:22</div></div><div class="posttext">[QUOTEThe &quot;File&quot; instruction will not put your files twice in the installer if that is the problem...<br />
[/QUOTE] <br />
<br />
I just tried to mention that I had to duplicate all the &quot;file related&quot; lines in the installer so there is increased possibility of errors - I change something in the future I will have to modify it on two places in the script...<br />
<br />
Anyway, thanks :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th April 2004, 15:31</div></div><div class="posttext">Why not put it all in a macro? Then you won't have to enter it twice and you can even let the macro call the same File command for every file extraction (see the UpgradeDLL macro).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mirek Flesko</div><div class="date">14th April 2004, 15:34</div></div><div class="posttext">Macro :eek: Well - I haven't used macros in NSIS yet, but it seems worth to try :) Thanks - I'll do that.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>