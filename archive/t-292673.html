<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Vista Permissions in C:\ProgramData, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Vista Permissions in C:\ProgramData NSIS Discussion" />
	
	<title> Vista Permissions in C:\ProgramData [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Vista Permissions in C:\ProgramData</div>
<hr />
<div class="pda"><a href="t-292673.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=292673">Vista Permissions in C:\ProgramData</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">xcabur</div><div class="date">3rd June 2008, 14:43</div></div><div class="posttext">Hello together<br />
<br />
I need your help again and i hope you can help me.<br />
I'm not sure that it is a problem from nsis but maybe you have an idea how I can do it.<br />
<br />
I have an Access Database which needs permissions to right in his tables. My NSIS Setup install the DB and other files under vista in the %programdata% directory. Because the whole %programfiles% directory is read only under vista.<br />
<br />
When I start the Setup the UAC appears and the files will correct install. But when I want rename the installed files a message appear and notifiy me that the file is write-protected when I force this process (choose continue) the file will renamed. <br />
This problem exits with the Database, PDF, or any other installed Files. When I open the DB he open as read only.<br />
<br />
When I delete this files and I copy the files manual in the same directory. I can rename the files. The NTFS Permissions aren't the problem. The System was restarted.<br />
<br />
I think windows mark the files with read-only permissions because they will created by setup.<br />
<br />
Has anybody an idea how i can install files in the %programdata% directory without this read-only problems?<br />
<br />
Thanks for help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tictox</div><div class="date">4th June 2008, 11:34</div></div><div class="posttext">I have been on a learning curve myself concerning vista UAC issues.. <br />
<br />
basically<br />
<br />
To write to program files , your application needs to be run as Administrator , to achieve this your application needs a manifest file which grants this permission.<br />
<br />
I was not the developer of some of my applications exe files and so i used a external manifest file to do this..<br />
<br />
<br />
IF you have previously installed your application without any manifest , and plan to now use a manifest , windows will not read the file unless you change you exe's time stamp , I did this by simply opening the exe in notepad scolling to the end , click to type , press spacebar and then backspace and save , which alters the timestamp.<br />
<br />
I had to give admin rights to my update manager exe as it copies files to program files..<br />
<br />
if you want to see whether UAC is creating virtual directories for your application you can run %LOCALAPPDATA%\VirtualStore and look in the program files folder  .. technically you dont want vista creating this for your app , and is a sure sign that you have not handled UAC correctly .. im still learning all this myself , please reseach everything I have stated yourself and get other opinions<br />
<br />
hope that is some help<br />
<br />
Ian</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xcabur</div><div class="date">4th June 2008, 14:01</div></div><div class="posttext">First of all thanks for your help.<br />
But I don't want install my Tools into the Programfiles directory but into the programdata directory it's euqally to the alusersprofile directory.<br />
Normaly the ProgramData Directory isn't watch by vista UAC who ever I run the Setup  anyway with administratur rights.<br />
<br />
But the Files are read only. When I copy the files manuel (not with a setup) in the same directory then I have no problems.<br />
<br />
Have you got an idea?<br />
<br />
This is the Notification:<br />
<br />
http://www.administrator.de/images/articles/8e5c2b4276c1c7f25b53e5f3454351d6-programdata.jpg</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xcabur</div><div class="date">4th June 2008, 14:56</div></div><div class="posttext">ok, I have find out that the install root directory hast set the write-protected flag. But I can't uncheck it. When I call the Preferences again the flag is set again. How can I uncheck it or why is the flag not set when I creat the directory manual?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>