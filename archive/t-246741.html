<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with ExecWait and osql.exe, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with ExecWait and osql.exe NSIS Discussion" />
	
	<title> Problem with ExecWait and osql.exe [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with ExecWait and osql.exe</div>
<hr />
<div class="pda"><a href="t-246741.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246741">Problem with ExecWait and osql.exe</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">blue_harvester</div><div class="date">22nd May 2006, 12:55</div></div><div class="posttext">I'm trying to execute the following:<br />
<br />
<br />
ExecWait '&quot;osql.exe&quot; -S SERVER -U USER <br />
 -P PASSWORD -n -i validate_osql.sql &gt; validateOSQL.dat -b' $OUT<br />
<br />
<br />
But this is not working. The $OUT variable is set to 1 after execution.<br />
<br />
I have copied the exact command to a cmd window and it works fine. Also executing sqlplus commands works perfectly too.<br />
<br />
Any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">22nd May 2006, 13:00</div></div><div class="posttext">What doesn't work?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">blue_harvester</div><div class="date">22nd May 2006, 13:11</div></div><div class="posttext">Originally posted by RobGrant <br />
What doesn't work?  <br />
Sorry, I should've been more specific. The actual execution of the osql.exe command doesn't work, ExecWait works fine. When I do the following it works fine:<br />
<br />
<br />
ExecWait '&quot;sqlplus.exe&quot; USER/PASSWORD@DATABASE @validate_sqlplus.sql'<br />
<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">22nd May 2006, 13:18</div></div><div class="posttext">Are you using the split line in the actual code? If so, you want to put a \ at the end of the first line so it carries over properly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">blue_harvester</div><div class="date">22nd May 2006, 13:21</div></div><div class="posttext">Originally posted by RobGrant <br />
Are you using the split line in the actual code? If so, you want to put a \ at the end of the first line so it carries over properly.  <br />
No, the code is all on one line.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">22nd May 2006, 13:23</div></div><div class="posttext">So what happens? Does the ExecWait DOS box appear? Does the call itself fail, or the osql program within it? Are you checking the exact commandline call, so that you can make sure it's not just a syntax error?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">blue_harvester</div><div class="date">22nd May 2006, 13:55</div></div><div class="posttext">Originally posted by RobGrant <br />
So what happens? Does the ExecWait DOS box appear? Does the call itself fail, or the osql program within it? Are you checking the exact commandline call, so that you can make sure it's not just a syntax error?  <br />
The ExecWait DOS box appears for a split second (too short to see what the output is). Also to check the syntax, I have copied the command within the quotes and pasted it into a command window and this works perfectly! I'm really stumped as to what's going wrong.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">22nd May 2006, 15:01</div></div><div class="posttext">Hm, I bet it's the output redirection that's the problem. Try without the &quot;&gt; validateOSQL.dat -b&quot;, see what happens.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">blue_harvester</div><div class="date">22nd May 2006, 15:39</div></div><div class="posttext">Originally posted by RobGrant <br />
Hm, I bet it's the output redirection that's the problem. Try without the &quot;&gt; validateOSQL.dat -b&quot;, see what happens.  <br />
You're right Rob, got it to work. Using the -o option now with osql. Suppose I should've used that from the start!<br />
<br />
Thanks again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">22nd May 2006, 15:46</div></div><div class="posttext">Hehe that's ok :) There is a way to get it to work with the &gt; though, you just need to mess around with quotation marks to get it to work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gustavo-serra</div><div class="date">1st November 2007, 14:58</div></div><div class="posttext">I am having the same problem, but I do not use output redirection. As RobGrant, I paste the command in a DOS shell and it works as it should. What can I do?<br />
<br />
The command is: 'FOR /F $\&quot;tokens=1,*$\&quot; %i IN ($\'at$\') DO IF %~nxj EQU limpabd.sh.bat at %i /DELETE'<br />
<br />
It is a loop to remove specific agended tasks.<br />
Thanks any help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">1st November 2007, 15:04</div></div><div class="posttext">try to prefix that command with: cmd.exe /c<br />
you really should use nsExec or one of the other &quot;Dos&quot; exec plugins</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gustavo-serra</div><div class="date">1st November 2007, 16:46</div></div><div class="posttext">Ok, I will download and use it at once. I will give a try to your tip, thanks very much! :-D</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>