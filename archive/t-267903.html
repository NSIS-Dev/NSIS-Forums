<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Silent Uninst and Inst, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Silent Uninst and Inst NSIS Discussion" />
	
	<title> Silent Uninst and Inst [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Silent Uninst and Inst</div>
<hr />
<div class="pda"><a href="t-267903.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267903">Silent Uninst and Inst</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">16th March 2007, 21:03</div></div><div class="posttext">I'm trying to further automate all of my builds by creating a website that does builds and then deploys them automatedly.  I'm using psexec to call the exe on the machine where it has to run against in silent mode.  I have a problem with doing this because of the uninstaller.  <br />
<br />
The first thing the release does is check the registry to see if the app is already installed and if so, ask the user if they want to uninstall or abort.  I can check here if this is silent and if so, automatically uninstall, but then there's another point where the user has to intercede (press OK and click Install).  Is there a way I can have it skip by this?<br />
<br />
Thanks,<br />
Eric</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">16th March 2007, 21:28</div></div><div class="posttext">You could add all the needed for user interaction code into .onInit function and after that before continue (leave function) add the instruction SetSilent silent</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">16th March 2007, 21:35</div></div><div class="posttext">I'm in the situation you're talking about already now for most of our apps (only interaction is when I ask if they want to uninstall in .oninit).<br />
<br />
I'm sure this is just the first in a series of questions, but I think I figured out the uninst part:<br />
<br />
Just run the uninstaller silently also if this is a /S.  I'm trying it right now.<br />
<br />
Thanks Much,<br />
Eric</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">21st March 2007, 15:04</div></div><div class="posttext">I've tried this, but it doesn't seem to work.  It goes silent whether I've run it with the /S option or not.  Here's the code:<br />
<br />
____________________________________________<br />
<br />
  IfSilent runSilentUninstall<br />
<br />
  MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />
  &quot;MyApp is already installed. $\n$\nClick `OK` to remove the \<br />
  previous version or `Cancel` to cancel this upgrade.&quot; \<br />
  IDOK uninst<br />
  Abort<br />
  <br />
;Run the uninstaller<br />
uninst:<br />
  ClearErrors<br />
  CopyFiles /SILENT /FILESONLY &quot;$INSTDIR\myApp\Uninst.exe&quot; &quot;$TEMP\Uninst.exe&quot;<br />
  Delete &quot;$INSTDIR\myApp\Uninst.exe&quot;<br />
  ExecWait '&quot;$TEMP\Uninst.exe&quot; _?=$INSTDIR'<br />
  goto done<br />
<br />
runSilentUninstall:<br />
  ClearErrors<br />
  CopyFiles /SILENT /FILESONLY &quot;$INSTDIR\myApp\Uninst.exe&quot; &quot;$TEMP\Uninst.exe&quot;<br />
  Delete &quot;$INSTDIR\myApp\Uninst.exe&quot;<br />
  ExecWait '&quot;$TEMP\Uninst.exe&quot; /S _?=$INSTDIR'<br />
  <br />
done:<br />
  Abort<br />
<br />
____________________________________________<br />
<br />
Any help?<br />
<br />
Thanks,<br />
Eric &lt;&gt;&lt;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stonkers</div><div class="date">21st March 2007, 15:17</div></div><div class="posttext">OK, figured it out.  This is fine other than the abort that keeps me from running the installer.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>