<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" problem with checking if installed, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  problem with checking if installed NSIS Discussion" />
	
	<title> problem with checking if installed [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  problem with checking if installed</div>
<hr />
<div class="pda"><a href="t-320455.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=320455">problem with checking if installed</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">xabbu</div><div class="date">1st July 2010, 10:55</div></div><div class="posttext">Hello,<br />
<br />
I've a little problem.<br />
<br />
What I want:<br />
I want the installer to check what version is installed and if it is newer the old version should be uninstalled. if not do nothing and if you have installed a newer version it should inform you.<br />
<br />
my way to do it:<br />
<br />
<br />
Function .onInit<br />
  ClearErrors<br />
; Check to see if SEP sesam is installed (we need it)<br />
; uninstall old version first!<br />
  ReadRegStr $R1 &quot;${PRODUCT_UNINST_ROOT_KEY}&quot; &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayVersion&quot;<br />
  ${VersionCompare} $R1 &quot;${PRODUCT_VERSION}&quot; $1<br />
  !define PKEY &quot;$R1&quot;<br />
  IntCmpU &quot;$1&quot; &quot;1&quot; newer noupdate uninst<br />
  uninst:<br />
  ClearErrors<br />
  Exec $INSTDIR\uninst.exe ; instead of the ExecWait line<br />
  noupdate:<br />
  MessageBox MB_OK|MB_ICONEXCLAMATION   &quot;${PRODUCT_NAME} ist bereits in der Version ${PKEY} installiert!$\n$\nEs ist kein Update nötig!&quot;<br />
  Abort<br />
  newer:<br />
  MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION   \<br />
  &quot;${PRODUCT_NAME} ist in einer neueren Version installiert!$\n$\nEs ist kein Update nötig! \<br />
  Wenn Sie die alte Version istallieren wollen$\n$\ndrücken Sie `OK` oder `Abbrechen` um das Setup zu verlassen.&quot; \<br />
  IDOK uninst<br />
  Abort<br />
done:<br />
<br />
FunctionEnd<br />
<br />
<br />
my problem is that the version check works but then the installer run the unint-part and and runs forward to the noupdate-part.<br />
<br />
But first he should deinstall the old software, after that he should start the installation of the new files.<br />
<br />
I also tryed goto done after the exec but than the installer starts at the same time.<br />
Same when I use ExecWait.<br />
<br />
Any idears?<br />
<br />
Thanks<br />
Xabbu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">1st July 2010, 11:28</div></div><div class="posttext">my problem is that the version check works but then the installer run the unint-part and and runs forward to the noupdate-part.<br />
[...]<br />
I also tryed goto done after the exec but than the installer starts at the same time.<br />
Same when I use ExecWait.<br />
These are two different problems. You need the goto done, for obvious reasons. The installer not appearing to wait for the uninstaller to finish has been explained many times in these forums. I suggest you use the search function.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>