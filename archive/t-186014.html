<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to ensure installer will work on Win98?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to ensure installer will work on Win98? NSIS Discussion" />
	
	<title> How to ensure installer will work on Win98? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to ensure installer will work on Win98?</div>
<hr />
<div class="pda"><a href="t-186014.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=186014">How to ensure installer will work on Win98?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">John P.</div><div class="date">9th July 2004, 16:57</div></div><div class="posttext">Hi.<br />
<br />
I have a few installers which install some custom made textures into a game.<br />
<br />
The installers work perfectly on WinXP.<br />
<br />
The game in question does not officially support Win98(SE), only WinXP and Win2K. <br />
So I thought everything would be OK with these installers.<br />
<br />
But now it turns out that the game community have been able to &quot;hack&quot; the game so that it will play just fine on Win98, and that's when some problems started.<br />
<br />
Because apparently, some of my installers won't work on Win98. <br />
The weird thing to me is, that the most 'advanced' installer, where I use things like checking the registry to see if this and that file has already been installed, and write to and read from HKCU, which as far as I know isn't even a part of Win98 registry, works(although with a lot of error messages - but it does the job regardless, according to 'customers') while the 'simpler' installers does not work, according to 'customers'.<br />
<br />
I have no way of checking. Well - actually I still have a Win98 CD laying around, but I'm not going to start dual booting just for this.<br />
<br />
I have attached the 'simpler' installer .nsi below.<br />
<br />
I've tried to remove the &quot;real names&quot;, and made it as simple as possible. So it's not the installer script, but an example with the same commands.<br />
<br />
Could it be as simple as the fact that I'm using $WINDIR for the icon?<br />
Something else like that that won't work on Win98?<br />
<br />
<br />
I see now that there are a couple of small redundant things, like I never use the VER_NAME, but that's something that's &quot;left behind&quot; from the bigger, more 'advanced' script, and in any event shouldn't be the reason for this problem.<br />
<br />
attachment removed at user's request</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RDaneel</div><div class="date">9th July 2004, 17:31</div></div><div class="posttext">Two things:<br />
<br />
1) just checking &quot;known&quot; registry locations to determine which OS is installed or which packages/features are supported/installed can lead to problems... :)<br />
<br />
Microsoft has a number of APIs (which themselves have evolved with time) to check this stuff out.  Alternatively, NSIS itself presents some of this information in a somewhat abstracted form, so you might look at the set of predefined &quot;$&quot; values available.<br />
<br />
2) one of the great uses for VM technology is *exactly* the situation you are in (especially since you say you have a Win98 CD)!  I maintain [virtual] installations of 98, NT4, 2000, and XP for just this purpose.<br />
<br />
In addition, keeping a virtual installation of your current/development OS around allows you to use it as a &quot;sandbox&quot;, or to try out that suspicious program without risking your &quot;real&quot; system.<br />
<br />
I have used both VMware and VirtualPC, and have settled on VirtualPC for my own use.  Both have free trials available:<br />
<br />
http://www.microsoft.com/windows/virtualpc/default.mspx<br />
<br />
http://www.vmware.com/landing/ws4_home.html</div></div><hr />


<div class="post"><div class="posttop"><div class="username">delboy</div><div class="date">10th July 2004, 23:29</div></div><div class="posttext">Are you sure the problem doesnt lie in the batch file you seem to be running from this installer? my guess is that that is failing, theres nothing in that script that should cause problems... big thing to remember the way that batchfiles are passed arguments and can refer to them changed in NT.<br />
<br />
there are two reg keys that will tell you the type of windows you are installing on<br />
<br />
HKLM \<br />
  &quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion<br />
for all flavours of NT (XP and 2k included)<br />
<br />
HKLM \<br />
  &quot;SOFTWARE\Microsoft\Windows\CurrentVersion<br />
for windows 9x</div></div><hr />


<div class="post"><div class="posttop"><div class="username">John P.</div><div class="date">11th July 2004, 12:05</div></div><div class="posttext">Yeah - thanks; I have changed the batch files, because a very small amount of people had problems with installing even on XP. I was referring to %TEMP% in the batch file($TEMP in the NSIS script), which caused problems for some.<br />
<br />
Now the batch files don't use %TEMP% anymore(and of course neither does the NSIS script).<br />
<br />
I haven't actually asked anyone with 98 to test the new installer(will do), but one of the people on XP that had problems are saying that the installer now works well for him.<br />
<br />
So I'm guessing perhaps that was the problem on Win98 as well.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>