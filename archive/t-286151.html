<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Control Panel uninstall wont CallAs Guest user, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Control Panel uninstall wont CallAs Guest user NSIS Discussion" />
	
	<title> Control Panel uninstall wont CallAs Guest user [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Control Panel uninstall wont CallAs Guest user</div>
<hr />
<div class="pda"><a href="t-286151.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=286151">Control Panel uninstall wont CallAs Guest user</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">2nd February 2008, 09:56</div></div><div class="posttext">This problem is Windows Vista-related. I have an application that writes to its own directory (usually in Program Files\whatever), so the written file ends up in VirtualStore. I cannot change this behaviour, as the application is not mine.<br />
<br />
When uninstalling this app in Windows Vista through Control Panel / Programs and Features, I am unable to get CallFunctionAsUser to reach the guest user. Instead, the function is called as the (admin-)user that the uninstaller was elevated to.<br />
<br />
I have attached an example script. The installer manually creates a file in the Guest User's VirtualStore, and the uninstaller tries to delete it.<br />
1) I login as guest user and run install.<br />
2) It asks for an Admin login, so I log in as my standard account, &quot;Maarten&quot;.<br />
3) Installation completes successfully.<br />
4) I go to Control Panel / Programs and Features, and start uninstall.<br />
5) It asks for an Admin login, so I log in as my standard account, &quot;Maarten&quot;.<br />
6) The output of the MessageBox call is: C:\Users\Maarten\AppData\Local\VirtualStore\Program Files\UAC Test\test.dat<br />
<br />
In other words, un.UserFunction was called as Maarten, not as Guest User. However, if I start the uninstaller manually through Explorer, the function DOES get called as Guest User.<br />
My question is now, is this a bug in the UAC plugin, a 'feature' in Windows, or am I doing something wrong?<br />
<br />
Thanks in advance for any help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd February 2008, 20:25</div></div><div class="posttext">http://forums.winamp.com/showthread.php?postid=2240806#post2240806<br />
<br />
So, the UAC plugin is not the real solution here, if you are admin, you can enumerate all the users anyway, so use http://nsis.sourceforge.net/EnumUsersReg , figure out the path to the virtual store and delete your folder</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>