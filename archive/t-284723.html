<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" InstallDirRegKey and Vista, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  InstallDirRegKey and Vista NSIS Discussion" />
	
	<title> InstallDirRegKey and Vista [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  InstallDirRegKey and Vista</div>
<hr />
<div class="pda"><a href="t-284723.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=284723">InstallDirRegKey and Vista</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MaxPaul</div><div class="date">10th January 2008, 14:57</div></div><div class="posttext">InstallDirRegKey seems not to save to the registry when installating to Vista.<br />
What is the problem and how can I correct it?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">10th January 2008, 21:01</div></div><div class="posttext">tried it with the RequestExecutionLevel (http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.32) command?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">11th January 2008, 05:10</div></div><div class="posttext">InstallDirRegKey does not save anything to the registry(ever), it only reads</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MaxPaul</div><div class="date">11th January 2008, 13:21</div></div><div class="posttext">I use RequestExecutionLevel = user and save install dir to registry.<br />
It works on windows 95.<br />
On Vista, there is no HKLM/Software/(mysoftware) key created.<br />
Maybe the key is saved elsewhere; but were should I find it?<br />
(I'm developing on win 95, my program is tested by someone else that use Vista 32)<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">11th January 2008, 13:34</div></div><div class="posttext">to write to HKLM, you need admin rights (RequestExecutionLevel =admin, or use the UAC plugin)<br />
<br />
if you don't want to require admin rights, write to HKCU instead (that means you can't use $programfiles either)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MaxPaul</div><div class="date">15th January 2008, 14:31</div></div><div class="posttext">I now write to HKCU and it works.<br />
<br />
Should I write uninstall info to HKCU too?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">15th January 2008, 15:54</div></div><div class="posttext">if RequestExecutionLevel = user (and you are not using the UAC plugin), then yes, you must put the uninstall registry info in HKCU</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MaxPaul</div><div class="date">22nd January 2008, 08:38</div></div><div class="posttext">It seems that when you 'open with' a program installed with RequestExecutionLevel = user on Vista, this program is not added to the list.<br />
Should I request admin rights for installing my program?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eburghardt</div><div class="date">24th January 2008, 22:10</div></div><div class="posttext">I have plans to use the installed regkeys to determine if Winamp (v5.5.2) is installed, but the keys used seem to vary with the &quot;flavor&quot; of Vista...<br />
<br />
I have seen this difference on Vista Ultimate 64 and HomePremium 32 both running on a Dell w/ AMD x64 cpu<br />
<br />
For both XP32 and Vista Ult64 this key is valid<br />
&quot;HK_CLASSES_ROOT\\Winamp.File\\DefaultIcon&quot;// Vista64	<br />
<br />
but on Vista HomePremium32 the above key is no longer used<br />
&quot;HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\winamp.exe&quot;)<br />
<br />
<br />
I'm wondering why this is not consistent...?<br />
<br />
Thanks in advance,<br />
<br />
Ernie</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>