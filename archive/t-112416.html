<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Trial Installations, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Trial Installations NSIS Discussion" />
	
	<title> Trial Installations [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Trial Installations</div>
<hr />
<div class="pda"><a href="t-112416.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=112416">Trial Installations</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Jacob Metro</div><div class="date">1st November 2002, 22:59</div></div><div class="posttext">How do I allow a user to install one portion of a program, let him/her play with the program, and then allow him/her to choose if he/she wants to install another component now or not?<br />
<br />
Okay,<br />
I love Nullsoft.  Ya'll are awesome.<br />
<br />
Using KiCHiK's example &quot;one-section&quot; I have set up a installer which brings up 10 choices.  The user selects one (and only one) of these choices.  The installer installs the choice and runs the app (myapp) using ExecWait.  The user looks around at the app and uses the choice they made.  The user exits myapp upon which the installer asks MB_YESNO &quot;you want to install another now?&quot;  On YES, the installer opens another instance of itself and closes the old instance.  On NO, the installer QUITs.<br />
<br />
This works fine for the first or second time, at the third time on NO and CLOSE though AutoWindowClose is TRUE, the installer (which has reached 100% complete and says &quot;COMPLETE&quot;) opens myapp which is outside the logical order at this point.<br />
<br />
On closing, my logic uses MB_YESNO again, I choose NO and number three installer closes.<br />
<br />
Repeating the same, open myapp out of order and NO to MB_YESNO after exit myapp the remaining two installers close perfectly.<br />
<br />
Here's the brief (this is not raw code, this is interpreted code)version of KiCHiK's script modified.<br />
<br />
<br />
ComponentText &quot;choose&quot;<br />
Sections 0-10 (including required components)<br />
.onInit remembers which one is selected<br />
.onSelChange turns off the old selection and turns on the new one<br />
<br />
Function CALLEDBYSECTIONS 1-10<br />
ExecWait myapp<br />
onexit MB_YESNO &quot;another?&quot; IDYES goto ShowIT<br />
If NO goto STOPIT<br />
<br />
ShowIT:<br />
ExecWait Installer.exe<br />
goto STOPIT<br />
<br />
STOPIT:<br />
QUIT<br />
<br />
FunctionEnd<br />
<br />
<br />
This works once or twice, but definately not on the third one.  So, I put MessageBox's at each logical crux so this I couldn't get lost in this simple program.  <br />
The first time, all MB_OK's show up fine.  The second and third times, &quot;NO&quot; MB_OK's show up.<br />
<br />
<br />
What do you guys think?  Am I crazy?  Is this a bug or am I thinking incorrectly about this?<br />
<br />
Let me KNOW, share with me your knowledge and experience<br />
jacob<br />
<br />
a working copy of trial is attached, i stripped everything but the essentials (still does the same thing, by the way)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jacob Metro</div><div class="date">1st November 2002, 23:58</div></div><div class="posttext">Moderator, <br />
Please cancel this thread unless you think this forum will be able to answer my question pretty well.  I didn't realize that the developers at sourceforge.net/tracker would answer my query as fast as they have.<br />
Thanks,<br />
jacob</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Aus</div><div class="date">2nd November 2002, 00:35</div></div><div class="posttext">threads automatically expire after 30 days if no one posts to them. there's no need to thwack it really... someone might want to answer it also in the meantime.<br />
<br />
--aus</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jacob Metro</div><div class="date">2nd November 2002, 00:46</div></div><div class="posttext">Thanks,<br />
jmetro</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th November 2002, 16:02</div></div><div class="posttext">That's what happens when you post at two places...<br />
<br />
You can either use the solution I gave you at SourceForge (auto close the window) or you can use the new paging system. What you could do is ask the user weather he wants to install another part of your software, and if he does start backing up in the dialogs using the pre-functions and Abort. When you get to the starting page you stop with the Aborts, and vialloa, you have a new installation.<br />
<br />
This was actually possible with the old paging system too, just Abort -3 or something.... ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jacob Metro</div><div class="date">4th November 2002, 16:34</div></div><div class="posttext">I like your solution on SourceForge.  It seems to work perfectly now.<br />
thanks so much for your patience.<br />
jacob</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>