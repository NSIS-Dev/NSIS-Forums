<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" help for dll reg, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  help for dll reg NSIS Discussion" />
	
	<title> help for dll reg [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  help for dll reg</div>
<hr />
<div class="pda"><a href="t-273419.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=273419">help for dll reg</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">gpseaver</div><div class="date">26th June 2007, 04:40</div></div><div class="posttext">i made a NSIS setup installer which contains Dll register,<br />
it's ok when i install it locally,<br />
then i install it on a vitual machine(vmware 4,winxp), after installed it , run the programme ,it goes wrong , then<br />
checked out that the Dlls hadn't been registed .<br />
<br />
here is the code related:<br />
Section -Post<br />
  WriteUninstaller &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayName&quot; &quot;$(^Name)&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayVersion&quot; &quot;${PRODUCT_VERSION}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;URLInfoAbout&quot; &quot;${PRODUCT_WEB_SITE}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;Publisher&quot; &quot;${PRODUCT_PUBLISHER}&quot;<br />
   ;------------------å†™æ³¨å†Œè¡¨ï¼Œæ³¨å†Œdll<br />
  regdll &quot;$instdir\pdmftp.dll&quot;<br />
  regdll &quot;$instdir\rtxsend.dll&quot;<br />
  regdll &quot;$instdir\ftpsend.ocx&quot;<br />
  regdll &quot;$instdir\mb.ocx&quot;<br />
  regdll &quot;$instdir\MSCOMCT2.ocx&quot;<br />
  WriteRegStr HKCU &quot;Software\pdm&quot; &quot;path&quot; &quot;$instdir\pdm.exe&quot;<br />
  WriteRegStr HKLM &quot;Software\pdm&quot; &quot;path&quot; &quot;$instdir\pdm.exe&quot;<br />
SectionEnd<br />
<br />
sorry for my poor english, i'm a chinese guy ,hehe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">26th June 2007, 05:50</div></div><div class="posttext">I'm just guessing here, but on your box where it seems to work OK, you might have had those controls already registered? Try changing the sequence that you register them, put the ones that depend upon the others after the ones that don't depend upon any others. (I'm thinking that the ocx's might be needed by the pdmftp or rtxsend dlls, and can't register until the ocx's are registered).<br />
<br />
Don</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>