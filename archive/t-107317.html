<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Why? a bug?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Why? a bug? NSIS Discussion" />
	
	<title> Why? a bug? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Why? a bug?</div>
<hr />
<div class="pda"><a href="t-107317.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=107317">Why? a bug?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jangogo</div><div class="date">27th September 2002, 18:57</div></div><div class="posttext">I use a micro like this:<br />
!insertmacro UpgradeDLL &quot;dao360.dll&quot; &quot;$PROGRAMFILES\Common Files\Microsoft Shared\DAO\dao360.dll&quot;<br />
<br />
the micro like this:<br />
!macro UpgradeDLL DLL_NAME DLL_LOCATION<br />
  ...  <br />
  GetDLLVersion ${DLL_LOCATION} $3 $4<br />
  .......<br />
!endmacro<br />
<br />
when I compile,error comes:<br />
GetDLLVersion expects 3 parameters, got 5.<br />
Usage: GetDLLVersion filename $(user_var: high output) $(user_var: low output)<br />
Error in macro UpgradeDLL on macroline 8<br />
<br />
error cause because the filepath string &quot;...dao360.dll&quot; has two space.<br />
but if I don't call GetDLLVersion  in micro, everything is OK!<br />
or if I remove the two space in DLL_LOCATION , everything is OK,too!<br />
<br />
how I can run:<br />
!insertmacro UpgradeDLL &quot;dao360.dll&quot; &quot;$PROGRAMFILES\Common Files\Microsoft Shared\DAO\dao360.dll&quot;<br />
with no error?<br />
pls! I need your help!<br />
:hang:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dselkirk</div><div class="date">27th September 2002, 19:32</div></div><div class="posttext">try this<br />
<br />
GetDLLVersion &quot;${DLL_LOCATION}&quot; $3 $4</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jangogo</div><div class="date">28th September 2002, 04:09</div></div><div class="posttext">I try and it works.<br />
but the Script Cause compile error in :<br />
File /oname=${DLL_LOCATION} ${DLL_NAME}<br />
Usage: File ([/a] [/r] filespec [...]|/oname=outfile one_file_only)<br />
Error in macro UpgradeDLL on macroline 16<br />
<br />
So I change it to:<br />
File /oname=&quot;${DLL_LOCATION}&quot; ${DLL_NAME}<br />
it still the same error.<br />
<br />
So why this comes?and How I can do? those error always in micro.<br />
help me,pls!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eccles</div><div class="date">28th September 2002, 10:03</div></div><div class="posttext">This should do it:<br />
<br />
File &quot;/oname=${DLL_LOCATION}&quot; ${DLL_NAME}<br />
<br />
When a parameter may contain spaces, the quotes have to be placed around the whole parameter, not just the filename.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jangogo</div><div class="date">28th September 2002, 15:20</div></div><div class="posttext">I'm using it to handle my VB app installation. I works well except the .tlb  file register. if this problem is OK, this setup tool will be perfect!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">28th September 2002, 21:09</div></div><div class="posttext">That's normal, you don't have to register type libraries.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">29th September 2002, 15:56</div></div><div class="posttext">This is my personal version of the UpgradeDLL macro... I made it at the same time as Kypec. However, it does not need any additional plugins like his version.<br />
Hope you like it.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>