<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Check if running an close?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Check if running an close? NSIS Discussion" />
	
	<title> Check if running an close? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Check if running an close?</div>
<hr />
<div class="pda"><a href="t-143568.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=143568">Check if running an close?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mikemanczur</div><div class="date">25th July 2003, 18:55</div></div><div class="posttext">Since I give the user the option (you know how stupid end users are) to start the application after install and then they try and reinstall (who knows why), they get an error.  is there a way I can shut down the current application onInit or something so it will just re - install over the old one?  I get this error:<br />
<br />
error opening the file for writing</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th July 2003, 21:28</div></div><div class="posttext">What kind of file is it?<br />
There is a plugin on the NSIS Archive called killproc which you could use, but it terminates applications and does not shut them down properly (not like as if the user clicked save and then close.)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mikemanczur</div><div class="date">28th July 2003, 17:51</div></div><div class="posttext">For windows.  When you put your mouse over the application in the task bar you should get a window name.  If not, find the window name.  Use this function and it should close the application.  I did it with the onInit because I wanted to close the application before the re-installed.<br />
<br />
Function &quot;.onInit&quot;<br />
  Call CloseIt<br />
FunctionEnd<br />
<br />
Function CloseIt<br />
   Push $0 <br />
   loop: <br />
      FindWindow $0 &quot;&quot; &quot;Window Name&quot; <br />
      IntCmp $0 0 done <br />
         SendMessage $0 16 0 0 <br />
         Sleep 100 <br />
      Goto loop <br />
   done: <br />
   Pop $0 <br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th July 2003, 19:17</div></div><div class="posttext">That's a helpful script.<br />
<br />
Please post it on the NSIS Archive:<br />
http://nsis.sourceforge.net/archive/nsisweb.php<br />
<br />
(If a similar script does not already exist)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th July 2003, 19:18</div></div><div class="posttext">Never mind, this script is on there already:<br />
http://nsis.sourceforge.net/archive/nsisweb.php?page=76&amp;instances=0,11<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mikemanczur</div><div class="date">28th July 2003, 19:51</div></div><div class="posttext">It was a pretty hard find though.  Lots of BS to sift through.  So whomever supplied it thank you.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>