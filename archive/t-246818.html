<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" custom page leave function password validation, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  custom page leave function password validation NSIS Discussion" />
	
	<title> custom page leave function password validation [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  custom page leave function password validation</div>
<hr />
<div class="pda"><a href="t-246818.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246818">custom page leave function password validation</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">shaunb</div><div class="date">23rd May 2006, 10:48</div></div><div class="posttext">Hi people, I've been trying to validate a users login on a remote server page, I have the blank password code working fine, although I can't see why the abort doesnt work after reading the value from the text file, I want it to go back to the page like the abort call does on empty password, anyway I've included the page leave function if anyone can read it hehe <br />
<br />
:) <br />
<br />
Function exitGetCFPassPage<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $CFPASS &quot;getCFPass.ini&quot; &quot;Field 2&quot; &quot;State&quot;<br />
  MessageBox MB_OK &quot;$$CFPASS == $CFPASS&quot;<br />
  # check its not empty at least<br />
  ${If} $CFPASS == &quot;&quot;<br />
    # empty password, prompt for a valid password again<br />
    MessageBox MB_OK &quot;Please enter a valid ColdFusion admin password.&quot;<br />
    abort<br />
  ${endIf}<br />
  # we forget all the items are extracted here already due to this page coming after the instfiles page<br />
  # we can just perform a simple wget on the testlogin script, and read the contents of c:\adminapi.log<br />
  # to see if it produced true or false for a valid login, then we can validate in here until we get a<br />
  # valid password!<br />
  <br />
  NSExec::exec &quot;$TEMP\${gossTemp}\wget\wget.exe http://localhost/icm/adminAPI/testlogin.cfm?password=$CFPASS&quot;<br />
  # this returns a file c:\adminapi.log with true or false in, which we can use<br />
  # read the file, decide what to do etc, what about exceptions if its not there?<br />
  FileOpen $4 &quot;c:\adminapi.log&quot; r<br />
  # we read until the end of line (including carriage return and new line) and save it to $1<br />
  FileRead $4 $1<br />
  # close the file<br />
  FileClose $4<br />
  MessageBox MB_OK &quot;login result is : $1&quot;<br />
  ${If} $1 == &quot;false&quot;<br />
    # invalid login<br />
    MessageBox MB_OK &quot;Please enter a valid ColdFusion admin password.&quot;<br />
    abort<br />
  ${endIf}<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shaunb</div><div class="date">23rd May 2006, 10:51</div></div><div class="posttext">I believe I need to basically loop over the wget checking and file reading code until I get 'true' in $0<br />
<br />
but I've tried labels etc and this abort method and it doesnt work, so loop maybe?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shaunb</div><div class="date">23rd May 2006, 11:01</div></div><div class="posttext">hmm all my attempts to loop around this function just end in an infinite loop as it doesnt let me input a new value.<br />
<br />
I'm stuck :( <br />
<br />
damn you custom dialogs and all that jazz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st June 2006, 09:46</div></div><div class="posttext">With no further details like a complete example or the results of the message box, I have to guess and I put my bet on the FAQ (http://nsis.sourceforge.net/I_am_reading_a_file_name_from_another_file_and_Delete/FileOpen/CopyFiles_don%27t_work_with_the_file_name).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>