<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" problem with OpenMutexA (getting result)., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  problem with OpenMutexA (getting result). NSIS Discussion" />
	
	<title> problem with OpenMutexA (getting result). [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  problem with OpenMutexA (getting result).</div>
<hr />
<div class="pda"><a href="t-268642.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=268642">problem with OpenMutexA (getting result).</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MVI</div><div class="date">30th March 2007, 11:18</div></div><div class="posttext">Greetings...<br />
<br />
By the following code:<br />
<br />
	MessageBox MB_OK &quot;TEST&quot;<br />
<br />
	CheckApp:<br />
		System::Call 'kernel32::OpenMutexA(i 0, i 0, t &quot;{D50A79A4-CFD5-49a0-B94E-BBFA1D974616}&quot;) i .r1'<br />
		IntCmp $R1 0 +3 <br />
			MessageBox MB_OK &quot;App is running.&quot; <br />
			GoTo CheckApp<br />
<br />
i'm trying to check if my app. is running.<br />
But I can't see any &quot;App is running.&quot; MessageBoxes...<br />
(App is running and it has mutex with such name. I can see &quot;TEST&quot; MessageBox.)<br />
<br />
What I'm doing wrong?<br />
<br />
Best regards...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">30th March 2007, 13:02</div></div><div class="posttext">If your app is the running installer, take a look here,<br />
<br />
http://nsis.sourceforge.net/Allow_only_one_installer_instance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MVI</div><div class="date">30th March 2007, 13:53</div></div><div class="posttext">My app not an installer. And I've already saw that code. But my question not about it...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">30th March 2007, 14:04</div></div><div class="posttext">Then, perhaps you might want to take a look on this,<br />
<br />
http://nsis.sourceforge.net/FindProcDLL_plug-in</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MVI</div><div class="date">30th March 2007, 14:35</div></div><div class="posttext">Thats completely nothing of the kind I neded...<br />
All that I need, is just point on my error (with correction).<br />
For example this:<br />
<br />
	CheckForApp:<br />
		System::Call &quot;kernel32::CreateMutexA(i 0, i 0, t &quot;{B1454C40-EAFE-4124-809F-90DEC53E06EC}&quot;) ?e&quot;<br />
		Pop $R0<br />
		StrCmp $R0 0 +3 <br />
			MessageBox MB_OK &quot;Please close App before continue.&quot; <br />
			GoTo CheckForApp<br />
<br />
code (changed from http://nsis.sourceforge.net/Allow_only_one_installer_instance)<br />
Always shows &quot;Please close App before continue.&quot; independently of test application presence...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">30th March 2007, 14:37</div></div><div class="posttext">Your quotes are messed up, escape &quot; or use '<br />
<br />
System::Call 'kernel32::CreateMutexA(... t &quot;foo&quot; ) ?e'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MVI</div><div class="date">30th March 2007, 15:07</div></div><div class="posttext">in second and third examles of http://nsis.sourceforge.net/Allow_only_one_installer_instance used double-quotes...<br />
also i've tried and nothing changed...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">30th March 2007, 19:10</div></div><div class="posttext">1. you'll need to use the different quotes.<br />
<br />
2. you missed to specify an output argument:<br />
<br />
System::Call 'kernel32::CreateMutexA(i 0, i 0, t &quot;{B1454C40-EAFE-4124-809F-90DEC53E06EC}&quot;) i .n ?e'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MVI</div><div class="date">2nd April 2007, 09:02</div></div><div class="posttext">I'm actually need help with my first &quot;code&quot;...<br />
There are single quotes and there is output argument....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd April 2007, 11:21</div></div><div class="posttext">And what's the code you've used in your application?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MVI</div><div class="date">2nd April 2007, 12:15</div></div><div class="posttext">I've created two applications.<br />
One, fore creating mutex:<br />
	HANDLE mutex = ::CreateMutex(NULL, TRUE, L&quot;{B1454C40-EAFE-4124-809F-90DEC53E06EC}&quot;);<br />
	while (1)<br />
		Sleep(1000);<br />
<br />
and one, for check this mutex:<br />
	while (1)<br />
	{<br />
		HANDLE mutex = ::OpenMutex(READ_CONTROL, FALSE, L&quot;{B1454C40-EAFE-4124-809F-90DEC53E06EC}&quot;);<br />
		if (mutex != 0)<br />
		{<br />
			CloseHandle(mutex);<br />
<br />
			MessageBox(NULL, L&quot;Please close App before continue.&quot;, NULL, MB_OK);<br />
		}<br />
		else<br />
			Sleep(1000);<br />
	}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">2nd April 2007, 19:04</div></div><div class="posttext">if you got problems with your first code, it's missing the error output:<br />
<br />
System::Call 'kernel32::OpenMutexA(i 0, i 0, t &quot;{D50A79A4-CFD5-49a0-B94E-BBFA1D974616}&quot;) i .r1'<br />
you need the ?e at the end, because r1 won't tell you anything about the mutex. only the call of GetErrorSomethingBla which is done by ?e will give you the info whether the mutex could have been created or not.<br />
<br />
<br />
use the code i submitted previously and it will work (i'm using it all the time with my codes)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MVI</div><div class="date">3rd April 2007, 08:44</div></div><div class="posttext">I've changed my code:<br />
	CheckForApp:<br />
		System::Call 'kernel32::OpenMutexA(i 0x00020000, i 0, t &quot;{B1454C40-EAFE-4124-809F-90DEC53E06EC}&quot;) i .r1 ?e'<br />
		StrCmp $R1 0 AppNotRunning<br />
			MessageBox MB_OK &quot;Please close App before continue.&quot; <br />
			GoTo CheckForApp<br />
	AppNotRunning:<br />
<br />
but MessageBox appears independently of mutex presence...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd April 2007, 09:14</div></div><div class="posttext">The error value goes into $1 but you check $R1. Check $1 or change r1 to R1.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MVI</div><div class="date">3rd April 2007, 09:26</div></div><div class="posttext">thanks. now it works.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>