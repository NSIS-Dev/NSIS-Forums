<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to detect Office 2003 PIA, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to detect Office 2003 PIA NSIS Discussion" />
	
	<title> How to detect Office 2003 PIA [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to detect Office 2003 PIA</div>
<hr />
<div class="pda"><a href="t-278287.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=278287">How to detect Office 2003 PIA</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">whchan</div><div class="date">4th October 2007, 12:56</div></div><div class="posttext">Hi, <br />
<br />
I'm migrating an installer of excel COM addin from visual studio setup project to NSIS. It's been quite good so far until i work on the Office PIA (Primary Interop Assembly) detection and installation.<br />
<br />
In visual studio setup project, there're ways for us to make use of the piacheck.exe to add pre-requisite for office 2003 PIA, and we can use &quot;launch condition&quot; to check against the excel 2003's PIA's component ID.<br />
<br />
After hours of search, i find no way to do the same thing in NSIS. Could someone here provide me some help on detecting Office/Excel 2003 PIA?<br />
<br />
Reggie</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th October 2007, 13:49</div></div><div class="posttext">A quick Google search for piacheck.exe suggests it's an executable used to register add-ins. It accepts a GUID on the command line and seems to register it as an add-in. So, execute piacheck.exe and pass your GUID as an argument. You can use ExecWait for that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">whchan</div><div class="date">4th October 2007, 14:18</div></div><div class="posttext">Thanks for the quick reply!<br />
<br />
it seems piacheck is checking the MSI's component ID, but which function should i use to call it? running it in command prompt doesn't print anything.<br />
<br />
Also, i have problem in using ExecWait for O2003PIA.msi, from the log, it seems it is run, but from add/remove program, it's not installed.<br />
<br />
the O2003PIA.msi can be obtained at http://www.microsoft.com/downloads/details.aspx?FamilyID=3C9A983A-AC14-4125-8BA0-D36D67E0F4AD&amp;displaylang=en<br />
if this url is hidden in the reply, google &quot;office 2003 PIA&quot; the first entry will let you download the file.<br />
<br />
ExecWait for the other msi, exe are working fine (e.g. kb908002 patch), but specifically the O2003PIA is having problem with it. As i'm new to NSIS, i have no idea how to debug this issue... if someone knows what went wrong, pls point me to the right direction, thx!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th October 2007, 14:22</div></div><div class="posttext">You should use ExecWait to run piacheck.exe. I don't know anything about this program, so I can't tell if it should print anything.<br />
<br />
To install MSI packages, execute msiexec with ExecWait. See the two following Wiki pages for examples.<br />
<br />
http://nsis.sourceforge.net/Embedding_other_installers<br />
http://nsis.sourceforge.net/Uninstalling_a_previous_MSI<br />
<br />
If the MSI itself is giving you problems, it's already in the realm of the MSI and not NSIS. You can verify this by running the exact msiexec line you'd run with ExecWait in cmd.exe.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">whchan</div><div class="date">5th October 2007, 06:18</div></div><div class="posttext">ExecWait works well! Thanks so much!<br />
<br />
I'm using registry check now, and will try out using PIACheck.exe with ExecWait later today.<br />
<br />
Thanks a lot for your ultraquick replies!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>