<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" create GUID, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  create GUID NSIS Discussion" />
	
	<title> create GUID [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  create GUID</div>
<hr />
<div class="pda"><a href="t-354218.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=354218">create GUID</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">danCDT123</div><div class="date">6th January 2013, 15:12</div></div><div class="posttext">I have this instruction in NSIS script to create a GUID<br />
System::Call 'ole32::CoCreateGuid(g .s)'<br />
<br />
and then:<br />
!if ${_RetVar} != s<br />
        Pop ${_RetVar}<br />
<br />
In some weird cases the returned GUID is the string 'ole32::CoCreateGuid(g .s)'.<br />
Does anyone knows something about it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">12th January 2013, 18:10</div></div><div class="posttext">does this help?<br />
http://nsis.sourceforge.net/Create_a_GUID,_a_Globally_Unique_Identifier</div></div><hr />


<div class="post"><div class="posttop"><div class="username">danCDT123</div><div class="date">13th January 2013, 13:42</div></div><div class="posttext">Thank you for replying. This is the code we used in the first place. Maybe it has a bug?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">13th January 2013, 15:59</div></div><div class="posttext">first example runs fine on win7<br />
;test<br />
  SetCompressor /SOLID bzip2<br />
  AutoCloseWindow true<br />
  ShowInstDetails nevershow<br />
  ShowUninstDetails nevershow<br />
  OutFile &quot;test.exe&quot;<br />
;--------------------------------<br />
;Languages<br />
  LoadLanguageFile &quot;${NSISDIR}\Contrib\Language files\english.nlf&quot;<br />
;--------------------------------<br />
;Installer Sections<br />
  Section<br />
  SectionEnd<br />
;--------------------------------<br />
;Installer Functions<br />
<br />
Function .onInit<br />
  loop:<br />
    Call CreateGUID<br />
    Pop $0 ;contains GUID<br />
    messagebox mb_okcancel|mb_defbutton1 &quot;GUID: $0&quot; idok loop<br />
  done:<br />
<br />
  Quit<br />
FunctionEnd<br />
<br />
;Call CreateGUID<br />
;Pop $0 ;contains GUID<br />
Function CreateGUID<br />
  System::Call 'ole32::CoCreateGuid(g .s)'<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd March 2013, 07:53</div></div><div class="posttext">If you get the original string sent to System::Call, it means System::Call didn't do anything and just returned. That's why you just have the original string on the stack. That's... weird... Any more details on when this happens?<br />
<br />
Total shot in the dark guess, but did you build your own version of System.dll by any chance?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Marshallx7</div><div class="date">14th March 2013, 17:47</div></div><div class="posttext">I've had the EXACT same problem. Everything is original. It has only ever happend on customer systems though, and they report the error back to us. We have never been able to reproduce it ourselves. I'd say it maybe happens 1 in every 10,000 installs, maybe less frequently than that even.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th March 2013, 18:19</div></div><div class="posttext">You could put the call into a For loop for a few iterations until it either returns a GUID or throws an error message.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th March 2013, 01:23</div></div><div class="posttext">You could build System.dll with SYSTEM_LOG_DEBUG turn it on with System:: Debug $OUTDIR\somelogfile.log and request that log file when it happens.<br />
<br />
The only possibility I see in the code is lack of memory. But the user would have seen that elsewhere...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>