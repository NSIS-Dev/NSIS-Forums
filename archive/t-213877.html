<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Using SHCTX, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Using SHCTX NSIS Discussion" />
	
	<title> Using SHCTX [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Using SHCTX</div>
<hr />
<div class="pda"><a href="t-213877.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=213877">Using SHCTX</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">BillTanner</div><div class="date">22nd April 2005, 18:07</div></div><div class="posttext">Hi, I am new to NSIS.  I am building some installs for some programs and found out about this, and using the HM NIS Editor.  It looks great.<br />
<br />
One thing I do not know how to do is mimic the behavior of the Windows Installer on the Directory page that presents the user with two radio buttons labeled &quot;Everyone&quot; and &quot;Just Me&quot;.  I can see from using the wizard that the root key is being set to default as &quot;HKLM&quot;.  I have searched through these forums and seen a description of using &quot;SHCTX&quot; and &quot;SetShellVarContext&quot;, but I don't really understand how I am supposed to get that input from the user.<br />
<br />
So my questions are:<br />
1. Are there any new examples that show exactly how to get the user to input whether he or she wants to install in HKCU or HKLM, and then to set that variable?<br />
<br />
2. Is there a way to add those two radio buttons to the MUI_PAGE_DIRECTORY dialog for the user to make that decision?<br />
<br />
Thanks in advance for any answers or pointers to samples!<br />
Bill</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">22nd April 2005, 19:12</div></div><div class="posttext">You would have to add the radio buttons with Resource Hacker, and then you need to find out which one is checked in the page's Leave function using SendMessage.<br />
<br />
You could create a variable with Var and store say 0 or 1 in it (the state from the radio buttons would be easiest) and then in the sections use StrCmp to call WriteRegStr's on HKLM or HKCU.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BillTanner</div><div class="date">22nd April 2005, 21:26</div></div><div class="posttext">Hmm, that sounds more complicated than I thought it would be.  I will try to do what you suggested, thanks.  Are there any samples of someone doing this?  I would have to make a custom form, no?  I can't just add to the MUI_PAGE_DIRECTORY form that comes with NSIS?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">22nd April 2005, 21:52</div></div><div class="posttext">Yes you can add radio buttons with Resource Hacker like I said. Just search for the name on Google. You'd need to make a copy of Contrib\UIs\modern.exe and place the copy in the same folder as your script.<br />
Then use !define MUI_UI modern.exe to use the new copy.<br />
<br />
Open modern.exe in Resource Hacker and you need to open up dialog ID 103. Add the radio buttons, then click Compile and then Save. Make sure you give them both a unique control number. 8 and 9 haven't been used yet.<br />
<br />
To find out if one of them is checked or not, you need to use SendMessage with the appropriate windows message. This works for check boxes, but I doubt the same message (0x00F2) will work for radio buttons as well:<br />
<br />
FindWindow $R0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
GetDlgItem $R0 $R0 8<br />
SendMessage $R0 0x00F2 0 0 $R0<br />
StrCmp $R0 1 0 +2<br />
 MessageBox MB_OK &quot;Checked!&quot;<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">23rd April 2005, 18:24</div></div><div class="posttext">would be much easier to add a custom page with install options.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BillTanner</div><div class="date">28th April 2005, 22:58</div></div><div class="posttext">Thanks for the replies!<br />
<br />
Unfortunately, this, and a couple of other little cutomizations were too difficult for me to do (I'm a newb).  It seems like this should be an attribute added to the form like the other things.  It was taking me a while to figure out, and because of the delay my boss ORDERED me to drop this NSIS 'stuff' and use the 'WiX' Windows Installer XML toolset (http://sourceforge.net/projects/wix/) instead.<br />
<br />
Cheers!<br />
Bill</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>