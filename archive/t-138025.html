<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Page calling command, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Page calling command NSIS Discussion" />
	
	<title> Page calling command [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Page calling command</div>
<hr />
<div class="pda"><a href="t-138025.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=138025">Page calling command</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">khal_nayak</div><div class="date">6th June 2003, 01:15</div></div><div class="posttext">how to call or take the user back to a specific page of the installer by just specifing some command in the section?<br />
I mean when u specify some command in a section and when the user selects the components and clicks next, the installation starts. What i want is that if the user selects a specific section then during installation, a msgbox should appear on clicking which the user be send to some previous page of the installer, eg:license, welcome, component. So then what command is there to make the user jump to diffrent pages?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">6th June 2003, 02:02</div></div><div class="posttext">None really that I know of.<br />
You may be able to go to the next or previous page by sending a WM_COMMAND message to the window with the ID of the next or previous button. Never tried it, so I don't know if it will work.<br />
BTW, like your nick. :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th June 2003, 10:37</div></div><div class="posttext">You can add another page after the instfiles page and skip it if the user hasn't selected the right component.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">khal_nayak</div><div class="date">6th June 2003, 11:02</div></div><div class="posttext">is it possible to disable the next button on the components page if the user doesnt select the appropriate install type from the drop down list?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th June 2003, 11:06</div></div><div class="posttext">It's not possible to disable it, but it's possible to not allow the user to continue. Call Abort from the leave function of the page and the user won't be able to move on.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">khal_nayak</div><div class="date">6th June 2003, 17:08</div></div><div class="posttext">im not so good at scripting the NSIS so can u plz type in that part of the script so i know what u exactly mean.<br />
Secondly, in my installer there r some exe files which while installing update some older version of them on the computer but the problem is u cant update a dll or exe file if it is already running in the background or foreground so then is it possible to detect that such files r running and that the installer can close such running programs and then update the file and then make it run again using exec? Like what the msn messenger installer has, it closes the msn that is running in the system tray and then updates the exe file and then runs it again?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th June 2003, 10:25</div></div><div class="posttext">As for the leave function:<br />
<br />
Page components &quot;&quot; &quot;&quot; compLeave<br />
#...<br />
!include Sections.nsh<br />
Function compLeave<br />
  # make sure ${mySec} is defined!<br />
  SectionGetFlags ${mySec} $0<br />
  IntOp $0 $0 &amp; ${SF_SELECTED}<br />
  StrCmp $0 ${SF_SELECTED} ok<br />
    # the user didn't select the required section,<br />
    # don't let him leave the page<br />
    Abort<br />
  ok:<br />
FunctionEnd<br />
<br />
In case you're using the MUI see the MUI readme about defining a leave function for the components page.<br />
<br />
As for updating in use DLLs, use the UpgradeDLL macro (http://nsis.sourceforge.net/Docs/AppendixB.html#B.11).<br />
<br />
I don't know how to close messenger yet. There is a recent thread about it. I really recommend you don't use the process termination method though, it's far from being the ideal way. There are also some other less recent threads about closing programs, some linked from that thread.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">khal_nayak</div><div class="date">7th June 2003, 16:52</div></div><div class="posttext">thanx m8, i finally got the script working my way.<br />
Plz keep me informed if u get any news bout some way to close running exe files and progs.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>