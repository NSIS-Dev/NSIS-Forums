<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Refreshing MUI InstallOptions page after NOTIFY control used, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Refreshing MUI InstallOptions page after NOTIFY control used NSIS Discussion" />
	
	<title> Refreshing MUI InstallOptions page after NOTIFY control used [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Refreshing MUI InstallOptions page after NOTIFY control used</div>
<hr />
<div class="pda"><a href="t-228874.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228874">Refreshing MUI InstallOptions page after NOTIFY control used</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">AnarkiNet</div><div class="date">20th October 2005, 08:27</div></div><div class="posttext">Heres my situation: I have a custom InstallOptions page with NOTIFY controls, which execute correctly when clicked or manipulated in the compiled installer, but the page doesnt refresh! I have to press &quot;back&quot; then &quot;next&quot; to see the changes that were made.<br />
Heres my custom page code:<br />
Function ShowFileOptions<br />
    ${If} $ShowLiscense = 0<br />
        !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;FileOptions.ini&quot; &quot;Settings&quot; &quot;NextButtonText&quot; &quot;Finish&quot;<br />
    ${Else}<br />
        !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;FileOptions.ini&quot; &quot;Settings&quot; &quot;NextButtonText&quot; &quot;Continue &gt;&quot;<br />
    ${EndIf}<br />
    <br />
    !insertmacro MUI_HEADER_TEXT &quot;$(TEXT_IO_TITLE)&quot; &quot;$(TEXT_IO_SUBTITLE)&quot;   <br />
    !insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;FileOptions.ini&quot;<br />
    Pop $HWND<br />
    !insertmacro MUI_INSTALLOPTIONS_SHOW<br />
FunctionEnd<br />
<br />
Function LeaveFileOptions<br />
    !insertmacro MUI_INSTALLOPTIONS_READ $R0 &quot;FileOptions.ini&quot; &quot;Settings&quot; &quot;State&quot;<br />
    StrCmp $R0 0 Done<br />
    StrCmp $R0 7 AddBtn<br />
    StrCmp $R0 10 EditBtn<br />
    Abort<br />
    <br />
    AddBtn:<br />
        !insertmacro MUI_INSTALLOPTIONS_READ $R1 &quot;FileOptions.ini&quot; &quot;Field 3&quot; &quot;State&quot;<br />
        !insertmacro SMIS_APPEND &quot;$R1&quot; &quot;FileOptions.ini&quot; &quot;Field 5&quot;<br />
        Abort<br />
    <br />
    EditBtn:<br />
        !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;FileOptions.ini&quot; &quot;Field 6&quot; &quot;Flags&quot; &quot;DISABLED&quot;<br />
        Abort<br />
    <br />
    Done:<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th October 2005, 08:50</div></div><div class="posttext">You can't do it that way because the InstallOptions page is in memory and no longer read from the INI file.<br />
You must manipulate the dialog in memory with GetDlgItem and SendMessage etc<br />
<br />
You already have the code ready to use $HWND in your leave function.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AnarkiNet</div><div class="date">20th October 2005, 09:27</div></div><div class="posttext">Is there any more extensive documentation of the SendMessage and related commands? the NSIS help files that come with dont list any of the message numbers and barely glaze over what the function does.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th October 2005, 10:55</div></div><div class="posttext">Try this example InstallOptions script:<br />
http://nsis.sourceforge.net/mediawiki/images/d/d6/IoColors.zip<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>