<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Header file for getting file version information, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Header file for getting file version information NSIS Discussion" />
	
	<title> Header file for getting file version information [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Header file for getting file version information</div>
<hr />
<div class="pda"><a href="t-326458.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=326458">Header file for getting file version information</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jiake</div><div class="date">25th January 2011, 08:20</div></div><div class="posttext">The script is written by Anders originally and collected by me. This is an alternative choice for getting the version informations of an EXE or DLL intead of the MoreInfo (http://nsis.sourceforge.net/MoreInfo_plug-in) plug-in.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">25th January 2011, 11:46</div></div><div class="posttext">You should make a wiki page for something like this, it just gets lost on the forum.<br />
<br />
...also, why did you remove the LogicLib usage? The logic lib overhead is a single global variable that you end up declaring anyway if your installer uses MUI etc...<br />
Even if you don't want to use the logiclib, you could use (&quot;dynamic&quot;) labels, direct jumps are hard to get right.<br />
<br />
Finally, you sort of broke my code, if you check the pastebin code you see that I'm checking GetLastError even if GetFileVersionInfo returns != 0 since a comment on MSDN said that you could crash if you don't do this!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jiake</div><div class="date">25th January 2011, 14:58</div></div><div class="posttext">I think if one of the steps fails, it always must push error to stack, so I use IntCmp to jump to one common label to push error message. Additionally, I will look over the issue you said and update it.<br />
<br />
Updated for checking GetLastError:</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>