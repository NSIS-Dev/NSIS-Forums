<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Second Link on MUI Finish Page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Second Link on MUI Finish Page NSIS Discussion" />
	
	<title> Second Link on MUI Finish Page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Second Link on MUI Finish Page</div>
<hr />
<div class="pda"><a href="t-205926.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=205926">Second Link on MUI Finish Page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">25th January 2005, 19:41</div></div><div class="posttext">I need to add a second link on the MUI Finish Page.  I found some threads that say the only way other than a custom page is to add another field to the ioSpecial.ini file in the plugins dir.<br />
<br />
I can easily add the link in a pre function before the finish page with a !insertmacro MUI_INSTALLOPTIONS_WRITE command, but i need the structure to be there first, like this:<br />
<br />
[Field 5]<br />
Type=Link<br />
Left=10<br />
Right=180<br />
Top=126<br />
Bottom=136<br />
State=<br />
Text=<br />
<br />
Question #1: should i do it with the File command, like this?<br />
<br />
  FileOpen $5 $PLUGINSDIR\ioSpecial.ini a<br />
  FileSeek $5 0 END<br />
  FileWrite $5 &quot;[Field 3]&quot;<br />
  FileSeek $5 0 END<br />
  FileWrite $5 &quot;Type=Link&quot;<br />
  FileSeek $5 0 END<br />
  FileWrite $5 &quot;Left=10&quot;<br />
  FileSeek $5 0 END<br />
  yada yada yada...<br />
  FileClose $5<br />
<br />
<br />
Question #2: I noticed that i do not need the flushini command on windows 98 when using the !insertmacro MUI_INSTALLOPTIONS_WRITE command, is the flush built into the macro, or am i just getting lucky?  <br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">25th January 2005, 20:14</div></div><div class="posttext">!define MUI_PAGE_CUSTOMFUNCTION_PRE   &quot;add_radio_buttons&quot;<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW  &quot;fix_background_color&quot;<br />
  <br />
!insertmacro MUI_PAGE_WELCOME<br />
<br />
...<br />
...<br />
<br />
Function add_radio_buttons<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Settings&quot; &quot;NumFields&quot; &quot;5&quot;<br />
  <br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 3&quot; &quot;Bottom&quot; &quot;150&quot;<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Type&quot;   &quot;radiobutton&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Text&quot;   &quot;blabla&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Left&quot;   &quot;120&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Right&quot;  &quot;315&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Top&quot;    &quot;150&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Bottom&quot; &quot;160&quot;<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 5&quot; &quot;Type&quot;   &quot;radiobutton&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 5&quot; &quot;Text&quot;   &quot;blabla&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 5&quot; &quot;Left&quot;   &quot;120&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 5&quot; &quot;Right&quot;  &quot;315&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 5&quot; &quot;Top&quot;    &quot;160&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 5&quot; &quot;Bottom&quot; &quot;170&quot;<br />
<br />
FunctionEnd<br />
<br />
Function fix_background_color<br />
  Push $0<br />
<br />
  GetDlgItem $0 $MUI_HWND 1203<br />
  SetCtlColors $0 &quot;&quot; &quot;FFFFFF&quot;<br />
  GetDlgItem $0 $MUI_HWND 1204<br />
  SetCtlColors $0 &quot;&quot; &quot;FFFFFF&quot;<br />
<br />
  Pop $0<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">25th January 2005, 22:24</div></div><div class="posttext">superwan, thanks.  Your saying that !insertmacro MUI_INSTALLOPTIONS_WRITE will create the entry if not currently present, right?<br />
<br />
Anyone know about Question #2?  Thanks all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">26th January 2005, 00:14</div></div><div class="posttext">I answer &quot;yes&quot; ;) for my question, just thank pengyou...<br />
<br />
take care to the third field &quot;bottom&quot; value ;)<br />
<br />
don't know the answer for your second question :p<br />
<br />
<br />
see ya</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th January 2005, 11:02</div></div><div class="posttext">You only need to use FlushINI before deleting the INI file. This removes the INI file data from Windows 9X memory.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">26th January 2005, 15:58</div></div><div class="posttext">Good to know, thanks.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>