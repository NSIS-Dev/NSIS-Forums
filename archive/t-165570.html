<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Using NSIS for Install based on reg keys, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Using NSIS for Install based on reg keys NSIS Discussion" />
	
	<title> Using NSIS for Install based on reg keys [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Using NSIS for Install based on reg keys</div>
<hr />
<div class="pda"><a href="t-165570.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=165570">Using NSIS for Install based on reg keys</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">lardiop</div><div class="date">19th January 2004, 04:32</div></div><div class="posttext">Hey everyone...<br />
<br />
I am a serious noob at NSIS, and this is probably very easy to do, I just cant figure it out. I have to write a program that will, based on reading a series of reg keys default to a certain install routine. here's what I mean:<br />
<br />
1) Start the install with a basic intro.<br />
2) Read a series of registry keys, and based on those keys, display a list of what is and what isn't installed, then automatically check off what needs to be installed.<br />
3) I need to install Microsoft Hotfixes that a computer is missing with the silent switch set. (IE: /q or /x etc) Basically, I am trying to use NSIS to envoke silent installs of programs, not actually copying files or creating uninstall routines.<br />
<br />
Could someone show me/give me a framework/template for something like this?<br />
<br />
Much Appreciated! :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">blayde</div><div class="date">19th January 2004, 14:17</div></div><div class="posttext">i'm a bit of a noob too, so i can't give you an exact answer, but i can't see any technical reason why you couldn't roughly do what you are asking.<br />
<br />
one option is to simply build a script that checks every hotfix you code in, and apply it as required.  it wouldn't be as pretty as you painted in your example, but you could certainly use DetailPrint to let the user know what was going on.<br />
<br />
<br />
for each hofix i would basically do :<br />
<br />
1) use ReadRegStr to read the registry value/ find out if it exists. (1)<br />
2) use StrCmp to find out if it is something requiring updating (1)<br />
3) update if so, else do next hotfix<br />
<br />
<br />
notes :<br />
<br />
(1) for strings only, there are functions to for non-strings<br />
<br />
- some microsoft updates cannont be done automatically via NSIS, AFAIK.  only those that use update.exe or come packaged in their own .exe.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lardiop</div><div class="date">19th January 2004, 17:47</div></div><div class="posttext">Can I run the Qxxxxxx.exe or KBxxxxxxx.exe patches from MS using some sort of run command inside of NSIS based on wheather a reg key has a certain value?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">19th January 2004, 18:07</div></div><div class="posttext">Sure, use StrCmp to compare the value you have read from the key.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">blayde</div><div class="date">20th January 2004, 05:42</div></div><div class="posttext">a) in case i confused/worried you.  what i was referring to above was that some updates only get installed via an .inf - i don't know how you would do that via NSIS<br />
<br />
b) you should be able to run the update files by Exec or ExecWait<br />
<br />
c) i would be interested in using your code once your finished :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">20th January 2004, 11:39</div></div><div class="posttext">To install from an .inf file use this command ExecWait '$SYSDIR\rundll32.exe setupapi,InstallHinfSection DefaultInstall 132 &quot;path to inf&quot;'<br />
Vytautas :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Dick4</div><div class="date">21st January 2004, 17:52</div></div><div class="posttext">Originally posted by blayde <br />
<br />
c) i would be interested in using your code once your finished :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>