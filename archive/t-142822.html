<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Displaying $InstDir in a textbox, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Displaying $InstDir in a textbox NSIS Discussion" />
	
	<title> Displaying $InstDir in a textbox [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Displaying $InstDir in a textbox</div>
<hr />
<div class="pda"><a href="t-142822.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=142822">Displaying $InstDir in a textbox</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bSecRes</div><div class="date">19th July 2003, 20:10</div></div><div class="posttext">Slashes get removed.<br />
<br />
I wanted to display a custom page right before the InstFiles page (mostly because I wanted an Install button). I decided to use this page to review the users selections during the install. I have a multiline textbox and I try to do this:<br />
!insermacro MUI_INSTALLOPTIONS_Write &quot;readytoinstall.ini&quot; &quot;Field n&quot; &quot;State&quot; &quot;Directory To Install To:\r\n\t$InstDir\r\n\r\n&quot; but the output in the textbox is <br />
Directory To Install To:<br />
    C:Program FilesFolder Name<br />
('C:' and 'Program Files' may not actually be the user selection obviously, I just used those in this example.)<br />
<br />
I checked the $InstDir variable and it still has slashes before and after I use it here but they won't show up in the textbox. Ultimately, the program gets installed correctly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">19th July 2003, 20:22</div></div><div class="posttext">your question is similar to mine:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=142732<br />
<br />
i also need to transfer $INSTDIR to the IO<br />
<br />
pls help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bSecRes</div><div class="date">19th July 2003, 20:24</div></div><div class="posttext">I had originally written my post as a reply to yours but then I wasn't sure what it was exactly you were trying for so I posted a new thread.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bSecRes</div><div class="date">19th July 2003, 21:08</div></div><div class="posttext">My problems is solved here kind of:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=135250<br />
<br />
Later I escape the slashes in a CopyFiles thing and it doesn't work. I'll keep you all up to date on my progress.<br />
<br />
Edit:<br />
Guide to escaping things in NSIS<br />
$$  is $<br />
$\&quot; is &quot;<br />
&amp;&amp;  is &amp;<br />
\\  is \<br />
<br />
The convention appears to be double everything except the quote because that means null? If some other character has a natural meaning in it's double form like the quote then it will need to be escaped with $\x x being the character with natural double meaning.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th July 2003, 23:21</div></div><div class="posttext">Use the ConvertBStoDBS function on the NSIS archive for placing paths in an IO page.<br />
<br />
http://nsis.sourceforge.net/archive/nsisweb.php?page=290&amp;instances=0,11,122<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">19th July 2003, 23:50</div></div><div class="posttext">Does not work so far - or am i wrong with this?<br />
<br />
[Field 7]<br />
Type=DirRequest<br />
Left=10<br />
Right=300<br />
Top=95<br />
Bottom=108<br />
State=$R0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bSecRes</div><div class="date">19th July 2003, 23:56</div></div><div class="posttext">Brummelchen, according to Afrow, you would want to do something like this:<br />
<br />
Push $R0<br />
Call ConvertBStoDBS<br />
Pop $R0<br />
WriteINIStr &quot;SomeFile.ini&quot; &quot;Field 7&quot; &quot;State&quot; $R0<br />
<br />
You cannot set the value of state to $R0 in a text editor and then, once the Field is processed, have the current value of $R0 appear there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th July 2003, 00:08</div></div><div class="posttext">bSecRes is correct.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">20th July 2003, 00:11</div></div><div class="posttext">no fortune :(<br />
<br />
<br />
page custom selectsaveitems<br />
<br />
Function .onInit<br />
  ;Extract InstallOptions INI Files<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;menu01.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;menu02a.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;menu03a.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;menu02b.ini&quot;<br />
FunctionEnd<br />
<br />
Function selectsaveitems<br />
  Push $INSTDIR<br />
    Call ConvertBStoDBS<br />
  Pop $R0<br />
  WriteINIStr &quot;menu02a.ini&quot; &quot;Field 7&quot; &quot;State&quot; $R0<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;menu02a.ini&quot;<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th July 2003, 00:19</div></div><div class="posttext">Should be:<br />
Function .onInit<br />
  ;Extract InstallOptions INI Files<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;menu01.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;menu02a.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;menu03a.ini&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;menu02b.ini&quot;<br />
FunctionEnd<br />
<br />
Function selectsaveitems<br />
  Push $INSTDIR<br />
    Call ConvertBStoDBS<br />
  Pop $R0<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;menu02a.ini&quot; &quot;Field 7&quot; &quot;State&quot; $R0<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;menu02a.ini&quot;<br />
FunctionEnd<br />
<br />
Doing a<br />
WriteINIStr &quot;menu02a.ini&quot; &quot;Field 7&quot; &quot;State&quot; $R0<br />
will write it to C:\menu02a.ini, because you did not specify the file path.<br />
With MUI_INSTALLOPTIONS_WRITE, the macro puts the file path in for you (which is $PLUGINSDIR\menu02a.ini)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">20th July 2003, 00:29</div></div><div class="posttext">This works, thx.<br />
<br />
But i dont need &quot;ConvertBStoDBS&quot; any longer - the directory is shown proper without.<br />
<br />
But there is something strange - the content of this page is shown after a second intermission (blank page) - huh, thats Mcafee - if deactivated its fast. grmpf - operation must be inside RAM.<br />
<br />
aha - IC - i put that line somewhere before (.oninit) - now it's fast again :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th July 2003, 00:34</div></div><div class="posttext">The \\ \ problem must have been an old IO issue, and must have been fixed in latest (or a recent) CVS.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bSecRes</div><div class="date">20th July 2003, 00:35</div></div><div class="posttext">Still an IO issue, just not with DirRequest fields.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">20th July 2003, 01:19</div></div><div class="posttext">jep it is<br />
i used your idea for a pre-install page and get no &quot;\&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th July 2003, 11:46</div></div><div class="posttext">&quot;\&quot; becomes &quot;&quot; in labels.<br />
&quot;\&quot; stays as &quot;\&quot; in anything else (text boxes, dirrequest etc)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th July 2003, 12:25</div></div><div class="posttext">It's not an issue, it's by design. It is this way so you can use line breaks in labels. The unfortunate side affect is the need to double every black slash when writing to labels.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">8th September 2003, 03:52</div></div><div class="posttext">i tried to use this function but i had a minor problem that i have to be compatible to my &quot;version 1&quot; which has a &quot;\&quot; at each path infomation<br />
<br />
eg<br />
c:\programs\<br />
and not<br />
c:\programs<br />
<br />
ConvertBStoDBS has bug inside which converts<br />
c:\programs\<br />
to<br />
c:\programs\c:\programs\<br />
<br />
Not familiar with the code i wrote the following script which is not comfortable but which does it better.<br />
<br />
maybe someone can use it...<br />
<br />
<br />
Function ConvertBStoDBS2<br />
  Exch $R0 ;input string<br />
  Push $R1 ;length string<br />
  Push $R2 ;output string<br />
  Push $R3 ;temp string<br />
  Push $R4 ;counter<br />
  Strlen $R1 $R0<br />
  StrCmp $R1 &quot;0&quot; done<br />
  StrCpy $R2 &quot;&quot;<br />
  StrCpy $R4 &quot;0&quot;<br />
loop:<br />
  StrCpy $R3 $R0 1 $R4<br />
  StrCmp $R3 &quot;\&quot; &quot;0&quot; nobs<br />
    StrCpy $R2 &quot;$R2$R3&quot;<br />
  nobs:<br />
  StrCpy $R2 &quot;$R2$R3&quot;<br />
  IntOp $R4 $R4 + 1<br />
  IntCmp $R4 $R1 loop loop &quot;0&quot;<br />
  StrCpy $R0 $R2<br />
done:<br />
  Pop $R4<br />
  Pop $R3<br />
  Pop $R2<br />
  Pop $R1<br />
  Exch $R0 ;output string<br />
FunctionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>