<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" VersionCompare result is 1, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  VersionCompare result is 1 NSIS Discussion" />
	
	<title> VersionCompare result is 1 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  VersionCompare result is 1</div>
<hr />
<div class="pda"><a href="t-293500.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=293500">VersionCompare result is 1</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">healy76</div><div class="date">23rd June 2008, 13:54</div></div><div class="posttext">Hi<br />
<br />
In the VersionCompare help (http://nsis.sourceforge.net/VersionCompare) is the following sample:<br />
<br />
${VersionCompare} &quot;1.1.1.9&quot; &quot;1.1.1.01&quot; $R0     ; $R0=&quot;1&quot;<br />
<br />
<br />
This is correct. But the following code results 1 too:<br />
<br />
${VersionCompare} &quot;1.1.1.1&quot; &quot;1.1.1.01&quot; $R0     ; $R0=&quot;1&quot;<br />
<br />
<br />
This is not correct. VersionCompare must ignore zero values at the front of a version part. I think the following result was desirable:<br />
<br />
${VersionCompare} &quot;1.1.1.1&quot; &quot;1.1.1.01&quot; $R0     ; $R0=&quot;0&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd June 2008, 17:55</div></div><div class="posttext">01 and 1 are the same number. Why should the comparison result be any different?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">23rd June 2008, 18:00</div></div><div class="posttext">If they were the same then VersionCompare should return 0 not 1 as healy76 says? I personally don't think they are the same, but I'm not completely sure. I seem to remember when writing the function that this was based on, Instructor said that 01 is not the same as 1.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">healy76</div><div class="date">24th June 2008, 07:51</div></div><div class="posttext">It is 'not' correct. 1 is the same as 01 but 1 is not the same as 01.  *very_strange*  :-)<br />
<br />
@Afrow: For a C compiler is 010 an octal value and not a Integer. I think that is meaning by the Instructor. But here we have a Version number and not an single value. The devinition of a version is:  integer dot integer [dot integer dot integer]. [] is not mandatory.<br />
<br />
Other example: Whe you try to use a Microsoft .NET class to convert a string value to a version you can use a class named Version(). For this class the value &quot;1.1.1&quot; is the same as &quot;1.01.01&quot;. This class ignore the leading zero's.<br />
<br />
C#:<br />
     Version v1 = new Version(&quot;1.1.1&quot;);<br />
     MessageBox.Show( v1.ToString() );     // -&gt; 1.1.1<br />
<br />
     Version v2 = new Version(&quot;1.01.01&quot;);<br />
     MessageBox.Show(v2.ToString());       // -&gt; 1.1.1<br />
<br />
Currently i replace the value &quot;.0&quot; with &quot;.&quot; in my NSIS Script before i use the VersionCompare. It works fine but in future it was more user-friendly when the VersionCompare do this for me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th June 2008, 10:09</div></div><div class="posttext">Ok thanks for the info. I'd contact Instructor by PM! So basically it depends which way around your arguments are for the call?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">healy76</div><div class="date">24th June 2008, 10:57</div></div><div class="posttext">@Afrow: Sorry but i down't understand your last sentense/question.<br />
<br />
So basically it depends which way around your arguments are for the call?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th June 2008, 13:11</div></div><div class="posttext">Do you get the same result for<br />
${VersionCompare} &quot;1.1.1.1&quot; &quot;1.1.1.01&quot; $R0<br />
and<br />
${VersionCompare} &quot;1.1.1.01&quot; &quot;1.1.1.1&quot; $R0<br />
<br />
Just so we know it is a bug and not by design.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">healy76</div><div class="date">24th June 2008, 13:33</div></div><div class="posttext">Ah ok. I have test this in a little example. Here is the result:<br />
<br />
<br />
  ${VersionCompare} &quot;1.1.1.1&quot; &quot;1.1.1.01&quot; $R0<br />
  Detailprint $R0     ;-&gt;   $R0=&quot;1&quot;<br />
  <br />
  ${VersionCompare} &quot;1.1.1.01&quot; &quot;1.1.1.1&quot; $R0<br />
  Detailprint $R0     ;-&gt;   $R0=&quot;1&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">24th June 2008, 19:26</div></div><div class="posttext">${VersionCompare} &quot;1.1.1.1&quot; &quot;1.1.1.01&quot; $R0<br />
Detailprint $R0     ;-&gt;   $R0=&quot;1&quot;<br />
  <br />
${VersionCompare} &quot;1.1.1.01&quot; &quot;1.1.1.1&quot; $R0<br />
Detailprint $R0     ;-&gt;   $R0=&quot;2&quot;It is by design.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">healy76</div><div class="date">25th June 2008, 07:15</div></div><div class="posttext">Oh sorry. That's right. I have the value $R0=&quot;2&quot; too. Likely a copy &amp; past error of me. Sorry.<br />
<br />
Of course you can say: &quot;blue is equal to green&quot;. :-) But in the real world isn't it the same. <br />
<br />
What is the reason behind this design? I subscribe to a view whith Microsoft. &quot;01&quot; or &quot;001&quot; is only a formating rule of version number and so not the same as &quot;1&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">7th October 2008, 21:29</div></div><div class="posttext">I'm going to have to second the question of why this is by design; as far as I know, throughout school, in any programming language where you use decimals (which version numbers' individual parts are), and so forth on... leading zeroes can and should be ignored.<br />
<br />
1.000000 is not the exact same as 1 if you're in a scientific field, but even there, 00000001 is the exact same as 1.<br />
<br />
I understand that *some* programmers decide to go with a version number such as &quot;4.2&quot; and then release a minor update and not wanting to go to &quot;4.3&quot;, they make it &quot;4.25&quot; instead; those programmers need to be hit over the head with a clue-by-four.<br />
<br />
Right now it has potential for breaking version comparisons where it shouldn't.<br />
For example, to check on the version of .NET Framework 3.0, I need to do the following (assume the second value is read from registry):<br />
${VersionCompare} &quot;3.0.04506.26&quot; &quot;3.0.04506.26&quot; $1<br />
This returns 0 as both are equal.<br />
<br />
Personally I have a newer version installed:<br />
${VersionCompare} &quot;3.0.04506.26&quot; &quot;3.0.04506.30&quot; $1<br />
This returns 2, as the second is newer.  All good.<br />
<br />
But then along comes a pre-release:<br />
${VersionCompare} &quot;3.0.04506.26&quot; &quot;3.0.4506.21&quot; $1<br />
This returns 2; even though the second version - imho - is the lesser, not the greater, of the two.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">stb</div><div class="date">13th October 2008, 18:22</div></div><div class="posttext">; example:<br />
;   Push &quot;1.2.3.4&quot;  ; versionnumber 1<br />
;   Push &quot;1.2.4&quot;    ; versionnumber 2<br />
;   !insertmacro VersionCheck<br />
;   Pop $0<br />
; Result is: &quot;0&quot; if equal, &quot;1&quot; if 1 is higher, &quot;2&quot; if 2 is higher<br />
!macro CompareVersionnumbers<br />
  !define Index 'VersionCheck_Line${__LINE__}'<br />
  Exch $R0 ;second versionnumber<br />
  Exch<br />
  Exch $R1 ;first versionnumber<br />
  Push $R3 ;temp char<br />
  Push $R4 ;temp string for $R0<br />
  Push $R5 ;temp string for $R1<br />
  Push $R6 ;counter for $R0<br />
  Push $R7 ;counter for $R1<br />
  StrCpy $R6 &quot;-1&quot;<br />
  StrCpy $R7 &quot;-1&quot;<br />
${Index}-Start:<br />
  StrCpy $R4 &quot;&quot;<br />
${Index}-DotLoop0:<br />
  IntOp $R6 $R6 + 1<br />
  StrCpy $R3 &quot;$R0&quot; 1 $R6<br />
  StrCmp $R3 &quot;&quot; ${Index}-DotFound0<br />
  StrCmp $R3 &quot;.&quot; ${Index}-DotFound0<br />
  StrCpy $R4 &quot;$R4$R3&quot;<br />
  Goto ${Index}-DotLoop0<br />
${Index}-DotFound0:<br />
  StrCpy $R5 &quot;&quot;<br />
${Index}-DotLoop1:<br />
  IntOp $R7 $R7 + 1<br />
  StrCpy $R3 &quot;$R1&quot; 1 $R7<br />
  StrCmp $R3 &quot;&quot; ${Index}-DotFound1<br />
  StrCmp $R3 &quot;.&quot; ${Index}-DotFound1<br />
  StrCpy $R5 &quot;$R5$R3&quot;<br />
  Goto ${Index}-DotLoop1<br />
${Index}-DotFound1:<br />
  StrCmp $R4 &quot;&quot; 0 ${Index}-4NotEmpty<br />
  StrCmp $R5 &quot;&quot; ${Index}-Equal<br />
  StrCpy $R4 &quot;0&quot;<br />
${Index}-4NotEmpty:<br />
  StrCmp $R5 &quot;&quot; 0 ${Index}-CompareNumbers<br />
  StrCpy $R5 &quot;0&quot;<br />
${Index}-CompareNumbers:<br />
  IntCmp $R4 $R5 ${Index}-Start ${Index}-Ver1More ${Index}-Ver2More<br />
${Index}-Equal:<br />
  StrCpy $R0 &quot;0&quot;<br />
  Goto ${Index}-Finish<br />
${Index}-Ver1More:<br />
  StrCpy $R0 &quot;1&quot;<br />
  Goto ${Index}-Finish<br />
${Index}-Ver2More:<br />
  StrCpy $R0 &quot;2&quot;<br />
${Index}-Finish:<br />
  Pop $R7<br />
  Pop $R6<br />
  Pop $R5<br />
  Pop $R4<br />
  Pop $R3<br />
  Pop $R1<br />
  Exch $R0<br />
  !undef Index<br />
!macroend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">13th October 2008, 18:48</div></div><div class="posttext">Cool - might have to Function-ize it.. still beats what I had been doing, though (Strip Leading Zeroes - wiki, WordReplace'ing &quot;.0&quot; with &quot;.&quot; (taking care to replace &quot;.0.&quot; with a safeguard), then finally calling the existing versioncompare.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>