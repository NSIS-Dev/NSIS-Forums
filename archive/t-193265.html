<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExtractDLLEx Plugin, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExtractDLLEx Plugin NSIS Discussion" />
	
	<title> ExtractDLLEx Plugin [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExtractDLLEx Plugin</div>
<hr />
<div class="pda"><a href="t-193265.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=193265">ExtractDLLEx Plugin</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mumpitzstuff</div><div class="date">12th September 2004, 00:42</div></div><div class="posttext">Hello,<br />
<br />
i enhanced the original ExtractDLL Plugin from Tim Kosse with the following features:<br />
<br />
- added LZMA compression<br />
- added file container support to add more than one file to the compressed file (like zip)<br />
- added wildcard support (* and ?)<br />
- added relative path support<br />
<br />
Have fun with the plugin...<br />
<br />
Achim Winkler<br />
<br />
Homepage (http://www.lkcc.org/achim) <br />
Download (http://www.lkcc.org/achim/download/extractdllex.zip)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th September 2004, 13:34</div></div><div class="posttext">Could you create an NSIS Archive page for this?<br />
<br />
http://nsis.sourceforge.net/archive/nsisweb.php<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ImmortAlex</div><div class="date">13th September 2004, 04:50</div></div><div class="posttext">Plugin depends on msvcr71.dll. My W2K Prof SP4 doesn't contains this dll. (Yes, I found it in some other program, but anyway...)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dujuan</div><div class="date">13th September 2004, 04:52</div></div><div class="posttext">hello, I am a beginner, <br />
Can somebody tell me how to ues ExtractDLLEx.dll ?<br />
<br />
I have read readme.txt, but I still don't know the meaning of &quot;Call the function &quot;extract&quot; with CallInstDLL&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ImmortAlex</div><div class="date">13th September 2004, 05:10</div></div><div class="posttext">1. Copy extractdllex.dll into NSIS\Plugins directory.<br />
2. In your script write:<br />
<br />
Push &quot;name_of_compressed_file&quot;<br />
Push &quot;name_of_file_to_extract&quot;<br />
extractdllex::extract<br />
Pop $0<br />
<br />
After that you'll have result code (&quot;success&quot; or error text) in $0.<br />
<br />
... And I found that plugin doesn't support masks in name of file to extract :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumpitzstuff</div><div class="date">13th September 2004, 08:12</div></div><div class="posttext">And I found that plugin doesn't support masks in name of file to extract :(<br />
<br />
This feature is only needed for the compression of files! How should the plugin extract files with masks??? Thats impossible.<br />
<br />
Achim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ImmortAlex</div><div class="date">13th September 2004, 08:44</div></div><div class="posttext">I want to use some archiver for backup when install over pervious installation and restore when uninstall.<br />
When I install I can use CompressFile.exe to create backup file, contains all installation directory, but when I uninstall I can't use extractdllex for restore previous state because I can't extract *.*<br />
That's all. I think I will use full version of 7-zip, or something else GPL-ed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumpitzstuff</div><div class="date">13th September 2004, 08:56</div></div><div class="posttext">Plugin depends on msvcr71.dll. My W2K Prof SP4 doesn't contains this dll. (Yes, I found it in some other program, but anyway...) <br />
<br />
you are right. i will fix that next days and will release a new version. thx for the tip!<br />
<br />
achim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumpitzstuff</div><div class="date">13th September 2004, 09:03</div></div><div class="posttext">When I install I can use CompressFile.exe to create backup file, contains all installation directory, but when I uninstall I can't use extractdllex for restore previous state because I can't extract *.*.<br />
<br />
thats not correct. if you create a backup with compressfile.exe (this needs lzma.exe!) with the following command:<br />
<br />
compressfile test.7z test.* /test/test.*<br />
<br />
and you have a directory structure like:<br />
<br />
test.exe<br />
test.ext<br />
test.dat<br />
/test/test.exe<br />
/test/text.ext<br />
/test/test.dat<br />
<br />
all 6 files gets compressed into test.7z! now copy the test.7z to the directory where you want to extract the files and call the extract function to get your 6 files including the directory structure back!<br />
<br />
achim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ImmortAlex</div><div class="date">13th September 2004, 09:21</div></div><div class="posttext">What should I push as name of file to extract? &quot;*.*&quot; or something else?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumpitzstuff</div><div class="date">13th September 2004, 09:23</div></div><div class="posttext">Hello,<br />
<br />
try this files if you do not have msvcr71.dll installed (like on most systems...)<br />
<br />
Achim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dujuan</div><div class="date">13th September 2004, 14:40</div></div><div class="posttext">Originally posted by mumpitzstuff <br />
thats not correct. if you create a backup with compressfile.exe (this needs lzma.exe!) with the following command:<br />
<br />
compressfile test.7z test.* /test/test.*<br />
<br />
and you have a directory structure like:<br />
<br />
test.exe<br />
test.ext<br />
test.dat<br />
/test/test.exe<br />
/test/text.ext<br />
/test/test.dat<br />
<br />
all 6 files gets compressed into test.7z! now copy the test.7z to the directory where you want to extract the files and call the extract function to get your 6 files including the directory structure back!<br />
<br />
achim  <br />
<br />
After I get test.7z , I write my script:<br />
<br />
ExtractDLLEx::extract &quot;e:\web\*.*&quot; &quot;e:\test.7z&quot;<br />
<br />
But there is something wrong, there is no file at the folder &quot;e:\web&quot; at the result.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumpitzstuff</div><div class="date">13th September 2004, 15:09</div></div><div class="posttext">hi,<br />
<br />
okay my explanation was wrong.<br />
<br />
the follwoing:<br />
<br />
ExtractDLLEx::extract &quot;e:\web\*.*&quot; &quot;e:\test.7z&quot;<br />
<br />
should be:<br />
<br />
Push &quot;test.7z&quot;<br />
Push &quot;update.tmp&quot;<br />
  <br />
ExtractDll::extract<br />
<br />
update.tmp is only the temporary filename for the decompression. after decompression the temp file gets splitted to the original files!<br />
<br />
achim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dujuan</div><div class="date">13th September 2004, 16:46</div></div><div class="posttext">I am so foolish that I don't know how to decompression the temp file(update.tmp). Can you tell me ?<br />
<br />
Please don't kick me...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumpitzstuff</div><div class="date">13th September 2004, 18:03</div></div><div class="posttext">okay you have the compressed test.7z file created with compressfile.exe. now write a little script where you call exactly this:<br />
<br />
Push &quot;test.7z&quot;<br />
Push &quot;update.tmp&quot;<br />
<br />
ExtractDLLEx::extract<br />
<br />
now create a exe file (let me call it update.exe) from your script and put the update.exe and test.7z into the same directory. you should create a new directory to see that something changed. execute the update.exe file and the file or files you compressed before should be uncompressed to this directory.<br />
i do not know how i can make it more clear...<br />
<br />
to get the result of the unpacking process you can enhance the script:<br />
<br />
Push &quot;test.7z&quot;<br />
Push &quot;update.tmp&quot;<br />
  <br />
ExtractDll::extract<br />
  <br />
;get the result<br />
Pop $0<br />
StrCmp $0 success SUCCESS<br />
  MessageBox MB_OK|MB_ICONSTOP &quot;$0&quot;<br />
<br />
SUCCESS:<br />
<br />
<br />
i hope this helps.<br />
<br />
achim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dujuan</div><div class="date">14th September 2004, 01:47</div></div><div class="posttext">Thank you very much!<br />
<br />
I think my explanation was wrong.<br />
<br />
my step:<br />
1.Create update.exe <br />
2.Put update.exe and test.7z in the same directory<br />
3.Execute update.exe, and get update.tmp<br />
<br />
I think update.tmp is a file container. How can I get the 6 original file in the update.tmp ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumpitzstuff</div><div class="date">14th September 2004, 06:15</div></div><div class="posttext">you get the files like i described it before with the extract command!!!!!!!! the extract command unpack the filecontainer to update.tmp and split the filecontainer to the original files!!!! it is not needed to do more.<br />
<br />
achim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumpitzstuff</div><div class="date">14th September 2004, 07:28</div></div><div class="posttext">the following is the pack/unpack sequence:<br />
<br />
; batch file to compress files<br />
CompressFile.exe test.7z test.* test/test.txt<br />
<br />
<br />
       test.exe      test.dat    test/test.txt<br />
               \        |        /<br />
                \       |       /<br />
                 \      |      /<br />
                  \     |     /<br />
CompressFile.exe   \    |    /<br />
                    pack.tmp (hardcoded in CompressFile)<br />
                        |<br />
                        |<br />
                     test.7z<br />
--------------------------------------------------------<br />
                     test.7z   <br />
                        |<br />
                        |<br />
                    update.tmp (temporary file!)<br />
ExtractDLLEx.dll    /   |   \<br />
                   /    |    \<br />
                  /     |     \<br />
                 /      |      \<br />
                /       |       \<br />
        test.exe     test.dat    test/test.txt<br />
        <br />
<br />
; nsis script to unpack files<br />
Push &quot;test.7z&quot;<br />
Push &quot;update.tmp&quot;<br />
  <br />
ExtractDllEx::extract<br />
  <br />
;get the result<br />
Pop $0<br />
StrCmp $0 success SUCCESS<br />
  MessageBox MB_OK|MB_ICONSTOP &quot;$0&quot;<br />
  <br />
SUCCESS:<br />
<br />
<br />
thats all i can say about it. i do not have more options to explain it...<br />
<br />
achim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dujuan</div><div class="date">14th September 2004, 11:12</div></div><div class="posttext">I apologize for my dumpishness.<br />
<br />
when I execute update.exe, therer is one error:<br />
Could not open splitted destination file.<br />
<br />
my OS : Windows XP pro + SP2<br />
my sources file and nsis script:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumpitzstuff</div><div class="date">14th September 2004, 11:49</div></div><div class="posttext">ahhhh now i see the problem. .. in relative paths is not supported at this time! the files you want to compress should be in the same directory like compressfile.exe or in subdirectories created in the same directory like compressfile.exe!!!<br />
<br />
achim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dujuan</div><div class="date">14th September 2004, 12:07</div></div><div class="posttext">Success!<br />
<br />
Thank you very much!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumpitzstuff</div><div class="date">15th September 2004, 11:25</div></div><div class="posttext">Hello,<br />
<br />
here is a new version of the plugin. Have fun!<br />
<br />
Achim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dujuan</div><div class="date">15th September 2004, 13:27</div></div><div class="posttext">Good!<br />
<br />
Does this new verion depend on msvcr71.dll ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumpitzstuff</div><div class="date">15th September 2004, 15:57</div></div><div class="posttext">this version depends on msvcrt.dll. this file should be included in every windows version down to win95.<br />
<br />
achim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">16th September 2004, 19:38</div></div><div class="posttext">would it be much work, to make it work the other way round? a plugin that creates 7z archives?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumpitzstuff</div><div class="date">17th September 2004, 11:11</div></div><div class="posttext">hello,<br />
<br />
to pack lzma is not so easy because there is no simple c interface for it. i tried it already and got a file of round 100kb. thats to much in my opinion but also to much work to make it smaller. at this time you can use compressfile and lzma.exe together to pack files...<br />
<br />
achim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dujuan</div><div class="date">17th September 2004, 16:43</div></div><div class="posttext">hello,<br />
<br />
When I execute update.exe(created from script), the filecontainer(update.tmp) will be splitted to the original files at the same directory. <br />
my question: how to split filecontainer to the original files to the special directory?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">18th September 2004, 17:49</div></div><div class="posttext">Originally posted by mumpitzstuff <br />
hello,<br />
<br />
to pack lzma is not so easy because there is no simple c interface for it. i tried it already and got a file of round 100kb. thats to much in my opinion but also to much work to make it smaller. at this time you can use compressfile and lzma.exe together to pack files...<br />
<br />
achim  <br />
<br />
so far i was using 7za.exe to do that, but as this is capable of packing and extracting, the filesize is quite big. where exactly can i get lzma.exe?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dujuan</div><div class="date">19th September 2004, 02:05</div></div><div class="posttext">Download LZMA SDK 4.06 (http://www.7-zip.org/sdk.html)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumpitzstuff</div><div class="date">20th September 2004, 11:02</div></div><div class="posttext">Originally posted by dujuan <br />
how to split filecontainer to the original files to the special directory?<br />
<br />
thats not supported at this time. but i will see what i can do...<br />
<br />
achim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mumpitzstuff</div><div class="date">21st September 2004, 10:17</div></div><div class="posttext">hello,<br />
<br />
i found a simple solution for your problem...<br />
<br />
1.) create a packed file e.g. test.7z<br />
<br />
2.) create a compiled nsis script (test.exe) where you set the variable SetOutPath to the directory you want to unpack the files (e.g. c:\unpacked) and call the extract function of the plugin after it.<br />
<br />
3.) copy test.7z to the same directory like SetOutPath e.g. c:\unpacked\test.7z<br />
<br />
4.) now copy test.exe to any directory you want e.g. c:\packed and execute test.exe<br />
<br />
5.) the files from c:\packed\test.7z should be unpacked in c:\unpacked\*.* now<br />
<br />
Function Test<br />
<br />
  SetOutPath &quot;c:\unpacked&quot;<br />
  <br />
  ;path not needed<br />
  Push &quot;c:\unpacked\test.7z&quot;<br />
  Push &quot;c:\unpacked\update.tmp&quot;<br />
  <br />
  ExtractDllEx::extract<br />
  <br />
  ;get the result<br />
  Pop $0<br />
  StrCmp $0 success SUCCESS<br />
    MessageBox MB_OK|MB_ICONSTOP &quot;$0&quot;<br />
    Delete &quot;update.tmp&quot;<br />
        <br />
    Quit<br />
      <br />
  SUCCESS:<br />
    ;Delete temp files<br />
    Delete &quot;update.tmp&quot;<br />
<br />
FunctionEnd <br />
<br />
achim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dujuan</div><div class="date">22nd September 2004, 03:37</div></div><div class="posttext">Good!<br />
thx!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RoMZERO</div><div class="date">3rd November 2004, 21:28</div></div><div class="posttext">why the plugin dont work with files compressed with 7-zip ?<br />
<br />
i'm use 7-zip 4.10</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>