<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Preinstaller, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Preinstaller NSIS Discussion" />
	
	<title> Preinstaller [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Preinstaller</div>
<hr />
<div class="pda"><a href="t-289443.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289443">Preinstaller</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kzchris</div><div class="date">1st April 2008, 14:11</div></div><div class="posttext">I would like to write preinstaller which will contain all my files, extract them when executed and in the end execute pointed installer. <br />
The problem is that my install folder contains many files and other folders and I donâ€™t want to point all the files in nsis script of preinstaller. Do you have any idea haw to write such preinstaller and point only whole folder do compress. Perhaps there are better tools to do this â€“ if you have any idea please let me know.<br />
Thanks for your time<br />
Kzchris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">1st April 2008, 17:51</div></div><div class="posttext">I had a hard time following you, but, if I understand this correctly:<br />
&quot;The problem is that my install folder contains many files and other folders and I donâ€™t want to point all the files in nsis script of preinstaller&quot;<br />
<br />
Then instead of this:<br />
<br />
SetOutPath &quot;$INSTDIR\folder1&quot;<br />
File &quot;source\folder1\file1&quot;<br />
File &quot;source\folder1\file2&quot;<br />
File &quot;source\folder1\file3&quot;<br />
<br />
SetOutPath &quot;$INSTDIR\folder2&quot;<br />
File &quot;source\folder2\file1&quot;<br />
File &quot;source\folder2\file2&quot;<br />
File &quot;source\folder2\file3&quot;<br />
You want to make your life easier and do something like this:<br />
<br />
SetOutPath &quot;$INSTDIR&quot;<br />
File /r &quot;source\*.*&quot;<br />
This will take all the folders and files under the source subdirectory and extract them to the $INSTDIR, preserving directory structure.  So you just make your file structure the same as the destination.  I also sub divide my files based on sections.<br />
<br />
So, my directory structure might look like this on my development machine:<br />
<br />
C:\MyNSISDevelopment\Installer\MyInstaller.nsi<br />
C:\MyNSISDevelopment\Sections\SectionAAA\ToCopy\Folder1\FileA1.txt<br />
C:\MyNSISDevelopment\Sections\SectionAAA\ToCopy\Folder1\FileA2.txt<br />
C:\MyNSISDevelopment\Sections\SectionAAA\ToCopy\Folder1\FileA3.txt<br />
C:\MyNSISDevelopment\Sections\SectionAAA\ToCopy\Folder2\FileA4.txt<br />
C:\MyNSISDevelopment\Sections\SectionAAA\ToCopy\Folder2\FileA5.txt<br />
C:\MyNSISDevelopment\Sections\SectionAAA\ToCopy\Folder2\FileA6.txt<br />
<br />
C:\MyNSISDevelopment\Sections\SectionBBB\ToCopy\Folder1\FileB1.txt<br />
C:\MyNSISDevelopment\Sections\SectionBBB\ToCopy\Folder1\FileB2.txt<br />
C:\MyNSISDevelopment\Sections\SectionBBB\ToCopy\Folder1\FileB3.txt<br />
C:\MyNSISDevelopment\Sections\SectionBBB\ToCopy\Folder2\FileB4.txt<br />
C:\MyNSISDevelopment\Sections\SectionBBB\ToCopy\Folder2\FileB5.txt<br />
C:\MyNSISDevelopment\Sections\SectionBBB\ToCopy\Folder2\FileB6.txt<br />
<br />
And my code would look like this:<br />
 Section &quot;SectionAAA&quot; Sec_AAA<br />
    SetOutPath &quot;$INSTDIR&quot;<br />
    File /r &quot;..\Sections\SectionAAA\ToCopy\*.*&quot;<br />
  SectionEnd<br />
 Section &quot;SectionBBB&quot; Sec_BBB<br />
    SetOutPath &quot;$INSTDIR&quot;<br />
    File /r &quot;..\Sections\SectionBBB\ToCopy\*.*&quot;<br />
  SectionEnd<br />
See how simple that makes the code?  It's all in how you organize your directory structure on the source machine.  I make the ToCopy folder because I might have other files relevant to that section that aren't necessarily copied in that way.  Everything under ToCopy is structured identically to what I want the structure to be under the destination $INSTDIR<br />
<br />
So for the above example the code would produce this on the destination machine, if $INSTDIR = C:\Program Files\MySoftware\:<br />
<br />
C:\Program Files\MySoftware\Folder1\FileA1.txt<br />
C:\Program Files\MySoftware\Folder1\FileA2.txt<br />
C:\Program Files\MySoftware\Folder1\FileA3.txt<br />
C:\Program Files\MySoftware\Folder2\FileA4.txt<br />
C:\Program Files\MySoftware\Folder2\FileA5.txt<br />
C:\Program Files\MySoftware\Folder2\FileA6.txt<br />
C:\Program Files\MySoftware\Folder1\FileB1.txt<br />
C:\Program Files\MySoftware\Folder1\FileB2.txt<br />
C:\Program Files\MySoftware\Folder1\FileB3.txt<br />
C:\Program Files\MySoftware\Folder2\FileB4.txt<br />
C:\Program Files\MySoftware\Folder2\FileB5.txt<br />
C:\Program Files\MySoftware\Folder2\FileB6.txt<br />
Can you define what you call a preinstaller, and also what a &quot;pointed installer&quot; is(an installer that's not pointless?)?  At first it sounded like you wanted all the files in the preinstaller, then it sounds like you don't. <br />
<br />
Here are a couple scripts that divide installer into multiple installers:<br />
http://nsis.sourceforge.net/Multi-volume_Distribution</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kzchris</div><div class="date">1st April 2008, 20:45</div></div><div class="posttext">Thank You for your exhaustive answer. I must admit that Iâ€™m not strong in English and I have some difficulties in expressing thoughts in that language. However your answer and example you recommended are almost exactly this that I was looking for.<br />
Thanks again.<br />
KZchris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">1st April 2008, 21:44</div></div><div class="posttext">No problem.  I've known English all my life, and I still have problems communicating what I mean sometimes.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>