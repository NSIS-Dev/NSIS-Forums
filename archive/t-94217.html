<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Closing Running Applications, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Closing Running Applications NSIS Discussion" />
	
	<title> Closing Running Applications [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Closing Running Applications</div>
<hr />
<div class="pda"><a href="t-94217.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=94217">Closing Running Applications</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">[FAIL]Pagannn</div><div class="date">11th July 2002, 22:35</div></div><div class="posttext">I have come up with a way to get rid of running applications during the install process. I know NSIS has the SendMessage function that you can use, but sometimes it doesn't work.<br />
<br />
I was trying to shut down Microsoft Outlook with the SendMessage function and it wouldn't close when minimized. I tried it on several machines and the dinosaur known as Windows NT won't allow SendMessage to close a minimized window. Windows 2000 and XP work just fine.<br />
<br />
I wrote a little command line app that takes the window class as a parameter and uses it to set the application window to &quot;normal&quot; mode and then close it.<br />
<br />
You can download it here:<br />
<br />
http://pagannn.clanfail.com/killapp/killapp.zip<br />
<br />
I also included a cool little utility that allows you to find the class of a window.<br />
<br />
Enjoy!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nocarr</div><div class="date">18th July 2002, 23:14</div></div><div class="posttext">Originally posted by [FAIL]Pagannn <br />
I have come up with a way to get rid of running applications during the install process. I know NSIS has the SendMessage function that you can use, but sometimes it doesn't work.<br />
................<br />
<br />
<br />
You are delphi programmer, right? :D <br />
Why not try this, it produces 14k code, instead of 20k.<br />
<br />
program stopper;<br />
<br />
uses<br />
  windows;<br />
<br />
Var hwnd: Integer;<br />
begin<br />
        hwnd := FindWindow(pchar(paramstr(1)),Nil);<br />
        If Hwnd &lt;&gt; 0 Then PostMessage(hwnd, 18, 0, 0);<br />
end.<br />
<br />
And then in the .nsi file use the Class of the program to close as parameter instead of it's handle.<br />
<br />
P.S. UPXed, the size is 8,5k (8704b)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">[FAIL]Pagannn</div><div class="date">22nd July 2002, 16:59</div></div><div class="posttext">First off, I haven't touched Delphi in many years. While I agree that it is superior to the MS bastardization of C++, the market in my area just isn't there.<br />
<br />
The code you put up works well, but I don't see that it restores the window to SW_NORMAL before sending the WM_CLOSE message. Because of my time away from Delphi, I might not be remembering the &quot;SendMessage&quot; wrapper paramters.<br />
<br />
I could get the exe file smaller if I remove this as well as the command line response strings.<br />
<br />
But thanks for the response! I'll look for other ways to get the exe file downsized.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Repzilon</div><div class="date">25th July 2002, 14:16</div></div><div class="posttext">You can also modify CloseWinamp Function and get a lower overhead.<br />
<br />
;------------------------------------------------------------------------------<br />
; CloseWinamp<br />
; <br />
; Closes all running instances of Winamp 1.x/2.x<br />
;<br />
; modifies no other variables<br />
Function CloseWinamp<br />
  Push $0<br />
  loop:<br />
    FindWindow $0 &quot;Winamp v1.x&quot;<br />
    IntCmp $0 0 done<br />
     SendMessage $0 16 0 0<br />
     Sleep 100<br />
     Goto loop<br />
  done:<br />
  Pop $0<br />
FunctionEnd<br />
<br />
What is the class name of Outlook ? Anybody with Spy++ and Outlook (I don't use the latter, so I did not install it) is welcome to tell us.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">[FAIL]Pagannn</div><div class="date">25th July 2002, 16:53</div></div><div class="posttext">The class name of the Outlook window is 'rctrl_renwnd32'.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>