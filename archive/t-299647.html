<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" semi-silent installer and InstFiles, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  semi-silent installer and InstFiles NSIS Discussion" />
	
	<title> semi-silent installer and InstFiles [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  semi-silent installer and InstFiles</div>
<hr />
<div class="pda"><a href="t-299647.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=299647">semi-silent installer and InstFiles</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">7th November 2008, 10:51</div></div><div class="posttext">I'm currently making an installer semi-silent by allowing for unattended installation using a sort of 'preferences file'.<br />
<br />
When a preference is invalid or missing, I still want the user interface to show up - which seems to exclude a silent installer as I can't switch silent mode anywhere outside of .onInit.<br />
<br />
So instead for any page where I do have a valid 'preference', I simply call Abort in the Pre function so that the page never shows, and set any variables/etc. to the appropriate values based on the preference which might otherwise be handled in any Post function.<br />
<br />
This all works quite lovely, but then in comes the special InstFiles page.  Calling Abort in its Pre or Show (does it even have one - using MUI?) functions does absolutely bupkis.<br />
I can stick HideWindow in the pre function, or in the first section, but that will still flash InstFiles onto the screen for a fraction of a second.<br />
<br />
Now personally I don't mind the InstFiles page popping up - any unattended install isn't going to care about a dialog, as long as the application finishes and exits okay, and personally I like having -some- visual confirmation of things happening even with a silent installation.  But for the user expecting a completely invisible installation, I'd still like to be able to hide it completely without any UI flash.<br />
<br />
So... can it be done at all, or am I SOL and just need to deal with the flash?  If it -can- be done... how?<br />
<br />
Most of the threads deal with the opposite.. a silent installer that users -do- still want to show the InstFiles page for.. go figure :)<br />
<br />
Thanks in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th November 2008, 22:58</div></div><div class="posttext">You should use silent installer and set it in .onInit if silent installers is what you want. Simply make sure everything you need is present in the preferences file before you set the silent mode.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">8th November 2008, 06:38</div></div><div class="posttext">yeah, that's the thing - I don't want a silent installer, but I think what you're saying is.. (pseudocode)<br />
<br />
<br />
If (not using a preferences file) then (<br />
  proceed with installation as a full UI installer<br />
)<br />
else (<br />
  if (all preference values are found and valid) then (<br />
    set installation type silent, which hides instFiles<br />
  )<br />
  else (<br />
    proceed with semi-silent installer (some pages may display), instFiles shows up as well as a result<br />
  )<br />
)<br />
<br />
<br />
Which is a good idea and I'll have to see how easy that is to implement - duplicating and/or moving code out of pages and to .onInit - thanks :)<br />
<br />
I take it that the &quot;don't show instFiles in a non-silent installer&quot; is one of the things that can't be done, though? :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th November 2008, 10:24</div></div><div class="posttext">You don't have to move the code to .onInit, it can stay in the sections. Only silent installers execute sections code outside of the instfiles page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">8th November 2008, 18:21</div></div><div class="posttext">That'd be fine if all code was within sections - but a lot of it is in pre/post functions for other / custom pages.. those don't seem to get called if the installer is in silent mode.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>