<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" (Advanced?) Registry settings., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  (Advanced?) Registry settings. NSIS Discussion" />
	
	<title> (Advanced?) Registry settings. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  (Advanced?) Registry settings.</div>
<hr />
<div class="pda"><a href="t-221366.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221366">(Advanced?) Registry settings.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">AlexanderG</div><div class="date">13th July 2005, 16:50</div></div><div class="posttext">(This is a bit lengthy to explain, but please bear with me.)<br />
I have a java application that is wrapped in janel (http://sourceforge.net/projects/janel) to create an executable for ease of use. I have an associated file type that I write to the registry.<br />
The executable works perfectly via clicking on it or using a shortcut.<br />
It doesn't work if you launch it from another directory (i.e. use the command prompt to go D:\&gt; &quot;D:\Stuff\MyProgram.exe&quot;).<br />
This is because it's home directory contains property files that it must have to work correctly.<br />
This causes problems for the associated file type, in that if it is not in the install directory it simply doesn't work.<br />
The program will run if a shortcut is used (i.e. you pass the project file to a shortcut instead of the EXE). I have tried to set the registry to use the *.lnk instead of the EXE but that throws an error (&quot;ASW.prjct is not a valid Win32 application)<br />
It will also work if the program is already running (i.e. the program is running and you click on a project file, this will load it in the program)<br />
<br />
So these are my questions:<br />
<br />
Is it possible to set the registry to move to the required directory and then launch the EXE?<br />
<br />
Is it possible to set the registry to launch the program and then send the file to the program?<br />
<br />
Is it possible to make the registry work with a link?<br />
<br />
Thanks for any and all help you can provide.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th July 2005, 17:33</div></div><div class="posttext">Windows allows you to set a file extension to run a batch file.<br />
This batch file example works for notepad which I set up for a &quot;ttb&quot; file extension (just to test it):<br />
<br />
C:<br />
notepad %1<br />
exit<br />
<br />
This should set the working dir to C:<br />
For the registry entry, it's &quot;path\to\file.bat&quot; %1<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">14th July 2005, 04:41</div></div><div class="posttext">why not create a application using nsis that acts as a launcher app that sets the current dir and then launces your app<br />
<br />
you can also use:<br />
cmd /c &quot;start /Dc:\path\to\my\ c:\path\to\my\app.exe&quot;<br />
in the registry, not sure if this works on Win9x, on those platforms you can use start directly since its a exe (you dont need cmd /c) but im not sure if it supports setting the current dir</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AlexanderG</div><div class="date">14th July 2005, 11:10</div></div><div class="posttext">Originally posted by Afrow UK <br />
&lt;snip&gt;<br />
<br />
-Stu  <br />
Unfortunately I need it to run without a command window.<br />
<br />
Originally posted by Anders <br />
why not create a application using nsis that acts as a launcher app that sets the current dir and then launces your app <br />
That is just beyond my abilities. And I need to get this done in the next few days. Unless there is some sort of tutorial? <br />
EDIT: Actually, now that I think about it, that would be great. Where could I find out more? (Being honest, I didn't know that NSIS could be used for anything besides installers.)<br />
<br />
Originally posted by Anders <br />
you can also use:<br />
cmd /c &quot;start /Dc:\path\to\my\ c:\path\to\my\app.exe&quot;<br />
in the registry, not sure if this works on Win9x, on those platforms you can use start directly since its a exe (you dont need cmd /c) but im not sure if it supports setting the current dir [/B] <br />
It needs to work on Windows and that didn't seem to work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th July 2005, 17:50</div></div><div class="posttext">Extremely simple to do.<br />
<br />
Name &quot;ExecShell&quot;<br />
OutFile execshell.exe<br />
<br />
Function .onInit<br />
<br />
 Call GetParameters<br />
 Pop $R0<br />
<br />
  SetOutPath &quot;$EXEDIR&quot;<br />
  Exec '&quot;$EXEDIR\program.exe&quot; &quot;$R0&quot;'<br />
<br />
  Abort<br />
<br />
FunctionEnd<br />
<br />
Function GetParameters<br />
# this function is in manual!<br />
FunctionEnd<br />
<br />
Section<br />
SectionEnd<br />
<br />
Minimal script.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AlexanderG</div><div class="date">15th July 2005, 12:17</div></div><div class="posttext">That's great, thank you all for your help.<br />
Could I set it to compile that script at the time of installation? Or must it be compiled beforehand?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th July 2005, 12:29</div></div><div class="posttext">Needs to be compiled before hand obviously, otherwise you'd need to include makensis.exe with your installer and run it with a banner explaining what is happening.<br />
Compile the script and put the exe in as part of your software.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AlexanderG</div><div class="date">15th July 2005, 12:45</div></div><div class="posttext">Sorry, I forgot that $EXEDIR would get the current directory and couldn't figure out how it was going to get the installation directory.:o <br />
Thanks again.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>