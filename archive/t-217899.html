<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" nsisXML: XML reader for Nsis, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  nsisXML: XML reader for Nsis NSIS Discussion" />
	
	<title> nsisXML: XML reader for Nsis [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  nsisXML: XML reader for Nsis</div>
<hr />
<div class="pda"><a href="t-217899.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=217899">nsisXML: XML reader for Nsis</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">3rd June 2005, 16:49</div></div><div class="posttext">Ok!<br />
<br />
Once again, from scratch, a plugin to read(for the moment) some XML elements attributes and text.<br />
<br />
See example.<br />
<br />
Note: is a debug state but stable...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">3rd June 2005, 17:53</div></div><div class="posttext">:up:<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">29th June 2005, 14:28</div></div><div class="posttext">A couple of suggestions:<br />
a) Include the source code, so that the rest of us can help.<br />
b) Add support for XPath.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">29th June 2005, 21:05</div></div><div class="posttext">it does not work.<br />
refuses to find the file i want him to read.<br />
the following code gives me a &quot;system cant find the file&quot; error:<br />
<br />
<br />
 IfFileExists &quot;$OUTDIR\Mods\$R0\mod.desc&quot; +2<br />
 Abort<br />
 nsisXml::Tidy &quot;$OUTDIR\Mods\$R0\mod.desc&quot;<br />
<br />
this code even crashes the program:<br />
<br />
 IfFileExists &quot;$OUTDIR\Mods\$R0\mod.desc&quot; +2<br />
 Abort<br />
 nsisXml::GetElementText &quot;$OUTDIR\Mods\$R0\mod.desc&quot; &quot;title&quot;<br />
<br />
and i'm 1000% sure, the file exists.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">30th June 2005, 13:51</div></div><div class="posttext">@iceman_k: I'll make some improvements..later...now, for the XPath..don't kow yet..<br />
<br />
@Comm@nder21: I'm using firts version of msxml... maybe try using .xml &amp; fix the path, there's a reason for system cant find the file</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">30th June 2005, 13:54</div></div><div class="posttext">the path IS fixed, i also tried with .xml ending ...<br />
this plugin does not work.<br />
<br />
the older xml plugin from lobo lunar (they told me that youre the same :)) works fine for me, though its 44k ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">30th June 2005, 14:12</div></div><div class="posttext">(out of topic) Comm@nder21, your links in your signature are pointing to wrong wiki pages.<br />
<br />
I'm using firts version of msxml...<br />
So that means, you're using the first version launched of the parser instead of the newest? Or maybe I'm overlooking this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">30th June 2005, 19:19</div></div><div class="posttext">Well... I'm making adjustmens... I'll check that part.<br />
@deguix: Is the installed version 1.0, which comes with IE 4, using new stuff, requires that the end-user must have the newest msxml version.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">1st July 2005, 17:14</div></div><div class="posttext">Originally posted by iceman_k <br />
A couple of suggestions:<br />
b) Add support for XPath. <br />
<br />
Ok :)<br />
<br />
Seems that XPath will be teh* way :D<br />
Working on it :winamp:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">2nd July 2005, 03:50</div></div><div class="posttext">Let's give another chance ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">3rd July 2005, 11:25</div></div><div class="posttext">thx, deguix, ill fix them asap.<br />
but plz, send me a pm in such things instead of posting anywhere in the forums :D<br />
<br />
joel, i'll try your new version asap.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">16th July 2005, 14:25</div></div><div class="posttext">plugin is shit.<br />
<br />
why?<br />
1. unicode seems not to be supported. i get lots of errors with characters like -äöü/ in this format:<br />
<br />
&lt;title&gt;ti-tle&lt;/title&gt;<br />
<br />
using code from the examples (text())<br />
<br />
2. though you say, &quot;use xpath syntax&quot;, no xpath functions are supported.<br />
text() is no xpath function, but e.g. normalize-space() is.<br />
(according to the page linked to in readme)<br />
gives me just errors ...<br />
<br />
<br />
well, if you manage to fix this two major issues, the plugin is quite usable.<br />
<br />
what i just hate, is the requirement of the msxml4 parser, that weights over 700k!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">16th July 2005, 17:58</div></div><div class="posttext">Comm@nder21:<br />
<br />
I can't make a plugin that is &quot;usable&quot; just for you. The unicode is not my fault. I got feedback from another users and they say that the plugin works great, even on Win98. There are another ways to parse an xml... I'm just making an average plugin for a common and easy xml file (including for non-programmers users). I don't see why not to update to msxml4... you update your windows, right?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">16th July 2005, 18:00</div></div><div class="posttext">i do.<br />
but it has to be installed manually even on my winxp sp2 (it's not provided with windows update).<br />
and this is the problem:<br />
anyone that wants to use the program has to install this 700k package first ...<br />
<br />
i'm sry, i didn't want to sound that rude, but i can't get it working really :)<br />
<br />
of course, the parser is great, but i can't make it using any of the w3c conform functions.<br />
just your (non-w3c) text functio works...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">16th July 2005, 18:05</div></div><div class="posttext">but i can't make it using any of the w3c conform functions.<br />
just your (non-w3c) text functio works...<br />
<br />
ah... that's a whole another history ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">16th July 2005, 18:09</div></div><div class="posttext">Basically you can either choose between using a very basic non-validating XML parser (which will fit into a few kilobytes) or a full-featured W3C complient parser (like MSXML) with support for namespaces, schemas and additional technologies.<br />
<br />
Maybe it would be a good idea to create a NSIS plug-in for both situations.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">24th September 2005, 00:40</div></div><div class="posttext">what about:<br />
http://nsis.sourceforge.net/wiki/XML_manipulation_(based_on_MSXML)<br />
?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">25th September 2005, 18:54</div></div><div class="posttext">(There is currently no text in this page)<br />
<br />
<br />
:rolleyes:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th September 2005, 19:44</div></div><div class="posttext">http://nsis.sourceforge.net/wiki/XML_manipulation_(based_on_MSXML)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">25th September 2005, 19:44</div></div><div class="posttext">sorry, the forum did not recognize the URL correctly<br />
here it is:<br />
http://nsis.sourceforge.net/wiki/XML_manipulation_(based_on_MSXML)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">27th September 2005, 21:38</div></div><div class="posttext">Ok...<br />
<br />
I'm working in this re-build version of nsisXML.<br />
Test the example and tell me if you got errors...<br />
<br />
Note: it suppose to work with OS that have msxml2 parser... so Win98 might have it pre-installed...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">28th September 2005, 20:12</div></div><div class="posttext">Another big update:<br />
<br />
nsisXML plugin to create and parse XML files using MSXML 2.6 (hope Win98 and better have it)<br />
<br />
Instructions:<br />
- Copy nsisXML.dll to Plugins and nsisXML.nsh to include directories<br />
- Read this readme and example files.<br />
<br />
Functions:<br />
<br />
==[Build]==<br />
Displays the build version of the plugin.<br />
<br />
Example:<br />
${nsisXML-&gt;Build} ${VAR_RET}<br />
<br />
==[xPath]==<br />
Uses xPath syntax to parse and get strings from elements or attributes values.<br />
<br />
Example:<br />
${nsisXML-&gt;xPath} &quot;PATH_OF_XML_FILE&quot; &quot;XPATH_INSTRUCTION&quot; ${VAR_RET}<br />
<br />
==[Create]==<br />
Creates, in memory, the template of the xml file.<br />
<br />
Example:<br />
${nsisXML-&gt;Create}<br />
<br />
==[CreateElement]==<br />
Let's you create a xml element, from the parent document or from another node.<br />
<br />
Example:<br />
${nsisXML::CreateElement} &quot;XPATH_INSTRUCTION&quot; &quot;STRING_ELEMENT&quot;<br />
<br />
Note:<br />
use &quot;XPATH_INSTRUCTION&quot; to locate a node where to put the new element; empty param means <br />
the element will be as the first child.<br />
<br />
==[CreateComment]]==<br />
Well...creates a comment after an element.<br />
<br />
Example:<br />
${nsisXML-&gt;CreateComment} &quot;XPATH_INSTRUCTION&quot; &quot;STRING_COMMENT&quot;<br />
<br />
==[SetElementAttr]==<br />
Adds an attribute and its value to an element.<br />
<br />
Example:<br />
${nsisXML::SetElementAttr} &quot;XPATH_INSTRUCTION&quot; &quot;Attribute&quot; &quot;Value&quot;<br />
<br />
==[SetElementText]==<br />
Sets the text for an element.<br />
<br />
Example:<br />
${nsisXML-&gt;SetElementText} &quot;XPATH_INSTRUCTION&quot; &quot;STRING_TEXT&quot;<br />
<br />
==[Display]==<br />
Shows in a MessageBox How's your xml tree going.<br />
<br />
Example:<br />
${nsisXML-&gt;Display}<br />
<br />
==[Release]==<br />
Frees the memory from the xml template and save the xml into a file.<br />
<br />
Example:<br />
${nsisXML-&gt;Release} &quot;$EXEDIR\myxml.xml&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">29th September 2005, 21:42</div></div><div class="posttext">Another changes and bug fixes... see the readme and the examples...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jamyn</div><div class="date">30th September 2005, 02:37</div></div><div class="posttext">In your attached archive: nsixml.nsh should be named nsisxml.nsh<br />
<br />
Also, trying to compile example 1 (included with the package) fails with:<br />
<br />
<br />
File: &quot;nsisXML.dll&quot;-&gt;&quot;$PLUGINSDIR\nsisXML.dll&quot; [compress] 23575/65536 bytes<br />
Plugin Command: Build 0<br />
DetailPrint: &quot;Build version: $0&quot;<br />
Invalid command: ${nsisXML-&gt;xPath}<br />
Error in script &quot;C:\Documents and Settings\Administrator\Desktop\stripped\exampe-1.nsi&quot; on line 17 -- aborting creation process<br />
<br />
<br />
Full log attached.  Still, I like the idea. Thank you for writing this!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">30th September 2005, 20:45</div></div><div class="posttext">In your attached archive: nsixml.nsh should be named nsisxml.nsh<br />
<br />
That type was fix and is going to publish in the next, and final prerelease :D<br />
<br />
Also, trying to compile example 1 (included with the package) fails with:<br />
<br />
Ok...I read you error log....and seems that you missed to include in the same folder one of the xml's.<br />
In a few moments I'm going to post the final prerelease... :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">30th September 2005, 21:46</div></div><div class="posttext">Final preRelease... see the help file and the examples<br />
Almost there!<br />
<br />
Any suggestions are welcome :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">3rd October 2005, 18:54</div></div><div class="posttext">Well... plugin uploaded into my site :)<br />
<br />
Thanks for the people who test it :up:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">16th October 2005, 01:20</div></div><div class="posttext">Ok.. the plugin is updated, the only new thing that the CreateElement function can tidy-up... :D<br />
<br />
TODO:<br />
1.- Tidy on LoadXML<br />
2.- Remove Attribute param.<br />
<br />
:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">16th October 2005, 14:12</div></div><div class="posttext">great work man, thanx :)<br />
<br />
attached a repack for easier installing to nsis.<br />
<br />
i also added some code to the include file for a future feature:<br />
multiple sessions.<br />
<br />
you'll get the idea by reading the new .nsh file :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">17th October 2005, 00:37</div></div><div class="posttext">:D :up:<br />
<br />
Nice one ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">17th October 2005, 02:16</div></div><div class="posttext">More updates: includes function to remove attributes, a tidy function for xml files and a few debug functions that help you test your xpath syntaxes without saving the file :)<br />
<br />
TODO:<br />
1.- Tidy a inputed XML string (the last one) :p<br />
<br />
@Commander: if you want to modify nsisxml.nsh send me the updated one by PM, thanks :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gbanfill</div><div class="date">7th December 2005, 11:43</div></div><div class="posttext">Hi all,<br />
<br />
I'm using ${nsisXML-&gt;SetElementText} to set a change a config file and set a connection string. However I get an &quot;Runtime  Error! abnormal program Termination&quot; popup window and the instrcution is not executed.<br />
<br />
The character string I am trying to set is greater than 64 characters long. If I try with a different (shorter) string, it works correctly.<br />
<br />
Does anyone know anything about a character limit on the SetElementText method? <br />
<br />
If it helps the simpleiset form of <br />
<br />
<br />
Name &quot;installer&quot;<br />
<br />
OutFile &quot;C:\installer.exe&quot;<br />
<br />
!include &quot;nsisXML.nsh&quot;<br />
<br />
<br />
Section &quot;Installer&quot;<br />
<br />
   ${nsisXML-&gt;OpenXML} &quot;C:\test.xml&quot;<br />
<br />
   ; If there are 63 x's the program will run, if there are 65 then an error will occur.<br />
<br />
   ${nsisXML-&gt;SetElementText} &quot;/a&quot;    &quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;<br />
<br />
   ${nsisXML-&gt;Release} &quot;C:\test.xml&quot;<br />
	 <br />
SectionEnd<br />
 <br />
<br />
<br />
Thanks in advance for any help you can give.<br />
George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">7th December 2005, 17:43</div></div><div class="posttext">Please post both script &amp; xml file to give it a look :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gbanfill</div><div class="date">8th December 2005, 09:25</div></div><div class="posttext">HI Joel,<br />
<br />
Here is a cut down version of what I am trying to do. Ziped up so there arent so many files to worry about.<br />
<br />
Include &amp; plugins contain the dll of nsisXML that I have been using. This is more for your reference than anything else.<br />
<br />
Example.xml is the xml file I am trying to use. I am using this as the example as this file can't change in stucture or namespace (which has added other problems!).<br />
<br />
Installer.exe is the installer as build on my machine. <br />
<br />
Any more information you want let me know.<br />
<br />
Cheers :)  <br />
<br />
George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">8th December 2005, 19:24</div></div><div class="posttext">I'll look it..this weekend, maybe the begin of the next one, I'll post an updated version dll one.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">25th February 2009, 01:01</div></div><div class="posttext">I have a single Processed element, containing multiple Form elements, each with a single Path element.<br />
<br />
I want to set all of the Path elements(across all the form elements) to the same value:<br />
${nsisXML-&gt;SetElementText} &quot;/Processed[0]/Form/Path[0]&quot; &quot;dsfgsdgsd&quot;<br />
<br />
However, this is only setting the Path element under the first form.  Is there a way to iterate?  Maybe using an iterator in the string?  If that, then how would I know that I've gone past the last Form element?  Would an error code be set that I can check each iteration of my loop, or can I use one of the other functions to test for the existance of the element before I try to set it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">25th February 2009, 01:13</div></div><div class="posttext">Oh... anyone have a workaround for the issue with long text for SetElementText?  :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ripper17</div><div class="date">5th April 2011, 16:46</div></div><div class="posttext">I know this thread has been dead quite some time, however I found the plug-in very useful - except for one thing: I was trying to set an ElementText with more than 64 characters, which failed.<br />
So I downloaded the sources (thanks Joel for providing them) and did the quick change to now support 1024 characters. I've also created a simple project for Visual Studio 2008 to build this plug-in. <br />
<br />
NOTE: I have not tested this code AT ALL! It does what I need and I haven't really changed much else. So most likely, no issues have been added by my change, but I don't know if this plug-in had any issues before that. Use at your own risk.<br />
<br />
NOTE2: I don't know if I am allowed to upload msxml5.dll (the version I used to compile) - so I did not. If you need to compile the nsisXML.dll for yourself, you will have to find it or any other version &gt; 2 and put it in the same folder as &quot;main.cpp&quot; and adapt the line &quot;#import &quot;msxml5.dll&quot; &quot; to the correct version number.<br />
<br />
The ZIP file contains the sources, the project and the newly build nsisXML.dll (copy to your NSIS\plugins dir) and the (unchanged) nsisxml.nsh (copy to your NSIS\include dir)<br />
<br />
Best<br />
<br />
Martin<br />
<br />
Please note that the attached plug-in depends on VS 2008 runtimes, msvcr90.dll may not be present on the customer comp (or you should handle the situation and install VS runtimes). Original plug-in from Joel created in VS 6 and depends on mcvcrt.dll, but this is acceptable. - Takhir</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">7th May 2011, 07:11</div></div><div class="posttext">ripper17 (and release users - 20 downloads) - please note that plug-in depends on VS 2008 runtimes, msvcr90.dll may not present on the customer comp (or you should handle the situation and install VS runtimes). Original plug-in from Joel created in VS 6 and depends on mcvcrt.dll, but this is acceptable.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th May 2011, 10:44</div></div><div class="posttext">Added to post.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">9th May 2011, 23:25</div></div><div class="posttext">if I may suggest...<br />
<br />
You can use this &quot;other&quot; nsisXML plug-in (http://wiz0u.free.fr/prog/nsisXML/)<br />
which is compiled under VC6 for ANSI &amp; Unicode NSIS and shouldn't have problem with long ElementText<br />
<br />
It does however requires MSXML which is installed on every windows since Win98/IE4</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angel89</div><div class="date">30th June 2011, 23:35</div></div><div class="posttext">Hello<br />
I have an XML FIle wish contain a directory.Now I want to Use Nsis.But i don't know how can i pars the value of the attribute wish contain the directory from the XML File.<br />
Also nsis should check if this directory exist.if not should Print a message, Like : &quot;Le Dossier n'existe pas &quot; ,Else,It terminate the execution of the rest of program<br />
This is  my XML FIle:<br />
&lt; v1&gt;<br />
&lt;v2&gt;<br />
&lt;v3 chemin= &quot;c:\Dossier&quot; taille=100&gt;<br />
&lt;\v3&gt;<br />
&lt;\v2&gt;<br />
&lt;\v1&gt;<br />
<br />
in nsis,i want to get the value of Chemin.<br />
Please,Can you write me what should i write in the nsi??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">1st July 2011, 08:23</div></div><div class="posttext">You already asked this question in your own thread. Please do not ask the same question twice.  http://forums.winamp.com/showthread.php?t=332038</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>