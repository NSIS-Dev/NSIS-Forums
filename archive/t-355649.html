<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Command Line Usage Problems, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Command Line Usage Problems NSIS Discussion" />
	
	<title> Command Line Usage Problems [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Command Line Usage Problems</div>
<hr />
<div class="pda"><a href="t-355649.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=355649">Command Line Usage Problems</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Webmaster2015</div><div class="date">8th February 2013, 13:35</div></div><div class="posttext">Hello. I am new to this forum. Anyway, I am a modder of GTA: Vice City and I was trying to integrate IMG editing into my NSIS installer. I am using a command line IMG editing tool to do so. However, when I run my installer, it skips the extraction of the IMG tool. Can someone tell me what to do to fix this?<br />
<br />
Here is the nsi<br />
<br />
http://www.mediafire.com/?ndrh9a5mpk866au<br />
<br />
Thanks in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">9th February 2013, 16:09</div></div><div class="posttext">The FILE command you used specifies a relative path to get/compress the executable. Are you sure that the path is correct relative to the nsi script? <br />
<br />
The compiler should detect an error if the file isn't found, but absolute paths might be more reliable. Check the compiler output listing to be sure it found the file (you'll see the size before and after it was compressed when the FILE command is processed).<br />
<br />
You can also use 7zip to look at the installer executable. If the fastman92ImgConsole.exe was found you'll see it under the $TEMP folder inside the archive. If it is present but does not get extracted, it might be a permissions issue. Try adding RequestExecutionLevel (http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.32) HIGHEST to your script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">9th February 2013, 19:50</div></div><div class="posttext">I agree with demiller9. It sounds like you were trying to do this:<br />
  File &quot;C:\Downloads\Programs\GTAVC\fastman92_IMG_Console_1_7\go here for program\fastman92ImgConsole.exe&quot;<br />
instead of this:<br />
  File &quot;Downloads\Programs\GTAVC\fastman92_IMG_Console_1_7\go here for program\fastman92ImgConsole.exe&quot;<br />
<br />
(Note that it's probably better to use $PLUGINSDIR, instead of $TEMP.)<br />
<br />
You should also include requestexecutionlevel admin, and verify adminlevel access using the UserInfo plugin in .onInit. Because you're trying to write to programfiles and HKLM.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Webmaster2015</div><div class="date">11th February 2013, 14:52</div></div><div class="posttext">Thanks! I'll try permissions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Webmaster2015</div><div class="date">12th February 2013, 14:58</div></div><div class="posttext">I updated nsi with a script piece from here:<br />
<br />
http://forums.winamp.com/showthread.php?t=310377<br />
<br />
Above mediafire link no longer works!!!<br />
<br />
I also changed fastman92 to ImgEdCmd.<br />
<br />
Hopefully it will work.<br />
<br />
<br />
!define PRODUCT_NAME &quot;Test&quot;<br />
!define PRODUCT_VERSION &quot;1.0&quot;<br />
!define PRODUCT_DIR_REGKEY &quot;Software\Microsoft\Windows\CurrentVersion\App Paths\IMGEdCmd.exe&quot;<br />
<br />
!define XPUI_SYSDIR &quot;C:\Program Files (x86)\NSIS\ExperienceUI\Contrib\ExperienceUI&quot;<br />
!include &quot;${XPUI_SYSDIR}\XPUI.nsh&quot;<br />
<br />
RequestExecutionLevel Highest<br />
<br />
; MUI 1.67 compatible ------<br />
;!include &quot;MUI.nsh&quot;<br />
<br />
; MUI Settings<br />
!define MUI_ABORTWARNING<br />
!define MUI_ICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico&quot;<br />
<br />
; Welcome page<br />
!insertmacro MUI_PAGE_WELCOME<br />
; Directory page<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
; Instfiles page<br />
!insertmacro MUI_PAGE_INSTFILES<br />
; Finish page<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
; Language files<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
; MUI end ------<br />
<br />
Name &quot;${PRODUCT_NAME} ${PRODUCT_VERSION}&quot;<br />
OutFile &quot;IMG 1.exe&quot;<br />
InstallDir &quot;$PROGRAMFILES\Rockstar Games\Grand Theft Auto Vice City&quot;<br />
InstallDirRegKey HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot;<br />
ShowInstDetails show<br />
<br />
<br />
Section &quot;MainSection&quot; SEC01<br />
<br />
SetOutPath &quot;$INSTDIR\addtogta3img&quot;<br />
  SetOverwrite on<br />
  File &quot;C:\Users\Ryan\Documents\GTAVC\ImgEdCmd\ImgEdCmd.exe&quot;<br />
  File &quot;C:\Users\Ryan\Documents\GTAVC\sparrow.txd&quot;<br />
<br />
; Unset all file-attributes (like Read-Only) and check if gta3.img and gta3.dir exist<br />
  SetOutPath &quot;$INSTDIR\models&quot;<br />
<br />
/*<br />
<br />
  IfFileExists &quot;$INSTDIR\models\gta3.img&quot; errModelInstall startModelInstallImg<br />
<br />
  Goto errModelInstall<br />
<br />
  startModelInstallImg:<br />
<br />
  IfFileExists &quot;$INSTDIR\models\gta3.dir&quot; errModelInstall startModelInstallDir<br />
<br />
  Goto errModelInstall<br />
<br />
  startModelInstallDir:<br />
<br />
*/<br />
<br />
  SetFileAttributes &quot;$INSTDIR\models\gta3.img&quot; FILE_ATTRIBUTE_NORMAL<br />
<br />
  SetFileAttributes &quot;$INSTDIR\models\gta3.dir&quot; FILE_ATTRIBUTE_NORMAL<br />
<br />
  ; Add models to gta3.img<br />
  <br />
  nsExec::Exec '&quot;$INSTDIR\addtogta3img\ImgEdCmd.exe&quot; &quot;$INSTDIR\models\gta3.img&quot; /a &quot;$INSTDIR\addtogta3img\sparrow.dff&quot;'<br />
<br />
SectionEnd<br />
<br />
<br />
<br />
Section -Post<br />
WriteRegStr HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot; &quot;&quot;$PROGRAMFILES\Rockstar Games\Grand Theft Auto Vice City&quot;&quot;<br />
Delete &quot;$INSTDIR\addtogta3img&quot;<br />
<br />
SectionEnd<br />
<br />
Later.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">12th February 2013, 16:09</div></div><div class="posttext">You should use requestexecutionlevel admin, and you also need to use the UserInfo plugin to make sure the installer actually *gets* admin access, for example in case UAC is turned off (or if using Windows older than Vista). <br />
<br />
Anders has made an excellent example script: http://pastebin.com/EvMkyLLt</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Webmaster2015</div><div class="date">12th February 2013, 17:16</div></div><div class="posttext">Thanks again!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>