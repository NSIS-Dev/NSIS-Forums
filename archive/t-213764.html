<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Please Help, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Please Help NSIS Discussion" />
	
	<title> Please Help [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Please Help</div>
<hr />
<div class="pda"><a href="t-213764.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=213764">Please Help</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Petkop</div><div class="date">21st April 2005, 11:17</div></div><div class="posttext">Dear All<br />
<br />
I'm new with NSIS. I have a small problem with Icons. I can NOT get any icon to my instalation. I try with all dfiferent icons size. Also if you see any other problem in my script please tell me! All my script is:<br />
<br />
<br />
; Define your application name<br />
!define APPNAME &quot;TouchFinL&quot;<br />
!define APPNAMEANDVERSION &quot;TouchFinL V4.23&quot;<br />
<br />
; Main Install settings<br />
Name &quot;${APPNAMEANDVERSION}&quot;<br />
InstallDir &quot;$PROGRAMFILES\TouchFinL&quot;<br />
InstallDirRegKey HKLM &quot;Software\${APPNAME}&quot; &quot;&quot;<br />
Icon &quot;C:\XXXInstall\tf.io&quot;<br />
OutFile &quot;C:\XXXInstall\Try\TouchFin.exe&quot;<br />
<br />
; Modern interface settings<br />
!include &quot;MUI.nsh&quot;<br />
<br />
!define MUI_ABORTWARNING<br />
!define MUI_FINISHPAGE_RUN &quot;$INSTDIR\TouchFinL.exe&quot;<br />
<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_LICENSE &quot;..\license.txt&quot;<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
!insertmacro MUI_UNPAGE_CONFIRM<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
; Set languages (first is default language)<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
!insertmacro MUI_RESERVEFILE_LANGDLL<br />
<br />
!include Library.nsh<br />
<br />
 Var ALREADY_INSTALLED<br />
<br />
<br />
Section &quot;-Install VB6 runtimes&quot;<br />
<br />
   ;Add code here that sets $ALREADY_INSTALLED to a non-zero value if the application is already installed. For example:<br />
<br />
   IfFileExists &quot;$INSTDIR\TouchFinL.exe&quot; 0 new_installation ;Replace MyApp.exe with your application filename<br />
     StrCpy $ALREADY_INSTALLED 1<br />
   new_installation:<br />
<br />
   !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED &quot;..\msvbvm60.dll&quot; &quot;$SYSDIR\msvbvm60.dll&quot; &quot;$SYSDIR&quot;<br />
   !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED    &quot;..\oleaut32.dll&quot; &quot;$SYSDIR\oleaut32.dll&quot; &quot;$SYSDIR&quot;<br />
   !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED    &quot;..\olepro32.dll&quot; &quot;$SYSDIR\olepro32.dll&quot; &quot;$SYSDIR&quot;<br />
   !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED    &quot;..\comcat.dll&quot;   &quot;$SYSDIR\comcat.dll&quot;   &quot;$SYSDIR&quot;<br />
   !insertmacro InstallLib DLL    $ALREADY_INSTALLED REBOOT_PROTECTED    &quot;..\asycfilt.dll&quot; &quot;$SYSDIR\asycfilt.dll&quot; &quot;$SYSDIR&quot;<br />
   !insertmacro InstallLib TLB    $ALREADY_INSTALLED REBOOT_PROTECTED    &quot;..\stdole2.tlb&quot;  &quot;$SYSDIR\stdole2.tlb&quot;  &quot;$SYSDIR&quot;<br />
	 <br />
	 !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED    &quot;..\MSBIND.DLL&quot;   &quot;$SYSDIR\MSBIND.DLL&quot;   &quot;$SYSDIR&quot;<br />
	 !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED    &quot;..\MSCOMCT2.OCX&quot; &quot;$SYSDIR\MSCOMCT2.OCX&quot; &quot;$SYSDIR&quot;<br />
	 !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED    &quot;..\MSCOMCTL.OCX&quot; &quot;$SYSDIR\MSCOMCTL.OCX&quot; &quot;$SYSDIR&quot;<br />
	 !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED    &quot;..\MSDATGRD.OCX&quot; &quot;$SYSDIR\MSDATGRD.OCX&quot; &quot;$SYSDIR&quot;<br />
	 !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED    &quot;..\msstdfmt.dll&quot; &quot;$SYSDIR\msstdfmt.dll&quot; &quot;$SYSDIR&quot;<br />
<br />
 SectionEnd<br />
<br />
 Section &quot;-un.Uninstall VB6 runtimes&quot;<br />
<br />
   !insertmacro UnInstallLib REGDLL SHARED NOREMOVE &quot;$SYSDIR\msvbvm60.dll&quot;<br />
   !insertmacro UnInstallLib REGDLL SHARED NOREMOVE &quot;$SYSDIR\oleaut32.dll&quot;<br />
   !insertmacro UnInstallLib REGDLL SHARED NOREMOVE &quot;$SYSDIR\olepro32.dll&quot;<br />
   !insertmacro UnInstallLib REGDLL SHARED NOREMOVE &quot;$SYSDIR\comcat32.dll&quot;<br />
   !insertmacro UnInstallLib DLL    SHARED NOREMOVE &quot;$SYSDIR\asycfilt.dll&quot;<br />
   !insertmacro UnInstallLib TLB    SHARED NOREMOVE &quot;$SYSDIR\stdole2.tlb&quot;<br />
<br />
 SectionEnd<br />
 <br />
 Section &quot;TouchFinL&quot; Section1<br />
<br />
	; Set Section properties<br />
	SetOverwrite on<br />
<br />
	; Set Section Files and Shortcuts<br />
	SetOutPath &quot;$INSTDIR\&quot;<br />
	File &quot;..\MyPrintTFL.dll&quot;			;Reg OK AppPath Folder<br />
	RegDLL $INSTDIR\MyPrintTFL.dll<br />
	File &quot;..\MDAC_TYP.EXE&quot;				;Reg NE AppPath Folder<br />
	File &quot;..\repHTML.tfz&quot;					;Reg NE AppPath Folder<br />
	File &quot;..\repPic.tfz&quot;					;Reg NE AppPath Folder<br />
	File &quot;..\TFDB.tfb&quot;						;Reg NE AppPath Folder<br />
	File &quot;..\TouchFinL.exe&quot;				;Reg NE AppPath Folder<br />
	File &quot;..\VB6STKIT.DLL&quot;				;Reg NE System Folder<br />
	File &quot;..\wininet.dll&quot;					;Reg NE AppPath Folder<br />
	<br />
	CreateShortCut &quot;$DESKTOP\TouchFinL.lnk&quot; &quot;$INSTDIR\TouchFinL.exe&quot;<br />
	CreateDirectory &quot;$SMPROGRAMS\TouchFinL&quot;<br />
	CreateShortCut &quot;$SMPROGRAMS\TouchFinL\TouchFinL.lnk&quot; &quot;$INSTDIR\TouchFinL.exe&quot;<br />
<br />
SectionEnd<br />
<br />
Section -FinishSection<br />
<br />
	WriteRegStr HKLM &quot;Software\${APPNAME}&quot; &quot;&quot; &quot;$INSTDIR&quot;<br />
	WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}&quot; &quot;DisplayName&quot; &quot;${APPNAME}&quot;<br />
	WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\uninstall.exe&quot;<br />
	WriteUninstaller &quot;$INSTDIR\uninstall.exe&quot;<br />
<br />
SectionEnd<br />
<br />
; Modern install component descriptions<br />
!insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />
!insertmacro MUI_DESCRIPTION_TEXT ${Section1} &quot;&quot;<br />
!insertmacro MUI_FUNCTION_DESCRIPTION_END<br />
<br />
;Uninstall section<br />
<br />
UninstallText &quot;This will uninstall TouchFin. Hit next to continue.&quot;<br />
;UninstallIcon &quot;C:\XXXInstall\Tf32.ico&quot;<br />
<br />
Section Uninstall<br />
	;Remove from registry...<br />
	DeleteRegKey HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}&quot;<br />
	DeleteRegKey HKLM &quot;SOFTWARE\${APPNAME}&quot;<br />
	; Delete self<br />
	Delete &quot;$INSTDIR\uninstall.exe&quot;<br />
	; Delete Shortcuts<br />
	Delete &quot;$DESKTOP\TouchFinL.lnk&quot;<br />
	Delete &quot;$SMPROGRAMS\TouchFinL\TouchFinL.lnk&quot;<br />
	Delete &quot;$SMPROGRAMS\TouchFinL\Uninstall.lnk&quot;<br />
	; Clean up TouchFinL<br />
	Delete &quot;$INSTDIR\MDAC_TYP.EXE&quot;<br />
	Delete &quot;$INSTDIR\MyPrintTFL.dll&quot;<br />
	Delete &quot;$INSTDIR\TFDB.tfb&quot;<br />
	Delete &quot;$INSTDIR\TouchFinL.exe&quot;<br />
	Delete &quot;$INSTDIR\wininet.dll&quot;<br />
	; Remove remaining directories<br />
	RMDir &quot;$SMPROGRAMS\TouchFinL&quot;<br />
	RMDir &quot;$INSTDIR\&quot;<br />
	<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">21st April 2005, 11:27</div></div><div class="posttext">Use !define MUI_ICON and !define MUI_UNICON to set icons for installer and uninstaller (instead Icon and UnInstallIcon).<br />
<br />
Add:<br />
Are you sure - extension of your installer icon is .io?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Petkop</div><div class="date">21st April 2005, 16:05</div></div><div class="posttext">Thank You. The extention is .ico.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>