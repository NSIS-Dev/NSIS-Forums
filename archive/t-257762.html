<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" string search question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  string search question NSIS Discussion" />
	
	<title> string search question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  string search question</div>
<hr />
<div class="pda"><a href="t-257762.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257762">string search question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">17th October 2006, 20:56</div></div><div class="posttext">I have a question on how to do this.  I am a n00b still so sorry for this sounding a little dumb.  <br />
<br />
I have a string, &quot;C:\Windows;C:\windows\system;c:\blarg;c:\foobar&quot;<br />
<br />
i want to do is check if c:\foobar is in the string.<br />
if it is go on.<br />
if it isnt, do something; then go on.<br />
<br />
thanks for any help..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">simulation</div><div class="date">17th October 2006, 23:02</div></div><div class="posttext">There is a handy function in the User Manual (Appendix C) called StrStr which can be used to find the first occurance of a string. See example<br />
<br />
<br />
Section &quot;&quot;<br />
<br />
 Push &quot;this is a string with foobar in it&quot;<br />
 Push &quot;foobar&quot;<br />
 Call StrStr<br />
 Pop $R0<br />
 <br />
 StrCpy $R0 $R0 6 ; truncate string to first 6 chrs<br />
 StrCmp &quot;foobar&quot; $R0 true false ;compare strings<br />
 <br />
 true:<br />
   DetailPrint &quot;foobar is present&quot;<br />
   Goto End<br />
 <br />
 false:<br />
   DetailPrint &quot;foobar is not present&quot;<br />
   Goto End<br />
<br />
End:<br />
SectionEnd<br />
<br />
<br />
; StrStr<br />
; input, top of stack = string to search for<br />
;        top of stack-1 = string to search in<br />
; output, top of stack (replaces with the portion of the string remaining)<br />
; modifies no other variables.<br />
;<br />
; Usage:<br />
;   Push &quot;this is a long ass string&quot;<br />
;   Push &quot;ass&quot;<br />
;   Call StrStr<br />
;   Pop $R0<br />
;  ($R0 at this point is &quot;ass string&quot;)<br />
<br />
Function StrStr<br />
  Exch $R1 ; st=haystack,old$R1, $R1=needle<br />
  Exch    ; st=old$R1,haystack<br />
  Exch $R2 ; st=old$R1,old$R2, $R2=haystack<br />
  Push $R3<br />
  Push $R4<br />
  Push $R5<br />
  StrLen $R3 $R1<br />
  StrCpy $R4 0<br />
  ; $R1=needle<br />
  ; $R2=haystack<br />
  ; $R3=len(needle)<br />
  ; $R4=cnt<br />
  ; $R5=tmp<br />
  loop99:<br />
    StrCpy $R5 $R2 $R3 $R4<br />
    StrCmp $R5 $R1 done99<br />
    StrCmp $R5 &quot;&quot; done99<br />
    IntOp $R4 $R4 + 1<br />
    Goto loop99<br />
  done99:<br />
  StrCpy $R1 $R2 &quot;&quot; $R4<br />
  Pop $R5<br />
  Pop $R4<br />
  Pop $R3<br />
  Pop $R2<br />
  Exch $R1<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">18th October 2006, 14:23</div></div><div class="posttext">okay i am still unsure.<br />
<br />
Push $R9<br />
  ReadRegStr $R9 HKLM \<br />
  &quot;SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot; Path<br />
<br />
if $R9 contains c:\mypath<br />
then go on<br />
if it doesnt contain it<br />
doMyFunction<br />
then go on<br />
<br />
thx  sorry i am really a noob here i still use HM NIS edit to autogenerate the code.  and now i got stuck on this here.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">18th October 2006, 16:41</div></div><div class="posttext">If the string doesn't have foobar in it the StrStr will return &quot;&quot;.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">18th October 2006, 17:54</div></div><div class="posttext">okay i get error with StrStr....<br />
<br />
this is what i got now<br />
<br />
  Push $R9<br />
  ReadRegStr $R9 HKLM \<br />
  &quot;SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot; Path<br />
  <br />
  ${StrStr} $0 $R9 &quot;foo&quot;<br />
  StrCmp $0 &quot;&quot; true false<br />
  <br />
  true:<br />
  ; do nothing go on<br />
  Goto End<br />
  <br />
  false:<br />
  Push &quot;PATH&quot;<br />
  Push &quot;%SystemRoot%\foo&quot;<br />
  Call AddToPath<br />
  Goto End<br />
<br />
  End:<br />
  File &quot;help.tgz&quot;<br />
  SetDetailsPrint textonly<br />
  DetailPrint &quot;Installing Help System...&quot;<br />
  SetDetailsPrint none<br />
...snip....<br />
SectionEnd<br />
<br />
<br />
error:<br />
<br />
Error in script &quot;C:\Documents and Settings\jweinraub\Desktop\Installers\636.26\636_26.nsi&quot; on line 27 -- aborting creation process<br />
<br />
<br />
line 27 of my installer: !include &quot;StrStr.nsh&quot;<br />
<br />
line 3 of strstr.nsh: !macro StrStr ResultVar String SubString<br />
<br />
thnx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">18th October 2006, 18:27</div></div><div class="posttext">i mean this but it still doesnt work, i use the AddToPath function found on the nsis.sf.net wiki.<br />
<br />
<br />
Push $R9<br />
  ReadRegStr $R9 HKLM \<br />
  &quot;SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot; Path<br />
  <br />
  Push $R9<br />
  Push &quot;foo&quot;<br />
  Call StrStr<br />
  Pop $R0<br />
  <br />
;  ${StrStr} $0 $R9 &quot;foo&quot;<br />
<br />
  StrCmp $R0 &quot;&quot; true false<br />
  <br />
  true:<br />
  ; doesn't have foo so add it<br />
  Push &quot;PATH&quot;<br />
  Push &quot;%SystemRoot%\foo&quot;<br />
  Call AddToPath<br />
  Goto End<br />
  <br />
  false:<br />
  ; do nothing go on<br />
  Goto End<br />
<br />
  End:<br />
  File &quot;help.tgz&quot;<br />
  SetDetailsPrint textonly<br />
...<br />
<br />
the adding isnt happening so i dunno if the addtopath function isnt working or my logic above isnt working.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>