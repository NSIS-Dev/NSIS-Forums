<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" AccessControl plugin, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  AccessControl plugin NSIS Discussion" />
	
	<title> AccessControl plugin [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  AccessControl plugin</div>
<hr />
<div class="pda"><a href="t-287718.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=287718">AccessControl plugin</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Daniel James</div><div class="date">28th February 2008, 13:42</div></div><div class="posttext">I'm trying to use the AccessControl plugin to set permissions on a shared data directory so that all users can read/write/modify the files it contains.<br />
<br />
The call I'm trying to make is:<br />
<br />
AccessControl::GrantOnFile &quot;$DataDir&quot; &quot;(BU)&quot; &quot;GenericRead + GenericWrite + DeleteChild&quot;<br />
<br />
<br />
This doesn't seem to be working ... have I got the syntax right? As it's more-or-less as copied from the page on the Wiki, I hope so! In particular, am I literally supposed to put &quot;(BU)&quot; as trustee for all built-in users or is that just a shorthand for &quot;BUILTIN\USERS&quot; in the example on the Wiki-page?<br />
<br />
I'm using the current version of AccessControl (downloaded yesterday) and I see from the Wiki that in recent versions &quot;Error messages are now just returned on NSIS stack&quot; ... so presumably every call to GrantOnFile must be followed by a pop instruction to get the error status -- what form is that status in? Is it a Win32 numeric error code, or what?<br />
<br />
It would be really nice to have some working example code (with error handling) on that Wiki page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th February 2008, 13:50</div></div><div class="posttext">The return value is a string telling you what parameter is wrong. You may find that (BU) is not a valid trustee (anything in curved brackets must be an SID). Use (S-1-5-32-545).<br />
<br />
http://support.microsoft.com/kb/243330<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Daniel James</div><div class="date">28th February 2008, 15:17</div></div><div class="posttext">Originally posted by Afrow UK <br />
The return value is a string telling you what parameter is wrong. <br />
And is an empty string if everything worked? Seems to be, yes.<br />
<br />
You may find that (BU) is not a valid trustee (anything in curved brackets must be an SID). Use (S-1-5-32-545).<br />
<br />
http://support.microsoft.com/kb/243330<br />
 <br />
Hmm... Unless I'm mistaken that is the SID for the &quot;Users&quot; group, and not all users of a PC are members of that group (Administrators, for example, are not ... though they'll have the right rights anyway). Is that what &quot;(BU)&quot; is meant to mean? I really want to allow access to all/any users ...<br />
<br />
Perhaps I should use &quot;Everyone&quot; (S-1-1-0)?<br />
<br />
Incidentally, it seems that Windows does recognize 2-character abbreviations for well-known SIDs in some situations, so &quot;(BU)&quot; may well work as well as &quot;(S-1-5-32-545)&quot; (and maybe &quot;(S-1-1-0)&quot; can be written &quot;(WD)&quot;) ... I had a look at the code for the AccessControl plugin and it strips the parentheses off the 'Trustee' string and passes it to ConvertStringSidToSid which is documented as accepting the 2-letter codes.<br />
<br />
Thanks for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th February 2008, 15:21</div></div><div class="posttext">Ah right my bad. Yes, BU stands for BUILTIN\USERS and WD stands for World - Everyone.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Daniel James</div><div class="date">29th February 2008, 09:13</div></div><div class="posttext">Originally posted by Me:<br />
Incidentally, it seems that Windows does recognize 2-character abbreviations for well-known SIDs in some situations, so &quot;(BU)&quot; may well work as well as &quot;(S-1-5-32-545)&quot; (and maybe &quot;(S-1-1-0)&quot; can be written &quot;(WD)&quot;) ... I had a look at the code for the AccessControl plugin and it strips the parentheses off the 'Trustee' string and passes it to ConvertStringSidToSid which is documented as accepting the 2-letter codes. <br />
Just for the record: ConvertStringSidToSid only accepts abbreviations for standard SIDs in XP and later. If you have to support Win2k you will have to use the numeric SIDs.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>