<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Error Wrapping MS Patch -  Please go to the control panel to install and configure sy, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Error Wrapping MS Patch -  Please go to the control panel to install and configure sy NSIS Discussion" />
	
	<title> Error Wrapping MS Patch -  Please go to the control panel to install and configure sy [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Error Wrapping MS Patch -  Please go to the control panel to install and configure sy</div>
<hr />
<div class="pda"><a href="t-312563.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=312563">Error Wrapping MS Patch -  Please go to the control panel to install and configure sy</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">SB5591</div><div class="date">17th September 2009, 15:18</div></div><div class="posttext">I'm stumped.<br />
<br />
I'm wrapping a KB (WindowsXP-KB915865-v11-x86-ENU.exe) from Microsoft that installs an Office 2007 component needed by Visio 2007.<br />
<br />
When I run the following code snippet from my .nsi script:<br />
<br />
Push 'WindowsXP-KB915865-v11-x86-ENU.exe'<br />
Call ExecCommand<br />
<br />
I get the following popup message:<br />
<br />
&quot;Please go to the control panel to install and configure system components&quot;<br />
<br />
I'm not a NSIS expert but have wrapped a few .MSI installs with no problems.  <br />
<br />
This is my first attempt to wrap a KB patch that installs a component like this.<br />
<br />
Any suggestions would be much appreciated.<br />
<br />
Thanks,<br />
<br />
Steve</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">17th September 2009, 18:18</div></div><div class="posttext">I was not able to reproduce the message you got, so I'm not sure what may have caused that.<br />
<br />
Since I don't know what &quot;ExecCommand&quot; does, here some comments you might already have tried:<br />
<br />
When you call WindowsXP-KB915865-v11-x86-ENU.exe /? from the command prompt, you will see all available command line switches.<br />
<br />
One of these is /passive: Unattended mode (progress bar only).<br />
When I use it like this:ExecWait '&quot;$TEMP\WindowsXP-KB915865-v11-x86-ENU.exe&quot; /passive'<br />
it installs without a problem.<br />
<br />
BTW:<br />
I found that when you call &quot;C:\Windows\System32\Setup.exe&quot;, your message will appear.<br />
One way this can happen is when an Autorun.ini is found with a &quot;open=Setup.exe&quot; entry without an actual Setup.exe in the same directory.<br />
Maybe this helps?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SB5591</div><div class="date">17th September 2009, 18:45</div></div><div class="posttext">jpderuiter:<br />
<br />
I see you're calling it a little differently.  I'll give that a try.<br />
<br />
Thanks,<br />
<br />
Steve</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SB5591</div><div class="date">17th September 2009, 21:06</div></div><div class="posttext">jpderuiter:<br />
<br />
Yep, that works.  Unfortunately I need to do a silent install and am using the /quiet switch.  <br />
<br />
From my testing seems like this (the popup message:&quot;Please go to the control panel to install and configure system components&quot;) only pops up when you (I) use the /quiet switch. <br />
<br />
The entire install is silent, as it should be, then at the end bingo, the popup.<br />
<br />
What a bummer!<br />
<br />
Any other ideas on suppressing this popup?<br />
<br />
Thanks,<br />
<br />
Steve</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">17th September 2009, 21:38</div></div><div class="posttext">ok, that's strange.<br />
Not happening on my machine.<br />
<br />
Did you have a look at the log file: C:\WINDOWS\KB915865.log<br />
<br />
You can extract the package to e.g. c:\KB915865_ENU usingWindowsXP-KB915865-v11-x86-ENU.exe  -x:c:\KB915865_ENU<br />
Maybe you can find something related there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">17th September 2009, 21:57</div></div><div class="posttext">BTW, does this only happen when you run it from an NSIS script, or always?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SB5591</div><div class="date">17th September 2009, 22:09</div></div><div class="posttext">jpderuiter:<br />
<br />
Thanks for the suggestion.  I've extracted the KB and am looking at my testing.  I think my logic was flawed and I'm re-running the tests to isolate this better.<br />
<br />
I've looked at the log file but didn't find anything useful to isolate this.<br />
<br />
So odd, if I run WindowsXP-KB915865-v11-x86-ENU.exe outside of a .nsi script it never gives the popup.  When running from a script I seem to get this popup.  I'm not sure why it would be having this behavior when fired from NSIS.<br />
<br />
I sure appreciate all your suggestions!<br />
<br />
Thanks,<br />
<br />
Steve</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">17th September 2009, 22:55</div></div><div class="posttext">What when you use the ExecDos plug-in?<br />
I use this plugin most of the time, mainly because of the ASYNC option, but I also found it working better then the other commands / plug-ins.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SB5591</div><div class="date">18th September 2009, 16:37</div></div><div class="posttext">jpderuiter:<br />
<br />
I'm not using ExecDos and will have to check that out.<br />
<br />
Thanks,<br />
<br />
Steve</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>