<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" WriteINIStr creates new files, but won't update existing, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  WriteINIStr creates new files, but won't update existing NSIS Discussion" />
	
	<title> WriteINIStr creates new files, but won't update existing [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  WriteINIStr creates new files, but won't update existing</div>
<hr />
<div class="pda"><a href="t-320184.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=320184">WriteINIStr creates new files, but won't update existing</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">faw872</div><div class="date">24th June 2010, 01:11</div></div><div class="posttext">I'm creating a desktop shortcut to distribute to our applications users but I've noticed  it only creates a new file if you change the filename you are passing to a filename not yet used.  When its a new .URL filename, it creates a new .URL file with the current data.  If I keep using the old .URL filename, it doesn't update the file that already exists.  Even if I delete the old .URL file manually and even clear my recycle bin and then I run the script again, if  I'm re-using a file name, it manages to create the old file with old url again.   I've tried this in XP and Windows 7.  Do I need to do something with temp files?  I haven't seen that in anyone elses code.  Thanks!  I've been trying to figure out this final detail for hours.  Here's the excerpt of the code:<br />
<br />
Section &quot;&quot; ;No components page, name is not important<br />
!macro CreateInternetShortcut FILENAME URL ICONFILE ICONINDEX<br />
nsislog::log &quot;c:\logfile.txt&quot; &quot;Creating Internet shortcut.&quot;<br />
WriteINIStr &quot;${FILENAME}.url&quot; &quot;InternetShortcut&quot; &quot;URL&quot; &quot;${URL}&quot;<br />
WriteINIStr &quot;${FILENAME}.url&quot; &quot;InternetShortcut&quot; &quot;IconFile&quot; &quot;${ICONFILE}&quot;<br />
WriteINIStr &quot;${FILENAME}.url&quot; &quot;InternetShortcut&quot; &quot;IconIndex&quot; &quot;${ICONINDEX}&quot;<br />
!macroend<br />
<br />
!insertmacro CreateInternetShortcut \<br />
  &quot;$DESKTOP\Econ 3&quot; \<br />
  &quot;http://mysite&quot; \<br />
  &quot;$SYSDIR\favicon.ico&quot; &quot;0&quot;<br />
<br />
SectionEnd ; end the section</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CrushBug</div><div class="date">24th June 2010, 02:51</div></div><div class="posttext">Is it possible that you are encountering a problem with quotation marks? What happens if you change the filename parameter from &quot;$DESKTOP\Econ 3&quot; to &quot;$DESKTOP\Econ3&quot; ?<br />
<br />
What about changing the quotation marks in the macro from &quot; (quotation marks) to ` (Grave Accent) ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th June 2010, 10:51</div></div><div class="posttext">Are you on Windows 98? Try FlushINI.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">faw872</div><div class="date">24th June 2010, 18:49</div></div><div class="posttext">Thanks for the input!  I'm actually using Windows XP and 7, not 98, but I ran with your ideas and tried putting flushini before, then after, and a delete.  I also changed it to no spaces in the file name and tried single quotes and ` in the macro.  No luck :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">faw872</div><div class="date">24th June 2010, 18:56</div></div><div class="posttext">nevermind, I figured it out!  If i delete the exe before I recompile, it will update the .url file I'm creating/modifying :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">faw872</div><div class="date">24th June 2010, 19:06</div></div><div class="posttext">oops, false alarm!  I haven't been able to get it to update since.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">faw872</div><div class="date">24th June 2010, 19:33</div></div><div class="posttext">i figured something else out, although its not a solution.  In both XP and Windows 7, if I delete the .URL file AND reboot, when I run the .exe if creates a new .URL file.  So i figured out a way to make it work, but thats not user friendly.  If I only delete the .URL file, or only reboot, then run the .exe, the .URL file is still what it was before the delete or reboot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th June 2010, 19:58</div></div><div class="posttext">Try creating the URL file in your install directory and creating a shortcut to that instead. Perhaps because it is on the desktop it is cached in some way.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">faw872</div><div class="date">24th June 2010, 23:58</div></div><div class="posttext">Thanks, I tried a different directory to install the URL shortcut to.   That didn't resolve it either.  I think this is solved though.  I noticed that the file is actually being updated with the right http path each time, because theres a file preview in Windows 7.  I had been testing by right clicking and looking at properties, which isn't updating for some reason, but I guess thats just life.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cornhoulio</div><div class="date">11th August 2010, 08:45</div></div><div class="posttext">never mind</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>