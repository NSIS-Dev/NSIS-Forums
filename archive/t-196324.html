<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" onVerifyInstDir problem with XP, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  onVerifyInstDir problem with XP NSIS Discussion" />
	
	<title> onVerifyInstDir problem with XP [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  onVerifyInstDir problem with XP</div>
<hr />
<div class="pda"><a href="t-196324.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=196324">onVerifyInstDir problem with XP</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">senin</div><div class="date">11th October 2004, 16:59</div></div><div class="posttext">I got a problem with the callback function 'onVerifyInstDir'.<br />
<br />
The following code<br />
<br />
Fucntion .onVerifyInstDir<br />
   Push $INSTDIR<br />
   Push &quot; &quot;<br />
   Call StrStr<br />
   Pop $R0<br />
   StrComp $R0,&quot;&quot; +3 0<br />
   MessageBox   MB_OK|MB_ICONINFORMATION $(MSG0003)<br />
   Abort<br />
FunctionEnd<br />
<br />
Works fine on Windows98. This checks for the space in installed directory and gives the error message propertly. But on Windows XP, When the browse button is clicked, the directory variable value automatically updates to the Windows XP profile directory(with spaces) and the call back fucntion is executed several times and shows message box multiple times. I use NSIS Version 2.0. Any help to resolve this issue would be appreciated. thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th October 2004, 17:05</div></div><div class="posttext">Use the leave function of the directory page. In .onVerifyInstDir you should only call Abort to disable the next button.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">senin</div><div class="date">13th October 2004, 22:08</div></div><div class="posttext">thanks<br />
But i want to show a dialogbox to alert the user that he selected a directory with spaces, this works perfectly on windows 98, If I remove the MessageBox it also work on XP(no dialog box) but ok</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th October 2004, 22:13</div></div><div class="posttext">That can done from the leave function. You shouldn't use MessageBox in .onVerifyInstDir. From the documentation:This code will be called every time the user changes the install directory, so it shouldn't do anything crazy with MessageBox or the likes.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>