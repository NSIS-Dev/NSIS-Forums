<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" General Query for all - Removing Files on Uninstall - What method do you use?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  General Query for all - Removing Files on Uninstall - What method do you use? NSIS Discussion" />
	
	<title> General Query for all - Removing Files on Uninstall - What method do you use? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  General Query for all - Removing Files on Uninstall - What method do you use?</div>
<hr />
<div class="pda"><a href="t-275258.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=275258">General Query for all - Removing Files on Uninstall - What method do you use?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Sheik</div><div class="date">2nd August 2007, 02:43</div></div><div class="posttext">Hi all,<br />
<br />
I am just curious, what method do people here use for removing their installed files during the uninstaller?<br />
<br />
Especially for very LARGE installers where there are too many files to manually type in each file name in the uninstall method.<br />
<br />
As I see it, there are 3 different options.<br />
<br />
1) No special &quot;logging&quot; makensis.exe build.<br />
Just &quot;RMDIR /r&quot; and run with it.<br />
<br />
2) No special &quot;logging&quot; makensis.exe build.<br />
Instead use the &quot;Advanced Uninstall Log NSIS Header&quot; and have it log during install, and uninstall based on that.<br />
http://nsis.sourceforge.net/Advanced_Uninstall_Log_NSIS_Header<br />
<br />
3) Use the special &quot;logging&quot; makensis.exe build.<br />
Parse the log to do the file removal on uninstall.<br />
http://nsis.sourceforge.net/Uninstall_from_NSIS_log<br />
<br />
<br />
What leads me to ask this question, is I came from the WISE world, where the install log is fundamental to the uninstall procedure.<br />
<br />
I actually started to get liking the NSIS method of not logging the install, but just go ahead and blow away your created directories as you see fit, and have released a few of my Installers with this.<br />
<br />
But I have gotten a complaint that this is a HORRIBLE idea, in that if your customer has created important files underneath your directory, we are indiscriminately blowing away things that shouldn't be blown away.<br />
<br />
They have a point.<br />
<br />
So this leads me to asking the rest of the NSIS world...<br />
<br />
Has anyone else ran into the same problem?<br />
What did you decide to do?<br />
Did I miss any options?<br />
<br />
Thanks!<br />
Scott</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">2nd August 2007, 06:36</div></div><div class="posttext">Obviously, RmDir /r should be used with caution.<br />
Recently discussed here in forum a case where accidentally removed the entire Start Menu on a system where the instruction implemented improperly.<br />
<br />
My choice (that's obvious too) is advanced uninstall log, because I wrote it ;)<br />
<br />
BTW if someone of you programmers could somehow fix that issue in which throws the list several times, I believe advanced uninstall log will become more useful tool.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd August 2007, 11:58</div></div><div class="posttext">You can still use RMDir /r but you should do some strenuous validation on the uninstall path first:<br />
<br />
http://nsis.sourceforge.net/Validating_%24INSTDIR_before_uninstall<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sheik</div><div class="date">2nd August 2007, 16:03</div></div><div class="posttext">Hi Red Wine,<br />
<br />
The Installer that I am concerned with has a HUGE amount of files and directories that get installed.<br />
<br />
We are talking 13,000+ files, and 800+ directories.<br />
<br />
rmdir /r (with validation of the top level directory) is very fast and efficient.<br />
<br />
But wow, is it dangerous, if someone uses anything under that top level directory for their own purposes.<br />
<br />
I was thinking about trying the &quot;Advanced Uninstall Log&quot;, but I really worry about the time/efficiency of it...<br />
<br />
Throwing the list of 13000+ files multiple times seems like a very time consuming task...<br />
<br />
The &quot;special&quot; logging build of makensis.exe is interesting, but I do not like the fact that it is &quot;special&quot;...<br />
<br />
I would hate to invest time/energy into writing code to it, only to have the feature &quot;go away&quot; in the future.<br />
<br />
I wonder if anyone has ever written a plugin to NSIS that does what the &quot;special&quot; build does...<br />
<br />
Or maybe the &quot;special&quot; logging feature could move from a compile time option to be a run time option?<br />
<br />
Or maybe there is a better, yet undiscovered way to do this?<br />
<br />
Thanks!<br />
Scott</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd August 2007, 16:07</div></div><div class="posttext">All the special build does it generate a log file at run time. The reason it is 'special' is because the majority of people do not need logging support and the overheard that it induces. The script that uninstalls from the log simply parses it for File instructions, so that may be your best route. Otherwise, use RMDir /r and check the link that I provided. As long as you check a prominent file is located in $INSTDIR (among other checks) before you call RMDir /r then everything should be ok.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sheik</div><div class="date">2nd August 2007, 16:29</div></div><div class="posttext">Hi Afrow UK,<br />
<br />
Thanks for your responses.<br />
<br />
What about the problem where the user might have added their own files or directories inside of $INSTDIR after the Installer was run?<br />
<br />
RMDir /r on uninstall would blow away these extra files by mistake!<br />
<br />
Scott</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd August 2007, 16:58</div></div><div class="posttext">Yes it would.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd August 2007, 17:06</div></div><div class="posttext">If you don't want to delete files using one of these scripts then you can instead write an NSIS installer which loops through all your files (i.e. using RecFind or Locate) and writes your NSIS code for you.<br />
http://nsis.sourceforge.net/Invoking_NSIS_run-time_commands_on_compile-time<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">2nd August 2007, 17:12</div></div><div class="posttext">Throwing the list of 13000+ files multiple times seems like a very time consuming task...<br />
Using advanced uninstall log when installing/uninstalling such a huge amount of files/directories it is NOT a very time consuming task because it does not need to throw the list more than once.<br />
Time consuming task might be noticed depending on target machine, and only in the case where the target installation directory contains such a huge amount of files/directories, either prior the installation, or added later by the users.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">helix400</div><div class="date">2nd August 2007, 20:28</div></div><div class="posttext">I do the RMDIR /r option. <br />
<br />
I do this because of our auto updates.  If we add new files during an update, I don't want to get into the hairy details of adding to the log to keep it perfect.  I find it much simpler to simply uninstall an entire folder.<br />
<br />
I also don't yet validate to make sure the folder I'm deleting isn't, say, the Program Files folder.  :O  One of these days, I'm going to have to put that in.<br />
<br />
As for user added files, those should generally happen under an individual user profile or all users profile.  And it's generally fine to not touch those files during the uninstall.<br />
<br />
For example, long ago, we used to store user setting files in a Program Files folder.  I did this because i thought it was normal practice, and because it let me delete every trace of our app on the users computer.  But with user permissions and especially Windows Vista enforcing it, storing settings and such in Program Files is a very bad idea.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>