<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Recommended method to execute DLL, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Recommended method to execute DLL NSIS Discussion" />
	
	<title> Recommended method to execute DLL [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Recommended method to execute DLL</div>
<hr />
<div class="pda"><a href="t-227291.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=227291">Recommended method to execute DLL</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jchaven</div><div class="date">30th September 2005, 06:37</div></div><div class="posttext">I am trying to create an install file to load several network printers with a single file. To actually install the printers uses &quot;rundll.exe&quot; as in this example:<br />
<br />
rundll32 printui.dll,PrintUIEntry <br />
/if /b &quot;Ricoh Aficio 1515 (Systems)&quot; <br />
/f &quot;\\ntserver\install\R1515_Win2K_XP\OEMSETUP.INF&quot; <br />
/q /r &quot;NP01-C05&quot; /m &quot;RICOH Aficio 1515 PCL 6&quot; /z /u<br />
<br />
<br />
The problem is I cannot figure-out how to run these commands in the NSIS script. I have read info about &quot;Exec&quot;, &quot;ExecWait&quot;, &quot;ExecShell&quot;, &quot;ExecDLL&quot;, and &quot;nsExec&quot; and I can't seem to get any of them to work. I fear that it is because of all the switches used in the command.<br />
<br />
Here is my latest failed attempt:<br />
<br />
ExecWait &quot;rundll32 printui.dll,PrintUIEntry <br />
/if /b 'Ricoh Aficio 1515 (Systems)' <br />
/f '$INSTDIR\Ricoh1515F_PCL6\Win2K_XP\OEMSETUP.INF' <br />
/q /r 'NP01-C05' /m 'RICOH Aficio 1515 PCL 6' /z /u&quot;<br />
<br />
<br />
So, NSIS gurus what advice can you help give this newbie to get around this?<br />
<br />
TIA,<br />
Charles</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th September 2005, 11:54</div></div><div class="posttext">How exactly doesn't it work? From the code you've posted above, it seems like you should get a syntax error because you've split the lines.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jchaven</div><div class="date">30th September 2005, 13:29</div></div><div class="posttext">Sorry - it was late when I posted. The error I receive is coming from the DLL and it states &quot;The arguments are invalid&quot;<br />
<br />
The arguments are not invalid -- they work from a batch. I broke the lines apart in the post for readability. In  the script they are all on one line.<br />
<br />
Thanks,<br />
Charles</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th September 2005, 13:36</div></div><div class="posttext">Maybe it doesn't like single quotes? Try using double quotes for the command line and single quotes for the NSIS string itself. If that doesn't work, attach the working example and the non-working example.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jchaven</div><div class="date">30th September 2005, 14:29</div></div><div class="posttext">The quotes thing was keeping it from running. The command is running now (there is a delay between commands like it is doing something) but doesn't add the printers.<br />
<br />
Here is the new command that does compile and appears to work but doesn't:<br />
ExecWait 'rundll32 printui.dll,PrintUIEntry /if /b &quot;Ricoh Aficio 1515 (Systems)&quot; /f &quot;$INSTDIR\Ricoh1515F_PCL6\Win2K_XP\OEMSETUP.INF&quot; /q /r &quot;NP01-M06&quot; /m &quot;RICOH Aficio 1515 PCL 6&quot; /z /u'<br />
<br />
Here is the command as run from a DOS batch file:<br />
start /wait rundll32 printui.dll,PrintUIEntry /if /b &quot;Ricoh Aficio 1515 (Systems)&quot; /f &quot;C:\Temp\JCH-INSTALL_PRINTERS\Ricoh1515F_PCL6\Win2K_XP\OEMSETUP.INF&quot; /q /r &quot;NP01-C05&quot; /m &quot;RICOH Aficio 1515 PCL 6&quot; /z /u<br />
<br />
I am able to get working what I need by adding the batch file to the install and using ExecWait to run it. However, it creates the DOS window and I have to make sure the $INSTDIR value is specified in my batch.<br />
<br />
I appreciate your help!!<br />
<br />
Thanks,<br />
Charles</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th September 2005, 14:37</div></div><div class="posttext">Maybe the working directory bothers it? Try setting it using SetOutPath.<br />
<br />
To avoid the DOS window, you can use the nsExec plug-in which is bundled with NSIS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jchaven</div><div class="date">30th September 2005, 15:55</div></div><div class="posttext">SetOutPath did it -- it is working perfectly now. Thanks!!<br />
<br />
Thanks,<br />
Charles</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>