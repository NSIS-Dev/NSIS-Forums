<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" win98 registry changes ignored until reboot?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  win98 registry changes ignored until reboot? NSIS Discussion" />
	
	<title> win98 registry changes ignored until reboot? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  win98 registry changes ignored until reboot?</div>
<hr />
<div class="pda"><a href="t-122171.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=122171">win98 registry changes ignored until reboot?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Darker</div><div class="date">20th January 2003, 19:03</div></div><div class="posttext">;) Background:<br />
Part of an installer I'm creating that runs via a login script installs a screen saver.<br />
<br />
Win2k and Win98 both use the same key to specify the 'wait' period before the screen saver kicks in.  Here's the command I'm using to set it.<br />
<br />
WriteRegStr HKCU &quot;Control Panel\Desktop&quot; &quot;ScreenSaveTimeOut&quot; &quot;240&quot;<br />
<br />
:up: Works fine in 2k, takes effect immediately.<br />
<br />
:cry: Problem:<br />
In win98, this registry setting doesn't take effect until the user logs out and back in.  <br />
<br />
i.e. If you change it to 4 minutes from 10 minutes via the above script command, then open the Desktop properties, the screen saver 'wait' period is still 10 minutes.  At the next login, win98 picks up the new setting from the registry and all is well.<br />
<br />
:hang: I don't want users to have to re-log to get this set.<br />
<br />
Anybody know of a way to force some kind of scriptable 'refresh' that will whip win98 into compliance?  Maybe?  :D<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th January 2003, 20:31</div></div><div class="posttext">Try:<br />
<br />
!include WinMessages.nsh<br />
SendMessage ${HWND_BROADCAST} ${WM_WININICHANGE} 0 &quot;STR:Control Panel\Desktop&quot; /TIMEOUT=5000<br />
<br />
or:<br />
<br />
!include WinMessages.nsh<br />
SendMessage ${HWND_BROADCAST} ${WM_WININICHANGE} 0 0 /TIMEOUT=5000<br />
<br />
If either of these doesn't work you'll have to search MSDN.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Darker</div><div class="date">21st January 2003, 16:11</div></div><div class="posttext">Well, good try, but that doesn't seem to work.<br />
<br />
I played with it for 3 or 4 hours (maybe I'm an idiot :)) and had no luck with either method above, or using the System.nsh sysSystemParametersInfo function which according to MSDN, should also set this.<br />
<br />
I think I'll just accept defeat.  Windows 98 sucks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st January 2003, 19:15</div></div><div class="posttext">It does, but when done right you can make it happen. The screen saver control panel does it, so it is possible. What's the System.dll line you tried?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Darker</div><div class="date">22nd January 2003, 16:16</div></div><div class="posttext">bah, I erased the line when I couldn't get it working and gave up.<br />
Thanks for the help though.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">26th March 2004, 08:12</div></div><div class="posttext">sorry for bringing up this old post again, but i was wondering if somebody came across a solution in meanwhile.<br />
<br />
my installer changes a couple of appearance settings (font smoothing etc), but that also doesn't work until i reboot.<br />
<br />
to make this off-topic, i don't have win98 :p</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gieltje</div><div class="date">26th March 2004, 09:51</div></div><div class="posttext">I would also be very interested, my installer makes a **** load of such registry changes</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>