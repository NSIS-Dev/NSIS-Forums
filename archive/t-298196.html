<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Welcome/Finish pages not displaying in Windows Vista, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Welcome/Finish pages not displaying in Windows Vista NSIS Discussion" />
	
	<title> Welcome/Finish pages not displaying in Windows Vista [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Welcome/Finish pages not displaying in Windows Vista</div>
<hr />
<div class="pda"><a href="t-298196.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=298196">Welcome/Finish pages not displaying in Windows Vista</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jossie</div><div class="date">4th October 2008, 03:04</div></div><div class="posttext">I was running my installer under Windows XP and it was running fine.  Under Vista however, the Welcome and Finish pages don't display.  I thought it could be due to the custom modern.exe I was running so then I compiled the following sample script, and it still didn't display the welcome/finish pages in Vista.  Does anyone have any ideas?<br />
<br />
<br />
;NSIS Modern User Interface<br />
;Welcome/Finish Page Example Script<br />
;Written by Joost Verburg<br />
<br />
;--------------------------------<br />
;Include Modern UI<br />
<br />
  !include &quot;MUI2.nsh&quot;<br />
<br />
;--------------------------------<br />
;General<br />
<br />
  ;Name and file<br />
  Name &quot;Modern UI Test&quot;<br />
  OutFile &quot;WelcomeFinish.exe&quot;<br />
<br />
  ;Default installation folder<br />
  InstallDir &quot;$LOCALAPPDATA\Modern UI Test&quot;<br />
<br />
  ;Get installation folder from registry if available<br />
  InstallDirRegKey HKCU &quot;Software\Modern UI Test&quot; &quot;&quot;<br />
<br />
  ;Request application privileges for Windows Vista<br />
  RequestExecutionLevel user<br />
<br />
;--------------------------------<br />
;Interface Settings<br />
<br />
  !define MUI_ABORTWARNING<br />
<br />
;--------------------------------<br />
;Pages<br />
<br />
  !insertmacro MUI_PAGE_WELCOME<br />
  !insertmacro MUI_PAGE_LICENSE &quot;${NSISDIR}\Docs\Modern UI\License.txt&quot;<br />
  !insertmacro MUI_PAGE_COMPONENTS<br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_PAGE_FINISH<br />
<br />
  !insertmacro MUI_UNPAGE_WELCOME<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_UNPAGE_INSTFILES<br />
  !insertmacro MUI_UNPAGE_FINISH<br />
<br />
;--------------------------------<br />
;Languages<br />
<br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
;--------------------------------<br />
;Installer Sections<br />
<br />
Section &quot;Dummy Section&quot; SecDummy<br />
<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
<br />
  ;ADD YOUR OWN FILES HERE...<br />
<br />
  ;Store installation folder<br />
  WriteRegStr HKCU &quot;Software\Modern UI Test&quot; &quot;&quot; $INSTDIR<br />
<br />
  ;Create uninstaller<br />
  WriteUninstaller &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
SectionEnd<br />
<br />
;--------------------------------<br />
;Descriptions<br />
<br />
  ;Language strings<br />
  LangString DESC_SecDummy ${LANG_ENGLISH} &quot;A test section.&quot;<br />
<br />
  ;Assign language strings to sections<br />
  !insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />
    !insertmacro MUI_DESCRIPTION_TEXT ${SecDummy} $(DESC_SecDummy)<br />
  !insertmacro MUI_FUNCTION_DESCRIPTION_END<br />
<br />
;--------------------------------<br />
;Uninstaller Section<br />
<br />
Section &quot;Uninstall&quot;<br />
<br />
  ;ADD YOUR OWN FILES HERE...<br />
<br />
  Delete &quot;$INSTDIR\Uninstall.exe&quot;<br />
<br />
  RMDir &quot;$INSTDIR&quot;<br />
<br />
  DeleteRegKey /ifempty HKCU &quot;Software\Modern UI Test&quot;<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th October 2008, 10:50</div></div><div class="posttext">That works fine for me on both XP and Vista. Any different programs installed on the Vista machine that might make the difference?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jossie</div><div class="date">7th October 2008, 00:02</div></div><div class="posttext">Its a pretty clean install of Vista Enterprise Edition SP1.  The only other software installed on the machine is McAfee VirusScan Enterprise and McAfee AntiSpyware Enterprise.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th October 2008, 07:09</div></div><div class="posttext">Try disabling both.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jossie</div><div class="date">9th October 2008, 00:32</div></div><div class="posttext">Ok so the problem was definitely McAfee VirusScan Enterprise.<br />
<br />
With it running no NSIS based installers (including the installer for NSIS) would should the welcome/finish pages.<br />
<br />
I uninstalled the VirusScan application, and the Welcome/Finish pages started showing up again.  (the antispyware application is still running).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">9th October 2008, 01:56</div></div><div class="posttext">I'm clueless on this, but... are you saying that the -other- pages do display?  I.e. it essentially skips the welcome page and goes straight to whatever the next page in line is?<br />
<br />
Or are you saying that the installer refuses to run -if- you have a welcome and/or finish page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th October 2008, 07:04</div></div><div class="posttext">I guess it's a false positive on nsDialogs.dll. Try scanning nsDialogs.dll manually and see what it says.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">9th October 2008, 11:46</div></div><div class="posttext">I don't have any problems with this virus scanner. Did you update your DAT files?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jossie</div><div class="date">10th October 2008, 23:46</div></div><div class="posttext">Specifically the welcome/finish pages didn't display, but the rest of the installer did.<br />
<br />
I had to convince the IT department to let me uninstall the virus scanner since they wouldn't let me disable it (since that would mean they would have to provide me the password for it).  After uninstalling mcafee the issue went away (as I said earlier).  Now the interesting bit is I reinstalled the installer and updated the DAT files, and the installer was still working fine.<br />
<br />
The only theory I can come up with is that this machine was an upgrade from XP to Vista.  Somehow during the upgrade process Mcafee got messed up?<br />
<br />
Thanks for everyone's help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th October 2008, 12:59</div></div><div class="posttext">The previous DAT files probably contained an error causing a false virus detection in an NSIS plug-in. The update of the DAT files has resolved this issue.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>