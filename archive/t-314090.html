<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Test for a Valid Certificate?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Test for a Valid Certificate? NSIS Discussion" />
	
	<title> Test for a Valid Certificate? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Test for a Valid Certificate?</div>
<hr />
<div class="pda"><a href="t-314090.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=314090">Test for a Valid Certificate?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">22nd October 2009, 21:21</div></div><div class="posttext">Is there a way (or plugin) to test a digitally signed installer (with a code signing certificate), from within that installer, that the digital signature exists and valid?<br />
<br />
That is, the the file has not been tampered with after it was signed?<br />
<br />
I know how to do it visually, by looking at the corresponding Properties tab. Is it possible to do this programmatically from within the installer?<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">23rd October 2009, 07:08</div></div><div class="posttext">Wouldn't this be a chicken-egg problem? You can't enter the checksum in the installer without changing the installer's checksum...<br />
<br />
Though I do seem to recall some signing solutions existing. Maybe someone else knows.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">26th October 2009, 05:56</div></div><div class="posttext">Originally posted by MSG <br />
Wouldn't this be a chicken-egg problem? You can't enter the checksum in the installer without changing the installer's checksum... <br />
Not really a chicken-and-egg because I don't expect to read the installer's checksum for that: The digital certificate is appended and itself includes a stronger hashing of the entire file.<br />
<br />
The nice thing about those digital certificates is that if anyone modifies anything inside the file (e.g. infecting with a virus), one could see immediately from the tab that it is no longer signed by so called &quot;verified publisher&quot;.<br />
<br />
So, all we really need is a way to look at this &quot;tab&quot; and tell go/no-go.<br />
<br />
Any idea how to do that?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">820815</div><div class="date">26th October 2009, 09:53</div></div><div class="posttext">Originally posted by MSG <br />
You can't enter the checksum in the installer without changing the installer's checksum...<br />
There's not a problem to fix its last four bytes.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">26th October 2009, 10:37</div></div><div class="posttext">There is really no point to do this, NSIS already checks itself with a CRC (And &quot;pirates&quot; will get around it anyways, or just extract the files without running the installer)<br />
<br />
If you really want to do this, call Wintrust::CryptCATAdminCalcHashFromFileHandle (and WTHelperGetProvSignerFromChain or CryptCATAdminEnumCatalogFromHash?) and WinVerifyTrust with the system plugin<br />
<br />
See also:<br />
http://forum.sysinternals.com/forum_posts.asp?TID=19404<br />
http://forum.sysinternals.com/forum_posts.asp?TID=16893&amp;PID=83634<br />
http://forum.sysinternals.com/forum_posts.asp?TID=19247</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>