<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Command or plugin to quit application gracefully?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Command or plugin to quit application gracefully? NSIS Discussion" />
	
	<title> Command or plugin to quit application gracefully? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Command or plugin to quit application gracefully?</div>
<hr />
<div class="pda"><a href="t-321094.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=321094">Command or plugin to quit application gracefully?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jdt2oo7</div><div class="date">24th July 2010, 00:57</div></div><div class="posttext">Hello all,<br />
<br />
I've been using the Processes::KillProcess to kill an application before update or before uninstallation, but we are looking for something that give the application time to gracefully shutdown. Any suggestion?<br />
<br />
Many thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">24th July 2010, 05:26</div></div><div class="posttext">well, you could send WM_CLOSE to the application:<br />
http://msdn.microsoft.com/en-us/library/ms632617(VS.85).aspx<br />
<br />
or you can try the relatively recent nsisDDE plugin:<br />
http://forums.winamp.com/showthread.php?t=320701</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">24th July 2010, 16:30</div></div><div class="posttext">Note: nsisDDE (http://wiz0u.free.fr/prog/nsisDDE/) has been around for a long time now (2005) but there was no forum thread for it ;)<br />
Version 1.1 was recently released and supports Unicode.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">25th July 2010, 02:02</div></div><div class="posttext">Note: nsisDDE (http://wiz0u.free.fr/prog/nsisDDE/) has been around for a long time now (2005) but there was no forum thread for it ;)<br />
whoops! :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jdt2oo7</div><div class="date">27th July 2010, 00:46</div></div><div class="posttext">Thanks for your responeses, Animaether and Wizou!<br />
<br />
I tried as follow but it doesn't seem to close the program:<br />
<br />
nsisDDE::Execute &quot;notepad&quot; &quot;[FileQuit()]&quot;<br />
Pop $0<br />
MessageBox MB_OK &quot;Found $0 responding DDE server(s)&quot;<br />
<br />
The message value for $0 is 0.<br />
<br />
I also try with nsisDDEW. What I do wrong here?<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">27th July 2010, 01:07</div></div><div class="posttext">from the first google hit for 'notepad dde'..<br />
&quot;DDE (Dynamic Data Exchange) is one Microsoft way of communicating between applications that support that (e.g. Word does, but Wordpad/Notepad don't). Messages are strings that express commands&quot;<br />
..it seems notepad doesn't take DDE commands.<br />
<br />
So if notepad is your target, WM_CLOSE may be what you're actually looking for.  What are you trying to accomplish, exactly?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jdt2oo7</div><div class="date">27th July 2010, 01:12</div></div><div class="posttext">Thanks Animaether! <br />
<br />
I am just trying to quit my application gracefully instead of using Processes::KillProcess to kill my application.<br />
<br />
For example, my app is in the process of syncing a file, I would like to quit after the sync process is completed instead of kill the app right away.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">27th July 2010, 01:18</div></div><div class="posttext">Well, you'd have to look up the exact specs of that application's DDE server - if any (e.g. just like notepad, it might not have any) - to use the DDE method.<br />
The alternative is the WM_CLOSE message, which the application should handle gracefully.  However, the exact manner in which it handles this is less fine-grained than DDE might allow.<br />
<br />
e.g. as per that same article, Microsoft Office Word can be told to close and - if a modified file is open - either save, don't save, or prompt the user.<br />
with WM_CLOSE, it always prompts the user (similar to pressing the X button on the window)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">27th July 2010, 09:57</div></div><div class="posttext">@jdt2oo7 : If you have the source code of your application and it is written in MFC, it is quite easy to add DDE support.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>