<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" VB Runtime and Multiple OS installation, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  VB Runtime and Multiple OS installation NSIS Discussion" />
	
	<title> VB Runtime and Multiple OS installation [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  VB Runtime and Multiple OS installation</div>
<hr />
<div class="pda"><a href="t-204800.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=204800">VB Runtime and Multiple OS installation</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pedro56</div><div class="date">13th January 2005, 11:13</div></div><div class="posttext">I have a program I wrote in VB6 which requires VB runtime files such as OLEAUT32.DLL however when installed on Windows 98 any programs using InstallShield no longer function due to new dll file version. Should I modify script to check if VB runtime files exist and only copy to Windows system if they don't exist ? The only file that appears to be missing from Windows 98 is msvbvm60.dll which should be in system32 folder.  I now this is a common problem but doesn't appear to be a simple solution.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th January 2005, 20:25</div></div><div class="posttext">Have you deployed OLEAUT32.DLL from Microsoft's redistributables, or from your own system directory? If you've used the DLL from your own system directory, that's probably the source of the problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pedro56</div><div class="date">13th January 2005, 23:33</div></div><div class="posttext">The runtime files were from my systerm (XP) so I took out all VB runtime files from NSIS script. The program only works in Windows 98 if msvbvm60.dll is in Windows/System32. I have many clients who still have an old OS so I need it compatible to 98, ME, NT,&amp; 2000. I am worried that if I include msvbvm60.dll it may cause problems with other OS which I can't test on.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th January 2005, 10:38</div></div><div class="posttext">Never copy any files from your own system folder, these files are only compatible with Windows XP. The OLE files in the VB6 runtimes from Microsoft are only intented to update older Windows version.<br />
<br />
NSIS can handle all these things automatically, just copy the code from the documentation and use official Microsoft files as described.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pedro56</div><div class="date">15th January 2005, 11:12</div></div><div class="posttext">Thanks. Installed vbrun60sp5.exe downloaded from MS on a clean install of Win98 SE. I included script from here into my setup script: http://nsis.sourceforge.net/archive/viewpage.php?pageid=47 <br />
<br />
Do I need to copy all dlls mentioned or can I modify to include only msvbvm60.dll as it appears this dll is the only one my app needs or are they all needed for Windows 95, NT, 2000 etc ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th January 2005, 11:29</div></div><div class="posttext">You should include all of them since that's what Microsoft does. msvcvm60.dll probably depends on the others.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pedro56</div><div class="date">15th January 2005, 12:12</div></div><div class="posttext">I am sure you are right with dependancies between dlls so I will include all &quot;distributable&quot; VB Runtime files listed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pedro56</div><div class="date">16th January 2005, 05:01</div></div><div class="posttext">Tested with &quot;redistributable&quot; runtime files and appears OK. Visual Studio Package &amp; Deployment Wizard included mci32.ocx (multimedia control), msrd2x35.dll (MS Jet ODBC) and vb6stkit.dll (VB Setup Toolkit Library). I understand vb6stkit.dll is possibly not required but I didn't select ODBC in wizard and leaving out all doesn't appear to affect correct running of my app. Should I include some or all the same way as runtime files or just copy to windows system?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tsugio</div><div class="date">18th January 2005, 17:18</div></div><div class="posttext">I found the best way to make sure you include everything you need is to use the Package &amp; Deployment wizard before using NSIS.  This will create a directory with all the dependencies for your project and you can simply add those files to your NSIS installation.<br />
<br />
HTH.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th January 2005, 18:19</div></div><div class="posttext">If it's a redistributable and is placed in the system directory, it's always a good idea to not just copy it. Your installer might contain an older version than the one on the system, and simply overwriting is not a good idea in such cases. Also, if it requires registration, simply copying it won't do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pedro56</div><div class="date">23rd January 2005, 01:56</div></div><div class="posttext">Modified script to include MCI32.OCX<br />
 and MSRD2X35.DLL which Package &amp; Deployment wizard listed. I have attached script for information. I am not sure about  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED whether it should be REBOOT_NOTPROTECTED or REBOOT_PROTECTED.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>