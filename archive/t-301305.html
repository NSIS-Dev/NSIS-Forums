<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Determine &quot;Default User&quot; Path, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Determine &quot;Default User&quot; Path NSIS Discussion" />
	
	<title> Determine &quot;Default User&quot; Path [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Determine &quot;Default User&quot; Path</div>
<hr />
<div class="pda"><a href="t-301305.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=301305">Determine &quot;Default User&quot; Path</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">xbarns</div><div class="date">22nd December 2008, 10:41</div></div><div class="posttext">Hello all, <br />
<br />
i am looking for a way to determine the &quot;Default User&quot; Path on different OS, is there by any chance a NSIS Variable for it? I looked in the Manual but didn't find anything useful.<br />
<br />
Maybe a little explanation what i want to do:<br />
<br />
Target is to set a default background to all users that might log on to a machine.<br />
<br />
For this i load the Default Users ntuser.dat (C:\Documents and Settings\Default User\ntuser.dat (XP /2003) , or c:\users\default\ntuser.dat (Vista))<br />
<br />
Make the needed changes, and done. <br />
<br />
For this to work i need to find the &quot;Default User&quot; which depending on language and OS might be totally different :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">22nd December 2008, 10:51</div></div><div class="posttext">if you call SHGetFolderPath with the system plugin, you can pass -1 as the token to get the paths for the &quot;default user&quot; (XP and later MSDN says; http://msdn.microsoft.com/en-us/library/bb762181(VS.85).aspx ) on NT4/2000 you can find the path and folder name in HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList , on 9x I don't know, might be in the registry or a .ini file somewhere, search around (not sure if it can change on 9x or if you even care)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">xbarns</div><div class="date">22nd December 2008, 11:18</div></div><div class="posttext">I only care for XP and later, may i ask you for an example on how to use this? <br />
<br />
I looked at the msdn page you provided but to be honest i cannot make anything of it :)<br />
<br />
I guess System::SHGetFolderPath &quot;-1&quot; will not do it.....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">22nd December 2008, 11:41</div></div><div class="posttext">!define CSIDL_APPDATA 0x001a <br />
!define CSIDL_PROFILE 0x0028<br />
System::Call 'shell32::SHGetFolderPath(i $HWNDPARENT,i ${CSIDL_PROFILE},i -1,i 0,t.r0)i.r1'<br />
DetailPrint &quot;$1=$0&quot;</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>