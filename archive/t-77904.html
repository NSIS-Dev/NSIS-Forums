<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Search path functions, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Search path functions NSIS Discussion" />
	
	<title> Search path functions [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Search path functions</div>
<hr />
<div class="pda"><a href="t-77904.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=77904">Search path functions</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st March 2002, 18:27</div></div><div class="posttext">Hi!<br />
<br />
I have written some functions for adding/removing directories from the search path of Windows. They work for NT (without restart) and 9x.<br />
<br />
I will be happy to see them in the functions.html file or contrib folder so they can help others but me :D<br />
<br />
KiCHiK</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbareis</div><div class="date">2nd March 2002, 00:07</div></div><div class="posttext">Hi,<br />
<br />
Some (possibly only older editors) can put EOF characters into the file, in which case the approach you use will fail (as your &quot;SET&quot; would never get executed).<br />
<br />
Just a warning,<br />
Dennis</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd March 2002, 11:26</div></div><div class="posttext">Thanks Dennis!<br />
<br />
After looking in the code again, I have found out that somehow some old code got into it. I have now attached the newest code from my installer script with (I hope) all of the corrections needed.<br />
<br />
Please download this version instead of the earlier one.<br />
<br />
About your comment, I don't really understand what you mean. Do these editors put EOF in the middle of the file? If so, how else can I seek for the EOF?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbareis</div><div class="date">2nd March 2002, 23:35</div></div><div class="posttext">Originally posted by kichik <br />
<br />
<br />
About your comment, I don't really understand what you mean. Do these editors put EOF in the middle of the file? If so, how else can I seek for the EOF? <br />
<br />
In the good old days editors added a special EOF character (stupid but true) to files (the reason for the /A /B switches on a copy command), most (all?) programs (including Windows reading autoexec.bat etc) still stop reading at the EOF character.<br />
<br />
From memory the EOF character was decimal 26, if I'm wrong then it was 27.<br />
<br />
I don'y know how common this would be but I have seen this myself so I know it does happen (I tried to do exactly what your code does).<br />
<br />
Bye,<br />
Dennis</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superrock</div><div class="date">3rd March 2002, 14:52</div></div><div class="posttext">Hi,<br />
<br />
Thanks for posting the path script. It would be helpful for me to get also the source for RefreshEnv or if you could explain what exactly it contains (Api call)<br />
<br />
Greetings,<br />
Andreas<br />
:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd March 2002, 20:44</div></div><div class="posttext">Here is the API function called:<br />
<br />
DWORD dwReturnValue;<br />
SendMessageTimeout(HWND_BROADCAST, WM_SETTINGCHANGE, 0, (LPARAM) &quot;Environment&quot;, SMTO_ABORTIFHUNG, 5000, &amp;dwReturnValue);<br />
<br />
KiCHiK</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superrock</div><div class="date">3rd March 2002, 23:08</div></div><div class="posttext">Thanks kichik,<br />
<br />
Will implement the function in an exe.<br />
<br />
Greetings,<br />
Andreas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GGamer</div><div class="date">18th April 2003, 01:08</div></div><div class="posttext">Kichik,<br />
<br />
I have looked at your zip file and the archive example on sourgefourge. It is almost exactly what I am looking for. In both cases you change HKLU\Enviorment Path Key (which is for the logedon user). But in my case I want to append the path for all the users, HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment\ Path key (As far as I know this is the right key). I have modified your code to change this key instead. It does append the path, but it seems to fix the %SystemRoot% to a string instead of a variable, eg (in dos)<br />
<br />
Before addation:<br />
<br />
path=c:\winnt\system\;c:\winnt\<br />
<br />
After addition of c:\foo<br />
path=%SystemRoot%;%SystemRoot%\system;c:\foo<br />
<br />
Do you have any suggestions?<br />
<br />
Thanks,<br />
<br />
Ross</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th April 2003, 01:17</div></div><div class="posttext">Use WriteRegExpandStr instead of WriteRegStr and it should keep the variables.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GGamer</div><div class="date">18th April 2003, 22:53</div></div><div class="posttext">Thanks, works a treat!<br />
<br />
Ross</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scarletbow</div><div class="date">3rd December 2003, 18:19</div></div><div class="posttext">I am using Windows XP and when I uninstall everthing seems to work fine.  When I check the path it looks ok, but when I try to type in commands that were accessible in my path I can't.  Has anybody had this problem yet?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">14th February 2007, 12:25</div></div><div class="posttext">Lately i used this function:<br />
http://nsis.sourceforge.net/Path_Manipulation<br />
<br />
But i had to set timeout=1000 otherwise my explorer will crash badly<br />
(tried several installations/deinstallations with it)<br />
SendMessage ${HWND_BROADCAST} ${WM_WININICHANGE} 0 &quot;STR:Environment&quot; /TIMEOUT=5000<br />
<br />
HTH</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th February 2007, 19:51</div></div><div class="posttext">If Explorer itself crashes, you probably have some rouge shell extension.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">18th February 2007, 01:22</div></div><div class="posttext">no - my system works fine. and the crash happend when opening START - Programs - &lt;subfolder&gt;, not anywhere else.<br />
It exactly happend when i set timout=5000 and right after the (de-)installation (both concerned).<br />
i can do vice versa many times without reboot...<br />
BTW the system timeout here is set to 5000 instead windows default 20000 (all values in milli seconds).<br />
<br />
it was this line which crashes my explorer (explorer + task bar/desktop). <br />
It was added to the script which works well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th February 2007, 20:11</div></div><div class="posttext">Fine, then it's not a rouge shell extension.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">21st February 2007, 19:55</div></div><div class="posttext">finally i will see when user is using the installer - but till<br />
now no negative feedback (ok i build it in as an option). thx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">didava</div><div class="date">12th July 2007, 11:04</div></div><div class="posttext">trojan &gt;&gt; RefreshEnv.exe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th July 2007, 17:27</div></div><div class="posttext">False positive. Anyway, the SendMessage solution is simpler.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>