<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to read version resource from the exe file, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to read version resource from the exe file NSIS Discussion" />
	
	<title> How to read version resource from the exe file [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to read version resource from the exe file</div>
<hr />
<div class="pda"><a href="t-314555.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=314555">How to read version resource from the exe file</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bubunia2000</div><div class="date">12th November 2009, 17:56</div></div><div class="posttext">Hi all,<br />
   I read the NSIS documentation and found that we can add version tab to the generated EXE(VIAddVersionKey). If the installer wants to read the product version while installing to check whether that product version is already installed or not. Can it be possible in NSIS?<br />
<br />
Cheers<br />
Pradeep</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">12th November 2009, 18:36</div></div><div class="posttext">Easiest way is to write your version number to registry during install.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bubunia2000</div><div class="date">12th November 2009, 19:38</div></div><div class="posttext">The reason Iam asking this way is I want when the exe is launched for installation I can query the registry whether the previous version exits or not in the registry. If it exists it will uninstall the earlier version and install the new instal else it will warn the user. So I need to know the &quot;version info&quot; prior the the launch of exe.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">12th November 2009, 20:18</div></div><div class="posttext">I would suggest you make a !define at the top of your installer script. That way you can use the define everywhere (to compare to, and to write to the registry upon install), and when you compile a new version you only need to change the actual versionnumber once.<br />
<br />
Example:<br />
<br />
!define VERSIONNUM 3.1<br />
<br />
Section<br />
  WriteRegStr HKCU &quot;Software\YourCompany\YourApp&quot; &quot;VersionNumber&quot; ${VERSIONNUM}<br />
SectionEnd<br />
<br />
<br />
At the beginning of the first section, read the version number from registry and compare it to ${VERSIONNUM}. If it's different, uninstall the previous version.<br />
<br />
You can also use the VersionCompare function (see the wiki/google), to determine whether the previous install is a newer or an older version (in the .onInit function, for example).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">13th November 2009, 16:53</div></div><div class="posttext">You can read the version of an executable using GetDLLVersion (it works for exe files with version resource too)<br />
<br />
from the manual with some modifications:<br />
GetDllVersion &quot;$EXEPATH&quot; $R0 $R1<br />
IntOp $R2 $R0 / 0x00010000<br />
IntOp $R3 $R0 &amp; 0x0000FFFF<br />
IntOp $R4 $R1 / 0x00010000<br />
IntOp $R5 $R1 &amp; 0x0000FFFF<br />
StrCpy $0 &quot;$R2.$R3.$R4.$R5&quot;<br />
<br />
this should give in $0 the version of the installer <br />
hope this helps<br />
  Stefano</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>