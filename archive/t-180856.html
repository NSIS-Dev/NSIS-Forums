<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" New System documentation, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  New System documentation NSIS Discussion" />
	
	<title> New System documentation [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  New System documentation</div>
<hr />
<div class="pda"><a href="t-180856.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=180856">New System documentation</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd May 2004, 16:22</div></div><div class="posttext">As I've promised Brainsucker I would do, too long ago, I have finally rewritten the System plug-in documentation. It is now in HTML with lots of examples. It is not yet complete, but it's ready for reading. You can find it at:<br />
<br />
http://nsis.sourceforge.net/System.html<br />
<br />
Comments are welcome.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pompo500</div><div class="date">22nd May 2004, 20:05</div></div><div class="posttext">Good job, kichik.<br />
<br />
I have one quick question though, can you get the primary ISO language code with NSIS?<br />
<br />
edit: nevermind (HKEY_CURRENT_USER\Control Panel\International\sLanguage)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">22nd May 2004, 23:24</div></div><div class="posttext">kichik, try to make as I did with some of my Archive pages. Because if I would read by the first impression the [/SIZE] parameter of System::Copy, I would think it's an optional, fixed parameter. Try to put as this structure below:<br />
<br />
String - Required fixed parameter, can't be changed.<br />
&quot;String&quot; - Required changeable parameter, generally you put as said by its name.<br />
(String|String2) - Required, one choice fixed parameters.<br />
(&quot;String&quot;|&quot;String2&quot;) - Required, one choice changeable parameters.<br />
[String] - Optional, fixed parameter.<br />
[&quot;String&quot;] - Optional, changeable parameter.<br />
[String|String2] - Optinal, one choice fixed parameters.<br />
[&quot;String&quot;|&quot;String2&quot;] - Optinal, one choice changeable parameters.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th May 2004, 11:23</div></div><div class="posttext">But it is, as the text just below it says, optional. As for fixed parameter, the examples and the text says it's not. I prefer having the meaning on the syntax line and not the type.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th June 2004, 13:54</div></div><div class="posttext">FAQ section added. Currently it only has a question about handling structures. What other questions would you like see?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">4th June 2004, 15:56</div></div><div class="posttext">Finally :)<br />
btw, FAQ section rocks. Now the callbacks section will rock too (your example works fine, Kichik :)<br />
<br />
bug-fix-release, 4.06.2004<br />
1. System::Copy /SIZE fixed (Kichik).<br />
2. System::Copy with destination auto-allocation now pushes destination<br />
address on stack.<br />
3. Callbacks fixed (Kichik's kick is awesome).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th June 2004, 16:23</div></div><div class="posttext">Thanks! :)<br />
<br />
Uploaded. New documentation will be uploaded once the callback information is updated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th June 2004, 17:27</div></div><div class="posttext">OK, new documentation is up on CVS. A copy is still available at the above address.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">4th June 2004, 22:38</div></div><div class="posttext">4. Bug with proc call parts redefinition, # for example (pointed by Kichik).<br />
5. Bug with memory protection during callback processing (Kichik).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fredtheman</div><div class="date">8th June 2004, 17:19</div></div><div class="posttext">BTW, I haven't checked the latest and greatest, but it'd be very nice if someone added a section on how to call COM servers using the System plug-in.<br />
<br />
Fred.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th June 2004, 19:01</div></div><div class="posttext">What would you add on top of what's already there?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fredtheman</div><div class="date">11th June 2004, 09:01</div></div><div class="posttext">&gt;&gt;What would you add on top of what's already there?<br />
<br />
I just took a look, and all there is to read is a tiny example with no comment in the &quot;Usage Examples&quot; of the document. I guess I'm not the only one coming from the VB world, so I could use a bit more info on how to call COM servers from NSIS :-)<br />
<br />
Fred.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th June 2004, 10:20</div></div><div class="posttext">Have you read the notes? Have you read the possible PROC values?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fredtheman</div><div class="date">14th June 2004, 15:53</div></div><div class="posttext">&gt;&gt;Have you read the notes? Have you read the possible PROC values?<br />
<br />
I'm sorry, you lost me. I looked for a bit of explanation on how to use the System plug-in to work with COM servers at the following locations, but found nothing usable for someone who is only use to COM through VB. Should I look elsewhere on the site?<br />
<br />
1. system_bugfix.zip<br />
2. 10.zip<br />
3. http://nsis.sourceforge.net/System.html<br />
(scroll down to Calling Functions -&gt; Notes and Usage Examples)<br />
<br />
If that all there is, I guess I'll have to read on how to work with COM servers from a C++ point of view, since this is just too short an example when coming from the VB world. Nice work anyway :-)<br />
<br />
Thx<br />
Fred.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th June 2004, 17:51</div></div><div class="posttext">Notes contains:To find out the index of a member in a COM interface, you need to search for the definition of this COM interface in the header files that come with Visual C/C++ or the Platform SDK. Remember the index is zero based.Possible PROC values and Meanings contains:IPTR-&gt;IDX -- Member indexed IDX from interface pointed by IPTR -- see below (example link)Do you think it deserves more than that, like callbacks?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fredtheman</div><div class="date">18th June 2004, 21:21</div></div><div class="posttext">I guess it makes perfect sense for people quite knowledgeable with COM and C++, but I doubt any VB user for instance can figure out how to call any COM server from NSIS without a bit more infos on how those things work at that level, eg. how to find the list of interfaces from a non-MS server, eg.<br />
<br />
Don't get me wrong, the System plug-in is very very useful, but it's just a bit cryptic for those not familiar with Win32 :-)<br />
<br />
Fred.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th June 2004, 22:07</div></div><div class="posttext">I assume you're refering to stuff like:s = GetObject(&quot;Something.Something&quot;)<br />
s.something()Took me a while to find it, but it's done with CLSIDFromProgID. It takes a string and returns a CLSID which can then be used with CoCreateInstance as in the example. Getting a bit complicated I guess... I better create a section for it, after I learn some more about it :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th June 2004, 23:51</div></div><div class="posttext">Ouch...# defines<br />
!define CLSCTX_ALL 23<br />
!define IID_IUnknown {00000000-0000-0000-C000-000000000046}<br />
!define IID_IDispatch {00020400-0000-0000-C000-000000000046}<br />
!define IID_NULL {00000000-0000-0000-0000-000000000000}<br />
<br />
!define DISPATCH_METHOD         1<br />
!define DISPATCH_PROPERTYGET    2<br />
!define DISPATCH_PROPERTYPUT    4<br />
!define DISPATCH_PROPERTYPUTREF 8<br />
<br />
!define DISPPARAMS (i,i,i,i)<br />
<br />
# get CLSID<br />
System::Call &quot;ole32::CLSIDFromProgID(w 'Shell.Application', \<br />
	g .r0) i.r1&quot;<br />
DetailPrint &quot;Shell.Application CLSID - $0&quot;<br />
DetailPrint &quot;CLSIDFromProgID - $1&quot;<br />
<br />
# create IActiveDesktop interface<br />
System::Call &quot;ole32::CoCreateInstance(g r0, i 0, \<br />
	i ${CLSCTX_ALL}, g '${IID_IDispatch}', *i .r0) i.r1&quot;<br />
DetailPrint &quot;IDispatch - $0&quot;<br />
DetailPrint &quot;CoCreateInstance - $1&quot;<br />
<br />
# call IUnknown-&gt;QueryInterface, get IDispatch<br />
#System::Call &quot;$0-&gt;0(g ${IID_IDispatch}, *i r2) i.r1&quot;<br />
#DetailPrint $2<br />
#DetailPrint $1<br />
<br />
# call IDispatch-&gt;GetIDsOfNames<br />
System::Call &quot;$0-&gt;5(g ${IID_NULL}, *w 'MinimizeAll', \<br />
	i 1, i 0, *i r2r2) i.r1&quot;<br />
DetailPrint &quot;MinimizeAll - $2&quot;<br />
DetailPrint &quot;GetIDsOfNames - $1&quot;<br />
<br />
# create arguments<br />
System::Call &quot;*${DISPPARAMS}(0, 0, 0, 0)i.R0&quot;<br />
DetailPrint &quot;Allocate DISPPARMS - $R0&quot;<br />
<br />
# call IDispatch-&gt;Invoke<br />
System::Call &quot;$0-&gt;6(i r2, g ${IID_NULL}, i 0, \<br />
	i ${DISPATCH_METHOD}, i R0, i 0, i 0, i 0) i.r1&quot;<br />
DetailPrint &quot;Invoke - $1&quot;<br />
<br />
# call IDispatch-&gt;Release<br />
System::Call &quot;$0-&gt;2() i.r1&quot;<br />
DetailPrint &quot;Release - $1&quot;And that's without any parameters passed to the method...<br />
<br />
Wasn't as simple as I thought it'd be :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gfm688</div><div class="date">7th January 2011, 09:26</div></div><div class="posttext">!define CLSID_Shell {13709620-C279-11CE-A49E-444553540000}<br />
!define IID_IShellDispatch {D8F015C0-C278-11CE-A49E-444553540000}<br />
<br />
Section<br />
System::Call Ole32::CoCreateInstance(g'${CLSID_Shell}',i0,i1,g'${IID_IShellDispatch}',*i.r0)i.r1<br />
StrCmp $1 0 0 end<br />
# call IShellDispatch-&gt;MinimizeAll<br />
System::Call &quot;$0-&gt;14()&quot;<br />
# call IShellDispatch-&gt;Release<br />
System::Call &quot;$0-&gt;2()&quot;<br />
end:<br />
SectionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>