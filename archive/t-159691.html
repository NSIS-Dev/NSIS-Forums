<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" All User script, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  All User script NSIS Discussion" />
	
	<title> All User script [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  All User script</div>
<hr />
<div class="pda"><a href="t-159691.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=159691">All User script</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Bill Halpern</div><div class="date">14th December 2003, 17:59</div></div><div class="posttext">I am a brand new user to NSIS.  Love it. <br />
<br />
1. I am having somewhat of a problem. I have created a simple install script using the HMNIS editor.  It works great but only for the currently logged on user. How do I set it to work for All Users of the machine?<br />
<br />
2. Is there any way to set the Start in Directory of the created shortcuts?<br />
<br />
Remember, I am a real novice at this. Please help.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">14th December 2003, 18:07</div></div><div class="posttext">SetContextVar it's your friend :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bill Halpern</div><div class="date">14th December 2003, 18:11</div></div><div class="posttext">Originally posted by Lobo Lunar <br />
SetContextVar it's your friend :)  <br />
<br />
I am a non-programmer and don't understand what you mean here. Could you give me some more details?<br />
<br />
Thank You</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">14th December 2003, 18:21</div></div><div class="posttext">I read again your question. I thought you were talking about installation. Sorry...<br />
Let's start again... about the users.... you must have enable &quot;all users&quot; to do this....must be apply for the currently user of your NT machine...<br />
About the shortcut... I don't understand the Is there any way to set the Start in Directory of the created shortcuts<br />
Do you ment open the folder where the shorcuts were created? If so check the ShellExec instructions of the manual...<br />
HIH (Hope it helps)!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bill Halpern</div><div class="date">14th December 2003, 18:52</div></div><div class="posttext">Originally posted by Lobo Lunar <br />
I read again your question. I thought you were talking about installation. Sorry...<br />
Let's start again... about the users.... you must have enable &quot;all users&quot; to do this....must be apply for the currently user of your NT machine...<br />
About the shortcut... I don't understand the Is there any way to set the Start in Directory of the created shortcuts<br />
Do you ment open the folder where the shorcuts were created? If so check the ShellExec instructions of the manual...<br />
HIH (Hope it helps)!!!  <br />
<br />
Thank you for your patience with me. One more time. I want to be able to do this easily if possible using the script editor. I have created a script that does the install but only puts the shortcuts on the current users desktop.<br />
<br />
I don't know what you mean by &quot;enable all users to do this.&quot; Where do I do this? When I run the install program I want the user to be able to answer whether he wants this to be installed for just the current user or all users. Can you be more specific?<br />
<br />
Thank you again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th December 2003, 20:57</div></div><div class="posttext">SetShellVarContext:Sets the context of $SMPROGRAMS and other shell folders. If set to 'current' (the default), the current user's shell folders are used. If set to 'all', the 'all users' shell folder is used. The all users folder may not be supported on all OSes.You can use it to tell NSIS to put the shortcut on the all users' desktop instead of just on the current user's desktop.<br />
<br />
For example:SetShellVarContext all<br />
CreateShortcut $DESKTOP\MyProg.lnk $INSTDIR\MyProg.exe<br />
<br />
If you want to give the user an option you can create an InstallOptions page to get the user's input. See Examples\Modern UI\InstallOptions.nsi for an example and Contrib\InstallOptions\Readme.html for the documentation.<br />
<br />
To set the working directory of shortcuts use SetOutPath. For example:SetOutPath &quot;C:\working\directory\for\the\shortcut&quot;<br />
CreateShortcut $DESKTOP\MyProg.lnk $INSTDIR\MyProg.exe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bill Halpern</div><div class="date">14th December 2003, 21:09</div></div><div class="posttext">Originally posted by kichik <br />
SetShellVarContext:You can use it to tell NSIS to put the shortcut on the all users' desktop instead of just on the current user's desktop.<br />
<br />
For example:SetShellVarContext all<br />
CreateShortcut $DESKTOP\MyProg.lnk $INSTDIR\MyProg.exe<br />
<br />
If you want to give the user an option you can create an InstallOptions page to get the user's input. See Examples\Modern UI\InstallOptions.nsi for an example and Contrib\InstallOptions\Readme.html for the documentation.<br />
<br />
To set the working directory of shortcuts use SetOutPath. For example:SetOutPath &quot;C:\working\directory\for\the\shortcut&quot;<br />
CreateShortcut $DESKTOP\MyProg.lnk $INSTDIR\MyProg.exe  <br />
<br />
Thank You!  This is just what I needed.  Consider yourself a savior of a neophyte!!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>