<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" /S = /s = /silent, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  /S = /s = /silent NSIS Discussion" />
	
	<title> /S = /s = /silent [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  /S = /s = /silent</div>
<hr />
<div class="pda"><a href="t-148124.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=148124">/S = /s = /silent</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">timecop12</div><div class="date">4th September 2003, 18:28</div></div><div class="posttext">Hi,<br />
<br />
I want to change the $CMDLINE from /s or /silent to<br />
/S for the real silent install. It's not really my problem, but some users use /s instead /S and the installer should fix this.<br />
<br />
I try this, but it don't works:<br />
<br />
Function .onInit<br />
         <br />
         goto nach_typ_silent<br />
           <br />
           typ_silent:<br />
           StrCpy $CMDLINE /S<br />
           <br />
          nach_typ_silent:<br />
<br />
           Call GetParameters<br />
           Pop $0<br />
           StrCmp $0 &quot;/S&quot; end_function<br />
           StrCmp $0 &quot;/silent&quot; typ_silent<br />
           StrCmp $0 &quot;/s&quot; typ_silent<br />
           StrCmp $0 &quot;/a&quot; end_function<br />
           StrCmp $0 &quot;/anything&quot; end_function<br />
           StrCmp $0 &quot;-offline&quot; end_function<br />
           StrCmp $0 &quot;-online&quot; end_function<br />
          ; !define UPDATEUI_CMDLINE $0<br />
          ; Exec &quot;My_Install_Package.exe /S&quot;<br />
    MessageBox MB_OK|MB_ICONEXCLAMATION &quot;Unzul√§ssiger Programmstart!&quot;<br />
           Abort<br />
<br />
           end_function:<br />
<br />
FunctionEnd<br />
<br />
<br />
Thanks.<br />
<br />
-timecop</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th September 2003, 18:31</div></div><div class="posttext">NSIS doesn't read the command line after .onInit, only before it. In the next CVS version you will be able to use SetSilent to do the same (already available in the newstuff version).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">timecop12</div><div class="date">4th September 2003, 18:50</div></div><div class="posttext">Wonderful, thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">4th September 2003, 20:57</div></div><div class="posttext">&gt;&gt; NSIS doesn't read the command line after .onInit<br />
<br />
where else then?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th September 2003, 21:11</div></div><div class="posttext">Just before.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">5th September 2003, 01:12</div></div><div class="posttext">.onGUIinit or so?<br />
<br />
i dont know so i asked<br />
<br />
.oninit is for me the first section executed on startup.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th September 2003, 11:02</div></div><div class="posttext">.onGUIInit comes after .onInit, it's before that too. .onInit is the first script code executed, but it's certainly not the first thing the installer does. Lots of stuff have to be initialized before .onInit will be useable, including the command line processing. Take $INSTDIR for example. You depend on $INSTDIR to be initalized in .onInit but it can be changed by the command line, InstallDir and InstallDirRegKey. All three of those have to be checked to make sure the directory is valid too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">5th September 2003, 18:28</div></div><div class="posttext">&lt;confused&gt;<br />
<br />
i know some settings before .oninit is used.<br />
<br />
For that script at the beginning of this topic - i just have to put a &quot;CALL ...&quot; somewhere near &quot;Installdir '...'&quot; or so?<br />
<br />
<br />
!define MUI_PRODUCT &quot;my xxx&quot;<br />
!define MUI_VERSION &quot;1.0&quot;<br />
!define MUI_ICON &quot;x.ico&quot;<br />
!define MUI_UNICON &quot;x.ico&quot;<br />
<br />
!include &quot;MUI.nsh&quot; ;important for the new MUI<br />
!include &quot;Sections.nsh&quot; ;important for section select or deselect<br />
<br />
!define TEMP1 $R1<br />
!define TEMP2 $R2<br />
!define TEMP3 $R3<br />
!define TEMP4 $R4<br />
 <br />
;--------------------------------<br />
;Configuration<br />
<br />
  ;General<br />
  OutFile &quot;xxx.exe&quot;<br />
  InstallDir &quot;$PROGRAMFILES\${MUI_PRODUCT}&quot;<br />
<br />
CALL ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th September 2003, 19:59</div></div><div class="posttext">I'm sorry, I don't understand... Call what? What does this has to do with silent installation? What does it has to do with defines?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">5th September 2003, 21:33</div></div><div class="posttext">damn<br />
<br />
so i ask other way:<br />
<br />
how do i initiate a /S (silent) installation in script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">5th September 2003, 21:35</div></div><div class="posttext">SetSilent</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th September 2003, 21:35</div></div><div class="posttext">Use SilentInstall/SilentUninstall if you want it to always be silent. Use the latest CVS version and SetSilent if you want it to be silent according to some check you'd preform on runtime.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">5th September 2003, 22:52</div></div><div class="posttext">hmm<br />
<br />
&gt;&gt; all sections that have the SF_SELECTED flag are installed quietly <br />
<br />
So the panes with path and other stuff will processed silent too? (no input/no output)<br />
<br />
but what have i to do when i asks this flag (/S) manually in .onInit?<br />
<br />
When do i need $CMDLINE or how can i turn left while &quot;not silent&quot; is right?<br />
<br />
The idea behind is that i have a program with own panes (from IO) and i dont want to create routines twice when i am able to do the silent way in same program.<br />
<br />
i hope this was not to complicated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th September 2003, 22:59</div></div><div class="posttext">I hope I understand what you're asking, tell me if I'm way off.<br />
<br />
The /S command line switch is process by NSIS, you don't need to process it alone.<br />
<br />
To automatically fill in information that you get from InstallOptions in non-silent mode you shuold use IfSilent. If the installation is silent you should of course supply defaults. If you want you can also process $CMDLINE, allowing the user to provide input on the command line.<br />
<br />
You can also use &quot;SetSilent normal&quot; in .onInit to prevent the installer from being silent.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">5th September 2003, 23:12</div></div><div class="posttext">hmm again ;)<br />
<br />
;Modern UI Configuration<br />
<br />
page custom selectaction<br />
<br />
page custom save01<br />
page custom save02<br />
page custom save03<br />
page custom save04<br />
page custom save05<br />
<br />
;page custom restore01<br />
;page custom restore02<br />
;page custom restore03<br />
;page custom restore04<br />
<br />
This is what i have so far.<br />
<br />
Saving routines are working but they have user-input (options to save different files and folder input).<br />
<br />
Default is all files ticked and folder (if not given) from registry.<br />
<br />
All settings are saved in a ini-file.<br />
<br />
with a silent install i have to bypass the user-input like this:<br />
<br />
page custom save01<br />
page custom save01_silent<br />
<br />
So &quot;save01&quot; compares if a silent flag has been set and skips while &quot;save01_silent&quot; skips not.<br />
<br />
i hope i made clear why i am asking where *before* .onInit the decision is made.<br />
<br />
if &quot;/S&quot; is the only flag for a silent setup i would use &quot;/s&quot; (lower case) or &quot;/silent&quot; (from example on top) and $CMDLINE to differentiate (what a word - to differ?) the way it goes.<br />
<br />
thank you for your patience :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th September 2003, 23:20</div></div><div class="posttext">Page functions won't be called on a silent installation. You should probably add something like this to your first section or .onInit:<br />
<br />
IfSilent 0 notSilent<br />
  Call save01_silent<br />
  Call save02_silent<br />
notSilent:<br />
<br />
I still don't understand why you want to know where before .onInit /S is processed. How can it help you? It's in Source\exehead\Main.c line 111.<br />
<br />
if &quot;/S&quot; is the only flag for a silent setup i would use &quot;/s&quot; (lower case) or &quot;/silent&quot; (from example on top) and $CMDLINE to differentiate (what a word - to differ?) the way it goes. <br />
<br />
Do you want to add those switches on top what NSIS already processes? If so, simply use this in .onInit:<br />
<br />
Call GetParameters<br />
Pop $0<br />
StrCmp $0 &quot;/s&quot; silent<br />
StrCmp $0 &quot;/silent&quot; silent<br />
Return<br />
silent:<br />
  SetSilent silent<br />
<br />
Note that StrCmp is case insensitive and that this will not work if the user specifies more than one swtich (for example: myinstaller.exe /silent /D=C:\Program Files\InstDir). To make it work with more than one switch use StrStr. You can find it in the manual.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">5th September 2003, 23:58</div></div><div class="posttext">Call GetParameters<br />
Pop $0<br />
StrCmp $0 &quot;/s&quot; silent<br />
StrCmp $0 &quot;/silent&quot; silent<br />
Return<br />
silent:<br />
  SetSilent silent<br />
<br />
<br />
IfSilent 0 notSilent<br />
;silent stuff<br />
notSilent:<br />
<br />
i think this is the solution for my problem - thank you very much.<br />
<br />
BTW are we talking about this GetParameters from Appendix_B ?<br />
<br />
 ; GetParameters<br />
 ; input, none<br />
 ; output, top of stack (replaces, with e.g. whatever)<br />
 ; modifies no other variables.<br />
<br />
 Function GetParameters<br />
   Push $R0<br />
   Push $R1<br />
   Push $R2<br />
   StrCpy $R0 $CMDLINE 1<br />
   StrCpy $R1 '&quot;'<br />
   StrCpy $R2 1<br />
   StrCmp $R0 '&quot;' loop<br />
     StrCpy $R1 ' ' ; we're scanning for a space instead of a quote<br />
   loop:<br />
     StrCpy $R0 $CMDLINE 1 $R2<br />
     StrCmp $R0 $R1 loop2<br />
     StrCmp $R0 &quot;&quot; loop2<br />
     IntOp $R2 $R2 + 1<br />
     Goto loop<br />
   loop2:<br />
     IntOp $R2 $R2 + 1<br />
     StrCpy $R0 $CMDLINE 1 $R2<br />
     StrCmp $R0 &quot; &quot; loop2<br />
   StrCpy $R0 $CMDLINE &quot;&quot; $R2<br />
   Pop $R2<br />
   Pop $R1<br />
   Exch $R0<br />
 FunctionEnd<br />
<br />
<br />
------------------------------------<br />
<br />
&gt;&gt; I still don't understand why you want to know where before .onInit /S is processed.<br />
<br />
The problem for me was to understand that NSIS uses /S internal and skips sections silent. This i meant with &quot;before&quot;. i thought it can be used manually before .onInit is used. :igor:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th September 2003, 09:19</div></div><div class="posttext">Yes, this is the GetParameters we are talking about.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>