<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstall on shutdown, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstall on shutdown NSIS Discussion" />
	
	<title> Uninstall on shutdown [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstall on shutdown</div>
<hr />
<div class="pda"><a href="t-286355.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=286355">Uninstall on shutdown</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">os00</div><div class="date">5th February 2008, 21:43</div></div><div class="posttext">Hi<br />
<br />
I need to run uninstall on shut down, log off etc. Currently I have C++ application which calls CreateProcess winapi function after it receives WM_QUERYENDSESSION message, but this doesn't work. CreateProcess returns TRUE, but nothing happens really (and I tried it also with other programs). Is there any way how to run uninstall when user is trying to shut down ?<br />
<br />
Thank you<br />
<br />
os00</div></div><hr />


<div class="post"><div class="posttop"><div class="username">robbynaze</div><div class="date">6th February 2008, 08:36</div></div><div class="posttext">this is not really nsis discussion ...<br />
<br />
anyway, just try to create a &quot;shutdown&quot; folder in &quot;start menu/programs&quot; and create a shortcut to your App ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">6th February 2008, 08:48</div></div><div class="posttext">os00: do you return 0 for WM_QUERYENDSESSION to cancel the shutdown? If not, at some point in the shutdown cycle, it is no longer possible to start new processes. If you need Vista support, you should use ShutdownBlockReasonCreate aswell. But this is not really nsis related, and it is a very strange thing to do. See http://msdn2.microsoft.com/en-us/library/bb394721(VS.85).aspx for more<br />
<br />
robbynaze: wtf are you talking about?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">robbynaze</div><div class="date">6th February 2008, 11:06</div></div><div class="posttext">Is there any way how to run uninstall when user is trying to shut down ? <br />
i understood that Anders wanted to run some stuff at shutdown<br />
<br />
i simply forgot to add following link to HSLAB Shutdown Folder (http://www.softarea51.com/windows/System_Utilities/Launchers_Task_Managers/Review-HSLAB_Free_Shutdown_Folder.html), this little application let you to create a folder &quot;shutdown&quot; (such as Start) in StartMenu/programs, you just add the programs you want to run when User's trying to shut down<br />
<br />
it was just a different solution to its question without any C++ coding ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">6th February 2008, 15:08</div></div><div class="posttext">That link to the software for a Shutdown folder looks interesting, but os00 may not be willing to add the cost to his product -- each copy he distributes will need a business license which costs $50 each.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>