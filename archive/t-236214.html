<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Codec pack installer?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Codec pack installer? NSIS Discussion" />
	
	<title> Codec pack installer? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Codec pack installer?</div>
<hr />
<div class="pda"><a href="t-236214.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=236214">Codec pack installer?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Nabukodonosor</div><div class="date">23rd January 2006, 13:48</div></div><div class="posttext">Ok, here the idea. You can see the picture bellow. First 3 items are irrelevant. The Graphs item is the issue. It should extract graph files for the applications MyTheatre, ProgDVB and Skyview. So, when I select ProgDVB and BlazeVideo codec for example, when I click on the Install button bellow, I should be asked for the ProgDVB plugins folder so the installation can extract graph files there. If I choose both ProgDVB and MyTheatre for example, I should be asked for plugins folder for both the ProgDVB AND MyTheatre.<br />
<br />
Just to mention, the first 3 items go to my $INSTDIR, i.e. C:\Program Files\My codec pack\. So this goes here, a for the graphs items I need to choose the location.<br />
<br />
How to do this?<br />
<br />
http://img63.imageshack.us/img63/2748/pack7il.jpg</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">23rd January 2006, 13:57</div></div><div class="posttext">add a userpage with all needed directory requests, and enable/disable them depending on the selection.<br />
you can do this in the SHOW function of the custom page.<br />
<br />
see modernui readme and installoptions readme for details about creating custom pages with modern ui.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nabukodonosor</div><div class="date">23rd January 2006, 14:34</div></div><div class="posttext">OK, i'll try to make this right. Thanks m8!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nabukodonosor</div><div class="date">23rd January 2006, 16:17</div></div><div class="posttext">OK, here's the thing. I don't know where to start with questions.<br />
1. On the picture bellow you can see that when I select some  random way installation folder (C:\1) it adds the Nabukodonosor's DVB pack on it. And i don't want that. Here is my part of the script for that thing:<br />
<br />
Section &quot;BlazeVideo/Moonlight/Overlay&quot; SEC55<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  File &quot;Graphs\ProgDVB\tv.blazevideo.xgr&quot;<br />
SectionEnd<br />
<br />
How to avoid this addon?<br />
<br />
2.On the first picture, I want to install first 3 items in the exactly specified folder (C:\Program Files\Nabukodonosor's DVB Pack). But when I select the installation folder for my graph files (2nd picture), my first 3 item ALSO ectract in the selected folder. And I don't want that either. So, my scipt for that right now is like this:<br />
Section &quot;Blaze Video Decoder 4.5.0.2&quot; SEC02<br />
  SetOutPath &quot;$INSTDIR\Video\Blaze Video Decoder 4.5.0.2&quot;<br />
  File &quot;Video\Blaze Video Decoder 4.5.0.2\Blaze VideoDecoder.ax&quot;<br />
SectionEnd<br />
<br />
So, I assume I need to change that $INSTDIR into absolute address like C:\Program Files\Nabukodonosor's DVB Pack? Is that right? Is there any other way?<br />
<br />
3. Can you explain me the enable/disable thing you've mentioned? I can't figure that out.<br />
<br />
<br />
<br />
<br />
http://img370.imageshack.us/img370/9981/pack26na.jpg</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nabukodonosor</div><div class="date">24th January 2006, 13:05</div></div><div class="posttext">Anyone?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th January 2006, 18:31</div></div><div class="posttext">Add a backslash to InstallDir. Read about InstallDir in the documentation for more information.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nabukodonosor</div><div class="date">24th January 2006, 20:39</div></div><div class="posttext">I've solved that. Thanks for the solution. I've also solved 2nd problem. What about the 3rd question?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nabukodonosor</div><div class="date">24th January 2006, 20:46</div></div><div class="posttext">One more thing. For example I know that $PROGRAMFILES is C:\Program files. But how to specify only C:\? I want to extract something in f.a. C:\folder1, but what if someone doesn't have C:\ but D:\ or even E:\??? I've solved a similar problem with C:\Program files\some folder with changing it to $PROGRAMFILES\some folder. How to do this with C:\some folder? WHats the equivalent for root folder?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">24th January 2006, 22:42</div></div><div class="posttext">nothing.<br />
<br />
use this one:<br />
<br />
Var /GLOBAL ROOT<br />
StrCpy $ROOT $PROGRAMFILES 0 3<br />
<br />
$ROOT is now C:\ or D:\ or whatever ...<br />
<br />
btw: thanx that you take care of this case!<br />
most software companies don't. some even hardcode &quot;C:\Program Files&quot; and destroy e.g. german file structures (&quot;C:\Programme&quot; by default) with such behaviours.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nabukodonosor</div><div class="date">24th January 2006, 23:24</div></div><div class="posttext">Can you PLEASE explain to me how to do that thing in your first message? The thing with 3 directory selection. I'm stuck with that!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">25th January 2006, 13:27</div></div><div class="posttext">!define MUI_PAGE_CUSTOMFUNCTION_PRE &quot;function1&quot;<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE &quot;function2&quot;<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE &quot;function3&quot;<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
<br />
:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nabukodonosor</div><div class="date">25th January 2006, 16:03</div></div><div class="posttext">OK, i'll try this. Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nabukodonosor</div><div class="date">25th January 2006, 17:18</div></div><div class="posttext">That didn't help me. I'm 5 days in all this, so a need more help. :-( I tried with this article:<br />
http://nsis.sourceforge.net/Two_installations_in_one_installer<br />
but it's for two installations and I need for 3. Also it has one section that's bad for my project:<br />
## Also if no sections are selected, warn the user!<br />
<br />
I've tried to delete that section, but then I got error after error.<br />
Can someone please adapt this code for 3 installation and without this last thing? Or at least explain to me how to do it step by step. There's no other way for me. All the other work is over, only this thing to finish and it's all over. Please guys!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nabukodonosor</div><div class="date">25th January 2006, 19:23</div></div><div class="posttext">OK, i've pulled it off, with the script above, just modified it. BUT, there is a problem. It extracts the Skyview graphs (see the 1st picture) in all 3 folders. I've must mistaken somewhere in the loop. Here's the script (only relevant part):<br />
<br />
## Create $PLUGINSDIR<br />
Function .onInit2<br />
 InitPluginsDir<br />
FunctionEnd<br />
<br />
Function IsPROG1Selected<br />
Push $R0<br />
Push $R1<br />
<br />
 StrCpy $R0 ${PROG1_StartIndex} # Group 1 start<br />
<br />
  Loop:<br />
   IntOp $R0 $R0 + 1<br />
   SectionGetFlags $R0 $R1			# Get section flags<br />
    IntOp $R1 $R1 &amp; ${SF_SELECTED}<br />
    StrCmp $R1 ${SF_SELECTED} 0 +3		# If section is selected, done<br />
     StrCpy $R0 1<br />
     Goto Done<br />
    StrCmp $R0 ${PROG1_EndIndex} 0 Loop<br />
<br />
 Done:<br />
Pop $R1<br />
Exch $R0<br />
FunctionEnd<br />
<br />
Function IsPROG2Selected<br />
Push $R0<br />
Push $R1<br />
<br />
 StrCpy $R0 ${PROG2_StartIndex}    # Group 2 start<br />
<br />
  Loop:<br />
   IntOp $R0 $R0 + 1<br />
   SectionGetFlags $R0 $R1			# Get section flags<br />
    IntOp $R1 $R1 &amp; ${SF_SELECTED}<br />
    StrCmp $R1 ${SF_SELECTED} 0 +3		# If section is selected, done<br />
     StrCpy $R0 1<br />
     Goto Done<br />
    StrCmp $R0 ${PROG2_EndIndex} 0 Loop<br />
<br />
 Done:<br />
Pop $R1<br />
Exch $R0<br />
FunctionEnd<br />
<br />
Function IsPROG3Selected<br />
Push $R0<br />
Push $R1<br />
<br />
 StrCpy $R0 ${PROG3_StartIndex} # Group 3 start<br />
<br />
  Loop:<br />
   IntOp $R0 $R0 + 1<br />
   SectionGetFlags $R0 $R1			# Get section flags<br />
    IntOp $R1 $R1 &amp; ${SF_SELECTED}<br />
    StrCmp $R1 ${SF_SELECTED} 0 +3		# If section is selected, done<br />
     StrCpy $R0 1<br />
     Goto Done<br />
    StrCmp $R0 ${PROG3_EndIndex} 0 Loop<br />
<br />
 Done:<br />
Pop $R1<br />
Exch $R0<br />
FunctionEnd<br />
<br />
## Here we are selecting first sections to install<br />
## by unselecting all the others!<br />
Function SelectFilesA<br />
<br />
 # We need to save the state of the Group 2 Sections<br />
 # for the next InstFiles page<br />
Push $R0<br />
Push $R1<br />
<br />
 StrCpy $R0 ${PROG2_StartIndex} # Group 2 start<br />
<br />
  Loop:<br />
   IntOp $R0 $R0 + 1<br />
   SectionGetFlags $R0 $R1				    # Get section flags<br />
    WriteINIStr &quot;$PLUGINSDIR\sections.ini&quot; Sections $R0 $R1 # Save state<br />
    !insertmacro UnselectSection $R0			    # Then unselect it<br />
    StrCmp $R0 ${PROG2_EndIndex} 0 Loop<br />
<br />
 # Don't install prog 1?<br />
 Call IsPROG1Selected<br />
 Pop $R0<br />
 StrCmp $R0 1 +4<br />
  Pop $R1<br />
  Pop $R0<br />
  Abort<br />
<br />
 # Set current $INSTDIR to PROG1_InstDir define<br />
 StrCpy $INSTDIR &quot;${PROG1_InstDir}&quot;<br />
<br />
Pop $R1<br />
Pop $R0<br />
FunctionEnd<br />
<br />
## Here we need to unselect all Group 1 sections<br />
## and then re-select those in Group 2 (that the user had selected on<br />
## Components page)<br />
Function SelectFilesB<br />
Push $R0<br />
Push $R1<br />
<br />
 StrCpy $R0 ${PROG1_StartIndex}    # Group 1 start<br />
<br />
  Loop:<br />
   IntOp $R0 $R0 + 1<br />
    !insertmacro UnselectSection $R0		# Unselect it<br />
    StrCmp $R0 ${PROG1_EndIndex} 0 Loop<br />
<br />
 Call ResetFiles<br />
<br />
 # Don't install prog 2?<br />
 Call IsPROG2Selected<br />
 Pop $R0<br />
 StrCmp $R0 1 +4<br />
  Pop $R1<br />
  Pop $R0<br />
  Abort<br />
<br />
 # Set current $INSTDIR to PROG2_InstDir define<br />
 StrCpy $INSTDIR &quot;${PROG2_InstDir}&quot;<br />
<br />
Pop $R1<br />
Pop $R0<br />
FunctionEnd<br />
<br />
## This will set all sections to how they were on the components page<br />
## originally<br />
Function ResetFiles<br />
Push $R0<br />
Push $R1<br />
<br />
 StrCpy $R0 ${PROG2_StartIndex}    # Group 2 start<br />
<br />
  Loop:<br />
   IntOp $R0 $R0 + 1<br />
   ReadINIStr &quot;$R1&quot; &quot;$PLUGINSDIR\sections.ini&quot; Sections $R0 # Get sec flags<br />
    SectionSetFlags $R0 $R1				  # Re-set flags for this sec<br />
    StrCmp $R0 ${PROG2_EndIndex} 0 Loop<br />
<br />
Pop $R1<br />
Pop $R0<br />
FunctionEnd<br />
<br />
Function SelectFilesC<br />
<br />
 # We need to save the state of the Group 3 Sections<br />
 # for the next InstFiles page<br />
Push $R0<br />
Push $R1<br />
<br />
 StrCpy $R0 ${PROG2_StartIndex} # Group 3 start<br />
<br />
  Loop:<br />
   IntOp $R0 $R0 + 1<br />
   SectionGetFlags $R0 $R1				    # Get section flags<br />
    WriteINIStr &quot;$PLUGINSDIR\sections.ini&quot; Sections $R0 $R1 # Save state<br />
    !insertmacro UnselectSection $R0			    # Then unselect it<br />
    StrCmp $R0 ${PROG2_EndIndex} 0 Loop<br />
<br />
 # Don't install prog 3?<br />
 Call IsPROG3Selected<br />
 Pop $R0<br />
 StrCmp $R0 1 +4<br />
  Pop $R1<br />
  Pop $R0<br />
  Abort<br />
<br />
 # Set current $INSTDIR to PROG1_InstDir define<br />
 StrCpy $INSTDIR &quot;${PROG3_InstDir}&quot;<br />
<br />
Pop $R1<br />
Pop $R0<br />
FunctionEnd<br />
<br />
<br />
I can't see the problem. It's all greek to me. :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th January 2006, 18:33</div></div><div class="posttext">You should use the LogicLib (http://nsis.sourceforge.net/Docs/Chapter2.html#2.3.5.1) for loops, it's simpler.<br />
<br />
I don't see where it extract Skyview in that script. Attach the entire script or at least include the extraction code.<br />
<br />
Please attach large scripts next time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nabukodonosor</div><div class="date">26th January 2006, 22:54</div></div><div class="posttext">OK, here's the entire script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nabukodonosor</div><div class="date">27th January 2006, 01:03</div></div><div class="posttext">Done it! yeah!!<br />
<br />
I didn't include the deselect script for the third item:<br />
<br />
StrCpy $R0 ${PROG1_StartIndex}    # Group 1 start<br />
<br />
  Loop:<br />
   IntOp $R0 $R0 + 1<br />
    !insertmacro UnselectSection $R0		# Unselect it<br />
    StrCmp $R0 ${PROG1_EndIndex} 0 Loop</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>