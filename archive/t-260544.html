<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" scons errors, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  scons errors NSIS Discussion" />
	
	<title> scons errors [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  scons errors</div>
<hr />
<div class="pda"><a href="t-260544.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=260544">scons errors</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">27th November 2006, 23:47</div></div><div class="posttext">For the last 10 days I have not been able to compile NSIS source.<br />
I get the following warnings while compiling the source files:<br />
cl : Command line warning D4002 : ignoring unknown option '/G-'<br />
<br />
and the following error while linking the exe:<br />
Ui.obj : error LNK2019: unresolved external symbol ___security_cookie referenced in function _outernotify@4<br />
util.obj : error LNK2001: unresolved external symbol ___security_cookie<br />
decompress.obj : error LNK2019: unresolved external symbol ___security_cookie referenced in function _BZ2_decompress@4<br />
bgbg.obj : error LNK2019: unresolved external symbol ___security_cookie referenced in function _BG_WndProc@16<br />
exec.obj : error LNK2001: unresolved external symbol ___security_cookie<br />
fileform.obj : error LNK2019: unresolved external symbol ___security_cookie referenced in function _verProc@16<br />
Main.obj : error LNK2001: unresolved external symbol ___security_cookie<br />
Ui.obj : error LNK2019: unresolved external symbol @__security_check_cookie@4 referenced in function _DialogProc@16<br />
util.obj : error LNK2019: unresolved external symbol @__security_check_cookie@4 referenced in function _myCreateProcess@8<br />
decompress.obj : error LNK2019: unresolved external symbol @__security_check_cookie@4 referenced in function _BZ2_decompress@4<br />
bgbg.obj : error LNK2019: unresolved external symbol @__security_check_cookie@4 referenced in function _BG_WndProc@16<br />
exec.obj : error LNK2001: unresolved external symbol @__security_check_cookie@4<br />
fileform.obj : error LNK2019: unresolved external symbol @__security_check_cookie@4 referenced in function _verProc@16<br />
Main.obj : error LNK2001: unresolved external symbol @__security_check_cookie@4<br />
build\release\stub_bzip2\stub_bzip2.exe : fatal error LNK1120: 2 unresolved externals<br />
scons: *** [build\release\stub_bzip2\stub_bzip2.exe] Error 1120<br />
scons: building terminated because of errors.<br />
<br />
I am using the Microsoft Visual C++ Toolkit 2003 and the Microsoft SDK from Feb 2003.<br />
This combination worked fine until about 10 days ago.<br />
So what changed?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">28th November 2006, 15:09</div></div><div class="posttext">OK, upgrading to the latest SDK (Server 2003 R2) did not help.<br />
Upgrading to Visual Studio 2005 Express resulted in a whole bunch of deprecated code warnings, as well as new unresolved externals:<br />
build.obj : error LNK2019: unresolved external symbol __imp__SendMessageA@16 referenced in function &quot;public: void __thiscall CEXEBuild::notify(enum notify_e,char const *)const &quot; (?notify@CEXEBuild@@QBEXW4notify_e@@PBD@Z)<br />
DialogTemplate.obj : error LNK2001: unresolved external symbol __imp__SendMessageA@16<br />
build.obj : error LNK2019: unresolved external symbol __imp__CharNextExA@12 referenced in function &quot;private: int __thiscall CEXEBuild::preprocess_string(char *,char const *,unsigned short)&quot; (?preprocess_string@CEXEBuild@@AAEHPADPBDG@Z)<br />
build.obj : error LNK2019: unresolved external symbol __imp__wsprintfA referenced in function &quot;private: int __thiscall CEXEBuild::add_intstring(int)&quot; (?add_intstring@CEXEBuild@@AAEHH@Z)<br />
script.obj : error LNK2001: unresolved external symbol __imp__wsprintfA<br />
DialogTemplate.obj : error LNK2019: unresolved external symbol __imp__CreateDialogIndirectParamA@20 referenced in function &quot;public: struct HWND__ * __thiscall CDialogTemplate::CreateDummyDialog(void)&quot; (?CreateDummyDialog@CDialogTemplate@@QAEPAUHWND__@@XZ)<br />
DialogTemplate.obj : error LNK2019: unresolved external symbol __imp__DestroyWindow@4 referenced in function &quot;public: void __thiscall CDialogTemplate::PixelsToDlgUnits(short &amp;,short &amp;)&quot; (?PixelsToDlgUnits@CDialogTemplate@@QAEXAAF0@Z)<br />
DialogTemplate.obj : error LNK2019: unresolved external symbol __imp__MapDialogRect@8 referenced in function &quot;public: void __thiscall CDialogTemplate::PixelsToDlgUnits(short &amp;,short &amp;)&quot; (?PixelsToDlgUnits@CDialogTemplate@@QAEXAAF0@Z)<br />
DialogTemplate.obj : error LNK2019: unresolved external symbol __imp__DeleteDC@4 referenced in function &quot;public: struct tagSIZE __thiscall CDialogTemplate::GetStringSize(unsigned short,char *)&quot; (?GetStringSize@CDialogTemplate@@QAE?AUtagSIZE@@GPAD@Z)<br />
DialogTemplate.obj : error LNK2019: unresolved external symbol __imp__DeleteObject@4 referenced in function &quot;public: struct tagSIZE __thiscall CDialogTemplate::GetStringSize(unsigned short,char *)&quot; (?GetStringSize@CDialogTemplate@@QAE?AUtagSIZE@@GPAD@Z)<br />
DialogTemplate.obj : error LNK2019: unresolved external symbol __imp__GetTextExtentPoint32A@16 referenced in function &quot;public: struct tagSIZE __thiscall CDialogTemplate::GetStringSize(unsigned short,char *)&quot; (?GetStringSize@CDialogTemplate@@QAE?AUtagSIZE@@GPAD@Z)<br />
DialogTemplate.obj : error LNK2019: unresolved external symbol __imp__SelectObject@8 referenced in function &quot;public: struct tagSIZE __thiscall CDialogTemplate::GetStringSize(unsigned short,char *)&quot; (?GetStringSize@CDialogTemplate@@QAE?AUtagSIZE@@GPAD@Z)<br />
DialogTemplate.obj : error LNK2019: unresolved external symbol __imp__CreateFontIndirectA@4 referenced in function &quot;public: struct tagSIZE __thiscall CDialogTemplate::GetStringSize(unsigned short,char *)&quot; (?GetStringSize@CDialogTemplate@@QAE?AUtagSIZE@@GPAD@Z)<br />
DialogTemplate.obj : error LNK2019: unresolved external symbol __imp__CreateCompatibleDC@4 referenced in function &quot;public: struct tagSIZE __thiscall CDialogTemplate::GetStringSize(unsigned short,char *)&quot; (?GetStringSize@CDialogTemplate@@QAE?AUtagSIZE@@GPAD@Z)<br />
DialogTemplate.obj : error LNK2019: unresolved external symbol __imp__GetDC@4 referenced in function &quot;public: struct tagSIZE __thiscall CDialogTemplate::GetStringSize(unsigned short,char *)&quot; (?GetStringSize@CDialogTemplate@@QAE?AUtagSIZE@@GPAD@Z)<br />
DialogTemplate.obj : error LNK2019: unresolved external symbol __imp__GetObjectA@12 referenced in function &quot;public: struct tagSIZE __thiscall CDialogTemplate::GetStringSize(unsigned short,char *)&quot; (?GetStringSize@CDialogTemplate@@QAE?AUtagSIZE@@GPAD@Z)<br />
makenssi.obj : error LNK2019: unresolved external symbol __imp__IsWindow@4 referenced in function _main<br />
script.obj : error LNK2019: unresolved external symbol __imp__CharNextA@4 referenced in function &quot;private: void __thiscall CEXEBuild::ps_addtoline(char const *,class GrowBuf &amp;,class StringList &amp;)&quot; (?ps_addtoline@CEXEBuild@@AAEXPBDAAVGrowBuf@@AAVStringList@@@Z)<br />
script.obj : error LNK2019: unresolved external symbol __imp__CharPrevA@8 referenced in function &quot;private: int __thiscall CEXEBuild::doParse(char const *)&quot; (?doParse@CEXEBuild@@AAEHPBD@Z)<br />
build\release\makensis\makensis.exe : fatal error LNK1120: 17 unresolved externals<br />
<br />
<br />
Is there a known working combination of SDK &amp; compiler that can be used to successfully compile the code?<br />
What does the official release process use?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">28th November 2006, 19:11</div></div><div class="posttext">Looks like its not linking to user32.lib<br />
<br />
The official setup used to be MSVC6 SP5+ProcessorPack, not sure if it has changed</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th November 2006, 17:04</div></div><div class="posttext">The official setup is indeed MSVC6 SP5 + Processor Pack. However, the nightly builds are running with Microsoft Visual C++ Toolkit 2003 and the Platform SDK of February 2003, and that still works (http://nsis.sourceforge.net/nightly/build.log). In the latest versions, the express edition of MSVC 2005 should also work.<br />
<br />
I'll take a look.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th November 2006, 18:34</div></div><div class="posttext">The first problem with the unknown option and the security cookie warnings was probably caused by a 2005 false positive which was in the code before 2.22 was released. The second seems like a problem with stale object files. The scons build code between 2.21 and 2.22 wasn't too stable, so it might have caused a little mess in the build directory. I think a clean build should work. Have you tried deleting .sconf_temp, .sconsign.dblite and build?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">WebMatze</div><div class="date">3rd December 2006, 12:59</div></div><div class="posttext">I also have a compile problem, i can compile with MSVC2005+platform SP1 but i cant if iuse MSVC2005+platform R2...<br />
<br />
I got an error &quot;Windows.h not found&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">5th December 2006, 14:52</div></div><div class="posttext">Originally posted by kichik <br />
The first problem with the unknown option and the security cookie warnings was probably caused by a 2005 false positive which was in the code before 2.22 was released. The second seems like a problem with stale object files. The scons build code between 2.21 and 2.22 wasn't too stable, so it might have caused a little mess in the build directory. I think a clean build should work. Have you tried deleting .sconf_temp, .sconsign.dblite and build?  <br />
<br />
Yes, I tried a clean build, and still get the errors.<br />
I currently have scons 0.96.93, Visual C++ Toolkit 2003 and Platform SDK Feb 2003 installed.<br />
This is my build script:<br />
<br />
set MSSDK=C:\Program Files\Microsoft SDK<br />
set VCToolkitInstallDir=C:\Program Files\Microsoft Visual C++ Toolkit 2003<br />
path %path%;c:\python;c:\Program Files\HTML Help Workshop<br />
call scons MSTOOLKIT=yes<br />
if exist build\release\Docs\chm (<br />
pushd build\release\Docs\chm<br />
if exist style.css attrib -r -s -h -a style.css<br />
if exist chmlink.js attrib -r -s -h -a chmlink.js<br />
if exist nsis.hhp attrib -r -s -h -a nsis.hhp<br />
popd<br />
)<br />
if exist build\release\Docs\html (<br />
pushd build\release\Docs\html<br />
if exist style.css attrib -r -s -h -a style.css<br />
popd<br />
)<br />
call scons MSTOOLKIT=yes PREFIX=&quot;C:\Program Files\NSIS&quot; install<br />
 <br />
My build log is attached.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">5th December 2006, 15:30</div></div><div class="posttext">I also have VS6 SP6 (processor pack is not available for SP6) and .Net Framework SDK 1.1/2.0 installed.<br />
Would this make a difference?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th December 2006, 18:59</div></div><div class="posttext">Do you also have a newer version of VS installed? mstoolkit.py didn't set MSVS_VERSION, but something else set it to a value that confused the ms configuration file.<br />
<br />
Put the attached mstoolkit.py file in SCons\Tools, see if it works and let me know what it prints as the old MSVS_VERSION value.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">5th December 2006, 20:57</div></div><div class="posttext">Yes, that did the trick.<br />
It was reporting MSVS_VERSION=8.0<br />
I tracked the problem down to scons picking the highest MSVS version number it finds in HKLM\Software\Microsoft\Visual Studio and HKLM\Software\Microsoft\VCExpress, regardless of whether it is still installed or not.<br />
This should be a bug, because HKLM retains these registry settings even after the particular version of MSVS is uninstalled. scons should check the installation path to verify that the MSVS installation still exists.<br />
The build works after removing references to 8.0 from HKLM\Software\Microsoft\Visual Studio and HKLM\Software\Microsoft\VCExpress.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th December 2006, 21:00</div></div><div class="posttext">I've uploaded the fixed version to CVS. Mind posting the details on this one to scons (http://scons.tigris.org/bug-submission.html)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">5th December 2006, 21:19</div></div><div class="posttext">Done (http://scons.tigris.org/issues/show_bug.cgi?id=1508)!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>