<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Custom data within a file to be installed?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Custom data within a file to be installed? NSIS Discussion" />
	
	<title> Custom data within a file to be installed? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Custom data within a file to be installed?</div>
<hr />
<div class="pda"><a href="t-306873.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=306873">Custom data within a file to be installed?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Decker87</div><div class="date">29th May 2009, 17:12</div></div><div class="posttext">I have a file called &quot;Userinfo.txt&quot;, and at a certain position, I want to insert some of the user's information.  For example, I want their &quot;Full Name&quot; go be inserted at byte 43.  Then, depending on how long their &quot;Full Name&quot; was, I want their &quot;Street Address&quot; to be inserted at position 75+Length(Full Name).<br />
<br />
This information, such as Full Name and Street Address, is information I wish to ask the user for at the start of the installation process.<br />
<br />
This could be done one of two ways:<br />
<br />
 I could mark those areas in the file with some sort of unique code, like &lt;FULLNAME&gt;, then ask NSIS to do a search-and-replace routine on the file at install time, replacing &lt;FULLNAME&gt; with the user's input.<br />
 I could leave those sections within the file empty, and tell NSIS to insert the user's input at specific locations in the file.<br />
<br />
<br />
Which of these, if any, are possible with NSIS?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">29th May 2009, 17:19</div></div><div class="posttext">The easier and more efficient option is to move the entire file into the NSIS script with multiple FileWrite instructions (with $\r$\n on the end of each line).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Decker87</div><div class="date">29th May 2009, 17:27</div></div><div class="posttext">So you're saying, I should just ask NSIS to write out the first part of the file byte-for-byte, until I get to where I want to write user input, then write that user input, then continue writing the file?<br />
<br />
Is this a good method, even when the file is around 1MB?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">29th May 2009, 18:44</div></div><div class="posttext">Whether the file is 1MB or 100MB if you need to replace any text in a file using an NSIS function it will be using FileRead and FileWrite on each line with some string manipulations in between. Therefore it would be best to store the file in an NSIS script (could be separate from your main script and included with !include) unless you use some external function (such as a plugin or exe) which will do it.<br />
<br />
Maybe like so:<br />
<br />
!macro WriteLine Line<br />
  FileWrite $R0 `${Line}$\r$\n`<br />
!macroend<br />
!define WriteLine `!insertmacro WriteLine`<br />
<br />
Push $R0<br />
FileOpen $R0 `$INSTDIR\some file.txt` w<br />
${WriteLine} `line 1`<br />
${WriteLine} `$some_data hi!`<br />
${WriteLine} `blah blah`<br />
FileClose $R0<br />
Pop $R0<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>