<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Read an ini file during installation, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Read an ini file during installation NSIS Discussion" />
	
	<title> Read an ini file during installation [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Read an ini file during installation</div>
<hr />
<div class="pda"><a href="t-336326.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=336326">Read an ini file during installation</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">wagner1308</div><div class="date">20th October 2011, 21:02</div></div><div class="posttext">I am new to nsis<br />
<br />
I want the installer read an ini file before starting the installation.<br />
Ini file that will have the following information Name of the installation folder, name for shortcuts among other things.<br />
With this I can have four variations of my applications eg software1.1, software1.2, software1.3, software1.4<br />
And it will not need to have an installer for each application for the changes to the installer will be the destination folder and different shortcuts.<br />
Does anyone have idea how I can do this?<br />
<br />
best regards<br />
Wagner.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">20th October 2011, 21:11</div></div><div class="posttext">Start by reading the documentation:<br />
http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wagner1308</div><div class="date">21st October 2011, 10:26</div></div><div class="posttext">I believe that right did not explain what I do.<br />
This is how I have a product installer, the installer will with an ini file. When running the installer will read the ini file and picked up some information, such as the installation folder and more.<br />
reading the documentation I saw the property ReadINIStr<br />
eg ReadINIStr $ 0 $ INSTDIR \ winamp winamp.ini outname<br />
But my problem is I'm not keeping a fixed place, where is the ini file.<br />
I have to make the installer look for an ini file when it runs and if he does not have the ini file to install a default installation of the product?<br />
<br />
I remember that my product has many Ex versions: Standard, Professional<br />
<br />
I know I'm not sure I could explain what I do.<br />
But thanks to which I responded</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">21st October 2011, 10:50</div></div><div class="posttext">1) You can use FindFirst/FindNext to find all .ini files in a certain directory. http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.5.12<br />
2) You can use ReadIniStr to read from an ini file.<br />
3) To set the default installation directory, simply do the following in the .onInit function:  StrCpy $INSTDIR &quot;C:\Your\Path&quot;<br />
<br />
With this information, you should be able to figure out how to do it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">21st October 2011, 12:15</div></div><div class="posttext">Does it really have to be that complicated?<br />
<br />
Why not put the INI file into the same folder as the &quot;Setup.exe&quot;, e.g. as &quot;Setup.ini&quot;.<br />
<br />
You could then simply read from the &quot;$EXEDIR\Setup.ini&quot; file...<br />
<br />
<br />
Though I would think about a different option:<br />
<br />
Instead of using an INI file to read the info at install-time, you can use Macros and set the info a compile-time!<br />
<br />
This way you still had to compile a different installer EXE for each product, but it could be done in a 100% automated way.<br />
<br />
The info that differs between different products could simply be passed to MaskeNSIS.exe via CLI parameters...<br />
<br />
(Not more work than creating an INI file for each product and no runtime dependency on the INI file)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wagner1308</div><div class="date">21st October 2011, 17:08</div></div><div class="posttext">that was what I was looking for, you think your place in the ini file &quot;$EXEDIR&quot; will be possible for me to copy the imformation I need.<br />
The matter of this macro I do not quite understand, I have little knowledge of nsis.<br />
Well, I'll try to use the &quot;$EXEDIR&quot; with ReadIniStr. If I have problems I'll post here.<br />
Thank you friends</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">21st October 2011, 17:23</div></div><div class="posttext">Normally you would use something like this to create shortcuts:<br />
<br />
CreateDirectory &quot;$SMPROGRAMS\My Company&quot;<br />
CreateShortCut &quot;$SMPROGRAMS\My Company\My Program.lnk&quot; &quot;$INSTDIR\My Program.exe&quot;<br />
<br />
<br />
With Macros you could replace the hardcoded strings like this:<br />
<br />
CreateDirectory &quot;$SMPROGRAMS\${CompanyName}&quot;<br />
CreateShortCut &quot;$SMPROGRAMS\${CompanyName}\${ProgramName}.lnk&quot; &quot;$INSTDIR\My Program.exe&quot;<br />
<br />
<br />
These would then be defined at the top of your NSI file like:<br />
<br />
!define CompanyName &quot;My Company&quot;<br />
!define ProgramName &quot;My Program&quot;<br />
<br />
<br />
Either that, or you pass them directly to the NSIS compiler as arguments:<br />
<br />
makensis.exe &quot;/DCompanyName=My Company&quot; &quot;/DProgramName=My Program&quot; Installer.nsi<br />
<br />
<br />
In the latter case, it would be advisable to add checks like this to your NSI file:<br />
<br />
!ifndef CompanyName<br />
!error &quot;CompanyName is undefined!&quot;<br />
!endif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wagner1308</div><div class="date">21st October 2011, 19:39</div></div><div class="posttext">my friends<br />
Can you make more or less what it wanted.<br />
Using $EXEDIR with ReadINIStr.<br />
<br />
But I'm not happy because my idea was to generate a single installer and when it is executed with an ini file the installer would get the information MenuGroup shortcut name and then I would just burn a CD with an installer and an ini file. if no ini file it installs the product with the settings that are already defined in the installer.<br />
Now so I could do with using $EXEDIR ReadINIStr I'll have to change the installer to insert five ini files:<br />
are: Standard, Professional, Professional Plus, Advanced, Special<br />
<br />
How could I fix it?<br />
<br />
Thank you!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">21st October 2011, 20:24</div></div><div class="posttext">Fix what? :confused:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">msroboto</div><div class="date">21st October 2011, 20:50</div></div><div class="posttext">How about you create one installer and 5 zip files that contain the right .ini file?<br />
Standard.zip Professional.zip etc.<br />
<br />
They download the right installer however you do that they unzip and you read the right .ini file.  Alternatively, you create one installer that requires the .ini and you mail them the .ini or have some other way to get it.<br />
Same idea they have to have the setup.exe and the .ini in the same directory.<br />
<br />
None of these methods is foolproof.  The .ini can be easily traded for sure.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wagner1308</div><div class="date">24th October 2011, 11:25</div></div><div class="posttext">the installer can read a file, where I do not have to specify the file path or put the file in EXEDIR.<br />
The installer could read at the level where it is? the local directory?, so I could check if the file exists then read ini settings and picks.<br />
If there is no ini file then installs with pre-existing settings.<br />
Thanks for the help everyone.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">24th October 2011, 13:11</div></div><div class="posttext">What do you mean with 'the local directory'?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">24th October 2011, 13:16</div></div><div class="posttext">the installer can read a file, where I do not have to specify the file path or put the file in EXEDIR.<br />
The installer could read at the level where it is? the local directory?, so I could check if the file exists then read ini settings and picks.<br />
If there is no ini file then installs with pre-existing settings.<br />
<br />
$EXEDIR refers to the directory where the installer executable (e.g. Setup.exe) is located. This is determined at run-time. Read &quot;$EXEDIR\Setup.ini&quot; and you will be reading the &quot;Setup.ini&quot; that is located in the very same directory where the &quot;Setup.exe&quot; is located, regardless of what directory that is. You can of course check for the existence of &quot;$EXEDIR\Setup.ini&quot; before you do that.<br />
<br />
Was that your question? :confused:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wagner1308</div><div class="date">25th October 2011, 10:36</div></div><div class="posttext">this explanation was that I lacked it worked, did not understand.<br />
Thank you friends</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>