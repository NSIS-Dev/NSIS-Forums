<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" another (external) patcher for work with nsis -&gt; aPatch (instead vpatch), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  another (external) patcher for work with nsis -&gt; aPatch (instead vpatch) NSIS Discussion" />
	
	<title> another (external) patcher for work with nsis -&gt; aPatch (instead vpatch) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  another (external) patcher for work with nsis -&gt; aPatch (instead vpatch)</div>
<hr />
<div class="pda"><a href="t-244840.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=244840">another (external) patcher for work with nsis -&gt; aPatch (instead vpatch)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">28th April 2006, 15:30</div></div><div class="posttext">geez i was looking these days for a script or patcher for nsis<br />
(in general - a patcher with simple byte replacing at fix address)<br />
<br />
the most patchers are search&amp;replace in all combinations.<br />
but that wasnt wanted, moreover they need a source/target file.<br />
(vpatch wasnt uselful same way)<br />
<br />
so i found aPatch<br />
http://www.ibsensoftware.com/<br />
<br />
this patcher works with a script which can be written from nsis.<br />
<br />
easy way:<br />
start<br />
open &lt;file&gt;<br />
search &lt;old_word&gt;<br />
write &lt;new_word&gt;<br />
quit<br />
end<br />
(word can be text or hexstrings)<br />
(use fileopen/filewrite/filewritebyte0D0A/fileclose)<br />
<br />
the the script must be compiled<br />
&quot;apatch.exe script.aps&quot;<br />
(apatch.exe need to be included in nsis-package /pluginsdir)<br />
(File /oname=$PLUGINSDIR\apatch.exe &quot;apatch.exe&quot;)<br />
<br />
it generates a simple patch.exe.<br />
unfortunaltely it has a GUI with a textfiled and two <br />
buttons: &quot;Patch&quot; and &quot;Quit&quot;<br />
<br />
but is is the only me known one:<br />
1) freeware<br />
2) script-based<br />
3) very easy (hand full of commands)<br />
<br />
In my case easy as simple<br />
- in nsis: get word, get file (io)<br />
- write apatch-script<br />
- compile with apatch<br />
- start patch (execwait)<br />
- remove all temp-files<br />
- done<br />
<br />
part of my script:<br />
start<br />
open &lt;file&gt;<br />
size 1227776<br />
onerror goto error<br />
<br />
backup on<br />
offset 933125<br />
write &lt;new_text&gt;<br />
print &quot;Success&quot;<br />
goto done<br />
<br />
error:<br />
print &quot;Failed&quot;<br />
<br />
done:<br />
quit<br />
end<br />
(open file, check filesize, goto offset, write text/hexstrings, quit)<br />
<br />
Use NSIS to write the filename, old_text, new_text, custom <br />
errormessages aso.<br />
<br />
aPatch is recognized from PEid, so it contains specific <br />
bytes as a exe-packer - and &quot;patch.exe&quot; is packed with this <br />
method - so you cant disassemble it to get rid of the GUI.<br />
<br />
feel free to post other soulutions this way - if you have <br />
one without GUI - write it here pls.<br />
<br />
btw, i tried &quot;fileseek #&quot;, but then i got 933125 00-bytes <br />
and then my text. so nsis can only work on textfiles !?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galil</div><div class="date">28th April 2006, 17:57</div></div><div class="posttext">btw, i tried &quot;fileseek #&quot;, but then i got 933125 00-bytes and then my text. so nsis can only work on textfiles !?<br />
If you open file in &quot;w&quot; mode that is what you're supposed to get.<br />
Read NSIS manual about differences between r/w/a<br />
<br />
<br />
moreover they need a source/target file.<br />
(vpatch wasnt uselful same way)<br />
Why doesn't that fit your needs?<br />
If you need fixed offset patch, automatic compare of original/patched files that is offered by all these kind of patch creators just make it easier for you. Why input all the offsets and byte values by hand when you can have it done automatically.<br />
<br />
(apatch.exe need to be included in nsis-package /pluginsdir) <br />
Why do you need the patcher to be compiled on the user's system?<br />
Normally you compile patcher on your system and distribute it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">28th April 2006, 18:16</div></div><div class="posttext">hmm, i needed filewrite /a ?<br />
idd i used /w...<br />
vpatch needs a source and target file to compare,<br />
like all others i know. there was no one with a simple <br />
replace like apatch.<br />
The source file isnt fixed, that was the main problem,<br />
so specific code changes from time to time the patcher is used.<br />
it just modifies a printed line which is given at a fixed address.<br />
so search/replace isnt my friend you see!?<br />
<br />
i need to compile at runtime but user has no apatch on its system ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th April 2006, 18:20</div></div><div class="posttext">Using w will delete the contents of the file.<br />
Using a will not delete the contents of the file and so using FileSeek will allow you to move the write pointer to the end of the file for continuous writing.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">28th April 2006, 18:34</div></div><div class="posttext">well i think youre right, i did it now with /a and it works, thx so much.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galil</div><div class="date">28th April 2006, 18:44</div></div><div class="posttext">Originally posted by Brummelchen <br />
it just modifies a printed line which is given at a fixed address.<br />
<br />
So you could simply use NSIS built-in functions FileSeek and FileWrite (and maybe also FileWriteByte if you need to null-terminate that string), file opened in &quot;a&quot; mode of course...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>