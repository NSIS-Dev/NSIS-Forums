<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Nsis and the installation temporary space, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Nsis and the installation temporary space NSIS Discussion" />
	
	<title> Nsis and the installation temporary space [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Nsis and the installation temporary space</div>
<hr />
<div class="pda"><a href="t-225798.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=225798">Nsis and the installation temporary space</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">neotwix</div><div class="date">12th September 2005, 11:31</div></div><div class="posttext">Hi, <br />
I have a question of how nsis work.<br />
When I began to work with nsis, I read on the french chm <br />
help file. (Chap1 introduction)<br />
&quot;Les installations de NSIS ne vont pas essayer de se décompresser elles-mêmes trois fois, en indiquant à l'utilisateur de &quot;bien vouloir patienter&quot;. Elles vont au but, et font leur travail.&quot;<br />
Which could be translated in english: &quot;The intallation made with nsis doesn't try to uncompress her self three times, <br />
And during this this time, the user only add a wainting message. The installer do only what they need to do.&quot;<br />
<br />
I interprete that like nsis doesn't need a lot of temporary space to installed it.<br />
<br />
I have a big sepup (I think), The archive take 100 MB with<br />
the LZMA /Solid compressor. The installation took 650 MB on my hard drive, And The installation contain ~12000 files.<br />
<br />
I want installed it on the PC with poor available free space.<br />
<br />
In my Case 900 MB<br />
On the panel when I choose the install path, the installer<br />
accept the path.<br />
During the installation, I have an extract error.<br />
If I made the installation on another PC with a lot of available free space, before clic on the finish button, <br />
I Have 500 MB extra space ( temporary file I hope).<br />
The space is removed after the clic on the finish button.<br />
<br />
So My question.... <br />
How the setup work during the installation ?<br />
Could it be possible to know the temporary space to <br />
unaccept drive with poor free space ?<br />
Maybe I make something wrong in nsi file ....<br />
<br />
<br />
thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">neotwix</div><div class="date">12th September 2005, 17:34</div></div><div class="posttext">I continue my investigation, <br />
and during the installation, <br />
nsis create a temporary directory, in my case<br />
C:\Documents and Settings\MyName\Local Settings\Temp\nsv73.tmp<br />
and a temporary file, in my case:<br />
C:\Documents and Settings\MyName\Local Settings\Temp\nsv72.tmp<br />
before the install panel and the real install of files, <br />
the size of this files is 0K. The directory contain the uncompressed files. My banners, and the plugins used by my setup.<br />
<br />
During the installation, the tmp size file increase drasticaly. in my case the file size grow up to 378 Mb.<br />
I don't know if it's normal. if it's how nsis work or it's a bug.<br />
I made my setup with setCompressor /solid lzma.<br />
Maybe it's for that ? Maybe it's due to the solid option ?<br />
<br />
Other information, I use NSIS 2.08<br />
I watch the NSIS 2.09 ChangeLog,and I dont see a fix of this <br />
type of problem.<br />
<br />
<br />
thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">neotwix</div><div class="date">13th September 2005, 11:45</div></div><div class="posttext">note: The bzip2 /solid don't use a temporary file to uncompress files. <br />
The temporary contain only plugins and bmp.<br />
<br />
Is it a specification of LZMA Algorithm ?<br />
In this case, it's a a de-advantage of the LZMA, if we need the double of place for the installation :(, <br />
In my case my setup increase from 107 MB in LZMA to 187 MB in BZIP2. I hope it's just a bug, I like so much my setup with<br />
LZMA :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th September 2005, 18:40</div></div><div class="posttext">It's not only for LZMA, it's for all solid installers. Search the forum for the words solid and you should find some threads that explain this. Basically, this file exists so the installer won't have to decompress your entire installer multiple times.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ImmortAlex</div><div class="date">15th September 2005, 04:38</div></div><div class="posttext">When compiler parses your script it found files in this order:<br />
a, b, c, d, e, f<br />
and store it into archive.<br />
But when script executes, it uses files in order, f.e.:<br />
a, b, f, c, e, d<br />
When you use solid compression, unpacker need to unpack files &quot;c, d, e&quot; before it unpack file &quot;f&quot;.<br />
So unpacker keeps that files in temp folder for not to return back to unpacking &quot;c&quot; when script reference to it.<br />
All you need is to carefully place references to files in you script. There is some disscussions in this forum about this, and AFAIR even in documentation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">neotwix</div><div class="date">15th September 2005, 11:37</div></div><div class="posttext">thanks, I try to test without solid option for compressor.<br />
And I have a error with lzma, I test it with all the other combination (bzip2,; bzip2 /solid, zlib, zlib /solid, and lzma /solid, all work fine)<br />
but for lzma alone, I have this error:<br />
File: &quot;myFile&quot; [compress]Error: add_db_data() - compress() failed(initialization failed [-2])<br />
and it a little file (a makefile 2 or 3 KB....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">neotwix</div><div class="date">15th September 2005, 14:30</div></div><div class="posttext">I think it's the SetCompressorDictSize is maybe too short.<br />
in my projectFile, I increase to 16MB the dic size. <br />
And I relaunch my setup generation with makensis.<br />
The compressor take more files but I have the same message to another files.<br />
I increase again the Dic Size to 32 Mb, and I the message:<br />
File: &quot;xxxxx.h&quot; [compress]<br />
and nothing more. If I made a top, my cpu do absolutly nothing. Another Thing I use nsis 2.09 under Linux.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th September 2005, 19:32</div></div><div class="posttext">Please attach a complete example, with all the files needed to reproduce this. Also try upgrading to 2.09.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd September 2005, 21:21</div></div><div class="posttext">Initialization error fixed. It was failing because the threads were not properly cleaned up. It's a good thing pthread_detach is mentioned in the man page for pthread_create.<br />
<br />
Patch attached.<br />
<br />
Thanks for your report.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>