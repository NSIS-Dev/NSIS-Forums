<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Compile NSIS 2.10 problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Compile NSIS 2.10 problem NSIS Discussion" />
	
	<title> Compile NSIS 2.10 problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Compile NSIS 2.10 problem</div>
<hr />
<div class="pda"><a href="t-228017.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228017">Compile NSIS 2.10 problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">9th October 2005, 11:45</div></div><div class="posttext">I have installed:<br />
python-2.4.1<br />
scons-0.96.91<br />
VCToolkit<br />
Windows Server 2003 SP1 Platform SDK<br />
<br />
Build.bat (in the NSIS source directory):<br />
@ECHO OFF<br />
set MSSDK=D:\Program Files\Microsoft Platform SDK<br />
set VCToolkitInstallDir=D:\Program Files\Microsoft Visual C++ Toolkit 2003<br />
set Python=D:\Python24<br />
<br />
set PATH=%Python%;%PATH%<br />
set INCLUDE=%MSSDK%\include;%INCLUDE%<br />
set LIB=%MSSDK%\lib;%LIB%<br />
<br />
scons MSTOOLKIT=yes<br />
<br />
But there are errors when I try to compile:<br />
scons: Reading SConscript files ...<br />
Delete(&quot;nsis-09-Oct-2005.cvs&quot;)<br />
Delete(&quot;.instdist&quot;)<br />
Delete(&quot;.test&quot;)<br />
Using Microsoft tools configuration<br />
Checking for main() in C library gdi32... (cached) no<br />
Checking for main() in C library user32... (cached) no<br />
Checking for main() in C library version... (cached) no<br />
Checking for main() in C library pthread... (cached) no<br />
Checking for main() in C library stdc++... (cached) no<br />
Checking for main() in C library iconv... (cached) no<br />
Checking for main() in C library dl... (cached) no<br />
Checking for main() in C++ library cppunit... (cached) no<br />
scons: done reading SConscript files.<br />
scons: Building targets ...<br />
cl /nologo /O1 /W3 /c Contrib\AdvSplash\advsplash.c /Fobuild\release\AdvSplash\a<br />
dvsplash.obj<br />
advsplash.c<br />
Contrib\AdvSplash\advsplash.c(214) : error C2065: 'LWA_ALPHA' : undeclared ident<br />
ifier<br />
Contrib\AdvSplash\advsplash.c(214) : error C2065: 'LWA_COLORKEY' : undeclared id<br />
entifier<br />
Contrib\AdvSplash\advsplash.c(244) : error C2065: 'WS_EX_LAYERED' : undeclared i<br />
dentifier<br />
Contrib\AdvSplash\advsplash.c(270) : error C2065: 'DWORD_PTR' : undeclared ident<br />
ifier<br />
Contrib\AdvSplash\advsplash.c(270) : error C2146: syntax error : missing ')' bef<br />
ore identifier 'myWnd'<br />
Contrib\AdvSplash\advsplash.c(270) : error C2144: syntax error : '&lt;Unknown&gt;' sho<br />
uld be preceded by '&lt;Unknown&gt;'<br />
Contrib\AdvSplash\advsplash.c(270) : error C2144: syntax error : '&lt;Unknown&gt;' sho<br />
uld be preceded by '&lt;Unknown&gt;'<br />
Contrib\AdvSplash\advsplash.c(270) : error C2143: syntax error : missing ')' bef<br />
ore 'identifier'<br />
Contrib\AdvSplash\advsplash.c(270) : error C2198: 'timeSetEvent' : too few argum<br />
ents for call through pointer-to-function<br />
Contrib\AdvSplash\advsplash.c(270) : error C2059: syntax error : ')'<br />
scons: *** [build\release\AdvSplash\advsplash.obj] Error 2<br />
scons: building terminated because of errors.<br />
<br />
I read in forum about the same error, it was environment variable problem, but why scons don't find liberaries, all paths is ok.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th October 2005, 13:06</div></div><div class="posttext">Does %MSSDK%\Lib\Gdi32.Lib exist? If it doesn't, you might have installed the wrong Platform SDK. There's one that doesn't come with all the libraries and binaries for some weird reason. Maybe it was only for 64-bit. I don't remember right now...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">9th October 2005, 15:24</div></div><div class="posttext">I'm confused. &quot;%MSSDK%\Lib\Gdi32.Lib&quot; exists.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th October 2005, 15:37</div></div><div class="posttext">If it exists, it's probably the correct Platform SDK version.<br />
<br />
What does config.log show?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">9th October 2005, 16:07</div></div><div class="posttext">This is very strange. After I have remove &quot;nsis-2.10-src&quot; and unpack source again (build.bat file the same):<br />
<br />
scons: Reading SConscript files ...<br />
Delete(&quot;nsis-09-Oct-2005.cvs&quot;)<br />
Delete(&quot;.instdist&quot;)<br />
Delete(&quot;.test&quot;)<br />
Using Microsoft tools configuration<br />
Checking for main() in C library gdi32... (cached) yes<br />
Checking for main() in C library user32... (cached) yes<br />
Checking for main() in C library version... (cached) yes<br />
Checking for main() in C library pthread... (cached) no<br />
Checking for main() in C library stdc++... (cached) no<br />
Checking for main() in C library iconv... (cached) no<br />
Checking for main() in C library dl... (cached) no<br />
Checking for main() in C++ library cppunit... (cached) no<br />
scons: done reading SConscript files.<br />
scons: Building targets ...<br />
cl /nologo /O1 /W3 /c Contrib\AdvSplash\advsplash.c /Fobuild\release\AdvSplash\a<br />
dvsplash.obj<br />
advsplash.c<br />
Contrib\AdvSplash\advsplash.c(214) : error C2065: 'LWA_ALPHA' : undeclared ident<br />
ifier<br />
Contrib\AdvSplash\advsplash.c(214) : error C2065: 'LWA_COLORKEY' : undeclared id<br />
entifier<br />
Contrib\AdvSplash\advsplash.c(244) : error C2065: 'WS_EX_LAYERED' : undeclared i<br />
dentifier<br />
Contrib\AdvSplash\advsplash.c(270) : error C2065: 'DWORD_PTR' : undeclared ident<br />
ifier<br />
Contrib\AdvSplash\advsplash.c(270) : error C2146: syntax error : missing ')' bef<br />
ore identifier 'myWnd'<br />
Contrib\AdvSplash\advsplash.c(270) : error C2144: syntax error : '&lt;Unknown&gt;' sho<br />
uld be preceded by '&lt;Unknown&gt;'<br />
Contrib\AdvSplash\advsplash.c(270) : error C2144: syntax error : '&lt;Unknown&gt;' sho<br />
uld be preceded by '&lt;Unknown&gt;'<br />
Contrib\AdvSplash\advsplash.c(270) : error C2143: syntax error : missing ')' bef<br />
ore 'identifier'<br />
Contrib\AdvSplash\advsplash.c(270) : error C2198: 'timeSetEvent' : too few argum<br />
ents for call through pointer-to-function<br />
Contrib\AdvSplash\advsplash.c(270) : error C2059: syntax error : ')'<br />
scons: *** [build\release\AdvSplash\advsplash.obj] Error 2<br />
scons: building terminated because of errors.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th October 2005, 16:32</div></div><div class="posttext">I actually wanted the config.log for the non-working build. The working one doesn't show the errors. But if it finds the libraries now, it's not important. The libraries were probably not found because the result was still cached from the last time you built it without the correct environment variables.<br />
<br />
But the incorrect header file is a puzzle. It doesn't stop on HINSTANCE, but it does on newer definitions which require _WIN32_WINNT. But _WIN32_WINNT is defined on the same file. This means it takes the header files from another place. Do you have WinUser.h installed in another place than %MSSDK%\Include\WinUser.h?<br />
<br />
BTW, you don't need to change INCLUDE and LIB on yourself. SCons handles that on its own and ignores your settings.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">9th October 2005, 16:51</div></div><div class="posttext">You are right there was &quot;%VCToolkitInstallDir%\Include\WinUser.h&quot;. After clean VCToolkit install, all compiles fine. Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th October 2005, 20:59</div></div><div class="posttext">Any idea how it got there? Was it there in the default installation of the VC Toolkit?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">10th October 2005, 07:04</div></div><div class="posttext">It is I place liberaries and headers from VC6 to VC Toolkit :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th October 2005, 12:46</div></div><div class="posttext">Ah, that explains it. I've updated the tool definition to give priority to the header and library files in the Platfrom SDK. In case they exist in both, the PSDK's should always be newer anyway.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>