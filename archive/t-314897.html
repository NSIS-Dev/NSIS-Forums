<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" InstallLib does not register any dll or ocx, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  InstallLib does not register any dll or ocx NSIS Discussion" />
	
	<title> InstallLib does not register any dll or ocx [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  InstallLib does not register any dll or ocx</div>
<hr />
<div class="pda"><a href="t-314897.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=314897">InstallLib does not register any dll or ocx</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pssns</div><div class="date">27th November 2009, 18:07</div></div><div class="posttext">New to NSIS. My first project is for trying to convert an old VB6 setup to NSIS, and testing it in Windows 7. To make things easier, I am testing with UAC disabled.<br />
<br />
When installing, it installs all the normal files, links and uninstall program, but it does not install any of the dlls and ocx. <br />
<br />
I am testing it with the logging version of the installer, and in the install.log file does not apear any comment or error about the dlls and ocx.<br />
<br />
Sure it will be something forgotten, so, any help will be appreciated.<br />
<br />
Here is a partial code of what I am using<br />
<br />
; MUI end ------<br />
<br />
!include &quot;Library.nsh&quot;<br />
<br />
Var ALREADY_INSTALLED<br />
Var Version<br />
<br />
Name &quot;${PRODUCT_NAME} ${PRODUCT_VERSION}&quot;<br />
OutFile &quot;ProtonSetup.exe&quot;<br />
InstallDir &quot;C:\PROTON&quot;<br />
InstallDirRegKey HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot;<br />
ShowInstDetails show<br />
ShowUnInstDetails show<br />
<br />
RequestExecutionLevel admin<br />
<br />
Section &quot;ProtonInstall&quot;<br />
  LogSet on<br />
  ReadRegDWord $Version HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; Version<br />
  IfErrors new_installation<br />
  StrCpy $ALREADY_INSTALLED 1<br />
  new_installation:<br />
  SetOverwrite ifnewer<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED &quot;Support\dbgrid32.ocx&quot; &quot;$SysDir\dbgrid32.ocx&quot; &quot;$SysDir&quot;<br />
  !insertmacro InstallLib DLL $ALREADY_INSTALLED REBOOT_PROTECTED &quot;Support\ADODCES.DLL&quot; &quot;$SysDir\ADODCES.DLL&quot; &quot;$SysDir&quot;<br />
  !insertmacro InstallLib DLL $ALREADY_INSTALLED REBOOT_PROTECTED &quot;Support\STDFTES.DLL&quot; &quot;$SysDir\STDFTES.DLL&quot; &quot;$SysDir&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED &quot;Support\MSSTDFMT.DLL&quot; &quot;$SysDir\MSSTDFMT.DLL&quot; &quot;$SysDir&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED &quot;Support\MSADODC.OCX&quot; &quot;$SysDir\MSADODC.OCX&quot; &quot;$SysDir&quot;<br />
  !insertmacro InstallLib DLL $ALREADY_INSTALLED REBOOT_PROTECTED &quot;Support\MSMPIES.DLL&quot; &quot;$SysDir\MSMPIES.DLL&quot; &quot;$SysDir&quot;<br />
  !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED &quot;Support\MSMAPI32.OCX&quot; &quot;$SysDir\MSMAPI32.OCX&quot; &quot;$SysDir&quot;<br />
  !insertmacro InstallLib DLL $ALREADY_INSTALLED REBOOT_PROTECTED &quot;Support\FLXGDES.DLL&quot; &quot;$SysDir\FLXGDES.DLL&quot; &quot;$SysDir&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">27th November 2009, 22:03</div></div><div class="posttext">Perhaps you're not running the installer as admin. When UAC is disabled, windows ignores the requested execution level. To work around this, use the userinfo plugin to manually test for actual admin access in .onInit.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pssns</div><div class="date">28th November 2009, 18:27</div></div><div class="posttext">It was easier than supposed. I tested in an XP machine, and it happened the same, so, after investigating, I added SetOutPath before registering dlls in the SysDir and InstDir folders, and now it works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st December 2009, 07:23</div></div><div class="posttext">SetOutPath sets the working directory which is also used in the search path for dependencies. If you have dependencies outside of the system folder and the search path, you have to set the working folder to that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pssns</div><div class="date">1st December 2009, 08:08</div></div><div class="posttext">Thanks for your interest kichik.<br />
<br />
The sample script inserted does not completely illustrate the situation because are only some partial lines of about 100 files to copy, and the ocx and dlls that did not copied where those in the InstDir folder, those in SysDir copied correctly.<br />
<br />
After using the log version of the installer, I saw that SetOutPat $InstDir also creates the folder if it does not exists, so putting it at the beginning of the files to copy to $InstDir solved my problem.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>