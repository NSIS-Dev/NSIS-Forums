<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" File type icon and application associations not updating on Windows 7 64 bit install, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  File type icon and application associations not updating on Windows 7 64 bit install NSIS Discussion" />
	
	<title> File type icon and application associations not updating on Windows 7 64 bit install [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  File type icon and application associations not updating on Windows 7 64 bit install</div>
<hr />
<div class="pda"><a href="t-347348.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=347348">File type icon and application associations not updating on Windows 7 64 bit install</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">grezit</div><div class="date">24th August 2012, 19:58</div></div><div class="posttext">I am working on a NSIS installer that edits the registry for a couple file types to change their icons and the application that runs them.<br />
<br />
After the registry edits are complete I use the SHChangeNotify system call to force the shell to update with the new settings.<br />
<br />
; Tell the shell to reset its icon cache<br />
System::Call 'shell32.dll::SHChangeNotify(i, i, i, i) v \<br />
(0x08000000, 0, 0, 0)'<br />
<br />
On WinXP 32bit and 64bit systems, this is working fine. It also works fine on a Windows 7 32bit box. However, on a Win7 64 bit box, the file type that is already in the registry is not updating to the new values I set for it. The file type that isn't already in the registry has the proper icon and app association applied to it without issue. Its the type with already existing registry settings that is not updating.<br />
<br />
This seems more like an operating system issue than in NSIS but perhaps someone here has encountered this issue.<br />
<br />
Does anyone have any ideas on this that will update the settings and not require any kind of system restart or killing and restarting explorer, which I want to avoid?<br />
<br />
<br />
Thanks for any assistance.<br />
<br />
Greg</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th August 2012, 22:27</div></div><div class="posttext">Is the installer running as an administrator (i.e. try Run as administrator)?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grezit</div><div class="date">27th August 2012, 19:34</div></div><div class="posttext">Is the installer running as an administrator (i.e. try Run as administrator)?<br />
<br />
Stu<br />
<br />
Running as Administrator did not resolve the issue.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Abu Abdullah</div><div class="date">7th September 2012, 07:48</div></div><div class="posttext">I'm facing the same issue. I'm using File Association in:<br />
http://nsis.sourceforge.net/File_Association<br />
<br />
is there any updates to be done for win7 64 bit</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th September 2012, 11:55</div></div><div class="posttext">Not that this should have any effect on HKCR but make sure you have SetRegView 64.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Abu Abdullah</div><div class="date">7th September 2012, 16:56</div></div><div class="posttext">many thanks. i was missing  SetRegView 64.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>