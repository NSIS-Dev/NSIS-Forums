<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How Do You Make !Macro's Accept Dynamic Parameters?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How Do You Make !Macro's Accept Dynamic Parameters? NSIS Discussion" />
	
	<title> How Do You Make !Macro's Accept Dynamic Parameters? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How Do You Make !Macro's Accept Dynamic Parameters?</div>
<hr />
<div class="pda"><a href="t-210604.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=210604">How Do You Make !Macro's Accept Dynamic Parameters?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">16th March 2005, 19:56</div></div><div class="posttext">I am trying to create a macro in which the parameters are unknown. There could be 1 or there could be 20. The problem with macros outright is it seems they need to know the exact number of parameters in which I in turn need to be dynamic.<br />
<br />
!macro operation parameter1<br />
...<br />
!insertmacro operation parameter1 parameter2 parameter3 parameter4<br />
<br />
How do I tell the macro that there could be more parameters without getting the following error:<br />
<br />
!insertmacro: macro &quot;operation &quot; requires 1 parameter(s), passed 4!<br />
<br />
In a real world scenario heres the deal. I have a zipup operation which zips up a file. I sometimes need only 1 OR 20+ files zipped up. Instead of creating a new !insertmacro for every file HOW do I create one !insertmacro and pass all the files to it?<br />
<br />
Instead of this:<br />
<br />
!insertmacro operation &quot;file1&quot;<br />
!insertmacro operation &quot;file2&quot;<br />
!insertmacro operation &quot;file3&quot;<br />
!insertmacro operation &quot;file4&quot;<br />
!insertmacro operation &quot;file5&quot;<br />
!insertmacro operation &quot;file6&quot;<br />
<br />
To This:<br />
!insertmacro operation &quot;file1&quot; &quot;file2&quot; &quot;file3&quot; &quot;file4&quot; &quot;file5&quot; &quot;file6&quot;<br />
<br />
Thanks for any tips, tricks and any help on this!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th March 2005, 20:27</div></div><div class="posttext">This is possible, but it's a bit messy and will take I'd say 30 minutes of your time.<br />
<br />
Your macro should take the list of files as one paramater, then writes it to a file like so:<br />
<br />
!macro operation FileList<br />
 !system &quot;${FileList} &gt;list.tmp&quot;<br />
<br />
Then you want to create another installer which reads from list.tmp, and with some string functions in it, parses the list of files and writes some more NSIS code involving each file to say list.nsh.<br />
You then use !include list.nsh under the above !system call, and finally use !system &quot;del list.tmp&quot; and !system &quot;del list.nsh&quot; to delete the temporary files.<br />
<br />
It probably sounds easier to use !insertmacro for each one.<br />
You could shorten !insertmacro MyMacro to:<br />
!define MyMacro &quot;!insertmacro MyMacro&quot; and thus ${MyMacro} serves as the same purpose.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">16th March 2005, 21:15</div></div><div class="posttext">whoa, I had no idea creating a looping dynamic parameter macro would require so much work. Sounds easier in theory ;)<br />
<br />
Major thanks Afrow, but that technique seems like it isn't worth the trouble Vs simply listing more !insertmacros.<br />
<br />
I'll take your word on the last bit of your advice :)<br />
<br />
Thanks Afrow!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th March 2005, 17:54</div></div><div class="posttext">There's no need for an external application in this case. You can simply use:!macro op args<br />
untgz::extractV -i ${args} --<br />
!macroend<br />
<br />
!insertmacro op 'file file2 &quot;file with spaces&quot; another_one'This will be translated into:untgz::extractV -i file file2 &quot;file with spaces&quot; another_one --</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">19th March 2005, 08:16</div></div><div class="posttext">Thanks for pointing that out Kichik! Thanks Afrow for making the wheels spin ;)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>