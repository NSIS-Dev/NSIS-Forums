<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with UMUI, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with UMUI NSIS Discussion" />
	
	<title> Problem with UMUI [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with UMUI</div>
<hr />
<div class="pda"><a href="t-323773.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=323773">Problem with UMUI</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Deko Servidoni</div><div class="date">4th November 2010, 16:21</div></div><div class="posttext">Hi everyone.<br />
<br />
I looked in the forum, but i didn't find anything about this problem (see attachment).<br />
When i use UMUI.nsh, on Windows Server 2008, after my script<br />
execute a &quot;Page custom &lt;name function&gt;&quot;, appears an empty window...<br />
I don't know how to fix it.<br />
<br />
Thks<br />
<br />
Sorry again if i duplicate the post but<br />
i don't find anything on the forum.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">4th November 2010, 19:13</div></div><div class="posttext">I guess this doesn't occur on XP/Vista/Win7 - have you tested this?<br />
<br />
Without seeing the code, I wouldn't venture to guess what might be the issue directly.  However, have you tried systematically removing items from your custom page (start with a blank one) to see if one of the dialog items might be the cause?  If the dialog items aren't the cause, try systematically removing code from your page create/show functions (if the error occurs when you click 'next', check the leave function).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Deko Servidoni</div><div class="date">11th November 2010, 16:34</div></div><div class="posttext">On XP/Vista/Win7 doesn't occur, only on Windows Server 2008<br />
<br />
this occurs between &quot;Page Custom Requisito&quot; and &quot;Page Custom InfoReqs&quot;<br />
here is my code:<br />
<br />
;interface da instalacao<br />
!insertmacro MUI_PAGE_WELCOME <br />
Page Custom Requisito             <br />
Page Custom InfoReqs<br />
!insertmacro UMUI_PAGE_SETUPTYPE<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!insertmacro UMUI_PAGE_ALTERNATIVESTARTMENU Application $STARTMENU_FOLDER<br />
<br />
  !define UMUI_CONFIRMPAGE_TEXT_TITLE &quot;Configuração atual:&quot;<br />
!insertmacro UMUI_PAGE_CONFIRM<br />
!insertmacro MUI_PAGE_INSTFILES<br />
Page Custom InfoPosInstall<br />
!define MUI_FINISHPAGE_LINK &quot;${COMPANY}&quot;<br />
!define MUI_FINISHPAGE_LINK_LOCATION &quot;${URL}&quot;<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
;interface da desinstalacao<br />
!insertmacro MUI_UNPAGE_WELCOME<br />
!insertmacro MUI_UNPAGE_CONFIRM<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
!insertmacro MUI_UNPAGE_FINISH<br />
<br />
;linguagem do instalador<br />
!insertmacro MUI_LANGUAGE &quot;PortugueseBR&quot;<br />
<br />
Function InfoReqs<br />
         ; abrindo arquivo .ini<br />
         !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;${REQINSTALLFILE}&quot;<br />
         <br />
         ; escrevendo no arquivo .ini<br />
         !insertmacro INSTALLOPTIONS_WRITE &quot;${REQINSTALLFILE}&quot; &quot;Field 7&quot; &quot;Text&quot; &quot;$WINVER&quot;<br />
         !insertmacro INSTALLOPTIONS_WRITE &quot;${REQINSTALLFILE}&quot; &quot;Field 8&quot; &quot;Text&quot; &quot;$DNFVER&quot; <br />
         !insertmacro INSTALLOPTIONS_WRITE &quot;${REQINSTALLFILE}&quot; &quot;Field 9&quot; &quot;Text&quot; &quot;$JAVVER&quot; <br />
         !insertmacro INSTALLOPTIONS_WRITE &quot;${REQINSTALLFILE}&quot; &quot;Field 13&quot; &quot;Text&quot; &quot;$SO&quot;<br />
         !insertmacro INSTALLOPTIONS_WRITE &quot;${REQINSTALLFILE}&quot; &quot;Field 14&quot; &quot;Text&quot; &quot;$DOTNET&quot;<br />
         !insertmacro INSTALLOPTIONS_WRITE &quot;${REQINSTALLFILE}&quot; &quot;Field 15&quot; &quot;Text&quot; &quot;$JAVA&quot;<br />
         <br />
         ; escrevendo a mensagen de OK ou ERRO, e indicando qual e/ou quais sao as causas<br />
         !insertmacro INSTALLOPTIONS_WRITE &quot;${REQINSTALLFILE}&quot; &quot;Field 10&quot; &quot;Text&quot; &quot;$MSG&quot;<br />
         <br />
         ${If} &quot;$DOTNET&quot; == &quot;ERRO&quot;<br />
               !insertmacro INSTALLOPTIONS_WRITE &quot;${REQINSTALLFILE}&quot; &quot;Field 11&quot; &quot;Text&quot; &quot;$MSGDN&quot;<br />
         ${EndIf}<br />
         <br />
         ${If} &quot;$JAVA&quot; == &quot;ERRO&quot;<br />
               !insertmacro INSTALLOPTIONS_WRITE &quot;${REQINSTALLFILE}&quot; &quot;Field 12&quot; &quot;Text&quot; &quot;$MSGJ&quot;<br />
         ${EndIf}<br />
         <br />
         ; titulo e subtitulo da pagina<br />
         !insertmacro MUI_HEADER_TEXT &quot;Pré-requisitos de funcionamento&quot;<br />
         !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;${REQINSTALLFILE}&quot;<br />
         <br />
         ${If} &quot;$DOTNET&quot; == &quot;ERRO&quot;<br />
         ${OrIf} &quot;$JAVA&quot; == &quot;ERRO&quot;<br />
                 MessageBox MB_OK|MB_ICONSTOP &quot;Finalizando instalador.&quot;<br />
                 Quit<br />
         ${EndIf}<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">18th November 2010, 08:26</div></div><div class="posttext">I am not sure about this, but is it possible to mix MUI and UMUI pages?<br />
<br />
Anyway: when you create a custom page, it MUST have a creator function.<br />
It should look like this:<br />
<br />
 Function customPage<br />
   GetTempFileName $R0<br />
   File /oname=$R0 customPage.ini ; &lt;&lt;&lt; HERE is ini file with definition of dialog controls<br />
   InstallOptions::dialog $R0 ; &lt;&lt; here the dialog is created<br />
   Pop $R1<br />
   StrCmp $R1 &quot;cancel&quot; done<br />
   StrCmp $R1 &quot;back&quot; done<br />
   StrCmp $R1 &quot;success&quot; done<br />
   error: MessageBox MB_OK|MB_ICONSTOP &quot;InstallOptions error:$\r$\n$R1&quot;<br />
   done:<br />
 FunctionEnd<br />
<br />
This function must be set for each custom page you have - in your case they should be named 'Requisito' and 'InfoReqs'<br />
See section 4.5.4 Page in NSIS help - http://nsis.sourceforge.net/Docs/Chapter4.html#4.5.4<br />
<br />
Please post that code for your installer - maybe you do something wrong in those functions because I can see only some writing to the INI files and actually no code for dialog creating<br />
<br />
By the way: For Modern UI 2 it is better to avoid using of these old .ini fiels and use nsDialogs instead of it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Deko Servidoni</div><div class="date">23rd November 2010, 15:29</div></div><div class="posttext">T.Slappy thanks for the help but i found the problem...<br />
<br />
The problem occurs on the another part of the code:<br />
<br />
   GetVersion::WindowsType<br />
   Pop $0<br />
   StrCpy $WINVER &quot;$WINVER $0&quot;<br />
<br />
<br />
So i used another method to get information about the windows and fix the problem.<br />
<br />
Thanks :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>