<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to make installer wait between two operations/exe executions, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to make installer wait between two operations/exe executions NSIS Discussion" />
	
	<title> How to make installer wait between two operations/exe executions [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to make installer wait between two operations/exe executions</div>
<hr />
<div class="pda"><a href="t-264044.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=264044">How to make installer wait between two operations/exe executions</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">20th January 2007, 07:01</div></div><div class="posttext">Currently I'm into an issue http://forums.winamp.com/showthread.php?s=&amp;threadid=263995.<br />
<br />
But I'm posting this post as a new to attract wider members from our NSIS forum. Can anyone tell me how to run the following two nsExec::Exec commands one by one. The 2nd command should be executed only after the 1st command has been completed completely.<br />
<br />
!define MUI_FINISHPAGE_RUN<br />
!define MUI_FINISHPAGE_RUN_FUNCTION &quot;ExecuteFinishPage&quot;<br />
<br />
Function ExecuteFinishPage<br />
    ; MSDE 2000 setup gets executed<br />
    nsExec::Exec &quot;$INSTDIR\setup.exe&quot;<br />
    ; after the msde installation<br />
    ; I want to start the SqL Service Manager by:<br />
    nsExec::Exec &quot;NET START MSSQLSERVER&quot;<br />
                OR<br />
    nsExec::Exec &quot;scm.exe -Action 1 -Service MSSQLSERVER -silent 2&quot;<br />
FunctionEnd<br />
<br />
Please note that there is no error in both the nsExec commands, both runs perfectly. The problem is that the installer after executing the 1st command does not waits to get the MSDE setup gets its installation completed, it goes on to execute the next available command. I've supplied even a simple MessageBox command, and it gets executed soon after invoking the MSDE setup. And due to this, my 2nd command is unable to start the SQL Service Manager as at that time MSDE installation is yet to be completed.<br />
<br />
I cannot use the 'SLEEP' command in between, as I don't know how long the MSDE setup will take to finish. And yes, I don't want to issue a 'REBOOT', and wants instantly to start the MSSQLSERVER Service after the MSDE setup. I'm running the msde setup(setup.exe) on default mode, this is good as the user can see the interface of msde installation.<br />
<br />
<br />
Sorry guys for taxing your patience with my long discussion.<br />
<br />
With regards,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">20th January 2007, 07:11</div></div><div class="posttext">I've an idea:<br />
<br />
nsExec::Exec &quot;$INSTDIR\setup.exe /wait&quot;<br />
<br />
let me try this, and will get back to this thread.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">20th January 2007, 10:18</div></div><div class="posttext">Perhaps the 1st setup is a wrapper which starts another setup, in this case you need to know if this wrapper supports switches, and the syntax for these switches.<br />
It might be better if you use ExecWait and capture the returned ErrorLevel.<br />
As for NsExec better use it with ExecToStack, see the documentation,<br />
http://nsis.sourceforge.net/Docs/nsExec/nsExec.txt</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th January 2007, 12:39</div></div><div class="posttext">Unattended has a page with a detailed list of all common installer switches. Use it to find out how to tell the MSDE installer to return only once it's done. For example, in some InstallShield installer, you must pass /SMS for that and For NSIS unisntallers, you must use _?=$INSTDIR. Also search the forum as this has been asked a few times before. Someone might have also posted the relevant switch from that page.<br />
<br />
http://unattended.sourceforge.net/installers.php</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">20th January 2007, 18:44</div></div><div class="posttext">Originally posted by Swapan Das <br />
I've an idea:<br />
<br />
nsExec::Exec &quot;$INSTDIR\setup.exe /wait&quot;<br />
<br />
let me try this, and will get back to this thread.  The MSDE setup does not need to be told to wait, it needs a parameter for the sa administrator password: &quot;setup.exe sapwd=&lt;YourNewSaAdministratorPassword&gt; /qn&quot;. The /qn switch will make it run silently.<br />
<br />
Check the information on MSDN: http://download.microsoft.com/download/d/5/4/d5402c33-65de-4464-9d82-d1de2971d9db/ReadmeMSDE2000A.htm#_3464462_msde_2000_setup_parameters_wluf</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">27th January 2007, 06:19</div></div><div class="posttext">Thanks to all of you for the valuable suggestions.<br />
I'm leaving town on an official tour for around 10 days.<br />
So will be able to resolve my this issue after my return.<br />
Will get back to this thread after 2 weeks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sanalnk</div><div class="date">16th February 2007, 07:10</div></div><div class="posttext">Hi <br />
Iam also facing the same problem.I would love to know how did you solved the problem<br />
&quot;How to make installer wait between two operations/exe executions&quot;</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>