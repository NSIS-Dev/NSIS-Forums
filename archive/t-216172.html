<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Finding path of &quot;Application Data&quot; folder in user's machine, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Finding path of &quot;Application Data&quot; folder in user's machine NSIS Discussion" />
	
	<title> Finding path of &quot;Application Data&quot; folder in user's machine [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Finding path of &quot;Application Data&quot; folder in user's machine</div>
<hr />
<div class="pda"><a href="t-216172.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=216172">Finding path of &quot;Application Data&quot; folder in user's machine</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">saurabhagarwal</div><div class="date">16th May 2005, 14:27</div></div><div class="posttext">Hi!<br />
<br />
While uninstalling I need to delete some files from user's machine. These files are there in the following path <br />
C:\Documents and Settings\develop\Application Data\MyFolder\abc.txt<br />
<br />
Upto &quot;Application Data&quot; we have system folders. MyFolder is user created folder. I need to delete file abc.txt from this folder.<br />
<br />
Now problem is that the path to Application Data folder may be different in different machines. Then how can I delete this file.<br />
<br />
Any any help will be greatly appreciated.<br />
<br />
Regards<br />
Saurabh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">16th May 2005, 14:51</div></div><div class="posttext">$APPDATA (http://nsis.sourceforge.net/Docs/Chapter4.html#4.2.3)<br />
The application data directory. Detection of the current user path requires Internet Explorer 4 and above. Detection of the all users path requires Internet Explorer 5 and above. The context of this constant (All Users or Current user) depends on the SetShellVarContext setting. The default is the current user.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">restools</div><div class="date">16th May 2005, 15:25</div></div><div class="posttext">--Now problem is that the path to Application Data folder may be different in different machines<br />
......<br />
......<br />
<br />
Section install<br />
  SetOutPath &quot;$APPDATA\MyFolder&quot;<br />
  File &quot;abc1.txt&quot;<br />
  File &quot;abc2.txt&quot;<br />
  File &quot;abc3.txt&quot;<br />
  FileOpen $0 $INSTDIR\Inst.log w<br />
  FileWrite $0 &quot;$APPDATA\MyFolder\abc1.txt$\r$\n&quot;<br />
  FileWrite $0 &quot;$APPDATA\MyFolder\abc2.txt$\r$\n&quot;<br />
  FileWrite $0 &quot;$APPDATA\MyFolder\abc3.txt$\r$\n&quot;<br />
  FileClose $0<br />
SectionEnd<br />
<br />
......<br />
......<br />
<br />
Section Uninstall<br />
  FileOpen $0 $INSTDIR\Inst.log r<br />
  read:<br />
  FileRead $0 $1<br />
  IfErrors close<br />
  Delete &quot;$1&quot;<br />
  Goto read<br />
  close:<br />
  FileClose $0<br />
SectionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>