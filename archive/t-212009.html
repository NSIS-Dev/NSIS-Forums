<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installation directory defaults to window' system32, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installation directory defaults to window' system32 NSIS Discussion" />
	
	<title> Installation directory defaults to window' system32 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installation directory defaults to window' system32</div>
<hr />
<div class="pda"><a href="t-212009.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=212009">Installation directory defaults to window' system32</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">John0xDEAD</div><div class="date">1st April 2005, 19:39</div></div><div class="posttext">I've made my own script file for installing several software components here at work. Once I run the final executable installer and get to choose the installation directory, most of the time it is ok and it defaults to application name, however often it rather defaults to windows' system32!!!<br />
<br />
It is quite problematic if someone just expect to click next, next, next and finish. Somehow when the browse button is clicked even though nothing was selected, the installation directory sometime comes back to what is expected.<br />
<br />
I've actually &quot;disabled&quot; two computers here at work ( my fault) because of this. Since I was lazy and didn't specifically add all of the files in the de-installation sequence (but rather used Delete &quot;$INSTDIR\*.*” to get rid of any remaining files, followed by RMDir &quot;$INSTDIR&quot;) unfortunately, the two times the installation defaulted to windows’ system32 install directory…you can then figure out that happened …<br />
<br />
Any clue why it often defaults to system32 ? Does it have to do with “current dir”?<br />
 <br />
In the script I do install few files in system32 but through the !insertmacro InstallLib macro. <br />
<br />
I am using the latest NSIS installer intallation ie.: 2.06<br />
<br />
And yes I have now fixed the de-installation sequence to be specific about files to delete :) Too bad that one have to learn lessons the hard way.<br />
<br />
Thank.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st April 2005, 20:32</div></div><div class="posttext">The current working directory is not used as the installation directory, unless you've used it to somehow calculate the installation directory. Not much can be said without the script. You should attach it so someone can check it out and tell you what might have gotten wrong.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">John0xDEAD</div><div class="date">1st April 2005, 20:45</div></div><div class="posttext">I didn't first posted the script, as I though it wouldn't usefull unless I also attach the equivalent entire tree (only relevant files) so someone can compile the script. <br />
<br />
Anyhow here it is.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st April 2005, 20:48</div></div><div class="posttext">Here's your problem:InstallDirRegKey HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot;<br />
# ...<br />
WriteRegStr HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot; &quot;$SYSDIR\FTD2XXUN.EXE&quot;You should be writing $INSTDIR to that key, not $SYSDIR.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">John0xDEAD</div><div class="date">1st April 2005, 22:04</div></div><div class="posttext">Wow, that was quick! You know your stuff quite well!<br />
<br />
I guess those particular lines slip me as I didn't added them myself.<br />
<br />
Thank you anyhow.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>