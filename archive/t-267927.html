<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Plugin fails on other machines, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Plugin fails on other machines NSIS Discussion" />
	
	<title> Plugin fails on other machines [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Plugin fails on other machines</div>
<hr />
<div class="pda"><a href="t-267927.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267927">Plugin fails on other machines</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dvalenitate</div><div class="date">17th March 2007, 12:42</div></div><div class="posttext">I have created a NSIS plugin using Visual Studio 2005. It works great on my XP system but on any other system it doesn't seem to be executed at all.<br />
<br />
Does anyone have an experience similar to this?<br />
<br />
Some more details:<br />
- If I compile the plugins from the NSIS site the same thing happens. My system: fine ; others : no execution<br />
<br />
- I have the Academic version of Visual Studio.<br />
<br />
- No errors occure when the plugin seems to fail to execute. Except that later things in my NSIS script that depended on results from the plugin to work don't work.<br />
<br />
- I have XP running in a Virtual PC on my machine as well. The DLLs I make work fine in this.<br />
<br />
Some side questions:<br />
- has anyone had much success with open source compilers with NSIS plugins?<br />
<br />
- does the Academic version of Visual Studio somehow limit the dll code it produces to the creator machine?<br />
<br />
- if I provided the code could someone else compile it and send me the resulting dll.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">17th March 2007, 13:34</div></div><div class="posttext">You should avoid msvcrt80 dependencies VS 2005 like to include. Replace vcrt calls with kernel functions (if any, wsprintf for example) or add your own functions (most of NSIS plug-ins include code for atoi variants). Tiny libc also helps sometimes. Or add MSCVRT redistributions to your package :) DependencyWalker (DEPENDS.EXE) can help to check situation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mr Inches</div><div class="date">18th March 2007, 00:29</div></div><div class="posttext">Further to Takhir's comment, the best place to run the Dependency Walker is on a plain vanilla installtion of Windows NT or Windows 2000. These operating systems include very old versions of the C runtime DLLs which VS2005 and VS2003 can't use. By running it on these systems, you will quickly see what your development PC has that your installation targets don't.<br />
<br />
Also, make sure you have not selected the multi-threaded DLL support for the MSCRT - I did this in an early version of CABSetup and it took one of the senior developers at my work to point out what I had done; I wouldn't have guessed it in a million years!<br />
<br />
Finally, check the MSDN to make sure that all of the functions your plugin uses are supported on your target platforms - some functions fail quietly or rely on you checking GetLastError.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dvalenitate</div><div class="date">18th March 2007, 02:58</div></div><div class="posttext">I will try your suggestions. Thanks for being so responsive!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">18th March 2007, 03:33</div></div><div class="posttext">msvcrt shipped with Win95B (OSR2.5 to be specific) and will be present on the original version if IE4 or WinSock or any kind of update is installed (It is also present on the Win95A CD IIRC) so it is pretty safe to build with the multi-threaded DLL version of the CRT IMHO</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">18th March 2007, 07:55</div></div><div class="posttext">BTW do not use debug build for distribution - msvcrtd.dll and mfc40d.dll will be absent in 99%! VS 6 is OK for most of Win versions (may be Win95 Gold not includes vcrt), but VS 2005 links to msvcrt80 and mfc80, and this is a problem almost everywhere.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dvalenitate</div><div class="date">19th March 2007, 09:15</div></div><div class="posttext">I compiled using Visual Studio 2002 and everything worked great.<br />
<br />
Thank you Microsoft for making life more complicated with progressive versions. Keeps things interesting. - Now with more productivity! Or not.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>