<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Running installed executable on a new process thread, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Running installed executable on a new process thread NSIS Discussion" />
	
	<title> Running installed executable on a new process thread [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Running installed executable on a new process thread</div>
<hr />
<div class="pda"><a href="t-301146.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=301146">Running installed executable on a new process thread</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">chamberlain</div><div class="date">17th December 2008, 12:16</div></div><div class="posttext">Hi All,<br />
<br />
I have an installer which calls the installer for MySQL 5.1. Once the MySQL and our installer have finished, the final wizard page allows the user to start our application.<br />
<br />
The problem is that our application is not given the true environment variables from Windows, only the environment variables that were present when the installer started (it is created as a child process). During this time, the MySQL installer may or may not have altered the environment variables. Our application reports an error which disappears if you exit the application and start it again (so that it takes the current environment variables).<br />
<br />
Is there a clean way of starting our installer application in a truly new process from Windows at the end of our installer? Or is there a way for child processes to get the current environment variables and not a copy from the main installer process?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th December 2008, 20:25</div></div><div class="posttext">There probably is a way to do it, maybe by running explorer.exe and having it run the application for you, but I don't know of one. What I'm sure will work is manually setting those environment variables by calling SetEnvironmentVariable. That would require you to know exactly which variables are set.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chamberlain</div><div class="date">18th December 2008, 07:25</div></div><div class="posttext">Thanks for the reply kichik.<br />
<br />
The problem with using SetEnvironmentVariable is that I would need to know the value of the install directory of MySQL, which the user can always change via the MySQL installer.<br />
<br />
What I could do is put in a check to see if MySQL is installed to the default location. If it is, then I can call SetEnvironmentVariable and then allow the user to start the executable at the end of installation. If it is not present in the default location, then perhaps I can disable/hide the start option on the final page, or even replace it with a &quot;reboot required&quot; message.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th December 2008, 07:55</div></div><div class="posttext">Doesn't MySQL write that value somewhere in the registry as well? At the very minimum, environment variables are written to HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chamberlain</div><div class="date">19th December 2008, 08:43</div></div><div class="posttext">Good point! I am not sure whether that registry variable will contain the updated value from MySQL, but I will investigate it as that would be a cleaner solution to just pass the updated path to the sub process. <br />
<br />
That way, our installer does not need to know about sub-installers in case we add or remove them in the future.<br />
<br />
I will test this solution.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chamberlain</div><div class="date">19th December 2008, 10:37</div></div><div class="posttext">Ok, I tried that and it would have worked, if weren't for the fact that the separate MySQL installer we have runs the MySQL configuration wizard as a sub-process. <br />
<br />
This means it tries to pass an updated PATH variable to our application which has not yet been updated.<br />
<br />
To get around this problem, I have disabled the &quot;Start application&quot; option from the final wizard page. We have several different versions of the installer (standard, full and express) and this issue only affects the full version where the user has complete control of the MySQL installer. This means that we can never guarantee that the user configures MySQL correctly and consequently cannot guarantee that the &quot;start application&quot; option will work.<br />
<br />
For our other installers this isn't a problem as MySQL either exists already on the end system, or we have control of the MySQL installer.<br />
<br />
Many thanks for the tips kichik!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>