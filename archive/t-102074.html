<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ReadRegStr, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ReadRegStr NSIS Discussion" />
	
	<title> ReadRegStr [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ReadRegStr</div>
<hr />
<div class="pda"><a href="t-102074.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=102074">ReadRegStr</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MysticEmpires2k</div><div class="date">26th August 2002, 21:16</div></div><div class="posttext">I have a littel problem.I want read the install dir from the reg.But i get a &quot;&quot; in the installdir.Waht is wrong.<br />
<br />
  Function GetMyInstPath<br />
  ReadRegStr $0 HKCU &quot;Software\Mysoft&quot; &quot;MyDir&quot;<br />
  FunctionEnd<br />
<br />
<br />
; The default installation directory<br />
InstallDir $0<br />
<br />
; The text to prompt the user to enter a directory<br />
DirText &quot;This will install the very simple example1 on your computer. Choose a directory&quot;<br />
<br />
; The stuff to install<br />
Section &quot;ThisNameIsIgnoredSoWhyBother?&quot;<br />
  ; Set output path to the installation directory.<br />
  SetOutPath $INSTDIR<br />
  ; Put file there<br />
  File &quot;C:\windows\notepad.exe&quot;<br />
SectionEnd ; end the section<br />
<br />
; eof<br />
<br />
<br />
I'am a beginner and my english is not very god.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th August 2002, 21:25</div></div><div class="posttext">A function doesn't get called by itself, you must call it from a section or a callback function. Anyway, you don't need to do it yourself, just use InstallDirRegKey.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MysticEmpires2k</div><div class="date">26th August 2002, 22:23</div></div><div class="posttext">Ok thx.But i have a problem to i have crate this on c++ <br />
<br />
	CRegKey key;<br />
    if( key.Open( HKEY_CURRENT_USER, &quot;Software\\mysoft&quot;) == ERROR_FILE_NOT_FOUND)<br />
    {<br />
    fprintf(fp,&quot;InstallDirRegKey HKEY_LOCAL_MACHINE `SOFTWARE\\mysoft` `MyDir`\n&quot;);<br />
	}<br />
	else<br />
	{<br />
    fprintf(fp,&quot;InstallDirRegKey HKEY_CURRENT_USER `Software\\mysoft1` `MyDir`\n&quot;);<br />
	}<br />
<br />
but i can't srcibt it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th August 2002, 22:55</div></div><div class="posttext">If you have two possible install directories, manage them in .onInit.<br />
<br />
Function .onInit<br />
  ReadRegStr $INSTDIR HKLM &quot;Software\\mysoft1&quot; &quot;myDir&quot;<br />
  IfErrors 0 done<br />
    ; if we couldn't read the reg key read the second one<br />
    ReadRegStr $INSTDIR HKLM &quot;Software\\mysoft2&quot; &quot;myDir&quot;<br />
    IfErrors 0 done<br />
      ; if we can't read this one either just use default<br />
      StrCpy $INSTDIR &quot;$PROGRAMFILES\MyProg&quot;<br />
  done:<br />
FunctionEnd<br />
<br />
InstallDirRegKey makes the installer read from the specified registry key when the it starts, and if can't read, just return to the default InstallDir.<br />
<br />
.onInit is a callback function that the installer calls before it shows any dialogs, so you can initialize stuff in there such as the installation directory.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>