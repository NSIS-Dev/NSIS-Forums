<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" HKCR HKLM HKCU write permissions, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  HKCR HKLM HKCU write permissions NSIS Discussion" />
	
	<title> HKCR HKLM HKCU write permissions [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  HKCR HKLM HKCU write permissions</div>
<hr />
<div class="pda"><a href="t-122968.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=122968">HKCR HKLM HKCU write permissions</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">titoo</div><div class="date">27th January 2003, 15:06</div></div><div class="posttext">Hi all,<br />
<br />
In my install I set some registry keys in:<br />
!define CAPEC_SK &quot;Software\CAPEC\ICAS\Structure&quot;<br />
<br />
WriteRegStr HKCU &quot;${CAPEC_SK}&quot; &quot;MainPath&quot; &quot;$INSTDIR&quot;<br />
<br />
WriteRegStr HKLM &quot;${CAPEC_SK}&quot; &quot;MainPath&quot; &quot;$INSTDIR&quot;<br />
<br />
WriteRegStr HKCR &quot;.ICS&quot; &quot;&quot; &quot;ICAS.Document&quot;<br />
<br />
My problem is to know if the user has the right to do that, even if he is not Administrator.<br />
For example a poweruser, or a user with some rights etc...<br />
<br />
Do you know if by default a power user can write in these keys?<br />
The right managment is a bite of mystery for me in this Windows registry. Unix is much more simple!<br />
<br />
By the way, why this question?<br />
<br />
It is because we have created a software which need to be installed on computer of big company members. These people have sometime limited access to their computer, (no administrator rights, but a mix) so if a request them to have admin rights to install the software, they will need to call their IT department and ask to install the software, but it will be done under the &quot;administrator&quot; account, and then for the shortcuts etc... it is a mess.<br />
<br />
Thank you...<br />
titoo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th January 2003, 15:13</div></div><div class="posttext">What you can do to find out is read the value out of the key in question and then try to write the same value back to it. If you get an error (use IfErrors) then the user can't write there.<br />
<br />
The right managment is a bite of mystery for me in this Windows registry. Unix is much more simple!<br />
<br />
I fully agree :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">titoo</div><div class="date">27th January 2003, 15:21</div></div><div class="posttext">:) Thank you! I will look at the IfError function and do that.<br />
<br />
titoo</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>