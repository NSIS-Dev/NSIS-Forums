<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Detect .NET Compact Framework using NSIS Script, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Detect .NET Compact Framework using NSIS Script NSIS Discussion" />
	
	<title> Detect .NET Compact Framework using NSIS Script [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Detect .NET Compact Framework using NSIS Script</div>
<hr />
<div class="pda"><a href="t-220784.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=220784">Detect .NET Compact Framework using NSIS Script</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Salimgbelim</div><div class="date">6th July 2005, 09:32</div></div><div class="posttext">Hi guys, <br />
<br />
Need some help regarding NSIS script to package my application. <br />
<br />
Q-1.I want is to detect if .netcf(.NET Compact framework) is installed on device if not install <br />
install the framework then install my application. <br />
<br />
Q-2.I want to install appropriate Cab (ARM/ARM4/SH3 etc..)files depending on the device.setup should detect the Operating system of device and install cab's accordigly<br />
<br />
Is it possible using NSIS? Have anyone done it before? <br />
<br />
Regards <br />
Salim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th July 2005, 11:30</div></div><div class="posttext">You should look on the NSIS Wiki (http://nsis.sourceforge.net/wiki)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Salimgbelim</div><div class="date">6th July 2005, 13:12</div></div><div class="posttext">Wiki Haven't got any example for mobile! :( :hang:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jmycr</div><div class="date">6th July 2005, 14:57</div></div><div class="posttext">EnumRegValue $1 HKLM SOFTWARE\Microsoft\.NETFramework 0<br />
<br />
  StrCmp $1 &quot;&quot; no_framework framework<br />
<br />
no_framework:<br />
InetLoad::load &quot;http://dotnetfx.exe&quot; &quot;$INSTDIR\dotnetfx.exe&quot;<br />
Execwait '&quot;$INSTDIR\dotnetfx.exe&quot;'<br />
<br />
framework:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Salimgbelim</div><div class="date">6th July 2005, 16:41</div></div><div class="posttext">Thanks for the reply.<br />
<br />
but,I think this code detects for .net compact framework on computer from where we are installing the system,but what i want is to check on device.<br />
<br />
Is it possible to somehow run something on device prior to installing the application which can detect the framework and return true/false?<br />
<br />
Regards<br />
<br />
Salim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">6th July 2005, 17:17</div></div><div class="posttext">What kind of operating systems exist on the device? If it's just Windows, you can try the Detect Windows Version function which you'll find in the NSIS Manual under Useful Scripts.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Salimgbelim</div><div class="date">6th July 2005, 17:29</div></div><div class="posttext">i got Orange M2000 which runs pocket pc 2003 OS.well for pocket pc 2003 it comes with .netCF but say e.g i want to install my application on some device which runs pocket pc 2002 OS (which doesn't come with compact framework) so i need a way during installing the application to detect on device.<br />
<br />
Regards<br />
Salim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th July 2005, 15:43</div></div><div class="posttext">Can you access the registry regedit on there? There's probably some registry entries there that identify which OS it us. Otherwise there should be some API function which returns the OS name / version which you could call with the System plugin (but I can't help you with that!)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Salimgbelim</div><div class="date">7th July 2005, 17:51</div></div><div class="posttext">Yes I can access the registery settings in Pocket PC,but i don't know how to access the pocket pc registery from NSIS script? :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th July 2005, 18:14</div></div><div class="posttext">ReadRegStr?<br />
There are a lot of registry and INI file instructions in the NSIS manual.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">0ddJob</div><div class="date">3rd August 2005, 17:05</div></div><div class="posttext">Taken the below from MSDN, any dieas how to do in NSIS script? Or any other ideas?<br />
<br />
<br />
<br />
Detecting the Microsoft .NET Compact Framework<br />
<br />
You will need to create a .dll which can be invoked as a custom action from the MSI file.<br />
<br />
Begin by connecting to the device using CeRapiInitEx.<br />
<br />
Use CeFindAllFiles to search the device's Windows directory for GAC_mscorlib_*.dll. If that is present, some flavor of the .NET Compact Framework is installed on the device.<br />
<br />
Query the device registry and enum the values in HKLM\SOFTWARE\Microsoft\.NETCompactFramework. You should find registry keys which represent the build of NETCF that is present. (e.g. 1.0.2268.00:REG_DWORD:0). This version is created by all .cab installs and is included on all future ROM installs. It was missing from the initial ROM install of the RTM .NET Compact Framework, so if you do not find it, assume the value is 1.0.2268.0.<br />
<br />
At this point you should know whether the .NET Compact Framework is present, and whether you need to deploy your own version to the device. If you also need to deploy the SQL CE files, you can use a similar mechanism of searching the Windows directory for the GAC'd libraries. The SQL install does not post its version to the registry, so the only way to know the build version would be to read the Win32 resources of the .dll. In the sample I have opted to always install the SQL .cabs if they are required. This should be safe, because CE installer will prevent an inadvertent downgrade of the SQL packages on the device. A similar approach could be taken with the .NET Compact Framework as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th August 2005, 18:24</div></div><div class="posttext">To call CeFindAllFiles, use the System plug-in. To enumerate the registry, use EnumRegKey and EnumRegValue. There are some examples for enumeration in the Wiki.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BULLETUK</div><div class="date">2nd October 2006, 07:36</div></div><div class="posttext">Has anybody got a solution for this? I've tried and tried to get CF.NET SP1 to be included in my NSIS script. But everytime it fails with the error:<br />
<br />
&quot;Application Manager cannot install this application on your mobile device due to an invalid setup file.&quot;<br />
<br />
Please take a look at the attached script. Thanks for any assistance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">6th October 2006, 16:29</div></div><div class="posttext">Make sure the setup file fits the device you're trying to install it on. There is usually a different executable for each platform. The OS version might not fit as well...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>