<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Display message on main screen while performing ExecWait, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Display message on main screen while performing ExecWait NSIS Discussion" />
	
	<title> Display message on main screen while performing ExecWait [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Display message on main screen while performing ExecWait</div>
<hr />
<div class="pda"><a href="t-304608.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=304608">Display message on main screen while performing ExecWait</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ghat</div><div class="date">25th March 2009, 18:31</div></div><div class="posttext">Hi,<br />
<br />
I am using MUI from the wizard in HM NSI edit. I need to stop a service before installing the main files and start the service back after installing the files. <br />
<br />
Something like<br />
<br />
ExecWait net stop service_name<br />
 //install the files<br />
ExeWait net start service_name<br />
<br />
I want to display the feed back message like &quot;Stopping the service..&quot; and &quot;Starting the Service..&quot;  while waiting for the service to stop and start on the main Installation window. Is it possible.<br />
<br />
Any help is appreciated. Hope I was clear.<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">25th March 2009, 18:54</div></div><div class="posttext">if this is something you do during intallation (e.g. from within a section), you could just use DetailPrint to put the message up with the rest of the progress messages.  Alternatively, use one of the many banner type plugins such as 'animate' to pop up a little dialog before you call the 'net stop' command, and kill that dialog once execwait (or whatever you end up using) returns.<br />
<br />
You may also want to have a look at this page regarding handling Services with NSIS:<br />
http://nsis.sourceforge.net/How_do_I_start/stop/create/remove/check_a_service</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ghat</div><div class="date">26th March 2009, 15:33</div></div><div class="posttext">Thanks I got that. Now I am trying to use NSIS_Simple_Service plugin since it seems a much better way to deal with services. But I am unable to capture the error. How do I check the return values?<br />
<br />
&quot; SimpleSC::GetServiceStatus &quot;MyService&quot;<br />
  Pop $0 ; returns an errorcode (&lt;&gt;0) otherwise success (0)<br />
  Pop $1 ; return the status of the service&quot;<br />
<br />
I want to call SimpleSC to get current status of service. If it is already runnign I ignore or I start the service and if any error occurs I would display a message.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">26th March 2009, 20:12</div></div><div class="posttext">something like this...<br />
<br />
!addplugindir &quot;.&quot;<br />
!addincludedir &quot;.&quot;<br />
<br />
!include &quot;nsDialogs.nsh&quot;<br />
!include &quot;winmessages.nsh&quot;<br />
!include &quot;logiclib.nsh&quot;<br />
<br />
OutFile &quot;test.exe&quot;<br />
<br />
Page Custom Test<br />
<br />
Function Test<br />
	SimpleSC::GetServiceStatus &quot;WZCSVC&quot; ; Wireless Zero Configuration<br />
	Pop $0<br />
	Pop $1<br />
	${If} $0 != 0<br />
	    MessageBox MB_OK &quot;An error occurred while attempting to get the service's status.  The service may not exist.&quot;<br />
	${Else}<br />
		${Select} $1<br />
			${Case} 1<br />
			    MessageBox MB_OK &quot;SERVICE_STOPPED - The service is present but is currently stopped.&quot;<br />
			${Case} 2<br />
			    MessageBox MB_OK &quot;SERVICE_START_PENDING - The service is present and is currently waiting to be (re)started by the system.&quot;<br />
			${Case} 3<br />
			    MessageBox MB_OK &quot;SERVICE_STOP_PENDING - The service is present and is currently waiting to be stopped by the system.&quot;<br />
			${Case} 4<br />
			    MessageBox MB_OK &quot;SERVICE_RUNNING - The service is present and is currently started (running).&quot;<br />
			${Case} 5<br />
			    MessageBox MB_OK &quot;SERVICE_CONTINUE_PENDING - The service is present and is currently waiting to be unpaused by the system.&quot;<br />
			${Case} 6<br />
			    MessageBox MB_OK &quot;SERVICE_PAUSE_PENDING - The service is present and is currently waiting to be paused by the system.&quot;<br />
			${Case} 7<br />
			    MessageBox MB_OK &quot;SERVICE_PAUSED - The service is present and is currently paused.&quot;<br />
		${EndSelect}<br />
	${EndIf}<br />
FunctionEnd<br />
<br />
Section<br />
SectionEnd<br />
<br />
<br />
Note that - in case you hadn't noticed - you need the name of the service, not its title.  You can find the name via the services control panel, for example, in the service's properties panel.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>