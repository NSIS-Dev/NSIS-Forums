<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Universal 32 and 64-bit installers, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Universal 32 and 64-bit installers NSIS Discussion" />
	
	<title> Universal 32 and 64-bit installers [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Universal 32 and 64-bit installers</div>
<hr />
<div class="pda"><a href="t-330124.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330124">Universal 32 and 64-bit installers</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">28th April 2011, 19:45</div></div><div class="posttext">Hi,<br />
<br />
I like to maintain one installer for our software which has 32-bit and 64-bit versions of the binaries (exes and dlls).<br />
<br />
Most of the support libraries are shared, but on a 32-bit, 64-bit system, it should install into the correct program files directory.  are there any known issues with doing this?  is there an easy way to avoid redundancy in installing the files since I don't want to copy and paste the 75 or so shared files so i can do the if architecture == 64 do this, else do that since there are really only 10 files that is needed to be in the 64-bit folders.  <br />
<br />
i am going to have x64 and x86 in the src tree of my nsis installer so it can reference it properly, but for the rest of the files, I don't want to just copy everything twice.<br />
<br />
is this achievable, or do i need to maintain separate installers for both architectures.<br />
<br />
thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">28th April 2011, 20:05</div></div><div class="posttext">You're not being entirely clear on what exactly you want to accomplish. If you're asking about runtime differentiation between 32 bit and 64 bits operating system, use the macros in x64.nsh. (A simple search would've told you this.)<br />
<br />
If you're talking about compiletime differentiation so you can build two kinds of installer with only one .nsi file, you can use makensis's /D parameter to define YourDefine, and use !ifdef YourDefine etc in your script. You can find this info in chapter 3 of the manual.  http://nsis.sourceforge.net/Docs/Chapter3.html</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">28th April 2011, 20:15</div></div><div class="posttext">Sorry for not being clear.  I know how to do 64-bit differentiation.  I did a search what I want to do, but what I want to do I think is maybe unique.<br />
<br />
To simplify things, my installer say installs about 100 files.  I want to use the same installer on any machine (32 or 64-bit).  When the installer installs, it automatically copies the appropriate files to the appropriate program files folder.  <br />
<br />
My question is, do I need to have the if statement on the top of the code when it gets installed for the correct program files folder flag gets set correctly (I am assuming $PROGRAMFILES is determined at runtime?)  How does it get determined if it goes into Program Files (x86) or Program Files where 64-bit compiled programs go?<br />
<br />
That is where I think I am not understanding the workflow on how this should be accomplished.  <br />
<br />
So say 15 of those 100 files is what is compiled for 64-bit systems.  So in my nsis src folder, I have x64 folder with those 15 files, a x86 folder where 15 of those files are that are 32-bit, and the remaining 85 files are in main src folder, the parent folder.  <br />
<br />
Is NSIS smart enough for me to just reference the x64 or x86 folders and still copy the rest of the support files I need to install.<br />
<br />
I hope this was more clear.<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">28th April 2011, 20:44</div></div><div class="posttext">$PROGRAMFILES always points to the 32bits version (usually called &quot;Program Files (x86)&quot; on 64 bits windows), because NSIS is a 32 bits application. To install something to x64 program files, use $PROGRAMFILES64. See chapter 4 of the manual:  http://nsis.sourceforge.net/Docs/Chapter4.html#4.2.3<br />
<br />
So in code:<br />
${If} ${RunningX64}<br />
  SetOutPath &quot;$PROGRAMFILES64\YourPath&quot;<br />
  File x64file1.ext<br />
  File x64file2.ext<br />
  File x64file3.ext<br />
{Else}<br />
  SetOutPath &quot;$PROGRAMFILES\YourPath&quot;<br />
  File x68file1.ext<br />
  File x68file2.ext<br />
  File x68file3.ext<br />
${EndIf}<br />
File commonfile1.ext<br />
File commonfile2.ext<br />
File commonfile3.ext</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jweinraub</div><div class="date">28th April 2011, 20:57</div></div><div class="posttext">I see, so the common files will still install in its proper folder of Programfiles64 / 32 then, i think i get it now.<br />
<br />
thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th April 2011, 21:53</div></div><div class="posttext">$PROGRAMFILES64 will have the same value as $PROGRAMFILES on 32-bit Windows so you can just use $PROGRAMFILES64 throughout although using both is probably good for code readability.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>