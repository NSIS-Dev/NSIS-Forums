<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Word Global Templates, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Word Global Templates NSIS Discussion" />
	
	<title> Word Global Templates [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Word Global Templates</div>
<hr />
<div class="pda"><a href="t-292571.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=292571">Word Global Templates</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jalamb</div><div class="date">1st June 2008, 10:36</div></div><div class="posttext">I am trying to write an installation for a Word global template. This means copying a file to the Word startup area. The Word startup area is either default or defined in the registry, but the registry name depends on the version of Word and to get the Word version reliably requires running Word. This shell script will display the version:<br />
<br />
Set objWord = CreateObject(&quot;Word.Application&quot;)<br />
Set objOptions = objWord.Options<br />
Wscript.Echo &quot;Version: &quot; &amp; objWord.Version<br />
objWord.Quit<br />
<br />
but I can't work out how to call it and get the value of objWord.Version back into NSIS.<br />
I could pass it back as an result code, but that will only allow an integer and the value will be something like &quot;11.0&quot;.<br />
I thought maybe I should write it to a file and then read the file from within NSIS, but it looks tricky working out where to write the file. Is that the right way to go?<br />
Any nudge in the right direction would be appreciated.<br />
J.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st June 2008, 10:51</div></div><div class="posttext">Use nsExec::ExecToStack with `&quot;$SYSDIR\wscript.exe&quot; &quot;path\to\file.vbs&quot;` (notice the double quotes) and then Pop $R0.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jalamb</div><div class="date">1st June 2008, 11:17</div></div><div class="posttext">I will look into that - thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">1st June 2008, 12:49</div></div><div class="posttext">no need to call a external script, you can call COM objects with the system plugin, the system plugin readme has a COM example</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th June 2008, 10:04</div></div><div class="posttext">Isn't $TEMPLATES good enough?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jalamb</div><div class="date">7th June 2008, 10:21</div></div><div class="posttext">Isn't $TEMPLATES good enough? <br />
<br />
No, 'fraid not.<br />
Word has three template areas - user templates (which probably defaults to $TEMPLATES), group templates and global templates (which is the Word Startup area). Global templates get different security privileges to the others, so is the one to use if you need to include toolbars with the template.<br />
<br />
All of these template areas can be overridden in Word by the user, in which case their new values are held in the registry.<br />
<br />
In addition, you can have more than one version of Word installed on a machine - I have 2003 and 2007 - perhaps one might be a demo version or you might have multiple versions for testing software.<br />
<br />
So I have 6 potential different template areas, and, as I said, the registry keys depend on the version of Word.<br />
I did think that I could simply ask Word what it value for Startup was, but that gives another value altogether!<br />
<br />
I have now successfully coded it up using nsExec</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>