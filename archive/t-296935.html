<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstaller not deleting start menu shortcuts, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstaller not deleting start menu shortcuts NSIS Discussion" />
	
	<title> Uninstaller not deleting start menu shortcuts [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstaller not deleting start menu shortcuts</div>
<hr />
<div class="pda"><a href="t-296935.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=296935">Uninstaller not deleting start menu shortcuts</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bubustoober</div><div class="date">5th September 2008, 06:18</div></div><div class="posttext">Using NSIS 2.37, target machines experiencing the problem are running Win XP SP2 and Win Server 2003 R2 SP2. My uninstaller is not deleting the start menu shortcuts, let alone the start menu folders that were created upon installation. It does delete all the other files it originally installed - the only problem is with the start menu folders and shortcuts. I'm new to NSIS - any help would be appreciated. Thanks!<br />
<br />
This is my NSIS code to install the start menu shortcuts and folders (works fine):<br />
;Create start menu shortcuts in the start menu programs directory, pointing each shortcut to the appropriate executable, assigning each the RM Dash icon 		<br />
CreateDirectory &quot;$SMPROGRAMS\RM Dashboard&quot; 		<br />
CreateDirectory &quot;$SMPROGRAMS\RM Dashboard\$Project_name&quot;<br />
createShortCut &quot;$SMPROGRAMS\RM Dashboard\$Project_name\Run Administrator Console.lnk&quot; &quot;$SYSDIR\wscript.exe&quot; '/B &quot;$INSTDIR\Run Administrator Console.vbs&quot;' &quot;$INSTDIR\RMDash-Icon-V2.ico&quot;<br />
createShortCut &quot;$SMPROGRAMS\RM Dashboard\$Project_name\Run Company Configuration Console.lnk&quot; &quot;$SYSDIR\wscript.exe&quot; '/B &quot;$INSTDIR\Run Company Configuration Console.vbs&quot;' &quot;$INSTDIR\RMDash-Icon-V2.ico&quot;<br />
createShortCut &quot;$SMPROGRAMS\RM Dashboard\$Project_name\Run Requirement Metrics Dashboard.lnk&quot; &quot;$SYSDIR\wscript.exe&quot; '/B &quot;$INSTDIR\Run RMD.vbs&quot;' &quot;$INSTDIR\RMDash-Icon-V2.ico&quot;<br />
createShortCut &quot;$SMPROGRAMS\RM Dashboard\$Project_name\Product Training Presentation.lnk&quot; &quot;$INSTDIR\Requirement Metrics Dashboard Training 0.52.ppt&quot; <br />
createShortCut &quot;$SMPROGRAMS\RM Dashboard\$Project_name\Uninstall.lnk&quot; &quot;$INSTDIR\Uninstall.exe&quot;  <br />
<br />
<br />
This is my NSIS uninstaller code to remove the start menu shortcuts and folders (compiles but does not remove anything):<br />
;Remove start menu shortcuts and folders 		 <br />
delete &quot;$SMPROGRAMS\RM Dashboard\$Project_name\Run Administrator Console.lnk&quot; <br />
delete &quot;$SMPROGRAMS\RM Dashboard\$Project_name\Run Company Configuration Console.lnk&quot; <br />
delete &quot;$SMPROGRAMS\RM Dashboard\$Project_name\Run Requirement Metrics Dashboard.lnk&quot; <br />
delete &quot;$SMPROGRAMS\RM Dashboard\$Project_name\Product Training Presentation.lnk&quot; <br />
delete &quot;$SMPROGRAMS\RM Dashboard\$Project_name\Uninstall.lnk&quot; <br />
RMDir &quot;$SMPROGRAMS\RM Dashboard\$Project_name&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">5th September 2008, 07:45</div></div><div class="posttext">why is $Project_name a variable and not a define? Are you setting it to the same value in the uninstaller AND the installer? Try MessageBox mb_ok &quot;$SMPROGRAMS\RM Dashboard\$Project_name\&quot; in the uninstaller and make sure the path is correct</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bubustoober</div><div class="date">5th September 2008, 22:02</div></div><div class="posttext">The message box revealed that the uninstaller is trying to delete the start menu shortcuts and folders from the *username's* start menu (e.g. C:\Documents and Settings\username\Start Menu\Programs\RM Dashboard\). However, the start menu shortcuts and folders are installed to *all users* start menu (C:\Documents and Settings\All Users\Start Menu\Programs\RM Dashboard\). I want the shortcuts and folders to be installed to all users' start menu, so how do I direct the uninstaller to delete those?<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">6th September 2008, 08:55</div></div><div class="posttext">SetShellVarContext all</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bubustoober</div><div class="date">7th September 2008, 06:30</div></div><div class="posttext">I think I'm getting bitten by having my $Project_name in a var instead of a define. I have it as a var right now because user input during the install process sets this var. However my Uninstall section needs to know this var too. How can I get my Uninstall section to know about the $Project_name var set by the user during installation? Upon closer inspection, the MessageBox was showing the path with a missing folder (note &quot;\\&quot; between &quot;Dashboard&quot; and &quot;Run&quot;):<br />
<br />
C:\Documents and Settings\All Users\Start Menu\Programs\RM Dashboard\\Run Administrator Console.lnk<br />
<br />
There should be a project folder between the two backslashes. That message box was driven by this code:<br />
<br />
MessageBox mb_ok &quot;$SMPROGRAMS\RM Dashboard\$Project_name\Run Administrator Console.lnk&quot;<br />
<br />
The $Project_name variable works in all the other sections but the Uninstall section does not appear to be able to read it. Any ideas?<br />
<br />
Thanks for your help!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">7th September 2008, 09:29</div></div><div class="posttext">save it in the registry or a ini file during install and restore it in the uninstaller (it is also possible to save stuff inside the uninstaller at the end of the exe)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>