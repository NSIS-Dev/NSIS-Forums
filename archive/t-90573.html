<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Closing an Application if running, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Closing an Application if running NSIS Discussion" />
	
	<title> Closing an Application if running [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Closing an Application if running</div>
<hr />
<div class="pda"><a href="t-90573.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=90573">Closing an Application if running</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">simham_uk</div><div class="date">10th June 2002, 14:25</div></div><div class="posttext">Can anyone explain how to, if possible, detect if an application is running (I have seen ways of detecting Windows, but what if it has no window - systray icon only), and if so, stop it.<br />
<br />
I'm trying to create an AutoUpdate thingy if possible.<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">10th June 2002, 14:48</div></div><div class="posttext">Hmmm, I seem to repeat myself :( :<br />
<br />
Search the Forum and find for instance:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=87330<br />
<br />
Please everyone search the Forum before posting. A lot of questions have already been answered! Check this (http://forums.winamp.com/showthread.php?s=&amp;threadid=62363) out!<br />
<br />
-Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th June 2002, 15:24</div></div><div class="posttext">Message to the systray icon goes to a window proc of the window that it belongs to. The window can be hidden but it is there. You need to find the name or the class name of the window that this icon belongs to and then send it WM_CLOSE.<br />
<br />
You can find some usuful info in the post Smile2Me sent you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">simham_uk</div><div class="date">10th June 2002, 20:06</div></div><div class="posttext">The Kill WA3 function worked just fine, thanks guys!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th June 2002, 08:54</div></div><div class="posttext">Which one worked? I hope you didn't use TerminateProcess, it is pretty brutal and unwanted.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">simham_uk</div><div class="date">11th June 2002, 09:41</div></div><div class="posttext">Hi Amir<br />
<br />
I used the FindWindow and SendMessage to close it and it worked great.<br />
<br />
I have nearly completed an online updater (my first decent project with NSIS).<br />
<br />
It will:<br />
<br />
<br />
- close the app if still running (actually it will wait for 1 app to stop, then it will close another itself and continue)<br />
- Check existing versions and write to CURversions.ini<br />
- Download NEWVersions.ini and compare<br />
- Download files as needed (zip2exe's with no popups)<br />
- Extract to their locations (Reg and UnReg DLL's as required)<br />
- Run the app again when done<br />
<br />
etc, etc.<br />
<br />
It still needs improvement I'm sure!<br />
<br />
My only concern is how do I ensure they have an internet connection.  Will the downloader invoke the default connection if required?  (I'm thinking of Dialup's).<br />
<br />
I read another post on this subject where someone was developing a DLL to do this, and had proxy support as well, but the thread died in July last year....I'll send them a message and see if it got finished.  The only thing I didn't like was that it prompted for the Updates to continue and stuff.  My solution is to be automated.  It would be easy to add an ini entry to set if you want prompted before updating!!<br />
<br />
I have attached my .nsi and the CURVersions.ini for anyone to see and comment on.<br />
<br />
Thanks for all your help Amir, and everyone else!!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>