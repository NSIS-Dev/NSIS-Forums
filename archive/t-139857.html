<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Path Manipulation - square box character?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Path Manipulation - square box character? NSIS Discussion" />
	
	<title> Path Manipulation - square box character? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Path Manipulation - square box character?</div>
<hr />
<div class="pda"><a href="t-139857.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=139857">Path Manipulation - square box character?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">SprinklerHead</div><div class="date">23rd June 2003, 16:25</div></div><div class="posttext">This is in reference to the path manipulation functions here:<br />
http://nsis.sourceforge.net/archive...e.php?pageid=91<br />
<br />
I am using the path manipulation functions mentioned above. On Win9x based machines the functions add a path to the end of autoexec.bat (SET PATH=%PATH%;mydir). But on some machines there is a weird square character just above the SET PATH line. I am not positive what this square character is, but SET PATH never gets executed. Any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SprinklerHead</div><div class="date">23rd June 2003, 16:26</div></div><div class="posttext">Try that link again...<br />
<br />
http://nsis.sourceforge.net/archive/viewpage.php?pageid=91</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th June 2003, 12:56</div></div><div class="posttext">Does that square character appear after the line too? Can you please attach the autoexec.bat file? What version of Windows have you tested it on?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SprinklerHead</div><div class="date">25th June 2003, 14:01</div></div><div class="posttext">The square character does not occur after the line, only just before it. This occurred on several Windows 98 machines. I have tested on all versions of Windows. It seems to only occur on some Windows 98 machines. <br />
<br />
My guess is that the square box character is an end of file character or a non-printable character. My gut feeling is that some autoexec.bat files have this character and some don't. That would explain why it only occurs on some Windows 98 boxes, not all.<br />
<br />
I fixed the machine here in the office that had this problem already, so I no longer have an autoexec.bat to send you. If another user reports the problem (one called last week but I told him how to fix), I will get them to email it to me and I will post it here.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SprinklerHead</div><div class="date">25th June 2003, 15:32</div></div><div class="posttext">Here is an example autoexec.bat file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">25th June 2003, 22:25</div></div><div class="posttext">As you suspected, in the cases where things go wrong there is an end-of-file character at the end of the file to which you are adding the path. In your ZIP file,  the first line ends with ASCII codes 13, 10, 26 (the normal sequence at the end of a line is ASCII 13, 10).<br />
<br />
One solution would be check that the file does not end with ASCII code 26 before you append the new data.<br />
<br />
The thread at http://forums.winamp.com/showthread.php?threadid=130099 may give you some ideas of how to go about this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th June 2003, 20:15</div></div><div class="posttext">Yey for DOS :(<br />
<br />
On my todo.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SprinklerHead</div><div class="date">17th July 2003, 18:33</div></div><div class="posttext">I wrote a Delphi dll that can add a path to any 95 or NT based platform.<br />
<br />
It handles the square box character problem described above by searching for the ASCII character #26 on a line by itself and deleting that line if found.<br />
<br />
It also checks to see if the path you are adding is already in the system path. If it is, then it doesn't add it. This could save the user a reboot on 95 platforms. For NT based platforms, it automatically calls SendMessage - you don't have to call that in your install script.<br />
<br />
For 95 based platforms, autoexec.bat gets modified. For NT platforms, the Path data in the key HKLM\System\CurrentControlSet\Control\Session Manager\Environment\ gets modified.<br />
<br />
To add a path:<br />
Path::AddToPath $INSTDIR<br />
Pop $0 ;&lt;--- will be either &quot;Reboot&quot; or &quot;NoReboot&quot;<br />
<br />
To remove a path:<br />
Path::RemoveFromPath $INSTDIR<br />
Pop $0 ;&lt;--- will be either &quot;Reboot&quot; or &quot;NoReboot&quot;<br />
<br />
The path must exist prior to a call to AddToPath or RemoveFromPath (GetShortPathName doesn't work right unless the Path exists).<br />
<br />
After this lengthy post the forum won't allow me to post the zip file because it's too big! Well, if someone wants it I can email it to you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">17th July 2003, 20:18</div></div><div class="posttext">Please create an archive page for your plug-in and mail the plug-in to one of the admins.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SprinklerHead</div><div class="date">18th July 2003, 18:49</div></div><div class="posttext">Err, what's an archive page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">YtseJam</div><div class="date">18th July 2003, 18:56</div></div><div class="posttext">http://nsis.sourceforge.net/archive</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th November 2003, 17:34</div></div><div class="posttext">Finally fixed.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>