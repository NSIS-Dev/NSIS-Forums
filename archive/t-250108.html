<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Background image, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Background image NSIS Discussion" />
	
	<title> Background image [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Background image</div>
<hr />
<div class="pda"><a href="t-250108.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=250108">Background image</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bnicer</div><div class="date">1st July 2006, 01:58</div></div><div class="posttext">I know how to re-compile 'modern_headerbmp.exe' in Resource Hacker, so the header bitmap image is in the background and the text is on top. I was wondering if you could do the same thing with the welcome &amp; finish page bitmap. Editing the fields in ioSpecial.ini always puts the image on top of the text. It occurs to me that you might be able to swop fields 1 and 3, but would that work, and where would you modify the settings? The bitmap is field 1; field 2 and field 3 are the welcome &amp; finish text.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st July 2006, 06:53</div></div><div class="posttext">Swapping the fields would work because their order in the INI file sets Z order. You could modify ioSpecial.ini using MUI_INSTALLOPTIONS_READ and MUI_INSTALLOPTIONS_WRITE in functions defined by MUI_PAGE_CUSTOMFUNCTION_PRE. As the MUI readme says:In the Pre function of the Welcome page and the Finish page, you can write to the InstallOptions INI file of the page (ioSpecial.ini)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bnicer</div><div class="date">1st July 2006, 10:34</div></div><div class="posttext">Changing the z-order works, but you pay a price. The image is gone when you go Back from the next window. And the text assumes a gray background color.<br />
<br />
How can I restore the background to white and keep the image from disappearing? Is it possible to do both?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bnicer</div><div class="date">1st July 2006, 12:13</div></div><div class="posttext">I at first thought you could edit 'System.nsh' to change the order of the fields there...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bnicer</div><div class="date">1st July 2006, 21:26</div></div><div class="posttext">I ran a search &amp; replace in notepad to substitute Field 1 with Field 3 and Field 3 with Field 1. Then I renamed the fields in 'ioSpecial.ini'. Now the bitmap image is in the background and it doesn't disappear when you go Back from the next window.<br />
<br />
And you can do this:<br />
<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW font_background<br />
!define MUI_WELCOMEPAGE_TITLE_3LINES<br />
!define MUI_WELCOMEPAGE_TEXT &quot;$(TEXT_WELCOME_INFO)&quot;<br />
!insertmacro MUI_PAGE_WELCOME<br />
<br />
Function font_background<br />
  GetDlgItem $R0 $MUI_HWND 1200<br />
  SetCtlColors $R0 0x000000 0xFFFFFF<br />
FunctionEnd<br />
1200 is Field 1.<br />
0xFFFFFF makes the background white.<br />
<br />
Is there is any reason I shouldn't modify 'System.nsh'?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st July 2006, 21:31</div></div><div class="posttext">It's not really wise as the same changes will be applied to all installers you create. Also when you install a new version of NSIS your changes will be lost.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bnicer</div><div class="date">4th July 2006, 11:23</div></div><div class="posttext">There is now a better way of changing the 'ioSpecial.ini' field order using MUI_INSTALLOPTIONS_WRITE. The image is  visible when you go Back from the next page. To whoever fixed it in NSIS 2.18, thank you. Bad timing on my part.:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bnicer</div><div class="date">10th March 2007, 08:31</div></div><div class="posttext">The Welcome/Finish pages display a 497 x 314 image in the background.<br />
<br />
I got a PM in January asking me how I fixed the image disappearing when pressing back.<br />
<br />
=====================<br />
<br />
I didn't check my messages until last week. <br />
<br />
=====================<br />
<br />
I'm fairly sure it was nothing I did. The issue fixed itself in NSIS 2.18.<br />
<br />
Maybe the problem was/is:<br />
<br />
To send the bitmap to the back behind the text, the z-order is reversed. You can do that in ioSpecial.ini. The recommended way is with MUI_INSTALLOPTIONS_WRITE. I think I tried (and possibly may have succeeded) only using MUI_INSTALLOPTIONS_WRITE ... Later I returned to editing System.nsh, which I started out attempting, because it was less complicated.<br />
<br />
The changes are risky.<br />
<br />
Afrow UK wrote:<br />
<br />
It's not really wise as the same changes will be applied to all installers you create. Also when you install a new version of NSIS your changes will be lost.<br />
<br />
<br />
If anyone would like to try, I could paste the modified System.nsh code below. It's a long file. NSIS Modern User Interface version 1.75 written by Joost Verburg. 2000+ lines. About 20 characters are changed.<br />
<br />
I would suggest just posting the differences, but they're all over the place.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bnicer</div><div class="date">10th March 2007, 09:06</div></div><div class="posttext">Here's a link to a screenshot:<br />
<br />
497x314 Welcome page (http://www.teanow4pm.demon.co.uk/sshots/sshots.htm)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bnicer</div><div class="date">10th March 2007, 09:15</div></div><div class="posttext">Actually, here's a link to the changed file:<br />
<br />
modified System.nsh (http://www.teanow4pm.demon.co.uk/nsis/System.nsh)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bnicer</div><div class="date">11th March 2007, 17:52</div></div><div class="posttext">System.nsh is the same in NSIS 2.24, 2.23, 2.22 and 2.21. The modified file is for those versions.<br />
<br />
The link might be obsolete before long. Sorry about that.<br />
<br />
Edit System.nsh yourself by first making a backup copy. Then open System.nsh in a text editor and make these changes:<br />
<br />
1) Replace every occurrence of &quot;Field 1&quot; with &quot;Field 999&quot;.<br />
2) Replace every occurrence of &quot;Field 3&quot; with &quot;Field 1&quot;.<br />
3) Replace every occurrence of &quot;Field 999&quot; with &quot;Field 3&quot;.<br />
<br />
Save the file.<br />
<br />
Images:<br />
Design a 497x314 image with enough area to display text. An orange title won't be visible on an orange background. The Welcome page and Finish page do not have the same text and other languages do not use the same text strings; please bear that in mind.<br />
<br />
How to show two checkboxes on the Finish page:<br />
You can customize the following code.<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE z_order_finish<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW font_background<br />
!define MUI_PAGE_CUSTOMFUNCTION_LEAVE post_install_1<br />
!define MUI_FINISHPAGE_TITLE_3LINES<br />
!define MUI_FINISHPAGE_TITLE &quot;$(TEXT_FINISH_INFO_TITLE)&quot;<br />
!define MUI_FINISHPAGE_SHOWREADME<br />
!define MUI_FINISHPAGE_RUN<br />
!define MUI_FINISHPAGE_RUN_TEXT &quot;$(TEXT_FINISH_RUN)&quot;<br />
!define MUI_FINISHPAGE_RUN_NOTCHECKED<br />
!define MUI_FINISHPAGE_RUN_FUNCTION post_install_2<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
Function z_order_finish<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $R1 &quot;ioSpecial.ini&quot; &quot;Field 3&quot; &quot;Text&quot;<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 1&quot; &quot;Top&quot; 80<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 1&quot; &quot;Bottom&quot; 185<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 2&quot; &quot;Top&quot; 15<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 2&quot; &quot;Bottom&quot; 80<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 3&quot; &quot;Text&quot; &quot;$(TEXT_FINISH_SHOW)&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 3&quot; &quot;Type&quot; Checkbox<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 3&quot; &quot;Left&quot; 78<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 3&quot; &quot;Right&quot; 258<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 3&quot; &quot;Top&quot; 150<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 3&quot; &quot;Bottom&quot; 160<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 3&quot; &quot;State&quot; 0<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 3&quot; &quot;Flags&quot; &quot;&quot;<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Left&quot; 78<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Right&quot; 258<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Top&quot; 130<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 4&quot; &quot;Bottom&quot; 140<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 5&quot; &quot;Text&quot; $R1<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 5&quot; &quot;Type&quot; Bitmap<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 5&quot; &quot;Left&quot; 0<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 5&quot; &quot;Right&quot; 331<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 5&quot; &quot;Top&quot; 0<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 5&quot; &quot;Bottom&quot; 193<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 5&quot; &quot;Flags&quot; RESIZETOFIT<br />
  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Field 5&quot; &quot;State&quot; &quot;&quot;<br />
FunctionEnd<br />
The bitmap is Field 3 before and Field 5 afterwards.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>