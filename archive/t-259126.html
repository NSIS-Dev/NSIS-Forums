<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with Create Shortcut, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with Create Shortcut NSIS Discussion" />
	
	<title> Problem with Create Shortcut [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with Create Shortcut</div>
<hr />
<div class="pda"><a href="t-259126.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=259126">Problem with Create Shortcut</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">g2g</div><div class="date">8th November 2006, 12:07</div></div><div class="posttext">Hi;<br />
<br />
IÂ´m a newbie with NSIS.<br />
I try to create an installer using the Wizard of HM NSIS Editor.<br />
It works fine. I try to create a shortcut on the desktop, but it donÂ´t work.<br />
CreateShortCut &quot;$SMPROGRAMS\$ICONS_GROUP\MyApp.lnk&quot; &quot;$INSTDIR\directory\start.bat&quot; <br />
the shortcut is created on the desktop. But when I look at the  properties the value of the parameter 'start in' is wrong.<br />
Could I change this value anywhere in my script?<br />
<br />
Thanks for helping<br />
<br />
Kind regards<br />
g2g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">8th November 2006, 12:37</div></div><div class="posttext">use SetOutPath before you call CreateShortCut</div></div><hr />


<div class="post"><div class="posttop"><div class="username">g2g</div><div class="date">8th November 2006, 12:52</div></div><div class="posttext">Hi Anders;<br />
<br />
i already use the Command SetOutPath before i create the ShortCut.<br />
<br />
<br />
<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  SetOverwrite try<br />
  File /r &quot;directory&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\$ICONS_GROUP\MyApp.lnk&quot; &quot;$INSTDIR\directory\start.bat&quot;<br />
<br />
I attached a image, that shows the properties of the shortcut.<br />
The value of the parameter should be &quot;C:\Program Files\MyApp&quot; instead of &quot;C:\Program Files\MyApp\directory\xxx&quot;<br />
<br />
Thanks for helping<br />
g2g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">g2g</div><div class="date">8th November 2006, 12:55</div></div><div class="posttext">sorry the image isnÂ´t attached.<br />
i try it one more time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th November 2006, 18:25</div></div><div class="posttext">Works fine for me. Which version of NSIS are you using? Could you attach the installation details (right click on it in the instfiles page and choose Copy Details to Clipboard)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">g2g</div><div class="date">9th November 2006, 08:52</div></div><div class="posttext">Hi @ll;<br />
<br />
i fixed the problem. The shortcut works.<br />
Anders was wright. The value of SetOutPath was wrong. I had to  change it before i create the shortcuts.<br />
<br />
Another question.<br />
I also try to run my Application after the install.<br />
HM NSIS Editor creates following Code: <br />
!define MUI_FINISHPAGE_RUN &quot;$INSTDIR\jakarta-tomcat-5.5.9\bin\startup.bat&quot;<br />
!insertmacro MUI_PAGE_FINISH <br />
<br />
ItÂ´s the same file, that my shortcut is joined to.<br />
But the application doesnÂ´t start up correctly.<br />
Are there any details (parameters) i have to attend?<br />
Do you have any ideas?<br />
<br />
Thanks a lot for your support!<br />
<br />
Regards<br />
g2g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">9th November 2006, 15:16</div></div><div class="posttext">you probably have the same &quot;current directory&quot; problem, try executing the .lnk instead of the .bat on the finish page. Or if the shortcut is optional, you can use a function callback on the finish page instead of executing something directly, that should give you more control</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>