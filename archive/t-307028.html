<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Windows 7 - erroneous installer warning, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Windows 7 - erroneous installer warning NSIS Discussion" />
	
	<title> Windows 7 - erroneous installer warning [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Windows 7 - erroneous installer warning</div>
<hr />
<div class="pda"><a href="t-307028.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=307028">Windows 7 - erroneous installer warning</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">2nd June 2009, 23:45</div></div><div class="posttext">Hi!<br />
<br />
I tested my installer with Winodws 7 RC-1 and I noticed that a few moments after my installer exists, Windows 7 will display a warning. That warning claims that the installer probably has failed! That's complete nonsense, as the installer obviously did complete successfully. So I assume it's a bug in Windows 7 and it can be ignored safely. But it still may scare my users! So I wonder: What can I do to convince Windows 7 that my installer actually did complete successfully? I already request &quot;admin&quot; execution level. Anything else I need to add?<br />
<br />
BTW: Another problem. How can I launch my application, but *without* admin rights? I know there is the UAC plugin, but I'm looking for a simpler method. I already tried to launch a second installer from my main installer and I explicitly limited the rights of that second installer to &quot;user&quot;. But even when launching my application from that second non-admin installer, it still somehow was running with &quot;admin&quot; rights, as the main installer. This sucks, because it disables Drag&amp;Drop and causes other random problems. Any suggestions?<br />
<br />
My complete installer script is here:<br />
http://pastie.org/498438<br />
<br />
Cheeeeeeers<br />
MuldeR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">redxii</div><div class="date">3rd June 2009, 00:42</div></div><div class="posttext">NSIS has to be updated to write a manifest file correctly for 7. sourceforge.net/tracker/index.php?func=detail&amp;aid=2725883&amp;group_id=22049&amp;atid=373085<br />
As for non-admin, your script requires admin privileges. For example: 'WriteRegStr HKLM'<br />
HKLM requires admin privileges to write to. You can try SHCTX or HKCU instead. Writing to $PROGAMFILES also requires admin. You can take a look at multiuser.nsh.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">3rd June 2009, 00:50</div></div><div class="posttext">Originally posted by redxii <br />
NSIS has to be updated to write a manifest file correctly for 7. sourceforge.net/tracker/index.php?func=detail&amp;aid=2725883&amp;group_id=22049&amp;atid=373085 <br />
<br />
Thanks for info ;)<br />
<br />
I hope NSIS will be fixed for Windows 7 soon, so I can make the Windows 7 people happy too :D<br />
<br />
<br />
Originally posted by redxii <br />
As for non-admin, your script requires admin privileges. For example: 'WriteRegStr HKLM'<br />
HKLM requires admin privileges to write to. You can try SHCTX or HKCU instead. Writing to $PROGAMFILES also requires admin. You can take a look at multiuser.nsh.  <br />
<br />
I'm aware that my Installer needs admin rights. And that's why I request the &quot;admin&quot; execution level. But at the end of the installer, I want to launch the application that has just been installed. The application itself should run with normal &quot;user&quot; rights. Unfortunately when launched by the &quot;admin&quot; level installer, the application will run at that higher security level too. That causes a few nasty problems, such as Drag&amp;Drop being disabled and other random glitches. So I look for a way to launch the app as the normal user from my admin-level installer...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">redxii</div><div class="date">3rd June 2009, 01:07</div></div><div class="posttext">What about this? nsis.sourceforge.net/UAC_plug-in#Launching_an_application_with_user_privileges<br />
<br />
!define MUI_FINISHPAGE_RUN_FUNCTION ExecAppFile<br />
 <br />
Function ExecAppFile<br />
    UAC::Exec '' '&quot;$INSTDIR\${APPFILE}&quot;' '' ''<br />
FunctionEnd<br />
<br />
I don't believe you will be able to do it without a plugin because the application launched from MUI_FINISHPAGE_RUN will inherit admin privileges and NSIS hasn't done anything to automatically lower the privileges like in inno setup.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">3rd June 2009, 05:03</div></div><div class="posttext">Once you are elevated, you can't go back, so I don't know what you think Inno is doing</div></div><hr />


<div class="post"><div class="posttop"><div class="username">redxii</div><div class="date">3rd June 2009, 06:57</div></div><div class="posttext">Well, no, I don't think that, it is that, in 5.2.0 or later. However it does it, the process spawned from [Run] runs as non-admin after the setup having admin privileges.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">3rd June 2009, 09:08</div></div><div class="posttext">Originally posted by redxii <br />
However it does it, the process spawned from [Run] runs as non-admin after the setup having admin privileges.  I use the UAC plugin in my NSIS installers to do that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">3rd June 2009, 10:11</div></div><div class="posttext">Thanks. I will need to add yet another plugin to my installer then ;)<br />
<br />
How I love UAC...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>