<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Function calls and arguments, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Function calls and arguments NSIS Discussion" />
	
	<title> Function calls and arguments [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Function calls and arguments</div>
<hr />
<div class="pda"><a href="t-195060.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=195060">Function calls and arguments</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">29th September 2004, 10:21</div></div><div class="posttext">Sorry, 2nd post in 2 days. Quick q I hope, I'll give the question, then the problem I'm working on in case I don't explain myself very well.<br />
<br />
Question: <br />
a) can I define functions within the scripting language which take arguments without having to use the slightly less than elegant method of using the stack? <br />
b) if not, I can see lots of built in functions which take arguments, can I edit the NSIS source to add my own argument?<br />
<br />
Problem:<br />
I want to log every time I place a file on the filesystem in a log that is separate to the install.log. ie I want an additional file list of everything that I install onto the client machine. To do this I could (for each file!) write out to a log and double the number of lines I write:<br />
<br />
blah blah filename.file // some code which writes to a log file<br />
File filename.file<br />
<br />
Or I could have a function which does it all for me:<br />
<br />
putFile filename.file<br />
<br />
And tell putFile to a) use the File command to dump the file somewhere and b) write out to a log.<br />
<br />
What I _don't_ want to have to do is this:<br />
<br />
Push filename.file<br />
putFile<br />
<br />
Because that's just as clumsy as the first method.<br />
<br />
So can I either using NSIS scripting or altering the source make something whose syntax would be this:<br />
<br />
putFile filename.file<br />
<br />
Thanks in advance <br />
<br />
Rob</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th September 2004, 11:51</div></div><div class="posttext">Afrow's post is what you're looking for:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=186760&amp;highlight=log+file<br />
<br />
You can make it even shorter with the following trick:!define mymacro &quot;!insertmacro mymacro&quot;<br />
${mymacro} # inserts mymacro</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">29th September 2004, 12:35</div></div><div class="posttext">First of all, thanks for helping.<br />
<br />
What you showed me is interesting. Unfortunately for me there is a basic reference section, and there are code examples, but nothing in between so I have to do the fsr mandatory thing of messing around with the source til i know it well enough to understand all the code examples :)<br />
<br />
So if I chuck that AdvDumpLog function into my code, do I simply need to write for each file:<br />
<br />
  Push &quot;Unzip.exe&quot;<br />
  Push &quot;$INSTDIR\filelist.log&quot;<br />
  Call AdvDumpLog<br />
<br />
And it will add on another filename within the file? (Obviously changing the filename Unzip.exe to whatever file it is).<br />
<br />
Thanks<br />
<br />
Rob</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th September 2004, 12:43</div></div><div class="posttext">Well, actually, as AdvDumpLog uses the first parameter to filter the log, you'd want it to read &quot;extract&quot;.<br />
<br />
But that's not the post I was referring to. See his next to last post. More specifically, you want:!macro ADD_FILE FILEIN FILEOUT<br />
 File &quot;/oname=${FILEOUT}&quot; &quot;${FILEIN}&quot;<br />
 # do stuff with file here<br />
!macroend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">29th September 2004, 12:51</div></div><div class="posttext">Aah sorry, ok. So you reckon the best way is to use a macro to pass the filename to an external program which will handle the log writing?<br />
<br />
(Sorry to ask what's probably an obvious question, but I feel I need to be clear :) ) <br />
<br />
Thanks again<br />
<br />
Rob</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">29th September 2004, 12:54</div></div><div class="posttext">Oh er hang on, are you actually saying chuck it all in a macro, cos you can write to the file from there? Cos that actually makes more sense now I look at it :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th September 2004, 12:55</div></div><div class="posttext">It doesn't have to be an external program. The macro can call FileWrite too.<br />
<br />
The File command logs almost everything it does so it's the easiest (with logging enabled). But you've asked for a function that can be called without the stack ;)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>