<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Setting a reg key with variables? And calling with batch?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Setting a reg key with variables? And calling with batch? NSIS Discussion" />
	
	<title> Setting a reg key with variables? And calling with batch? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Setting a reg key with variables? And calling with batch?</div>
<hr />
<div class="pda"><a href="t-294127.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=294127">Setting a reg key with variables? And calling with batch?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">-Gamah</div><div class="date">8th July 2008, 00:28</div></div><div class="posttext">Here's what my script uses to find someone's game directory (this is an automatic addon installer)<br />
<br />
Function .onInit<br />
<br />
  Call GetSteamAccountName<br />
  Pop $R0 ; CaDDy-<br />
  Pop $R1 ; E\Games\Steaaam<br />
<br />
  # Check if Steam is installed<br />
  StrCmp $R0 &quot;&quot; 0 +3<br />
    MessageBox MB_OK|MB_ICONSTOP $(SteamNotInstalled)<br />
    Abort<br />
<br />
  # It is installed so set INSTDIR<br />
  StrCpy $INSTDIR &quot;$R1\SteamApps\$R0\garrysmod\garrysmod&quot;<br />
<br />
The &quot;$R1\SteamApps\$R0\garrysmod\garrysmod is what i want written to a registry key.<br />
<br />
This brings me to the second question, is it possible to call up a registry key as a variable in a batch file? If so, how would I do so?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th July 2008, 14:31</div></div><div class="posttext">Use ReadReg* and WriteReg* all of which are in the documentation. You could read a value in NSIS and pass it via the batch's command-line. However, what can you do in a batch that you cannot do in NSIS?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">-Gamah</div><div class="date">8th July 2008, 17:19</div></div><div class="posttext">Originally posted by Afrow UK <br />
 However, what can you do in a batch that you cannot do in NSIS?<br />
<br />
Stu [/B] <br />
<br />
svn checkout and svn export :P<br />
<br />
edit<br />
<br />
So something like &quot;WriteReg HKLM\Software\UltimateGmodPack\GmodInstdir &quot;$R1\SteamApps\$R0\garrysmod\garrysmod\&quot; will write the actual values in on the key and not just the $R1 and $R0?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">-Gamah</div><div class="date">8th July 2008, 17:41</div></div><div class="posttext">Also, if i could just use NSIS to set an environment variable, that would make things much easier.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th July 2008, 17:42</div></div><div class="posttext">I'll let you do a search for that one.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">-Gamah</div><div class="date">8th July 2008, 18:06</div></div><div class="posttext">I see nothing in the documentation on SETTING an environment variable, only the ones that NSIS uses.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th July 2008, 19:24</div></div><div class="posttext">There's also this forum you can search as well as the Wiki (http://nsis.sf.net).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">-Gamah</div><div class="date">8th July 2008, 20:48</div></div><div class="posttext">Okay I've done searching, now why doesn't this work?<br />
<br />
Function .setReg<br />
WriteRegStr HKLM &quot;SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot; &quot;GMOD_DIR&quot; &quot;$R1\SteamApps\$R0\garrysmod\garrysmod&quot;<br />
 FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">8th July 2008, 21:00</div></div><div class="posttext">What does the registry look like after calling the function?<br />
<br />
Also, you might add a message box in your function function as a debug tool to see that $R0 and $R1 are set properly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th July 2008, 21:27</div></div><div class="posttext">In what way does it not work? Are you calling the function? The . in front of the name does not make it get called automatically.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">-Gamah</div><div class="date">8th July 2008, 21:40</div></div><div class="posttext">After compiling and running the installer, the GMOD_DIR entry IS MADE IN THE KEY properly, with $R0 and $R1 set and everything.<br />
<br />
But when i go to command prompt and type %GMOD_DIR% it tells me that environment variable GMOD_DIR is not defined (though i'm LOOKING AT IT in regedit.exe<br />
<br />
any ideas?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>