<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" COM support, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  COM support NSIS Discussion" />
	
	<title> COM support [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  COM support</div>
<hr />
<div class="pda"><a href="t-153331.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=153331">COM support</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">seva_t</div><div class="date">20th October 2003, 20:17</div></div><div class="posttext">Hello NSIS experts,<br />
<br />
is there any easy way to use COM objects in NSIS?<br />
For example, in VBScript I can create a COM object with<br />
 CreateObject function and then call any methods that object defines.<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">20th October 2003, 20:46</div></div><div class="posttext">You will have to write a plug-in or use an external application.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th October 2003, 21:20</div></div><div class="posttext">Actually, the System plug-in in the latest CVS version supports COM. You can find an example in this thread (http://forums.winamp.com/showthread.php?s=&amp;threadid=147686).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">20th October 2003, 22:02</div></div><div class="posttext">Yes, Kichik is right. Use sheduled tasks creator script as sample.  For example instead of CreateObject you should call ole32::CoCreateInstance. To call methods you should find the object interface description (.idl file) (compiled from .idl c-style .h file will be even better, it will contain plain interface virtual methods structure) and use methods indexes to call approriate methods.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">seva_t</div><div class="date">20th October 2003, 23:27</div></div><div class="posttext">Thanks, this is definitely a way, although quite cryptic, <br />
for my taste ;-)<br />
I'll try to go with Execute &quot;wscript &lt;my VBScript file&gt;&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thelliez</div><div class="date">2nd February 2006, 19:37</div></div><div class="posttext">Searching for COM integration I found this old thread.<br />
<br />
Although NSIS is a wonderful tool, creating an installer for a server side application is more complicated than it should be.<br />
<br />
Because we have to perform many tasks like:<br />
1- set a web site (app pool, web service extension, virtual directory, isapi filter...);<br />
2- set some user rights (creation, groups, permissions,...);<br />
3- set some service settings (service logon, dependencies, schedule tasks, DEP,..);<br />
<br />
We ended up using a bunch of .cmd, .vbs and .bat scripts outside NSIS. We have experienced numerous difficulties switching shells. For example:<br />
<br />
1- cscript.exe not always found;<br />
2- scrun.dll not always registered (used for CreateObject calls);<br />
3- Escaping of strings (like passwords) cross multiple shells;<br />
4- variable delayed expansions issues;<br />
<br />
The above thread points to a sheduleTask.nsi file example. This is really a difficult way to do it. Hard to read, hard to maintain.<br />
<br />
I would be really great if NSIS was to evolve with a tighter /easier integration to COM.<br />
<br />
<br />
Just some feedback about this otherwise great software.<br />
Thierry</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>