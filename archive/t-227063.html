<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecWait to Program which requires newly added PATH, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecWait to Program which requires newly added PATH NSIS Discussion" />
	
	<title> ExecWait to Program which requires newly added PATH [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecWait to Program which requires newly added PATH</div>
<hr />
<div class="pda"><a href="t-227063.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=227063">ExecWait to Program which requires newly added PATH</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">spacefight</div><div class="date">27th September 2005, 15:18</div></div><div class="posttext">Hi Forum,<br />
<br />
My NSIS script installs Perl via ExecWait to msiexec silently.  The Perl Installation Wizard adds the path to perl to the PATH variable. After installing Perl, I want to install Perl modules via ExecWait to PPM (the perl package manager).<br />
<br />
This step fails because the newly started ExecWait thread/program/whatever does not see the path to perl added by the Perl Installer. <br />
<br />
If I open a new shell window after the installation is done and start PPM, it works, so the path is then correctly loaded.<br />
<br />
Now my Question:<br />
Is there a method for an installation script to add a directory to the PATH value so that later ExecWaits within the same installation script can use it?<br />
<br />
If the PATH to perl is set before PPM runs, it all works fine.<br />
<br />
Thanks for any hints,<br />
spacefight<br />
<br />
Code Snippet:<br />
<br />
; install perl which adds C:\perl\bin\perl.exe to the PATH variable<br />
  ExecWait 'msiexec /i &quot;$INSTDIR\ActivePerl-5.8.7.813-MSWin32-x86-148120.msi&quot; /qn INSTALLDIR=C:\perl\ PERL_PATH=&quot;Yes&quot; /l $INSTDIR\perlinstall.log'<br />
[..]<br />
; install IO-stringy module<br />
  ExecWait 'c:\perl\bin\ppm.bat install $INSTDIR\perl\IO-stringy.ppd'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th September 2005, 17:19</div></div><div class="posttext">You'll find your answer in the following Wiki page:<br />
<br />
http://nsis.sourceforge.net/wiki/Setting_Environment_Variables_to_Active_Installer_Process</div></div><hr />


<div class="post"><div class="posttop"><div class="username">spacefight</div><div class="date">28th September 2005, 07:41</div></div><div class="posttext">Thanks,<br />
<br />
Your plugin worked, the 1st option didn't work on XP either. I'd suggest that you remove this option from the wiki page in order to avoid having people trying without success.<br />
<br />
spacefight</div></div><hr />


<div class="post"><div class="posttop"><div class="username">spacefight</div><div class="date">28th September 2005, 10:13</div></div><div class="posttext">Oops.<br />
<br />
I have to restate: your plugin does not work as supposed. The processes started by the ExecWaits after the Plugin call do not have the correct path set, so they fail.<br />
<br />
Is there a way to verify that the plugin does what it's supposed to?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">28th September 2005, 10:18</div></div><div class="posttext">Could you try that option again? I fixed a bug that a string wasn't being delimited as it should on the System plug-in call. (I just didn't test it :()</div></div><hr />


<div class="post"><div class="posttop"><div class="username">spacefight</div><div class="date">28th September 2005, 10:24</div></div><div class="posttext">deguix: What option are you talking about?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">spacefight</div><div class="date">28th September 2005, 10:34</div></div><div class="posttext">Ah you changed the wiki page. Well it does not work with your changes (the quotes around PATH) either.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">spacefight</div><div class="date">28th September 2005, 11:09</div></div><div class="posttext">On the wiki page, it should be <br />
<br />
    System::Call 'Kernel32::SetEnvironmentVariableA(t, t) i(&quot;PATH&quot;, &quot;$R0&quot;).r0'<br />
<br />
so R0 as well in quotes. Then it works. No need for the plugin at all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">28th September 2005, 11:55</div></div><div class="posttext">Sorry 'bout that. Forgot to add those to $R0 also...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">spacefight</div><div class="date">28th September 2005, 12:02</div></div><div class="posttext">Ok thanks.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>