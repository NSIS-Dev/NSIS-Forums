<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with start menu shortcut, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with start menu shortcut NSIS Discussion" />
	
	<title> Problem with start menu shortcut [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with start menu shortcut</div>
<hr />
<div class="pda"><a href="t-289493.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289493">Problem with start menu shortcut</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kook04</div><div class="date">2nd April 2008, 14:44</div></div><div class="posttext">Please bear with me.  I've looked through all existing threads and I've seen information regarding my problem, but so far nothing has helped me fix it.<br />
<br />
In my script I am creating a start menu items that points to a  batch file.  I want to set the &quot;working directory&quot; for the batch file to a directory other than $INSTDIR.<br />
<br />
From what I have read on these forums, you do that by calling SetOutPath (and specifying the directory you want to be the working directory) prior to calling CreateShortCut.  I'm doing that, but it isn't working.  Here is the relevant portion of my script:<br />
<br />
Section -StartMenuItems<br />
    <br />
SetOutPath &quot;$INSTDIR\scripts\&quot;<br />
CreateDirectory &quot;$SMPROGRAMS\KAST&quot;    <br />
<br />
CreateShortCut &quot;$SMPROGRAMS\KAST\${SERVER_NAME}.lnk&quot; &quot;$INSTDIR\scripts\StartWatchdogServer.bat&quot; &quot;$INSTDIR\icons\watchdog.ico&quot; &quot;0&quot;                                 <br />
    <br />
SectionEnd<br />
<br />
This creates the start menu group correctly, and creates the menu item, but the &quot;Start In&quot; (i.e., working directory) for the bat file is still $INSDIR<br />
<br />
Does anyone have any ideas?  This has been holding me up for a while.<br />
<br />
Thanks in advance for your help.<br />
<br />
-Kennedy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">l0k1</div><div class="date">2nd April 2008, 15:56</div></div><div class="posttext">I think the problem comes from the batch file opening a console window.<br />
<br />
Have you try changing the directory from the batch file (CD command) ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">2nd April 2008, 16:42</div></div><div class="posttext">The working directory is set by SetOutPath instruction. In your case should be &quot;$INSTDIR\scripts\&quot;. If you want to point to a different working directory then change the above SetOutPath.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kook04</div><div class="date">3rd April 2008, 15:28</div></div><div class="posttext">Thank you for your replies.  It turns out that the SetOutPath command does work for what I need.  I just misunderstood the syntax and was trying to use it a little differently than I thought I was.<br />
<br />
Thanks again..<br />
<br />
-Kennedy</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>