<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Changing behavior based on installed components, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Changing behavior based on installed components NSIS Discussion" />
	
	<title> Changing behavior based on installed components [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Changing behavior based on installed components</div>
<hr />
<div class="pda"><a href="t-292504.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=292504">Changing behavior based on installed components</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Cristofori</div><div class="date">30th May 2008, 20:45</div></div><div class="posttext">I have an application that has several components, one of which is an executable GUI. I'd like to give the user the option of launching that GUI (which is easy enough with MUI_FINISHPAGE_RUN), but only if they've actually chosen to install it.  <br />
<br />
Is there a way to disable the check box on the last page that gives the user the option to run the executable during runtime based on which components have been installed?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">30th May 2008, 22:24</div></div><div class="posttext">Use the custom function MUI_FINISHPAGE_RUN_FUNCTION as described in MUI docs.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cristofori</div><div class="date">2nd June 2008, 17:58</div></div><div class="posttext">Thanks for the input, I see the function but I can't find anywhere in the docs that explains how I would do either of the following:<br />
<br />
1 - Hide the check box that gives the option to run the executable<br />
<br />
2 - Determine which components were installed so I can decide whether or not to hide the check box<br />
<br />
Any thoughts?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">2nd June 2008, 18:08</div></div><div class="posttext">Well, the doc explains that this certain function could be used instead of the standard &quot;run my application&quot; behaviour.<br />
Therefore you should add code into this function in order to determine which components were installed, so accordingly you may show or skip the checkbox.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cristofori</div><div class="date">2nd June 2008, 18:50</div></div><div class="posttext">Therefore you should add code into this function in order to determine which components were installed, so accordingly you may show or skip the checkbox.<br />
<br />
Apologies if my question has been unclear, but I what I'm trying to figure out is HOW to do the two things mentioned here.  I've read through the docs but I see no way of actually finding out what has been installed or how to mess with the check box.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd June 2008, 19:24</div></div><div class="posttext">Use<br />
${If} ${SectionIsSelected} ${SectionId}<br />
...<br />
${EndIf}<br />
where SectionId is defined with your Section:<br />
Section &quot;A section&quot; SectionId<br />
<br />
You need to !include LogicLib.nsh and also ensure that this code goes after your Section code in the script.<br />
<br />
Just to show you how that code works behind the scenes which you could also use instead:<br />
<br />
SectionGetFlags ${SectionId} $R0<br />
IntOp $R0 $R0 &amp; ${SF_SELECTED}<br />
StrCmp $R0 ${SF_SELECTED} [] []<br />
<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">2nd June 2008, 19:29</div></div><div class="posttext">If the issue is to hide the checkbox depending on a selected section, you don't even need the function MUI_FINISHPAGE_RUN_FUNCTION as I mentioned above.<br />
The example below shows the checkbox when section 2 (additional) is selected.<br />
OutFile &quot;Test.exe&quot;<br />
InstallDir &quot;$PROGRAMFILES\Test&quot;<br />
ShowInstDetails show<br />
<br />
!include &quot;mui.nsh&quot;<br />
!include &quot;LogicLib.nsh&quot;<br />
<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW func_show<br />
!define MUI_FINISHPAGE_RUN myapp<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
Section &quot;Main&quot; sec1<br />
SetOutPath &quot;$INSTDIR&quot;<br />
Detailprint &quot;Installing Section 1 (Main)&quot;<br />
sleep 3000<br />
SectionEnd<br />
<br />
Section /o &quot;Additional&quot; sec2<br />
SetOutPath &quot;$INSTDIR&quot;<br />
Detailprint &quot;Installing Section 2 (Additional)&quot;<br />
sleep 3000<br />
SectionEnd<br />
<br />
<br />
Function func_show<br />
${Unless} ${SectionIsSelected} ${sec2}<br />
GetDlgItem $0  $MUI_HWND 1203<br />
ShowWindow $0 ${SW_HIDE}<br />
${EndUnless}<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cristofori</div><div class="date">2nd June 2008, 22:34</div></div><div class="posttext">Thanks for all the help, those examples are quite educational got me going in the right direction.  I ended up having to add one more line to uncheck the checkbox, otherwise it would still try to launch the executable since it was in a checked state even though it was hidden.<br />
<br />
SendMessage $0 ${BM_SETCHECK} ${BST_UNCHECKED} 0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">2nd June 2008, 23:11</div></div><div class="posttext">have a look at the CUIN source (http://nsis.sourceforge.net/CombinedUnInstaller), it disables/hides components depending on a prior messagebox. should explain what you're looking for.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>