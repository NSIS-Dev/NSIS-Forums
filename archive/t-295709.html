<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Calling a 'to be' installed script before extracting the files to output folder, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Calling a 'to be' installed script before extracting the files to output folder NSIS Discussion" />
	
	<title> Calling a 'to be' installed script before extracting the files to output folder [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Calling a 'to be' installed script before extracting the files to output folder</div>
<hr />
<div class="pda"><a href="t-295709.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=295709">Calling a 'to be' installed script before extracting the files to output folder</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">zorg117</div><div class="date">8th August 2008, 23:12</div></div><div class="posttext">Hi All,<br />
<br />
I am fairly new to NSIS and am trying to figure out a way to run a VBScript on the target system and obtain certain information from it before modifying the target system in any way (including extracting the files). This is the business requirement. I need to make sure that I gather all the input from the user and then verify that it is valid (using the VBScript that is to be run on the target system) and then finally install the files.<br />
<br />
Below is my page flow, I am using MUI2 with custom pages:<br />
.....<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_LICENSE &quot;license.rtf&quot;<br />
Page custom SetUpConfiguration CheckConfiguration<br />
Page custom ConfigurationErrorHandling<br />
!insertmacro MUI_PAGE_INSTFILES<br />
....<br />
<br />
The CheckConfiguration function is trying to execute the VBScript but it is not working right now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">9th August 2008, 00:19</div></div><div class="posttext">This way you can run a VBScript and capture the output:<br />
<br />
SetOutPath $INSTDIR<br />
File &quot;C:\My Scripts\Foobar.vbs&quot;<br />
<br />
nsExec:execToStack '&quot;$SYSTEM\CScript.exe&quot; &quot;$INSTDIR\Foobar.vbs&quot;'<br />
Pop $0<br />
Pop $1<br />
<br />
StrCmp $0 &quot;error&quot; +2<br />
MessageBox MB_OK &quot;Result: $1&quot;<br />
<br />
But why not do it directly in NSIS ???</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zorg117</div><div class="date">9th August 2008, 00:30</div></div><div class="posttext">Thank you for the response. I need to check and see if the solution you suggested works inside a function. I am looking for something that goes inside a function. I am trying to avoid writing the code in NSIS as the VBScript code I have is huge!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">9th August 2008, 00:36</div></div><div class="posttext">Yes, this will work perfectly fine in a function ;)<br />
<br />
But you will depend on Windows Scripting Host, which is *NOT* installed on all Windows systems and which is *DISABLED* on many system...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zorg117</div><div class="date">9th August 2008, 00:51</div></div><div class="posttext">Thanks man, I am going to check it out now. I have a check for the WSH. I made the code in such a way that the installer aborts if WSH is missing or disabled. The product will be installed in a lhighly restricted environment with limited users so as long as it works well in that environment I am happy</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>