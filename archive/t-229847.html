<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Delete shortcuts in start menu, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Delete shortcuts in start menu NSIS Discussion" />
	
	<title> Delete shortcuts in start menu [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Delete shortcuts in start menu</div>
<hr />
<div class="pda"><a href="t-229847.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=229847">Delete shortcuts in start menu</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Cherry17</div><div class="date">31st October 2005, 23:03</div></div><div class="posttext">Hello,<br />
<br />
I have got a problem with deleting the shortcuts in the start menu while uninstalling the program. I have read the posts in the forum but I did not find a solution.<br />
<br />
I write the shortcuts with:<br />
<br />
Var /GLOBAL test<br />
<br />
	StrCpy $R1 $R0 1<br />
        StrCpy $test $R0 <br />
	StrCmp $R1 &quot;&gt;&quot; skip<br />
<br />
                SetShellVarContext all<br />
		CreateDirectory $SMPROGRAMS\$R0<br />
		CreateShortCut $SMPROGRAMS\$R0\Analyzer.lnk $INSTDIR\Analyzer.exe<br />
		CreateShortCut $SMPROGRAMS\$R0\Uninstaller.lnk $INSTDIR\Uninstaller.exe<br />
	<br />
	skip:<br />
<br />
I want to delete them with:<br />
<br />
  Delete &quot;$SMPROGRAMS\$test\*.*&quot;<br />
  RMDir &quot;$SMPROGRAMS\$test&quot;<br />
<br />
It does not work.<br />
<br />
If I use<br />
<br />
  Delete &quot;$SMPROGRAMS\Analyzer 1.0\*.*&quot;<br />
  RMDir &quot;$SMPROGRAMS\Analyzer 1.0&quot;<br />
<br />
it works. But I will not know the folder the user will choose so my second solution is not great. What's wrong with the first solution?<br />
<br />
Thank,<br />
    Cherry17</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st November 2005, 07:52</div></div><div class="posttext">You need to use the /r switch on RMDir:<br />
<br />
RMDir /r &quot;$SMPROGRAMS\$test&quot;<br />
<br />
Without it, RMDir will only delete a folder if it is empty.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cherry17</div><div class="date">1st November 2005, 10:19</div></div><div class="posttext">Hi Afrow,<br />
<br />
therefore I use  Delete &quot;$SMPROGRAMS\Analyzer 1.0\*.*&quot; It should clear the directory. I don't want to use RMDir /r because I'am afraid of killing the whole start menu if I make a mistake with the path.<br />
<br />
I want to delete the content of the folder. <br />
I've just tried<br />
  Delete &quot;$SMPROGRAMS\$test\Analyzer.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\$test\Uninstaller.lnk&quot;<br />
  RMDir &quot;$SMPROGRAMS\$test&quot;<br />
but it doesn't work.<br />
<br />
Thanks,<br />
      Cherry17</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st November 2005, 18:14</div></div><div class="posttext">Are there any hidden files in the folder (e.g. desktop.ini)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">1st November 2005, 18:20</div></div><div class="posttext">I want to delete them with:<br />
<br />
Delete &quot;$SMPROGRAMS\$test\*.*&quot;<br />
RMDir &quot;$SMPROGRAMS\$test&quot;<br />
<br />
It does not work.<br />
<br />
If I use<br />
<br />
Delete &quot;$SMPROGRAMS\Analyzer 1.0\*.*&quot;<br />
RMDir &quot;$SMPROGRAMS\Analyzer 1.0&quot;<br />
<br />
it works.Logically, $test variable does not contain correct value. When you run unistaller all variables is empty, so when installing you need to save variable $R0 suppose in registry, and when run unistaller read this value from registry to $temp.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cherry17</div><div class="date">2nd November 2005, 09:09</div></div><div class="posttext">Hi Instructor,<br />
<br />
but I can remove the whole program. Only the shortcuts are the problem. Why can I remove the program? I thought the real values were written in the uninstaller but not the registers.<br />
Is it wrong?<br />
<br />
Thanks, <br />
       Kirstin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">2nd November 2005, 10:15</div></div><div class="posttext">When you runs unistaller it by default sets $INSTDIR=$EXEDIR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cherry17</div><div class="date">2nd November 2005, 15:44</div></div><div class="posttext">Hi Instructor,<br />
<br />
ok. Now I can understand the problem. I don't want to write anything in the registry. I'am afraid of deleting something really important when I try to delete my entries. I will think it over.<br />
<br />
Thanks for your help.<br />
               Kirstin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd November 2005, 15:50</div></div><div class="posttext">Surely your startup path won't change so why should you need to store the path if it's a fixed path?<br />
If you're scared of deleting a folder that isn't there... well you can't!<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cherry17</div><div class="date">3rd November 2005, 09:36</div></div><div class="posttext">Hi Afrow,<br />
<br />
I create a folder in the startup menu. I think I have to save the name of this folder, don't I?<br />
The user can change the name of this folder while installing the program. If he uses the default name, I will be able to remove the folder, but if he changes the name, I will not.<br />
<br />
Thanks,<br />
        Kirstin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cherry17</div><div class="date">3rd November 2005, 10:01</div></div><div class="posttext">HiAfrow,<br />
<br />
an ini-file is a great solution! I will try it. <br />
<br />
Thank,<br />
     Kirstin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd November 2005, 10:02</div></div><div class="posttext">In that case there is no other way but storing the folder name in the registry or in an INI file.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd November 2005, 10:15</div></div><div class="posttext">Strange how that happens sometimes. You posted after me but the post has gone above mine in the list.<br />
<br />
Anyway, use WriteINIStr and ReadINIStr.<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>