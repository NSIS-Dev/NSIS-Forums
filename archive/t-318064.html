<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Infinite ProgressBar, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Infinite ProgressBar NSIS Discussion" />
	
	<title> Infinite ProgressBar [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Infinite ProgressBar</div>
<hr />
<div class="pda"><a href="t-318064.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318064">Infinite ProgressBar</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bltomov</div><div class="date">30th March 2010, 14:28</div></div><div class="posttext">Hi,<br />
<br />
I'm a nsis newbie, and have created a script to install a program, and uninstall the existing version, before installing a new one. I run the uninstaller in silent mode, so there is no progressbar during uninstallation, but maybe a infinite for a long time job?<br />
Is it possible, to show a infinite progress bar during uninstalling of the old version?<br />
Thank you in advance.<br />
<br />
Regards,<br />
Boian</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">30th March 2010, 16:50</div></div><div class="posttext">You could play with one of the banner plugins or the LoadingBAR UI for your uninstaller:<br />
http://nsis.sourceforge.net/LoadingBar_UI<br />
<br />
http://nsis.sourceforge.net/MSIBanner_plug-in (old)<br />
http://nsis.sourceforge.net/NxSMSILoaderDlg_plug-in (slightly less old)<br />
http://nsis.sourceforge.net/Nxs_plug-in (least old)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bltomov</div><div class="date">31st March 2010, 16:30</div></div><div class="posttext">Thank you for the response. I have downloaded the plugins, and have already a solution to show a dialog with the progress bar, during execution of the longtime process. Is it possible, to integrate the progressBar into a NSIS installer page?<br />
<br />
I have found that the NSdialog, already contains a ProgressBar (NSD_CreateProgressBar), but there is no documentation, how i can use it, and set a value.<br />
<br />
Regards,<br />
Boian</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">31st March 2010, 17:16</div></div><div class="posttext">well if you want it inside a dialog, then your uninstaller isn't very 'silent' anymore, is it? ;)<br />
<br />
The nsDialogs progressbar you'd probably have to alter using windows messaging.  See also this thread:<br />
http://forums.winamp.com/showthread.php?postid=2575941<br />
<br />
Just in short, you'd want to set up a range...<br />
sendMessage ProgressControl_hwnd ${PBM_SETRANGE32} start end ; e.g. 0 100 for a standard 0%-100% progressbar<br />
<br />
And then set the value in your script where appropriate...<br />
sendMessage ProgressControl_hwnd ${PBM_SETPOS} value 0 ; e.g. 33 0 for 33%<br />
<br />
ProressControl_hwnd is what you get in the Pop after creating the item with nsDialogs.<br />
PBM_SETRANGE and PBM_SETPOS are defined in WinMessages.nsh (ships with NSIS) - so be sure to include that if you aren't already.<br />
<br />
If you want it to be one of those marquee progressbars that just continually loop from left to right, you probably have to set up some manner of style on the thing.. haven't looked into that :)<br />
Edit: This page is informative, though: http://msdn.microsoft.com/en-us/library/bb760816%28VS.85%29.aspx#Marquee_Style</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">31st March 2010, 17:29</div></div><div class="posttext">complete example...<br />
<br />
!include &quot;WinMessages.nsh&quot;<br />
!include &quot;MUI2.nsh&quot;<br />
!include &quot;nsDialogs.nsh&quot;<br />
<br />
OutFile &quot;test.exe&quot;<br />
<br />
Section<br />
SectionEnd<br />
<br />
Var dialog<br />
Var hwnd<br />
Var null<br />
<br />
!define PB_EXSTYLE ${WS_EX_WINDOWEDGE}|${WS_EX_CLIENTEDGE}<br />
!define PBS_MARQUEE 0x08<br />
<br />
Page Custom page.custom<br />
Function page.custom<br />
	nsDialogs::Create 1018<br />
	Pop $dialog<br />
<br />
	nsDialogs::CreateControl &quot;msctls_progress32&quot; \<br />
		${DEFAULT_STYLES}|${PBS_MARQUEE} \<br />
		${PB_EXSTYLE} \<br />
		0 0 100% 10% \<br />
		&quot;Test&quot;<br />
	    Pop $hwnd<br />
<br />
	${NSD_CreateTimer} NSD_Timer.Callback 10 ; Need a timer to kickstart the marquee progressbar<br />
	nsDialogs::Show<br />
FunctionEnd<br />
<br />
Function NSD_Timer.Callback<br />
	SendMessage $hwnd ${PBM_SETMARQUEE} 1 50 ; start=1|stop=0 interval(ms)=+N<br />
	${NSD_KillTimer} NSD_Timer.Callback ; Kill the timer<br />
	MessageBox MB_YESNO &quot;Stop the marquee?&quot; IDNO +2<br />
		SendMessage $hwnd ${PBM_SETMARQUEE} 0 0<br />
FunctionEnd<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
<br />
Essentially you would put all of your actions inside the function that is being called, and start/stop/slow-down/speed-up the progressbar from there.<br />
<br />
Edit: The Marquee-style progressbar is not available with all visual themes, though.  If you comment out the MUI2 lines, you'll see that in the non-MUI visual theme, there is no marquee effect.  Something to keep in mind :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">31st March 2010, 17:44</div></div><div class="posttext">And one more reply.... This is a plugin we actually use for our uninstaller to set the progress of the built-in un.InstFiles page to a correct amount (we use a stored list to delete only installed files, and the built-in progress handling only goes by the number of commands it knows about, so direct control to show a correct progress was needed):<br />
http://nsis.sourceforge.net/RealProgress_plug-in<br />
<br />
Note that this plugin does -not- do any marquee style handling - that's not what it's for :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">2nd April 2010, 21:41</div></div><div class="posttext">I have updated the nsDialogs FAQ wiki topic with some more progress bar examples:<br />
http://nsis.sourceforge.net/NsDialogs_FAQ</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>