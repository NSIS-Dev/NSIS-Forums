<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Ability to uninstall post install added files, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Ability to uninstall post install added files NSIS Discussion" />
	
	<title> Ability to uninstall post install added files [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Ability to uninstall post install added files</div>
<hr />
<div class="pda"><a href="t-291479.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291479">Ability to uninstall post install added files</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">tannayr</div><div class="date">8th May 2008, 14:03</div></div><div class="posttext">To clarify, my program has a built in updater that updates and adds files as they are needed. I used HM NSIS Edit wizard to make my installer/uninstaller and it worked beautifully. Except any files that were downloaded/updated after the install were not deleted and because of this left the folders and the start menu items in place.<br />
<br />
What I am asking is how to obtain the functionality to remove files and folders added to the directory after an install. If anyone could point me in the right direction I would greatly appreciate it. Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DEbln001</div><div class="date">8th May 2008, 14:58</div></div><div class="posttext">I also used downloads in my installer.<br />
If wanted (checkbox) my installer deletes files after execution. I use the following command:<br />
<br />
IfFileExists &quot;$TEMP\FILE_xyz.exe&quot; 0 +2<br />
  Delete &quot;$TEMP\FILE_xyz.exe&quot;<br />
<br />
I hope that helped you a bit</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrmagik</div><div class="date">8th May 2008, 15:01</div></div><div class="posttext">Just put your delete commands in a post install section, usually:<br />
<br />
<br />
<br />
Section -post SECPostInstall<br />
    ; Remove the temp Installation Directory<br />
    RmDir /REBOOTOK $TEMP\myInstall<br />
SectionEnd<br />
<br />
<br />
Or whatever is appropriate for your installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tannayr</div><div class="date">8th May 2008, 15:05</div></div><div class="posttext">Thanks for the quick replies. Going to implement this within the next few hours. Assuming I can change $temp to whatever i need as they are not temporary files.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mrmagik</div><div class="date">8th May 2008, 15:09</div></div><div class="posttext">$TEMP is the Windows temporary directory. It is a built-in/pre-defined variable. You could specify any path for the RmDir command, however. I was just showing you an example.<br />
<br />
Anyway, I recommend using EclipseNSIS, the auto-complete and documentation tree that runs alongside it is invaluable IMO.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tannayr</div><div class="date">8th May 2008, 18:31</div></div><div class="posttext">Think I was a bit unclear with my request. I don't want them deleted after the install. Say if the customer uses the product for a year, and it updates itelf within that year. How do I make the uninstaller delete any files within the directory without having it prespecified in &quot;section UNINSTALL&quot;. Is it possible to add just a &quot;Delete &quot;$INSTDIR\*&quot; kind of thing where * = anything and everything in the $INSTDIR.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fabian.rap.more</div><div class="date">8th May 2008, 19:49</div></div><div class="posttext">Yes</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">8th May 2008, 23:35</div></div><div class="posttext">If you look at the makensis.nsi in Examples they do use RMDir /r to remove a directory and all it's subfiles and subdirectories.  They do this for each of the known directories within INSTDIR, but you'll notice they do NOT do a<br />
RMDir /r $INSTDIR<br />
<br />
I think the reason is that if someone change the destination from soemthing like &quot;C:\Programs Files\NSIS\&quot; to &quot;C:\Program Files\&quot;, then you would NOT want to do a RMDir /r $INSTDIR because it'd blow away their entire Program Files directory.<br />
<br />
So if you don't add any new directories to the root of INSTDIR, and updates only add files(or directories that are more than one level deep) then you could do something like the NSIS isntaller:<br />
RMDir /r $INSTDIR\Bin<br />
RMDir /r $INSTDIR\Updates<br />
RMDir /r $INSTDIR\Docs<br />
RMDir /r $INSTDIR\Examples<br />
<br />
RMDir $INSTDIR<br />
;I believe this last command will only remove <br />
;INSTDIR if it is empty, since there is no /r</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tannayr</div><div class="date">9th May 2008, 03:53</div></div><div class="posttext">Thanks Aaron.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th May 2008, 05:13</div></div><div class="posttext">There's the easy way too,<br />
<br />
Advanced Uninstall Log (http://nsis.sourceforge.net/Advanced_Uninstall_Log_NSIS_Header)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>