<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS Compression, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS Compression NSIS Discussion" />
	
	<title> NSIS Compression [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS Compression</div>
<hr />
<div class="pda"><a href="t-50073.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=50073">NSIS Compression</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dbareis</div><div class="date">18th May 2001, 02:25</div></div><div class="posttext">Hi,<br />
<br />
There may be an undocumented command for this but I have noticed that NSIS compresses each file individually. It would do much better if it &quot;batched&quot; files within a section and compressed the lot in one go (only one table for starters).<br />
<br />
It would probably be better to &quot;batch&quot; by extension within group as then it can compress better (text files are completely different from graphics etc) or allow the user to specify where batching occurs.<br />
<br />
If there is such an option already please let me know, I did search the newsgroups as I noticed that the doco appears out of date as I can't see some commands I'm pretty sure I've seen mentioned in recent posts...<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Gonzotek</div><div class="date">18th May 2001, 03:19</div></div><div class="posttext">--------------------------<br />
SetCompress auto|force|off<br />
This command sets the compress flag which is used by the installer to determine whether or not data should be compressed. Typically the SetCompress flag will effect the commands after it, and the last SetCompress command in the file also determines whether or not the install info section and uninstall data of the installer is compressed. If compressflag is 'auto', then files are compressed if the compressed size is smaller than the uncompressed size. If compressflag is set to 'force', then the compressed version is always used. If compressflag is 'off' then compression is not used (which can be faster). <br />
---------------------------<br />
<br />
By &quot;It would do much better if it 'batched' files&quot; do you mean build time or space   --or--  installer time/space? I was under the impression (and that doesn't mean I think I am right) that by setting the flag to 'auto' you'd get the best of both worlds.  'Force' might work well if you have a lot of similar files. And 'Off' would work well if you have files that don't compress all that well (like files that are used in a highly compressed format to begin with).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbareis</div><div class="date">18th May 2001, 04:02</div></div><div class="posttext">Sorry but my files are being compressed, I made sure of that and I tried the data block compression (whatever that is)! <br />
<br />
The compression has an overhead (a table which is used to recreate the data), this is why a file originally 100 bytes long would get larger when &quot;compressed&quot;. This is what the &quot;auto&quot; flag is for, it ensures that if a compressed file is larger is not used (that is you are trying for minimal size - I'm not sure why anyone would choose 'ON' - surely not as an extremely poor mans encryption?).<br />
<br />
The larger the chunk of data the smaller the percentage of the data taken up by the table.  Larger data should also produce a better more efficient table (but depending on how the compression works it may not look ahead far enough for this to help).<br />
<br />
Basically I was hoping that if I had 100 small gif files in a section that rather than possibly have 100 poorly (if at all) compressed files with the overhead 100 times, I could get the overhead once as well as well compressed data.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Koen van de Sande</div><div class="date">18th May 2001, 10:03</div></div><div class="posttext">dbareis means that he doesn't want NSIS to compress every file seperately, but instead compress groups of files at the same time - it's like creating a seperate zip file for 1000 small files - every time you get overhead.<br />
So dbareis wants them to be compressed at the same time, thus saving overhead (and improving compression).<br />
<br />
You could write a tool for this, which'd combine all files into 1 file, append it to an exe file, which extracts the files again upon execution. But that's not the best solution for the problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Edgewize</div><div class="date">19th May 2001, 15:16</div></div><div class="posttext">This ties into the proposed BZIP2 compression, as well, because BZ2 works really well on large blocks but not on smaller files.<br />
<br />
If the datablock could be completely reorganized to compress in 900kb chunks instead of a per-file basis, BZ2 would probably kick ZLIB's ass on ratio.  (I say 900kb because BZIP2 has a built-in block size of 900kb, after which it resets.)<br />
<br />
I think this is a task best left to Justin, though, because I know that the datablock gets slightly reorganized with every release of NSIS and a patch would probably break between versions.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>