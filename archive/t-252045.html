<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Help ! Writing into an Custom Page Input Box, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Help ! Writing into an Custom Page Input Box NSIS Discussion" />
	
	<title> Help ! Writing into an Custom Page Input Box [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Help ! Writing into an Custom Page Input Box</div>
<hr />
<div class="pda"><a href="t-252045.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=252045">Help ! Writing into an Custom Page Input Box</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">baskaran.vishnu</div><div class="date">27th July 2006, 10:05</div></div><div class="posttext">Hi,<br />
<br />
I have a question regarding writing into an input field of a custom page.<br />
<br />
I have a custom page with an input box with the codes as seen below;<br />
<br />
var \GLOBAL PORTNO #Global variable to hold the Port Number<br />
Page Custom AddOptionShow AddOptionCheck<br />
<br />
Function .onInit<br />
<br />
  !insermacro MUI_INSTALLOPTIONS_EXTRACT_AS &quot;Forms\AddOption.ini&quot; &quot;AddOps&quot;<br />
<br />
FunctionEnd<br />
<br />
Function AddOptionShow <br />
  !insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;AddOps&quot;<br />
  !insertmacro MUI_INSTALLOPTIONS_SHOW <br />
FunctionEnd<br />
<br />
Function AddOptionCheck<br />
 /* Link the function to the AddOption.ini */<br />
  !insertmacro MUI_INSTALLOPTIONS_READ $PORTNO &quot;AddOps&quot; &quot;Field 2&quot; &quot;State&quot;<br />
<br />
  ${if} $PORTNO == &quot;&quot; #Empty/Blank Port Number<br />
     MessageBox MB_OK &quot;Error: Port Number Must Not be empty !&quot;<br />
   <br />
  /* Write back a default Port Number into the Input Box */ <br />
   !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;AddOps&quot; &quot;Field 2&quot; &quot;8080&quot;<br />
     Abort #Back to the Port page<br />
   <br />
  ${else}<br />
     MessageBox MB_OK &quot;Success! Port Number entered is: $PORT&quot;<br />
     goto END<br />
  ${endif}<br />
<br />
END:<br />
FunctionEnd<br />
<br />
<br />
Based on the codes above, Function AddOptionShow initializes and displays the custom page. Function AddOptionCheck  checks the keyed in Port number. If the Port Number is NULL (Blank field), I would get a returned error message and the installer would enter back a default Port number of &quot;8080&quot; into the Port input field<br />
<br />
However, the '!insertmacro MUI_INSTALLOPTIONS_WRITE &quot;AddOps&quot; &quot;Field 2&quot; &quot;8080&quot;' does not seem to write 8080 into the Port Input field.  <br />
<br />
Is there a way which i could write back into the input box after displaying the error message ?<br />
<br />
Thanks very much for any ideas or help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th July 2006, 10:32</div></div><div class="posttext">InstallOptions doesn't read the INI file again when you call Abort in the Leave function. If it did, you'd notice a bit of a pause before the dialog was shown. The dialog is still in memory in the Leave function, so you can modify the dialog with SendMessage.<br />
<br />
Examples\InstallOptions\testnotify.nsi is a good example.<br />
Check its Leave function where it uses EnableWindow, SendMessage etc to modify the dialog controls.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">y2kanily2k</div><div class="date">28th July 2006, 12:49</div></div><div class="posttext">Hey, You can try like this<br />
<br />
 !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;AddOps&quot; &quot;Field 2&quot; &quot;State&quot; &quot;8080&quot;<br />
<br />
The above will work good.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th July 2006, 12:54</div></div><div class="posttext">He was missing &quot;State&quot; yes, but it will still not work. Read my message above.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baskaran.vishnu</div><div class="date">14th August 2006, 05:04</div></div><div class="posttext">Hi,<br />
<br />
Sorry for my late reply. Thanks Afrow on your guide.<br />
<br />
I was able to use the SendMessage command in NSIS to actually send back a default Port Number to the specific Input box.<br />
<br />
But, I would also like to bring your attention to focus issue for the input box. At the moment, when the custom page loads, I would set focus to the Port Number input box to make it easier for the to directly key in the port number, instead of having to drag the mouse cursor into the input box. The sample code is as shown below;<br />
<br />
<br />
var \GLOBAL PORTNO #Global variable to hold the Port Number<br />
Page Custom AddOptionShow AddOptionCheck<br />
<br />
Function .onInit<br />
<br />
!insermacro MUI_INSTALLOPTIONS_EXTRACT_AS &quot;Forms\AddOption.ini&quot; &quot;AddOps&quot;<br />
<br />
FunctionEnd<br />
<br />
Function AddOptionShow<br />
!insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;AddOps&quot;<br />
<br />
/* Set Focus for the Port Number field */<br />
Push &quot;$PLUGINSDIR\AddOps&quot;<br />
Push &quot;$R0&quot;<br />
Push &quot;2&quot; #the field number of the Port Number Input Box <br />
Call SetFocus #Function to Set Focus to a specific Input Box<br />
!insertmacro MUI_INSTALLOPTIONS_SHOW<br />
FunctionEnd<br />
<br />
Function AddOptionCheck<br />
/* Link the function to the AddOption.ini */<br />
!insertmacro MUI_INSTALLOPTIONS_READ $PORTNO &quot;AddOps&quot; &quot;Field 2&quot; &quot;State&quot;<br />
<br />
${if} $PORTNO == &quot;&quot; #Empty/Blank Port Number<br />
MessageBox MB_OK &quot;Error: Port Number Must Not be empty !&quot;<br />
<br />
/* Write back a default Port Number and SetFocus into the Input Box */<br />
!insertmacro MUI_INSTALLOPTIONS_READ $R1 &quot;AddOps&quot; &quot;Field 2&quot; &quot;HWND&quot;<br />
SendMessage $R1 ${WM_SETFOCUS} 0 0<br />
SendMessage $R1 ${WM_SETTEXT} 0 &quot;STR:8080&quot;<br />
<br />
Abort #Back to the Port page<br />
<br />
${else}<br />
MessageBox MB_OK &quot;Success! Port Number entered is: $PORT&quot;<br />
goto END<br />
${endif}<br />
<br />
END:<br />
FunctionEnd<br />
<br />
<br />
From the code above, During the custom page loadup, I have used the SetFocus function to set focus into the InputField of the Port Number (http://nsis.sourceforge.net/Set_Focus_to_a_Control)<br />
<br />
Once the Next button is pressed, if the Port Number is empty, the error message would be displayed followed by the SendMessage command to populate the PortNumber Input box with a default value (8080) as well as Set Focus into it. This works, the number 8080 is loaded into the Input box and the cursor has been focused into it. But, I can't seem to type into the Port Number box anymore !<br />
<br />
I have tried typing some extra numbers into it, but nothing gets typed into it despite the cursor being focused into the PortNumber input box. If I were to remove the 'SendMessage $R1 ${WM_SETFOCUS} 0 0' command, I could type into the PortNumber Input box. <br />
<br />
I am not sure where I have gone wrong. Thanks a million for any available help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th August 2006, 10:45</div></div><div class="posttext">You need a Pop $R0 after<br />
!insertmacro MUI_INSTALLOPTIONS_INITDIALOG<br />
See the usage example on that page.<br />
<br />
You may also need to call that function again instead of a basic SendMessage with ${WM_SETFOCUS}.<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>