<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Suggestions for makensis.nsi, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Suggestions for makensis.nsi NSIS Discussion" />
	
	<title> Suggestions for makensis.nsi [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Suggestions for makensis.nsi</div>
<hr />
<div class="pda"><a href="t-138262.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=138262">Suggestions for makensis.nsi</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">8th June 2003, 11:32</div></div><div class="posttext">1)<br />
<br />
!define VER_MAJOR 2<br />
!define VER_MINOR 0b4<br />
<br />
...<br />
<br />
!define VERSION &quot;2.0b4 (CVS)&quot;<br />
<br />
Is not better to put this below, because when you change the version, only need to change in the VER_MAJOR and VER_MINOR defines:<br />
<br />
!define VERSION &quot;${VER_MAJOR}.${VER_MINOR} (CVS)&quot;<br />
<br />
2) Adding the effect, to show a custom text next to the progress bar when installing some type of files, or creating shortcuts... Example: <br />
<br />
Section &quot;NSIS Development System (required)&quot; SecCore<br />
  SetDetailsPrint textonly<br />
  DetailPrint &quot;Installing files...&quot; ; (or &quot;Installing NSIS Development System (required) files&quot;<br />
  SetDetailsPrint listonly<br />
<br />
  SectionIn 1 2 3 RO<br />
  SetOutPath $INSTDIR<br />
  RMDir /r $SMPROGRAMS\NSIS<br />
<br />
  ...<br />
<br />
  !ifndef NO_STARTMENUSHORTCUTS<br />
  IfFileExists $SMPROGRAMS\NSIS &quot;&quot; nofunshit<br />
<br />
  SetDetailsPrint textonly<br />
  DetailPrint &quot;Creating shortcuts...&quot;<br />
  SetDetailsPrint listonly<br />
<br />
  IfFileExists $INSTDIR\Examples 0 +2<br />
    CreateShortCut &quot;$SMPROGRAMS\NSIS\NSIS Examples Directory.lnk&quot; &quot;$INSTDIR\Examples&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th June 2003, 00:27</div></div><div class="posttext">If you have the code ready can you please submit a patch (http://sourceforge.net/tracker/?atid=373087&amp;group_id=22049&amp;func=browse)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">10th June 2003, 09:52</div></div><div class="posttext">I will submit wednesday or thursday, because the time give to me is little, thanks for the chance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">10th June 2003, 18:53</div></div><div class="posttext">Maybe it's me...<br />
but with the current CVS, makensis.nsi <br />
doesn't compile the VersionInfo.nsi...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th June 2003, 20:30</div></div><div class="posttext">Lobo Lunar: fixed</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">12th June 2003, 09:39</div></div><div class="posttext">I have more suggestions:<br />
<br />
For StartMenu.nsi:<br />
<br />
If you create a shortcut folder like &quot;$SMPROGRAMS\Company\Games\My Game\&quot; using the StartMenu dll, you will work only on the My Game folder, and remove it, but the Company and the Games folder, will be not deleted after the uninstallation (if not exist shortcuts)?<br />
<br />
This code in red is a solution for this:<br />
<br />
...<br />
<br />
    RMDir &quot;$SMPROGRAMS\${TEMP}&quot; ;Only if empty, so it won't delete other shortcuts<br />
<br />
    StartMenuLoop:<br />
    Push ${TEMP}<br />
     Call un.GetParent<br />
    Pop ${TEMP}<br />
    StrCmp $R9 &quot;&quot; +3 0<br />
      RMDir &quot;$SMPROGRAMS\${TEMP}&quot;<br />
        Goto StartMenuLoop<br />
<br />
  !insertmacro MUI_STARTMENU_DELETE_END<br />
<br />
...<br />
<br />
(${TEMP}= a the var that you use for the Start Menu Folder)<br />
<br />
It will remove the My Game, Games and the Company folders (if not exist any shortcuts), and any parent folder that exists, (except the SMPrograms)! But it requires the GetParent Function.<br />
<br />
For MakeLangID.exe:<br />
<br />
- Add these &quot;SubLang&quot;s to the program:<br />
<br />
SubLang_Kashmiri<br />
SubLang_Nepali<br />
SubLang_Serbian<br />
<br />
Because the &quot;Lang&quot;s don't have a &quot;sublang&quot; default compared to other languages that have the default. I.e.:<br />
<br />
Lang_Spanish - have<br />
SubLang_Spanish (that is the default sublang)<br />
<br />
- Remove these &quot;SubLang&quot;s from the program:<br />
<br />
SubLang_Korean<br />
SubLang_Lithuanian<br />
<br />
Because these languages don't have more than one sublang. I.e.:<br />
<br />
Lang_Korean<br />
SubLang_Korean (is the default one, don't have more sublangs)<br />
<br />
For Everyone:<br />
<br />
I made a list with all available languages to use with NSIS (based on MakeLangID.exe), that I attached here. It detects the real system language. If is the English from UK, Australia, US... Is Spanish from Argentina, Uruguay, Costa Rica, Spain... This is not dependent of Modern UI Language Files, so you can use it normaly with any UI.<br />
<br />
Use $(LangName) to you use the result.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th June 2003, 16:19</div></div><div class="posttext">The start menu code is a nice idea. I'll add it.<br />
<br />
As for MakeLangID, the list is an exact copy of what Microsoft has defined in their .h files. I have not changed anything to maintain full compatibility.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">virtlink</div><div class="date">13th June 2003, 11:57</div></div><div class="posttext">Maybe a little bit offtopic, but:<br />
<br />
What always bothers me, is the very long 'Creating shortcut' line.<br />
Example (something like):<br />
&quot;Creating shortcut: C:\Documents and Settings\Daniel\Start Menu\Programs\NSIS\Shortcut.lnk&quot;<br />
It doesn't fit in the window, and it looks awfull. In Microsof programs, this is solved my removing the midsection of the url:<br />
&quot;Creating shortcut: C:\Documents and Settings\...\NSIS\Shortcut.lnk&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">13th June 2003, 12:19</div></div><div class="posttext">This MSDN page (http://search.microsoft.com/gomsuri.asp?n=1&amp;c=rp_Results&amp;siteid=us&amp;target=http://support.microsoft.com/default.aspx?scid=kb%3Ben-us%3B249678) details how to create such ellipsis shortened text.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">15th June 2003, 16:38</div></div><div class="posttext">For System.nsh (System Plugin):<br />
<br />
; Is it DRIVE_FIXED?<br />
System::Call '${sysGetDriveType} (i r1) .r3'<br />
IntCmp $3 ${DRIVE_FIXED} 0 enumnext<br />
<br />
The comment question says that this code will detect the drives that are fixed (Hard Disk), but it detects the fixed, remote, cdrom, or ram disk drives. So replacing the IntCmp by StrCmp will detect ONLY the hard disks, that is the objective here.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th June 2003, 18:25</div></div><div class="posttext">Done, thanks.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>