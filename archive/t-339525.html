<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Has GetDrives Stopped Enumerating Mapped Drives in Windows7 ?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Has GetDrives Stopped Enumerating Mapped Drives in Windows7 ? NSIS Discussion" />
	
	<title> Has GetDrives Stopped Enumerating Mapped Drives in Windows7 ? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Has GetDrives Stopped Enumerating Mapped Drives in Windows7 ?</div>
<hr />
<div class="pda"><a href="t-339525.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=339525">Has GetDrives Stopped Enumerating Mapped Drives in Windows7 ?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">16th December 2011, 18:58</div></div><div class="posttext">I have been using the very useful GetDrives (http://www.downloadatoz.com/software-development_directory/nsis/manual/SectionE.1.html#E.1.5) function for a while, but only today I discovered that while it continues to work perfectly on Windows XP, it doesn't list network-mapped drives on Windows 7.<br />
<br />
(I tried both the default &quot;ALL&quot; and the more specific &quot;FDD+HDD+CDROM+NET+RAM&quot; option)<br />
<br />
Is this known behavior?<br />
<br />
Any suggestion how to enumerate all drives (including mapped network shares) on Windows 7?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">16th December 2011, 20:24</div></div><div class="posttext">Could it be related to elevation?  http://forums.winamp.com/showthread.php?t=339478</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">16th December 2011, 20:39</div></div><div class="posttext">GetDrives works on my Windows 7 Professional SP1 (64-bit) system, Here are the results from a test using &quot;NET&quot;:<br />
X:\  (NET Drive)<br />
Y:\  (NET Drive)<br />
Tested using NSIS 2.45 using RequestExecutionLevel &quot;user&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">16th December 2011, 21:09</div></div><div class="posttext">GetDrives works on my Windows 7 Professional SP1 (64-bit) system, Tested using NSIS 2.45 using RequestExecutionLevel &quot;user&quot;<br />
<br />
This is very interesting. I use:<br />
<br />
RequestExecutionLevel admin<br />
<br />
Which should intuitively provide more access to the system, not less.<br />
<br />
I will test this with user and see what happens.<br />
<br />
(BTW, I am using NSIS 2.45, too. I should upgrade to the latest 2.46, I know.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">16th December 2011, 23:49</div></div><div class="posttext">I forgot to mention that I ran my test from a standard account, not an administrator account.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">17th December 2011, 07:01</div></div><div class="posttext">This is very interesting. I use:<br />
<br />
requestexecutionlevel admin<br />
<br />
Which should intuitively provide more access to the system, not less.<br />
Anders did suggest that drive mapping (which are per-user) may not survive elevation. Intuitively, that seems pretty reasonable.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">17th December 2011, 12:20</div></div><div class="posttext">Anders is right - if you elevate then GetDrives can only see the drives mapped by the administrative rights account.<br />
<br />
My admin account does not have any mapped drives so when I re-ran my test with  RequestExecutionLevel &quot;admin&quot; the GetDrives NET option did not find anything.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">19th December 2011, 11:40</div></div><div class="posttext">http://blogs.msdn.com/b/cjacks/archive/2007/02/19/mapped-network-drives-with-uac-on-windows-vista.aspx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">13th January 2012, 16:57</div></div><div class="posttext">http://blogs.msdn.com/b/cjacks/archive/2007/02/19/mapped-network-drives-with-uac-on-windows-vista.aspx<br />
Anders, you are the forum king. Thank you!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>