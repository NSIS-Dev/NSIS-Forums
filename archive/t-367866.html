<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Windows 8 problem - shorcuts are not created for a non-admin account, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Windows 8 problem - shorcuts are not created for a non-admin account NSIS Discussion" />
	
	<title> Windows 8 problem - shorcuts are not created for a non-admin account [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Windows 8 problem - shorcuts are not created for a non-admin account</div>
<hr />
<div class="pda"><a href="t-367866.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=367866">Windows 8 problem - shorcuts are not created for a non-admin account</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">darryllrohr</div><div class="date">1st August 2013, 20:55</div></div><div class="posttext">Hello,<br />
<br />
i have created a nullsoft installer.  it works as expected on all OS's except for windows 8.<br />
<br />
on windows 8, i am having a problem with the CreateShortCut command.<br />
<br />
i have set the proper execution level:<br />
RequestExecutionLevel admin<br />
<br />
i am getting the start menu directory from here:<br />
!insertmacro MUI_PAGE_STARTMENU Application $StartMenuFolder<br />
<br />
and here are the CreateShortCut commands that i am using:<br />
CreateDirectory &quot;$SMPROGRAMS\$StartMenuFolder&quot;<br />
CreateShortCut &quot;$SMPROGRAMS\$StartMenuFolder\MyProgram.lnk&quot; &quot;$INSTDIR\MyLauncher.exe&quot;<br />
CreateShortCut &quot;$DESKTOP\MyProgram.lnk&quot; &quot;$INSTDIR\MyLauncher.exe&quot;<br />
<br />
when i run the installer on a user account that has admin privileges, a desktop shortcut is created, the startmenu folder is created, and shortcuts are created in the start menu folder.  also, my application shows up in the windows 8 &quot;apps&quot; interface.  i also verify that the startmenu shortcuts were created at:<br />
C:\Users\myuser\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\MyProgram<br />
<br />
however, when i run the installer on a user account that does not have admin privileges, the shortcuts do not get created.  i do experience the execution level request (i have to enter the credentials for an admin account).  once entered, the program does install, but the shortcuts are not created and my program does not show up in the windows 8 &quot;app&quot; interface.<br />
<br />
any ideas?<br />
<br />
thanks,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd August 2013, 00:17</div></div><div class="posttext">This is how UAC works, if a non-admin user elevates with a admin account the new process runs as that admin.<br />
<br />
If you are installing into $programfiles / HKLM you are doing a machine/all users install and you should call &quot;SetShellVarContext all&quot; so your shortcuts are visible for all users...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">darryllrohr</div><div class="date">2nd August 2013, 19:18</div></div><div class="posttext">i know how UAC works. the permission elevation was not the issue, but setting SetShellVarContext to &quot;all&quot; and verifying Local Machine vs Current User solved my problem.<br />
<br />
thanks</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>