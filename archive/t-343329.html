<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" win7/vista install template, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  win7/vista install template NSIS Discussion" />
	
	<title> win7/vista install template [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  win7/vista install template</div>
<hr />
<div class="pda"><a href="t-343329.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=343329">win7/vista install template</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">gclass</div><div class="date">21st March 2012, 14:34</div></div><div class="posttext">Hi<br />
I am about to write for the first time uninstall data to the registry.<br />
the installer just need to place a file and create desktop and start menu short cuts.<br />
<br />
I looked for some information, and found this template:<br />
http://nsis.sourceforge.net/Sample_installation_script_for_an_application<br />
<br />
and this one as for the permission level:<br />
http://nsis.sourceforge.net/Shortcuts_removal_fails_on_Windows_Vista<br />
<br />
I wonder if this will cover all and the installer will have the most chances to work properly on most machines?<br />
<br />
or if there is a template I can learn from?<br />
<br />
thx<br />
G</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st March 2012, 19:22</div></div><div class="posttext">If you require administrator access for installation you still need to check the user is an administrator using the UserInfo plug-in (as that page states). You need administrator access if your shortcut will be placed for all users, you are writing to HKLM registry or you are writing files to Program Files or Windows. If you are not writing to any of these locations (uninstall registry can go in HKCU), you can just use RequestExecutionLevel user.<br />
<br />
But yes, that is enough to ensure a standard installation will work on all Windows versions (including Windows 8) *.<br />
<br />
* that can execute 32-bit programs I should add :)<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gclass</div><div class="date">23rd March 2012, 12:53</div></div><div class="posttext">Hi Stu,<br />
Thank you for your kind reply :)<br />
I managed to code it properly and it is working as expected on xp,vista and 7.<br />
<br />
thinking about admin permissions, I wonder how &quot;appropriate&quot; it is to install software to c:\somefolder and place desktop shortcut in case NSIS do not get admin privileges?<br />
<br />
thx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">23rd March 2012, 13:46</div></div><div class="posttext">You can't write to C:\somefolder without admin privileges. The only folder you can write to is the user's profile folders, such as $APPDATA. This is where you would install to for per-user installs, create per-user shortcuts and write HKCU uninstall registry.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gclass</div><div class="date">23rd March 2012, 14:04</div></div><div class="posttext">thanks Stu,<br />
really helpful and useful<br />
:)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>