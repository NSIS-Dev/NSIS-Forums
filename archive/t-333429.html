<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Write registry key to HKEY_CURRNET_USER from RunAs Admin installer, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Write registry key to HKEY_CURRNET_USER from RunAs Admin installer NSIS Discussion" />
	
	<title> Write registry key to HKEY_CURRNET_USER from RunAs Admin installer [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Write registry key to HKEY_CURRNET_USER from RunAs Admin installer</div>
<hr />
<div class="pda"><a href="t-333429.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=333429">Write registry key to HKEY_CURRNET_USER from RunAs Admin installer</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">marcins</div><div class="date">11th August 2011, 12:02</div></div><div class="posttext">Hello,<br />
I was looking for this a few days and I still don't know how to do this, so maybe someone here can help me!<br />
I have installer that must be run as Admin to copy all files into right directories but at same time I need to write registry key to HKEY_CURRNET_USER (can be all users in the system, doesn't matter). But when I'll run installer as Admin it will write registry key (only) to Admin's HKEY_CURRNET_USER, not user that I want.<br />
<br />
So is there any way/script to write something for HKEY_CURRENT_USER to all users in system?<br />
HKEY_LOCAL_MACHINE is not good for me... must be HKEY_CURRENT_USER.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">11th August 2011, 14:14</div></div><div class="posttext">You can user enumusersreg to get access to all trees in the HKU hive. If you only want access to the user who first executed the installer, you'll need the UAC plugin (not recommended).<br />
<br />
Note however that you should not write to userlevel registry in an admin-only installer. If an installer requires admin access, it should always install for all users, and thus should write to HKLM. Only userlevel installers are supposed to install for a single user. This is the way Windows is designed to be used.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">marcins</div><div class="date">16th August 2011, 09:27</div></div><div class="posttext">Well it doesn't work like that to me. Can someone please help me?<br />
<br />
When I run it on Admin account scripts add lines to registry but only for Admin.<br />
<br />
Here is simple script that i want to use.<br />
<br />
!include &quot;EnumUsersReg.nsh&quot;<br />
Name EnumUsersReg<br />
OutFile EnumUsersReg.exe<br />
 <br />
ShowInstDetails show<br />
 <br />
Section<br />
; use ${un.EnumUsersReg} in uninstaller sections<br />
${EnumUsersReg} CallbackFunction temp.key<br />
SectionEnd<br />
 <br />
Function CallbackFunction<br />
 <br />
Pop $0<br />
 <br />
; registry x32<br />
    WriteRegStr HKU &quot;Software\JavaSoft\Prefs\com\ibm\/S/P/S/S\/S/P/S/S /Statistics\19.0\ui\doc_types\dataeditor\menus\19;/Predictive /Solutions;0;;\0;/P/S /D/A/S;0;;&quot; &quot;0&quot; &quot;separator;&quot;<br />
    WriteRegStr HKU &quot;Software\JavaSoft\Prefs\com\ibm\/S/P/S/S\/S/P/S/S /Statistics\19.0\ui\doc_types\output\menus\19;/Predictive /Solutions;0;;\0;/P/S /D/A/S;0;;&quot; &quot;0&quot; &quot;separator;&quot;<br />
    WriteRegStr HKU  &quot;Software\JavaSoft\Prefs\com\ibm\/S/P/S/S\/S/P/S/S /Statistics\19.0\ui\doc_types\syntax\menus\19;/Predictive /Solutions;0;;\0;/P/S /D/A/S;0;;&quot; &quot;0&quot; &quot;separator;&quot;<br />
	<br />
DetailPrint $0<br />
 <br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">16th August 2011, 17:30</div></div><div class="posttext">Software is not the the root of HKU</div></div><hr />


<div class="post"><div class="posttop"><div class="username">marcins</div><div class="date">16th August 2011, 19:53</div></div><div class="posttext">So how i should write that Key? I cant use numbers like S-1-5-21... because they are different in every windows?! Please help!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">16th August 2011, 21:39</div></div><div class="posttext">So how i should write that Key? I cant use numbers like S-1-5-21... because they are different in every windows?! Please help!<br />
<br />
EnumUsersReg knows</div></div><hr />


<div class="post"><div class="posttop"><div class="username">msroboto</div><div class="date">16th August 2011, 21:47</div></div><div class="posttext">I know you say that you have to write this for every user.<br />
How will you handle new users added to the system after your install?<br />
Just something to consider.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">17th August 2011, 03:33</div></div><div class="posttext">I know you say that you have to write this for every user.<br />
How will you handle new users added to the system after your install?<br />
Just something to consider.<br />
<br />
The correct way to handle this is to copy default settings to HKCU when your _application_ is started for the first time as that user</div></div><hr />


<div class="post"><div class="posttop"><div class="username">marcins</div><div class="date">17th August 2011, 09:02</div></div><div class="posttext">Ok its working now! I forgot to put $0\ before Software. Thanks for help!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>