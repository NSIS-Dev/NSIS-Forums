<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS - Control folder location in Start-Menu, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS - Control folder location in Start-Menu NSIS Discussion" />
	
	<title> NSIS - Control folder location in Start-Menu [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS - Control folder location in Start-Menu</div>
<hr />
<div class="pda"><a href="t-359441.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=359441">NSIS - Control folder location in Start-Menu</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Carolus</div><div class="date">15th April 2013, 10:21</div></div><div class="posttext">Hi,<br />
<br />
I have done NSIS script that performs silent installations on several setup files (.exe).<br />
<br />
They end up on different default locations/folders in the Start menu, since I have not specified where to place them, and I don't know how.<br />
<br />
The reason is that some of these installed programs are pointless to have as stand-alone programs, as they depend on the &quot;Main&quot; installed program to run.<br />
<br />
So, what I want to do is to control, in the NSIS script, that some of the program folders are placed inside/under the &quot;MAIN&quot;-program folder in the Start-menu.<br />
<br />
How do I do this? Is it possible?<br />
<br />
BR<br />
Carolus</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th April 2013, 11:24</div></div><div class="posttext">You can either just delete those short cuts and then create your own after running the silent installers, or just move them using Rename. You can just move the entire folders under your own.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Carolus</div><div class="date">15th April 2013, 13:03</div></div><div class="posttext">Hi,<br />
<br />
Thanks for your reply.<br />
<br />
Could you please show an example of this?<br />
<br />
I tried to 'move' som program folders using createshortcut, but that doesn't work.<br />
<br />
BR,<br />
Carolus</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th April 2013, 13:11</div></div><div class="posttext">As I said, use the Rename instruction. You can move files and folders using it.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Carolus</div><div class="date">16th April 2013, 13:25</div></div><div class="posttext">Hi,<br />
<br />
Thanks.<br />
<br />
I am of course doing somehting wrong, it doesn't work.<br />
<br />
I tried, after the silent installation calls (ExecWait....) on one of the 'sub-apps' with this:<br />
<br />
; There is a space in MikTex 2.9 folder name <br />
Rename &quot;$SMPROGRAMS\MikTex 2.9&quot; &quot;$SMPROGRAMS\doxygen\MikTex 2.9&quot;<br />
<br />
; Also tried to remove the directory entirely<br />
RMDir /r &quot;$SMPROGRAMS\MikTex 2.9&quot;<br />
<br />
The creation of the installation .exe works and the installation goes through, but the folder is NOT moved, or deleted in the latter case.<br />
<br />
BR,<br />
Carolus</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">16th April 2013, 13:56</div></div><div class="posttext">Are you sure you're in the proper user context? SetShellvarContext all or current? Also, if current, are you at the proper access level (elevated/admin vs userlevel)?<br />
<br />
Put a MessageBox MB_OK &quot;$SMPROGRAMS&quot; in front of your delete command to see which path you're actually trying to delete.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Carolus</div><div class="date">16th April 2013, 14:54</div></div><div class="posttext">Hi,<br />
<br />
Thanks.<br />
<br />
You are abolutely right. I have only tried the delete command so far.<br />
<br />
I copy-pasted the path in the delete command:<br />
RMDir /r &quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\MikTex 2.9&quot;<br />
<br />
And that worked. But that does not look very elegant though. How should it be if I want to use some pre-defined path constant and delete the same directory, in the correct context? <br />
<br />
BR,<br />
Carolus</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">16th April 2013, 14:56</div></div><div class="posttext">As MSG said you need to use SetShellvarContext all to change the context of the path constants (that path is for all users, so use all).<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>