<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Error copying file sometimes when installing, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Error copying file sometimes when installing NSIS Discussion" />
	
	<title> Error copying file sometimes when installing [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Error copying file sometimes when installing</div>
<hr />
<div class="pda"><a href="t-122231.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=122231">Error copying file sometimes when installing</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ve6raj</div><div class="date">21st January 2003, 06:12</div></div><div class="posttext">Hello All: <br />
Not exactly a NSIS problem, but I hope someone can help. I have an install script that works pretty well 90% of the time. On the odd machine I will get this error, usually for 10 to 15 files saying that there is an error copying the file. &quot;Cannot create &lt;filename&gt;: Access is denied. make sure disk is not full or write-protected and that the file is not currently in use.&quot; I click on the OK button for the 10 or 15 times that the error is generated, then the rest of the installation continues normally. After installation the files are where they are supposed to be and evrything works OK. It is just annoying to get these error messages on some machines. On most of the machines the install script works flawlessly.<br />
Thanks in advance<br />
Raj</div></div><hr />


<div class="post"><div class="posttop"><div class="username">virtlink</div><div class="date">21st January 2003, 14:39</div></div><div class="posttext">In order to find the error, please post your script here at the NSIS forum. KiCHiK, I, or someone else will look at it then and eventually fix any bugs in the script and/or NSIS if it are NSIS bugs. It's a possible bug caused by Windows.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ve6raj</div><div class="date">27th January 2003, 00:06</div></div><div class="posttext">Hello and thanks for your reply:<br />
<br />
I would appreciate it if you could shed any light on my problem. <br />
<br />
Here is the script:<br />
<br />
Please do not include large scripts but attach them, especially not HUGE scripts (attached below...)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">27th January 2003, 01:22</div></div><div class="posttext">First thing I see is that you assume the user has a C drive.  Not a good idea.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ve6raj</div><div class="date">27th January 2003, 02:38</div></div><div class="posttext">Yes, it is part of the hardware spec. They all have a drive C:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">27th January 2003, 05:18</div></div><div class="posttext">CreateDirectory &quot;C:\MB2KS&quot;<br />
CreateDirectory &quot;C:\MB2KS\A&quot;<br />
...<br />
<br />
<br />
You should to use $INSTDIR in &quot;C:\MB2KS&quot;, because when the user enter the Install Dir, almost don't have any effect.<br />
<br />
<br />
Yes, it is part of the hardware spec. They all have a drive C:<br />
<br />
<br />
But someone will want to install in drive D (if have two hard disk or two partitions of the hard disk). You can detect drive letter by using:<br />
<br />
<br />
StrCpy [var] &quot;$INSTDIR&quot; 1<br />
<br />
<br />
When [var] is a output variable ($1, $2...).<br />
<br />
This can be useful for the dir &quot;C:\MBWIN&quot;.<br />
<br />
<br />
!define VER_MAJOR 8. <br />
!define VER_MINOR 03<br />
<br />
<br />
You should to delete this dot for the version. You use this dot in other time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th January 2003, 11:12</div></div><div class="posttext">.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cvx_borg</div><div class="date">8th May 2003, 09:23</div></div><div class="posttext">Originally posted by deguix <br />
You can detect drive letter by using:<br />
<br />
StrCpy [var] &quot;$INSTDIR&quot; 1<br />
<br />
When [var] is a output variable ($1, $2...).<br />
<br />
This can be useful for the dir &quot;C:\MBWIN&quot;.<br />
 <br />
<br />
but we should keep in mind that it can result in a &quot;\&quot; as well, for a \\thiscomputer\thisshare\ unc path.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th May 2003, 16:05</div></div><div class="posttext">That's right. You can use this function, GetRoot (http://nsis.sourceforge.net/archive/nsisweb.php?page=293&amp;instances=0,11,211), that I have just created.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>