<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" FileAssociation.nsh Registry Error, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  FileAssociation.nsh Registry Error NSIS Discussion" />
	
	<title> FileAssociation.nsh Registry Error [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  FileAssociation.nsh Registry Error</div>
<hr />
<div class="pda"><a href="t-326760.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=326760">FileAssociation.nsh Registry Error</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mvpetrovich</div><div class="date">2nd February 2011, 03:40</div></div><div class="posttext">In FileAssociation.nsh there are two lines that I believe should be changed (the first and last of the following three):<br />
<br />
  WriteRegStr HKCR &quot;$R0\shell\open\command&quot; &quot;&quot; '&quot;$R2&quot; &quot;%1&quot;'<br />
  WriteRegStr HKCR &quot;$R0\shell\edit&quot; &quot;&quot; &quot;Edit $R0&quot;<br />
  WriteRegStr HKCR &quot;$R0\shell\edit\command&quot; &quot;&quot; '&quot;$R2&quot; &quot;%1&quot;'<br />
<br />
This should be:<br />
<br />
  WriteRegStr HKCR &quot;$R0\shell\open\command&quot; &quot;&quot; '&quot;$R2&quot; %1'<br />
  WriteRegStr HKCR &quot;$R0\shell\edit&quot; &quot;&quot; &quot;Edit $R0&quot;<br />
  WriteRegStr HKCR &quot;$R0\shell\edit\command&quot; &quot;&quot; '&quot;$R2&quot; %1'<br />
<br />
Parentheses should not be around the %1.  When they are there, the parameter is not set, and the file will not open in the desired software.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd February 2011, 17:32</div></div><div class="posttext">Take a look at Verbs and File Associations on MSDN (http://msdn.microsoft.com/en-us/library/bb776883(v=vs.85).aspx#Verbs and File Associations) and you will see:<br />
<br />
command<br />
(Default) = &quot;%ProgramFiles%\MyProgram.exe&quot; &quot;%1&quot;<br />
<br />
Your program is broken if it cannot handle: yourapp.exe &quot;c:\somefile.ext&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mvpetrovich</div><div class="date">2nd February 2011, 19:39</div></div><div class="posttext">Your program is broken if it cannot handle: yourapp.exe &quot;c:\somefile.ext&quot; <br />
<br />
This seemed odd to me, as I thought about this after I posted. Actually, the software is not broken, but uses some very old technology.  This code goes back to around 1998.  I directly read the command line and process the file using the text after the program name.  Back in those days, we did not have parameters passed to an array.  Looks like it is time to enter the modern world. :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd February 2011, 20:40</div></div><div class="posttext">Actually, the software is not broken, but uses some very old technology.  <br />
<br />
Any app written for Win95 or later needs to be able to handle long paths with spaces and wrapped in quotes, if it can't, it is BROKEN!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mvpetrovich</div><div class="date">2nd February 2011, 21:11</div></div><div class="posttext">Correct.  I was parsing the command line myself, and quotes were not needed.  My programs took long file names, and only used one parameter.  What I did not do was allow quotes, since I did not need any delimiters.  I just moved from InstallShield to NSIS (and love it).  My InstallShield setups did not use quotes in the association, so that is how I missed it.  It has been running like that for 12 years.   I'll use the parameter array in the next release to be more compliant.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>