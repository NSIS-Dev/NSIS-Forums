<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Install Section Call Another?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Install Section Call Another? NSIS Discussion" />
	
	<title> Install Section Call Another? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Install Section Call Another?</div>
<hr />
<div class="pda"><a href="t-258867.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258867">Install Section Call Another?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">RossW</div><div class="date">4th November 2006, 02:25</div></div><div class="posttext">I'm developing a 3-section installer for custom MS Access programs, each of which uses custom ActiveX components.<br />
<br />
Is there a way for each section to call a hidden section which installs the VB runtime .dlls, passing in the name of the app so that the code increments the usage counters per the example on the Wiki? Can I do the same when uninstalling the sections?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th November 2006, 03:43</div></div><div class="posttext">You can define a global label in the section and call it. But why not use a function?Section<br />
Call :.global_label<br />
SectionEnd<br />
<br />
Section<br />
.global_label:<br />
DetailPrint hello<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RossW</div><div class="date">4th November 2006, 15:20</div></div><div class="posttext">A function makes sense, but how do i pass in the name of the component? And will the call to the function by synchronous, i.e. will the rest of the code in the section installer be run only AFTER the call to the function completes?<br />
<br />
i.e.<br />
<br />
Push &quot;Sec1Component&quot;<br />
Call InstallVB6RuntimeDlls</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th November 2006, 15:43</div></div><div class="posttext">Pushing the component name on the stack should work, but why would you need to pass it to the function?<br />
<br />
Code in NSIS is ran only synchronously. There's nothing asynchronous in the scripting language.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RossW</div><div class="date">4th November 2006, 17:18</div></div><div class="posttext">The example from the Wiki indicates you need to check if your component/app is already installed:<br />
<br />
   IfFileExists &quot;$INSTDIR\${CompFileName}&quot; 0 new_installation<br />
     StrCpy $ALREADY_INSTALLED 1<br />
<br />
Do I need a Return instruction in the function I'm calling or in the installer section? The user manual is a bit confusing ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th November 2006, 17:24</div></div><div class="posttext">Then you wan to know how to pass parameters to functions? That's easy. Just Push before you Call the function and Pop in the function.Section<br />
Push &quot;section 1&quot;<br />
Call f<br />
SectionEnd<br />
<br />
Section<br />
Push &quot;section 2&quot;<br />
Call f<br />
SectionEnd<br />
<br />
Function f<br />
Pop $0<br />
DetailPrint &quot;called from $0&quot;<br />
FunctionEndHowever, if all you want to install is the VB runtime, you don't need to do it from each section. Installing the runtime once for the entire application is good enough. Add an invisible section (nameless) that installs the runtime and you're set.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RossW</div><div class="date">5th November 2006, 00:59</div></div><div class="posttext">I was using an invisible secion originally when I had only 1 app/component, but with the 3 I thought I'd need to call the VB6Runtime function for each so that it updated the shared counter - otherwise, if I uninstalled 1 section it could remove the ActiveX component that the other two appps use.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th November 2006, 17:52</div></div><div class="posttext">If you provide support for installing each component, I'd say the best solution here would be to make the test for the existence of your &quot;application&quot; check for all three components. As long as either of the components is installed, there's no need to update the shared counter when updating and no need to uninstall the VB6 runtimes.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>