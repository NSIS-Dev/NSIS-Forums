<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Removed CompareDLLVersions ?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Removed CompareDLLVersions ? NSIS Discussion" />
	
	<title> Removed CompareDLLVersions ? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Removed CompareDLLVersions ?</div>
<hr />
<div class="pda"><a href="t-68259.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=68259">Removed CompareDLLVersions ?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th December 2001, 16:28</div></div><div class="posttext">Why is CompareDLLVersions removed in NSIS 1.6? I need it for my installers :mad: Is there other function I can use?<br />
<br />
Thanx.<br />
Joost</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hando</div><div class="date">10th December 2001, 16:53</div></div><div class="posttext">Other DLL function (from the version history):<br />
Removed CompareDLLVersions, CompareFileTimes, added GetDLLVersion, GetFileTime, GetDLLVersionLocal, GetFileTimeLocal, and IntCmpU.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">F. Heidenreich</div><div class="date">10th December 2001, 16:56</div></div><div class="posttext">You could use GetDLLVersion and GetDLLVersionLocal instead of CompareDLLVersions<br />
<br />
See UpgradeDLL in functions.htm for an example.<br />
<br />
~ Florian</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th December 2001, 16:58</div></div><div class="posttext">Thanks.<br />
<br />
So i should use something like: If GetDLLLocalVersion(DLLName) &gt; GetDLLVersion(DLLName) then CopyNewDLL ?<br />
<br />
I'm new to the NSIS system, so i'll have to find out how I can do this is the NSIS language :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">F. Heidenreich</div><div class="date">10th December 2001, 17:41</div></div><div class="posttext">I think you could use it in this way:<br />
<br />
<br />
ClearErrors<br />
GetDLLVersionLocal &quot;test.dll&quot; $0 $1<br />
GetDLLVersion &quot;$SYSDIR\test.dll&quot; $2 $3<br />
IfErrors upgrade_dll<br />
IntCmpU $0 $2 noupgradedll noupgrade_dll upgrade_dll<br />
IntCmpU $1 $3 noupgrade_dll noupgrade_dll<br />
upgrade_dll:<br />
    UnRegDLL &quot;$SYSDIR\test.dll&quot;<br />
    File /oname=&quot;$SYSDIR\test.dll&quot; &quot;test.dll&quot;<br />
    RegDLL &quot;$SYSDIR\test.dll&quot;<br />
noupgrade_dll:<br />
<br />
<br />
~ Florian</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th December 2001, 17:51</div></div><div class="posttext">I just wrote some code similar to your code, with some reboot stuff included. But, I only compare $0 and $2, and it seems to work. Should I also compare $1 and $3 ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th December 2001, 18:16</div></div><div class="posttext">Strange, I've done some testing and now I'm using your code, but it always detects that the integers are equal, but they are not :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th December 2001, 18:22</div></div><div class="posttext">Problem solved ;)<br />
<br />
I'll have to compare only the large integers, because only the build numbers are different.<br />
<br />
IntCmpU $1 $3 noupgradedll noupgrade_dll upgrade_dll<br />
<br />
<br />
Now the next problem :D <br />
<br />
How can I register a DLL on reboot ??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">F. Heidenreich</div><div class="date">10th December 2001, 18:33</div></div><div class="posttext">Hi Joost,<br />
<br />
I don't know how to register a DLL on reboot, but you could use the RegDLL command to register your DLL immediately.<br />
<br />
~ Florian</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th December 2001, 18:36</div></div><div class="posttext">That's true. When the DLL is not in use, I register it with RegDLL, but when the DLL is in use, it should be done after the new DLL is install (on reboot).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">F. Heidenreich</div><div class="date">10th December 2001, 18:42</div></div><div class="posttext">Only an idea ;):<br />
<br />
Try to write an entry at HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce to make a call to regsvr32.exe yourdll.dll.<br />
<br />
~ Florian</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th December 2001, 18:53</div></div><div class="posttext">Good idea :D <br />
<br />
I have to find out how to make this 'silent'. And, is this being called AFTER the NSIS 'Rename on reboot'?<br />
<br />
I'll check where NSIS puts the 'Rename on reboot' stuff :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">10th December 2001, 19:01</div></div><div class="posttext">In Win2000: It it stored in a PendingRenameOperations key.<br />
<br />
Maybe I should write a piece of code that checks which one is called first.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">11th December 2001, 18:13</div></div><div class="posttext">For the solution:<br />
http://forums.winamp.com/showthread.php?s=&amp;postid=415687#post415687</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>