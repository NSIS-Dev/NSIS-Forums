<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" SetOverwrite, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  SetOverwrite NSIS Discussion" />
	
	<title> SetOverwrite [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  SetOverwrite</div>
<hr />
<div class="pda"><a href="t-224039.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=224039">SetOverwrite</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">c567591</div><div class="date">15th August 2005, 22:28</div></div><div class="posttext">I am trying to use set overwrite and I am having 2 problems:<br />
1)  If I set the file date on a file in the OS to the current time and then rerun the installer with SetOverwrite IfNewer, then it is being overwritten anyway. :(<br />
<br />
2)  Here is a section that I am tring to add a commandline variable to override SetOverwrite:<br />
  ${If} $R0 == &quot;&quot;<br />
    SetOverwrite On<br />
    MessageBox MB_OK &quot;*** Warning:  File overwrite mode is ON. All files will be overwritten!&quot;<br />
    DetailPrint &quot;*** Warning:  File overwrite mode is ON. All files will be overwritten!&quot;<br />
    LogText &quot;*** Warning:  File overwrite mode is ON. All files will be overwritten!&quot;<br />
  ${Else}<br />
    SetOverwrite IfNewer  ;Set for regular install<br />
    MessageBox MB_OK &quot;File overwrite mode is set to Update.&quot;<br />
    DetailPrint &quot;File overwrite mode is set to Update.&quot;<br />
    LogText &quot;File overwrite mode is set to Update.&quot;<br />
  ${EndIf}<br />
<br />
I only see 1 message box based on if I have the commandline parameter there or not. <br />
That part works, the SetOverwrite does not seem to change.<br />
<br />
What I am trying to acomplish here is to add a switch for our support to use to force overwrite of all items regardless of the dates/versions.<br />
<br />
I searched and found similar problems but not exactly the same as these.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">16th August 2005, 01:06</div></div><div class="posttext">If I'm not mistaken, SetOverwrite is a compile-time command (since it's used in conjunction with the FILE command.)<br />
<br />
Assuming that, you may need to create 2 separate sections--one  to execute with the command line switch in place and the other when it's not.  (The file commands themselves could be wrapped in a macro so that you could re-use the same FILE commands in both sections without having to re-write a lot of the code.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">16th August 2005, 04:23</div></div><div class="posttext">I was thinking of using 'strcpy $(^SetOverWrite) on' or 'strcpy $(^SetOverWrite) ifnewer' for run-time assigning. I don't know if this will work, it is just an idea I got during the development of the installer for my UI (User Interface).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">c567591</div><div class="date">16th August 2005, 15:14</div></div><div class="posttext">I still don't think that would get around the double file listings.<br />
Is there an alternative to a double file listing?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">16th August 2005, 15:25</div></div><div class="posttext">Let's say that the overwrite flag is stored in $R1. (&quot;Y&quot; means overwrite, 'N' means no overwrite)  Put your file copies in a macro like this:<br />
<br />
!macro InstallFiles<br />
   File 'C:\myfile1.dat'<br />
   File 'C:\myfile2.dat'<br />
   ; [add more files here]<br />
!macroend<br />
<br />
Next, create your two sections like this:<br />
<br />
Section '-WithOverwriteOn'<br />
   ; this section gets processes only when<br />
   ; overwrite flag is on...<br />
   StrCmp $R1 'N' endsection 0<br />
   SetOverwrite on<br />
   SetOutPath 'C:\somedirectory'<br />
   !insertmacro InstallFiles<br />
   endsection:<br />
SectionEnd<br />
<br />
Section '-WithOverwriteOff'<br />
   ; this section gets processes only when<br />
   ; overwrite flag is off...<br />
   StrCmp $R1 'Y' endsection 0<br />
   SetOverwrite IfNewer<br />
   SetOutPath 'C:\somedirectory'<br />
   !insertmacro InstallFiles<br />
   endsection:<br />
SectionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>