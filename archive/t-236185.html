<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Install SSL Certificate, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Install SSL Certificate NSIS Discussion" />
	
	<title> Install SSL Certificate [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Install SSL Certificate</div>
<hr />
<div class="pda"><a href="t-236185.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=236185">Install SSL Certificate</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Ryan J</div><div class="date">23rd January 2006, 03:20</div></div><div class="posttext">Can NSIS be used to install an SSL Certificate? <br />
<br />
I have created an ActiveX component and I want to avoid purchasing a certificate. Also, I have a dll that must be placed in the user's Windows directory in order to use the control anyway... Therefore, I just want to have the user run a setup program to install a SSL cert (so I can self-sign the ActiveX control) and place the DLL in one easy installation.<br />
<br />
I would imagine placing a DLL in Windows is fairly easy, but not sure if NSIS is cabable of installing the certificate...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th January 2006, 17:43</div></div><div class="posttext">If there's an API for it, you can call it using System plug-in. However, it might be simpler and nicer to use ExecShell on the certificate so Windows will ask the user if he wants to install the certificate.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">marbed</div><div class="date">16th March 2006, 13:13</div></div><div class="posttext">Hi,<br />
I found quite good solusion: <br />
<br />
rundll32.exe cryptext.dll,CryptExtAddCER file.cer<br />
<br />
Now I can fired this command via ExecWait and after that we see &quot;import certificate wizard&quot; window. Is possible I think calling method CryptExtAddCER from cryptext.dll, using plugin System (System::Call).<br />
<br />
What do you think about this idea?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th March 2006, 17:33</div></div><div class="posttext">You can try using:System::Call &quot;cryptext::CryptExtAddCER(i $HWNDPARENT, i 0, t 'file.cer', i 1)&quot;However, I'm not sure how it'd react to a NULL passed on hInstance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">16th March 2006, 20:52</div></div><div class="posttext">if i don't know what handle to pass i normally try 0, if not working $HWNDPARENT. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">marbed</div><div class="date">17th March 2006, 06:56</div></div><div class="posttext">Thanks for answers. <br />
Calling certificate wizard is good idea but better is installation a certificate in silent mode. Ofcourse before install certificate in Root store must be warning, but for others certificates silent mode is acceptable. One question:<br />
Can I call CryptExtAddCER function in silent mode? I don't now    <br />
what is definition of this function exactly, maybe I shold set some parameter?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th March 2006, 09:05</div></div><div class="posttext">CryptExtAddCER is an API function specifically for use with rundll32. I doubt it has an option to run silently. But you can try passing 0 on the last parameter (SW_HIDE).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">marbed</div><div class="date">17th March 2006, 14:15</div></div><div class="posttext">Passing 0 in last parameter not work. But i found solution to install the certificates in silent mode. I add keys to registry. My certificates are in this place: <br />
<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SystemCertificates\CA<br />
and <br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SystemCertificates\ROOT\Certificates<br />
<br />
I used reg2nsis to convert *.reg file to NSIS script. When i <br />
fired certmgr.msc every certificates was in correct stores.<br />
<br />
I hope this solution is safe and not been revolution in my store ;)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>