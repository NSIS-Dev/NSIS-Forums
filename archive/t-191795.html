<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Install from regkey help, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Install from regkey help NSIS Discussion" />
	
	<title> Install from regkey help [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Install from regkey help</div>
<hr />
<div class="pda"><a href="t-191795.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=191795">Install from regkey help</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Danimator</div><div class="date">29th August 2004, 18:47</div></div><div class="posttext">I don't understand how to use the InstallDirRegKey code. Please help!<br />
<br />
basically, I want ONLY this section of my installer to check the regkey to see if and where windowblinds is installed, and if it is installed, installe the files there, if it's not installed then install it to a folder in the desktop. (There's 12 sections in my installer, but I only want it applying to this section, not all the other things)<br />
<br />
But I don't know how to incorporate the InstallDirRegKey command into the section. Here's the section code for this, but no idea where to add the regcode stuff properly cuz I'm a noob ; Any help would be very much appreciated, thanx.<br />
<br />
-----------------------------------------------------<br />
<br />
Section &quot;Windowblinds Skins&quot; Section9<br />
<br />
	<br />
; Set Section properties<br />
	<br />
SetOverwrite on<br />
<br />
; Check Registry<br />
<br />
InstallDir $DESKTOP\Windowblinds\<br />
InstallDirRegKey HKLM SOFTWARE\Stardock\Windowblinds\WB5.ini\INSTALLED &quot;RealPath&quot;<br />
<br />
	<br />
; Set Section Files and Shortcuts<br />
	<br />
File &quot;WindowBlinds Skins\Panther.Uis&quot;<br />
File &quot;WindowBlinds Skins\Panther.txt&quot;<br />
<br />
SectionEnd<br />
<br />
<br />
----------------------------------------------------------</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">29th August 2004, 19:58</div></div><div class="posttext">Instead of using InstallDirRegKey on a section you could do (with this code below, you can remove the InstallDir command you put):<br />
<br />
ReadRegStr $INSTDIR HKLM SOFTWARE\Stardock\Windowblinds\WB5.ini\INSTALLED &quot;RealPath&quot;<br />
IfFileExists $INSTDIR +2<br />
  StrCpy $INSTDIR &quot;$DESKTOP\Windowblinds\&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Danimator</div><div class="date">29th August 2004, 20:05</div></div><div class="posttext">K, so how would I type that all in that section? I have nooooo idea ;) haha. Can ya show me using the script e.g. I supplied in top post? (Like I said, I'm a total noob at all this NSIS stuff. Thanx.<br />
<br />
Also, this is the registry key, so also not sure if i have that top part right either:<br />
<br />
-----------------regkey from registry-----------------<br />
<br />
Windows Registry Editor Version 5.00<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Stardock\WindowBlinds\WB5.ini\INSTALLED]<br />
&quot;RealPath&quot;=&quot;C:\\Program Files\\Stardock\\Object Desktop\\WindowBlinds&quot;<br />
&quot;Path3&quot;=&quot;430&quot;<br />
&quot;ver&quot;=&quot;4.30&quot;<br />
&quot;Path&quot;=&quot;Object Desktop&quot;<br />
&quot;Path2&quot;=&quot;WB-g1de774&quot;<br />
--------------------------------------------------------------</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Danimator</div><div class="date">29th August 2004, 20:48</div></div><div class="posttext">k, I tried that code ya put:<br />
<br />
ReadRegStr $INSTDIR HKLM SOFTWARE\Stardock\Windowblinds\WB5.ini\INSTALLED &quot;RealPath&quot;<br />
IfFileExists $INSTDIR +2<br />
  StrCpy $INSTDIR &quot;$DESKTOP\Windowblinds\&quot;<br />
<br />
it didnt do anything during the install...I think it checked the reg key cuz it didnt install teh folder on the desktop, but it didn't install it to the regkey's installed folder either ( isearched harddrive, it didnt install it anywhere) Any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Danimator</div><div class="date">30th August 2004, 17:11</div></div><div class="posttext">Anyone?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">KrYpT</div><div class="date">30th August 2004, 22:39</div></div><div class="posttext">Hm.... did you set the output path? (I assume not because it's never mentioned on this page)<br />
<br />
The quick solution: SetOutPath $INSTDIR<br />
(after the ReadRegStr bit already mentioned)<br />
<br />
But... I can forsee some potential problems... You mentioned you only want this special directory handling to apply to this section (other sections get installed to somewhere else) so you're going to have to save where that somewhere else is, so you will end up using $INSTDIR for two different things. That's probably not going to work (if it's what you plan).<br />
<br />
So, long story short, maybe you could try this (it might take some adapting, but you get the idea):<br />
ReadRegStr $0 HKLM SOFTWARE\Stardock\Windowblinds\WB5.ini\INSTALLED &quot;RealPath&quot;<br />
IfFileExists $0 +2<br />
  StrCpy $0 &quot;$DESKTOP\Windowblinds&quot;<br />
SetOutPath $0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Danimator</div><div class="date">31st August 2004, 01:49</div></div><div class="posttext">Thanx KrYpT, that worked great. Last question though..<br />
<br />
what if I check for that key example &quot;HKLM SOFTWARE\Stardock\Windowblinds\WB5.ini\INSTALLED &quot;RealPath&quot;<br />
<br />
....and the &quot;realpath&quot; part in the registry is &quot;c:\programfiles\object desktop\windowblinds\&quot;<br />
<br />
..how would i then have it install to &quot;c:\programfiles\object desktop\windowblinds\skins&quot; folder?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">31st August 2004, 03:46</div></div><div class="posttext">Put this before SetOutPath $0.<br />
<br />
StrCpy $0 &quot;$0\skins&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Danimator</div><div class="date">31st August 2004, 17:08</div></div><div class="posttext">Thanx, all working great now. Appreciate teh help.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>