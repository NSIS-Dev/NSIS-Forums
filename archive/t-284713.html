<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Wrap multiple MSI's(newbie), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Wrap multiple MSI's(newbie) NSIS Discussion" />
	
	<title> Wrap multiple MSI's(newbie) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Wrap multiple MSI's(newbie)</div>
<hr />
<div class="pda"><a href="t-284713.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=284713">Wrap multiple MSI's(newbie)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">oreillyr</div><div class="date">10th January 2008, 12:18</div></div><div class="posttext">HI All,<br />
<br />
I have a requirement for a client to wrap three MSI's into a single file install. NSIS was recommended to me as the solution! Is it possible to use NSIS to achieve this? I have had a look and dont see MSI's mentioned(possibly not looked efficiently!. When looking at some of the scripts it mentions the installdir however I am looking for something that you can run from the desktop which will just kick off the MSI's one after another, the InstallDir being taken care of in the MSI's themselves. Sorry if I have missed something simple!Could someone point me in the right direction either to a previous post or some sample script involving multiple MSI install? Thanks in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">10th January 2008, 12:36</div></div><div class="posttext">Probably you did not perform a deep search into the forum.<br />
These are regular expressions for nsis. You can extract msi's into $PLUGINSDIR and call msiexec for each one.<br />
You're able to check if the required version of msiexec is installed on the target and download it if needed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oreillyr</div><div class="date">10th January 2008, 14:03</div></div><div class="posttext">Thanks for the reply. Could you give me the URL for one such post please? I have been searching through since and have not found any! cheers</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">10th January 2008, 14:26</div></div><div class="posttext">There's s huge &quot;database&quot; here. Just for reference...<br />
<br />
http://forums.winamp.com/search.php?s=&amp;action=showresults&amp;searchid=10686684&amp;sortby=&amp;sortorder=<br />
<br />
Also you may want to review the documentation,<br />
<br />
http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1<br />
<br />
http://nsis.sourceforge.net/Docs/Chapter4.html#4.1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oreillyr</div><div class="date">10th January 2008, 14:53</div></div><div class="posttext">Thanks mate. Will be more thorough when next searching ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oreillyr</div><div class="date">11th January 2008, 14:01</div></div><div class="posttext">Could anyone post a complete sample script which just installs 1 MSI and I will hopefully be able to work out how to do the rest please? I am not a developer/scripter by any stretch of the imagination! I am having trouble with the installdir concept as the MSI will take care of all that anyway. Do I need to set an installdir? Any help would be appreciated!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th January 2008, 15:09</div></div><div class="posttext">Use File and then ExecWait.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oreillyr</div><div class="date">11th January 2008, 15:53</div></div><div class="posttext">Could you expand a bit? Post a snippet perhaps? <br />
Cheers,<br />
Rob</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">11th January 2008, 17:12</div></div><div class="posttext">You don't need to use InstallDir unless you installer has to extract a custom installation beyond msi's.<br />
My suggestion is to use $PLUGINSDIR as I mentioned above.<br />
<br />
Also, you may want to search wiki to grab useful info.<br />
<br />
http://nsis.sourceforge.net/List_of_all_pages_in_NSIS_repository</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th January 2008, 17:18</div></div><div class="posttext">InitPluginsDir<br />
SetOutPath $PLUGINSDIR<br />
File setup.msi<br />
ExecWait `msiexec.exe /qn /i &quot;setup.msi&quot;` $R0<br />
${If} $R0 != 0<br />
  DetailPrint `Application installation failed: $R0`<br />
  Abort<br />
${EndIf}<br />
Pretty self explanatory. Look up the instructions if you need more information.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oreillyr</div><div class="date">14th January 2008, 11:13</div></div><div class="posttext">Self explanatory when you know how ;) Thanks for your help guys</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>