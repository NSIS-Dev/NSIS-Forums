<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Mb_yesno, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Mb_yesno NSIS Discussion" />
	
	<title> Mb_yesno [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Mb_yesno</div>
<hr />
<div class="pda"><a href="t-258886.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258886">Mb_yesno</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">4th November 2006, 13:50</div></div><div class="posttext">I'm having a small problem with a YESNO box. Sometimes it doesn't pop-up and goes directly to the IDNO value.<br />
<br />
FoundProgramEXE: ;Check and see if client is running<br />
  StrCpy $PROCEDURE &quot;FoundProgramEXE&quot;<br />
  Call DebugHeader<br />
  FindProcDLL::FindProc $PROGRAMEXECUTABLE<br />
  StrCmp $R0 &quot;1&quot; &quot;&quot; ProfileWork<br />
  ;=== client is already running, check if it is using<br />
  ;    the portable profile<br />
  MessageBox MB_YESNO|MB_ICONQUESTION|MB_TOPMOST `${APP} is \<br />
    already running. Close ${APP} and continue starting \<br />
    ${FULLNAME}?` IDNO UnloadTorpark IDYES KeepLoadingTorpark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th November 2006, 13:55</div></div><div class="posttext">Are you sure it doesn't just skip the message box because $R0 isn't 1? If so, attach a complete minimal example reproducing the problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">4th November 2006, 14:19</div></div><div class="posttext">This is the most minimal example. The problem is that the issue isn't consistent.<br />
<br />
And yes, I'm sure it isn't because $R0 isn't 1. I have a DebugHeader at the beginning of every procedure and my log is this:<br />
<br />
...<br />
FoundProgramEXE<br />
UnloadTorpark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th November 2006, 14:24</div></div><div class="posttext">It's minimal, but it's not complete. I can not compile it.<br />
<br />
DebugHeader is called before FindProcDLL::FindProc which can change $R0.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">4th November 2006, 15:28</div></div><div class="posttext">Function DebugHeader<br />
  StrCmp $DEBUGON 1 &quot;&quot; +2<br />
    MessageBox MB_OK|MB_ICONINFORMATION `Running $PROCEDURE`<br />
  StrCmp $DEBUGON 2 &quot;&quot; +4<br />
    ${time::GetLocalTime} $R7<br />
    FileWrite $6 &quot;$R7 $PROCEDURE$\n&quot;<br />
    ClearErrors<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">4th November 2006, 15:30</div></div><div class="posttext">Here is the full code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th November 2006, 15:59</div></div><div class="posttext">That's definitely not minimal. I can not compile it and it's pretty large. The idea behind &quot;complete minimal example reproducing the problem&quot; is that you give whoever is trying to help you a small script which he can compile. That script should show only the problem and contain nothing else. It saves both of us time. You might find out the answer on your own while searching for the cause and I, or whoever is helping you, will have less to work on so you can get a faster answer. In this case, a complete minimal example would have been:Name test<br />
OutFile test.exe<br />
Section<br />
MessageBox MB_TOPMOST test # this won't show<br />
SectionEndBack to the problem itself, it looks to me like you've run into an old bug (http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1400995&amp;group_id=22049&amp;atid=373085) which has been fixed for version 2.15. Which version are you using?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">4th November 2006, 16:31</div></div><div class="posttext">Sorry for the confusion. I am running NSIS 2.21.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th November 2006, 16:53</div></div><div class="posttext">So back to square one. I need an example. Does adding `SilentInstall silent` to the example I posted above reproduce the problem?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">4th November 2006, 17:12</div></div><div class="posttext">Like I said, the problem cannot be reproduced reliably, as sometimes the compiled executable behaves and sometimes it misbehaves. But the program by default includes SilentInstall silent. When I add &quot;silentinstall silent&quot; to the program, that does not reproduce the error.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th November 2006, 17:18</div></div><div class="posttext">In that case, I'm fresh out of ideas.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">torpark</div><div class="date">4th November 2006, 17:25</div></div><div class="posttext">Is there a cleaner syntax I could be using than:<br />
<br />
<br />
MessageBox MB_YESNO|MB_ICONQUESTION|MB_TOPMOST `${APP} is <br />
    already running. Close ${APP} and continue starting <br />
    ${FULLNAME}?` IDNO UnloadTorpark IDYES KeepLoadingTorpark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th November 2006, 17:27</div></div><div class="posttext">You can first copy the message to a variable, or use a constant for it to get a shorter and cleaner line.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>