<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" write in the middle of text file, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  write in the middle of text file NSIS Discussion" />
	
	<title> write in the middle of text file [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  write in the middle of text file</div>
<hr />
<div class="pda"><a href="t-267819.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267819">write in the middle of text file</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">andreinho</div><div class="date">15th March 2007, 09:30</div></div><div class="posttext">i would like to know how is possible to write in the middle of text file; for example i suppose to have a text file with 5 line<br />
<br />
row1<br />
row2<br />
row3<br />
row4<br />
row5<br />
<br />
i would like to have a output file as:<br />
<br />
row1<br />
row2<br />
rowx<br />
row3<br />
row4<br />
row5<br />
<br />
with a new line inserted in the middle, i would like to know if i have to use fileseek command and how use it. thanks so much for help. bye. Andre</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">15th March 2007, 10:01</div></div><div class="posttext">You can do it using Text Functions Header, there is an example in documentation tailored for your case.<br />
<br />
http://nsis.sourceforge.net/Docs/AppendixE.html#E.2</div></div><hr />


<div class="post"><div class="posttop"><div class="username">andreinho</div><div class="date">15th March 2007, 10:42</div></div><div class="posttext">i've however some problem beacuse i have to use a tmp file i suppose, have i cut the line below my line, copy it to another tmp file, insert my line and copy lines from tmp to my file? are there other ways? thanks so much, bye. Andre</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">15th March 2007, 10:58</div></div><div class="posttext">The example4 on LineFind does all the job.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">andreinho</div><div class="date">15th March 2007, 12:10</div></div><div class="posttext">i have the text below, i don't understand why don't work, i've prova.txt file with line of text and i would like to write something 2 lines up the last row but don't write, nothing, why? thanks so much<br />
<br />
!define PRODUCT_NAME &quot;a&quot;<br />
!define PRODUCT_VERSION &quot;1.0&quot;<br />
!define PRODUCT_PUBLISHER &quot;La mia compagnia, Inc.&quot;<br />
!define PRODUCT_WEB_SITE &quot;http://www.lamiacompagnia.com&quot;<br />
!define PRODUCT_DIR_REGKEY &quot;Software\Microsoft\Windows\CurrentVersion\App Paths\nsis-2.24-setup.exe&quot;<br />
!define PRODUCT_UNINST_KEY &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}&quot;<br />
!define PRODUCT_UNINST_ROOT_KEY &quot;HKLM&quot;<br />
<br />
!include &quot;MUI.nsh&quot;<br />
!include &quot;TextFunc.nsh&quot;<br />
<br />
<br />
!define MUI_ABORTWARNING<br />
!define MUI_ICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico&quot;<br />
!define MUI_UNICON &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico&quot;<br />
<br />
; Welcome page<br />
!insertmacro MUI_PAGE_WELCOME<br />
; License page<br />
!insertmacro MUI_PAGE_LICENSE &quot;lic.txt&quot;<br />
; Directory page<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
<br />
!insertmacro linefind<br />
<br />
; Instfiles page<br />
!insertmacro MUI_PAGE_INSTFILES<br />
<br />
; Finish page<br />
!define MUI_FINISHPAGE_RUN &quot;$INSTDIR\nsis-2.24-setup.exe&quot;<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
; Uninstaller pages<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
; Language files<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
; MUI end ------<br />
<br />
Name &quot;${PRODUCT_NAME} ${PRODUCT_VERSION}&quot;<br />
OutFile &quot;Setup.exe&quot;<br />
InstallDir &quot;$PROGRAMFILES\a&quot;<br />
InstallDirRegKey HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot;<br />
ShowInstDetails show<br />
ShowUnInstDetails show<br />
<br />
Section &quot;SezionePrincipale&quot; SEC01<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  SetOverwrite ifnewer<br />
  File &quot;nsis-2.24-setup.exe&quot;<br />
  CreateDirectory &quot;$SMPROGRAMS\a&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\a\a.lnk&quot; &quot;$INSTDIR\nsis-2.24-setup.exe&quot;<br />
  CreateShortCut &quot;$DESKTOP\a.lnk&quot; &quot;$INSTDIR\nsis-2.24-setup.exe&quot;<br />
  <br />
  <br />
  iffileexists &quot;$INSTDIR\prova.txt&quot; occhio<br />
  File &quot;prova.txt&quot;<br />
occhio:<br />
<br />
${LineFind} &quot;$INSTDIR\prova.txt&quot; &quot;&quot; &quot;-2&quot; &quot;Example4&quot;<br />
        IfErrors 0 +2<br />
	MessageBox MB_OK &quot;Error&quot;<br />
<br />
SectionEnd<br />
<br />
Section -AdditionalIcons<br />
  CreateShortCut &quot;$SMPROGRAMS\a\Uninstall.lnk&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
SectionEnd<br />
<br />
Section -Post<br />
  WriteUninstaller &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot; &quot;$INSTDIR\nsis-2.24-setup.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayName&quot; &quot;$(^Name)&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayIcon&quot; &quot;$INSTDIR\nsis-2.24-setup.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayVersion&quot; &quot;${PRODUCT_VERSION}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;URLInfoAbout&quot; &quot;${PRODUCT_WEB_SITE}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;Publisher&quot; &quot;${PRODUCT_PUBLISHER}&quot;<br />
SectionEnd<br />
<br />
Function Example4<br />
FileOpen $R4 &quot;$INSTDIR\prova.txt&quot; a<br />
FileWrite $R4 &quot;---First Line---$\r$\n&quot;<br />
FileClose $R4<br />
FunctionEnd<br />
<br />
Function un.onInit<br />
  MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 &quot;Sei sicuro di voler completamente rimuovere $(^Name) e tutti i suoi componenti?&quot; IDYES +2<br />
  Abort<br />
FunctionEnd<br />
<br />
Function un.onUninstSuccess<br />
  HideWindow<br />
  MessageBox MB_ICONINFORMATION|MB_OK &quot;$(^Name) Ã¨ stato completamente rimosso dal tuo computer.&quot;<br />
FunctionEnd<br />
<br />
Section Uninstall<br />
  Delete &quot;$INSTDIR\uninst.exe&quot;<br />
  Delete &quot;$INSTDIR\prova.txt&quot;<br />
  Delete &quot;$INSTDIR\nsis-2.24-setup.exe&quot;<br />
<br />
  Delete &quot;$SMPROGRAMS\a\Uninstall.lnk&quot;<br />
  Delete &quot;$DESKTOP\a.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\a\a.lnk&quot;<br />
<br />
  RMDir &quot;$SMPROGRAMS\a&quot;<br />
  RMDir &quot;$INSTDIR&quot;<br />
<br />
  DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot;<br />
  DeleteRegKey HKLM &quot;${PRODUCT_DIR_REGKEY}&quot;<br />
  SetAutoClose true<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">andreinho</div><div class="date">15th March 2007, 12:21</div></div><div class="posttext">ok, i've solved tha problem, work properly, seeing another example on forum, thanks so much however.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">15th March 2007, 12:28</div></div><div class="posttext">I think you're using the example incorrectly,<br />
Section<br />
	${LineFind} &quot;$INSTDIR\prova.txt&quot; &quot;&quot; &quot;-2&quot; Example4<br />
	IfErrors 0 +2<br />
	MessageBox MB_OK &quot;Error&quot;<br />
SectionEnd<br />
<br />
Function Example4<br />
	FileWrite $R4 &quot;---First Line---$\r$\n&quot;<br />
	FileWrite $R4 &quot;---Second Line ...---$\r$\n&quot;<br />
<br />
	Push $0<br />
FunctionEnd<br />
Also looking your code, (IfFileExists &quot;$INSTDIR\prova.txt&quot;), I think you're writing to the file in both cases, either exists or extract it, is this what you want?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">andreinho</div><div class="date">15th March 2007, 17:46</div></div><div class="posttext">yes red wine, i've understand your suggest, and also i've understood error for differentiate the 2 ways. thanks so much.bye. Andre</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>