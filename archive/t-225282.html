<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Cannot delete folder/file with non-EN character, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Cannot delete folder/file with non-EN character NSIS Discussion" />
	
	<title> Cannot delete folder/file with non-EN character [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Cannot delete folder/file with non-EN character</div>
<hr />
<div class="pda"><a href="t-225282.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=225282">Cannot delete folder/file with non-EN character</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Clam</div><div class="date">5th September 2005, 19:03</div></div><div class="posttext">In my uninstaller I want to remove the shortcuts created during install.<br />
<br />
The shortcuts reside in the Start Menu, and contain a Japanese colon &quot;***65306;&quot;<br />
<br />
The reason for this, is that my installer patches the original program, and then replaces the original programs uninstaller..<br />
<br />
Therefore needs to remove the original shortcut created with the original installer.<br />
<br />
The program group in the Start Menu also contains the Japanese colon &quot;***65306;&quot;.<br />
<br />
For example:<br />
$SMPROGRAMS\Program***65306;Folder\Program***65306;Shortcut.lnk<br />
<br />
I hope that makes some sense. For some reason &quot;Delete&quot; and &quot;RMDir&quot; will not remove files/folders with that character in it.<br />
<br />
Thank  you very much for your time in reading this problem : )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Clam</div><div class="date">5th September 2005, 20:43</div></div><div class="posttext">Here's some more info...<br />
<br />
It seems I can't create the icon folder if it doesn't already exist:<br />
Error creating shortcut: C:\Documents and Settings\Administrator\Start Menu\Programs\Program***65306;Group\Uninstall.lnk<br />
<br />
But when the original program creates the folder, I can insert my Uninstaller link in there...<br />
<br />
It seems NSIS doesn't like to write files/folders with non-EN characters??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Clam</div><div class="date">6th September 2005, 10:56</div></div><div class="posttext">I would hate to call a batch script just to delete/create these files :/<br />
<br />
How does NSIS handle other 'strange' characters in filenames?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">6th September 2005, 12:38</div></div><div class="posttext">The Japanese : does not have te same ASC value as the Regular :, use the ASC value instead of typing a &quot;:&quot; on the keboard.<br />
<br />
e.g. &quot;xyz&quot;#240&quot;andtherest&quot; where 240 is just an example. I do not know the exact value for the Japanese : sign.<br />
<br />
Success</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Clam</div><div class="date">6th September 2005, 13:40</div></div><div class="posttext">Originally posted by onad <br />
The Japanese : does not have te same ASC value as the Regular :, use the ASC value instead of typing a &quot;:&quot; on the keboard.<br />
<br />
e.g. &quot;xyz&quot;#240&quot;andtherest&quot; where 240 is just an example. I do not know the exact value for the Japanese : sign.<br />
<br />
Success  <br />
<br />
Are you saying to enter &quot;#65306&quot; into the script? do I need to escape it with anything? Like: $\#65306 or something?<br />
Or will just:<br />
Delete &quot;$SMPROGRAMS\Program#65306Group&quot;<br />
Work?<br />
<br />
I will try it, but somehow I don't think it'll work.<br />
<br />
When I insert &quot;:&quot; into my script, the Compiler processes it fine, because if you check the log file I attached, it's using the correct colon, but it can't do anything with it for some reason.<br />
<br />
Thanks for your advice, I'll play with it now, and hope for the best ;(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Clam</div><div class="date">6th September 2005, 13:48</div></div><div class="posttext">I tried using the #65306 but I don't think I used it correctly.<br />
<br />
Error creating shortcut: C:\Documents and Settings\Administrator\Start Menu\Programs\Program#65306Group\Uninstall.lnk<br />
<br />
  CreateShortCut &quot;$SMPROGRAMS\Program#65306Group\Uninstall.lnk&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
Normally it would be something like this:<br />
 CreateShortCut &quot;$SMPROGRAMS\Program***65306;Group\Uninstall.lnk&quot; &quot;$INSTDIR\uninst.exe&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">onad</div><div class="date">6th September 2005, 14:30</div></div><div class="posttext">You have to push the whole string into a variable first. Then use the variable.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Clam</div><div class="date">6th September 2005, 14:42</div></div><div class="posttext">Hmm, I'm not to sure how to go about that, (I'm a bit of a novice when it comes to push/pop)<br />
The only way I can confidantly add a string to a varible is with StrCpy :(<br />
<br />
Maybe if you could spare the time, a quick example could put me in the right direction?<br />
Thank you very much for the help thus far.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">6th September 2005, 15:10</div></div><div class="posttext">The only way I can confidantly add a string to a varible is with StrCpy<br />
it IS the only way, use it.<br />
<br />
well, ok, actually there's another way:<br />
Push &quot;something&quot;<br />
Pop $SOMETHING<br />
<br />
now $SOMETHING contains &quot;something&quot; (without &quot;&quot;)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>