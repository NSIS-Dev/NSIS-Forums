<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to extract a .rar file and copy it to a diff. folder??, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to extract a .rar file and copy it to a diff. folder?? NSIS Discussion" />
	
	<title> How to extract a .rar file and copy it to a diff. folder?? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to extract a .rar file and copy it to a diff. folder??</div>
<hr />
<div class="pda"><a href="t-230734.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=230734">How to extract a .rar file and copy it to a diff. folder??</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">cirerita</div><div class="date">11th November 2005, 19:26</div></div><div class="posttext">Hi,<br />
I made a search and found that the nsExec command apparently can be used to extract .rar files together with Unrar, or so I understood.<br />
<br />
I've been trying to use it in my installer to no avail. Mind you, I'm a 99% newbie, so that's normal, I guess.<br />
Here's the basic script:<br />
<br />
SetOutPath &quot;$INSTDIR&quot;<br />
  File &quot;..\MediaAutoGraph.rar&quot;<br />
  nsExec::unrar '&quot;$INSTDIR\MediaAutoGraph.rar&quot;'<br />
<br />
I've been switching the &quot; here and there, but I always get some sort of error.  I just want to extract the .rar file (it will create a folder with a lot of files) and then I want to copy the extracted folder to a different location and overwrite an existing one.<br />
<br />
any idea? thanks a lot...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th November 2005, 19:31</div></div><div class="posttext">nsExec can be used to run unrar.exe. It can't extract files from RAR archives on its own. Extract unrar.exe along with the RAR archive and use something like:nsExec::ExecToLog '&quot;C:\path\to\unrar.exe&quot; &quot;$INSTDIR\MediaAutoGraph.rar&quot;'unrar.exe might require some more information on the command line, so this example will probably not work as is.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cirerita</div><div class="date">11th November 2005, 19:37</div></div><div class="posttext">Is there any other way to extract files on the fly from a rar archive?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th November 2005, 19:43</div></div><div class="posttext">7-zip's command line utility might be able to extract RAR archives as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cirerita</div><div class="date">11th November 2005, 19:50</div></div><div class="posttext">Ok, I tried your command line and extracting also UnRAR.exe together with the rar archive. Obviously, UnRAR needs some extra parameters to extract the archive.<br />
<br />
This is what i get in the log window:<br />
<br />
Extract: UnRAR.exe... 100%<br />
Extract: MediaAutoGraph.rar... 100%<br />
<br />
UNRAR 3.51 freeware      Copyright (c) 1993-2005 Alexander Roshal<br />
<br />
Usage:     unrar &lt;command&gt; -&lt;switch 1&gt; -&lt;switch N&gt; &lt;archive&gt; &lt;files...&gt;<br />
               &lt;@listfiles...&gt; &lt;path_to_extract\&gt;<br />
<br />
&lt;Commands&gt;<br />
  e             Extract files to current directory<br />
  l[t,b]        List archive [technical, bare]<br />
  p             Print file to stdout<br />
  t             Test archive files<br />
  v[t,b]        Verbosely list archive [technical,bare]<br />
  x             Extract files with full path<br />
<br />
&lt;Switches&gt;<br />
  -             Stop switches scanning<br />
  ac            Clear Archive attribute after compression or extraction<br />
  ad            Append archive name to destination path<br />
  ap&lt;path&gt;      Set path inside archive<br />
  av-           Disable authenticity verification check<br />
  c-            Disable comments show<br />
  cfg-          Disable read configuration<br />
  cl            Convert names to lower case<br />
  cu            Convert names to upper case<br />
  dh            Open shared files<br />
  ep            Exclude paths from names<br />
  ep3           Expand paths to full including the drive letter<br />
  f             Freshen files<br />
  id[c,d,p,q]   Disable messages<br />
  ierr          Send all messages to stderr<br />
  inul          Disable all messages<br />
  ioff          Turn PC off after completing an operation<br />
  kb            Keep broken extracted files<br />
  n&lt;file&gt;       Include only specified file<br />
  n@            Read file names to include from stdin<br />
  n@&lt;list&gt;      Include files in specified list file<br />
  o+            Overwrite existing files<br />
  o-            Do not overwrite existing files<br />
  oc            Set NTFS Compressed attribute<br />
  ow            Save or restore file owner and group<br />
  p[password]   Set password<br />
  p-            Do not query password<br />
  r             Recurse subdirectories<br />
  ri&lt;P&gt;[:&lt;S&gt;]   Set priority (0-default,1-min..15-max) and sleep time in ms<br />
  ta&lt;date&gt;      Process files modified after &lt;date&gt; in YYYYMMDDHHMMSS format<br />
  tb&lt;date&gt;      Process files modified before &lt;date&gt; in YYYYMMDDHHMMSS format<br />
  tn&lt;time&gt;      Process files newer than &lt;time&gt;<br />
  to&lt;time&gt;      Process files older than &lt;time&gt;<br />
  ts&lt;m,c,a&gt;[N]  Save or restore file time (modification, creation, access)<br />
  u             Update files<br />
  v             List all volumes<br />
  ver[n]        File version control<br />
  vp            Pause before each volume<br />
  x&lt;file&gt;       Exclude specified file<br />
  x@            Read file names to exclude from stdin<br />
  x@&lt;list&gt;      Exclude files in specified list file<br />
  y             Assume Yes on all queries</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cirerita</div><div class="date">11th November 2005, 20:24</div></div><div class="posttext">I tried this, but no luck:<br />
<br />
  File &quot;..\UnRAR.exe&quot;<br />
  File &quot;..\MediaAutoGraph.rar&quot;<br />
  nsExec::ExecToLog '&quot;$INSTDIR\UnRAR.exe e&quot; &quot;MediaAutoGraph.rar&quot;'<br />
<br />
also tried using 7z:<br />
File &quot;..\7z.exe&quot;<br />
  File &quot;..\MediaAutoGraph.rar&quot;<br />
  nsExec::ExecToLog '&quot;$INSTDIR\7z.exe e&quot; &quot;MediaAutoGraph.rar&quot;'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th November 2005, 20:25</div></div><div class="posttext">Get the 'e' out of the quotes. The first quotes should surround just the path to the executable.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">11th November 2005, 20:26</div></div><div class="posttext">code:<br />
<br />
<br />
also tried using 7z:<br />
File &quot;..\7z.exe&quot;<br />
File &quot;..\MediaAutoGraph.rar&quot;<br />
nsExec::ExecToLog '&quot;$INSTDIR\7z.exe&quot; e MediaAutoGraph.rar'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cirerita</div><div class="date">11th November 2005, 20:40</div></div><div class="posttext">thanks guys, got it working:<br />
<br />
 nsExec::ExecToLog '&quot;$INSTDIR\7z.exe&quot; e MediaAutoGraph.rar -oc:\downloads\test&quot;'<br />
<br />
it copies the content of the rar archive to the downloads\test folder.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th November 2005, 09:25</div></div><div class="posttext">I think you've got one to many quotes there.<br />
 nsExec::ExecToLog '&quot;$INSTDIR\7z.exe&quot; e MediaAutoGraph.rar -o&quot;c:\downloads\test&quot;'<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cirerita</div><div class="date">12th November 2005, 09:35</div></div><div class="posttext">it'w weird, beucause it does work this way:<br />
nsExec::ExecToLog '&quot;$INSTDIR\7z.exe&quot; e MediaAutoGraph.rar -aoa -oc:\downloads\test&quot;'  [aoa command overwrites without asking first]<br />
<br />
i'll try your way now...<br />
<br />
well, well, well, it works both ways. <br />
nsExec::ExecToLog '&quot;$INSTDIR\7z.exe&quot; e MediaAutoGraph.rar -aoa -oc:\downloads\test&quot;'<br />
<br />
and <br />
<br />
nsExec::ExecToLog '&quot;$INSTDIR\7z.exe&quot; e MediaAutoGraph.rar -aoa -o&quot;c:\downloads\test&quot;'<br />
<br />
it seems that the right way should be the second one, but the first one also works. weird, huh?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AlexV</div><div class="date">24th November 2006, 16:22</div></div><div class="posttext">It's probably worth pointing out at this point that 7z.exe will only work if 7zip is installed. If you just ship 7z.exe and the target system has not got 7zip installed, it won't be able to extract anything.<br />
<br />
There is a standalone .exe provided by 7zip called 7za.exe, but unfortunately that does not extract from rar files. I'm trying to be able to extract rar's, zip's and 7z's in my installer, and the only solution I have found so far is to ship both 7za.exe and unrar.exe, for a whopping total of 686k.<br />
<br />
If anyone knows of a more lightweight solution with zip, 7z, and rar capability, I'd love to hear of it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vitoco</div><div class="date">24th November 2006, 17:08</div></div><div class="posttext">BTW, why to use NSIS to extract a temporary archive file like a RAR or ZIP (and it's uncompressor utility) and then extract final files from the archive?<br />
<br />
NSIS can drop final files just like an archiver. You only need to uncompress your files locally and add them (or the directory containing them) to your NSI script, then compile.<br />
<br />
File /r and it's other options are enougth. I can't think about a situation where a simple archiver is required as an intermediate step.<br />
<br />
At least for me, NSIS's solid lzma compress a lot more than WinRAR with the maximum compression option.<br />
<br />
++Vitoco</div></div><hr />


<div class="post"><div class="posttop"><div class="username">erundil</div><div class="date">22nd April 2011, 02:36</div></div><div class="posttext">BTW, why to use NSIS to extract a temporary archive file like a RAR or ZIP (and it's uncompressor utility) and then extract final files from the archive?<br />
<br />
We dont speak of something like this:<br />
File archive.rar<br />
Unpack archive.rar<br />
<br />
We speak about using installer to unpack an archive which already exists (on same CD maybe).<br />
What is more - NSIS have it's limitations - it's 2GB per file. If you want to distribute some more, u need to pack data into separate archives.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">22nd April 2011, 06:20</div></div><div class="posttext">Please don't reply to a discussion that's been closed for five(!) years.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>