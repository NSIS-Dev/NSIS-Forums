<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Custom screen and cancel button, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Custom screen and cancel button NSIS Discussion" />
	
	<title> Custom screen and cancel button [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Custom screen and cancel button</div>
<hr />
<div class="pda"><a href="t-182393.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=182393">Custom screen and cancel button</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">slimclity</div><div class="date">5th June 2004, 22:36</div></div><div class="posttext">Hi,<br />
<br />
I've created a custom screen with some input fields that are saved to an .ini file. That works great, but when I press the CANCEL button on this custom screen the values are written to the .ini file!<br />
<br />
<br />
Function SettingsPage<br />
<br />
   # Display the page.<br />
   !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;screen1.ini&quot;<br />
<br />
   !insertmacro MUI_INSTALLOPTIONS_READ $Username &quot;screen1.ini&quot; &quot;Field 1&quot; &quot;State&quot;<br />
<br />
   WriteINIStr &quot;$INSTDIR\settings.ini&quot; &quot;settings&quot; &quot;username&quot; &quot;$Username&quot;<br />
<br />
FunctionEnd<br />
<br />
Also, how is it possible to check if the fields are filled in? If not, show a message dialog that they must be filled in. And when a FileRequest/DirRequest is used, if the file/dir exists? (if they don't use the chooser)<br />
<br />
Thanks for the time/help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">5th June 2004, 23:25</div></div><div class="posttext">you can do this using MinLen/MaxLen or notify flags. check the docs (http://nsis.sourceforge.net/Contrib/InstallOptions/Readme.html) for details.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">slimclity</div><div class="date">6th June 2004, 10:00</div></div><div class="posttext">Originally posted by Yathosho <br />
you can do this using MinLen/MaxLen or notify flags. check the docs (http://nsis.sourceforge.net/Contrib/InstallOptions/Readme.html) for details. <br />
Great, thanks for the help.<br />
To see if the user press cancel in the custom screen I now use this:<br />
<br />
   !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;screen1.ini&quot;<br />
    Pop $R0 ;Get the return value<br />
       StrCmp $R0 &quot;success&quot; +3<br />
       Call SaveINI<br />
<br />
But for some strange reason the result is always &quot;success&quot;, even when I press cancel!?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">6th June 2004, 12:36</div></div><div class="posttext">From the MUI ReadMe:<br />
<br />
If you need the InstallOptions return value (success, back, cancel, error), use the MUI_INSTALLOPTIONS_DISPLAY_RETURN or MUI_INSTALLOPTIONS_SHOW_RETURN macro. The return value will be added to the stack, so you can use the Pop command to get it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">slimclity</div><div class="date">6th June 2004, 12:59</div></div><div class="posttext">Originally posted by pengyou <br />
From the MUI ReadMe:<br />
If you need the InstallOptions return value (success, back, cancel, error), use the MUI_INSTALLOPTIONS_DISPLAY_RETURN or MUI_INSTALLOPTIONS_SHOW_RETURN macro. The return value will be added to the stack, so you can use the Pop command to get it.  <br />
Thanks, I now have this: <br />
   # Display the page.<br />
   !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;screen1.ini&quot;<br />
   !insertmacro MUI_INSTALLOPTIONS_SHOW_RETURN<br />
       Pop $R0 ;Get the return value<br />
       MessageBox MB_OK &quot;$R0&quot;<br />
       Call Save<br />
But now all I get is: error... When I press cancel or next. Also tried to search for examples that use &quot;MUI_INSTALLOPTIONS_SHOW_RETURN&quot;, but didn't find them.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">6th June 2004, 15:29</div></div><div class="posttext">I suggest you read the MUI ReadMe again ;)<br />
<br />
If you want to get the return value, use<br />
<br />
MUI_INSTALLOPTIONS_DISPLAY_RETURN instead of MUI_INSTALLOPTIONS_DISPLAY<br />
or<br />
MUI_INSTALLOPTIONS_SHOW_RETURN instead of  MUI_INSTALLOPTIONS_SHOW<br />
<br />
Try # Display the page.<br />
!insertmacro MUI_INSTALLOPTIONS_DISPLAY_RETURN &quot;screen1.ini&quot;<br />
Pop $R0 ;Get the return value<br />
MessageBox MB_OK &quot;$R0&quot;<br />
Call SaveThe mathtest.nsi example uses MUI_INSTALLOPTIONS_DISPLAY_RETURN</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>