<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Plugin for my application, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Plugin for my application NSIS Discussion" />
	
	<title> Plugin for my application [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Plugin for my application</div>
<hr />
<div class="pda"><a href="t-181840.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181840">Plugin for my application</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Mosestycoon</div><div class="date">31st May 2004, 21:56</div></div><div class="posttext">Dear Community -<br />
<br />
I have a problem of creating a plugin for my main-application (MY-APP). In fact I don't know how to plug in. <br />
<br />
The idea I had was to make MY-APP write a registry key to HKLM SOFTWARE\MY-APP with the value InstallPath with (guess what) the installation path of MY-APP (e.g. C:\Program Files\My-App)<br />
<br />
So how can I use this value as new $INSTDIR for the plugin? <br />
<br />
Thx in advance <br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">1st June 2004, 13:03</div></div><div class="posttext">Use ReadRegStr and then set the folder using SetOutPath.<br />
<br />
If you prefer to use the $INSTDIR variable use StrCpy and SetOutPath.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mosestycoon</div><div class="date">1st June 2004, 19:35</div></div><div class="posttext">Thx for your reply, I already gave it (a successful) try, but allow me one more question Joost. I did it like this <br />
Function getInstallPath<br />
  ReadRegStr $R9 HKLM &quot;SOFTWARE\MY-APP&quot; &quot;InstallPath&quot; <br />
    StrCmp $R9 &quot;&quot; done<br />
  done:<br />
FunctionEnd <br />
<br />
Where do I have to paste a potential abortion if the main application isn't installed and is it possible to handle this &quot;globaly&quot;, or do I have to call this function everytime I need it (e.g. section, uninstaller, etc.)?<br />
<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mosestycoon</div><div class="date">1st June 2004, 21:17</div></div><div class="posttext">I try to write the abortion option mentioned above. Therefore I (tried to) analyize the waplugin example shipped with the NSIS package. I found the &quot;IfFileExists&quot; and now I want to know if there is something similar for registrykeys?<br />
<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">2nd June 2004, 03:35</div></div><div class="posttext">Yes. Everytime you call ReadRegStr it can return a value if it exists or set errors if it doesn't exist.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mosestycoon</div><div class="date">2nd June 2004, 09:05</div></div><div class="posttext">So can you please tell what I have to set and where I have to place it? <br />
<br />
Right now the installation would be already impossible if the core package is not installed. But you get an *cancel - retry - ignore* messagebox because the installpath is invalid (it tries to install to a  path starting with a '\' not C:\ or D:\).<br />
<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">2nd June 2004, 10:54</div></div><div class="posttext">Put it inside .onInstFailed callback function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mosestycoon</div><div class="date">2nd June 2004, 11:16</div></div><div class="posttext">Sorry deguix, this makes no sense to me (! and only me !), so please help me out:<br />
<br />
This callback is called when the user hits the 'cancel' button after the install has failed (if it could not extract a file, or the install script used the Abort command)<br />
<br />
Would this trigger the installer to stop automatically from installing (or even not to enable the install button like in the waplugin example) if the registry key is not found? <br />
<br />
Thx<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">2nd June 2004, 12:07</div></div><div class="posttext">Ahhhhh... The components page... I thought that was the installation part...<br />
<br />
Ok, put that inside the callback function .onVerifyInstDir.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mosestycoon</div><div class="date">2nd June 2004, 20:43</div></div><div class="posttext">Hm, I gave it a try, but without the desired result. Any other ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">2nd June 2004, 21:18</div></div><div class="posttext">Why not just check for the registry value in the .onInit function and quit the installer with an error message if it is not present?<br />
Slightly adapting the example from the NSIS documentation, you could use:<br />
<br />
<br />
 Function .onInit<br />
   ReadRegStr $INSTDIR HKLM &quot;SOFTWARE\MY-APP&quot; &quot;Path&quot;<br />
   StrCmp $INSTDIR &quot;&quot; 0 NoAbort<br />
     MessageBox MB_OK &quot;MY-APP not found. Unable to get install path.&quot;<br />
     Abort ; causes installer to quit.<br />
   NoAbort:<br />
 FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mosestycoon</div><div class="date">2nd June 2004, 22:21</div></div><div class="posttext">Thx Iceman_K<br />
That's it. It works.<br />
Your my man :D</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>