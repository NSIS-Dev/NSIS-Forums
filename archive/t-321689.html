<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" SelectFolderDialog without 'Create new folder'?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  SelectFolderDialog without 'Create new folder'? NSIS Discussion" />
	
	<title> SelectFolderDialog without 'Create new folder'? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  SelectFolderDialog without 'Create new folder'?</div>
<hr />
<div class="pda"><a href="t-321689.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=321689">SelectFolderDialog without 'Create new folder'?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Netsurfer24</div><div class="date">15th August 2010, 16:00</div></div><div class="posttext">Hi,<br />
<br />
I wonder if it is possible to have a nsDialogs::SelectFolderDialog without the 'create new folder' button? Or at least to disbale this button?<br />
<br />
I use this on a custom page where the user should be able to select as many existing folders as desired. Therefor creating a new folder is not wanted/ makes no sense in this case.<br />
<br />
If it could be done by the FindWindow and GetDlgItem method - does anybody know the correct parameters?<br />
<br />
Thanks,<br />
<br />
Gunther</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">15th August 2010, 21:34</div></div><div class="posttext">'fraid there's no such luck - once the dialog opens, code execution is locked.<br />
<br />
You can always create the folder browse dialog yourself, of course:<br />
<br />
!include &quot;nsDialogs.nsh&quot;<br />
!include &quot;LogicLib.nsh&quot;<br />
<br />
OutFile &quot;$%temp%\temp.exe&quot;<br />
<br />
<br />
; See also: http://msdn.microsoft.com/en-us/library/bb762115%28VS.85%29.aspx<br />
!define BIF_RETURNONLYFSDIRS 0x00000001<br />
Section<br />
	; Buffer to hold a display name output, not actively used.<br />
	System::Call '*(&amp;t260) i.r0'<br />
	; Struct to handle the select folder dialog.  You'd probably only care about the text at the top.<br />
    System::Call &quot;*(i$HWNDPARENT, i, ir0, t'Text at top', i${BIF_RETURNONLYFSDIRS}, i, i, i) i.r1&quot;<br />
    ; The actual call<br />
	System::Call &quot;shell32::SHBrowseForFolder(i r1) i.r2&quot;<br />
	<br />
	; Some logic checking on its output<br />
	${If} $2 == 0<br />
	    MessageBox MB_OK &quot;User canceled browsing.&quot;<br />
	${Else}<br />
	    ; Get the actual path from the pidl<br />
	    System::Call &quot;shell32::SHGetPathFromIDList(i r2, t.r3)&quot;<br />
	    ; and display<br />
		MessageBox MB_OK &quot;User selected folder: $3&quot;<br />
	${EndIf}<br />
	<br />
	; Clean up the structs<br />
	System::Free $0<br />
	System::Free $1<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Netsurfer24</div><div class="date">15th August 2010, 23:55</div></div><div class="posttext">Animaether,<br />
'fraid there's no such luck - once the dialog opens, code execution is locked.<br />
<br />
You can always create the folder browse dialog yourself, of course:<br />
Of course ...! :p<br />
But really - I'd prefer if this would be available by nsDialogs (maybe differenced by a parameter).<br />
<br />
<br />
!include &quot;nsDialogs.nsh&quot;<br />
!include &quot;LogicLib.nsh&quot;<br />
<br />
<br />
&lt;smartypants&gt;<br />
BTW: It is not necessary to include LogicLib when using nsDialogs as it already includes<br />
LogicLib as well as WinMessages. <br />
&lt;/smartypants&gt;<br />
<br />
Thanks for code example, but I have already added hundred of lines of code to my script just to make same small changes to the standard behaviour of NSIS :hang: - so in this case I leave it to the user ...!<br />
<br />
Thanks again for your really helpful answer,<br />
<br />
Gunther</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">16th August 2010, 00:33</div></div><div class="posttext">But really - I'd prefer if this would be available by nsDialogs (maybe differenced by a parameter).<br />
Sure - but that'll need a change to the plugin itself; you'd have to officially log it as a wish list item :)<br />
<br />
BTW: It is not necessary to include LogicLib when using nsDialogs as it already includes<br />
LogicLib as well as WinMessages.<br />
True - but whenever I use functionality from a library explicitly, I like including that library myself (near-ish the top of the file) so that anybody reviewing the code can see the dependency.  Say somebody else takes over my project and ditches nsDialogs for InstallOpensEx for whatever reason.  They remove the &quot;!include nsDialogs.nsh&quot; and *boink* goes the compiled as soon as it hits the ${If}-etc. bits :)<br />
<br />
<br />
Thanks for code example, but I have already added hundred of lines of code to my script just to make same small changes to the standard behaviour of NSIS<br />
Well, then what's 10 more? ;)<br />
<br />
Thanks again for your really helpful answer<br />
No problem - if nothing else, others who might have been wondering about this will be helped as well.. yay forums :)<br />
(presuming they search :x)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>