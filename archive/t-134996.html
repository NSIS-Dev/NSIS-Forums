<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Why is there an enabled cancel button in the finish page?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Why is there an enabled cancel button in the finish page? NSIS Discussion" />
	
	<title> Why is there an enabled cancel button in the finish page? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Why is there an enabled cancel button in the finish page?</div>
<hr />
<div class="pda"><a href="t-134996.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=134996">Why is there an enabled cancel button in the finish page?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">tupper</div><div class="date">11th May 2003, 02:10</div></div><div class="posttext">Why is there an enabled cancel button in the finish page?<br />
<br />
I'm using the modern UI. Any tips on how to disable the cancel button in the finish page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">11th May 2003, 02:33</div></div><div class="posttext">Good point.<br />
If the installation end *succesfully*,<br />
both cancel and finish are up.<br />
Why noy desable one of them?<br />
<br />
BTW: Welcome to the Forums tupper :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th May 2003, 11:24</div></div><div class="posttext">Try adding this into an install section (preferably a last one) It will grey out the cancel button.<br />
<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Settings&quot; &quot;CancelEnable&quot; &quot;0&quot;<br />
<br />
Optionally, you could completely remove the cancel button by doing this:<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Settings&quot; &quot;CancelShow&quot; &quot;0&quot;<br />
<br />
Let me know if it works.<br />
<br />
If it doesn't work, then try putting it in a custom finish page function like so:<br />
!insertmacro MUI_PAGECOMMAND_FINISH &quot;CustomFinish&quot;<br />
Function &quot;CustomFinish&quot;<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Settings&quot; &quot;CancelEnable&quot; &quot;0&quot;<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Settings&quot; &quot;CancelShow&quot; &quot;0&quot;<br />
FunctionEnd<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tupper</div><div class="date">11th May 2003, 15:24</div></div><div class="posttext">Stu, thanks for the suggestions. I tried the suggestions, with mixed results.<br />
<br />
The first approach (as follows) didn't affect the cancel button.<br />
<br />
<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Settings&quot; &quot;CancelEnable&quot; &quot;0&quot;<br />
<br />
The second approach (as follows) caused a compiler error [&quot;MUI_PAGECOMMAND_FINISH&quot; requires 0 parameter(s)]<br />
<br />
!insertmacro MUI_PAGECOMMAND_FINISH &quot;CustomFinish&quot;<br />
Function &quot;CustomFinish&quot;<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Settings&quot; &quot;CancelEnable&quot; &quot;0&quot;<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Settings&quot; &quot;CancelShow&quot; &quot;0&quot;<br />
FunctionEnd<br />
<br />
The &quot;optionally&quot; variant of the first approach (as follows) does work. So it seems that the installer enables / disables the buttons after the last section is completed.<br />
<br />
<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Settings&quot; &quot;CancelShow&quot; &quot;0&quot;<br />
<br />
It might be better to have the button visible but disabled (not sure...), but this will do fine! Thanks again!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tupper</div><div class="date">11th May 2003, 15:26</div></div><div class="posttext">Originally posted by Lobo Lunar <br />
BTW: Welcome to the Forums tupper :D  <br />
<br />
Thanks :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th May 2003, 17:01</div></div><div class="posttext">Sorry, I made a typo error.<br />
Use:<br />
<br />
!define MUI_CUSTOMFUNCTION_FINISH_SHOW &quot;CustomFinish&quot;<br />
Function &quot;CustomFinish&quot;<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Settings&quot; &quot;CancelEnable&quot; &quot;0&quot;<br />
FunctionEnd<br />
<br />
That should work fine.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th May 2003, 17:08</div></div><div class="posttext">There is a cancel button on the finish page so the user will be able to cancel seeing the readme and running your program without clicking too much.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th May 2003, 17:12</div></div><div class="posttext">Hmm, well I was going to test it, but the Cancel button on the Finish page is already disabled!<br />
Not sure why your's isn't?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tupper</div><div class="date">11th May 2003, 21:02</div></div><div class="posttext">Originally posted by Afrow UK <br />
Sorry, I made a typo error.<br />
Use:<br />
<br />
!define MUI_CUSTOMFUNCTION_FINISH_SHOW &quot;CustomFinish&quot;<br />
Function &quot;CustomFinish&quot;<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;Settings&quot; &quot;CancelEnable&quot; &quot;0&quot;<br />
FunctionEnd<br />
<br />
 <br />
<br />
This doesn't affect the cancel button with my installer. Even replacing &quot;CancelEnable&quot; with &quot;CancelShow&quot; makes no difference. But if I replace &quot;CancelEnable&quot; with &quot;CancelShow&quot; and MUI_CUSTOMFUNCTION_FINISH_SHOW with MUI_CUSTOMFUNCTION_FINISH_PRE, then the cancel button disappears. But your earlier suggestion (putting the code in the installation section) has the same effect and seems to be a bit simpler and more logical.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tupper</div><div class="date">11th May 2003, 21:13</div></div><div class="posttext">Originally posted by kichik <br />
There is a cancel button on the finish page so the user will be able to cancel seeing the readme and running your program without clicking too much.  <br />
<br />
Kichik, thanks for the explanation :-) I think I'll stick with hiding the button as pressing &quot;Cancel&quot; won't actually cancel (roll back) the installation.<br />
<br />
I guess another option for me would be to add some code to change the button text (to &quot;Stop&quot; or &quot;Abort&quot; or &quot;Close&quot; ... ?) but I think that might be confusing for users (perhaps not if the right word was found) --- and I don't know how to do that anyway :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tupper</div><div class="date">11th May 2003, 21:19</div></div><div class="posttext">Originally posted by Afrow UK <br />
Hmm, well I was going to test it, but the Cancel button on the Finish page is already disabled!<br />
Not sure why your's isn't?<br />
<br />
<br />
The button seems to be automatically disabled if you don't bring up checkboxes for running the program or for viewing the read me. This agrees with Kichik's comments (that the button allows users to avoid the horrible fate of running or looking at what they just installed ;-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tupper</div><div class="date">11th May 2003, 21:38</div></div><div class="posttext">Originally posted by kichik <br />
There is a cancel button on the finish page so the user will be able to cancel seeing the readme and running your program without clicking too much.  <br />
<br />
I've something more to add --- clicking on the close box seems to have the same effect as clicking on the cancel button. Any comments about not showing the warning / confirmation window if the installation has completed? This would allow a one-click escape. (Is this easily coded in my script?)<br />
<br />
Thanks again :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th May 2003, 22:32</div></div><div class="posttext">Hm, only thing I can suggest, is that you..<br />
<br />
1. In a !define MUI_CUSTOMFUNCTION_FINISH_SHOW function, copy say $9 as &quot;done&quot; (StrCpy $9 done)<br />
2. Make a copy of the Contrib\Modern UI\System.nsh file and paste it as a different copy. Scroll down until you get to !macro MUI_ABORTWARNING (use search)<br />
Replace this:<br />
<br />
!macro MUI_ABORTWARNING<br />
<br />
  !ifndef MUI_NOVERBOSE &amp; MUI_MANUALVERBOSE<br />
    !verbose 3<br />
  !endif<br />
<br />
  ;Warning when Cancel button is pressed<br />
<br />
  MessageBox MB_YESNO|MB_ICONEXCLAMATION &quot;$(MUI_TEXT_ABORTWARNING)&quot; IDYES quit<br />
    Abort<br />
    quit:<br />
<br />
  !ifndef MUI_NOVERBOSE &amp; MUI_MANUALVERBOSE<br />
    !verbose 4<br />
  !endif<br />
<br />
!macroend<br />
<br />
With this.<br />
<br />
!macro MUI_ABORTWARNING<br />
<br />
  !ifndef MUI_NOVERBOSE &amp; MUI_MANUALVERBOSE<br />
    !verbose 3<br />
  !endif<br />
<br />
  ;Warning when Cancel button is pressed<br />
<br />
StrCmp $9 done quit<br />
<br />
  MessageBox MB_YESNO|MB_ICONEXCLAMATION &quot;$(MUI_TEXT_ABORTWARNING)&quot; IDYES quit<br />
    Abort<br />
    quit:<br />
<br />
  !ifndef MUI_NOVERBOSE &amp; MUI_MANUALVERBOSE<br />
    !verbose 4<br />
  !endif<br />
<br />
!macroend<br />
<br />
<br />
Make sure you !include that special modified system.nsh file instead of using the original one. It think that this should be added to the orig system.nsh.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">izi</div><div class="date">19th January 2006, 08:24</div></div><div class="posttext">add <br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE OnShowFinish<br />
<br />
Function OnShowFinish<br />
   GetDlgItem $R0 $HWNDPARENT 2<br />
   SendMessage $R0 ${WM_CLOSE} 0 0<br />
FunctionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>