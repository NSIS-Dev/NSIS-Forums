<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" License / EULA text from external file?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  License / EULA text from external file? NSIS Discussion" />
	
	<title> License / EULA text from external file? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  License / EULA text from external file?</div>
<hr />
<div class="pda"><a href="t-251549.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=251549">License / EULA text from external file?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MatthewHarmon</div><div class="date">20th July 2006, 16:29</div></div><div class="posttext">Hi all...<br />
<br />
Is there a way to have the license/EULA text be taken from the root of my distribution CD instead of baked right into the installer?<br />
<br />
I'm using the modern UI, but can modify the macros if need be.<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">20th July 2006, 16:40</div></div><div class="posttext">And why not use, in compilation time, that license file?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MatthewHarmon</div><div class="date">20th July 2006, 16:47</div></div><div class="posttext">Because my publisher won't let me!  They want to be able to make changes to the license without needing to make a new installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">20th July 2006, 16:50</div></div><div class="posttext">http://forums.winamp.com/showthread.php?s=&amp;threadid=231547</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th July 2006, 17:02</div></div><div class="posttext">You can use either one of these:<br />
<br />
http://nsis.sourceforge.net/External_License_file<br />
http://nsis.sourceforge.net/ExLicensePage_plug-in<br />
http://nsis.sourceforge.net/NonObligatoricPages<br />
http://nsis.sourceforge.net/ExDlg_plug-in<br />
http://nsis.sourceforge.net/CustomLicense_plug-in</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MatthewHarmon</div><div class="date">20th July 2006, 17:13</div></div><div class="posttext">Thanks... I found that first method and it seems to work for me.  Also seems to be the &quot;safest&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">20th July 2006, 19:06</div></div><div class="posttext">Now I see that code may be shorter and msvcrt free :)<br />
!define FILE_SHARE_READ 1<br />
!define GENERIC_READ 0x80000000<br />
!define OPEN_EXISTING 3<br />
!define FILE_BEGIN 0<br />
!define FILE_END 2<br />
<br />
Function addLicense<br />
<br />
   System::Call 'kernel32::CreateFile(t &quot;$EXEDIR\${LIC_NAME}&quot;, i ${GENERIC_READ}, i ${FILE_SHARE_READ}, i 0, i ${OPEN_EXISTING}, i 0, i 0) i .r0'<br />
   IfErrors exit<br />
   System::Call 'kernel32::SetFilePointer(i r0, i 0, i 0, i ${FILE_END}) i .r1'<br />
   IntOp $1 $1 + 1 ; for terminating zero<br />
   System::Call 'kernel32::SetFilePointer(i r0, i 0, i 0, i ${FILE_BEGIN})'<br />
   System::Alloc $1<br />
   Pop $2<br />
   System::Call 'kernel32::ReadFile(i r0, i r2, i r1, *i .r3, i 0)'<br />
   System::Call 'kernel32::CloseHandle(i r0)'<br />
   FindWindow $0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
   GetDlgItem $0 $0 1000<br />
   SendMessage $0 ${WM_SETTEXT} $0 $2<br />
   System::Free $2<br />
exit:<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MatthewHarmon</div><div class="date">21st July 2006, 16:42</div></div><div class="posttext">So, I assume calling the 'kernel32::' routines are &quot;safer&quot; than calling out to the .dll.  That is, calling 'kernel32' routines are guaranteed to work?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">21st July 2006, 17:09</div></div><div class="posttext">No. 'system' plug-in adds .dll for module to load if extension was ommited, and this is not safety question. kernel32.dll calls should work on all systems beginnig Win95. msvcrt.dll appeared in Win95 second edition (?) or with any service pack (or any IE installed), but 100% waranty of msvcrt is beginning Win98 only.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbguy</div><div class="date">24th July 2006, 03:44</div></div><div class="posttext">Takhir, for some reason your code bails out early (it jumps to the exit) which means there is an error when loading the text file. But when I remove the IfErrors line, the file loads fine.<br />
<br />
Is there some way to see what error the kernel is throwing? Just for safety reasons if nothing else.<br />
<br />
Thanks,<br />
<br />
VBGuy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">24th July 2006, 07:07</div></div><div class="posttext">Looks like error flag was set before function call, just add ClearErrors (Manual 4.9.4.3) as a first function line.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>