<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" nsExec::Exec Problem on Uninstall, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  nsExec::Exec Problem on Uninstall NSIS Discussion" />
	
	<title> nsExec::Exec Problem on Uninstall [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  nsExec::Exec Problem on Uninstall</div>
<hr />
<div class="pda"><a href="t-130644.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=130644">nsExec::Exec Problem on Uninstall</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dabossuk</div><div class="date">2nd April 2003, 12:52</div></div><div class="posttext">Hi<br />
<br />
In my main section I call <br />
<br />
      nsExec::Exec &quot;cmd /c $INSTDIR\regasm.exe /codebase /tlb<br />
mbloxsdk.dll&quot;<br />
      nsExec::Exec &quot;cmd /c $INSTDIR\regsvr32.exe /u mbloxwrappers.dll&quot;<br />
<br />
The above works fine ... and registers my components.  Note that I do NOT pass in $INSTDIR - if I do it does not work.  The files are in the root of the installer.<br />
<br />
I am then calling the following section on uninstall :<br />
<br />
Section &quot;Uninstall&quot;<br />
<br />
 ;Unregister my components<br />
<br />
 Banner::show /NOUNLOAD &quot;un-Registering .NET and COM Components ....&quot;<br />
  <br />
      nsExec::Exec &quot;cmd /c $INSTDIR\regasm.exe /unregister $INSTDIR\mbloxsdk.dll&quot;<br />
      nsExec::Exec &quot;cmd /c $INSTDIR\regsvr32.exe /u $INSTDIR\mbloxwrappers.dll&quot;<br />
<br />
      Sleep 3000<br />
  <br />
 Banner::destroy  <br />
<br />
******<br />
<br />
However when I uninstall I have to call with a $INSTDIR otherwise exec comes up with an error saying it cannot find the files.  If I put in $INSTDIR it does not create an error - but also does not unregister my components - I can check in the registery and they are still there.  If I do the same commands from a dos prompt manually it works fine ...<br />
<br />
Any ideas ?? Thanks<br />
<br />
Dabossuk</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">2nd April 2003, 12:57</div></div><div class="posttext">To register your dll, you should use RegDLL.<br />
<br />
Why do you call CMD? It will only work on Windows NT and will cause a lot of extra problems. Calling regsvr32.exe directly is possible, but that won't work on the first Windows 95 version.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dabossuk</div><div class="date">2nd April 2003, 13:10</div></div><div class="posttext">Hi<br />
<br />
I could use Reg and Unreg for the COM DLL - but that does not solve the problem of the .NET component where I have to use Regasm.exe - which is the same as regsvr32 but for .NET components (I assume that reg and unreg does not support regasm.exe?)<br />
<br />
Dabossuk</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dabossuk</div><div class="date">2nd April 2003, 13:11</div></div><div class="posttext">just read again what you posted ... could I just call regasm.exe instead of CMD in nsExec::Exec ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">2nd April 2003, 13:18</div></div><div class="posttext">Yep, you don't have to call CMD (the Windows NT command line), just call regasm.exe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd April 2003, 15:04</div></div><div class="posttext">And don't forget to quote incase $INSTDIR contains spaces.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dabossuk</div><div class="date">2nd April 2003, 20:49</div></div><div class="posttext">Yeh the quotes were the problem ...<br />
<br />
all working now ;-)<br />
<br />
Thanks<br />
<br />
Dabossuk</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>