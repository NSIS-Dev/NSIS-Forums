<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS: detect WIN32-WIN64, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS: detect WIN32-WIN64 NSIS Discussion" />
	
	<title> NSIS: detect WIN32-WIN64 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS: detect WIN32-WIN64</div>
<hr />
<div class="pda"><a href="t-255415.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=255415">NSIS: detect WIN32-WIN64</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mturk</div><div class="date">13th September 2006, 13:13</div></div><div class="posttext">Hi,<br />
<br />
We would like to extend the nsis installer for the Tomcat<br />
(http://tomcat.apache.org) with the automatic detection<br />
of the underlaying OS/CPU.<br />
<br />
For now, we are using it only for WIN32/x86, but would<br />
like to extend it to WIN64/amd64 and later WIN64/ia64.<br />
<br />
The problem is that we have WIN32/x86 native files<br />
named tomcat6.exe and tomcat6w.exe. Beyond those we<br />
have tomcat6.exe.amd64 and tomcat6w.exe.amd64 that would<br />
need to be installed as tomcat6.exe/tomcat6w.exe if the<br />
underlaying OS is WIN64/amd64.<br />
<br />
The installer itself (apache-tomcat-x.x.x.exe) should<br />
run on all platforms, so it should be 32 bit, with<br />
platform specific files.<br />
<br />
For the platform specific files we have to scenarios:<br />
1. Integrated within installer<br />
2. Downloadable by the installer.<br />
<br />
In general, all that we would need is a simple variable<br />
that would give OS and other the CPU.<br />
<br />
BTW, the .nsi for Apache Tomcat is at:<br />
http://svn.apache.org/viewvc/tomcat/tc6.0.x/trunk/res/tomcat.nsi?view=markup<br />
<br />
Anyone knows how to do that?<br />
I read lots of posts about WIN32/WIN64, but there are no<br />
'real howto'<br />
<br />
Regards,<br />
Mladen.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th September 2006, 13:27</div></div><div class="posttext">Did you try the GetVersion plugin?<br />
http://nsis.sourceforge.net/GetVersion_%28Windows%29_plug-in<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mturk</div><div class="date">13th September 2006, 13:40</div></div><div class="posttext">Nope.<br />
Will it allow to distinguish the WIN32/x86, WIN64/amd64?<br />
Further more, the feature has to be the part of the 'core'<br />
distribution.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">noisehole</div><div class="date">13th September 2006, 13:52</div></div><div class="posttext">since the nsis stub is always 32bit, im using this code:<br />
<br />
System::Call &quot;kernel32::GetCurrentProcess() i .s&quot;<br />
System::Call &quot;kernel32::IsWow64Process(i s, *i .r0)&quot;<br />
StrCmp $0 &quot;0&quot; is32bit is64bit<br />
<br />
<br />
beware of the fs and registry redirection for wow64 processes (eg api Wow64DisableWow64FsRedirection)<br />
<br />
regards</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>