<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" A small flaw in script.c (patch included), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  A small flaw in script.c (patch included) NSIS Discussion" />
	
	<title> A small flaw in script.c (patch included) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  A small flaw in script.c (patch included)</div>
<hr />
<div class="pda"><a href="t-66238.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=66238">A small flaw in script.c (patch included)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">felfert</div><div class="date">21st November 2001, 01:13</div></div><div class="posttext">Hi,<br />
<br />
I currently use two different versions of NSIS. The original and a slightly hacked version with support for some additional commands. In my installer-scripts, i tried to use !ifdef/!endif to make them compile with both versions. Unfortunately this does not work with original NSIS (1.67). Even if !ifdef-ing out some portion of the script, it still checks for known commands and amount of arguments for known commands and then terminates compilation. The attached patch fixes this (IMHO unnecesary) behavior. With that patch applied,<br />
you now can write arbitrary text (like comments) within these disabled areas, just like in C.<br />
<br />
Justin, can you please apply this in your next release?<br />
<br />
-Fritz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">justin</div><div class="date">21st November 2001, 02:24</div></div><div class="posttext">I actually found a simpler way of doing this. Simply insert the following two lines into the very beginning of CEXEBuild::parseLine():<br />
<br />
<br />
  while (*str == ' ' || *str == '\t') str++;<br />
  if (ignore &amp;&amp; *str!='!') return PS_OK;<br />
<br />
<br />
I will include this as part of 1.70. The major change in 1.70 from 1.67 is better support for MBCS. I've updated most of NSIS's internal string handling, all that is left is dialog code page etc updates (I think).<br />
<br />
After thanksgiving, at least...<br />
<br />
-Justin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">felfert</div><div class="date">21st November 2001, 03:56</div></div><div class="posttext">Originally posted by justin <br />
I actually found a simpler way of doing this. Simply insert the following two lines into the very beginning of CEXEBuild::parseLine():<br />
<br />
<br />
  while (*str == ' ' || *str == '\t') str++;<br />
  if (ignore &amp;&amp; *str!='!') return PS_OK;<br />
<br />
...<br />
-Justin <br />
<br />
No, that doesn't catch the following (WHATEVER undefined):<br />
<br />
<br />
!ifndef WHATEVER<br />
+-----------------+<br />
! My fancy header !<br />
+-----------------!<br />
!endif<br />
<br />
<br />
At least, it should check for the complete two possible keywords !endif and !else and probably also for a following whitespace.<br />
<br />
-Fritz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">felfert</div><div class="date">21st November 2001, 03:59</div></div><div class="posttext">Originally posted by felfert ...<br />
<br />
Ooops! 1,$s/undef/def/g<br />
<br />
-Fritz</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>