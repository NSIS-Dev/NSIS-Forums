<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" CreateShortcut to run as administrator, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  CreateShortcut to run as administrator NSIS Discussion" />
	
	<title> CreateShortcut to run as administrator [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  CreateShortcut to run as administrator</div>
<hr />
<div class="pda"><a href="t-319628.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=319628">CreateShortcut to run as administrator</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">akatik</div><div class="date">2nd June 2010, 19:35</div></div><div class="posttext">Good day.<br />
I need to create shortcut with advanced property &quot;Run as administrator&quot; set. Help needed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">3rd June 2010, 05:55</div></div><div class="posttext">Good day.<br />
I need to create shortcut with advanced property &quot;Run as administrator&quot; set. Help needed.<br />
<br />
I don't know if this is possible in a shortcut, but I think you could add a manifest to the exe with admin as requested execution level.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">3rd June 2010, 07:24</div></div><div class="posttext">Well, it is possible, but a pain to write in a script.<br />
Maybe a plugin is easier:<br />
http://social.msdn.microsoft.com/Forums/en-US/windowssecurity/thread/a55aa70e-ae4d-4bf6-b179-2e3df3668989</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">3rd June 2010, 07:42</div></div><div class="posttext">You can also try to add a REG_SZ key named &lt;Full_Path _To_My_Application.exe&gt; with a value of &quot;RUNASADMIN&quot; to the registry at HKCU\SOFTWARE\Microsoft\Windows_NT\CurrentVersion\AppCompatFlags\Layers.<br />
(Source: http://www.techtalkz.com/windows-deployment/193291-howto-force-run-adminstrator-vista-all-users.html)<br />
I don't have Vista, so I can't test this for you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd June 2010, 12:01</div></div><div class="posttext">One could update this plug-in (it would probably have to be me though):<br />
http://nsis.sourceforge.net/ShellLink_plug-in<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">3rd June 2010, 16:51</div></div><div class="posttext">People keep asking this over and over, but it seems to me that you probably have other problems if you need this property set on your shortcuts (What if the user runs the app directly?) Anyways, here is some code: http://nsis.sourceforge.net/IShellLink_Set_RunAs_flag</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd June 2010, 19:09</div></div><div class="posttext">I've updated the ShellLink plug-in but currently the Wiki is down.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">akatik</div><div class="date">4th June 2010, 15:54</div></div><div class="posttext">MSG Elevating application is not the decision I need. Simple users should have the ability to run it.<br />
Anders, I understand, that writing programs that require administrative rights is not good. But my program is meant for system administrators. There will be two shortcuts - for simple users with restricted possibilities - and for admins, full functioning. <br />
Thank you, Afrow UK, it works fine.<br />
Thanks for you all a lot. There are several topics on this issue on the forum. But only here is the helpful solution.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mikesch</div><div class="date">4th October 2010, 13:35</div></div><div class="posttext">Hello Afrow UK!<br />
<br />
Many thanks for your great solution. This works fine for my application.<br />
<br />
Because of the many threads about this problem perhaps it could become part of the next NSIS setup.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">akatik</div><div class="date">11th February 2011, 11:50</div></div><div class="posttext">I have a problem - I set flag &quot;Run as Administrator&quot; using this code: http://nsis.sourceforge.net/IShellLink_Set_RunAs_flag<br />
If my shortcut is placed in All users Start menu, then it works great.<br />
But in Start menu of current user - no flag is set.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th February 2011, 15:13</div></div><div class="posttext">Is the path correct? (SetShellVarContext).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">akatik</div><div class="date">11th February 2011, 15:25</div></div><div class="posttext">Yes, path is correct. The code is:<br />
<br />
		CreateShortcut &quot;$SMPROGRAMS\wtc\${wtcTxt}-Administrator.lnk&quot; &quot;$INSTDIR\Bin\win32.exe&quot;<br />
		push &quot;$SMPROGRAMS\wtc\${wtcTxt}-Administrator.lnk&quot;<br />
		call ShellLinkSetRunAs<br />
		pop $0<br />
<br />
As far as I understood this function returned not 0:<br />
		System::Call &quot;$2-&gt;5(w '$9',i 0)i.r0&quot; ;Load</div></div><hr />


<div class="post"><div class="posttop"><div class="username">akatik</div><div class="date">11th February 2011, 16:14</div></div><div class="posttext">Afrow UK, you were right. <br />
&quot;Windows Vista and Windows 7 automatically identifies installer executables, including NSIS installers, and asks the user permission to run them with elevated privileges. Automatic detection, however, comes with the price of automatic backward compatibility tricks. One of which is automatic relocation of shortcuts created in the Start Menu to All Users' Start Menu.&quot;<br />
<br />
I hate Microsoft :( It placeв my shortcut to All users start menu and even didn't say &quot;Meow&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">akatik</div><div class="date">11th February 2011, 16:15</div></div><div class="posttext">Afrow UK, you were right. <br />
&quot;Windows Vista and Windows 7 automatically identifies installer executables, including NSIS installers, and asks the user permission to run them with elevated privileges. Automatic detection, however, comes with the price of automatic backward compatibility tricks. One of which is automatic relocation of shortcuts created in the Start Menu to All Users' Start Menu.&quot;<br />
<br />
I hate Microsoft :( It placeв my shortcut to All users start menu and even didn't say &quot;Meow&quot;.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>