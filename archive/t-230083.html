<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" nsExec on Win2003?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  nsExec on Win2003? NSIS Discussion" />
	
	<title> nsExec on Win2003? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  nsExec on Win2003?</div>
<hr />
<div class="pda"><a href="t-230083.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=230083">nsExec on Win2003?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">colm</div><div class="date">4th November 2005, 10:24</div></div><div class="posttext">Has anyone tried using nsExec on Windows 2003? Last few times I tried it it didn't work at all. It seems to work fine on XP though.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th November 2005, 10:29</div></div><div class="posttext">Looks like this guy (http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1345772&amp;group_id=22049&amp;atid=373085) had problems as well. The same questions go to you as well. Have you verified it's a problem with nsExec and not of the program you're trying to run? Have you tried running any other programs? Can add more details about what exactly you're running?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">colm</div><div class="date">4th November 2005, 11:13</div></div><div class="posttext">Um, that guy was me :)<br />
<br />
I figured it was a problem with nsExec because when I tried the nsExec example installed with NSIS it failed too. I didn't write that :)<br />
<br />
I'm running ExecDos now instead and that seems to work okay.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th November 2005, 12:05</div></div><div class="posttext">DosExec has no support for 16-bit console applications. That might be the problem with nsExec. It was added because of this thread (http://forums.winamp.com/showthread.php?s=&amp;threadid=142028&amp;highlight=nsexec+bug).<br />
<br />
I've attached three versions of nsExec with three different changes to that piece of code. Let me know if any of those work for you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thelliez</div><div class="date">15th November 2005, 20:45</div></div><div class="posttext">I need to call cscript and I have been struggling to find a consistent way to do it under Windows 2003.<br />
<br />
Somehow nsExec does not always find cscript, even if I use the full path. At least it is not consistent across two different Windows Server 2003 installations.<br />
<br />
Right now I have this running on one server:<br />
nsExec::ExecToStack  '&quot;$SYSDIR\cscript.exe&quot; //nologo &quot;$INSTDIR\admin\utility.vbs&quot; doSomething'<br />
While on the other server I had this running:<br />
nsExec::ExecToStack  '&quot;$COMPSEC&quot; /C &quot;cscript&quot; //nologo &quot;$INSTDIR\admin\utility.vbs&quot; doSomething'<br />
        <br />
On both server cscript is at the same place and in the path.<br />
<br />
(I tried the three different recent versions of NsExec without luck).<br />
<br />
Suggestions?<br />
Thanks,<br />
Thierry</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd November 2005, 19:37</div></div><div class="posttext">I have tested the nsExec example multiple times on Windows Server 2003 Enterprise SP1 and it always worked. Can you spare some more details? Do you have an anti-virus? Did you try turning it off?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">23rd November 2005, 07:47</div></div><div class="posttext">To kichik: ExecDos works correct with grep.exe if it was called from batch file:<br />
ExecDos::exec &quot;$EXEDIR\nsi.bat&quot; &quot;&quot; &quot;$EXEDIR\${APP_NAME}.log&quot;<br />
Pop $0 ; bat exit code<br />
Batch file content<br />
@echo off<br />
grep.exe ExecDos Readme.txt<br />
cls<br />
DOS window not appears, log file receives output. Texted on XP, but I hope batch execution to be the same on other systems.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th November 2005, 13:04</div></div><div class="posttext">Of course, I meant automatic support. nsExec creates a 32-bit console wrapper automatically.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">colm</div><div class="date">14th April 2006, 16:42</div></div><div class="posttext">I solved the problem by using ExecDos. I then tried replacing ExecDos with nsExec some months later in order to log the output properly (on a different machine). It worked fine the second time but not at all the first time. I'm not sure why, but it was something to do with calling cscript.exe.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>