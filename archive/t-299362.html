<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS close application before uninstall, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS close application before uninstall NSIS Discussion" />
	
	<title> NSIS close application before uninstall [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS close application before uninstall</div>
<hr />
<div class="pda"><a href="t-299362.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=299362">NSIS close application before uninstall</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jams08</div><div class="date">30th October 2008, 18:41</div></div><div class="posttext">Hi,<br />
In my case, i'm trying to find and close the running application and then uninstall the existing application and finally install. <br />
<br />
I'm using Findwindow and SendMessage $1 ${WM_CLOSE} 0 0 to close my application. But my application in turn pops up a confirmation dialog (with yes / no option). My application will be closed only if you select option yes in the dialog box. Could some one tell me how to find the dialog box from running application and select yes/no option in that dialog (so that my application will be closed) ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">1st November 2008, 00:12</div></div><div class="posttext">I used AutoIt scripts for finding dialogs and sending button clicks.  You can search for dialogs based on titles as well as message texts.  After getting my AutoIt script to work, I compile the script to an exe.  I then include that exe in my installer and extract it to a temp directory to run it.  The AutoIt functions have timeouts, so that it will automatically close if it doesn't find the dialog.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deepcut</div><div class="date">2nd November 2008, 14:28</div></div><div class="posttext">I don't know whether AaronLS's suggestion of AutoIt includes a macro recorder, but a similar system I use called AutoHotkey does. Which makes recording your couple of clicks and compiling the script to an exe very easy.<br />
Not a very elegant solution though.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>