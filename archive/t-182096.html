<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" ExecShell doesn't work in all computers, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  ExecShell doesn't work in all computers NSIS Discussion" />
	
	<title> ExecShell doesn't work in all computers [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  ExecShell doesn't work in all computers</div>
<hr />
<div class="pda"><a href="t-182096.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=182096">ExecShell doesn't work in all computers</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mabrev</div><div class="date">3rd June 2004, 07:19</div></div><div class="posttext">Hi! I'm newbie with NSIS and my problem is that my instalation file works fine in my computer, but it doesn't work in another computers. The problem is in the ExecShell instruction, I try to execute a batch file that is ignored in other computers. Could anybody help me?<br />
<br />
I've tried nsExec::Exec but this instrcution is ignored in my computer too.<br />
<br />
Thanks in advance and excuse my poor english.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Davion</div><div class="date">3rd June 2004, 07:45</div></div><div class="posttext">I don't know for what you use the batch file, but maybe<br />
Exec or ExecWait could do the job</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mabrev</div><div class="date">3rd June 2004, 08:12</div></div><div class="posttext">No, I can't use Exec or ExecWait. I'm using the batch file for running this command: &quot;mysql-opt -standalone&quot;, if I use Exec it appears a black screen that I want to eliminate using ExecShell.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Davion</div><div class="date">3rd June 2004, 08:16</div></div><div class="posttext">is the Batch file not executet or does it only not work correctly on the other systems...maybe on other sys your command can't be understand properly</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mabrev</div><div class="date">3rd June 2004, 08:20</div></div><div class="posttext">If I use the same batch file with Exec sentence, the batch works in all computers but a black screen is shown, so the problem isn't the batch file or the command, it must be the ExecShell.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">3rd June 2004, 13:18</div></div><div class="posttext">Two links from 2-nd forum page :)<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=179975<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=181442<br />
<br />
Try SW_HIDE first</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">3rd June 2004, 15:23</div></div><div class="posttext">Why not use nsExec?<br />
<br />
nsExec<br />
------<br />
nsExec will execute command-line based programs and capture the output<br />
without opening a dos box.<br />
<br />
<br />
Usage<br />
-----<br />
nsExec::Exec [/TIMEOUT=x] path<br />
<br />
-or-<br />
<br />
nsExec::ExecToLog [/TIMEOUT=x] path<br />
<br />
-or-<br />
<br />
nsExec::ExecToStack [/TIMEOUT=x] path<br />
<br />
<br />
See the documentation, it's all in there.....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mabrev</div><div class="date">3rd June 2004, 15:47</div></div><div class="posttext">Originally posted by zimsms <br />
[B]Why not use nsExec?<br />
 <br />
<br />
I've tried this also, but it doesn't work. I don't know why, but it doesn't do anything. I've seen the documentation, but I don't know if I have to add some code for using it or what it's wrong.<br />
<br />
My code is:<br />
<br />
		SetOutPath $4\mysql\bin<br />
		File &quot;mysql.bat&quot;<br />
;		Exec 'mysql.bat' ;-- Se arranca el servidor Mysql<br />
		ExecShell &quot;open&quot; /S '$4\mysql\bin\mysql.bat' ;-- Se arranca el servidor Mysql<br />
;		nsExec::Exec &quot;mysql.bat&quot;<br />
<br />
<br />
nsExec doesn't work in any computer, exec works in all and execShell only in my computer.<br />
<br />
Somebody could tell me if there is something wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">3rd June 2004, 15:52</div></div><div class="posttext">oh, nsExec works, but since NSIS is a win32 application no matter what you get the prompt back instantly. If you check your process viewer, you will notice your batch file is running. <br />
<br />
I had a similar issue, and had to write a C function that waits for the process to end before returning to the user. I also requested that this functionality be added to nsExec, as nsExec::ExecWait. But have not seen it appear in CVS as of yet.<br />
<br />
You can read the thread here (http://forums.winamp.com/showthread.php?s=&amp;threadid=180398).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mabrev</div><div class="date">3rd June 2004, 16:13</div></div><div class="posttext">Well, I've checked my process viewer and my problem is opposite to yours, my instalation file is stopped waitting batch file ending. I want to nsExec doesn't wait, how can I do that??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">3rd June 2004, 16:20</div></div><div class="posttext">nsExec::Exec &quot;$4\mysql\bin\mysql.bat&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">3rd June 2004, 16:35</div></div><div class="posttext">What about this? <br />
<br />
System::Call 'kernel32.dll::WinExec(t &quot;mysql.bat&quot;, i 0) i.r0'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">3rd June 2004, 16:48</div></div><div class="posttext">Is the file associated set correctly?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mabrev</div><div class="date">3rd June 2004, 16:58</div></div><div class="posttext">Originally posted by Takhir <br />
What about this? <br />
<br />
System::Call 'kernel32.dll::WinExec(t &quot;mysql.bat&quot;, i 0) i.r0'  <br />
<br />
  It works perfectly<br />
<br />
  Thanks a lot to everybody</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ccartier</div><div class="date">12th November 2007, 09:41</div></div><div class="posttext">System::Call 'kernel32.dll::WinExec(t &quot;c:\temp\mybat.bat&quot;, i 0) i.r0' works well to launch a .bat file at the end of the NSIS installation process. Problem: WinExec executes the .bat file from ...\My documents (ie it's there I find .log file after the launch), whereas I'd like to be executed from the .bat repository, ie c:\temp (so as to read a .conf file).<br />
Is there a way for it? I tried to precede &quot;System::Call ...&quot; with   SetOutPath &quot;c:\temp&quot;  but this doesn help...<br />
<br />
I'll appreciate any comments<br />
<br />
Cyril</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th November 2007, 10:56</div></div><div class="posttext">If you need to run the batch file without waiting for it to finish and you cannot get Winexec working, you can make another NSIS executable that runs the batch file itself with nsExec and extract and run that at the end of your main installer with Exec.<br />
<br />
The secondary installer code would look like this:<br />
OutFile RunBatch.exe<br />
SilentInstall silent<br />
Section<br />
nsExec::Exec ...<br />
SectionEnd<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>