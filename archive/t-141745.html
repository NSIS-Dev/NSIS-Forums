<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" using NSIS to install windowsInstaller, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  using NSIS to install windowsInstaller NSIS Discussion" />
	
	<title> using NSIS to install windowsInstaller [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  using NSIS to install windowsInstaller</div>
<hr />
<div class="pda"><a href="t-141745.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=141745">using NSIS to install windowsInstaller</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">krisbabu</div><div class="date">10th July 2003, 14:34</div></div><div class="posttext">Hi..<br />
<br />
I have a problem with my installer. I want to install mycomponent.msi(windowsInstaller) .is it possible?.<br />
<br />
Am using the flg command and it throws error.<br />
<br />
Exec &quot;${MSIExecPaht}msiExec /q /i &quot;License.msi&quot; TargetDIr = &quot;$InSTDir&quot;<br />
<br />
Bye<br />
Krisbabu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th July 2003, 14:39</div></div><div class="posttext">You have a problem with the quotes. Use ' as the outer quote and it should be OK. You should also quote the path to the executable just in case it contains spaces. So the line should look like this:<br />
<br />
Exec '&quot;${MSIExecPath}msiExec&quot; /q /i &quot;License.msi&quot; TargetDir = &quot;$INSTDIR&quot;'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">krisbabu</div><div class="date">10th July 2003, 14:55</div></div><div class="posttext">Hi kichek..<br />
The code that i used Exactly the one u suggested,But still it thro' error.I tried using nsExec::Exec '&quot;${MSIExecPath}msiExec&quot; /q /i &quot;License.msi&quot; TargetDir = &quot;$INSTDIR&quot;' too,but it's return value was Error.<br />
Thanks for ur reply<br />
krisbabu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th July 2003, 14:59</div></div><div class="posttext">What error?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">krisbabu</div><div class="date">11th July 2003, 06:35</div></div><div class="posttext">hi kichek..<br />
it gave the return as error and i didn't get any more information.<br />
<br />
here is my code:<br />
Exec '&quot;${MSISEXECPATH}msiExec&quot; /q /i &quot;License.msi&quot; TARGETDIR = &quot;$INSTDIR&quot;'<br />
pop $0 #return value/error/timeout<br />
DetailPrint &quot;Return value $0&quot;<br />
<br />
Here<br />
${MSISEXECPATH} -&gt; msiExec path<br />
TARGETDIR = $INSTDIR&quot; -&gt; is parameter so that i can send targetdir, which is defined in License.msi<br />
Thanks<br />
krisbabu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th July 2003, 11:36</div></div><div class="posttext">That's not how you get the return value. Exec doesn't return any return value because it doesn't wait for the program to finish. Only ExecWait and nsExec return the return value. With ExecWait you specify the output variable in another parameter and only with nsExec you pop it from the stack.<br />
<br />
First of all make sure ${MSISEXECPATH} has an ending back-slash so the path is completely right (you can also just output &quot;${MSISEXECPATH}msiExec&quot;), next make sure it can find License.msi. If License.msi is not in the current working directory ($EXEDIR or $OUTDIR if SetOutPath was used) then either specify a full path or set the current working directory (using SetOutPath) to the directory of License.msi.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">krisbabu</div><div class="date">18th July 2003, 09:08</div></div><div class="posttext">Hi,<br />
I got it.The mistake was with the coding.There was extra Space.It is like this<br />
<br />
Exec ' &quot;${MSIExecPath}msiExec&quot; /q /i &quot;License.msi&quot; TargetDir = &quot;$INSTDIR&quot; '<br />
<br />
Now it is as follows:<br />
<br />
<br />
ExecWait Exec '&quot;${MSIExecPath}msiExec&quot; /q /i &quot;License.msi&quot; TargetDir = &quot;$INSTDIR&quot;' - No Space bt ' and &quot;<br />
Thanks<br />
Krisbabu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>