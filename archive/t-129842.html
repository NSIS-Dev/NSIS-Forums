<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Using variables as CreateShortCut arguments, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Using variables as CreateShortCut arguments NSIS Discussion" />
	
	<title> Using variables as CreateShortCut arguments [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Using variables as CreateShortCut arguments</div>
<hr />
<div class="pda"><a href="t-129842.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=129842">Using variables as CreateShortCut arguments</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Dark Ryder</div><div class="date">26th March 2003, 19:11</div></div><div class="posttext">I'm working with a quick-and-dirty installer that creates a number of shortcuts with CreateShortCut.  One of the sections I have set up gives the user the option of setting the SW_SHOWMAXIMIZED flag on all of them (a horrible, horrible abuse of the system, I know ;)), but was unsatisfied with my solution.  Here's what I'm using:Section &quot;-Default&quot;<br />
StrCpy $9 &quot;&quot;<br />
SectionEnd<br />
<br />
Section &quot;Maximize&quot;<br />
StrCpy $9 &quot;max&quot;<br />
SectionEnd<br />
<br />
Section &quot;Desktop Shortcut&quot;<br />
StrCmp $9 &quot;max&quot; deskMax<br />
CreateShortCut &quot;$DESKTOP\App.lnk&quot; &quot;$INSTDIR\App.exe&quot;<br />
Goto deskNorm<br />
deskMax:<br />
CreateShortCut &quot;$DESKTOP\App.lnk&quot; &quot;$INSTDIR\App.exe&quot; &quot;&quot; &quot;&quot; &quot;&quot; SW_SHOWMAXIMIZED<br />
deskNorm:<br />
SectionEndIt works perfectly well, but it's ugly and I have to end up creating jumps and labels for each of the dozen or so shortcuts involved.  What I would much prefer is something like this:Section &quot;-Default&quot;<br />
StrCpy $9 &quot;SW_SHOWNORMAL&quot;<br />
SectionEnd<br />
<br />
Section &quot;Maximize&quot;<br />
StrCpy $9 &quot;SW_SHOWMAXIMIZED&quot;<br />
SectionEnd<br />
<br />
Section &quot;Desktop Shortcut&quot;<br />
CreateShortCut &quot;$DESKTOP\App.link&quot; &quot;$INSTDIR\App.exe&quot; &quot;&quot; &quot;&quot; &quot;&quot; $9<br />
SectionEndMuch cleaner, no?  But it doesn't work.  I get a bad argument error (it's interpreting $9 literally).  Same when I put the variable name in quotes.  Anybody got any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th March 2003, 19:15</div></div><div class="posttext">It won't work this way. This should work:<br />
<br />
StrCmp $9 &quot;value&quot; &quot;&quot; done<br />
  ...createshortcut with parameter 1...<br />
<br />
StrCmp $9 &quot;value2&quot; &quot;&quot; done<br />
  ...createshortcut with parameter 2...<br />
<br />
done:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">26th March 2003, 19:18</div></div><div class="posttext">Maybe, just maybe if you are using the Modern UI with<br />
the Startmenu page; the $9 is only for it.<br />
Another thing *maybe* using defines:<br />
<br />
<br />
!define status &quot;SW_SHOWNORMAL&quot;<br />
<br />
Section &quot;Maximize&quot;<br />
StrCpy ${status} &quot;SW_SHOWMAXIMIZED&quot;<br />
SectionEnd<br />
<br />
Section &quot;Desktop Shortcut&quot;<br />
CreateShortCut &quot;$DESKTOP\App.link&quot; &quot;$INSTDIR\App.exe&quot; &quot;&quot; &quot;&quot; &quot;&quot; ${status}<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Dark Ryder</div><div class="date">26th March 2003, 19:20</div></div><div class="posttext">No, no -- the version using StrCmp is working.  I just don't feel that's a good solution, and I'd like to be able to use a variable as an argument in CreateShortCut.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Dark Ryder</div><div class="date">26th March 2003, 19:22</div></div><div class="posttext">Dark Boy, let me give that a shot.  I hadn't thought of using defines...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th March 2003, 19:25</div></div><div class="posttext">Defines are processed by the compiler and cannot be changed on run-time. StrCmp is the only way because the parameter is a compiler parameter.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Dark Ryder</div><div class="date">26th March 2003, 19:32</div></div><div class="posttext">Even so.  StrCpy gives an argument error if you try copying to a define.  Oh, well.  And come to think of it, I'd bet that determining it at compile time is the only reasonable way to do it, too, because otherwise you'd have to include code for evaluating strings into the appropriate numerical value in the installer itself.  Too bad.  Thanks, everybody!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th March 2003, 19:41</div></div><div class="posttext">You can make your code a little prettier with a macro. For example:<br />
<br />
!macro cs target loc<br />
StrCmp $0 max +3<br />
  CreateShortcut &quot;${target}&quot; &quot;${loc}&quot;<br />
  Goto +2<br />
  CreateShortcut &quot;${target}&quot; &quot;${loc}&quot; &quot;&quot; &quot;&quot; &quot;&quot; SW_SHOWMAXIMIZED<br />
!macroend</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Dark Ryder</div><div class="date">26th March 2003, 20:13</div></div><div class="posttext">Thanks, kichik!  Works just fine, once I RTFM ;).  I haven't used NSIS in a long while (v1.4x, I think), so I keep forgetting about the new stuff like macros and relative jumps.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">virtlink</div><div class="date">28th March 2003, 13:47</div></div><div class="posttext">Hasn't it become a great scripting language since then? ;)<br />
<br />
B.t.w. KiCHiK: wouldn't this problem be solved when SW_SHOWMAXIMIZED is not read as a switch, but as a string, performing escape and variable/symbol replace functions on it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">28th March 2003, 15:03</div></div><div class="posttext">I see no reason to change that for only this command. It will also add size.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>