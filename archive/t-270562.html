<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS Simple Service Plugin, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS Simple Service Plugin NSIS Discussion" />
	
	<title> NSIS Simple Service Plugin [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS Simple Service Plugin</div>
<hr />
<div class="pda"><a href="t-270562.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=270562">NSIS Simple Service Plugin</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">3rd May 2007, 18:51</div></div><div class="posttext">Hi,<br />
<br />
IÂ´ve create a service plugin. This plugin contains basic service functions like start, stop the service or checking the service status. It also contains advanced service functions for example setting the service description, changed the logon account, granting or removing the service logon privilege.<br />
<br />
Here the function list:<br />
<br />
<br />
SimpleSC::Install [name_of_service] [display_name] [start_type] [service_commandline] [dependencies] [account] [password]<br />
SimpleSC::Remove [name_of_service]<br />
SimpleSC::StartService [name_of_service] <br />
SimpleSC::StopService [name_of_service] <br />
SimpleSC::PauseService [name_of_service] <br />
SimpleSC::ContinueService [name_of_service]<br />
SimpleSC::RestartService [name_of_service]<br />
SimpleSC::ExistsService [name_of_service]<br />
SimpleSC::GetServiceDisplayName [name_of_service]<br />
SimpleSC::GetServiceName [display_name]<br />
SimpleSC::GetServiceStatus [name_of_service]<br />
SimpleSC::SetServiceDescription [name_of_service] [service_description]<br />
SimpleSC::SetServiceStartType [name_of_service] [start_type]<br />
SimpleSC::SetServiceLogon [name_of_service] [account] [password]<br />
SimpleSC::GrantServiceLogonPrivilege [account]<br />
SimpleSC::RemoveServiceLogonPrivilege [account]<br />
SimpleSC::ServiceIsPaused [name_of_service]<br />
SimpleSC::ServiceIsRunning [name_of_service]<br />
SimpleSC::ServiceIsStopped [name_of_service]<br />
<br />
<br />
Here is the link to the wiki: http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin<br />
<br />
Any comments, suggestions and questions are welcome...<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nicolas Cuny</div><div class="date">7th May 2007, 14:09</div></div><div class="posttext">Hi,<br />
<br />
I just tested your plugin and was surprised to see that it doesn't need admin privileges to check the status of a service, contrary to the other available plugins. This was tested on Vista and XP Pro SP2.<br />
<br />
This is very useful to me and I would like to know if this behaviour is intended and maybe a little explanation too :)<br />
<br />
These are the scripts I used to double-check :<br />
<br />
Name &quot;simpleservice-test&quot;<br />
Outfile &quot;simpleservice-test.exe&quot;<br />
ShowInstDetails show<br />
RequestExecutionLevel user<br />
<br />
Section -Main SEC0000<br />
    SetAutoClose false<br />
    SimpleSC::GetServiceStatus &quot;W32Time&quot;<br />
    pop $0<br />
    pop $1<br />
    DetailPrint $0<br />
    DetailPrint $1<br />
SectionEnd<br />
<br />
Name &quot;nsscm-test&quot;<br />
Outfile &quot;nsscm-test.exe&quot;<br />
ShowInstDetails show<br />
RequestExecutionLevel user<br />
<br />
Section -Main SEC0000<br />
    SetAutoClose false<br />
    nsSCM::QueryStatus &quot;W32Time&quot;<br />
    Pop $0<br />
    Pop $1<br />
    DetailPrint $0<br />
    DetailPrint $1<br />
SectionEnd<br />
<br />
!include &quot;servicelib.nsh&quot;<br />
<br />
Name &quot;servicelib-test&quot;<br />
Outfile &quot;servicelib-test.exe&quot;<br />
ShowInstDetails show<br />
RequestExecutionLevel user<br />
<br />
Section -Main SEC0000<br />
    SetAutoClose false<br />
    !insertmacro SERVICE &quot;status&quot; &quot;W32Time&quot; &quot;&quot;<br />
    pop $0<br />
    DetailPrint $0<br />
SectionEnd<br />
<br />
And these are the results :<br />
<br />
* simpleservice-test:<br />
0<br />
4<br />
<br />
* nsscm-test:<br />
error<br />
1<br />
<br />
* servicelib-test:<br />
false<br />
<br />
Thanks for the great job !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nicolas Cuny</div><div class="date">7th May 2007, 17:37</div></div><div class="posttext">I found out so far that :<br />
<br />
- GetServiceStatus works with admin and user privileges<br />
- ExistsService only works with admin privileges<br />
- ServiceIsRunning works with both privileges, but documentation on the wiki is wrong : '1' means the service is running<br />
<br />
This has been tested on Vista and XP.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">7th May 2007, 18:36</div></div><div class="posttext">Hi,<br />
<br />
Originally posted by Nicolas Cuny <br />
I found out so far that :<br />
<br />
- ExistsService only works with admin privileges<br />
- ServiceIsRunning works with both privileges, but documentation on the wiki is wrong : '1' means the service is running<br />
<br />
This has been tested on Vista and XP.  <br />
<br />
IÂ´ve changed the access flags for each functions so every function will be executed with the lowest privilege which is necessary. So I think ExistsService should now work with user privileges. A new version (1.01) of this plugin is available now.<br />
<br />
IÂ´ve changed the wrong Result-Description for the functions ServiceIsRunning, ServiceIsPaused and ServiceIsStopped.<br />
<br />
Any comments, suggestions and questions are welcome...<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psmika</div><div class="date">24th May 2007, 10:05</div></div><div class="posttext">Hello,<br />
<br />
I'm am currently building an installer for a service application and I am using this plugin to create the service itself. <br />
<br />
I am able to create the service but in the service control manager there is no description. Also when the service starts a message is logged in the even viewer and then it says Service1 has been started even tho my service is called something else. <br />
Most likely im doing something wrong, it would be nice if someone could point me in the right direction.<br />
<br />
I have used the following command to add the service:<br />
SimpleSC::InstallService &quot;MyService&quot; &quot;My  Service&quot; &quot;2&quot; &quot;$INSTDIR\bin\MyService.exe&quot; &quot;&quot; &quot;&quot; &quot;&quot;<br />
<br />
Thanks in advance for any help with this!<br />
<br />
// Mika</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">24th May 2007, 17:34</div></div><div class="posttext">Hi,<br />
<br />
<br />
I am able to create the service but in the service control manager there is no description. <br />
 <br />
<br />
Thats correct. If you install the service the service description is not set. Please use the function &quot;SetServiceDescription&quot; to set a seperate description.<br />
<br />
<br />
Also when the service starts a message is logged in the even viewer and then it says Service1 has been started even tho my service is called something else. <br />
 <br />
<br />
I think Service1 is your Display name, otherwise you canÂ´t see it in eventlog. But I think your Key-Name (It is called [name_of_service] in plugin doc) is always the same. DonÂ´t confuse Display-Name and Key-Name.<br />
<br />
The Display-Name is a unique name you can see in the service controller at the column &quot;Name&quot;. <br />
<br />
The Key-Name is a unique name you can see if you show the properties of a service.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psmika</div><div class="date">25th May 2007, 09:04</div></div><div class="posttext">Thank you so much for your response.<br />
<br />
The SetServiceDescription function works like a charm!<br />
I found out that the Service1 issue is a programming issue and it has nothing to do with this plugin.<br />
<br />
Thank you for the fast response and for this plugin!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Andy1988</div><div class="date">29th May 2007, 17:02</div></div><div class="posttext">I tried to use your dll.<br />
I copied it into the Plugins folder in the folder where NSIS is installed, but the compiler always says that &quot;SimpleSC::Install&quot; is an illegal command.<br />
<br />
Do I need to define somewhere in my NSIS Script that I want to use your dll? I was not able to find anything about this in the Wiki, this forum or with google.<br />
Perhaps I'm blind ;)<br />
<br />
Thank you for your help!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">29th May 2007, 19:54</div></div><div class="posttext">Hello Andy,<br />
<br />
Originally posted by Andy1988 <br />
I tried to use your dll.<br />
I copied it into the Plugins folder in the folder where NSIS is installed, but the compiler always says that &quot;SimpleSC::Install&quot; is an illegal command.<br />
<br />
Do I need to define somewhere in my NSIS Script that I want to use your dll? I was not able to find anything about this in the Wiki, this forum or with google.<br />
Perhaps I'm blind ;)<br />
<br />
A good message to you: You are not blind ;). That was my mistake. The documentation (in the readme.txt and on the wiki) was wrong about the name of the install and remove function. Only in the example it was correct. The function names are:<br />
<br />
<br />
SimpleSC::InstallService<br />
SimpleSC::RemoveService<br />
 <br />
<br />
IÂ´ve fixed it in the file and on the wiki.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Andy1988</div><div class="date">29th May 2007, 23:27</div></div><div class="posttext">Originally posted by Speed78 <br />
Hello Andy,<br />
<br />
<br />
<br />
A good message to you: You are not blind ;). That was my mistake. The documentation (in the readme.txt and on the wiki) was wrong about the name of the install and remove function. Only in the example it was correct. The function names are:<br />
<br />
<br />
SimpleSC::InstallService<br />
SimpleSC::RemoveService<br />
 <br />
<br />
IÂ´ve fixed it in the file and on the wiki.<br />
<br />
Best regards<br />
<br />
Rainer  <br />
It's great to hear that there is nothing wrong with my eyes ;)<br />
Now everything works like expected!<br />
<br />
BTW: Great plugin! And thank you for your work and fast help!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mr.hanky</div><div class="date">26th July 2007, 20:42</div></div><div class="posttext">I think this is the best service plugin so far.<br />
<br />
I do have one request. An option that will show the config info.<br />
Like the qc option does for SC.exe in windows<br />
qc--------------Queries the configuration information for a service. <br />
<br />
The option I am looking for the most is to read BINARY_PATH_NAME<br />
<br />
Thanks again for the great plugin<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">26th July 2007, 23:55</div></div><div class="posttext">Hello Chris,<br />
<br />
I will add a function like &quot;GetServicePath&quot; in the next release. I think I will release it next days.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lushdog</div><div class="date">31st July 2007, 19:31</div></div><div class="posttext">When I do a SimpleSC::RemoveService yet the service is still in the Services list.  If I try to restart the service I get a &quot;The specified service has been marked for deletion.&quot;  <br />
<br />
The service is removed from the list upon the next reboot.<br />
<br />
The only reason I ask is I'd like to let the user uninstall/reinstall without rebooting.<br />
<br />
I believe the &quot;sc delete&quot; command removes the service without a reboot.<br />
<br />
Does your plugin use &quot;sc&quot; or some other command?<br />
<br />
Thanks in advance,<br />
<br />
Matt</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">1st August 2007, 13:51</div></div><div class="posttext">Hi lushdog,<br />
<br />
Originally posted by lushdog <br />
When I do a SimpleSC::RemoveService yet the service is still in the Services list.  If I try to restart the service I get a &quot;The specified service has been marked for deletion.&quot;  <br />
<br />
The service is removed from the list upon the next reboot.<br />
<br />
The only reason I ask is I'd like to let the user uninstall/reinstall without rebooting.<br />
<br />
I believe the &quot;sc delete&quot; command removes the service without a reboot.<br />
<br />
Does your plugin use &quot;sc&quot; or some other command?<br />
<br />
Thanks in advance,<br />
<br />
Matt  <br />
<br />
The plugin uses the windows api functions. I think you have removed the service during your service list windows was opened!? If the service list is opened this is a default behaviour. Try to close the service list window and remove the service and then open the service list. You will see that the service is removed. <br />
<br />
&quot;sc&quot; uses the same functions like my plugin so &quot;sc&quot; has the same behaviour.<br />
<br />
Please remember: You should stop the service before you  removing it.<br />
<br />
Best Regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">2nd August 2007, 20:08</div></div><div class="posttext">Hi,<br />
<br />
IÂ´ve released a new version of the NSIS Simple Service Plugin. The new version provides the function &quot;SimpleSC::GetServiceBinaryPath&quot; to get the binary path of a specified service.<br />
<br />
You can find more informations and download file on the wiki page (http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin). <br />
<br />
If you have any questions please let me now.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">7th August 2007, 16:37</div></div><div class="posttext">Hi,<br />
<br />
IÂ´ve released a new version of the NSIS Simple Service Plugin. This is an bugfix release that concerns to the functions StartService, StopService, ContinueService and PauseService. It is recommend to use this version of the plugin because it is possible that using this functions ends in an endless loop. This happens for example if the service doesnÂ´t start, stop aso. or e.g. the service crashes during startup (Function: StartService).<br />
<br />
You can find more informations and download file on the wiki page (http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin).<br />
<br />
If you have any questions please let me now.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">9th January 2008, 22:36</div></div><div class="posttext">Hello Rainer,<br />
<br />
this is a great plugin.<br />
<br />
I have a request:<br />
Could you add an option to SimpleSC::StopService to stop dependant services first?<br />
(Like the DOS command &quot;net stop {ServiceName} /y&quot;.)<br />
Have a look at http://support.microsoft.com/kb/245230 for an idea.<br />
<br />
Thanks in advance,<br />
JP</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">10th January 2008, 07:44</div></div><div class="posttext">Hello JP,<br />
<br />
I will add this feature in the next release.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">12th January 2008, 16:51</div></div><div class="posttext">Hi,<br />
<br />
IÂ´ve released a new version of the NSIS Simple Service Plugin. The functions SimpleSC::StopService and SimpleSC::RestartService are now improved. Now all dependent services are stopping recursively too. You can find more informations and download file on the wiki page (http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin).<br />
<br />
If you have any questions please let me now.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th January 2008, 11:43</div></div><div class="posttext">It would be very handy if you could add support for enabling desktop interaction when installing a service. This is ideal for Microsoft's srvany.exe executable which you can use to run any Windows executable as a service (silly enough though, the app that comes with it, instsrv.exe does not allow you to enable desktop interaction!)<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">13th January 2008, 12:40</div></div><div class="posttext">Hello Stu,<br />
<br />
I will add the feature in the next release. This feature will only run on systems older than Windows Vista. Vista doesnÂ´t support desktop interaction anymore (See: http://msdn2.microsoft.com/en-us/library/ms683502(VS.85).aspx)<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th January 2008, 13:03</div></div><div class="posttext">Righto thanks that's fine.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bradkohl</div><div class="date">14th January 2008, 23:38</div></div><div class="posttext">Could you add the ability to start a service with a parameter?   I tried adding my param to the end of the binary path and that didn't work.  <br />
<br />
So far I like the plugin a lot, my only complaint is that it's a little bigger than other options like nsSCM and the ExistsService function seems to have odd return values compared to the other functions, the return value(1) seems more like a success case with that one, as opposed to the others which return (0) on success.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th January 2008, 12:49</div></div><div class="posttext">Try with a binary path as `&quot;path\to\app.exe&quot; params`<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">16th January 2008, 11:50</div></div><div class="posttext">Originally posted by bradkohl <br />
Could you add the ability to start a service with a parameter?   I tried adding my param to the end of the binary path and that didn't work.  <br />
 <br />
<br />
What exactly did you mean? If you mean the &quot;InstallService&quot; function then you can use your parameter in the &quot;[service_commandline]&quot; parameter.<br />
<br />
For example:<br />
<br />
SimpleSC::InstallService &quot;MyService&quot; &quot;My Service Display Name&quot; &quot;2&quot; &quot;C:\MyPath\MyService.exe /process=server&quot; &quot;&quot; &quot;&quot; &quot;&quot;<br />
  Pop $0 ; return error(1)/success(0)<br />
<br />
If you mean a start parameter in the &quot;StartService&quot; function then you are right. At the moment it is not implemented yet. If you need this please let me now and I will add this functionality.<br />
<br />
[i]<br />
So far I like the plugin a lot, my only complaint is that it's a little bigger than other options like nsSCM <br />
[/B]<br />
<br />
I think this is not really a problem. This plugin provides more functions and the harddisk are very cheap.<br />
<br />
[i]<br />
The ExistsService function seems to have odd return values compared to the other functions, the return value(1) seems more like a success case with that one, as opposed to the others which return (0) on success. <br />
[/B]<br />
<br />
Yes, you are right. The reason for this is that the function returns &quot;True&quot; or &quot;False&quot; - &quot;True&quot; is 1 and &quot;False&quot; is 0. I think its ok because itÂ´s documented in the wiki.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bradkohl</div><div class="date">18th January 2008, 17:56</div></div><div class="posttext">thanks for the reply, you're right the added functionality and flexibility does make up for the size, and yes I was talking about service 'start' parameters.  It would be great if you could add them but in the mean time, I've hardcoded the param I needed in the source.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">18th January 2008, 19:21</div></div><div class="posttext">Hi bradkohl,<br />
<br />
I will add this functionality in the next release.<br />
<br />
Best Regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">29th January 2008, 22:40</div></div><div class="posttext">Hi,<br />
<br />
IÂ´ve released a new version of the NSIS Simple Service Plugin. The changes are:<br />
<br />
- SimpleSC::InstallService supports now more than one dependencies (delimitter is the forward slash).<br />
- SimpleSC::InstallService supports now more service types e.g. to create an interactive service.<br />
- SimpleSC::StartService supports now arguments.<br />
<br />
Note: The signature of the functions SimpleSC::InstallService and SimpleSC::StartService has been changed. If you update from a previous version you must check your parameters.<br />
<br />
You can find more informations and download file on the wiki page (http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin).<br />
<br />
If you have any questions please let me now.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pcrowley</div><div class="date">29th January 2008, 23:41</div></div><div class="posttext">I tried using this and got a consistent failure on creating a service.  I need to create a kernel driver service which is a little different - the type is 1 rather than 16.<br />
<br />
Unfortunately, there doesn't seem to be a good way to get at the error returned.  I might have been able to do a call with System to do a GetLastError, or maybe not.  It would be very helpful to be able to get the reason for a failure.  Even a new function like SimpleSC::GetError would be helpful.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">29th January 2008, 23:52</div></div><div class="posttext">calling GetLastError with system.dll will not work, you will get the wrong result</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">30th January 2008, 09:14</div></div><div class="posttext">Hi,<br />
<br />
Even a new function like SimpleSC::GetError would be helpful.  <br />
<br />
I think this function is helpful. I will add this in the next release. <br />
<br />
Did you installed your service successfully now?<br />
<br />
Best Regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">5th February 2008, 19:46</div></div><div class="posttext">Hi,<br />
<br />
IÂ´ve released a new version of the NSIS Simple Service Plugin. The changes are:<br />
<br />
- Every function now returns &lt;&gt; 0 if there is an error. Use SimpleSC::GetErrorMessage to get the message of a function result<br />
- Added function SimpleSC::GetErrorMessage to get the message of a function result<br />
- SimpleSC::ExistsService results now 0 if the service exists and &lt;&gt; 0 if the service doensnÂ´t exists<br />
- SimpleSC::RestartService supports now arguments.<br />
<br />
Note: The signature of the function SimpleSC::RestartService has been changed. If you update from a previous version you must check your parameters.<br />
<br />
You can find more informations and download file on the wiki page (http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin).<br />
<br />
If you have any questions please let me now.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th February 2008, 17:56</div></div><div class="posttext">I'm using the latest dll and SimpleSC::ExistsService is returning 0 when the service doesn't exist.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th February 2008, 21:07</div></div><div class="posttext">Also RemoveService appears to be returning a value other than 0 on success rather than on failure.<br />
<br />
Edit: My bad on RemoveService. The other function still returns 1 when it exists though.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">10th February 2008, 12:57</div></div><div class="posttext">Hi,<br />
<br />
IÂ´ve released a new version of the NSIS Simple Service Plugin. The changes are:<br />
<br />
- SimpleSC::ExistsService results now 0 if the service exists and &lt;&gt; 0 if the service doensnÂ´t exists<br />
<br />
You can find more informations and download file on the wiki page (http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin).<br />
<br />
Thanks to Stu for reporting this bug. If you have any questions please let me now.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th February 2008, 13:03</div></div><div class="posttext">Thank you!<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">elllit</div><div class="date">4th July 2008, 10:30</div></div><div class="posttext">Hi,<br />
<br />
in my installer I want to stop and delete an already running service, install the data and then install and start it again.<br />
<br />
Everything is fine, until it comes to the stopping/deleting point. It passes without error but the process stays active for another ~20s (on my system), causing the installer to show a message that the file, that is about to be installed, is currently in use.<br />
<br />
The service actually does not exist anymore. So checking for existance does not work.<br />
<br />
Sleeping for a static 30sec is not satisfying at all. <br />
<br />
Using the nsProcess plug-in to see wether my service is still running or not might be a solution (will try it next). But I hope that there is a better out there.<br />
<br />
Any suggestions?<br />
<br />
-- Till</div></div><hr />


<div class="post"><div class="posttop"><div class="username">elllit</div><div class="date">4th July 2008, 13:31</div></div><div class="posttext">Edit: Solved - Layer 8 issue *bangs the forehead on teh table*<br />
<br />
<br />
---<br />
<br />
Oh, there is another issue:<br />
<br />
Installing for the standard user works flawlessly. But giving an account name and password it fails with error code 1057 that is: &quot;Account invalid or does not exist&quot; or something... I triple checked the strings and even hardcoded them into the script w/o success. :-(<br />
<br />
Im trying to install on a 2003 Server if that might help.<br />
<br />
Thanks,<br />
<br />
-- Till</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">5th July 2008, 12:03</div></div><div class="posttext">Hello Till,<br />
<br />
 <br />
Everything is fine, until it comes to the stopping/deleting point. It passes without error but the process stays active for another ~20s (on my system), causing the installer to show a message that the file, that is about to be installed, is currently in use.<br />
<br />
The service actually does not exist anymore. So checking for existance does not work.<br />
<br />
<br />
If the service doesnÂ´t exists (Stopped &amp; Uninstalled) the plugin has done his work. A question to figure out where the problem is:<br />
<br />
Please try to stop your service with the plugin (not to uninstall!). After that please open your process list and check for your service process. Please repeat the same steps with the service manager. Does the service process exists in the process list?<br />
<br />
<br />
<br />
 <br />
Sleeping for a static 30sec is not satisfying at all. <br />
<br />
Using the nsProcess plug-in to see wether my service is still running or not might be a solution (will try it next). But I hope that there is a better out there.<br />
<br />
This is really nonsatisfying!<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">elllit</div><div class="date">22nd July 2008, 12:52</div></div><div class="posttext">Hi,<br />
<br />
first: sorry for the delay in answering your reply.<br />
<br />
Originally posted by Speed78 <br />
Hello Till,<br />
<br />
If the service doesnÂ´t exists (Stopped &amp; Uninstalled) the plugin has done his work. A question to figure out where the problem is:<br />
<br />
Please try to stop your service with the plugin (not to uninstall!). After that please open your process list and check for your service process. Please repeat the same steps with the service manager. Does the service process exists in the process list?<br />
  <br />
<br />
I actually did that, but somehow I did something that obviously has fixed the problem, because I never had that delay issue since then. :confused: <br />
<br />
Anyways... I now have a issue that seemed to work all the time but now giving me a hard time.<br />
<br />
This is the code i use to start a service<br />
<br />
<br />
    ${If} $S_StartNowInput == ${BST_CHECKED}<br />
        DetailPrint `Starting service`<br />
        LogEx::Write /NOUNLOAD `... starting`<br />
        LogEx::Write /NOUNLOAD `... &gt;&gt;&gt; arguments: `<br />
        SimpleSC::StartService &quot;${s_name}&quot; &quot;&quot;<br />
        Pop $0<br />
        ${If} $0 &lt;&gt; 0<br />
            #SimpleSC::GetErrorMessage<br />
            #Pop $0<br />
            LogEx::Write /NOUNLOAD `... [InstallService] ERROR: $0`<br />
            DetailPrint `Could not start service! - Reason: $0`<br />
            Goto cancel<br />
        ${EndIf}<br />
    <br />
        DetailPrint `... done`<br />
    ${EndIf}<br />
<br />
<br />
This fragment is, with some more pieces, enclosed in a macro. Before starting the service it is installed without any sign of error. When it comes to starting it runs into the 30sec timeout (i guess) and gives me &quot;1053&quot; as result. Which in words means: &quot;The service did not respond to the start or control request in a timely fashion&quot; or something similar.<br />
<br />
I'm pretty confused because I couldn't track down the cause of this. I'm not that familiar with windows' service handling and thus not sure what to look for.<br />
<br />
Any ideas? Thanks in advance.<br />
<br />
Till</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">22nd July 2008, 14:45</div></div><div class="posttext">This to me would suggest a problem with the service itself. I personally have had no problems with SimpleSC installing, starting, stopping or uninstalling services.<br />
<br />
I have seen that kind of error in a service that does not start the main thread in its start method.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">22nd July 2008, 21:01</div></div><div class="posttext">Hello Till,<br />
<br />
please try this script:<br />
<br />
----------------------<br />
Name &quot;test&quot;<br />
OutFile &quot;test.exe&quot;<br />
<br />
!Define SERVICE &quot;TapiSrv&quot;<br />
<br />
Section<br />
  MessageBox MB_OK &quot;NOTE: Result '0' means it was success otherwise '1'&quot;<br />
  <br />
  MessageBox MB_OK &quot;Starting Service: ${SERVICE}&quot;<br />
  SimpleSC::StartService &quot;${SERVICE}&quot; &quot;&quot;<br />
  Pop $0<br />
  MessageBox MB_OK &quot;Result: $0&quot;<br />
<br />
SectionEnd<br />
----------------------<br />
<br />
This script will start the tapi service (In german: &quot;Telefonie&quot;... I donÂ´t know the name in english :( )<br />
<br />
I tested this script without any problems. If you also have no problems with this script I think the problem is your service. Can you check this and please give me a feedback!?<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">elllit</div><div class="date">23rd July 2008, 08:13</div></div><div class="posttext">Speed78,<br />
<br />
thanks for helping me.<br />
<br />
The result your skript gives me is &quot;1056&quot;.<br />
<br />
The service &quot;Telefonie&quot; is running on my system and I can't stop it apperently (Error &quot;1053&quot; again). When I try to stop it via the services control list it says it needs to stop &quot;RAS-Verbindungsverwaltung&quot; which has &quot;Telefonie&quot; as a dependency. This is where the error comes into place. I guess it is used in the background somehow(?).<br />
<br />
I'll talk with guys who code the service to check if the problem is on that side, following Afrow UK's suggestion which I also considered as another spot to search for a solution. But trying to find the error on oneself is the first way to go, isn't it? ;)<br />
<br />
Till</div></div><hr />


<div class="post"><div class="posttop"><div class="username">elllit</div><div class="date">23rd July 2008, 11:52</div></div><div class="posttext">Update:<br />
<br />
I manged to get one service running with the help of a developer. The problem was that a dependency wasn given for the service, which I didn't know about.<br />
<br />
Anyways, installing the other service mine is depending on solved the problem.<br />
<br />
I hope its as &quot;easy&quot; with the other service. I will ask the colleague on monday and report about it.<br />
<br />
I apology for bothering you as it was a fault on my side ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">elunkes</div><div class="date">14th August 2008, 22:02</div></div><div class="posttext">How can i get the LOGON NAME in a service<br />
<br />
we have <br />
<br />
SimpleSC::SetServiceLogon [name_of_service] [account] [password]<br />
<br />
but i want something like this <br />
<br />
  GetServiceLogon (or something)<br />
<br />
can ai get it ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">15th August 2008, 03:37</div></div><div class="posttext">Hi,<br />
<br />
the next day I will released a new version of the plugin. I will implement this function in the new version.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">17th August 2008, 18:01</div></div><div class="posttext">Hi,<br />
<br />
IÂ´ve released a new version of the NSIS Simple Service Plugin. The changes are:<br />
<br />
<br />
- SimpleSC::GrantServiceLogonPrivilege and SimpleSC::RemoveServiceLogonPrivilege works now correct with domain names like MyDomain\MyUser.<br />
<br />
- Added function SimpleSC::GetServiceLogon to get the logon username of a service. <br />
<br />
<br />
You can find more informations and download file on the wiki page (http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin).<br />
<br />
Thanks to everyone for reporting bugs and requesting features. If you have any questions please let me now.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">elunkes</div><div class="date">18th August 2008, 15:27</div></div><div class="posttext">Hi Speed78,<br />
<br />
this version of SimpleSC was detected as a TROJAN when i used it in my compilation script<br />
<br />
With version 1.21  there is no problem (but also there is no new functions)<br />
<br />
without a antivirus , the new functions works right.<br />
<br />
i'm using &quot;Avast&quot; in my computer.<br />
<br />
could you review this version 1.22?<br />
<br />
thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">18th August 2008, 18:40</div></div><div class="posttext">Hi,<br />
<br />
IÂ´ve checked the file and here the results.<br />
<br />
<br />
http://www.virustotal.com/en/analisis/8f9c4252847f6e00f64b4943e04615dd<br />
<br />
IÂ´ve contacted AntiVir and Webwasher. AntiVir gave me the answer that the file is a FALSE-POSITIVE File and that they will modify the virus definitions. Webwasher gave me no answer at the moment.<br />
<br />
IÂ´m really confused about this because I only change some lines in the code and the scanner found a &quot;pseudo&quot;-virus. <br />
<br />
I couldnÂ´t determine some problems with &quot;Avast&quot;. So you can take a look to the VirusTotal-URL.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">18th August 2008, 20:55</div></div><div class="posttext">Hi,<br />
<br />
IÂ´ve released a new version of the NSIS Simple Service Plugin. I detected that the compiler optimazation results in a false-positive virusscan, so IÂ´ve removed it a I hope the problem is solved now.<br />
<br />
You can find more informations and download file on the wiki page (http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin).<br />
<br />
Thanks to everyone for reporting bugs and requesting features. If you have any questions please let me now.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">elunkes</div><div class="date">19th August 2008, 01:59</div></div><div class="posttext">Now it works fine!!<br />
<br />
thank you!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">phunkydizco</div><div class="date">12th February 2009, 12:49</div></div><div class="posttext">I have a service that takes some time to stop. How can I stop the service and wait until it is really stopped?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">12th February 2009, 16:48</div></div><div class="posttext">Hello,<br />
<br />
take a look at the documentation: http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin<br />
<br />
The &quot;SimpleSC::StopService&quot;-Function is what you are searching for.<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">13th April 2009, 12:06</div></div><div class="posttext">Hi,<br />
<br />
IÂ´ve released a new version of the NSIS Simple Service Plugin. The changes are:<br />
<br />
<br />
- Fixed wait for status bug if the service status changed. Now, if a service stops, starts aso. the plugin will work like the recommendations in the MSDN. On some systems (especially 64Bit systems) the plugin returns &quot;Stopped&quot; although the service was not really stopped.<br />
<br />
It is recommend to update your version of this plugin. You can find more informations and download file on the wiki page (http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin).<br />
<br />
If you have any questions please let me now.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">amclellan</div><div class="date">18th April 2009, 18:12</div></div><div class="posttext">I've been using version 1.24 of SimpleSC and I really appreciate it's ease of use.  I'm currently working on a issue where the a service has been previously installed and now I'm trying to update only the binary path if it happened to be installed in a different location without changing the other settings associated with the service.  Is there a SetServiceBinaryPath or some other way of performing this action.<br />
<br />
Thanks<br />
<br />
Allan McLellan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">18th April 2009, 18:25</div></div><div class="posttext">Hello Allan,<br />
<br />
unfortunately, there is no possiblity to change the binary path. At the moment I recommend the following procedure:<br />
<br />
1. Deinstall the service old &quot;RemoveService&quot;<br />
2. Install the new service with the new binary path &quot;InstallService&quot;.<br />
<br />
Nethertheless, I will add the method &quot;SetServiceBinaryPath&quot; in the next version of this plugin, but this will take some weeks.<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">amclellan</div><div class="date">18th April 2009, 19:07</div></div><div class="posttext">Hi<br />
<br />
Thanks for getting back to me so quickly.  I'm currently checking to see if the new binary path equals the old binary path and if they don't then pop up a message box requiring the user to manually go in and change it via the service manager.  It's not the nicest, but it doesn't really happen all that often.  Again thanks for the quick response.<br />
<br />
Allan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">18th April 2009, 19:22</div></div><div class="posttext">Hello Allan,<br />
<br />
I think to compare the binary path of the old service with the new service is a good idea. But if the paths are not equal I think itÂ´s more comfortable just to remove the old service (Take a look at SimpleSC::RemoveService) and install it again (Take a look at SimpleSC::InstallService). I think this should work. At the moment there is not possiblity to change the binary path in the service manager directly (AFAIK until Windows 2003). So the only way to change it is via command line &quot;sc.exe&quot;.<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saill</div><div class="date">22nd April 2009, 02:32</div></div><div class="posttext">Originally posted by elllit <br />
<br />
<br />
Installing for the standard user works flawlessly. But giving an account name and password it fails with error code 1057 that is: &quot;Account invalid or does not exist&quot; or something... I triple checked the strings and even hardcoded them into the script w/o success. :-(<br />
<br />
Im trying to install on a 2003 Server if that might help.<br />
<br />
Thanks,<br />
<br />
-- Till  <br />
<br />
Hi Till,<br />
<br />
We ran into the same problem. Turns out Windows wants the account name to be preceded by &quot;.\&quot;. We figured this out by having Windows report the account owning the service. This works on XP, we're hopeful it will hold for other Windows platforms.<br />
<br />
Just to be safe, we started the service as admin, then set service logon to the desired account.<br />
<br />
The code that worked looks like this:<br />
<br />
SimpleSC::InstallService &quot;MyService&quot; &quot;My Service Display Name&quot; &quot;272&quot; &quot;2&quot; &quot;C:\MyPath\MyService.exe&quot; &quot;&quot; &quot;&quot; &quot;&quot;<br />
<br />
SimpleSC::SetServiceLogon &quot;MyService&quot; &quot;.\MyServiceUser&quot; &quot;MyServiceUserPassword&quot;<br />
   Pop $0 ; returns an errorcode (&lt;&gt;0) otherwise success (0)<br />
   IntCmp $0 0 +1 Done Done ; If successful grant the service logon privilege to &quot;MyServiceUser&quot;<br />
    ; Note: Every serviceuser must have the ServiceLogonPrivilege to start the service<br />
    SimpleSC::GrantServiceLogonPrivilege &quot;.\MyServiceUser&quot;<br />
    Pop $0 ; returns an errorcode (&lt;&gt;0) otherwise success (0)<br />
  Done:<br />
<br />
<br />
Rainer, thanks for the great tool. Really saved our butts with this particular bug!<br />
<br />
Saill</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">22nd April 2009, 16:48</div></div><div class="posttext">Hi Saill,<br />
<br />
if I understand you correctly your problem with SetServiceLogon is &quot;.\&quot;-prefix of a non domain-account? I will check this for the next plugin-version.<br />
<br />
Kind regards,<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saill</div><div class="date">22nd April 2009, 21:55</div></div><div class="posttext">Hi Rainer,<br />
<br />
Exactly. My experiments show that any for any [account] input you need to add the &quot;.\&quot; prefix. Once you do that, it works great.<br />
<br />
No real need to fix it - a note in the documentation should do the trick.<br />
<br />
Thanks a lot for the tool. We used it to make sure that our service was owned by the current user so we could kill our runtime cleanly at shutdown. Solved one of our trickiest Windows bugs!<br />
<br />
Warm regards,<br />
<br />
Saill</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">23rd April 2009, 17:00</div></div><div class="posttext">Hello Saill,<br />
<br />
I changed it in the online documentation but addionally I will change this in the next version.<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saill</div><div class="date">24th April 2009, 19:17</div></div><div class="posttext">Hi Rainer,<br />
<br />
That's great! I believe the .\ prefix is also necessary in the &quot;account&quot; input for:<br />
<br />
SimpleSC::InstallSevice<br />
SimpleSC::GrantServiceLogonPrivilege<br />
SimpleSC::RemoveServiceLogonPrivilege<br />
<br />
Warm regards,<br />
<br />
Saill</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sadeesh</div><div class="date">11th May 2009, 06:13</div></div><div class="posttext">Hi,<br />
<br />
I am trying to install a bat file as service. <br />
I am able to create the service, but i am not able to start the service via script.<br />
When i try to start the service manually i get the following windows error message.<br />
<br />
&quot;1053 service did not respond to the start or control request in a timely fashion&quot;<br />
<br />
Can anyone help me to fix this?<br />
<br />
Thanks in advance,<br />
Sadeesh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th May 2009, 10:37</div></div><div class="posttext">You can't use a batch file as a service. Not every program can be used as a service. It must be specifically designed for this purpose. There are some helpers that can turn any application to a service. Google &quot;turn any application to a service&quot; or something similar and you should be able to find them.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pineapplex</div><div class="date">12th May 2009, 08:19</div></div><div class="posttext">I found a solution in order to use a Batch file as service. I used Flash Mx to create an EXE file that contains a FSCommand opening the Batch file. At last, the batch file is working as service.<br />
<br />
I hope it works for you.<br />
<br />
But I have another question:<br />
<br />
I have a service running (not a batch file, of course). What's the best way to &quot;interact&quot; with the service? I have the service running but I can't find the way to open my application and change some config parameters, for example.<br />
<br />
Can you help me with this issue?<br />
<br />
I'm sorry for my english. I hope you can understand me.<br />
<br />
Best wishes from Spain.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">15th May 2009, 21:22</div></div><div class="posttext">Version 1.24 has a problem (at least on my system) with stopping the Wireless Zero Configuration.<br />
SimpleSC::StopService &quot;WZCSVC&quot; does stop the service but is unaware of the status change and returns an error after the 30 s timeout (&quot;The service did not respond to the start or control request in a timely fashion&quot;).<br />
I tried several other windows services and there was no such problem. Version 1.23 deals with WZCSVC successfully. My system is XP SP2 but Wireless Zero Configuration has been updated (hotfix KB917021).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">21st May 2009, 16:15</div></div><div class="posttext">Hi,<br />
<br />
IÂ´ve released a new version of the NSIS Simple Service Plugin. The changes are:<br />
<br />
- SimpleSC::SetServiceLogon supports now non-domain username without the &quot;.\&quot;-prefix<br />
- SimpleSC::SetServiceBinaryPath function added <br />
<br />
You can find more informations and download file on the wiki page (http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin).<br />
<br />
If you have any questions please let me now.<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">21st May 2009, 16:18</div></div><div class="posttext">Hello,<br />
<br />
Originally posted by aerDNA <br />
Version 1.24 has a problem (at least on my system) with stopping the Wireless Zero Configuration.<br />
SimpleSC::StopService &quot;WZCSVC&quot; does stop the service but is unaware of the status change and returns an error after the 30 s timeout (&quot;The service did not respond to the start or control request in a timely fashion&quot;).<br />
I tried several other windows services and there was no such problem. Version 1.23 deals with WZCSVC successfully. My system is XP SP2 but Wireless Zero Configuration has been updated (hotfix KB917021).  <br />
<br />
sry... I read this just now after releasing 1.25. I will check this on XP SP2 the next days. If you stop your service manually (via service control center) how much time takes it to stop the service (&gt; 30 seconds) ?<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">21st May 2009, 16:54</div></div><div class="posttext">Originally posted by Speed78 <br />
If you stop your service manually (via service control center) how much time takes it to stop the service (&gt; 30 seconds) ?<br />
<br />
<br />
When stopped manually, everything's ok (takes about 2 sec). With SimpleSC 1.23 it's also fine. The problem is with v1.24-1.25. Starting the service works ok in new versions, although it takes several seconds longer than with 1.23.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pineapplex</div><div class="date">21st May 2009, 18:12</div></div><div class="posttext">Hi Rainer,<br />
<br />
What's the best way to &quot;interact&quot; with the service? I have the service running but I can't find the way to open my application and change some config parameters, for example.<br />
<br />
Excuse me for my &quot;stupid&quot; question but I'm starting to use NSIS and I can't find a solution for this issue.<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">21st May 2009, 20:07</div></div><div class="posttext">Hi aerDNA,<br />
<br />
Originally posted by aerDNA <br />
When stopped manually, everything's ok (takes about 2 sec). With SimpleSC 1.23 it's also fine. The problem is with v1.24-1.25. Starting the service works ok in new versions, although it takes several seconds longer than with 1.23.  <br />
<br />
IÂ´ve changed the code stop-service in version 1.24 because on some conditions the service doesnÂ´t stop correctly. So please can you give me the following information:<br />
<br />
Please try to stop the service via the plugin &gt;= 1.24. Open during stopping the service the service control manager and take a look to the service at the &quot;Status&quot;-column. Which state do you see? &quot;Stopping...&quot;? <br />
<br />
Did the service have dependencies?<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">21st May 2009, 20:10</div></div><div class="posttext">Hi pineapplex,<br />
<br />
Originally posted by pineapplex <br />
Hi Rainer,<br />
<br />
What's the best way to &quot;interact&quot; with the service? I have the service running but I can't find the way to open my application and change some config parameters, for example.<br />
<br />
Excuse me for my &quot;stupid&quot; question but I'm starting to use NSIS and I can't find a solution for this issue.<br />
<br />
Thanks in advance.  <br />
<br />
there are several solutions to communicate with a service. You can use a TCP/IP socket, named pipes or shared memory. This depends on your knowledge about this methods and your service requirements. <br />
<br />
Use this topics (TCP/IP socket, named pipes or shared memory) to get more addionally informations for you programming language.<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">21st May 2009, 20:37</div></div><div class="posttext">Hi aerDNA,<br />
<br />
Originally posted by Speed78 <br />
Hi aerDNA,<br />
<br />
 <br />
<br />
IÂ´ve changed the code stop-service in version 1.24 because on some conditions the service doesnÂ´t stop correctly. So please can you give me the following information:<br />
<br />
Please try to stop the service via the plugin &gt;= 1.24. Open during stopping the service the service control manager and take a look to the service at the &quot;Status&quot;-column. Which state do you see? &quot;Stopping...&quot;? <br />
<br />
Did the service have dependencies?<br />
<br />
Kind regards<br />
<br />
Rainer  <br />
<br />
I can reproduce your behaviour now and I will fix asap.<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">21st May 2009, 21:40</div></div><div class="posttext">Hi,<br />
<br />
IÂ´ve released a new version of the NSIS Simple Service Plugin. The changes are:<br />
<br />
- Fixed wait for status bug on starting, stopping, pausing or continuing a service <br />
<br />
You can find more informations and download file on the wiki page (http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin).<br />
<br />
Thanks to aerDNA for reporting this bug. If you have any questions please let me now.<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">22nd May 2009, 15:31</div></div><div class="posttext">Glad I could help. There are several service plugins but personally I prefer yours. I used it to make a little util aimed specifically at managing WZC / WLAN Autoconfig. Compiled with v1.26 and works like a charm. So thank you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kalix11</div><div class="date">27th May 2009, 16:12</div></div><div class="posttext">I tried using V1.26 to Set Logon account info for the Service and was not able to do it. When I visited your plugin page at http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin and found there is a note: The function &quot;SetServiceLogon&quot; only works if the servicetype is &quot;SERVICE_WIN32_OWN_PROCESS&quot;<br />
<br />
Would you please explain a little more about this servicetype? And how do I check and adjust the servicetype? Thanks a lot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">27th May 2009, 18:15</div></div><div class="posttext">Hello kalix11,<br />
<br />
Originally posted by kalix11 <br />
I tried using V1.26 to Set Logon account info for the Service and was not able to do it. When I visited your plugin page at http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin and found there is a note: The function &quot;SetServiceLogon&quot; only works if the servicetype is &quot;SERVICE_WIN32_OWN_PROCESS&quot; <br />
<br />
At the moment there is no possibility to get or set the service type. I would add these functions in the next version of the plugin.<br />
<br />
If you create a service on your own you should know the service type. <br />
<br />
Some useful link about the service type can be found here:<br />
<br />
http://msdn.microsoft.com/en-us/library/ms681987(VS.85).aspx<br />
<br />
See &quot;lpServiceStartName [in, optional]&quot; - lpServiceStartName is the username!<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kalix11</div><div class="date">27th May 2009, 18:30</div></div><div class="posttext">Thank you for your reply. I checked my service using some 3rd party tool and found the servicetype is SERVICE_WIN32_OWN_PROCESS. Can you think of any reason why SetServiceLogon is not working? I tried username with &quot;.\&quot; or without &quot;.\&quot;, all the same results. Or should I first grant LogonAsService privilege to the user account before I call SetServiceLogon?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">27th May 2009, 18:48</div></div><div class="posttext">Hi kalix11,<br />
<br />
Originally posted by kalix11 <br />
Thank you for your reply. I checked my service using some 3rd party tool and found the servicetype is SERVICE_WIN32_OWN_PROCESS. Can you think of any reason why SetServiceLogon is not working? I tried username with &quot;.\&quot; or without &quot;.\&quot;, all the same results. Or should I first grant LogonAsService privilege to the user account before I call SetServiceLogon?  <br />
<br />
You donÂ´t need this &quot;\.&quot;-prefix in version 1.26 and you donÂ´t need grant service logon before SetServiceLogon. <br />
<br />
Make sure that the user exists. If the user exists please please check the error result using the GetErrorMessage-Function like in this example:<br />
<br />
SimpleSC::SetServiceLogon &quot;MyService&quot; &quot;MyServiceUser&quot; &quot;MyServiceUserPassword&quot;<br />
  Pop $0 ; returns an errorcode (&lt;&gt;0) otherwise success (0)<br />
  IntCmp $0 0 Done +1 +1 <br />
    Push $0<br />
    SimpleSC::GetErrorMessage<br />
    Pop $0<br />
    MessageBox MB_OK|MB_ICONSTOP &quot;SetServiceLogon fails - Reason: $0&quot;<br />
  Done:<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kalix11</div><div class="date">27th May 2009, 21:25</div></div><div class="posttext">Thanks for the quick reply. I used your code and found out the reason is : The account name is invalid or does not exist, or the password is invalid for the account name specified.<br />
<br />
However, I'm pretty sure I'm using an existing account and provided right password. I also create a test account and it still failed. Any thoughts on it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">27th May 2009, 22:10</div></div><div class="posttext">Hi,<br />
<br />
Originally posted by kalix11 <br />
Thanks for the quick reply. I used your code and found out the reason is : The account name is invalid or does not exist, or the password is invalid for the account name specified.<br />
<br />
However, I'm pretty sure I'm using an existing account and provided right password. I also create a test account and it still failed. Any thoughts on it?  <br />
<br />
Can you give me the account name? Is this a domain account, then you have to use domain\user - syntax!? Does the name contains some specail characters? Remark: The plugin is not a unicode plugin!<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kalix11</div><div class="date">27th May 2009, 22:26</div></div><div class="posttext">The test account is just called &quot;test&quot; with password the same. Nothing fancy, just a proof of concept.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">27th May 2009, 22:48</div></div><div class="posttext">Hi,<br />
<br />
Originally posted by kalix11 <br />
The test account is just called &quot;test&quot; with password the same. Nothing fancy, just a proof of concept.  <br />
<br />
I canÂ´t reproduce it. I have created on Windows Vista and Windows XP a local user called &quot;test&quot; with the same password and used the function without any problems!<br />
<br />
So please can you give me the following informations:<br />
<br />
1. Which NSIS Version do you use?<br />
2. Which OS + SP + Language are you using?<br />
3. Please can you post your NSIS setup lines here. If possible can you send me a sample setup to rainer@speed-soft.de<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kalix11</div><div class="date">27th May 2009, 23:06</div></div><div class="posttext">Thank you so much for your time. I'll try to clean up other stuffs and give you only what it needs to reproduce the error and send you the email. Thanks again.<br />
<br />
BTW, the service was created using a java service wrapper from http://wrapper.tanukisoftware.org/. I don't know whether this would make any difference.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kalix11</div><div class="date">29th May 2009, 19:14</div></div><div class="posttext">Rainer is the MAN! Eventually there was an error in my code not passing the correct username and password. No wonder it would fail. There is nothing wrong with the plug-in.<br />
<br />
Rainer rocks!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">disruptor108</div><div class="date">1st July 2009, 23:02</div></div><div class="posttext">Originally posted by elllit <br />
Hi,<br />
<br />
first: sorry for the delay in answering your reply.<br />
<br />
 <br />
<br />
I actually did that, but somehow I did something that obviously has fixed the problem, because I never had that delay issue since then. :confused: <br />
<br />
Anyways... I now have a issue that seemed to work all the time but now giving me a hard time.<br />
<br />
This is the code i use to start a service<br />
<br />
<br />
    ${If} $S_StartNowInput == ${BST_CHECKED}<br />
        DetailPrint `Starting service`<br />
        LogEx::Write /NOUNLOAD `... starting`<br />
        LogEx::Write /NOUNLOAD `... &gt;&gt;&gt; arguments: `<br />
        SimpleSC::StartService &quot;${s_name}&quot; &quot;&quot;<br />
        Pop $0<br />
        ${If} $0 &lt;&gt; 0<br />
            #SimpleSC::GetErrorMessage<br />
            #Pop $0<br />
            LogEx::Write /NOUNLOAD `... [InstallService] ERROR: $0`<br />
            DetailPrint `Could not start service! - Reason: $0`<br />
            Goto cancel<br />
        ${EndIf}<br />
    <br />
        DetailPrint `... done`<br />
    ${EndIf}<br />
<br />
<br />
This fragment is, with some more pieces, enclosed in a macro. Before starting the service it is installed without any sign of error. When it comes to starting it runs into the 30sec timeout (i guess) and gives me &quot;1053&quot; as result. Which in words means: &quot;The service did not respond to the start or control request in a timely fashion&quot; or something similar.<br />
<br />
I'm pretty confused because I couldn't track down the cause of this. I'm not that familiar with windows' service handling and thus not sure what to look for.<br />
<br />
Any ideas? Thanks in advance.<br />
<br />
Till <br />
<br />
I understand that this post may be over a year old, but I was having the same issue.  When installing my service it would throw a 1053 error when trying to start.  <br />
<br />
I found the solution was to register the service:<br />
<br />
ExecWait '&quot;$INSTDIR\${PRODUCT_NAME}\Product.exe&quot; /service'<br />
<br />
After doing this, SimpleSC::StartService worked just fine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">2nd July 2009, 17:12</div></div><div class="posttext">Hello,<br />
<br />
Originally posted by disruptor108 <br />
I found the solution was to register the service:<br />
<br />
ExecWait '&quot;$INSTDIR\${PRODUCT_NAME}\Product.exe&quot; /service'<br />
<br />
After doing this, SimpleSC::StartService worked just fine.  <br />
<br />
<br />
the problem of elllit was that there exists services which depends on his service. Because of that the service doesnÂ´t start.<br />
<br />
I think your problem was that your service wasnÂ´t installed. Because of this your service doesnÂ´t start. You  can use your method which works of course or you can use the method SimpleSC::InstallService which is the general method for every service. However, you need to install the service first and after this you can start the service.<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">janvi</div><div class="date">11th November 2009, 13:43</div></div><div class="posttext">Hi Rainer,<br />
<br />
I m new to NSIS Script and I have been trying to install a Windows Service using your service plugin. I want to run a JAR file, rather than an exe, when the service starts.<br />
The service gets installed but I m not able to get it started. Whenever the installed service is started an error pops up saying &quot;Could not start MyService service on Local Computer. Error 193: 0xc1&quot;.<br />
I know the fact that this error comes up if the application is not valid Win32 application but I dont find any issues with my attempt of installation.<br />
Using NSIS script I m placing (installing) the required files into installation directory and using service plugin I install it where the &lt;binary_path&gt; value in SimpleSC::InstallService points to the JAR file placed in the installation directory.<br />
Can you please guide me?<br />
<br />
Thank You,<br />
Janvi</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">11th November 2009, 14:40</div></div><div class="posttext">I'd expect you would need to execute java with the jar as a parameter. Jar files aren't executable by themselves.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">janvi</div><div class="date">12th November 2009, 06:28</div></div><div class="posttext">Hi MSG,<br />
<br />
Thank you for replying. I tried what you said but it turned out to be a vain attempt. It's still not working. I guess the problem is not because of the JAR file.<br />
<br />
I tried a different scenario to check if the JAR file is causing the problem. I tried to run notepad.exe as a service. This time a different error message popped up saying &quot;Error 1053: The service didn't respond in timely fashion.&quot;<br />
<br />
I have kept the script as simple as possible so that it remains less error prone.<br />
Following is the script; please guide me if you find anything wrong:<br />
<br />
&lt;Script&gt;<br />
<br />
Name &quot;TestService&quot;<br />
OutFile &quot;TestService.exe&quot;<br />
<br />
InstallDir '$PROGRAMFILES\TestService'<br />
<br />
SetCompress Auto<br />
SetDateSave On<br />
SetDataBlockOptimize On<br />
SetOverwrite on<br />
<br />
Section<br />
SetOutPath $INSTDIR<br />
File 'F:\Projects\JavaService.jar'<br />
File 'F:\Projects\notepad.exe'<br />
<br />
# SimpleSC::InstallService [name_of_service] [display_name] [service_type] [start_type]<br />
# 				 [dependencies] [account] [password]<br />
<br />
SimpleSC::InstallService &quot;TestService&quot; &quot;TestService&quot; &quot;16&quot; &quot;2&quot;\<br />
			 &quot;$INSTDIR\JavaService.jar&quot; &quot;&quot; &quot;&quot; &quot;&quot;<br />
    Pop $0 ; returns an errorcode (&lt;&gt;0) otherwise success (0)<br />
    detailprint $0<br />
<br />
# Start service<br />
SimpleSC::StartService &quot;TestService&quot;<br />
    Pop $0 ; returns an errorcode (&lt;&gt;0) otherwise success (0)<br />
    detailprint $0<br />
<br />
[B]&lt;/Script&gt;<br />
<br />
I dont understand what's wrong. Please help..<br />
<br />
Thank You,<br />
Janvi</div></div><hr />


<div class="post"><div class="posttop"><div class="username">janvi</div><div class="date">12th November 2009, 09:57</div></div><div class="posttext">Hi,<br />
<br />
Just some update.. I converted my JAR file into an exe using Jar2Exe tool. Now, using the same script I m able to run this exe as Windows Service. Any clue??<br />
<br />
Thank You,<br />
Janvi</div></div><hr />


<div class="post"><div class="posttop"><div class="username">janvi</div><div class="date">15th November 2009, 13:51</div></div><div class="posttext">Hi..<br />
Can anyone please guide me to solve the problem i'm facing?<br />
Any help will be greatly appreciated.<br />
<br />
Thank You,<br />
Janvi</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">15th November 2009, 14:08</div></div><div class="posttext">Since a service has to communicate with the OS (like &quot;I'm still running&quot;), I think it's not possible to install a jar file as service.<br />
<br />
See the following for more info / what you can try:<br />
<br />
http://edn.embarcadero.com/article/32068<br />
http://www.coderanch.com/t/429680/General-Computing/start-executable-jar-as-Windows</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yudyzhao</div><div class="date">4th February 2010, 17:15</div></div><div class="posttext">I has another issue with SimpleSC.dll. I installed the Unicode NSIS, then SimpleSC::ServiceIsRunning always return the service status is stopped (0) no matter my service is running or not.<br />
<br />
Speed78, is there Unicode SimpleSC plug-in available? So urgent need this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">4th February 2010, 20:13</div></div><div class="posttext">As far as I know SimpleSC is not available in Unicode.<br />
<br />
As a workaround to find if a service is running  you can use:   !include &quot;WordFunc.nsh&quot;<br />
   Var Service<br />
   .<br />
   .<br />
   .<br />
   ; inside function / section<br />
   StrCpy $Service &quot;ServiceName&quot;<br />
<br />
   Push &quot;ExecDos::End&quot; # Add a marker for the loop to test for.<br />
   ExecDos::exec /TIMEOUT=2000 /TOSTACK 'sc.exe query &quot;$Service&quot;' &quot;&quot; &quot;&quot;<br />
   Pop $0 # return value<br />
   StrCmp $0 0 0 NotRunning<br />
   ## Loop through stack.<br />
   StrCpy $2 0<br />
   Loop:<br />
      Pop $1<br />
      StrCmp $1 &quot;ExecDos::End&quot; ExitLoop<br />
      ${WordFind} &quot;$1&quot; &quot;RUNNING&quot; &quot;*&quot; $3<br />
      Intcmp $3 0 NotFound NotFound<br />
      IntOp $2 $2 + 1<br />
      NotFound:<br />
      StrCpy $3 &quot;0&quot;<br />
      Goto Loop<br />
   ExitLoop:<br />
   IntCmp $2 0 NotRunning NotRunning Running<br />
   NotRunning:<br />
      DetailPrint &quot;$Service is not running&quot;<br />
      Goto End<br />
   Running:<br />
      DetailPrint &quot;$Service is running&quot;<br />
      Goto End<br />
   End:Hope this helps.<br />
(The ExecDos plugin is available for unicode:<br />
http://forums.winamp.com/showthread.php?threadid=181442)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yudyzhao</div><div class="date">5th February 2010, 09:38</div></div><div class="posttext">Thanks for help. <br />
But ExceDos (Unicode version)cannot find the running windows service as well... no clue what wrong with it<br />
:eek:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">5th February 2010, 09:43</div></div><div class="posttext">OK.<br />
<br />
Well, I didn't test this in Unicode, but what's the output of ExecDos?<br />
(Add DetailPrint &quot;$1&quot; after Pop $1 in the loop to see what it is)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ebi70</div><div class="date">12th July 2010, 08:15</div></div><div class="posttext">Hello together, <br />
<br />
I have following problem with the simplesc plugin.<br />
I install my service with installutil of .net, because when I try to install with simplesc, then the services will hnot start, I think this is because that the dependencies are not correct updated.<br />
Anyway, when I install my service with installutil, update then the logon with:<br />
SimpleSC::SetServiceLogon &quot;&lt;name&gt;&quot; &quot;$USER_NAME&quot; &quot;$USER_PASSWORD&quot;<br />
<br />
everything works fine.<br />
Then I start my installer again and update my installation.<br />
Within the &quot;Function preuninstall_function&quot; i stop the services if they are running with:<br />
SimpleSC::StopService &quot;&lt;name&gt;&quot; <br />
and then remove the service with:<br />
SimpleSC::RemoveService &quot;&lt;name&gt;&quot; or again with <br />
installutil of .net (makes no sense what I use, the service is removed from the list), <br />
<br />
but when I now try to reinstall the service again in my Section like explained above, <br />
the service is installed, but the user update will fail:<br />
SimpleSC::SetServiceLogon &quot;&lt;name&gt;&quot; &quot;$USER_NAME&quot; &quot;$USER_PASSWORD&quot;<br />
<br />
Any ideas?<br />
Thanks,<br />
Ebi70</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">20th July 2010, 10:01</div></div><div class="posttext">Hello,<br />
<br />
sry for this answer-delay. I don't get any message that somebody posts in this thread and I don't know why :(.<br />
<br />
<br />
Hello together, <br />
<br />
I have following problem with the simplesc plugin.<br />
I install my service with installutil of .net, because when I try to install with simplesc, then the services will hnot start, I think this is because that the dependencies are not correct updated.<br />
<br />
<br />
<br />
1. Please post the sc.exe command and the SimpleSC::InstallService command which you are using.<br />
2. After using sc.exe and SimpleSC::InstallService, please check the dependencies in the Windows service manager.<br />
3. Please post the dependencies of your service.<br />
<br />
<br />
<br />
<br />
<br />
<br />
but when I now try to reinstall the service again in my Section like explained above, <br />
the service is installed, but the user update will fail:<br />
SimpleSC::SetServiceLogon &quot;&lt;name&gt;&quot; &quot;$USER_NAME&quot; &quot;$USER_PASSWORD&quot;<br />
<br />
<br />
Please use the GetErrorMessage Function to get the error. In the documentation you can find an example how to use it.<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">14th September 2010, 12:36</div></div><div class="posttext">Hi,<br />
<br />
I've released a new version of the NSIS Simple Service Plugin. There are two new functions SimpleSC::GetServiceFailure and SimpleSC::SetServiceFailure. The function SimpleSC::StopService has now an addional argument to wait for file release if you would overwrite the binary file.<br />
<br />
You can find more informations and download file on the wiki page (http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin).<br />
<br />
If you have any questions please let me now.<br />
<br />
Special thanks to Rogier for this great donation. He makes this changes possible.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mabian</div><div class="date">12th October 2010, 16:30</div></div><div class="posttext">Hello, I'm having problems with this plugin, 1.28.<br />
<br />
StrCpy $P_ServiceName &quot;EcoManager_$P_ServiceID&quot;<br />
SimpleSC::ExistsService &quot;$P_ServiceName&quot;<br />
Pop $0 ; returns an errorcode if the service doesn´t exists (&lt;&gt;0)/service exists (0)<br />
MessageBox MB_OK &quot;Servizio $P_ServiceName esiste? $0&quot;<br />
<br />
Even though the service name is built correctly and it doesn't exists, the messagebox says $0 value is 0.<br />
<br />
Maybe is it something about unicode (trying it on XP SP3)?<br />
<br />
Thank you,<br />
   Mario</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">12th October 2010, 17:26</div></div><div class="posttext">Dear mabian,<br />
<br />
if your service name contains Unicode characters you will get problems. This version of the service plugin doesn't support Unicode.<br />
<br />
1. Please enter SimpleSC::ExistsService your service name and don't use a variable (only for testing).<br />
2. Try to use the ExistsService-Method with an other service. If this works I asume that it depends on your servicename + Unicode.<br />
3. Please use the GetErrorMessage Method to get error text.<br />
<br />
Please let me know your results.<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mabian</div><div class="date">12th October 2010, 17:48</div></div><div class="posttext">This fragment:<br />
<br />
	SimpleSC::ExistsService &quot;Dnscache&quot;<br />
	Pop $0 ; returns an errorcode if the service doesn´t exists (&lt;&gt;0)/service exists (0)<br />
	MessageBox MB_OK &quot;$0&quot;    <br />
        Push $0<br />
        SimpleSC::GetErrorMessage<br />
        Pop $0<br />
        MessageBox MB_OK|MB_ICONSTOP &quot;Message: $0&quot;<br />
<br />
Produces a few japanese chars in the first message box and a longer japanese/chinese string in the second...<br />
<br />
- Mario<br />
<br />
Same with an unexisting service name.<br />
<br />
Thanks,<br />
    Mario</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">12th October 2010, 18:35</div></div><div class="posttext">Dear mabian,<br />
<br />
you can only use GetErrorMessage if an error exists e.g.<br />
<br />
  <br />
  SimpleSC::ExistsService &quot;Dnscache&quot;<br />
    Pop $0 ; returns an errorcode if the service doesn´t exists (&lt;&gt;0)/service exists (0)<br />
    MessageBox MB_OK &quot;$0&quot;<br />
    IntCmp $0 0 Done +1 +1<br />
        Push $0<br />
        SimpleSC::GetErrorMessage<br />
        Pop $0<br />
        MessageBox MB_OK|MB_ICONSTOP &quot;Message: $0&quot;<br />
<br />
  Done:<br />
<br />
<br />
nethertheless this is not the problem. Are you using the Unicode-Version of NSIS? If yes please try it with the Non-Unicode. I just tried it with the Non-Unicode Version of NSIS and it works for me.<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mabian</div><div class="date">12th October 2010, 21:50</div></div><div class="posttext">Confirmed: the ANSI version of NSIS works as expected.<br />
<br />
I thought the dll would work with Unicode NSIS as long as no unicode strings were used.<br />
<br />
Thank you very much!<br />
<br />
- Mario</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nv_rajanikanth</div><div class="date">13th October 2010, 12:17</div></div><div class="posttext">Hi <br />
Thanks for this plug-in. Now i am able to install/start/stop...of 'my service' through this.<br />
but i am not able to see this in the 'services.msc'. <br />
please let me know how to list this 'my service' into 'services.msc', so that later on i can stop/start/restart manually.<br />
<br />
Thanks,<br />
Rajanikanth</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">13th October 2010, 13:44</div></div><div class="posttext">Dear Rajanikanth,<br />
<br />
if you can install/start/stop the service your service should be displayed in the ServiceManager (services.msc) or I don't understand you correctly!?<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mabian</div><div class="date">13th October 2010, 13:57</div></div><div class="posttext">Rajanikanth,<br />
<br />
if you have services.msc already open while the installer adds the service, you have to press F5 to make it update the service list.<br />
<br />
Installing a service adds it to the list here.<br />
<br />
- Mario</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hnedka</div><div class="date">22nd December 2010, 17:53</div></div><div class="posttext">Hi, I have created a workaround to make it work with Unicode. You first need to enter this into your code:<br />
<br />
!define Unicode2Ansi &quot;!insertmacro Unicode2Ansi&quot;<br />
<br />
!macro Unicode2Ansi String outVar<br />
  System::Call 'kernel32::WideCharToMultiByte(i 0, i 0, w &quot;${String}&quot;, i -1, t .s, i ${NSIS_MAX_STRLEN}, i 0, i 0) i'<br />
  Pop &quot;${outVar}&quot;<br />
!macroend<br />
<br />
And then you call SimpleSC functions like this:<br />
${Unicode2Ansi} &quot;my_service_short_name&quot; $R0<br />
SimpleSC::StopService &quot;$R0&quot; 0<br />
Pop $0<br />
<br />
It will obviously not work with chars, that are really Unicode (like Chinese) and probably also with everything non-english or non-local-language, but in standard situations, it should work. If there are any problems, let me know in this thread.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">16th April 2011, 15:56</div></div><div class="posttext">Hi,<br />
<br />
I've released a new version of the NSIS Simple Service Plugin. There are four new functions:<br />
<br />
- GetServiceFailureFlag <br />
- SetServiceFailureFlag <br />
- GetServiceDelayedAutoStartInfo <br />
- SetServiceDelayedAutoStartInfo <br />
<br />
You can find more informations and download file on the wiki page (http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin).<br />
<br />
If you have any questions please let me now.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th June 2011, 18:08</div></div><div class="posttext">SimpleSC checks whether the service is stopped before calling DeleteService. This is fine in normal circumstances, but some services cannot be stopped (they have no handler). I'd rather SimpleSC just went ahead and called DeleteService anyway, where in such cases the service will be deleted on reboot (i.e. DeleteService returns 1072). If you don't want to change the current behaviour, at least add a /force switch or something which ignores the state of the service.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">19th June 2011, 21:10</div></div><div class="posttext">Hey Stu,<br />
<br />
I think the best way is to do it like windows does it in the &quot;sc delete&quot; command. Therefore I will remove the &quot;Stopped&quot;-check in the code. I will change it within the next week.<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rijukk</div><div class="date">6th July 2011, 13:25</div></div><div class="posttext">Hi Rainer,<br />
<br />
<br />
I've released a new version of the NSIS Simple Service Plugin. There are two new functions SimpleSC::GetServiceFailure and SimpleSC::SetServiceFailure. The function SimpleSC::StopService has now an addional argument to wait for file release if you would overwrite the binary file.<br />
<br />
<br />
As you said, I used SimpleSC::StopService with &quot;wait_for_file_release&quot; flag, since i need to overwrite the binary file.<br />
<br />
Sometimes our services take longer time,&gt;30sec, to stop in that case <br />
SimpleSC::StopService &quot;&lt;My Service Name&gt;&quot; 1<br />
Will return with an error# 1053  (The service did not respond to the start or control request in a timely fashion).<br />
<br />
<br />
Currently I am over coming this using loop and check status logic. below is my code snippet  <br />
<br />
<br />
<br />
	SimpleSC::StopService &quot;&lt;My Service Name&gt;&quot; 1<br />
	; My service take more than 30sec to stop sometimes since it is doing some file processing<br />
        Pop $0<br />
	;&quot;1053 error (The service did not respond to the start or control request in a timely fashion)<br />
   	Goto CheckServiceStateNoSleep<br />
  LoopAgain:<br />
	DetailPrint &quot;Waiting for service to stop...&quot;<br />
        Sleep 2000<br />
  CheckServiceStateNoSleep:<br />
         SimpleSC::GetServiceStatus &quot;&lt;My Service Name&gt;&quot;<br />
         Pop $0<br />
         Pop $1<br />
         IntCmp $1 1 ServiceStopped LoopAgain LoopAgain<br />
  ServiceStopped:<br />
         ;Service Exe replacement step here<br />
<br />
<br />
Is there any better alternatives?<br />
<br />
Thank you,<br />
Riju</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">7th July 2011, 17:30</div></div><div class="posttext">Hi Riju,<br />
<br />
if your service need more than 30 seconds I think you are using the registry setting ServicePipeTimeout!? Otherwise you should get a windows message e.g. if you are stopping the service via Service Manager.<br />
<br />
So I can do the following:<br />
<br />
1. I can wait until the service controller gave me the result information after an action (e.g. stopped, timeout, etc.). The disadvantage can be that I'm waiting forever and the setup seems to hang.<br />
<br />
2. I can add a wait timeout parameter in the function. The disadvantage is that the timeout doesn't depend on the windows timeout.<br />
<br />
However, I think I need to check it and I will try to change it within the next release. I have another task on my todo list for Stu, but at the moment my work in the company is very stressful. Therefore it can take a time.<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rijukk</div><div class="date">8th July 2011, 04:18</div></div><div class="posttext">Hi Rainer,<br />
<br />
I appreciate you for taking time from your busy schedule to reply our queries.. Thank you!!<br />
<br />
<br />
<br />
So I can do the following:<br />
<br />
1. I can wait until the service controller gave me the result information after an action (e.g. stopped, timeout, etc.). The disadvantage can be that I'm waiting forever and the setup seems to hang.<br />
<br />
2. I can add a wait timeout parameter in the function. The disadvantage is that the timeout doesn't depend on the windows timeout.<br />
<br />
<br />
<br />
I think, wait timeout parameter in the function will do the trick. If timeout is 0, it will wait till the service stop properly.<br />
<br />
I see it rather an advantage than a disadvantage, In a sense you are providing an optional parameter to override the default windows timeout. That is always an advantage :)  <br />
<br />
Thank you very much,<br />
Riju</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">16th July 2011, 11:59</div></div><div class="posttext">@ZvyaginzevaE:<br />
Googled what you're looking for and seems it can be obtained easily. But you completely missed the forum, this one has nothing to do with cars.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">28th July 2011, 19:15</div></div><div class="posttext">Dear all,<br />
<br />
in the attachment you can find a Beta version of the new NSIS plugin. This version contains these new functions:<br />
<br />
The following functions got a new &quot;Timeout&quot; parameter:<br />
<br />
<br />
 SimpleSC::StartService<br />
 SimpleSC::StopService<br />
 SimpleSC::PauseService<br />
 SimpleSC::ContinueService<br />
 SimpleSC::RestartService<br />
<br />
<br />
The function SimpleSC::RemoveService doesn't stop the service now. If you need this functions please use the SimpleSC::StopService before you remove the service.<br />
<br />
It would be great if you can check this new version. Any feedback will be welcome.<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">15th August 2011, 22:13</div></div><div class="posttext">Dear all,<br />
<br />
no news are good news. Therefore I released a new version of the NSIS Simple Service Plugin. <br />
<br />
There are four new functions:<br />
<br />
 The function SimpleSC::RemoveService doesn't stop the service now. If you need this functions please use the SimpleSC::StopService before you remove the service.<br />
 The following functions got a new &quot;Timeout&quot; parameter:<br />
<br />
 SimpleSC::StartService<br />
 SimpleSC::StopService<br />
 SimpleSC::PauseService<br />
 SimpleSC::ContinueService<br />
 SimpleSC::RestartService<br />
<br />
<br />
<br />
You can find more informations and download file on the wiki page (http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin).<br />
<br />
If you have any questions please let me now.<br />
<br />
Best regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rijukk</div><div class="date">21st September 2011, 12:52</div></div><div class="posttext">Hi Rainer,<br />
<br />
I really appreciate you for coming up with &quot;timeout parameter&quot; as requested. However I am sorry, currently I am away from the installer project; hoping to back soon too. I will definitely do my aprt of testing and let you know my experience. <br />
<br />
btw, is there any infinite timeout value like &quot;-1&quot; or &quot;0&quot;?<br />
<br />
Thank you,<br />
Riju</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sr164w</div><div class="date">18th January 2012, 08:25</div></div><div class="posttext">Can I use this plugin in for commercial use of my installer:confused:?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">19th January 2012, 06:22</div></div><div class="posttext">By default all plug-ins can be used in commercial installers.<br />
If it is not strictly prohibited in plug-in readme then feel free to use it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dixonich</div><div class="date">10th December 2012, 10:44</div></div><div class="posttext">Hello! My problem. Services plug-in not work! Help please!Service does not start!<br />
<br />
!define PRODUCT_NAME &quot;MyApp&quot; <br />
!define PRODUCT_VERSION &quot;19&quot; <br />
!define pkgdir &quot;C:\Swe&quot; <br />
<br />
!include &quot;MUI.nsh&quot; <br />
SetCompressor /SOLID lzma <br />
<br />
!define MUI_ABORTWARNING <br />
!insertmacro MUI_PAGE_FINISH <br />
!insertmacro MUI_LANGUAGE &quot;Russian&quot; <br />
<br />
Name &quot;${PRODUCT_NAME}&quot; <br />
Caption &quot;Установка ${PRODUCT_NAME} ${PRODUCT_VERSION}&quot; <br />
OutFile &quot;${PRODUCT_NAME}-${PRODUCT_VERSION}.exe&quot; <br />
ShowInstDetails show <br />
<br />
Section <br />
SetOutPath &quot;C:\&quot; <br />
<br />
File &quot;${pkgdir}\SystemTrayDemo.exe&quot; <br />
<br />
SimpleSC::InstallService &quot;ServiceStartD&quot; &quot;Testing123D&quot; &quot;16&quot; &quot;2&quot; &quot;C:\SystemTrayDemo.exe&quot;  &quot;&quot; &quot;&quot; &quot;&quot;<br />
SimpleSC::StartService &quot;ServiceStartD&quot; &quot;&quot; 30<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">10th December 2012, 15:01</div></div><div class="posttext">Can you start it if you run services.msc (Computer management)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Speed78</div><div class="date">10th December 2012, 19:23</div></div><div class="posttext">Hello! My problem. Services plug-in not work! Help please!Service does not start!<br />
<br />
!define PRODUCT_NAME &quot;MyApp&quot; <br />
!define PRODUCT_VERSION &quot;19&quot; <br />
!define pkgdir &quot;C:\Swe&quot; <br />
<br />
!include &quot;MUI.nsh&quot; <br />
SetCompressor /SOLID lzma <br />
<br />
!define MUI_ABORTWARNING <br />
!insertmacro MUI_PAGE_FINISH <br />
!insertmacro MUI_LANGUAGE &quot;Russian&quot; <br />
<br />
Name &quot;${PRODUCT_NAME}&quot; <br />
Caption &quot;Установка ${PRODUCT_NAME} ${PRODUCT_VERSION}&quot; <br />
OutFile &quot;${PRODUCT_NAME}-${PRODUCT_VERSION}.exe&quot; <br />
ShowInstDetails show <br />
<br />
Section <br />
SetOutPath &quot;C:\&quot; <br />
<br />
File &quot;${pkgdir}\SystemTrayDemo.exe&quot; <br />
<br />
SimpleSC::InstallService &quot;ServiceStartD&quot; &quot;Testing123D&quot; &quot;16&quot; &quot;2&quot; &quot;C:\SystemTrayDemo.exe&quot;  &quot;&quot; &quot;&quot; &quot;&quot;<br />
SimpleSC::StartService &quot;ServiceStartD&quot; &quot;&quot; 30<br />
SectionEnd<br />
<br />
<br />
Which error mesage do you got (GetErrorMessage)? Are you using the unicode version of NSIS?<br />
<br />
Kind regards<br />
<br />
Rainer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nuoyantaizi</div><div class="date">6th October 2013, 08:34</div></div><div class="posttext">Hi,Speed78<br />
Nice to meet you.I have a problem when use NSIS Simple Service Plugin to install a windows service named &quot;Apache&quot;.<br />
When i use &quot;SimpleSC::InstallService ....&quot; ,the service is installed ok,but it can not start,the error is &quot;required components not installed&quot;.<br />
I have a try to use &quot;apache/bin/httpd -k install&quot;,i saw the dependences are &quot;AFD&quot;,and &quot;TCP/IP Protocal Driver / IPSEC driver&quot;.<br />
So,how can i use simplesc to install this apache ?<br />
<br />
By the way,StartSercie,StopService need 30 seconds,that's so long! My production need to install 4 service on user's computer,so that's need too much time! Can you tell me if the SimpleSC can do this like &quot;sc start httpd&quot;,&quot;sc stop httpd&quot; ?<br />
<br />
Best Regards<br />
From your chinese friend :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">7th October 2013, 23:45</div></div><div class="posttext">When i use &quot;SimpleSC::InstallService ....&quot; ,the service is installed ok,but it can not start,the error is &quot;required components not installed&quot;.<br />
I have a try to use &quot;apache/bin/httpd -k install&quot;,i saw the dependences are &quot;AFD&quot;,and &quot;TCP/IP Protocal Driver / IPSEC driver&quot;.<br />
So,how can i use simplesc to install this apache ?Use &quot;AFD/IPSec/Tcpip&quot; as dependencies in the InstallService command (see http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nuoyantaizi</div><div class="date">10th October 2013, 15:28</div></div><div class="posttext">Use &quot;AFD/IPSec/Tcpip&quot; as dependencies in the InstallService command (see http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin)<br />
<br />
To jpderuiter,<br />
thank you very much! <br />
<br />
I have a try what you said,the dependences are installed successfully! thanks again!<br />
But tha apache software can not start yet.i don't know why,i think the software has its own process when use &quot;-k install&quot;.but i still thanks you told me how to use the dependence parameter:)<br />
<br />
Another question,do you know how to install a .NET service except using &quot;installutil.exe&quot; ?<br />
I have a .exe that developed by .net framework 4.0,i try to use SimpleSC to install ,and i failed,i must to use the .NET install tool &quot;installutil.exe&quot; to install it.<br />
<br />
Ah,do you understand what i said ? :) ,i am sorry about my english.<br />
<br />
but,all of these are ok! i have write a .exe instead of that one.<br />
<br />
Thanks again!<br />
<br />
i have to improve my english now ,today i met a German teacher,thanks to God,there is a senior student there ,and she can speak german very well~:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th October 2013, 17:00</div></div><div class="posttext">You only need to use installutil.exe if the .NET service uses the ServiceInstaller/ServiceProcessInstaller classes to define its install configuration. If you just create the service and only extend the ServiceBase class then you can install it using the normal Windows APIs (i.e. SimpleSC will work).<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>