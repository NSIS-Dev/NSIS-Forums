<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Two plugins, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Two plugins NSIS Discussion" />
	
	<title> Two plugins [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Two plugins</div>
<hr />
<div class="pda"><a href="t-242176.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=242176">Two plugins</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th March 2006, 17:51</div></div><div class="posttext">Just so that people know that they exist, I've uploaded two plugins.<br />
<br />
EmbeddedLists.dll (http://nsis.sf.net/File:EmbeddedLists.zip)<br />
This displays a single selection, multiple selection or columned list box (with column headings and optional check boxes). The plugin takes its list box items from the NSIS stack. I wrote this plugin as even with the makensis 8192 string length build I felt it was unsafe when having a large number of list box items for InstallOptions list boxes (from an Internet source).<br />
<br />
ButtonEvent.dll (http://nsis.sf.net/File:ButtonEvent.zip)<br />
A small 3KB dll that allows you to catch click events of any custom buttons on any NSIS dialogs. The buttons must be added  to the UI files with Resource Hacker. The example included makes use of a custom button on the parent window (alongside the Next and Back buttons) and one on the Components page.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">30th March 2006, 20:51</div></div><div class="posttext">Hi Stu,<br />
this ButtonEvent sounds like something was really missed!<br />
It is that what I was looking for to figure some actions I have in my mind, yet, I was not able to find such code or to write one by my self.<br />
Next, I'll check it deeply to find out how it works, thus where and how it will assists me.<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">31st March 2006, 08:16</div></div><div class="posttext">Well basically you just need to add a button with Resource Hacker and give it a unique ID number.<br />
If the button is on the parent dialog (105) then call the AddEventHandler function in .onGUIInit. If the button is on a child form (inner dialog) then call it in the pages' Show function.<br />
<br />
With this accomplished, the buttons will act the same as the user clicking &quot;Next&quot; except an internal flag is set showing that the user in fact clicked on one of the custom buttons.<br />
<br />
For custom buttons on the parent dialog, the WhichButtonID function should be called in all pages' Leave functions (to catch the click event for all pages of the installer).<br />
For individual pages, the WhichButtonID only needs to be called for that pages' Leave function.<br />
<br />
Hope that helps.<br />
The example script displays this, but in script form.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">{_trueparuex^}</div><div class="date">1st April 2006, 13:00</div></div><div class="posttext">The example of EmbeddedLists.dll caused the installer to crash, but it was one time crash only. It crashed after I clicked next button on the multi column page, but I am not sure about that. It might have been when initializing the check box page too.<br />
<br />
My os is windows 2000</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st April 2006, 14:45</div></div><div class="posttext">Do you have .NET Framework 1.1 installed? The plugin was written under MS VS.NET, but works fine on a Windows XP machine without .NET Framework installed. I don't have a Windows 2000 machine anymore either.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">{_trueparuex^}</div><div class="date">1st April 2006, 18:29</div></div><div class="posttext">I avoid .NET Framework like the plague. So no, I don't have .NET Framework installed. ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st April 2006, 18:37</div></div><div class="posttext">I'll recompile it in C++6 tomorrow and I'll post here.<br />
How often does it crash? Have you been able to get it to crash again?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">{_trueparuex^}</div><div class="date">2nd April 2006, 11:44</div></div><div class="posttext">Yes actually I just got it to crash again. And I think I even can reproduce the crash. This time it crashed when I clicked the close button in the Installion complete page. This makes me wonder, maybe I used the cancel button instead of next button when it crashed last time. (I really should pay more attention while testing these things :rolleyes: )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd April 2006, 21:56</div></div><div class="posttext">Hello.<br />
I was able to recompile the plugin under VC++6 with minor changes. One thing that could be causing the crash (but I doubt it) is that the ListView_SetCheckState macro was undefined for VC++6 when MSDN said that it is defined from Windows 95 and upwards (with IE3+ installed). However, the compiler said otherwise.<br />
<br />
If you could re-download from the same URL and try it out I'd be very greatful. If my assumptions are correct then I'll have to avoid using VS.NET for plugin work.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zeeh3</div><div class="date">3rd April 2006, 12:21</div></div><div class="posttext">Hi Stu, I have a question for you. Can EmbeddedLists.dll be used with installoptions' custom page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">3rd April 2006, 12:28</div></div><div class="posttext">These look cool! I don't quite understand the difference between your ButtonEvent and just using the NOTIFY flag on a custom button with appropriate exit code. I haven't looked at it, only at your description.<br />
<br />
I point this out because in the future when people are searching the wiki, it would be worth having a clear explanation :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd April 2006, 15:28</div></div><div class="posttext">The explanation is pretty clear. You can't place a button on an existing NSIS dialog with InstallOptions. Adding it with ResourceHacker is the only way, and then it doesn't actually do anything when you click on it. This is where the ButtonEvent plugin comes in.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd April 2006, 15:30</div></div><div class="posttext">zeeh3: If you want to display a list box on an InstallOptions dialog, use Type=ListBox. Note that this is a basic control without the additional features that a ListView control has (multiple columns and column headings).<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">{_trueparuex^}</div><div class="date">3rd April 2006, 19:33</div></div><div class="posttext">Sorry to say, but it still crashes. Now it crashed just like the first crash. So I guess that was right after all.<br />
<br />
Is anyone else having problems with this plugin?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">3rd April 2006, 21:31</div></div><div class="posttext">Interesting. I'll have a good look at the code tomorrow.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">3rd April 2006, 23:44</div></div><div class="posttext">The Embedded Lists functionality can be achieved using InstallOptions and System plugins.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">4th April 2006, 09:00</div></div><div class="posttext">I would love to see the code to add a SysListView32 control :]<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">4th April 2006, 12:49</div></div><div class="posttext">It would be complex, but the System plugin is very powerful. Pretty much any Windows API can be invoked using it.<br />
Right now I don't have the time, but maybe later I could look at it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zeeh3</div><div class="date">4th April 2006, 15:19</div></div><div class="posttext">Originally posted by Afrow UK <br />
zeeh3: If you want to display a list box on an InstallOptions dialog, use Type=ListBox. Note that this is a basic control without the additional features that a ListView control has (multiple columns and column headings).<br />
<br />
-Stu  <br />
<br />
I know that :)<br />
I was just asking for an enhaced Listbox using your plugin with custom pages.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">4th April 2006, 17:16</div></div><div class="posttext">I'm not sure what InstallOptionsEx has, but you can check that out (forum search).<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SimonSez07</div><div class="date">11th April 2006, 22:55</div></div><div class="posttext">how can i hide my custom button (placed where your &quot;Try Me&quot; button is on the example) for all pages after the welcome page? i only want the button to be pressable on the welcome page.<br />
<br />
also trying to abort the installation after the button is pressed (after the button does its purpose, of course)<br />
<br />
(thx for your plug-in stu)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">11th April 2006, 23:01</div></div><div class="posttext">Use Quit to close the installer. Abort when called in any pages' Leave function will just return the user back to the page.<br />
<br />
To hide the button for all other pages; in their Show functions use:<br />
<br />
GetDlgItem $R0 $HWNDPARENT id_num<br />
ShowWindow $R0 ${SW_HIDE}<br />
<br />
For the page for it to be shown on; use ${SW_SHOW} instead of ${SW_HIDE}. id_num is your button control ID defined through Resource Hacker.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rmccue</div><div class="date">12th April 2006, 01:22</div></div><div class="posttext">Can I use ButtonEvent to catch clicks on the minimize/maximize/close buttons? Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th April 2006, 11:11</div></div><div class="posttext">Hmm no I never thought of that :)<br />
I should be able to add support for it if you want?<br />
<br />
Edit: Well only the minimise and close buttons are usable, but the close button is the same as clicking on Cancel (MUI_CUSTOMFUNCTION_ABORT is called). As for minimise what would you want to do there?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rmccue</div><div class="date">13th April 2006, 22:46</div></div><div class="posttext">Well,<br />
I was thinking that it might help me with using Wansis and TrayIcon together.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th April 2006, 23:28</div></div><div class="posttext">So you'd like to call a function when the program is minimised or maximised?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rmccue</div><div class="date">15th April 2006, 01:08</div></div><div class="posttext">I was thinking that. But whenever you click the Tray Icon to minimize/maximize, it would call the function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th April 2006, 10:13</div></div><div class="posttext">That would need to be a modification to the NotifyIcon plugin.<br />
I'll see what I can do.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th April 2006, 11:26</div></div><div class="posttext">Done.<br />
http://nsis.sourceforge.net/File:NotifyIcon.zip<br />
<br />
Check Examples\NotifyIcon folder.<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>