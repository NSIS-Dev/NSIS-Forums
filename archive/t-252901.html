<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" API SetComputerName, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  API SetComputerName NSIS Discussion" />
	
	<title> API SetComputerName [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  API SetComputerName</div>
<hr />
<div class="pda"><a href="t-252901.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=252901">API SetComputerName</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">The Glimmerman</div><div class="date">9th August 2006, 12:05</div></div><div class="posttext">I want to set my computername with an api call.<br />
<br />
StrCpy $ComputerName &quot;TestName&quot;<br />
System::Call 'kernel32.dll::SetComputerName???(t &quot;$ComputerName&quot;) i .r0'<br />
I tried SetComputerName, SetComputerNameA, SetComputerNameEx, SetComputerNameExw.<br />
If I use<br />
<br />
System::Call 'kernel32.dll::SetComputerName(t &quot;$ComputerName&quot;) i .r0'<br />
The Computername is inserted in the registry, but the name isn't changed.<br />
<br />
I read on <br />
MSDN (http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sysinfo/base/setcomputernameex.asp) something about COMPUTER_NAME_FORMAT (http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sysinfo/base/computer_name_format_str.asp) <br />
I think i'm missing something.<br />
<br />
Hope that someone can help me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">9th August 2006, 15:12</div></div><div class="posttext">I think i'm missing something.<br />
<br />
Awnser<br />
<br />
MSDN something about COMPUTER_NAME_FORMAT <br />
<br />
You can see that the function need 2 params and you are using one, right?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">The Glimmerman</div><div class="date">9th August 2006, 15:42</div></div><div class="posttext">I know.<br />
But how do i define that.<br />
<br />
I tried several things like<br />
<br />
SetComputerName(t &quot;ComputerNamePhysicalDnsHostname&quot; , t &quot;$ComputerName&quot;) i .r0'<br />
<br />
SetComputerName(${ComputerNamePhysicalDnsHostname} , t &quot;$ComputerName&quot;) i .r0'<br />
<br />
<br />
But that doesn't work.<br />
<br />
$0 gives an error</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th August 2006, 17:04</div></div><div class="posttext">I'm guessing that this will work:<br />
SetComputerName(i 5 , t &quot;$ComputerName&quot;) i .r0'<br />
COMPUTER_NAME_FORMAT is an enumeration, and ComputerNamePhysicalDnsHostname is the 6th item.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CancerFace</div><div class="date">10th August 2006, 08:19</div></div><div class="posttext">Afrow UK is right, it is an enumeration:<br />
# ComputerNameNetBIOS 0<br />
# ComputerNameDnsHostname 1<br />
# ComputerNameDnsDomain 2<br />
# ComputerNameDnsFullyQualified 3<br />
# ComputerNamePhysicalNetBIOS 4<br />
# ComputerNamePhysicalDnsHostname 5<br />
# ComputerNamePhysicalDnsDomain 6<br />
# ComputerNamePhysicalDnsFullyQualified 7<br />
Better use SetComputerNameEx (http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sysinfo/base/setcomputernameex.asp). Try to set with ComputerNamePhysicalNetBIOS and  ComputerNamePhysicalDnsHostname. If you get an error then use SetComputerName. Something like this:...<br />
System::Call 'kernel32.dll::SetComputerNameExA(i 4,t &quot;$ComputerName&quot;)i.r1'<br />
System::Call 'kernel32.dll::SetComputerNameExA(i 5,t &quot;$ComputerName&quot;)i.r1'<br />
StrCmp $1 0 +1 +2<br />
System::Call 'kernel32.dll::SetComputerNameA(t &quot;$ComputerName&quot;)i .r1'<br />
...<br />
The above code was generated from the example shown here (http://www.vbfrance.com/codes/CHANGE-LE-NOM-DE-L-ORDINATEUR-SOUS-WINDOWS-2000-ET-XP/27725.aspx).<br />
CF</div></div><hr />


<div class="post"><div class="posttop"><div class="username">The Glimmerman</div><div class="date">10th August 2006, 12:47</div></div><div class="posttext">System::Call 'kernel32.dll::SetComputerNameExA(i 5,t &quot;$ComputerName&quot;)i.r1'<br />
<br />
<br />
This one works.<br />
thx</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>