<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installer for Firefox Toolbar, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installer for Firefox Toolbar NSIS Discussion" />
	
	<title> Installer for Firefox Toolbar [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installer for Firefox Toolbar</div>
<hr />
<div class="pda"><a href="t-246764.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246764">Installer for Firefox Toolbar</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">22nd May 2006, 19:27</div></div><div class="posttext">Hi Friends!<br />
 I have made an toolbar extension for firefox, and i want to make a installer for it, now my back end is in MySQL and toolbar is coded in JS and XUL now as you might know firefox extensions are installed by opening firefox and then opening the .xpi file with firefox to install it, now how do i make firefox launch from NSIS intaller and let it open .xpi file which would install the toolbar for me. also how would i include the MySQL database files in the installer.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">22nd May 2006, 19:54</div></div><div class="posttext">You may want to take a look here (http://forums.winamp.com/showthread.php?threadid=246301)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">22nd May 2006, 20:42</div></div><div class="posttext">Thnks Red wine, but still i am in a dilemma of how to install my MySQL database on the users machine so that the toolbar is able to call the database.<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">22nd May 2006, 20:53</div></div><div class="posttext">how to install my MySQL database... <br />
I'd suggest forum and wiki search :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">23rd May 2006, 02:26</div></div><div class="posttext">Hey thanks... :)))<br />
but do i need to install MySQL on target machines or just my MySQL file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">23rd May 2006, 08:32</div></div><div class="posttext">I'd be surprised if you needed to include the database with the installer; why not let users set it up themselves? They may even already have a copy installed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">23rd May 2006, 14:35</div></div><div class="posttext">Hi Rob!<br />
so it means that if they dont have MySQL on their machines, i should give them a message to install MySQL first on their machines and then put up my database files in the installer? or i should make a execwait from the installer to install MySQL on their machines, but that brings up the issues of passwords etc for MySQL.<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">23rd May 2006, 15:01</div></div><div class="posttext">Well I don't know the details of your situation, but I'd be tempted to just say, &quot;This needs MySQL, install it before you run this installer.&quot; Just offload it to the user :)<br />
<br />
But your application's raison d'etre may be having MySQL included. It's a management decision :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">23rd May 2006, 18:01</div></div><div class="posttext">Thanksss Rob!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">23rd May 2006, 20:53</div></div><div class="posttext">Hi!<br />
here is my script but is not launching Firefox and hence the .xpi is not installed, pls help me correct it. <br />
Thanks.<br />
!define APPNAME &quot;NetTrust&quot;<br />
!define APPNAMEANDVERSION &quot;NetTrust 1.0.&quot;<br />
<br />
Name &quot;${APPNAMEANDVERSION}&quot;<br />
OutFile &quot;NetTrustSetup.exe&quot;<br />
BrandingText &quot;NetTrust&quot;<br />
<br />
;Flags<br />
XPStyle on<br />
!include &quot;MUI.nsh&quot;<br />
<br />
!define MUI_ABORTWARNING<br />
<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_LICENSE &quot;license.txt&quot;<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
!insertmacro MUI_PAGE_INSTFILES<br />
;page custom Dotnet,DirectX<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
<br />
!insertmacro MUI_UNPAGE_WELCOME<br />
!insertmacro MUI_UNPAGE_CONFIRM<br />
!insertmacro MUI_UNPAGE_INSTFILES<br />
!insertmacro MUI_UNPAGE_FINISH<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
!insertmacro MUI_RESERVEFILE_LANGDLL<br />
<br />
<br />
;Set the default Installation Directory<br />
InstallDir &quot;$PROGRAMFILES\Nettrust&quot;<br />
<br />
Function .onInit<br />
MessageBox MB_YESNO &quot;This will install NetTrust on your System. Do you wish to continue?&quot; IDYES true<br />
Abort<br />
<br />
true:<br />
<br />
ReadRegStr $1 HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\firefox.exe&quot; &quot;&quot;<br />
StrCmp $1 &quot;&quot; NoFireFox ok<br />
<br />
NoFireFox:<br />
MessageBox MB_OK|MB_ICONSTOP &quot;FireFox wasn't found on your system, Please install the latest version of Firefox from http://www.mozilla.com/firefox. Setup will now Exit.&quot;<br />
Abort<br />
<br />
ok:<br />
<br />
!insertmacro MUI_LANGDLL_DISPLAY<br />
<br />
InitPluginsDir<br />
<br />
functionend<br />
<br />
Section &quot;NetTrust&quot; Section1; <br />
<br />
; Set output path to the installation directory. Also sets the working<br />
; directory for shortcuts<br />
SetOutPath $INSTDIR\<br />
<br />
nsExec::Exec '&quot;C:\Program Files\Mozilla Firefox\firefox.exe&quot; -install-global-extension &quot;nt.xpi&quot;'<br />
<br />
<br />
File nt.exe<br />
File readme.txt<br />
<br />
<br />
WriteUninstaller $INSTDIR\UninstallNetTrust.exe<br />
<br />
; // CREATE SHORT CUTS <br />
<br />
CreateShortCut &quot;$DESKTOP\NetTrust.lnk&quot; &quot;$INSTDIR\nt.exe&quot;<br />
CreateDirectory &quot;$SMPROGRAMS\NetTrust&quot;<br />
CreateShortCut &quot;$SMPROGRAMS\NetTrust\Run NetTrust.lnk&quot; &quot;$INSTDIR\nt.exe&quot;<br />
CreateShortCut &quot;$SMPROGRAMS\NetTrust\Uninstall NetTrust.lnk&quot; &quot;$INSTDIR\UninstallNetTrust.exe&quot;<br />
<br />
; // END CREATING SHORTCUTS  <br />
<br />
; //CREATE REGISTRY KEYS FOR ADD/REMOVE PROGRAMS IN CONTROL PANEL <br />
<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust&quot; &quot;NetTrust&quot;\<br />
&quot;NetTrust (remove only)&quot;<br />
<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust&quot; &quot;UninstallString&quot; \<br />
&quot;$INSTDIR\UninstallNetTrust.exe&quot;<br />
<br />
; // END CREATING REGISTRY KEYS <br />
<br />
MessageBox MB_OK &quot;NetTrust was successfully installed on your Computer.&quot;<br />
<br />
SectionEnd<br />
<br />
<br />
<br />
Section &quot;Uninstall&quot;<br />
; remove all the files and folders<br />
Delete $INSTDIR\UninstallNetTrust.exe ; delete self<br />
Delete $INSTDIR\nt.xpi<br />
Delete $INSTDIR\nt.exe<br />
Delete $INSTDIR\readme.txt<br />
<br />
<br />
RMDir $INSTDIR<br />
<br />
; now remove all the startmenu links<br />
Delete &quot;$SMPROGRAMS\NetTrust\Run NetTrust.lnk&quot;<br />
Delete &quot;$SMPROGRAMS\NetTrust\Uninstall NetTrust.lnk&quot;<br />
RMDIR &quot;$SMPROGRAMS\NetTrust&quot;<br />
<br />
; Now delete registry keys<br />
DeleteRegKey HKEY_LOCAL_MACHINE &quot;SOFTWARE\NetTrust&quot;<br />
DeleteRegKey HKEY_LOCAL_MACHINE &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust&quot;<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">24th May 2006, 00:22</div></div><div class="posttext">This line:<br />
<br />
nsExec::Exec '&quot;C:\Program Files\Mozilla Firefox\firefox.exe&quot; -install-global-extension &quot;nt.xpi&quot;'<br />
<br />
should actually have the value you pulled from the registry, not referring to an absolute path.<br />
<br />
nsExec::Exec '&quot;$0&quot; -install-global-extension &quot;nt.xpi&quot;'<br />
or<br />
nsExec::Exec '&quot;$0\firefox.exe&quot; -install-global-extension &quot;nt.xpi&quot;'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">24th May 2006, 03:32</div></div><div class="posttext">&lt;&lt;nsExec::Exec '&quot;$0&quot; -install-global-extension &quot;nt.xpi&quot;' &gt;&gt; <br />
shall it not be $1 as i am getting registry value in $1 and not in $0?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">24th May 2006, 04:14</div></div><div class="posttext">True. Sorry, it's just that I always use $0 as my first variable. It should be $1 in your case.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th May 2006, 05:54</div></div><div class="posttext">Does this &quot;nt.xpi&quot; exist on target, or you're going to extract it?<br />
I think a path to the file is missing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">24th May 2006, 16:45</div></div><div class="posttext">hi !!<br />
nt.xpi is on my machine, and also i am going to put one nt.xpi on the target machine by simply <br />
file nt.xpi before the exec statement, would it work?<br />
as regards the path it is in the same folder as the .nsi file so i think it should work.<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th May 2006, 17:15</div></div><div class="posttext">Yes,<br />
SetOutPath $INSTDIR<br />
File .....<br />
File .....<br />
File nt.xpi<br />
nsExec::Exec '&quot;$1&quot; -install-global-extension &quot;$INSTDIR\nt.xpi&quot;'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">24th May 2006, 18:25</div></div><div class="posttext">It works guyssssssssssss!!<br />
<br />
THANK YOU ALL!!:D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">24th May 2006, 19:27</div></div><div class="posttext">please helpppppp<br />
sorry to bug you again guys.. but the application installed correctly on one machine but one another one, it just throws up the firefox browser without installing the toolbar, please take a look at my final script and please help me...<br />
<br />
!define APPNAME &quot;NetTrust&quot;<br />
!define APPNAMEANDVERSION &quot;NetTrust 1.1.&quot;<br />
<br />
Name &quot;${APPNAMEANDVERSION}&quot;<br />
OutFile &quot;NetTrust.exe&quot;<br />
BrandingText &quot;NetTrust&quot;<br />
<br />
!include &quot;MUI.nsh&quot;<br />
<br />
!define MUI_ABORTWARNING<br />
<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_LICENSE &quot;license.txt&quot;<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
!insertmacro MUI_RESERVEFILE_LANGDLL<br />
<br />
<br />
<br />
Function .onInit<br />
;MessageBox MB_YESNO &quot;This will install NetTrust on your System. Do you wish to continue?&quot; IDYES gogogo<br />
;Abort<br />
<br />
;gogogo:<br />
<br />
ReadRegStr $1 HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\firefox.exe&quot; &quot;&quot;<br />
StrCmp $1 &quot;&quot; NoFireFox ok<br />
<br />
NoFireFox:<br />
MessageBox MB_OK|MB_ICONSTOP &quot;FireFox wasn't found on your system, Please install the latest version of Firefox from http://www.mozilla.com/firefox. Setup will now Exit&quot;<br />
Abort<br />
<br />
ok:<br />
<br />
!insertmacro MUI_LANGDLL_DISPLAY<br />
<br />
InitPluginsDir<br />
<br />
<br />
functionend<br />
<br />
Section &quot;&quot; ; A &quot;useful&quot; name is not needed as we are not installing separate components<br />
<br />
; Set output path to the installation directory. Also sets the working<br />
; directory for shortcuts<br />
SetOutPath $INSTDIR\<br />
<br />
File nt.xpi<br />
File nt.exe<br />
File readme.txt<br />
nsExec::Exec '&quot;$1&quot;' -install-global-extension &quot;$INSTDIR\nt.xpi&quot;<br />
<br />
<br />
WriteUninstaller $INSTDIR\UninstallNetTrust.exe<br />
<br />
; ///////////////// CREATE SHORT CUTS //////////////////////////////////////<br />
<br />
CreateDirectory &quot;$SMPROGRAMS\NetTrust&quot;<br />
<br />
<br />
CreateShortCut &quot;$SMPROGRAMS\NetTrust\Run NetTrust.lnk&quot; &quot;$INSTDIR\nt.exe&quot;<br />
<br />
<br />
CreateShortCut &quot;$SMPROGRAMS\NetTrust\Uninstall NetTrust.lnk&quot; &quot;$INSTDIR\UninstallNetTrust.exe&quot;<br />
<br />
; ///////////////// END CREATING SHORTCUTS ////////////////////////////////// <br />
<br />
; //////// CREATE REGISTRY KEYS FOR ADD/REMOVE PROGRAMS IN CONTROL PANEL /////////<br />
<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust&quot; &quot;NetTrust&quot;\<br />
&quot;NSIS Example Application 1 (remove only)&quot;<br />
<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust&quot; &quot;UninstallString&quot; \<br />
&quot;$INSTDIR\UninstallNetTrust.exe&quot;<br />
<br />
; //////////////////////// END CREATING REGISTRY KEYS ////////////////////////////<br />
<br />
MessageBox MB_OK &quot;Installation was successful.&quot;<br />
<br />
SectionEnd<br />
<br />
<br />
<br />
Section &quot;Uninstall&quot;<br />
; remove all the files and folders<br />
Delete $INSTDIR\UninstallNetTrust.exe ; delete self<br />
Delete $INSTDIR\nt.xpi<br />
Delete $INSTDIR\nt.exe<br />
Delete $INSTDIR\readme.txt<br />
<br />
<br />
RMDir $INSTDIR<br />
<br />
; now remove all the startmenu links<br />
Delete &quot;$SMPROGRAMS\NetTrust\Run NetTrust.lnk&quot;<br />
Delete &quot;$SMPROGRAMS\NetTrust\Uninstall NetTrust.lnk&quot;<br />
RMDIR &quot;$SMPROGRAMS\NetTrust&quot;<br />
<br />
; Now delete registry keys<br />
DeleteRegKey HKEY_LOCAL_MACHINE &quot;SOFTWARE\NetTrust&quot;<br />
DeleteRegKey HKEY_LOCAL_MACHINE &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust&quot;<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th May 2006, 19:30</div></div><div class="posttext">The path part of the plugin call must be surrounded by quotes. This includes the parameters.<br />
I'm not sure how it worked at all to be honest, unless the readme isn't telling me something.<br />
<br />
nsExec::Exec '&quot;$1&quot; -install-global-extension &quot;$INSTDIR\nt.xpi&quot;'<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">24th May 2006, 19:50</div></div><div class="posttext">It does n't even launch firefox if quotes are put this way.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th May 2006, 20:04</div></div><div class="posttext">perhaps this?<br />
nsExec::Exec '&quot;$1 -install-global-extension&quot; &quot;$INSTDIR\nt.xpi&quot;'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">24th May 2006, 20:10</div></div><div class="posttext">:o Nope that doesnt help too... i guesss we just need to launch firefox and present it with a .xpi file so that the toolbar file, nt.xpi installs itself to firefox. Dont know wat happened...:weird:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th May 2006, 20:19</div></div><div class="posttext">Unless the command params are wrong, should be a quotes issue.<br />
Anyway from my point of view best method is to make a nice htm file where you're telling users about your extension and provide a button to install the extension.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th May 2006, 20:38</div></div><div class="posttext">If you're executing firefox.exe, then why are you using nsExec::Exec?<br />
nsExec is used to execute command line executables to hide their command window. It should still work, but you should just use the Exec instruction:<br />
<br />
Exec '&quot;$1&quot; -install-global-extension &quot;$INSTDIR\nt.xpi&quot;'<br />
<br />
Another thing. Where does the $INSTDIR come into this? You aren't even setting its value to anything. If $INSTDIR is empty, your files will be extracted anywhere and the firefox execution will more than likely fail.<br />
You should set it to a value with StrCpy, e.g.<br />
StrCpy $INSTDIR $EXEDIR<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">24th May 2006, 21:03</div></div><div class="posttext">@red wine: the solution of leading a user to a webpage by launching firefox and then installing the .xpi from there requires all the users must have internet at install, and it would not be possible for a user who is offline to install my file then.<br />
<br />
@Afrow:is it not that i am extracting nt.xpi in INSTDIR through file nt.xpi and then providing firefox the file nt.xpi from there?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th May 2006, 21:06</div></div><div class="posttext">No leading users to net. Compile a htm file and extract it e.g. to $TEMP, then launch it with firefox :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">24th May 2006, 21:29</div></div><div class="posttext">ohhhhhhhh.. i never knew i could do that.. ill try that fix and get back !!<br />
Thnxxxx for ur support guys!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">24th May 2006, 21:32</div></div><div class="posttext">Well, see this thread, the guy said it's working. :-)<br />
http://forums.winamp.com/showthread.php?threadid=246301</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">25th May 2006, 05:56</div></div><div class="posttext">Another problem bros..<br />
Well even if the file nt.xpi is extracted to the INSTDIR why is firefox giving me error and is picking up nt.xpi from my hard disk location instead of INSTDIR<br />
<br />
it picks up nt.xpi from file:///C:/Documents%20and%20Settings.. <br />
<br />
and when i just run the setup firefox gives me error<br />
Firefox can't find the file at /C:/Documents and Settings/varun  vasudev/Desktop/fundoo/nt.xpi.<br />
<br />
y the hell firefox is picking up nt.xpi frm the hard disk it should be packaged in the installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">25th May 2006, 06:01</div></div><div class="posttext">guys. pls help .. <br />
the problems are<br />
1.firefox is picking nt.xpi from my hard disk and when i run the set up it gives me error Firefox can't find the file at /C:/Documents and Settings/varun vasudev/Desktop/fundoo/nt.xpi<br />
<br />
2. Add remove programs dont function.<br />
<br />
my final script is<br />
<br />
!define APPNAME &quot;NetTrust&quot;<br />
!define APPNAMEANDVERSION &quot;NetTrust 1.1.&quot;<br />
<br />
Name &quot;${APPNAMEANDVERSION}&quot;<br />
OutFile &quot;NetTrust.exe&quot;<br />
BrandingText &quot;NetTrust&quot;<br />
<br />
!include &quot;MUI.nsh&quot;<br />
<br />
!define MUI_ABORTWARNING<br />
<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_LICENSE &quot;license.txt&quot;<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
!insertmacro MUI_RESERVEFILE_LANGDLL<br />
<br />
<br />
<br />
Function .onInit<br />
;MessageBox MB_YESNO &quot;This will install NetTrust on your System. Do you wish to continue?&quot; IDYES gogogo<br />
;Abort<br />
<br />
;gogogo:<br />
<br />
ReadRegStr $1 HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\firefox.exe&quot; &quot;&quot;<br />
StrCmp $1 &quot;&quot; NoFireFox ok<br />
<br />
NoFireFox:<br />
MessageBox MB_OK|MB_ICONSTOP &quot;FireFox wasn't found on your system, Please install the latest version of Firefox from http://www.mozilla.com/firefox. Setup will now Exit&quot;<br />
Abort<br />
<br />
ok:<br />
<br />
!insertmacro MUI_LANGDLL_DISPLAY<br />
<br />
InitPluginsDir<br />
<br />
<br />
functionend<br />
<br />
Section &quot;&quot; ; A &quot;useful&quot; name is not needed as we are not installing separate components<br />
<br />
; Set output path to the installation directory. Also sets the working<br />
; directory for shortcuts<br />
SetOutPath $INSTDIR\<br />
<br />
File nt.xpi<br />
<br />
File readme.txt<br />
StrCpy $INSTDIR $EXEDIR<br />
<br />
nsExec::Exec '&quot;$1&quot; &quot;$INSTDIR\nt.xpi&quot;'<br />
<br />
<br />
WriteUninstaller $INSTDIR\UninstallNetTrust.exe<br />
<br />
; ///////////////// CREATE SHORT CUTS //////////////////////////////////////<br />
<br />
CreateDirectory &quot;$SMPROGRAMS\NetTrust&quot;<br />
<br />
<br />
CreateShortCut &quot;$SMPROGRAMS\NetTrust\Run NetTrust.lnk&quot; &quot;$INSTDIR\nt.exe&quot;<br />
<br />
<br />
CreateShortCut &quot;$SMPROGRAMS\NetTrust\Uninstall NetTrust.lnk&quot; &quot;$INSTDIR\UninstallNetTrust.exe&quot;<br />
<br />
; ///////////////// END CREATING SHORTCUTS ////////////////////////////////// <br />
<br />
; //////// CREATE REGISTRY KEYS FOR ADD/REMOVE PROGRAMS IN CONTROL PANEL /////////<br />
<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust&quot; &quot;NetTrust&quot;\<br />
&quot;NSIS Example Application 1 (remove only)&quot;<br />
<br />
WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust&quot; &quot;UninstallString&quot; \<br />
&quot;$INSTDIR\UninstallNetTrust.exe&quot;<br />
<br />
; //////////////////////// END CREATING REGISTRY KEYS ////////////////////////////<br />
<br />
MessageBox MB_OK &quot;Installation was successful.&quot;<br />
<br />
SectionEnd<br />
<br />
<br />
<br />
Section &quot;Uninstall&quot;<br />
; remove all the files and folders<br />
Delete $INSTDIR\UninstallNetTrust.exe ; delete self<br />
Delete $INSTDIR\nt.xpi<br />
Delete $INSTDIR\nt.exe<br />
Delete $INSTDIR\readme.txt<br />
<br />
<br />
RMDir $INSTDIR<br />
<br />
; now remove all the startmenu links<br />
Delete &quot;$SMPROGRAMS\NetTrust\Run NetTrust.lnk&quot;<br />
Delete &quot;$SMPROGRAMS\NetTrust\Uninstall NetTrust.lnk&quot;<br />
RMDIR &quot;$SMPROGRAMS\NetTrust&quot;<br />
<br />
; Now delete registry keys<br />
DeleteRegKey HKEY_LOCAL_MACHINE &quot;SOFTWARE\NetTrust&quot;<br />
DeleteRegKey HKEY_LOCAL_MACHINE &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust&quot;<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">25th May 2006, 06:08</div></div><div class="posttext">Check the link on your htm file.<br />
If you extract both the htm and the xpi to the same location, do not include any path when linking.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th May 2006, 09:31</div></div><div class="posttext">Move<br />
StrCpy $INSTDIR $EXEDIR<br />
above<br />
SetOutPath $INSTDIR<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">25th May 2006, 14:34</div></div><div class="posttext">hi There!<br />
<br />
moving <br />
StrCpy $INSTDIR $EXEDIR<br />
above<br />
SetOutPath $INSTDIR<br />
<br />
seems to fix the problem but now the installation folder of nettrust is not being made in the program files folder.. even though i am using <br />
<br />
InstallDir $PROGRAMFILES\NetTrust\<br />
<br />
<br />
!define APPNAME &quot;NetTrust&quot;<br />
!define APPNAMEANDVERSION &quot;NetTrust 1.1.&quot;<br />
<br />
Name &quot;${APPNAMEANDVERSION}&quot;<br />
OutFile &quot;NetTrust.exe&quot;<br />
BrandingText &quot;NetTrust&quot;<br />
<br />
InstallDir $PROGRAMFILES\NetTrust\<br />
<br />
!include &quot;MUI.nsh&quot;<br />
<br />
!define MUI_ABORTWARNING<br />
<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_LICENSE &quot;license.txt&quot;<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
!insertmacro MUI_LANGUAGE &quot;English&quot;<br />
<br />
what could be the problem guys??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th May 2006, 15:20</div></div><div class="posttext">You weren't using InstallDir before, or you didn't have it in the script. That's why you needed the StrCpy. Either use InstallDir or the StrCpy code I posted, but not both. The StrCpy sets the $INSTDIR variable to $EXEDIR. InstallDir also sets the $INSTDIR variable to what you want, but before any NSIS code is executed. Therefore the StrCpy is overwriting your &quot;$PROGRAMFILES\NetTrust&quot; value with $EXEDIR.<br />
<br />
Remove the StrCpy instruction.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">25th May 2006, 16:14</div></div><div class="posttext">Thanks Afrow!<br />
it finally worked fine... just had one curiosity, now if i removed the strcpy code how is it still not picking up nt.xpi from my hard disk, coz you had suggested the strcpy code to specifically fix that bug?<br />
:cool:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th May 2006, 16:45</div></div><div class="posttext">What do you mean?<br />
In what way is it not 'picking it up'? Does the File instruction fail?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">25th May 2006, 18:11</div></div><div class="posttext">no i mean u suggested strcpy as a fix for<br />
Firefox can't find the file at /C:/Documents and Settings/varun vasudev/Desktop/fundoo/nt.xpi<br />
<br />
now even without strcpy this seems to work, i was just curious how.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th May 2006, 19:27</div></div><div class="posttext">Because you didn't have InstallDir in your script and now you do.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">varun</div><div class="date">26th May 2006, 13:21</div></div><div class="posttext">Thanks Stu.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>