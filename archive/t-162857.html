<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Activation page component, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Activation page component NSIS Discussion" />
	
	<title> Activation page component [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Activation page component</div>
<hr />
<div class="pda"><a href="t-162857.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=162857">Activation page component</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">chris_svp</div><div class="date">2nd January 2004, 11:38</div></div><div class="posttext">Hi all,<br />
<br />
my boss want to add a registration step (like in a good commercial software he said :))during installation, so I think I add to create some kind of activation page between MUI_PAGE_LICENSE and MUI_PAGE_DIRECTORY:<br />
<br />
----------------------------------<br />
|Registration                   X|<br />
----------------------------------<br />
|                                |<br />
|  Name:                         |<br />
|  Company:                      |<br />
|  Serial Number:                |<br />
|                                |<br />
|                    OK Cancel   |<br />
----------------------------------<br />
<br />
What am I wondering is <br />
- someone has already done that ?<br />
- and more generally if there is a location (other than the examples directory of course) to find scripts that provide a new functionnality in open source?<br />
<br />
I am using the MUI.<br />
<br />
thanks a lot guys</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd January 2004, 12:24</div></div><div class="posttext">The Contrib folder contains examples for the plug-ins. Among those plug-ins is InstallOptions which is exactly what you need. Examples\Modern UI\InstallOptions.nsi is also an InstallOptions example.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chris_svp</div><div class="date">2nd January 2004, 14:22</div></div><div class="posttext">thanks, I missed this tuto (the name is not very correlated...)<br />
<br />
My second question is still interrogating me :)<br />
It would be very nice if such a location exists</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd January 2004, 14:30</div></div><div class="posttext">Well, that's the Contrib folder. There is also The Archive (http://nsis.sf.net/archive).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chris_svp</div><div class="date">2nd January 2004, 15:00</div></div><div class="posttext">ah ok :)<br />
<br />
I have another -silly- question, this time on the custom page I create: how do I do multilingual pages?<br />
<br />
I mean how do I, for example, decide the caption of a label in function of the user selected language?<br />
<br />
thanks for your ultra fast answers</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd January 2004, 15:02</div></div><div class="posttext">Write a LangString to the INI using WriteINIStr or the MUI macro (MUI_INSTALLOPTIONS_WRITE, I think).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chris_svp</div><div class="date">2nd January 2004, 15:31</div></div><div class="posttext">could you be more specific please?<br />
<br />
for example, taking ioB.ini, how do I put a multilingual text for the label?<br />
<br />
//////ioB.ini//////////<br />
[Settings]<br />
NumFields=1<br />
<br />
[Field 1]<br />
Type=label<br />
Text=Install Options Page B<br />
Left=0<br />
Right=-1<br />
Top=0<br />
Bottom=10<br />
////////////////////////<br />
<br />
I tried Text=LangString ${LANG_ENGLISH} &quot;Install Page B&quot;<br />
but this doesnot work.<br />
<br />
I believe I misunderstand your answer :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chris_svp</div><div class="date">2nd January 2004, 15:33</div></div><div class="posttext">oh my god I did a mistake in typing the msg:<br />
I tried<br />
Text=LangString ${LANG_ENGLISH} &quot;Install Page B&quot;<br />
Text=LangString ${LANG_FRENCH} &quot;Page d'installation B&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd January 2004, 15:37</div></div><div class="posttext">You need to write it using WriteINIStr or the MUI macro on runtime. That is, before you show the page, before you call InstallOptions to parse the INI, write the LangString into the text/state field.<br />
<br />
WriteINIStr $PLUGINSDIR\mypage.ini &quot;Field 4&quot; &quot;Text&quot; &quot;$(MyLangString)&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jamesgoh</div><div class="date">27th January 2004, 01:31</div></div><div class="posttext">I have managed to add in the serial code checking. But I have 2 questions:<br />
(1) The serial code page can still be skipped when the installer is executed in DOS using the /S switch. How do I overcome that?<br />
(2) I authenticate the serial code using the StrCmp instruction. But StrCmp is non-case sensitive. How do I make a case sensitive comparison?<br />
<br />
Please advice.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">27th January 2004, 02:20</div></div><div class="posttext">To use a case sensitive comparison you will have to use the system plugin with the appropriate API call or alternatively write a plugin for NSIS.<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">opher</div><div class="date">27th January 2004, 08:29</div></div><div class="posttext">As to silent (/S switch) run, you can place code in .onInit to check for (= require) the serial code on the command line or otherwise emit a warning and exit.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chris_svp</div><div class="date">4th February 2004, 10:25</div></div><div class="posttext">Originally posted by jamesgoh <br />
I have managed to add in the serial code checking.  <br />
<br />
Can I ask you how you did?<br />
<br />
My problem is that I do not know how to catch the NextButton click (i.e I do not know where to put my code for the checking).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">4th February 2004, 11:25</div></div><div class="posttext">Check the documentation about the leave function you can define for any page in NSIS.  You should place your check in that function and if the serial is incorrect use the abort command to prevent the installer from advancing to the next page.<br />
<br />
Vytautas ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">4th February 2004, 11:33</div></div><div class="posttext">You can disable the Next button if the serial is invalid using EnableWindow, but that alone is not very secure. Therefore you should also check the serial again in the leave funtion and Abort if the serial is invalid.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chris_svp</div><div class="date">4th February 2004, 13:46</div></div><div class="posttext">thanks guys for your quick answers, it helped me a lot (I just missed the leave_function parameter of the Page function). :)<br />
<br />
Now, I have another problem which is the dynamic update of my page (i.e write the registration code after the user click on Generate)<br />
<br />
I join my scripts to this post with a #FIXME in activ.nsi at the place where I want to add this stuff.<br />
<br />
I think that I should use SendMessage but my tries in this area stay unsuccessful.:(<br />
<br />
Thanks again for the previous help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th February 2004, 14:04</div></div><div class="posttext">You need to use SendMessage &lt;hwnd&gt; ${WM_SETTEXT} 0 &quot;STR:$1&quot;. To get the hwnd use GetDlgItem along with the hwnd of the InstallOptions dialog. To get the hwnd of the InstallOptions dialog see the example to set InstallOptions font in the MUI readme.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">chris_svp</div><div class="date">4th February 2004, 16:22</div></div><div class="posttext">thank you very much, this is perfectly working now :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>