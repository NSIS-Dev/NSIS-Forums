<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" IfFileExists and quotes, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  IfFileExists and quotes NSIS Discussion" />
	
	<title> IfFileExists and quotes [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  IfFileExists and quotes</div>
<hr />
<div class="pda"><a href="t-323955.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=323955">IfFileExists and quotes</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Stander</div><div class="date">11th November 2010, 10:37</div></div><div class="posttext">Hi!<br />
<br />
Recently I was trying to read the &quot;UninstallString&quot; from the system registry and check if the uninstaller file exists.<br />
<br />
  ReadRegStr $R0 HKLM \<br />
  &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\My_App&quot; \<br />
  &quot;UninstallString&quot;<br />
<br />
  IfFileExists $R0 +1 done<br />
<br />
The problem is that if the file path stored in the registry includes quotes, the IfFileExists function always returns false.<br />
<br />
Example<br />
if $R0 = C:\Program files\MyApp\uninstall.exe then IfFileExists returns true (file exists)<br />
but<br />
if $R0 = &quot;C:\Program files\MyApp\uninstall.exe&quot; then IfFileExists returns false (file doesn't exist)<br />
<br />
Is there any way to make it work or to exclude quotes from the received value (path)?<br />
<br />
Regards,<br />
Stander</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">11th November 2010, 11:27</div></div><div class="posttext">To remove a &quot; from the beginning of the string:<br />
<br />
StrCpy $R1 $R0 1<br />
${If} $R1 == '&quot;'<br />
  StrCpy $R0 $R0 &quot;&quot; 1<br />
${EndIf}<br />
<br />
I'll leave the removal of a trailing &quot; character as an exercise to you.<br />
<br />
(Hint: http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.8 )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Stander</div><div class="date">11th November 2010, 17:16</div></div><div class="posttext">Thanks a lot MSG!<br />
<br />
Homework done! :)<br />
<br />
StrCpy $R1 $R0 &quot;&quot; -1<br />
${If} $R1 == '&quot;'<br />
  StrCpy $R0 $R0 -1<br />
${EndIf}<br />
<br />
But... I'm wondering why the IfFileExists function doesn't respect quotes.<br />
Many other functions have no problems with paths with quotes.<br />
For instance ExecWait accepts all paths, no matter if they include quotes or not.<br />
<br />
Moreover, according to this guide (http://nsis.sourceforge.net/Add_uninstall_information_to_Add/Remove_Programs#Required_values) it is even recommended to use quotes in paths saved to the registry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">11th November 2010, 18:51</div></div><div class="posttext">Any instruction that executes a new process should be quoted, for everything else, quotes are probably not required. IfFileExists probably ends up calling the win32 api GetFileAttributes, and it does not want quoted paths (Like most win32 functions)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Stander</div><div class="date">11th November 2010, 22:06</div></div><div class="posttext">Any instruction that executes a new process should be quoted, for everything else, quotes are probably not required. IfFileExists probably ends up calling the win32 api GetFileAttributes, and it does not want quoted paths (Like most win32 functions)<br />
Thanks for the explanation.<br />
<br />
Regards,<br />
Stander</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>