<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to include REPAIR,REMOVE featture in NSIS?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to include REPAIR,REMOVE featture in NSIS? NSIS Discussion" />
	
	<title> How to include REPAIR,REMOVE featture in NSIS? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to include REPAIR,REMOVE featture in NSIS?</div>
<hr />
<div class="pda"><a href="t-352025.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=352025">How to include REPAIR,REMOVE featture in NSIS?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ilaiyaraja</div><div class="date">15th November 2012, 05:56</div></div><div class="posttext">I have written nsis script for my application.The installation steps are working fine.If i install second time in  same directory it should ask REPAIR or REMOVE option? How do i include this feature in my script?<br />
<br />
<br />
Can anyone help me?<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">15th November 2012, 06:20</div></div><div class="posttext">You'll have to code this yourself. You'll have to write autodetection code, show a custom (nsDialogs) page if necessary, and execute different installation code inside your sections depending on the option chosen by the user.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ilaiyaraja</div><div class="date">15th November 2012, 06:29</div></div><div class="posttext">Thanks MSG.<br />
ok..using nsDialogs customize the installation page.but when i install same application second time,then only include repair or remove option.How can i find out the application already installed or not?<br />
<br />
<br />
 WriteRegDWORD HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$(^Name)&quot; NoModify 1<br />
    WriteRegDWORD HKLM &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$(^Name)&quot; NoRepair 1<br />
 I saw this code in my script by default when i created  installer.Is this lines are related to repair or remove feature?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">15th November 2012, 07:15</div></div><div class="posttext">In your custom page function, add some code that does some auto-detection of your application:<br />
${If} ${FileExists} &quot;$INSTDIR\Somefile1.ext&quot;<br />
${AndIf} ${FileExists} &quot;$INSTDIR\Somefile2.ext&quot;<br />
  ;Show a custom page<br />
${EndIf}<br />
<br />
Also: In the custom page's leave function, set a $variable to remember what option the user chose, and in your sections, simply do<br />
${If} $variable == &quot;repair&quot;<br />
  ;do repair stuff<br />
${Else}<br />
  ;do reinstall stuff<br />
${EndIf}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">15th November 2012, 08:47</div></div><div class="posttext">The easiest solution is to create nsDialogs page with 2 radiobuttons: Repair and Remove.<br />
<br />
Repair will simply launch installer as is - so all files, values, settings etc will be overwritten to their default values.<br />
<br />
Remove will launch uninstaller (and immediately quit installer)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ilaiyaraja</div><div class="date">15th November 2012, 13:10</div></div><div class="posttext">Thanks Slappy. I have tried.<br />
Function nsDialogsPage<br />
<br />
	nsDialogs::Create 1018<br />
	Pop $Dialog<br />
<br />
	${If} $Dialog == error<br />
		Abort<br />
	${EndIf}<br />
<br />
	${NSD_CreateRadioButton} 0 0 100% 12u &quot;Repair&quot;<br />
	Pop $hwnd<br />
      ${NSD_OnClick $hwnd ???<br />
	${NSD_CreateRadioButton} 0 13u 100% -13u &quot;Remove&quot;<br />
	Pop $hwnd<br />
             ${NSD_OnClick $hwnd ???<br />
	nsDialogs::Show<br />
FunctionEnd<br />
<br />
How to call un installer function? I think un installer function starts from this funtion un.init. If i put un.init it should returns error message? How to call un installer function?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">16th November 2012, 05:33</div></div><div class="posttext">How to call un installer function?<br />
You cannot call an uninstaller function, but you can execute the uninstaller:<br />
ExecWait &quot;$INSTDIR\Uninstall.exe&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ilaiyaraja</div><div class="date">16th November 2012, 06:06</div></div><div class="posttext">Thanks MSG.<br />
It's working fine using this command.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ilaiyaraja</div><div class="date">30th November 2012, 10:27</div></div><div class="posttext">You cannot call an uninstaller function, but you can execute the uninstaller:<br />
ExecWait &quot;$INSTDIR\Uninstall.exe&quot; <br />
<br />
Function Remove<br />
ExecWait &quot;$INSTDIR\Uninstall.exe&quot;<br />
FunctionEnd.<br />
It will call the un insall function and open the un intall window.once the user click the un install button then only the files are removed.<br />
Is there any way if the user click remove radio button immediately un install functionality happen without opening one more window or dont want to ask again user input?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">1st December 2012, 00:34</div></div><div class="posttext">Well you could just copy all the uninstall code (delete files, registry, etc) from the uninstall section to a RemovePrevious section in your installer. Or create a silent uninstaller I guess, but that's probably overkill.<br />
<br />
(Keep in mind that it's bad form to be making changes to a user's system before the user clicks Install. Any page before INSTFILES should not be writing/deleting stuff. Therefore it's best to put the delete code in a section, because sections are executed only on the instfiles page. Maybe it could be the first section of your installer, and maybe an always-enabled one.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ilaiyaraja</div><div class="date">1st December 2012, 03:48</div></div><div class="posttext">Well you could just copy all the uninstall code (delete files, registry, etc) from the uninstall section to a RemovePrevious section in your installer. Or create a silent uninstaller I guess, but that's probably overkill.<br />
<br />
(Keep in mind that it's bad form to be making changes to a user's system before the user clicks Install. Any page before INSTFILES should not be writing/deleting stuff. Therefore it's best to put the delete code in a section, because sections are executed only on the instfiles page. Maybe it could be the first section of your installer, and maybe an always-enabled one.) <br />
<br />
ok..thanks. MSG &quot;it's bad form to be making changes to a user's system before the user clicks Install&quot;.<br />
Based on this i have changed the scenario.<br />
<br />
If the user checked the remove radio button,then un install the software like the status bar and followed by finish page and finally end.Is it possible?<br />
Function Remove<br />
ExecWait &quot;$INSTDIR\Uninstall.exe&quot;<br />
Quit<br />
FunctionEnd.<br />
This is my remove function code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">1st December 2012, 08:32</div></div><div class="posttext">Well you could make an uninstaller with only an uninstfiles page, sure. But then you're still making changes to the system before your own installer's instfiles page. My point is it's better to call that uninstaller from your first section, not from a page's leave function or something like that.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>