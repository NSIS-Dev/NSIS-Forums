<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Defining Section Order at Runtime., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Defining Section Order at Runtime. NSIS Discussion" />
	
	<title> Defining Section Order at Runtime. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Defining Section Order at Runtime.</div>
<hr />
<div class="pda"><a href="t-293244.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=293244">Defining Section Order at Runtime.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Sheik</div><div class="date">17th June 2008, 15:23</div></div><div class="posttext">Hi all,<br />
<br />
This issue has been a nagging one for me, for awhile.<br />
<br />
I wonder if anyone else has found a solution to it, or perhaps a workaround?<br />
<br />
Lets say I have an Installer that has 6-8 sections.<br />
<br />
I want to define an order to said sections at runtime, based on what sections they select to be installed.<br />
<br />
So perhaps if they select &quot;all&quot;, then I have one set of orders, but if they only select 4 of 8, then I want to have a different order of Install...<br />
<br />
Is there any way to do this?<br />
Can I define an order of how the sections run/get installed during runtime?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">17th June 2008, 16:01</div></div><div class="posttext">Unselected sections won't get executed, where exactly is the issue that you're referring?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sheik</div><div class="date">17th June 2008, 16:45</div></div><div class="posttext">Hi Red Wine,<br />
<br />
I need the section order changed, based on what sections they decide to install.<br />
<br />
For instance, lets say I have 4 sections:<br />
<br />
The default order:<br />
1) Install sub1<br />
2) Install main.<br />
3) Install sub2<br />
4) Install sub3<br />
<br />
HOWEVER, lets say that I want this order to ONLY install this way if they select all the sections to install.<br />
But lets say I want this order to change, if they DON'T select sub2 to install.<br />
In that case, I want this order to be changed to say:<br />
<br />
1) Install main<br />
2) Install sub3<br />
3) Install sub1<br />
<br />
This is a simplified case, I actually have 8-9 sections, all of which have certain orders they need to be installed, based on which other sections they have select/not selected...<br />
<br />
I need a way to define the order at runtime, in which these sections are run/installed...<br />
<br />
Scott</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">17th June 2008, 17:40</div></div><div class="posttext">I guess you should add a different order of the sections (with different section id's of course) and associate each order with a certain install type.<br />
Makensis won't compile twice same files so the size of the installer would remain the same but you have to write a lot of complicated code.<br />
I guess it should work as you expect though I haven't try it my self.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">18th June 2008, 05:06</div></div><div class="posttext">Or another idea:<br />
Make all your current sections just an empty &quot;shell&quot; and install everything from one hidden section.  Have the hidden section execute things in an order based on the section flags of the other sections. (use sections.nsh and logiclib.nsh to make coding easier.)<br />
<br />
It might take you a bit to come up with the correct logic, but once you had it down, it might be easier to manage.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sheik</div><div class="date">18th June 2008, 06:20</div></div><div class="posttext">Hi all,<br />
<br />
Yeah, Comperio, that is currently the way I was doing it... But I was really hoping to be in the &quot;spirit&quot; of sections, and actually install/uninstall files in their respective section namespace...<br />
<br />
I am actually writing a new patch for NSIS right now, that hopefully kichik will accept it.<br />
<br />
I am adding 2 new commands:<br />
SectionSetOrder<br />
SectionGetOrder<br />
<br />
It adds a new flag internally to the &quot;section struct&quot;, that allows users to specify the order of installation for each section.<br />
<br />
By default, all sections are set to an order of 0, which means to use the regular &quot;in order&quot; way.<br />
But if we come across a value for &quot;order&quot; that is non-zero, it will override the regular &quot;in order&quot; way, and will install/uninstall based on 1 -&gt; X, where X is a bigger number.<br />
<br />
The code itself is obviously very small, as I am just reusing a lot of existing code, mostly the SectionSetSize/SectionGetSize commands.<br />
<br />
I have most of the patch done, and will finish it up tomorrow, as well as submit it tomorrow as well...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sheik</div><div class="date">18th June 2008, 18:43</div></div><div class="posttext">Hi all,<br />
<br />
I have finished the patch, and submitted it to sourceforge here:<br />
http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1997092&amp;group_id=22049&amp;atid=373087<br />
<br />
Add 2 new commands to allow defining Section Order at Runtime.<br />
<br />
This patch allows us to define, at runtime, the order in which sections<br />
will be installed.<br />
<br />
I have added 2 new commands, called:<br />
SectionSetOrder<br />
SectionGetOrder<br />
<br />
I have added a new int variable in the struct section, called &quot;order&quot;.<br />
By default, &quot;order&quot; for each section is set to 0, indicating no ordering<br />
preference.<br />
<br />
The SectionSetOrder command allows users to set the new order so you can<br />
run section installs in a different order.<br />
<br />
Most of this patch just uses the &quot;SectionSetSize/SectionGetSize&quot; code as<br />
its guide.<br />
<br />
I wrote this patch, specifically because I have a situation where I have 8<br />
or 9 sections, and depending upon which sections are enabled/disabled, I<br />
need to change the order of the way I install each section.<br />
<br />
My topic on the NSIS Forum is here:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=293244<br />
<br />
Below is the copy/paste of the patch.<br />
If you accept this patch, and would like a .patch file instead, let me<br />
know.<br />
<br />
Please consider adding this patch, thank you!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>