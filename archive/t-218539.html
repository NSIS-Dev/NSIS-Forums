<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" delete last char in string if char is..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  delete last char in string if char is... NSIS Discussion" />
	
	<title> delete last char in string if char is... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  delete last char in string if char is...</div>
<hr />
<div class="pda"><a href="t-218539.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=218539">delete last char in string if char is...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Huette</div><div class="date">10th June 2005, 14:25</div></div><div class="posttext">Hello!<br />
(first: sry for my english)<br />
<br />
i want to have an function that does the following:<br />
<br />
input is a string. if the string ends on a special char (the other input), the char will be deleted. otherwise nothing should be done. sounds trivial, but i don't get by with the push's and pop's etc really well. so i hope somebody already got that function or can write it in a few minutes, because it would take too much time for me, to write it by myself. i think it shouldn't be a problem to the most of the forum-members. thank you =)<br />
<br />
<br />
PS.: i looked for that function in the archive, but didn't found what i want. Important is, that the char will only be deleted, if it's the last of the string. if the char exists in the string(n-times), but is not at last position nothing should be done.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th June 2005, 14:31</div></div><div class="posttext">;Push &quot;a&quot;<br />
;Push &quot;blahaha&quot;<br />
;Call ChopLastChar<br />
;Pop $R0<br />
;$R0 == blahah<br />
<br />
Function ChopLastChar<br />
Exch $R0<br />
Exch<br />
Exch $R1<br />
Push $R2<br />
 StrCpy $R2 $R0 1 -1<br />
 StrCmp $R2 $R1 0 +2<br />
 StrCpy $R0 $R0 -1<br />
Pop $R2<br />
Pop $R1<br />
Exch $R0<br />
FunctionEnd<br />
<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Huette</div><div class="date">10th June 2005, 15:43</div></div><div class="posttext">Wow!<br />
That was really fast. Thank you very much.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">erundil</div><div class="date">25th March 2013, 15:44</div></div><div class="posttext">Wow, this topic is really old... sorry to revive it, but I think my problem is too similar to create a separate one.<br />
<br />
I need to delete backslash from string:<br />
&quot;$INSTDIR\blablabla\someting\&quot;   --&gt;   &quot;$INSTDIR\blablabla\someting&quot;<br />
<br />
The problem I have to deal with is so common, that I began to wonder maybe there is a built-in function or something? I mean... if nothing else, I can use the solution from Stu, but it looks like some magic to me and I prefer my code as short and clear as possible. Clear to me, to be precise :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bnicer</div><div class="date">25th March 2013, 16:03</div></div><div class="posttext">StrCpy $0 &quot;a string&quot; &quot;&quot; -1 # = &quot;g&quot;<br />
StrCmp $0 &quot;g&quot; 0 +2<br />
StrCpy $0 &quot;a string&quot; -1 # = &quot;a strin&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th March 2013, 16:43</div></div><div class="posttext">Put the code to call my function in a macro or just use the 3 main lines inside it (which is the same as what bnicer has posted). The reason for the function call with the rest of it is to stop variables being clobbered.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">erundil</div><div class="date">26th March 2013, 13:16</div></div><div class="posttext">Thanks for quick replies guys. 3 lines are something I can analyze :D<br />
<br />
So far I managed to shorten the code even more to:<br />
StrCpy $OutputString $InputString -1<br />
I don't need to save that last char anywhere, or even check if it's really a backslash, so code above does the trick.<br />
<br />
Ah, also output can be the same as input, so to trim last char from $INSTDIR I can use:<br />
StrCpy $INSTDIR $INSTDIR -1<br />
<br />
By accident I found something else. When reading a path from from registry using ReadRegStr it works like this:<br />
RegValue == &quot;X:\path&quot; --&gt; ReadRegStr == &quot;X:\path&quot;<br />
RegValue == &quot;X:\path\&quot; --&gt; ReadRegStr == &quot;X:\path&quot;<br />
In short words if there is backslash in the end, it is ommited... meaning I didn't need the code in the first place. Don't I feel dumb now not to test that earlier...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">26th March 2013, 14:09</div></div><div class="posttext">ReadRegStr will read the exact value, it will not remove any backslashes.<br />
<br />
It is actually the $INSTDIR variable that removed your backslash. $INSTDIR is a special variable, it is actively maintained by NSIS to always contain a valid path. Trailing backslashes, spaces, etc are automatically removed after its value is changed by any command.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">erundil</div><div class="date">28th March 2013, 16:21</div></div><div class="posttext">Is the $INSTDIR the only variable to perform this trick? Or are there others to do this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">28th March 2013, 17:07</div></div><div class="posttext">There are others, [r]0-9 are normal and language, hwndparent and path variables are special</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>