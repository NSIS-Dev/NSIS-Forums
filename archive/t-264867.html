<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Variable is not resolved, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Variable is not resolved NSIS Discussion" />
	
	<title> Variable is not resolved [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Variable is not resolved</div>
<hr />
<div class="pda"><a href="t-264867.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=264867">Variable is not resolved</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">daniel8</div><div class="date">1st February 2007, 20:27</div></div><div class="posttext">Hi, I require to assign text conditionally to a variable. Unfortunately the variable $versionLabel is not resolved, it always remains &quot;$versionLabel&quot; instead of printing out its value.<br />
<br />
Any help is greatly appreciated.<br />
----------------------------------------------------------<br />
!define MINOR_VERSION    &quot;e&quot;<br />
<br />
!include &quot;MUI.nsh&quot;<br />
!include &quot;LogicLib.nsh&quot;<br />
<br />
Name &quot;PROFIDA Update&quot;<br />
Var &quot;versionLabel&quot;<br />
<br />
Section &quot;-vardef&quot;<br />
   ${If} ${MINOR_VERSION} != &quot;&quot;<br />
      StrCpy &quot;$versionLabel&quot; &quot; [${MINOR_VERSION}]&quot;<br />
   ${EndIf}<br />
   <br />
   DetailPrint &quot;this is $versionLabel &gt; sould equal ${MINOR_VERSION}&quot;<br />
SectionEnd<br />
<br />
!define VERSION '${MAJOR_VERSION}$versionLabel ${UPDATE_COUNT}'<br />
...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">1st February 2007, 20:45</div></div><div class="posttext">not able to reproduce the problem <br />
OutFile 'test.exe'<br />
<br />
!include &quot;LogicLib.nsh&quot;<br />
!define MINOR_VERSION &quot;e&quot;<br />
Var &quot;versionLabel&quot;<br />
<br />
Section &quot;boo&quot;<br />
StrCmp ${MINOR_VERSION} &quot;&quot; end<br />
StrCpy &quot;$versionLabel&quot; &quot; [${MINOR_VERSION}]&quot;<br />
DetailPrint &quot;this is $versionLabel &gt; sould equal ${MINOR_VERSION}&quot;<br />
<br />
${If} ${MINOR_VERSION} != &quot;&quot;<br />
StrCpy &quot;$versionLabel&quot; &quot; [${MINOR_VERSION}]&quot;<br />
${EndIf}<br />
<br />
DetailPrint &quot;this is $versionLabel &gt; sould equal ${MINOR_VERSION}&quot;<br />
<br />
end:<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st February 2007, 20:54</div></div><div class="posttext">daniel8, OutFile is a compile time command. You can't use variables in it. Those will only be set during runtime. Imagine you used the computer name in that variable. How is the compiler to know on which computer you'll run the installer and give it the matching name?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">daniel8</div><div class="date">2nd February 2007, 08:28</div></div><div class="posttext">Thanks for taking time to work on my problem.<br />
<br />
kichik, all variables like ${VERSION_FILE} are resolved properly anywhere in my file except $versionLabel. Even when using DetailPrint $versionLabel remains &quot;$versionLabel&quot; instead of filling in its value. I tried the same using $0, $1, $R1 but the result is always the same.<br />
<br />
I am using NSIS version 2.23<br />
<br />
Red Wine, are you using maybe a different version of NSIS?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">2nd February 2007, 09:08</div></div><div class="posttext">I'm using 2.23, the little example I posted above should work for all  2.0 + versions, does not work for you? Still the var $versionLabel is empty?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd February 2007, 09:10</div></div><div class="posttext">${VERSION_FILE} is not a variable, it's a compile time define.<br />
<br />
If you tried to DetailPrint it and it printed the variable name itself, you probably had a typo in there. Pay attention to the warnings the compiler gives you. It'll tell you if it doesn't know a specific variable in this case.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">daniel8</div><div class="date">2nd February 2007, 10:12</div></div><div class="posttext">kichik, I do not get any error nor any warnings.<br />
<br />
Red Wine and kichik, please have a look at the compiler output below - $versionLabel remains $versionLabel and is not resolved to the value it actually holds. I used Red Wine's snippet from above.<br />
---------------------------------------------------------<br />
Processing script file: &quot;D:\Documents\Development\Updates\TestUpdate\variableTest.nsi&quot;<br />
OutFile: &quot;test.exe&quot;<br />
!include: &quot;C:\programs\dev\NSIS\Include\LogicLib.nsh&quot;<br />
!include: closed: &quot;C:\programs\dev\NSIS\Include\LogicLib.nsh&quot;<br />
!define: &quot;MINOR_VERSION&quot;=&quot;e&quot;<br />
Var: &quot;versionLabel&quot;<br />
Section: &quot;boo&quot;<br />
StrCmp &quot;e&quot; &quot;&quot; equal=end, nonequal=<br />
StrCpy $versionLabel &quot; [e]&quot; () ()<br />
DetailPrint: &quot;this is $versionLabel &gt; sould equal e&quot;<br />
!insertmacro: _If<br />
!insertmacro: end of _If<br />
StrCpy $versionLabel &quot; [e]&quot; () ()<br />
!insertmacro: _EndIf<br />
!insertmacro: end of _EndIf<br />
DetailPrint: &quot;this is $versionLabel &gt; sould equal e&quot;<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd February 2007, 10:15</div></div><div class="posttext">Once again, you are confused with the difference between compile time and runtime. The compiler can't tell what $versionLabel will hold when the installer is executed so it prints out the variable name itself. When you actually execute the installer, the variable name will be replaced by its runtime value.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">daniel8</div><div class="date">2nd February 2007, 12:34</div></div><div class="posttext">kichik and Red Wine, thanks for all the patience and help - you put me onto the right track, it works via use of !ifdef and !define.<br />
<br />
I searched this forum for the keywords &quot;compile time variable&quot; and also understand now the purpose of the section &quot;Conditional Compilation&quot; in the NSIS user manual.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>