<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How do I create a simple installer to copy files to multiple directories?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How do I create a simple installer to copy files to multiple directories? NSIS Discussion" />
	
	<title> How do I create a simple installer to copy files to multiple directories? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How do I create a simple installer to copy files to multiple directories?</div>
<hr />
<div class="pda"><a href="t-305062.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305062">How do I create a simple installer to copy files to multiple directories?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">7th April 2009, 08:36</div></div><div class="posttext">Hello<br />
<br />
I would like to know how to create a simple installer using NSIS which will, at launch of setup, ask me to choose (from a Drop down list or radio buttons) which Operating System I am installing it on (or could auto-detect this?).<br />
<br />
Firstly, I'll explain what I need done.<br />
<br />
I need 2 files (.exe and .ini) copied to the following directories;<br />
<br />
On Windows (XP, Server 2003 and everything before);[list=1] %WINDIR%\servicepackfiles\i386<br />
 %WINDIR%\system32\dllcache<br />
 %WINDIR%\system32<br />
 %WINDIR%[/list=1]On New Windows! (Vista, Win7, Server 2008 etc. including x64);[list=1] %WINDIR%<br />
 %WINDIR% \servicepackfiles\i386<br />
 %WINDIR% \system32\dllcache<br />
 %WINDIR%\SysWOW64 - (NOTE: Probably only on Vista x64)<br />
 %WINDIR%\winsxs\amd64_microsoft-windows-notepad_31bf3856ad364e35_6.0.6001.18000_none_cb3928ff285d2ca9 - (NOTE: Probably only on Vista x64)<br />
 %WINDIR%\winsxs\amd64_microsoft-windows-notepadwin_31bf3856ad364e35_6.0.6001.18000_none_9ee86862b36a7eff - (NOTE: Probably only on Vista x64)<br />
 %WINDIR%\winsxs\x86_microsoft-windows-notepad_31bf3856ad364e35_6.0.6001.18000_none_6f1a8d7b6fffbb73[/list=1]Any advice on how I could do this would be truly appreciated.<br />
<br />
Thanks in advance,<br />
<br />
Panarchy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sgiusto</div><div class="date">7th April 2009, 10:12</div></div><div class="posttext">Hello,<br />
the SetOutPath command is used to specify the destination folder of files and the constants $WINDIR and $SYSDIR contain the windows and system folder of the system you are installing on. <br />
Search nsis site for GetWindowsVersion macro that detects the windows version you are running on.<br />
Last but not least RTFM!<br />
These are baisc features and are well documented.<br />
Regards<br />
  Stefano</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">7th April 2009, 13:07</div></div><div class="posttext">Thanks, I'll research what you have described!<br />
<br />
Documentation wasn't simple...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">7th April 2009, 13:35</div></div><div class="posttext">Okay, well here is what I've worked out so far.<br />
<br />
Please tell me what I am doing wrong;Name &quot;Notepad2&quot;<br />
OutFile &quot;Notepad2 Setup.exe&quot;<br />
<br />
LicenseText &quot;You must agree to this license before installing.&quot;<br />
LicenseData &quot;license.txt&quot;<br />
<br />
<br />
InstallDir &quot;$WINDIR&quot;<br />
InstallDir &quot;$WINDIR\servicepackfiles\i386&quot;<br />
InstallDir &quot;$WINDIR\system32\dllcache&quot;<br />
InstallDir &quot;$WINDIR\system32&quot;<br />
DirShow hide ; (make this show to let the user change it)<br />
DirText &quot;Select the directory to install myApp in:&quot;<br />
<br />
Section &quot;&quot; ; (default section)<br />
SetOutPath &quot;$INSTDIR&quot;<br />
<br />
File /-y notepad.exe<br />
File /-y notepad.ini<br />
<br />
SectionEnd ; end of default section<br />
<br />
<br />
; eofThanks in advance,<br />
<br />
Panarchy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th April 2009, 14:54</div></div><div class="posttext">You only use InstallDir once to set the default installation directory for the Directory page. You aren't even using a Directory page so you shouldn't be using it. Just use SetOutPath on the 4 directories with the 2 File instructions after each. Also, what is /-y? There is no such switch for the File instruction.<br />
<br />
This is a much better install.<br />
<br />
!include MUI2.nsh<br />
<br />
Name `Notepad2`<br />
OutFile `Notepad2 Setup.exe`<br />
<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_LICENSE license.txt<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
!insertmacro MUI_LANGUAGE English<br />
<br />
Section<br />
<br />
  !macro ExtractNotepad2 ToDir<br />
    SetOutPath `${ToDir}`<br />
    File notepad.exe<br />
    File notepad.ini<br />
  !macroend<br />
<br />
  !insertmacro ExtractNotepad2 $WINDIR<br />
  !insertmacro ExtractNotepad2 $WINDIR\servicepackfiles\i386<br />
  !insertmacro ExtractNotepad2 $SYSDIR\dllcache<br />
  !insertmacro ExtractNotepad2 $SYSDIR<br />
<br />
SectionEnd<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">7th April 2009, 15:24</div></div><div class="posttext">Sweet!<br />
<br />
Nice, smaller, a little harder to understand, but all in all much better then my 1st attempt.<br />
<br />
Almost perfect!<br />
<br />
Thanks for your help, now I just need to work out how to make it install differently when installed on Vista, Server 2008 &amp; Windows 7.<br />
<br />
If you know how I can do so, without creating a separate installer, please tell me!<br />
<br />
[The] GetWindowsVersion macro detects the windows version you are runningPerhaps this can be used?<br />
<br />
Thanks in advance for any extra advice,<br />
<br />
Panarchy<br />
<br />
PS: Once again, thank you for what you have posted!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th April 2009, 17:12</div></div><div class="posttext">You should just need to add RequestExecutionLevel user or RequestExecutionLevel admin in there.<br />
Read it up in the manual.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">8th April 2009, 03:33</div></div><div class="posttext">Thanks, I'll do that.<br />
<br />
In the meantime, I'm getting some errors with the unedited script you wrote;<br />
Error in macro MUI_PAGEDECLARATION_LICENSE on macroline 17<br />
Error in macro MUI_PAGE_LICENSE on macroline 6<br />
Error in script &quot;C:\Users\Panarchy\Documents\Almost Perfect.nsi&quot; on line 7 -- aborting creation process<br />
<br />
Please tell me how to fix them.<br />
<br />
Thanks in advance,<br />
<br />
Panarchy<br />
<br />
PS: Where should I put notepad.exe and notepad.ini?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">11th April 2009, 15:42</div></div><div class="posttext">*bump*</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">11th April 2009, 16:27</div></div><div class="posttext">For your last two questions:<br />
I assume that your MUI error is that the file 'license.txt' does not exist in your MUI folder. <br />
<br />
Also, the files notepad.exe and notepad.ini should be in the same folder as your script (unless you specific the full path to the file.)  This is explained in the main NSIS help for the FILE command.  (a copy of it is found here:  http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1.5) <br />
<br />
And for usage about WinVer, have a look inside the main header file--WinVer.nsh--found in the includes folder of you NSIS install.  <br />
<br />
For other help, you should consider spending some time browsing your NSIS installation folder (especially look a the DOCS and EXAMPLES folders--there's some good documentation and examples for MUI that will explain each command in detail.)  You might also want to take some time reading through the FAQs (http://nsis.sourceforge.net/FAQ) on the wiki.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">12th April 2009, 00:38</div></div><div class="posttext">Thanks, will do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">13th April 2009, 06:11</div></div><div class="posttext">Hello<br />
<br />
Okay, everything now works pretty much perfectly, however I would like to customise a few things.<br />
<br />
Any idea how I can change the following text?<br />
http://i39.tinypic.com/35hrear.jpg<br />
<br />
Would really appreciate any suggestions.<br />
<br />
Thanks in advance,<br />
<br />
Panarchy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">17th April 2009, 14:50</div></div><div class="posttext">*bump*</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">17th April 2009, 17:48</div></div><div class="posttext">There is much you can learn by reading the docs.<br />
!define MUI_LICENSEPAGE_TEXT_BOTTOM `my text`<br />
BrandingText `my text`<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">18th April 2009, 05:15</div></div><div class="posttext">Thanks for your reply.<br />
<br />
The BrandingText one works, however this one;<br />
!define MUI_LICENSEPAGE_TEXT_BOTTOM `my text<br />
<br />
Doesn't.<br />
<br />
Please tell me how to get the 2nd one to work.<br />
<br />
Thanks in advance,<br />
<br />
Panarchy<br />
<br />
PS: Thanks for the BrandingText one, really appreciate it.`</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">18th April 2009, 13:30</div></div><div class="posttext">Have you put the define before inserting the page macros?<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">18th April 2009, 15:29</div></div><div class="posttext">Thanks, that did the job.<br />
<br />
Would it also be possible to change the following text?;<br />
<br />
http://i40.tinypic.com/2j4c7zm.jpg<br />
<br />
And also to make the font size bigger (much bigger). Alternatively if you can tell me how to create another page in the wizard, one which I can use as a CAUTION page telling the user that it will replace Notepad with Notepad2.<br />
<br />
Thanks in advance for any extra help,<br />
<br />
Panarchy<br />
<br />
PS: Thanks once again for all you've helped me with!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>