<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to call a DLL made by yourself?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to call a DLL made by yourself? NSIS Discussion" />
	
	<title> How to call a DLL made by yourself? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to call a DLL made by yourself?</div>
<hr />
<div class="pda"><a href="t-250936.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=250936">How to call a DLL made by yourself?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">pedroac</div><div class="date">12th July 2006, 12:50</div></div><div class="posttext">Hello everybody<br />
<br />
I have a DLL (Autenticator.dll) that I created (Visual Studio C#) which has one class (named ValidateClass), and this class has one method:<br />
public static String validate(String username, String password)<br />
<br />
I have a UserPass dialog which puts the inserted username and password into $R0 and $R1.<br />
<br />
All I wanna do is to call the function in my DLL with the $R0 and $R1 parameters and to get the function's result.<br />
<br />
How should I do that?<br />
First, where do I have to put the DLL file?<br />
Second, what is the syntax of the call to the DLL in the function? Something like <br />
System::Call 'Authenticator::ValidateClass.validate($R0, $R1)'? Where does the function's result go to?<br />
<br />
Thanks for the help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th July 2006, 13:07</div></div><div class="posttext">This is not going to work. C# (and VB.NET) DLL's are not standard extensions - they use .NET. If you write a DLL it's got to be C/C++ 6 or Delphi. It is possible to write these plugins under VS.NET but they can't contain any .NET code. Even then, the user may still need to have .NET installed. You wouldn't believe how many people still don't have .NET installed and never will.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pedroac</div><div class="date">12th July 2006, 14:39</div></div><div class="posttext">The rest of my application will use .NET, so I'm going to use this verification: <br />
<br />
http://nsis.sourceforge.net/Get_.NET_Version<br />
<br />
If the user has a valid .NET version, the installer continues, otherwise it will stop.<br />
<br />
So, I think the that .NET is not the problem.<br />
<br />
Or is it simply impossible to user C#-made DLL's in NSIS?<br />
<br />
So, is there any way to get the result of the function call?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th July 2006, 16:54</div></div><div class="posttext">You'd have to build it as a console application and capture its output with nsExec::ExecToStack.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pedroac</div><div class="date">12th July 2006, 18:01</div></div><div class="posttext">You mean an .exe?<br />
<br />
If so, where should the output go in order to be captured by nsExec?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th July 2006, 18:17</div></div><div class="posttext">EXE = executive (executable)<br />
It needs to be output like in any other console application which you run in command prompt.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pedroac</div><div class="date">12th July 2006, 18:29</div></div><div class="posttext">Ok, so now I have my app in console mode. By passing the username and password as arguments in command line, it outputs a String.<br />
<br />
So, how do I call the application with the right parameters? (please assume that the arguments are stored in $R0 and $R1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">12th July 2006, 19:04</div></div><div class="posttext">nsExec::ExecToLog '&quot;$PLUGINSDIR\myapp.exe&quot; &quot;param1&quot; &quot;param2&quot;'<br />
Pop $R0 #result<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>