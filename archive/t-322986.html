<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Silent Installs - how to change StartMenuGroup and InstallDir programmatically?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Silent Installs - how to change StartMenuGroup and InstallDir programmatically? NSIS Discussion" />
	
	<title> Silent Installs - how to change StartMenuGroup and InstallDir programmatically? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Silent Installs - how to change StartMenuGroup and InstallDir programmatically?</div>
<hr />
<div class="pda"><a href="t-322986.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322986">Silent Installs - how to change StartMenuGroup and InstallDir programmatically?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Radix999</div><div class="date">8th October 2010, 03:40</div></div><div class="posttext">I've added silent support (with a record option) to my NSIS installers and the only thing I'm having problems with is the correct way to read/save the default Start Menu group and Installation directory.<br />
<br />
I'm using the MUI2 theme, and its dialogs are handling both of these pages - but can't see where its reading/saving these values.  What variables should I be changing?<br />
<br />
Cheers in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">8th October 2010, 04:27</div></div><div class="posttext">The MUI directory page copies the picked folder path into the $INSTDIR variable.<br />
The MUI Start Menu page copies the picked start menu path into the variable you specify in the '!insertmacro MUI_PAGE_STARTMENU ID Variable' line.<br />
<br />
So you would manually copy appropriate values into those two variables when detecting a silent installation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Radix999</div><div class="date">8th October 2010, 15:39</div></div><div class="posttext">Thanks for your reply.<br />
<br />
I actually managed to figure out the $INSTDIR variable after a bit of trial and error, but the StartMenuGroup eludes me still.<br />
<br />
The variable I'm passing to that macro is $StartMenuGroup - seems simple enough, but when I read that value I get something completely different than I expected - it's a path like C:\Users\XXX\AppData\Roaming\xxx\StartMenu\ (sorry, not at work atm and don't remember the full path, but it seemed more like the path TO the StartMenu group and not the name specified by the user.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">8th October 2010, 19:07</div></div><div class="posttext">The value stored in the $StartMenuGroup is actually the full path to the user's Start Menu + the start menu entry (which gets stored as another folder).  So when you run it in silent mode, you will have to append an appropriate start menu entry to that path yourself.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>