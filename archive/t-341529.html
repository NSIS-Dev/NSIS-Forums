<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Registry and WordFunc help?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Registry and WordFunc help? NSIS Discussion" />
	
	<title> Registry and WordFunc help? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Registry and WordFunc help?</div>
<hr />
<div class="pda"><a href="t-341529.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=341529">Registry and WordFunc help?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ferdhy_raja</div><div class="date">31st January 2012, 19:58</div></div><div class="posttext">hi i have a problem with changing the registry value if the exe file moved or changed name<br />
I want to find all and change the registry value,write founded in reg file or change with Write value.....?<br />
This my script:<br />
GetTempFileName $R0<br />
	FileOpen $R1 $R0 w<br />
	FileWrite $R1 'Windows Registry Editor Version 5.00$\r$\n$\r$\n'<br />
	FileWrite $R1 '[HKEY_CURRENT_USER\Software\my software]$\r$\n$\r$\n'<br />
<br />
	${registry::Open} &quot;HKEY_CURRENT_USER\Software\my software&quot; &quot;/K=0 /V=1 /S=0 /B=1 /N='LocalFileName'&quot; $0<br />
	StrCmp $0 0 0 loop<br />
	MessageBox MB_OK &quot;Error&quot; IDOK close<br />
<br />
	loop:<br />
	${registry::Find} &quot;$0&quot; $1 $2 $3 $4<br />
	StrCmp $4 '' close<br />
	StrCmp $4 'REG_KEY' 0 +3<br />
	;FileWrite $R1 '[$1]$\r$\n'<br />
	FileWrite $R1 '&quot;$1&quot;=$\r$\n'<br />
	goto +4<br />
	${WordFind} &quot;$3&quot; &quot;settings&quot; &quot;E+2*}&quot; $6<br />
	;${registry::Write} &quot;$1&quot; &quot;$2&quot; &quot;$EXEDIR$6&quot; &quot;REG_SZ&quot; $R0<br />
	FileWrite $R1 '[HKEY_CURRENT_USER\$1]$\r$\n'<br />
	FileWrite $R1 '&quot;$2&quot;=&quot;$EXEDIR\$6&quot;$\r$\n$\r$\n'<br />
	goto loop<br />
<br />
	close:<br />
	${registry::Close} &quot;$0&quot;<br />
	${registry::Unload}<br />
	FileClose $R1<br />
<br />
<br />
and this the result:<br />
Windows Registry Editor Version 5.00<br />
<br />
[HKEY_CURRENT_USER\Software\my software]<br />
<br />
[HKEY_CURRENT_USER\Software\my software\11]<br />
&quot;LocalFileName&quot;=&quot;C:\PortableApps\NSISPortable\App\NSIS\Examples\Registry\\my software\Administrator\sc_installer_11\sc_installer.zip&quot;<br />
<br />
[HKEY_CURRENT_USER\Software\my software\12]<br />
&quot;LocalFileName&quot;=&quot;C:\PortableApps\NSISPortable\App\NSIS\Examples\Registry\\my software\Administrator\ScrollLicense_12\ScrollLicense.zip&quot;<br />
<br />
you see the value backsplash \ only one<br />
<br />
it has to be<br />
[HKEY_CURRENT_USER\Software\my software\11]<br />
&quot;LocalFileName&quot;=&quot;C:\\PortableApps\\NSISPortable\\App\\NSIS\\Examples\\Registry\\my software\\Administrator\\sc_installer_11\\sc_installer.zip&quot;<br />
<br />
sorry my english is very bad<br />
thanks a lot ......</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd February 2012, 16:15</div></div><div class="posttext">Does the registry plug-in not export reg files?<br />
<br />
Edit: Yes it does.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">2nd February 2012, 17:36</div></div><div class="posttext">FileOpen $R1 $R0 w<br />
<br />
	FileWrite $R1 'Windows Registry Editor Version 5.00$\r$\n$\r$\n'<br />
you create an ANSI file like this, then use &quot;REGEDIT4&quot; instead, your's is UTF-8 header<br />
<br />
and do a StrRep on \ to get \\<br />
<br />
yes Afrow it does, but i think he wants only a specifi entry</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ferdhy_raja</div><div class="date">2nd February 2012, 18:00</div></div><div class="posttext">sorry i have found this solution<br />
This script looking for value and replace it<br />
and this works fine<br />
<br />
${registry::Open} &quot;HKEY_CURRENT_USER\Software\my software&quot; &quot;/K=0 /V=1 /S=0 /B=1 /N='LocalFileName'&quot; $0<br />
	StrCmp $0 0 0 loop<br />
	MessageBox MB_OK &quot;Error&quot; IDOK close<br />
<br />
	loop:<br />
	${registry::Find} &quot;$0&quot; $1 $2 $3 $4<br />
	<br />
	StrCmp $4 '' close<br />
	${WordFind} &quot;$3&quot; &quot;settings&quot; &quot;E+2*}&quot; $6<br />
	${registry::Write} &quot;HKEY_CURRENT_USER\$1&quot; &quot;$2&quot; &quot;$EXEDIR$6&quot; &quot;$4&quot; $9<br />
	<br />
	goto loop<br />
<br />
	close:<br />
	${registry::Close} &quot;$0&quot;<br />
	${registry::Unload}<br />
	<br />
thanks a lot</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">2nd February 2012, 18:06</div></div><div class="posttext">idd, my bad, thats possible too with the registry function</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>