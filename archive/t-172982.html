<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Could not load: ...\myplugin.dll, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Could not load: ...\myplugin.dll NSIS Discussion" />
	
	<title> Could not load: ...\myplugin.dll [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Could not load: ...\myplugin.dll</div>
<hr />
<div class="pda"><a href="t-172982.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=172982">Could not load: ...\myplugin.dll</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">AmoebaMan17</div><div class="date">11th March 2004, 17:15</div></div><div class="posttext">I have created a plugin that uses ADO to update an MSAccess database at install time, for registration purposes.  The installation and plugin works fine on some workstations and doesn't work on others.<br />
<br />
The workstations that work have Visual Studio 2003 installed on them.<br />
<br />
Does anyone know what conditions will generate the message in the [Details...] button during installation: Could not load:...\myplugin.dll?<br />
<br />
I am able to create this installer on the machine which can not load the DLL during installation, and since the installer is able to load the DLL at install file creation time, I thought it would work.<br />
<br />
Another strange situation is that I am able to create a seperate .EXE file with the same code inside the exported _dllspec function, and that will run on the workstations in question.<br />
<br />
So, my guess is that it is some compiler/linker switch that is preventing this from working.<br />
<br />
My compiler switches are: <br />
/O1 /Ob1 /D &quot;WIN32&quot; /D &quot;NDEBUG&quot; /D &quot;_WINDOWS&quot; /D &quot;_USRDLL&quot; /D &quot;REGDEMO_EXPORTS&quot; /D &quot;_MBCS&quot; /D &quot;_WINDLL&quot; /GF /FD /EHsc /MT /GS /Gy /YX&quot;stdafx.h&quot; /Fp&quot;Release/regDemo.pch&quot; /Fo&quot;Release/&quot; /Fd&quot;Release/vc70.pdb&quot; /W3 /nologo /c /TP<br />
<br />
My linker switches are: <br />
/OUT:&quot;Release/regDemo.dll&quot; /VERSION:1.0 /INCREMENTAL:NO /NOLOGO /DLL /NODEFAULTLIB /OPT:NOWIN98 /ENTRY:&quot;_DllMainCRTStartup&quot; /IMPLIB:&quot;Release/regDemo.lib&quot; MSVCRT.lib comsupp.lib  kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib<br />
<br />
I am a programmer, but I am not an expert in compiling.<br />
<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th March 2004, 20:10</div></div><div class="posttext">Your DLL probably requires some runtime DLLs that are not present on those workstations. I would guess msvcr70.dll and some ADO DLLs. You can either distribute those DLLs, put them in $PLUGINSDIR before you call the plug-in or simply not use them and link statically.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AmoebaMan17</div><div class="date">11th March 2004, 20:57</div></div><div class="posttext">:up: :up: <br />
Thank you 1000 times!!  I have been fighting with<br />
getting anything to work and this fixed it!!<br />
<br />
You were exactly right!!  It was the msvcr70.dll.<br />
<br />
Is there a way to make VS.NET compile with an<br />
older C Runtime requirement?  Do I just need<br />
to find an older msvcrt.lib file to compile<br />
against?  My program requires Windows 2000 or<br />
greater, all of which should have msvcrt.dll of<br />
at least version 6, I assume.<br />
<br />
Also, as a lesser important question, how do I<br />
prevent the horrendous non-word-wrapping from<br />
happening again during my posts, without manually<br />
formatting my paragraphs?<br />
<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">11th March 2004, 23:57</div></div><div class="posttext">Doesn't Visual Studio .NET come a Win32 Project without the .NET runtime?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AmoebaMan17</div><div class="date">12th March 2004, 05:06</div></div><div class="posttext">When I created a new project, I chose to create an empty<br />
Win32 DLL project.  I don't think it requires the CLR, but <br />
I'm not sure.  But I also downloaded the source to a <br />
couple of plugins from the NSIS archive and then just <br />
inserted my functions in that code, leaving the compiler <br />
and linker settings alone, and that also wasn't working.<br />
<br />
I don't have my VS.NET compiler on this computer, but I <br />
have my MS VC++ 6.0.  I notice that the MSVCRT.LIB that is <br />
with MS VC++ 6.0 requires msvcrt.dll.  So, I am going to <br />
copy that onto my other computer and hopefully things will <br />
compile without the requirement of msvcr70.dll.<br />
<br />
-chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th March 2004, 10:38</div></div><div class="posttext">Instead of messing with libraries you can simply link statically. In MSVC 6 it's an option in the project setting. I'm sure that option exists in 7 too.<br />
<br />
To create smaller DLLs simply avoid using MSVCRT just like NSIS and all of its plug-ins are doing.<br />
<br />
As for the word wrap, the forum software must have gotten confused by the long line of compiler switches. It shouldn't do it, you don't have to break the lines on your own.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>