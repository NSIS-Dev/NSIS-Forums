<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Scheduled tasks, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Scheduled tasks NSIS Discussion" />
	
	<title> Scheduled tasks [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Scheduled tasks</div>
<hr />
<div class="pda"><a href="t-209917.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=209917">Scheduled tasks</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mynab</div><div class="date">9th March 2005, 13:09</div></div><div class="posttext">Hello,<br />
<br />
I am trying to setup scheduled tasks and properly set the user /password that I get through a custom page. I use a script that I got somewhere (can't remember exactly but probably here) that uses ITaskScheduler and ITask. I therefore does something like:<br />
<br />
System::Call '$R2-&gt;30(w &quot;user&quot;, w &quot;password&quot;)'<br />
<br />
but it does not seem to work. Does anyone has any success with this?<br />
<br />
Thanks,<br />
mynab</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th March 2005, 16:05</div></div><div class="posttext">Please search the forum in future...<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=147686&amp;highlight=task<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mynab</div><div class="date">10th March 2005, 17:03</div></div><div class="posttext">Please read the messages in the future...<br />
The thread you mention is the one I got the script from. I am trying to enhance this script to add a call to ITask to set the user and password on the task I create. Anyone?<br />
<br />
-Mynab</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th March 2005, 18:10</div></div><div class="posttext">Sorry but your original post did not contain information about the direct source.<br />
<br />
Try t instead of w<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th March 2005, 18:23</div></div><div class="posttext">According to MSDN, SetAccountInformation requires Unicode string, so w is ok.<br />
<br />
What's the return value of the method?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mynab</div><div class="date">11th March 2005, 08:21</div></div><div class="posttext">Not sure if it's right but what I did is add i.R9 at the end of my System::Call line and then do a MessageBox with $R9 and it displays 0 which is equal to S_OK. So it seems Windows does not complain.<br />
<br />
However if I then go to the scheduled tasks panel and run my task it fails. If I open the task set the password and then run it again it is OK so I guess I really have to set the password on the task even though the task should be run by the same user as the one that installs the software (Administrator in that case).<br />
<br />
mynab</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mynab</div><div class="date">16th March 2005, 15:34</div></div><div class="posttext">Anyone on this?<br />
<br />
mynab</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th March 2005, 20:50</div></div><div class="posttext">Can you post the complete code snippet so it can be tested?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mynab</div><div class="date">31st March 2005, 15:38</div></div><div class="posttext">Sorry kichik,<br />
<br />
did not see your post and switched to something else. Just tought I should give an update on this.<br />
<br />
I finally discovered and started to use the schtasks command. Much more powerful than the at command as it allows for everything I needed except multiple scheduling for the same task. It might not be available on older systems but it is at least on XP Pro and 2003 Server. Just type schtasks /? at the command prompt to get a detailed explanation of all the command line switches.<br />
<br />
Regards,<br />
mynab</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>