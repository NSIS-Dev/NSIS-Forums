<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Pass a variable value to uninstall.exe, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Pass a variable value to uninstall.exe NSIS Discussion" />
	
	<title> Pass a variable value to uninstall.exe [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Pass a variable value to uninstall.exe</div>
<hr />
<div class="pda"><a href="t-132847.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=132847">Pass a variable value to uninstall.exe</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">thoste</div><div class="date">23rd April 2003, 15:54</div></div><div class="posttext">During the Installation I assign a value to a variable:<br />
<br />
StrCpy $1 &quot;blah&quot;<br />
<br />
When I perform later an uninstall I want to access this<br />
variable content but it is empty.<br />
<br />
How could I pass such a value?<br />
<br />
Alternatively I assumed that it is possible to pass a value through the command line (as a parameter).<br />
<br />
But when I coded and called a link<br />
<br />
uninstall /DBLAH=XXX<br />
<br />
and inside the script:<br />
!ifndef BLAH<br />
!define BLAH &quot;AAA&quot;<br />
!endif<br />
...<br />
Section &quot;Uninstall&quot;<br />
...<br />
  MessageBox MB_OK &quot;BLAH=${BLAH}&quot;<br />
...<br />
SectionEnd<br />
<br />
..I got a window popup saying:<br />
BLAH=AAA<br />
and not as desired:<br />
BLAH=XXX<br />
<br />
Why?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">23rd April 2003, 16:10</div></div><div class="posttext">I recommend you that you use the &quot;!define&quot;<br />
<br />
When you use, for example:<br />
<br />
!define Name &quot;Dude&quot;<br />
<br />
Everytime that use put ${Name}, the compiler will replace it with <br />
&quot;Dude&quot;, even in the Uninstaller Section.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd April 2003, 16:33</div></div><div class="posttext">The /D switch is for makensis.exe not the generated installer. The installer supports only the /S and /NCRC command line switches. You should just pass the parameter as it is without any command line switches and then read it from $CMDLINE in the uninstaller. To get the parameters from the command line use GetParameters (http://nsis.sourceforge.net/Docs/AppendixB.html#B.3). Be aware though that if the user double clicks on your installer in Windows this parameter will not pass, therefore it might be a better idea to save this in the registry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thoste</div><div class="date">23rd April 2003, 17:29</div></div><div class="posttext">Hmmm, all the GetParameter variant doe not work:<br />
<br />
If I call uninstall with a paramter and try to<br />
call GetParameter the compilation of the NSIS script yields:<br />
<br />
&quot;Call must be used with function names starting with &quot;un.&quot; in the uninstall section.&quot;<br />
<br />
On the other side I cannot code unGetParameters in the Uninstall Section</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd April 2003, 18:01</div></div><div class="posttext">Well, as the error says the function name must start with &quot;un.&quot;. Just add the &quot;un.&quot; prefix to the function name - un.GetParameters. Also call it with this name - Call un.GetParameters.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thoste</div><div class="date">24th April 2003, 09:39</div></div><div class="posttext">This is exactly what I have done. Below you will find the exact line from my script:<br />
<br />
  Call un.GetParameters<br />
<br />
But I got from the compilation process:<br />
<br />
Processed 1 file, writing output:<br />
Error: resolving uninstall function &quot;un.GetParameters&quot; in &quot;uninstall section&quot;<br />
Note: uninstall functions must begin with &quot;un.&quot;, and install functions must not<br />
Error - aborting creation process<br />
<br />
So what more can I do ??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">virtlink</div><div class="date">24th April 2003, 10:03</div></div><div class="posttext">The compiled script generates two programs: the installer and the uninstaller. The compiler needs to know which functions, sections and page-instructions belong to the installer, and which belong to the uninstaller.<br />
Functions that belong to the uninstaller have &quot;un.&quot; before their name:<br />
<br />
Function un.GetParameters<br />
FunctionEnd<br />
<br />
To call such a function, use:<br />
<br />
Call un.GetParameters<br />
<br />
So you propably forgot to change the function's name to &quot;un.GetParameters&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thoste</div><div class="date">24th April 2003, 10:16</div></div><div class="posttext">If I understand it right the function <br />
GetParameters<br />
is available as a NSIS built-in function in the compiler<br />
whereas the function<br />
un.GetParameters<br />
is NOT a built-in function.<br />
<br />
So I have to <br />
- search for the original source of GetParameter somewhere in the   <br />
  NSIS installation,<br />
- then cut &amp; paste it to my own source, <br />
- prepend an &quot;un.&quot; and <br />
- recompile it. <br />
Is this you want to suggest ?<br />
<br />
Hmmm, very unconvenient.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">24th April 2003, 10:34</div></div><div class="posttext">That would be because you misunderstand :)<br />
<br />
GetParameters is NOT a built-in function, it is merely a function that is in appendix B of the documentation (http://nsis.sourceforge.net/Docs/AppendixB.html#B.3). Therefore it is a normal function like any other, if you want it in the uninstaller it needs un. in the name.<br />
<br />
I think it's about time we had a new prefix for functions, something like both.funcname.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">virtlink</div><div class="date">24th April 2003, 11:04</div></div><div class="posttext">those, you need to think simple. NSIS is simple too. ;)<br />
<br />
- GetParmeters is a function, as described in Appendix B, Section 3 (http://nsis.sourceforge.net/Docs/AppendixB.html#B.3).<br />
- un.GetParameters is the same function, but with un. in front of it's name. un.GetParameters is available to the uninstaller, not to the installer, while GetParameters is available to the installer ONLY.<br />
<br />
To make your script working, just paste the source of the GetParameters-function (http://nsis.sourceforge.net/Docs/AppendixB.html#B.3) into your script (if you haven't already), and change the function's name to 'un.GetParameters'.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>