<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with registerExtension.nsh, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with registerExtension.nsh NSIS Discussion" />
	
	<title> Problem with registerExtension.nsh [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with registerExtension.nsh</div>
<hr />
<div class="pda"><a href="t-284099.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=284099">Problem with registerExtension.nsh</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">abu_abdulla</div><div class="date">31st December 2007, 15:19</div></div><div class="posttext">Hi,<br />
<br />
I have small problem with registerExtension.nsh<br />
http://nsis.sourceforge.net/File_Association<br />
<br />
I use:<br />
${registerExtension} &quot;$INSTDIR\installer.exe&quot; &quot;.mcr&quot; &quot;MCR File&quot;<br />
${unregisterExtension} &quot;.mcr&quot; &quot;MCR File&quot;<br />
<br />
it gives me this error when compiling:<br />
<br />
Section: &quot;Uninstall&quot;<br />
!insertmacro: unregisterExtension<br />
Push: .mcr<br />
Push expects 1 parameters, got 2.<br />
Usage: Push string<br />
Error in macro unregisterExtension on macroline 2<br />
Error in script &quot;E:\Installer.nsi&quot; on line 250 -- aborting creation process</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st December 2007, 18:23</div></div><div class="posttext">It has a problem with quoting spaces, among other things. It also corrupts some variables. That script needs some work.<br />
<br />
I've fixed your specific problem in the Wiki. Try it now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">abu_abdulla</div><div class="date">31st December 2007, 18:42</div></div><div class="posttext">Appreciate your help.<br />
<br />
I have now this exception:<br />
!insertmacro: unregisterExtension<br />
Push: .mcr<br />
Push: MCR File<br />
Call must be used with function names starting with &quot;un.&quot; in the uninstall section.<br />
Usage: Call function_name | [:label_name]<br />
Error in macro unregisterExtension on macroline 3<br />
Error in script &quot;E:\Installer.nsi&quot; on line 280 -- aborting creation process<br />
<br />
<br />
I tried calling:<br />
${unregisterExtension} &quot;.mcr&quot; &quot;MCR File&quot;<br />
<br />
from &quot;Uninstall&quot; section and  un.onInit function.<br />
<br />
Did I missed anything?<br />
<br />
Thanks again</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st January 2008, 17:45</div></div><div class="posttext">Another problem with the script. It defines unregsiterExtension as an installer function instead of an uninstaller function.<br />
<br />
I've fixed that now as well. Try again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">abu_abdulla</div><div class="date">2nd January 2008, 05:50</div></div><div class="posttext">Thanks it works fine now.<br />
<br />
I just have small comment. It seems that reboot is required to refresh the icon of the file. I couldn't find a way to rebuild IconCache.db directly.<br />
<br />
In Windows XP<br />
<br />
    - Go to C:\Documents and Settings\{username}\Local Settings\Application Data<br />
    - Delete IconCache.db<br />
    - Reboot<br />
<br />
In Windows 9x<br />
<br />
    - Goto c:\windows<br />
    - Delete ShellIconCache<br />
    - Reboot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd January 2008, 18:39</div></div><div class="posttext">RefreshShellIcons (http://nsis.sourceforge.net/Docs/AppendixE.html#E.1.21) should do the trick.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">abu_abdulla</div><div class="date">3rd January 2008, 04:03</div></div><div class="posttext">Thanks for the help. It works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">abu_abdulla</div><div class="date">13th January 2008, 08:23</div></div><div class="posttext">I have another question. Is there a way to let clicking multiple files (at once) goes as parameters to one EXE instance instead of passing each file to one instance of the EXE file i.e.<br />
<br />
program.exe &lt;File1 Path&gt;<br />
program.exe &lt;File2 Path&gt;<br />
program.exe &lt;File3 Path&gt;<br />
<br />
And I need it to be:<br />
<br />
program.exe &lt;File1 Path&gt; &lt;File2 Path&gt; &lt;File3 Path&gt;<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th January 2008, 19:57</div></div><div class="posttext">That requires a shell extension.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>