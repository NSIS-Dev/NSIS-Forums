<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" &quot;Could not load: XXXX.dll&quot; error in log (possibly XP SP3 related), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  &quot;Could not load: XXXX.dll&quot; error in log (possibly XP SP3 related) NSIS Discussion" />
	
	<title> &quot;Could not load: XXXX.dll&quot; error in log (possibly XP SP3 related) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  &quot;Could not load: XXXX.dll&quot; error in log (possibly XP SP3 related)</div>
<hr />
<div class="pda"><a href="t-291913.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291913">&quot;Could not load: XXXX.dll&quot; error in log (possibly XP SP3 related)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kinar</div><div class="date">16th May 2008, 21:37</div></div><div class="posttext">I've run into an issue where an installer will not work on a machine that was previously &quot;hosed up&quot; by XP SP3.  Prior to the botched SP3 install, the computer had the software installed and was working fine.  resolving the botched SP3 install involved restoring to a previous restore point (i'm not sure if this was windows restore or a 3rd party restore util) which was also prior to the software being installed.<br />
<br />
However, the installer no longer works on this machine.<br />
<br />
I've left out all the gory details of the install log, however, normally it goes like this (I have highlighted the file names which I replaced to protect the innocent):<br />
<br />
Output folder: C:\Program Files\InstallDirectory\<br />
Extract: File1.exe... 100%<br />
Extract: File2.dll... 100%<br />
Extract: File3.dll... 100%<br />
Extract: File4.exe... 100%<br />
...<br />
Continue on with other files and directorys in the install dir<br />
...<br />
Create folder: C:\Documents and Settings\USER\Start Menu\Programs\ApplicationName<br />
Create shortcut: C:\Documents and Settings\USER\Start Menu\Programs\ApplicationName\Application.lnk<br />
Created uninstaller: C:\Program Files\InstallDirectory\uninst.exe<br />
Registering: C:\Program Files\InstallDirectory\File2.dll<br />
Registering: C:\Program Files\InstallDirectory\File3.dll<br />
Completed<br />
<br />
<br />
On the machine in question, it goes as follows (fails at the registering stage).<br />
<br />
Output folder: C:\Program Files\InstallDirectory\<br />
Extract: File1.exe... 100%<br />
Extract: File2.dll... 100%<br />
Extract: File3.dll... 100%<br />
Extract: File4.exe... 100%<br />
...<br />
Continue on with other files and directorys in the install dir<br />
...<br />
Create folder: C:\Documents and Settings\USER\Start Menu\Programs\ApplicationName<br />
Create shortcut: C:\Documents and Settings\USER\Start Menu\Programs\ApplicationName\Application.lnk<br />
Created uninstaller: C:\Program Files\InstallDirectory\uninst.exe<br />
Could not load: C:\Program Files\InstallDirectory\File2.dll<br />
Could not load: C:\Program Files\InstallDirectory\File3.dll<br />
Completed<br />
<br />
<br />
Upon checking the Install directory, it is empty which explains the could not load error, however, what could possibly cause the installer to report that it extracted the file but the file not actually get extracted?<br />
<br />
Any thoughts/ideas/help would be greatly appreciated...<br />
<br />
I realise that the answer I probably am going to get is something along the lines of &quot;reinstall XP&quot; or &quot;no way of knowing what is happening&quot; but if anyone has any other advice, please help.<br />
<br />
TIA,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th May 2008, 22:15</div></div><div class="posttext">I'll give you both. No way and you need to reinstall XP. No way because it'd tell you if it couldn't extract, so something is probably deleting the files later. And reinstall XP because it fails loading due to missing dependencies.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">{_trueparuex^}</div><div class="date">16th May 2008, 22:29</div></div><div class="posttext">Originally posted by kinar <br />
I realise that the answer I probably am going to get is something along the lines of &quot;reinstall XP&quot; or &quot;no way of knowing what is happening&quot; but if anyone has any other advice, please help. <br />
Luckily we don't get much that kind of answers around here. :) <br />
<br />
The first thing that comes to mind is that your AV thinks those files are malware and is removing them, but then you probably should get a warning from the AV.<br />
<br />
You could try to run to Filemon (http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx). It's a tool from Microsoft to monitor system file activity.<br />
<br />
Just use &quot;File2.dll;File3.dll&quot; as Include filter in Filemon and run the installer again. That should tell exactly what's happening to those files.<br />
<br />
Edit: Lol kichik! Though you are might be right.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kinar</div><div class="date">16th May 2008, 22:38</div></div><div class="posttext">kichik, thanks for the response.  As a developer, I certainly appreciate seeing someone else use the &quot;no way in hell that is happening&quot; response (I use it frequently).  I'll look into what might possibly be removing them.<br />
<br />
Also, {_trueparuex^}, thanks for the suggestion of FileMon.  I am familiar with it from back before MS bought sysinternals.<br />
<br />
Unfortunately this is not a machine that I can sit down in front of so I may not ever find a solution, but I'll see if I can arrange to remote into the machine on monday and poke around a bit.<br />
<br />
I'll make sure to post back here any results.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kinar</div><div class="date">21st May 2008, 20:58</div></div><div class="posttext">As usual, it turns out that I got some bad information.<br />
<br />
The files are extracted to the installation directory as expected.<br />
<br />
The DLL registration failure is being caused by the fact that vcredist_x86 is not properly installing the MFC80 dlls which causes the application dlls to fail registration.<br />
<br />
The funny thing about all of this is that while searching the forums prior to posting, I found all 80 million posts about dll registration failing due to missing dependancies but had assumed it wasn't the issue due to the information I had previously been given.<br />
<br />
Sometimes it is quite amazing how things work out.<br />
<br />
Thanks one last time for the help guys.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>