<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with the banner, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with the banner NSIS Discussion" />
	
	<title> Problem with the banner [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with the banner</div>
<hr />
<div class="pda"><a href="t-267355.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267355">Problem with the banner</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">arfgh</div><div class="date">8th March 2007, 02:04</div></div><div class="posttext">Yes<br />
<br />
i am using the banner plugin to show some like for example<br />
<br />
&quot;Installation sucesfull&quot;<br />
<br />
and it work so fine. But sometimes before the banner it is showed, it appear in a so fast blink another banner telling<br />
<br />
&quot;Unpacking data 0%&quot;<br />
<br />
Of course i not like this not needed blink banner it appear.<br />
<br />
Can someone tell me how prevent this banner not appear ?<br />
i am using the last version of nsis and my installer is compressed with lzma<br />
<br />
thx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arfgh</div><div class="date">8th March 2007, 13:11</div></div><div class="posttext">nobody know how to disable this anomaly ?<br />
<br />
let me tell more info about my script..<br />
<br />
i not use code on the section because i dont want to show the default installer. I only want to show the final banner &quot;installation succesfull&quot;, because my installers are not so big. 5 MB maximun.<br />
<br />
Ths is the code how i use the banner. Tell me if is incorrect<br />
<br />
Banner::show /NOUNLOAD 'Installation successfull !'<br />
IntOp $0 $0 + 1<br />
Sleep 10<br />
StrCmp $0 100 0 -2<br />
Banner::destroy<br />
abort<br />
FunctionEnd<br />
<br />
Then all the code in into the .onInit<br />
and there is where i use 2 plugins.. advsplash + banner<br />
the problem is that internal banner from nsis it appear telling &quot;Unpacking data 0%&quot;. And i dont know why this appear, because if i not use the banner plugin, it not appear.<br />
<br />
Really strange... help !!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th March 2007, 18:57</div></div><div class="posttext">It's because you're using solid compression and decompressing something located at the end of the compressed data block early in installer execution. This could happen if .onInit is located at the bottom of the script and it uses a plug-in. To solve it, .onInit should be moved, or ReserveFile should be used.<br />
<br />
Files are added to the compressed data block as they're seen in the script. If a file appears last in the script, it'll be the last file on the data block. Because solid compression compresses the entire data block in one pass, it also has to decompress the entire data block to get to its end. Normally, files are decompressed as they're decompressed because both their extraction order and compression order matches. However, if for some reason, a piece of code which extracts a file is located at the bottom of the script and runs earlier than extraction code above it in the script, you get a delay at the first extraction. It has to decompress the entire block.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arfgh</div><div class="date">8th March 2007, 21:12</div></div><div class="posttext">Well<br />
<br />
i can insert all the code not on .onInit, but in this case the installer window it appear. Include if i use the HideWindow, a so fast blink of the installer window flash in and flash out.<br />
<br />
For this reason i inserted all the code into the .onInit<br />
I go to try to make the changes you told to see if i can prevent this &quot;unpacking date&quot; not appear.<br />
<br />
But is so strange problem, because not allways happend.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arfgh</div><div class="date">8th March 2007, 23:41</div></div><div class="posttext">How can i see this last file of the compressed solid block i am using at first ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th March 2007, 05:35</div></div><div class="posttext">You may use ReserveFile (http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1.7)  as kichik suggested.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arfgh</div><div class="date">9th March 2007, 09:24</div></div><div class="posttext">Well<br />
i used the ReserveFile with a file it is in the end part of the solid block. But the &quot;Unpacking Date&quot; still appears. How i told, this nsis banner not come all the times.<br />
<br />
At this time, the solution i found to preserve this, is insert all my installer code in a Section and leave the .onInit.<br />
But doing that i get other issue with the HideWindow command.<br />
<br />
Yes,i want to hide the installer window, but before the HideWindow it take effect, a so fast blink of the window installer is pop up with a so ugly effect.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th March 2007, 09:31</div></div><div class="posttext">Reserve all plugins (DLLs) you're using in your installer.<br />
<br />
As for the fast blink you're referring in other post too, I'm not able to reproduce it or I'm not so fast to see it ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th March 2007, 11:23</div></div><div class="posttext">There's no need in moving the code into sections. All you have to do is move .onInit to the top of the script or use ReserveFile for the files used by .onInit on the top of the script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arfgh</div><div class="date">10th March 2007, 14:08</div></div><div class="posttext">Red Wine<br />
<br />
can i Reservefile for the 2 plugins i am using ?<br />
can this solve the problem ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">10th March 2007, 15:39</div></div><div class="posttext">According to NSIS manual and to kichik's suggestion, either moving the .onInit function to the top of your script, or using ReserveFile must resolve your problem.<br />
  ReserveFile &quot;${NSISDIR}\Plugins\AdvSplash.dll&quot;<br />
  ReserveFile &quot;${NSISDIR}\Plugins\Banner.dll&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arfgh</div><div class="date">11th March 2007, 18:23</div></div><div class="posttext">ok i tried that, but i got the same results.<br />
<br />
Moving the code to the section the problem not appears, but, i got the popup window installer before the HideWindow not take effect.<br />
<br />
some other suggests ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arfgh</div><div class="date">13th March 2007, 21:51</div></div><div class="posttext">in the section i have a messagebox in the near begin of the section. This messagebox it appear if the installer detect a file it exist on the destination path.<br />
<br />
When that happend, is when the installer window it pop up so fast. This is the bug i want to solve.<br />
<br />
please help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th March 2007, 19:50</div></div><div class="posttext">Have you tried moving .onInit? That's the easiest solution available.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arfgh</div><div class="date">15th March 2007, 20:34</div></div><div class="posttext">if the code is on the .onInit, i just told what happend.<br />
<br />
i cant prevent with any way the &quot;unpacking data&quot; it appear.<br />
<br />
i used the reserveFile for the plugins and for the files. No succes. For this reason i moved all the code to the section. But there have this strange popup of the window installer.<br />
<br />
some solution to that ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th March 2007, 17:43</div></div><div class="posttext">But did you move .onInit to the top of the script file?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arfgh</div><div class="date">19th March 2007, 14:18</div></div><div class="posttext">Yes, the .onInit is after the first parameters as for example...<br />
<br />
<br />
Name blabla.exe<br />
compression lzma<br />
<br />
.onInit<br />
....<br />
...<br />
...<br />
...<br />
<br />
<br />
Section<br />
HideWindow<br />
....<br />
...here the code</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th March 2007, 19:25</div></div><div class="posttext">Attach the complete script. It'd be easiest to see what's wrong this way.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>