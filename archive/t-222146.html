<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Setup doesn't work properly, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Setup doesn't work properly NSIS Discussion" />
	
	<title> Setup doesn't work properly [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Setup doesn't work properly</div>
<hr />
<div class="pda"><a href="t-222146.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=222146">Setup doesn't work properly</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">aps</div><div class="date">22nd July 2005, 08:03</div></div><div class="posttext">I create the following simple script, that (in silent mode, as you can see) update some file while they are working, so that they would be ready to use on the next reboot.<br />
I have compiled the script, so that I obtained the setup correctly.<br />
I tried to launch the setup on my PC (with Win XP pro) and it works fine (create the installation directory with the file as listed). It also makes the Install.log, which I previously set to ON, boot on the code (NSIS_CONFIG_LOG) and on the script. <br />
I have 50 machine with XPembedded Operating System (they have all the same image inside, so they are identical), on which I have my application to be upgraded with this setup,<br />
and I noticed a strange behaviour: in fact ONLY ON SOME OF THEM, if I double click on the setup icon, it does not do nothing! Also the Install.log is not created!<br />
If I rename the directory containing the file to be updated, and launch the setup, it will create the new dir with the new files inside (and the install.log too), but if I relaunch the same setup, it doesn't work any more, and it doesn't create (update) the install.log file too!<br />
<br />
Has someone any ideas or suggestion for this strange case?<br />
Thanks in advance!<br />
Aps<br />
<br />
<br />
!define PRODUCT_NAME &quot;MySetup&quot;<br />
!define PRODUCT_VERSION &quot;1.0&quot;<br />
!define PRODUCT_PUBLISHER &quot;bla&quot;<br />
!define PRODUCT_WEB_SITE &quot;http://www.bla.com&quot;<br />
!define PRODUCT_DIR_REGKEY &quot;Software\Microsoft\Windows\CurrentVersion\App Paths\MyProj.exe&quot;<br />
<br />
SetCompressor lzma<br />
<br />
Name &quot;${PRODUCT_NAME} ${PRODUCT_VERSION}&quot;<br />
OutFile &quot;MySetup.exe&quot;<br />
InstallDir &quot;C:\Dir1\Dir2\MySetup&quot;<br />
Icon &quot;${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico&quot;<br />
SilentInstall silent<br />
InstallDirRegKey HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot;<br />
<br />
Section &quot;MyProj&quot; SEC01<br />
Logset on<br />
  SetOutPath &quot;C:\Dir1\Dir2&quot;<br />
  Rename $INSTDIR\MyProj.exe $INSTDIR\MyProj_old.exe<br />
  Delete /REBOOTOK $INSTDIR\MyProj_old.exe<br />
  Rename $INSTDIR\Pippo.dll $INSTDIR\Pippo_old.dll<br />
  Delete /REBOOTOK $INSTDIR\Pippo_old.dll<br />
  SetOverwrite ifdiff<br />
  File &quot;..\MyProj.exe&quot;<br />
  File &quot;..\Pippo.dll&quot;<br />
  File &quot;..\Pluto.dll&quot;<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd July 2005, 18:48</div></div><div class="posttext">Maybe something writes to the registry value in ${PRODUCT_DIR_REGKEY} and changes the installation directory. Try running it with Filemon (http://www.sysinternals.com/Utilities/Filemon.html) to see which files it's working with.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aps</div><div class="date">25th July 2005, 10:28</div></div><div class="posttext">Thanks a lot for the suggestion! Now I'm going to use FileMon...<br />
<br />
If I use the wizard to make the setup, it introduces the following lines in the script created:<br />
<br />
Section -Post<br />
  WriteRegStr HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot; &quot;C:\dir1\dir2\MyProj.exe&quot;<br />
SectionEnd<br />
<br />
What does it mean?<br />
I didn't use it in my previous script...is it necessary?<br />
<br />
Thanks for the help!<br />
Aps</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th July 2005, 21:10</div></div><div class="posttext">It writes the installation directory into the registry so InstallDirRegKey will use it the next time the user runs the installer. However, it should write $INSTDIR and not an hard-coded path.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>