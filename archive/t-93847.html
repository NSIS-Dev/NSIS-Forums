<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Full color icon, XP style without recompiling and smaller header size, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Full color icon, XP style without recompiling and smaller header size NSIS Discussion" />
	
	<title> Full color icon, XP style without recompiling and smaller header size [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Full color icon, XP style without recompiling and smaller header size</div>
<hr />
<div class="pda"><a href="t-93847.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=93847">Full color icon, XP style without recompiling and smaller header size</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th July 2002, 18:49</div></div><div class="posttext">I have worked on this for quite a while now, but it is finally ready :)<br />
<br />
This is a modification of NSIS 1.98.<br />
<br />
I have added:<br />
<br />
* Ability to add XP manifest without recompiling (XPStyle on)<br />
* Support for all types of icons. Uninstall icon shuold still be the same structure as the installer icon, if used. You can even add an icon with 3 different sizes in it (this mod's installer includes one with 9).<br />
* Stripping of unused resources from the exe header. For example, if you didn't use the license page, the license dialog resource will be stripped down resulting in an even smaller exe header.<br />
* ${NSISDIR} - A constant holding the path in which NSIS is installed, on the compiler machine of course...<br />
<br />
I am suggesting this mod as NSIS 1.99.<br />
<br />
Sunjammer kindly helped me by hosting the file on his NSIS archive.<br />
<br />
You can download it from:<br />
http://www.clantpa.co.uk/nsis/wiki/index.php/Nsis199<br />
<br />
I hope you enjoy it :)<br />
   KiCHiK</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">8th July 2002, 19:41</div></div><div class="posttext">Does XPStyle on work when you have CRC check on?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">8th July 2002, 20:06</div></div><div class="posttext">Yes, all of the above work with CRC check on.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">9th July 2002, 00:20</div></div><div class="posttext">but i cant use this with nsis 2.0 alpha?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">9th July 2002, 00:25</div></div><div class="posttext">${NSISDIR} is nice, thank you!<br />
<br />
about my previously posted question. i'm really hot for the fullcolor icons, but i just modified my code for some new features of 2.0 alpha. maybe there could be a new alpha with your features beside the 1.99 ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">9th July 2002, 02:14</div></div><div class="posttext">If you let me know which files you changed for each new feature, I will try to incorporate them into 2.0a.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">spanky</div><div class="date">9th July 2002, 03:38</div></div><div class="posttext">kichik,<br />
Using your mod I get an error using InstallColors.  It worked with NSIS 1.98 but it doesn't work with yours.<br />
<br />
I'm using:<br />
InstallColors 0066C8 000000<br />
<br />
From MakeNSISW:<br />
&quot;InstallColors: fg=0066C8 bg=000000<br />
Usage: InstallColors (/windows | (foreground_color background_color))<br />
Error in script &quot;poop.nsi&quot; on line 86 -- aborting creation process&quot;<br />
<br />
Any knowledge as to why this occurs?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">9th July 2002, 08:54</div></div><div class="posttext">Keep me posted about whether or not this *is* a bug, if it is I'll list it as a known bug on the info page about this mod.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">9th July 2002, 09:07</div></div><div class="posttext">Rainwater said:<br />
If you let me know which files you changed for each new feature, I will try to incorporate them into 2.0a.<br />
<br />
1.98 -&gt; KiCHiK 1.99 diffs attached (placed here so anyone who cares can see). The zip contains a text file listing the changed files plus the diffs of the changed files, I haven't had time to strip out the unchanged code so the diff files are complete files if you see what I mean.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th July 2002, 09:43</div></div><div class="posttext">Thanks spanky,<br />
<br />
It was indeed a bug, and a very stupid one may I add...<br />
I have fixed this bug and another one relating the default uninstall icon. I have also updated the makefiles (I hope I did it right...).<br />
<br />
I hope the new file will be up soon on Sunjammer's NSIS Archive. I will let you know when it is there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">9th July 2002, 09:52</div></div><div class="posttext">The archive has now been updated with the new version of KiCHiK's 1.99 NSIS mod.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th July 2002, 12:03</div></div><div class="posttext">Sunjammer, you forgot the core of it all in the diffs zip you posted earlier. You forgot ResourceEditor.cpp and ResourceEditor.h.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">9th July 2002, 12:24</div></div><div class="posttext">Ahha of course that would be because I posted differences and forgot additions, twit. Well you've pointed it out now, can't believe I forgot to mention that!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CodeSquid</div><div class="date">9th July 2002, 16:44</div></div><div class="posttext">I'm using the packhdr command to further reduce the size of the installer. I'm using the latest version of UPX for exe compression.<br />
<br />
But everytime I use !packhdr in my scripts, NSIS 1.99 always reports this error message:<br />
&quot;Locating install icon after compress: find_data_offset: error searching data -- failing!&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">9th July 2002, 17:48</div></div><div class="posttext">Originally posted by CodeSquid <br />
I'm using the packhdr command to further reduce the size of the installer. I'm using the latest version of UPX for exe compression.<br />
<br />
But everytime I use !packhdr in my scripts, NSIS 1.99 always reports this error message:<br />
&quot;Locating install icon after compress: find_data_offset: error searching data -- failing!&quot; <br />
<br />
It sounds like there could be a problem with the patch that is stripping the unused resources.  Maybe people should use upx to take care of that?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th July 2002, 18:43</div></div><div class="posttext">My patch doesn't ever remove the icon. I don't see any reason for it to fail. The icon is there. Did this work with NSIS 1.98? Maybe UPX compresses the icons as well. But then, how could Windows read them?<br />
<br />
Please send me the script so I can look further into it.<br />
<br />
EDIT:<br />
I think I know what is wrong. Maybe UPX compress all of the icon resource together, and doesn't align each raw data section size to 8 like my resource editor does.<br />
<br />
I will look into it, and if this is the case I will just rewrite the find_data_offset function to match this case.<br />
<br />
Does it only happen when you add an icon file with more than one icon?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CodeSquid</div><div class="date">9th July 2002, 19:01</div></div><div class="posttext">Yes, it worked before with 1.98<br />
When I call upx with --compress-icons=0 1.99 still doesn't work<br />
<br />
EDIT:<br />
My icon files have more than one icon: 32x32 and 16x16, each in 16 and 256 colors</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th July 2002, 19:11</div></div><div class="posttext">OK, so that must be the problem... UPX eliminates the space between icons... I will fix this bug tomorrow.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">spanky</div><div class="date">9th July 2002, 21:35</div></div><div class="posttext">Normally, compressing the icons is not a good idea.<br />
Use this instead:<br />
!packhdr tmp.dat &quot;upx --best --crp-ms=500000 --color --compress-icons=0 tmp.dat</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th July 2002, 16:36</div></div><div class="posttext">I have found out what the problem is, and it is a pretty funny one :)<br />
It seems UPX doesn't eliminate the space between icons, it adds more! :eek: Some compression eh?<br />
<br />
I won't make the fix today, maybe tomorrow. If anyone else wants to do it instead of me here is my idea (if you have a better one please post it):<br />
The uninstaller icon data should be saved as an array of variable length entries. Each entry of the array would contain:<br />
1) The size of the icon<br />
2) The offset in which it should saved<br />
3) The icon data itself<br />
<br />
generate_uninstall_icon_data would build this array and leave the offsets entries empty. After the file is compressed using UPX or whatever (which is the last the time the exe header can change) the offsets will be written into this array. To find the offsets you will have to write a function like get_addr_of_res.<br />
<br />
The function generating the uninstaller must change too (in the exe header).<br />
<br />
If all this is done it would be useless for get_addr_of_res to search for the icon offset, and to be called after each use of CResrouceEditor.<br />
<br />
If someone is ready to this please tell me. If I get no PMs/E-Mail until tomorrow I will do it my self.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pjw62</div><div class="date">10th July 2002, 20:40</div></div><div class="posttext">I haven't seen your code yet, but it sounds a bit special sir.<br />
<br />
You are a good programmer (or I am extraordinarily poor) and I must admit, I had a go at it and  could not get it working very cleanly.  Eventually I had to settle with not being able to add named entries, 'cause I just couldn't get them to work.<br />
<br />
I am downloading yours now and will take a quick peep ;)<br />
<br />
Thanks/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th July 2002, 11:05</div></div><div class="posttext">Thanks pjw62 :D<br />
<br />
If you need some resources of the resource section strcture PM me, I have stumbled ascross some while studying the subject ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th July 2002, 18:47</div></div><div class="posttext">OK, it is ready!<br />
InstallColors, UPX, multiple icons, zlib and bz2. It all works now. This time I wrote the icons handling functions a bit more general so it should be able to handle even the craziest compiler/packer unless it compresses the icons (I hope :D ).<br />
<br />
I have also added an error message if the NSIS path could not be found in the registry. It does not stop compilation, but I at least now you will know why your include doesn't work.<br />
<br />
I have asked Sunjammer to upload the new file. He'll let you know when it is there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">11th July 2002, 19:06</div></div><div class="posttext">KiCHiK's new version has been uploaded. The direct link to the file is http://www.clantpa.co.uk/nsis/hosted/nsis199.exe.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">11th July 2002, 19:10</div></div><div class="posttext">Originally posted by kichik <br />
I have also added an error message if the NSIS path could not be found in the registry. It does not stop compilation, but I at least now you will know why your include doesn't work.<br />
<br />
That is not needed.  You don't need to read from the registry to get the directory.  Just change that code in build.cpp to this:<br />
<br />
<br />
{<br />
char szNSISDir[NSIS_MAX_STRLEN],*fn2;<br />
GetModuleFileName(NULL,szNSISDir,sizeof(szNSISDir));<br />
fn2=strrchr(szNSISDir,'\\');<br />
if(fn2!=NULL) *fn2=0;<br />
definedlist.add(&quot;NSISDIR&quot;, (char*)szNSISDir);<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th July 2002, 19:23</div></div><div class="posttext">Thanks Rainwater, it is indeed better. Done.<br />
<br />
EDIT: Uploaded</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mlbl</div><div class="date">12th July 2002, 16:03</div></div><div class="posttext">I think that the stuff that you stripped down causes a problem with having a custom Enabled/Disabled bitmap for the checkboxes/option boxes.<br />
<br />
It worked fine in 1.98 but this feature was broken in your copy, hope you can fix it ASAP. Other than that everything else works fine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th July 2002, 16:22</div></div><div class="posttext">Err... I can't beleive I did that stupid mistake again! I forgot to call get_addr_of_resource after altering rsources...<br />
A new version will be uploaded ASAP.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T(+)rget</div><div class="date">14th July 2002, 20:25</div></div><div class="posttext">I was wondering whether or not u could add that Brand Image thingy to your version of NSIS as well with full like bmp support like with da icons if poss.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T(+)rget</div><div class="date">14th July 2002, 23:25</div></div><div class="posttext">lol soz<br />
<br />
Anyway like I said it'll be nice to see that Brand Image thing included with this version of NSIS you know the image on the side of the installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mlbl</div><div class="date">15th July 2002, 01:48</div></div><div class="posttext">Originally posted by T(+)rget <br />
lol soz<br />
<br />
Anyway like I said it'll be nice to see that Brand Image thing included with this version of NSIS you know the image on the side of the installer. <br />
<br />
That would probably make the installer look a bit weird. In it's current form, the installer is pretty much simple and small in size. Adding a branding image will also make the installer size much larger and i think NSIS looks great at the moment. If you're looking for an installer that supports branding, try Inno Setup instead - www.jrsoftware.org</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T(+)rget</div><div class="date">15th July 2002, 21:05</div></div><div class="posttext">Yeah but you could do a switch so that if you don't include it in your nsi file it won't use the coding for it or if you put in your nsi file BrandImage off.<br />
<br />
I just think it'll be a nice addition to NSIS which most people would like to use say like if the installer is over 50mb or something you wouldn't notice much difference in size.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th July 2002, 12:21</div></div><div class="posttext">Hi Target,<br />
<br />
I will do it. I was thinking of doing it with the first version but I had a problem with bitmaps...<br />
<br />
To mlbl, I will make it so the header size won't change. Don't worry, it is just a couple of lines of code...<br />
<br />
KiCHiK<br />
<br />
I have just noticed that Sunjammer has uploaded the new version with the Enabled/Disabled bitmap bug fixed.<br />
<br />
Thanks Sunjammer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">19th July 2002, 18:09</div></div><div class="posttext">I have just noticed that Sunjammer has uploaded the new version with the Enabled/Disabled bitmap bug fixed.<br />
<br />
Eh? I haven't done anything recently, what are you on about KiCHiK? :D <br />
<br />
KiCHiK is correct - if you consider six days ago to be &quot;recently&quot; :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T(+)rget</div><div class="date">20th July 2002, 00:09</div></div><div class="posttext">lol <br />
<br />
Thanks for your reply about adding the Brand Image like that old version which that anyedit guy done NSIS v1.59BB (I did contact him about doing it for the latest version but he ain't got no time to do it)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th July 2002, 15:46</div></div><div class="posttext">A new version is out:<br />
<br />
- Full color bitmap for EnabledBitmap/DisabledBitmap are now supported. Bitmap size MUST be 20x20 now though... I hope that doesn't break anyone's script<br />
- Code now compiles and works with Borland compiler (would somone mind checking it on mingw too?)<br />
- Fixed a bug that caused makensis to crash if uninstall section was present and WriteUninstaller wasn't. Also made it so the uninstaller data won't be added unless WriteUninstaller was called.<br />
<br />
For Borland copmiler users:<br />
1) To compile my mod you need to change the current makefile and get it to compile ResourceEditor.cpp too.<br />
2) If you want to make your Borland compiled NSIS even smaller you can remove any resources of the RCData type (using Resource Hacker or another resource editor), and remove the .reloc section (using crayzee's wipe.reloc v1.40 (http://crayzee.cjb.net) or another aligner/wiper). UPX does a good job as well.<br />
<br />
I think that branding image support will take a little longer to make than I have thought in the first place. It is a little complicated... I will try to find some code on the Internet, but if I fail I will have to write it my-self and it will take some time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T(+)rget</div><div class="date">20th July 2002, 16:46</div></div><div class="posttext">Here's the download link to the old Brand Image using NSIS v1.59<br />
<br />
NSIS Brand Image (http://prdownloads.sourceforge.net/nsisphouse/nsis159BB.exe?download)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th July 2002, 20:50</div></div><div class="posttext">The problem with this mod is that it forces you to use branding image. I don't want to do that. I want to give it as an option.<br />
To do this I need to learn how to edit dialog resources. And of course, like everything else with Microsoft, it isn't that simple...<br />
I haven't found any class/code that already does this so I guess I will have to write my own class. I hope it won't take too long. If I write this class I will be able to implement font changing as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">21st July 2002, 15:50</div></div><div class="posttext">I was away so KiCHiK's new NSIS 1.99 version has literally only just been uploaded to my archive. Keep it up KiCHiK - that's the sixth version I've uploaded so far :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T(+)rget</div><div class="date">21st July 2002, 21:45</div></div><div class="posttext">Yeah do it your way mate so we can change fonts as well :D that'll be nice. Can't wait for this version to come out!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st July 2002, 22:50</div></div><div class="posttext">It is almost ready. I just want to make sure everything works as it should, update the documents, and test it on Borland compiler.<br />
<br />
It will probably be uploaded tomorrow.<br />
<br />
I have attached a JPEG teaser, enjoy :D<br />
<br />
BTW, In my version you can replace the bitmaps during installation, so you can put a different bitmap for every page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd July 2002, 12:52</div></div><div class="posttext">Ready!<br />
<br />
- Added SetFont<br />
- Added AddBrandingImage, and SetBrandingImage<br />
- 'SpaceTexts none' now causes no space texts to appear<br />
- Added gfx.nsi example file<br />
<br />
Will be uploaded soon... Done!<br />
<br />
Enjoy :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">22nd July 2002, 13:03</div></div><div class="posttext">It is now uploaded, information is here (http://www.clantpa.co.uk/nsis/wiki/index.php/Nsis199) and here is a direct download link (http://www.clantpa.co.uk/nsis/hosted/nsis199.exe).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CodeSquid</div><div class="date">22nd July 2002, 14:27</div></div><div class="posttext">KiCHiK, you're the greatest!<br />
<br />
There's only one thing left which could be very useful: Merge NSIS 1.99 and NSIS 2.0a1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd July 2002, 14:44</div></div><div class="posttext">Thanks man :D<br />
<br />
But I have to disagree... There are two things left!<br />
I need to make nsis support multiple languages too :)<br />
<br />
To merge it with NSIS 2.0a1 I first have to talk to Rainwater but he doesn't answer =/<br />
I guess he is away or something...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">22nd July 2002, 15:37</div></div><div class="posttext">Great work!<br />
<br />
Another nice thing would be an integration of InstallOptions. Now the images &amp; font settings don't work with the InstallOptions dialogs.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T(+)rget</div><div class="date">22nd July 2002, 19:58</div></div><div class="posttext">Nice one m8e thanks for adding that support for me :D I am a happy bunny now :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mlbl</div><div class="date">23rd July 2002, 02:34</div></div><div class="posttext">The branding image works great, but it doesn't show up in the uninstaller.<br />
<br />
I just noticed something - in the uninstaller, the text between the cancel and uninstall button is not centered, i'm not sure if this small &quot;problem&quot; existed before, but it is as though there is an invisible button between the uninstall button and the text that causes it to be that way (not centered). Hope you can fix this (although it's very minor and can be ignored)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd July 2002, 09:33</div></div><div class="posttext">As the branding image is set at runtime (so it can be compressed along with all other files), you need to set it seperatly for the uninstaller. That means you have to create a function named un.onNextPage and control the image there.<br />
<br />
The space between between the cancel and the uninstall button is because the space is &quot;reserved&quot; for the back button. This space also exists in the license agreement page... Fixing it will enlarge the header size by 0.5KB so I prefer to leave this way as this is, like you said, a very minor bug.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd July 2002, 11:43</div></div><div class="posttext">New version:<br />
<br />
- Updated InstallOptions that support the SetFont option<br />
- Documented !error and !warning (hidden features)<br />
- Added !echo and !verbose<br />
- Added 'force' option for CRCCheck to make sure your installer is not corrupted (disables /NCRC command line option)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">23rd July 2002, 11:50</div></div><div class="posttext">Uploaded to the archive (http://www.clantpa.co.uk/nsis/) and ready for download (http://www.clantpa.co.uk/nsis/hosted/nsis199.exe) (if you're wondering why I posted this it's because AFAIK the archive is the only place that NSIS 1.99 is hosted, KiCHiK sends me updates directly, so until I post here you can't be sure unless you actually read the info on the archive which version is hosted there :D)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mlbl</div><div class="date">23rd July 2002, 11:52</div></div><div class="posttext">Ok thanks, i didn't thought of doing that :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thomas.lentzsch</div><div class="date">23rd July 2002, 12:42</div></div><div class="posttext">The branding image is not correctly resized on systems with a non standard font resolution (96 dpi). If you for example use large fonts (120 dpi), the image does not use the complete width of the installer window.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd July 2002, 13:19</div></div><div class="posttext">Thanks for letting me know Thomas.<br />
<br />
This sucks =/<br />
It means I will have to calculate the number of pixels required on the user's machine, which means the image could end up being very ugly...<br />
<br />
Well, it will be on the next version... Ugly, but it will be there :(<br />
<br />
Ready and uploaded</div></div><hr />


<div class="post"><div class="posttop"><div class="username">spanky</div><div class="date">23rd July 2002, 13:43</div></div><div class="posttext">Why in the world do people use custom font sizes!  arg.  It makes a lot of programs look ugly and distorted.<br />
<br />
kichik, thanks for breathing new life into NSIS.  Keep up the good work!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thomas.lentzsch</div><div class="date">24th July 2002, 08:38</div></div><div class="posttext">It's not a game playing with font resolutions. On many notebook computers you have lcd displays with a standard resolution which is NOT 96 dpi (the standard for desktop computers).<br />
<br />
The image resize problem is not so easy. You have to do complex transformations to resize an image with a goog result. This could not be an installer task. May be a parameter could turn off the resizing (e.g. AddBrandingImage top 40 noresize).<br />
<br />
I like the new Branding Image very much. The setup procedure is the first contact a user has with the software. So an image in the installer can give a much better look.<br />
<br />
---<br />
<br />
What about setting fonts in the install options DLL. We launch the installer with a first page build with the install options DLL. Is there any chance to use the font (SetFont command) in the DLL?<br />
<br />
May be it could be usefull to add another font - the LicenceFont. The licence agreement is a formatted text document. Changing the installer font can result in a re-formatting of the document.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th July 2002, 09:34</div></div><div class="posttext">Currently I am just using LoadImage(0, filename, IMAGE_BITMAP, width, height, LR_LOADFROMFILE). If you know another way that resiezs better, besides resizing it myself, please tell me.<br />
<br />
In the latest version I released install options takes the font from the NSIS window.<br />
<br />
In my next version I intend to make the license agreement use RTF instead of text. Correct me if I am wrong but this will give you the option to change the font. If not the font, at least its size.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">24th July 2002, 12:22</div></div><div class="posttext">Will it also be possible to click hyperlinks in the License Text?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th July 2002, 12:39</div></div><div class="posttext">If RTF supports it...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th July 2002, 16:32</div></div><div class="posttext">I have built another example of branding usage.<br />
This time it uses a nsis header file I made that defines some very helpful macros.<br />
<br />
This is all you need:<br />
!include &quot;branding.nsh&quot;<br />
<br />
Function .onInit<br />
	!insertmacro BI_INIT $2<br />
FunctionEnd<br />
<br />
Function .onNextPage<br />
	!insertmacro BI_NEXT<br />
FunctionEnd<br />
<br />
Function .onPrevPage<br />
	!insertmacro BI_PREV<br />
FunctionEnd<br />
<br />
!insertmacro BI_LIST<br />
!insertmacro BI_LIST_ADD &quot;bitmap1.bmp&quot;<br />
!insertmacro BI_LIST_ADD &quot;bitmap2.bmp&quot;<br />
!insertmacro BI_LIST_ADD &quot;bitmap3.bmp&quot;<br />
!insertmacro BI_LIST_ADD &quot;bitmap4.bmp&quot;<br />
!insertmacro BI_LIST_ADD &quot;bitmap5.bmp&quot;<br />
!insertmacro BI_LIST_END<br />
<br />
It can be used from within sections if you wish too. Just add !insertmacro BI_NEXT anywhere.<br />
It also works with the uninstaller.<br />
<br />
Have a look at gfx.nsi inside the zip file to see an example of usage.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th July 2002, 19:12</div></div><div class="posttext">Does anyone use .onVerifyInstDir? If so, don't use it with SpaceTexts none or it will not work.<br />
<br />
Sorry about this...<br />
<br />
This bug will be fixed in my next version (merged with 2.0a1 finally :D)<br />
<br />
Another one :(<br />
Switching from non custom to custom installation will not show the component selection sub-window if SpaceTexts none was specified...<br />
<br />
This too will be fixed in the next version</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SmartyMan</div><div class="date">25th July 2002, 01:13</div></div><div class="posttext">Originally posted by kichik <br />
Currently I am just using LoadImage(0, filename, IMAGE_BITMAP, width, height, LR_LOADFROMFILE). If you know another way that resiezs better, besides resizing it myself, please tell me.<br />
Maybe you will get better results when centering the image in the foreseen range of the window instead of resizing it?<br />
<br />
<br />
In my next version I intend to make the license agreement use RTF instead of text. Correct me if I am wrong but this will give you the option to change the font. If not the font, at least its size. <br />
Of course the RichEditCtrl can use different Fonts, but I hope that you dont attempt to ignore/overwrite the font settings given in the .rtf by the author?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mlbl</div><div class="date">25th July 2002, 03:44</div></div><div class="posttext">If it's possible maybe try to detect the DPI, if it's 96 DPI then use branding image, if it doesn't match 96 DPI - disable it (or have an option for it).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th July 2002, 10:10</div></div><div class="posttext">Just cenetering the image won't give a good result because not all of the image will be shown. I will use StreachBlt in my next version, it should resize better.<br />
<br />
Don't worry, I won't overrun any settings in the RTF...<br />
<br />
The branding image control is added at script compile time, so it can not be disabled at runtime.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SmartyMan</div><div class="date">25th July 2002, 14:03</div></div><div class="posttext">Originally posted by kichik <br />
Just cenetering the image won't give a good result because not all of the image will be shown. I will use StreachBlt in my next version, it should resize better.<br />
Maybe we talk about different things, so I have made a small demo showing &quot;my&quot; way of displaying the image and also a possible solution for the details-window problems.<br />
Resize the window to see the effect, and if you arent sure how this works, take a look in the included source.<br />
<br />
Don't worry, I won't overrun any settings in the RTF...<br />
OK :)<br />
BTW: did you ever thought about concepts allowing more than one &quot;licence&quot; page?<br />
Example: you might want to display a short description of the software, then the licence.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SmartyMan</div><div class="date">25th July 2002, 14:06</div></div><div class="posttext">Originally posted by kichik <br />
If RTF supports it... <br />
Search the VisualStudio help (aka MSDN) for &quot;EM_AUTOURLDETECT&quot; and see if you like what you read.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">25th July 2002, 15:00</div></div><div class="posttext">Originally posted by SmartyMan <br />
<br />
OK :)<br />
BTW: did you ever thought about concepts allowing more than one &quot;licence&quot; page?<br />
Example: you might want to display a short description of the software, then the licence. <br />
An introduction screen would be very nice! :D<br />
<br />
What I would also like to see is a modern style user interface for NSIS, just like all other instllers (Microsoft, Inno Setup, InstallShield). Look at the attechment.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mlbl</div><div class="date">25th July 2002, 15:28</div></div><div class="posttext">Originally posted by Joost Verburg <br />
<br />
An introduction screen would be very nice! :D<br />
<br />
What I would also like to see is a modern style user interface for NSIS, just like all other instllers (Microsoft, Inno Setup, InstallShield). Look at the attechment. <br />
<br />
NSIS was made to be small and simple (in terms of size and interface). Having an interface like Installshield/Inno setup would be really nice but if you prefer your installer to have that kind of interface, use it then. <br />
<br />
Inno setup is FREE and not only that, you can actually do quite a lot of stuff with it provided that you know how to with the use of the &quot;beefed&quot; up version of Inno Setup called My Inno Setup Extensions that allows you to use Pascal/Delphi like coding for your installer. It's not as easy to code though, compared to NSIS :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">25th July 2002, 16:46</div></div><div class="posttext">Originally posted by mlbl <br />
<br />
<br />
NSIS was made to be small and simple (in terms of size and interface). Having an interface like Installshield/Inno setup would be really nice but if you prefer your installer to have that kind of interface, use it then. <br />
<br />
Inno setup is FREE and not only that, you can actually do quite a lot of stuff with it provided that you know how to with the use of the &quot;beefed&quot; up version of Inno Setup called My Inno Setup Extensions that allows you to use Pascal/Delphi like coding for your installer. It's not as easy to code though, compared to NSIS :) <br />
I'm not going to use Inno Setup. NSIS scripting rocks :D Inno Setup is also quite large.<br />
<br />
This interface could just be an option. I think it's nicer and more user friendly. It's possible now to remove unused resources, so using another dialog for this interface is no problem.<br />
<br />
Unfortunately, I cannot code C++, otherwise I would have made such an interface immediately.<br />
<br />
I have also heard from other developpers that they don't use NSIS because of it's interface.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CodeSquid</div><div class="date">25th July 2002, 16:57</div></div><div class="posttext">Originally posted by Joost Verburg <br />
I have also heard from other developpers that they don't use NSIS because of it's interface. <br />
I can't believe it. I'm using NSIS (among other things) because of its good interface: Small, simple and without too much fancy stuff.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">25th July 2002, 17:15</div></div><div class="posttext">Originally posted by CodeSquid <br />
<br />
I can't believe it. I'm using NSIS (among other things) because of its good interface: Small, simple and without too much fancy stuff. <br />
Sure, NSIS has a good interface. ;) It's just a bit classic. I would prefer a more modern interface, like the other installers. :) Another good reason is that the user is familiar with such an interface.<br />
<br />
There is no need for a change in the standard interface, but it would be great as an option.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SmartyMan</div><div class="date">25th July 2002, 18:05</div></div><div class="posttext">The code<br />
	GetTempFileName $1<br />
	MessageBox MB_OK $1<br />
displays<br />
	G:\DOKUME~1\ADMINI~1\LOKALE~1\Temp\nst74.tmp<br />
on my system (german W2000/SP2).<br />
<br />
With this value of $1, the code<br />
	File /oname=$1 logo.bmp<br />
creates a tmp file with 0 bytes length, so code like<br />
	SetBrandingImage $1<br />
doesnt work.<br />
<br />
Replacing the &quot;GetTempFileName&quot; line by<br />
	StrCpy $1 &quot;G:\DOKUME~1\ADMINI~1\LOKALE~1\Temp\nst74.bmp&quot;<br />
or<br />
	StrCpy $1 &quot;G:\Dokumente und Einstellungen\Administrator\Lokale Einstellungen\Temp\nst74.bmp&quot;<br />
makes the code work, but using<br />
	StrCpy $1 &quot;G:\Dokumente und Einstellungen\Administrator\Lokale Einstellungen\Temp\nst74.tmp&quot;<br />
fails again.<br />
<br />
Another way to make the code work is<br />
	GetTempFileName $1<br />
	StrCpy $1 &quot;$1.bmp&quot;<br />
(resulting in &quot;G:\DOKUME~1\ADMINI~1\LOKALE~1\Temp\nst74.tmp.bmp&quot;)<br />
<br />
So it seems that the extension causes the problem...<br />
...BUT: compiling the unmodified gfx.nsi shows the images although the extension of $1 is &quot;.tmp&quot;<br />
<br />
I can live with this, but maybe other users will experience this problem too, so I thought I should drop a line.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SmartyMan</div><div class="date">25th July 2002, 18:08</div></div><div class="posttext">Is it possible to add an option for setting the margins and border used by the branding image?<br />
I would prefer brandings like shown in nsis-demo.zip (no margins at left/right/top when using &quot;top&quot; and no margins at top/bottom/left when using &quot;left&quot; instead of the 10-12 pixels used currently, and &quot;sunken&quot; style for the border)<br />
<br />
And: what is the reason for blurring the image? In the attached screenshot you may see what I mean (original at the top, nsis version below)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">25th July 2002, 18:43</div></div><div class="posttext">Originally posted by SmartyMan <br />
The code<br />
	GetTempFileName $1<br />
	MessageBox MB_OK $1<br />
displays<br />
	G:\DOKUME~1\ADMINI~1\LOKALE~1\Temp\nst74.tmp<br />
on my system (german W2000/SP2).<br />
<br />
With this value of $1, the code<br />
	File /oname=$1 logo.bmp<br />
creates a tmp file with 0 bytes length<br />
<br />
Of course, because File does not overwrite the temp file by default. You should use something like this:<br />
GetTempFileName $1<br />
SetOverwrite On<br />
File /oname=$1 logo.bmp<br />
SetOverwrite Off<br />
<br />
Hard coding a temp file name is not good, because the file has to be unique.<br />
SetBrandingImage $1<br />
The branding image has to be included when the installer is compiled, so you cannot use variables in the file name.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">25th July 2002, 18:50</div></div><div class="posttext">Originally posted by SmartyMan <br />
Is it possible to add an option for setting the margins and border used by the branding image?<br />
I would prefer brandings like shown in nsis-demo.zip (no margins at left/right/top when using &quot;top&quot; and no margins at top/bottom/left when using &quot;left&quot; instead of the 10-12 pixels used currently, and &quot;sunken&quot; style for the border)<br />
<br />
And: what is the reason for blurring the image? In the attached screenshot you may see what I mean (original at the top, nsis version below) <br />
Yeah, an option for setting margins would be great, but I think that the size of the current dialog is limited, this should be changed.<br />
<br />
When I zoom in at your image, I can see that it gets resized a litle bit (1 pixel), I think that's the problem (a bug).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th July 2002, 19:52</div></div><div class="posttext">OK, here is what I will do. I will add an option to load anohter dialog resource instead of the default dialog, an option to send a message to a dialog control, and replace SetBrandingImage with ChangeImage control_id image.<br />
<br />
This will allow to customize NSIS interface in every way you wish to and to set your own place/margin/styles (including centering) to the branding image.<br />
<br />
About the blurring, did you take note of the size reported by AddBrandingImage and used it?<br />
<br />
Another license page could be achived by using InstallOptions.<br />
<br />
Did I miss any question? I hope not :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Zaraza</div><div class="date">25th July 2002, 20:27</div></div><div class="posttext">Will all of this development going on (which is great), I think it's time to get yourself a proper project page on Sourceforge.net!<br />
<br />
BTW, I'm working on adding NSIS syntax highlighting support to the wonderful JEdit 4.0 text editor, so even 1 more tool with support NSIS. Hope to make it available soon.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th July 2002, 20:33</div></div><div class="posttext">Hmm... That could be a good idea, this way I won't bug Sunjammer so much anymore :D I am sure he will be glad not to upload 3 versions everyday ;)<br />
<br />
Signing up now...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">25th July 2002, 21:21</div></div><div class="posttext">Originally posted by kichik <br />
OK, here is what I will do. I will add an option to load anohter dialog resource instead of the default dialog.<br />
Without size limitations or margins? Great! :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SmartyMan</div><div class="date">26th July 2002, 12:08</div></div><div class="posttext">Of course, because File does not overwrite the temp file by default. You should use something like this<br />
Of cource i have proofed that there was no file with this name in my temp dir before i started the installer<br />
<br />
Hard coding a temp file name is not good, because the file has to be unique. <br />
This is correct, but which other options i have to spot the reason for the effect (0 bytes files) and to make the code work?<br />
The posting was ment as a report with maximum possible accuracy, to make it easier for the readers to find out whats going on.<br />
<br />
The branding image has to be included when the installer is compiled, so you cannot use variables in the file name.<br />
Please read the docs and/or take a look into gfx.nsi and then correct yourself ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SmartyMan</div><div class="date">26th July 2002, 12:09</div></div><div class="posttext">I will add an option to load another dialog resource instead of the default dialog<br />
So I can design the dialogs using the VisualStudio Resource-Editor and then copy the .rc file into my installation?<br />
Whow, that would be very impressing - but you can make me also happy with changing the syntax of AddBrandingImage by adding options<br />
	/center (-&gt; SS_CENTERIMAGE|SS_REALSIZEIMAGE)<br />
	/nomargins (-&gt; MoveWindow(0,0,..) instead of MoveWindow(12,10,...))<br />
	/border (-&gt; SS_SUNKEN) :)<br />
<br />
About the blurring, did you take note of the size reported by AddBrandingImage and used it?<br />
I use /V3 when starting makeNSIS, so I didnt saw this info (OK, I had not seen it even w/o the /V option because of the text masses produced by the compiler ;)<br />
Your suggestion was correct, the width prompted by AddBrandingImage differed by 1 pixel from the width of the image; I have fixed that and the result is OK now - thanks :)<br />
<br />
Another license page could be achived by using InstallOptions.<br />
Have I missed something?<br />
With InstallOptions, I can create a RichEditCtrl object and will be able to make it load a .rtf?<br />
I dont think so ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th July 2002, 12:28</div></div><div class="posttext">Of cource i have proofed that there was no file with this name in my temp dir before i started the installer <br />
<br />
GetTempFileName creates a 0-byte temp file, so you should SetOverwrite On before using the File command, because this 0-byte file needs to be overwritten.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th July 2002, 12:54</div></div><div class="posttext">So I can design the dialogs using the VisualStudio Resource-Editor and then copy the .rc file into my installation?<br />
<br />
I was thinking more at the direction of making it editable with Resource Hacker so everyone can edit it, not only people who have VC...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th July 2002, 16:25</div></div><div class="posttext">Originally posted by SmartyMan <br />
<br />
Please read the docs and/or take a look into gfx.nsi and then correct yourself ;) <br />
I have not tried this feature yet :D I'll wait for the merge of 1.99 and 2.0a1 and the other changes.<br />
<br />
So you should extract the files first and use than use SetBrandingImage? That's good, because different branding images on different pages will work better using this method.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SmartyMan</div><div class="date">26th July 2002, 16:35</div></div><div class="posttext">Originally posted by Joost Verburg <br />
<br />
GetTempFileName creates a 0-byte temp file, so you should SetOverwrite On before using the File command, because this 0-byte file needs to be overwritten. <br />
If the overwrite flag is the reason, why does the gfx.nsi work?<br />
But OK, I will try this, thanks anyway.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SmartyMan</div><div class="date">26th July 2002, 16:38</div></div><div class="posttext">Originally posted by kichik <br />
<br />
<br />
I was thinking more at the direction of making it editable with Resource Hacker so everyone can edit it, not only people who have VC... <br />
Hm, so we have to do this work again and again, anytime we compile a new installer?<br />
In this case, I would prefer the mentioned options for AddBrandingImage ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th July 2002, 16:38</div></div><div class="posttext">Originally posted by SmartyMan <br />
<br />
If the overwrite flag is the reason, why does the gfx.nsi work?<br />
But OK, I will try this, thanks anyway. <br />
I had the same problems using GetTempFileName, so I guess this will work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th July 2002, 17:14</div></div><div class="posttext">The problem doesn't occour in gfx.nsi because I left SetOverwrite to the default value which is on. If you changed the overwrite setting to anything else anywhere in your script to no or ifnewer it just won't work.<br />
<br />
Hm, so we have to do this work again and again, anytime we compile a new installer? <br />
In this case, I would prefer the mentioned options for AddBrandingImage<br />
<br />
Nope, you will just have to add a line such as 'ChangeUI &quot;${NSISDIR}\Contrib\UIs\LeftBI.exe&quot;' to your script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th July 2002, 17:45</div></div><div class="posttext">So you are planning the use compiled Win32 resource files (.res) which can be edited with ResHack?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th July 2002, 17:52</div></div><div class="posttext">Yes :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th July 2002, 18:03</div></div><div class="posttext">Great work! I can't wait ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">27th July 2002, 00:28</div></div><div class="posttext">Originally posted by kichik <br />
Thanks man :D<br />
<br />
But I have to disagree... There are two things left!<br />
I need to make nsis support multiple languages too :)<br />
<br />
To merge it with NSIS 2.0a1 I first have to talk to Rainwater but he doesn't answer =/<br />
I guess he is away or something... <br />
<br />
hehe.  I have been out for a few days.  I would love to see how you are progressing on the merge.  You can IM me at ICQ #105482052.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SmartyMan</div><div class="date">28th July 2002, 12:33</div></div><div class="posttext">Originally posted by Joost Verburg <br />
<br />
I had the same problems using GetTempFileName, so I guess this will work. <br />
You are right, my script was using &quot;SetOverwerite IfNewer&quot;; removing this line mde the code work.<br />
Thanks again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SmartyMan</div><div class="date">28th July 2002, 12:35</div></div><div class="posttext">Originally posted by Joost Verburg <br />
So you are planning the use compiled Win32 resource files (.res) which can be edited with ResHack? <br />
Do you have an URL for downloading this software?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mlbl</div><div class="date">28th July 2002, 14:15</div></div><div class="posttext">Originally posted by SmartyMan <br />
<br />
Do you have an URL for downloading this software? <br />
<br />
Resource Hacker Homepage (http://www.users.on.net/johnson/resourcehacker/)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th July 2002, 14:31</div></div><div class="posttext">The custom UI code is almost ready so I want to ask you to start creating your custom UIs so I can add them to my next version (NSIS 2.0a2).<br />
<br />
Attched is the default UI. All you need to do is change its dialgo resource (105) to whatever you want, as long as you keep the basic controls. The basic controls are back, cancel, and next buttons, the version string and the big &quot;black&quot; rect in the middle which is used to determine the position and size of the NSIS dialogs (dir selection, license agreement, etc.). It is recommended that you don't resize the middle rect.<br />
<br />
Please attach or E-Mail me your UIs so I can include them in the contrib folder.<br />
<br />
TIA<br />
  KiCHiK<br />
<br />
New attachment with just one EXE, sorry about that</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">29th July 2002, 14:56</div></div><div class="posttext">Originally posted by kichik <br />
<br />
Attched is the default UI. All you need to do is change its dialgo resource (105) to whatever you want, as long as you keep the basic controls. The basic controls are back, cancel, and next buttons, the version string and the big &quot;black&quot; rect in the middle which is used to determine the position and size of the NSIS dialogs (dir selection, license agreement, etc.). It is recommended that you don't resize the middle rect.<br />
<br />
<br />
Does this mean all of the text will be inside of the black rectangle?  I would like to be able to add the header text inside of another area.  Probaly not possible though, right?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th July 2002, 15:27</div></div><div class="posttext">Not at the moment... Sorry.<br />
But I will see what I can do for the next version :D<br />
<br />
BTW, does anyone think it would be useful to add a /RESIZETOFIT option to SetBrandingImage?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">29th July 2002, 16:31</div></div><div class="posttext">Originally posted by rainwater <br />
Does this mean all of the text will be inside of the black rectangle?  I would like to be able to add the header text inside of another area. Probaly not possible though, right? <br />
<br />
What's to stop you adding static text strings into the dialog template? I can't see how that would break anything, you wouldn't be able to change them at runtime but if you are building it for just you and it is just intended as a fixed header (maybe a title) that would be okay.<br />
<br />
(shoot me down in flames if I'm completely wrong)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">29th July 2002, 16:42</div></div><div class="posttext">Originally posted by Sunjammer <br />
<br />
<br />
What's to stop you adding static text strings into the dialog template? I can't see how that would break anything, you wouldn't be able to change them at runtime but if you are building it for just you and it is just intended as a fixed header (maybe a title) that would be okay.<br />
<br />
(shoot me down in flames if I'm completely wrong) <br />
<br />
I agree.  I'm wanting to change the text to include the section title (so that is looks similar to the windows installer) and the subtext (like DirText).  Kickik is going to work on a solution.  If all else fails, SendMessage support will let me add my own labels and change them at runtime using onnextpage, etc.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">29th July 2002, 16:43</div></div><div class="posttext">Ahha I'd forgotten about SendMessage, even better then.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SmartyMan</div><div class="date">30th July 2002, 11:35</div></div><div class="posttext">BTW, does anyone think it would be useful to add a /RESIZETOFIT option to SetBrandingImage?<br />
I did not change my opinion yet, so: yes.<br />
I havent had the time to take a look into the ResHack tool(s) yet, but regardless how good this tools are, using options in the script has some advantages.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th July 2002, 18:20</div></div><div class="posttext">I am having trouble using StretchBlt, the stretched bitmaps comes out black &amp; white :(<br />
In the mean while I am just using the plain old LoadImage with a specified width and height, but I would like to use StretchBlt because its results are much better. Does anyone what's the problem with it? Does anyone know how to resize a HBITMAP?<br />
<br />
TIA<br />
  KiCHiK</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">30th July 2002, 18:23</div></div><div class="posttext">Originally posted by kichik <br />
I am having trouble using StretchBlt, the stretched bitmaps comes out black &amp; white :(<br />
In the mean while I am just using the plain old LoadImage with a specified width and height, but I would like to use StretchBlt because its results are much better. Does anyone what's the problem with it? Does anyone know how to resize a HBITMAP?<br />
<br />
TIA<br />
  KiCHiK <br />
<br />
Take a look at http://www.codeguru.com/bitmap/SmoothBitmapResizing.html</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th July 2002, 18:48</div></div><div class="posttext">This article doesn't use StretchBlt... It uses a custom algorithm that will add some KBs to the header.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">30th July 2002, 19:06</div></div><div class="posttext">Originally posted by kichik <br />
This article doesn't use StretchBlt... It uses a custom algorithm that will add some KBs to the header. <br />
<br />
Yep, but it also says StretchBlt will not work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th July 2002, 19:22</div></div><div class="posttext">The only sentence about StretchBlt is:<br />
When we want to resize a bitmap and also the resulting bitmap to be of the highest possible quality, the Win32 AIP function StretchBlt() is not of much help. There are already articles about this task in the CodeGuru sections, but the proposed algorithms take considerable amount of memory when used on large bitmaps - with dimensions of several thousand pixels on each axis.<br />
<br />
And I don't see where it says it won't work. It just says it won't produce the best quality.<br />
<br />
I guess I will just leave my code with the LoadImage solution =/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thomas.lentzsch</div><div class="date">30th July 2002, 20:06</div></div><div class="posttext">The StretchBlt function works fine with colors bitmaps.<br />
<br />
But have have do do some stuff before you call the StretchBlt function. So one thing is to select the color palette within the device context before you call StrechBlt and deselect the palette later.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th July 2002, 20:32</div></div><div class="posttext">Thanks Thomas, I will test it later with the palette selection. I guess that was the problem...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SmartyMan</div><div class="date">30th July 2002, 23:03</div></div><div class="posttext">OK, I had a look with ResHack at the default.exe now.<br />
There is no control for the branding image, so I have to add one myself if I want to change the styles.<br />
In this case I have to move the other controls down (or right);<br />
AddBrandingImage does this for me, if I use an ui.exe I have to do it myself and therefore I have to create a new ui.exe at least for every different-in-size image I want to use for my various installers.<br />
Changing the image during page-switch will cause problems, too...<br />
<br />
To handle these problems, we would need the possibility to define a selfmade control as the control used to show the branding image (e.g. SetBrandingCtrl &lt;id&gt;)<br />
<br />
As you can see, the options mentioned in one of my latest postings would make the things easier to handle - but that doesnt mean that an editable resource isnt a good idea.<br />
<br />
In my opinion the editable resource is a brilliant way to handle very personal optical adjustments, present in *every* installer that the user creates (e.g. increase the buttons width for longer texts), while options dealing with styles are the better way to handle adjustments to controls the installer manipulates itself (in this case: resize the branding-control as given by AddBrandingImage, move the other controls out of the way).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th July 2002, 23:23</div></div><div class="posttext">You can use NSIS 1.99 with AddBrandingImage and then load its dialog resource into ui.exe.<br />
<br />
Should I keep AddBrandingImage along with ChangeUI? It is possible...<br />
<br />
You will have an option to set the image to a given control id (SetBrandingCtrl &lt;id&gt;). Plus, ChangeUI will find the first image control and set it as the default for SetBrandingImage (if no id was specified).<br />
<br />
BTW, to add an &quot;image control&quot; in Resource Hacker just right-click your dialog (after you chose it in the left pane), choose Insert Item, press on the tree picture (tooltip is BITMAP), OK, resize, move, and don't forget to press the Compile Script button or else your changes won't be saved.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st July 2002, 20:29</div></div><div class="posttext">I have finished merging 1.99 with 2.0a1, you can find it here (http://forums.winamp.com/showthread.php?s=&amp;threadid=96334)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SmartyMan</div><div class="date">31st July 2002, 23:05</div></div><div class="posttext">Should I keep AddBrandingImage along with ChangeUI? It is possible... <br />
If you remove this command, there will be no way for defining size and orientation for the branding :)<br />
OK, you could also move the parameters to SetBrandingCtrl.<br />
<br />
You will have an option to set the image to a given control id (SetBrandingCtrl &lt;id&gt; ). Plus, ChangeUI will find the first image control and set it as the default for SetBrandingImage (if no id was specified). <br />
OK, lets see how it feels to use the new concept then :)<br />
<br />
BTW: wouldnt this ui.exe concept a good way of replacing the install-options-dll?<br />
I mean, if you plan to integrate commands for communication with the self added controls, why not use them with self made dialogs using page.exe's editable with ResHack, too?<br />
Advantages would be:<br />
- graphical dialog editor<br />
- much more flexibility (more controls, more control about styles etc)<br />
- no need for another .dll and code dealing with installing it, handling those .ini files etc<br />
<br />
Just an idea...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">spanky</div><div class="date">1st August 2002, 01:54</div></div><div class="posttext">Found a bug.  I downloaded the latest version and recompiled my new script - but I forgot to remove the command &quot;EnabledBitmap&quot; first.<br />
Trying to do a compile crashes MakeNSISW with this command included.<br />
<br />
btw, is there any way to add the functionality of EnabledBitmap back in?  I don't have many installation options so the checkboxes are no use for me.  Besides, they're ugly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">1st August 2002, 01:56</div></div><div class="posttext">Originally posted by spanky <br />
Found a bug.  I downloaded the latest version and recompiled my new script - but I forgot to remove the command &quot;EnabledBitmap&quot; first.<br />
Trying to do a compile crashes MakeNSISW with this command included.<br />
<br />
<br />
I can't reproduce.  I get the following in the log window:<br />
<br />
Invalid command: EnabledBitmap</div></div><hr />


<div class="post"><div class="posttop"><div class="username">spanky</div><div class="date">1st August 2002, 01:59</div></div><div class="posttext">Looks like &quot;SectionDivider&quot; was also removed.  This too causes MakeNSISW to crash.<br />
Am I safe to say that all compile errors cause it to crash?<br />
<br />
Can we re-add the functionality of SectionDivider too?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">1st August 2002, 02:22</div></div><div class="posttext">Originally posted by spanky <br />
Looks like &quot;SectionDivider&quot; was also removed.  This too causes MakeNSISW to crash.<br />
Am I safe to say that all compile errors cause it to crash?<br />
<br />
Can we re-add the functionality of SectionDivider too? <br />
<br />
What OS are you using?  Compile errors shouldn't be causing a crash (they don't on my XP system).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mlbl</div><div class="date">1st August 2002, 03:56</div></div><div class="posttext">Would it be possible to have an option to span the NSIS output file into multiple disks/discs? Would be great it that could be done.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">1st August 2002, 08:11</div></div><div class="posttext">I notice that people are not posting these bugs on the Source Forge system where they will be recorded, likewise with the feature requests. It will make KiCHiK's (and anyone else who joins him) life easier I'm sure if you use those facilities.<br />
<br />
Submit a bug in NSIS 2.0a2 here (http://sourceforge.net/tracker/?func=add&amp;group_id=58662&amp;atid=489679)<br />
<br />
Submit a feature request in NSIS 2.0a2 here (http://sourceforge.net/tracker/?func=add&amp;group_id=58662&amp;atid=489682)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st August 2002, 08:13</div></div><div class="posttext">Makensisw doesn't crash here too...<br />
mlbl, I don't think I will do it, maybe in some future version.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mlbl</div><div class="date">1st August 2002, 13:06</div></div><div class="posttext">I've made a small UI. This is simply a modified version by moving around some of the buttons and text around so that it looks different.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st August 2002, 13:18</div></div><div class="posttext">Thanks mlbl, it will be included in the next version.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mlbl</div><div class="date">1st August 2002, 15:15</div></div><div class="posttext">Minor Update.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RIV@NVX</div><div class="date">1st August 2002, 19:12</div></div><div class="posttext">I just can't add branding image to installer. Can someone write that part of code for me for NSIS 2.0a2 and post it in the forum? Tried macros, every suggestion, but image just doesn't show up.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">1st August 2002, 19:55</div></div><div class="posttext">I noticed using reshacker that nsis does not respect the size you give the 1018 control.  You should document the minimum height/width so people understand they can't make that control too small.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SmartyMan</div><div class="date">1st August 2002, 23:03</div></div><div class="posttext">Originally posted by kichik <br />
I have finished merging 1.99 with 2.0a1<br />
<br />
Great, Ive downloaded and tested it a bit, here are some notes:<br />
<br />
I really love the new license page using a RichEditCtrl and clickable URLs, great work :)<br />
<br />
-------------<br />
<br />
You said that I will get &quot;my style&quot; of branding images with the next update using ChangeUI and ResHacker, so here is what I have tried:<br />
<br />
1. ChangeUI &quot;...ui.exe&quot;, No AddBrandingImage, SetBrandingImage in .onNextPage<br />
--&gt; Height is adjusted correct, Width is adjusted incorrect, other controls are not moved out of the way (see branding1.png)<br />
<br />
2. ChangeUI &quot;...ui.exe&quot;, AddBrandingImage top 65, SetBrandingImage in .onNextPage<br />
--&gt; Selfmade control will not be used (you can see it on bottom of the branding image in branding2.png)<br />
<br />
So how will I get the desired result (no margins, sunken border)?<br />
Do I really have to create an own hand-sized ui.exe for every installer?<br />
<br />
-------------<br />
<br />
The strings &quot;Extract&quot;, &quot;Output directory&quot; etc in the details-view cant be changed (e.g. for a german translation); I really would like to see some commands for that in one of your next updates.<br />
BTW: if you need assistance for a build in german text collection, just ask me :)<br />
<br />
-------------<br />
<br />
At my first atempt to use the new SetCompressor command I got this:<br />
<br />
Error: can't change compressor after data already got compressed or header already changed!<br />
Error in script &quot;G:\Programme\NSIS\NSISplus\NSISplus.nsi&quot; on line 1 -- aborting creation process<br />
<br />
The reason was the file nsisconf.nsi (included automatically by makeNSIS) because I had some definitions there that are the same for all my installers (checkbox icons etc).<br />
I like the idea of having only one compiler exe, but maybe you should add a command line option for choosing the compressor, because otherwise the nsisconf.nsi is nearly useless.<br />
<br />
-------------<br />
<br />
When you published the V1.99, makensis.htm contained documentation of all the new features you builded in; the one that came with V2.0a2 doesnt, but you will update the docs soon, wont you?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd August 2002, 09:27</div></div><div class="posttext">RIV@NVX, please send in your code so I can look at it and see what's wrong.<br />
<br />
rainwater, like I have said in one of my earlier posts: &quot;It is recommended that you don't resize the middle rect.&quot;<br />
<br />
SmartyMan, if you use your own UI you should move the controls your self using Resource Hacker. ChangeUI doesn't move them for you. To set the branding image for other than the default image control you need to specify the /IMGID= switch for SetBrandingImage.<br />
<br />
I am working on the multilingual option for NSIS, and every string (log included? please give your opinion here (http://sourceforge.net/survey/survey.php?group_id=58662&amp;survey_id=13396)) will be changable.<br />
<br />
A command line switch to compile using bzip2 is /X&quot;SetCompressor bzip2&quot;.<br />
<br />
The documents are updated, I don't understand what you are talking about.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RIV@NVX</div><div class="date">2nd August 2002, 10:38</div></div><div class="posttext">XPStyle On<br />
SetFont &quot;Tahoma&quot; 8<br />
AddBrandingImage &quot;Top&quot; 167<br />
!packhdr &quot;DMX.dat&quot; &quot;C:\UPX\upx.exe --best --force --crp-ms=100000 DMX.dat&quot;<br />
!include &quot;C:\Program Files\NSIS\Examples\branding.nsh&quot;<br />
<br />
;BGGradient Format ColorUp ColorDown InstallTitle (RRGGBB) Hex<br />
;InstallColors Format Foreground Background (RRGGBB) Hex<br />
BGGradient 00FF00 0000FF 505050<br />
InstallColors 00FF00 000000<br />
InstProgressFlags smooth colored<br />
<br />
Function .onInit<br />
  SetOutPath &quot;$TEMP&quot;<br />
  File /oname=spltmp.bmp &quot;splash.bmp&quot;<br />
  File /oname=spltmp.exe &quot;C:\Program Files\NSIS\Bin\splash.exe&quot;<br />
  ExecWait '$TEMP\spltmp.exe 5000 $HWNDPARENT $TEMP\spltmp'<br />
  Delete &quot;$TEMP\spltmp.exe&quot;<br />
  Delete &quot;$TEMP\spltmp.bmp&quot;<br />
  !insertmacro BI_INIT $2<br />
FunctionEnd<br />
<br />
!insertmacro BI_LIST<br />
!insertmacro BI_LIST_ADD &quot;splash.bmp&quot;<br />
!insertmacro BI_LIST_END<br />
<br />
Function .onNextPage<br />
  !insertmacro BI_NEXT<br />
FunctionEnd<br />
<br />
Function .onPrevPage<br />
  !insertmacro BI_PREV<br />
FunctionEnd<br />
<br />
<br />
Function BrandImage<br />
  GetTempFileName $1<br />
  SetOverwrite On<br />
  File /oname=$1 &quot;splash.bmp&quot;<br />
  SetOverwrite Off<br />
  SetBrandingImage &quot;/IMGID=0&quot; &quot;/RESIZETOFIT&quot; $1<br />
SectionEnd<br />
<br />
I tried everything, i do not want to switch images, but I thought that it could work...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd August 2002, 10:46</div></div><div class="posttext">If you want just one image you don't need any macro, all you need is:<br />
<br />
Function .onNextPage<br />
   StrCmp $R0 1 image_already_set; Don't use $R0 anywhere else!<br />
      GetTempFileName $1<br />
      SetOverwrite on<br />
      File /oname=$1<br />
      SetOverwrite off ; or what ever it was before<br />
      SetBrandingImage /RESIZETOFIT $1<br />
      Delete $1<br />
   image_already_set:<br />
FunctionEnd<br />
<br />
Also /IMGID=0 doesn't mean use default, it means use control ID 0, and it doesn't exist if you created the image control with AddBrandingImage.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RIV@NVX</div><div class="date">2nd August 2002, 14:23</div></div><div class="posttext">It works (finally). Thanks a lot!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RIV@NVX</div><div class="date">2nd August 2002, 15:31</div></div><div class="posttext">I just noticed a bug, not sure if anyone mentioned it exactly. If I use ChangeUI command with BZIP2 compression, makensis.exe crashes.<br />
I use WinXP, no service packs.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mlbl</div><div class="date">2nd August 2002, 16:08</div></div><div class="posttext">Agreed. It does crash, but only if you use the command line to set the compressor as opposed to adding &quot;SetCompressor bzip2&quot; into your .nsi file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd August 2002, 16:30</div></div><div class="posttext">Thanks RIV@NVX, it was indeed a bug (forgot an equality sign in DialogTemplate.cpp). The crash occours if you change to a UI without a branding image. I have uploaded a fixed version to the CVS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RIV@NVX</div><div class="date">2nd August 2002, 18:41</div></div><div class="posttext">Can I add image to uninstaller? Can I use the same code like before and what switches should I change?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd August 2002, 18:57</div></div><div class="posttext">Because the installer and the uninstaller use the same UI, if you add an image to the installer the uninstaller will have one too. To set the image just add un before .onNextPage in the code I gave you above.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">2nd August 2002, 20:40</div></div><div class="posttext">mmh, was just wondering if that works with nsis2 already =)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>