<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MUI_FINISHPAGE_RUN question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MUI_FINISHPAGE_RUN question NSIS Discussion" />
	
	<title> MUI_FINISHPAGE_RUN question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MUI_FINISHPAGE_RUN question</div>
<hr />
<div class="pda"><a href="t-332344.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=332344">MUI_FINISHPAGE_RUN question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kalverson</div><div class="date">11th July 2011, 19:04</div></div><div class="posttext">In one of our older installs, I have run into a situation where the application has the wrong configuration path.  This is due to admin elevation on a standard user profile during the install.  The application is launched at the end using the admin profile rather than the standard user profile and thus has the wrong configuration path.  Is there an easy wait to either disable the checkbox on the finish page in this situation, or just launch the application with the correct standard user profile instead?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">11th July 2011, 21:02</div></div><div class="posttext">Simply don't add the RUN macro.<br />
<br />
Or, if you want to disable the run option only for elevated installs, you can do that in the page's SHOW function. The HWND of the run checkbox is stored in a variable. See NSIS\Contrib\Modern UI 2\Pages\Finish.nsh to find out what it's called.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kalverson</div><div class="date">12th July 2011, 13:08</div></div><div class="posttext">I found what I needed in the System.nsh header here since I am not using MUI 2:<br />
<br />
    !ifdef MUI_FINISHPAGE_RUN<br />
      GetDlgItem $MUI_TEMP1 $MUI_HWND 1203<br />
      SetCtlColors $MUI_TEMP1 &quot;&quot; &quot;${MUI_BGCOLOR}&quot;<br />
      EnableWindow $MUI_TEMP1 0<br />
    !endif<br />
<br />
Now all I have to do is figure out if I am a standard user that was elevated at install time.<br />
<br />
Thanks for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kalverson</div><div class="date">12th July 2011, 18:40</div></div><div class="posttext">On second thought, I was reading what the UAC plug-in does and discovered I can launch my application as the user which is what I really wanted to do in the first place.  It looks like using the UAC plug-in to launch the installled applicaiton is the way to go.  One additional question if any knows, has the UAC plug-in been tested on MS servers 2003 or 2008?  I did not see these in the OS test environment list.<br />
<br />
http://nsis.sourceforge.net/UAC_plug-in</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">13th July 2011, 06:43</div></div><div class="posttext">UAC plugin works fine on WinServer 2003. I never tested on 2008.<br />
<br />
The reason I never mentioned the UAC plugin is that it makes installers a lot more complex, and it adds a hundred things that can go wrong. It's definitely not recommended for beginners. That being said, the plugin was indeed designed to do exactly what you want to do. Just make sure to examine and understand the example scripts.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kalverson</div><div class="date">13th July 2011, 14:09</div></div><div class="posttext">Thanks for you help and the additional comments on UAC.  I have implemented the UAC plug-in and it does solve our issue.  There is one minor thing that occurs now, but I am not sure anything can be done about it.  The UAC security dialog that asks for logon credentials sometimes is minimized and blinking on the task bar.  If you user does not notice this, they might think nothing happened when they double clicked the installer exe.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>