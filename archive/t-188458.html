<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Writing strings to Non NSIS INI files, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Writing strings to Non NSIS INI files NSIS Discussion" />
	
	<title> Writing strings to Non NSIS INI files [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Writing strings to Non NSIS INI files</div>
<hr />
<div class="pda"><a href="t-188458.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=188458">Writing strings to Non NSIS INI files</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jimpy22</div><div class="date">31st July 2004, 21:01</div></div><div class="posttext">Hi, can someone tell me how to write a user input string requested from a text box during installation into one of my own .ini files (ie not a NSIS .ini file?)<br />
<br />
Thank you in anticipation</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">31st July 2004, 21:09</div></div><div class="posttext">Use ReadINIStr and after WriteINIStr. See NSIS documentation for details.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jimpy22</div><div class="date">31st July 2004, 21:21</div></div><div class="posttext">Thanks for your reply. I have been reading documentation and forums for 3 hours now and am just very confused.<br />
<br />
My file ia touch.ini:<br />
<br />
[Software Title]<br />
-------------------- Browser System Variables -------------------------------<br />
<br />
--[Address Settings]<br />
BrwDefaultAddress=http://IP:77/config_ip.asp?Where=RegX<br />
BrwReportAddress=<br />
<br />
--[System Settings]<br />
SystemKeys=ON<br />
SysDeskTop=ON<br />
<br />
BrowserDiagMode=OFF<br />
BrowserKioksMode=OFF<br />
BrowserControlBar=ON<br />
<br />
etc etc etc etc<br />
<br />
I want to take an IP address that the user puts into a text box in the installer during installation and write it into the 'IP' bit of this line above BrwDefaultAddress=http://IP:77/config_ip.asp?Where=RegX.<br />
<br />
And then put a value into 'X' in the same line above.<br />
<br />
Can any one give me the code to do that - I have just ended up going around and around in circles for hours!!! Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">31st July 2004, 21:34</div></div><div class="posttext">it would be easier to first get the text from the textbox<br />
then build the whole url with a couple of StrCpy's<br />
then write the whole line to the .ini file</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jimpy22</div><div class="date">31st July 2004, 21:40</div></div><div class="posttext">I don't even seem to be able to hold on to the text string entered during the installation to be able to re-write the whole line and then replace it in the touch.ini file???</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">31st July 2004, 21:46</div></div><div class="posttext">ReadINIStr $0 &quot;Page.ini&quot; &quot;Field #&quot; &quot;State&quot; ;&quot;IP&quot; value as you said<br />
StrCpy $1 &quot;X&quot; ;&quot;X&quot; value as you said<br />
WriteINIStr &quot;Touch.ini&quot; &quot;Address Settings&quot; &quot;BrwDefaultAddress&quot; \<br />
&quot;http://$0:77/config_ip.asp?Where=Reg$1&quot;<br />
<br />
Replace &quot;Page.ini&quot; with your page INI file, &quot;#&quot; with the number of the &quot;Field&quot; of the textbox that gets the IP.<br />
<br />
 Ops! Fixed code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">31st July 2004, 21:47</div></div><div class="posttext">Using an InstallOptions dialogue, the user will enter the data into the necessary fields. He click's next, and his data will be saved into the InstallOptions INI dialogue file. You can then use ReadINIStr $R0 &quot;IOfile.ini&quot; &quot;Field X&quot; &quot;State&quot; to retrieve the data.<br />
Then use WriteINIStr &quot;touch.ini&quot; &quot;Address Settings&quot; &quot;http://IP:$R0/config_ip.asp?Where=RegX&quot;<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jimpy22</div><div class="date">31st July 2004, 22:07</div></div><div class="posttext">I put:<br />
ReadINIStr $0 &quot;ioA.ini&quot; &quot;Field 2&quot; &quot;State&quot; ;&quot;IP&quot; value as you said<br />
 ReadINIStr $1 &quot;ioA.ini&quot; &quot;Field 4&quot; &quot;State&quot; ;&quot;X&quot; value as you said<br />
 WriteINIStr &quot;$INSTDIR\PAERS Registration system\iTouch_BR.ini&quot; &quot;Address Settings&quot; &quot;BrwDefaultAddress&quot; &quot;http://$0:77/config_ip.asp?Where=Reg$1&quot;<br />
<br />
<br />
In the main section. After I ran the install the touch.ini file looked like this:<br />
<br />
[Software Title]<br />
<br />
-------------------- Browser System Variables -------------------------------<br />
<br />
--[Address Settings]<br />
BrwDefaultAddress=<br />
--http://192.134.0.122:77/config_ip.asp?Where=Reg1<br />
BrwReportAddress=<br />
<br />
--[System Settings]<br />
SystemKeys=ON<br />
SysDeskTop=ON<br />
<br />
BrowserDiagMode=OFF<br />
BrowserKioksMode=OFF<br />
BrowserControlBar=ON<br />
BrowserBiometrics=ON<br />
BrowserNeedsFapi=YES<br />
<br />
BrowserReportEvents=OFF<br />
<br />
--[System Livery]<br />
BrowserTitle=PAERS Registration <br />
BrowserLogo=<br />
BrowserBackground=<br />
BrowserPosTop=84<br />
BrowserPosLeft=112<br />
BrowserSizeWidth=600<br />
BrowserSizeHeight=450<br />
<br />
[Address Settings]<br />
BrwDefaultAddress=http://:77/config_ip.asp?Where=Reg<br />
<br />
<br />
It added the string at the end and did not have the user entered values? What am I doing wrong? (Thanks for the help so far)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">31st July 2004, 22:17</div></div><div class="posttext">Attach (or post if it's small) the InstallOptions INI file. (ioA.ini as you mentioned)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jimpy22</div><div class="date">31st July 2004, 22:21</div></div><div class="posttext">ini file attached</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jimpy22</div><div class="date">31st July 2004, 22:23</div></div><div class="posttext">and .nsi</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">31st July 2004, 22:29</div></div><div class="posttext">Are you copying the page to the $PLUGINSDIR before and showing the page from there? Are you using MUI (Modern User Interface)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jimpy22</div><div class="date">31st July 2004, 22:31</div></div><div class="posttext">I don't think so - should I?<br />
<br />
I have posted the .nsi file as well as the .ini file.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">31st July 2004, 22:34</div></div><div class="posttext">Oh yeah, that's because you're using Modern UI. Instead of using ReadINIStr you should use &quot;!insertmacro MUI_INSTALLOPTIONS_READ&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jimpy22</div><div class="date">31st July 2004, 22:45</div></div><div class="posttext">OK - so have changed it to:<br />
<br />
---------------------------------<br />
 !insertmacro MUI_INSTALLOPTIONS_READ $0 &quot;ioA.ini&quot; &quot;Field 2&quot; &quot;State&quot; ;&quot;IP&quot; value as you said<br />
 !insertmacro MUI_INSTALLOPTIONS_READ $1 &quot;ioA.ini&quot; &quot;Field 4&quot; &quot;State&quot; ;&quot;X&quot; value as you said<br />
 WriteINIStr &quot;$INSTDIR\PAERS Registration system\iTouch_BR.ini&quot; &quot;Address Settings&quot; &quot;BrwDefaultAddress&quot; &quot;http://$0:77/config_ip.asp?Where=Reg$1&quot;<br />
--------------------------------------<br />
<br />
<br />
As suggested but I still get the following written in to my touch.ini file (ie adds lines at end instead of adding value to brwdefaultaddress and does not enter the values entered by user?<br />
<br />
---------------------------------------------<br />
[Software Title]<br />
<br />
-------------------- Browser System Variables -------------------------------<br />
<br />
--[Address Settings]<br />
BrwDefaultAddress=<br />
--http://192.12.0.22:77/config_ip.asp?Where=Reg1<br />
BrwReportAddress=<br />
<br />
--[System Settings]<br />
SystemKeys=ON<br />
SysDeskTop=ON<br />
<br />
BrowserDiagMode=OFF<br />
BrowserKioksMode=OFF<br />
BrowserControlBar=ON<br />
BrowserBiometrics=ON<br />
BrowserNeedsFapi=YES<br />
<br />
BrowserReportEvents=OFF<br />
<br />
--[System Livery]<br />
BrowserTitle=PAERS Registration <br />
BrowserLogo=<br />
BrowserBackground=<br />
BrowserPosTop=84<br />
BrowserPosLeft=112<br />
BrowserSizeWidth=600<br />
BrowserSizeHeight=450<br />
<br />
[Address Settings]<br />
BrwDefaultAddress=http://:77/config_ip.asp?Where=Reg<br />
<br />
-------------------------------------------------------<br />
<br />
<br />
What is the other thing you said to do?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st August 2004, 00:40</div></div><div class="posttext">Have you tried removing the -- from in front of all your section headings (in iTouch_BR.ini)?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">1st August 2004, 03:02</div></div><div class="posttext">!insertmacro MUI_PAGE_INSTFILES<br />
Page custom CustomPageA<br />
<br />
You did put that code I said to you in a Section. This happens before you get to the page, so there will ever be an empty string. To solve this just put that code after you show &quot;ioA.ini&quot; (which is in the Function CustomPageA).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>