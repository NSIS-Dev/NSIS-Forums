<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" VB and NSIS, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  VB and NSIS NSIS Discussion" />
	
	<title> VB and NSIS [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  VB and NSIS</div>
<hr />
<div class="pda"><a href="t-279036.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=279036">VB and NSIS</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Kauko</div><div class="date">15th October 2007, 18:13</div></div><div class="posttext">When I call NSIS generated installer from VB program it doesn't show up on the screen foreground but only in taskbar?<br />
How do I bring it to the screen foreground?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th October 2007, 18:17</div></div><div class="posttext">Try ExecShell with SW_SHOWMAXIMIZED.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">helix400</div><div class="date">15th October 2007, 19:33</div></div><div class="posttext">Here's some VB6 code we use to restore other windows:<br />
<br />
'These next sections are helpful to find a window specifically by its handle (hWnd)<br />
'----------------------------------------------------<br />
Declare Function FindWindow Lib &quot;user32&quot; Alias &quot;FindWindowA&quot; (ByVal lpClassName As String, ByVal lpWindowName As String) As Long<br />
Declare Function ShowWindow Lib &quot;user32&quot; (ByVal hWnd As Long, ByVal nCmdShow As Long) As Long<br />
Declare Function SetFocus Lib &quot;user32&quot; (ByVal hWnd As Long) As Long<br />
Declare Function SetActiveWindow Lib &quot;user32&quot; (ByVal hWnd As Long) As Long<br />
Declare Function SetForegroundWindow Lib &quot;user32&quot; (ByVal hWnd As Long) As Long<br />
Declare Function GetWindowPlacement Lib &quot;user32&quot; (ByVal hWnd As Long, lpwndpl As WINDOWPLACEMENT) As Long<br />
<br />
Const SW_SHOW = 5<br />
Const SW_RESTORE = 9<br />
Const SW_SHOWMINIMIZED = 2<br />
Const SW_SHOWMAXIMIZED = 3<br />
Const SW_SHOWNORMAL = 1<br />
<br />
Public Type Rect<br />
    Left   As Long<br />
    Top    As Long<br />
    Right  As Long<br />
    Bottom As Long<br />
End Type<br />
<br />
Private Type POINTAPI<br />
    x As Long<br />
    y As Long<br />
End Type<br />
<br />
Private Type WINDOWPLACEMENT<br />
    Length           As Long<br />
    Flags            As Long<br />
    showCmd          As Long<br />
    ptMinPosition    As POINTAPI<br />
    ptMaxPosition    As POINTAPI<br />
    rcNormalPosition As Rect<br />
End Type<br />
<br />
Private lpwndpl As WINDOWPLACEMENT<br />
<br />
<br />
Public Function RestoreWindow(lngHandle As Long) As Boolean<br />
'If you know a window's handle, this will restore the window to the front<br />
<br />
On Local Error GoTo ErrorHandler<br />
<br />
Dim lState     As Long<br />
Dim bRetVal As Boolean<br />
<br />
    bRetVal = False<br />
    lpwndpl.Length = 44<br />
    <br />
    lState = GetWindowPlacement(lngHandle, lpwndpl)<br />
    HandleDebug &quot;lState is: &quot; &amp; lState<br />
    If lState &lt;&gt; 0 Then<br />
        Select Case lpwndpl.showCmd<br />
            Case SW_SHOWMINIMIZED<br />
                    Call ShowWindow(lngHandle, SW_RESTORE)<br />
            Case SW_SHOWNORMAL, SW_SHOWMAXIMIZED<br />
                    Call ShowWindow(lngHandle, SW_SHOW)<br />
        End Select<br />
        Call SetFocus(lngHandle)<br />
        Call SetActiveWindow(lngHandle)<br />
        Call SetForegroundWindow(lngHandle)<br />
        bRetVal = True<br />
    End If<br />
    <br />
    RestoreWindow = bRetVal<br />
Exit Function<br />
ErrorHandler:<br />
    MsgBox &quot;Error loading window&quot;<br />
    RestoreWindow = bRetVal<br />
End Function<br />
<br />
<br />
If you need to get a window's handle, you can do so with this...<br />
<br />
lngHandle = FindWindow(vbNullString, [window's caption name])<br />
<br />
If you need a VB.NET version, just let me know.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kauko</div><div class="date">15th October 2007, 20:07</div></div><div class="posttext">Looks like you guys are trying to make this too complicated?<br />
Pls notice that this is NSIS generated install program run FROM VB menu program which starts by CD-ROM's Autorun.<br />
I have dozen separate programs in the menu of VB program. <br />
I want to select program to install by clicking VB program button.<br />
All install programs created in VB properly execute in the foreground but all NSIS install programs execute to HIDING. Only taskbar shows that it is running.<br />
There is no ExecShell anywhere here.<br />
There is Shell in VB menu program running the install programs.<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th October 2007, 21:23</div></div><div class="posttext">http://www.vbaccelerator.com/codelib/shell/shellex.htm<br />
<br />
If you wrote the installer, try putting a BringToFront in the welcome page's show function (or onGUIInit).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kauko</div><div class="date">16th October 2007, 15:10</div></div><div class="posttext">Thanks, this worked:<br />
<br />
!define MUI_CUSTOMFUNCTION_GUIINIT MyGUIInit<br />
<br />
Function MyGUIInit<br />
  BringToFront<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">helix400</div><div class="date">17th October 2007, 22:32</div></div><div class="posttext">BringToFront doesn't work on newer Windows versions (Microsoft I suppose disabled the underlying feature due to too many spyware popups).  BringToFront instead will just cause the taskbar item to blink.<br />
<br />
As both of us mentioned, the problem is not with NSIS, it's with how you launch the application from within VB.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kauko</div><div class="date">18th October 2007, 12:05</div></div><div class="posttext">Do not know any better so I do:<br />
<br />
Private Sub ButtonMyProgram_Click()<br />
    Shell &quot;Programs\Setup_MyProgram.exe&quot;<br />
End Sub<br />
<br />
which works with Win2000 &amp; WinXP and BringToFront in my NSIS script.<br />
Can you please give details how I suppose do it right?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">helix400</div><div class="date">19th October 2007, 07:43</div></div><div class="posttext">Again, just so you know, newer Windows versions do not allow applications to bring themselves to the front.  Only applications in front have the rights to bring other apps in front.<br />
<br />
In VB6, I think you can do this with:<br />
<br />
Shell &quot;Programs\Setup_MyProgram.exe&quot;, vbNormalFocus<br />
<br />
If you ever wondered why Shell has 2 parameters in vb6, now you know why  :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>