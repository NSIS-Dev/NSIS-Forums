<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Plugin not registering, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Plugin not registering NSIS Discussion" />
	
	<title> Plugin not registering [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Plugin not registering</div>
<hr />
<div class="pda"><a href="t-291316.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291316">Plugin not registering</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">5th May 2008, 18:30</div></div><div class="posttext">I have a plugin that I pass a serial number to and it returns on the stack 1 for valid, 0 for invalid, or -1 for failure.  It doesn't seem to be calling into the DLL, as it leaves the parameter being passed in on the stack.  Below is my code, the log output that seems to indicate the problem, and a skeleton of my C code attached that is a modification of exdll.c.  I had commented some things out, that I'm not sure whether they are necessary.  I had a hard time getting that exdll.c to complete under Visual Studio.  I remember having to recreate the whole project and solution.<br />
<br />
  Var /GLOBAL _TBaseline_TFLSerialNumberVerifier_Result<br />
  TFlSerialNumberVerifier::IsValidSerialNumber /NOUNLOAD &quot;$TBaseline_SerialNumber&quot;<br />
  Pop $_TBaseline_TFLSerialNumberVerifier_Result<br />
  <br />
  ${If} $_TBaseline_TFLSerialNumberVerifier_Result = 0     <br />
      MessageBox MB_ICONEXCLAMATION|MB_OK &quot;The serial number does not appear to be valid.&quot;<br />
    <br />
    Goto cancelLeave<br />
  ${ElseIf} $_TBaseline_TFLSerialNumberVerifier_Result = -1 <br />
    Goto cancelLeave    <br />
  ${EndIf}<br />
  <br />
  Pop $0 ; restore 0<br />
  Goto done ;always skip the Abort statement, only some type of &quot;GOTO cancelleave&quot; can get here<br />
  cancelLeave:  <br />
    Pop $0 ; restore 0<br />
    ;TODO: Log error if silent    <br />
    Abort  ;stay on this page    <br />
  done:<br />
File: overwriteflag=1, allowskipfilesflag=2, name=&quot;C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\nsd3A.tmp\TFlSerialNumberVerifier.dll&quot;<br />
File: wrote 13824 to &quot;C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\nsd3A.tmp\TFlSerialNumberVerifier.dll&quot;<br />
Error registering DLL: Could not load C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\nsd3A.tmp\TFlSerialNumberVerifier.dll</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">5th May 2008, 18:34</div></div><div class="posttext">Eh, it lost my attachment when I previewed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th May 2008, 19:16</div></div><div class="posttext">If you've recreated the solution and project, your DLL probably depends on DLL files that do not exist on clean systems. You should build your DLL as a static DLL so it won't depend on MSVCR??.DLL.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">5th May 2008, 21:10</div></div><div class="posttext">Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">l0k1</div><div class="date">6th May 2008, 15:09</div></div><div class="posttext">I've got same problem and i resolve it when i changed DLL MULTITHREAD (/MD) compiler option to MULTITHREAD (/MT)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">6th May 2008, 19:20</div></div><div class="posttext">Yeah, that has something to do with whether the c libraries are included in the exe or not.  Microsoft's documentation could elaborate a little more on that kind of stuff and what those settings mean.<br />
<br />
I was able to successfully convert the exedll project from the most recent version of NSIS and then just renamed the project and pasted my code into it, and it is working fine now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th May 2008, 10:29</div></div><div class="posttext">Yes the easiest way is to copy the exdll.dsp and exdll.dsw files and just do a simple text replace. I spose it would be useful if I were to write an app to create a new NSIS plug-in project (to create the relevant dsp/dsw or vcproj files).<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>