<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" InstallDirRegKey does not work for me., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  InstallDirRegKey does not work for me. NSIS Discussion" />
	
	<title> InstallDirRegKey does not work for me. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  InstallDirRegKey does not work for me.</div>
<hr />
<div class="pda"><a href="t-150325.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=150325">InstallDirRegKey does not work for me.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">lll2008</div><div class="date">24th September 2003, 23:31</div></div><div class="posttext">I am a new user of NSIS (just started to play with it today). I used:<br />
<br />
InstallDirRegKey HKLM  &quot;SYSTEM\CurrentControlSet\Control\ServiceProvider\ServiceTypes\Microsoft Internet Information Server&quot; &quot;&quot;<br />
<br />
or<br />
<br />
HKLM  &quot;SYSTEM\CurrentControlSet\Control\ServiceProvider\ServiceTypes&quot; &quot;Microsoft Internet Information Server&quot;<br />
<br />
to check if iis has been installed, but neither worked for me. I am sure the key is there! I also tried to add a key to SOFTWARE, and InstallDirKey did not work for me either. Please refer to my script file (attached).<br />
<br />
Could you tell me what the problem is? Or any suggestion on this?<br />
<br />
Thank you in advance!<br />
<br />
li</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">25th September 2003, 00:29</div></div><div class="posttext">Which version of NSIS are you using?<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lll2008</div><div class="date">25th September 2003, 14:55</div></div><div class="posttext">Hi Vytautas, I am using NSIS 2.0 Beta 3a - Released March 15, 2003.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">25th September 2003, 16:02</div></div><div class="posttext">What exactly do you want to do? InstallDirRegKey gets a folder from the registry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lll2008</div><div class="date">29th September 2003, 15:36</div></div><div class="posttext">Hi Joost,<br />
I am trying to check if iis is installed before I install my components. I suppose if the iis key is there InstallDirRegKey HKLM &quot;SYSTEM\CurrentControlSet\Control\ServiceProvider\ServiceTypes\Microsoft Internet Information Server&quot; &quot;&quot; will return a folder to INSTDIR, otherwise INSTDIR will be empty. But apprently this does not work for me. Even though the key is there, the InstallDirRegKey still returns an empty string. Please check the attachement in my first post.<br />
<br />
Any suggestion?<br />
<br />
Thanks,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th September 2003, 15:43</div></div><div class="posttext">Are you sure it contains a valid directory path? If it doesn't contain a valid directory path, nothing will get into $INSTDIR. If you want to read this value, which is not a directory path, you should use ReadRegStr and not InstallDirRegKey.<br />
<br />
BTW, you can use RegDLL instead of executing regsvr32 which doesn't exist on every Windows machine.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>