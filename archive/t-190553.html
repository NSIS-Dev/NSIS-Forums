<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Programatically change the active control (the one which has focus) in a custom page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Programatically change the active control (the one which has focus) in a custom page NSIS Discussion" />
	
	<title> Programatically change the active control (the one which has focus) in a custom page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Programatically change the active control (the one which has focus) in a custom page</div>
<hr />
<div class="pda"><a href="t-190553.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=190553">Programatically change the active control (the one which has focus) in a custom page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">k_hejwosz</div><div class="date">19th August 2004, 00:02</div></div><div class="posttext">I am in the middle of developing an installer for my company's flagship application.<br />
<br />
I have designed the Select Installation Type custom page, which suggests to users the recommended installation strategy.<br />
<br />
My problem (illustrated in the attachment):<br />
If, despite recommendation, users chose Clean install, clicked Next and backtracked right upon, the installer would remember their choice but the active control would still remain the first radio button on the page (in the picture: Update).<br />
<br />
My question:<br />
Is it possible to programmatically change the active control (i.e. the one which is going to have focus on the page)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">19th August 2004, 10:35</div></div><div class="posttext">My problem (illustrated in the attachment):Where is that?<br />
<br />
Is it possible to programmatically change the active control (i.e. the one which is going to have focus on the page)?The page state is saved everytime when the user goes to another page. You can set a control state by using WriteINIStr.<br />
<br />
Problems:<br />
I think there is something in your installer that is setting the state everytime the page is executed.<br />
<br />
That means, or are you using WriteINIStr, or you're replacing the old file each time the page is executed.<br />
<br />
Solutions:<br />
You should set the state of that control much before showing the page, for example, on the installer .onInit or .onGUIInit function. This makes that page to really save that page state until the installer finishes.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">k_hejwosz</div><div class="date">19th August 2004, 10:38</div></div><div class="posttext">I did not mean the state of the control but focus band around it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">19th August 2004, 11:29</div></div><div class="posttext">OK, I created a function for you to set focus to a control. To use it, you need first to reserve the page, call this function, and only then show the page. The input used by the function is:Push &quot;YourINIFile.ini&quot; ;Page INI file<br />
Push $0 ;Page Handle (you got when reserving the page)<br />
Push &quot;2&quot; ;Control Number<br />
Call SetFocusThe function code is:Function SetFocus<br />
<br />
  Exch $0 ; Control Number<br />
  Exch<br />
  Exch $2 ; Page Handle<br />
  Exch<br />
  Exch 2<br />
  Exch $3 ; Page INI File<br />
  Exch 2<br />
  Push $1<br />
  Push $R0<br />
  Push $R1<br />
  Push $R2<br />
  Push $R3<br />
  Push $R4<br />
  Push $R5<br />
<br />
  IntOp $1 $0 + 1199<br />
  GetDlgItem $1 $2 $1<br />
<br />
  # Send WM_SETFOCUS message<br />
  System::Call &quot;user32::SetFocus(i r1, i 0x0007, i,i)i&quot;<br />
<br />
  ReadINIStr $R0 &quot;$3&quot; &quot;Field $0&quot; &quot;Left&quot;<br />
  ReadINIStr $R1 &quot;$3&quot; &quot;Field $0&quot; &quot;Right&quot;<br />
  ReadINIStr $R3 &quot;$3&quot; &quot;Field $0&quot; &quot;Top&quot;<br />
  ReadINIStr $R4 &quot;$3&quot; &quot;Field $0&quot; &quot;Bottom&quot;<br />
  IntOp $R2 $R1 - $R0<br />
  IntOp $R5 $R4 - $R3<br />
<br />
  System::Call &quot;user32::CreateCaret(i r0, i, i R2, i R5)i&quot;<br />
  System::Call &quot;user32::ShowCaret(i r0)i&quot;<br />
<br />
  Pop $R5<br />
  Pop $R4<br />
  Pop $R3<br />
  Pop $R2<br />
  Pop $R1<br />
  Pop $R0<br />
  Pop $1<br />
  Pop $0<br />
  Pop $2<br />
  Pop $3<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">19th August 2004, 13:31</div></div><div class="posttext">Nice! Thanks deguix!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">k_hejwosz</div><div class="date">22nd August 2004, 16:26</div></div><div class="posttext">Originally posted by deguix <br />
Push $0 ;Page Handle (you got when reserving the page)<br />
<br />
<br />
Could you please explain what you mean by the above. How do I reserve the page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">23rd August 2004, 11:53</div></div><div class="posttext">InstallOptions::initDialog &quot;YourPage.ini&quot; ;&lt;- Reserving the page<br />
Pop $hwnd ;&lt;- Page handle<br />
<br />
InstallOptions::show ;&lt;- Showing reserved page</div></div><hr />


<div class="post"><div class="posttop"><div class="username">k_hejwosz</div><div class="date">23rd August 2004, 12:52</div></div><div class="posttext">Thank you deguix. You were extremely helpful.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>