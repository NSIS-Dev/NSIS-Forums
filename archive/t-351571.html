<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Probleme recuperate var in custom pages, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Probleme recuperate var in custom pages NSIS Discussion" />
	
	<title> Probleme recuperate var in custom pages [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Probleme recuperate var in custom pages</div>
<hr />
<div class="pda"><a href="t-351571.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=351571">Probleme recuperate var in custom pages</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">devcphp</div><div class="date">7th November 2012, 13:28</div></div><div class="posttext">Hi<br />
<br />
I want to recuperate some var in a custom pages but i can't realise it.<br />
<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_DIRECTORY<br />
<br />
Page custom ShowCustomPageConfigurationMatricesServeur  LeaveCustomPageConfigurationMatricesServeur<br />
<br />
    Function ShowCustomPageConfigurationMatricesServeur<br />
      ReserveFile &quot;${PAGE_CUSTOM_MATRICES_SERVEUR}&quot;<br />
      !insertmacro MUI_HEADER_TEXT &quot;Personnalisation&quot; &quot;&quot;<br />
      !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;${PAGE_CUSTOM_MATRICES_SERVEUR}&quot;<br />
      !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;${PAGE_CUSTOM_MATRICES_SERVEUR}&quot;<br />
    FunctionEnd<br />
    Function LeaveCustomPageConfigurationMatricesServeur<br />
        ReadINIStr $R0 &quot;${PAGE_CUSTOM_MATRICES_SERVEUR}&quot; &quot;Field 1&quot; &quot;State&quot;    <br />
        <br />
      <br />
        ReadINIStr $R1 &quot;${PAGE_CUSTOM_MATRICES_SERVEUR}&quot; &quot;Field 2&quot; &quot;State&quot;    <br />
        ReadINIStr $R2 &quot;${PAGE_CUSTOM_MATRICES_SERVEUR}&quot; &quot;Field 3&quot; &quot;State&quot;    <br />
        ReadINIStr $R4 &quot;${PAGE_CUSTOM_MATRICES_SERVEUR}&quot; &quot;Field 4&quot; &quot;State&quot;    <br />
        ReadINIStr $R5 &quot;${PAGE_CUSTOM_MATRICES_SERVEUR}&quot; &quot;Field 9&quot; &quot;State&quot;   <br />
        ReadINIStr $R6 &quot;${PAGE_CUSTOM_MATRICES_SERVEUR}&quot; &quot;Field 12&quot; &quot;State&quot;   <br />
        <br />
       FileOpen $0 ${NOM_FICHIER_PARAMETRAGE_XML} w<br />
       FileWrite $0 &quot;&lt;?xml version=$\&quot;1.0$\&quot; encoding=$\&quot;ISO-8859-1$\&quot; standalone=$\&quot;no$\&quot;?$\r$\n&quot;<br />
       FileWrite $0 &quot;&lt;!-- standalone=no pour faire savoir à l'analyseur syntaxique xml que la dtd se trouve dans un fichier séparé--&gt;$\r$\n&quot;<br />
     <br />
       FileWrite $0 &quot;&lt;!DOCTYPE ParametrageGeneral SYSTEM $\&quot;Parametrage.dtd$\&quot;&gt;$\r$\n&quot;<br />
       FileWrite $0 &quot;&lt;ParametrageGeneral&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;!--Configuration des éléments nécéssaires aux types de connexions aux bases de données--&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;TypeConnexions&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;ParamTypeConnexion id=$\&quot;CONNECTION_TO_ACCESS$\&quot;&gt;odbc:Driver={Microsoft Access Driver (*.mdb)};Dbq=&lt;/ParamTypeConnexion&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;/TypeConnexions&gt;$\r$\n&quot;<br />
       FileWrite $0 &quot;&lt;Connexions&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;ParamConnexion id=$\&quot;CONNECTION_TO_ACCESS_ANALYSIMMO$\&quot;&gt;$R0&lt;/ParamConnexion&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;ParamConnexion id=$\&quot;CONNECTION_TO_MYDB$\&quot;&gt;$R2&lt;/ParamConnexion&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;ParamConnexion id=$\&quot;CONNECTION_TO_ACCESS_DPE$\&quot;&gt;$R1&lt;/ParamConnexion&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;ParamConnexion id=$\&quot;CONNECTION_TO_CADASTRE$\&quot;&gt;http://www.cadastre.gouv.fr&lt;/ParamConnexion&gt;$\r$\n&quot;<br />
       FileWrite $0 &quot;&lt;/Connexions&gt;$\r$\n&quot;<br />
       FileWrite $0 &quot;&lt;!--Configuration des éléments nécéssaires aux documents--&gt;$\r$\n&quot;<br />
       FileWrite $0 &quot;&lt;Generations&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;ParamGeneration id=$\&quot;SCRIPT_VB_TO_PDF$\&quot;&gt;$INSTDIR\${PDFCREATOR_DATA_FICHIERS_SOURCES}\Convert2Pdf.vbs&lt;/ParamGeneration&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;ParamGeneration id=$\&quot;SCRIPT_VB_TO_PNG$\&quot;&gt;$INSTDIR\${PDFCREATOR_DATA_FICHIERS_SOURCES}\Convert2Png.vbs&lt;/ParamGeneration&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;ParamGeneration id=$\&quot;SCRIPT_VB_TO_TIFF$\&quot;&gt;$INSTDIR\${PDFCREATOR_DATA_FICHIERS_SOURCES}\Convert2Tiff.vbs&lt;/ParamGeneration&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;ParamGeneration id=$\&quot;SCRIPT_VB_TO_BMP$\&quot;&gt;$INSTDIR\${PDFCREATOR_DATA_FICHIERS_SOURCES}\Convert2Bmp.vbs&lt;/ParamGeneration&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;ParamGeneration id=$\&quot;SCRIPT_VB_TO_JPG$\&quot;&gt;$INSTDIR\${PDFCREATOR_DATA_FICHIERS_SOURCES}\Convert2Jpg.vbs&lt;/ParamGeneration&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;ParamGeneration id=$\&quot;CHEMIN_DE_GENERATION$\&quot;&gt;$R6&lt;/ParamGeneration&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;ParamGeneration id=$\&quot;MATRICE_ERNT$\&quot;&gt;$R2&lt;/ParamGeneration&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;ParamGeneration id=$\&quot;MATRICE_NON_INDEMNISATION$\&quot;&gt;$R4&lt;/ParamGeneration&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;ParamGeneration id=$\&quot;MATRICE_INDEMNISATION$\&quot;&gt;$R5&lt;/ParamGeneration&gt;$\r$\n&quot;<br />
       FileWrite $0 &quot;&lt;Versions&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot; &lt;ParamVersion id=$\&quot;VERSION_FICHIER_XML_PARAMETRAGE$\&quot;&gt;2.0.3&lt;/ParamVersion&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;!--&lt;ParamVersion id=$\&quot;VERSION_LOGICIEL$\&quot;&gt;2.0.0&lt;/ParamVersion&gt;--&gt;$\r$\n$\t&quot;<br />
       FileWrite $0 &quot;&lt;ParamVersion id=$\&quot;VERSION_SERVEUR_ERNT$\&quot;&gt;3.0.0&lt;/ParamVersion&gt;$\r$\n&quot;<br />
       FileWrite $0 &quot;&lt;/Versions&gt;$\r$\n&quot;<br />
       FileClose $0<br />
    FunctionEnd<br />
<br />
i write an xml file but whitout any var.<br />
<br />
But if i write manually the state  in the .ini file, the xml file output contain the variable.<br />
<br />
Where is my error?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">7th November 2012, 14:31</div></div><div class="posttext">(Please use pastebin or an attachment to share large amounts of code.)<br />
<br />
First of all, verify that $R0-6 contains the proper value, using a MessageBox. If the variable is empty, it cannot be written to a file either.<br />
Second, your code example is rather unclear. Please provide a minimal script that shows your problem (without ${defines} that we don't know, etc...), and explain what it should do and what it actually does.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">devcphp</div><div class="date">7th November 2012, 15:03</div></div><div class="posttext">thank's for your response.<br />
When i use a sgBox, i don't have any value of my var.<br />
<br />
i will modify my code as you like</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">7th November 2012, 16:35</div></div><div class="posttext">If the Msgbox is empty, it means either the state is not set, or the ini file is not being read properly. Since manually editing the ini works, we must conclude that the state is not set. <br />
<br />
Not sure how that's happening, it's been years since I've touched InstallOptions. Perhaps someone else can help you, but that's where the problem appears to begin, at least.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">devcphp</div><div class="date">8th November 2012, 14:18</div></div><div class="posttext">effectively the state is not set. If i set it manuelly by editing the ini file no problem. if not nothing is read.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>