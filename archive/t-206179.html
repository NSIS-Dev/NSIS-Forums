<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to start stop uninstall services BASED on IF services are started, stopped, etc?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to start stop uninstall services BASED on IF services are started, stopped, etc? NSIS Discussion" />
	
	<title> How to start stop uninstall services BASED on IF services are started, stopped, etc? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to start stop uninstall services BASED on IF services are started, stopped, etc?</div>
<hr />
<div class="pda"><a href="t-206179.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=206179">How to start stop uninstall services BASED on IF services are started, stopped, etc?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">28th January 2005, 08:21</div></div><div class="posttext">I need to communicate with services and communication is very dependent on the services current state. e.g. There is no point in trying to start a started service. No point in trying to stop a stopped service. No point in trying to uninstall a nonexistent service...<br />
<br />
I've been pulling my hair trying hard on this. I've download the services.dll by sunjammer I believe. I've downloaded the NSIS service lib and worked with that. Both choices are no go. Sunjammers solution works with MessageBoxes BUT how do I use that to my advantage? How do I say IF service is installed GOTO Is service running? IF service is running please stop it. IF service is installed but not running please uninstall.<br />
<br />
Man, I tried clear errors, IfErrors and a bunch of other stuff and cant quite get any thing to work. This is something I tried in so many different variations but give me no cigar :( Section<br />
  ClearErrors <br />
  services::IsServiceRunning 'MyService'<br />
  Pop $0<br />
      IfErrors skip1<br />
      DetailPrint &quot;one sleeping... Stopping MyService&quot;<br />
      nsExec::ExecToLog '&quot;C:\Program Files\rock\paper\scissor.exe&quot; -stop'<br />
      Sleep 9000<br />
      skip1:<br />
<br />
  ClearErrors<br />
  services::IsServiceInstalled 'MyService'<br />
  Pop $0<br />
      IfErrors skip2<br />
      DetailPrint &quot;one sleeping... Removing MyService&quot;<br />
      nsExec::ExecToLog '&quot;C:\Program Files\rock\paper\scissor.exe&quot; -remove'<br />
      Sleep 9000<br />
      skip2:<br />
      <br />
  ClearErrors <br />
  services::IsServiceRunning 'MyService'<br />
  Pop $0<br />
      IfErrors 0 skip3<br />
      DetailPrint &quot;Second sleeping... Stopping MyService&quot;<br />
      nsExec::ExecToLog '&quot;C:\Program Files\rock\paper\scissor.exe&quot; -stop'<br />
      Sleep 9000<br />
      skip3:<br />
<br />
  ClearErrors<br />
  services::IsServiceInstalled 'MyService'<br />
  Pop $0<br />
      IfErrors 0 skip4<br />
      DetailPrint &quot;Second sleeping... Removing MyService&quot;<br />
      nsExec::ExecToLog '&quot;C:\Program Files\rock\paper\scissor.exe&quot; -remove'<br />
      Sleep 9000<br />
      skip4:<br />
SectionEnd<br />
Any body have any ideas? I much rather work with the plugin by sunjammer than work with the other script. I could in no way get the other script to work. I couldn't even get an error out of it :( Can someone please help. Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">28th January 2005, 09:44</div></div><div class="posttext">I've solved it... I was going to sleep before posting that last message but I could never really sleep without solving a problem from the night before ;)<br />
<br />
Anyway, I promise to post my solution tomorrow for those looking on seeing about how I did it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">28th January 2005, 14:18</div></div><div class="posttext">[off topic]<br />
Are you the same vbgunz from Abyss? :)<br />
[/off topic]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">28th January 2005, 20:19</div></div><div class="posttext">Hello Lobo. Yes, I am that vbgunz ;)<br />
<br />
Here is how I solved the IF service exist do something or do something else. The following code is for use with the services plugin. I hope this helps :)Section<br />
  services::IsServiceRunning 'MyService'<br />
     Pop $0<br />
      StrCmp $0 Yes 0 no_MyService_running<br />
      DetailPrint &quot;Preparing to Stop MyService&quot;<br />
       nsExec::ExecToLog '&quot;C:\Program Files\rock\paper\scissor.exe&quot; -stop'<br />
        Goto MyService_running_done<br />
	<br />
no_MyService_running:<br />
  DetailPrint &quot;HOORAY!!! Skipped an unstarted service (MyService);)&quot;<br />
   Goto MyService_running_done<br />
MyService_running_done:<br />
<br />
  services::IsServiceInstalled 'MyService'<br />
     Pop $0<br />
      StrCmp $0 Yes 0 no_MyService_installed<br />
      DetailPrint &quot;Preparing to Uninstall MyService&quot;<br />
       nsExec::ExecToLog '&quot;C:\Program Files\rock\paper\scissor.exe&quot; -remove'<br />
        Goto MyService_installed_done<br />
	<br />
no_MyService_installed:<br />
  DetailPrint &quot;HOORAY!!! Skipped uninstalling a ghost service (MyService);)&quot;<br />
   Goto MyService_installed_done<br />
MyService_installed_done:<br />
SectionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>