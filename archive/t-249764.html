<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Registry import by shell command &quot;reg import&quot;, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Registry import by shell command &quot;reg import&quot; NSIS Discussion" />
	
	<title> Registry import by shell command &quot;reg import&quot; [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Registry import by shell command &quot;reg import&quot;</div>
<hr />
<div class="pda"><a href="t-249764.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=249764">Registry import by shell command &quot;reg import&quot;</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Guv'nor</div><div class="date">27th June 2006, 10:11</div></div><div class="posttext">Hello!<br />
<br />
I tried to add some registry keys using a reg file.<br />
The syntax for the shell command looks e.g. like this:<br />
<br />
<br />
REG IMPORT d:\regfile\regfile.reg<br />
<br />
<br />
Now the problem is, if I use that in my NSIS script, it just won't work. But I copied that command out of the &quot;detail view&quot; and just pasted it into a console window, and it worked perfectly.<br />
<br />
So the command in my script must be 100% correct, but it doesn't get executed correctly. I used the following syntax:<br />
<br />
<br />
ExecWait '&quot;REG IMPORT d:\regfile\regfile.reg&quot;'<br />
<br />
<br />
Does anybody know why this doesn't work? And if it's not my fault, is there any alternative to this command?<br />
<br />
Nice greetings<br />
Guv'nor</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guv'nor</div><div class="date">27th June 2006, 10:13</div></div><div class="posttext">I'll have to add:<br />
<br />
The file is extracted into the right place before the command is executed, so there shouldn't be a &quot;file not found error&quot; or something...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guv'nor</div><div class="date">27th June 2006, 12:05</div></div><div class="posttext">Now I tried exporting the status message into a textfile using<br />
<br />
<br />
REG IMPORT d:\regfile\regfile.reg &gt; c:\test.txt<br />
<br />
<br />
and it works perfectly in the command shell. But with the installer, test.txt is not even created... very strange, isn't it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th June 2006, 12:40</div></div><div class="posttext">REG is not an executable. ExecWait requires a full executable path.<br />
<br />
Use ExecShell on &quot;d:\regfile\regfile.reg&quot;, or use ExecWait on '&quot;$WINDIR\regedit.exe&quot; &quot;d:\regfile\regfile.reg&quot;'<br />
However, you should never use a .reg file. Use NSIS's WriteRegStr, WriteRegDWORD etc<br />
<br />
You can use this to generate the script:<br />
http://nsis.sourceforge.net/Reg2Nsis_-_convert_registry_info_into_NSIS_commands<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guv'nor</div><div class="date">27th June 2006, 12:48</div></div><div class="posttext">Okay it works now, thank you! I used ExecShell. But why shouldn't you use a regfile? I think it's more flexible somehow...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">27th June 2006, 13:00</div></div><div class="posttext">It's easier for the developer, but it's not professional. You should also have RegEdit displaying a message box asking you to confirm, which is something the user may cancel.<br />
<br />
If your reg file is say version 5, it may not work on older versions of Windows. By using NSIS's registry instructions, you're benefited to know that it'll work on all Windows versions.<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>