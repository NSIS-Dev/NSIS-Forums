<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Adapt the manifest of the setup application, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Adapt the manifest of the setup application NSIS Discussion" />
	
	<title> Adapt the manifest of the setup application [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Adapt the manifest of the setup application</div>
<hr />
<div class="pda"><a href="t-345677.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=345677">Adapt the manifest of the setup application</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">SunToo</div><div class="date">20th June 2012, 07:55</div></div><div class="posttext">Hi,<br />
is there any way to adapt the manifest of a setup application created by NSIS?<br />
<br />
I would like to extend the manifest with an additional element of type<br />
<br />
&lt;supportedOS Id=&quot;{...}&quot;&gt; to support Windows 8.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">20th June 2012, 21:51</div></div><div class="posttext">You could probably use resource hacker and !packhdr but I don't think there is any point, Win7 compatibility should be enough...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">21st June 2012, 00:36</div></div><div class="posttext">Win7 (http://msdn.microsoft.com/en-us/library/windows/desktop/dd371711%28v=vs.85%29.aspx)<br />
Win8 (http://msdn.microsoft.com/en-us/library/windows/desktop/hh848036%28v=vs.85%29.aspx)<br />
<br />
The only reason we added the Win7 guid to the manifest is for PCA.<br />
The Win8 guid will change the IShellLink interface we use to create shortcuts so we would have to think about possible compatibility issues. The only benefit is theme support in high contrast mode, not a big deal IMHO.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SunToo</div><div class="date">26th June 2012, 12:59</div></div><div class="posttext">Hi Anders,<br />
<br />
thank you for your help. Your solution works great. There's just one disadvantage: The size of the resulting setup executable increased considerable (I used UPX for compression and tried different options). <br />
<br />
Regarding the required manifest support for Windows 8 I disagree. The PCA is involved if the manifest doesn't contain the supportedOS key for Windows 8. And in that case there are a lot of situations that cause the PCA to show an error dialog or just to change the behavior of your app (see http://msdn.microsoft.com/library/hh848074(v=vs.85).aspx). E.g., if the PCA detects that your setup checks the OS versions, shows a message box and aborts it informs the user that a problem occurred because Microsoft has the opinion a program should never abort because of the OS version. I could reproduce such a behavior. But in the monitored case the message box and the termination had nothing to do with the OS check performed before. Fortunately I could see that the PCA is involved. But in many cases the PCA changes the app behavior silently. <br />
So I think it is a good idea to upgrade the manifest.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>