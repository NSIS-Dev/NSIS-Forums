<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Two License Pages, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Two License Pages NSIS Discussion" />
	
	<title> Two License Pages [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Two License Pages</div>
<hr />
<div class="pda"><a href="t-136925.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=136925">Two License Pages</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">gek</div><div class="date">28th May 2003, 19:07</div></div><div class="posttext">Hi,<br />
<br />
I'm very new to NSIS and I'm trying to figure out how to make an installer that displays 2 license pages that follow each other using Modern UI. I tried something like<br />
<br />
<br />
  LicenseData &quot;[snip long absolute path]\gpl.txt&quot;<br />
<br />
  !insertmacro MUI_PAGECOMMAND_WELCOME<br />
  !insertmacro MUI_PAGECOMMAND_LICENSE<br />
<br />
  LicenseData &quot;[snip long absolute path]\warning.txt&quot;<br />
<br />
  !insertmacro MUI_PAGECOMMAND_LICENSE<br />
  !insertmacro MUI_PAGECOMMAND_DIRECTORY<br />
  !insertmacro MUI_PAGECOMMAND_STARTMENU<br />
  !insertmacro MUI_PAGECOMMAND_INSTFILES<br />
  !insertmacro MUI_PAGECOMMAND_FINISH<br />
 <br />
<br />
but it does not seem to work. :cry: Could someone help me with this issue?? <br />
<br />
One more question: Can I somehow display RTF files in the license box? It's not really necessary, but it would be nice to have. <br />
<br />
Thanks for the great installer, btw.!!<br />
<br />
Greets,<br />
Daniel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">28th May 2003, 22:06</div></div><div class="posttext">i am not sure - this might same problem with an additional readme section which is on the to-do-list.<br />
search the forum for &quot;readme&quot; and you will find no answer ;(<br />
<br />
# i forgot<br />
there exist a extlicense.dll or so - i found the SC on this site, but no DLL - dont know how to compile</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th May 2003, 22:08</div></div><div class="posttext">You will need to do the following:<br />
<br />
<br />
LicenseData &quot;[snip long absolute path]\gpl.txt&quot;<br />
<br />
  !insertmacro MUI_PAGECOMMAND_WELCOME<br />
  !insertmacro MUI_PAGECOMMAND_LICENSE<br />
  !define MUI_CUSTOMFUNCTION_LICENSE_PRE LicenseText<br />
  Page license mui.LicensePre mui.LicenseShow mui.LicenseLeave &quot;MUI_INSTALLBUTTON_LICENSE&quot;<br />
<br />
<br />
Function LicenseText<br />
  FindWindow $0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
  GetDlgItem $1 $0 102 #change<br />
  SendMessage $1 ${WM_SETTEXT} 0 &quot;STR:License Text$\r$\nLine 1$\r$\nLine 2$\r$\nLine 3&quot; #change<br />
FunctionEnd<br />
<br />
<br />
You now need to get the License text on one line into the command, and you also might need to get the right dialog number (currently 102)<br />
However, I think I have the right dialog number there?<br />
Change the dialog number until the license text within the window changes.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">28th May 2003, 22:15</div></div><div class="posttext">grmph - nice solution from the cvs i guess?<br />
when will cvs go final :cry:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gek</div><div class="date">28th May 2003, 23:33</div></div><div class="posttext">Hi,<br />
<br />
Thanks for your answer. I'm almost there! I now get the license page twice, but unfortunatly both time with the same license. When I compile the NSI I get the warning:<br />
<br />
<br />
1 warning:<br />
  install function &quot;LicenseText&quot; not referenced - zeroing code (298-301) out<br />
<br />
<br />
I don't quite understand. Perhaps you could have a look at the script?<br />
<br />
Thanks in advance,<br />
Daniel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th May 2003, 23:42</div></div><div class="posttext">Try<br />
!define MUI_CUSTOMFUNCTION_LICENSEPAGE_PRE LicenseText<br />
instead of<br />
!define MUI_CUSTOMFUNCTION_LICENSE_PRE LicenseText<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th May 2003, 10:02</div></div><div class="posttext">FindWindow, GetDlgItem and SendMessage are all present in b3 too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st May 2003, 14:55</div></div><div class="posttext">Originally posted by gek <br />
One more question: Can I somehow display RTF files in the license box? It's not really necessary, but it would be nice to have. <br />
<br />
Yes, you can. Just specify an RTF file instead of a text file in LicenseData.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">31st May 2003, 17:23</div></div><div class="posttext">Will LicenseData ever become a non compiletime command?<br />
I mean, so that it can be used multiple times to change the LicenseData on multiple LicensePages.<br />
<br />
That would be a helpful feature.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">31st May 2003, 17:27</div></div><div class="posttext">Yes.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">2nd June 2003, 10:46</div></div><div class="posttext">hi!<br />
<br />
i have a similar problem...<br />
i need to show 2 licence pages. i followed the steps (as explained in this tread), and i have 2 license pages, but with the same content (from LicenseData &quot;txt.txt&quot;). i have no errors or warnings. help !<br />
<br />
thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd June 2003, 13:36</div></div><div class="posttext">Attach the script and I'll have a look.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">2nd June 2003, 13:43</div></div><div class="posttext">here is my script:<br />
<br />
maybe it would be usefull to others to...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd June 2003, 13:54</div></div><div class="posttext">Change:<br />
GetDlgItem $1 $0 102 #change<br />
to:<br />
GetDlgItem $1 $0 1000<br />
<br />
You will also need a way to determine that the LicenseText function was called for the right page, as it will be called for both the license pages. You should probably set a variable to 1 in the page's leave function and then if it's set in the pre function change the text and reset the variable. This way you will only see the first license when the variable is not set which is when the user comes back from the second page to the first page. I'm assuming here that the two pages come right after the other, as in your script. If this is not the case anymore you will have to set the variable in other pages too to know which page you should show next.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">2nd June 2003, 14:26</div></div><div class="posttext">i changed &quot;GetDlgItem $1 $0 102 #change&quot; with &quot;GetDlgItem $1 $0 1000&quot; but i still have 2 pages with the text from LicenseData displayed.<br />
<br />
thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd June 2003, 14:31</div></div><div class="posttext">Hmm... Right. The window hasn't been created yet. You should use it in the show function not the pre function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">2nd June 2003, 15:20</div></div><div class="posttext">a little help please!<br />
<br />
where to put the variable ? in what section ? i must create a new one ?<br />
and in what section to check the state of the variable, and change it ?<br />
<br />
and the most important !<br />
how do i declare one ? :D <br />
<br />
thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd June 2003, 15:26</div></div><div class="posttext">Not a section, in the pre/show/leave functions of the pages. You don't need to declare one, just use $0, $1, ..., or $R9. This variable is meant for the LicenseText function to know in which page it is so it won't show the same text on both pages. In your case setting it on the leave function of the license page and clearing (and checking) it in the show function should be enough.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">2nd June 2003, 15:47</div></div><div class="posttext">sorry. i do not understand.<br />
<br />
maybe with an example ? a little one ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd June 2003, 15:57</div></div><div class="posttext">I have used the same pre, show and leave functions for both of the license pages because that's how it works with the MUI.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">2nd June 2003, 16:12</div></div><div class="posttext">i will try tonight. thanks very much. i'll tell you tomorow the result.<br />
thanks again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">3rd June 2003, 12:30</div></div><div class="posttext">hi!<br />
<br />
i tried and tried and finaly it works. but one big question:<br />
the first license page displayes &quot;LicenseData&quot; while for the second one i have to write manualy in the script every line. but what if i have a license about 10KB ? is it posible to display in the second page too, the license from a file ?<br />
<br />
thanks again!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd June 2003, 12:57</div></div><div class="posttext">Use this instead of the SendMessage ${WM_SETTEXT} command:<br />
<br />
SendMessage $0 ${WM_SETTEXT} 0 &quot;STR:&quot;<br />
FileOpen $1 &quot;$PLUGINSDIR\secondlicense.txt&quot; &quot;r&quot;<br />
loop:<br />
  FileRead $1 $2<br />
  SendMessage $0 0x00C2 0 &quot;STR:$2&quot;<br />
  IfErrors 0 loop<br />
FileClose $1<br />
SendMessage $0 0x00B1 0 0<br />
SendMessage $0 0x00B7 0 0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">3rd June 2003, 13:41</div></div><div class="posttext">it works. thanks.<br />
<br />
then it should work for 3 licenses too ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd June 2003, 13:53</div></div><div class="posttext">If you apply the right checking in the show and leave functions. It shouldn't be too hard, just keep in mind that the leave function is only called when the user clicks next and not on back or cancel.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">3rd June 2003, 14:54</div></div><div class="posttext">@kichik<br />
<br />
same problem here - i have no idea - not familiar with this:<br />
!include WinMessages.nsh<br />
<br />
;--------------------------------<br />
;Modern UI Configuration<br />
<br />
  !insertmacro MUI_PAGE_WELCOME<br />
<br />
  !insertmacro MUI_PAGE_LICENSE<br />
    !define MUI_LICENSEPAGE_CHECKBOX<br />
    Page license &quot;&quot; &quot;showLicense&quot; &quot;leaveLicense&quot;<br />
<br />
  !insertmacro MUI_PAGE_COMPONENTS<br />
    !define MUI_COMPONENTSPAGE_SMALLDESC<br />
<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
<br />
  !insertmacro MUI_PAGE_FINISH<br />
    !define MUI_FINISHPAGE_SHOWREADME_NOTCHECKED &quot;$INSTDIR\readme.txt&quot;<br />
  <br />
  !define MUI_ABORTWARNING<br />
<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_UNPAGE_INSTFILES<br />
<br />
;--------------------------------<br />
;Data<br />
  <br />
  LicenseData &quot;license.txt&quot;<br />
  <br />
;--------------------------------<br />
;Reserve Files<br />
<br />
  ReserveFile &quot;readme.txt&quot;<br />
<br />
;--------------------------------<br />
;Installer Functions<br />
<br />
Function showLicense<br />
  StrCmp $R9 1 0 skip<br />
    FindWindow $0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
    GetDlgItem $0 $0 1000<br />
<br />
    SendMessage $0 ${WM_SETTEXT} 0 &quot;STR:&quot;<br />
    FileOpen $1 &quot;readme.txt&quot; &quot;r&quot;<br />
    loop:<br />
      FileRead $1 $2<br />
      SendMessage $0 0x00C2 0 &quot;STR:$2&quot;<br />
      IfErrors 0 loop<br />
    FileClose $1<br />
    SendMessage $0 0x00B1 0 0<br />
    SendMessage $0 0x00B7 0 0<br />
<br />
  skip:<br />
    StrCpy $R9 0<br />
FunctionEnd<br />
<br />
Function leaveLicense<br />
  StrCpy $R9 1<br />
FunctionEnd<br />
<br />
;--------------------------------<br />
<br />
<br />
I get twice the License-Page with nail [x] and when i reached the compo-page and step one step back i get my readme in a small (license) window and a nail. step back once more and repeat from license page same procedure.<br />
<br />
:confused:<br />
<br />
##<br />
second problem - i get no option for the readme at the end. cvs-problem? 2b3 did so. Or just again the MUI?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">3rd June 2003, 15:02</div></div><div class="posttext">try changing like this:<br />
<br />
FileOpen $1 &quot;readme.txt&quot; &quot;r&quot; to FileOpen $1 &quot;$PLUGINSDIR\readme.txt&quot; &quot;r&quot;<br />
<br />
and you must have this:<br />
<br />
Function .onInit  <br />
  InitPluginsDir<br />
  File /oname=$PLUGINSDIR\readme.txt &quot;readme.txt&quot;<br />
FunctionEnd<br />
<br />
hope it will help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">3rd June 2003, 15:29</div></div><div class="posttext">for kichik,<br />
<br />
i tried (for the 3rd license page) but no result.<br />
so for the moment it will remain so.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">3rd June 2003, 18:28</div></div><div class="posttext">Can you attach the script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd June 2003, 18:41</div></div><div class="posttext">Brummelchen, please attach large scripts from now on. o_owd answer is correct, you have to extract the file first and use full path.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">3rd June 2003, 21:31</div></div><div class="posttext">for Joost:<br />
<br />
Can you attach the script? <br />
<br />
this question was for me? or Brummelchen?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">3rd June 2003, 21:51</div></div><div class="posttext">does not work so far :(<br />
<br />
After MUI_PAGE_WELCOME<br />
<br />
MUI_PAGE_LICENSE<br />
 image (http://bernd.dusnet.de/becky/other/b2plugs2.gif)<br />
Page license &quot;&quot; &quot;showLicense&quot; &quot;leaveLicense&quot;<br />
 image (http://bernd.dusnet.de/becky/other/b2plugs3.gif)<br />
MUI_PAGE_COMPONENTS<br />
 image (http://bernd.dusnet.de/becky/other/b2plugs4.gif)<br />
then back to Page license<br />
 image (http://bernd.dusnet.de/becky/other/b2plugs5.gif)<br />
<br />
and so on ...<br />
<br />
i always get the correct readme when i step back.<br />
<br />
script is attached so far (sorry for inconvenience)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">4th June 2003, 06:48</div></div><div class="posttext">i don't know why it does not display the borh license pages.<br />
<br />
try with this script. (it works in my script)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">4th June 2003, 16:19</div></div><div class="posttext">Greta move - u da man :D<br />
<br />
it works. i have made a little change to get different pageheaders<br />
<br />
&gt;  Page license &quot;&quot; &quot;showLicense&quot; &quot;leaveLicense&quot;<br />
&gt;  Page license &quot;&quot; &quot;showLicense1&quot; &quot;leaveLicense&quot;<br />
<br />
but one little teardrop<br />
<br />
&gt; !define MUI_LICENSEPAGE_CHECKBOX<br />
<br />
no checkbox so far</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th June 2003, 20:35</div></div><div class="posttext">Brummelchen, you have to use the MUI macros all the way if you are using the MUI. Using Page as a replacment for the MUI_PAGE_LICENSE macro is what causing you all of the problems above.<br />
<br />
o_owd, please attach the script, or describe the logic you've tried to include 3 license pages.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">4th June 2003, 20:58</div></div><div class="posttext">@kichik<br />
<br />
&gt; !define MUI_LICENSEPAGE_CHECKBOX <br />
<br />
exist there a MUI macro for that?<br />
<br />
&gt; or describe the logic you've tried to include 3 license pages.<br />
<br />
I made an example to this, i hope that helps - it is based on the script from o_owd<br />
<br />
The MUI section must be like this<br />
<br />
&gt; Page license &quot;&quot; &quot;showLicense&quot; &quot;leaveLicense&quot; <br />
&gt; Page license &quot;&quot; &quot;showLicense1&quot; &quot;leaveLicense&quot; <br />
&gt; Page license &quot;&quot; &quot;showLicense2&quot; &quot;leaveLicense&quot; <br />
...<br />
<br />
the first function is reduced 'cause it only displays the normal license.txt</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th June 2003, 21:02</div></div><div class="posttext">No, &quot;Using Page as a replacment for the MUI_PAGE_LICENSE macro is what causing you all of the problems above. &quot;<br />
<br />
MUI_LICENSEPAGE_CHECKBOX is a MUI define and is OK, but worth nothing if you don't use the MUI macro to insert the license page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">4th June 2003, 21:25</div></div><div class="posttext">@kichik<br />
<br />
So there is no alternative for that? Not a problem at all - the checkbox is only preventing from &quot;klick - klick - klick - installed&quot; must be &quot;klick - read - check - klick - installed&quot; ;)<br />
But the other way dont work.<br />
<br />
Is it possible to get the checkbox additional from InstallOption?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th June 2003, 21:42</div></div><div class="posttext">The other way is the only right way and it can work, you only need to find the right logic to make it show the right license in the right page. The logic implemented in my examples works for two pages that come one after the other. If you have another case you'd have to find another logic and implement it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Brummelchen</div><div class="date">4th June 2003, 22:29</div></div><div class="posttext">&gt;&gt; you only need to find the right logic to make it show the right license in the right page. The logic implemented in my examples works for two pages that come one after the other.<br />
<br />
Thats what i am doing to - Welcome/license/readme<br />
but so far i have no check button only the &quot;accept&quot; button.<br />
<br />
to prevent misunderstandings...<br />
you have a solution for that (2pages with check button) or not?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th June 2003, 22:37</div></div><div class="posttext">Again, you don't have a check button because you have told the MUI to add a check button but haven't used the MUI's way of including pages, you have used the Page command.<br />
<br />
The code I have attached above implements a logic to show two license pages that come one after another. All you need to do is translate it to MUI macros (change Page commands to the appropriate !insertmacro, define the right values, etc.)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">5th June 2003, 07:21</div></div><div class="posttext">for kichik,<br />
<br />
i am trying to make a codec pack. there are a lots of them, so everybody knows what i'm talking about.<br />
i try to include 3 license pages because there are 3 diffrent licenses: <br />
the DivX codec has it's own license, then XviD and AC3 Filter are open source, so GNU license file, and Windows Media Player - Microsoft. so EULA is the 3rd.<br />
<br />
for showing 2 of them i was using the code you showed me. but i need 3 of them. thanks to Brummelchen i have now 3 of them, but as you said - Page is just a replacement for MUI_PAGE_LICENSE.<br />
<br />
so kichik, the logic was yours. you gave me the idea with &quot;Page&quot;. why do i need 3 ? i just explained.<br />
as for Brummelchen, is not my code, so the credit is not mine. it's kichik.<br />
<br />
i'll attach the script. i think the script it's really nice, and maybe it will inspire others:<br />
<br />
multiple license pages, custom page that appear only if one section was selected, as for uninstaller, it remembers what sections were installed. so it won't delete everything.<br />
<br />
in a few words: everything that you helped me in the past few weeks.<br />
<br />
really, a big thank you, man. to all of you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th June 2003, 14:07</div></div><div class="posttext">Attached are two scripts that will hopefully clear this up. One with the MUI and one without. The one with the MUI uses the same show and leave function for all three pages and therefor requires a certain logic to know which page should be shown where the script without the MUI uses the Page command and therefor has a different show and leave function for every license page. The second script, using Page, doesn't require any logic because you know in which page you are by the function called.<br />
<br />
Once again, do NOT use the Page command for non custom (Page custom - InstallOptions and such) in a MUI script! It's not only the checkbox missing, there's a lot more. Just don't.<br />
<br />
The logic in the MUI script is required because you can't define a separate function for every license page but only one for all three. Therefor you must know in which page you're manually and not by the function called because there is just one function.<br />
<br />
Last time, do NOT use Page license instead of !insertmacro MUI_PAGE_LICENSE in a MUI script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">o_owd</div><div class="date">5th June 2003, 14:24</div></div><div class="posttext">you're the man. i'm done with this. thanks.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>