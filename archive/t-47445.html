<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" CreateShortcut problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  CreateShortcut problem NSIS Discussion" />
	
	<title> CreateShortcut problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  CreateShortcut problem</div>
<hr />
<div class="pda"><a href="t-47445.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=47445">CreateShortcut problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">PabUK</div><div class="date">18th April 2001, 12:25</div></div><div class="posttext">I have the following code in an NSIS script:<br />
<br />
SetOutPath &quot;$STARTMENU\Programs\PAWSoft\PAWClock&quot;<br />
CreateShortCut &quot;$STARTMENU\Programs\PAWSoft\PAWClock\PAWClock.lnk&quot; &quot;$INSTDIR\PAWClock.exe&quot; &quot;&quot; &quot;&quot; 0<br />
CreateShortCut &quot;$STARTMENU\Programs\PAWSoft\PAWClock\Read Me.lnk&quot; &quot;$INSTDIR\ReadMe.txt&quot; &quot;&quot; &quot;&quot; 0<br />
CreateShortCut &quot;$STARTMENU\Programs\PAWSoft\PAWClock\Whats New.lnk&quot; &quot;$INSTDIR\WhatsNew.txt&quot; &quot;&quot; &quot;&quot; 0<br />
CreateShortCut &quot;$STARTMENU\Programs\PAWSoft\PAWClock\Uninstall PAWClock.lnk&quot; &quot;$INSTDIR\Uninstall.exe&quot; &quot;&quot; &quot;&quot; 0<br />
<br />
This code works fine for me whatever I do, such as installing to a non-default location and installing on another partition.<br />
<br />
Th problem is that I have a beta tester and the createshortcuts failed for him. He sent me this screenshot:<br />
<br />
http://www.pawsoft.btinternet.co.uk/temp/NSISProb.gif<br />
<br />
He later told me that he installed it to E:\win_util\pawclock<br />
<br />
As I said I tested it myself on other partitions so I can't see how it could be that. Has anyone got any ideas why it might be failing or a way of getting more info?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PabUK</div><div class="date">18th April 2001, 12:28</div></div><div class="posttext">Also, I have just noticed that NSIS has $SMPROGRAMS, is it better to use than $STARTMENU\Programs or is it just for convenience?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PabUK</div><div class="date">18th April 2001, 14:08</div></div><div class="posttext">Just got another response from the tester with this problem:<br />
<br />
Just in case it matters, I am using Windows ME and yes, other programs install okay. I checked the c:\program file directory because it is still there. I notice the error is referring to c:\windows\start menu\program and this directory is present. I tried three times and used the defaults and it still shows the error.<br />
<br />
Please, has anyone seen this sort of error with CreateShortcut before? I hope it is only local to his system, but it is a worry either way.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tale</div><div class="date">8th May 2001, 00:21</div></div><div class="posttext">I've noticed that if the folder doesn't exist on my start menu under programs that the shortcuts don't get created there.  Maybe that was the problem.  I have to copy a file to the place I want to create the shortcuts and then delete the file.  Then I can create my shortcuts successfully.  I don't have any problems creating shortcuts anywhere else.<br />
<br />
--tale</div></div><hr />


<div class="post"><div class="posttop"><div class="username">THEMike</div><div class="date">9th May 2001, 09:12</div></div><div class="posttext">Ok SMPROGRAMS (if that is correct) is much better to use.<br />
<br />
Why? Well because it's not always start menu/programs.<br />
<br />
I had some Dannish user complaining to me that it had created programs on his machine instead of putting it in his programma folder.<br />
<br />
So I posted on the beta list, and the nice person on the list(craigf I think it was) provided me (/me no like c) with a fix, and next release something similar turned up. Cool.<br />
<br />
Anyway I digress.<br />
<br />
CreateShortcut requires the folders to already exist, you have to create the folder in the SMPROGRAMS then create shortcut in there, which I see you are doing.<br />
<br />
Next it's the icon issue. I see you are using icon 0 in a non-extant file. Oh dear. If you want to specify an icon you have to specify the file too! If you don't specify either it works, if you specify one you have to specify the other.<br />
<br />
e.g.<br />
<br />
SetOutPath &quot;$STARTMENU\Programs\PAWSoft\PAWClock&quot; <br />
CreateShortCut &quot;$STARTMENU\Programs\PAWSoft\PAWClock\PAWClock.lnk&quot; &quot;$INSTDIR\PAWClock.exe&quot; &quot;&quot; $INSTDIR\PAWClock.exe 0 <br />
<br />
<br />
If you want to default:<br />
<br />
SetOutPath &quot;$STARTMENU\Programs\PAWSoft\PAWClock&quot; <br />
CreateShortCut &quot;$STARTMENU\Programs\PAWSoft\PAWClock\PAWClock.lnk&quot; &quot;$INSTDIR\PAWClock.exe&quot;<br />
<br />
<br />
Will do fine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PabUK</div><div class="date">9th May 2001, 13:30</div></div><div class="posttext">My script has been completely rewritten in the 3 weeks since I posted that first message. It is now much better and has not failed in any situation so far. Part of the problem was with an NSIS bug in 1.3 but that has all been fixed now in the latest versions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">THEMike</div><div class="date">9th May 2001, 16:19</div></div><div class="posttext">DOH!<br />
<br />
/me notices dates of PsyPab's posts<br />
<br />
Well that will teach me to read the forums in such a rush.<br />
<br />
Ah dagnamit. Better late than never ;-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PabUK</div><div class="date">9th May 2001, 19:55</div></div><div class="posttext">Doesn't matter, I would probably have appreciated it at the time.<br />
<br />
I hardly ever check the post date, so I can see how easy it could have happened. Especially in a forum as slow moving as this one (NSIS).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>