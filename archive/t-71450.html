<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" how to use upx to compress exe first before make installer, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  how to use upx to compress exe first before make installer NSIS Discussion" />
	
	<title> how to use upx to compress exe first before make installer [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  how to use upx to compress exe first before make installer</div>
<hr />
<div class="pda"><a href="t-71450.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=71450">how to use upx to compress exe first before make installer</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">hotice</div><div class="date">10th January 2002, 07:08</div></div><div class="posttext">for example<br />
I have a a.exe in disk c.<br />
I wrote ExecWait(&quot;c:\upx -9 c:\a.exe&quot;) in a Section named a at the beginning of the script file, it is no use.<br />
If I wrote same line in Section  &quot;Copy Files&quot;, it will excute when I run the installer and it is not what i want.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">10th January 2002, 07:24</div></div><div class="posttext">But what do you want exactly?<br />
<br />
You can use UPX to compress the Header of the Installer by using the following command at the beginning of the script<br />
<br />
!packhdr &quot;temp.dat&quot; &quot;C:\Programme\NSIS\upx.exe --best temp.dat&quot;<br />
<br />
But if you want to compress a file that you want to include in the installer you have to do it either before you built the installer or you call UPX after file was installed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hotice</div><div class="date">10th January 2002, 08:34</div></div><div class="posttext">Originally posted by flizebogen <br />
But what do you want exactly?<br />
<br />
<br />
But if you want to compress a file that you want to include in the installer you have to do it either before you built the installer or you call UPX after file was installed. <br />
YES1<br />
Function .onInit<br />
  SetOutPath $TEMP<br />
  File /oname=spltmp.bmp &quot;sarp.bmp&quot;<br />
<br />
  File /oname=spltmp.exe &quot;C:\program files\nsis\splash.exe&quot;<br />
  ExecWait '&quot;$TEMP\spltmp.exe&quot; 1000 $HWNDPARENT $TEMP\spltmp'<br />
  Delete $TEMP\spltmp.exe<br />
  Delete $TEMP\spltmp.bmp<br />
;  Delete $TEMP\spltmp.wav<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kreft</div><div class="date">10th January 2002, 19:30</div></div><div class="posttext">i dont fully understand if it is a question or not but if it were this would be the answer :)<br />
<br />
!packhdr temp.exe &quot;upx\upx --best temp.exe&quot;<br />
<br />
this will compress the header of the installer, hope that helps</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hotice</div><div class="date">11th January 2002, 01:43</div></div><div class="posttext">Originally posted by Kreft <br />
i dont fully understand if it is a question or not but if it were this would be the answer :)<br />
<br />
!packhdr temp.exe &quot;upx\upx --best temp.exe&quot;<br />
<br />
this will compress the header of the installer, hope that helps <br />
Sorry For My Poor English.<br />
What I need is to run a command to upx my own exe file first.<br />
then create the installer.<br />
eg.<br />
My App includes<br />
a.exe 1000K bytes <br />
a.txt 1000k bytes <br />
My Installer<br />
Myapp.exe<br />
I want the srcipt<br />
do following steps<br />
1. upx a.exe 1000K-&gt;400K<br />
2. nsis compress a.exe(400K)-&gt;(390K)<br />
  +a.txt(1000k)-&gt;(200K)<br />
3. nsis add header(40k)+some info(2k)+390K+200K<br />
 to Myapp.exe (632K)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kreft</div><div class="date">11th January 2002, 01:48</div></div><div class="posttext">i would check with your upx documentaion on how to compress your app then do so thru an execwait in your script and then use the code i gave you above to pack the nsis header</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th January 2002, 09:29</div></div><div class="posttext">Hi!<br />
<br />
What you need is a simple batch file that you run when you want to compile your installer.<br />
<br />
Something like:<br />
upx myapp.exe<br />
upx mytext.txt<br />
makensis myinstall.nsi<br />
<br />
KiCHiK</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">11th January 2002, 13:06</div></div><div class="posttext">Hi hotice,  !System '[path to UPX]\UPX --best [path to MyProg]\MyProg.exe'Stick this line of code at the start of your script for any files that need compressing. These files will then be compressed before they are packed into the installer.<br />
<br />
Hope this helps!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasonFriday13</div><div class="date">24th August 2005, 06:27</div></div><div class="posttext">This thread has not been replied to for over three and a half years :). I now use upx to compress the header of my installers. I added !packhdr to the nsisconf.nsh file so all installers are now packed by upx. The overhead usually goes down to 30KB from 47KB (these are approximate).</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>