<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" checking .NET versions, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  checking .NET versions NSIS Discussion" />
	
	<title> checking .NET versions [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  checking .NET versions</div>
<hr />
<div class="pda"><a href="t-143877.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=143877">checking .NET versions</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dabossuk</div><div class="date">28th July 2003, 13:25</div></div><div class="posttext">Hi<br />
<br />
I have been using the .NET script that checks for .NET installed, and it works just fine.<br />
<br />
However as .NET 1.1 is now out - the script does not check for differnet versions :-) ... would someone mind updating the script so it can check for 1.1 as well as 1.0.  Sorry its a little beyond my skills to change.<br />
<br />
Also in case people are planning on doing this, I have found that using GACutil.exe to put .NET components into the global assembly cache works just fine in NSIS. ;-)<br />
<br />
Thanks<br />
<br />
DabossUK</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd August 2003, 10:56</div></div><div class="posttext">I don't think it will be too hard to add a check for a minial version in the script (http://nsis.sourceforge.net/archive/viewpage.php?pageid=24). If you add and upload it here I'll update the archive page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dabossuk</div><div class="date">5th August 2003, 12:19</div></div><div class="posttext">Hey<br />
<br />
Sorry, but changing that code is a little over my skill level.  Still do not funny understand all the functions.<br />
<br />
However, I scrapped the .NET script (for some reason the version is NOT stored in the registry from what I can see.  So I have used this method instead.  Does the job so guess thats ok ;-) ?<br />
<br />
<br />
	IfFileExists $WINDIR\Microsoft.NET\Framework\v1.1.4322\*.* abort<br />
			MessageBox MB_YESNO|MB_ICONEXCLAMATION &quot;Service  requires the Microsoft .NET Framework 1.1 to run.  $\r$\nThe installer cannot find a version installed on this machine. $\r$\n Do you wish to install from the Internet ?  $\r$\nIf not please install .NET Framework and rerun the installer.&quot; IDYES +1 IDNO Abort2<br />
				ExecShell open http://msdn.microsoft.com/netframework/downloads/howtoget.asp<br />
				Abort</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th August 2003, 12:42</div></div><div class="posttext">That may not work if the directory is<br />
v1.1.4323 or something slightly different.<br />
<br />
You should find the directory that is v1.1* using FindFirst/Next:<br />
<br />
ClearErrors<br />
 FindFirst $R0 $R1 &quot;$WINDIR\Microsoft.NET\Framework\v1.1*&quot;<br />
loop:<br />
 IfErrors error<br />
 IfFileExists &quot;$R1\*.*&quot; exit<br />
ClearErrors<br />
 FindNext $R0 $R1<br />
Goto loop<br />
error:<br />
 MessageBox MB_OK &quot;You do not have M$ .NET 1.1 or higher installed!&quot;<br />
exit:<br />
 FindClose $R0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">5th August 2003, 13:42</div></div><div class="posttext">Of course, this solution won't work once .NET 1.2 is released. :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LordKurgan</div><div class="date">2nd April 2004, 02:18</div></div><div class="posttext">Can someone post the full script on how to check if 1.1 is intalled</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">2nd April 2004, 13:55</div></div><div class="posttext">See above.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LordKurgan</div><div class="date">4th April 2004, 23:32</div></div><div class="posttext">i'm no good with coding there any change u code cut and paste me together a scrip and tell me where to stick it in the nsi file :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">5th April 2004, 07:57</div></div><div class="posttext">Put it in a section or function where you need to know the version.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LordKurgan</div><div class="date">6th April 2004, 03:35</div></div><div class="posttext">how?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">6th April 2004, 14:20</div></div><div class="posttext">I have no idea what you mean. This is normal NSIS script code. If you don't know the script langauge you'll have to learn it first.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>