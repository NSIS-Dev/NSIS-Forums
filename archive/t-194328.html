<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" &quot;Error Opening File for Writing&quot;, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  &quot;Error Opening File for Writing&quot; NSIS Discussion" />
	
	<title> &quot;Error Opening File for Writing&quot; [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  &quot;Error Opening File for Writing&quot;</div>
<hr />
<div class="pda"><a href="t-194328.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=194328">&quot;Error Opening File for Writing&quot;</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">storm2k</div><div class="date">21st September 2004, 22:12</div></div><div class="posttext">I am trying to create an installer that will install several fixes for problems that come up at our help desk. Basically, the client chooses one option, and it will install that patch. Right now I'm stuck on this one piece of the puzzle:<br />
<br />
Section /o &quot;TimJr PCP Fix&quot; g1o8<br />
<br />
  SetOutPath %DESKTOP<br />
<br />
  Call RunPCPFix<br />
  MessageBox MB_OK|MB_ICONEXCLAMATION &quot;Please make sure that TIM SR (CIS and \<br />
  ETMMAIN) are closed before proceeding. A Talk-2-Jr will \<br />
  be run as part of the fix, so please ensure that \<br />
  your Jornada is connected.&quot;<br />
<br />
  File &quot;TimJrPCP.exe&quot;<br />
  File &quot;pcp.bat&quot;<br />
  ExecWait &quot;%DESKTOP\pcp.bat&quot;<br />
  Delete &quot;%DESKTOP\TimJrPCP.exe&quot;<br />
  Delete &quot;%DESKTOP\pcp.bat&quot;<br />
<br />
SectionEnd<br />
<br />
The simple exercise is that it extracts this executable file and a batch file, runs the batch file and then deletes both files off the desktop. This code compiles fine, but when I'm trying to run the installer, I'll get a &quot;error opening file for writing&quot; error. I'm not sure what's going on, but this is happening for both the executable and the batch file. I checked the forum, and the only things I got there that were useful were to check if the files are read only (they're not) and to check the outpath to make sure that the directories were created (given that it's the desktop constant, it should be.<br />
<br />
Can anyone help?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">storm2k</div><div class="date">22nd September 2004, 07:25</div></div><div class="posttext">Actually, while I'm at it, I'll ask two related questions, because I think I can do most of what the batch file does right in my script, if I could get it to unpack the files properly.<br />
<br />
One of the things I need to do is copy the executable to two sepeate places and rename it. Could I just do that easily with by adding an oname switch to the file command? If so, I know i could just use ExecWait for the command I need to run (or if not, just have it extract a batchfile with the commands to run into $TEMP and ExecWait on that).<br />
<br />
I'm mostly confused, however, because other sections of my script extract and install files to various directories, and I have tested these sections and they work without a problem, so I'm a bit baffled about what's happening here, unless it's due to compression (I'm using lzma, but I also tried zlib and had the same issue).<br />
<br />
I would really appreciate any help that anyone could provide for me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">22nd September 2004, 13:23</div></div><div class="posttext">Uhm, the first thing I noticed there is that you've used %DESKTOP and not $DESKTOP. It's $ not %!<br />
<br />
Use NSIS' CopyFiles to copy files!<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">storm2k</div><div class="date">22nd September 2004, 15:42</div></div><div class="posttext">Wow, this was a silly error. That was it. <br />
<br />
Thanks for your help :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>