<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NT Authority and Scheduler Code, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NT Authority and Scheduler Code NSIS Discussion" />
	
	<title> NT Authority and Scheduler Code [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NT Authority and Scheduler Code</div>
<hr />
<div class="pda"><a href="t-280461.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=280461">NT Authority and Scheduler Code</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bulgin</div><div class="date">31st October 2007, 23:59</div></div><div class="posttext">Thanks for everyone's help when I had problems with the code for the scheduler -- I can get it to work now.  One thing that confuses me, though, is I can get a scheduled task to run using AUTHORITY\System without a password if I'm creating the task with the Windows Task Scheduler GUI.  If I use Authority\System as the user without password in the NSIS script, it fails to run.  Me no understand.  No Cabish!  Is this standard behavoir?  Can I make it so that the NSIS script can run with Authority\System and no password?  Thanks in advance and I apologize for my lack of knowledge at this point in time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">1st November 2007, 19:55</div></div><div class="posttext">I don't understand. Are you running a NSIS installer from a scheduled task and get nothing or are you trying to schedule task with NSIS and fail?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bulgin</div><div class="date">2nd November 2007, 00:50</div></div><div class="posttext">Kichik thanks for your reply.  <br />
<br />
I am successful running a scheduled task from the NSIS generated executable as per the code.  I need to input the current user and their password for it to work -- that I believe is normal behavior.  However, I would like to run it as NT Authority\System and I am unable to do so when I do this to the code:<br />
<br />
Section &quot;SiteSecureBackup&quot;<br />
push &quot;My Task&quot;<br />
push &quot;My Task Comment&quot;<br />
push &quot;c:\Working Dir\My Task Program.exe&quot;<br />
push &quot;c:\Working Dir&quot;<br />
push &quot;&quot;<br />
push &quot;*(&amp;l2, &amp;i2 0, &amp;i2 2007, &amp;i2 11, &amp;i2 1, &amp;i2 0, &amp;i2 0, &amp;i2 0, &amp;i2 9, &amp;i2 0, i 0, i 0, i 0, i 2, &amp;i2 1, &amp;i2 0x2, &amp;i2 0, i 0, &amp;i2 0) i.s&quot;<br />
push &quot;NT Authority\System&quot;<br />
push &quot;&quot;<br />
Call CreateTask<br />
Pop $0<br />
MessageBox MB_OK &quot;CreateTask result: $0&quot;<br />
<br />
<br />
HOWEVER I am able to run a task with the NT Authority\System user and no password when I create the task using the Windows scheduler wizard built into Windows XP (I just input &quot;NT Authority\System&quot; into the &quot;Enter the user name&quot; box and leave password blank).  So why does it work with the wizard but not the script?  I would like to be able to run a task using the NSIS Script using NT Authority\System just like wizard does.  Can this be done?  Thank you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">2nd November 2007, 09:16</div></div><div class="posttext">You need to update the script to pass NULL instead of an empty password. In the SetAccountInformation call, replace r8 with n.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bulgin</div><div class="date">3rd November 2007, 05:23</div></div><div class="posttext">thank you, and in following part did I do it correctly?  Or should those &quot;pushes&quot; both be blank?<br />
<br />
Thanks<br />
<br />
Section &quot;SiteSecureBackup&quot;<br />
push &quot;My Task&quot;<br />
push &quot;My Task Comment&quot;<br />
push &quot;c:\Working Dir\My Task Program.exe&quot;<br />
push &quot;c:\Working Dir&quot;<br />
push &quot;&quot;<br />
push &quot;*(&amp;l2, &amp;i2 0, &amp;i2 2007, &amp;i2 11, &amp;i2 1, &amp;i2 0, &amp;i2 0, &amp;i2 0, &amp;i2 9, &amp;i2 0, i 0, i 0, i 0, i 2, &amp;i2 1, &amp;i2 0x2, &amp;i2 0, i 0, &amp;i2 0) i.s&quot;<br />
push &quot;NT Authority\System&quot;<br />
push &quot;&quot;<br />
Call CreateTask<br />
Pop $0<br />
MessageBox MB_OK &quot;CreateTask result: $0&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd November 2007, 10:27</div></div><div class="posttext">You need to update CreateTask itself, not your code that calls CreateTask.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bulgin</div><div class="date">3rd November 2007, 16:30</div></div><div class="posttext">Yes, I replaced SetAccountInformation r8 with n higher up in the script.  My question is: is that replacement higher up in the script, plus the changes I made in the code that calls CreateTask sufficient?  I'm a newbie (I'm sure you can tell that by now) so I'm unclear when you say &quot;you need to update CreateTask itself&quot;.  I thought I did that.<br />
<br />
Thank you for your expertise and help.  Peace.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd November 2007, 16:34</div></div><div class="posttext">The section code seems fine at first look. Doesn't it work now with the CreateTask modification?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bulgin</div><div class="date">3rd November 2007, 16:40</div></div><div class="posttext">Kickik -- I'm going to have to get back later today.  Office computers under trojan attacks and I must go in to repair.  But I can say that yesterday when I tried it with the modifications we are speaking of, the Windows Scheduler still showed it as being created by the local user and not &quot;NT Authority\System&quot;, but I didn't have the time to troubleshoot then.  Will later.<br />
<br />
Talk later.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>