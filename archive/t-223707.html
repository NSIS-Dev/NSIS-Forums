<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" just want to add to registry not install a program, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  just want to add to registry not install a program NSIS Discussion" />
	
	<title> just want to add to registry not install a program [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  just want to add to registry not install a program</div>
<hr />
<div class="pda"><a href="t-223707.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=223707">just want to add to registry not install a program</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">fieryidris</div><div class="date">10th August 2005, 17:24</div></div><div class="posttext">i have been struggling with trying to create a simple interface that will just add / delete registry keys to personalise a program but i am not very computery and although i have managed to use the HM NIS edit wizard to make myself a ini file that using the C:\Program Files\NSIS\Examples\InstallOptions testlink.exe ends up looking similar to what i want to do i am not sure how to actually make it up properly so it works.<br />
<br />
i do not need the install button at the bottom of the page but i dont know how to get rid of it.<br />
<br />
i would also like to use the modern ui but i am not sure how to combine them together, and anyway that can wait until i understand how to make it work properly how it is at the moment.<br />
<br />
this is the ini file (testlink.ini)<br />
<br />
; Ini file generated by the HM NIS Edit IO designer.<br />
[Settings]<br />
NumFields=5<br />
<br />
[Field 1]<br />
Type=Button<br />
Text=exit<br />
State=quit<br />
Left=214<br />
Right=264<br />
Top=108<br />
Bottom=123<br />
<br />
[Field 2]<br />
Type=Button<br />
Text=website<br />
State=http://www.awebsite.com<br />
Left=24<br />
Right=74<br />
Top=105<br />
Bottom=121<br />
<br />
[Field 3]<br />
Type=Link<br />
Text=add something to the registry<br />
State=WriteRegStr HKCU &quot;&quot;Software\My Company\My Software&quot; &quot;String Value&quot; &quot;dead beef&quot;..WriteRegStr HKCU &quot;Software\My Company\My Software&quot; &quot;String Value&quot; &quot;dead beef&quot;<br />
TxtColor=0xFF00FF<br />
Left=98<br />
Right=211<br />
Top=12<br />
Bottom=30<br />
<br />
[Field 4]<br />
Type=Link<br />
Text=add something to the registry and something else<br />
State=WriteRegStr HKCU &quot;&quot;Software\My Company\My Software&quot; &quot;String Value&quot; &quot;dead beef&quot;..WriteRegStr HKCU &quot;Software\My Company\My Software&quot; &quot;String Value&quot; &quot;dead beef&quot;<br />
TxtColor=0xFF00FF<br />
Left=78<br />
Right=240<br />
Top=44<br />
Bottom=62<br />
<br />
[Field 5]<br />
Type=Link<br />
Text=remove something from the registry<br />
State=DeleteRegKey HKCU &quot;Software\My Company\My Software&quot;<br />
TxtColor=0x0000FF<br />
Left=94<br />
Right=211<br />
Top=71<br />
Bottom=89<br />
<br />
<br />
<br />
am i doing it all completely wrong or what? please dont get too complicated on me my head is already about to explode as it is.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">10th August 2005, 18:34</div></div><div class="posttext">As NSIS was not made for simple applications, it's bound to be complicated. It would be much easier to use Visual Basic to create a program to do this.<br />
<br />
In NSIS though, you need to firstly use Resource Hacker to remove the Next button (IDD 105). You can't delete the button though, only hide it (otherwise makensis won't let you compile).<br />
<br />
To make links actually do something, you need the Flags=NOTIFY setting. You then in the page's Leave function need to read from Settings-&gt;State in the INI file with ReadINIStr to determine which link field number was clicked on.<br />
<br />
Don't bother with MUI here. You can simply use XPStyle on instead.<br />
<br />
-Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>