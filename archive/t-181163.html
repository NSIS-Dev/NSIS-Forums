<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" 2000 pro or server, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  2000 pro or server NSIS Discussion" />
	
	<title> 2000 pro or server [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  2000 pro or server</div>
<hr />
<div class="pda"><a href="t-181163.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181163">2000 pro or server</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">scriptjunkie</div><div class="date">25th May 2004, 19:52</div></div><div class="posttext">Is there a way to tell the difference between windows server and professional? I can't seem to figure out a way that a program will only install on a server.<br />
<br />
Thanks for your assistance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">26th May 2004, 16:34</div></div><div class="posttext">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion contains a string called &quot;ProductName&quot; which contains the value &quot;Windows 2000&quot;, on the w2k professional build; However, this string does not exist on w2k Server.<br />
<br />
I only have one 2k Server to check, can anyone else confirm this? It is in the same location which we obtain the different windows versions from.<br />
<br />
If the above is always true, then you can just check for this strings existence.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scriptjunkie</div><div class="date">26th May 2004, 19:03</div></div><div class="posttext">I wish it was that easy. The productName key shows up on server and pro.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">28th May 2004, 21:09</div></div><div class="posttext">It is easy! I spent 15 minutes and found the answer!<br />
<br />
Here you go:<br />
<br />
Look in the registry here &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\ProductOptions&quot;<br />
<br />
Get the value for &quot;ProductType&quot;<br />
<br />
Compare the values to the following table:<br />
If ProductType is, &quot;WinNT&quot;, then this is &quot;Professional&quot;<br />
If ProductType is, &quot;LanManNT&quot;, then this is &quot;Server&quot;<br />
If ProductType is, &quot;ServerNT&quot;, then this is &quot;Advanced Server&quot;<br />
If ProductType is, &quot;Unknown&quot;, then this is &quot;Data Centre&quot;<br />
<br />
Unknown- Anyone have Data Centre?<br />
<br />
Someone should update the GetWindowsVersion, to supply this info. ;)<br />
<br />
<br />
Cheers,<br />
<br />
ZIMSMS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">28th May 2004, 22:28</div></div><div class="posttext">http://www.codeproject.com/system/dtwinver.asp</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">28th May 2004, 22:40</div></div><div class="posttext">Ahnnnnn... This is not so accurate either. I have Windows XP Home Edition and it returns &quot;WinNT&quot;, so that means &quot;Home&quot; and &quot;Professional&quot; versions return this value. We should find ways to differenciate from both now.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">28th May 2004, 22:49</div></div><div class="posttext">Originally posted by deguix <br />
Ahnnnnn... This is not so accurate either. I have Windows XP Home Edition and it returns &quot;WinNT&quot;, so that means &quot;Home&quot; and &quot;Professional&quot; versions return this value. We should find ways to differenciate from both now.  <br />
updated version @ the guys website: http://www.naughter.com/dtwinver.html (v1.68)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">29th May 2004, 03:07</div></div><div class="posttext">Wow, a great program. A .dll version for NSIS of this program would be great!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zimsms</div><div class="date">31st May 2004, 13:00</div></div><div class="posttext">The post I made above will work, since the current GetWindows Version, determines if it's XP, 2000, etc. You would place the above in the is2000 area.<br />
<br />
Anyways, as for the link Anders listed, that would make a nice plugin.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scriptjunkie</div><div class="date">3rd June 2004, 23:49</div></div><div class="posttext">Got a little side tracked on this project... but, thank you this was exactly what I was looking for.<br />
<br />
regards</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>