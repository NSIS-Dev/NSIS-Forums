<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Excel workbooks shortcuts, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Excel workbooks shortcuts NSIS Discussion" />
	
	<title> Excel workbooks shortcuts [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Excel workbooks shortcuts</div>
<hr />
<div class="pda"><a href="t-193604.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=193604">Excel workbooks shortcuts</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">banerji</div><div class="date">15th September 2004, 05:23</div></div><div class="posttext">Hello,<br />
<br />
My NSIS script creates shortcuts to MS Excel workbooks in the start menu folders.  This is a piece of software for general release, so I don't know beforehand which version of Excel the end-user will be running.  <br />
<br />
The shortcuts are created as follows:<br />
<br />
CreateShortCut &quot;$SMPROGRAMS\...\Shortcut.lnk&quot; &quot;EXCEL.EXE&quot; &quot;$INSTDIR\Workbook.xls&quot;<br />
<br />
and the installation proceeds fine.  However, clicking on the .lnk file from the Start Menu throws up a window telling me that Windows is searching for &quot;Excel.exe&quot;.<br />
<br />
Is there a way to dynamically find out which directory the &quot;excel.exe&quot; executable is located?  I suspect one has to search the registry, but how?  Also, could someone walk me through the process?  Or point me to a pre-written macro?<br />
<br />
Thanks in advance...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Davion</div><div class="date">15th September 2004, 15:28</div></div><div class="posttext">in the Registry there is the path of every Office Application depending on the version, for Office 2000 the Path of Excel would be in<br />
<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\9.0\Excel\InstallRoot\Path<br />
<br />
I think for Office 97 you have to change the 9.0 to 8.0 ascending with every Version <br />
<br />
so You would have to check the RegKey for Office 97, if its empty for 2000<br />
and so on.<br />
<br />
the Path you get from there you write  into a variable and create the shortcut like this:<br />
<br />
CreateShortCut &quot;$SMPROGRAMS\...\Shortcut.lnk&quot; &quot;$EXCELPATH\EXCEL.EXE&quot; &quot;$INSTDIR\Workbook.xls&quot;<br />
<br />
where $EXCELPATH is the Path you got out of the registry of course ;)<br />
<br />
this should work<br />
<br />
greetz Dave<br />
<br />
btw: I used this way to find the path of ACCESS or the ACCESS Runtime in my Setup and it works fine for me</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">15th September 2004, 19:32</div></div><div class="posttext">CreateShortCut &quot;$SMPROGRAMS\...\Shortcut.lnk&quot; &quot;$INSTDIR\Workbook.xls&quot;<br />
<br />
this should work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">15th September 2004, 19:34</div></div><div class="posttext">Yes, you just want to target the xls document. Windows will do the rest (execute the xls Shell)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">banerji</div><div class="date">16th September 2004, 05:25</div></div><div class="posttext">Yes, I just referred the link and Windows did the rest.<br />
<br />
Thanks for the tips, guys.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>