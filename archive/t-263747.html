<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Looking for some guidance, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Looking for some guidance NSIS Discussion" />
	
	<title> Looking for some guidance [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Looking for some guidance</div>
<hr />
<div class="pda"><a href="t-263747.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=263747">Looking for some guidance</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">soylentyellow</div><div class="date">15th January 2007, 23:43</div></div><div class="posttext">My previous experience with NSIS involved moinor maintainence on someones existing installer.  Now that I'm starting one from scratch, I could use a few pointers.<br />
<br />
For my environment I went with the Eclipse NSIS plugin, its working nicely. HM NIS Edit was throwing errors and crashing on the example scripts, sad because I liked it a lot before.<br />
<br />
Here are some things I'm trying to do...<br />
-Start one or two external installers that are on CDs<br />
 From reading the user manual it looks like I should use ExecWait.<br />
Edit: This is assuming I know which drive is the cd drive. Should I just prompt the user to simplify things?<br />
<br />
-Install one ActiveX control<br />
 Found this on the wiki http://nsis.sourceforge.net/ActiveX_Dll_Component_Register<br />
<br />
-Change the resolution to 1024x768<br />
 Found this on the wiki too http://nsis.sourceforge.net/ChangeRes_plug-in<br />
<br />
-Disable the screen saver<br />
<br />
-Disable power management<br />
<br />
-Set the IP address<br />
 Is there a plugin for this?<br />
<br />
-Make sure the date/time are correct<br />
 I found THIS (http://nsis.sourceforge.net/Time_plugin) any suggestions on how to get the correct time regardless of current system time?<br />
<br />
-Enable automatic login<br />
 The comps I am making this for are in &quot;welcome screen mode&quot; for lack for better term that I know.  They should have only one acount but that account will have a password. There is probably a registry key for this but I'm not sure where to start looking.<br />
<br />
<br />
Thanks for any advice you can spare :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">16th January 2007, 05:30</div></div><div class="posttext">This is assuming I know which drive is the cd drive. Should I just prompt the user to simplify things?If your installer resides on the same media you could use $EXEDIR, otherwise there are a couple of plugins at wiki dealing with CD drives, e.g.<br />
http://nsis.sourceforge.net/EnumCDs_plug-in<br />
http://nsis.sourceforge.net/CDRom_plug-in<br />
<br />
-Disable the screen saver<br />
<br />
-Disable power managementThese info are stored to the registry.<br />
<br />
-Set the IP address<br />
Is there a plugin for this?What do you mean set?<br />
http://nsis.sourceforge.net/IP_plug-in<br />
http://nsis.sourceforge.net/Internet_plug-in<br />
<br />
<br />
-Enable automatic loginain't that simple to by bass user's password.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">soylentyellow</div><div class="date">16th January 2007, 16:14</div></div><div class="posttext">thank you for the help :D <br />
<br />
managed to dig up a few more answers, in case anyone else has the same questions<br />
<br />
it looks like the screensaver can be disabled in the registry here http://articles.techrepublic.com.com/5100-10877_11-5572452.html <br />
<br />
as for setting the IP address and other network information quickly the netsh command thats build in to windows is the way to do, you can edit the registry but it gets messy<br />
for example: netsh interface ip set address &quot;Local Area Connection 2&quot; static 192.168.1.10 255.255.255.0 192.168.1.1 1<br />
<br />
for the automatic logon function Im not trying to &quot;bypass&quot; the users password just make it so they never have to take the time to log in again. While Im still not sure of a way that is attractive for end users to accomplish this it can be done relatively easily through the registry.<br />
http://support.microsoft.com/kb/310584</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">16th January 2007, 16:57</div></div><div class="posttext">as for setting the IP address and other network information quickly the netsh command thats build in to windows is the way to do, you can edit the registry but it gets messy<br />
for example: netsh interface ip set address &quot;Local Area Connection 2&quot; static 192.168.1.10 255.255.255.0 192.168.1.1 1Cute! I'm happy because most likely I'd never use any of your installers on my machine :D <br />
<br />
for the automatic logon function Im not trying to &quot;bypass&quot; the users password just make it so they never have to take the time to log in again. While Im still not sure of a way that is attractive for end users to accomplish this it can be done relatively easily through the registry.<br />
http://support.microsoft.com/kb/310584Gee! What's become my intelligence! Now I got your point! Your going to pop up a custom page asking users something like &quot;please enter your windows logon user name and password in the fields bellow to enable automatically logon&quot; :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">soylentyellow</div><div class="date">16th January 2007, 20:48</div></div><div class="posttext">the users would be doing the same thing manually otherwise :p<br />
<br />
Edit: er, their systems would be imaged to behave like this<br />
<br />
Edit2(hah): sorry I never explained that this installer is not really for users to just install on their home computers for example but rather for industrial touch panels that are owned by a company in a very specific environment where users should never have to log in or worry about a screensaver because its their job to hit the stop button on the screen to keep someone from getting their arm cut off but a piece of machinery... just to give you a reasoning for the somewhat odd requirements I'm working with :p</div></div><hr />


<div class="post"><div class="posttop"><div class="username">soylentyellow</div><div class="date">16th January 2007, 21:01</div></div><div class="posttext">and yes it looks like Im going to have to become well-versed in custom pages to make all this happen :cry:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">16th January 2007, 22:30</div></div><div class="posttext">The 'automatic logon' key is in HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon. You should set DefaultDomainName, DefaultUserName, and AutoAdminLogon. (The last one gets set to 1). If these values aren't correct when the system boots, it will prompt for correct values. (If your browser wraps the line containing the registry key, note that the key after Microsoft is 'Windows NT' with a space).<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">16th January 2007, 22:44</div></div><div class="posttext">I've posted some sample code the other day dealing with registry and demonstrating the creation of custom page that you may download and examine as a starting point hopefully helpful for you.<br />
Get it in the following forum thread,<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=262263<br />
<br />
Anyway if you intend to install windows on a workstation through this procedure, it might be better idea to use unattended installation.<br />
If I remember correctly, one is able to manage all these within an customized unattended installation, (disable screensaver, power management, desktop settings, enable auto logon, allow users only to set up their user name and password, set up network settings, almost everything I guess).<br />
Moreover you may install drivers and other required software within unattended.<br />
This what I can't get is the meaning of adding user name and password when autologon is enabled.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">soylentyellow</div><div class="date">17th January 2007, 15:18</div></div><div class="posttext">thanks I'll put this to use<br />
<br />
another question, I have been using the components page to ask which version of the app should be deployed, should I use a custom page with radial buttons instead because only one should ever be installed</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">17th January 2007, 15:33</div></div><div class="posttext">another question, I have been using the components page to ask which version of the app should be deployed, should I use a custom page with radial buttons instead because only one should ever be installed<br />
It's up to your preference, with nsis you're always can do it the way you like. :)<br />
BTW the custom page with radio buttons already discussed a few threads below.<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=263822</div></div><hr />


<div class="post"><div class="posttop"><div class="username">soylentyellow</div><div class="date">19th January 2007, 21:47</div></div><div class="posttext">Will this plugin...<br />
 http://nsis.sourceforge.net/ActiveX_Dll_Component_Register<br />
<br />
...allow me to register OCX files too?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">19th January 2007, 21:53</div></div><div class="posttext">I couldn't say for the plugin, I haven't test it, I'd say NSIS allows you see the documentation,<br />
http://nsis.sourceforge.net/Docs/AppendixB.html#B</div></div><hr />


<div class="post"><div class="posttop"><div class="username">soylentyellow</div><div class="date">25th January 2007, 18:15</div></div><div class="posttext">I think Im doing something wrong with this function for a custom page, it always behaves like the first button was pressed<br />
<br />
Function InstallInTouch<br />
    !insertmacro MUI_INSTALLOPTIONS_READ $0 &quot;$PLUGINSDIR\InstallInTouch.ini&quot; &quot;Settings&quot; &quot;State&quot;<br />
    StrCmp $0 0 validate  ; Next button?<br />
    StrCmp $0 1 verify  ; verify button?<br />
    StrCmp $0 2 install  ; install button?<br />
    StrCmp $0 3 skip ; skip button?<br />
    <br />
verify:<br />
MessageBox MB_OK &quot;Verify Button Pressed&quot;<br />
goto done<br />
<br />
install:<br />
MessageBox MB_OK &quot;Install Button Pressed&quot;<br />
goto done<br />
<br />
skip:<br />
MessageBox MB_OK &quot;Skip Button Pressed&quot;<br />
goto done<br />
<br />
validate:<br />
MessageBox MB_OK &quot;Next Button Pressed&quot;<br />
<br />
done:<br />
FunctionEnd<br />
<br />
<br />
InstallInTouch.ini follows<br />
<br />
; Auto-generated by EclipseNSIS InstallOptions Script Wizard<br />
; Jan 17, 2007 11:46:36 AM<br />
[Settings]<br />
NumFields=4<br />
<br />
[Field 1]<br />
Type=Button<br />
Flags=NOTIFY<br />
Left=63<br />
Top=22<br />
Right=113<br />
Bottom=37<br />
Text=Verify<br />
<br />
[Field 2]<br />
Type=Button<br />
Flags=NOTIFY<br />
Left=63<br />
Top=65<br />
Right=113<br />
Bottom=81<br />
Text=Install<br />
<br />
[Field 3]<br />
Type=Button<br />
Flags=NOTIFY<br />
Left=63<br />
Top=109<br />
Right=113<br />
Bottom=125<br />
Text=Skip<br />
<br />
<br />
I just have a messagebox for each button to make sure I can get basic stuff right before adding real behavior.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">soylentyellow</div><div class="date">25th January 2007, 18:17</div></div><div class="posttext">I think it's just not getting caught by any of the StrCmp statements, what gives?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th January 2007, 18:25</div></div><div class="posttext">When using MUI_INSTALLOPTIONS_READ, you shouldn't pass $PLUGINSDIR\your.ini. The macro adds $PLUGINSDIR on its own.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">soylentyellow</div><div class="date">25th January 2007, 18:54</div></div><div class="posttext">thank you :D</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>