<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Hard Drive Space, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Hard Drive Space NSIS Discussion" />
	
	<title> Hard Drive Space [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Hard Drive Space</div>
<hr />
<div class="pda"><a href="t-134348.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=134348">Hard Drive Space</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">firefly2442</div><div class="date">5th May 2003, 05:51</div></div><div class="posttext">Stupid question but... if the person using the installer doesn't have enough disk space will the installer notify them or just not install the files?  Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">5th May 2003, 14:23</div></div><div class="posttext">You will get an error message.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">7th May 2003, 15:15</div></div><div class="posttext">The next/install button will be grayed out which means the user won't be able to start the installation. There is no error message because you can't click the next button.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baskaran.vishnu</div><div class="date">20th July 2006, 02:55</div></div><div class="posttext">Hi,<br />
<br />
I would like to know if there is way that an error message could be displayed if the Install Directory is full ?<br />
<br />
I understand that currently if the install directory is full, the install button is grayed out. However, I am also required to display an error message informing the user that the Install Directory/Hard Disk is full.<br />
<br />
If I am not mistaken, I may need to configure the MUI/UMUI NSIS codes for this. Are there any leads on how to configure these codes?<br />
<br />
<br />
Would appreciate any advice on this.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th July 2006, 13:30</div></div><div class="posttext">You can create a Function .onVerifyInstDir and put a MessageBox in there, but you'll also have to find a way to check if there is no space left.<br />
<br />
This could either be done by checking the path itself, or by checking some text or something on the NSIS dialog.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th July 2006, 16:55</div></div><div class="posttext">You can use GetInstDirError (http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.7.2) for that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th July 2006, 20:11</div></div><div class="posttext">Cool didn't know about that :o<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baskaran.vishnu</div><div class="date">24th July 2006, 13:01</div></div><div class="posttext">Hi,<br />
<br />
Based on your advices and references, I have found a way on actually displaying an error message for an invalid installation directory or insufficient HD Space for the installed path.<br />
<br />
For this, we have to slightly modify the UMUI.nsh file (Ultra Moden UI) or the Systems.nsh (Modern UI) within the NSIS Install directory.<br />
<br />
Inside these .nsh files, find the macro MUI_PAGE_DIRECTORY function and add in the extra codes as highlighted in bold below;<br />
!macro MUI_PAGE_DIRECTORY<br />
<br />
!verbose push<br />
  !verbose ${MUI_VERBOSE}<br />
<br />
  !insertmacro MUI_PAGE_INIT<br />
<br />
  !insertmacro MUI_SET MUI_${MUI_PAGE_UNINSTALLER_PREFIX}DIRECTORYPAGE<br />
<br />
  !insertmacro MUI_DEFAULT MUI_DIRECTORYPAGE_TEXT_TOP &quot;&quot;<br />
  !insertmacro MUI_DEFAULT MUI_DIRECTORYPAGE_TEXT_DESTINATION &quot;&quot;<br />
<br />
  PageEx ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}directory<br />
<br />
    PageCallbacks ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}mui.DirectoryPre_${MUI_UNIQUEID} ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}mui.DirectoryShow_${MUI_UNIQUEID} ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}mui.DirectoryLeave_${MUI_UNIQUEID}<br />
    PageCallbacks &quot;&quot; &quot;&quot; dirLeave <br />
<br />
<br />
    Caption &quot; &quot;<br />
<br />
    DirText &quot;${MUI_DIRECTORYPAGE_TEXT_TOP}&quot; &quot;${MUI_DIRECTORYPAGE_TEXT_DESTINATION}&quot;<br />
<br />
    !ifdef MUI_DIRECTORYPAGE_VARIABLE<br />
      DirVar &quot;${MUI_DIRECTORYPAGE_VARIABLE}&quot;<br />
    !endif<br />
<br />
    /* Disable the DirVerify function that disables the 'Next' / 'Install' button for Invalid Path or File Size */<br />
    ;!ifdef MUI_DIRECTORYPAGE_VERIFYONLEAVE<br />
      DirVerify leave<br />
    ;!endif<br />
<br />
  PageExEnd<br />
<br />
Function dirLeave<br />
  GetInstDirError $0<br />
  ${Switch} $0<br />
    ${Case} 0<br />
      goto FINNISH_INST_DIR_PAGE<br />
      ${Break}<br />
    ${Case} 1<br />
      goto INVALID_INSTALL_DIR_PATH<br />
      Abort<br />
      ${Break}<br />
    ${Case} 2<br />
      goto INVALID_INSTALL_DIR_SPACE<br />
      Abort<br />
      ${Break}<br />
  ${EndSwitch}<br />
<br />
<br />
INVALID_INSTALL_DIR_PATH:<br />
     MessageBox MB_OK|MB_ICONSTOP &quot;Error: Invalid Installation Directory Path !&quot;<br />
  Abort<br />
<br />
INVALID_INSTALL_DIR_SPACE:<br />
 <br />
    ${Default} # Default at English language<br />
     MessageBox MB_OK|MB_ICONSTOP &quot;The selected installation directory does not have adequate space !&quot;<br />
  Abort<br />
<br />
FINNISH_INST_DIR_PAGE:<br />
FunctionEnd <br />
<br />
<br />
Based on the codes above and reference as provided by Kichik, we have to disable (comment) the !ifdef MUI_DIRECTORYPAGE_VERIFYONLEAVE command to prevent the Install button from being grayed out in the event of an invalid installation path/insufficient HD Space. In other words, the 'DirVerify leave' command must always be executed .<br />
<br />
From these we add the PageCallbacks &quot;&quot; &quot;&quot; dirLeave callback function that checks for an invalid installation path/insufficient HD Space.<br />
<br />
From the codes above, in the install directory page, if user  points to an invalid install path or to an install path with in-adequate HD space, an error message is displayed to user if user clicks on the Install/Next button, instead of having the button grayed out, as would be normally seen.<br />
<br />
I hope the above codes helps.<br />
<br />
Special Thanks and appreciation to Afrow and Kichik for your help and advice.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>