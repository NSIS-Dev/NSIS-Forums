<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to Detect SQL Server 2005 and SQL Express from NSIS, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to Detect SQL Server 2005 and SQL Express from NSIS NSIS Discussion" />
	
	<title> How to Detect SQL Server 2005 and SQL Express from NSIS [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to Detect SQL Server 2005 and SQL Express from NSIS</div>
<hr />
<div class="pda"><a href="t-281980.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=281980">How to Detect SQL Server 2005 and SQL Express from NSIS</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">23rd November 2007, 12:58</div></div><div class="posttext">Dear Friends,<br />
<br />
From my NSIS installer I'll restore a database of SQL Server 2005. But prior to this act I want to confirm whether the user's system is having SQL Server 2005 or SQL Server 2005 Express Edition (SSE). Please note that I don't need instance names etc. info., just want to know whether SQL 2005 or SSE is there or not. <br />
<br />
Please keep in mind that, the user may have other versions of SQL Server installed in his system like MSDE, SQL 2000.<br />
<br />
<br />
For MSDE/MSSQL I use:<br />
      ReadRegStr $R0 HKLM \<br />
      &quot;SOFTWARE\Microsoft\MSSQLServer\Setup&quot; SQLPath<br />
<br />
For my this issue, I'm trying with the following but someone informed me that it didn't detected his sql express.<br />
Please give better and correct solution then this:<br />
<br />
;for sql server 2005<br />
  ReadRegStr $R1 HKLM \<br />
      &quot;SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL&quot; MSSQLSERVER<br />
;for sql express:<br />
  ReadRegStr $R2 HKLM \<br />
      &quot;SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL&quot; SQLEXPRESS<br />
<br />
<br />
Regards,<br />
Swapan<br />
ps:As usual its need quick response as my installer is just waiting for this check to be bundled in it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LazyBear</div><div class="date">27th November 2007, 08:13</div></div><div class="posttext">if you are still working on your installer, <br />
<br />
microsoft kb321185 (http://support.microsoft.com/kb/321185) could be helping you.<br />
<br />
run the following statement with osqlor your preferred way of running DB-Scripts from the commandline:<br />
<br />
SELECT SERVERPROPERTY ('productlevel')<br />
<br />
depending on what is installed, you should get something like<br />
&quot;RTM&quot; or &quot;SQL Server 2005&quot; so you can go further with this return val.<br />
<br />
I haven't tested it yet, because i currently hav no SQL2005 here, but the statement works under SQL2000 too.<br />
<br />
have a look at the link for further informations about the ServerProps.<br />
<br />
Greetz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pozbremser</div><div class="date">27th November 2007, 08:31</div></div><div class="posttext">if MS SQL Server run, You can ask him about sql server version,<br />
but You can not start it, if You don't know, which version client has.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">29th November 2007, 12:44</div></div><div class="posttext">Thanks for the reply. Will check and let you know in this thread. Actually was looking for some registry level solution.<br />
<br />
Regards &amp; Thanks,</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>