<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How can I reset instfiles page?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How can I reset instfiles page? NSIS Discussion" />
	
	<title> How can I reset instfiles page? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How can I reset instfiles page?</div>
<hr />
<div class="pda"><a href="t-319220.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=319220">How can I reset instfiles page?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mshak</div><div class="date">17th May 2010, 12:33</div></div><div class="posttext">Good time of day. Sorry if my English so bad.<br />
I wrote NSIS script for installing some MSI (MicroSoft Installer) files. I can't decompile it, because files have signature.<br />
All files required serial numbers for installing. <br />
script:<br />
<br />
!include &quot;nsDialogs.nsh&quot;<br />
....<br />
!include &quot;MUI2.nsh&quot;<br />
....<br />
Page Custom GetSN<br />
!insertmacro MUI_PAGE_INSTFILES<br />
...<br />
Var HWNDGetSN<br />
Function GetSN<br />
	nsDialogs::Create 1018<br />
	Pop $HWNDGetSN<br />
 ... ; fields for SerialNumbers<br />
	nsDialogs::Show<br />
FunctionEnd<br />
...<br />
Section ... ; install section<br />
 ExecWait 'MsiExec /i &quot;1.msi&quot; PIDKEY=$SN1' $0<br />
 StrCmp $0 &quot;1603&quot; is1603 ; check return code. <br />
is1603:  ... ; How i can return to GetSN page? And after correct SN retry Install files. <br />
 ExecWait 'MsiExec /i &quot;2.msi&quot; PIDKEY=$SN2' $0<br />
 ... ; check return code. How i can return to GetSN page? <br />
 ExecWait 'MsiExec /i &quot;3.msi&quot; PIDKEY=$SN3' $0<br />
 ... ; check return code. How i can return to GetSN page? <br />
SectionEnd<br />
<br />
<br />
I can return, using that method http://nsis.sourceforge.net/Go_to_a_NSIS_page<br />
but if I push Install button again... NSIS script don't clear status for installfiles page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">17th May 2010, 16:34</div></div><div class="posttext">I think if you jump to the end of the last section to allow the installer to leave the InstFiles page before going back to your custom page; that should sort it.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mshak</div><div class="date">18th May 2010, 08:13</div></div><div class="posttext">oh.. Big thanks. <br />
Really, when i return to SN page after Instfiles page it's work correctly. I do it using another custom page.<br />
script:<br />
<br />
!include LogicLib.nsh<br />
!include &quot;nsDialogs.nsh&quot;<br />
....<br />
!include &quot;MUI2.nsh&quot;<br />
....<br />
Page Custom GetSN<br />
!insertmacro MUI_PAGE_INSTFILES<br />
Page Custom verifyInstall<br />
!insertmacro MUI_PAGE_FINISH<br />
...<br />
Var HWNDGetSN<br />
Function GetSN<br />
	nsDialogs::Create 1018<br />
	Pop $HWNDGetSN<br />
 ... ; fields for SerialNumbers<br />
	nsDialogs::Show<br />
FunctionEnd<br />
...<br />
Section ... ; install section<br />
${If} $InstallStatus == &quot;true&quot; <br />
 ExecWait 'MsiExec /i &quot;1.msi&quot; PIDKEY=$SN1' $0<br />
 StrCmp $0 &quot;1603&quot; is1603 ; check return code. <br />
is1603: <br />
 StrCpy $InstallStatus &quot;false&quot;<br />
${EndIf}<br />
${If} $InstallStatus == &quot;true&quot; <br />
 ExecWait 'MsiExec /i &quot;2.msi&quot; PIDKEY=$SN2' $0<br />
 ... ; check return code. <br />
${EndIf}<br />
 ... ; other files<br />
SectionEnd<br />
Section -FinishSection <br />
  ${If} $InstallStatus == &quot;true&quot;<br />
; wrilte links and unstaller<br />
  ${EndIf}<br />
SectionEnd<br />
Function verifyInstall ; функция для создания страницы проверки. <br />
  ${If} $InstallStatus == &quot;false&quot;<br />
    StrCpy $R9 -3<br />
    Call RelGotoPage<br />
  ${EndIf}<br />
FunctionEnd<br />
<br />
After that I have only one question: Can I disable &quot;Back&quot; button on finish page?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">18th May 2010, 12:25</div></div><div class="posttext">GetDlgItem $R0 $HWNDPARENT 3<br />
EnableWindow $R0 0<br />
<br />
Use in a defined MUI_PAGE_CUSTOMFUNCTION_SHOW function for your finish page.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mshak</div><div class="date">18th May 2010, 12:46</div></div><div class="posttext">Thanks a lot. script working correctly now</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>