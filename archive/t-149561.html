<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Screenshot Plugin?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Screenshot Plugin? NSIS Discussion" />
	
	<title> Screenshot Plugin? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Screenshot Plugin?</div>
<hr />
<div class="pda"><a href="t-149561.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=149561">Screenshot Plugin?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">17th September 2003, 22:13</div></div><div class="posttext">is there a plugin that lets nsis create a screenshot?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lzandman</div><div class="date">18th September 2003, 07:33</div></div><div class="posttext">I'm pretty sure there isn't one... But why would you want to do that?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lzandman</div><div class="date">18th September 2003, 08:54</div></div><div class="posttext">Well, now there is... :)<br />
<br />
I've just created a NSIS plugin that can save screenshots. It supports taking full-screen screenshots and screenshots of the NSIS window (but I think it has to be visible for this). Check it out:<br />
<br />
http://home.studenten.net/~wowleon/nsScreenshot.zip<br />
<br />
I've included an NSI-file that should explain how it works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">18th September 2003, 14:29</div></div><div class="posttext">Great!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lzandman</div><div class="date">18th September 2003, 14:36</div></div><div class="posttext">But even though I created it, why would anyone want to use it? Why take a screenshot during install? :igor:<br />
<br />
For me it was just practicing writing NSIS plugins, but I'm really interested in why anyone would use it...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lzandman</div><div class="date">19th September 2003, 06:33</div></div><div class="posttext">Doesn't anybody like it? No response from official NSIS developers?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">19th September 2003, 19:29</div></div><div class="posttext">can this plugin also detect the size of the made screenshot?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">19th September 2003, 20:15</div></div><div class="posttext">can one capture any other windows but the installer window?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">19th September 2003, 20:24</div></div><div class="posttext">killahbite: You can get the size of the file.<br />
<br />
lzandman: I've added your plug-in to the archive download section (http://nsis.sourceforge.net/archive/download.php). Please create an archive page for your plug-in. If possible, also try reduce the size of your plug-in.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">19th September 2003, 20:26</div></div><div class="posttext">i'm asking cause i don't see it in this plugins notexistent documentation :P<br />
<br />
i'd like to capture the avs window (avswnd), but this plugin seems only to capture fullscreen or nsis installer window.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">19th September 2003, 20:31</div></div><div class="posttext">I don't think this plug-in supports it. You can ask the author to add this feature.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lzandman</div><div class="date">22nd September 2003, 13:19</div></div><div class="posttext">Thanx for all the comments. I've read them and changed nsScreenshot (http://home.studenten.net/~wowleon/nsScreenshot.zip) a little. I've removed the NSIS-window-capture function and replaced it by a more generic function that takes a window handle and captures that window. Just use the FindWindow function to get the window handle of a window and supply it to my plugin. To capture the NSIS window you can use $HWNDPARENT.<br />
<br />
I've also reduced the plugin's size by removing some unused resources that Delphi stuffed in the DLL. And I've also compressed it using UPX. It's now 65 kB, which is still large but not as much as it used to be. Creating small code using Delphi is still a big problem...<br />
<br />
For more information about nsScreenshot look at the archive page (http://nsis.sourceforge.net/archive/nsisweb.php?page=409&amp;instances=0) that I've just created :)<br />
<br />
Killahbite: I don't think it is necessary for me to add support for file size to the plugin. There are other ways to determine this. Just search the forums for a way to get the file size.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">22nd September 2003, 14:47</div></div><div class="posttext">Please link to http://nsis.sourceforge.net/archive/download.php?file=Screenshot.zip<br />
<br />
I will update that file today.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lzandman</div><div class="date">22nd September 2003, 15:40</div></div><div class="posttext">Originally posted by Joost Verburg <br />
Please link to http://nsis.sourceforge.net/archive/download.php?file=Screenshot.zip<br />
<br />
I will update that file today. I've added that URL as a alternative to my own server, because it currently still holds the previous version.<br />
<br />
By the way: I've named my plugin &quot;nsScreenshot&quot;. You named the ZIP-file &quot;Screenshot.zip&quot; (without the 'ns'-prefix). Was that a mistake or don't you like the prefix? I'd rather you name it &quot;nsScreenshot.zip&quot;, because that's more consistent. So could you please change it? :D<br />
<br />
P.S. Joost, ben jij een Nederlander?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">22nd September 2003, 19:06</div></div><div class="posttext">Originally posted by lzandman <br />
I don't think it is necessary for me to add support for file size to the plugin. There are other ways to determine this. Just search the forums for a way to get the file size. <br />
<br />
i was speaking of the image size (width x height), not filesize.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">22nd September 2003, 19:11</div></div><div class="posttext">i tried capturing the window of the winamp plugin avs (handle is avswnd). i get an error when i do so.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lzandman</div><div class="date">23rd September 2003, 09:58</div></div><div class="posttext">Originally posted by killahbite <br />
i tried capturing the window of the winamp plugin avs (handle is avswnd). i get an error when i do so. I can't test the AVS plugin here myself, but there are two things that might explain the error:<br />
 The window you want to capture isn't a top-level window. So you have to use the FindWindow function multiple times. You first have to get the handle to the top-level window and from there descent to the window you want to capture.<br />
<br />
For example, to capture the tray windows contents: The tray window is a child of the taskbar. See this picture:<br />
<br />
http://home.studenten.net/~wowleon/WindowTree.jpg<br />
<br />
First we have to get the handle of the &quot;Shell_TrayWnd&quot; window and then we have to get the handle of the &quot;TrayNotifyWnd&quot; window. We can use the following code for this:<br />
<br />
FindWindow $R0 &quot;Shell_TrayWnd&quot;<br />
FindWindow $R0 &quot;TrayNotifyWnd&quot; &quot;&quot; $R0<br />
The first line returns a handle to the taskbar. The second line uses this handle to get the handle of the tray area. You can use programs like Spy++ or Winsight32 to determine window classes and parent-child relations.<br />
<br />
 AVS uses hardware acceleration (DirectX, OpenGL) to create the graphics. This way all graphic data is sent directly to the screen hardware without using Windows. This is much faster, but it also means that nsScreenshot can't capture it, because Windows doesn't know anything about it. When capturing such graphics you usually end up with a window containing nothing but blackness. But in this case nsScreenshot will not return &quot;error&quot; though...<br />
I hope this helps you solve your problem :)<br />
<br />
BTW.: I could put the image dimensions onto the stack, but unfortunately I can't FTP from here. So you have to wait a couple of hours for a new version of nsScreenshot to arrive :rolleyes:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lzandman</div><div class="date">23rd September 2003, 21:06</div></div><div class="posttext">I've put the updated version online. It now includes support for returning image dimensions (width and height). When nsScreenshot returns &quot;ok&quot; (only then!) it has put two additional values onto the stack. Those values are the width and height of the captured image.<br />
<br />
Currently you can only download it here (http://home.studenten.net/~wowleon/nsScreenshot.zip), because the ZIP-file on the NSIS server isn't updated.<br />
<br />
Question for Joost or Kichik: can I upload the latest version of my plugin to the NSIS archive server myself or do I have to signal you to update it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd September 2003, 21:13</div></div><div class="posttext">Originally posted by lzandman <br />
Question for Joost or Kichik: can I upload the latest version of my plugin to the NSIS archive server myself or do I have to signal you to update it?  <br />
<br />
Not yet I'm afraid. We do want to enable it eventually but can't find the time to update the Archive.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">23rd September 2003, 21:35</div></div><div class="posttext">Updated file on NSIS archive server.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lzandman</div><div class="date">23rd September 2003, 21:50</div></div><div class="posttext">Originally posted by Joost Verburg <br />
Updated file on NSIS archive server. Thanx :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>