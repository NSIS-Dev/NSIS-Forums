<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" nsDialogs::SelectFolderDialog, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  nsDialogs::SelectFolderDialog NSIS Discussion" />
	
	<title> nsDialogs::SelectFolderDialog [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  nsDialogs::SelectFolderDialog</div>
<hr />
<div class="pda"><a href="t-282565.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=282565">nsDialogs::SelectFolderDialog</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">sujith</div><div class="date">3rd December 2007, 11:29</div></div><div class="posttext">Hi,<br />
<br />
I have used following function nsDialogs::SelectFolderDialog but it does not show the dialogbox. Any idea?<br />
<br />
This is the script<br />
<br />
!include LogicLib.nsh<br />
<br />
;Installer Created By Sujith Quintelier<br />
;This Script Intend To Install 3 Components<br />
; - Install JRE 1.5.12 (jre)<br />
; - Install Tomcat Application Server 6.0.13 (tomcat)<br />
; - Install TINKsearch<br />
; -- Copy Data (data)<br />
; -- Copy Application (app)<br />
; -- Copy Users (users)<br />
; - Install Tinksearch Config (config)<br />
;--------------------------------<br />
; The name of the installer<br />
Name &quot;TINKsearch&quot;<br />
<br />
; The file to write<br />
OutFile &quot;TINKsearch.exe&quot;<br />
<br />
; The default installation directory<br />
InstallDir $PROGRAMFILES\ICMS\TINKsearch<br />
<br />
; Registry key to check for directory (so if you install again, it will <br />
; overwrite the old one automatically)<br />
InstallDirRegKey HKLM &quot;Software\ICMS\TINKsearch&quot; &quot;Install_Dir&quot;<br />
<br />
;--------------------------------<br />
; Variables<br />
<br />
Var TS_DATA_DIR<br />
Var TS_APP_DIR<br />
<br />
;--------------------------------<br />
; InstTypes<br />
!ifndef NOINSTTYPES ; only if not defined<br />
  InstType &quot;Full&quot;<br />
  InstType &quot;JRE&quot;<br />
  InstType &quot;Tomcat&quot;<br />
  InstType &quot;TINKsearch&quot;<br />
  InstType &quot;TINKsearchConfig&quot;<br />
  ;InstType /NOCUSTOM<br />
  ;InstType /COMPONENTSONLYONCUSTOM<br />
!endif<br />
<br />
<br />
;--------------------------------<br />
; Pages<br />
<br />
Page components<br />
Page directory<br />
Page custom selectDataFolder<br />
Page instfiles<br />
UninstPage uninstConfirm<br />
UninstPage instfiles<br />
<br />
; selectDataFolder: Show Select Folder Dialog When Data Must Be Copied<br />
Function selectDataFolder<br />
    ; Check If Data Has Been Selected<br />
    SectionGetFlags 3 $0<br />
    IntOp $0 $0 &amp; ${SF_SELECTED}<br />
    ; Do Check Data Has Been Selected<br />
    ${If} $0 == 1<br />
        ; Show Select Folder Dialog<br />
        nsDialogs::SelectFolderDialog<br />
        Pop $TS_DATA_DIR<br />
        ; Check A Folder Has Been Selected<br />
        ${If} $TS_DATA_DIR == &quot;error&quot;<br />
            MessageBox MB_OK &quot;Must Choose Folder!&quot;<br />
            ; Cancel Installation<br />
            Abort<br />
        ${EndIf}<br />
    ${EndIf}<br />
FunctionEnd<br />
<br />
;--------------------------------<br />
; The stuff to install<br />
; Install JRE<br />
; Index=0<br />
Section /o &quot;Install JRE&quot; jre<br />
    SectionIn 1 2<br />
    SetOutPath $INSTDIR\temp<br />
    File &quot;JRE\jre.exe&quot;<br />
    ExecWait &quot;$INSTDIR\temp\jre.exe&quot;<br />
    RMDir /r &quot;$INSTDIR\temp&quot;<br />
SectionEnd<br />
<br />
; Install Apache Foundata Sofware Tomcat Application Server<br />
; Index=1<br />
Section /o &quot;Install Tomcat Application Server&quot; tomcat<br />
    SectionIn 1 3<br />
    SetOutPath $INSTDIR\temp<br />
    File &quot;AppServer\apache-tomcat.exe&quot;<br />
    ExecWait &quot;$INSTDIR\temp\apache-tomcat.exe&quot;<br />
    RMDir /r &quot;$INSTDIR\temp&quot;  <br />
SectionEnd<br />
<br />
; Install TINKsearch Group<br />
SectionGroup TINKsearch<br />
    ; Copy Data Structure<br />
    ; Index=2<br />
    Section /o &quot;Copy Data Structure&quot; data<br />
        SectionIn 1 4<br />
        SetOutPath $TS_DATA_DIR<br />
        File /r &quot;Data\TINKsearch&quot;<br />
    SectionEnd<br />
    <br />
    ; Copy TINKsearch Application<br />
    ; Index=3<br />
    Section /o &quot;Copy TINKsearch Application&quot; app<br />
        SectionIn 1 4<br />
        ; Check if the service exists<br />
        SimpleSC::ExistsService &quot;tomcat6&quot;<br />
        ; return service exists(1)/service doesnÂ´t exists (0)<br />
        Pop $0<br />
        ${If} $0 == 1<br />
            ; Check if the service is stopped<br />
            SimpleSC::ServiceIsStopped &quot;tomcat6&quot;<br />
            ; return $0 error(1)/success(0), $1 Stopped(1)/Not Stopped(0) <br />
            Pop $0<br />
            Pop $1<br />
            ${If} $0 == 0<br />
                ReadRegStr $TS_APP_DIR HKLM &quot;Software\Apache Software Foundation\Tomcat\6.0&quot; InstallPath<br />
                ${If} $1 == 0<br />
                    ; Stop a service<br />
                    SimpleSC::StopService &quot;tomcat6&quot;<br />
                    ; return error(1)/success(0)<br />
                    Pop $0 <br />
                    ${If} $0 == 0<br />
                        SetOutPath &quot;$TS_APP_DIR\webapps&quot;<br />
                        File /r &quot;webapps\TINKsearch&quot;<br />
                    ${Else}<br />
                        SetOutPath &quot;$INSTDIR\temp&quot;<br />
                        File /r &quot;webapps\TINKsearch&quot;                        <br />
                        MessageBox MB_OK 'tomcat6 Service Could Not Be Stopped: Please Copy $INSTDIR\temp\TINKsearch to $TS_APP_DIR\webapps'<br />
                    ${EndIf}<br />
                ${Else}<br />
                    SetOutPath &quot;$TS_APP_DIR\webapps&quot;<br />
                    File /r &quot;webapps\TINKsearch&quot;<br />
                ${EndIf}<br />
            ${EndIf}<br />
        ${Else}<br />
            MessageBox MB_OK 'No Tomcat Has Not Been Installed'<br />
        ${EndIf}<br />
    <br />
    SectionEnd<br />
    <br />
    ; Copy Tomcat-Users.xml<br />
    ; Index=4<br />
    Section /o &quot;Copy Tomcat-Users&quot; users<br />
        SectionIn 1 4<br />
        ; Check if the service exists<br />
        SimpleSC::ExistsService &quot;tomcat6&quot;<br />
        ; return service exists(1)/service doesnÂ´t exists (0)<br />
        Pop $0<br />
        ${If} $0 == 1<br />
            ; Check if the service is stopped<br />
            SimpleSC::ServiceIsStopped &quot;tomcat6&quot;<br />
            ; return $0 error(1)/success(0), $1 Stopped(1)/Not Stopped(0) <br />
            Pop $0<br />
            Pop $1<br />
            ${If} $0 == 0<br />
                ReadRegStr $TS_APP_DIR HKLM &quot;Software\Apache Software Foundation\Tomcat\6.0&quot; InstallPath<br />
                ${If} $1 == 0<br />
                    ; Stop a service<br />
                    SimpleSC::StopService &quot;tomcat6&quot;<br />
                    ; return error(1)/success(0)<br />
                    Pop $0 <br />
                    ${If} $0 == 0<br />
                        SetOutPath &quot;$TS_APP_DIR\conf&quot;<br />
                        File /r &quot;conf\tomcat-users.xml&quot;<br />
                    ${Else}<br />
                        SetOutPath &quot;$INSTDIR\temp&quot;<br />
                        File /r &quot;conf\tomcat-users.xml&quot;<br />
                        MessageBox MB_OK 'tomcat6 Service Could Not Be Stopped: Please Copy $INSTDIR\temp\tomcat-users.xml to $TS_APP_DIR\conf'<br />
                    ${EndIf}<br />
                ${Else}<br />
                    SetOutPath &quot;$TS_APP_DIR\conf&quot;<br />
                    File /r &quot;conf\tomcat-users.xml&quot;<br />
                ${EndIf}<br />
            ${EndIf}<br />
        ${Else}<br />
            MessageBox MB_OK 'No Tomcat Has Not Been Installed'<br />
        ${EndIf}<br />
              <br />
    SectionEnd<br />
SectionGroupEnd<br />
<br />
; Install TINKsearch Config<br />
; Index=5<br />
Section /o &quot;Install TINKsearch Config&quot; config<br />
    SectionIn 1 5<br />
    SetOutPath $INSTDIR\temp<br />
    File /r &quot;TINKsearchConfig&quot;<br />
    ExecWait &quot;$INSTDIR\temp\TINKsearchConfig\setup.exe&quot;<br />
    RMDir /r &quot;$INSTDIR\temp&quot;<br />
  <br />
    ; Write the installation path into the registry<br />
    WriteRegStr HKLM SOFTWARE\ICMS\TINKsearch &quot;Install_Dir&quot; &quot;$INSTDIR&quot;<br />
    <br />
    ; Write the uninstall keys for Windows<br />
    WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\TINKsearch&quot; &quot;DisplayName&quot; &quot;TINKsearch&quot;<br />
    WriteRegStr HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\TINKsearch&quot; &quot;UninstallString&quot; '&quot;$INSTDIR\uninstall.exe&quot;'<br />
    WriteRegDWORD HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\TINKsearch&quot; &quot;NoModify&quot; 1<br />
    WriteRegDWORD HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\TINKsearch&quot; &quot;NoRepair&quot; 1<br />
<br />
    ; Write Data Path into the registry<br />
    WriteRegStr HKLM &quot;Software\ICMS\TINKsearch&quot; &quot;DataDir&quot; $TS_DATA_DIR<br />
    <br />
    ; Write Uninstaller<br />
    WriteUninstaller &quot;uninstall.exe&quot;<br />
    <br />
    ; Create Short Cut For The Uninstaller<br />
    CreateDirectory &quot;$SMPROGRAMS\ICMS\TINKsearch&quot;<br />
    CreateShortCut &quot;$SMPROGRAMS\ICMS\TINKsearch\Uninstall.lnk&quot; &quot;$INSTDIR\uninstall.exe&quot; &quot;&quot; &quot;$INSTDIR\uninstall.exe&quot; 0<br />
 <br />
SectionEnd<br />
<br />
;--------------------------------<br />
; Uninstaller<br />
; Index=6<br />
Section &quot;Uninstall&quot;<br />
  ; Remove files and uninstaller<br />
  Delete $INSTDIR\uninstall.exe<br />
  Delete $INSTDIR\temp\*.*<br />
  Delete $TS_APP_DIR\webapps\TINKsearch\*.*<br />
<br />
  ; Remove shortcuts, if any<br />
  Delete &quot;$SMPROGRAMS\ICMS\TINKsearch\*.*&quot;<br />
<br />
  ; Remove directories used<br />
  RMDir /r &quot;$SMPROGRAMS\ICMS\TINKsearch&quot;<br />
  RMDir /r &quot;$INSTDIR&quot;<br />
  <br />
    ; Read registry settings<br />
    ;ReadRegStr $TS_DATA_DIR HKLM Software\ICMS\TINKsearch DataDir<br />
    ReadRegStr $TS_APP_DIR HKLM Software\ICMS\TINKsearch AppDir<br />
    <br />
    ; Remove TINKsearch Data (Currently Disabled)<br />
    ;RMDir /r $TS_DATA_DIR<br />
    <br />
    ; Remove TINKsearch Application<br />
    RMDir /r $TS_APP_DIR\webapps\TINKsearch<br />
<br />
    ; Remove registry keys<br />
    DeleteRegKey HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\TINKsearch&quot;<br />
    DeleteRegKey HKLM SOFTWARE\ICMS\TINKsearch<br />
  <br />
SectionEnd<br />
<br />
<br />
Thx,<br />
Sujith</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">3rd December 2007, 11:57</div></div><div class="posttext">you still need to provide the two params:<br />
<br />
nsDialogs::SelectFolderDialog &quot;&quot; &quot;&quot;<br />
<br />
you might aswell supply some decent defaults,<br />
<br />
nsDialogs::SelectFolderDialog &quot;Select the folder to configure...&quot; &quot;$programfiles\foo\config&quot;<br />
<br />
edit: please attach the script next time</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>