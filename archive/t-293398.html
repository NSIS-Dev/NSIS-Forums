<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" file browse on cd-rom only, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  file browse on cd-rom only NSIS Discussion" />
	
	<title> file browse on cd-rom only [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  file browse on cd-rom only</div>
<hr />
<div class="pda"><a href="t-293398.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=293398">file browse on cd-rom only</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">lmpymilk</div><div class="date">20th June 2008, 21:38</div></div><div class="posttext">Is there a way to only allow end user to browse for files on the cd-rom? So if I want them to choose a template for the install, I want to make sure it's from the cd-rom.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">20th June 2008, 22:36</div></div><div class="posttext">Once you have a path, you decide if it refers to a CD-Drive or to some other device (e.g. HDD) by calling the &quot;GetDriveType&quot; function. The return value will be DRIVE_CDROM for CD/DVD drives. For other device types you'll get a different return value, e.g. DRIVE_FIXED.<br />
<br />
http://msdn.microsoft.com/en-us/library/aa364939.aspx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lmpymilk</div><div class="date">23rd June 2008, 22:16</div></div><div class="posttext">Thanks, I have the drive type and path, but then the user clicks the button to browse for the template and they can browse anywhere they have rights. I want to restrict this to the folder and all sub folders on the cd-rom.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lmpymilk</div><div class="date">9th July 2008, 00:55</div></div><div class="posttext">maybe this was missed :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">9th July 2008, 03:40</div></div><div class="posttext">Use the .onVerifyInstDir callback-function. This function will be called everytime the user selects a new folder. Even when the user makrs a folder in the &quot;browse&quot; dialog, that function will be called first (before the user get's the chance to click &quot;OK&quot;). So simply check the value of $INSTDIR within that function. If $INSTDIR doesn't point to a DRIVE_CDROM device, then you can call the Abort command. This will gray out the &quot;OK&quot; button in the &quot;browse&quot; dialog and it will gray out the &quot;Next&quot; button of the Diretcory page. Let the callback-function run to the end, if the selected folder is valid...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>