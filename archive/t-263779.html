<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Silent Install of SQL with Parameters, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Silent Install of SQL with Parameters NSIS Discussion" />
	
	<title> Silent Install of SQL with Parameters [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Silent Install of SQL with Parameters</div>
<hr />
<div class="pda"><a href="t-263779.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=263779">Silent Install of SQL with Parameters</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kerstin</div><div class="date">16th January 2007, 14:29</div></div><div class="posttext">Hello,<br />
<br />
i am very new to NSIS. I am just writing an installer which detects if SQL 2005 Express is installed on the computer. Now so the sql install window won't popup i would like to give it the path username and so on with it so the user does not have to get confused. i know you can install sql through commandline or an ini file but how can i accomplish this through my NSIS installer? Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">16th January 2007, 17:11</div></div><div class="posttext">Since you know that you can install sql through commandline, you may pass the command line to built in commands such as Exec or ExecWait, or pass it to the included nsexec plugin. Also there are a couple of similar plugins at wiki (http://nsis.sf.net)  ExecCmd (http://nsis.sourceforge.net/ExecCmd_plug-in) for instance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kerstin</div><div class="date">16th January 2007, 19:09</div></div><div class="posttext">Unfortunately your Links are timing out on me. Does anybody have an example what i like to accomplish?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th January 2007, 19:29</div></div><div class="posttext">The links should be back again soon. SourceForge has some downtimes now and then. They do have a zillion hits a second, or so I'm told by the marketing guy behind me. But seriously, their service is great, even with the occasional downtime.<br />
<br />
Anyway, back to your question, simply use ExecWait to run the installer. For example:SetOutPath $INSTDIR<br />
File sql-installer.exe<br />
ExecWait '&quot;$INSTDIR\sql-installer.exe&quot; /SILENT /USER=blah'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kerstin</div><div class="date">16th January 2007, 20:28</div></div><div class="posttext">Hmm,sorry don't wanna be annoying, but i tried your code and i do not know it just does not work i get error because only 1-2 parameters are expected but i got a lot more:<br />
<br />
 ExecWait '&quot;$TEMP\SQLEXPR.EXE&quot;' /Silent /INSTANCENAME=SQLEXPRESS ADDLOCAL=All PIDKEY=ABCDE12345FGHIJ67890KLMNO SAPWD=StrongPassword SQLACCOUNT=SQLEXPRESS\bla SQLPASSWORD=blabla  AGTACCOUNT=SQLEXPRESS\bla  AGTPASSWORD=blabla  SQLBROWSERACCOUNT=sqlexpress\bla  SQLBROWSERPASSWORD=blabla  '<br />
I just do not have a single clue what i need to do. if i use the ExecCmd::exec i also get an error (not supported even so i have put the dll to the plugins)<br />
<br />
Thank you for all your help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">16th January 2007, 20:32</div></div><div class="posttext">Be aware of the quotes, that's probably the problem.<br />
<br />
 ExecWait '&quot;$TEMP\SQLEXPR.EXE&quot; /Silent /INSTANCENAME=SQLEXPRESS ADDLOCAL=All PIDKEY=ABCDE12345FGHIJ67890KLMNO SAPWD=StrongPassword SQLACCOUNT=SQLEXPRESS\bla SQLPASSWORD=blabla AGTACCOUNT=SQLEXPRESS\bla AGTPASSWORD=blabla SQLBROWSERACCOUNT=sqlexpress\bla SQLBROWSERPASSWORD=blabla'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kerstin</div><div class="date">16th January 2007, 22:06</div></div><div class="posttext">hey thank you for your fast reply- yup the quotes where the issue. no i got it to compile but when i have the installer running and it comes to the sectin where it should install the sql express then it runs through half of my installation then errors out (Microsoft discovered blabla). Any idea? Anybody out there with experience with silent install of sql express?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Swapan Das</div><div class="date">17th January 2007, 05:44</div></div><div class="posttext">In near future I may have to build such an installer, so I'm looking forward to this thread for a solution.<br />
<br />
Kerstin, for MSDE/SQL Serve detection you may refer to my thread:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=261330<br />
(for final coding)<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=261052<br />
(for discussion)<br />
<br />
I've not yet checked the registry for SQL 2005 Express. Hope it will be the same, otherwise you've to just replace that registry path.<br />
<br />
Now coming to your execution of SQL installation:<br />
Since I was installing SQL only if there is no existence of SQL, the coding was simple:<br />
<br />
 ExecWait '&quot;$INSTDIR\setup.exe&quot;' $0<br />
(yes, no silent installation)<br />
I called it from Finish page Run, so it was fine for the user also.<br />
<br />
But to throw some light on how to call a SQL script, I'm providing you a script of how to restore a SQL database from NSIS installer. I've created a text file containing the actual command and then calling it.<br />
<br />
Function RestoreSQLData<br />
   SetOverwrite try<br />
   nsExec::Exec &quot;cmd /C NET START MSSQLSERVER&quot;<br />
   StrCpy $DemoDbName &quot;Demo&quot;<br />
   SetOutPath &quot;$INSTDIR&quot;<br />
   SetFileAttributes &quot;$INSTDIR\Data\$DemoDbName.bak&quot; NORMAL<br />
   FileOpen &quot;$0&quot; &quot;RestDemo.txt&quot; &quot;w&quot;<br />
   FileWrite &quot;$0&quot; &quot;RESTORE DATABASE $DemoDbName FROM DISK='$INSTDIR\Data\$DemoDbName.Bak' WITH MOVE 'Data_dat' TO   '$INSTDIR\Data\$DemoDbName.mdf',MOVE 'Data_log' TO '$INSTDIR\Data\$DemoDbName.ldf',REPLACE$\r$\n&quot;<br />
   FileClose &quot;$0&quot;<br />
   nsExec::Exec &quot;cmd /C Osql -S . -U sa -P -o Demo.Log -i RestDemo.txt&quot;<br />
FunctionEnd<br />
<br />
Demo.log will contain the output. You can check from here whether your command executed properly or not.<br />
<br />
This is not actually what you want, but may be helpful.<br />
If you get it right meantime, then do let us know.<br />
<br />
With regards,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kerstin</div><div class="date">17th January 2007, 14:39</div></div><div class="posttext">Thank You so much for your help! i got it in the meantime.<br />
Here is a snippet of what i ended up doing: <br />
 NSISDL::download &quot;http://example.com/admin/SQLEXPR.EXE&quot; &quot;$TEMP\SQLEXPR.EXE&quot;<br />
                ExecWait '$TEMP\SQLEXPR.EXE  /qb INSTANCENAME=bla ADDLOCAL=ALL SECURITYMODE=SQL SAPWD=bla DISABLENETWORKPROTOCOLS=0'<br />
                SetOutPath &quot;$INSTDIR&quot;<br />
                File &quot;\Mule Worker Debug\mule2_db.exe&quot;<br />
                ReadRegStr $0 HKLM &quot;System\CurrentControlSet\Control\ComputerName\ActiveComputerName&quot; &quot;ComputerName&quot;<br />
                ExecWait 'mule2_db.exe /server:$0\bla /database:bla /username:bla /password:bla /makedatabase'<br />
                DetailPrint &quot;Completed SQLServer 2005 install. Cleaning temporary files...&quot;<br />
	        Delete &quot;$TEMP\SQLEXPR.EXE&quot;<br />
	        DetailPrint &quot;Completed cleaning temporary files.&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alexjula</div><div class="date">10th September 2007, 15:30</div></div><div class="posttext">What's the actual link you used in :<br />
 NSISDL::download &quot;link&quot; ?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>