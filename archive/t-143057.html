<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Program files directory differs with the different windows languages., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Program files directory differs with the different windows languages. NSIS Discussion" />
	
	<title> Program files directory differs with the different windows languages. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Program files directory differs with the different windows languages.</div>
<hr />
<div class="pda"><a href="t-143057.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=143057">Program files directory differs with the different windows languages.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">insolit</div><div class="date">21st July 2003, 20:17</div></div><div class="posttext">I'd like to know if i can make the installer to detect automatically the program files directory, depending on the operative system language.<br />
For example for portuguese versions of windows the program files directory is &quot;programas&quot;.<br />
I have the installer set to have the default installation folder, into &quot;program files&quot;, but i'd like that the installer could automatically detect the operative system and the correspondent program files folder.<br />
Hope i've made myself clear.<br />
Hope somebody can help me out.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Gunny2k2</div><div class="date">21st July 2003, 20:26</div></div><div class="posttext">InstallDir &quot;$PROGRAMFILES\${MUI_PRODUCT}&quot;  <br />
<br />
$PROGRAMFILES = means it whould autodect windows program files <br />
${MUI_PRODUCT} = means it would make a dir the name of the installer</div></div><hr />


<div class="post"><div class="posttop"><div class="username">insolit</div><div class="date">21st July 2003, 21:06</div></div><div class="posttext">that's exactly what i have but there's having a problem with portuguese operative systems.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st July 2003, 21:26</div></div><div class="posttext">If the directory paths have strange characters in them, then you will get problems straight off.<br />
This is probably another issue which needs to be fixed.<br />
<br />
Can you please tell us what the default Program Files path is for Portuguese systems?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">insolit</div><div class="date">21st July 2003, 22:15</div></div><div class="posttext">I believe there are no strange caracters, anyway the default path is &quot;programas&quot;.<br />
By the way here is the installer code i'm using:<br />
<br />
attach large scripts. attached below :down:<br />
<br />
Could you tell me if you can notice any problems with these lines?<br />
One of the problems that occurs is that the ac3filter is not correctly installed at the first time installation, i've to run the program twice to get ac3filter instalation program running.<br />
Another problem is that when people run this installer with windows portuguese operative system, besides it is not correctly detecting the program files instalation folder default, if they don't change manually the name of the folder &quot;program files&quot; to &quot;programas&quot;, the files won't even get to be registered or installed.<br />
I could really use some help here.<br />
Thanks in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">21st July 2003, 22:38</div></div><div class="posttext">Hi dude:<br />
attach large scripts, please :) ...<br />
$PROGRAMFILES is a runtime variable...<br />
depending of the end-user OS language I'll be the <br />
path for &quot;Program files&quot;<br />
For example:<br />
in spanish is :&quot;C:\Archivos de programa\&quot;<br />
You can see it yours in this Registry root:<br />
<br />
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion<br />
[ProgramFilesDir]<br />
[ProgramFilesPath]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd July 2003, 08:36</div></div><div class="posttext">Open regedit, go to the key Lobo Lunar posted, take a screen shot and attach it here. Also try the latest CVS version, it has an additional check for weird cases.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">insolit</div><div class="date">22nd July 2003, 13:17</div></div><div class="posttext">First of all thanks to all by the great support.<br />
Kichik i just installed the lateste CVS and nothing strange is detected in the script.<br />
I have no problems in the installation of my installer, because i have windows english version, besides the fact the ac3filter is not installed in the first installation. In a first installation, the file ac3filter_0_69b.exe, is copied to the specified folder but not ran.<br />
But I got a printscreen from someone who had problems, because he has portuguese windows version:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd July 2003, 13:22</div></div><div class="posttext">His registry seems OK, nothing funky. Are you sure what he sees is not an old value that NSIS got using InstallDirRegKey? Trying sending him an installer that just prints $PROGRAMFILES and doesn't use InstallDir or InstallDirRegKey. If that doesn't get the right value for him, I'd like to talk to him in person.<br />
<br />
BTW, I have removed the screen shot from your post because it contains the product id. I should have mentioned that there might be sensitive information in there, I'm sorry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">insolit</div><div class="date">22nd July 2003, 13:51</div></div><div class="posttext">Ok, thnks a lot for removing it, i did not pay attention to that.<br />
This problem occurred to everyone that have run my installer and have windows xp pro portuguese. <br />
Here's a printscreen of what happens:<br />
<br />
http://pwp.netcabo.pt/matroska/problem2.jpg <br />
<br />
http://pwp.netcabo.pt/matroska/problem1.jpg</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd July 2003, 14:20</div></div><div class="posttext">Does it work if you specify a full path for RegDLL ($INSTDIR\dllname.dll)? Does it work if you add &quot;Sleep 1000&quot; between File and RegDLL? Are the files even extracted to the right place? Does the installer using latet CVS version solve any of these for them?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">insolit</div><div class="date">23rd July 2003, 00:13</div></div><div class="posttext">Kichik thnks a lot. <br />
Everything works just great now.<br />
To complete the installer i'd like to add an uninstallation to the ac3filter.<br />
But the problem is how can i put the uninstaller of my installer to find the directory where the ac3filter independent installer, installed the program.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">23rd July 2003, 00:25</div></div><div class="posttext">You could use the Search for file function on the NSIS Archive (http://nsis.sourceforge.net/archive/nsisweb.php?page=211&amp;instances=0,11) to search for the specific ac3filter file?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd July 2003, 13:03</div></div><div class="posttext">insolit, which one solved it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">insolit</div><div class="date">23rd July 2003, 22:21</div></div><div class="posttext">All problems were solved.<br />
I have got no further complaints in windows xp portuguese or english installations.<br />
Now everything's just fine, thanks to you. :)<br />
Now I'll try to use the search option Afrow UK mentioned, so that I can also uninstall ac3 filter. (Thanks Afrow UK)<br />
By the way, is there a way to have an uninstall process, so that we could choose the components to uninstall, instead of uninstalling everything?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">23rd July 2003, 22:28</div></div><div class="posttext">I want to know which solution of the three suggested solved it, not what it solved. I already understand it has solved everything, and am happy that it did, but I would still like to know what solved it.<br />
<br />
For now, to show a &quot;components page&quot; in the uninstaller, you can use InstallOptions. Hopefully, tomorrow or the day after you'll be able to show a real components page too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">insolit</div><div class="date">24th July 2003, 07:59</div></div><div class="posttext">Sorry I misunderstood your questions.<br />
Well both two first options, can individually put the installer doing things correctly.<br />
About the third choice, as I previously mentioned had no effect.<br />
And by the way, all files are installed to the correct directory.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>