<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" CreateShortCut on Pocket PC, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  CreateShortCut on Pocket PC NSIS Discussion" />
	
	<title> CreateShortCut on Pocket PC [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  CreateShortCut on Pocket PC</div>
<hr />
<div class="pda"><a href="t-259794.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=259794">CreateShortCut on Pocket PC</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">lharrison</div><div class="date">17th November 2006, 16:01</div></div><div class="posttext">Hi, I have been using NSIS for quite a while now to package my Pocket PC application.  For some reason I cannot get the CreateShortCut to work for me.<br />
<br />
This is the code I have been tring to use:<br />
<br />
SetOutPath &quot;$INSTDIR&quot;<br />
CreateShortCut &quot;$INSTDIR\sync.lnk&quot; &quot;$INSTDIR\sm_server.exe&quot;<br />
<br />
I really want my short cut to be in the following directory:<br />
My Device\Windows\Star Menu\Programs<br />
<br />
But I can't even get it to create a shortcut in the Install direcory.<br />
<br />
Does anyone ahve any experience with this or have a solution for me?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th November 2006, 16:21</div></div><div class="posttext">If you want to create shortcuts on the device itself, you'd probably want to call CeSHCreateShortcut (http://msdn.microsoft.com/library/en-us/wcesdkr/html/_wcesdk_CeSHCreateShortcut_RAPI_.asp?frame=true) instead of using the normal method. If you create a shortcut using the normal method, it'd probably result with a target that tells your PC how to find that executable instead of a target that tells the device how to find it.!include LogicLib.nsh<br />
<br />
System::Call &quot;rapi::CeRapiInit() i .r0&quot;<br />
 <br />
${If} $0 == 0 # S_OK<br />
<br />
  System::Call &quot;rapi::CeSHCreateShortcut(t'shortcut', t'target')&quot;<br />
<br />
  System::Call &quot;rapi::CeRapiUninit()&quot;<br />
<br />
${Else}<br />
<br />
  DetailPrint &quot;error initializing rapi interface&quot;<br />
  DetailPrint &quot;make sure the device is connected&quot;<br />
<br />
${EndIf}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lharrison</div><div class="date">17th November 2006, 19:30</div></div><div class="posttext">Hi, I added the following code in my .nsi project:<br />
<br />
!include LogicLib.nsh<br />
<br />
System::Call &quot;rapi::CeRapiInit() i .r0&quot;<br />
 <br />
${If} $0 == 0 # S_OK<br />
<br />
  System::Call &quot;rapi::CeSHCreateShortcut(t'Sm Server', t'sm_server.exe')&quot;<br />
<br />
  System::Call &quot;rapi::CeRapiUninit()&quot;<br />
<br />
${Else}<br />
<br />
  DetailPrint &quot;error initializing rapi interface&quot;<br />
  DetailPrint &quot;make sure the device is connected&quot;<br />
<br />
${EndIf}<br />
<br />
And still nothing.  I did a search in the NSIS help and it did not list anything about the CeSHCreateShortcut.<br />
<br />
I'm using version 2.0.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th November 2006, 19:35</div></div><div class="posttext">Try specifying full paths for CeSHCreateShortcut. I don't think it automatically creates shortcuts on the start menu. MSDN doesn't mention that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lharrison</div><div class="date">17th November 2006, 19:55</div></div><div class="posttext">I put in the following path:<br />
My Device\Windows\Star Menu\Programs\<br />
<br />
Still no luck.  I did notice thought, the the root directory, My Device that there are news files being added.<br />
They are named as so:<br />
??????????????????</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th November 2006, 20:03</div></div><div class="posttext">Are you sure \My Device is the correct path? Sounds to me like the path is for your PC as it refers to the device and not to itself. Using CeGetSpecialFolderPath to get the path would probably be a better idea. That'd also make sure it works, even if it the user changes the start menu paths.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lharrison</div><div class="date">17th November 2006, 20:05</div></div><div class="posttext">I will try that.  I did a search on CeGetSpecialFolderPath and CeSHCreateShortcut and came up empty.  Do you know where I can find documentation on these?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lharrison</div><div class="date">17th November 2006, 20:07</div></div><div class="posttext">I found some documentation, sorry, I thought these were NSIS commands.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lharrison</div><div class="date">17th November 2006, 20:41</div></div><div class="posttext">Hey, do you have an example on how to use and display the results of CeGetSpecialFolderPath?<br />
<br />
thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th November 2006, 20:44</div></div><div class="posttext">System::Call &quot;rapi::CeGetSpecialFolderPath(i2,i${NSIS_MAX_STRLEN},t.r0)&quot;<br />
DetailPrint $0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lharrison</div><div class="date">17th November 2006, 20:47</div></div><div class="posttext">hey, thanks for the example, it was pretty close to what I was tring.  I still must be doing something wrong.  the DetailPrint does nothing.  Have you ever tried this using NSIS?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th November 2006, 20:57</div></div><div class="posttext">Haven't tried it. I don't have a Pocket PC and I never installed the emulator.<br />
<br />
According to MSDN, the line I gave you above should work. There's not much to get wrong there. You can add i.r1 at the end and get the return value to $1. The only possible problem I could think of is that RAPI is not initialized. That could happen if it's called before CeRapiInit.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lharrison</div><div class="date">20th November 2006, 15:20</div></div><div class="posttext">Hi,<br />
   I tried the following and it returns 0<br />
<br />
<br />
System::Call &quot;rapi::CeGetSpecialFolderPath(CSIDL_PROGRAMS,i${NSIS_MAX_STRLEN},i .r4)&quot;<br />
<br />
Any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zbd</div><div class="date">21st November 2006, 02:51</div></div><div class="posttext">As far as creating the shortcut on the device, i'm pretty sure, when you are compiling your CAB file you can specify the shortcuts in there along with any Reg values etc.<br />
<br />
Not sure if it is new in the CAB wizard that comes with Visual Studio 2005, I haven't tested it myself yet.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lharrison</div><div class="date">21st November 2006, 13:50</div></div><div class="posttext">Hi, originaly, I thought the same.  I looked at all of the properties in the cabwiz and cannot find anything about a shortcut.  I will keep hunting.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lharrison</div><div class="date">21st November 2006, 14:40</div></div><div class="posttext">Got it!  Finally!  In case anyone reads with a simialr problem here is the solution.<br />
In .NET 2005, after you created your cab project and added the project output, double click on the primary output.  In the left pane (File System) right cvlcik and add a special folder.  In the right pane add project output.  Re build and install your cab and you will have a shortcut.<br />
Thanks to all that have helped.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">21st November 2006, 18:46</div></div><div class="posttext">i.r4 should be outside of the parenthesis. It's the return value, not another function parameter.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>