<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Windows 7 Uninstall Registry Entries, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Windows 7 Uninstall Registry Entries NSIS Discussion" />
	
	<title> Windows 7 Uninstall Registry Entries [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Windows 7 Uninstall Registry Entries</div>
<hr />
<div class="pda"><a href="t-333191.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=333191">Windows 7 Uninstall Registry Entries</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Ron.Stordahl</div><div class="date">4th August 2011, 19:23</div></div><div class="posttext">I am updating an installer for XP to include Vista/Windows 7.  Currently, in XP,  I set in the registry:<br />
<br />
WriteRegStr HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot; &quot;$INSTDIR\BPQ32.exe&quot;<br />
<br />
WriteRegStr HKLM &quot;${PRODUCT_UNINST_KEY}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\uninst.exe&quot;.  As well as similar entries for &quot;DisplayIcon&quot;,  &quot;Publisher&quot; etc.<br />
<br />
Should these be changed to HKCU for Vista/Windows 7 installs.  I do need to use HKCU as opposed to HKLM for other non-install related registry entries in Windows 7, such as paths to application data, etc.<br />
<br />
The application is 32 bit if that matters.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">4th August 2011, 20:04</div></div><div class="posttext">If you're elevating your install (that is, requiring admin access), you shouldn't be using HKCU at all, because they'll end up in the admin's reghive, not the user's. (It's true that on Vista/7 this might actually be the same user, but that's not guaranteed.)<br />
If on the other hand you don't elevate, you cannot use HKLM at all because you need admin access to write there.<br />
<br />
So, long story short: In almost all cases you shouldn't be writing to both HKLM and HKCU. It's either one or the other: HKLM for admin-level installers, HKCU for user-level installers.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ron.Stordahl</div><div class="date">5th August 2011, 00:04</div></div><div class="posttext">That is good info.  The entries I quoted are as far as I understand needed so that the control panel uninstall program list will include my application.  I doubt it is actually necessary as I have the uninstall link in the program list, however good practice is to do as I have suggested.<br />
<br />
So I will use HKCU for all and not mix the two.<br />
<br />
Thanks for the informative response...I am just learning about W7!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>