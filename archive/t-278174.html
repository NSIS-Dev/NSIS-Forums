<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with Vista/RequestExecutionLevel, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with Vista/RequestExecutionLevel NSIS Discussion" />
	
	<title> Problem with Vista/RequestExecutionLevel [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with Vista/RequestExecutionLevel</div>
<hr />
<div class="pda"><a href="t-278174.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=278174">Problem with Vista/RequestExecutionLevel</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jory99</div><div class="date">1st October 2007, 12:35</div></div><div class="posttext">Hi Forum,<br />
<br />
I am currently porting our Windows XP installer to Vista. I am using 'RequestExecutionLevel admin' to make it run using appropriate privileges.<br />
<br />
The problem is, when I use this the shortcuts get installed for the privileged account (local administrator in this case) rather than the account of the desktop user that started the installer. Is there a way around this?<br />
<br />
I have also tried using an installer without 'RequestExecutionLevel admin', but then I get a notification at the end saying that the installation was not correct.<br />
<br />
Thanks in advance for any help.<br />
Jonas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">1st October 2007, 16:50</div></div><div class="posttext">use &quot;SetShellVarContext all&quot; before you create the shortcuts (this will put them in the &quot;all users&quot; startmenu, if you don't want a all users type install, you could use the UAC plugin and executecodesegment, but its not pretty)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jory99</div><div class="date">2nd October 2007, 13:03</div></div><div class="posttext">Thanks Anders,<br />
<br />
I would prefer not to install for all users, so I'll look into your tip re UAC plugin!<br />
<br />
Thanks for your help.<br />
Jonas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd October 2007, 13:21</div></div><div class="posttext">Its not really about what you prefer, with vista and an installer running as admin, the installer might not be running as the user you think it is running as (It could be elevated with an admin account, different from the user's explorer.exe etc.) So unless you are installing a driver or something that really needs admin rights, you might want to try to make it work as a normal user</div></div><hr />


<div class="post"><div class="posttop"><div class="username">smatte</div><div class="date">2nd October 2007, 18:22</div></div><div class="posttext">You should read about bootstrapping. You'll have to split your installer to have an installer running as user that start an other installer as admin to install files.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd October 2007, 18:35</div></div><div class="posttext">Originally posted by smatte <br />
You should read about bootstrapping. You'll have to split your installer to have an installer running as user that start an other installer as admin to install files.  <br />
This is exactly what the UAC plugin does</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>