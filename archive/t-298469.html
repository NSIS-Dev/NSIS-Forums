<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Subtracting Characters from a line of text, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Subtracting Characters from a line of text NSIS Discussion" />
	
	<title> Subtracting Characters from a line of text [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Subtracting Characters from a line of text</div>
<hr />
<div class="pda"><a href="t-298469.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=298469">Subtracting Characters from a line of text</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">madj42</div><div class="date">9th October 2008, 17:17</div></div><div class="posttext">Forgive me I'm new to this whole NSIS scripting thing.  I've searched up and down everywhere for this and cannot find anything.  I'm looking to pull the registry information for the ProductID for WinXP and then subtract the last couple characters off of it since it seems the first three sets of numbers are the same.<br />
<br />
The end goal of this function or line of code is to be able to verify if the PC the installer is running on is a corporate supported PC.<br />
<br />
XXXXX-XXX-XXXXXXX-XXXXX<br />
<br />
Above is the normal format for the ProductID key in the registry.  I'm looking to chop off the bits underlined and put it into a variable so that I can compare it using the StrCmp command.  I already have the code to pull the value from the registry and put it as the variable $1 but from there I'm lost.<br />
<br />
I'm not looking for someone to write the code for me or anything but if someone can point me in the right direction as to which commands can do this that would be much appreciated.  Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">9th October 2008, 22:13</div></div><div class="posttext">look at the StrCpy commandStrCpy $0 &quot;a string&quot; # = &quot;a string&quot;<br />
StrCpy $0 &quot;a string&quot; 3 # = &quot;a s&quot;<br />
StrCpy $0 &quot;a string&quot; -1 # = &quot;a strin&quot;<br />
StrCpy $0 &quot;a string&quot; &quot;&quot; 2 # = &quot;string&quot;<br />
StrCpy $0 &quot;a string&quot; &quot;&quot; -3 # = &quot;ing&quot;<br />
StrCpy $0 &quot;a string&quot; 3 -4 # = &quot;rin&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">9th October 2008, 22:18</div></div><div class="posttext">Yathosho beat me to it!  But since I had my reply all ready so go, I'll submit it anyway:<br />
<br />
If the part you want to get always 5 characters, then you could use StrCpy as Yathosho points out:  StrCpy $2 &quot;$1&quot; &quot;&quot; -5<br />
<br />
Else, you'd have to split at the last dash.  To do that, one might use this:<br />
!include WordFunc.nsh<br />
!include Logiclib.nsh<br />
!insertmacro WordFind<br />
...<br />
<br />
; let's say $1 is the long string:<br />
${WordFind} &quot;$1&quot; &quot;-&quot; &quot;-1&quot; $2<br />
; $2 should be your string<br />
${If} &quot;$2&quot; == &quot;&quot;<br />
   MessageBox MB_OK &quot;Invalid product code!&quot;<br />
${EndIf}<br />
(Both StrCpy and WordFind are in the NSIS help files if you need more info.)<br />
<br />
edit:  forgot the !insertmacro command in my example...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">madj42</div><div class="date">10th October 2008, 03:25</div></div><div class="posttext">Thanks to both of you.  Using the above examples I came up with a working demo script which will be merged in my main script tomorrow.  I thought this NSIS stuff was going to be hard but in reality its not as bad as I thought!<br />
<br />
If it helps anyone this is what I wrote:<br />
<br />
<br />
<br />
ReadRegStr $1 HKLM &quot;Software\Microsoft\Windows NT\CurrentVersion&quot; &quot;ProductId&quot;<br />
StrCpy $2 &quot;$1&quot; -6<br />
IfFileExists &quot;c:\corporatecomputer.txt&quot; &quot;+3&quot; &quot;+1&quot;<br />
StrCmp $2 &quot;34534-OEM-4636364&quot; &quot;+2&quot; &quot;+1&quot;<br />
StrCmp $2 &quot;56345-OEM-3642634&quot; &quot;+1&quot; &quot;NotCorporate&quot;<br />
<br />
MessageBox MB_OK 'The value was good!'<br />
Goto Finish<br />
<br />
NotCorporate:<br />
MessageBox MB_OK 'Setup cannot continue because this is not a Corporate Computer. $8'<br />
Quit<br />
<br />
<br />
I had to put a backdoor in there so thats where the corporatecomputer.txt comes in to play.  Thanks again!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>