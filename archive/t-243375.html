<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" infinite loop possible in close all IE windows example, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  infinite loop possible in close all IE windows example NSIS Discussion" />
	
	<title> infinite loop possible in close all IE windows example [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  infinite loop possible in close all IE windows example</div>
<hr />
<div class="pda"><a href="t-243375.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=243375">infinite loop possible in close all IE windows example</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">13th April 2006, 17:19</div></div><div class="posttext">The wiki example showing how to close all IE windows (http://nsis.sourceforge.net/Closing_ALL_Internet_Explorer_Windows) can get caught in an infinite loop if an IE window has a dialog open.<br />
<br />
For example, if you open IE, go to Tools, and select Internet Options, a settings dialog appears. If you then run the routine on the wiki page, it will loop through and infinitely keep sending WM_CLOSE messages to IE, which will all be ignored.<br />
<br />
The only way I'm aware of to be sure that you will close all IE instances is to kill all iexplore.exe processes. This will cause all IE windows to die, even if they have dialogs open.<br />
<br />
I would recommend Instructor's nsprocess plug-in (http://forums.winamp.com/showthread.php?s=&amp;threadid=230998). I haven't used it, but he says it can &quot;Kill all processes with specified name (not only one)&quot;, so it should do the trick :)<br />
<br />
Note: this infinite loop possibility is not only present in this particular example. To be safe, you can set an upper limit of the number of times you want to loop and exit out of the loop if that is reached.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">13th April 2006, 18:22</div></div><div class="posttext">It should have a counter in there so it loops say 100 times and then gives up.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">13th April 2006, 19:14</div></div><div class="posttext">Find-Close-Terminate plg-in (http://nsis.sourceforge.net/FCT_plug-in) enumarates windows and first attempts to close applications (WM_CLOSE), if app. still running - terminates it. Bad idea to 'terminate' app as a first step (if we can find it's window). From KillProcDll plug-in description: &quot;The TerminateProcess function is used to unconditionally cause a process to exit. Use it only in extreme circumstances. The state of global data maintained by dynamic-link libraries (DLLs) may be compromised if TerminateProcess is used rather than ExitProcess.&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">13th April 2006, 19:48</div></div><div class="posttext">Takhir, you are too nice to apps :p<br />
Thanks for the plug-in link!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>