<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Get the count of total number of files under a folder., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Get the count of total number of files under a folder. NSIS Discussion" />
	
	<title> Get the count of total number of files under a folder. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Get the count of total number of files under a folder.</div>
<hr />
<div class="pda"><a href="t-329007.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=329007">Get the count of total number of files under a folder.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">reachb4</div><div class="date">28th March 2011, 10:48</div></div><div class="posttext">Hi,<br />
<br />
What is the script to  get the  count of files under a folder?<br />
<br />
<br />
Please advice.<br />
<br />
<br />
Thanks in advance,<br />
<br />
Regards,<br />
John.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Highcoder</div><div class="date">28th March 2011, 11:17</div></div><div class="posttext">As a famous philosoph said a long time ago: &quot;RTFM!&quot; :D<br />
Joke...<br />
<br />
But exactly there is the answer. Keyword: &quot;File Functions Header&quot; (http://nsis.sourceforge.net/Docs/AppendixE.html#E.1)<br />
<br />
!include &quot;FileFunc.nsh&quot;<br />
<br />
Section &quot;GetFileCount&quot;<br />
${GetSize} &quot;C:\YourFolder&quot; &quot;/G=0&quot; $0 $1 $2      ;file count in YourFolder or...<br />
${GetSize} &quot;C:\YourFolder&quot; &quot;/G=1&quot; $0 $1 $2      ;file count in YourFolder include Subdirectorys!<br />
; $0 = contains the size normaly but the option S=nothing means &quot;donÂ´t get size, faster&quot;<br />
; $1 = filecount<br />
; $2 = directorycount<br />
SectionEnd<br />
<br />
have fun<br />
<br />
cheers</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jiake</div><div class="date">28th March 2011, 13:21</div></div><div class="posttext">http://nsis.sourceforge.net/Locate_plugin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">28th March 2011, 13:46</div></div><div class="posttext">The NSIS User Manual has some appendices describing lots of useful functions together with sample code showing how to use them.<br />
<br />
Appendix E.1 (File Functions Header) includes the GetSize function which can be used to count the number of files in a folder or in a folder and its sub-folders:<br />
http://nsis.sourceforge.net/Docs/AppendixE.html#E.1.3</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">28th March 2011, 16:55</div></div><div class="posttext">Or if you don't need recursive searches, you can just use something simple like this:<br />
<br />
StrCpy $dirs 0<br />
StrCpy $files 0<br />
FindFirst $0 $1 &quot;C:\YourPath\*.*&quot;<br />
loop:<br />
  StrCmp $1 &quot;&quot; done<br />
  ${If} ${FileExists} &quot;$1\*.*&quot;<br />
    IntOp $dirs $dirs + 1<br />
  ${Else}<br />
    IntOp $files $files + 1<br />
  ${EndIf}<br />
  FindNext $0 $1<br />
  Goto loop<br />
done:<br />
FindClose $0<br />
The manual is your friend. http://nsis.sourceforge.net/Docs/Chapter4.html</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">28th March 2011, 18:09</div></div><div class="posttext">You need to ignore $1 if it is . or ..:ClearErrors<br />
FindFirst $0 $1 &quot;C:\YourPath\*.*&quot;<br />
${DoUntil} ${Errors}<br />
  ${If} $1 != .<br />
  ${AndIf} $1 != ..<br />
    ${If} ${FileExists} &quot;C:\YourPath\$1\*.*&quot;<br />
      IntOp $dirs $dirs + 1<br />
    ${Else}<br />
      IntOp $files $files + 1<br />
    ${EndIf}<br />
  ${EndIf}<br />
  FindNext $0 $1<br />
${Loop}<br />
FindClose $0Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">29th March 2011, 06:24</div></div><div class="posttext">You need to ignore $1 if it is .. otherwise it will count the files and folders in the parent folder as well!<br />
I don't see how it would count the files from parent. It would simply add two counts to $dirs. FindFirst/Next isn't recursive, either down or up the tree. You can solve the two extra counts by using StrCpy $dirs -2 at the beginning, instead of 0. Saves a bunch of Ifs (but probably breaks if the search directory doesn't exist).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">29th March 2011, 10:26</div></div><div class="posttext">Sorry you are right of course. Fixed the error with the FileExist check ($1 is only the file name, not the complete path).<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>