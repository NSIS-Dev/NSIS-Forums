<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Enumerating and abstracting function names.....function_Ptr anyone?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Enumerating and abstracting function names.....function_Ptr anyone? NSIS Discussion" />
	
	<title> Enumerating and abstracting function names.....function_Ptr anyone? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Enumerating and abstracting function names.....function_Ptr anyone?</div>
<hr />
<div class="pda"><a href="t-296281.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=296281">Enumerating and abstracting function names.....function_Ptr anyone?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Andrew Wallo</div><div class="date">21st August 2008, 18:12</div></div><div class="posttext">Based on insufficient solutions for resolving a string to its function name during runtime, ( see posts <br />
Post on Rollbacks. (http://forums.winamp.com/showthread.php?postid=2393593#post2393593) <br />
And the apparent lack of abstracted functionality during runtime of the GetFunctionAddress GetFunctionAddress Limitations (http://forums.winamp.com/showthread.php?s=&amp;postid=2393261#post2393261) <br />
<br />
I'm trying to create a script/macro that would perform the following:<br />
<br />
Step 1. Define a macro named ResStr ( Short for ResolveString )<br />
<br />
-&gt; hard part for me...<br />
Step 1.  Rip the NSIS script and Enumerate ALL the names of EVERY function defined in the script. Not necessary for a manual version... but would be really good for a global coding style performance enhancement.<br />
<br />
Step 2.  Build a case statement for an input variable that would resolve to each of those names as a string literal in order to survive compile reduction to memory space.<br />
<br />
See, without it being truely abstracted....using GetFunctionAddress is meaningless for runtime solutions.  i.e. Yes... we can pass a function pointer to a macro and the macro doesn't need to know what specific one its calling... But only if the setup is built at compile time. <br />
<br />
GetFunctionAddress NEEDS to receive a variable that contains a string.... but to do that we need to be able to hash the &quot;stringnames&quot; to the memory spaces... like this code might....???<br />
<br />
<br />
USAGE:  <br />
<br />
; Reading a string from a file into this var...<br />
${GetBetween} &quot;&lt;callback&gt;&quot; &quot;&lt;/callback&gt;&quot; $fileHandle $myFunction_PtrString<br />
<br />
${ResStr} $myFunction_PtrString<br />
<br />
<br />
And the manually built version would be someting like this:<br />
<br />
<br />
<br />
!macro ResStr _FunctionNameLiteral<br />
  push ${FunctionNameLiteral}<br />
  call func_ResStr<br />
!macroend <br />
<br />
Function func_ResStr<br />
  push $1 ; save reg1<br />
  Exch<br />
  pop $1  ; get function name as string literal. <br />
<br />
  ${Switch} $1<br />
    ${Case} &quot;fileBusyCondition&quot; ; this would work because its runtime comparisons...<br />
       ; a result call back from trying to rollback.<br />
       Call fileBusyCondition ; this would work because its precompile time linking.....<br />
    ${Case} &quot;mailTheMoney&quot;<br />
       ; When I hack the lotto successfully perform<br />
       ; this callback.<br />
       Call mailTheMoney<br />
    ; Blah Blah Blah every function that a user might care<br />
    ; to call back....<br />
  ${EndSwitch}<br />
  pop $1<br />
FunctionEnd<br />
<br />
<br />
So if we could enumerate all function names like this, then we could have an Resolve String function......<br />
<br />
Easiest way to enumerate all function names in a NSIS project?  <br />
<br />
[ Hollow sound. ]  Helloooooooooo? ;-)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>