<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Processes::FindProcess vs. nsProcess::FindProcess vs. FindProcDLL, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Processes::FindProcess vs. nsProcess::FindProcess vs. FindProcDLL NSIS Discussion" />
	
	<title> Processes::FindProcess vs. nsProcess::FindProcess vs. FindProcDLL [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Processes::FindProcess vs. nsProcess::FindProcess vs. FindProcDLL</div>
<hr />
<div class="pda"><a href="t-322583.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322583">Processes::FindProcess vs. nsProcess::FindProcess vs. FindProcDLL</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">20th September 2010, 17:48</div></div><div class="posttext">I noticed that there are multiple plug-ins with similar functionality:<br />
<br />
http://nsis.sourceforge.net/FindProcDLL_plug-in<br />
<br />
http://nsis.sourceforge.net/Processes_plug-in<br />
<br />
http://forums.winamp.com/showthread.php?t=230998<br />
<br />
My question now is when and why choose one over the other? What are the differences between them? Is one a newer version of another?<br />
<br />
I found this excellent thread (http://forums.winamp.com/showthread.php?t=274475) which provides a clue (&quot;FindProcDLL only finds processes of the currently logged in user&quot;), but I haven't found more information.<br />
<br />
Could you please shed some light on this?<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th September 2010, 18:01</div></div><div class="posttext">Without looking at the source code, I can guess some use API's that only work prior to Vista or after Windows 98. None of the plug-ins will allow you to find a 64-bit process (because this cannot be done from a 32-bit process unless you use WMI).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nsnb</div><div class="date">20th September 2010, 19:26</div></div><div class="posttext">Without looking at the source code, I can guess some use API's that only work prior to Vista or after Windows 98. None of the plug-ins will allow you to find a 64-bit process (because this cannot be done from a 32-bit process unless you use WMI).<br />
Further investigation suggests that nsProcess by Instructor (http://forums.winamp.com/showthread.php?t=230998) is the newest of all and supports finding a 64-bit process if NSIS itself was built on an x64 system. It doesn't support Unicode, however, which a recent revision of FindProceDLL (http://sourceforge.net/projects/findkillprocuni/files/) does.<br />
<br />
The Processes plug-in (http://nsis.sourceforge.net/Processes_plug-in) has an x64 Vista fix, but there is no information about what that fix means.<br />
<br />
My conclusion is that nsProcess is the most mature &amp; complete package (except that some reported it triggers their anti-virus software). I can, of course, be mistaken - so if you think otherwise please let me know.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">820815</div><div class="date">20th September 2010, 21:26</div></div><div class="posttext">ProcFunc (http://forums.winamp.com/showthread.php?t=290325)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th September 2010, 22:19</div></div><div class="posttext">...and supports finding a 64-bit process if NSIS itself was built on an x64 system.<br />
<br />
The limitation is because NSIS is 32-bit; it is nothing to do with the platform that NSIS is built on. If NSIS was rebuilt as an x64 binary then we wouldn't have the problem. I think I posted a link on this issue in the LockedList plug-in forum topic while I was trying to find a solution. x64 NSIS is not going to be here any time soon - it'd be a lot of work.<br />
<br />
So really there are 2 solutions that I can think of at this time. Use WMI (someone posted a header file in a recent post) or write a 64-bit executable which does what the plug-ins do (you could make it a console application and read its output using nsExec::ExecToStack).<br />
<br />
Post 7000 FTW.<br />
<br />
Edit: In regards to ProcFunc, it uses CreateToolhelp32Snapshot among others (including the FindProcDLL plug-in). From MSDN CreateToolhelp32Snapshot:<br />
If the specified process is a 64-bit process and the caller is a 32-bit process, this function fails and the last error code is ERROR_PARTIAL_COPY (299).<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">razvar</div><div class="date">11th April 2011, 11:16</div></div><div class="posttext">You can use IssProc (google it). It was made for Inno but works with nsis, even if the setup is 32bit you will get the 64bit processes, dll's or any file type in use  (no WMI required)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hnedka</div><div class="date">3rd June 2011, 10:23</div></div><div class="posttext">Hi, I have created a modification of FindProcDLL plugin, because I found out it doesn't work on 64 bit Windows. It's alpha so far, briefly tested (ANSI version not at all). For the time being I don't recommend it for any serious project.<br />
<br />
Changes you won't like:<br />
- removed support for Win9x (too much trouble with it, sorry)<br />
<br />
Positive changes:<br />
- can find 64 bit processes (no WMI)<br />
- can find processes called like a short path (for example you are looking for Program.exe, but it's called with a short path, so the real process name is e.g. PROGR~1.EXE and you wouldn't find it before)<br />
- excludes current process from all searches<br />
<br />
- you can search for an entire path (or any part of it - from the left), for example:<br />
FindProcDLL::FindProc &quot;C:\Program Files\MyProg\Prog.exe&quot;<br />
FindProcDLL::FindProc &quot;C:\Program Files&quot;<br />
<br />
- you can search for a subpath from the right (backslash is expected in the process path right before the searched string):<br />
FindProcDLL::FindProc &quot;MyProg\Prog.exe&quot;<br />
FindProcDLL::FindProc &quot;Program Files\MyProg\Prog.exe&quot;<br />
<br />
- integrated KillProc function (all of the above updates apply to it):<br />
FindProcDLL::KillProc &quot;myprog.exe&quot;<br />
<br />
- added function WaitProcEnd, which waits for a process to exit (doesn't consume any processor time, uses WaitForSingleObject):<br />
FindProcDLL::WaitProcEnd &quot;myprog.exe&quot; -1 the second parameter is timeout, if it is reached, the function returns 100 and doesn't wait for the process (recommended value is -1); <br />
 if there was no process to wait for, 0 is returned, if successfully waited, returns 1<br />
<br />
- added function WaitProcStart, which waits until a certain process start (very processor-intensive, timeout is this time used for the polling interval, set at least 250 ms, 500 is better)<br />
FindProcDLL::WaitProcStart &quot;myprog.exe&quot; 300<br />
 returns 0 on success<br />
<br />
- plugin size is 3.5 kB ;)<br />
 <br />
 All returned values go to $R0, just like in the standard version. I will likely upgrade it soon, if and when I encounter any bugs. Let me know if you find something.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hnedka</div><div class="date">3rd June 2011, 10:58</div></div><div class="posttext">Updated the file from the previous post. Can't edit it now, waits for authorization.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PoRtAbLe_StEaLtH</div><div class="date">9th September 2012, 21:13</div></div><div class="posttext">Updated the file from the previous post. Can't edit it now, waits for authorization.<br />
<br />
i have been struggling with this for a few weeks now.. originally.. i thought it was due to CreateMuteX. .. your MOD fixed it!!!!<br />
<br />
what a relief :)<br />
<br />
thank you sooo much for sharing .. i couldn't have done it .. <br />
<br />
P.S.<br />
hnedka's MOD deserves it's own Wiki page ! :up:</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>