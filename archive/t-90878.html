<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Extension DLL for OS, DLL and file version information, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Extension DLL for OS, DLL and file version information NSIS Discussion" />
	
	<title> Extension DLL for OS, DLL and file version information [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Extension DLL for OS, DLL and file version information</div>
<hr />
<div class="pda"><a href="t-90878.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=90878">Extension DLL for OS, DLL and file version information</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Sunjammer</div><div class="date">13th June 2002, 02:16</div></div><div class="posttext">This is something I put together for my own use but that other people might find useful. It's an extension dll that can get things like the Service Pack number installed on the system, the Windows build number, all kinds of version information from DLLs and exe files (the sort of thing you see on the Version tab of the file properties dialog in Windows 2000.<br />
<br />
You can find it on my NSIS web page with my other dlls here :<br />
<br />
http://www.clantpa.co.uk/nsis/<br />
<br />
There is a demo .nsi file with it that dumps lots of information into the detail view about the system and about two files I chose to look at, batmeter.dll (which does not support the DllGetVersion mechanism) and comctl32.dll (which does). Its quite dumb, it expects them to be in c:\winnt\system32 and if they're not you'll get blank strings back for those files.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cjs</div><div class="date">12th November 2003, 22:26</div></div><div class="posttext">Is this script still availible? If someone has a copy around please email me at<br />
<br />
cs@micadmarine.com</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th November 2003, 22:30</div></div><div class="posttext">This has been replaced by the Archive which is open source. You can find the source code in CVS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cjs</div><div class="date">12th November 2003, 22:32</div></div><div class="posttext">What I was looking to accomplish was a getwindowsversion with service pack information. <br />
<br />
If service pack is not greater then or equal to sp3 then report a message to the user. otherwise, continue installation. <br />
<br />
How would I do that using getwindowsversion function?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th November 2003, 22:33</div></div><div class="posttext">Oh, oops... Thought this message was about the original NSIS Archive. The plug-in you are talking about is available in the Archive with an example script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cjs</div><div class="date">12th November 2003, 22:37</div></div><div class="posttext">The example looks too complicated! How would I run a comparison value based on the output of &quot;getwindowsversion&quot;<br />
<br />
thanks alot for your help, you guys are the best. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th November 2003, 22:42</div></div><div class="posttext">Like everything else in NSIS, using StrCmp or IntCmp. IntCmp is probably the on you are looking for because it can test if it's greater or smaller and not just different. As for specific values to compare to, you'd have to find it out on your own unless someone else has the answer.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>