<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to check to see if folder is shared., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to check to see if folder is shared. NSIS Discussion" />
	
	<title> How to check to see if folder is shared. [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to check to see if folder is shared.</div>
<hr />
<div class="pda"><a href="t-206888.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=206888">How to check to see if folder is shared.</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jfellis</div><div class="date">4th February 2005, 22:38</div></div><div class="posttext">Hi,<br />
<br />
I know how to use: <br />
nsExec::Exec 'net share myfolder=$ccPath'<br />
<br />
to set myfolder to share, but is there a way to check to see if it is already shared?<br />
<br />
Thanks.  I am having great fun with NSIS!!<br />
<br />
John</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">5th February 2005, 02:30</div></div><div class="posttext">u could call NetShareEnum with the system plugin (there are differences between 9x and nt)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">5th February 2005, 17:45</div></div><div class="posttext">Here's another possibility that I should work consistantly in the different versions of windows.  (This is assuming that the output remains consistant with the different versions of Windows)<br />
<br />
 nsExec::ExecToStack 'Net Share' <br />
<br />
Then, you could create a function that takes the output off the top of the stack to find out the folders that are currently shared.<br />
<br />
I did a quick test and I can get the output OK, so at least in theory, it should work. (Just don't forget that the top of the stack will be the return value.  The 2nd item on the stack will be the actual output.)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>