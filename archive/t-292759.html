<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" see if application is running, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  see if application is running NSIS Discussion" />
	
	<title> see if application is running [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  see if application is running</div>
<hr />
<div class="pda"><a href="t-292759.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=292759">see if application is running</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MTec007</div><div class="date">5th June 2008, 11:48</div></div><div class="posttext">how do i check to see if my application is running if the title changes? ie it will always start with &quot;Something.. yeah.&quot; but after that i dont know what it will be.<br />
<br />
!define WNDCLASS &quot;ThunderRT6FormDC&quot;<br />
!define WNDTITLE &quot;Something.. yeah.&quot;<br />
  FindWindow $0 &quot;${WNDCLASS}&quot; &quot;${WNDTITLE}&quot;<br />
  StrCmp $0 0 continueInstall<br />
    MessageBox MB_ICONSTOP|MB_OK &quot;The application you are trying to extract is running. Close it and try again.&quot;<br />
    Abort<br />
  continueInstall:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">5th June 2008, 12:45</div></div><div class="posttext">if you're the author of the application, one solution would be  to add a DDE server to your application, so you can check if it's running, and even make it close<br />
(just like MS Office apps do to command running instance instead of starting a new one)<br />
<br />
see my plugin http://wiz0u.free.fr/prog/nsisDDE/<br />
for how to manipulate DDE commands</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MTec007</div><div class="date">5th June 2008, 13:02</div></div><div class="posttext">I don't really want to go in that direction, adding a DDE server only for the use of the installer? shouldn't there be a better way?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">5th June 2008, 13:34</div></div><div class="posttext">&quot;adding a DDE server&quot; is only a matter of responding to 3 Windows messages, it's not a big overhead, and if you're under MFC it's trivial.<br />
<br />
If you can't use FindWindow or you want to give an order to a running instance, DDE is the most adequate solution I've come up with, compared to other forms of inter-process communications.<br />
<br />
Other solutions could be to enumerate running processes or to have the running program write its &quot;running state&quot; in the registry but these solutions have flaws (what if the executable has been renamed, or the process was killed, ...)<br />
<br />
So the better is to have some cooperation from the running instance, hence the interprocess communication solution</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">5th June 2008, 14:56</div></div><div class="posttext">http://nsis.sourceforge.net/FCT_plug-in with /WTP option if your plan is to close application.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">5th June 2008, 16:59</div></div><div class="posttext">note that FCT uses WM_CLOSE <br />
and that WM_CLOSE is not always a correct way to close an application gracefully<br />
<br />
see http://blogs.msdn.com/oldnewthing/archive/2008/04/21/8413175.aspx for more info<br />
<br />
&quot;what if the app reacts by minimizing instead, or by displaying a 'save file?' popup..&quot; <br />
<br />
(here, FCT kills the process)<br />
<br />
but if MTec007 is the author of the app, he should be able to tell if this approach is acceptable</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MTec007</div><div class="date">5th June 2008, 21:34</div></div><div class="posttext">I don't need anything fancy. I don't need to close my application. The user is capable. Does NSIS support some kind of wildcard/regex/anything that I can use to make the code in my original post work?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">5th June 2008, 22:18</div></div><div class="posttext">If you know the possible title changes, this might work:<br />
Function FindWindow<br />
<br />
      FindWindow $R1 &quot;${WNDCLASS}&quot; &quot;Something.. yeah.&quot;<br />
      ${Unless} $R1 = 0<br />
         MessageBox MB_ICONSTOP|MB_OK \<br />
         &quot;The application you are trying to extract is running. Close it and try again.&quot;<br />
         Abort<br />
      ${EndUnless}<br />
      FindWindow $R1 &quot;${WNDCLASS}&quot; &quot;Something different.. yeah.&quot;<br />
      ${Unless} $R1 = 0<br />
         MessageBox MB_ICONSTOP|MB_OK \<br />
         &quot;The application you are trying to extract is running. Close it and try again.&quot;<br />
         Abort<br />
      ${EndUnless}<br />
      FindWindow $R1 &quot;${WNDCLASS}&quot; &quot;Something completely different.. yeah.&quot;<br />
      ${Unless} $R1 = 0<br />
         MessageBox MB_ICONSTOP|MB_OK \<br />
         &quot;The application you are trying to extract is running. Close it and try again.&quot;<br />
         Abort<br />
      ${EndUnless}<br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MTec007</div><div class="date">6th June 2008, 22:59</div></div><div class="posttext">i only know that it will begin with &quot;Something.. yeah.&quot; all change will be after that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th June 2008, 14:24</div></div><div class="posttext">In which case you need to use EnumWindows API; or just use FCT plug-in as already mentioned which allows window title part.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MTec007</div><div class="date">8th June 2008, 14:10</div></div><div class="posttext">how do i use enumwindows?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">8th June 2008, 20:14</div></div><div class="posttext">or use FindProcDLL; if you can reasonably assume that the process executable name doesn't change; I've had to use this for an application we install for; sometimes its process exists (and DLL files are thusly locked and can't be overwritten) while the Window is not yet in existence or has already closed (but the process not yet exited).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">9th June 2008, 13:01</div></div><div class="posttext">That plug-in does not work on Vista apparently. The System plug-in has an example of using EnumChildWindows which can be modified to use EnumWindows:<br />
http://nsis.sourceforge.net/Docs/System/System.html#callback<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MTec007</div><div class="date">9th June 2008, 14:26</div></div><div class="posttext">Afrow UK: can you give any elaboration? that code is way beyond my comprehension of NSIS' scripting language</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>