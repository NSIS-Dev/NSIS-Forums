<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Unexpected $PLUGINSDIR directory launch, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Unexpected $PLUGINSDIR directory launch NSIS Discussion" />
	
	<title> Unexpected $PLUGINSDIR directory launch [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Unexpected $PLUGINSDIR directory launch</div>
<hr />
<div class="pda"><a href="t-220243.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=220243">Unexpected $PLUGINSDIR directory launch</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">29th June 2005, 17:59</div></div><div class="posttext">At the end of my installer script, I am using ExecShell to open a file downloaded to the $PLUGINSDIR with:<br />
ExecShell &quot;open&quot; '&quot;$PLUGINSDIR\${FILENAME}.mov&quot;'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">29th June 2005, 18:55</div></div><div class="posttext">Try just:<br />
ExecShell &quot;open&quot; &quot;$PLUGINSDIR\${FILENAME}.mov&quot;<br />
<br />
What is ${FILENAME} at that time (check with a MessageBox for example).<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">29th June 2005, 20:36</div></div><div class="posttext">Ok, I think I finally narrowed it down...<br />
;<br />
If I disable every occurence of 'setoutpath' execept for the mySpash Function below, the unexpected directory launch is the last setoutpath command in the function...$DESKTOP in this case.<br />
;<br />
If I disable ALL setoutpath commands, the project directory [where the exe is compiled] unexpectedly launches...<br />
Is there a way to suppress these directory launches ?<br />
strange bug...<br />
;<br />
Function mySplash<br />
InitPluginsDir<br />
SetOutPath &quot;$PLUGINSDIR&quot;<br />
File /oname=$PLUGINSDIR\splash.bmp &quot;${FILENAME}.bmp&quot;<br />
advsplash::show 1500 600 400 0xFFFFFF $PLUGINSDIR\splash.bmp<br />
Pop $0<br />
Delete $PLUGINSDIR\splash.bmp<br />
SetOutPath &quot;$DESKTOP&quot;<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">29th June 2005, 20:47</div></div><div class="posttext">Could you attach your script?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">30th June 2005, 00:25</div></div><div class="posttext">it is a bit long, but the main function that seems to be causing/controlling the directory launch is mySplash..<br />
Editing the setoutpath location on the last line of the function will control which directory launches.<br />
;<br />
if I disable the mySplash function, then the directory of the compiled exe launches<br />
;<br />
Also, the directory launch only occurs on a full install located in 'Section &quot;FullInstall&quot; SecDummy'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th June 2005, 13:50</div></div><div class="posttext">I noticed this:<br />
Function InstallQuickTimeFromDVD<br />
    ExecWait '&quot;$qtInstallerLoc&quot;'<br />
FunctionEnd<br />
Could this be it?<br />
<br />
Edit: Nevermind, that's a website URL.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th June 2005, 13:53</div></div><div class="posttext">I noticed that you're using a s**t load of variables. These can take up a lot of memory on run time, and a lot of them could easily have been used as !define's instead (which are only used on compile-time.)<br />
<br />
The only thing that could possibly be causing this is the double quotes on all the exec's (e.g. '&quot;file.ext&quot;'. This isn't necessary. Try changing them all.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">30th June 2005, 16:28</div></div><div class="posttext">thanks Afrow :)<br />
I'll give it a try<br />
thanks for taking a look<br />
yes, the variables got a bit out of control on this project<br />
If I use this one as a shell for another project, I'll be slashing and burning as far as variables go<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">30th June 2005, 18:50</div></div><div class="posttext">changed all exec commands to :<br />
ExecWait '$R0'<br />
or<br />
ExecShell 'open' '$R0'<br />
<br />
is there anything else that could be causing the directory launch</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th June 2005, 19:02</div></div><div class="posttext">I couldn't find anything. Could you make a cut down version of your script which we can test that produces the problem. We can't test the current one because we don't have the files and stuff to go with it.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">30th June 2005, 19:13</div></div><div class="posttext">thanks Afrow :)<br />
let me see what I can come up with<br />
might be better for me to zip the whole project which is fairly small as all the major stuff is downloaded from the server<br />
I'll include the extra plugins too...<br />
and give a link to the .zip'd project</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">30th June 2005, 19:20</div></div><div class="posttext">Yeh that will work also :)<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">1st July 2005, 01:08</div></div><div class="posttext">Hi Afrow :)<br />
I sent you a private message with a project link<br />
thanks for taking a look as I am very stumped<br />
<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st July 2005, 11:05</div></div><div class="posttext">You mean e-mail or on here... I haven't got any new PM's.<br />
I'm currently at college (no NSIS compiler here!) I'll be getting home about 7GMT tonight so I'll take a good look then.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">1st July 2005, 17:57</div></div><div class="posttext">yes, I sent you a priave email on this discussion board<br />
I'll send you another one just in case.<br />
;<br />
what are you studying ?  College for me was about 10 years ago...Got so burned out after graduation, I could not enjoy reading books for 1 year. Kind of sad.<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">1st July 2005, 20:26</div></div><div class="posttext">Pure maths, business, accounting and computing.<br />
<br />
So when is the directory actually launched?<br />
<br />
There's a lot of warnings after compile. You might want to check them all out.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">1st July 2005, 22:02</div></div><div class="posttext">;Pure math<br />
Differential equations and such ?<br />
I got a Finance Economics BS...and then became a professional composer for TV commercials..strange paths<br />
at least, my degree made me lose my fear of numbers for writing budgets. <br />
;<br />
I checked the warnings out. At first glance, it seems none of them would cause a window launch. Most of them are from the writeXML.nsh file which is a bit older and needs house cleaning. I removed the writeXML.nsh to see if its functions were causing the problem.  Directory still launches :(<br />
;<br />
The directory launches ONLY on a Full Install where the 3rd party installer QuickTimeInstaller.exe is executed.  On the  final ExecShell: <br />
ExecShell 'open' '$PLUGINSDIR\${FILENAME}.mov' on line 437 in the function 'FullInstall' in the .nsi file, the window launches...Wierd<br />
;<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd July 2005, 00:08</div></div><div class="posttext">What happens if the ExecShell line is commented out?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">2nd July 2005, 01:04</div></div><div class="posttext">the directory still launches :(<br />
;<br />
If I disable the launch of the 3rd party installer, , ExecWait '$PLUGINSDIR\QuickTimeFullInstaller.exe' $0<br />
the directory does NOT launch.<br />
;<br />
Strangely, the 3rd Party Installer is not asking for a SPECIFIC directory launch as the last setoupath command controls which directory pops up<br />
;<br />
is there some system call that would supress the launch ?<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">2nd July 2005, 12:32</div></div><div class="posttext">SetOutPath will be setting the working directory for QuickTimeFullInstaller.exe<br />
Try placing SetOutPath &quot;&quot; before the ExecWait instruction.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">2nd July 2005, 17:59</div></div><div class="posttext">If I clear the Working Directory,the $EXEDIR directory pops up. <br />
Seems like the option at this point is to redesign the 3rd party installer and combine it with my NSIS installer :( I guess it is too much for a billion dollar company to make a decent installer package. In my experience, Apple is pretty consistently at war with its own developers.<br />
;<br />
Is there some way to 'listen' for a directory launch call and squash it before it executes? Maybe, a system command can save the day. Otherwise, I'll have to open up another can of worms.<br />
;<br />
thanks for walking me thru the debug,Afrow :)<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd July 2005, 19:43</div></div><div class="posttext">What about setting the working dir to a folder that doesnt exist or a invalid directory name? (Not sure if SetOutPath catches this, if it does u could call the raw api)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">3rd July 2005, 01:51</div></div><div class="posttext">will try the above :)<br />
Also, the directory only launches in Win2000 and 98<br />
For XP, everything works just fine..<br />
weird<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">3rd July 2005, 17:19</div></div><div class="posttext">I setoutpath'd to &quot;blah\blah\nonextistent&quot;<br />
seems the command was ignored<br />
;<br />
strangely, when I setoutpath to the above, the installer waited an extra 2 seconds before it launched the directory<br />
maybe it was thinking ;)<br />
;<br />
At this point, if faced with this kind of thing, would you guys create your own distribution of a major piece of software? Wonder if there are any legalities lurking there ?  Or, would you roll with bug and use the opened directory to house a ReadMe file and some goodies...<br />
g</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">4th July 2005, 09:07</div></div><div class="posttext">Don't forget that SetOutPath will recursively create the path that you give it, so giving it a bad path might confuse it! Or it will create the directory path in the root.<br />
<br />
Sounds like it's the QuickTimeFullInstaller.exe at fault here. What if you make it run another executable... does a folder still open?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grahama</div><div class="date">4th July 2005, 18:32</div></div><div class="posttext">I narrowed it down to ANOTHER executable ,QTPluginInstaller.exe, called WITHIN QuicktimeFullInstaller.exe. <br />
;<br />
As long as QTPluginInstaller.exe is run, the working directory will launch.  Thankfully, the problem is only for 2000/98 and does not happen on XP.<br />
;<br />
If I can't get a response from Apple/QuickTime a week after this week's holiday, I'll redesign the installer. Sometimes Apple responds quickly, and sometimes they do not respond at all despite repeated attempts. <br />
;<br />
Thankfully, I have an exe that converts reg values to a nsis script...so it should not be too hard.  Lots of files and reg values...<br />
;<br />
Maybe this is a good thing.... <br />
Executing 3rd party installer within a main installer is kind of kludgy anyway and looks a bit ugly.<br />
g</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>