<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Annotation, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Annotation NSIS Discussion" />
	
	<title> Annotation [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Annotation</div>
<hr />
<div class="pda"><a href="t-304368.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=304368">Annotation</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">congahonga</div><div class="date">19th March 2009, 10:39</div></div><div class="posttext">I a lot of DOS comands, so i don't want to make for every command a batch-file with &quot;pause&quot;, and later switch back to exec without batch-files. So, i search for a trick to make every ExecWait command output &quot;visible&quot; with a small extra command...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">19th March 2009, 15:37</div></div><div class="posttext">There may be another way, but if it where me, I might consider something like this:<br />
<br />
Make your calling methods into a macro and place it in it's own header file (*.NSH).<br />
<br />
Then, when you want to switch, you only need to rewrite your macro.  (Your main script code could remain the same; you'd just switch header files.)<br />
<br />
<br />
Examples of a macro:; Dos window<br />
!macro ExecMyCommand CustomExec command param<br />
   Exec 'cmd.exe /c &quot;${command}&quot; ${param}'<br />
!macroend<br />
<br />
; no window<br />
!macro ExecMyCommand CustomExec command param<br />
   nsExec::ExectoLog 'cmd.exe /c &quot;${command}&quot; ${param}'<br />
!macroend<br />
Then in your main script:<br />
!include myheader.nsh<br />
...<br />
!insertmacro ExecMyCommand &quot;myfile.bat&quot; &quot;/d /a=p&quot;<br />
 <br />
<br />
You could also tweak your macro to have both methods and insert the proper one based on another define.  like:!ifdef debug<br />
  ; define old macro<br />
!else<br />
  ; define new macro<br />
!endif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AaronLS</div><div class="date">21st March 2009, 04:12</div></div><div class="posttext">I'm not sure what your goal is, but I use ExecToStack for running command line/console mode tools during installation.  This allows you access to everything that appeared in the console, as well as the return code.  You could display this in a message box or log it to a file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">congahonga</div><div class="date">23rd March 2009, 10:40</div></div><div class="posttext">I found another VERY EASY way !<br />
<br />
Instead of<br />
<br />
ExecWait &quot;setsu.exe $3 -s StandardUser -m KWO -d operational&quot;<br />
<br />
which doesn't prompt, even if an error occurs. <br />
<br />
I use<br />
<br />
ExecWait &quot;cmd /c pause | setsu.exe $3 -s StandardUser -m KWO -d operational&quot;<br />
<br />
(setsu.exe is a special command as a file, that i use)<br />
<br />
The trick is, that &quot;cmd /c&quot; means for the shell: execute only ONE command, then close.<br />
<br />
&quot;pause | setsu.exe&quot; is a piped command (so it's in fact one command, even if it looks like two commands)<br />
<br />
This is a trick to add a pause to every Shell-Command.<br />
<br />
Attention: is not &quot;&lt;command&gt; | pause&quot;, it's vice versa like above<br />
<br />
I try to combine this trick with dependend compiling, so you can set one compiler directive and the output stops with pause (while developing) and you can cancel this function with one compiler directive !<br />
<br />
When i found it out, i post it here for YOU ALL!<br />
<br />
by the way: look in wikipedia for &quot;cmd&quot; there a quit a lot of very nice parameters, to expend shell functionalities. Perhaps you will need that !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">congahonga</div><div class="date">23rd March 2009, 12:32</div></div><div class="posttext">Now you can switch between debug-mode with a break, and release mode without a break !<br />
I didn't usw compiler-directives, I use an normal variable called DEBUG, that makes it.<br />
<br />
Please reply my post, if you like my &quot;dirty trick&quot;, because i want to find out, if i found out a good trick, or a bad one... :-)<br />
<br />
------------------------------------------------------------<br />
Name &quot;Test&quot;<br />
OutFile &quot;Test.exe&quot;<br />
<br />
!include LogicLib.nsh<br />
<br />
VAR cmd_prefix<br />
VAR DEBUG<br />
<br />
Page instfiles<br />
<br />
Section <br />
<br />
# 1 for debug-mode, 0 for release without breaks<br />
push 1<br />
pop $DEBUG<br />
<br />
${If} $DEBUG == 0<br />
       StrCpy $cmd_prefix &quot;cmd /c&quot;<br />
${else}<br />
       StrCpy $cmd_prefix &quot;cmd /c pause |&quot;<br />
${endif}<br />
<br />
ExecWait &quot;$cmd_prefix echo 1.Command simulated with echo&quot;<br />
<br />
ExecWait &quot;$cmd_prefix echo 2.Command simulated with echo&quot;<br />
<br />
SectionEnd</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>