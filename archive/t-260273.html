<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Version check against currently installed version, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Version check against currently installed version NSIS Discussion" />
	
	<title> Version check against currently installed version [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Version check against currently installed version</div>
<hr />
<div class="pda"><a href="t-260273.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=260273">Version check against currently installed version</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Nniol</div><div class="date">24th November 2006, 11:56</div></div><div class="posttext">Hi,<br />
<br />
HOw would you access the Exe currently within the archive so that it can have its version checked against a currenlty installed version so that versions are not overwritten with a prior or equivalent versiobn<br />
<br />
Nniol</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th November 2006, 12:01</div></div><div class="posttext">Use GetDllVersionLocal to get the version information of a local file on the build system. See Include\Library.nsh for a usage example.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nniol</div><div class="date">24th November 2006, 12:04</div></div><div class="posttext">I can get the version on the local system, but having trouble with GetFileVersion error in macro line 5.....<br />
<br />
I need to access the FileVersion of the executable within the archive...<br />
<br />
Nniol</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th November 2006, 12:05</div></div><div class="posttext">What macro? Are you talking about a file inside another archive and not your installer? You'd have to extract it first.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nniol</div><div class="date">24th November 2006, 12:06</div></div><div class="posttext">NO... the executable is whithin my install, I need to make sure that its version is greater than the currently installed version....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nniol</div><div class="date">24th November 2006, 12:17</div></div><div class="posttext">Is GetDllLocalVesion what I require</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th November 2006, 12:19</div></div><div class="posttext">The executable in your install could only come from your local machine. Therefore, using GetDllVersionLocal should provide you with the correct version details. Include\Library.nsh provides a perfect usage example for your case, comparing the versions of a local file, also bundled in the installer, and a file on the user's system.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nniol</div><div class="date">24th November 2006, 12:33</div></div><div class="posttext">Do I need to have added it using File first?<br />
<br />
I have my script in a root directory and then all files to be installed are in a child directory called Install.<br />
<br />
However<br />
<br />
GetDllVersionLocal &quot;Install\$ServiceExeName&quot; $R0 $R1 <br />
<br />
Can not find the executable..<br />
<br />
The command I use later on to add all the files to the Archive is:<br />
	File /r .\Install\*.*<br />
<br />
Nniol</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th November 2006, 12:36</div></div><div class="posttext">There's no need to include the file in order to get its version. The problem in your script is that you use a variable in a compile time command. The compiler can't possibly know what $ServiceExeName will contain at runtime. Use the real file name, without any variables.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>