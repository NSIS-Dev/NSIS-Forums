<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Can't register dll and ocx, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Can't register dll and ocx NSIS Discussion" />
	
	<title> Can't register dll and ocx [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Can't register dll and ocx</div>
<hr />
<div class="pda"><a href="t-221853.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221853">Can't register dll and ocx</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Romka</div><div class="date">19th July 2005, 09:32</div></div><div class="posttext">Please help!<br />
I try to register DLL and OCX:<br />
<br />
!insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED msvcr70.dll $SYSDIR\msvcr70.dll $SYSDIR<br />
<br />
Compile log:<br />
<br />
!insertmacro: InstallLib<br />
warning: unknown variable/constant &quot;ALREADY_INSTALLED&quot; detected, ignoring (macro:InstallLib:49)<br />
!insertmacro: end of InstallLib<br />
SectionEnd<br />
<br />
Installation log:<br />
<br />
Can’t find symbol: DllRegisterServer<br />
<br />
DLL copy into sysdir but not register. What I do wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">19th July 2005, 10:35</div></div><div class="posttext">Var ALREADY_INSTALLED<br />
!insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED msvcr70.dll $SYSDIR\msvcr70.dll $SYSDIR</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">19th July 2005, 12:00</div></div><div class="posttext">&quot;Var&quot; instruction has to be outside sections and functions and prefferably at the top of your script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Romka</div><div class="date">19th July 2005, 15:36</div></div><div class="posttext">Thanks!<br />
Var ALREADY_INSTALLED is working.:)<br />
But Installation log:<br />
           Can’t find symbol: DllRegisterServer:( <br />
One more questions please!:rolleyes:<br />
I can’t find in user manual how to register fonts files(*.ttf).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th July 2005, 20:46</div></div><div class="posttext">That means the DLL shouldn't be registered. For fonts, search the forum and the wiki.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">20th July 2005, 05:15</div></div><div class="posttext">In your first example, you mention the file 'msvcr70.dll'.  <br />
<br />
This is a file included with MS .NET Framework, which I'm fairly certain is protected by Windows File Protection.  This means that the only way you'd be able to install it is via Microsoft's own installation (or Windows installer merge module).<br />
<br />
Or I could be wrong...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JCD29</div><div class="date">15th November 2005, 23:44</div></div><div class="posttext">you can use : upgradeDLL<br />
!insertmacro UpgradeDLL XXX.dll &quot;$PROGRAMFILES\XXX.dll&quot; &quot;$INSTDIR\Temp&quot;<br />
<br />
this macro exists in example given by the NSIS installer</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>