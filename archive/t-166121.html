<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" No Uninstall Confirm Page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  No Uninstall Confirm Page NSIS Discussion" />
	
	<title> No Uninstall Confirm Page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  No Uninstall Confirm Page</div>
<hr />
<div class="pda"><a href="t-166121.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=166121">No Uninstall Confirm Page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jaschulz</div><div class="date">22nd January 2004, 16:50</div></div><div class="posttext">The code below compiles and runs but does not show the UNCONFIRM page:<br />
<br />
  ;create the uninstaller<br />
  !define MUI_WELCOMEPAGE_TITLE &quot;Uninstall: ${PRODUCT} ${VERSION}&quot;<br />
  !define MUI_WELCOMEPAGE_TEXT &quot;This wizard will guide you through the uninstall process for \<br />
    ${COMPANY}'s ${PRODUCT} software.\r\n\r\n\Click Next to begin.&quot;<br />
  !insertmacro MUI_UNPAGE_WELCOME<br />
  !define MUI_UNCONFIRMPAGE_TEXT '&quot;This process will uninstall ${PRODUCT} ${VERSION} from the folder shown below:&quot;\<br />
                                  &quot;Note: The ${PRODUCT} data files are NOT deleted by this process.$\r$\n$\r$\nPlease delete them $\&quot;manually$\&quot;.&quot;'<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_UNPAGE_INSTFILES<br />
  !define MUI_FINISHPAGE_TITLE &quot;Uninstall: ${PRODUCT} ${VERSION}&quot;<br />
  !define MUI_FINISHPAGE_TEXT &quot;Thank you for using ${company}'s\<br />
                               ${PRODUCT} software.&quot;<br />
  !insertmacro MUI_UNPAGE_FINISH<br />
  <br />
Furthermore, it I try to use:<br />
<br />
!define MUI_UNCONFIRMPAGE_TEXT_TOP (as described in the MUI read me) the compiler halts with an error on that line.  What am I doing wrong here?<br />
<br />
JAS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">22nd January 2004, 17:07</div></div><div class="posttext">Works fine for me. Using the latest version? Can you attach the entire script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jaschulz</div><div class="date">22nd January 2004, 17:30</div></div><div class="posttext">OK.  Here is the whole thing.  (I ran the update today, so it ought to be the latest version.  Do you get an compile error with MUI_UNCONFIRMPAGE_TEXT_TOP?)<br />
<br />
;NSIS Modern User Interface version 1.66<br />
;--------------------------------<br />
;Include Modern UI<br />
<br />
  !include &quot;MUI.nsh&quot;<br />
<br />
;--------------------------------<br />
;Configuration<br />
<br />
  ;General<br />
<br />
  Name &quot;Teaching Assistant&quot;<br />
  var DATAINSTDIR<br />
  !define VERSION &quot;v. 4.0&quot;<br />
  !define PRODUCT &quot;Teaching Assistant&quot;<br />
  !define ADDRESS &quot;PO Box 267870  Chicago, IL  60626-7870&quot;<br />
  !define SHORT_PRODUCT_NAME &quot;TA&quot;<br />
  !define COMPANY &quot;WiseWare&quot;<br />
  !define COPYRIGHT &quot;Copyright Â© 2003 by ${COMPANY}&quot;<br />
  !define MUI_HEADERBITMAP &quot;wwOWL.bmp&quot;<br />
  !define MUI_HEADERBITMAP_RIGHT<br />
  !define MUI_ICON &quot;..\ta.ico&quot;<br />
  !define MUI_UNICON &quot;..\unta.ico&quot;<br />
  Caption &quot;${PRODUCT} ${VERSION}  ${COPYRIGHT}&quot;<br />
  OutFile &quot;SetUp${SHORT_PRODUCT_NAME}.exe&quot;<br />
<br />
  ;Folder selection page<br />
<br />
  InstallDir &quot;$PROGRAMFILES\WiseWare\${PRODUCT}&quot;<br />
  <br />
  ;Get install folder from registry if available<br />
<br />
  InstallDirRegKey HKCU &quot;Software\WiseWare\${PRODUCT}&quot; &quot;&quot;<br />
<br />
;--------------------------------<br />
;Modern UI Configuration<br />
<br />
  !define MUI_ABORTWARNING<br />
<br />
;--------------------------------<br />
;Variables<br />
<br />
  Var STARTMENU_FOLDER<br />
  Var MUI_TEMP<br />
  <br />
;--------------------------------<br />
;Pages<br />
<br />
  ;create Welcome Page<br />
  !define MUI_WELCOMEPAGE_TITLE &quot;SetUp: ${PRODUCT} ${VERSION}&quot;<br />
  !define MUI_WELCOMEPAGE_TEXT &quot;This wizard will guide you through the installation of \<br />
  ${company}'s ${PRODUCT} software.\r\n\r\n\Click Next to begin the installation process.&quot;<br />
  !insertmacro MUI_PAGE_WELCOME<br />
  ;create License Page<br />
  !define MUI_LICENSEPAGE_CHECKBOX<br />
  !define MUI_LICENSEPAGE_CHECKBOX_TEXT &quot;I accept all the terms of the License Agreement.&quot;<br />
  !define MUI_LICENSEPAGE_TEXT_TOP &quot;Please review the all terms of the License Agreement: &quot;<br />
  !define MUI_LICENSEPAGE_TEXT '&quot;If you accept all the terms of the License Agreement, \<br />
  check the box below and then click CONTINUE \<br />
  to proceed with the installation.&quot; &quot;CONTINUE&quot;'<br />
  !define MUI_PAGE_HEADER_TEXT &quot;License Agreement&quot;<br />
  !define MUI_PAGE_HEADER_SUBTEXT &quot;${COMPANY} ${ADDRESS}&quot;<br />
  !insertmacro MUI_PAGE_LICENSE &quot;taLicense.txt&quot;<br />
  ;create Program Install Page<br />
  !define MUI_PAGE_HEADER_TEXT &quot;Program Install Location&quot;<br />
  !define MUI_DIRECTORYPAGE_TEXT '&quot;SetUp will install ${PRODUCT} in the Destination Folder \<br />
  shown below.$\r$\n$\r$\nTo select a different Destination Folder, Click Browse...&quot; \<br />
  &quot;Destination Folder: &quot;'<br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  !define MUI_DIRECTORYPAGE_VARIABLE $DATAINSTDIR<br />
  !define MUI_PAGE_HEADER_TEXT &quot;Data Install Location&quot;<br />
  !define MUI_PAGE_HEADER_SUBTEXT &quot;Choose the folder in which to install the ${PRODUCT} data files.&quot;<br />
  !define MUI_DIRECTORY_PAGE_TEXT_TOP &quot;SetUp will install the ${PRODUCT} data files in the Destination Folder \<br />
  shown below.$\r$\n$\r$\nTo select a different Destination Folder, Click Browse...&quot;<br />
  !insertmacro MUI_PAGE_DIRECTORY<br />
  <br />
  ;Start Menu Folder Page Configuration<br />
  !define MUI_STARTMENUPAGE_REGISTRY_ROOT &quot;HKCU&quot;<br />
  !define MUI_STARTMENUPAGE_REGISTRY_KEY &quot;Software\${PRODUCT}&quot;<br />
  !define MUI_STARTMENUPAGE_REGISTRY_VALUENAME &quot;Start Menu Folder&quot;<br />
<br />
  !insertmacro MUI_PAGE_STARTMENU Application $STARTMENU_FOLDER<br />
<br />
  !insertmacro MUI_PAGE_INSTFILES<br />
  !insertmacro MUI_PAGE_FINISH<br />
<br />
  ;create the uninstaller<br />
  !define MUI_WELCOMEPAGE_TITLE &quot;Uninstall: ${PRODUCT} ${VERSION}&quot;<br />
  !define MUI_WELCOMEPAGE_TEXT &quot;This wizard will guide you through the uninstall process for \<br />
    ${COMPANY}'s ${PRODUCT} software.\r\n\r\n\Click Next to begin.&quot;<br />
  !insertmacro MUI_UNPAGE_WELCOME<br />
  !define MUI_UNCONFIRMPAGE_TEXT '&quot;This process will uninstall ${PRODUCT} ${VERSION} from the folder shown below:&quot;\<br />
                                  &quot;Note: The ${PRODUCT} data files are NOT deleted by this process.$\r$\n$\r$\nPlease delete them $\&quot;manually$\&quot;.&quot;'<br />
  !insertmacro MUI_UNPAGE_CONFIRM<br />
  !insertmacro MUI_UNPAGE_INSTFILES<br />
  !define MUI_FINISHPAGE_TITLE &quot;Uninstall: ${PRODUCT} ${VERSION}&quot;<br />
  !define MUI_FINISHPAGE_TEXT &quot;Thank you for using ${company}'s\<br />
                               ${PRODUCT} software.&quot;<br />
  !insertmacro MUI_UNPAGE_FINISH<br />
  <br />
;--------------------------------<br />
;Languages<br />
 <br />
  !insertmacro MUI_LANGUAGE &quot;English&quot;<br />
  <br />
;--------------------------------<br />
;Installer Functions<br />
<br />
Function .onInit<br />
  ClearErrors<br />
  ReadRegStr $0 HKCU &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders&quot; Personal<br />
  StrCpy $DATAINSTDIR &quot;$0\${PRODUCT}&quot;<br />
  ClearErrors<br />
  BringToFront<br />
FunctionEnd<br />
<br />
;--------------------------------<br />
;Installer Sections<br />
<br />
Section &quot;Install&quot;<br />
<br />
;  SetRebootFlag True<br />
<br />
  ;Establish the Program/Help folder<br />
<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  <br />
  ;Extract the program<br />
  <br />
  File &quot;..\${SHORT_PRODUCT_NAME}.exe&quot;<br />
  File &quot;..\HTML Help\${SHORT_PRODUCT_NAME}.chm&quot;<br />
<br />
  ;Establish the Data folder<br />
<br />
  SetOutPath &quot;$DATAINSTDIR&quot;<br />
<br />
  ;Extract the data files<br />
<br />
  IfFileExists &quot;$DATAINSTDIR\ASGNMNTS.FF2&quot; querycopydatafiles<br />
  copydatafiles:<br />
  File &quot;..\ASGNMNTS.FF2&quot;<br />
  File &quot;..\CALENDAR.FF2&quot;<br />
  File &quot;..\COURSES.FF2&quot;<br />
  File &quot;..\HOLIDAYS.FF2&quot;<br />
  File &quot;..\PERSONS.FF2&quot;<br />
  File &quot;..\SCHEDULE.FF2&quot;<br />
  File &quot;..\SECTIONS.FF2&quot;<br />
  File &quot;..\STUDENTS.FF2&quot;<br />
  File &quot;..\SUBMSSNS.FF2&quot;<br />
  File &quot;..\TERMS.FF2&quot;<br />
  dontcopydatafiles:<br />
<br />
  ;Write the Registry Keys<br />
<br />
  WriteRegStr HKCU &quot;Software\WiseWare\${PRODUCT}&quot; &quot;&quot; $INSTDIR<br />
  WriteRegDWord HKCU &quot;Software\${COMPANY}\${PRODUCT}&quot; &quot;defaultLeft&quot; 0<br />
  WriteRegDWord HKCU &quot;Software\${COMPANY}\${PRODUCT}&quot; &quot;defaultTop&quot; 0<br />
  WriteRegDWord HKCU &quot;Software\${COMPANY}\${PRODUCT}&quot; &quot;ATTENDANCECURSOR&quot; 0<br />
  WriteRegDWord HKCU &quot;Software\${COMPANY}\${PRODUCT}&quot; &quot;GRADESCURSOR&quot; 0<br />
  WriteRegStr   HKCU &quot;Software\${COMPANY}\${PRODUCT}&quot; &quot;TERMSTART&quot; ''<br />
  WriteRegStr   HKCU &quot;Software\${COMPANY}\${PRODUCT}&quot; &quot;dataPath&quot; $DATAINSTDIR<br />
  WriteRegStr   HKCU &quot;Software\${COMPANY}\${PRODUCT}&quot; &quot;backupPath&quot; ''<br />
  WriteRegStr   HKCU &quot;Software\${COMPANY}\${PRODUCT}&quot; &quot;USERID&quot; ''<br />
  WriteRegStr   HKCU &quot;Software\${COMPANY}\${PRODUCT}&quot; &quot;USERRANK&quot; ''<br />
  WriteRegStr   HKCU &quot;Software\${COMPANY}\${PRODUCT}&quot; &quot;USERLASTNAME&quot; ''<br />
  WriteRegStr   HKCU &quot;Software\${COMPANY}\${PRODUCT}&quot; &quot;USERFIRSTNAME&quot; ''<br />
  WriteRegStr   HKCU &quot;Software\${COMPANY}\${PRODUCT}&quot; &quot;USERINITIAL&quot; ''<br />
  WriteRegStr   HKCU &quot;Software\${COMPANY}\${PRODUCT}&quot; &quot;USEROFFICE&quot; ''<br />
  WriteRegStr   HKCU &quot;Software\${COMPANY}\${PRODUCT}&quot; &quot;USERHOURS&quot; ''<br />
  WriteRegStr   HKCU &quot;Software\${COMPANY}\${PRODUCT}&quot; &quot;USERPHONE&quot; ''<br />
  WriteRegStr   HKCU &quot;Software\${COMPANY}\${PRODUCT}&quot; &quot;USEREMAIL&quot; ''<br />
  WriteRegStr   HKCU &quot;Software\${COMPANY}\${PRODUCT}&quot; &quot;USERWEBSITE&quot; ''<br />
<br />
<br />
  ;Add Application to Add/Remove Programs<br />
<br />
  WriteRegStr HKCU &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT}&quot; &quot;DisplayName&quot; '${PRODUCT}'<br />
  WriteRegStr HKCU &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT}&quot; &quot;UninstallString&quot; '&quot;$INSTDIR\uninstall${SHORT_PRODUCT_NAME}.exe&quot;'<br />
  WriteRegDWord HKCU &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT}&quot; &quot;NoModify&quot; 1<br />
  WriteRegDWord HKCU &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT}&quot; &quot;NoRepair&quot; 1<br />
  <br />
  goto done<br />
<br />
  ;Extract the data files<br />
<br />
  querycopydatafiles:<br />
  MessageBox MB_YESNO|MB_ICONQUESTION &quot;The TA data files already exists in:$\n$\r$\n$\r$DATAINSTDIR.$\n$\r$\n$\r\<br />
  Do you want to overwrite them?&quot; IDYES copydatafiles<br />
  goto dontcopydatafiles<br />
<br />
  done:<br />
<br />
<br />
  ;Create uninstaller<br />
  <br />
  SetOutPath &quot;$INSTDIR&quot;<br />
<br />
  WriteUninstaller &quot;$INSTDIR\Uninstall${SHORT_PRODUCT_NAME}.exe&quot;<br />
  <br />
  !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
<br />
    ;Create shortcuts<br />
    CreateDirectory &quot;$SMPROGRAMS\$STARTMENU_FOLDER&quot;<br />
    CreateShortCut  &quot;$SMPROGRAMS\$STARTMENU_FOLDER\Uninstall${SHORT_PRODUCT_NAME}.lnk&quot; &quot;$INSTDIR\Uninstall${SHORT_PRODUCT_NAME}.exe&quot;<br />
    CreateShortCut  &quot;$SMPROGRAMS\$STARTMENU_FOLDER\${SHORT_PRODUCT_NAME}.lnk&quot; &quot;$INSTDIR\${SHORT_PRODUCT_NAME}.exe&quot;<br />
<br />
  !insertmacro MUI_STARTMENU_WRITE_END<br />
<br />
SectionEnd<br />
<br />
;--------------------------------<br />
;Uninstaller Section<br />
<br />
Section &quot;Uninstall&quot;<br />
<br />
  ;Delete the program<br />
<br />
  Delete &quot;$INSTDIR\${SHORT_PRODUCT_NAME}.exe&quot;<br />
  <br />
  ;Delete the Help File<br />
<br />
  Delete &quot;$INSTDIR\${SHORT_PRODUCT_NAME}.CHM&quot;<br />
<br />
  ;Delete the uninstaller<br />
<br />
  Delete &quot;$INSTDIR\Uninstall${SHORT_PRODUCT_NAME}.exe&quot;<br />
  <br />
  ;Delete the install folder<br />
<br />
  RMDir &quot;$INSTDIR&quot;<br />
  <br />
  !insertmacro MUI_STARTMENU_GETFOLDER Application $MUI_TEMP<br />
<br />
  Delete &quot;$SMPROGRAMS\$MUI_TEMP\Uninstall${SHORT_PRODUCT_NAME}.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\$MUI_TEMP\${SHORT_PRODUCT_NAME}.lnk&quot;<br />
<br />
  ;Delete empty start menu parent diretories<br />
  StrCpy $MUI_TEMP &quot;$SMPROGRAMS\$MUI_TEMP&quot;<br />
<br />
  startMenuDeleteLoop:<br />
    RMDir $MUI_TEMP<br />
    GetFullPathName $MUI_TEMP &quot;$MUI_TEMP\..&quot;<br />
<br />
    IfErrors startMenuDeleteLoopDone<br />
<br />
    StrCmp $MUI_TEMP $SMPROGRAMS startMenuDeleteLoopDone startMenuDeleteLoop<br />
  startMenuDeleteLoopDone:<br />
<br />
  <br />
  ;Delete the registry keys<br />
<br />
  DeleteRegKey HKCU &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT}&quot;<br />
  DeleteRegKey /ifempty HKCU &quot;Software\WiseWare\${PRODUCT}&quot;<br />
  DeleteRegKey /ifempty HKCU &quot;Software\WiseWare&quot;<br />
<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">22nd January 2004, 18:07</div></div><div class="posttext">Please attach large scripts next time.<br />
<br />
It compiles fine and shows the uninstall confirm page (the page that shows the folder). This define for the top text also works fine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jaschulz</div><div class="date">22nd January 2004, 18:23</div></div><div class="posttext">Are you saying that when you run the uninstaller you see this text one one of the pages:<br />
<br />
**********<br />
<br />
Note: The Teaching Assistant data files are NOT deleted by this process.<br />
<br />
Please delete them &quot;manually&quot;.<br />
<br />
**********<br />
<br />
I see the welcome page, then the page with the folder, then the finish page, but on none of them do I see the text above (which appears in the script as: !define MUI_UNCONFIRMPAGE_TEXT '&quot;This process will uninstall ${PRODUCT} ${VERSION} from the folder shown below:&quot;\<br />
&quot;Note: The ${PRODUCT} data files are NOT deleted by this process.$\r$\n$\r$\nPlease delete them $\&quot;manually$\&quot;.&quot;')<br />
<br />
<br />
JAS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">22nd January 2004, 19:26</div></div><div class="posttext">The confirm page IS the page with the folder, that's how it's called. Make sure you set the define before the page macro.<br />
<br />
There is no MUI_UNCONFIRMPAGE_TEXT, only MUI_UNCONFIRMPAGE_TEXT_TOP.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jaschulz</div><div class="date">22nd January 2004, 20:03</div></div><div class="posttext">Now I am really confused.  My script compiles with<br />
<br />
MUI_UNCONFIRMPAGE_TEXT<br />
<br />
though it does not show the text in question<br />
<br />
If I use<br />
<br />
MUI_UNCONFIRMPAGE_TEXT_TOP<br />
<br />
the compiler gives the following error:<br />
<br />
!insertmacro: MUI_UNPAGE_CONFIRM<br />
UninstallText expects 1-2 parameters, got 17.<br />
Usage: UninstallText Text_to_go_on_uninstall_page [subtext]<br />
Error in macro MUI_UNPAGE_CONFIRM on macroline 22<br />
Error in script &quot;C:\Documents and Settings\James Schulz\My Documents\Code\Delphi\TEACHING ASSISTANT\NSIS\TeachingAssistant.nsi&quot; on line 94 -- aborting creation process</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">22nd January 2004, 20:12</div></div><div class="posttext">It will always compile if you choose a random name, it just does nothing with that setting.<br />
<br />
There are weird quotes in your MUI_UNCONFIRMPAGE_TEXT_TOP setting, try:<br />
!define MUI_UNCONFIRMPAGE_TEXT_TOP &quot;This process will uninstall ${PRODUCT} ${VERSION} from the folder shown below. Note: The ${PRODUCT} data files are NOT deleted by this process.$\r$\n$\r$\nPlease delete them $\&quot;manually$\&quot;.&quot;<br />
Note: Because of a minor flaw, do not break this text up in multiple lines for now. This will be fixed soon.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jaschulz</div><div class="date">23rd January 2004, 16:19</div></div><div class="posttext">OK.  I understand now.  I don't know much about compilers, and it never occurred to me that the NSIS compiler would simple ignore a line it didn't understand (without giving an error).  Thanks,<br />
<br />
JAS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">23rd January 2004, 16:51</div></div><div class="posttext">It does understand that lines, it sets the define MUI_UNCONFIRMPAGE_TEXT.<br />
<br />
However, the Modern UI does nothing with it.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>