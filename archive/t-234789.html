<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" LoadBitmap Problem, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  LoadBitmap Problem NSIS Discussion" />
	
	<title> LoadBitmap Problem [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  LoadBitmap Problem</div>
<hr />
<div class="pda"><a href="t-234789.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=234789">LoadBitmap Problem</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">5th January 2006, 14:44</div></div><div class="posttext">what i want to do:<br />
assign a custom bitmap to a static bitmap control on runtime, by loading it from any path.<br />
<br />
what's the problem:<br />
don't know the right usage for LoadImage / the correct values for IMAGE_BITMAP and LR_LOADFROMFILE params.<br />
<br />
[LoadPicture gives me error 1814 (Ressource not found in specified file), seems not to fit for this job]<br />
<br />
attached a full example script (you may take your own bitmap!) with custom page.<br />
<br />
plz have a look.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">5th January 2006, 16:30</div></div><div class="posttext">1. Bitmap load is correct, but first of all you need valid control handle. To get [Field 1] use<br />
   FindWindow $0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
   GetDlgItem $ctrlhandle $0 1200<br />
<br />
This works in my home 2.08, may be later versions put handle to INI file...<br />
2. Might be better to set Top and Left coordinates of control and not set Right and Bottom in the INI file. MSDN: &quot;SS_BITMAP The style ignores the nWidth and nHeight parameters; the control automatically sizes itself to accommodate the bitmap.&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">5th January 2006, 18:11</div></div><div class="posttext">1. you can indeed ommit that, as with latest installoptions the handle of the control is written to the ini file as HWND/HWND2 setting for each field.<br />
<br />
2. well, installoptions wont work without those settings :)<br />
the control will resize no matter what you tell it by the ini file.<br />
<br />
but thanx for your testing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">5th January 2006, 18:17</div></div><div class="posttext">seems not to work :(<br />
<br />
	ReadINIStr $0 &quot;$PLUGINSDIR\test3.ini&quot; &quot;Field 1&quot; &quot;HWND&quot;<br />
	System::Call &quot;user32::LoadBitmap (i r0, t '$PLUGINSDIR\test3.bmp') i .r1&quot;<br />
	SendMessage $0 0x0172 &quot;&quot; &quot;$1&quot;<br />
	SendMessage $0 0x000F &quot;&quot; &quot;&quot;<br />
	<br />
	MessageBox MB_OK &quot;$0, $1&quot;<br />
messagebox says: &lt;some number&gt;,error</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">5th January 2006, 18:20</div></div><div class="posttext">The LoadBitmap function loads the specified bitmap resource from a module's executable file.You cannot use it to load a bitmap from a .bmp file. For this, you must use LoadImage with the LR_LOADFROMFILE flag.<br />
<br />
See the following for an example:<br />
<br />
http://nsis.sourceforge.net/ModernUI_Mod_to_Display_Images_while_installing_files</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">5th January 2006, 18:36</div></div><div class="posttext">well, that was exactly what i ment and read from msdn, but takhir made me think otherwise...<br />
<br />
and regarding LR_LOADFROMFILE ... read my first post, i thought using this one at first ... :)<br />
<br />
anyway, thanx for the link, thats the solution! :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">5th January 2006, 19:15</div></div><div class="posttext">2 Comm@nder21: First of all I tested test3 with LoadImage() sample you included to zip and it worked (with my corrections for 2.08) both with 2 and 1 images (download or replace on Cancel click, I added second image and defined it in INI). This worked fine without Right and Bottom definitions in INI, but if these parameters were defined I found wrong position (and probably size) of bitmap/static control. And WM_PAINT usage in your script is wrong and not required.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">5th January 2006, 19:21</div></div><div class="posttext">Files attached. Image appeares on Cancel click.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">6th January 2006, 13:23</div></div><div class="posttext">I remember EBanner (http://nsis.sourceforge.net/EBanner_plug-in) plug-in I wrote last year :), it scales image and supports more formats (including png). Sample script attached (1 line to show image, but 'stop' call required at the end to remove it).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">7th January 2006, 12:37</div></div><div class="posttext">well, i found a much easier way once i had a look into MUI's system.nsh. :)<br />
<br />
from NSIS Docs:<br />
4.9.14.12 SetBrandingImage<br />
[/IMGID=item_id_in_dialog] [/RESIZETOFIT] path_to_bitmap_file.bmp<br />
Sets the current bitmap file displayed as the branding image. If no IMGID is specified, the first image control found will be used, or the image control created by AddBrandingImage. Note that this bitmap must be present on the user's machine. Use File first to put it there. If /RESIZETOFIT is specified the image will be automatically resized (very poorly) to the image control size. If you used AddBrandingImage you can get this size, by compiling your script and watching for AddBrandingImage output, it will tell you the size. SetBrandingImage will not work when called from .onInit!<br />
<br />
now as you may set any control id, this should work for every kind of loading bitmaps :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">7th January 2006, 13:13</div></div><div class="posttext">I tested AddBrandingImage some time ago, but big picture appeared on the HWNDPARENT field and was visible partly only. And I not continued with this option :) Good sample in Manual might be very usefull.<br />
BTW thanks for idea, I added 'partly known' window class name option to my find-close-terminate (http://nsis.sourceforge.net/FCT_plug-in) plug-in.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>