<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Drag and drop &quot;Delete on Reboot&quot; widget, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Drag and drop &quot;Delete on Reboot&quot; widget NSIS Discussion" />
	
	<title> Drag and drop &quot;Delete on Reboot&quot; widget [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Drag and drop &quot;Delete on Reboot&quot; widget</div>
<hr />
<div class="pda"><a href="t-215410.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=215410">Drag and drop &quot;Delete on Reboot&quot; widget</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">SenseiSimpleton</div><div class="date">8th May 2005, 22:25</div></div><div class="posttext">This is kinda going off the context of using NSIS for installers, but it has so many useful features that it can be used for so many other things.<br />
<br />
i want to make a simple app that deletes files that windows has locked, on reboot, in the following ways:<br />
<br />
1. Accepts files dragged onto the exe icon<br />
&gt; a large group of files or single file.. this runs the program and the programs tries to delete all the files using the /REBOOTOK switch.<br />
<br />
2. when you open the EXE, there is a small square drag-drop target window to which you can drag and drop files in the same way as above.<br />
<br />
3. Add a context menu item to all files (this part is easy enough) which lets you right click a stuck file and say &quot;delete on reboot&quot; (or simply &quot;Delete&quot;) and it takes the appropriate action (delete or delete on reboot).<br />
<br />
It's easy enough to just hardcode in the file to be deleted but how could it accept dragged files and translate that into their paths and subsequently loop through all the files and run the delete or take the command from context menu and get the file name of the file to be deleted?<br />
<br />
i havent been able to find anything about dragging and dropping onto an install (with good reason, i dont know why anyone would need that under normal circumstances.<br />
<br />
This is justa small personal project but any help would be much appreciated.. i'm sure many people would find this simple app very useful since windows has that nasty habit of keeping files which are no longer running locked, sometimes indefinitely.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th May 2005, 21:16</div></div><div class="posttext">The paths of files that are dragged onto an executable icon are passed on the command line. You should parse $CMDLINE to get them.<br />
<br />
Making the installer window itself a drop target would require  a plug-in. See this MSDN page (http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/programmersguide/shell_basics/shell_basics_programming/transferring/transfer.asp) for more information.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>