<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Progress Bar..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Progress Bar... NSIS Discussion" />
	
	<title> Progress Bar... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Progress Bar...</div>
<hr />
<div class="pda"><a href="t-214803.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=214803">Progress Bar...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">3rd May 2005, 16:21</div></div><div class="posttext">Hello all.<br />
<br />
I'm building a very small installer, that's only job is to extract a very large folder, silently.  The only thing I would like the user to see is a progress bar in the middle of the screen, like in a banner.  I'm looking at MSIBanner right now, but it looks like I have to update the progress bar manually.  Is there any way to have any kind of progress bar display during a silent install that will automatically update based on the progress of the FILE command within nsis?  Thanks all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobGrant</div><div class="date">3rd May 2005, 16:30</div></div><div class="posttext">I dunno if there's a neater way (someone else may know) but you could consider having some sort of callback:<br />
<br />
So instead of:<br />
<br />
File &quot;$INSTDIR\myFile.file&quot;<br />
<br />
<br />
Have:<br />
<br />
!macro addfile PATHANDFILE<br />
  File &quot;${PATHANDFILE}&quot;<br />
  ; Update banner by 1, somehow!<br />
!macroend<br />
<br />
!insertmacro addfile &quot;$INSTDIR\myFile.file&quot;<br />
<br />
<br />
I don't know how banner works exactly, but perhaps if you know how many files there are, you can tell it that, then use this to increment the number transferred. Just a thought.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">3rd May 2005, 19:08</div></div><div class="posttext">This below does what you want:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=175295&amp;highlight=Loading+Bar+UI<br />
<br />
This is not a plugin. With this, you'll need to create another installer for the window and put the code you want to be executed in its section.<br />
<br />
The process is the same as doing with the progress bar in the main installer window but with the customized UI. This UI crops the window in the second installer, making it show only the progress bar and the description of the current progress.<br />
<br />
You'll have to execute the second installer where you want the progress bar to appear.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">3rd May 2005, 23:39</div></div><div class="posttext">Thanks deguix for your tool, that works perfectly.  Just one question, I like the progress bar, and I like the current status (extracting blabla.dll), but can I add a title or some words that don't change?  Like &quot;Please wait while blabla extracts...&quot;, that stay up the whole time?  Thanks again!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">4th May 2005, 00:56</div></div><div class="posttext">Here's a possible solution:<br />
When extracting a file, use a &quot;SetDetailsPrint none&quot; command.  This supressress any messages from a file command, but leaves the previous message on the display.  The code for each file would be something like this:<br />
<br />
detail print &quot;Please wait while [filename] extracts...&quot;<br />
SetDetailsPrint none<br />
file &quot;C:\MyFile.exe&quot;<br />
SetDetailsPrint textonly<br />
<br />
<br />
If you wanted to make it easier, you could wrap the file extraction process into a function or macro to allow you to call it wherever you needed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">4th May 2005, 04:24</div></div><div class="posttext">Comperio, good to know about the SetDetailsPrint none command, thanks.  However would I lose the extract status then?  Is there a way to get both?  Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">4th May 2005, 07:15</div></div><div class="posttext">Hmmm... interesting. You're wanting to have a description and the extraction status at the same time... You'll need to edit the UI with Resource Hacker, add another label (for the description), and set the text of this label using &quot;SendMessage&quot; command when you want it. Maybe I should give an update to the old UI later. I still gotta do some other things right now...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jnuw</div><div class="date">4th May 2005, 19:54</div></div><div class="posttext">Originally posted by deguix <br />
Maybe I should give an update to the old UI later. I still gotta do some other things right now... <br />
Yeah, that would be great when you have a chance.  I love seeing the real-time status of whatâ€™s going on, but it would be nice to have a general message like, &quot;Please wait while your system is updated...&quot; or something like that.  Thanks!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>