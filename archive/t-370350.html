<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Installer Banner Being Stretched, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Installer Banner Being Stretched NSIS Discussion" />
	
	<title> Installer Banner Being Stretched [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Installer Banner Being Stretched</div>
<hr />
<div class="pda"><a href="t-370350.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=370350">Installer Banner Being Stretched</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kevingale</div><div class="date">6th September 2013, 18:55</div></div><div class="posttext">Hi.<br />
<br />
When we run our NSIS installer that uses MUI under Japanese and Korean systems the custom installer banner is being stretched. It is okay under English systems.<br />
<br />
Does anybody know the cause of this and how we can fix it?<br />
<br />
NOTE. We are using the Unicode version of NSIS so not sure if the problem is related to this version or is a generic NSIS issue.<br />
<br />
<br />
Thanks.<br />
Kev.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">7th September 2013, 05:08</div></div><div class="posttext">The different font for CJK will probably cause the dialog units to change. I believe there is a MUI define you can set to disable the stretching...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kevin_gale</div><div class="date">9th September 2013, 14:14</div></div><div class="posttext">Hi.<br />
<br />
Thanks for your reply.<br />
<br />
There is the &quot;MUI_WELCOMEFINISHPAGE_BITMAP_NOSTRETCH&quot; option but according to the documentation we should not use it if the images are the correct size (which we don't because they are).<br />
<br />
&quot;Do not stretch the bitmap for the Welcome and Finish page to fit the size of the field. Use this option only if you have an image that does not use the whole space. If you have a full size bitmap that fits exactly, you should not use this option because the size of the field will be different if the user has a custom DPI setting.&quot;<br />
<br />
<br />
I'll give this a go but I guess either the documentation is wrong or there is a bug somewhere.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">9th September 2013, 15:47</div></div><div class="posttext">Mui_headerimage_bitmap_nostretch?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kevin_gale</div><div class="date">11th September 2013, 10:22</div></div><div class="posttext">Using the nostretch options does solve the stretching problem. However, it has introduced the following issues:<br />
1. The welcome banner is now cropped even though the image is the correct size (we are missing quite a few pixels from the bottom).<br />
<br />
2. The header now has a grey bar at the bottom that runs from the end of the header image to the end of the dialog.<br />
<br />
<br />
I would attach some screen shot but every picture I try to attach is deemed as invalid even though they are the correct format (PNG / JPEG) and below the maximum file size.<br />
<br />
<br />
Kev.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">11th September 2013, 11:19</div></div><div class="posttext">PNG and JPEG are not supported! Use Windows bitmpa (.bmp) only.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kevin_gale</div><div class="date">11th September 2013, 13:33</div></div><div class="posttext">I've just tried a bmp image and that also has failed.<br />
<br />
The exact message is &quot;This is not a valid image file.&quot;.<br />
<br />
Not sure if this is related to my browser but I am using Firefox 23.01 under Mac OS X 10.8<br />
<br />
<br />
Kev.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">11th September 2013, 15:31</div></div><div class="posttext">I don't think there's need for screenshots anyway. You're getting an expected result and you even quoted the explanation yourself. Page elements are scaled with regard to dpi. The image is resized to fit the size of the field. If you disable stretching, the proportion to the rest of the page will not be maintained; the image will fill just a part of the field or be croppped if it's larger. That's why you shouldn't disable stretching.<br />
I'm guessing the cause of your initial problem is that with CJK fonts, which obviously have different dpi, the width and height of the header image are not scaled with the same factor and the aspect ratio gets distorted. If so, the only fix that springs to mind is to use a different image on those systems.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kevin_gale</div><div class="date">11th September 2013, 16:50</div></div><div class="posttext">Hi.<br />
<br />
I wish I could upload the screen shots as this seems like madness.<br />
<br />
In summary...<br />
<br />
1. If we allow the banners and headers to stretch then on CJK systems the height of images appears to be correct and only the width is stretched by some strange amount! Our images are the recommended sizes so I don't understand why any resizing should be occurring.<br />
<br />
2. If we do not allow the banners and headers to stretch then on CJK systems their proportions are correct but the banner is cropped at the bottom and a visual glitch appears to the right of the header all the way to the end of the dialog.<br />
<br />
<br />
Using different images for each language would be an unbelievably bad solution. For starters, we do not even know the dimensions that are required for each language and would the dimensions be the same for all operating systems?<br />
<br />
This is definitely one area of NSIS that could (should) be improved as it really limits it's use.<br />
<br />
<br />
<br />
Kev.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">11th September 2013, 17:28</div></div><div class="posttext">I believe 1. &amp; 2. are clear and I don't know how to explain it any better than I already have. <br />
My suggestion doesn't require you to use a separate image for each language, just one extra for CJK. It shouldn't be difficult to determine the appropriate dimensions. Then you can use something like this:<br />
!define MUI_CUSTOMFUNCTION_GUIINIT ChkCJK<br />
Function ChkCJK<br />
StrCmp $LANGUAGE ${LANG_JAPANESE} +2<br />
StrCmp $LANGUAGE ${LANG_KOREAN} 0 +3<br />
File /oname=$PLUGINSDIR\modern-header.bmp Header_CJK.bmp<br />
SetBrandingImage /IMGID=1046 /RESIZETOFIT &quot;$PLUGINSDIR\modern-header.bmp&quot;<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kevin_gale</div><div class="date">11th September 2013, 17:34</div></div><div class="posttext">I guess that is better than all languages but what is the recommended dimensions?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">11th September 2013, 18:01</div></div><div class="posttext">Those that fit the control. Use e.g. WinExplorer (http://www.nirsoft.net/utils/winexp.html) to examine Static controls on the page. The size of the header image control should normally be 150x57 (which is also the officially recommended bitmap size); check its dimensions with CJK.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kevin_gale</div><div class="date">11th September 2013, 18:11</div></div><div class="posttext">ok.<br />
<br />
This whole approach seems badly designed. There should be no reason why the images are scaled according to the font DPI.<br />
<br />
Is there any way to log enhancement requests?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">11th September 2013, 18:37</div></div><div class="posttext">You can disable the scaling, and you did, and you witnessed the effect, and you wanted to post screenshots of it...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kevin_gale</div><div class="date">11th September 2013, 19:18</div></div><div class="posttext">mmm.... we appear to be going around in circles here.<br />
<br />
My point is that NSIS should be displaying the images correctly when scaling is switched off. I do not see any reason why the bottom of the side banner should be clipped by a few pixels and for the header (not header image) to appear with a visual glitch.<br />
<br />
If it is 'by-design' then ok but the design of this needs improving (correcting) which is why I wanted to know if there was anywhere to log enhancements.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">11th September 2013, 19:21</div></div><div class="posttext">there's the bug tracker on sourceforge for the project.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kevin_gale</div><div class="date">13th September 2013, 17:33</div></div><div class="posttext">Thanks,<br />
<br />
I've logged this as an enhancement (with screen shots showing the problem) as:<br />
<br />
https://sourceforge.net/p/nsis/feature-requests/521/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">17th September 2013, 20:01</div></div><div class="posttext">!include MUI2.nsh<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW SizeWelcomeFinish<br />
!insertmacro MUI_PAGE_WELCOME<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
!insertmacro MUI_PAGE_INSTFILES<br />
!insertmacro MUI_LANGUAGE Korean<br />
<br />
Function SizeWelcomeFinish<br />
FindWindow $R0 &quot;#32770&quot; &quot;&quot; $HWNDPARENT<br />
GetDlgItem $R0 $R0 0x4B0<br />
System::Call *(i,i,i,i)i.r0<br />
System::Call 'USER32::GetClientRect(i$R0,ir0)'<br />
System::Call *$0(i,i,i.r1,i.r2)<br />
System::Free $0<br />
StrCpy $R2 $2<br />
${DoWhile} $1 &gt; 164<br />
	IntOp $1 $1 - 1<br />
	IntOp $2 $2 - 1<br />
${Loop}<br />
${DoWhile} $2 &lt; $R2<br />
	IntOp $2 $2 + 1<br />
${Loop}<br />
System::Call 'USER32::SetWindowPos(i$R0,i0,i,i,i$1,i$2,i0x16)'<br />
FunctionEndDoes some stretching but should look better...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>