<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Multiple reg keys to a single .reg file?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Multiple reg keys to a single .reg file? NSIS Discussion" />
	
	<title> Multiple reg keys to a single .reg file? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Multiple reg keys to a single .reg file?</div>
<hr />
<div class="pda"><a href="t-334908.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=334908">Multiple reg keys to a single .reg file?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">highend</div><div class="date">18th September 2011, 13:25</div></div><div class="posttext">Hi,<br />
<br />
Is there a way to export multiple (different) reg keys to one single .reg file?<br />
<br />
Like:<br />
HKEY_CURRENT_USER\Software\a<br />
&quot;ValueA&quot;=&quot;x&quot;<br />
HKEY_CURRENT_USER\Software\b<br />
&quot;ValueB&quot;=&quot;y&quot;<br />
HKEY_CURRENT_USER\Software\c<br />
&quot;ValueC&quot;=&quot;Z&quot;<br />
<br />
to .\destination.reg<br />
<br />
with:<br />
<br />
Windows Registry Editor Version 5.00<br />
<br />
[HKEY_CURRENT_USER\Software\a]<br />
&quot;ValueA&quot;=&quot;x&quot;<br />
[HKEY_CURRENT_USER\Software\b]<br />
&quot;ValueB&quot;=&quot;y&quot;<br />
[HKEY_CURRENT_USER\Software\c]<br />
&quot;ValueC&quot;=&quot;Z&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">19th September 2011, 05:47</div></div><div class="posttext">The registry plugin can export to reg files, afaik. You can then merge them using FileRead/FileWrite, I suppose.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zackbuffo</div><div class="date">19th September 2011, 10:40</div></div><div class="posttext">What about &quot;WriteRegStr&quot; or &quot;WriteRegExpandStr&quot;?<br />
<br />
If .\destination.reg is the actual registry file on a system it should be something like:<br />
<br />
WriteRegStr HKCU\Software\a ValueA x<br />
WriteRegStr HKCU\Software\b ValueB y<br />
WriteRegStr HKCU\Software\c ValueC z<br />
<br />
(See Manual 4.9.2.16 and 17)<br />
<br />
Or do you want to build up a new registry file to use it somewhere else?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hypheni9</div><div class="date">19th September 2011, 10:42</div></div><div class="posttext">Is there a way to export multiple (different) reg keys to one single .reg file?<br />
<br />
Just use ReadRegStr and put them in a single file with .reg file formatting.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">highend</div><div class="date">19th September 2011, 11:15</div></div><div class="posttext">@MSG<br />
<br />
I'll have a look at this.<br />
<br />
@zackbuffo<br />
<br />
It's not so much about importing registry entries inside a .reg file ;)<br />
<br />
@hypheni9<br />
<br />
Expand my example to a few dozen or hundreds of entries under a key. That will be a daunting task to export them all via single commands :)<br />
<br />
Isn't there an easier way like:<br />
Fill an array / variable with the different registry _keys_ that you want to export and use a foreach / while loop to iterate through that array / variable that exports each key to a different .reg file (via the ${registry::SaveKey} command from the registry plugin). In the end you get as many .reg files as you filled your array / variable with different registry keys.<br />
<br />
Of course the part of the .nsi script, that must be able to import these .reg files has to find out which .reg files have to be imported by reading the file names of all existing .reg files in a (previously defined) directory and import those that match a defined naming scheme.<br />
<br />
E.g. if the export loop saves all keys with a file name extension of i=1, i++ like:<br />
SavedRegKey1.reg<br />
SavedRegKey2.reg<br />
SavedRegKey3.reg<br />
...<br />
SavedRegKeyX.reg<br />
<br />
the import loop should only import those files that use the same naming convention like the export loop.<br />
<br />
This would be the most general approach but should work in all cases, regardless how many different registry keys have to be im- / exported.<br />
<br />
The question is: Can this be done with NSIS?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">highend</div><div class="date">19th September 2011, 11:26</div></div><div class="posttext">Thanks for your suggestions.<br />
<br />
Isn't there a more general approach to solve this?<br />
<br />
Like: Fill an array / a variable with the all the different reg keys / .reg files that have to be ex- or imported and loop through them while taking the SaveKey / RestoreKey command from the registry plugin?<br />
<br />
E.g. Exporting:<br />
Array / variable is filled with &quot;key 1; key 2; key3; keyX&quot;. A foreach / while loop reads the different entries and invokes the SaveKey command with a naming scheme for the output like:<br />
Export01.reg, Export02.reg, Export03.reg, ExportXX.reg (something like &quot;Name of file&quot; (Export) + ascending number (i=01; i++) + file extension (.reg)).<br />
<br />
Importing would do the same but must be able to look for .reg files in a (previously defined) directory and import (via RestoreKey) only those that match the naming scheme.<br />
<br />
The question is: Can this be done with NSIS in it's current state?<br />
<br />
Regards,<br />
Highend</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>