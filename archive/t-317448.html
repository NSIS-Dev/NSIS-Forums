<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" IntOp divide wrong/unexpected answer, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  IntOp divide wrong/unexpected answer NSIS Discussion" />
	
	<title> IntOp divide wrong/unexpected answer [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  IntOp divide wrong/unexpected answer</div>
<hr />
<div class="pda"><a href="t-317448.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=317448">IntOp divide wrong/unexpected answer</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">wacaveman</div><div class="date">2nd March 2010, 22:25</div></div><div class="posttext">MessageBox MB_OK &quot;Incoming date is $0&quot; &gt;&gt; displays 020307<br />
IntOp $R1 $0 / 100<br />
MessageBox MB_OK &quot;date1 is $0 : $R1&quot; &gt;&gt; displays 020307<br />
 :83<br />
<br />
So, I figured out that NSIS uses standard notation with an extra 0 on the front is Octal.  How do I tell NSIS this is a decimal number?<br />
<br />
Thanks,<br />
<br />
-Kevin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">2nd March 2010, 22:29</div></div><div class="posttext">there is no IntOp flag for this, but it really should exist, so you should add a feature request for it</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">2nd March 2010, 23:29</div></div><div class="posttext">Kevin,<br />
In your case you are looking at dates and only have to worry about a single leading zero. You can code a test for that and eliminate that single zero like this: StrCpy $R1 $0 1<br />
${If} $R1 = 0<br />
  StrCpy $0 $0 &quot;&quot; 1<br />
${EndIf}<br />
IntOp $R1 $0 / 100<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">3rd March 2010, 08:59</div></div><div class="posttext">more easily, if you're sure of the format DDMMYY<br />
just do a StrCpy $R1 $0 4 to obtain DDMM</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wacaveman</div><div class="date">3rd March 2010, 14:54</div></div><div class="posttext">Awesome - I got it, thanks for the he'p.<br />
<br />
So, I set the date as I compile (and append this to the install .exe file) - and since this is !define, should be embedded in the installer as well, right?<br />
<br />
I then compare this to a registry entry (which I would have written to before on previous installs), and I can detect upgrades, as well as roll-backs.<br />
<br />
!define /date DATE &quot;%m%d%y&quot;<br />
<br />
Function ConvertDateToYYMMDD<br />
  Pop $0<br />
  <br />
  StrCpy $R1 $0 4    ;Create MMDD (from MMDDYY)<br />
  StrCpy $R2 $0 &quot;&quot; -2 ;Calculate YY<br />
  StrCpy $0 &quot;$R2$R1&quot;<br />
<br />
  Push $0<br />
FunctionEnd<br />
<br />
<br />
Function IsDateNewer<br />
  Pop $R4<br />
  Pop $R3<br />
<br />
  Push $R3<br />
  Call ConvertDateToYYMMDD<br />
  Pop $R3<br />
<br />
  Push $R4<br />
  Call ConvertDateToYYMMDD<br />
  Pop $R4<br />
<br />
  IntCmp $R3 $R4 GT LTOE GT<br />
  LTOE:<br />
    StrCpy $0 &quot;false&quot;<br />
    Push $0<br />
    return<br />
  GT:<br />
    StrCpy $0 &quot;true&quot;<br />
    Push $0<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">3rd March 2010, 15:05</div></div><div class="posttext">Why not use date format &quot;%Y%m%d&quot; directly ? (YYYYMMDD)<br />
then you can directly read/write the value from registry (as integer or string as you prefer), and proceed to integer comparison<br />
(and year with century never starts with '0')</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>