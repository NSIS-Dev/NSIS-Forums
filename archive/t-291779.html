<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Set working directory for program called via exec, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Set working directory for program called via exec NSIS Discussion" />
	
	<title> Set working directory for program called via exec [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Set working directory for program called via exec</div>
<hr />
<div class="pda"><a href="t-291779.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291779">Set working directory for program called via exec</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">thivnor</div><div class="date">14th May 2008, 02:30</div></div><div class="posttext">I would like to have my NSIS script invoke an executable, and have the working directory for the invoked executable be the same as its own current directory. What is happening now is that the working directory for the invoked program is the same as the folder where my NSIS executable is running from.<br />
<br />
I have used SetOutPath, but that does not appear to be setting the working directory for the invoked .exe. <br />
<br />
I've created a simple test setup to demonstrate this. <br />
<br />
debug.nsi has:<br />
<br />
    System::Call &quot;kernel32::GetCurrentDirectory(i ${NSIS_MAX_STRLEN}, t .r0)&quot;   <br />
    StrCpy $workingDir $0<br />
    MessageBox MB_OK|MB_ICONEXCLAMATION &quot;workingDir: $workingDir&quot;<br />
<br />
In other works, it just reports out its working directory.<br />
<br />
invoke.nsi has:<br />
<br />
    StrCpy $OUTDIR &quot;C:\&quot;<br />
    SetOutPath &quot;C:\&quot;<br />
    Exec &quot;$EXEDIR\subfolder\debug.exe&quot;<br />
    <br />
<br />
No matter what I do, debug.exe reports that the working directory is the same: the directory where invoke.exe lives. <br />
<br />
I'm looking for the equivalent to &quot;cd&quot; in a batch file. Or, in Windows Shortcut terms, I want to set the &quot;Start In&quot; property.<br />
<br />
Anyway to accomplish this? <br />
<br />
I'm using MakeNSIS v2.31</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th May 2008, 22:27</div></div><div class="posttext">Does it work with something other than &quot;C:\&quot;?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thivnor</div><div class="date">15th May 2008, 23:03</div></div><div class="posttext">Wow. <br />
<br />
I've re-tested this, and determine that, in fact using C:\ doesn't work, but every other folder I've tried does work. I had originally just popped C:\ in, as a quick test. I didn't figure the actual directory mattered.<br />
<br />
BAD:<br />
    SetOutPath &quot;C:\&quot;<br />
    Exec &quot;$EXEDIR\subfolder\debug.exe&quot;<br />
<br />
GOOD:<br />
    SetOutPath &quot;E:\&quot;<br />
    Exec &quot;$EXEDIR\subfolder\debug.exe&quot;<br />
<br />
GOOD:<br />
    SetOutPath &quot;C:\Foo&quot;<br />
    Exec &quot;$EXEDIR\subfolder\debug.exe&quot;<br />
<br />
Now ... I'm super-curious! What is so special about C:\ ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">16th May 2008, 00:31</div></div><div class="posttext">C:\, or more accurately - your boot drive's root folder is, well, your boot drive's root folder.  Installing into it (which SetOutPath is usually for) is considered 'bad'.<br />
<br />
See also &quot;AllowRootDirInstall&quot;.<br />
<br />
Note that under Vista, unless you mucked with write permissions left and right, writing to root will fail regardless.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thivnor</div><div class="date">16th May 2008, 00:57</div></div><div class="posttext">Hmm... C:\ ... your boot drive's root folder ... now that you put it THAT way, this all makes total sense. <br />
<br />
As an aside, I've found NSIS so useful that I now use it as a general purpose programming language, for small Windows utilities. I will need to keep in mind the original point of functions like SetOutPath!<br />
<br />
Thanks for the clues !!!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>