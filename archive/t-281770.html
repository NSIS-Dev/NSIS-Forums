<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Reading Batch Exit Codes, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Reading Batch Exit Codes NSIS Discussion" />
	
	<title> Reading Batch Exit Codes [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Reading Batch Exit Codes</div>
<hr />
<div class="pda"><a href="t-281770.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=281770">Reading Batch Exit Codes</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Fightin_Foo</div><div class="date">19th November 2007, 20:55</div></div><div class="posttext">Hello all,<br />
<br />
I was having some problems with processes plugins and Vista so I decided I would write my own batch script to see if a a process is running.   The batch script works fine and returns a different error level / exit code (by EXIT /B ###) depending on whether the process is found or not.  All the NSIS documentation and google searches I have seen say ExecWait should be able to read the exit code.  But it either always reads 0 or an empty variable.  Does anybody have any ideas?  I don't really want to use a plugin if I don't have to but if I do, anybody know a good one that will work with XP and Vista?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">galevsky</div><div class="date">20th November 2007, 08:58</div></div><div class="posttext">Just a comment about &quot;I don't really want to use a plugin if I don't have to but if I do&quot;, NSIS is really suffering from lack of documentation and maintenance, and a lot of interesting stuff (means up-to-date and the ones to use) are now developped in plugins...<br />
<br />
As for your problem, I am using nsExec:<br />
Return Value<br />
------------<br />
If nsExec is unable to execute the process, it will return &quot;error&quot;<br />
on the top of the stack, if the process timed out it will return<br />
&quot;timeout&quot;, else it will return the return code from the<br />
executed process.<br />
<br />
Read more here: http://nsis.sourceforge.net/Docs/nsExec/nsExec.txt<br />
<br />
Gal'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Fightin_Foo</div><div class="date">20th November 2007, 14:06</div></div><div class="posttext">I really didn't want to make it seem that I was anti-plugins, I have just had some problems with some of them and Vista and wanted to try to avoid having more.  If there is a plugin out there that will work for me with a minimal chance of problems I will be happy to use it.<br />
<br />
Thanks for the suggestion about nsExec, but sadly it didn't work for me.  It always returns 0 for me.  Any other ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th November 2007, 18:16</div></div><div class="posttext">Execute the command line application (command.com on 9x and cmd.exe on NT, or just %COMSPEC% on all) and tell it to execute your batch file. It should return the correct value.ReadEnvStr $0 COMSPEC<br />
ExecWait '&quot;$0&quot; /c blah.bat' $0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Fightin_Foo</div><div class="date">20th November 2007, 22:35</div></div><div class="posttext">Unfortunately, kichik, your ReadEnvStr didn't work for me either, it always read 1 so it was at least a new result.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th November 2007, 22:43</div></div><div class="posttext">Don't use /B as you want it to exit CMD.EXE and set its return value and not the batch's.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Fightin_Foo</div><div class="date">23rd November 2007, 21:10</div></div><div class="posttext">Nice suggestion kichik, I removed the /B and then I could read the exit code (just with ExecWait) on Windows XP.  However it still gives me problems in Vista.  Anyone have ideas that will make Vista happy?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>