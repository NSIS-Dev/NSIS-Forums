<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" DLL register (VB6) - urgent!, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  DLL register (VB6) - urgent! NSIS Discussion" />
	
	<title> DLL register (VB6) - urgent! [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  DLL register (VB6) - urgent!</div>
<hr />
<div class="pda"><a href="t-286021.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=286021">DLL register (VB6) - urgent!</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">fnonaka</div><div class="date">31st January 2008, 12:22</div></div><div class="posttext">Hello!<br />
<br />
I have an application in VB6, and in the SETUP.lst file is included:<br />
<br />
[Bootstrap Files]<br />
VB6STKIT.DLL,$(WinSysPathSysFile),,,7/15/00 12:00:00 AM,101888,6.0.84.50<br />
MSVCRT40.DLL,$(WinSysPathSysFile),,,5/31/98 12:00:00 AM,326656,4.21.0.0<br />
ASYCFILT.DLL,$(WinSysPathSysFile),,,8/31/99 4:55:18 PM,147728,2.40.4277.1<br />
COMCAT.DLL,$(WinSysPathSysFile),$(DLLSelfRegister),,5/31/98 12:00:00 AM,22288,4.71.1460.1<br />
OLEPRO32.DLL,$(WinSysPathSysFile),$(DLLSelfRegister),,2/4/03 11:32:42 AM,229376,5.0.4518.0<br />
OLEAUT32.DLL,$(WinSysPathSysFile),$(DLLSelfRegister),,2/4/03 11:32:40 AM,929792,2.40.4518.0<br />
msvbvm60.dll,$(WinSysPathSysFile),$(DLLSelfRegister),,11/8/00 3:02:46 PM,1388544,6.0.89.64<br />
STDOLE2.TLB,$(WinSysPathSysFile),$(TLBRegister),,2/4/03 11:32:40 AM,16896,2.40.4518.0<br />
<br />
[Setup1 Files]<br />
File3=@MSREPL35.DLL,$(WinSysPathSysFile),,,8/17/01 10:59:00 AM,430080,3.51.2404.0<br />
File5=@expsrv.dll,$(WinSysPathSysFile),,,6/24/99 11:40:58 PM,379152,6.0.0.8540<br />
File6=@vbajet32.dll,$(WinSysPathSysFile),,,1/22/99 4:09:38 AM,30992,6.0.1.8268<br />
File7=@msjint35.dll,$(WinSysPathSysFile),,,4/24/98 12:00:00 AM,123664,3.51.623.0<br />
File8=@msjter35.dll,$(WinSysPathSysFile),,,4/24/98 12:00:00 AM,24848,3.51.623.0<br />
File2=@VB5DB.DLL,$(WinSysPath),,$(Shared),6/18/98 12:00:00 AM,89360,6.0.81.69<br />
File4=@msrd2x35.dll,$(WinSysPathSysFile),$(DLLSelfRegister),,9/5/01 2:00:00 PM,262144,3.51.623.0<br />
File9=@MSJET35.DLL,$(WinSysPathSysFile),$(DLLSelfRegister),,5/5/99 10:22:00 PM,1056768,3.51.2723.0<br />
File1=@Mscomctl.ocx,$(WinSysPath),$(DLLSelfRegister),$(Shared),1/6/99 5:18:14 AM,1057552,6.1.83.41<br />
File6=@MSMASK32.OCX,$(WinSysPath),$(DLLSelfRegister),$(Shared),5/22/00 12:00:00 AM,166600,6.0.84.18<br />
File7=@MSFLXGRD.OCX,$(WinSysPath),$(DLLSelfRegister),$(Shared),5/22/00 12:00:00 AM,244416,6.0.84.18<br />
File8=@DBGRID32.OCX,$(WinSysPath),$(DLLSelfRegister),$(Shared),6/24/98 12:00:00 AM,525352,5.1.81.4<br />
File9=@Comdlg32.ocx,$(WinSysPath),$(DLLSelfRegister),$(Shared),5/6/99 11:00:00 PM,140288,6.0.84.18<br />
File10=@dao350.dll,$(MSDAOPath),$(DLLSelfRegister),$(Shared),4/27/98 12:00:00 AM,570128,3.51.1608.0<br />
<br />
I'm a beginner in registering dll files, so:<br />
<br />
1 - What's the best way to register these dll files?<br />
<br />
2 - First of all, I'm copying the dll files with &quot;file components\VB6STKIT.DLL&quot;, for example, to copy the dll files to their directory, and then I use InstallLib command to register... is it correct? I'm not sure if InstallLib command installs AND register dll files at the same time!<br />
<br />
3 - I thought to pack vbrun60.exe and msvbvm50.exe files, but they don't include all these dll files, so I think it's not recommended to use them to install, am I right?<br />
<br />
4 - Also, when I try to run these .exe files, I receive the msg  &quot;Error registering the oleaut32.dll&quot; for example. Why this is happening - maybe it's because I have already this dll installed on my machine? <br />
<br />
5 - How can I register the Shared and TLBRegister files? What does it happens if I register without specifying the &quot;shared&quot; information?<br />
<br />
Thanks!<br />
Fernando</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fnonaka</div><div class="date">1st February 2008, 12:48</div></div><div class="posttext">Hi again!<br />
I changed the code and did this:<br />
<br />
#VB DLL<br />
        !insertmacro InstallLib DLL          NOTSHARED REBOOT_PROTECTED &quot;componentes\VB6STKIT.DLL&quot; &quot;$SYSDIR\VB6STKIT.DLL&quot; $SYSDIR<br />
        !insertmacro InstallLib DLL          NOTSHARED REBOOT_PROTECTED &quot;componentes\MSVCRT40.dll&quot; &quot;$SYSDIR\MSVCRT40.dll&quot; $SYSDIR<br />
        !insertmacro InstallLib DLL          NOTSHARED REBOOT_PROTECTED &quot;componentes\ASYCFILT.DLL&quot; &quot;$SYSDIR\ASYCFILT.DLL&quot; $SYSDIR<br />
        !insertmacro InstallLib REGDLL       NOTSHARED REBOOT_PROTECTED &quot;componentes\COMCAT.DLL&quot; &quot;$SYSDIR\COMCAT.DLL&quot; $SYSDIR<br />
        !insertmacro InstallLib REGDLL       NOTSHARED REBOOT_PROTECTED &quot;componentes\OLEPRO32.DLL&quot; &quot;$SYSDIR\OLEPRO32.DLL&quot; $SYSDIR<br />
        !insertmacro InstallLib REGDLL       NOTSHARED REBOOT_PROTECTED &quot;componentes\OLEAUT32.DLL&quot; &quot;$SYSDIR\OLEAUT32.DLL&quot; $SYSDIR<br />
        !insertmacro InstallLib REGDLL       NOTSHARED REBOOT_PROTECTED &quot;componentes\msvbvm60.dll&quot; &quot;$SYSDIR\msvbvm60.dll&quot; $SYSDIR<br />
        !insertmacro InstallLib REGDLLTLB    NOTSHARED REBOOT_PROTECTED &quot;componentes\STDOLE2.TLB&quot; &quot;$SYSDIR\STDOLE2.TLB&quot; $SYSDIR<br />
<br />
        #Other DLL<br />
        !insertmacro InstallLib DLL          NOTSHARED REBOOT_PROTECTED &quot;componentes\MSREPL35.DLL&quot; &quot;$SYSDIR\MSREPL35.DLL&quot; $SYSDIR<br />
        !insertmacro InstallLib DLL          NOTSHARED REBOOT_PROTECTED &quot;componentes\expsrv.dll&quot; &quot;$SYSDIR\expsrv.dll&quot; $SYSDIR<br />
        !insertmacro InstallLib DLL          NOTSHARED REBOOT_PROTECTED &quot;componentes\vbajet32.dll&quot; &quot;$SYSDIR\vbajet32.dll&quot; $SYSDIR<br />
        !insertmacro InstallLib DLL          NOTSHARED REBOOT_PROTECTED &quot;componentes\msjint35.dll&quot; &quot;$SYSDIR\msjint35.dll&quot; $SYSDIR<br />
        !insertmacro InstallLib DLL          NOTSHARED REBOOT_PROTECTED &quot;componentes\msjter35.dll&quot; &quot;$SYSDIR\msjter35.dll&quot; $SYSDIR<br />
        !insertmacro InstallLib DLL          SHARED    REBOOT_PROTECTED &quot;componentes\VB5DB.DLL&quot; &quot;$WINDIR\VB5DB.DLL&quot; $WINDIR<br />
        !insertmacro InstallLib REGDLL       NOTSHARED REBOOT_PROTECTED &quot;componentes\msrd2x35.dll&quot; &quot;$SYSDIR\msrd2x35.dll&quot; $SYSDIR<br />
        !insertmacro InstallLib REGDLL       NOTSHARED REBOOT_PROTECTED &quot;componentes\msrd2x35.dll&quot; &quot;$SYSDIR\msrd2x35.dll&quot; $SYSDIR<br />
        !insertmacro InstallLib REGDLL       NOTSHARED REBOOT_PROTECTED &quot;componentes\MSJET35.DLL&quot; &quot;$SYSDIR\MSJET35.DLL&quot; $SYSDIR<br />
        !insertmacro InstallLib REGDLL       SHARED    REBOOT_PROTECTED &quot;componentes\Mscomctl.ocx&quot; &quot;$WINDIR\Mscomctl.ocx&quot; $WINDIR<br />
        !insertmacro InstallLib REGDLL       SHARED    REBOOT_PROTECTED &quot;componentes\MSMASK32.OCX&quot; &quot;$WINDIR\MSMASK32.OCX&quot; $WINDIR<br />
        !insertmacro InstallLib REGDLL       SHARED    REBOOT_PROTECTED &quot;componentes\MSFLXGRD.OCX&quot; &quot;$WINDIR\MSFLXGRD.OCX&quot; $WINDIR<br />
        !insertmacro InstallLib REGDLL       SHARED    REBOOT_PROTECTED &quot;componentes\DBGRID32.OCX&quot; &quot;$WINDIR\DBGRID32.OCX&quot; $WINDIR<br />
        !insertmacro InstallLib REGDLL       SHARED    REBOOT_PROTECTED &quot;componentes\Comdlg32.ocx&quot; &quot;$WINDIR\Comdlg32.ocx&quot; $WINDIR<br />
        !insertmacro InstallLib REGDLL       SHARED    REBOOT_PROTECTED &quot;componentes\dao360.dll&quot; &quot;$WINDIR\dao360.dll&quot; $WINDIR<br />
        <br />
        #DAO registering<br />
        !define MSDAOPath &quot;$COMMONFILES\Microsoft Shared\DAO&quot;<br />
        !insertmacro InstallLib REGDLL       SHARED    REBOOT_PROTECTED &quot;componentes\dao350.dll&quot; &quot;${MSDAOPath}\dao350.dll&quot; &quot;${MSDAOPath}&quot;<br />
<br />
My questions:<br />
<br />
I'm not sure if the dll were installed, because when I installing the application, it says: &quot;Registering xxxx.dll&quot; - but it doesn't show all the dll's in the list above, and if the dll was successfuly registered! Then it shows only the message &quot;Finished&quot;.<br />
<br />
Is it good to use REBOOT_PROTECTED? <br />
I saw in other examples using the variable ALREADY_INSTALLED - do I have to use it too?<br />
<br />
Is there any way(command) to know if the dll were registered? Considering the fact that I have already these dll's registered in my machine. I use REGEDIT to search a specific dll, but when I find it, I don't know if the dll I found is the one I registered!<br />
<br />
thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">fbongor</div><div class="date">11th April 2008, 00:24</div></div><div class="posttext">I also am trying to make an installer for a VB6 package and also need to do a DLLSELFREGISTER as well as self-register some OCX active-X files.<br />
<br />
Has anyone had any luck with this?<br />
thanks<br />
F</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">11th April 2008, 02:40</div></div><div class="posttext">Originally posted by fnonaka <br />
I'm a beginner in registering dll files, so:<br />
<br />
1 - What's the best way to register these dll files?<br />
<br />
Using RegDLL, also you should read this wiki pages:<br />
http://nsis.sourceforge.net/How_to_install_the_VB6_runtimes<br />
http://nsis.sourceforge.net/How_can_I_install_the_VB6_runtimes<br />
http://nsis.sourceforge.net/VB_Converter<br />
http://nsis.sourceforge.net/Docs/AppendixB.html<br />
http://nsis.sourceforge.net/RegisterTLB_-_register_Typelib<br />
<br />
2 - First of all, I'm copying the dll files with &quot;file components\VB6STKIT.DLL&quot;, for example, to copy the dll files to their directory, and then I use InstallLib command to register... is it correct? I'm not sure if InstallLib command installs AND register dll files at the same time!<br />
<br />
See above links<br />
<br />
3 - I thought to pack vbrun60.exe and msvbvm50.exe files, but they don't include all these dll files, so I think it's not recommended to use them to install, am I right?<br />
<br />
Why not use the M$ VB[5][6] runtime installer? Nsis can launch external executables.<br />
<br />
4 - Also, when I try to run these .exe files, I receive the msg  &quot;Error registering the oleaut32.dll&quot; for example. Why this is happening - maybe it's because I have already this dll installed on my machine? <br />
<br />
That, or corrupted or bad version, error on system core, also bad Windows version, don't know..there can be tons of reasons in windows environment.<br />
<br />
5 - How can I register the Shared and TLBRegister files? What does it happens if I register without specifying the &quot;shared&quot; information?<br />
<br />
Thanks!<br />
Fernando [/B]<br />
See above links.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>