<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" help plz.. selecting install dir, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  help plz.. selecting install dir NSIS Discussion" />
	
	<title> help plz.. selecting install dir [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  help plz.. selecting install dir</div>
<hr />
<div class="pda"><a href="t-162456.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=162456">help plz.. selecting install dir</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">chooch_t</div><div class="date">30th December 2003, 11:14</div></div><div class="posttext">Hello everyone. Now I'm not a programmer so please no flaming if this is easy to you guys. I have created some ICC profiles that I need to send out to customers. Depending upon their OS the files will be installed in the correct location ie.<br />
<br />
for win 98/Me this wouod be sysdir/color<br />
<br />
for win2000/xp this would be sysdir/spool/drivers/color<br />
<br />
How can I get the installer to automatically detect the OS and then select the correct install path.<br />
<br />
I would like to do this in one install file rather than have 2 separate ones for win9x and win2000<br />
<br />
Thanks<br />
<br />
chooch_t</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">30th December 2003, 11:37</div></div><div class="posttext">In the NSIS documentation/help file there is a usefull functions section which contains a function to get the windows version.<br />
<br />
Vytautas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cdzitu</div><div class="date">30th December 2003, 11:57</div></div><div class="posttext">Hi, them from one newbie to another. :) I've found a function named 'GetWindowsVersion' in 'NSIS manual &gt; Appendix B'. But i just don't know how to keep on with it, so i'll tell you how i would do it. I would extract the files to both directories, if the user is using 98/ME, it will extract to '${SYSDIR}\color' and won't find the '${SYSDIR}\spool\drivers\color'; if the user is using XP/2K, it will extract sucessfully to ${SYSDIR}\spool\drivers\color and fail when trying to extract to the other directory. <br />
<br />
Hihi, hope i helped you!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">30th December 2003, 12:10</div></div><div class="posttext">Not quite, I would work but both locations would have the files created.  If you only wish to tell the difference between NT and 9x windows families this code should do the trick. push $0<br />
<br />
ReadRegStr $R0 HKLM &quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot; &quot;CurrentVersion&quot;<br />
IfErrors lbl_win9x lbl_winnt<br />
<br />
lbl_win9x:<br />
  ; extract files for windows 9x here<br />
  <br />
goto lbl_end<br />
<br />
lbl_winnt:<br />
  ; extract files for windows nt here<br />
<br />
goto lbl_end<br />
<br />
lbl_end:<br />
pop $0 Just add this code to a section and you are set to go.<br />
<br />
Vytautas :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cdzitu</div><div class="date">30th December 2003, 13:21</div></div><div class="posttext">Hehe, the way Vytautas posted is really better :P But my way would work fine too, it wouldn't extract to both directories because the dirs are exclusive from their OS, there isn't the '${SYSDIR}\spool\drivers\color' in Win98 (at least at mine ;]) and i suppose there isn't the '${SYSDIR}\color' at WinXP/2K. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Vytautas</div><div class="date">30th December 2003, 13:27</div></div><div class="posttext">No they don't exist, but NSIS would create the folders if needed.<br />
<br />
Vytautas ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Cdzitu</div><div class="date">30th December 2003, 13:45</div></div><div class="posttext">Hehe, you're right, Vytautas. Have just realized that! :) See you!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>