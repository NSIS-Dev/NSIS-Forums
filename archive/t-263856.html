<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to see why runas plugin returns error, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to see why runas plugin returns error NSIS Discussion" />
	
	<title> How to see why runas plugin returns error [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to see why runas plugin returns error</div>
<hr />
<div class="pda"><a href="t-263856.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=263856">How to see why runas plugin returns error</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ontrack16</div><div class="date">17th January 2007, 12:00</div></div><div class="posttext">I use the runas plugin.<br />
<br />
Every time I get an error as return.<br />
<br />
I am very sure that the provided user, password and program to execute are right.<br />
<br />
Can someone tell me why it fails or how I can see where it fails ?<br />
<br />
Does somebody have an example of another way to &quot;RunAs&quot; ?<br />
I looked at the API CreateProcessWithLogon but can't get it working either.<br />
<br />
I can't use DosExec plugin because the program to start is a Win program.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th January 2007, 14:21</div></div><div class="posttext">It's not really a plug-in, so you must extract it first. You must also extract it to somewhere the System plug-in can find it.InitPluginsDir<br />
SetOutPath $PLUGINSDIR<br />
File runas.dll<br />
System::Call &quot;runas...&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ontrack16</div><div class="date">20th January 2007, 10:22</div></div><div class="posttext">Isn't that how to get the plugin installed ?<br />
<br />
If so, then sorry, It looks like I have expressed me wrong.<br />
I think the runas plugin is installed and at the right place.<br />
I did it manually by decompressing the zip file and copying the dll in %programfiles%\nsis\plugin.<br />
The compiler recognizes the functions inside the dll (DLLMain, DLLMain12, GetAdministrators, GetAdministrators@8, RunAsW, RunAsW@16)<br />
<br />
The problem in fact is that every time I use the runas, it returns a fail status.<br />
The value returned from the function (r0) is always 0.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th January 2007, 12:42</div></div><div class="posttext">As I said, it's not really a plug-in, so that's not how you install it. It's a DLL that you can call with the System plug-in. Therefore, NSIS won't automatically package it for you and you must extract it yourself. Your script doesn't do that and if the DLL is in the Plugins directory, it can't find it. Your script tests that $0 is not 1, it doesn't test that it is 0. If you add a MessageBox there, you'll probably see it's actually &quot;error&quot; as you've stated yourself in the first post.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>