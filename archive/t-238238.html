<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Disable or remove Windows close button?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Disable or remove Windows close button? NSIS Discussion" />
	
	<title> Disable or remove Windows close button? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Disable or remove Windows close button?</div>
<hr />
<div class="pda"><a href="t-238238.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=238238">Disable or remove Windows close button?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">16th February 2006, 22:53</div></div><div class="posttext">Odd question:<br />
Is there a way that I can disable the Close button (little 'x' in the upper right-hand corner) of an installer window?<br />
<br />
Or, perhaps a way to remove the title bar altogether?<br />
<br />
First, I thought perhpas a SendMessage or EnableWindow command might do it, but couldn't find a handle to this control or a command to use to do it.<br />
<br />
Next, I thought maybe I could use Resource Hacker to do it, but couldn't find a way to get to that part of the Window.  <br />
<br />
Can anyone give me a push in the right direction?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">17th February 2006, 09:08</div></div><div class="posttext">Edit the dialog in Resource Hacker and remove the WS_SYSMENU style from IDD 105 (or to remove the whole caption, remove WS_CAPTION).<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">19th February 2006, 17:01</div></div><div class="posttext">Perhaps I'm doing something wrong as I cannot make this work. Using Resource Hacker, I changed the file ${NSISDIR}\Contrib\UIs\default.exe to remove WS_SYSMENU.  I saved the EXE and confirmed the save by viewing the modified date of default.exe.  I then just recompile my NSIS script, but nothing changes.  Have I missed a step?<br />
<br />
2nd qustion:<br />
I found this article (http://www.codeguru.com/Cpp/W-D/dislog/menuhandling/article.php/c1931/) about how to disable the close box that I thought I'd try using the system plugin.  I found the function on MSDN, so I decided to GetSystemMenu (http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/resources/menus/menureference/menufunctions/getsystemmenu.asp)  setup an experiment with Windows Notepad using this function:<br />
<br />
   FindWindow $5 '' 'Untitled - Notepad'<br />
   MessageBox MB_OK &quot;handle of Notepad: $5&quot;<br />
   System::Call &quot;user32::GetSystemMenu (i r5,i 0) i.r6&quot;<br />
   ;MessageBox MB_OK &quot;Return value #1: $R1&quot;<br />
   MessageBox MB_OK &quot;Result: $6&quot;<br />
<br />
But each time I run, my result returns 'error'.  Can anyone tell me what I might be doing wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th February 2006, 17:04</div></div><div class="posttext">Are you using Modern UI? If so you need to modify modern.exe. Also, when removing the styles, make sure you click the Compile button in Resource Hacker and then File&gt;Save.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">19th February 2006, 17:05</div></div><div class="posttext">No, I'm not using MUI.  (I wanted to start with baby steps).  and yes, I did both compile and save.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">22nd February 2006, 02:07</div></div><div class="posttext">Anyone have any idea why my System Plugin call isn't working from above?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">22nd February 2006, 04:08</div></div><div class="posttext">disable close:<br />
<br />
function .onGuiInit<br />
push $1<br />
System::Call &quot;user32::GetSystemMenu(i $HWNDPARENT,i 0) i.s&quot;<br />
pop $1<br />
System::Call &quot;user32::EnableMenuItem(i $1,i 0xF060,i 1)&quot;<br />
pop $1<br />
functionEnd<br />
<br />
<br />
nasty hack to remove titlebar: (windows size is a bit off, and you really should do the proper bit-twiddling to remove the required bits and call Redraw window instead of all those ShowWindow calls)<br />
<br />
function .onGuiInit<br />
System::Call 'user32::SetWindowLong(i $HWNDPARENT,i -16,i 339871820)'<br />
ShowWindow $HWNDPARENT 0<br />
ShowWindow $HWNDPARENT 2<br />
ShowWindow $HWNDPARENT 0<br />
ShowWindow $HWNDPARENT 1<br />
functionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">22nd February 2006, 16:54</div></div><div class="posttext">Thanks, Anders!<br />
<br />
For some reason, I wasn't getting the handle returned from my GetSystemMenu function, but since your function seems to work, so I'll just go with that.  ;)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>