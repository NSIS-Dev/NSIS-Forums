<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Close Running Application, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Close Running Application NSIS Discussion" />
	
	<title> Close Running Application [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Close Running Application</div>
<hr />
<div class="pda"><a href="t-72918.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=72918">Close Running Application</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">22nd January 2002, 23:29</div></div><div class="posttext">i remember the FindWindow command in NSIS 1.4x could detect if a software was running during the installation-process and close it.<br />
<br />
now that the commands changed, i'm in need of help.<br />
<br />
i want my setup to <br />
<br />
1) detect if winamp is running and force the user to close it<br />
<br />
or<br />
<br />
2) close winamp without asking<br />
<br />
if you can help me, please paste the syntax. the makensis.html wasnt a big help for me!<br />
<br />
thx in advance,<br />
<br />
kb</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">22nd January 2002, 23:55</div></div><div class="posttext">This is from functions.htm in the nsis distro:<br />
<br />
Function CloseWinamp<br />
  Push $0<br />
  loop:<br />
    FindWindow $0 &quot;Winamp v1.x&quot;<br />
    IntCmp $0 0 done<br />
     SendMessage $0 16 0 0<br />
     Sleep 100<br />
     Goto loop<br />
  done:<br />
  Pop $0<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">23rd January 2002, 00:02</div></div><div class="posttext">i remember i tried this before. nothing happening. reading the makensis.html it should be possible with FindWindow/SendMessage, but i have no clue how that works. this function does nothing, but thanks anyhow for the quick reply!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">23rd January 2002, 00:40</div></div><div class="posttext">I just ran it and it closed winamp just like it should.  Are you calling the function?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">23rd January 2002, 01:28</div></div><div class="posttext">i did copy+paste =)<br />
<br />
what version of nsis did you use? mine is 1.94</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">23rd January 2002, 01:40</div></div><div class="posttext">I'm using 1.94<br />
<br />
<br />
Name &quot;CloseWinamp&quot;<br />
Outfile &quot;closewinamp.exe&quot;<br />
<br />
Section -<br />
	Call CloseWinamp<br />
SectionEnd<br />
<br />
Function CloseWinamp<br />
  Push $0<br />
  loop:<br />
    FindWindow $0 &quot;Winamp v1.x&quot;<br />
    IntCmp $0 0 done<br />
     SendMessage $0 16 0 0<br />
     Sleep 100<br />
     Goto loop<br />
  done:<br />
  Pop $0<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">F. Heidenreich</div><div class="date">23rd January 2002, 05:54</div></div><div class="posttext">This will not work for the current BETA of Winamp. If you want to close a BETA version simply replace FindWindow*$0*&quot;Winamp*v1.x&quot;<br />
with FindWindow $0 &quot;STUDIO&quot;<br />
<br />
~ Florian</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">23rd January 2002, 15:31</div></div><div class="posttext">Doh.  It never crossed my mind they might be refering wo Winamp 3.  :cool:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">23rd January 2002, 21:51</div></div><div class="posttext">thank you very much! works now, and i added both functions to support both versions =)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">24th January 2002, 05:34</div></div><div class="posttext">Excuse my ignorance on this topic, but how do you find out the name of the Window you want to close if you did not write the application you are trying to close?<br />
<br />
-Carlos</div></div><hr />


<div class="post"><div class="posttop"><div class="username">F. Heidenreich</div><div class="date">24th January 2002, 08:38</div></div><div class="posttext">Carlos,<br />
there is a tool called Spy++ that ships with Visual Studio. With this tool you could identify the window class or window handle of every open window.<br />
There are similar tools called Window Finder (http://www.codeproject.com/useritems/windowfinder.asp) (which ships with source code) and WinSpy (http://www.gena01.com/win32spy/).<br />
<br />
Kichik (http://forums.winamp.com/member.php?s=&amp;action=getinfo&amp;userid=44024) uploaded the Spy program from the platform SDK at this (http://forums.winamp.com/showthread.php?s=&amp;threadid=69348) thread.<br />
<br />
~ Florian</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cchian</div><div class="date">24th January 2002, 13:57</div></div><div class="posttext">Thank you for all those useful links Florian, they worked great!!!<br />
<br />
-Carlos</div></div><hr />


<div class="post"><div class="posttop"><div class="username">benp</div><div class="date">25th January 2002, 14:01</div></div><div class="posttext">is there an other way to close apps like the above one<br />
i mean a command like kill (killtask ...)&quot;exename&quot;<br />
is more simplier than write everytime a function like the findwindow...<br />
is there a way to implement this command in the next releases of nsis<br />
<br />
sorry for my bad english:confused:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pomflain</div><div class="date">25th January 2002, 14:36</div></div><div class="posttext">Just make a function to do that an always pass in &quot;exename&quot; in one of thhe registers.  Name the function &quot;killtask&quot; if you want,  then just Call killtask</div></div><hr />


<div class="post"><div class="posttop"><div class="username">benp</div><div class="date">25th January 2002, 15:00</div></div><div class="posttext">can you give me an example please???:hang:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">25th January 2002, 16:44</div></div><div class="posttext">Function CloseApplication<br />
  Pop $1<br />
  Push $0<br />
  loop:<br />
    FindWindow $0 $1<br />
    IntCmp $0 0 done<br />
     SendMessage $0 16 0 0<br />
     Sleep 100<br />
     Goto loop<br />
  done:<br />
  Pop $0<br />
FunctionEnd<br />
<br />
Function .onInit<br />
  Push &quot;Winamp v1.x&quot;<br />
  Call CloseApplication<br />
FunctionEnd<br />
 <br />
<br />
Push the class name of the application before calling it, then the closeapplication will close it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">benp</div><div class="date">25th January 2002, 17:04</div></div><div class="posttext">ah yes ok thank you :) :) :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">benp</div><div class="date">26th January 2002, 14:11</div></div><div class="posttext">that way wont work because the task i want to close runs in the background <br />
i have found the window name but it close only the (invisible) window and not the task<br />
the task is still shown in taskmon<br />
<br />
is there an other way to close this because i can not write over the file<br />
<br />
please help  :confused: :confused:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ksyksy</div><div class="date">28th January 2002, 06:11</div></div><div class="posttext">I can not English Very well. <br />
<br />
I want to closeing MYSQL daemon. <br />
please Tell me. help. <br />
<br />
Function CloseWinamp <br />
Push $0 <br />
loop: <br />
FindWindow $0 &quot;Winamp v1.x&quot; &lt;== How Can i set... <br />
IntCmp $0 0 done <br />
SendMessage $0 16 0 0 <br />
Sleep 100 <br />
Goto loop <br />
done: <br />
Pop $0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">felfert</div><div class="date">28th January 2002, 07:09</div></div><div class="posttext">In case of MySQL, you can NOT simply kill the daemon. If you do that, you will probably loose database consitency. Instead, simply run the mysqladmin commandline-tool:<br />
<br />
C:\mysql\bin\mysqladmin shutdown<br />
<br />
This terminates the server gracefully.<br />
<br />
From within your script, this would be:<br />
<br />
<br />
Function stopMySQL<br />
  ExecWait &quot;C:\\mysql\\bin\\mysqladmin shutdown&quot;<br />
FunctionEnd<br />
<br />
<br />
Note:<br />
Depending on your setup, this probably needs to specify a database admin-user and his password on the commandline.<br />
See mysql docs...<br />
<br />
A question:<br />
Why do you want to shutdown the DB-server?<br />
Nearly anything can be done without shutting down MySQL.<br />
<br />
-Fritz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ksyksy</div><div class="date">28th January 2002, 07:21</div></div><div class="posttext">How do i know... MySQL Daemon State. (RUNning? OR Not RUNning) <br />
<br />
If (MySQL daemon == running) Sending SQL query To MySQL server. <br />
else message &quot;Please Running MySQL Daemon&quot; <br />
<br />
<br />
&lt;= please teach me. help me. <br />
How can i know MySQL Daemon State.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">linuxamp</div><div class="date">13th March 2002, 08:59</div></div><div class="posttext">Originally posted by benp <br />
that way wont work because the task i want to close runs in the background <br />
i have found the window name but it close only the (invisible) window and not the task <br />
the task is still shown in taskmon <br />
<br />
is there an other way to close this because i can not write over the file <br />
<br />
<br />
yes that is true.<br />
it is March, did you find a way to cloes the running task?:) <br />
thank you</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>