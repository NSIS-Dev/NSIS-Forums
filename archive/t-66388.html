<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Uninstaller, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Uninstaller NSIS Discussion" />
	
	<title> Uninstaller [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Uninstaller</div>
<hr />
<div class="pda"><a href="t-66388.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=66388">Uninstaller</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">anton/five</div><div class="date">22nd November 2001, 16:03</div></div><div class="posttext">Is there any way to make a uninstaller generated by NSIS to return code 1 instead of 0 when uninstalling was successful?<br />
<br />
The reason to do it is that after returning code 1 by the uninstaller, the Add/Remove List will be refreshed. But if code 0 was returned, the Add/Remove List will continue to show inside the product name, for which<br />
the uninstaller was called.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">22nd November 2001, 20:41</div></div><div class="posttext">try putting a RegEntry in <br />
HKLM\Microsoft\windows\currentversion\uninstall<br />
with &quot;DisplayName&quot; and &quot;UnInstallString&quot;<br />
<br />
This entry will disappear if you delete these entries<br />
at uninstall and also the add/remove list will be<br />
updated.<br />
<br />
- :D Hendri :D -</div></div><hr />


<div class="post"><div class="posttop"><div class="username">justin</div><div class="date">23rd November 2001, 03:17</div></div><div class="posttext">Having the uninstaller return 1 will actually not help these, because when executed the uninstaller copies itself to the system temporary directory, runs itself from that directory, and quits instantly. For this reason, the list is not properly refreshed. I'm not sure of a good workaround (maybe the uninstaller can signal the windows add/remove programs dialog to refresh?)...<br />
<br />
-Justin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anton/five</div><div class="date">23rd November 2001, 04:59</div></div><div class="posttext">Smile2Me, I really remove these entries from the Registry during uninstalling, but the Add/Remove List will be updated only after closing its window and following opening.<br />
I have done some tests and got to know that if an uninstaller return 1, the Add/Remove List will be refreshed immediately.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anton/five</div><div class="date">23rd November 2001, 05:01</div></div><div class="posttext">justin, I got it. It is really hard to make a good workaround.<br />
By the way, I tried to send the broadcast WM_SETTINGCHANGE message with 0 as parameters after uninstalling, but there was no effect. I do not know another way to signal the Add/Remove List. :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">justin</div><div class="date">23rd November 2001, 07:27</div></div><div class="posttext">Came up with a crappy way that works for me, at least in winME (the strings/etc might differ on win95/NT/2k/98/etc). Here it is:<br />
<br />
Function un.RefreshUninstallPanel<br />
Push $0<br />
Push $1<br />
StrCpy $1 &quot;&quot;<br />
again:<br />
  FindWindow $0 &quot;#32770&quot; &quot;Add/Remove Programs Properties&quot;<br />
  StrCmp $0 0 done<br />
  SendMessage $0 16 0 0<br />
  StrCpy $1 1<br />
  goto again<br />
done:<br />
  StrCmp $1 &quot;&quot; noopen<br />
    Exec '&quot;$WINDIR\control.exe&quot; appwiz.cpl'<br />
  noopen:<br />
Pop $1<br />
Pop $0<br />
FunctionEnd<br />
<br />
<br />
I'll see if I can come up with something better...<br />
<br />
-Justin<br />
<br />
P.S. It might be the most elegant to call this from un.onUninstSuccess...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">23rd November 2001, 08:25</div></div><div class="posttext">Well ok, I see your point now.<br />
Actually I'm running Win2k and<br />
I didn't have this problem, but<br />
I tested it on another machine...<br />
<br />
Indeed you're both right (of course).<br />
<br />
Sorry for my remark,<br />
<br />
- :D Smile2Me :D -</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>