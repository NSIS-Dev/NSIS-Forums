<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Best option to detect OS?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Best option to detect OS? NSIS Discussion" />
	
	<title> Best option to detect OS? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Best option to detect OS?</div>
<hr />
<div class="pda"><a href="t-294988.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=294988">Best option to detect OS?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">zanz</div><div class="date">23rd July 2008, 20:56</div></div><div class="posttext">I want to limit my installation to:<br />
<br />
- Windows NT only AND Windows 2k, Win XP, and Win Vista only. Nor Win Server or Win 98.<br />
<br />
I see there's WinVer.nsh that requires some manipulation. Is using WinVer.nsh my best option, is there a developed plug-in (which would work on both XP and Vista)? Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">23rd July 2008, 21:08</div></div><div class="posttext">WinVer will detect all of those IIRC.<br />
<br />
If not then there's the GetVersion plug-in.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zanz</div><div class="date">23rd July 2008, 22:09</div></div><div class="posttext">I think I'll give getVersion plug-in a try first...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zanz</div><div class="date">23rd July 2008, 23:19</div></div><div class="posttext">I'm using the plug in, but i get an error when i compile:<br />
<br />
Error: could not resolve label &quot;_LogicLib_Label_3&quot; in function &quot;MyOSDetectFunction&quot;<br />
<br />
<br />
Below is my function...what could be wrong?<br />
Function MyOSDetectFunction<br />
<br />
	GetVersion::WindowsName<br />
	Pop $R0<br />
	<br />
	DetailPrint &quot;WindowsName:&quot;<br />
	DetailPrint &quot;  $R0&quot;<br />
<br />
	;check if OS is XP<br />
	${If} $R0 == 'XP'<br />
		Goto Done<br />
	Goto checkVista<br />
	${EndIf}<br />
<br />
;Check if OS is Vista<br />
checkVista:<br />
<br />
	${If} $R0 == 'Vista'<br />
		Goto Done<br />
	 Goto checkWin2k<br />
<br />
;Check if OS is Win 2000<br />
checkWin2k:<br />
	${If} $R0 == '2000'<br />
		Goto Done<br />
	 Goto printMessageAndAbort<br />
	 <br />
printMessageAndAbort:<br />
	MessageBox MB_OK|MB_ICONINFORMATION &quot;System not supported.&quot;<br />
	Abort &quot;Existing installation...&quot;<br />
<br />
Done: <br />
<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zanz</div><div class="date">23rd July 2008, 23:44</div></div><div class="posttext">Nevermind, i used the if-else combination and it works fine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th July 2008, 10:42</div></div><div class="posttext">You can just use WinVer for that.<br />
<br />
${Unless} ${IsWinVista}<br />
${AndUnless} ${IsWinXP}<br />
${AndUnless} ${IsWin2000}<br />
  MessageBox MB_OK|MB_ICONINFORMATION &quot;System not supported.&quot;<br />
  Abort<br />
${EndUnless}<br />
<br />
I assumed you needed something more.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>