<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" nsDialogs - using ${NSD_CreateListBox}, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  nsDialogs - using ${NSD_CreateListBox} NSIS Discussion" />
	
	<title> nsDialogs - using ${NSD_CreateListBox} [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  nsDialogs - using ${NSD_CreateListBox}</div>
<hr />
<div class="pda"><a href="t-276367.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=276367">nsDialogs - using ${NSD_CreateListBox}</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">johnbm</div><div class="date">23rd August 2007, 21:23</div></div><div class="posttext">I'm interested in using a listbox in nsDialogs. It's unclear to me from the documentation I have seen though how one can populate the listbox and once this is done how one captures the selection made in the listbox.<br />
<br />
If I use the code:<br />
<br />
${NSD_CreateListBox} 100 40 20% 12u &quot;sample entry&quot;<br />
<br />
it will create a blank listbox.<br />
<br />
Would anyone be able to clarify this for me?<br />
<br />
Thanks, John</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th August 2007, 08:36</div></div><div class="posttext">You can add items with LB_ADDSTRING.${NSD_CreateListBox} 100 40 20% 12u &quot;&quot;<br />
Pop $ListBox<br />
SendMessage $ListBox ${LB_ADDSTRING} 0 &quot;STR:Simple entry&quot;<br />
SendMessage $ListBox ${LB_ADDSTRING} 0 &quot;STR:Another entry&quot;<br />
SendMessage $ListBox ${LB_ADDSTRING} 0 &quot;STR:Blah&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jeffadams78</div><div class="date">24th August 2007, 16:51</div></div><div class="posttext">How do you get the selection from the list box?  And can you have a change function?  <br />
<br />
GetFunctionAddress $0 OnMyListBoxChange<br />
nsDialogs::OnChange /NOUNLOAD $MY_LIST_BOX $0<br />
<br />
Doesn't seem to work...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">24th August 2007, 17:26</div></div><div class="posttext">Look up MSDN for LB_ADDSTRING and you will see all the other list box messages available.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th August 2007, 17:33</div></div><div class="posttext">Send LB_GETCURSEL to get the selected state of an item.SendMessage $MY_LIST_BOX ${LB_GETCURSEL} 0 0 $0<br />
# $0 will not be zero if the item is selectedList box notification is only sent when the LBS_NOTIFY style is used. I have added it to the next version of nsDialogs.nsh. For the current version, you can manually create the list box when the desired flags or add |${LBS_NOTIFY} to the definition of __NSD_ListBox_STYLE in nsDialogs.nsh.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jeffadams78</div><div class="date">24th August 2007, 18:39</div></div><div class="posttext">LB_GETCURSEL returns the index or &quot;LB_ERR&quot; if no line is selected.  Any idea what LB_ERR is?  -1?  You don't appear to have it defined in nsDialogs.nsh.  The index is supposedly 0-based, so 0 is valid (first line).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th August 2007, 18:47</div></div><div class="posttext">It's -1.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jeffadams78</div><div class="date">24th August 2007, 18:48</div></div><div class="posttext">You beat me to the post ;).  LB_ERR = -1... because that's what I get back every time I send the LB_GETCURSEL message.  Any idea why that would be?------<br />
<br />
Nevermind, it was a bug in my code, I get the correct value from the message I wasn't copying it into the right variable.<br />
<br />
Manually creating the list box with LBS_NOTIFY worked great though as far as getting OnChange notifications.<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jeffadams78</div><div class="date">24th August 2007, 19:08</div></div><div class="posttext">Any reason why LB_GETTEXT wouldn't work?  I'm trying to get the text that the user selected, and I think this should work:<br />
<br />
  SendMessage $MY_LIST_BOX ${LB_GETCURSEL} 0 0 $0<br />
  ${IF} $0 &gt;= 0<br />
    IntOp $1 $0 + 0;<br />
    SendMessage $MY_LIST_BOX ${LB_GETTEXT} $1 $0 $2<br />
    MessageBox MB_OK '0: $0, 1: $1, 2: $2'<br />
  ${ENDIF}<br />
<br />
I always get back: $0 is the correct index (from the first SendMessage, the second one fails and doesn't write to it), $1 is the same (since I copied $0 into it), and $2 is LB_ERR, which according to the MSDN means that I passed an invalid index... but it is valid.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th August 2007, 19:10</div></div><div class="posttext">Yes, you need System::Call for that. SendMessage alone can't handle strings returning from the message.System::Call user32::SendMessage(i$MY_LIST_BOX,i${LB_GETTEXT},i$INDEX,t.$0)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jeffadams78</div><div class="date">24th August 2007, 19:21</div></div><div class="posttext">Hmm, that still didn't work.  I've actually changed my mind and decided that the index is fine for my purposes, but thanks for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">johnbm</div><div class="date">24th August 2007, 20:22</div></div><div class="posttext">kichik thanks for your help, that worked well and it's pointed me in the right direction on a number of things. I'm now trying to create a combobox with a dropdown style.<br />
<br />
${NSD_CreateComboBox} 200 20 20% 59u &quot;&quot;<br />
Pop $ComboBox<br />
SendMessage $ComboBox ${CB_ADDSTRING} 0 &quot;STR:First Entry&quot;<br />
SendMessage $ComboBox ${CB_ADDSTRING} 0 &quot;STR:Second Entry&quot;<br />
SendMessage $ComboBox ${CB_ADDSTRING} 0 &quot;STR:Third Entry&quot;<br />
<br />
I know that I need to use CBS_DROPDOWN to set the style and I expect that I add this as an extra parameter to <br />
<br />
${NSD_CreateComboBox} 200 20 20% 59u &quot;&quot;<br />
<br />
but I'm not sure of the syntax.<br />
<br />
I believe one may also be able to do this by using CreateWindow. Does anyone know how this is done?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">klopfdreh</div><div class="date">13th February 2008, 10:10</div></div><div class="posttext">Hello,<br />
<br />
I saw that thread about ListBox and I tried it by myself, but this codesnippet below doesn't work for me:<br />
<br />
<br />
${NSD_CreateListBox} 0 60 100% 100% &quot;&quot;<br />
Pop $ListBox<br />
SendMessage $ListBox ${LB_ADDSTRING} 0 &quot;HELLOOO&quot;<br />
<br />
<br />
I defined a Var ListBox and the Compiler compiled it without any errors. :weird: <br />
<br />
Thanks so far!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th February 2008, 10:14</div></div><div class="posttext">Use &quot;STR:HELLOOO&quot; instead of just &quot;HELLOOO&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">klopfdreh</div><div class="date">13th February 2008, 10:20</div></div><div class="posttext">Thanks kichik - thats right!<br />
<br />
And how can I clear the list?<br />
<br />
Edit: Saw it in some CPP Code<br />
<br />
<br />
SendMessage $ListBox ${LB_RESETCONTENT} 0 0<br />
<br />
<br />
Thanks a lot!<br />
<br />
P.S.:<br />
<br />
May you are able to help me with DialogsEx? I have another post here with a problem which hasn't been solved yet:<br />
<br />
Topic:<br />
Custom Page with FileSelect-Button<br />
<br />
URL:<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=286733</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ivan Andreevich</div><div class="date">16th December 2008, 19:23</div></div><div class="posttext">Ah, this was something I was looking for. <br />
<br />
I am using an nsDialogs DropList, so my code is slightly different. Here it is for reference. It's combo box commands.<br />
<br />
Clear droplist:<br />
SendMessage $DropList ${CB_RESETCONTENT} 0 0<br />
<br />
Add entry ($1) to droplist:<br />
SendMessage $DropList ${CB_ADDSTRING} 0 &quot;STR:$1&quot;<br />
<br />
Select entry ($1) in the droplist: <br />
SendMessage $DropList ${CB_SELECTSTRING} 0 &quot;STR:$1&quot;<br />
<br />
Ivan</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>