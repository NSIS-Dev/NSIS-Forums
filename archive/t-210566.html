<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Reading the last line of a file on successfull Java Install, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Reading the last line of a file on successfull Java Install NSIS Discussion" />
	
	<title> Reading the last line of a file on successfull Java Install [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Reading the last line of a file on successfull Java Install</div>
<hr />
<div class="pda"><a href="t-210566.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=210566">Reading the last line of a file on successfull Java Install</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">0x539</div><div class="date">16th March 2005, 10:09</div></div><div class="posttext">Hi<br />
<br />
I'm try to write a script that will automatically install Java if needed. So far I'm detecting through the registry what version of java is installed and downloading it if appropriate. My problem comes in that I don't know how to tell whether it has been successfully installed if need be. At the moment I've got it writing a log file for the install. What I want to do is parse the log file to get the last line which looks like this...<br />
<br />
&quot;MSI (s) (98:58): Product: Java 2 Runtime Environment, SE v1.4.2_06 -- Installation operation completed successfully.&quot;<br />
<br />
I then want to use the StrStr function in the manual to look for the string &quot;Installation operation completed successfully&quot;<br />
<br />
My read-the-last-line function looks like this...<br />
<br />
Function ReadLastLine<br />
	ClearErrors<br />
	FileOpen $0 &quot;setup.log&quot; &quot;r&quot;<br />
	loop:<br />
		FileRead $0 $1 100<br />
		;Dumpstate::debug		<br />
		DetailPrint $1<br />
		IfErrors done<br />
		Goto loop<br />
	done:<br />
	DetailPrint $1<br />
	FileClose $0<br />
	Push $1<br />
 FunctionEnd<br />
<br />
It doesn't matter what I put for the max length, it always only reads in one character from the file.<br />
<br />
I'd be grateful for any help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">16th March 2005, 11:33</div></div><div class="posttext">May be installer's exit code also can help (MSI in your case), ExecWait sets user' variable with this value.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Instructor</div><div class="date">16th March 2005, 17:10</div></div><div class="posttext">Function LineRead<br />
http://nsis.sourceforge.net/archive/nsisweb.php?page=620&amp;instances=0,11,311</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>