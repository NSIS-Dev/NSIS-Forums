<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" determine highest value in a specified section, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  determine highest value in a specified section NSIS Discussion" />
	
	<title> determine highest value in a specified section [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  determine highest value in a specified section</div>
<hr />
<div class="pda"><a href="t-117191.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=117191">determine highest value in a specified section</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">9th December 2002, 01:16</div></div><div class="posttext">long time ago, smile2me helped me on a script i used on an add-on for mIRC (http://www.mirc.co.uk):<br />
<br />
Function FindNumber<br />
 Exch $0<br />
 Push $1<br />
 Push $2<br />
 StrCpy $1 &quot;0&quot;<br />
<br />
 loop:<br />
 IntOp $1 $1 + 1<br />
 StrCpy $2 $0 1 $1<br />
 StrCmp $2 &quot;=&quot; 0 loop<br />
 StrCpy $0 $0 $1<br />
 Pop $2<br />
 Pop $1<br />
 Exch $0<br />
FunctionEnd<br />
<br />
Section -config<br />
 StrCpy $R9 &quot;0&quot;<br />
 fileopen $0 &quot;servers.ini&quot; &quot;r&quot;<br />
<br />
 Loop:<br />
 fileread $0 $1<br />
 StrCmp $1 &quot;&quot; ExitLoop<br />
 StrCpy $2 $1 1<br />
 StrCmp $2 &quot;n&quot; 0 Loop<br />
 StrCpy $2 $1 &quot;&quot; 1<br />
 Push $2<br />
 Call FindNumber<br />
 Pop $2<br />
 IntCmp $2 $R9 Loop Loop<br />
 StrCpy $R9 $2<br />
 Goto Loop<br />
 <br />
 ExitLoop:<br />
 FileClose $0<br />
 MessageBox MB_OK &quot;The highest entry is $R8&quot;<br />
<br />
i'd love to use this script on the mirc.ini, which in difference to the servers.ini has various sections. the layout of mirc.ini looks like this:<br />
<br />
[section]<br />
n0=entry 0<br />
n1=entry 1<br />
n2=entry 2<br />
<br />
[another section]<br />
n0=entry 0<br />
n1=entry 1<br />
n2=entry 2<br />
etc.<br />
<br />
i could need a helping hand on how to modify the script above to do the following.<br />
<br />
i need to script to do the same in a specified section, let's say determine the highest value (nX) in a section [example].</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">9th December 2002, 01:26</div></div><div class="posttext">i got the working script above by adding this:<br />
<br />
ExitLoop:<br />
 FileClose $0<br />
 IntOp $R8 $R9 + 1<br />
 WriteINIStr servers.ini servers n$R8 &quot;some entry&quot;<br />
<br />
now i want to use the last line multiple times, which of course requires a different value for $R8.<br />
<br />
 IntOp $R8 $R9 + 1<br />
WriteINIStr servers.ini servers n$R8 &quot;some entry&quot;<br />
IntOp $R8 $R8 + 1<br />
WriteINIStr servers.ini servers n$R8 &quot;some entry&quot;<br />
IntOp $R8 $R8<br />
<br />
did not work (which is natural i guess). but i dont know how to solve this issue. of course i could rename the string $R8 to something different, but then i'm still limited to $R0 - $R9. is there a more elegant way to solve this (a loop maybe?).<br />
<br />
help is highly appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th December 2002, 17:01</div></div><div class="posttext">First of all, please attach large scripts next time and don't open a new thread for a question that continues the one from another thread of yours.<br />
<br />
Now, to get the highest number in a specified section I would take a different approach since the one presented here gets the highest number in the first section found that has an entry starting with &quot;n&quot;.<br />
<br />
StrCpy $0 0<br />
Loop:<br />
	ReadINIStr $1 &quot;mirc.ini&quot; &quot;insert desired ini section name here&quot; n$0<br />
	IfErrors Done<br />
	IntOp $0 $0 + 1<br />
	Goto Loop<br />
<br />
Done: ; $0 is now the first unused number in the INI file section<br />
<br />
To add entries then, all you need to do is call WriteIniStr and after each time you call it use IntOp $0 $0 + 1 to make sure the number you get is unique.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">9th December 2002, 23:28</div></div><div class="posttext">does not work, always reports &quot;0&quot; (i used messagebox to check this)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th December 2002, 14:23</div></div><div class="posttext">It works perfectly fine for me... Are you sure you have specified the right path to mirc.ini and the right section name?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">10th December 2002, 14:59</div></div><div class="posttext">i tried [section] and  section , both resulted the same. if you have the time, i can send you the script via icq, you got my uin ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">11th December 2002, 13:21</div></div><div class="posttext">is it possible to additionally use a duplicate-filter?<br />
<br />
n0=Leningrad<br />
n1=Paris<br />
n2=Madrid<br />
<br />
at this point it wouldnt be necessary to add n3=Leningrad, since it exists already. any chance to avoid duplicates in that script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">11th December 2002, 15:22</div></div><div class="posttext">You can compare the value you want to add with each n# and if it's already there just not add it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">11th December 2002, 21:24</div></div><div class="posttext">hm, but what about the prefix &quot;nX=&quot; ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th December 2002, 15:24</div></div><div class="posttext">ReadINIStr reads the value. The value doesn't include the nX=.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>