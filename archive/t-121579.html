<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" .NET Framework Section Question, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  .NET Framework Section Question NSIS Discussion" />
	
	<title> .NET Framework Section Question [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  .NET Framework Section Question</div>
<hr />
<div class="pda"><a href="t-121579.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=121579">.NET Framework Section Question</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">mistertea</div><div class="date">15th January 2003, 21:41</div></div><div class="posttext">I have already created a function for checking if the .NET Framework is installed (attached). If neither version is installed, I would like the installer to create a read-only section with &quot;.NET Framework&quot;. On the finish page, it would be nice if I could get a checked/read-only box with &quot;Install .NET Framework Now&quot; which runs the setup program after it has been unpacked and the have it run silently with:ExecWait('&quot;.NET Framework 1.1 Redistributable Final Beta.exe&quot; dotnetfx.exe /q:a /c:&quot;install /l /q&quot;'If the .NET Framework is detected, I would like nothing to be done. (No setup program extracted, nothing installed but the main program.)<br />
<br />
Is this feasible?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">virtlink</div><div class="date">16th January 2003, 18:46</div></div><div class="posttext">AFAIK there is no instruction that can change the read-only parameter of a Section. So it isn't (yet) possible. Maybe an idea for NSIS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mistertea</div><div class="date">16th January 2003, 23:36</div></div><div class="posttext">Hmmm, that'll be okay for now.<br />
<br />
I was just wondering if it is possible to add sections using functions. So is this (adding sections with functions) currently possible?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th January 2003, 11:50</div></div><div class="posttext">It's not possible to create functions but it is possible to change every flag of a section including read-only at runtime using SectionSetFlags and SectionGetFlags. You must do it before or after the components page shows because while it does you can only change the selected and bold flag.<br />
<br />
What you need to do is create a RO section with the approriate name. Upon runtime, if you don't need this section to be shown in the components page and executed set its flags to not have SF_SELECTED and set its name to nothing.<br />
<br />
For example:<br />
<br />
<br />
StrCmp $0 &quot;noneed&quot; 0 donthide<br />
  # 0 doesn't include SF_SELECTED of course :)<br />
  SectionSetFlags ${SEC} 0<br />
  SectionSetText ${SEC} &quot;&quot;<br />
donthide:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mistertea</div><div class="date">17th January 2003, 23:46</div></div><div class="posttext">I have decided to take a difference approach and check for .NET using ASP 3.0, which points you to the version of the installer that you need.<br />
<br />
Now I need the installer to instead extract a file from itself to a temp directory, ExecWait that file, and then delete that file after the setup is over. How can I accomplish this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">18th January 2003, 05:43</div></div><div class="posttext">Try this:<br />
<br />
<br />
InitPluginsDir<br />
File /oname=$PLUGINSDIR/\file2exec.exe mylocalfile.exe<br />
<br />
<br />
Then just exec the file and the file will be deleted automatically when the installer finishes because it is in the plugins dir.  If you are using Modern UI, i believe it already inits the plugins dir so that line is not neeeded.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rainwater</div><div class="date">18th January 2003, 05:46</div></div><div class="posttext">Sorry, the slash is backwards because the forum doesn't like the slash.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mistertea</div><div class="date">18th January 2003, 07:31</div></div><div class="posttext">Thanks everyone very much for your help!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>