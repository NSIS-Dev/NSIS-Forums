<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MUI_FINISHPAGE in modern.exe ?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MUI_FINISHPAGE in modern.exe ? NSIS Discussion" />
	
	<title> MUI_FINISHPAGE in modern.exe ? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MUI_FINISHPAGE in modern.exe ?</div>
<hr />
<div class="pda"><a href="t-213190.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=213190">MUI_FINISHPAGE in modern.exe ?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Huette</div><div class="date">14th April 2005, 15:50</div></div><div class="posttext">I want to customize the MUI_FINISHPAGE with Resource Hacker, but I can't find the right resource for that dialog. How can I find out where it is, except comparing the dialog-previews in Resource Hacker with my running setup?<br />
Thx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">14th April 2005, 18:36</div></div><div class="posttext">The finish page is an InstallOptions page, not a normal page found in modern.exe. You can edit ioSpecial.ini in $PLUGINSDIR in the pre function of the welcome and finish page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Huette</div><div class="date">15th April 2005, 09:19</div></div><div class="posttext">hmmm....pre function means?<br />
i can't manage to show that label nor the header_text.<br />
maybe you can tell me what i'm doing wrong.<br />
- first i added a label to the ioSpecial.ini:<br />
[Field 4]<br />
Type=Label<br />
Left=50<br />
Right=86<br />
Top=134<br />
Bottom=142<br />
- then i have to extract the ioSpecial.ini in .onInit-Function?<br />
!insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;ioSpecial.ini&quot; doesn't work:<br />
&quot;!insertmacro: macro named &quot;MUI_INSTALLOPTIONS_EXTRACT&quot; not found!&quot;   ...no idea...<br />
- page custom FinishpageEdit<br />
!insertmacro MUI_PAGE_FINISH<br />
<br />
- Function FinishpageEdit<br />
<br />
  !insertmacro MUI_HEADER_TEXT &quot;Test&quot; &quot;TestSub&quot;<br />
<br />
  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;ioSpecial.ini&quot;<br />
<br />
  FunctionEnd<br />
<br />
...first edit header_text....if that works own label will follow...<br />
<br />
anything missing?  !include headerfile?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th April 2005, 22:53</div></div><div class="posttext">pre function means MUI_PAGE_CUSTOMFUNCTION_PRE in this case. See the MUI readme for more information about using it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Huette</div><div class="date">18th April 2005, 12:23</div></div><div class="posttext">can somebody describe the function (not the content) of the ioSpecial.ini detailed? or can i read it somewhere? <br />
<br />
instead of adding a new label, now i just try to enlarge the checkbox in the finishpage, so i can set a longer text (in mui languagefile). But where can i set the width and height of it? There are only two labels and one bitmap defined in the ioSpecial.ini . Where comes that checkbox from? In &quot;Local Settings\Temp\&quot; i can find another ioSpecial.ini with the settings of the finishpage (checkbox included), but changes are not decisive.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Huette</div><div class="date">18th April 2005, 16:25</div></div><div class="posttext">if i could set the postition of the checkbox it would help me, too, because then i could add the text to the label above the checkbox (why is the label hidden by the checkbox, if it's text gets longer?). strange thing, that checkbox. no own component in modern.exe? integrated into the label? I ain't that hard to add a little text to the finishpage, is it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th April 2005, 19:31</div></div><div class="posttext">The MUI edits the INI on runtime according to the defines you add in the script. Take a look at the MUI_FUNCTION_FINISHPAGE macro in Contrib\Modern UI\System.nsh. Notice especially the following line which is called after the MUI finished writing into ioSpecial.ini:!insertmacro MUI_PAGE_FUNCTION_CUSTOM PREThat line calls your PRE function in which you can change ioSpecial.ini.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">20th April 2005, 01:36</div></div><div class="posttext">There's probably other ways to do this, but here's a trick you can use help eliminate some of the guesswork in editing the ioSpecial.ini file while keeping the same general look to the page:<br />
<br />
The ioSpecial.ini file gets created in the plugins directory at runtime.  If you were to temporarily insert the following code into your .onInit function, you'd know which folder was the PLUGINS folder:<br />
<br />
InitPluginsDir<br />
MessageBox MB_OK &quot;PluginsDir: $PLUGINSDIR&quot;<br />
<br />
<br />
Once this is in place, execute your installer.  Make a note of this path and the click OK.  (the path will change each time time you run the install).  Continue with the install until you get to the finish page.  Then, open the plugins folder.  You should see the ioSpecial.ini.  Make a copy of this file and store it somewhere.  This can then be a &quot;template&quot; you can use to tweak your own page. (I prefer to use the built-in InstallOptions editor from HM NIS EDIT.)  Once you know what you need to change, then it's just matter of inserting the proper WriteIniStr commands in your PRE function.<br />
<br />
Enjoy!:cool:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Huette</div><div class="date">20th April 2005, 07:25</div></div><div class="posttext">thanks. i finished customizing my finishpage now. didn't really understand the MUI_INSTALLOPTIONS_WRITE line. now everything looks like it shoud.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>