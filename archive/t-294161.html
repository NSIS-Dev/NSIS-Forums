<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Program group, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Program group NSIS Discussion" />
	
	<title> Program group [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Program group</div>
<hr />
<div class="pda"><a href="t-294161.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=294161">Program group</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">richiebabes</div><div class="date">8th July 2008, 16:11</div></div><div class="posttext">You know in some installs you get a page asking you to add the program to a group. Is there an NSIS page extant that I can use for this? Googled it but couldn't find any info.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">8th July 2008, 16:52</div></div><div class="posttext">When you say &quot;program group&quot;, do you mean &quot;start menu folder&quot;?  If so, have a look a the MUI/MUI2 docs regarding the start menu page.  (There's also an example &quot;StartMenu.nsi&quot; located in ${NSISDIR}\Examples\Modern UI)<br />
<br />
If that's not it, then perhaps attach an example of what you mean.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">richiebabes</div><div class="date">8th July 2008, 19:23</div></div><div class="posttext">Thanks for the pointer. I don't want to be rude, because I love NSIS, but the documentation for MUI_PAGE_STARTMENU is lousy! What do the two parameters mean? I want to show the product name in the edit box on the dialog but I can only seem to get the path. I have tried these:<br />
<br />
!insertmacro MUI_PAGE_STARTMENU &quot;Application&quot; $StartMenuFolder<br />
!insertmacro MUI_PAGE_STARTMENU &quot;Application&quot; $INSTDIR<br />
!insertmacro MUI_PAGE_STARTMENU $(PRODUCT_NAME) $INSTDIR<br />
!insertmacro MUI_PAGE_STARTMENU &quot;Application&quot; $(PRODUCT_NAME)<br />
<br />
And other variations. The only thing it liked for the second parameter was $INSTDIR - and then the whole path appears in the edit box. Arghh! Help! S.O.S.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">8th July 2008, 19:45</div></div><div class="posttext">It's all in the MUI docs! :weird: <br />
<br />
I think the correct syntax would be:<br />
<br />
Var $StartMenuFolder<br />
<br />
...<br />
<br />
!insertmacro MUI_PAGE_STARTMENU MyPageID $StartMenuFolder<br />
<br />
...<br />
<br />
Section &quot;Shortcuts&quot;<br />
  CreateDirectory &quot;$SMPROGRAMS\$StartMenuFolder&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\$StartMenuFolder\Run My Application.lnk&quot; &quot;$INSTDIR\Program.exe&quot;<br />
SectionEnd<br />
<br />
<br />
<br />
To configure the Startmenu page put these *before* the page macro:<br />
<br />
!define MUI_STARTMENUPAGE_TEXT_TOP &quot;$(PRODUCT_NAME)&quot;<br />
!define MUI_STARTMENUPAGE_TEXT_CHECKBOX &quot;Checkbox text&quot;<br />
!define MUI_STARTMENUPAGE_DEFAULTFOLDER &quot;My Company\$(PRODUCT_NAME)&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_ROOT HKCU<br />
!define MUI_STARTMENUPAGE_REGISTRY_KEY &quot;SOFTWARE\My Company\$(PRODUCT_NAME)&quot;<br />
!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME &quot;Startmenu&quot;<br />
<br />
And in your Uninstaller you would use:<br />
<br />
Section Uninstall<br />
  ...<br />
  !insertmacro MUI_STARTMENU_GETFOLDER MyPageID $0<br />
  Delete &quot;$SMPROGRAMS\$0\Your Shortcut.lnk&quot;<br />
  ...<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">8th July 2008, 20:35</div></div><div class="posttext">If the only thing it accepted was $INSTDIR then you are missing Var StartMenuFolder.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">richiebabes</div><div class="date">8th July 2008, 22:10</div></div><div class="posttext">What is the check box for? When I check it everything is grayed out. What's the point of that? What would the text typically be?<br />
<br />
I get an error: LangString &quot;PRODUCT_NAME&quot; is not set in language table of language English<br />
<br />
I have a !define for PRODUCT_NAME<br />
<br />
Also the registry key - what would I put for &quot;My Company&quot;? My company or leave it for the user or what?<br />
<br />
Help! Can't find any documentation on it!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">9th July 2008, 00:04</div></div><div class="posttext">Originally posted by richiebabes <br />
What is the check box for? When I check it everything is grayed out. What's the point of that? What would the text typically be?<br />
<br />
I get an error: LangString &quot;PRODUCT_NAME&quot; is not set in language table of language English<br />
<br />
I have a !define for PRODUCT_NAME <br />
<br />
<br />
Leran to search the docs :p <br />
<br />
LangString is *not* !define :mad: <br />
<br />
!define MyDefine &quot;Some important string&quot;<br />
<br />
LangString MyLangStr ${LANG_ENGLISH} &quot;Hello world!&quot;<br />
LangString MyLangStr ${LANG_GERMAN} &quot;Hallo Welt!&quot;<br />
<br />
Section<br />
  DetailPrint &quot;This is a define: ${MyDefine}&quot;<br />
  DetailPrint &quot;This is a localized string: $(MyLangStr)&quot;<br />
SectionEnd<br />
Notice () versus {} !!!<br />
<br />
<br />
Originally posted by richiebabes <br />
Also the registry key - what would I put for &quot;My Company&quot;? My company or leave it for the user or what?<br />
<br />
Help! Can't find any documentation on it!  <br />
<br />
Make sure you use a unique Registry key!<br />
<br />
And of course &quot;My Company&quot; was a placeholder ;)<br />
<br />
An Example would be:<br />
Software\PandeGroup\Folding@home\5.03</div></div><hr />


<div class="post"><div class="posttop"><div class="username">richiebabes</div><div class="date">9th July 2008, 00:27</div></div><div class="posttext">Thanks - I am the world's worst searcher of docs.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">9th July 2008, 00:43</div></div><div class="posttext">Examples can help a lot, if you don't like or don't have docs ;)<br />
<br />
I recommand you have a deep look at:<br />
NSIS\Examples\Modern UI\StartMenu.nsi</div></div><hr />


<div class="post"><div class="posttop"><div class="username">richiebabes</div><div class="date">9th July 2008, 19:10</div></div><div class="posttext">Where will I find this?<br />
<br />
Software\PandeGroup\Folding@home\5.03</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">9th July 2008, 19:33</div></div><div class="posttext">Originally posted by richiebabes <br />
Where will I find this?<br />
<br />
Software\PandeGroup\Folding@home\5.03  <br />
<br />
You won't find this on your system, unless you have installed Folding@Home. It was just an example :rolleyes: <br />
<br />
<br />
However you can inspect the Registry via:<br />
START -&gt; Run -&gt; &quot;regedit&quot;<br />
<br />
Your entry would be located at:<br />
My Computer &gt; HKEY_CURRENT_USER &gt; SOFTWARE &gt; My Company &gt; My Product<br />
<br />
Note that &quot;My Company&quot; and &quot;My Product&quot; are placeholders for real names ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">richiebabes</div><div class="date">17th July 2008, 22:09</div></div><div class="posttext">Still wondering about the check box. What's it for? If you check it then it grays out the area. What's the point of that? And what text would typically be put there? And would it typically be checked or unchecked on entering the dialog?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LoRd_MuldeR</div><div class="date">17th July 2008, 22:34</div></div><div class="posttext">The user checks the checkbox if he doesn't want to have a StartMenu entry created. Otherwise he enters the name of the StartMenu folder he want's to have created by your installer. Use the provided macros to implement that behavior properly!<br />
<br />
Var StartmenuFolder<br />
<br />
...<br />
MUI_PAGE_STARTMENU MyStartMenuPage $StartmenuFolder<br />
...<br />
<br />
Section &quot;-Shortcuts&quot;<br />
  ...<br />
  !insertmacro MUI_STARTMENU_WRITE_BEGIN MyStartMenuPage<br />
    CreateFolder &quot;$SMPROGRAMS\StartmenuFolder&quot;<br />
    CreateShortcut &quot;$SMPROGRAMS\StartmenuFolder\Shortcut.lnk&quot; &quot;$INSTDIR\Program.exe&quot;<br />
    ...<br />
  !insertmacro MUI_STARTMENU_WRITE_END<br />
  ...<br />
SectionEnd<br />
<br />
...<br />
<br />
Section &quot;Uninstall&quot;<br />
  ...<br />
  !insertmacro MUI_STARTMENU_GETFOLDER MyStartMenuPage $R0<br />
  Delete &quot;$SMPROGRAMS\$R0\Shortcut.lnk&quot;<br />
  RMDir &quot;$SMPROGRAMS\$R0&quot;<br />
  ...<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">richiebabes</div><div class="date">17th July 2008, 23:14</div></div><div class="posttext">A thousand thanks. I am forever in your debt. :-)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>