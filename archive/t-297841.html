<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Cannot create new user on Windows Server 2008, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Cannot create new user on Windows Server 2008 NSIS Discussion" />
	
	<title> Cannot create new user on Windows Server 2008 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Cannot create new user on Windows Server 2008</div>
<hr />
<div class="pda"><a href="t-297841.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=297841">Cannot create new user on Windows Server 2008</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">JasnaPaka</div><div class="date">25th September 2008, 10:48</div></div><div class="posttext">In last two days I'm trying to resolve one problem with creating new user account. In my install program I distribute PostgreSQL in ZIP version (no installer). Install program is trying to create new user account which is needed for running service (PostgreSQL cannot be run under actual user). I'm using UserMgr plugin.<br />
<br />
My steps are simple:<br />
* create new user <br />
* give him &quot;SeServiceLogonRight&quot; right<br />
<br />
UserMgr::CreateAccountEx &quot;login&quot; &quot;password&quot; &quot;aaaa&quot; &quot;aa&quot; &quot;aaa&quot; &quot;UF_PASSWD_CANT_CHANGE|UF_DONT_EXPIRE_PASSWD&quot;<br />
UserMgr::AddPrivilege &quot;login&quot; &quot;SeServiceLogonRight&quot;<br />
<br />
I need user account where password doesn't expire. Lines above work fine on my Windows XP and Windows Vista with UAC but I have a problem on Windows Server 2008 and with one customer which is in Windows domain.<br />
<br />
On Windows Server 2008 I have administrator rights but when I try to create new user account in install program I get &quot;Error 2254&quot;. When I try create new standard user via command line I get error &quot;access denied&quot;.<br />
<br />
&quot;C:\temp&gt;net user [user] [password] /Add<br />
System error 5 has occurred.<br />
<br />
Access is denied.&quot;<br />
<br />
But when I try add new user via GUI in Windows Server 2008, all works fine. If I try install PostgreSQL via official installer (which create new system user too), all works fine and new user is created. So there is some way how to create new user but I don't know how.<br />
<br />
Second problem with creating new user is in our customer which is in Windows domain and have a similar problem. I'm not sure if there is a possibility to create new user because what I know at this moment, his account is limited. <br />
<br />
My questions are<br />
-----------------<br />
* how can I create new user account for running service under this new user on systems where I cannot create new account via lines above?<br />
* if actual user doesn't have enough rights to create new user. How can I detect it?<br />
<br />
Thanks for your answers.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JasnaPaka</div><div class="date">25th September 2008, 13:59</div></div><div class="posttext">I did some more tests. I have created small utility which add new user via WinAPI call (function NetUserAdd, using for example here: http://nsis.sourceforge.net/User_Management_using_API_calls#Create_User). When I run this utility on command line, user hasn't added successfully. When I run cmd.exe like administrator (context menu, option: &quot;Run as administrator&quot;) all works correctly. I have this problem on Windows Server 2008 only, on Windows Vista with UAC all works fine. Any ideas?</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>