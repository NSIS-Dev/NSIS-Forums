<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with CreateShortCut pointing to Internet pages, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with CreateShortCut pointing to Internet pages NSIS Discussion" />
	
	<title> Problem with CreateShortCut pointing to Internet pages [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with CreateShortCut pointing to Internet pages</div>
<hr />
<div class="pda"><a href="t-58360.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=58360">Problem with CreateShortCut pointing to Internet pages</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">ametrano</div><div class="date">27th August 2001, 11:41</div></div><div class="posttext">I have a problem with the following snippet:<br />
<br />
  CreateShortCut &quot;$SMPROGRAMS\QuantLib\QuantLib Home Page.lnk&quot; \<br />
                 &quot;http://quantlib.org/index.html&quot;<br />
<br />
When I use the startup menu entry &quot;QuantLib Home Page&quot; I get the followig error:<br />
&quot;The file or folder 'quantlib.org/index.html' that this shortcut refers to cannot be found&quot;<br />
<br />
I get the same error with the NSIS installer itself, as it adds a shortcut to the NSIS Home Page that results in:<br />
&quot;The file or folder 'nsis/' that this shortcut refers to cannot be found&quot;<br />
That shortcut is generated by the following snippet in makensis.nsi:<br />
<br />
  CreateShortCut &quot;$SMPROGRAMS\NSIS\NSIS Home Page.lnk&quot; \<br />
                 &quot;http://www.nullsoft.com/free/nsis/&quot;<br />
<br />
thank you in advance for your help<br />
<br />
ciao -- Nando</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pjw62</div><div class="date">27th August 2001, 21:52</div></div><div class="posttext">how very curious.. this works under win2k, but not '98. The easiest solution I could find was to change the likn to `start internet_address`..  BUT, then you dont get the nice icon, and you get a console pop up, which I hate. So you could include .url files in the installer.<br />
<br />
.url files take the format..<br />
<br />
[InternetShortcut]<br />
URL=url_goes_here<br />
<br />
e.g.<br />
[InternetShortcut]<br />
URL=http://www.incomplete.co.uk/nsis.htm<br />
<br />
However, a more desirable solution is to generate these files at run time. Please feel free to use the below script, and please say if you find it useful..<br />
<br />
The delete part is so that an existing link is removed as WriteINIStr concentates enntries/.. while this is not a problem in itself, the user doesn't want to end up with a potential infinitely sized file after an infinite number of installs..<br />
<br />
; file name of URL (_MUST_ be full path otherwise it will be created int he windows directory).<br />
strcpy $0 &quot;C:\programs\nsisdll\examples\test.url&quot;<br />
<br />
Delete $0<br />
WriteINIStr $0 \ <br />
      &quot;InternetShortcut&quot; &quot;URL&quot; \<br />
      &quot;http://www.incomplete.co.uk/nsis.htm&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DuaneJeffers</div><div class="date">28th August 2001, 04:19</div></div><div class="posttext">This works in Win98 and WinME, it might just be your computer. Everything works. And the .url thing will work, but so will the .lnk files. What version of Win32 are you using, and it might be done with/without simple fixes.<br />
<br />
-DJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">spaetz</div><div class="date">28th August 2001, 12:52</div></div><div class="posttext">It doesn't work on my Win98 computer, but I know how to create these files with NSIS on the fly:<br />
<br />
WriteINIStr &quot;$SMPROGRAMS\Freenet\FN Homepage.url&quot; &quot;InternetShortcut&quot; &quot;URL&quot; &quot;http://www.freenetproject.org&quot;  <br />
<br />
Should do the trick...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pjw62</div><div class="date">28th August 2001, 15:16</div></div><div class="posttext">It doesn't work on my Win98 either..  spaetz.. errm, of course you know how to do it, I just posted that method earlier.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">spaetz</div><div class="date">28th August 2001, 15:44</div></div><div class="posttext">oops, I though you had just described the file format and didn't read the post thoroughly enough, my bad. Sorry :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DuaneJeffers</div><div class="date">29th August 2001, 00:31</div></div><div class="posttext">Well, I will tell you, it does work for my Win98 and WinME computers. It may just be your guys' computers.<br />
<br />
-DJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pjw62</div><div class="date">29th August 2001, 16:16</div></div><div class="posttext">&quot;It may just be your guys' computers.&quot; - Win98 comes in several builds, especially once you get installing different internet explorers. It is not my computer, as under win2k pro build 2195 rc3 (final), it works fine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ametrano</div><div class="date">11th October 2001, 14:07</div></div><div class="posttext">Thanks to all who replied.<br />
<br />
I solved the problem thanks to your suggestions. Now the QuantLib open source project ships with the Null Soft Installer (http://quantlib.org). Here's a snippet from the .nsi file:<br />
<br />
#it doesn't work<br />
#  CreateShortCut &quot;$SMPROGRAMS\QuantLib\QuantLib Home Page.lnk&quot; \<br />
#                 &quot;http://quantlib.org/index.html&quot;<br />
#this works<br />
  WriteINIStr &quot;$SMPROGRAMS\QuantLib\QuantLib Home Page.url&quot; \<br />
              &quot;InternetShortcut&quot; &quot;URL&quot; &quot;http://quantlib.org/&quot;<br />
<br />
I'm using this on WinNT4 patch 6a.<br />
<br />
Since the problem was also with NSIS itself anybody knows how to report this problem to the NSIS developer(s)?<br />
<br />
I would also like to add QuantLib to the list of NSIS users at http://www.nullsoft.com/free/nsis/users.html, but I don't know any email address I could use to this effect.<br />
<br />
I haven't understood what pwj62 wrote:<br />
&gt; The delete part is so that an existing link is removed as<br />
&gt; WriteINIStr concentates enntries/.. while this is not a problem in<br />
&gt; itself, the user doesn't want to end up with a potential infinitely<br />
&gt; sized file after an infinite number of installs.. <br />
&gt;<br />
&gt;; file name of URL (_MUST_ be full path otherwise it will be<br />
&gt; created int he windows directory).<br />
&gt; strcpy $0 &quot;C:\programs\nsisdll\examples\test.url&quot;<br />
&gt; Delete $0<br />
&gt; WriteINIStr $0 \ <br />
&gt; &quot;InternetShortcut&quot; &quot;URL&quot; \ <br />
&gt; &quot;http://www.incomplete.co.uk/nsis.htm&quot;<br />
<br />
what's about the delete part? Sorry if this is a naive question.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ametrano</div><div class="date">11th October 2001, 14:16</div></div><div class="posttext">forgot to say I was using NSIS 1.44<br />
<br />
Now updating to 1.55<br />
<br />
ciao -- Nando</div></div><hr />


<div class="post"><div class="posttop"><div class="username">prodangle</div><div class="date">13th October 2001, 15:52</div></div><div class="posttext">Originally posted by ametrano <br />
.................<br />
<br />
I would also like to add QuantLib to the list of NSIS users at http://www.nullsoft.com/free/nsis/users.html, but I don't know any email address I could use to this effect.<br />
<br />
<br />
email justin (he's at Nullsoft)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>