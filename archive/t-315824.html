<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Create installer with the same version as the main application executable, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Create installer with the same version as the main application executable NSIS Discussion" />
	
	<title> Create installer with the same version as the main application executable [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Create installer with the same version as the main application executable</div>
<hr />
<div class="pda"><a href="t-315824.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=315824">Create installer with the same version as the main application executable</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">madden</div><div class="date">29th December 2009, 11:58</div></div><div class="posttext">Hello<br />
<br />
I would like to always version my installer with the same version  as the main executable in the packaged application.<br />
<br />
Can I read the version info resource from an executable at compile-time and then set the Output file name to include it or set the version info instructions to include it ?<br />
<br />
Thank you,<br />
Timothy Madden</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">29th December 2009, 17:05</div></div><div class="posttext">for this, I use a small command-line tool I made, which takes an EXE and generates a NSH script.<br />
So I call my tool in my NSI script with !execute, and I !include the result:<br />
!execute &quot;mytool.exe mainprogram.exe output.nsh&quot;<br />
!include &quot;output.nsh&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">29th December 2009, 17:08</div></div><div class="posttext">by the way, this small tool can be an executable made with NSIS, using GetFileVersion</div></div><hr />


<div class="post"><div class="posttop"><div class="username">madden</div><div class="date">29th December 2009, 18:13</div></div><div class="posttext">I think that is a nice idea.<br />
<br />
I resorted to installing exiftool to read the version info from the command line, and then use a makefile with some commands that parse exiftool output and invoke makeNSIS with /DPRODUCT_VERSION=%%i on the command line.<br />
<br />
After that I found out I can also use !search... to have makeNSIS scan the resource file in my project and take the version info (version number, product name, company name) from there... :)<br />
<br />
But I agree that generating and launching a small NSIS installer (with a few !system directives) works without any external tool and without any application source code files.<br />
<br />
Come to think of it, it would also be a good idea to check that resources in the executable are no older than the resources described in the source file (to check that I have  recently compiled my program before creating the installer)...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">9th April 2010, 16:36</div></div><div class="posttext">I released my tool here: http://wiz0u.free.fr/prog/PETool/<br />
Using PETool.exe &lt;exefile&gt; /NSIS &lt;header.nsh&gt;<br />
it will generates a header.nsh file with the useful version information taken from the EXE (or DLL)<br />
<br />
BTW, this tool has many other useful features that one can use in the building process, like tweaking version informations or changing resources (for example, it can be use to &quot;brand&quot; an executable)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">niteflyer</div><div class="date">13th April 2010, 09:16</div></div><div class="posttext">I have made a headerfile some time ago, which has a macro for this purpose:<br />
<br />
http://nsis.sourceforge.net/NfUtils_header_file#nfu.SetVersionInfo<br />
<br />
It uses the same technique described in Wizou's first post...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grassu</div><div class="date">15th April 2010, 01:11</div></div><div class="posttext">Dear Wizou,<br />
<br />
I just downloaded your petool.exe and tried to execute it on a win7 64bit system.<br />
Petool is crashing and creates just an empty output.nsh file.<br />
<br />
Any idea?<br />
<br />
Thanks,<br />
grassu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">15th April 2010, 08:48</div></div><div class="posttext">mmmh no idea... I don't have such a configuration to test on...<br />
I will take a look at the source to see what could be a problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">15th April 2010, 12:59</div></div><div class="posttext">PETool v1.5 works OK on my Windows 7 64-bit system. Attached is the output from the command:<br />
<br />
PETool.exe ChromeSetup.exe /NSIS example.nsh<br />
<br />
(I changed the output file's extension so I could upload it here)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">15th April 2010, 13:22</div></div><div class="posttext">thank you pengyou!<br />
so I guess it must be the EXE/DLL that grassu was trying PETool on, that made it crash.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">grassu</div><div class="date">15th April 2010, 14:39</div></div><div class="posttext">Thanks for your reply and for your nice tool.<br />
<br />
I think I found the bug. Petool doesn't like relative pathes. <br />
<br />
Example:<br />
petool.exe resides in c:\tmp\test\petool.exe<br />
firefox.exe resides in c:\tmp\firefox.exe<br />
<br />
When I call petool like this it works:<br />
C:\tmp\test&gt; petool.exe c:\tmp\firefox.exe /NSIS out.nsh<br />
<br />
but calling it with relative path it crashes:<br />
C:\tmp\test&gt; petool.exe ..\firefox.exe /NSIS out.nsh<br />
<br />
Any idea,<br />
<br />
Christian</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Wizou</div><div class="date">15th April 2010, 16:24</div></div><div class="posttext">Thanks for this report. I will check that out<br />
This is probably due to the way I handle wildcard expressions.<br />
<br />
Ex: PETool.exe *.exe /SHOWSTAMP</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>