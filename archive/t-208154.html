<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" my extensions for  UserInfo plugin, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  my extensions for  UserInfo plugin NSIS Discussion" />
	
	<title> my extensions for  UserInfo plugin [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  my extensions for  UserInfo plugin</div>
<hr />
<div class="pda"><a href="t-208154.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=208154">my extensions for  UserInfo plugin</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">hgerstung</div><div class="date">18th February 2005, 11:35</div></div><div class="posttext">Hey guys!<br />
<br />
I must have the possibility to create a new user in my installer, as well as setting up some user rights / privileges for this user. <br />
<br />
I put a few new functions into the UserInfo plugin and it seems to work just fine. Here's the list of functions I added to UserInfo:<br />
<br />
- CreateAccount USER_ID PASSWORD COMMENT<br />
  Adds a user account with the given password and comment to the local system<br />
<br />
- DeleteAccount USER_ID<br />
  Removes the given user account from the system<br />
<br />
- AddPrivilege USER_ID PRIVILEGE<br />
  Adds a privilege to the given user, e.g. SeServiceLogonRight or SeSetSystemTime etc.<br />
<br />
- RemovePrivilege USER_ID PRIVILEGE<br />
  Removes a privilege from a user account<br />
<br />
Now I would like to add a number of group related functions and would like to add:<br />
<br />
- CreateGroup GROUP_ID COMMENT<br />
  Create a new group<br />
<br />
- DeleteGroup GROUP_ID<br />
  Deletes a group<br />
<br />
- AddToGroup USER_ID GROUP_ID<br />
  Adds the user to the given group<br />
<br />
- RemoveFromGroup USER_ID GROUP_ID<br />
  Removes the user from the given group<br />
<br />
I have difficulties with the group name, which has to be passed to almost all NETAPI functions as a LPCWSTR (Unicode). I am using the same conversions I did with the user related functions, but I get constant errors. If any Visual C++ freak out there with experiences regarding Unicode string handling can help me, please send me a PM.<br />
<br />
And: I would like to know if I should submit my hacked UserInfo plugin? Who has to receive it in which format? (I could zip the UserInfo folder in my NSIS contrib dir, that's where I am actually developing).<br />
<br />
Is this of any interest to somebody?<br />
<br />
Kind regards,<br />
Heiko</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th February 2005, 11:39</div></div><div class="posttext">AccessControl is already able to change user access to objects. There are also some users currently working on improving it. I think it would be better if you apply your changes to the AccessControl plug-in. The UserInfo plug-in is just for information, not for access control.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hgerstung</div><div class="date">18th February 2005, 11:57</div></div><div class="posttext">Originally posted by kichik <br />
AccessControl is already able to change user access to objects. There are also some users currently working on improving it. I think it would be better if you apply your changes to the AccessControl plug-in. The UserInfo plug-in is just for information, not for access control.  <br />
<br />
The AccessControl plugin seems to be targeted against File and Registry access rights, I will probably better start a new plugin, maybe calling it UserManager or something like that...<br />
<br />
If anyone is interested in helping me with these damn unicode strings, I could send you a Zip file containing the project. <br />
<br />
At the moment, the features I need are working fine, so I already can use it for myself.<br />
<br />
Kind regards,<br />
Heiko</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">18th February 2005, 12:05</div></div><div class="posttext">It might be targeted against file and registry, but it is still about AccessControl. Other than the concept, there are probably a lot of code that can be shared. It probably already handles Unicode strings... You could join forces with the users already working on it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Rlstephens</div><div class="date">21st March 2005, 17:48</div></div><div class="posttext">Your extension sounds like just what I need. All I need to do is create user accounts and set their privileges. This is required for a silent install of PostgreSQL 8.0. Have you posted your extension anywhere or can you post it here? Or has anyone else found anything that will acomplish this?<br />
<br />
Thanks!<br />
Ryan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st March 2005, 17:51</div></div><div class="posttext">The plugin is available on the Archive Download (http://nsis.sourceforge.net/archive/download.php) page.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Rlstephens</div><div class="date">21st March 2005, 17:54</div></div><div class="posttext">Perfect. Thank you!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tao.shen</div><div class="date">6th July 2005, 08:22</div></div><div class="posttext">Originally posted by Rlstephens <br />
Your extension sounds like just what I need. All I need to do is create user accounts and set their privileges. This is required for a silent install of PostgreSQL 8.0. Have you posted your extension anywhere or can you post it here? Or has anyone else found anything that will acomplish this?<br />
<br />
Thanks!<br />
Ryan  <br />
<br />
Hi, I am doing a silent postgresql install too and wandering if you managed to get this working using UserInfo. I am calling &quot;net user&quot; to create a service account but run into the problem when the account expires after XX days. There is no native net user/account to disable password expiry for a specific account.. Were you able to get around this issue?<br />
<br />
Cheers,<br />
Tao</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hgerstung</div><div class="date">6th July 2005, 09:53</div></div><div class="posttext">Originally posted by tao.shen <br />
Hi, I am doing a silent postgresql install too and wandering if you managed to get this working using UserInfo. I am calling &quot;net user&quot; to create a service account but run into the problem when the account expires after XX days. There is no native net user/account to disable password expiry for a specific account.. Were you able to get around this issue?<br />
<br />
Cheers,<br />
Tao  <br />
<br />
Hi Tao,<br />
<br />
sorry but I did not find out an easy way to accomplish this. Did you try to use my plugin to create that user account? As far as I can see it seems not to be affected by that problem, but I may be wrong as this could differ on different Windows flavours. <br />
<br />
Kind regards,<br />
Heiko</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CancerFace</div><div class="date">14th April 2006, 11:18</div></div><div class="posttext">@tao.shen<br />
Although net commands do not have the option of changing the 'expired' flag of a user account, you can use WMI do do it. Set a variable for the user name and call<br />
<br />
nsExec::ExecToStack '$SYSDIR\Wbem\wmic.exe UserAccount Where Name=&quot;$YourUserAcount&quot; Set PasswordExpires= FALSE'<br />
Other properties that can be changed in this way are<br />
<br />
The following writeable properties are available:<br />
Property                                Type                    Operation<br />
========                                ====                    =========<br />
Disabled                                boolean                 Read/Write<br />
FullName                                string                  Read/Write<br />
Lockout                                 boolean                 Read/Write<br />
PasswordChangeable                      boolean                 Read/Write<br />
PasswordExpires                         boolean                 Read/Write<br />
PasswordRequired                        boolean                 Read/Write<br />
Not very elegant since it requires WMI, but a solution nonetheless.<br />
<br />
@hgerstung<br />
My understanding is that it is possible to set the password to not expire using the netapi32 calls that the UserInfo plugin utilizes. If the user properties are defined using a USER_INFO_1 structure you can pass the UF_DONT_EXPIRE_PASSWD flag to the NetUserAdd function.<br />
<br />
CF</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>