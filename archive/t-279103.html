<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" LTR license in RTL language, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  LTR license in RTL language NSIS Discussion" />
	
	<title> LTR license in RTL language [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  LTR license in RTL language</div>
<hr />
<div class="pda"><a href="t-279103.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=279103">LTR license in RTL language</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Backland</div><div class="date">16th October 2007, 14:35</div></div><div class="posttext">hey all,<br />
<br />
I'm back with yet another language issue.<br />
<br />
I'm trying to get the license text in the richedit to show up just like it would for an LTR language. I understand NSIS is manually mirroring the dialog.<br />
<br />
The first step I took is to remove the following styles that NSIS is adding to the richedit control: <br />
<br />
WS_EX_RTLREADING, WS_EX_LEFTSCROLLBAR and ES_RIGHT<br />
<br />
Now the control has the exact same styles as it does when compiled with an LTR language, but the text is still aligning to the right.<br />
<br />
Even though the license file is a plain ascii text file (english), I even tried a Unicode version and added a Left-To-Right mark character at the beginning of the file to force LTR alignment, but still no luck.<br />
<br />
Even removing WS_EX_RTLREADING adn WS_EX_RIGHT from the parent inner dialog holding the richedit does not change the alignment.<br />
<br />
Does anyone have any idea on what needs to be done force the richedit to LTR? Its not one of the window styles as far as I can see....<br />
<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th October 2007, 22:38</div></div><div class="posttext">Removing all the styles worked fine for me. I used Resource Hacker to edit dialog 102 and it worked fine. How exactly did you remove the styles?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Backland</div><div class="date">17th October 2007, 07:59</div></div><div class="posttext">I'm removing them at runtime with SetWindowLong (verifying removal with spy++).<br />
<br />
Can you tell me exactly what you removed? Styles of the richedit or the dialog?<br />
<br />
Its my understanding that the default license dialog (102) is configured for LTR viewing, but NSIS manually mirrors it at runtime and applies the RTLREADING styles when an RTL language like Hebrew is selected. I will take another look at dialog 102.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Backland</div><div class="date">17th October 2007, 09:46</div></div><div class="posttext">Here is a minimal script that reproduces the issue:<br />
<br />
<br />
!include &quot;MUI.nsh&quot;<br />
OutFile &quot;MultiLanguage.exe&quot;<br />
LicenseData &quot;${NSISDIR}\license.txt&quot;<br />
<br />
page license<br />
!insertmacro MUI_LANGUAGE &quot;Hebrew&quot;<br />
<br />
Section<br />
SectionEnd<br />
<br />
<br />
here is the resource script for dialog 102<br />
<br />
<br />
102 DIALOGEX 0, 0, 300, 140<br />
STYLE DS_FIXEDSYS | DS_CONTROL | WS_CHILD | WS_CAPTION<br />
CAPTION &quot;&quot;<br />
LANGUAGE LANG_ENGLISH, SUBLANG_ENGLISH_US<br />
FONT 8, &quot;MS Shell Dlg&quot;<br />
{<br />
   CONTROL &quot;&quot;, 1040, STATIC, SS_LEFT | WS_CHILD | WS_VISIBLE, 0, 0, 300, 15 <br />
   CONTROL &quot;&quot;, 1000, &quot;RichEdit20A&quot;, ES_LEFT | ES_MULTILINE | ES_READONLY | WS_CHILD | WS_VISIBLE | WS_BORDER | WS_VSCROLL | WS_TABSTOP, 0, 15, 300, 93 <br />
   CONTROL &quot;&quot;, 1006, STATIC, SS_LEFT | WS_CHILD | WS_VISIBLE, 0, 113, 300, 26 <br />
}<br />
<br />
<br />
I've also attached a screenshot of the issue, can you tell me what you modified to the license text to align to the left, just like when the English language is selected?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th October 2007, 19:35</div></div><div class="posttext">NSIS doesn't mirror dialogs on runtime. It creates them at build time. Some styles don't take affect immediately after SetWindowLong or at all after the control is created. So you'll have to edit the resources using Resource Hacker after building the installer.<br />
<br />
You can also create your own UI based on Contrib\UIs\modern.exe and add the styles you don't want it to have. The dialog manager xors styles it wants to add to make a dialog RTL. So if you add the styles, it'll actually remove it while trying to add it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Backland</div><div class="date">17th October 2007, 19:44</div></div><div class="posttext">Thanks for the info, I'll give the custom UI a try.<br />
<br />
Originally posted by kichik <br />
Removing all the styles worked fine for me. I used Resource Hacker to edit dialog 102 and it worked fine. How exactly did you remove the styles? <br />
<br />
Can you tell me what you did? Which styles did you add/remove?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th October 2007, 19:50</div></div><div class="posttext">I removed the styles you mentioned in your first post. Everything related to RIGHT and all of the extended styles which are all related to RTL anyway.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Backland</div><div class="date">20th October 2007, 14:04</div></div><div class="posttext">Thanks for the info, the problem is fixed for the most part.<br />
<br />
I've noticed that if multiple languages are included, the installer will include multiple mirrored versions of dialogs (eg dialogs 202, 302 mirrored for 102).<br />
<br />
Why are there multiple versions and how to tell which version belongs to which language? for example, I only want to replace the license dialog for Hebrew, how can we know which resource to replace?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th October 2007, 14:10</div></div><div class="posttext">It adds a dialog set for each different setting it needs to apply. If a specific language has a different font or it's RTL, it'll add a new dialog set for it. Those can't be easily done in runtime so they're prepared in compile-time.<br />
<br />
There's no defined set of rules for the order of the dialogs. Currently, it depends on the order in which you've inserted the languages. So long as you don't add new languages, change fonts or RTL and the relevant source code in makensis.exe doesn't change, it's safe to assume the number will stay the same. DOn't forget to make sure it does when one of those change.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Backland</div><div class="date">20th October 2007, 14:45</div></div><div class="posttext">Looks I'll have to come up with a way to track the languages added and work out the dialog ids for RTL languages (no font settings in the script) and make needed changes with packhdr to avoid any CRC issues.<br />
<br />
Its becoming slightly complex for a simple thing like an LTR license in an RTL page, seemingly because ES_LEFT and WS_EX_LTRREADING dont have any effect once the RichEdit is created with the ES_RIGHT and WS_EX_RTLREADING styles.<br />
<br />
Thanks again for all the details, at least the problem is solved.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>