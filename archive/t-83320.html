<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Extremely dumb newbie question regarding Delete, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Extremely dumb newbie question regarding Delete NSIS Discussion" />
	
	<title> Extremely dumb newbie question regarding Delete [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Extremely dumb newbie question regarding Delete</div>
<hr />
<div class="pda"><a href="t-83320.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=83320">Extremely dumb newbie question regarding Delete</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Mistral</div><div class="date">2nd April 2002, 08:44</div></div><div class="posttext">I'm trying to make a silent patch installer that users of my mIRC script can download automatically and it patch the script and then disappear.<br />
<br />
The problem I'm having is that it extracts all the files OK, but it does not delete the installer file. Can someone please point me in the direction of my error please?<br />
<br />
 Name &quot;test&quot;<br />
 OutFile &quot;testpatch.exe&quot;<br />
 SetCompress auto<br />
 CRCCheck on<br />
 AutoCloseWindow true<br />
 ShowInstDetails hide<br />
 SilentInstall Silent<br />
 InstallDir &quot;$EXEDIR&quot;<br />
 DirShow hide<br />
<br />
 Section &quot;default&quot; <br />
 SetOutPath &quot;$INSTDIR&quot;<br />
 file /r &quot;C:\Documents and Settings\Mistral\Desktop\test\system&quot;<br />
 SectionEnd<br />
<br />
 Function .onInstSuccess<br />
 Delete /REBOOTOK &quot;$EXEDIR\testpatch.exe&quot; ; (tried $INSTDIR too ... no luck)<br />
 FunctionEnd<br />
<br />
Many thanks in advance<br />
<br />
Mistral</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pomflain</div><div class="date">2nd April 2002, 09:01</div></div><div class="posttext">Have you tried $OUTDIR?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mistral</div><div class="date">2nd April 2002, 09:04</div></div><div class="posttext">No I hadn't, just did. Same result :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SQwerl</div><div class="date">2nd April 2002, 09:43</div></div><div class="posttext">Function .onInstSuccess<br />
Delete /REBOOTOK &quot;$EXEDIR\testpatch.exe&quot; ; (tried $INSTDIR too ... no luck)<br />
FunctionEnd<br />
<br />
Have you tried a 'Section' instead?<br />
<br />
Section Delete_EXE<br />
Delete &quot;$INSTDIR\testpatch.exe&quot;<br />
SectionEnd<br />
<br />
Just a guess, not sure if it would work or not.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">2nd April 2002, 15:18</div></div><div class="posttext">I guess the installer is unable to delete itself (???)<br />
I tried this script on my desktop:<br />
outfile prob.exe<br />
name prob<br />
section<br />
delete $DESKTOP\prob.exe<br />
sectionend<br />
<br />
and indeed, it didn't delete itself.<br />
Maybe at reboot, but I don't think so...<br />
<br />
Good luck, Hendri.<br />
Ps: why deleting the installer???</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">2nd April 2002, 15:28</div></div><div class="posttext">outfile prob.exe<br />
name prob<br />
<br />
section<br />
delete /rebootok $DESKTOP\prob.exe<br />
sectionend<br />
<br />
<br />
This works. Your sure the reference in your original function is correct? If correct, this would mean, that there is a bug in NSIS, because from a section it works and not from a function. I expect that you need to debug the code to check the path to the file you want to delete. So just put a messagebox before the delete command and run the code. Post your results here, then we know if this was a bug or a mistake...<br />
<br />
Good luck, greetz,<br />
Hendri.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mistral</div><div class="date">2nd April 2002, 15:57</div></div><div class="posttext">Function .onInstSuccess<br />
GetFullPathName $R1 &quot;$EXEDIR\testpatch.exe&quot;<br />
MessageBox MB_YESNO &quot;EXE found at $R1, confirm Delete?&quot; IDNO NoDelete<br />
Delete /REBOOTOK &quot;$EXEDIR\testpatch.exe&quot; <br />
NoDelete:<br />
FunctionEnd<br />
<br />
Returns &quot;EXE Found at c:\Documents and Settings\Mistral\Desktop\test2\testpatch.exe, confirm Delete?&quot;<br />
<br />
Although this is a correct path, upon confirmation it still does not delete.<br />
<br />
I hadn't tried in a section before, although when I tried it it did not work for me, no matter what I tried. Even copying your text did not work. Maybe this is a problem with only Windows XP? Could someone else try it on a different OS and see if they get the same results?<br />
<br />
PS. I suppose I could just write in a .remove event in my script, but I know that this is possible, as I have seen it being done with another patch for another mIRC script, which I'd like to emulate.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mistral</div><div class="date">2nd April 2002, 16:35</div></div><div class="posttext">Name &quot;test&quot;<br />
OutFile &quot;testpatch.exe&quot;<br />
SetCompress auto<br />
CRCCheck on<br />
AutoCloseWindow true<br />
ShowInstDetails hide<br />
SilentInstall Silent<br />
InstallDir &quot;$EXEDIR&quot;<br />
DirShow hide<br />
<br />
Section &quot;default&quot; ; (default section)<br />
SetOutPath &quot;$INSTDIR&quot;<br />
file /r &quot;C:\Documents and Settings\Mistral\Desktop\test\system&quot;<br />
WriteUninstaller $INSTDIR\Uninst.exe<br />
SectionEnd ; end of default section<br />
<br />
Section &quot;Uninstall&quot;<br />
SetAutoClose true<br />
Delete $INSTDIR\Uninst.exe<br />
Delete $INSTDIR\testpatch.exe<br />
SectionEnd<br />
<br />
Function .onInstSuccess<br />
ExecWait $INSTDIR\Uninst.exe<br />
FunctionEnd<br />
<br />
<br />
This works as I wanted ... I suppose I should have been more logical in my thinking. Thanks for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smile2Me</div><div class="date">2nd April 2002, 17:05</div></div><div class="posttext">This is a nice solution to the problem of removing the exe itself! Well done! :)<br />
<br />
BTW, Delete /rebootok also works fine, but then you will need to allow for rebooting the machine. That is indeed less preferrable. If one needs the uninstall section for a real uninstall, one could use a small batch file or vb script to delete thge original install exe if ou don't want to reboot... <br />
<br />
Greetz, Hendri.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>