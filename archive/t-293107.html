<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Wrong Handle of MUI_PAGE_INSTFILES? or what?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Wrong Handle of MUI_PAGE_INSTFILES? or what? NSIS Discussion" />
	
	<title> Wrong Handle of MUI_PAGE_INSTFILES? or what? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Wrong Handle of MUI_PAGE_INSTFILES? or what?</div>
<hr />
<div class="pda"><a href="t-293107.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=293107">Wrong Handle of MUI_PAGE_INSTFILES? or what?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">AuGuS666</div><div class="date">14th June 2008, 01:00</div></div><div class="posttext">Hi all:<br />
Im using an nsis script like a loader of aplications it works very fine now, but, i just want to add a last feature &quot;Hide the Minimize&quot; button of my &quot;only page&quot; the &quot;MUI_PAGE_INSTFILES&quot;, but i cant get the handle or i dont know whats wrong, this is my script:<br />
<br />
<br />
  !define MF_GRAYED 1<br />
  !define SC_MINIMIZE 0xF020<br />
  !define SC_MAXIMIZE 0xF030<br />
  !define SC_CLOSE 0xF060<br />
  !define NOMBRE &quot;Boot&quot;<br />
  !define VERSION &quot;v1.0&quot;<br />
<br />
  !define MUI_CUSTOMFUNCTION_GUIINIT myGUIInit<br />
   <br />
   !define MUI_ICON &quot;IMG\icon_install.ico&quot;<br />
   !define MUI_HEADERIMAGE<br />
   !define MUI_HEADERIMAGE_BITMAP &quot;IMG\header-install.bmp&quot;<br />
   <br />
  ;LIBS<br />
   !include &quot;MUI2.nsh&quot;<br />
   !include &quot;WinMessages.nsh&quot;<br />
   !include &quot;WordFunc.nsh&quot;<br />
   !include &quot;Library.nsh&quot;<br />
   <br />
  ;PAGES<br />
   !insertmacro MUI_PAGE_INSTFILES<br />
   !insertmacro MUI_LANGUAGE Spanish<br />
  <br />
  BrandingText &quot;srl&quot;<br />
  Name &quot;${NOMBRE} ${VERSION}&quot;<br />
  CRCCheck on<br />
  Caption &quot;Boot&quot;<br />
  XPStyle off<br />
  VIProductVersion 1.0.0.0<br />
  VIAddVersionKey /LANG=${LANG_SPANISH} ProductName &quot;Inicio de CAI v5.0 v1.0&quot;<br />
  VIAddVersionKey /LANG=${LANG_SPANISH} ProductVersion &quot;v1.0&quot;<br />
  VIAddVersionKey /LANG=${LANG_SPANISH} FileVersion &quot;v1.0&quot;<br />
  VIAddVersionKey /LANG=${LANG_SPANISH} FileDescription &quot;Boot&quot;<br />
  VIAddVersionKey /LANG=${LANG_SPANISH} LegalCopyright &quot;srl&quot;<br />
  ShowInstDetails nevershow<br />
  ShowUninstDetails nevershow<br />
  AutoCloseWindow true<br />
  SetOverwrite on<br />
  SetDatablockOptimize on<br />
  InstallDir &quot;C:\Archivos de Programa\Boot&quot;<br />
  OutFile &quot;Bootnnova.exe&quot;<br />
  AUTOCLOSEWINDOW true<br />
  <br />
;Secciones<br />
<br />
Section &quot;Install&quot;<br />
  #0.-<br />
  #HIDE SOME BUTTONS FROM THE PAGE<br />
  GetDlgItem $R0 $HWNDPARENT 1<br />
  ShowWindow $R0 ${SW_HIDE}<br />
  GetDlgItem $R0 $HWNDPARENT 2<br />
  ShowWindow $R0 ${SW_HIDE}<br />
  GetDlgItem $R0 $HWNDPARENT 3<br />
  ShowWindow $R0 ${SW_HIDE}<br />
<br />
  #0.-<br />
  #DISABLE MIMIZED BUTTON<br />
  #THE NEXT CODE DONT WORK AT RUN TIME<br />
System::Call 'user32::GetSystemMenu(i $HWNDPARENT, i 0) i .r0'<br />
System::Call 'user32::EnableMenuItem(i s, i ${SC_MINIMIZE}, i ${MF_GRAYED})'<br />
System::Call 'user32::GetSystemMenu(i $HWNDPARENT, i 0) i .r0'<br />
System::Call 'user32::EnableMenuItem(i s, i ${SC_MAXIMIZE}, i ${MF_GRAYED})'<br />
System::Call 'user32::GetSystemMenu(i $HWNDPARENT, i 0) i .r0'<br />
System::Call 'user32::EnableMenuItem(i s, i ${SC_CLOSE}, i ${MF_GRAYED})'<br />
<br />
#NOT EVEN THIS ONE WORKS AT RUN TIME<br />
System::Call 'user32::GetWindowLong(i $hwndparent,i -16)i.r0'<br />
intop $1 0x30000 ~<br />
intop $0 $0 &amp; $1<br />
System::Call 'user32::SetWindowLong(i $hwndparent,i -16,i $0)i'<br />
<br />
<br />
 #1-<br />
 EXECWAIT '&quot;$INSTDIR\EXE1.exe&quot;'<br />
<br />
 sleep 1000<br />
<br />
 #2-<br />
 EXECWAIT '&quot;$INSTDIR\EXE2.exe&quot;'<br />
<br />
SectionEnd<br />
<br />
<br />
Function myGUIInit<br />
!macro GetReturnValue<br />
!ifdef DEBUG<br />
  Pop $R9<br />
  StrCmp $R9 success +2<br />
    DetailPrint &quot;Error: $R9&quot;<br />
!endif<br />
!macroend<br />
<br />
!ifdef DEBUG<br />
  BgImage::SetReturn /NOUNLOAD on<br />
!endif<br />
<br />
  #DESCOMPRIMIR EL FONDO<br />
   SETOUTPATH &quot;$INSTDIR\Imagenes&quot;<br />
   File &quot;Imagenes\Background.bmp&quot;<br />
<br />
  #SET BACKGROUND<br />
  BgImage::SetBg /NOUNLOAD /FILLSCREEN $INSTDIR\Imagenes\Background.bmp<br />
  !insertmacro GetReturnValue<br />
  #REDRAW<br />
  BgImage::Redraw /NOUNLOAD<br />
<br />
FunctionEnd<br />
<br />
Function .onGUIEnd<br />
<br />
  #DELETE BACKGROUND<br />
   Delete &quot;$INSTDIR\Imagenes\Background.bmp&quot;<br />
<br />
FunctionEnd<br />
<br />
Function .onInit<br />
   ;ONLY ONE INSTANCE<br />
    System::Call 'kernel32::CreateMutexA(i 0, i 0, t &quot;myMutex&quot;) i .r1 ?e'<br />
    Pop $R0<br />
    StrCmp $R0 0 +2<br />
    quit<br />
    <br />
functionend<br />
<br />
<br />
<br />
So?? :confused: what is wrong?? and a little question more:<br />
<br />
Â¿How can i hide this loader not showing it at the taskbar?<br />
<br />
Thanks in advance for all the help bye...<br />
:up:  ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th June 2008, 11:08</div></div><div class="posttext">Change in each EnableMenuItem(i s to EnableMenuItem(i r0<br />
The handle isn't on the stack.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">14th June 2008, 19:16</div></div><div class="posttext">Originally posted by AuGuS666 <br />
Â¿How can i hide this loader not showing it at the taskbar?<br />
[/B] <br />
Three steps: 1) hide the main window 2) add the Extended Style bit WS_EX_TOOLWINDOW (0x080) 3) reenable the main window.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AuGuS666</div><div class="date">14th June 2008, 22:54</div></div><div class="posttext">;) <br />
Testing in progress :D <br />
Ill post reply soon...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AuGuS666</div><div class="date">16th June 2008, 21:06</div></div><div class="posttext">Well this is the working code for what i was looking for:<br />
<br />
<br />
<br />
  #0.1<br />
  #0.-HIDE MAIN WINDOW FROM UPDATES<br />
  ShowWindow $HWNDPARENT ${SW_HIDE} <br />
<br />
  #0.2<br />
  #HIDE BUTTONS OK -----------------<br />
  GetDlgItem $R0 $HWNDPARENT 1<br />
  ShowWindow $R0 ${SW_HIDE}<br />
  GetDlgItem $R0 $HWNDPARENT 2<br />
  ShowWindow $R0 ${SW_HIDE}<br />
  GetDlgItem $R0 $HWNDPARENT 3<br />
  ShowWindow $R0 ${SW_HIDE}<br />
<br />
  #0.3<br />
#Afrow UK SUGGEST<br />
  #HIDE MINIMIZE FROM MENU OK ---------------------------------------------<br />
  System::Call 'user32::GetSystemMenu(i $HWNDPARENT, i 0) i .r0'<br />
  System::Call 'user32::EnableMenuItem(i r0, i ${SC_MINIMIZE}, i ${MF_GRAYED})'<br />
  System::Call 'user32::GetSystemMenu(i $HWNDPARENT, i 0) i .r0'<br />
  System::Call 'user32::EnableMenuItem(i r0, i ${SC_MAXIMIZE}, i ${MF_GRAYED})'<br />
  System::Call 'user32::GetSystemMenu(i $HWNDPARENT, i 0) i .r0'<br />
  System::Call 'user32::EnableMenuItem(i r0, i ${SC_CLOSE}, i ${MF_GRAYED})'<br />
  System::Call 'user32::GetWindowLong(i $HWNDPARENT,i -16)i.r0'<br />
  intop $1 0x30000 ~<br />
  intop $0 $0 &amp; $1<br />
  System::Call 'user32::SetWindowLong(i $HWNDPARENT,i -16,i $0)i'<br />
<br />
  #0.4<br />
  #demiller9 SUGGEST <br />
#TO HIDE THE APLICATION FROM THE TASK BAR<br />
  !insertmacro _NSD_AddExStyle  $HWNDPARENT 0x080<br />
  ShowWindow $HWNDPARENT ${SW_SHOW}  <br />
 <br />
...<br />
<br />
<br />
Thanks for the tips :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>