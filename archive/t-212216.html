<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Making Desktop Shortcut Optional, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Making Desktop Shortcut Optional NSIS Discussion" />
	
	<title> Making Desktop Shortcut Optional [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Making Desktop Shortcut Optional</div>
<hr />
<div class="pda"><a href="t-212216.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=212216">Making Desktop Shortcut Optional</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">JWood</div><div class="date">4th April 2005, 03:25</div></div><div class="posttext">I have a very simple script generated by the HM NIS Wizards (no selectable components or anything like that).<br />
<br />
I works well but I would like the creation of a desktop shortcut to be optional. Right now, it creates a desktop shortcut, which I like. But the user should have the choice of not creating one.<br />
<br />
Does anyone have some simple code for making this process optional?<br />
<br />
Thanks.<br />
<br />
Jonathan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hesung</div><div class="date">4th April 2005, 05:23</div></div><div class="posttext">Add one Section to be selected..<br />
<br />
Section /o &quot;Wanna a destop shortcut&quot;<br />
CreateShortCut &quot;$DESKTOP\ShortcutName.lnk&quot; &quot;$INSTDIR\AimName.exe&quot;<br />
<br />
SectionEnd<br />
<br />
<br />
;;---If the user wanna one, he|her can selete it.<br />
<br />
<br />
I don't think using HM NIS Wizards is a good idea..The simple is too simple..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hesung</div><div class="date">4th April 2005, 05:34</div></div><div class="posttext">Donnot forget to insert this Page Macro in the Page Options<br />
<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
<br />
If using the HM_NIS you can select the Checkbox&quot;Allow user to select the componnents to install&quot; to add the code<br />
......<br />
Then add the section.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JWood</div><div class="date">4th April 2005, 21:31</div></div><div class="posttext">Thanks, but then the user has the option of not installing the main program files. Also, I really don't care for the layout of the page where you select components. It it hard to add an option or a new page with an option to install the desktop shortcut?<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">5th April 2005, 10:16</div></div><div class="posttext">Thanks, but then the user has the option of not installing the main program files.<br />
You can set &quot;read-only&quot;-attrib for section (include SectionIn R0 inside section) -&gt; user won't be able to change its state.<br />
<br />
Or you can create checkbox on finishpage named &quot;Create desktop shortcut&quot;. Example for MUI may be like this:<br />
<br />
!define MUI_FINISHPAGE_RUN<br />
!define MUI_FINISHPAGE_RUN_TEXT &quot;Create desktop shortcut&quot;<br />
!define MUI_FINISHPAGE_RUN_FUNCTION &quot;myfunction&quot;<br />
<br />
Function &quot;myfunction&quot;<br />
CreateShortCut &quot;$DESKTOP\My_programm.lnk&quot; &quot;$INSTDIR\proga.exe&quot;<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">5th April 2005, 10:49</div></div><div class="posttext">And question by this (http://forums.winamp.com/showthread.php?s=&amp;threadid=212298) thread.<br />
The SectionIn RO works but doesn't look right for me.<br />
Why not?<br />
<br />
<br />
This code will also help you to show the &quot;main programm files&quot;-section as enabled but the user will not be able to modify its state (without setting &quot;read-only&quot;-attrib for section).<br />
<br />
Function .onSelChange<br />
   SectionGetFlags ${SecIndex} $R0<br />
   IntOp $R1 $R0 &amp; 0x0001<br />
   IntCmp $R0 1 sekok<br />
      IntOp $R1 $R0 | 0x0001<br />
      SectionSetFlags ${SecIndex} $R1<br />
   sekok:<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JWood</div><div class="date">5th April 2005, 19:39</div></div><div class="posttext">Yeah, I think it might look better not being grayed out. However, it still seems funky to me have a screen that asks the user to choose program elements to install and there are only two items, and only one of those items can be modified, and that item doesn't really relate to installing program elements.<br />
<br />
From a user-interface standpoint, it seems that it would be far more reasonable to simply display a single checkbox that specifies if a desktop shortcut should be created.<br />
<br />
There may be different opinions but I've been programming a long time and that's my opinion.<br />
<br />
I'm trying to figure out how to add the checkbox but the docs are seeming pretty lean to me. (Neither custom nor InstallOptions are even in the help index.)<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th April 2005, 19:58</div></div><div class="posttext">Read glory_man post 3 posts up.<br />
He has attached code to add a &quot;Create desktop shortcut&quot; check-box to the MUI Finish page.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JWood</div><div class="date">5th April 2005, 20:26</div></div><div class="posttext">Originally posted by Afrow UK <br />
Read glory_man post 3 posts up.<br />
He has attached code to add a &quot;Create desktop shortcut&quot; check-box to the MUI Finish page.<br />
<br />
-Stu  <br />
<br />
Could I get some sort of clue as to which post you are referring to. I'm using my browser to view these posts. As soon as you replied, this thread went to the top of the list so there is no &quot;3 posts up.&quot;<br />
<br />
And I couldn't find anything with a subject similar to &quot;add a &quot;Create desktop shortcut&quot; check-box to the MUI Finish page.&quot;<br />
<br />
Sounds like just what I need. Something to go on? Please.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pidgeot</div><div class="date">5th April 2005, 22:36</div></div><div class="posttext">A post is not the same as a thread. When Afrow says &quot;3 posts up&quot;, he means 3 posts above his in this thread.<br />
<br />
The code he's referring to is this:<br />
!define MUI_FINISHPAGE_RUN<br />
!define MUI_FINISHPAGE_RUN_TEXT &quot;Create desktop shortcut&quot;<br />
!define MUI_FINISHPAGE_RUN_FUNCTION &quot;myfunction&quot;<br />
<br />
Function &quot;myfunction&quot;<br />
CreateShortCut &quot;$DESKTOP\My_programm.lnk&quot; &quot;$INSTDIR\proga.exe&quot;<br />
FunctionEnd<br />
<br />
If you need MUI_FINISHPAGE_RUN for something else, you can use a messagebox:<br />
<br />
MessageBox MB_YESNO|MB_ICONQUESTION &quot;Create desktop shortcut?&quot; IDNO +2<br />
CreateShortCut &quot;$DESKTOP\My Program.lnk&quot; &quot;$INSTDIR\program.exe&quot;<br />
<br />
<br />
Place it in an appropriate section of your installer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JWood</div><div class="date">5th April 2005, 23:01</div></div><div class="posttext">Originally posted by Pidgeot <br />
A post is not the same as a thread. When Afrow says &quot;3 posts up&quot;, he means 3 posts above his in this thread. <br />
<br />
Doh! How right you are. My apologies to both you and &quot;Afrow UK&quot;. I'm used to using Outlook Express for this type of stuff and just missed those comments.<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JWood</div><div class="date">5th April 2005, 23:02</div></div><div class="posttext">Originally posted by glory_man <br />
Or you can create checkbox on finishpage named &quot;Create desktop shortcut&quot;. Example for MUI may be like this:<br />
<br />
!define MUI_FINISHPAGE_RUN<br />
!define MUI_FINISHPAGE_RUN_TEXT &quot;Create desktop shortcut&quot;<br />
!define MUI_FINISHPAGE_RUN_FUNCTION &quot;myfunction&quot;<br />
<br />
Function &quot;myfunction&quot;<br />
CreateShortCut &quot;$DESKTOP\My_programm.lnk&quot; &quot;$INSTDIR\proga.exe&quot;<br />
FunctionEnd<br />
 [/B]<br />
<br />
I apologize for completely missing these comments the first time around. I've got this code working and just trying to decide if that's the way I'll go. Either way, it was an excellent suggestion. Thanks a million!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">glory_man</div><div class="date">6th April 2005, 10:14</div></div><div class="posttext">As I can see (http://forums.winamp.com/showthread.php?s=&amp;threadid=212299) JWood uses MUI_FINISHPAGE_RUN. So defines-code can be modified to the next:<br />
<br />
!define MUI_FINISHPAGE_SHOWREADME<br />
!define MUI_FINISHPAGE_SHOWREADME_TEXT &quot;Create desktop shortcut&quot;<br />
!define MUI_FINISHPAGE_SHOWREADME_FUNCTION &quot;myfunction&quot;</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>