<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" When to register locked font?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  When to register locked font? NSIS Discussion" />
	
	<title> When to register locked font? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  When to register locked font?</div>
<hr />
<div class="pda"><a href="t-106843.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=106843">When to register locked font?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">SprinklerHead</div><div class="date">24th September 2002, 18:48</div></div><div class="posttext">If a font file is locked and you have to do a reboot to update it, when do you call RegisterFont? Is it ok to call RegisterFont right after the Rename call, like this...<br />
<br />
SetOutPath $TEMP<br />
GetTempFileName $R1<br />
file /oname=$R1 &quot;${FilesDir}${FONT_NAME}&quot;<br />
Rename /REBOOTOK $R1 $WINDIR\Fonts\${FONT_NAME}<br />
fonts::registerFont &quot;$WINDIR\Fonts\${FONT_NAME}&quot;<br />
<br />
It seems like it should work, since the old font file is there still. The reason I ask is because it seems like half the time my installation works fine, but the other half the fonts aren't right. I am having a really hard time with the font installation for some reason.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th September 2002, 19:08</div></div><div class="posttext">Have you tried unregistering the old font first?<br />
<br />
Registering/unregistering is only for the current session, for the font to be loaded  everytime you need to write some registry entries as you already know. You also need to send WM_FONTCHANGE using SendMessageTimeour. With NSIS just write SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0 /TIMEOUT=5000. This is only possible with the newest version of NSIS from the CVS. Maybe after you unregister the font and send this message you will be able to replace the font without a reboot.<br />
<br />
If this doesn't work and you do replace the file after reboot, you don't need to call registerFont at all because the registry entries are already there after a reboot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SprinklerHead</div><div class="date">24th September 2002, 19:26</div></div><div class="posttext">Registering/unregistering is only for the current session, for the font to be loaded  everytime you need to write some registry entries as you already know.<br />
<br />
I didn't already know :eek:. It seems to me like you would almost always want the fonts to be loaded everytime - not just for the current session. In fact, I can't think of a time when you wouldn't. Of course, I am not entirely sure what a &quot;session&quot; is either. So what registry keys do I need to add/adjust?<br />
<br />
Have you tried unregistering the old font first?<br />
<br />
No, but I'll try that. It looks almost like I don't have to call registerfont/unregisterfont in the font.dll at all. Is that the case? These fonts I am trying to install are for my app and I want them to be used permanently.<br />
<br />
So it looks like I need to...<br />
<br />
- unregister the old one<br />
- copy the font file<br />
- write some registry keys (think I saw this in another post somewhere)<br />
- send the system font message<br />
<br />
Is that right? Sorry for being a pain, but I am about to pull all my hair out over this. Seems like I am getting closer though.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th September 2002, 19:40</div></div><div class="posttext">Registering and unregistering is done so you can use it the font without a reboot. If you don't write the registry keys, which are mentioned in that other thread called &quot;Font&quot;, the font won't be loaded after reboot.<br />
<br />
- unregister the old one<br />
- copy the font file<br />
- write some registry keys (think I saw this in another post somewhere)<br />
- send the system font message <br />
<br />
You have to register the font after you copy it so you will be able to use it without a reboot. Then you send the message.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SprinklerHead</div><div class="date">24th September 2002, 19:43</div></div><div class="posttext">OK, I think I got it. Thanks again.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>