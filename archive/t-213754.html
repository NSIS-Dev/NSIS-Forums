<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Issue with StrCmp, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Issue with StrCmp NSIS Discussion" />
	
	<title> Issue with StrCmp [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Issue with StrCmp</div>
<hr />
<div class="pda"><a href="t-213754.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=213754">Issue with StrCmp</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Panther24</div><div class="date">21st April 2005, 06:52</div></div><div class="posttext">Hi!<br />
<br />
I'm trying to find the User Previlidges and cont as per that.<br />
Is the user has Admin, then the function True else False.<br />
Here is a sample of what i'm doing ....<br />
<br />
Function .onInit<br />
	<br />
Call IsUserAdmin<br />
Pop $R0<br />
MessageBox MB_OK 'User= &quot;$R1&quot;  AccountType= &quot;$R2&quot;  IsUserAdmin= &quot;$R0&quot;'<br />
StrCmp &quot;True&quot; $R0 Install End<br />
<br />
Install:<br />
  InitPluginsDir<br />
  File /oname=$PLUGINSDIR\splash.bmp &quot;abcd.bmp&quot;<br />
  advsplash::show 1000 600 200 -1 $PLUGINSDIR\splash<br />
  Delete $PLUGINSDIR\splash.bmp<br />
  LogSet on<br />
	<br />
End:<br />
  MessageBox MB_OK 'Need Administrative Previlidges to Install'<br />
FunctionEnd<br />
<br />
The problem is that the StrCmp though equal to True executes Install &amp; then End.<br />
<br />
Any Help or Suggestion!!<br />
<br />
Panther24</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panther24</div><div class="date">21st April 2005, 07:04</div></div><div class="posttext">Hi!<br />
<br />
Sorry Folks!! I have another shot at it and resolved the issue myself. Sorry!!<br />
<br />
The new Function looks like...<br />
<br />
Function .onInit<br />
	Call IsUserAdmin<br />
	Pop $R0<br />
	;MessageBox MB_OK 'User= &quot;$R1&quot;  AccountType= &quot;$R2&quot;  IsUserAdmin= &quot;$R0&quot;'<br />
	StrCmp &quot;True&quot; $R0 Install End<br />
	<br />
	End:<br />
		MessageBox MB_OK|MB_ICONSTOP 'Need Administrative Previlidges to Install'<br />
		Abort<br />
<br />
	Install:<br />
		InitPluginsDir<br />
		File /oname=$PLUGINSDIR\splash.bmp &quot;abc.bmp&quot;<br />
		advsplash::show 1000 600 200 -1 $PLUGINSDIR\splash<br />
		Delete $PLUGINSDIR\splash.bmp<br />
		LogSet on<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st April 2005, 08:40</div></div><div class="posttext">It was happening because you needed to jump over the 'End:' block of code with Goto after doing the 'Install:' block of code.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panther24</div><div class="date">21st April 2005, 10:23</div></div><div class="posttext">But now i have another problem the Logging doesn't seem to work!! Any Ideas, Before Every Section i'm using LogText also to specify with section is being installed.<br />
<br />
- Panther24</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">21st April 2005, 12:35</div></div><div class="posttext">Are you using the makensis special build compiled with logging?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panther24</div><div class="date">22nd April 2005, 05:42</div></div><div class="posttext">Yes I'm using the special build i copied it twice and also verified it by downloading twice. It was working fine for abt 3-4 builds, but now.... :(<br />
<br />
Panther24</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">22nd April 2005, 06:18</div></div><div class="posttext">According to NSIS help manuals, you must have $INSTDIR defined before the LogSet function will work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panther24</div><div class="date">22nd April 2005, 07:41</div></div><div class="posttext">Hi Comperio,<br />
<br />
Ur right!! That what i had changed and now it seems 2 work fine.<br />
<br />
Tnx.<br />
Panther24</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>