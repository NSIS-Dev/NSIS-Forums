<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Desktop Shortcuts - How to make?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Desktop Shortcuts - How to make? NSIS Discussion" />
	
	<title> Desktop Shortcuts - How to make? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Desktop Shortcuts - How to make?</div>
<hr />
<div class="pda"><a href="t-305539.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305539">Desktop Shortcuts - How to make?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">20th April 2009, 06:34</div></div><div class="posttext">Hello<br />
<br />
How do I make a desktop shortcut automatically within my .nsi script file?<br />
<br />
The file is located in the WINDOWS directory. <br />
<br />
The file 'installed'/extracted using the NSIS installer is an .exe<br />
<br />
Please tell me how to add a Desktop Shortcut for my .exe<br />
<br />
Thanks in advance,<br />
<br />
Panarchy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thek</div><div class="date">20th April 2009, 07:52</div></div><div class="posttext">Use the command CreateShortcut (http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.3)<br />
<br />
Also read the doku about the command &quot;SetShellVarContext&quot; so you know the difference in behaviour (all Users/current user)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">20th April 2009, 08:02</div></div><div class="posttext">Thanks, will do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">20th April 2009, 08:18</div></div><div class="posttext">Just tried, can't seem to work it out.<br />
<br />
Just want to get the simplest method to work before work (custom icon, local user) before trying anything fancy.<br />
<br />
Please tell me the exact command to use. I have only 1 .exe to link.<br />
<br />
Thanks in advance,<br />
<br />
Panarchy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thek</div><div class="date">20th April 2009, 08:39</div></div><div class="posttext">Here's a simple sample:<br />
CreateShortcut &quot;$DESKTOP\My_Application.lnk&quot; &quot;$INSTDIR\My_application.exe&quot; <br />
This generates an icon with the name &quot;My_Application&quot; on the Deskotp, linking it to your installed exe, with the same icon than your exe.<br />
<br />
If you want to have another icon, you have to embed it in your exe resources and select it with an index or install an additional icon file<br />
<br />
But read the documentation<br />
it only has 4 lines of text, it isn't that hard!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">20th April 2009, 12:53</div></div><div class="posttext">Thanks, got it to work now.<br />
<br />
You da man!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">20th April 2009, 13:10</div></div><div class="posttext">Didn't work... worked until I tried adding an icon;<br />
<br />
pastebin.com/f33bc852a<br />
<br />
It's giving me an error on line 23 (!insertmacro ExtractMaintainenceScript $WINDIR)<br />
<br />
Please tell me how to get my Install script working again.<br />
<br />
Thanks in advance,<br />
<br />
Panarchy<br />
<br />
EDIT: When I finally got it to work, with it's parameters and everything (including copying across the .ico file) all I got was a blank icon :( tried on Vista 64-bit and my 32-bit XP VMware Virtual Machine.<br />
<br />
Please tell me how to get this to work!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">20th April 2009, 14:09</div></div><div class="posttext">Help if you post your code.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">20th April 2009, 22:22</div></div><div class="posttext">Certainly.<br />
<br />
I have sent a PM to both Afrow UK and thek.<br />
<br />
Please have a read of it, and tell me what you can do to make my code work.<br />
<br />
Thanks in advance,<br />
<br />
Panarchy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Panarchy</div><div class="date">22nd April 2009, 15:07</div></div><div class="posttext">They were both of great help.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>