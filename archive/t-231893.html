<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Power User and PendingFileRenameOperations, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Power User and PendingFileRenameOperations NSIS Discussion" />
	
	<title> Power User and PendingFileRenameOperations [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Power User and PendingFileRenameOperations</div>
<hr />
<div class="pda"><a href="t-231893.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=231893">Power User and PendingFileRenameOperations</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">smatte</div><div class="date">25th November 2005, 16:27</div></div><div class="posttext">When installing with a power user and some files are locked, my installer mark those files for rename on reboot but power user are unable to write in PendingFileRenameOperations registry key. Is there any workaround or should I allow intallation only to administrator?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">CraigF</div><div class="date">25th November 2005, 17:05</div></div><div class="posttext">[scdisc-&gt;nsisdisc]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">26th November 2005, 12:04</div></div><div class="posttext">You should allow administrators only.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">28th November 2005, 22:43</div></div><div class="posttext">Can you please post your method of writing to PendingFileRenameOperations? I haven't been able to find documentation on it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">28th November 2005, 23:48</div></div><div class="posttext">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/fileio/fs/movefileex.asp</div></div><hr />


<div class="post"><div class="posttop"><div class="username">smatte</div><div class="date">29th November 2005, 00:59</div></div><div class="posttext">If your file is in use:<br />
<br />
# Get a temp file name<br />
GetTempFileName $0<br />
# Install<br />
SetOutpath $INSTDIR<br />
File /oname=$0 &quot;something.dat&quot;<br />
Rename /REBOOTOK &quot;$INSTDIR\0&quot; &quot;something.dat&quot;<br />
<br />
It will add an entry to PendingFileRenameOperations.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dienjd</div><div class="date">29th November 2005, 18:00</div></div><div class="posttext">Thanks for the help! I should have been able to figure it out, but I was fixated on searching for &quot;PendingFileRenameOperations&quot; in the manual.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>