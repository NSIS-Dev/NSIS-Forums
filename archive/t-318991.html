<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problem with executing CeCreateFile, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problem with executing CeCreateFile NSIS Discussion" />
	
	<title> Problem with executing CeCreateFile [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problem with executing CeCreateFile</div>
<hr />
<div class="pda"><a href="t-318991.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318991">Problem with executing CeCreateFile</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">santana108</div><div class="date">6th May 2010, 21:37</div></div><div class="posttext">I am using the system.dll plugin to execute RAPI commands for a remote installation. <br />
<br />
I am able to create directories, but I am not able to open or create files.<br />
<br />
System::Call &quot;rapi::CeCreateDirectory(w 'application\ctgtalk', i 0) i .r4&quot;<br />
<br />
System::Call &quot;rapi::CeFileCreate(w 'application\ctgtalk\somefile.txt', i 3, i 0, i 0, i 1, i 128, i 0) p .r4&quot;<br />
<br />
<br />
The create directory function works file returns 1 indicating success and directory is created.<br />
<br />
The CeFileCreate function is supposed to return a file handle if it succeeds and an invalid handle if it fails. It is returning 0 with is not a valid file handle and the file is not created.<br />
<br />
dwDesiredAccess is set to 3 which is GENERIC_READ | GENERIC_WRITE.<br />
dwCreationDisposition is set to 1 which is CREATE_NEW.<br />
dwFlagsAndAttributes is set to 128 which is FILE_ATTRIBUTE_NORMAL.<br />
<br />
Does anyone have a clue as to why this is not working?<br />
<br />
Chris Lustig<br />
<br />
 <br />
<br />
<br />
<br />
The parameter set to 1 sets to CREATE_NEW and the parameter set to 128 sets to FILE_ATTRIBUTES_NORMAL.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">6th May 2010, 22:11</div></div><div class="posttext">p is not a valid type in 2.46, use i for now</div></div><hr />


<div class="post"><div class="posttop"><div class="username">santana108</div><div class="date">7th May 2010, 12:17</div></div><div class="posttext">p is not a valid type in 2.46, use i for now<br />
<br />
Doesn't work when I use i either.  I am still clueless.<br />
<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th May 2010, 12:31</div></div><div class="posttext">Would help if you used CeCreateFile instead of CeFileCreate ;)<br />
<br />
Edit: And System should have put &quot;error&quot; on the stack.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">santana108</div><div class="date">7th May 2010, 13:20</div></div><div class="posttext">Oops I am a little dislexic. Thanks.  At least I am now getting error codes back and can move forward.<br />
<br />
Thanks,<br />
<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">santana108</div><div class="date">7th May 2010, 14:48</div></div><div class="posttext">Would help if you used CeCreateFile instead of CeFileCreate ;)<br />
<br />
Edit: And System should have put &quot;error&quot; on the stack.<br />
<br />
Stu<br />
<br />
That is in fact what was happening.<br />
<br />
Now that the function call name is correct I am getting an invalid parameter error.<br />
<br />
this is the System::Call<br />
<br />
 System::Call &quot;rapi::CeCreateFile(w 'application\\ctgtalk\\somefile.txt', i 3, i 0, i 0, i 1, i 128, i 0) i .r4&quot;<br />
<br />
which should be equivalent to <br />
<br />
CeCreateFile( L &quot;\\application\\ctgTalk\\somefile.txt&quot;,GENERIC_WRITE | GENERIC_READ,0,0,CREATE_NEW,FILE_ATTRIBUTES_NORMAL,0)<br />
<br />
<br />
Note: When calling fuctions through the System::Call forward slashes in front of the path don't work.  I was able to get the CeCreateDirectory function to work when I removed the forward slashes.<br />
<br />
If anyone has a clue for this one, it would be greatly appriciated.<br />
<br />
Chris</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">7th May 2010, 16:45</div></div><div class="posttext">You should use !defines for all the constants. For masks System allows | (bitwise or). That should help a bit. As for double backstrokes that is purely because in C/C++ (and others) a single backstroke is an escape character (i.e. &quot;\&quot;hello\&quot;&quot;). You don't need to use two here.<br />
<br />
Stu</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>