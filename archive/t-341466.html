<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Change images in nsDialogs, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Change images in nsDialogs NSIS Discussion" />
	
	<title> Change images in nsDialogs [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Change images in nsDialogs</div>
<hr />
<div class="pda"><a href="t-341466.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=341466">Change images in nsDialogs</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">30th January 2012, 15:58</div></div><div class="posttext">I state that I tried to look for some solutions about it in all the afternoon but I failed. <br />
I have to change an image of a nsDialog in runtime. I have a dialog like this:<br />
<br />
[ImageNo] IE8                         [ProgressBar]<br />
[ImageNo] Microsoft Visual C++  [ProgressBar]<br />
[ImageNo] Adobe                     [ProgressBar]<br />
<br />
If they are not installed in the OS I will show an image and I will install them. After installing IE8 for example I want show another image but I am not able to do it. Can someone help me?<br />
After installing IE8 my dialog should be:<br />
<br />
[ImageYes] IE8                         [ProgressBar]<br />
[ImageNo] Microsoft Visual C++  [ProgressBar]<br />
[ImageNo] Adobe                     [ProgressBar]<br />
<br />
I hope you understand what I mean.<br />
Thanks in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">30th January 2012, 16:35</div></div><div class="posttext">Just use the set image commands from the nsDialogs readme</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">31st January 2012, 07:14</div></div><div class="posttext">I tried but I can't get it. Ok I will try. I can't modify a dialog from a section without calling the function. Should I call the function with parameters to show what I want or is there an easiest way? Maybe passing handlers from the stack and then I can set images like I want.<br />
<br />
Edit: I tried without  success I am not able to understand where I am wrong. I made my creator function showing my dialog. Then I have a section where I install some components but I am not able to update the dialog that I showed and modifying progress bars or images.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">31st January 2012, 07:26</div></div><div class="posttext">Why are you talking about sections? nsDialogs are on custom pages.<br />
<br />
You should post the code you already have so we can see what the problem is...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">31st January 2012, 08:08</div></div><div class="posttext">My code is like this http://nsis.sourceforge.net/Docs/nsDialogs/Readme.html#step-add nothing more I only made the creator function. I have never used custom pages. Annnd here I attached an example code of what I want to do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">31st January 2012, 08:23</div></div><div class="posttext">You cannot modify pages in sections. All sections are executed on the instfiles page, so the previous page is gone. You need to create a new page after instfiles.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">31st January 2012, 08:38</div></div><div class="posttext">mmm ok. I will manage the function in a way that shows what I want to spend less parameters as possible. and are dialogs shown the same in silent mode?<br />
<br />
Edit: ok they are not shown</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">31st January 2012, 10:40</div></div><div class="posttext">I can't find &quot;delete post&quot; -.-''</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">31st January 2012, 10:41</div></div><div class="posttext">Is there a way to hide instfiles page and show only nsDialogs to make the user know what is happening?<br />
I mean substitute the instfiles page with a nsDialog practically</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">31st January 2012, 11:01</div></div><div class="posttext">Hmm... You could move all the Sections code to functions, then call those in your custom instfiles page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">31st January 2012, 12:22</div></div><div class="posttext">I tried this <br />
<br />
 Page custom nsDialogs<br />
Var counter<br />
Var message<br />
Function nsDialogs<br />
 nsDialogs::Create 1018<br />
 Pop $1<br />
    IntOp $counter 0 + 0<br />
    start:<br />
    Pop $0<br />
    ${If} $0 == &quot;done&quot;<br />
        StrCpy $message &quot;message$counter&quot;<br />
    ${ElseIf} $0 == &quot;&quot;<br />
         StrCpy $message &quot;starting&quot;<br />
    ${EndIf}<br />
    ${NSD_CreateLabel} 20 0 25% 12u &quot;$message&quot;<br />
    Pop $Label<br />
    nsDialogs::Show<br />
    IntOp $counter $counter + 1<br />
    Push &quot;done&quot;<br />
    Goto start<br />
FunctionEnd<br />
<br />
<br />
This code should be a loop and it is. But to make show different messages I have to press always close button.<br />
<br />
Edit: this code should change always the same label with a new one but it seems to have a sintax mistake. This code exit when create for the second time a label I don't know why anyway the meaning I think it's clear. Can it work? Anyway I have to solve the problem to close always the window manually to make a new one appear</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">31st January 2012, 12:36</div></div><div class="posttext">You can only show a page once. Because of this, you can only create it once, too. To update a label, use SendMessage with the ${WM_SETTEXT} message.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">31st January 2012, 12:42</div></div><div class="posttext">Yeah you are right and to update an image? As I understood I can't reload an entire dialog. But I can't make ${NSD_SetImage} $Image &quot;path&quot; $ImageHandler to set a new one because I need to close the last one. .-. any &quot;sendImage&quot; command? T.T<br />
<br />
Edit: I trawled the .nsh file and I found this:<br />
SendMessage $R0 ${STM_SETIMAGE} ${_IMGTYPE} $0<br />
<br />
Could be useful? If yes can you explain me those parameters?<br />
<br />
<br />
Edit2: ok I made a simple and ignorant copy/paste of this <br />
<br />
StrCpy $0 &quot;MyImage.bmp&quot;<br />
		System::Call 'user32::LoadImage(i 0, t r0, i ${IMAGE_BITMAP}, i 0, i 0, i ${LR_LOADFROMFILE}) i.s'<br />
		Pop $IMAGE<br />
		SendMessage $Image ${STM_SETIMAGE} ${IMAGE_BITMAP} $IMAGE<br />
<br />
And it work but remain the problem that I have to press close button to show the next dialog. How can I do to solve this problem?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">31st January 2012, 13:39</div></div><div class="posttext">Nothing I have always to close the last dialog to open another one. I have to open a dialog. Execute a program and show another dialog with a modify image. I have to do this process many times. But it seems that when I make nsDialogs::Show the function stop also if I have other code after. &gt;.&lt; I am made I must  take a break. Someone has time to make a little example code on how to open a dialog set some images and then change them with some conditions? It will be really helpful</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">31st January 2012, 14:08</div></div><div class="posttext">Indeed nsDialogs::Show halts execution of the script until Next or Back is clicked. You need to use a callback function, such as nsD_OnClick.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">31st January 2012, 14:25</div></div><div class="posttext">I think I don't follow you. How can I use a callback function in this case? I don't want to stress but I can't understand. I am working with nsis since one month but it's a really big &quot;world&quot;. Anyway if you are so patient to explain me I am grateful to you. Anyway I will try to do it by myself.... ^^</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">31st January 2012, 14:53</div></div><div class="posttext">Callback functions are NSIS functions that get called when something special happens. nsDialogs can call callbacks for specific events, for example the onclick event. The only way to execute NSIS code while nsDialogs is waiting for the Next or Back button to be clicked, is to use a callback function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">31st January 2012, 15:08</div></div><div class="posttext">ok... You say to set on .OnClick function (when I press install)  my nsis code and then refresh my dialog when I need it?:|</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">31st January 2012, 16:46</div></div><div class="posttext">This will not work. NSIS code (except in Sections) runs under the same thread as the UI. Therefore the UI will not update until your callback function has returned (i.e. it will become unresponsive). The only thing you can do is add an image on the InstFiles page with Resource Hacker.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">31st January 2012, 17:11</div></div><div class="posttext">Ok stu. Tomorrow morning I will look for an &quot;escamotage&quot;. Maybe a little patch. Or something else. Anyway thanks for the patience again =P.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">1st February 2012, 07:54</div></div><div class="posttext">Ok stu. Tomorrow morning I will look for an &quot;escamotage&quot;. Maybe a little patch. Or something else. Anyway thanks for the patience again =P<br />
I was thinking about what I can do to solve this issue. Is there a way to say to a dialog to close itself so I can open another one? Any idea to achieve my goal. The perfect thing is to eliminate the wait after nsDialogs::show I think. But I have no idea how to do it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bennaloz</div><div class="date">1st February 2012, 10:25</div></div><div class="posttext">I solved my problem. I make the main setup run in silent mode comunicate with a secondary setup that only shows Dialogs according to parameters that I send. Every time I need a new dialog I will kill the last process and will execute a new one with new parameters. It seems to work. Maybe it's not the best solution but it's better than nothing</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>