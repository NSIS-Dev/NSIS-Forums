<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" [nsDialogs] Multi-select Listbox?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  [nsDialogs] Multi-select Listbox? NSIS Discussion" />
	
	<title> [nsDialogs] Multi-select Listbox? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  [nsDialogs] Multi-select Listbox?</div>
<hr />
<div class="pda"><a href="t-321778.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=321778">[nsDialogs] Multi-select Listbox?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Netsurfer24</div><div class="date">18th August 2010, 13:36</div></div><div class="posttext">Hi,<br />
<br />
I thought it would be easy to create a multiple select listbox with nsDialogs, but obviously I was wrong. :rolleyes:<br />
<br />
I have done the following:<br />
<br />
${NSD_CreateListBox} 10u 70u 200u 35u $(LB_CleanUp) <br />
Pop $ListBox_CleanUp<br />
${NSD_AddStyle} $ListBox_CleanUp ${LBS_MULTIPLESEL}<br />
<br />
Adding the &quot;LBS_MULTIPLESEL&quot; should do the trick - but it did not.<br />
<br />
After these lines I fill the listbox with several values - all works fine/ as expected.<br />
But I can only choose one item at a time.<br />
<br />
Is there anything wrong with the code?<br />
Did I miss something?<br />
Or what do I have to do to create a multiple select listbox with nsDialogs?<br />
<br />
Thanks,<br />
<br />
Gunther</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">18th August 2010, 14:04</div></div><div class="posttext">Some styles you can't add after a control has been instantiated - LBS_MULTIPLESEL is one of them.  You'll have to create the control manually from scratch.<br />
<br />
Below is a code snippet to simply add a new ${NSD_Create* command, ${NSD_CreateListboxMultiselect}.<br />
<br />
<br />
!define __NSD_ListBoxMultiselect_CLASS LISTBOX<br />
!define __NSD_ListBoxMultiselect_STYLE ${DEFAULT_STYLES}|${WS_TABSTOP}|${WS_VSCROLL}|${LBS_DISABLENOSCROLL}|${LBS_HASSTRINGS}|${LBS_NOINTEGRALHEIGHT}|${LBS_NOTIFY}|${LBS_MULTIPLESEL}<br />
!define __NSD_ListBoxMultiselect_EXSTYLE ${WS_EX_WINDOWEDGE}|${WS_EX_CLIENTEDGE}<br />
!insertmacro __NSD_DefineControl ListBoxMultiselect<br />
<br />
<br />
I think the guys were still pondering options on how to make adding these types of styles -before- instantiating the control more flexible.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Netsurfer24</div><div class="date">18th August 2010, 14:11</div></div><div class="posttext">Some styles you can't add after a control has been instantiated - LBS_MULTIPLESEL is one of them.  You'll have to create the control manually from scratch.<br />
Ahhh ..., that's the trap again ... :D, I see.<br />
<br />
Then it is clear - thanks! :up:<br />
<br />
Gunther</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Netsurfer24</div><div class="date">18th August 2010, 22:14</div></div><div class="posttext">It's me again ... :p<br />
<br />
Animaether's code works perfectly.<br />
But now I have another problem ... :cry:<br />
<br />
I gather some values and write them to a file before the page with the listbox is shown.<br />
In the page's (show) function I check if the file exists and if so add each line from the file as an item to the listbox. And there is also one value deriving from a variable added to the listbox.<br />
<br />
So far so good.<br />
But on page leave (no matter if back or next) and first time returning to the page there is only the value coming from the variable!?<br />
Leaving the page and returning again brings back all values!?<br />
<br />
Any ideas?<br />
<br />
Here is the code passage that reads the values from the file:<br />
<br />
${If} ${FileExists} $TEMP\ocpn_prev_installs.tmp<br />
	FileOpen $R0 $TEMP\ocpn_prev_installs.tmp r<br />
	IfErrors done<br />
	${Do}<br />
		FileReadUTF16LE $R0 $0<br />
		${If} $0 == &quot;&quot;<br />
			Goto done<br />
		${Else}<br />
			FileReadUTF16LE $R0 $R1<br />
			SendMessage $ListBox_CleanUp ${LB_ADDSTRING} 0 &quot;STR:$R1&quot;<br />
		${EndIf}<br />
	${Loop}<br />
	done:<br />
	FileClose $R0<br />
${EndIf}<br />
<br />
<br />
What am I doing wrong this time ...? :o<br />
<br />
Gunther</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th August 2010, 00:09</div></div><div class="posttext">You probably want a ClearErrors at the top.<br />
<br />
Edit: Also instead of Goto done and done: you can just use ${ExitDo} or ${Break}.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Netsurfer24</div><div class="date">19th August 2010, 00:21</div></div><div class="posttext">Stu,<br />
You probably want a ClearErrors at the top.<br />
you are so right ...! :up:<br />
I should remember to clear the error flag when using IfErrors ... :rolleyes:<br />
Edit: Also instead of Goto done and done: you can just use ${ExitDo} or ${Break}.<br />
<br />
Ah, OK - I see.<br />
<br />
Thanks,<br />
<br />
Gunther</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>