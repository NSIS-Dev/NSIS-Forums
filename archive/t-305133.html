<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" What about this NSIS installer script - possible or not?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  What about this NSIS installer script - possible or not? NSIS Discussion" />
	
	<title> What about this NSIS installer script - possible or not? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  What about this NSIS installer script - possible or not?</div>
<hr />
<div class="pda"><a href="t-305133.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305133">What about this NSIS installer script - possible or not?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">underline</div><div class="date">9th April 2009, 02:01</div></div><div class="posttext">Hello everyone,<br />
<br />
I want to create an NSIS script and I need your help:<br />
<br />
I have next files:<br />
<br />
file1.exe<br />
file2.exe<br />
file3.dll<br />
file4.dll<br />
file5.dat<br />
file6.dat<br />
<br />
and I want all files to be added to an installer with the next options:<br />
<br />
The installer should extract all files to temp folder, then the file &quot;file1.exe&quot; should start, then the files should be copied/moved to the Windows/system32 folder and deleted from temp folder, then file2.exe should start.<br />
<br />
I use the next NSIS script to create an installer that extract the files on Windows temp folder and then run file1.exe but don't know how to update it to copy/move the files to Windows\system32 folder and then run file2.exe<br />
<br />
Here is the script so please any help to update it or give me a new solution will be highly appreciated. Here is the script:<br />
<br />
<br />
<br />
OutFile &quot;installer.exe&quot;<br />
Icon &quot;name.ico&quot;<br />
SilentInstall Silent<br />
WindowIcon Off<br />
CRCCheck On<br />
SetCompress Off<br />
RequestExecutionLevel highest<br />
<br />
Section<br />
<br />
; Generate a temp file name<br />
GetTempFileName $0<br />
; Delete it and replace it with a folder<br />
Delete $0<br />
CreateDirectory $0<br />
<br />
; Report any problem<br />
IFErrors 0 +2<br />
  Abort &quot;Can't install application! Please contact support.&quot;<br />
<br />
; Unpack files<br />
SetOutPath $0<br />
<br />
; Pack all the files in the current directory and its subdirectories,<br />
; excluding anything in SVN<br />
; File /r /x .svn &quot;*.*&quot;<br />
File /r /x .svn /x *.ico /x *.nsi &quot;*.*&quot;  ; Also exclude the ICO and NSI files from installer<br />
<br />
; Run the executable and wait<br />
ClearErrors<br />
SetOutPath &quot;$0\&quot;<br />
<br />
; IMPORTANT: Place the name of your starting executable (i.e. the file to run<br />
; when unpacked) here.<br />
ExecWait &quot;$0\file1.exe&quot;<br />
<br />
IFErrors 0 +2<br />
    Abort &quot;Can't run app! Please contact support.&quot;<br />
<br />
  ; And delete the unpacked files<br />
  ClearErrors<br />
  SetOutPath $TEMP        ; Need to do this because we can't delete the working folder<br />
RMDir /r $0           ; If there's an error we probably don't really care, as it's in a temp folder<br />
<br />
SectionEnd<br />
<br />
<br />
<br />
<br />
<br />
Thank you in advance for your help. <br />
If anyone can offer me real support then I can pay him for the time spent for me!<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th April 2009, 02:22</div></div><div class="posttext">Unpack your files in $PLUGINSDIR which is removed upon terminating the installer. (see the manual)<br />
<br />
ExecWait or nsExec the file1.exe (see the manual again)<br />
<br />
Once the file1.exe has finished CopyFiles or Rename from the $PLUGINSDIR to $SYSDIR (once again see the manual)<br />
<br />
Finally launch file2.exe with Exec or ExecWait or nsExec if you're dealing with console applications.<br />
<br />
What else? Read the documentation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">underline</div><div class="date">9th April 2009, 17:40</div></div><div class="posttext">Red Wine, thank you so much for your reply!<br />
<br />
I am just beginner with NSIS and I need someone to update my script (or post a new one) for my case. <br />
<br />
As I said before, if anyone can offer me professional support and help me with what I need, I can pay with PayPal for that, just let me know!<br />
<br />
If anyone can update my script or create a new one for my case please let me know.<br />
<br />
Thank you!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th April 2009, 21:10</div></div><div class="posttext">Nevertheless, you'll need to provide more details about the task.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">underline</div><div class="date">9th April 2009, 21:55</div></div><div class="posttext">Red Wine, thank you again for your reply!<br />
<br />
I will try to give you more info as requested:<br />
<br />
I will rename the files to make you understand much better what I need:<br />
<br />
uninstall.exe<br />
uninstall.dat<br />
installer.exe<br />
installer.dll<br />
installer.dat<br />
<br />
Now I need an installer with all the above files inside and the installer should unpack the files on Windows TEMP folder, then next run the uninstall.exe file (this will uninstall any previous installed version of the application which is installed on Windows system32 folder) then once any old version is uninstalled the installer files (installer.exe, installer.dll, installer.dat) should be copied/moved to Windows system32 folder and the file installer.exe should be executed. After this is completed the temp files should be deleted.<br />
<br />
Also next options should be there:<br />
<br />
SilentInstall Silent ; for Silent install<br />
RequestExecutionLevel highest    ; for Vista<br />
CRCCheck On ; I think is needed<br />
SetCompress Off ; I think is needed for faster extraction<br />
<br />
If you need more info please let me know and if you spend your time to help me I don't want you to do it for nothing, I want to pay you for that and maybe we can continue future collaboration.<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">9th April 2009, 22:14</div></div><div class="posttext">Okay, do you want to upload the files somewhere and give the link to download them and build your installation or you prefer a script on which you'll replace the file names and the local paths in order to compile it your self?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">underline</div><div class="date">9th April 2009, 22:19</div></div><div class="posttext">Red Wine, thank you!<br />
<br />
I prefer a script on which I will replace the file names and the local paths in order to compile it my self. <br />
<br />
In the script I post it I should have the files in one folder and the script will add all the files inside the folder to installer excepting the .svn , .nsi and .ico files which not needed on the installer. I preffer same way when I create the installer but only if is possible.<br />
<br />
Thanks!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>