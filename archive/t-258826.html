<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Clearing fields, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Clearing fields NSIS Discussion" />
	
	<title> Clearing fields [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Clearing fields</div>
<hr />
<div class="pda"><a href="t-258826.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258826">Clearing fields</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">davidnewcomb</div><div class="date">3rd November 2006, 11:19</div></div><div class="posttext">Just spent the last week writing an installer with bells and whistles, and hit a problem. Scenario: I have several custom pages which I use to collect info. Some of the info is repeated and so the custom pages have to be repeated with cleared fields. There are various fields which are dynamically greyed out depending on what on the page is selected.<br />
<br />
I did start of with a &quot;Page custom startFn leaveFn&quot; which handles the NOTIFY to grey out the buttons. But found that there was no way to clear a text field. I did use MUI_INSTALLOPTIONS_WRITE but found that you really need to call MUI_INSTALLOPTIONS_DISPLAY to redraw the screen with the new changes.<br />
<br />
Then I looked at the mathtest.nsi to figure out how to repeatedly show the same screen, and found that it uses MUI_INSTALLOPTIONS_DISPLAY_RETURN to stay in the startFn and loop until it's ok. MUI_INSTALLOPTIONS_DISPLAY_RETURN only returns Success or Failed, so there is no way to tell if one of my custom buttons is being called.<br />
<br />
I'm a bit confused about how I can submit a page (maybe from a custom button), have it do something and then clear all the fields.<br />
<br />
Any help would be appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd November 2006, 12:11</div></div><div class="posttext">The INI file is not reloaded when after the leave function returns. It's only rewritten before the leave function is called.<br />
<br />
To change fields, you should use the same method you've used to disable them. Only instead of using EnableWindow, you use SendMessage ${WM_SETTEXT}.<br />
<br />
Take a look at the custom page leave function in Examples\InstallOptions\testnotify.nsi (http://nsis.sourceforge.net/Examples/InstallOptions/testnotify.nsi). It shows you how to do it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">davidnewcomb</div><div class="date">3rd November 2006, 13:56</div></div><div class="posttext">Thanks for the fast response.<br />
<br />
'wparam' seems to be what you want to set it to, but what is 'lparam' for?<br />
<br />
Is there some documentation for SendMessage which describes which types of dialog box, need what message in order to do what action/job?<br />
There seems to be a lot of &quot;SendMessage $0 $1 0x0123 0&quot; (or whatever) entries which don't describe where 0x0123 came from.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd November 2006, 14:01</div></div><div class="posttext">lParam is not used in the case of WM_SETTEXT and should be set to zero. WM_SETTEXT is a standard window message and is best described in MSDN (http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/windows/windowreference/windowmessages/wm_settext.asp?frame=true). MSDN contains reference to all available messages.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">davidnewcomb</div><div class="date">3rd November 2006, 14:22</div></div><div class="posttext">Ok, one final thing on the same lines. The box I am trying to fill in is a multi-line readonly text box. I read a file which contains:<br />
<br />
  1|1|1<br />
  2|2|2<br />
<br />
into $0 and give it to MUI_INSTALLOPTIONS_WRITE but it only displays the 1st line. So I have to read the file in and replace the \r\n with actual &quot;\r\n&quot;. Presumerably because there is an INI file behind and it only accepts single line entries.<br />
<br />
However when I call SendMessage and give it the converted read-from-file string containing actual &quot;\r\n&quot; it prints these in the boxes.<br />
<br />
Are there any built in functions that can help here, or do I have to handle each case with my own functions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd November 2006, 14:25</div></div><div class="posttext">The InstallOptions (http://nsis.sourceforge.net/Docs/InstallOptions/Readme.html) readme contains Io2Nsis and Nsis2Io which do exactly that. WordReplace (http://nsis.sourceforge.net/Docs/AppendixE.html#E.3.8) can also help here.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">davidnewcomb</div><div class="date">3rd November 2006, 15:28</div></div><div class="posttext">Excellent thanks for you help. Things are progressing nicely. Why aren't Io2Nsis and Nsis2Io included in the standard distribution?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd November 2006, 15:31</div></div><div class="posttext">They are. That readme is located in the Docs folder in your installation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">davidnewcomb</div><div class="date">3rd November 2006, 16:13</div></div><div class="posttext">I mean in a nsh file. With all the other useful functions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd November 2006, 16:20</div></div><div class="posttext">Because that change could be easily implemented using WordReplace in WordFunc.nsh.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">davidnewcomb</div><div class="date">3rd November 2006, 16:28</div></div><div class="posttext">Ok. Thanks for you help on this one. Shalom!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>