<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" trouble registering dll, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  trouble registering dll NSIS Discussion" />
	
	<title> trouble registering dll [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  trouble registering dll</div>
<hr />
<div class="pda"><a href="t-260545.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=260545">trouble registering dll</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">jpodtbc</div><div class="date">27th November 2006, 23:57</div></div><div class="posttext">hi all.<br />
<br />
i'm having trouble registering my BHO DLL.<br />
<br />
i can manually register it using &quot;regasm /codebase file.dll&quot; and all the appropriate registry entries are created. <br />
<br />
however, after searching through the forums for quite some time and trying all the offered solutions for registering a DLL with nsis, i'm still stuck.<br />
<br />
i tried the following: <br />
SetOutPath $INSTDIR<br />
...<br />
File &quot;file.dll&quot;<br />
RegDLL &quot;$INSTDIR\file.dll&quot; but i get an error when i check with IfErrors.<br />
<br />
i also tried using the InstallLib macro as follows:<br />
!define LIBRARY_COM <br />
!insertmacro InstallLib REGDLL NOTSHARED NOREBOOT_NOTPROTECTED &quot;path_to_local\file.dll&quot; &quot;$INSTDIR\file.dll&quot; &quot;$SYSDIR&quot;but this also raised the error flag. i checked the registry manually and the DLL is never being registered properly. <br />
<br />
i don't know if it has to do with it being a COM object. i've tried installing the dependency into the same directory before registering but still no luck. it's strange, though, because regasm registers the DLL fine when the dependency is not there.<br />
<br />
thanks for any help...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpodtbc</div><div class="date">28th November 2006, 01:27</div></div><div class="posttext">i have further compiled my dll using a strong name and it still doesn't work for either case...shrug.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th November 2006, 17:09</div></div><div class="posttext">RegDLL isn't the same as regasm.exe. The latter registers a .NET assembly. The first merely calls DllRegisterServer from the DLL. You'll have to manually call regasm.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpodtbc</div><div class="date">30th November 2006, 17:42</div></div><div class="posttext">that's strange because there were at least a couple of other threads in which users were asking how to circumvent having to use regasm.exe to register their .NET dlls. they were repeatedly told to use RegDLL/UnRegDLL or the InstallLib/UninstallLib macros.<br />
<br />
<br />
does anyone know if the UpgradeDLL registers .NET assemblies?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th November 2006, 18:43</div></div><div class="posttext">UpgradeDLL uses RegDLL, so it doesn't.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>