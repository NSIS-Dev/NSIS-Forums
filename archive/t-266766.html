<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Need File association help, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Need File association help NSIS Discussion" />
	
	<title> Need File association help [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Need File association help</div>
<hr />
<div class="pda"><a href="t-266766.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=266766">Need File association help</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">f1nn</div><div class="date">28th February 2007, 12:08</div></div><div class="posttext">Hi<br />
<br />
I am trying to set a file assocation for my application<br />
I am trying the script by Vytautas on the NSIS site<br />
http://nsis.sourceforge.net/wiki/File_Association.<br />
However I am having trouble and dont understand what is going wrong.<br />
If I check the registry after runing the script I can see that under HOT  KEY CLASSES ROOT their is a folder called .riverDoc.<br />
I also have a folder called RiverDocs.riverDoc, contained within this are two more folders one called RiverDocsIcon.ico and the shell folder which contains the Edit and Open commands.<br />
<br />
If I highlight the .riverDoc folder the registry shows the following information<br />
Name       Type      Data<br />
(Default)  Reg_SZ    RiverDoc.riverDoc<br />
<br />
If I highlight the RiverDoc.riverDoc folder the registry shows the following information<br />
<br />
Name       Type      Data<br />
(Default)  Reg_SZ    RiverDoc File<br />
EditFlags  Reg_DWORD 0x00000000 (0)<br />
<br />
The entry for the RiverDocsIcon reads<br />
Name       Type      Data<br />
(Default)  REG_SZ    c:\program files\RiverDocs\RiverDoc.exe,0<br />
<br />
If I highlight the edit or the open folder I see for edit<br />
Name       Type      Data<br />
(Default)  REG_SZ    edit<br />
and for open<br />
Name       Type      Data<br />
(Default)  REG_SZ   Value not set<br />
   <br />
The shell edit command folder highlighted reads<br />
Name       Type      Data<br />
(Default)  REG_SZ    c:\program files\RiverDocs\RiverDoc.exe&quot;%1&quot;<br />
<br />
The shell open command folder highlighted  reads<br />
Name       Type      Data<br />
(Default)  REG_SZ    c:\program files\RiverDocs\RiverDoc.exe&quot;%1&quot;<br />
<br />
The problem that I am having is that when I check the file assocations in explorer folder options I can see in file types<br />
Extension  FileTypes<br />
RIVERDOC   RiverDocs File<br />
<br />
When I go to the advanced option edit and open appear in the actions panel RiverDocs File appears in the textfiels beside the change icon button. If I choose to highlight the edit or open action and choose edit button I get the proper path in the application used to perform action <br />
C:\Program Files\RiverDocs\RiverDoc.exe &quot;%1&quot;<br />
<br />
Thsi all seeams ok but if I try to open a file of type riverdoc it just wont work. Windows asks me to choose the program to open the file. Also the Icons are not appearing in the file assocation in explorer folder options file types nor on the document that I am trying to open. Sorry if this is a bit long winded but I would apprecate any help in pointing out what I am doing wrong and how I might fix it. I have trawled the site and seen similar questions but no answers that work for me yet.<br />
<br />
many thanks<br />
<br />
<br />
!define Index &quot;Line${__LINE__}&quot;<br />
                  ReadRegStr $1 HKCR &quot;.riverdoc&quot; &quot;&quot;<br />
                  StrCmp $1 &quot;&quot; &quot;${Index}-NoBackup&quot;<br />
                  StrCmp $1 &quot;RiverDocs.riverdoc&quot; &quot;${Index}-NoBackup&quot;<br />
                  WriteRegStr HKCR &quot;.riverDoc&quot; &quot;backup_val&quot; $1<br />
                &quot;${Index}-NoBackup:&quot;<br />
                  WriteRegStr HKCR &quot;.riverDoc&quot; &quot;&quot; &quot;RiverDocs.riverDoc&quot;<br />
                  ReadRegStr $0 HKCR &quot;RiverDocs.riverDoc&quot; &quot;&quot;<br />
                  StrCmp $0 &quot;&quot; 0 &quot;${Index}-Skip&quot;<br />
                  WriteRegStr HKCR &quot;RiverDocs.riverdoc&quot; &quot;&quot; &quot;RiverDocs File&quot;<br />
                  WriteRegStr HKCR &quot;RiverDocs.riverdoc\shell&quot; &quot;&quot; &quot;open&quot;<br />
                  WriteRegStr HKCR &quot;RiverDocs.riverdoc\RiverDocsIcon.ico&quot; &quot;&quot; &quot;$INSTDIR\RiverDoc.exe,0&quot;<br />
                &quot;${Index}-Skip:&quot;<br />
                  WriteRegStr HKCR &quot;RiverDocs.riverdoc\shell\open\command&quot; &quot;&quot; \<br />
                  '$INSTDIR\RiverDoc.exe &quot;%1&quot;'<br />
                  WriteRegStr HKCR &quot;RiverDocs.riverdoc\shell\edit&quot; &quot;&quot; &quot;Edit&quot;<br />
                  WriteRegStr HKCR &quot;RiverDocs.riverdoc\shell\edit\command&quot; &quot;&quot; \<br />
                  '$INSTDIR\RiverDoc.exe &quot;%1&quot;'<br />
<br />
!define SHCNE_ASSOCCHANGED 0x8000000<br />
!define SHCNF_IDLIST 0<br />
System::Call 'Shell32::SHChangeNotify(i ${SHCNE_ASSOCCHANGED}, i ${SHCNF_IDLIST}, i 0, i 0)'<br />
                  ;System::Call 'shell32.dll::SHChangeNotify(i, i, i, i) v (0x08000000, 0, 0, 0)'<br />
                  ;System::Call 'Shell32::SHChangeNotify(i 0x8000000, i 0, i 0, i 0)'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">28th February 2007, 13:59</div></div><div class="posttext">Try putting quotes around the program path in the registry shell commands. When you write the shell edit and open commands, try '&quot;$INSTDIR\Riverdoc.exe&quot; &quot;%1&quot;'. (single quotes around two quoted strings).<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">f1nn</div><div class="date">1st March 2007, 13:42</div></div><div class="posttext">thanks for the reply I will try this</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>