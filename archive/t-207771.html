<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Createshortcut Problems, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Createshortcut Problems NSIS Discussion" />
	
	<title> Createshortcut Problems [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Createshortcut Problems</div>
<hr />
<div class="pda"><a href="t-207771.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=207771">Createshortcut Problems</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Tmort</div><div class="date">14th February 2005, 16:20</div></div><div class="posttext">I'm trying to create a shortcut, particularly on the Desktop and specify an icon.<br />
<br />
I have output set to &quot;$INSTDIR&quot; and this is where all the files a copied to including the icon file.<br />
<br />
I've tried a few variations and I can get the code to compile but it doesn't create a shortcut when I run it.<br />
<br />
The section of code is:<br />
<br />
SetOutPath &quot;$INSTDIR&quot;<br />
  SetOverwrite ifnewer<br />
  ;File &quot;..\..\path\to\file\mydb.mdb&quot;<br />
  CreateDirectory &quot;$SMPROGRAMS\mydb&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\mydb\mydb.lnk&quot; &quot;$INSTDIR\mydb.mdb&quot; &quot;mydb icon.ico&quot;<br />
  CreateShortCut &quot;$DESKTOP\mydb.lnk&quot; &quot;$INSTDIR\mydb.mdb&quot;  &quot;mydb icon.ico&quot;<br />
<br />
Thanks in advance for the help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">14th February 2005, 16:39</div></div><div class="posttext">You use SetOutPath to set the 'Start in' path for shortcuts. You need to specify the full path to your icon:<br />
&quot;$INSTDIR\mydb icon.ico&quot;<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tmort</div><div class="date">14th February 2005, 21:14</div></div><div class="posttext">I guess I don't get it.<br />
<br />
I've tried:<br />
<br />
Section &quot;MainSection&quot; SEC01<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  SetOverwrite ifnewer<br />
  ;File &quot;..\..\path\to\file\mydb.mdb&quot;<br />
  CreateDirectory &quot;$SMPROGRAMS\mydb&quot;<br />
  <br />
  ;File &quot;..\..\path\to\file\Example.file&quot;<br />
  File &quot;mydb.mdb&quot;<br />
  File &quot;mydb Icon.ico&quot;<br />
  File &quot;mydb_DATA.mdb&quot;<br />
  SetOutPath &quot;$instdir\mydb icon.ico&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\mydb\mydb.lnk&quot; &quot;$INSTDIR\mydb.mdb&quot; &quot;$instdir\mydb icon.ico&quot;<br />
  CreateShortCut &quot;$DESKTOP\iwcd.lnk&quot; &quot;$INSTDIR\mydb.mdb&quot;  &quot;$instdir\mydb icon.ico&quot;<br />
<br />
SectionEnd<br />
<br />
What am I missing?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th January 2007, 13:57</div></div><div class="posttext">The icon path is the fourth parameter. The third parameter is the command line parameters. Add an empty set of quotes between the mdb and the file and it should work.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>