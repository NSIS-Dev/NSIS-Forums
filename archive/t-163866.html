<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" continue install after reboot, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  continue install after reboot NSIS Discussion" />
	
	<title> continue install after reboot [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  continue install after reboot</div>
<hr />
<div class="pda"><a href="t-163866.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=163866">continue install after reboot</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">moxo</div><div class="date">8th January 2004, 14:41</div></div><div class="posttext">i Have a problem with barcode fonts, in my installation program i copy this fonts in windows directory after i execute the code(joined with this message) to install font. after my installation launch installation of access runtime and after it launch an update of microsoft component with their program called osp.msi but this last program need a reboot. I do a reboot with my installation and the osp program after reboot continue the update. At the end of update i launch my application but for my application, the barcode fonts are not installed. if relaunch my installation, the access runtime and microsoft update component are not re-installed because they are already present but my font are installer again. And now my application can create goods barcode.<br />
I want to know is possible to install my fonts after the reboot and after the end of update microsoft conponent?<br />
how i do? thanks very much<br />
;code i use a the end of my installation<br />
execwait '&quot;$SYSDIR\msiexec.exe&quot; /i &quot;$EXEDIR\access-2000\osp.msi&quot; REBOOT=&quot;ReallySuppress&quot; /qb-'<br />
setrebootflag true<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">8th January 2004, 14:53</div></div><div class="posttext">Does it install the fonts after the reboot? Otherwise you can just register it after installation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">moxo</div><div class="date">8th January 2004, 16:12</div></div><div class="posttext">if i can i want to install font after reboot and after the end of microsoft update component, i do this because i thinks perhaps this resolve my problme. But for the moment i install the font just before the reboot :(<br />
if the register after the reboot is good and resolve my problem, it's good for me. but how can i register after reboot?<br />
thanks Joost</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">8th January 2004, 16:30</div></div><div class="posttext">Why do you want to register after reboot? You can register fonts immidiately. See the NSIS Archive for information about font registering.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">moxo</div><div class="date">9th January 2004, 16:43</div></div><div class="posttext">if i use fonts.dll, i need to put fonts.dll only in plugin subdirectory of nsis directory or i must to put on source installation($exedir).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">9th January 2004, 19:15</div></div><div class="posttext">Put plug-ins in the Plugins folder. You can also use the system plug-in to register fonts:<br />
!include WinMessages.nsh<br />
<br />
System::Call &quot;GDI32::AddFontResourceA(t) i ('fontname.fon') .s&quot;<br />
Pop $0<br />
# $0 is zero if the function failed<br />
SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">moxo</div><div class="date">13th January 2004, 13:33</div></div><div class="posttext">i try this part of script i joined but i have the same problem. When i reboot, the fonts are copied but not registered. I open the windows font directory and after is good.<br />
my nsis's version is 2.0b3.<br />
i go tested with sytem plugin.<br />
i write this??:<br />
System::Call &quot;GDI32::AddFontResourceA(t) i ('fontname.fon') .s&quot;<br />
System::Call &quot;GDI32::AddFontResourceA(t) i ('fontname2.fon') .s&quot;<br />
Pop $0<br />
SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0<br />
<br />
or:<br />
System::Call &quot;GDI32::AddFontResourceA(t) i ('fontname.fon') .s&quot;<br />
Pop $0<br />
SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0<br />
System::Call &quot;GDI32::AddFontResourceA(t) i ('fontname2.fon') .s&quot;<br />
Pop $0<br />
SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0<br />
thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comm@nder21</div><div class="date">13th January 2004, 13:41</div></div><div class="posttext">it's recommended to upgrade to nsis2rc2 :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">moxo</div><div class="date">13th January 2004, 14:51</div></div><div class="posttext">yes but I would be obliged to change my scripts. And it's more future problem for me:) and for you because you help me much:)).<br />
and i don't have time know to modify all scripts</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">13th January 2004, 15:18</div></div><div class="posttext">System::Call &quot;GDI32::AddFontResourceA(t) i ('fontname.fon') .s&quot;<br />
Pop $0<br />
System::Call &quot;GDI32::AddFontResourceA(t) i ('fontname2.fon') .s&quot;<br />
Pop $0<br />
SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0<br />
<br />
Should work fine. Make sure the filename is correct.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">moxo</div><div class="date">13th January 2004, 16:52</div></div><div class="posttext">it is not good again :(<br />
so for the moment i use <br />
for winnt<br />
WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts&quot; \<br />
&quot;BARCODES 12 MEDIUM (TrueType)&quot; &quot;N01bc12m.ttf&quot;<br />
<br />
for win9x<br />
WriteRegStr HKEY_LOCAL_MACHINE &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Fonts&quot; \<br />
&quot;BARCODES 12 MEDIUM (TrueType)&quot; &quot;N01bc12m.ttf&quot;<br />
<br />
i try later with the last version of nsis</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>