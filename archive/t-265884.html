<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" It's late and I don't see my error..., media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  It's late and I don't see my error... NSIS Discussion" />
	
	<title> It's late and I don't see my error... [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  It's late and I don't see my error...</div>
<hr />
<div class="pda"><a href="t-265884.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=265884">It's late and I don't see my error...</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">15th February 2007, 23:52</div></div><div class="posttext">This little piece of code should copy one of several files to the system folder and set it as the wallpaper. The file is not copied, but the registry key is set. Can anyone think why? (This is running on Windows 2000, logged on as administrator).<br />
<br />
${If} ${FileExists} &quot;C:\Ipls\Lockout\$0.bmp&quot;<br />
	CopyFiles &quot;C:\Ipls\Lockout\$0.bmp&quot; &quot;$SYSDIR\NTL_POPUP.bmp&quot;	1407<br />
	WriteRegStr HKCU &quot;Control Panel\Desktop&quot; &quot;Wallpaper&quot; &quot;$SYSDIR\NTL_POPUP.bmp&quot;<br />
${EndIf}<br />
<br />
<br />
The value shown in the registry ends up as C:\Winnt\system32\NTL_POPUP.bmp<br />
<br />
Thanks,<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">16th February 2007, 00:00</div></div><div class="posttext">The user might not have enough permissions to write to the system directory or you might have a relative jump above ${If} which skips the check itself.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">16th February 2007, 00:08</div></div><div class="posttext">I am only using LogicLib statements, there are no relative jumps coded here. I am able to copy the file in manually (same logon).<br />
<br />
Here's the code immediately before the piece I posted above:<br />
<br />
ReadRegStr $R0 HKLM &quot;${REG_ARCHITECT}\System&quot; &quot;Display Partner Logo&quot;<br />
${Unless} ${Errors}<br />
	${If} $R0 == &quot;TRUE&quot;<br />
		StrCpy $0 &quot;Partner&quot;<br />
	${EndIf}<br />
${EndUnless}<br />
<br />
<br />
There is a little bit more logic ahead of this that sets $0 to one of 6 values depending upon another registry value.<br />
<br />
Don</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">17th February 2007, 11:19</div></div><div class="posttext">Just to close out my thread...<br />
<br />
I found that I wasn't extracting the bmp files before I tried to select one of them for the wallpaper. (They are in different sections, and I had to reorder the sections). The registry was being set by the application after the install finished and started it, but before I had a chance to look to see what lines of code executed. <br />
<br />
Don  :hang:</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>