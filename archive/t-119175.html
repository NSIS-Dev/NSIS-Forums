<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" New to NSIS: very simple help, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  New to NSIS: very simple help NSIS Discussion" />
	
	<title> New to NSIS: very simple help [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  New to NSIS: very simple help</div>
<hr />
<div class="pda"><a href="t-119175.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=119175">New to NSIS: very simple help</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">robdal</div><div class="date">27th December 2002, 08:05</div></div><div class="posttext">Hi everybody,<br />
I'm totally new to NSIS and I need some help to get started.<br />
What I need is very simple indeed:<br />
1) no user interface at all<br />
2) I need to check if the version of Internet Explorer installed is greater then 5.01. In that case I need to check if the .Net Framework is installed.<br />
3) In one case I need to launch an EXE, otherwise I need to launch another one.<br />
<br />
Is there someone who has done already something like this and would like to share with me?<br />
<br />
<br />
Best Regards<br />
Roberto DALMONTE</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th December 2002, 10:56</div></div><div class="posttext">Welcome to the NSIS world Roberto :D<br />
<br />
1) Use SilentInstall (http://nsis.sourceforge.net/Docs/Chapter3.html#3.6.1.34<br />
)<br />
2) Use GetIEVersion (http://nsis.sourceforge.net/Docs/AppendixB.html#B.6) to detect IE. Microsoft use this to detect .NET:<br />
The Setup.exe Bootstrapper sample demonstrates the code to use to wrap a setup program to verify if the .NET Framework is installed. The code checks for a specified version number of the .NET Framework in the following registry key. <br />
<br />
HKLM\SOFTWARE\Microsoft\.NETFramework\policy\v1.0 <br />
<br />
The version number to check for is obtained from Dotnetfx.exe. The code performs a comparison between the build number in the registry key and the build number of the .NET Framework being hosted by the application. If there is not a matching build number in the registry key in this location, Setup.exe installs the version of the .NET Framework being hosted by the application. <br />
<br />
Note that if you want Setup.exe to check for a build number and language version of the .NET Framework, you must specify the culture name of the language to check for in the settings.ini file. If you do not specify a culture name, Setup.exe checks for the English language version by default. See the Creating the Settings.ini File topic for instructions on specifying a culture name.<br />
<br />
Taken from http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnnetdep/html/dotnetfxref.asp.<br />
3) Use StrCmp (http://nsis.sourceforge.net/Docs/Chapter3.html#3.7.4.17) and Exec (http://nsis.sourceforge.net/Docs/Chapter3.html#3.7.1.3), ExecShell (http://nsis.sourceforge.net/Docs/Chapter3.html#3.7.1.4), ExecWait (http://nsis.sourceforge.net/Docs/Chapter3.html#3.7.1.5) or nsExec (a plugin).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">robdal</div><div class="date">27th December 2002, 13:51</div></div><div class="posttext">Thank you for your help.<br />
By the way, where do I find the &quot;Setup.exe Bootstrapper sample&quot; you mention?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">27th December 2002, 14:19</div></div><div class="posttext">That Microsoft link I have taken the quote from.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">robdal</div><div class="date">29th December 2002, 10:14</div></div><div class="posttext">We managed to write our first nsis script, and it works very nicely.<br />
<br />
Nonetheless, we had to change a bit the GetIEVersion. The problem is that the .Net Framework accepts as a good one the IE5 version that comes with Win2000 sp2(IE 5.01), but requires a greater version of IE if you happen to have Win98 second edition (IE 5.00). So we found a key in the registry in order to check if you need to update IE or not.<br />
<br />
ReadRegStr $R0 HKLM &quot;Software\Microsoft\Internet Explorer\Version Vector&quot; &quot;IE&quot;   <br />
Strcpy $R0 $R0 4; we need to check for 5.01 or 5.00 so 4 chars<br />
<br />
<br />
NSIS is excellent.<br />
Our best compliments.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">29th December 2002, 17:21</div></div><div class="posttext">NSIS is excellent.<br />
<br />
I am glad you like it :D<br />
<br />
Would please mind attaching your .NET framework checking function so others can use it too?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">robdal</div><div class="date">30th December 2002, 07:56</div></div><div class="posttext">I'll explain the purpose of this script:<br />
1) We have our own installer (written in C#: SharpInstaller.exe) that is able to perform some checks tailored to our software.<br />
2) We need to be sure that our customers have the required Net Framework installed.<br />
3) A pre-requisite of the .Net Framework is IE 5.01.<br />
<br />
The script checks for the IE version:<br />
1) if we get 6 we jump to the label IEOK.<br />
2) if we get 4, 3, 2 or 1 we jump to the label IEKO, if we get 5 we jump to the lbl_IE5.<br />
3) In lbl_IE5 we check to see if we got 5.00 (the only case in which a version 5 is not enough) then we jump to lbl_IEKO.<br />
4) the lbl_IEKO should launch the installation of IE 6. In our case we launch a program that will take care of that and would give an explanation of what's going on to the user.<br />
<br />
If the user has a good enough version of IE, then we check for the .Net Framework. In our case we check for a very specific subkey, which is the version we distribute (Italian version of .Net Framework). The logic followed is the same for IE: we launch a program that explains something to the user (during the installation of .Net Framework it appears as if the PC is not working and it can last up to 10 minutes in older PC's)<br />
I realize that our script is not well written and a bit chaotic, but i guess that a more expert NSIS user might make it more readable.<br />
<br />
<br />
[attached below]<br />
<br />
<br />
best regards<br />
Roberto DALMONTE</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th December 2002, 14:33</div></div><div class="posttext">Thanks.<br />
<br />
Please attach large scripts next time.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>