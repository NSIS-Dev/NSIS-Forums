<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" MessageBox with more buttons, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  MessageBox with more buttons NSIS Discussion" />
	
	<title> MessageBox with more buttons [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  MessageBox with more buttons</div>
<hr />
<div class="pda"><a href="t-148932.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=148932">MessageBox with more buttons</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">12th September 2003, 10:37</div></div><div class="posttext">I am looking for a way to make a MessageBox with the buttons &quot;yes&quot;, &quot;yes to all&quot;, &quot;no&quot; and &quot;no to all&quot;.<br />
<br />
I searched, and checked documentation but still don't know how to do it.<br />
<br />
anyone? ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">12th September 2003, 11:02</div></div><div class="posttext">As always, it's a built-in Windows API function, you need a plug-in to change it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">13th September 2003, 00:05</div></div><div class="posttext">A brand new plugin, or a trick with the system plugin?<br />
<br />
I think you meant a brand new plugin but since I saw many nice tricks with that system plugin, maybe I can find a workaround :rolleyes:<br />
<br />
If I can't find a workaround, users will have to click 'yes' to all ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">13th September 2003, 00:23</div></div><div class="posttext">With system plugin? I don't know... too much API calls since we're subclassing</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">13th September 2003, 01:31</div></div><div class="posttext">mmm.... I was playing with messagboxes and saw that I can't use two sets of buttons at once, so the max buttons is three (abor, retry, ignore or yes, no, cancel), but there's a MB_DEFBUTTON4 for making default the 4th button. I am missing something?<br />
<br />
Lobo, are you saying that using system plugin for this would be difficult but possible?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">14th September 2003, 03:50</div></div><div class="posttext">actually...in VB you are using the same MsgBox but you edit<br />
the strings, you know: &quot;OK&quot;, &quot;CANCEL&quot; with stuff you like.<br />
Is subclassing. I think Nsis have one, maybe the developers can put some test code so we can convert it to system plugin syntax.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">14th September 2003, 11:07</div></div><div class="posttext">I don't think this is possible using the System plug-in. You have to write a new one.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">14th September 2003, 22:28</div></div><div class="posttext">System allows to do everething needed to create custom dialog, but NSIS somehow brokes all the dialogs created at the scripting thread. And the system couldn't create a new thread for it... :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">15th September 2003, 11:31</div></div><div class="posttext">http://www2.skwire.net/~n0On3/Smileys/sad.gif<br />
<br />
 http://www2.skwire.net/~n0On3/Smileys/shock.gif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">18th September 2003, 16:18</div></div><div class="posttext">Try this (isn't complete yet but it shows the basics i hope ;) )<br />
<br />
It allows you to set the title and caption as a normal messagebox but you can define the number of buttons to include and also the text for the 4 buttons on the messagebox (the 4th is the 'help' button).<br />
<br />
Has a few problems still in handling the number of buttons and some of the standard styles of a messagebox but it works eg MB_HELP.<br />
<br />
note: if a button text isn't associated for a button then in most cases the button text will be cleared - haven't put checking of that in yet :blah: .<br />
<br />
Example is basic but should give you an idea of things so far (more complete info will come soon). I will alter the way of setting the button text so that you just pass in what you want to change<br />
eg <br />
with a yes|no|cancel then you can pass only the text needed for the 'no' to change it to yes|blah|cancel.<br />
<br />
Feedback welcome<br />
<br />
Daz<br />
<br />
ps when using the 'help' button nothing happens at the moment - thinking of playing with it to act as a full button eventually if things work out</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joel</div><div class="date">18th September 2003, 20:09</div></div><div class="posttext">Nice ;) Thanks dude...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">brainsucker</div><div class="date">18th September 2003, 22:17</div></div><div class="posttext">huh :) Windows Hooks ;) Nice idea!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">19th September 2003, 13:44</div></div><div class="posttext">Originally posted by brainsucker <br />
huh :) Windows Hooks ;) Nice idea!  <br />
<br />
that's what i thought to :D<br />
<br />
found it when i was playing with hooks to get all visible windows to dock to the edge of the desktop and found that i could catch a messagebox being created, so i can get its hwnd :) <br />
<br />
will upload the new version when i get on the other work machine in a bit. changed a few bits so that now the 'help' button will react as a proper button (apart from a few cases still :( ) and fixed some bugs and stuff.<br />
<br />
what's the normal buffer limit for the included messagebox?<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">19th September 2003, 15:18</div></div><div class="posttext">latest version attached<br />
<br />
now you can set only the button text you want to otherwise the existing text will be kept. also it doesn't matter which way round you pass in the button order :cool: <br />
<br />
done a number of internal changes so that now there is a functional 'forth' button on the dialog so it is possible to do &quot;yes&quot;, &quot;yes to all&quot;, &quot;no&quot; and &quot;no to all&quot; and have the option working.<br />
<br />
setting the number of buttons to -1 allows the normal button states to be set and the text can still be set for the buttons.<br />
<br />
still are a few issues ie using MB_HELP to get the forth button will not always close for a few mode combinations when using '-1'.<br />
<br />
enjoy<br />
daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">19th September 2003, 23:51</div></div><div class="posttext">wow!!!<br />
<br />
I missed all this replies!!!<br />
<br />
How could I!!!???<br />
<br />
Thanks DrO, gonna test this :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">21st September 2003, 12:39</div></div><div class="posttext">Originally posted by n0On3 <br />
wow!!!<br />
<br />
I missed all this replies!!!<br />
<br />
How could I!!!???<br />
<br />
Thanks DrO, gonna test this :)  <br />
<br />
don't worry about it ;) <br />
<br />
done a few more bits on it so that the 'help' button will always work as a full button whatever style is passed in and some more bug fixes/changes<br />
<br />
also trying to get custom icon setting working for the messagebox as well - thought it might be useful :D <br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">21st September 2003, 21:31</div></div><div class="posttext">And where's the update?<br />
<br />
I looked in the Archive and couldn't find it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">22nd September 2003, 13:41</div></div><div class="posttext">I looked in the Archive and couldn't find it. <br />
<br />
latest version is now attached (with readme explaining how to use it that makes sense i hope :D )<br />
<br />
only real feature missing now is the ability to set the icon shown by the messagebox to be a user defined icon (ran out of time last night).<br />
<br />
wahtever mode you use now, the button texts will always be altered correctly and the 'help' button will always close the messagebox whatever the style used (wasa glaring issue in the last release)<br />
<br />
has anyone tried it with a language other than english yet? i'm interested to see how it works with other languages.<br />
<br />
also would the ability to alter the button sizes on the messagebox so that the text passed in will fit correctly be a good to implement?<br />
(noted that NT has small buttons so the example may not appear correctly :( )<br />
<br />
enjoy<br />
<br />
-daz<br />
<br />
ps will put a copy into the archive soon once i've got the user icon part working</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">23rd September 2003, 04:45</div></div><div class="posttext">thanks for posting :)<br />
<br />
I haven't used any other languages than english.<br />
<br />
and yes, auto-resize buttons seems nice<br />
<br />
<br />
thanks for working in this plugin :up:<br />
<br />
<br />
Note: thanks for writing my name in the text files, can you write 'n0On3' instead of 'n0on3'? ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">23rd September 2003, 15:21</div></div><div class="posttext">At last user icon support works!!<br />
<br />
Attached is now the latest version including a few typo fixes for the readme file.<br />
<br />
@n0On3 - sorry for getting it wrong, it was 2:30am when i was writing that file ;)<br />
<br />
note: if using the user icon option and the icon does not exist then a blank space will be seen where the icon goes - likely to happen with the second test messagebox in the example script (at least on NT, i found 2k was fine).<br />
<br />
I will setup a archive page for this in a bit and when i get the chance to tonight i will work on the resizing of the text buttons so that the text will always fit :cool: (may take a while with other things on at the moment)<br />
<br />
enjoy this people<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">24th September 2003, 15:52</div></div><div class="posttext">auto-resize buttons seems nice <br />
well it's implemented now so when you set the button text if you want it then the button will be resized to the text (and a bit more either side for a nicer look ;))<br />
eg <br />
&quot;/but1 /trim install me now&quot;<br />
<br />
still a few little issues such as getting the sizing to work correctly when the text is just too big for the button.<br />
<br />
also the messagebox will max out at 80% of the screen size (not fully supported yet and may add a little extra when this limit is reached...)<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">24th September 2003, 18:35</div></div><div class="posttext">thanks :)<br />
<br />
I wanted to say that I find the command a bit confusing:<br />
<br />
I can pass which styles I want to use(like MB_OKCANCEL) but if I want to use them I have to pass &quot;-1&quot;, but if i also pass &quot;/but3 c&quot; then the style is overwritten.<br />
<br />
I also don't understand the hwnd. I thought these messageboxes will always be created from the installer, or is this plugin doing something more?<br />
<br />
I tried to think a simpler format. Describing the window from up to down:<br />
<br />
MessageBox::Show &quot;window title&quot; &quot;icon.dll,3&quot; &quot;window text&quot; 4 &quot;IDYES&quot; &quot;yes to all&quot; &quot;IDNO&quot; &quot;no to all&quot;<br />
<br />
I used IDYES for telling that I want a 'yes' style in the first button and IDNO for having a no in the third. And I think that making it always return the number of the button instead of No = 9 is easier to understand.<br />
<br />
I also think that if somebody uses a long text for a button, he will always want it resized, so the /trim switch can be avoided.<br />
<br />
just some suggestions ;)<br />
<br />
<br />
PS: maybe with this format you can pass things that can't be done, like this: MessageBox::Show &quot;window title&quot; &quot;&quot; &quot;window text&quot; 2 &quot;IDNO&quot; &quot;IDYES&quot; and you can't have a first button with a 'no' and the second be a 'yes'. If this is the case you can make the script refuse to compile and say that it has to be 'yes' and 'no' instead.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">25th September 2003, 13:51</div></div><div class="posttext">suggestions are good ;) <br />
<br />
thought it was getting a bit confusing too for the parameters (was going to overhaul how they are passed anyway for v1.0).<br />
<br />
I thought these messageboxes will always be created from the installer, or is this plugin doing something more?when you pass a 0 for the parameter then it will use the installer as the owner. the reason it is in there is basically from the initial development phase of the plugin (since i ported the basics of what i had from another program) and was going to drop it anyway<br />
<br />
I also think that if somebody uses a long text for a button, he will always want it resized, so the /trim switch can be avoided. was going to drop it too - since that part isn't finished yet i was using the /trim to allow me to test the feature for specific button positions (without hard coding tests into the code) to make sure that the messagebox would resize and move subsequent buttons correctly.<br />
MessageBox::Show &quot;window title&quot; &quot;icon.dll,3&quot; &quot;window text&quot; 4 &quot;IDYES&quot; &quot;yes to all&quot; &quot;IDNO&quot; &quot;no to all&quot;nice :)<br />
i like that idea and it's not to difficult to change the existing code to do it as well. also the &quot;icon.dll,3&quot; is better for the whole icon thing since &quot;0,3&quot; could be used to get the resource from the installer.<br />
<br />
about the '-1' thing, the idea was that with it the function will return what the messagebox returns but with the ability if needed to alter the button text if wanted (late night programming that :)). so if the forth is 'no' then it will return 9 since that is the button's id.<br />
<br />
can understand the confusion about it so i will map the return to 1,2,etc in all cases now (does make it more consistant) and will drop the -1 option.<br />
<br />
&quot;IDYES&quot; &quot;yes to all&quot; &quot;IDNO&quot; &quot;no to all&quot; part - i like that idea and it isn't hard to put it in as things are since i can just set internally set the button text to 'yes' when a 'IDYES' is passed for example.<br />
<br />
i can see what you're getting at about the IDNO can't be first but i think that if the return value is going to be mapped to the button number then it should not matter which way round the buttons are - just my thought on it.<br />
<br />
hope that clarifies a few bits.<br />
thanks for the suggestions n0On3 :), always good to have a different view point on things. will get on with this tonight and get a test version uploaded tomorrow.<br />
<br />
-daz<br />
<br />
ps just had a thought, if doing &quot;IDYES&quot; &quot;yes to all&quot; &quot;IDNO&quot; &quot;no to all&quot; then it's possible to drop the number of buttons specification. instead it can be worked out from the number of button texts passed in</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">25th September 2003, 16:16</div></div><div class="posttext">Great! <br />
<br />
I am very glad you liked my ideas :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">26th September 2003, 13:31</div></div><div class="posttext">changed the calling syntax of the function to be simpler and hopefully make more sense ;) <br />
<br />
now the number of buttons to show is all based on the number of button strings passed with default button texts used when you pass the defines<br />
e.g. IDYES =&gt; 'Yes'  IDCANCEL =&gt; 'Cancel' (see the readme for the supported options)<br />
<br />
buttons are resized in all cases (more logical) and the resizing is more gradual especially when the text is near to the existing button width.<br />
<br />
the handling of long button texts when the messagebox width is exceeded (that's the 80% of the screen limit) is not done yet.<br />
also the MB_DEFBUTTON? style will not work for resized buttons (defaults to the first button but i have the fix worked out for it).<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">29th September 2003, 03:41</div></div><div class="posttext">yes, this plugin works great :)<br />
<br />
I found that I can't use the installer icon when the installer is set to silent:<br />
<br />
SilentInstall &quot;Silent&quot;<br />
<br />
<br />
great plugin, thanks :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">29th September 2003, 11:41</div></div><div class="posttext">I found that I can't use the installer icon when the installer is set to silentwill have a look at that tonight, thanks for pointing it out (and will have a go at the few other bits left to do).<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">29th September 2003, 11:49</div></div><div class="posttext">Can you create an archive page when it's finished?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">29th September 2003, 12:52</div></div><div class="posttext">Can you create an archive page when it's finished?Will do that once i've got the last few bits fixed (and got the code readable ;) )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">30th September 2003, 11:42</div></div><div class="posttext">I found that I can't use the installer icon when the installer is set to silenthad a check of the code and the icon part works fine in a silent installer.<br />
<br />
i did notice that in the example with v0.98 beta, the last messagebox did not have the icon set, instead it has a &quot;&quot; where the icon part goes.<br />
<br />
working on the button widths at the moment for the 80% limit being reached. also fixed the default button issue - just needed to prevent a message being sent to the messagebox :igor: <br />
<br />
should have the new version with the button adjustment fully done by tomorrow i hope<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">3rd October 2003, 11:50</div></div><div class="posttext">Originally posted by DrO <br />
[B]had a check of the code and the icon part works fine in a silent installer.<br />
 <br />
<br />
You mean that you could use the icon when silent installer in the messagebox? I used your example and now, not only it's not showed but even crashes :(<br />
<br />
I attach the thingy.<br />
<br />
<br />
<br />
also, what's this &quot;MB_ICONHAND&quot; style? the nsis I use doesn't have it... :weird:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">3rd October 2003, 12:39</div></div><div class="posttext">what OS are you using?<br />
(checked the example and it is fine on NT4 and 2k)<br />
<br />
also is it the last messagebox that is failing?<br />
<br />
	messagebox::show MB_TOPMOST|MB_DEFBUTTON2|MB_RIGHT &quot;look at me a title&quot; \<br />
	&quot;&quot; \<br />
	&quot;and for a messagebox that will show an icon... :o)$\n&quot; &quot;ah go on if you dare&quot; IDYES IDYES2<br />
<br />
with the second line, to get the installer icon it should be &quot;0,103&quot; instead of &quot;&quot; - typo on my part (was trying to get that test version done beofre i left for work)<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">3rd October 2003, 16:43</div></div><div class="posttext">@n0On3 - if you can, can you let me know what the crash error is please (picture?)<br />
<br />
I'll have a look at the code tonight (haven't touched it for a few days) and i'll make sure that any potential parts that could cause a crash are catered for. Will try and get a newer version up for tomorrow which should hopefully fix things for you.<br />
<br />
Adding in parameter checks so that you can't do IDYES &quot;blah&quot; IDYES since it's not good having two 'Yes' buttons :)<br />
<br />
also, what's this &quot;MB_ICONHAND&quot; style? the nsis I use doesn't have it... magic that is ;) it is just the stop sign icon but using a different name (throw back to Windows 3.x before 95 came along and they altered the defined names that's all, check here (http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/dialogboxes/dialogboxreference/dialogboxfunctions/messagebox.asp))<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">3rd October 2003, 20:10</div></div><div class="posttext">added a page into the archive (http://nsis.sourceforge.net/archive/viewpage.php?pageid=370) for the Customisable MessageBox plugin (thought a proper name would be good for it instead of 'MessageBox with more buttons'  ;))<br />
<br />
-daz<br />
<br />
[p.s. is it fine to just link to here for the downloads since i haven't anywhere to host files :( ]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">4th October 2003, 08:03</div></div><div class="posttext">Originally posted by DrO <br />
[B]what OS are you using?<br />
(checked the example and it is fine on NT4 and 2k)<br />
<br />
also is it the last messagebox that is failing? <br />
sorry, I left that info. I use win98se. Does the compiled exe work in your 2k?<br />
<br />
and is the first messagebox that fails. Strange because it works in another silent installer I made. But in that other it always shows 4 buttons. This is the code:MessageBox::Show MB_ICONQUESTION &quot;Can't Move, Copy instead?&quot; &quot;&quot; \<br />
`We can't move through different drives.$\nBut we can copy and \<br />
delete if no errors` &quot;Copy &amp;&amp; Delete&quot; &quot;Copy&quot; &quot;IDCANCEL&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">4th October 2003, 13:05</div></div><div class="posttext">Originally posted by DrO <br />
[p.s. is it fine to just link to here for the downloads since i haven't anywhere to host files :( ] <br />
<br />
It can be put on the Archive too. Just e-mail the file to an Archive admin and we'll upload it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">4th October 2003, 14:57</div></div><div class="posttext">give this version a try - have altered the handling of one or two strings internally so hopefully it won't crash (had not fully checked the module handle for a &quot;&quot; situation).<br />
<br />
also included two compiled versions (normal and silent) which work on my machine at least ;)<br />
<br />
note: long button text handling is still fudged (got to get full limit checking working still)<br />
<br />
note 2: just looking at the function call, the &quot;IDCANCEL&quot; should be just IDCANCEL (no &quot;'s around it) if you want the button text to be 'cancel' ;)<br />
<br />
@n0On3: will test that later. i tested your file on NT4 and it worked (will check later on my machine under both oses)<br />
<br />
@kichik: will pm it once it's working fully :)<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">4th October 2003, 16:32</div></div><div class="posttext">ok, I won't use &quot;IDCANCEL&quot; ;)<br />
<br />
<br />
please, can some moderator edit my post and make it not soooooooo wide?<br />
<br />
<br />
and... doesn't anybody know when this forum decides to create a second page???</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">5th October 2003, 12:51</div></div><div class="posttext">Originally posted by n0On3 <br />
ok, I won't use &quot;IDCANCEL&quot; ;) ignore what i said about that, was half asleep at work and not remembering that the &quot;&quot; are stripped before being passed to the plugin :confused:<br />
(also it looks neater without the &quot;&quot;s for the predefined texts i think)<br />
<br />
tested your file under 98 and 2k - crashed under 98 :cry:<br />
<br />
found the problem (was only related to silent installers!) so new none crashing version is attached ;)<br />
<br />
-daz<br />
<br />
ps issue is that with the silent installer it does not have a window title and so my code for that was incorrectly handling a &quot;&quot; for the caption (so it was the second messagebox crashing ;)) - i just can't code at times :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th October 2003, 13:30</div></div><div class="posttext">I currently know nothing about win32 programming; you obviously must know quite a bit!<br />
<br />
Good work!!<br />
<br />
-Stu :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">5th October 2003, 14:01</div></div><div class="posttext">Originally posted by Afrow UK <br />
you obviously must know quite a bit! enough to get by with ;)<br />
<br />
is mainly from playing around with things (all self taught though i wonder why at times :weird: ) that i've learnt win32 and even then i still have to research things / spend hours working out why it won't work but that's the same with anything really<br />
<br />
-daz<br />
<br />
<br />
p.s. starts a second page here ;) @ n0On3</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">5th October 2003, 14:18</div></div><div class="posttext">That's the way I get taught.<br />
I know a few basic languages inside out by making the same program for my game in the different languages.<br />
My programs basically read through a Quake2 log file getting the number of kills the entered name has done, how many deaths etc for specific weapons.<br />
<br />
So far I've done it in Basic, QuickBasic, Perl and C<br />
I'm looking forward to getting MS Visual Studio but that will come once I have finised school.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">5th October 2003, 14:59</div></div><div class="posttext">i remember basic ;) first language i learnt back on my old atari ste (one for the history books and i've still got it).<br />
<br />
only do c now since it's straight forward, have dabbled a bit in c++ but not enough to be able to do it all the time.<br />
<br />
learnt the basics of c at uni and then win32 for my final project (a little editor and development thing for some DOS tools from the first year).<br />
<br />
still developing the thing so that i can have a MDI text editor with customisable syntax highlighting of my source files. also worked on a thing to allow most windows and dialogs to 'dock' to the screen edge or the inside of MDI window eg Excel and that as linux does - makes positioning of windows easier to do but still have a few bugs with the code when it's closed down :( (but with recent stuff i've done here (http://forums.winamp.com/showthread.php?s=&amp;threadid=149292) i think i may have the solution to the problems)<br />
<br />
File reading is the fun stuff to do ;) windows hooks and subclassing are a real pain in comparison at times<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">12th October 2003, 19:36</div></div><div class="posttext">hi, I used v0.98 beta 3 and still have the extra fourth button. I don't know how it got there :hang: <br />
<br />
MessageBox::Show MB_TOPMOST|MB_ICONQUESTION &quot;Can't Move, Copy instead?&quot; &quot;&quot; \\<br />
`We can't move through different drives.$\nBut we can copy and delete if no errors` \\<br />
&quot;Copy &amp;&amp; Delete&quot; &quot;Copy&quot; IDCANCEL</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">13th October 2003, 18:01</div></div><div class="posttext">can you post a screen shot of what's appearing for you. also what OS are you using?<br />
<br />
i will have a look at the code again in a bit but i can't think what could be going wrong :weird: <br />
<br />
also did this version definitely fix the crash issue you were having in the earlier versions?<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">14th October 2003, 15:46</div></div><div class="posttext">yes, it seems that the silent crash is gone :)<br />
<br />
I attach a snap. Using Win98se</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">14th October 2003, 16:09</div></div><div class="posttext">thanks for the picture and it's what i expected to see.<br />
<br />
i managed to reproduce the problem and it's down to there being other values on the stack. the function will read in until it gets to the 4 button limit or there is nothing else on the stack hence what you get.<br />
<br />
best option i can think of would be to add a control character on for the last button to ensure that the correct number of buttons are added<br />
e.g. IDYES &quot;blah&quot; \eIDCANCEL<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">n0On3</div><div class="date">14th October 2003, 22:48</div></div><div class="posttext">ah, so the problem is the stack...<br />
<br />
do all plugins read parameters from stack?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">15th October 2003, 11:39</div></div><div class="posttext">yep, that's how they are passed for the plugin to get them.  the issue with this plugin is that it takes variable parameters unlike most other plugins which accept a fixed number of parameters - hence the problem with reading what is available.<br />
<br />
so the options are:<br />
* a control flag on the last button<br />
* assuming that if the stack parameter converts to a number to stop<br />
* to control the number it expects (as in older versions)<br />
* ensure the stack is clear before using the function<br />
<br />
personally i think the first option is the easiest to use. didn't have enough time to make the above alteration last night, will be up by tomorrow.<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th October 2003, 23:00</div></div><div class="posttext">You can do what the author of UnTGZ has done. He forced an extra stack push of &quot;--&quot; for inputs of variant sizes. It's the most elegant and simple way in my opinion. Forcing a flag on the last button might cause the user to delete it when editing or move it around when moving the buttons.<br />
<br />
BTW, nsisdt uses the $0 variable :p</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">16th October 2003, 07:12</div></div><div class="posttext">yeah the flag option has it's issues ;)<br />
i'll have a look at what you've mentioned, thanks.<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scully13</div><div class="date">17th May 2004, 19:06</div></div><div class="posttext">Can somebody help me out on this one. Here is the code I'm using:<br />
messagebox::show &quot;MB_ICONQUESTION&quot; &quot;&quot; &quot;&quot; &quot;$(TEXT_INSTCLIENT_MSG)&quot; &quot;$(TEXT_YES_MSG)&quot; &quot;$(TEXT_NO_MSG)&quot;<br />
I keep getting a third button like what is described above. I've tried the possible fixes except I can't figure out how to clear the stack to make the third button go away. I tried the control flag &quot;\e$(TEXT_NO_MSG)&quot; but then it just shows up in the buttons text. It also looks like the last option is one he was talking about putting back in but never did. Is there a newer version of this available or can somebody show me a workaround?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">1st February 2005, 22:17</div></div><div class="posttext">and I'm upping this topic because I think you should explain in your txt what is the id of an icon group<br />
<br />
<br />
I have this code :<br />
<br />
	messagebox::show MB_ICONEXCLAMATION|MB_ICONHAND|MB_TOPMOST &quot;$(question_hercules)&quot; \<br />
	&quot;another_software.exe,103&quot; \<br />
	&quot;$(messagebox_hercules)&quot; $(yes) $(no)<br />
<br />
and I didn't find the good value for &quot;103&quot;<br />
<br />
resource hacker gave me the good values...<br />
<br />
say it in your help file ;)<br />
<br />
<br />
see ya and thx for your great plugin dro ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">8th February 2005, 19:08</div></div><div class="posttext">hello<br />
<br />
I have this messagebox :<br />
<br />
<br />
	messagebox::show MB_YESNO|MB_ICONEXCLAMATION|MB_TOPMOST &quot;$(question_hercules)&quot; \<br />
	&quot;0,103&quot; \<br />
	&quot;$(messagebox_hercules)$\n&quot; &quot;$(yes)&quot;<br />
<br />
	Pop $0<br />
	StrCmp $0 &quot;1&quot; yes<br />
	StrCmp $0 &quot;2&quot; no<br />
<br />
<br />
<br />
But I have no sound when it appears<br />
I'd like that a window &quot;question&quot; sound comes...<br />
<br />
How can I do ?<br />
<br />
<br />
thx for your answers :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">8th February 2005, 21:14</div></div><div class="posttext">point 1: yeah, i agree on that. i also really need to just better document the plugin (as well as finding the source code for it on my old machine otherwise it's re-write time which in some ways could be a good thing i think :) and since there's a decent changelog in the zip i can re-work things if needed that way)<br />
<br />
point 2: not sure to be honest, only thing i can think of is that you don't have a sound assigned to that system action (you'd need to check in the sound properties dialog)<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">8th February 2005, 21:34</div></div><div class="posttext">are saying that this code is giving you a sound ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">8th February 2005, 21:53</div></div><div class="posttext">i've just looked through some info on msdn and the MessageBeep(..) (http://msdn.microsoft.com/library/default.asp?url=/library/en-us/debug/base/messagebeep.asp) needs to be called. as a work around you can use the system plugin to manually do this.<br />
<br />
i think i will just do a complete re-code of the plugin and i'm noting down to have sound support in there as well (for some of my Winamp plugins i need to alter a standard messagebox so i intend to make a general core which will work for them and as a nsis plugin for this)<br />
<br />
just as i was about to post i did a quick system scan and i've found what looks like the source code for 0.98beta (first one i believe) so i'll do a bit more and see what else i can find since if i can get 0.98b3 that'll make my life easier)<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">superwan</div><div class="date">8th February 2005, 23:41</div></div><div class="posttext">yeah :D<br />
<br />
this is cool<br />
<br />
I'm waiting for it ;)<br />
<br />
&quot;bon courage&quot; like we say in France ;) see ya :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">11th July 2005, 16:15</div></div><div class="posttext">Hey DrO,<br />
This might be a moot point if you are still planning to re-write, but I thought I'd mention it:<br />
<br />
In your latest reslease (v0.98 beta 3), I still get a crash with the silent install.<br />
<br />
To recreate, just run the file messagebox_s.exe included with the package.  The crash occurs on the message box that reads &quot;And for the special options&quot;<br />
<br />
I've attached a screenshot of the message box that generates the error.  i also noticed that the &quot;no&quot; button should be named &quot;m12if you can!&quot;<br />
<br />
Here's the text of the error:<br />
The application, , generated an application error The error occurred on 07/11/2005 @ 07:54:13.718 The exception generated was c00000fd at address 100023B4 (&lt;nosymbols&gt;) <br />
<br />
This is nothing urgent--just letting you know.<br />
Thanks! :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yathosho</div><div class="date">6th August 2005, 00:59</div></div><div class="posttext">btw, nsis (english translation) officially uses &quot;OK&quot; and not &quot;Ok&quot;, like that messagebox plugin (IDOK)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">donovaly</div><div class="date">12th November 2005, 13:48</div></div><div class="posttext">Hello DrO,<br />
<br />
I am using your MessageBox plugin v0.98 beta 3.<br />
<br />
I found two bugs:<br />
<br />
1. when I use you plugin in a section twice without pop $0 between them, I get three buttons in the second messagebox. Here an example script:<br />
<br />
-------------------------<br />
OutFile &quot;MessageBoxTest.exe&quot;<br />
<br />
; Installer sections<br />
Section &quot;-Installation actions&quot; SecInstallation<br />
	<br />
  messagebox::show MB_ICONINFORMATION|MB_DEFBUTTON1 &quot;&quot; &quot;&quot; &quot;test&quot; &quot;Download Now&quot; &quot;Download Later&quot;<br />
  ; Pop $0 ; without this the next messagebox will have three buttons although only two are defined!!!<br />
<br />
  messagebox::show MB_ICONINFORMATION|MB_DEFBUTTON1 &quot;&quot; &quot;&quot; &quot;test2&quot; &quot;Download Now&quot; &quot;Download Later&quot;<br />
  Pop $0<br />
  StrCmp $0 &quot;1&quot; 0 readyTest ; pressed &quot;Download Now&quot;<br />
   ExecShell &quot;open&quot; &quot;http://google.com/&quot;<br />
  readyTest:<br />
<br />
SectionEnd<br />
-----------------------------<br />
<br />
2. When I use your plugin in the .onInit function my installer always crashes. Here an example script:<br />
<br />
-----------------------------<br />
OutFile &quot;MessageBoxTest.exe&quot;<br />
<br />
Section<br />
<br />
SectionEnd<br />
<br />
Function .onInit<br />
  <br />
  messagebox::show MB_ICONINFORMATION|MB_DEFBUTTON1 &quot;&quot; &quot;&quot; &quot;test&quot; &quot;Download Now&quot; &quot;Download Later&quot;<br />
<br />
  messagebox::show MB_ICONHAND|MB_DEFBUTTON2 &quot;&quot; &quot;&quot; &quot;and for the special options...$\n&quot; &quot;IDYES&quot; &quot;m12if you can!&quot;<br />
<br />
  ClearErrors<br />
FunctionEnd<br />
-----------------------------<br />
<br />
Could you help me with this bugs or do I have bugs in my scripts.<br />
Thanks in advance and regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">5th December 2005, 01:39</div></div><div class="posttext">I too am also experiencing this problem :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">5th December 2005, 02:05</div></div><div class="posttext">because the plugin uses a variable parameter list you need to ensure that the stack is in a 'clean' state otherwise it will start pulling more than it should do (as you've come across). there was a post a few up by kichik about using a terminating parameter to indicate the end of the params.<br />
<br />
as for the crash, i've managed to find the source code for 0.98 beta 1. i'm not sure where the beta 3 code is (could be on my old dev machine still...) i'll see if i can at least get the code working again and fix up some of the issues that i'd fixed from b1 to b3 and hopefully the issue you're having as well<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">5th December 2005, 04:32</div></div><div class="posttext">How do I apply what Kichik mentioned a few post up? I am not sure although I tried pushing before and after this plugin and failed to work around it :(<br />
<br />
Also, if you do plan on re-writing the code can you possibly add in support for jumps much like how MessageBox Handles them  now?<br />
<br />
e.g. messagebox::show &quot;&quot; &quot;Title&quot; &quot;&quot; &quot;Body&quot; '&quot;B_A&quot; +12' '&quot;B_B&quot; -12' '&quot;B_D&quot; .DONE'<br />
I find the idea of $Pop and $StrCmp a bit cumbersome... Do you think you can add in support for jumps right pass the buttons somehow (all on the same line)?<br />
<br />
Thank you DrO, I find the plugin very promising. Thank you again!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">5th December 2005, 09:39</div></div><div class="posttext">I found this link (http://forums.winamp.com/showthread.php?postid=935212#post935212) in the forums and tried out what Virtlink said. It seems to work as advertised...<br />
<br />
LoopAgain:<br />
 Pop $R9<br />
 IfErrors Done LoopAgain<br />
Done:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">5th December 2005, 13:11</div></div><div class="posttext">the post by kichik was a suggestion on how the plugin could be fixed to handle the multiple parameters better.<br />
<br />
i've been out of the loop on any real nsis coding for a while so i'm not sure if plugins are able to do what you're asking for with the jumps so i can't say. the other option is to have a quick macro in place to wrap things up for such a case (is something i'd need to look into to see if it's viable or not, etc)<br />
<br />
Do you think you can add in support for jumps right pass the buttons somehownot quite sure what you mean by that<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">5th December 2005, 13:49</div></div><div class="posttext">i've managed to get the 0.98 beta 1 code compiling on my machine here at work and that example script doesn't crash for me but beta 3 does so i broke something with beta 3.<br />
<br />
i've just added in /end needing to be on the end of a call to the plugin's function which fixes all of the pop fun since i can now at least only process what's needed and not anything else (will have to make sure it's working 100% though before i do anything else with it).<br />
<br />
because of the state of the code i'm going to ditch a 1.0 and effectively re-code a fair chunk of it to aim towards a 2.0 since i also want to have the ability to have a checkbox on the bottom of the messagebox for setting as a default action type of thing.<br />
<br />
it's going to take a few days for me to get upto speed with the code again but should have at least a fixed working build by the middle of the week :)<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">5th December 2005, 20:16</div></div><div class="posttext">What I meant was instead of...<br />
<br />
messagebox::show &quot;&quot; &quot;Title&quot; &quot;&quot; &quot;Body&quot; &quot;B_A&quot; &quot;B_B&quot; &quot;B_D&quot;<br />
pop $0 <br />
StrCmp $0 1 +12<br />
StrCmp $0 2 -12<br />
StrCmp $0 3 .DONE<br />
<br />
<br />
Something a bit more like this...<br />
<br />
messagebox::show &quot;&quot; &quot;Title&quot; &quot;&quot; &quot;Body&quot; `&quot;B_A&quot; +12` `&quot;B_B&quot; -12` `&quot;B_D&quot; .DONE`<br />
<br />
Just keeping it on one line like the traditional MessageBox instead of Popping and StrCmping just to Goto. Just an idea if you're really going to rewrite the code... Thanks Dr0!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vbgunz</div><div class="date">6th December 2005, 12:44</div></div><div class="posttext">I have a problem I am not too sure how to get passed. It involves nesting a variable within a temporary !define inside a !macro. Basically, I am trying to create a macro in which I would be able to use relative jumps a bit easier to get around...<br />
!macro messagebox TITLE BODY B1 X1 B2 X2 B3 X3 B4 X4<br />
  Pop $R9 # Clear the Stack...<br />
  IfErrors 0 -1<br />
  messagebox::show &quot;&quot; &quot;${TITLE}&quot; &quot;&quot; &quot;${BODY}&quot; &quot;${B1}&quot; &quot;${B2}&quot; &quot;${B3}&quot; &quot;${B4}&quot;<br />
   Pop $1<br />
    IntOp $2 $2 + 1<br />
  StrCmp $1 $2 ${X$2} -1<br />
!macroendIn theory, the above will jump forward perfectly whereas jumping back would require I add on +5. This way though insures the jumps are predictable as where the following leads to a lot of math for relative jumps...<br />
!macro messagebox TITLE BODY B1 X1 B2 X2 B3 X3 B4 X4<br />
  Pop $R9 # Clear the Stack...<br />
  IfErrors 0 -1<br />
  messagebox::show &quot;&quot; &quot;${TITLE}&quot; &quot;&quot; &quot;${BODY}&quot; &quot;${B1}&quot; &quot;${B2}&quot; &quot;${B3}&quot; &quot;${B4}&quot;<br />
   Pop $1<br />
    StrCmp $1 1 ${X1}<br />
    StrCmp $1 2 ${X2}<br />
    StrCmp $1 3 ${X3}<br />
    StrCmp $1 4 ${X4}<br />
!macroendGlobal jumps are no problem *but* I am really trying to get this to be relatively friendly. My problem in example 1 (line 6) is, I do not know how to nest the variable inside the define... I tried doubling the $, quotes, backslashes and am completely lost as to how to do it... Can anybody shed some light or some better code?<br />
<br />
I might have mistakes in the code but am unable to test it out fully :(<br />
<br />
Any help is greatly appreciated on this! Thank you!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">10th January 2006, 22:01</div></div><div class="posttext">how do you include a custom icon, where do you put that icon (dll file) for it to recognised</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">11th January 2006, 22:15</div></div><div class="posttext">Anyone? <br />
Dro<br />
<br />
Please</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">12th January 2006, 13:56</div></div><div class="posttext">sorry for the delay in reply, real world kept me from a proper browse of the forums yesterday.<br />
<br />
the icon needs to be in a resource dll if i remember correctly (the example script uses shell32.dll from memory). i'll try and double-check the code over tonight (if need be i can look at modifying to make a custom build which allows you to specify just a .ico to be used (should be a relatively easy change from what i rememeber of the icon api in windows)<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">12th January 2006, 20:40</div></div><div class="posttext">Thanks DrO for the reply,<br />
No need to change it to a ico, (but if you want that would be great), I can easily make icon dll file, I just need to no where to place or extract the dll file too, so it works, I tried placing it in the system32 folder, but it didn't work I just got a blank space where a icon should have been.<br />
<br />
That's just messing around with your default script, I'm not really bother about adding more button, it would just be nice if I could place a custom icon in it.<br />
<br />
Plus I'm not really sure what to put in the script, whether you can specify a named custom icon as in &quot;fred.dll,0&quot; or does could you specify it as &quot;$INSTDIR\fred.dll,0&quot;<br />
<br />
Thanks<br />
<br />
Tony</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">12th January 2006, 20:42</div></div><div class="posttext">you'd need to specify a full path, the reason the shell32 one works is because it's already on the system's default search path<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">12th January 2006, 20:48</div></div><div class="posttext">ah ok I'll try it thanks mate :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">12th January 2006, 21:30</div></div><div class="posttext">Nah I can't get it to work, I've placed a dll file in the system32 folder, the dll file has 2 icons in it so the full path and icon number (for icon 2) would be &quot;$SYSDIR\fred.dll,2&quot; right?<br />
<br />
It didn't work<br />
<br />
It frustrating :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">12th January 2006, 21:41</div></div><div class="posttext">with that dll, open it up in resource hacker (http://www.angusj.com/resourcehacker/) for example and look for a [icon group] value in the tree. check which icon group the icon you want to use is in and then use the id of that group. that works ok for me from what i can tell<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">12th January 2006, 21:50</div></div><div class="posttext">Ah this is why it probably won't work tried opening it with res hacker as you suggested, but Res Hack says its not a win32 executable file I made the dll file with Axialis IconWorkshop<br />
<br />
Bugger :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">12th January 2006, 23:30</div></div><div class="posttext">use the attached dll for adding your icons into. it's a valid dll i built in msvc and i tested by manually adding an icon in with resource hacker and it worked for me<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TonyDS</div><div class="date">13th January 2006, 01:30</div></div><div class="posttext">thank but that didnt work but it gave me an idea, I found a existing dll file it was a file called acctres.dll deleted all the crap out of it leaving two icon and replaced those with my icons<br />
<br />
And it works <br />
<br />
so thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">13th January 2006, 01:32</div></div><div class="posttext">strange, not sure why it wouldn't have worked assuming the icon was fully added and then saved to the dll. as long as it works now then that's the main thing :)<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">19th June 2006, 18:10</div></div><div class="posttext">I'm using LogicLib and I need a custom messagebox nested within some logic.  However, this causes the stack to be unable to be in a clean state.  I was wondering when their would be a fixed implemented for this?  Reading back on this thread I saw that a /end switch was being tested.<br />
<br />
Thanks!<br />
<br />
EDIT:  Also, with my testing, I've noticed that whenever I quit the installer, it seems to give a memory read violation whenever it tries to unload the messagebox dll.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Yurik</div><div class="date">24th July 2006, 11:58</div></div><div class="posttext">Hi,<br />
Am I right that there is no solution for extra buttons still except for manually clearing stack? This is not elegant solution as the stack could keep some values from outer procedure calls.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lilisbbc</div><div class="date">30th August 2006, 13:51</div></div><div class="posttext">Hi,<br />
<br />
I have just tested the messagebox plugin v.098 beta 3 and I found another small bug inside.<br />
I am using Modern UI, and just after the Welcome page, and before the License page agreement shows, I insert a function to display a simple messagebox with a specific title and only a &quot;OK&quot; button (with the plugin).<br />
When clicking, on &quot;Next&quot; (in the Welcome page), then this pops up the messagebox correctly. Then, when I click back (to return to the welcome page), and then &quot;Next&quot; again, this pops up the same messagebox with my &quot;OK&quot; button but also an additional &quot;1&quot; button !!!<br />
Repeating the process another time, will display the messagebox with &quot;2&quot; if I have clicked on &quot;1&quot;, etc...<br />
<br />
Below is the essential part of the code:<br />
<br />
!insertmacro MUI_PAGE_WELCOME<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW ShowLicenseInfo<br />
!insertmacro MUI_PAGE_LICENSE &quot;myLicense.txt&quot;<br />
.<br />
.<br />
.<br />
Function ShowLicenseInfo<br />
  messagebox::show MB_TOPMOST &quot;my specific title&quot; \<br />
  &quot;&quot; &quot;\<br />
  PLEASE NOTE: this is some additional information&quot; \<br />
  IDOK<br />
FunctionEnd<br />
<br />
Is there something I have done wrong ? Or is it a problem from the plugin ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lilisbbc</div><div class="date">30th August 2006, 14:52</div></div><div class="posttext">Originally posted by lilisbbc <br />
!insertmacro MUI_PAGE_WELCOME<br />
!define MUI_PAGE_CUSTOMFUNCTION_SHOW ShowLicenseInfo<br />
!insertmacro MUI_PAGE_LICENSE &quot;myLicense.txt&quot;<br />
.<br />
.<br />
.<br />
Function ShowLicenseInfo<br />
  messagebox::show MB_TOPMOST &quot;my specific title&quot; \<br />
  &quot;&quot; &quot;\<br />
  PLEASE NOTE: this is some additional information&quot; \<br />
  IDOK<br />
FunctionEnd<br />
<br />
Is there something I have done wrong ? Or is it a problem from the plugin ? [/B] <br />
<br />
Okay, after some investigations, it appears that simply adding Pop $0 at the end of the function solves the problem.<br />
Don't really know why, but well, as long as it works... <br />
Thanks Dr0 for the plugin ! :-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goldy1064</div><div class="date">30th August 2006, 16:35</div></div><div class="posttext">The reason that happens is that this plugin requires that the stack be empty.  The first four elements on the stack will be used as the messagebox buttons.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">icebox13</div><div class="date">25th September 2006, 16:28</div></div><div class="posttext">Does anyone have any idea why a message box with this plugin might not work in certain instances?  As the developer of our installer, I have not experienced any issues with it, nor have others who've tested it, but one tester has.  I'm using the messagebox::show in 3 separate places, and for him, when he clicks on the button in the custom pages to display these message boxes, nothing happens.  I've created this simple script, which duplicates the problem on his machine, but works fine for others and myself.  He can see the &quot;normal&quot; message box, but not the MB via the plugin.  Any thoughts?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">25th September 2006, 17:58</div></div><div class="posttext">One thing in that script is that you've got InitPluginsDir after MUI_INSTALLOPTIONS_EXTRACT and it should be before.<br />
What happens if you put a normal MessageBox before the plugin MessageBox. Does that get displayed?<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">icebox13</div><div class="date">25th September 2006, 19:26</div></div><div class="posttext">I updated the InitPluginsDir, and that didn't seem to make a difference (though I will update that in my real code anyway, thanks for pointing it out).  I also inserted a normal message box to confirm that we're getting to that place in the code, and it appears.  The very next line, the messagebox::show, still doesn't work on his (still does on mine).<br />
<br />
On a side note, we're both using our standard company issue workstations with Windows XP Pro SP2.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">icebox13</div><div class="date">25th September 2006, 19:28</div></div><div class="posttext">Sorry, meant to update attachment with your suggestions:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">icebox13</div><div class="date">26th September 2006, 18:08</div></div><div class="posttext">Any ideas for us to try?  Has anyone else ran into this before?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">26th September 2006, 18:13</div></div><div class="posttext">at the moment no since i don't have the source code on my machine here (i think my attempt at a new version was on the machine at work) so i'll have to track that down tomorrow and see what i can make up to test the thing out). i will add that it appears to work fine for me (though i can't test on an XP install until later). not too sure why it'd fail to display as such if it's working on all other installs (unless the test machine where it fails has something else installed on it which could be breaking the OS hacks)<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">loquis</div><div class="date">2nd October 2006, 16:44</div></div><div class="posttext">Found an odd issue with messagebox. <br />
<br />
If I have message text with a ':' in it, sometimes the text after the ':' isnt shown, sometimes it is.<br />
<br />
Any idea why this might be?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">3rd December 2006, 20:17</div></div><div class="posttext">I've tested the latest version (v.0.98 beta 3) of your plugin.<br />
<br />
messagebox::show MB_DEFBUTTON2|MB_TOPMOST &quot;title&quot; &quot;&quot; &quot;Body&quot; &quot;Button1&quot; IDNO<br />
<br />
If i see this messagebox and press Escape a sound is played and the messagebox disappears.<br />
<br />
messagebox::show MB_DEFBUTTON2|MB_TOPMOST &quot;title&quot; &quot;&quot; &quot;Body&quot; &quot;Button1&quot; &quot;Button2&quot;<br />
<br />
If i press Escape on a messagebox without standard buttons the process uses 99 procent cpu resources and stops responding.<br />
<br />
Any ideas?<br />
<br />
- flizebogen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">3rd December 2006, 20:24</div></div><div class="posttext">i tried looking into that issue but there's a quirk with the overrides i do and the OS. i can't remember if i managed to resolve the issue or not since it was something i was trying to work on during my lunch breaks at work and i don't have that code to hand. from what i remember if there's no proper close button (with the [x] in the top right being greyed out) will cause the lock up<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flizebogen</div><div class="date">24th April 2007, 20:49</div></div><div class="posttext">I added a Close button. Like you said this prevented the crash.<br />
<br />
Unfortunately i have an other problem:<br />
<br />
Below is the output of the example from the latest version. If i execute it on a terminal server within a rdp session. No problems on a workstation.<br />
<br />
The Plugin return not the number of the chosen button, it don't display at all and gives this faulty output<br />
<br />
Any ideas?<br />
<br />
C:\DOKUME~1\ab\LOKALE~1\Temp\3\nsu10.tmp\messagebox.dll<br />
messagebox call 1 returned... MB_DEFBUTTON4|MB_TOPMOST<br />
C:\DOKUME~1\ab\LOKALE~1\Temp\3\nsu10.tmp\messagebox.dll<br />
messagebox call 2 returned... MB_SETFOREGROUND|MB_ICONHAND|MB_DEFBUTTON3<br />
C:\DOKUME~1\ab\LOKALE~1\Temp\3\nsu10.tmp\messagebox.dll<br />
messagebox call 3 returned... MB_ICONHAND|MB_DEFBUTTON2<br />
C:\DOKUME~1\ab\LOKALE~1\Temp\3\nsu10.tmp\messagebox.dll<br />
messagebox call 4 returned... MB_ICONEXCLAMATION|MB_ICONHAND|MB_TOPMOST|MB_DEFBUTTON2|MB_RIGHT<br />
C:\DOKUME~1\ab\LOKALE~1\Temp\3\nsu10.tmp\messagebox.dll<br />
Completed</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zbd</div><div class="date">20th July 2007, 02:10</div></div><div class="posttext">This is a great plugin.<br />
<br />
I cant seem to work out why, but every time i try to show a custom messagebox, it adds an extra button on to the end that says, &quot;success&quot;<br />
<br />
I can't seem to make it not show.<br />
Any ideas?<br />
<br />
Nevermind, worked it out, had to Pop $0 before it<br />
Cheers</div></div><hr />


<div class="post"><div class="posttop"><div class="username">talonx</div><div class="date">10th September 2007, 12:52</div></div><div class="posttext">Great work!!! <br />
I'm using it in a current project of mine. Pressing the escape button when the message box is shown (2 custom buttons in my case) hangs the installer, with the CPU going to 60%...a known issue?<br />
<br />
Thanks in advance,<br />
    Hrish</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">23rd October 2008, 17:41</div></div><div class="posttext">It's a pity that messagebox plugin is no longer developed, because it's great. I encountered only one bug but it's a nasty one: messagebox crashes (it freezes, actually) when Esc is pressed. Seems that it goes into some infinite loop (cpu load is 99%).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">23rd October 2008, 17:44</div></div><div class="posttext">Just realized that the previous reply said the same thing. :o</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eagle3386</div><div class="date">22nd December 2008, 16:01</div></div><div class="posttext">Hey guys,<br />
<br />
I'm pretty new to all NSIS-stuff, but I truly enjoy the capabilities of the system! :)<br />
<br />
Anyway, let's get straight to the point:<br />
1. Awesome plugin, but:<br />
2. Could you, DrO, enable support for .ico-files?<br />
<br />
Since I'm only using a single icon for kinda &quot;Xmas welcome-screen&quot;, I'd prefer to not generate a DLL, but instead use such an .ico-file.<br />
<br />
Thanks in advance,<br />
 Martin.. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">22nd December 2008, 18:01</div></div><div class="posttext">Here's how I do it:<br />
<br />
&gt; You need Resource Hacker (http://www.angusj.com/resourcehacker/).<br />
<br />
<br />
&gt; Put the .ico in the folder where your script is and create a cmd file, e.g. header.cmd. Here's what you should put in it:<br />
<br />
@echo off<br />
rem 'Inject' the icons into the header with ResHacker:<br />
&quot;%ProgramFiles%\Resource Hacker\ResHacker.exe&quot; -add &quot;%TEMP%\exehead.tmp&quot;, &quot;%TEMP%\exehead.tmp&quot;, &quot;%~dps0IconName.ico&quot;, icongroup,104,1033<br />
rem If you want to compress the header with upx:<br />
&quot;%ProgramFiles%\UPX\upx.exe&quot; --best &quot;%TEMP%\exehead.tmp&quot;<br />
<br />
Icon group 104 will contain icons from your ico file. Add more lines for more icon groups.<br />
<br />
<br />
&gt; Put this at the end of your script:<br />
<br />
!packhdr &quot;$%TEMP%\exehead.tmp&quot; &quot;header.cmd&quot;<br />
<br />
<br />
&gt; And finally, the MessageBox example:<br />
<br />
Messagebox::show MB_TOPMOST &quot;Caption&quot; &quot;0,104&quot; &quot;Text&quot; &quot;Button 1&quot; &quot;Button 2&quot; &quot;Button 3&quot; &quot;Button 4&quot;<br />
# it uses the 1st icon from icongroup 104</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eagle3386</div><div class="date">22nd December 2008, 18:41</div></div><div class="posttext">First of all, thank you very much for your guide.<br />
<br />
Unfortunately, the sad thing about this solution is the fact that Resource Hacker doesn't work under Vista (at least not x64, which is the one I run).. :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">22nd December 2008, 22:25</div></div><div class="posttext">You could try XN Resource Editor or eXeScope as alternatives. I don't know if they'll work on Vista x64 but even if they do, the problem is they don't support command line operation, at least not to my knowledge. eXeScope documentation says it supports some kind of batch processing based on log files but I haven't tried the program. But if you do find a resource editor that works on your system, what you can do is:<br />
<br />
&gt; Instead of that header.cmd, create two new ones:<br />
<br />
header1.cmd:<br />
copy &quot;%TEMP%\exehead.tmp&quot; C:\tmphead.tmp<br />
<br />
header2.cmd:<br />
copy C:\tmphead.tmp &quot;%TEMP%\exehead.tmp&quot; /Y<br />
<br />
&gt; Compile the script with:<br />
!packhdr &quot;$%TEMP%\exehead.tmp&quot; &quot;header1.cmd&quot;<br />
<br />
&gt; Edit C:\tmphead.tmp with a resource editor<br />
<br />
&gt; Compile again with header2.cmd&quot;<br />
<br />
<br />
Or settle for a regular messagebox and use MB_USERICON... :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eagle3386</div><div class="date">22nd December 2008, 23:33</div></div><div class="posttext">Originally posted by aerDNA <br />
(...)<br />
Useful suggestions<br />
(...)<br />
<br />
Or settle for a regular messagebox and use MB_USERICON... :)<br />
Uh! That MB_USERICON shows the same like I did (as a workaround) while waiting for an answer from you (which means I set the app's icon to a different one):<br />
MessageBox::show styles &quot;Ho! Ho! Ho!&quot; &quot;0,103&quot; &quot;   Merry Xmas$\r$\n   to all you geeks! :)&quot; IDOK<br />
Though, following your way I can't set my own message box-title.. :(<br />
<br />
And I used &quot;0,103&quot; instead of your suggested &quot;0,104&quot; (AFAIR the Wiki told me that &quot;3&quot;) - maybe you could explain this to me? :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">23rd December 2008, 10:03</div></div><div class="posttext">Or settle for a regular messagebox and use MB_USERICON...<br />
Being sleepy makes me slip. You don't have to settle for a regular mb, you can also use the installer icon with the plugin, exactly the way you did. Icon group 103 always contains the installer icon. 104 was the one I suggested to create for adding an extra, which is unnecessary if you're willing to use the same icon for the installer and the messagebox.<br />
Btw, there's a way to change the title even when using the regular mb. But you don't need that now, or do you?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eagle3386</div><div class="date">23rd December 2008, 11:53</div></div><div class="posttext">Originally posted by aerDNA <br />
Being sleepy makes me slip. You don't have to settle for a regular mb, you can also use the installer icon with the plugin, exactly the way you did.<br />
This sounds somewhat familiar for me.. ;)<br />
<br />
Originally posted by aerDNA <br />
Icon group 103 always contains the installer icon. 104 was the one I suggested to create for adding an extra, which is unnecessary if you're willing to use the same icon for the installer and the messagebox.<br />
Thanks for clarifying this for me! :)<br />
<br />
Originally posted by aerDNA <br />
Btw, there's a way to change the title even when using the regular mb. But you don't need that now, or do you?<br />
I always want to learn more, so if you like, please go on! :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">23rd December 2008, 14:13</div></div><div class="posttext">Here, I've made a script that shows how to change a single MB's caption. My method may not be very elegant but it works, and it allows you to create an animated title. This doesn't really belong to this thread any more, I hope the moderators don't mind...<br />
<br />
<br />
OutFile &quot;XMAS.exe&quot;<br />
;Icon &quot;xmas.ico&quot;<br />
XPStyle On<br />
<br />
!include &quot;WinMessages.nsh&quot;<br />
!define InstCaption &quot;Merry XMAS Wisher 1.0 beta&quot;<br />
!define MBCaption1 &quot;  Merry XMAS, human!&quot;<br />
!define MBCaption2 &quot;  Live long and prosper!&quot;<br />
Caption &quot;${InstCaption}&quot;<br />
<br />
        Function .onInit<br />
# If you don't want the blinking caption on the taskbar as well, use .onGUIInit<br />
        <br />
InitPluginsDir<br />
WriteUninstaller $PLUGINSDIR\MBCaption.exe<br />
MessageBox MB_OK|MB_ICONINFORMATION|MB_TOPMOST &quot;This MessageBox has a normal title.&quot;<br />
Exec &quot;$PLUGINSDIR\MBCaption.exe&quot;<br />
MessageBox MB_OK|MB_USERICON|MB_TOPMOST &quot;But this one has a festive title!&quot;<br />
MessageBox MB_OK|MB_ICONINFORMATION|MB_TOPMOST &quot;This is the normal title again.&quot;<br />
Abort<br />
<br />
FunctionEnd<br />
<br />
Section &quot;Blank&quot;<br />
SectionEnd<br />
<br />
<br />
          Function un.onInit<br />
<br />
FindWindow $0 &quot;&quot; &quot;${InstCaption}&quot; &quot;&quot; &quot;&quot;<br />
IsWindow $0 0 -1<br />
<br />
CaptionLoop:<br />
SendMessage $0 ${WM_SETTEXT} &quot;0&quot; &quot;STR:${MBCaption1}&quot;<br />
Sleep 800<br />
SendMessage $0 ${WM_SETTEXT} &quot;0&quot; &quot;STR:&quot;<br />
Sleep 400<br />
SendMessage $0 ${WM_SETTEXT} &quot;0&quot; &quot;STR:${MBCaption2}&quot;<br />
Sleep 800<br />
SendMessage $0 ${WM_SETTEXT} &quot;0&quot; &quot;STR:&quot;<br />
Sleep 400<br />
FindWindow $1 &quot;&quot; &quot;${InstCaption}&quot; &quot;&quot; &quot;&quot;<br />
IsWindow $1 0 CaptionLoop<br />
<br />
Abort<br />
FunctionEnd<br />
<br />
Section &quot;un.Blank&quot;<br />
SectionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eagle3386</div><div class="date">23rd December 2008, 18:28</div></div><div class="posttext">Thank you very much! :)<br />
And merry Xmas to you and your family! ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aerDNA</div><div class="date">24th January 2009, 18:13</div></div><div class="posttext">Appendix:<br />
The above script is missing one thing: RequestExecutionLevel User. Without it, MBCaption.exe should (re)trigger UAC (Utterly Annoying Component :down: ).<br />
And as I said, the method is not very elegant. When you don't really need a flashing caption, the proper way to go would be to create a custom MB through Win API. E.g.:<br />
!include &quot;${NSISDIR}\Examples\System\System.nsh&quot;<br />
!define STYLE ${MB_OK}|${MB_ICONINFORMATION}|${MB_TOPMOST}<br />
System::Call 'User32::MessageBox(i $HWNDPARENT, t &quot;The text&quot;, t &quot;A caption&quot;, i ${STYLE}) i.'<br />
To use a custom icon (including the installer icon), you need MessageBoxIndirect, but it accepts only module handles. Handles returned by LoadImage don't work, that must be why MessageBox plugin can't support ico files.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eagle3386</div><div class="date">24th January 2009, 18:43</div></div><div class="posttext">Again, thanks a lot for pointing this out! :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">scully13</div><div class="date">30th January 2009, 15:17</div></div><div class="posttext">Has anyone ever converted the messagebox plugin into Unicode?  If not I would be interested in trying to do so if the source is available somewhere.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">30th January 2009, 17:48</div></div><div class="posttext">nope it's not been done since the source was lost. i did begin to reimplement it but my winamp commitments have killed that from happening. but maybe one day i'll get around to it...<br />
<br />
-daz</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DrO</div><div class="date">18th June 2011, 01:13</div></div><div class="posttext">have just removed the downloads for this and the wiki page relating to the plug-in has been removed.<br />
<br />
i'm never going to get around to re-creating it to make it compatible with current OSes since it's been almost 6 years and i've never found the time.<br />
<br />
is also better to remove it to prevent other users trying to use it and then wonder why they have issues - doesn't help it was compiled in a manner which turns out to not be DEP compatible *doh*<br />
<br />
:lock:<br />
<br />
-daz</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>