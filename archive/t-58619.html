<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" CompareDLLVersions, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  CompareDLLVersions NSIS Discussion" />
	
	<title> CompareDLLVersions [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  CompareDLLVersions</div>
<hr />
<div class="pda"><a href="t-58619.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=58619">CompareDLLVersions</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Bettawrekonize</div><div class="date">29th August 2001, 22:12</div></div><div class="posttext">Can someone please give me an example of how to use the CompareDLLVersions command?  Lets say I want to move DLL Files into a directory (that already has DLL files), but I want to use the CompareDLLVersions command to check the versions of the files to make sure that newer files don't get replaced by oldier files.  How would I do that?  Please give me an example.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DuaneJeffers</div><div class="date">30th August 2001, 00:40</div></div><div class="posttext">Section &quot;CompareDLLs&quot;<br />
SetOutPath $SYSDIR<br />
CompareDLLVersions /STOREFROM mydll1.dll mydllnew<br />
Goto xxx<br />
mydllnew:<br />
File mydll1.dll<br />
xxx:<br />
SectionEnd<br />
<br />
<br />
<br />
Hope this Helps, What this does is the CompareDllVersions will determine how new your dll is to the one on the computer you are installing this on to. If it is new, then it will extract the DLL to the System Directory and then be done with it. The Goto is in case the installer's DLL is newer than yours. This is how I interpret it.<br />
<br />
Hope this Helps,<br />
-Duane Jeffers</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bettawrekonize</div><div class="date">2nd September 2001, 16:49</div></div><div class="posttext">I haven't tried this yet, but thanks.  I hope it works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bettawrekonize</div><div class="date">2nd September 2001, 17:27</div></div><div class="posttext">It still doesn't work right.  Can you give me an example?  Ok, as an example, lets say Dllupdate.nsi is in C:\test, and the file DXTMSFT.DLL is also in C:\test.  Ok lets say that another version of DXTMSFT.DLL is in C:\test2, and I want to make an installation file that'll install DXTMSFT.DLL into C:\test2, but it'll first check to see if the DXTMSFT.DLL in C:\test2 is newer or oldier than the one that's in the installation file (to make sure that it won't install an oldier version into C:\test2).  How will I do that?<br />
This is what I tried<br />
<br />
Section &quot;CompareDLLs&quot;<br />
SetOutPath C:\test2<br />
CompareDLLVersions /STOREFROM DXTMSFT.DLL DXTMSFT.DLL<br />
Goto xxx<br />
DXTMSFT.DLL:<br />
File DXTMSFT.DLL.dll<br />
xxx:<br />
SectionEnd<br />
<br />
Do you think you can help?  I would appreciate it a lot if someone can help.  Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">prodangle</div><div class="date">3rd September 2001, 01:36</div></div><div class="posttext">Here's how I got it going, ripped straight out of my .nsi so it should work.  hope this helps :cool: :cool: :cool:<br />
<br />
<br />
;DLL/OCX version checking stuff<br />
SetOverwrite on<br />
SetOutPath $SYSDIR<br />
CompareDLLVersions /STOREFROM comdlg32.ocx $SYSDIR\comdlg32.ocx comdlg32_1newer comdlg32_2newer<br />
comdlg32_1newer:<br />
File comdlg32.ocx<br />
RegDLL &quot;$SYSDIR\comdlg32.ocx&quot;<br />
comdlg32_2newer:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bettawrekonize</div><div class="date">3rd September 2001, 07:12</div></div><div class="posttext">It didn't work but thanks anyways.  It says error on line 3.  I'll try to figure it out, but if someone can tell me why it's not working I would appreciate it.  Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">prodangle</div><div class="date">3rd September 2001, 14:20</div></div><div class="posttext">I assume you changed the $SYSDIR etc to the directories you actually want to use ($TEMP i think)<br />
Anyway - line 3 sounds a bit too high up to be part of this code.  Sounds like the problem is elsewhere in your script - post it up here and we'll take a look if you want</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bettawrekonize</div><div class="date">3rd September 2001, 20:21</div></div><div class="posttext">Thanks</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>