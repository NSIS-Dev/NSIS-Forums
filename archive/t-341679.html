<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" How to detect flash drive, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  How to detect flash drive NSIS Discussion" />
	
	<title> How to detect flash drive [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  How to detect flash drive</div>
<hr />
<div class="pda"><a href="t-341679.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=341679">How to detect flash drive</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">C_10</div><div class="date">3rd February 2012, 09:46</div></div><div class="posttext">Hi,<br />
<br />
I want to detect a USB flash drive once the user connect it.<br />
It should look like this:<br />
; Disable next button while USB flash drive not identified<br />
  GetDlgItem $0 $HWNDPARENT 1	; next=1, cancel=2, back=3<br />
  EnableWindow $0 0<br />
  loop:<br />
  ${If}<br />
  # usb is detected<br />
  ${Else}<br />
  Goto loop<br />
  ${EndIf}<br />
  ; Enable next button<br />
  GetDlgItem $0 $HWNDPARENT 1<br />
  EnableWindow $0 1<br />
<br />
I hope you have some ideas,<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">3rd February 2012, 10:10</div></div><div class="posttext">See this recent thread: http://forums.winamp.com/showthread.php?t=341152</div></div><hr />


<div class="post"><div class="posttop"><div class="username">C_10</div><div class="date">7th February 2012, 12:34</div></div><div class="posttext">Thanks! It works:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">C_10</div><div class="date">7th February 2012, 14:40</div></div><div class="posttext">Now first of all my custom function search the flash drive and then I can see text/label/image and so on...<br />
But i want it the other way round...<br />
<br />
How can I do this?<br />
<br />
Function customFunction<br />
  nsDialogs::Create 1018<br />
  ; Text, label, image<br />
  ...<br />
  ; Disable next button while USB flash drive not identified<br />
  GetDlgItem $0 $HWNDPARENT 1	; next=1, cancel=2, back=3<br />
  EnableWindow $0 0<br />
  ; Search flash drive<br />
  ...<br />
  ; Enable next button<br />
  GetDlgItem $0 $HWNDPARENT 1<br />
  EnableWindow $0 1<br />
  nsDialogs::Show<br />
  ${NSD_FreeImage} $Image<br />
FunctionEnd<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">C_10</div><div class="date">10th February 2012, 08:48</div></div><div class="posttext">Hmm, perhaps I should attach some images.<br />
<br />
While searching the flash drive I can't see the images/labels (see attachments).<br />
But I want that you can see the page with all components first, and after that the installer should search the flash drive.<br />
<br />
I hope you understand what I mean, please help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">10th February 2012, 09:29</div></div><div class="posttext">Once you do nsDialogs::Show, the installer will wait until the Next button is pressed (or any other button which has a callback function defined). The installer cannot wait for two things at the same time (Next button and flash drive). So you'll need to do the flashdrive search in the page's leave function. The page would then say &quot;please insert the flash drive and click Next to continue&quot;. If in the leave function no drive is found, call abort and the installer will stay on the 'please insert' page.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">C_10</div><div class="date">10th February 2012, 10:20</div></div><div class="posttext">Thanks MSG! That's a good idea, but I've one problem:<br />
<br />
 So you'll need to do the flashdrive search in the page's leave function<br />
<br />
I've a custom page, so I can't use &quot;!define MUI_PAGE_CUSTOMFUNCTION_LEAVE&quot;<br />
Can I copy the flashdrive search after <br />
nsDialogs::Show<br />
${NSD_FreeImage} $Image<br />
and make so my own customFunction leave?<br />
<br />
Function customFunction<br />
  nsDialogs::Create 1018<br />
  ; Text, label, image<br />
  ...<br />
  nsDialogs::Show<br />
  ${NSD_FreeImage} $Image<br />
<br />
  ; search flash drive<br />
  ...<br />
  MessageBox MB_YESNO &quot;Leave Function TEST! Go to next page?&quot; IDYES +2<br />
  Abort<br />
<br />
FunctionEnd<br />
<br />
I can see the MessageBox, but when I click on &quot;No&quot;, I'm on the next page anyway...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">10th February 2012, 10:58</div></div><div class="posttext">Page custom customFunction customLeaveFunction<br />
<br />
http://nsis.sourceforge.net/Docs/Chapter4.html#4.5.4</div></div><hr />


<div class="post"><div class="posttop"><div class="username">C_10</div><div class="date">10th February 2012, 12:14</div></div><div class="posttext">Thanks again MSG!!!<br />
<br />
My problem is solved :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>