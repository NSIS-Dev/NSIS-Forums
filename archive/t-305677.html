<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Windows 7 - RequestExecutionLevel ?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Windows 7 - RequestExecutionLevel ? NSIS Discussion" />
	
	<title> Windows 7 - RequestExecutionLevel ? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Windows 7 - RequestExecutionLevel ?</div>
<hr />
<div class="pda"><a href="t-305677.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305677">Windows 7 - RequestExecutionLevel ?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">kando234</div><div class="date">24th April 2009, 09:30</div></div><div class="posttext">Hi,<br />
<br />
another small problem I experienced...<br />
I really donÂ´t get this and maybe someone<br />
out here has an idea whatÂ´s going on.<br />
<br />
My old installation routine - i call it (1) from now on - (guess it was built with NSIS version &lt; 2) works fine on windows 7...<br />
<br />
But my new installation routine - (2) - (same source,<br />
just added a few sections) doesnÂ´t.<br />
<br />
HereÂ´s what happens on Windows 7:<br />
<br />
(1) UAC Warning, <br />
looks like this (http://img27.imageshack.us/img27/3365/unbenanntmtp.png)<br />
(if url does not appear: img27.imageshack.us/img27/3365/unbenanntmtp.png<br />
<br />
-&gt; I click allow -&gt; everything works as expected<br />
<br />
(2): Security warning due to unknown publisher<br />
(we know that from Vista and XP) - looks like this (http://www.tweak-uac.com/UAC-unknown-publisher.png) (i googled an image, if url does not appear: tweak-uac.com/UAC-unknown-publisher.png)<br />
<br />
-&gt; I click &quot;Run&quot; -&gt; Installer works fine but isnÂ´t allowed to create folders or shortcuts<br />
<br />
P.S.: <br />
RequestExecutionLevel for both installers is set to:<br />
<br />
RequestExecutionLevel user<br />
<br />
<br />
Thanks for any hint you can provide on why those installation routines work different (I want it the way the old installation routine worked ... without changing user -&gt; admin, or is it impossible without changing it to admin ?)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">24th April 2009, 16:23</div></div><div class="posttext">where are you trying to create the folders/shortcuts?  They may be off-limits to writing except for admins (short of an admin messing with permissions).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kando234</div><div class="date">24th April 2009, 18:44</div></div><div class="posttext">Folders in<br />
C:\Program Files\[blabla]<br />
<br />
and<br />
<br />
shortcuts in startmenu and desktop.<br />
<br />
The old installer works fine with RequestLevel user !<br />
But the new one doesnÂ´t ... It cannot create folders<br />
or shortcuts in Vista or Windows 7.<br />
<br />
Is there something the new version of NSIS changed ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">24th April 2009, 18:53</div></div><div class="posttext">yes, but did your old installer actually try to write to c:\program files\[blabla]?<br />
<br />
If not - there's your problem :)  Any installer that wants to write files to the Program Files folder, write to the HKLM registry and several more bits and pieces require administrator rights.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kando234</div><div class="date">24th April 2009, 19:46</div></div><div class="posttext">Of course I tried the same folders in &quot;Program Files&quot; but as you can see both installers request different authorization.... very strange.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">25th April 2009, 12:15</div></div><div class="posttext">there was no RequestExecutionLevel in &lt;v2, so what you are saying does not make any sense.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Comperio</div><div class="date">25th April 2009, 17:57</div></div><div class="posttext">I'll add a few more things:<br />
<br />
RequestExecutionLevel was added with 2.21.  So even the very first releases of 2.x did not have it.<br />
<br />
And are SURE that you have RequestExecutionLevel properly set?<br />
<br />
I know Windows Vista has the ability to try to auto-detect if an EXE is an installation or not based on file names, embedded vendor info, and other &quot;signatures&quot;.  So it's possible you'd get the UAC prompt in some cases in which there was no application manifest.<br />
<br />
I did some searching and found this tool that may help you 'peek inside' your EXE to show you any embedded application manifest to allow you to see if it actually has the proper executionlevel set:  (http://weblogs.asp.net/kennykerr/archive/2007/07/10/manifest-view-1-0.aspx)  <br />
<br />
I haven't tried it, but I thought I'd mentioned it as a way for you to double-check each of your EXEs to see if they actually have the manifest set properly.  (There is another tool in one of the MS SDKs that I've used before that does a similar thing, but unfortunately, I don't remember the name of it off hand...)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>