<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" InstallOptions: question on FileRequest control, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  InstallOptions: question on FileRequest control NSIS Discussion" />
	
	<title> InstallOptions: question on FileRequest control [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  InstallOptions: question on FileRequest control</div>
<hr />
<div class="pda"><a href="t-66546.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=66546">InstallOptions: question on FileRequest control</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">s0mbre</div><div class="date">24th November 2001, 14:47</div></div><div class="posttext">Before I begin I'd like to thank Justin and Michael for their work on NSIS and InstallOptions. A warm thank you to all other contributors as well. :)<br />
<br />
Both my questions are related to the FileRequest control available in InstallOptions.<br />
<br />
1.  The InstallOptions docs state:<br />
MaxLen (optional) This should be set to a maximum of 260 for &quot;FileRequest&quot; and &quot;DirRequest&quot; controls. <br />
   May I ask why? ;)  Is that the limit on path lengths?  So I should *definitely* set MaxLen to 260 for all FileRequest controls then?<br />
<br />
2.  Is there any way to specify an initial directory for the FileRequest dialog box? It seems to default to starting up in whatever directory InstallOptions.exe is running from.<br />
<br />
Thank you. :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th November 2001, 15:21</div></div><div class="posttext">Text (optional) Specifies the caption of a label control, or the initial text for text and comboboxes. Will also specify the initial value for FileRequest and DirRequest controls.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">s0mbre</div><div class="date">24th November 2001, 17:32</div></div><div class="posttext">Thanks kichik, but I know about that. ;) <br />
That sets the initial text in the FileRequest box. I want to know if theres a way to set the initial directory in the file browse dialog box that the FileRequest control pops up.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">29th November 2001, 09:42</div></div><div class="posttext">Would you be able to do a SetOutPath to the correct location before loading Install Options, and then load it using a full path?<br />
<br />
  SetOutPath $TEMP<br />
  File InstallOptions.exe<br />
  File InstallOptions.ini<br />
<br />
; I want the FileRequest to start at C:\WINDOWS<br />
  SetOutPath C:\WINDOWS<br />
<br />
  WriteINIStr $TEMP\InstallOptions.ini Settings ParentWnd $HWNDPARENT<br />
  ExecWait &quot;$TEMP\InstallOptions $TEMP\InstallOptions.ini&quot;This hasn't been tested, but I don't see why it wouldn't work!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">s0mbre</div><div class="date">29th November 2001, 11:56</div></div><div class="posttext">Thank you very much petersa! :D <br />
<br />
I was beginning to think no-one would answer me.  I am going to go try your suggestion &amp; get back to ya. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">s0mbre</div><div class="date">29th November 2001, 15:18</div></div><div class="posttext">Hi all. :)<br />
<br />
Peter, thanks for the suggestion, man.  It was a great idea and it works well enough.<br />
<br />
I did run into a problem, I think it might be a bug with NSIS1.67/InstallOptions, my computer, or my script.  (I don't see anything wrong with the script though. :)<br />
<br />
The problem is that certain variables don't work with the file browse box. (They seem to work fine everywhere else tho)<br />
<br />
For example the following works, i.e. the file browse dialog box opens up at C:\Windows\<br />
;copy installoptions.exe to temp dir<br />
  SetOutPath $TEMP<br />
  File InstallOptions.exe<br />
  File &quot;filereq.ini&quot;<br />
<br />
;SetOutPath to folder you want browse file box to start at<br />
  SetOutPath &quot;$WINDIR&quot;<br />
;run installoptions<br />
  WriteINIStr $TEMP\filereq.ini Settings ParentWnd $HWNDPARENT<br />
  ExecWait '$TEMP\InstallOptions $TEMP\filereq.ini'<br />
  ReadINIStr $1 $TEMP\filereq.ini Results 2<br />
  ReadINIStr $2 $TEMP\filereq.ini Results 4 <br />
<br />
But the following (which is what I wanted) doesn't work - the file browse box starts at the 'My Documents' folder:<br />
;copy installoptions.exe to temp dir<br />
  SetOutPath $TEMP<br />
  File InstallOptions.exe<br />
  File &quot;filereq.ini&quot;<br />
<br />
;SetOutPath to folder you want browse file box to start at<br />
  SetOutPath &quot;$PROGRAMFILES&quot;<br />
;run installoptions<br />
  WriteINIStr $TEMP\filereq.ini Settings ParentWnd $HWNDPARENT<br />
  ExecWait '$TEMP\InstallOptions $TEMP\filereq.ini'<br />
  ReadINIStr $1 $TEMP\filereq.ini Results 2<br />
  ReadINIStr $2 $TEMP\filereq.ini Results 4 <br />
<br />
I have obtained the following results when using variables to set outpath for the file browse box:<br />
  SetOutPath &quot;$QUICKLAUNCH&quot;	;My Documents<br />
  SetOutPath &quot;$INSTDIR&quot;	;My Documents<br />
  SetOutPath &quot;$PROGRAMFILES&quot;	;My Documents<br />
  SetOutPath &quot;$DESKTOP&quot;	;My Documents<br />
  SetOutPath &quot;$EXEDIR&quot;		;Works<br />
  SetOutPath &quot;$WINDIR&quot;		;Works<br />
  SetOutPath &quot;$SYSDIR&quot;		;Works<br />
  SetOutPath &quot;$TEMP&quot;		;Works<br />
  SetOutPath &quot;$STARTMENU&quot;	;My Documents<br />
  SetOutPath &quot;$SMPROGRAMS&quot;	;Works<br />
  SetOutPath &quot;$SMSTARTUP&quot;	;My Documents<br />
  SetOutPath &quot;$QUICKLAUNCH&quot;	;My Documents <br />
<br />
I have found that even if i write the path, e.g. SetoutPath &quot;C:\Program Files&quot; it doesn't work and insists on opening at My Documents.<br />
<br />
And one final item I noticed is that the Details view of the install shows that the OutputDir is indeed being set correctly all the time, even if the file browse box opens at My Documents.  This is a very strange bug.<br />
<br />
I am attaching my code - it's very simple, it's a trimmed down version of the example that comes with InstallOptions.  Included in the zip is a screenshot of the details view of the install.<br />
<br />
I hope some kind souls out there will have a look at it, at least compile it and see if they get the same error on their system. :)<br />
<br />
Thanks guys &amp; gals. :eek:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">30th November 2001, 10:49</div></div><div class="posttext">I just tried it on my system with $PROGRAMFILES, and got My Documents. Sounds like a problem with Install Options.<br />
<br />
I think I've found another bug with Install Options: after clicking the '...' button and then clicking 'Cancel', the box then re-opens, as if you had pressed the '...' button again.<br />
<br />
Anyone else get this?<br />
<br />
I think another option should be added to the INI file, like DefaultFolder or something, so that you don't have to set the working directory to it.<br />
<br />
Actually, I think that $HWNDPARENT should be specified as a command line argument and not as part of the INI file, because it's an unnecessary write to the file that can be avoided.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">s0mbre</div><div class="date">30th November 2001, 16:32</div></div><div class="posttext">I'm rather pleased (does this make me perverse? :p) to hear you experienced the same problem - at least this means the problem is reproducible and apparently identifiable.<br />
<br />
Thanks again petersa, you're a one-man assistance machine. :)<br />
<br />
I experienced the same click on '...', click on 'Cancel', file browse box reappears phenomenon.  If I click 'Cancel' on the second box though, it really goes away. ;)  You can't blame a module for being persistent. :)<br />
<br />
Oh a 'DefaultFolder' option would be divine.  I'm so grateful for what I already have, though.  It's really kind of people like Justin, Michael, and all other contributors to NSIS (yourself included petersa) to work on NSIS and benefit so many others. :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">locnar42</div><div class="date">6th December 2001, 23:36</div></div><div class="posttext">I will take a look at this and fix it ASAP. (btw, my cable connection is AWOL while @home sorts out their business.  Until I get it back I may not post much)<br />
<br />
The way it's supposed to work (at least in my mind) is to open in whatever directory is specified by the filename in the box.  If this is empty (or invalid path) then it's going to use the current directory.<br />
<br />
Anybody else agree/disagree with this operation?<br />
<br />
michael</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">7th December 2001, 11:45</div></div><div class="posttext">I agree with you there, but if there isn't a file in the box then a default directory would be good, instead of just 'My Documents', because chances are the file you're looking for won't be there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">locnar42</div><div class="date">7th December 2001, 13:39</div></div><div class="posttext">hrmm, perhaps you are right.  Allow the user to specify default directories for each control.  It would use that after filename, but before the current directory.<br />
<br />
michael</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petersa</div><div class="date">7th December 2001, 13:59</div></div><div class="posttext">Sounds great. :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">s0mbre</div><div class="date">9th December 2001, 05:58</div></div><div class="posttext">I'll second that - it sounds great. :)<br />
<br />
I can't *believe* I'm getting NSIS for free - incredible. :eek:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">roberto12cr</div><div class="date">13th May 2013, 18:00</div></div><div class="posttext">Hi, <br />
I am trying to add a file request to my ui...<br />
but when I run the exe file it does not show the control....<br />
<br />
I have the same problem with the dirrequest control...<br />
this is my ini code:<br />
<br />
; Auto-generated by EclipseNSIS InstallOptions Script Wizard<br />
; May 13, 2013 10:51:19 AM<br />
[Settings]<br />
NumFields=2<br />
<br />
[Field 1]<br />
Type=FileRequest<br />
Left=25<br />
Top=93<br />
Right=258<br />
Bottom=106<br />
Flags=NOTIFY|FILE_EXPLORER|FILE_MUST_EXIST|PROMPT_CREATE<br />
MaxLen=260<br />
<br />
[Field 2]<br />
Type=DirRequest<br />
Left=25<br />
Top=62<br />
Right=258<br />
Bottom=75<br />
Flags=NOTIFY<br />
MaxLen=260<br />
<br />
Thanks in advance...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">14th May 2013, 10:00</div></div><div class="posttext">This is only form definition, can you show some script how use this form?<br />
<br />
I suggest you to switch to nsDialog, InstallOptions forms are deprecated.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>