<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Custom Page, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Custom Page NSIS Discussion" />
	
	<title> Custom Page [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Custom Page</div>
<hr />
<div class="pda"><a href="t-267637.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267637">Custom Page</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">is99</div><div class="date">12th March 2007, 15:09</div></div><div class="posttext">Is it possible when I use modern UI to make a custom page without the Header ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">12th March 2007, 15:16</div></div><div class="posttext">[Settings]<br />
NumFields=#<br />
Rect=1044<br />
<br />
See IO documentation,<br />
<br />
http://nsis.sourceforge.net/Docs/InstallOptions/Readme.html</div></div><hr />


<div class="post"><div class="posttop"><div class="username">is99</div><div class="date">12th March 2007, 16:58</div></div><div class="posttext">Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">is99</div><div class="date">13th March 2007, 16:28</div></div><div class="posttext">I have one very small problem with it.<br />
<br />
When I work your way everything work great but at the bottom of the screen where there is usually &quot;Nullsoft installation system&quot; line this line is cut in half so I dont see the upper half of the line.<br />
<br />
Is it possible to remove this line at all somehow or make someohow that my screen wont overlap it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">13th March 2007, 16:40</div></div><div class="posttext">http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.6</div></div><hr />


<div class="post"><div class="posttop"><div class="username">is99</div><div class="date">13th March 2007, 17:13</div></div><div class="posttext">Thanks again</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BlueStream</div><div class="date">9th April 2007, 11:29</div></div><div class="posttext">How about if you want the &quot;content area&quot; to have a white background like the MUI_PAGE_WELCOME and MUI_PAGE_FINISH?<br />
<br />
I've tried putting a white bitmap in the &quot;content area&quot; but the labels for the checkboxes that I've included are still gray. <br />
<br />
Is there a better way to do this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th April 2007, 11:45</div></div><div class="posttext">Use SetCtlColors to set its background color. In the show callback function of the page, read HWND from the INI file and use it with SetCtlColors.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BlueStream</div><div class="date">9th April 2007, 12:13</div></div><div class="posttext">Hi kichik<br />
<br />
Sorry.. I'm a bit confused esp about handles.. This is what I did...<br />
<br />
in file.nsi<br />
GetDlgItem $asd $HWNDPARENT 1<br />
SetCtlColors $asd 0x000000 0xFFFFFF<br />
<br />
in options.ini<br />
[Settings]<br />
NumFields=7<br />
Rect=1044<br />
HWND=asd<br />
<br />
Think it's wrong :eek: <br />
<br />
Usage: GetDlgItem $(user_var: handle output) dialog item_id<br />
Error in script</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th April 2007, 12:16</div></div><div class="posttext">You probably forgot to define $asd using Var.<br />
<br />
But you don't need GetDlgItem and 1 is the identifier of the Next button and not of your control. Use ReadINIStr or MUI_INSTALLOPTIONS_READ to get the HWND value of your Field. Open the INI file in $PLUGINSDIR when the installer is running and you'll see.<br />
<br />
To find out where $PLUGINSDIR is, simply MessageBox it after it's initialized. You can manually initialize it using InitPluginsDir or use it after the custom page was already displayed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BlueStream</div><div class="date">9th April 2007, 13:09</div></div><div class="posttext">Hi kichik.<br />
<br />
I now see that it's generated for you. :)<br />
<br />
But I still can't read the value. <br />
<br />
ReadINIStr $asd &quot;ioC.ini&quot; &quot;Field 3&quot; &quot;HWND&quot;<br />
ReadINIStr $asd &quot;$PLUGINSDIR\ioC.ini&quot; &quot;Field 3&quot; &quot;HWND&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_READ $asd &quot;$PLUGINSDIR\ioC.ini&quot; &quot;Field 3&quot; &quot;HWND&quot;<br />
<br />
Neither of these return the value of HWND, unless I manually set the value in the original ioC.ini file which is wrong, I know.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th April 2007, 13:45</div></div><div class="posttext">Then you're either using a very old version of NSIS or you're reading the value before the page is actually created. Use it after MUI_INSTALLOPTIONS_INITDIALOG. If you're using MUI_INSTALLOPTIONS_DISPLAY, split it to MUI_INSTALLOPTIONS_INITDIALOG and MUI_INSTALLOPTIONS_SHOW.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BlueStream</div><div class="date">9th April 2007, 14:29</div></div><div class="posttext">Thanks kichik :D <br />
<br />
As always, letting me find my way without leading me by the hand. I always learn a lot from you. :)<br />
<br />
Cheers :D<br />
<br />
For the benefit of the rest:<br />
<br />
in script.nsi (replace Field X with the name of the field)<br />
Var $avarname<br />
<br />
Function PageFunction<br />
   !insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;ioC.ini&quot;<br />
   ReadINIStr $avarname &quot;$PLUGINSDIR\io.ini&quot; &quot;Field X&quot; &quot;HWND&quot;<br />
   SetCtlColors $avarname 0x000000 0xFFFFFF<br />
   !insertmacro MUI_INSTALLOPTIONS_SHOW<br />
FunctionEnd<br />
<br />
in io.iniNothing extra</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BlueStream</div><div class="date">9th April 2007, 16:40</div></div><div class="posttext">Now I have a related question.<br />
<br />
Why is my white bitmap image of size 250x200 and monochrome at [Field 1] appearing above the other fields and not displaying. <br />
<br />
I made one also at 600x600 but that covered up almost the entire screen even though i put the left, top, etc at different coordinates.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th April 2007, 16:48</div></div><div class="posttext">If it's not appearing, you probably didn't extract it and set the State value of the Bitmap control correctly. You must set State at runtime so InstallOptions can find the image.<br />
<br />
The controls are created sequentially from Field 1 to the last field so the first control should be behind everything. Are you sure it's really Field 1 that's hiding the second group box?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BlueStream</div><div class="date">9th April 2007, 16:56</div></div><div class="posttext">This is my ioC.ini<br />
<br />
<br />
[Settings]<br />
NumFields=8<br />
Rect=1044<br />
NextButtonText=Finish<br />
<br />
[Field 1]<br />
Type=Bitmap<br />
Text=white.bmp<br />
Left=130<br />
Right=313<br />
Top=32<br />
Bottom=180<br />
State=1<br />
<br />
[Field 2]<br />
Type=Groupbox<br />
Text=Shortcuts<br />
Left=117<br />
Right=315<br />
Top=52<br />
Bottom=93<br />
<br />
[Field 3]<br />
Type=Groupbox<br />
Text=Additional<br />
Left=117<br />
Right=315<br />
Top=109<br />
Bottom=148<br />
<br />
[Field 4]<br />
Type=checkbox<br />
Text=Create shortcut on the Desktop.<br />
Left=126<br />
Right=288<br />
Top=64<br />
Bottom=76<br />
State=0<br />
HWND=<br />
<br />
[Field 5]<br />
Type=checkbox<br />
Text=Create shortcut in the Start Menu.<br />
Left=126<br />
Right=300<br />
Top=76<br />
Bottom=88<br />
State=1<br />
<br />
[Field 6]<br />
Type=Checkbox<br />
Text=Start the program once done.<br />
Left=126<br />
Right=272<br />
Top=124<br />
Bottom=132<br />
State=1<br />
<br />
[Field 7]<br />
Type=Bitmap<br />
Text=win.bmp<br />
Left=0<br />
Right=110<br />
Top=0<br />
Bottom=193<br />
<br />
[Field 8]<br />
Type=Label<br />
Text=Additional configuration<br />
Left=109<br />
Right=316<br />
Top=0<br />
Bottom=47<br />
<br />
<br />
State=1 added to [Field 1] to no avail. As you can see, the other bitmap displays fine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th April 2007, 16:59</div></div><div class="posttext">Sorry, you must set Text correctly, not State. State means nothing for Bitmap controls. You must set Text to where you've extracted the image or InstallOptions won't be able to find the image. You must use WriteINIStr or MUI_INSTALLOPTIONS_WRITE on runtime to write the path where the image was extracted.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BlueStream</div><div class="date">9th April 2007, 17:11</div></div><div class="posttext">oooo<br />
<br />
I think I've got the general idea. Was under the impression that it was all automatic.<br />
<br />
Thx :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BlueStream</div><div class="date">9th April 2007, 19:12</div></div><div class="posttext">Image displays but is still on top. Any ideas?<br />
<br />
Function onInit<br />
   InitPluginsDir<br />
   File /oname=$PLUGINSDIR\white.bmp &quot;white.bmp&quot;<br />
FunctionEnd<br />
<br />
Function CustomPageC<br />
   !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioC.ini&quot; &quot;Field 1&quot; &quot;Text&quot; &quot;$PLUGINSDIR\white.bmp&quot;<br />
   !insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;ioC.ini&quot;<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th April 2007, 19:16</div></div><div class="posttext">Attach the script and the INI file. As said earlier, this shouldn't happen as the first field is created first.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BlueStream</div><div class="date">9th April 2007, 19:30</div></div><div class="posttext">Attached</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BlueStream</div><div class="date">9th April 2007, 19:32</div></div><div class="posttext">File is attached here</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">9th April 2007, 19:57</div></div><div class="posttext">Is that still for the white background? You don't need a bitmap for that... Get the HWND of the InstallOptions dialog and use SetCtlColors on that. Use MUI_INSTALLOPTIONS_INITDIALOG_RETURN and Pop the result which is the HWND.<br />
<br />
As for the bitmap, my bad again. The last Field goes on the bottom of the Z-order. From MSDN:If the created window is a child window, its default position is at the bottom of the Z-order. If the created window is a top-level window, its default position is at the top of the Z-order (but beneath all topmost windows unless the created window is itself topmost).So Field 1 should be Field 8.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BlueStream</div><div class="date">10th April 2007, 05:36</div></div><div class="posttext">Hey again Kichik. <br />
<br />
That about solves it :)<br />
<br />
But there is &quot;no such macro MUI_INSTALLOPTIONS_INITDIALOG_RETURN&quot;.<br />
<br />
Will just stick with the bitmap :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">10th April 2007, 20:17</div></div><div class="posttext">Right, then MUI_INSTALLOPTIONS_INITDIALOG already pushes the HWND to the stack. Even if you stick with the bitmap, you should Pop that value to avoid stack corruption.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BlueStream</div><div class="date">11th April 2007, 06:21</div></div><div class="posttext">script updated..<br />
<br />
Thx again :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>