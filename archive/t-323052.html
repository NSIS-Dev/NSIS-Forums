<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" WinSxS_HasAssembly and msvcrt90.dll, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  WinSxS_HasAssembly and msvcrt90.dll NSIS Discussion" />
	
	<title> WinSxS_HasAssembly and msvcrt90.dll [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  WinSxS_HasAssembly and msvcrt90.dll</div>
<hr />
<div class="pda"><a href="t-323052.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=323052">WinSxS_HasAssembly and msvcrt90.dll</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">flobadob</div><div class="date">11th October 2010, 16:56</div></div><div class="posttext">I'm using WinSxS_HasAssembly (http://nsis.sourceforge.net/WinSxS_QueryAssemblyInfo_to_check_if_assembly_is_installed) to detect whether vc++ 2008 SP1 redistributables are installed. The function always returns 0 even though the redist package is installed. I'm calling the function with the following code...<br />
<br />
Function CheckVCRedist<br />
	Var /GLOBAL VCREDIST<br />
	push 'msvcr90.dll'<br />
	push 'Microsoft.VC90.CRT,version=&quot;9.0.21022.8&quot;,type=&quot;win32&quot;,processorArchitecture=&quot;x86&quot;,publicKeyToken=&quot;1fc8b3b9a1e18e3b&quot;'<br />
	call WinSxS_HasAssembly<br />
	pop $VCREDIST<br />
	DetailPrint 'WinSxS check for runtime returned $VCREDIST'<br />
FunctionEnd<br />
<br />
Anyone else have any difficulty with this function and vc++ 2008 SP1?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Animaether</div><div class="date">11th October 2010, 18:52</div></div><div class="posttext">I remember glancing over a discussion on this over here..<br />
http://kobyk.wordpress.com/2008/04/12/deploying-the-visual-c-libraries-with-an-nsis-installer/<br />
..though I don't know if it was actually resolved there.<br />
<br />
To be honest, we use the registry keys to detect whether it is installed (it's not foolproof, but no method seems to be.. and if the registry key is missing while the product -is- installed, it's typically a good idea for the user to re-install anyway), and the prepackaged installers (run in silent mode) to install them if needed - rather than trying to install them ourselves.<br />
<br />
But that discussion should give you something to work with, at least :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">12th October 2010, 07:41</div></div><div class="posttext">You have a space in x86, not sure if that is just the forum post or what but the assembly string needs to be in the correct format and the function is very picky about it.<br />
<br />
Also, your post says msvcrt90.dll but your code says msvcr90.dll, make up your mind ;)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>