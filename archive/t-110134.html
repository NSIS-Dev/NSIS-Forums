<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" need help regarding multini4 (instopts.dll), media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  need help regarding multini4 (instopts.dll) NSIS Discussion" />
	
	<title> need help regarding multini4 (instopts.dll) [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  need help regarding multini4 (instopts.dll)</div>
<hr />
<div class="pda"><a href="t-110134.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=110134">need help regarding multini4 (instopts.dll)</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">lvsram</div><div class="date">17th October 2002, 00:43</div></div><div class="posttext">Hi,<br />
As i have to insert 2 ini pages, i used InstOpts.dll similar to multini4 on sunjammer's site.I used same macros and same functions.<br />
My problem is i am getting error when i use<br />
ReadINIStr $3 &quot;iniA.ini&quot; &quot;Field 3&quot; State<br />
Please help me.<br />
<br />
thanks in advance.<br />
lvsram</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Freeman II</div><div class="date">17th October 2002, 04:58</div></div><div class="posttext">what error message did you get?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lvsram</div><div class="date">17th October 2002, 15:34</div></div><div class="posttext">Now i found the problem that i haven't given the complete path of ini file.<br />
But there is one thing i feel like knowing.<br />
Is there any way to know what the error is? <br />
Thank you very much for the response.<br />
--lvsram</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th October 2002, 16:26</div></div><div class="posttext">No there isn't. NSIS doesn't return any error strings.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lvsram</div><div class="date">17th October 2002, 22:10</div></div><div class="posttext">now i am inserting 3 ini files by using multini4 from sunjammer site.<br />
i am able to get the values. Now my problem is <br />
1 . i want to make sure the user entered some value in the first and then only i want user to go to second page. and same thing for second and third pages.<br />
2. Exactly where in the methods onCustomPage, onPageEntry, onPageExit,<br />
do i have to check(i think mostly in onPageExit) ? and when i check if i find the blank values, how can i force the current page to be shown without going next page, unless user enters some value in the fields. <br />
<br />
please help me.<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th October 2002, 22:27</div></div><div class="posttext">In the example (multini4.nsi) you have a function called onCustomPage. In it the DLL is called (CallInstDll &quot;$TEMP\instopts.dll&quot; dialog). All you need to do is condition the entire calling process (quoted below) with some StrCmp or IntCmp depending on the input from the last page.<br />
<br />
Push &quot;$TEMP\\ini$0.ini&quot;<br />
CallInstDll &quot;$TEMP\\instopts.dll&quot; dialog<br />
Pop $0<br />
StrCmp $0 &quot;success&quot; Done<br />
  SetErrors<br />
  StrCmp $0 &quot;back&quot; Done<br />
  ; Something else - abort the installer.<br />
    Call CleanUpAll<br />
    Quit</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lvsram</div><div class="date">17th October 2002, 22:46</div></div><div class="posttext">sorry i didn't get exactly your point.<br />
<br />
<br />
Function onCustomPage<br />
    MessageBox MB_OK &quot;start of onCustomPage 2val is $2&quot; ;first place<br />
    Exch $2<br />
    MessageBox MB_OK &quot;onCustomPage 2val is $2&quot; ;second place<br />
    ; Show our custom InstOpts pages.<br />
    Push &quot;$TEMP\ini$2.ini&quot;<br />
    CallInstDll &quot;$TEMP\InstOpts.dll&quot; dialog<br />
    Pop $2<br />
    StrCmp $2 &quot;success&quot; Done<br />
    SetErrors<br />
    StrCmp $2 &quot;back&quot; Done<br />
    ; Something else - abort the installer.<br />
    MessageBox MB_OK &quot;onCustomPage 2val in between is $2&quot; ;third place<br />
    Call Cleanup<br />
    Quit<br />
  <br />
  Done:<br />
    MessageBox MB_OK &quot;onCustomPage 2val is $2&quot; ; fourth place<br />
    Pop $2<br />
  FunctionEnd<br />
<br />
<br />
you mean to say to put the checking lines after StrCmp $2 &quot;back&quot; Done<br />
Thank you very much</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">17th October 2002, 23:00</div></div><div class="posttext">After you call Exch $2 the page number is in $2 as long as you don't override it with Pop $2 in your example. Just pop the result to somewhere other than $2 ($0 for example) and then you should have the page letter during the whole function untill Pop $2.<br />
<br />
If for example you want to save in $R0 the result of the first IO page and then according to it show or not show the second page use:<br />
Function onCustomPage<br />
  Exch $0<br />
  Push $1<br />
  ; Show our custom InstOpts pages.<br />
  StrCmp $0 &quot;B&quot; 0 +2 ; second page<br />
    ; // if value of $R0 from last page is<br />
    ; // &quot;don't show&quot; then don't show<br />
    StrCmp $R0 &quot;don't show&quot; Done <br />
<br />
  Push &quot;$TEMP\\ini$0.ini&quot;<br />
  CallInstDll &quot;$TEMP\\instopts.dll&quot; dialog<br />
  Pop $1<br />
  StrCmp $1 &quot;success&quot; ReadData<br />
    SetErrors<br />
    StrCmp $1 &quot;back&quot; ReadData<br />
      ; Something else - abort the installer.<br />
      Call CleanUpAll<br />
      Quit<br />
<br />
ReadData:<br />
  StrCmp $0 &quot;A&quot; 0 +2 ; first page<br />
    ReadINIStr $R0 &quot;$TEMP\\ini$0.ini&quot; &quot;Field 5&quot; State<br />
  ; else delete $R0 contents<br />
  StrCpy $R0 &quot;&quot;<br />
<br />
Done:<br />
  Pop $1<br />
  Pop $0<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lvsram</div><div class="date">21st October 2002, 16:25</div></div><div class="posttext">Hi Kichik, <br />
Thank you very much for fast replies.<br />
Sorry to ask you the same question again and again.<br />
As i am new and weak in push and pop knowledge, i feel so confused.<br />
Please help me . I almost done my installation things 80% and when i complete this  other 20% which is data validation, i will be done for now.<br />
<br />
I used the above code and it is not stopping at the first page still it is going to second page. This is the change i made to your code.<br />
One more thing exactly i don't know how to control the pages like <br />
there is a text field in page1 and i want to check that when the user is going to next page, and when the user is going to third page , i want to check a field in second page.<br />
Second thing is i want to fill one field in a page explicitly myself<br />
using writeInistr, i feel good place is after calling CallInstDll .<br />
Please tell me the correct place.<br />
Please make changes to the below code in your reply.<br />
<br />
Thank you very much.<br />
<br />
<br />
Function onCustomPage<br />
  MessageBox MB_OK &quot;[0]start of onCustomPage before exch ,2val is $2&quot; ;first place<br />
  Exch $2<br />
  MessageBox MB_OK &quot;[0]onCustomPage after exch ,2val is $2&quot; <br />
  <br />
  ; Show our custom InstOpts pages.<br />
  StrCmp $2 &quot;B&quot; 0 +2 ; second page<br />
    ; // if value of $R9 from last page is<br />
    ; // &quot;don't show&quot; then don't show<br />
    StrCmp $R9 &quot;don't show&quot; Done <br />
<br />
  Push &quot;$TEMP\myini$0.ini&quot;<br />
  CallInstDll &quot;$TEMP\instopts.dll&quot; dialog<br />
  Pop $2<br />
  StrCmp $2 &quot;success&quot; ReadData<br />
    SetErrors<br />
    StrCmp $2 &quot;back&quot; ReadData<br />
      ; Something else - abort the installer.<br />
      Call Cleanup<br />
      Quit<br />
<br />
ReadData:<br />
  StrCmp $2 &quot;A&quot; 0 +2 ; first page<br />
    ReadINIStr $3 &quot;$TEMP\myini$2.ini&quot; &quot;Field 8&quot; State<br />
    StrCmp $3 &quot;&quot; 0 +2<br />
    StrCpy $R9 &quot;don't show&quot;<br />
  ; else delete $R9 contents<br />
  StrCpy $R9 &quot;&quot;<br />
<br />
Done:<br />
  Pop $2<br />
FunctionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lvsram</div><div class="date">23rd October 2002, 17:26</div></div><div class="posttext">Hi any body,<br />
please help me.<br />
Thank you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">24th October 2002, 22:48</div></div><div class="posttext">Second thing is i want to fill one field in a page explicitly myself using writeInistr, i feel good place is after calling CallInstDll. Please tell me the correct place.<br />
<br />
If you want the change to be visible to the user you have to make the change before you call the DLL that will parse the INI file. If you do it after you call the DLL it will not show it.<br />
<br />
I have attached a correct script, I will explain about it later if you want, just tell me what you don't understand.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lvsram</div><div class="date">25th October 2002, 17:16</div></div><div class="posttext">Hi Kichik,<br />
Thank you very much for help.<br />
I have copied your coded and tried, but this has small problem.<br />
Go to  First ini<br />
Click next button<br />
  checking validity of the field in first ini<br />
  if the user left the field in first ini blank then i don't want to proceed forward to any page but keep him in same page. this is similar to all 3 ini pages.<br />
When i copied your code this is helping not to go to second ini page but going to third ini page.<br />
If you want i can send you my nsi and ini files.<br />
<br />
Thank you very much<br />
<br />
the code you sent and i made a change at one line <br />
                                       StrCmp $3 &quot;&quot; DontShow Show<br />
<br />
;...<br />
  StrCmp $3 &quot;&quot; DontShow Show<br />
;...<br />
<br />
no need to rewrite the whole script, only one line has changed... kichik</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">25th October 2002, 18:29</div></div><div class="posttext">Use IO's MinLen, MaxLen and ValidateText fields to do the trick. Read more about it in the InstallOptions readme.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lvsram</div><div class="date">25th October 2002, 22:21</div></div><div class="posttext">Thank you. I did the above changes checking minlength.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>