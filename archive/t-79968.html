<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" XP user level install?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  XP user level install? NSIS Discussion" />
	
	<title> XP user level install? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  XP user level install?</div>
<hr />
<div class="pda"><a href="t-79968.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=79968">XP user level install?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Pomflain</div><div class="date">21st March 2002, 00:45</div></div><div class="posttext">Tried installing from a &quot;restricted&quot; user on my XP box here.  It appears the .onInit can run because it detects that an old version is installed,  but then can't load the uninstaller.  I tried uninstalling it from the add/remove software and it said I lacked the permissions to modify the add/remove settings.  What happens if you run an installer that doesn't have anything going on in .onInit is it just quits.  Same things happens in the installer if it detects an old version and you say not to uninstall.<br />
<br />
So I'm wondering if there's a way I can detect if the user has the proper access level to run the installer.  At least so I can give an error message that says something.  Better than just having the installer quit without giving any indication that it even ran at all.<br />
<br />
Any suggestions would be appreciated.<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DuaneJeffers</div><div class="date">21st March 2002, 00:52</div></div><div class="posttext">If it a restricted user, then they shouldn't be able to install something. They would have to get permission. That is why there is a restricted user that can not download anything and install it.<br />
<br />
-Duane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pomflain</div><div class="date">21st March 2002, 01:54</div></div><div class="posttext">However if they run the installer,  nothing happens.  It runs,  but just quits instantly.  Not sure why .onInit will run,  perhaps it doesn't detect that the program is running until it hits the ShowWindow,  not really sure.  I'm just wondering if there's a way to detect that they can't install because they don't have permissions so I can give them a dialog telling them such.  Otherwise might end up with e-mails saying the installers just quit when the problem is that they are running as a restricted user and never mentioned that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pomflain</div><div class="date">21st March 2002, 17:48</div></div><div class="posttext">In .onInit try to write to the registry,  that should fail since the registry should be locked down.  Display a message saying that they probably don't have permissions to install the program and prompt them to quit or continue.<br />
<br />
Will that work with the desired effect,  or am I going to get some false positives in doing so?<br />
<br />
Thanks.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>