<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Problems with Windows Installer, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Problems with Windows Installer NSIS Discussion" />
	
	<title> Problems with Windows Installer [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Problems with Windows Installer</div>
<hr />
<div class="pda"><a href="t-329282.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=329282">Problems with Windows Installer</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">AndreasD</div><div class="date">4th April 2011, 02:57</div></div><div class="posttext">I'm new to NSIS and have run into a problem installing the Windows installer WindowsInstaller-KB893803-v2-x86 from my NSIS script.<br />
<br />
I've tried a number of variations on the command line switches to install silently and suppress the reboot, but I always end up with with the final screen asking whether I want to reboot (with the skip reboot tick box unticked)<br />
<br />
Here are some of the variations:<br />
<br />
Execwait '&quot;WindowsInstaller-KB893803-v2-x86.exe&quot; /quiet /norestart' $0<br />
Execwait 'WindowsInstaller-KB893803-v2-x86.exe /quiet /norestart' $0<br />
Execwait 'WindowsInstaller-KB893803-v2-x86.exe /q /z' $0<br />
<br />
<br />
Thanks for any help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">4th April 2011, 07:10</div></div><div class="posttext">I assume the correct command is:<br />
ExecWait '&quot;WindowsInstaller-KB893803-v2-x86.exe&quot; /quiet /norestart' $0<br />
<br />
Did you checked the result in $0?<br />
Is it ERROR_SUCCESS or ERROR_SUCCESS_REBOOT_REQUIRED ??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jpderuiter</div><div class="date">4th April 2011, 07:29</div></div><div class="posttext">Try:<br />
Execwait 'WindowsInstaller-KB893803-v2-x86.exe /passive /norestart' $0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndreasD</div><div class="date">4th April 2011, 23:10</div></div><div class="posttext">Thanks for the replies.<br />
<br />
T.Slappy : It does return  ERROR_SUCCESS_REBOOT_REQUIRED but the WindowsInstaller is displaying the reboot screen (ie it ignores the /quiet switch)<br />
<br />
jpderuiter: I just tried that an it still asks if I want to reboot. It seems to ignore the request for a quiet/passive install.<br />
<br />
Is there a way to tick the 'do not reboot' box in 'WindowsInstaller-KB893803-v2-x86.exe?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">5th April 2011, 03:04</div></div><div class="posttext">I do this, and there is no window asking for a reboot. No WindowsInstaller UI appears at all for either of the two files shown here.<br />
	# WindowsInstaller 3.1, VisualC redistributable components<br />
	ClearErrors<br />
	ReadRegStr $R0 HKLM &quot;${UNINSTALL_KEY}\{9A25302D-30C0-39D9-BD6F-21E6EC160475}&quot; &quot;DisplayVersion&quot;<br />
	${If} ${Errors}<br />
		DetailPrint &quot;Extract: VCRedist_x86.exe&quot;<br />
		SetDetailsPrint none<br />
		SetOutPath $PLUGINSDIR<br />
		File &quot;${SCC_LIB}\WindowsInstaller-KB893803-v2-x86.exe&quot;<br />
		File &quot;${SCC_LIB}\vc_red.msi&quot;<br />
		File &quot;${SCC_LIB}\vc_red.cab&quot;<br />
<br />
		SetDetailsPrint both<br />
			DetailPrint &quot;Execute: WindowsInstaller-KB893803-v2-x86.exe&quot;<br />
		SetDetailsPrint none<br />
		ExecWait '&quot;$PLUGINSDIR\WindowsInstaller-KB893803-v2-x86.exe&quot;  /quiet /norestart'<br />
<br />
		SetDetailsPrint both<br />
			DetailPrint &quot;Execute: VCRedist_x86.exe&quot;<br />
		SetDetailsPrint none<br />
		ExecWait '&quot;$SYSDIR\msiexec.exe&quot; /i $PLUGINSDIR\vc_red.msi /qn /norestart'<br />
	${EndIf}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndreasD</div><div class="date">5th April 2011, 06:57</div></div><div class="posttext">demiller9: <br />
Thanks very much for the code, that fixed my problem. <br />
<br />
The bit that made it work was that WindowsInstaller... needed to be included in the NSIS installer package and ruinning it from $PLUGINSDIR, otherwise the /quiet switch didn't work</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>