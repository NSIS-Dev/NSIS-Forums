<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" InstDrv plug-in 64 bit, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  InstDrv plug-in 64 bit NSIS Discussion" />
	
	<title> InstDrv plug-in 64 bit [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  InstDrv plug-in 64 bit</div>
<hr />
<div class="pda"><a href="t-313846.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=313846">InstDrv plug-in 64 bit</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">yz6307</div><div class="date">15th October 2009, 12:12</div></div><div class="posttext">hi,<br />
<br />
I want my installer to enable to install 64 bit hardware drivers on 64 bit system. But &quot;InstDrv plug-in&quot; web page says the plug-in does not work to install drivers on a 64-bit Windows version. <br />
<br />
So is there a solution to install drivers on 64 bit system?<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yz6307</div><div class="date">15th October 2009, 23:22</div></div><div class="posttext">Can anyone help meï¼Ÿ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cowwoc</div><div class="date">16th October 2009, 00:48</div></div><div class="posttext">Originally posted by yz6307 <br />
Can anyone help meï¼Ÿ  <br />
<br />
I'm wondering the same thing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">yz6307</div><div class="date">19th October 2009, 10:09</div></div><div class="posttext">no solutionï¼Ÿ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AxelMock</div><div class="date">30th October 2009, 11:16</div></div><div class="posttext">Originally posted by yz6307 <br />
no solutionï¼Ÿ  <br />
<br />
Yes and no.<br />
<br />
I had the same problem, as I needed to write an installer for hardware device drivers for 32bit and 64bit OSes.<br />
<br />
Microsoft recommends using DIFxAPI. DIFx is a nice framework with just 4 or 5 DLL functions to install/uninstall a driver.<br />
For the 32bit version it's not too difficult to do the calls using the System plugin. <br />
64bit: The 32bit installer CANNOT call any function in a 64bit DLL. There's definitely no trick or workaround for that!<br />
<br />
So I ended up writing a wrapper EXE for DIFxAPI to be compiled twice by WINDKK, one for 32bit (Win2K buildenv) and one for 64bit (W2K3 64 buildenv) and calling the appropriate exe from my installer. The 64bit exe then calls the 64bit version of DIFxAPI.<br />
<br />
Meanwhile the little wrapper does everything else/special we need to install/uninstall our drivers.<br />
Sorry that I cannot share this code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AxelMock</div><div class="date">30th October 2009, 11:48</div></div><div class="posttext">I forgot to mention that Microsoft has a nice little example of how to use DIFxAPI which can be used to build such a 32/64 bit application in the Windows DDK.<br />
<br />
c:\WinDDK\7600.16385.0\src\setup\DIFxAPI\DIFxCmd\<br />
<br />
IMHO: Two functionality need to be added: ScanForHWChange<br />
(Scan for Hardware changes, CM_Reenumerate_DevNode_Ex) like in the Device Manager and WaitWhileInstallationInProgess (CMP_WAITNOPENDINGINSTALLEVENTS_PROC from cfgmgr32.dll)<br />
<br />
Vista (and above) provide the little command line tool pnputil.exe to enumerate, install and uninstall driver packages. Can nicely be called from NSIS.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>