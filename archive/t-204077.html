<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" SetShellVarContext at runtime, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  SetShellVarContext at runtime NSIS Discussion" />
	
	<title> SetShellVarContext at runtime [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  SetShellVarContext at runtime</div>
<hr />
<div class="pda"><a href="t-204077.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=204077">SetShellVarContext at runtime</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">LIGHTNING UK!</div><div class="date">6th January 2005, 17:38</div></div><div class="posttext">I'm looking to give users of my program the choice of creating shortcuts under 'All Users' or just their user.<br />
<br />
Some installers I've seen have a dedicated page for this where it offers choices of 'Everyone' &amp; 'Just Me' - I'm sure you know what I'm getting at!<br />
<br />
Anyway, I'm not so hot on making custom pages so I was going to settle with a simple MessageBox asking them how they'd like to proceed.<br />
<br />
Section &quot;Main Program Files&quot; SecCore<br />
  SectionIn 1 RO<br />
<br />
  SetOutPath &quot;$INSTDIR&quot;<br />
  File &quot;DVDDecrypter.exe&quot;<br />
  File &quot;ReadMe.txt&quot;<br />
<br />
  SetOutPath &quot;$INSTDIR\Sounds&quot;<br />
  File &quot;Sounds\Success.wav&quot;<br />
  File &quot;Sounds\Error.wav&quot;<br />
<br />
  MessageBox MB_YESNO|MB_ICONQUESTION &quot;Would you like to create shortcuts for all users instead of just yourself?&quot; IDYES ShortcutsAllUsers IDNO ShortcutsJustMe<br />
  ShortcutsAllUsers:<br />
    SetShellVarContext all<br />
  ShortcutsJustMe:<br />
    SetShellVarContext current<br />
  ShortcutsConfigured:<br />
    <br />
  CreateDirectory &quot;$SMPROGRAMS\DVD Decrypter&quot;<br />
  CreateShortCut &quot;$SMPROGRAMS\DVD Decrypter\Uninstall.lnk&quot; &quot;$INSTDIR\uninstall.exe&quot; &quot;&quot; &quot;$INSTDIR\uninstall.exe&quot; 0<br />
  CreateShortCut &quot;$SMPROGRAMS\DVD Decrypter\DVD Decrypter.lnk&quot; &quot;$INSTDIR\DVDDecrypter.exe&quot; &quot;&quot; &quot;$INSTDIR\DVDDecrypter.exe&quot; 0<br />
  CreateShortCut &quot;$SMPROGRAMS\DVD Decrypter\DVD Decrypter Read Me.lnk&quot; &quot;$INSTDIR\ReadMe.txt&quot; &quot;&quot; &quot;$INSTDIR\ReadMe.txt&quot; 0<br />
SectionEnd<br />
<br />
<br />
That's what I'd had in mind but it doesnt work. Has anyone already done what I'm trying to achieve?<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pengyou</div><div class="date">6th January 2005, 17:53</div></div><div class="posttext">If &quot;all users&quot; is selected, you need to jump over the &quot;current user&quot; option:ShortcutsAllUsers:<br />
    SetShellVarContext all<br />
    Goto MakeShortcuts<br />
ShortcutsJustMe:<br />
    SetShellVarContext current<br />
MakeShortcuts:<br />
    (insert your CreateShortcut commands here)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LIGHTNING UK!</div><div class="date">6th January 2005, 18:15</div></div><div class="posttext">Wouldn't you know it would be something simple like that!<br />
<br />
Next problem is that the $QUICKLAUNCH variable doesnt seem to goto the 'All Users' folder - but then I'm not sure if that folder exists / works like that anyway.<br />
<br />
Many Thanks :)</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>