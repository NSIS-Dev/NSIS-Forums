<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" vcredist sometimes hangs or loops on Windows 7, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  vcredist sometimes hangs or loops on Windows 7 NSIS Discussion" />
	
	<title> vcredist sometimes hangs or loops on Windows 7 [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  vcredist sometimes hangs or loops on Windows 7</div>
<hr />
<div class="pda"><a href="t-331845.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=331845">vcredist sometimes hangs or loops on Windows 7</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Oogst</div><div class="date">24th June 2011, 10:40</div></div><div class="posttext">I have made an installer using NSIS and it turns out that for some Windows 7 users (I estimate about 1% of the total) the vcredist installation hangs or even enters an infinite loop where it starts over and over again. Why is this happening and how can I fix this?<br />
<br />
The vcredist_x86.exe I am installing is from Visual Studio 2005. It also seems to somehow happen with one of my own programs that I run after that. This is the relevant part of the installer:<br />
<br />
ExecWait &quot;VCRedist\vcredist_x86.exe /Q&quot;<br />
ExecWait &quot;Proun.exe CONNECTIONTEST&quot;<br />
<br />
I have not seen this happening myself, but several users have reported this to me on my support forum. Does anyone know how to fix this?<br />
<br />
Thanks in advance!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">24th June 2011, 16:33</div></div><div class="posttext">I'm not saying that it is going to fix the problem, but you should execute with full path and correct quotes:<br />
ExecWait '&quot;$pluginsdir\VCRedist\vcredist_x86.exe&quot; /Q'</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Oogst</div><div class="date">24th June 2011, 19:58</div></div><div class="posttext">I can change that, but I strongly doubt it will help, because it is running the file, and even recognizing the /Q, since it runs automatically. I guess this couldn't cause repeated runs of the ExecWait, right?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">demiller9</div><div class="date">24th June 2011, 23:05</div></div><div class="posttext">In my installer I embed the vc redistributable, but I have extracted it beforehand and call it like this:SetOutPath $PLUGINSDIR<br />
File &quot;${LIB}\vc_red.msi&quot;<br />
File &quot;${LIB}\vc_red.cab&quot;<br />
DetailPrint &quot;Execute: VCRedist_x86.exe&quot;<br />
ExecWait '&quot;$SYSDIR\msiexec.exe&quot; /i $PLUGINSDIR\vc_red.msi /qn /norestart'<br />
Use the -x switch to extract the contents of VCRedist_x86 without installing it.<br />
<br />
Don<br />
<br />
Edit: specify the switch that extracts the contents without installing the package.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">msroboto</div><div class="date">24th June 2011, 23:07</div></div><div class="posttext">I doubt it will make much difference but this is what I use to install vcredist.<br />
<br />
 nsExec::ExecToStack &quot;vcredist_x86.exe /Q&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MSG</div><div class="date">25th June 2011, 11:12</div></div><div class="posttext">Are you sure the problem also occurs for your proun.exe? You should ask (one of) the affected users to run a quick test installer that only tries to install vcredist. Add some messageboxes with debug info if applicable. You need to isolate the cause of the problem, so start with the simplest and work your way up.<br />
<br />
If it's only vcredist that's looping, you might want to create a minimum installer that shows the problem and pass that to microsoft support.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">T.Slappy</div><div class="date">25th June 2011, 12:49</div></div><div class="posttext">I suppose this error is somehow related to 64bit VC Redist because on X86 installation is much smoother...<br />
BTW: fix this line:<br />
ExecWait &quot;Proun.exe CONNECTIONTEST&quot;<br />
<br />
This command launches PROUN.exe [the installer!!!] not the game app with name &quot;Proun.exe&quot; which is really annoying because everyone installs the game twice!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>