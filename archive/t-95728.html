<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" VB Runtimes, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  VB Runtimes NSIS Discussion" />
	
	<title> VB Runtimes [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  VB Runtimes</div>
<hr />
<div class="pda"><a href="t-95728.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=95728">VB Runtimes</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">HelluvaEngineer</div><div class="date">25th July 2002, 21:57</div></div><div class="posttext">I'm trying to figure out the most seamless way to integrate the VB runtimes into my installation.  <br />
<br />
I set it up so that it would launch the Microsoft installer using the &quot;ExecWait  /Q&quot; option.  That worked, but on machines that actually needed the update, it prompted to reboot.  Even if I did this last, I would still prefer that the user not reboot in the middle of an installation.  Perhaps I could wait till the end and just use &quot;Exec&quot;, but then I can't clean up the temp file I extracted.<br />
<br />
What are my other options?  Bundle the individual .DLLs and check versions on each to decide whether I should upgrade?  I had even thought of creating a download link and launching that if the user needs the upgrade (thereby shrinking the install by 1 MB).<br />
<br />
Any advice?  Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DuaneJeffers</div><div class="date">26th July 2002, 09:05</div></div><div class="posttext">Very Simple .... At the End of the install of your program, run the vbRuntimes installer. Have it something like (IF the installer is autoclose) running a pop saying the user needs to update and once the user clicks ok, then the installer for your program quits and launches the installer for the vbRuntimes. This is usually what games do for the upgrade of DirectX or OpenGL.<br />
<br />
-Duane</div></div><hr />


<div class="post"><div class="posttop"><div class="username">HelluvaEngineer</div><div class="date">26th July 2002, 15:10</div></div><div class="posttext">Ok, I'm down with that plan.  However, I see one glitch.  How do I clean up the M$ executable, since the installer will have already exited?  I would prefer to not leave ~1MB of junk in the $TEMP directory, unless there's no other way.<br />
<br />
EDIT:  I just realized this won't work.  I need to launch a VB app (an Audio Setup Wizard) before or immediately after the installer.  It has a dependency on the VB runtimes.  So, this would require launching the runtime installer first and THEN run the wizard.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th July 2002, 15:33</div></div><div class="posttext">You can also extract the VB runtimes from the file and install them using NSIS (with the UpgradeDLL macro).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">HelluvaEngineer</div><div class="date">26th July 2002, 19:04</div></div><div class="posttext">I guess that's what I need to do, then.  Do I need to bother with any of that Shared DLL registry stuff?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joost Verburg</div><div class="date">26th July 2002, 21:11</div></div><div class="posttext">Yes, you should use the UpgradeDLL macro for upgrading the VB DLL's.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">By-Gones</div><div class="date">8th August 2002, 01:00</div></div><div class="posttext">I had the same vb-runtime-problem. Here's my solution:<br />
<br />
For the completly silent install of the vbrun60sp5.exe, you need the command line option /Q /R:N for the microsoft file so there is never a restart:<br />
ExecWait &quot;$INSTDIR\VBRUN60SP5.EXE /Q /R:N&quot;<br />
<br />
After that, you can clean the temporary file.<br />
Then, at the end of the installation, you call something like this:<br />
MessageBox MB_YESNO|MB_ICONQUESTION &quot;Do you want to restart Windows?&quot; IDNO NoRestart<br />
Reboot<br />
NoRestart:<br />
...<br />
<br />
You also can call this in the .onInstSuccess - function, so it's really at the end.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tscherno</div><div class="date">30th August 2002, 06:33</div></div><div class="posttext">Originally posted by HelluvaEngineer <br />
I had even thought of creating a download link and launching that if the user needs the upgrade (thereby shrinking the install by 1 MB).<br />
<br />
This sounds very interesting. How could it be done?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th August 2002, 09:36</div></div><div class="posttext">Either use ExecShell &quot;open&quot; &quot;http://www.whatever.com/downloadthis.exe&quot; or just use NSIS-dl.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tscherno</div><div class="date">30th August 2002, 11:47</div></div><div class="posttext">And how can I check if a specific version of the vb-runtime is installed?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">30th August 2002, 11:53</div></div><div class="posttext">Using GetDLLVersion or Sunjammer's SysDLL</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>