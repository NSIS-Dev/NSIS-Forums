<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Add/Remove not initialising uninstaller?, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Add/Remove not initialising uninstaller? NSIS Discussion" />
	
	<title> Add/Remove not initialising uninstaller? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Add/Remove not initialising uninstaller?</div>
<hr />
<div class="pda"><a href="t-288733.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=288733">Add/Remove not initialising uninstaller?</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">hungryOrb</div><div class="date">19th March 2008, 18:52</div></div><div class="posttext">Ehm.. I thought that using add/remove would initialise the uninstaller, but it didnt, instead it simply removed the program entry there. Is there a link I can perhaps read, or might someone know why this happens?<br />
<br />
Thanks if any help ;]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">19th March 2008, 19:10</div></div><div class="posttext">Sounds like your uninstaller path is set wrong in the registry.<br />
<br />
Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hungryOrb</div><div class="date">20th March 2008, 11:15</div></div><div class="posttext">Thanks for reply :]<br />
<br />
This is what I have:<br />
<br />
!define PRODUCT_DIR_REGKEY &quot;Software\Microsoft\Windows\CurrentVersion\App Paths\DracoSSC.exe&quot;<br />
!define PRODUCT_UNINST_KEY &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}&quot;<br />
!define PRODUCT_UNINST_ROOT_KEY &quot;HKLM&quot;<br />
!define PRODUCT_STARTMENU_REGVAL &quot;NSIS:StartMenuDir&quot;<br />
<br />
and:<br />
<br />
Section -Post<br />
  WriteUninstaller &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr HKLM &quot;${PRODUCT_DIR_REGKEY}&quot; &quot;&quot; &quot;$INSTDIR\DracoSSC.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayName&quot; &quot;$(^Name)&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;UninstallString&quot; &quot;$INSTDIR\uninst.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayIcon&quot; &quot;$INSTDIR\DracoSSC.exe&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;DisplayVersion&quot; &quot;${PRODUCT_VERSION}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;URLInfoAbout&quot; &quot;${PRODUCT_WEB_SITE}&quot;<br />
  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot; &quot;Publisher&quot; &quot;${PRODUCT_PUBLISHER}&quot;<br />
SectionEnd<br />
<br />
Please could you perhaps offer how this could be wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">20th March 2008, 11:27</div></div><div class="posttext">What about the uninstall section?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hungryOrb</div><div class="date">20th March 2008, 11:39</div></div><div class="posttext">After that last section, only this remains:<br />
<br />
Function un.onUninstSuccess<br />
  HideWindow<br />
  MessageBox MB_ICONINFORMATION|MB_OK &quot;$(^Name) was successfully removed from your computer.&quot;<br />
FunctionEnd<br />
<br />
Function un.onInit<br />
  MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 &quot;Are you sure you want to completely remove $(^Name) and all of its components?&quot; IDYES +2<br />
  Abort<br />
FunctionEnd<br />
<br />
Section Uninstall<br />
  !insertmacro MUI_STARTMENU_GETFOLDER &quot;Application&quot; $ICONS_GROUP<br />
  Delete &quot;$INSTDIR\${PRODUCT_NAME}.url&quot;<br />
  Delete &quot;$INSTDIR\uninst.exe&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\stdole2.tlb&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\olepro32.dll&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\oleaut32.dll&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\msvbvm60.dll&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\COMCAT.DLL&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\asycfilt.dll&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\scrrun.dll&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\richtx32.ocx&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\msvcr71.dll&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\MSMASK32.OCX&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\MSMAPI32.OCX&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\MSINET.OCX&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\MSHFLXGD.OCX&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\MSFLXGRD.OCX&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\MSCOMCTL.OCX&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\MSCOMCT2.OCX&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\msado25.tlb&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\hhctrl.ocx&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\FM20.DLL&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\COMDLG32.OCX&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\COMCT332.OCX&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\myodbc3S.lib&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\myodbc3S.dll&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\myodbc3m.exe&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\myodbc3i.exe&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\myodbc3c.exe&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\myodbc3.lib&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\myodbc3.hlp&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\myodbc3.gid&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\myodbc3.fts&quot;<br />
  Delete &quot;$WINDIR\System\TestFolder1\myodbc3.dll&quot;<br />
  Delete &quot;$INSTDIR\zip32.dll&quot;<br />
  Delete &quot;$INSTDIR\WinSubHook.tlb&quot;<br />
  Delete &quot;$INSTDIR\User Modules\_dmd syntax.txt&quot;<br />
  Delete &quot;$INSTDIR\Updates.txt&quot;<br />
  Delete &quot;$INSTDIR\UpdateInProgress.exe&quot;<br />
  Delete &quot;$INSTDIR\unzip32.dll&quot;<br />
  Delete &quot;$INSTDIR\SSubTmr6.dll&quot;<br />
  Delete &quot;$INSTDIR\MSDERUN.DLL&quot;<br />
  Delete &quot;$INSTDIR\Modules\Verifier\verifier.cmd&quot;<br />
  Delete &quot;$INSTDIR\Modules\TestJet.dmd&quot;<br />
  Delete &quot;$INSTDIR\Modules\TestJet\TestJet.exe&quot;<br />
  Delete &quot;$INSTDIR\Modules\DracoSSC.DDF&quot;<br />
  Delete &quot;$INSTDIR\Modules\CommandPrompt.dmd&quot;<br />
  Delete &quot;$INSTDIR\Modules\CommandPrompt\CommandPrompt.exe&quot;<br />
  Delete &quot;$INSTDIR\LanguageSelector.exe&quot;<br />
  Delete &quot;$INSTDIR\LanguageEditor.exe&quot;<br />
  Delete &quot;$INSTDIR\langs.dat&quot;<br />
  Delete &quot;$INSTDIR\KDateBox.ocx&quot;<br />
  Delete &quot;$INSTDIR\Images\WelcomeBitMap.bmp&quot;<br />
  Delete &quot;$INSTDIR\Images\update.avi&quot;<br />
  Delete &quot;$INSTDIR\Images\Thumbs.db&quot;<br />
  Delete &quot;$INSTDIR\Images\splash.jpg&quot;<br />
  Delete &quot;$INSTDIR\Images\pocn.jpg&quot;<br />
  Delete &quot;$INSTDIR\Images\po.jpg&quot;<br />
  Delete &quot;$INSTDIR\Images\logonbg.jpg&quot;<br />
  Delete &quot;$INSTDIR\Images\lockbg.jpg&quot;<br />
  Delete &quot;$INSTDIR\Images\Floorplan.jpg&quot;<br />
  Delete &quot;$INSTDIR\Images\dragon.jpg&quot;<br />
  Delete &quot;$INSTDIR\Images\confail.jpg&quot;<br />
  Delete &quot;$INSTDIR\Icons\Thumbs.db&quot;<br />
  Delete &quot;$INSTDIR\Icons\SupplierX.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\SupplierO.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\Supplier.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\StockX.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\StockO.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\Stock.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\QuoteX.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\QuoteO.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\Quote.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\OrderX.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\OrderO.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\Order.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\JobX.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\JobO.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\Job.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\Dragon.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\CustomerX.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\CustomerO.ico&quot;<br />
  Delete &quot;$INSTDIR\Icons\Customer.ico&quot;<br />
  Delete &quot;$INSTDIR\ezVidC60.ocx&quot;<br />
  Delete &quot;$INSTDIR\DracoUpdate.exe&quot;<br />
  Delete &quot;$INSTDIR\DracoSSC.exe&quot;<br />
  Delete &quot;$INSTDIR\dracok.dll&quot;<br />
  Delete &quot;$INSTDIR\Dracohelp.chm&quot;<br />
  Delete &quot;$INSTDIR\DAO350.DLL&quot;<br />
<br />
  Delete &quot;$SMPROGRAMS\$ICONS_GROUP\Website.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\$ICONS_GROUP\Help.lnk&quot;<br />
  Delete &quot;$DESKTOP\Draco SSC.lnk&quot;<br />
  Delete &quot;$SMPROGRAMS\$ICONS_GROUP\Draco SSC.lnk&quot;<br />
<br />
  RMDir &quot;$WINDIR\System\TestFolder1&quot;<br />
  RMDir &quot;$SMPROGRAMS\$ICONS_GROUP&quot;<br />
  RMDir &quot;$INSTDIR\User Modules&quot;<br />
  RMDir &quot;$INSTDIR\Modules\Verifier&quot;<br />
  RMDir &quot;$INSTDIR\Modules\TestJet&quot;<br />
  RMDir &quot;$INSTDIR\Modules\CommandPrompt&quot;<br />
  RMDir &quot;$INSTDIR\Modules&quot;<br />
  RMDir &quot;$INSTDIR\Images&quot;<br />
  RMDir &quot;$INSTDIR\Icons&quot;<br />
  RMDir &quot;$INSTDIR&quot;<br />
<br />
  DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} &quot;${PRODUCT_UNINST_KEY}&quot;<br />
  DeleteRegKey HKLM &quot;${PRODUCT_DIR_REGKEY}&quot;<br />
  <br />
  ;Delete the user details in registry<br />
  DeleteRegValue HKCU &quot;Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main&quot; &quot;MySQLUser&quot;<br />
  DeleteRegValue HKCU &quot;Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main&quot; &quot;MySQLPass&quot;<br />
  DeleteRegValue HKCU &quot;Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main&quot; &quot;MySQLADDR&quot;<br />
  DeleteRegValue HKCU &quot;Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main&quot; &quot;AutoUpdatePath&quot;<br />
  DeleteRegValue HKCU &quot;Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main&quot; &quot;AutoUpdateEnable&quot;<br />
<br />
  SetAutoClose true<br />
SectionEnd<br />
<br />
Thanks for reply :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">20th March 2008, 12:00</div></div><div class="posttext">It seems you've made your installer with HM editor so normally there should be not something wrong.<br />
According to that code, you should see/react in those 2 messages boxes and what's installed should being uninstalled.<br />
Have you tried to run the uninstaller from StartMenu shortcut or directly from $INSTDIR ?<br />
Is it possible to exists an invalid character in $INSTDIR ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hungryOrb</div><div class="date">20th March 2008, 12:38</div></div><div class="posttext">Yes, is what I was thinking about the HM editor.<br />
<br />
Running the actual uninst file is fine, and seems to work perfectly. I guess the registry just doesn't know where to look for the right file?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">20th March 2008, 12:45</div></div><div class="posttext">Open regedit and check out your records. I tend to assume that there's an invalid character.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hungryOrb</div><div class="date">20th March 2008, 13:11</div></div><div class="posttext">Thanks for replies again,. <br />
There doesn't seem to be any path's to be found in the registry, in the main folder that is. None that point to an uninstaller anyways. At which point does NSIS usually inform the registry about a path to an uninst.exe file?<br />
It's not in the script directly right?<br />
<br />
Just wondering also, is there a way to use exec with a registry file? can I just somehow use a statement like this:<br />
<br />
'Execwait &quot;draco.reg&quot; $0'<br />
?<br />
<br />
Thanks for any helps ;D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">20th March 2008, 13:36</div></div><div class="posttext">Regarding to your script, you should find your records by opening regedit under HKLM Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}<br />
<br />
Yes you can execute a reg file see here,<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=249764<br />
<br />
http://forums.winamp.com/showthread.php?s=&amp;threadid=281839</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hungryOrb</div><div class="date">20th March 2008, 15:03</div></div><div class="posttext">Thankyou! :D The uninstall string is reading the correct path! So I'll just do some tests.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hungryOrb</div><div class="date">20th March 2008, 15:42</div></div><div class="posttext">Hmm.. yeah it seems to work perfectly now ._. <br />
<br />
Ehm, would you guys happen to know the auto-updating is continually checked? The app should check registry value, and the registry value is always '1'.<br />
<br />
Function CustomPage<br />
<br />
   !insertmacro MUI_HEADER_TEXT &quot;$(CUSTOM_TITLE)&quot; &quot;$(CUSTOM_SUBTITLE)&quot;<br />
   # Display the page.<br />
   !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;Custom&quot;<br />
<br />
   # Get the user entered values.<br />
   !insertmacro MUI_INSTALLOPTIONS_READ $Username &quot;Custom&quot; &quot;Field 1&quot; &quot;State&quot;<br />
   !insertmacro MUI_INSTALLOPTIONS_READ $Password &quot;Custom&quot; &quot;Field 2&quot; &quot;State&quot;<br />
   !insertmacro MUI_INSTALLOPTIONS_READ $Server &quot;Custom&quot; &quot;Field 3&quot; &quot;State&quot;<br />
   !insertmacro MUI_INSTALLOPTIONS_READ $Autoupdate &quot;Custom&quot; &quot;Field 4&quot; &quot;State&quot;<br />
   !insertmacro MUI_INSTALLOPTIONS_READ $AUpdatePath &quot;Custom&quot; &quot;Field 5&quot; &quot;State&quot;<br />
   <br />
<br />
WriteRegStr HKCU &quot;Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main&quot; &quot;MySQLUser&quot; $Username ;As per install instruction file.<br />
WriteRegStr HKCU &quot;Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main&quot; &quot;MySQLPass&quot; $Password<br />
WriteRegStr HKCU &quot;Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main&quot; &quot;MySQLADDR&quot; $Server<br />
WriteRegStr HKCU &quot;Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main&quot; &quot;AutoUpdatePath&quot; $AUpdatePath<br />
<br />
   ${If} $Autoupdate = 1 ;control is selected<br />
   WriteRegStr HKCU &quot;HKEY_CURRENT_USER\Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main&quot; &quot;AutoUpdateEnable&quot;=&quot;1&quot;<br />
   ${EndIf}<br />
   ${If} $Autoupdate = 0<br />
   WriteRegStr HKCU &quot;HKEY_CURRENT_USER\Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main&quot; &quot;AutoUpdateEnable&quot;=&quot;0&quot;<br />
   ${EndIf}<br />
<br />
FunctionEnd<br />
<br />
I thought the last set of statements would work properly.. At least the reg key is actually made.. :] I can't see someone wanting to use the installer without selecting auto-update anyways..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Red Wine</div><div class="date">20th March 2008, 18:03</div></div><div class="posttext">You must get the user entered values within custom page leave function. When you read it within create function, you're just getting the values that you've set as default.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>