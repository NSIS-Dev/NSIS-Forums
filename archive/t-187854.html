<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" UI flow control : function / label use outside sections ??, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  UI flow control : function / label use outside sections ?? NSIS Discussion" />
	
	<title> UI flow control : function / label use outside sections ?? [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  UI flow control : function / label use outside sections ??</div>
<hr />
<div class="pda"><a href="t-187854.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=187854">UI flow control : function / label use outside sections ??</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">wfredk</div><div class="date">26th July 2004, 15:17</div></div><div class="posttext">I've tried to put logic in to the NSIS script I'm writing to see if ActiveSync is installed, and to either display an error message if it's not found, or continue.  However, it seems NSIS doesn't have any support for flow control during the &quot;wizard&quot; portion of the installer, only during installation itself:  When I try to compile the script, it tells me the (jump target) labels can only be used inside a function or a section.  Sections are installation code blocks that are executed after the UI finishes.  Functions cannot be called except from inside a function or a section - so they're effectively only available in the post-UI phase, too.<br />
<br />
Is there no way to have flow control during the UI phase of NSIS operation, or am I missing something?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th July 2004, 16:06</div></div><div class="posttext">You need to insert your code into a Pre or Leave function of one of the Installer Pages.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wfredk</div><div class="date">26th July 2004, 20:12</div></div><div class="posttext">ok, that will work.  having the page code buried inside insertmacro statements makes that option rather less obvious, but now that you've pointed it out, I'm quite certain I can figure out how to do it :cool:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">26th July 2004, 21:29</div></div><div class="posttext">Well, you're using MUI right, so...<br />
<br />
<br />
!define MUI_PAGE_CUSTOMFUNCTION_PRE CheckActiveSync<br />
!insertmacro MUI_PAGE_COMPONENTS<br />
<br />
Function CheckActiveSync<br />
 ...<br />
FunctionEnd<br />
<br />
This will call the 'CheckActiveSync' function just before the Components Page.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wfredk</div><div class="date">26th July 2004, 21:42</div></div><div class="posttext">I go to the grocery store and I come back and find my code written for me!<br />
<br />
:) :) :) :)<br />
<br />
FWIW, I'll actually be putting the function call before MUI_PAGE_DIRECTORY, but that doesn't change your example significantly.<br />
<br />
Thanks, you've saved me a bunch of time!<br />
<br />
:up:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flyakite</div><div class="date">29th July 2004, 21:06</div></div><div class="posttext">Couldn't you just use:<br />
<br />
Function .onInit<br />
Call CheckActiveSync<br />
FuntionEnd</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Anders</div><div class="date">29th July 2004, 21:21</div></div><div class="posttext">Originally posted by flyakite <br />
Couldn't you just use:<br />
<br />
Function .onInit<br />
Call CheckActiveSync<br />
FuntionEnd  <br />
<br />
Not when you are using the modern ui</div></div><hr />


<div class="post"><div class="posttop"><div class="username">flyakite</div><div class="date">30th July 2004, 06:57</div></div><div class="posttext">I think you're wrong.  I'm using Modern UI, and this is in my .onInit<br />
<br />
call CheckSP1<br />
<br />
and this is my CheckSP1 function:<br />
<br />
    Function CheckSP1<br />
      ReadRegStr $R3 HKLM &quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot; CSDVersion<br />
      StrCmp $R3 &quot;Service Pack 1&quot; &quot;&quot; +2<br />
      Return<br />
      MessageBox MB_OK &quot;You do not have Windows XP Service Pack 1 installed.$\n$\n Make sure to choose the 'Extract Files Only' install type when installing.&quot;<br />
    FunctionEnd<br />
<br />
<br />
and here is code DIRECTLY in my .onInit obtained from the Archive using a jump:<br />
<br />
<br />
      System::Call 'kernel32::CreateMutexA(i 0, i 0, t &quot;72&quot;) i .r1 ?e'<br />
        Pop $R0<br />
        StrCmp $R0 0 +3<br />
        MessageBox MB_OK &quot;The installer is already running.&quot;<br />
      Abort</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iceman_k</div><div class="date">31st July 2004, 05:14</div></div><div class="posttext">flyakite is 100% correct.<br />
.onInit can most certainly be called when using MUI.<br />
It's .onGUIInit which has been taken over by MUI.<br />
In that case you have to !define MUI_CUSTOMFUNCTION_GUIINIT if you want to do any special GUI initialization steps.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Afrow UK</div><div class="date">31st July 2004, 13:54</div></div><div class="posttext">I tend not to use .onInit for long calculations or file searches etc, as the user may think the installer has crashed.<br />
If you do though, make sure you use the banner plugin to display a message.<br />
<br />
-Stu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">deguix</div><div class="date">31st July 2004, 17:25</div></div><div class="posttext">I tend not to use .onInit for long calculations or file searches etc, as the user may think the installer has crashed.<br />
If you do though, make sure you use the banner plugin to display a message.<br />
<br />
I was exactly talking about this in other forums, because I done it in the past, and so were the users complaining about the installer...</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>