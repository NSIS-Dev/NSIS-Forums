<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" NSIS 2.09 - Fails to write uninstaller/No Details/Uninstall failure, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  NSIS 2.09 - Fails to write uninstaller/No Details/Uninstall failure NSIS Discussion" />
	
	<title> NSIS 2.09 - Fails to write uninstaller/No Details/Uninstall failure [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  NSIS 2.09 - Fails to write uninstaller/No Details/Uninstall failure</div>
<hr />
<div class="pda"><a href="t-226064.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=226064">NSIS 2.09 - Fails to write uninstaller/No Details/Uninstall failure</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">MrEyes</div><div class="date">15th September 2005, 12:10</div></div><div class="posttext">Hello all,<br />
<br />
Technically this is three questions, but I didnt want to spam the board.<br />
<br />
1) I am using the following lines to write an uninstaller:<br />
<br />
Section -FinishSection<br />
  WriteRegStr HKLM \<br />
    &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAMEANDVERSION}&quot; \<br />
    &quot;DisplayName&quot; &quot;${APPNAMEANDVERSION}&quot;<br />
  WriteRegStr HKLM \<br />
    &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAMEANDVERSION}&quot; \<br />
    &quot;UninstallString&quot; &quot;$INSTDIR\uninstall.exe&quot;<br />
  WriteUninstaller &quot;$INSTDIR\uninstall.exe&quot;<br />
SectionEnd<br />
;;MessageBox MB_OK $INSTDIR<br />
<br />
The $INSTDIR is set with the following lines<br />
<br />
<br />
!define APPNAMEANDVERSION &quot;MyApp_1.0.2.4_SB_SIAC&quot;<br />
InstallDir &quot;$PROGRAMFILES\${APPNAMEANDVERSION}&quot;<br />
<br />
<br />
When the installer runs the necessary registry keys are created so the section is being hit, but the unistaller executable is not created.  If I enabled the MessageBox line in the finish section this displays a valid path.<br />
<br />
Interestingly if I code the unistaller path to be c:\uninstall.exe this works fine and the unistaller is written.  Which leads onto question 2.<br />
<br />
2) My installer generates and unistall executable in C:\ when I attempt to execute this file I get the following error:<br />
<br />
NSIS Error<br />
Error launching installer<br />
<br />
I cant find any further information on this error in the operating system logs, google searches show lots of people reporting the error but few solutions. Can anybody point me in the right direction?<br />
<br />
3) And the third and final question, for some reason while the installer is working if I click the &quot;Show Details&quot; button it doesnt show any details.<br />
<br />
I have played with the ShowInstDetails command, but this seems to enable or disable the option to show details rather than enable/disable the generation of details<br />
<br />
And that folks is about it, thanks in advance for any guidance offered on finding a solution to these problems</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">15th September 2005, 19:11</div></div><div class="posttext">Are you sure $INSTDIR exists when you call WriteUninstaller?<br />
<br />
An uninstaller will not run from a root of a drive, unless AllowRootDirInstall is enabled.<br />
<br />
As for the details problem, a complete example is needed. Without it, all I can suggest is that you search for SetDetailsPrint calls.</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>