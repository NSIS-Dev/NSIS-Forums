<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" InstallOptions fields &quot;move&quot; with different DPIs, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  InstallOptions fields &quot;move&quot; with different DPIs NSIS Discussion" />
	
	<title> InstallOptions fields &quot;move&quot; with different DPIs [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  InstallOptions fields &quot;move&quot; with different DPIs</div>
<hr />
<div class="pda"><a href="t-275299.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=275299">InstallOptions fields &quot;move&quot; with different DPIs</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">arantius</div><div class="date">2nd August 2007, 22:05</div></div><div class="posttext">I've set up a page with InstallOptions.dll to involve some paragraphs of text with links embedded right in the middle of them, like you see all over the web.<br />
<br />
I did it by placing the paragraph in full as a label, then positioning a link field of *just* the right size and position to cover up the word that it is &quot;turning into&quot; a link.<br />
<br />
Problem is, even though the docs for IO.dll say that it handles different DPI settings, it doesn't.<br />
<br />
I've attached a file that contains an installer script based on the example included with NSIS, and screenshots of the resulting executable running at 96 and 120 dpi.  In 120, the word &quot;link&quot; is off to the left of where it should be, though the position is perfect at the (default) 96 dpi.<br />
<br />
I've searched the forum for just &quot;DPI&quot; and can only find it mentioned in passing.  Am I doing something wrong?  Can I fix this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">3rd August 2007, 18:02</div></div><div class="posttext">It handles different DPIs by using dialog units for sizes instead of pixels. This way, when you switch to another DPI, you don't have to recalculate how many pixels you need. However, this calculation is not good enough to aim at exactly one letter out a complete sentence as a dialog unit or even a pixel doesn't have a high enough resolution.<br />
<br />
You can calculate the exact location with GetTextExtentPoint32.!insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;ioA.ini&quot;<br />
Pop $7<br />
<br />
!insertmacro MUI_INSTALLOPTIONS_READ $8 &quot;ioA.ini&quot; &quot;Field 1&quot; &quot;HWND&quot;<br />
!insertmacro MUI_INSTALLOPTIONS_READ $9 &quot;ioA.ini&quot; &quot;Field 3&quot; &quot;HWND&quot;<br />
<br />
System::Call user32::GetDC(ir9)i.r0<br />
<br />
SendMessage $9 ${WM_GETFONT} 0 0 $1<br />
System::Call gdi32::SelectObject(ir0,ir1)<br />
<br />
StrCpy $1 &quot;link&quot;<br />
StrLen $2 $1<br />
System::Call gdi32::GetTextExtentPoint32(ir0,tr1,ir2,*l.r1)<br />
System::Int64Op $1 &gt;&gt; 32<br />
System::Int64Op $1 &amp; 0xffffffff<br />
<br />
StrCpy $1 &quot;This is a long line with a &quot;<br />
StrLen $2 $1<br />
System::Call gdi32::GetTextExtentPoint32(ir0,tr1,ir2,*l.r1)<br />
System::Int64Op $1 &amp; 0xffffffff<br />
System::Call user32::MapWindowPoints(ir9,ir7,*lsr1,i1)<br />
System::Int64Op $1 &gt;&gt; 32<br />
System::Int64Op $1 &amp; 0xffffffff<br />
<br />
System::Call user32::ReleaseDC(ir0)<br />
<br />
System::Call user32::MoveWindow(ir8,is,is,is,is,i1)<br />
<br />
!insertmacro MUI_INSTALLOPTIONS_SHOW</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arantius</div><div class="date">3rd August 2007, 20:35</div></div><div class="posttext">Thank you very much kichik!</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>