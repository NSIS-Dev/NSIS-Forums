<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" Suggestion for UserInfo.nsi, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  Suggestion for UserInfo.nsi NSIS Discussion" />
	
	<title> Suggestion for UserInfo.nsi [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  Suggestion for UserInfo.nsi</div>
<hr />
<div class="pda"><a href="t-138856.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=138856">Suggestion for UserInfo.nsi</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Lilla</div><div class="date">13th June 2003, 05:14</div></div><div class="posttext">With the latest CVS (downloaded a few hours ago)<br />
When running UserInfo.nsi (.exe), <br />
under Win98SE, I get the Admin message.<br />
This is good, however, it contradicts what is stated<br />
in the comments/message of label &quot;Win9x:&quot; (see below)<br />
<br />
Excerpts from UserInfo.nsi<br />
<br />
StrCmp $R2 &quot;Admin&quot; 0 Continue<br />
MessageBox MB_OK 'User &quot;$R1&quot; is in the Administrators group'<br />
<br />
... clip...<br />
<br />
Win9x:<br />
; This one means you don't need to care about admin or<br />
; not admin because Windows 9x doesn't either<br />
MessageBox MB_OK &quot;Error! This DLL can't run under Windows 9x!&quot;<br />
<br />
<br />
Observation:<br />
** Win98SE does indeed run this DLL, at least my install does.<br />
** My install includes a number of updates, not sure if this is why.<br />
<br />
In any event, you might want to correct the comment/message.<br />
<br />
Lilla</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">13th June 2003, 10:30</div></div><div class="posttext">I know about this. For some weird reason the functions UserInfo.dll looks are for are there on Windows 98 too but just don't work. So UserInfo.dll, knowing that admin isn't required on Windows 98 anyway, returns admin anyway. You should still check for an empty string because these functions may not be present on Windows 95.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Lilla</div><div class="date">13th June 2003, 19:00</div></div><div class="posttext">Kichik, thanks for that inforamtion.<br />
I'll put the check for empty back in then.<br />
<br />
Lilla</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>