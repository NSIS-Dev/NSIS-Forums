<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content=" zlib on x64 issue, media player, mp3 player, music player, ipod sync, multimedia player, player, winamp, audio player" />
	<meta name="description" content="[Archive]  zlib on x64 issue NSIS Discussion" />
	
	<title> zlib on x64 issue [Archive]  - Winamp Forums</title>
	<link rel="stylesheet" type="text/css" href="archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar">Winamp Forums &gt; Developer Center &gt; <a href="f-65.html">NSIS Discussion</a> &gt;  zlib on x64 issue</div>
<hr />
<div class="pda"><a href="t-263915.html?login=1" rel="nofollow">Log in</a></div>
<p class="largefont">Try the Internet Archive: <a href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=263915">zlib on x64 issue</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">18th January 2007, 09:07</div></div><div class="posttext">Situation: MS Windows 2003 Server Enterprise x64 Edition Service Pack 1, Dual Core AMD Opteron 280, 2.4 GHz, 2 GB, NSIS 2.22, default compression (zlib). Just created package with 64 bit binaries (about 18 MB). When launched displays message box &quot;Error decompressing data! Corrupted installer?&quot;. If I make small changes in script (comment lines) new package may be correct (seldom) or may not (often). Particular package behaiviour repeatable. <br />
This never happened if: 1) &quot;SetCompressor lzma&quot; both simple and /solid; 2) if package includes 32-bit binaries (sounds weird, but it is so, may be because package size is less, about 15 MB); 3) on x86 comps.<br />
I could not reproduce the situation using a short NSIS script samples - packages started correct (and unfortunatelly had not time for long tests with my big script). Simple patch - I switched to lzma and happy with it (package is smaller, 10 and 13 MB, may be not good for marketing department ;) With /solid 7 MB). But if somebody knows good zlib test - I can run it there (using Remote Desktop).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">19th January 2007, 14:38</div></div><div class="posttext">It sounds to me like a size problem as well. Did you try adding more data to the lzma installer to see if it happens there as well? It'd also be a good idea, even without this problem, to add tests for the compression and decompression modules in Source\Tests. I thought I added those already, but apparently I didn't. Are you up for adding those for testing your problem?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">20th January 2007, 11:31</div></div><div class="posttext">I can run tests from office (IP limitations) and write short programs (at weekend). Job takes almost all my time :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">20th January 2007, 21:05</div></div><div class="posttext">I've started writing one. Currently, it tests only zlib and bzip2. I've attached both a test to the source tree and a compiled tester. It tests compression of up to 32mb files. Works fine for me on x86. Let me know how it goes on x64.<br />
<br />
Another good test would be opening the installer with 7-zip and seeing what it has to say about it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">22nd January 2007, 16:11</div></div><div class="posttext">I run test.exe few times today, but it always reported OK (9)...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kichik</div><div class="date">22nd January 2007, 20:03</div></div><div class="posttext">What about opening the installer with 7-zip? Try compiling another version of test.exe with an even larger compression buffer. Maybe that'd help...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Takhir</div><div class="date">24th January 2007, 14:08</div></div><div class="posttext">With new program release I cannot reproduce situation :( If I'll have time later I'll take previous version from archive and build distribution, but I cannot promise this..</div></div><hr />


<div id="copyright">2001-2013 <a href="http://creativecommons.org/publicdomain/mark/1.0/" target="_blank">Public Domain Mark 1.0</a></div>
</div>
</body>
</html>