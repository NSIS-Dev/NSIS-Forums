<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Error in the script, but why?" />

  <title>Error in the script, but why? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Error in the script, but why?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=249613">Error in the script, but why?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ghola2</span><br />
      <span class="post-time small text-muted">25th June 2006 16:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Error in the script, but why?</strong><br />
      Hy!<br />
      <br />
      I am trying to make a custom page, who has 2 textboxes, and init these textboxes with values from in.ini file if exist. The problem is that in the function where should be the init, i can't even make a strcpy, because it throws an error, that i am not using the correct sintax... (same problem with MUI_INSTALLOPTIONS_READ, or ReadINIStr, Pop )<br />
      What I am doing wrong? Can anybody help me?<br />
      <br />
      Thanks in advance<br />
      <br />
      <br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #0000BB"><br />
      <br /></span><span style="color: #007700">;--------------------------------<br />
      ;Include</span><span style="color: #0000BB">ModernUI<br />
      <br /></span> <span style="color: #007700">!include</span><span style="color: #DD0000">"MUI.nsh"<br /></span> <span style="color: #007700">!include</span><span style="color: #DD0000">"TextFunc.nsh"<br />
      <br />
      <br /></span> <span style="color: #0000BB">ReserveFile</span><span style="color: #DD0000">"ServerPort.ini"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_RESERVEFILE_INSTALLOPTIONS<br />
      <br /></span> <span style="color: #007700">;--------------------------------<br />
      ;</span><span style="color: #0000BB">General<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Name</span><span style="color: #007700">and</span><span style="color: #0000BB">file<br />
      Name</span><span style="color: #DD0000">"ModernUITest"<br /></span> <span style="color: #0000BB">OutFile</span><span style="color: #DD0000">"Basic.exe"<br />
      <br /></span> <span style="color: #007700">;Default</span><span style="color: #0000BB">installationfolder<br />
      InstallDir</span><span style="color: #DD0000">"$PROGRAMFILES\ModernUITest"<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Getinstallationfolderfromregistry</span><span style="color: #007700">if</span><span style="color: #0000BB">available<br />
      InstallDirRegKeyHKCU</span><span style="color: #DD0000">"Software\ModernUITest"""<br />
      <br /></span> <span style="color: #007700">;--------------------------------<br />
      ;Interface</span><span style="color: #0000BB">Settings<br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_ABORTWARNING<br />
      <br />
      <br /></span> <span style="color: #007700">;--------------------------------<br />
      ;</span><span style="color: #0000BB">Pages<br />
      <br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_WELCOME<br />
      <br />
      <br />
      <br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_COMPONENTS<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_DIRECTORY<br />
      PagecustomServerPage<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_INSTFILES<br />
      <br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_UNPAGE_CONFIRM<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_UNPAGE_INSTFILES<br />
      <br /></span> <span style="color: #007700">;--------------------------------<br />
      ;</span><span style="color: #0000BB">Languages<br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_LANGUAGE</span><span style="color: #DD0000">"English"<br />
      <br /></span> <span style="color: #007700">;--------------------------------<br />
      ;</span><span style="color: #0000BB">InstallerSections<br />
      <br />
      Section</span><span style="color: #DD0000">"DummySection"</span><span style="color: #0000BB">SecDummy<br />
      <br />
      SetOutPath</span><span style="color: #DD0000">"$INSTDIR"<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">ADDYOUROWNFILESHERE</span><span style="color: #007700">...<br />
      <br />
      ;</span><span style="color: #0000BB">Storeinstallationfolder<br />
      WriteRegStrHKCU</span><span style="color: #DD0000">"Software\ModernUITest"""</span><span style="color: #0000BB">$INSTDIR<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Createuninstaller<br />
      WriteUninstaller</span><span style="color: #DD0000">"$INSTDIR\Uninstall.exe"<br />
      <br /></span> <span style="color: #0000BB">SectionEnd<br />
      <br /></span> <span style="color: #007700">;--------------------------------<br />
      ;</span><span style="color: #0000BB">Descriptions<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Languagestrings<br />
      LangStringUSERPASS_TITLE</span><span style="color: #007700">${</span><span style="color: #0000BB">LANG_ENGLISH</span><span style="color: #007700">}</span><span style="color: #DD0000">"EnteryourUsernameandPassword."<br /></span> <span style="color: #0000BB">LangStringUSERPASS_SUBTITLE</span><span style="color: #007700">${</span><span style="color: #0000BB">LANG_ENGLISH</span><span style="color: #007700">}</span><span style="color: #DD0000">""<br /></span> <span style="color: #0000BB">LangStringDESC_SecDummy</span><span style="color: #007700">${</span><span style="color: #0000BB">LANG_ENGLISH</span><span style="color: #007700">}</span><span style="color: #DD0000">"Atestsection."<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Assignlanguagestringstosections<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_FUNCTION_DESCRIPTION_BEGIN<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_DESCRIPTION_TEXT</span><span style="color: #007700">${</span><span style="color: #0000BB">SecDummy</span><span style="color: #007700">}$(</span><span style="color: #0000BB">DESC_SecDummy</span><span style="color: #007700">)<br />
      !</span><span style="color: #0000BB">insertmacroMUI_FUNCTION_DESCRIPTION_END<br />
      <br /></span> <span style="color: #007700">;--------------------------------<br />
      ;</span><span style="color: #0000BB">UninstallerSection<br />
      <br />
      Section</span><span style="color: #DD0000">"Uninstall"<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">ADDYOUROWNFILESHERE</span><span style="color: #007700">...<br />
      <br /></span> <span style="color: #0000BB">Delete</span><span style="color: #DD0000">"$INSTDIR\Uninstall.exe"<br />
      <br /></span> <span style="color: #0000BB">RMDir</span><span style="color: #DD0000">"$INSTDIR"<br />
      <br /></span> <span style="color: #0000BB">DeleteRegKey</span><span style="color: #007700">/</span><span style="color: #0000BB">ifemptyHKCU</span><span style="color: #DD0000">"Software\ModernUITest"<br />
      <br /></span> <span style="color: #0000BB">SectionEnd<br />
      <br />
      <br />
      <br /></span> <span style="color: #007700">Function.</span><span style="color: #0000BB">OnInit<br />
      <br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_EXTRACT_AS</span><span style="color: #DD0000">"ServerPort.ini""ServerPort.ini"<br />
      <br /></span> <span style="color: #0000BB">FunctionEnd<br />
      <br />
      <br />
      <br /></span> <span style="color: #FF8000">#CUSTOMPAGE.<br />
      #=========================================================================<br />
      #GettheUsernameandPassword.<br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">ServerPage<br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_HEADER_TEXT</span><span style="color: #DD0000">"$(USERPASS_TITLE)""$(USERPASS_SUBTITLE)"<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">ReadINIStr$serverPort</span><span style="color: #DD0000">"$INSTDIR\in.ini""Server""Port"</span><span style="color: #007700">;</span><span style="color: #0000BB">generateserror</span><span style="color: #007700">,</span><span style="color: #0000BB">why</span><span style="color: #007700">?!<br />
      <br />
      <br />
      ;</span><span style="color: #0000BB">StrCpy$R99</span><span style="color: #DD0000">"semmikozod!!!!"</span><span style="color: #007700">;</span><span style="color: #0000BB">GENERATESERRORWHY</span><span style="color: #007700">?!<br />
      <br />
      <br />
      <br />
      <br />
      !</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_WRITE</span><span style="color: #DD0000">"ServerPort.ini""Field2""State""alma"</span><span style="color: #007700">;</span><span style="color: #DD0000">"$serverName"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_WRITE</span><span style="color: #DD0000">"ServerPort.ini""Field4""State""12"</span><span style="color: #007700">;</span><span style="color: #DD0000">"$serverPort"<br /></span> <span style="color: #FF8000">#Displaythepage.<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_DISPLAY</span><span style="color: #DD0000">"ServerPort.ini"<br />
      <br /></span> <span style="color: #FF8000">#Gettheuserenteredvalues.<br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_READ$R0</span><span style="color: #DD0000">"ServerPort.ini""Field2""State"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_READ$R1</span><span style="color: #DD0000">"ServerPort.ini""Field4""State"<br />
      <br />
      <br />
      <br /></span> <span style="color: #0000BB">MessageBoxMB_OK</span><span style="color: #DD0000">"{$R0}+$R1"<br />
      <br /></span> <span style="color: #0000BB">FunctionEnd<br /></span></span> <!-- php buffer end -->
      <hr />
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">25th June 2006 17:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You need to declare variables with the Var instruction.<br />
      Variables $0-$9 and $R0 to $R9 are predeclared by the compiler.<br />
      <br />
      e.g.<br />
      Var serverPort<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
