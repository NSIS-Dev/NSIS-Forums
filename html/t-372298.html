<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Problems on creating new page in NSIS with checkbox etc" />

  <title>Problems on creating new page in NSIS with checkbox etc - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Problems on creating new page in NSIS with checkbox etc</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=372298">Problems on creating new page in NSIS with checkbox etc</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">winman2004</span><br />
      <span class="post-time small text-muted">30th September 2013 13:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Problems on creating new page in NSIS with checkbox etc</strong><br />
      I want to insert a new page in the installation which contains two checkbox client version and server version.on clicking client version nothing special happens as of now. But if server version selected then a browse option should come to select a folder(This is not a installation folder). I am finding some difficulties to do this. I have added two checkbox a text box and browse button.In the onchange of checkbox i make browse and textbox.<br />
      <br />
      <br />
      But now the problem is<br />
      I want only one checkbox to be checked at a time.<br />
      <br />
      When server version checked browse option should appear(which works now) ,but if it is unchecked again then that browse option should disappear.(which does not work because i was not able to write code for that)<br />
      <br />
      If i click next on this page and then come back to same page using back then all controls or checkbox i checked should be as it is. But now those browse options will disappear even if server version checkbox is selected(As i have not done proper coding for this also)<br />
      <br />
      So please help me to do all these things. Also help me if there any other method to do the same<br />
      <br /></p>
      <pre>
<code><br />; Script generated by the HM NIS Edit Script Wizard.<br /><br />; HM NIS Edit Wizard helper defines<br />!define PRODUCT_NAME "My application"<br />!define PRODUCT_VERSION "1.0"<br /><br />Var Dialog<br />Var Text<br />Var Text_State<br />Var Checkbox<br />Var Checkbox1<br />Var Checkbox_State<br />Var Checkbox1_State<br />var /GLOBAL SOURCETEXT<br />var /global SOURCE<br />var /global BROWSESOURCE<br />; MUI 1.67 compatible ------<br />!include "MUI.nsh"<br />!include nsDialogs.nsh<br /><br />; MUI Settings<br />!define MUI_ABORTWARNING<br />!define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico"<br />!define MUI_UNICON "${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico"<br /><br />; Welcome page<br />!insertmacro MUI_PAGE_WELCOME<br />Page custom InstallPageCreate checkinstdir<br />; Directory page<br />!insertmacro MUI_PAGE_DIRECTORY<br />; Instfiles page<br />!insertmacro MUI_PAGE_INSTFILES<br />; Finish page<br />!insertmacro MUI_PAGE_FINISH<br /><br />; Uninstaller pages<br />!insertmacro MUI_UNPAGE_INSTFILES<br /><br />; Language files<br />!insertmacro MUI_LANGUAGE "English"<br /><br />; MUI end ------<br /><br />Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br />OutFile "Setup.exe"<br />InstallDir "$PROGRAMFILES\My application"<br />ShowInstDetails show<br />ShowUnInstDetails show<br />Var InstallPageDialog<br />Var InstallPage.DirRequest<br />Var InstallPage.BrowseButton<br />Var mui.WelcomePage<br />Var mui.WelcomePage1<br />Var mui.WelcomePage.Image1<br />Var mui.WelcomePage.Title<br />Var mui.WelcomePage.Text<br />Var ImageHandle<br />Var mui.WelcomePage.Title.Font<br />Var LINK<br />Var LINK.Font<br />Var clickinstall<br />Var mui.WelcomePage.Image.Bitmap<br />var checked<br />var checked1<br />Var CheckBox.Font<br />var mui.WelcomePage1.Title1<br />var mui.WelcomePage.Title.Font1<br />Function InstallPageCreate<br /><br />    nsDialogs::Create 1044<br />    Pop $mui.WelcomePage<br />    nsDialogs::SetRTL $(^RTL)<br />    SetCtlColors $mui.WelcomePage 0xffffff 0xffffff<br /><br />    ${NSD_CreateLabel} 120u 70u 140u 14u "Choose the intallation method"<br />    Pop $clickinstall<br />    SetCtlColors $clickinstall "" "ffffff"<br /><br />${NSD_CreateCheckbox} 120u 90u 100% 10u "&amp;Client version"<br />Pop $CheckBox<br />CreateFont $CheckBox.Font "$(^Font)" "08" "500"<br />SetCtlColors $CheckBox "" "FFFFFF"<br />SendMessage $CheckBox ${WM_SETFONT} $CheckBox.Font 0<br />GetFunctionAddress $0 OnCheckbox1<br />nsDialogs::OnClick $CheckBox $0<br /><br />${NSD_CreateCheckbox} 120u 100u 100% 10u "&amp;Server version"<br />Pop $CheckBox1<br />CreateFont $CheckBox.Font "$(^Font)" "08" "500"<br />SetCtlColors $CheckBox1 "" "FFFFFF"<br />SendMessage $CheckBox1 ${WM_SETFONT} $CheckBox.Font 0<br />GetFunctionAddress $0 OnCheckbox2<br />nsDialogs::OnClick $CheckBox1 $0<br /><br />${If} $Checkbox_State == ${BST_CHECKED}<br />        ${NSD_Check} $Checkbox<br />${EndIf}<br />${If} $Checkbox1_State == ${BST_CHECKED}<br />        ${NSD_Check} $Checkbox1<br />${EndIf}<br /><br />nsDialogs::Show<br /><br />    ;Delete image from memory<br />    ${NSD_FreeImage} $mui.WelcomePage.Image.Bitmap<br /><br />  FunctionEnd<br /><br />  Function OnCheckbox2<br /> <br />  StrCpy $SOURCE "C:\"<br /><br /><br />        ${NSD_CreateText} 120u 120u 80u 12u "$SOURCE"<br /><br />        pop $SOURCETEXT<br />    ${NSD_CreateBrowseButton} 280u 120u 35u 14u "Browse"<br />    Pop $InstallPage.BrowseButton<br />    ${NSD_OnClick} $InstallPage.BrowseButton Browsesource<br />   <br /><br />  FunctionEnd<br />  Function OnCheckbox1<br />  <br /><br />  FunctionEnd<br /><br />  Function checkinstdir<br />       ${NSD_GetText} $Text $Text_State<br />        ${NSD_GetState} $Checkbox $Checkbox_State<br />  ${If} $Checkbox_State == ${BST_CHECKED}<br />  strcpy $checked 1<br />  ${else}<br />  strcpy $checked 0<br />  ${Endif}<br /><br />  ${NSD_GetState} $Checkbox1 $Checkbox1_State<br />  ${If} $Checkbox1_State == ${BST_CHECKED}<br />  strcpy $checked1 1<br />  ${else}<br />  strcpy $checked1 0<br />  ${Endif}<br />  FunctionEnd<br /><br />  Function Browsesource<br />  nsDialogs::SelectFolderDialog "Select Source Folder" "c:\"<br />  pop $SOURCE<br />  ${NSD_SetText} $SOURCETEXT $SOURCE<br />  FunctionEnd<br /><br /><br /><br />Section "MainSection" SEC01<br />SectionEnd<br /><br /><br /><br />Section -Post<br /><br />SectionEnd<br /><br /><br /><br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bnicer</span><br />
      <span class="post-time small text-muted">1st October 2013 03:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What you're trying to do might not be possible.<br />
      <br />
      I don't think you can make the Browse button disappear without refreshing the page; to refresh the page, leave the page (Next or Back), and then to return to the page, use Back or Next.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">1st October 2013 08:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You cannot create elements after the Show command. You need to create all components on the page together, and then hide some of them. In the onclick functions you can then unhide the required components and hide others:<br />
      <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.14.17" target="_blank">http://nsis.sourceforge.net/Docs/Cha...html#4.9.14.17</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">winman2004</span><br />
      <span class="post-time small text-muted">1st October 2013 09:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey I did something <a href="https://skydrive.live.com/?cid=02b635f7d896b131&amp;id=2B635F7D896B131%21130&amp;authkey=!AM7QvKhL8NHq63o" target="_blank">like this</a>.<br />
      <br />
      It works almost perfectly.There may be changes required to improve code structure.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">winman2004</span><br />
      <span class="post-time small text-muted">1st October 2013 09:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by MSG</small><br />
        You cannot create elements after the Show command. You need to create all components on the page together, and then hide some of them. In the onclick functions you can then unhide the required components and hide others:<br />
        <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.14.17" target="_blank">http://nsis.sourceforge.net/Docs/Cha...html#4.9.14.17</a>
      </blockquote>Thank you for reply. I have done some changes(see <a href="https://skydrive.live.com/?cid=02b635f7d896b131&amp;id=2B635F7D896B131%21130&amp;authkey=!AM7QvKhL8NHq63o" target="_blank">here</a>) . Any suggestions from your side to improve it?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bnicer</span><br />
      <span class="post-time small text-muted">1st October 2013 11:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by winman2004</small><br />
        Any suggestions from your side to improve it?
      </blockquote>Very good, however if one <u>one</u> checkbox must be checked and both checkboxes also must not be checked at the same time, why nor use radio buttons?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">winman2004</span><br />
      <span class="post-time small text-muted">4th October 2013 07:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please check my code <a href="https://skydrive.live.com/?cid=02b635f7d896b131&amp;id=2B635F7D896B131%21130&amp;authkey=!AM7QvKhL8NHq63o" target="_blank">here</a>. I am facing small problem. If a user click on browse button and in folder browse dialog if he clicks cancel instead of selecting path then control will be set to "error" . How can i handle this? I want user to select path compulsorily if he has selected server installation. How can i do it?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">4th October 2013 07:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Simply check for a proper path in the $SOURCE variable in your page's leave function.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">winman2004</span><br />
      <span class="post-time small text-muted">4th October 2013 09:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok how can i display same custom page in the leave function? If i use a leave function for custom page i will give a message to user that path should be selected or some thing else and then i again want to show same custom page. How can i call custom page from the leave function?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">4th October 2013 10:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Calling 'abort' in the leave function will make the user stay on that page.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">winman2004</span><br />
      <span class="post-time small text-muted">4th October 2013 14:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by MSG</small><br />
        Calling 'abort' in the leave function will make the user stay on that page.
      </blockquote>Thank you. I was able to do it. Can i get windows user list in nsis? I want user to select any one of the windows user account from a list. The list must contain all windows user accounts of PC.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">5th October 2013 00:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://nsis.sourceforge.net/User_Management_using_API_calls#Enumerate_all_users" target="_blank">http://nsis.sourceforge.net/User_Man...rate_all_users</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">winman2004</span><br />
      <span class="post-time small text-muted">5th October 2013 05:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am already using NSD_SetImage to display a image on the custom page. It works properly,but only in my pc where the image exists in path. So to include in setup what should i do? Should i include image file by using 'File' option of nsis or is there any method to do it?<br />
      <br />
      But !define MUI_WELCOMEFINISHPAGE_BITMAP "D:\Icons\Welcome.bmp" in welcome page shows image properly in all pc. But how to include or load image in custom page?</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
