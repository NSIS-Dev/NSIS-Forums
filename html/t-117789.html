<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="MD5 plugin"><title>MD5 plugin - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">MD5 plugin</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=117789">MD5 plugin</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">IGx89</span><br><span class="post-time small text-muted">14th December 2002 00:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>MD5 plugin</strong><br>I needed a MD5 plugin for an auto-updater (see it in action <a href="http://www.wulfram.com/download.php" target="_blank">here</a>) I've made with NSIS, and since I didn't find any, I made my own :). I haven't renamed a bunch of stuff from the original exdll, so just ignore that. I used MSVC++ .NET to make it, so if you have VC++ 6, you might have to convert it using the converter over at <a href="http://www.CodeProject.com," target="_blank">www.CodeProject.com,</a> or start the project from scratch.<br><br>The final size of the dll is 40.5kb using VC++ .NET Standard, and 22.5kb after packing it with UPX. I've tried to make it smaller, with no avail. If anyone can cut in half (or more :)) its size, you have my undying gratitude :)<br><br>Enjoy!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">14th December 2002 14:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't know how this is done with VC7, but you shouldn't link to the default libraries (libc). If you do this you won't be able to use any libc functions including memset (use mini_memset from NSIS sources), sprintf (use wsprintf), strncat (use lstrcat instead [no n, but this can be done manually]), strcpy (use lstrcpy), new and delete (you will have to define your own [IO does that]), strlen (use lstrlen instead), fopen and friends (use CreateFile, CloseFile, ReadFile and WriteFile instead), and memcpy (use mini_memcpy or my_memcpy from one of NSIS contribs). There are more functions you can't use, but those are the ones I have found in your source code. After you dump libc your DLL will be cut at least in half.<br><br>You should also rename DllMain back to _DllMainCRTStartup and set the entry point to _DllMainCRTStartup.<br><br>Nice idea BTW, submit it to Sunjammer's NSIS Archive when it's ready (and the new archive is ready too).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">IGx89</span><br><span class="post-time small text-muted">14th December 2002 15:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the tips! I actually did specify no default, and then manually added in libc.lib. That brought it down from 50kb to 40kb. I'll try what you said, and see if I can get it to work :)<br><br>BTW, why did you suggest for me to rename the entry point? What does that do?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">14th December 2002 15:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It makes it smaller too.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">IGx89</span><br><span class="post-time small text-muted">14th December 2002 16:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Goody :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">IGx89</span><br><span class="post-time small text-muted">15th December 2002 18:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It won't let me use new or delete, either; I think I'll let someone else do the conversion. I'm not THAT desperate :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">15th December 2002 18:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>new and delete (you will have to define your own [IO does that])</blockquote>;)</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">30th May 2005 16:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Matthew "IGx89" Lieder<br>Author<br><br>KJD (<a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=413" target="_blank">archive</a>)<br>-Modified to reduce size and use exdll.h<br>(reduced to about 6KB uncompressed, by removing CRTL dependency)<br><br>Davy Durham<br>-MD5.cpp fix (correct for loop used to replace memset, exceeded bounds)<br><br>Shengalts Aleksander aka Instructor<br>-New command: "GetMD5Random" for generate random MD5sum<br>-Changed names: "GetFileMD5" -&gt; "GetMD5File", "GetMD5" -&gt; "GetMD5String"<br>-Fixed: string lenght error<br><br><br><b>md5dll</b> 0.3</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Clammerz</span><br><span class="post-time small text-muted">16th December 2006 11:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Apologies for the huge bump, but I was wondering if it was possible to see some sort of progress while calculating a checksum?<br><br>On older machines, it could take quite some time to calculate a checksum for a file in the 10's of MB range, let alone larger files. So it would be nice if such progress display could be added.<br><br>I will probably use a Banner of some sort displaying "Verifying files, please wait..." or something in the meantime though, but it's not a solution I'm all that happy about : P<br><br>I feel like the user should know at all times that the installer is progressing.<br><br>Thank you very much for your time.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cobra300</span><br><span class="post-time small text-muted">18th March 2009 01:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">version 1.1 seems has a bug: the result can only be pop to $0. I tried the following code:<br></p><pre>
<code><br>    StrCpy $0 "D0"<br>    StrCpy $1 "D1"<br>    Crypto::HashFile "MD5" "$WINDIR\notepad.exe"<br>    Pop $1<br>    DetailPrint $0<br>    DetailPrint $1<br></code>
</pre><br>
      The output is:<br>
      <pre>
<code><br>DAF60E13E96ECB67F0EDAA89C6B01B8D<br>D1<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br>
      <span class="post-time small text-muted">18th March 2009 03:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you're referring to the Crypto plugin. This thread is for the MD5 plugin. For the Crypto thread, see:<br>
      <a href="http://forums.winamp.com/showthread.php?postid=1346355" target="_blank">http://forums.winamp.com/showthread.php?postid=1346355</a><br>
      <br>
      Plugin URLs:<br>
      Crypto: <a href="http://nsis.sourceforge.net/Crypto_plug-in" target="_blank">http://nsis.sourceforge.net/Crypto_plug-in</a><br>
      MD5: <a href="http://nsis.sourceforge.net/MD5_plugin" target="_blank">http://nsis.sourceforge.net/MD5_plugin</a><br>
      <br>
      For what it's worth - I did duplicate the behavior you saw - the Crypto thread seems to have other posts referring to the 'empty' result as well. I'd guess that nothing actually gets set on the stack (as the Pop results in the Errors flag being set) and instead the Crypto plugin dumps its result in $0 directly. Not a huge issue (although not encouraged), but something that should probably be noted in the docs.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>