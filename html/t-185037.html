<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Detect script path at compile time" />

  <title>Detect script path at compile time - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Detect script path at compile time</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=185037">Detect script path at compile time</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">e-novative</span><br />
      <span class="post-time small text-muted">29th June 2004 22:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Detect script path at compile time</strong><br />
      Hi folks,<br />
      <br />
      I was having some trouble excluding .svn version control subdirectories from getting packages with my application, but thanks to rsegal I could solve the problem.<br />
      <br />
      One question remains: I need the full absolute path to the NSIS script (resp. to the directories I choose to wrap up into the installer). Since my source is tucked away in a version control database, the actual path where the NSIS script is compiled from is not fixed, but differs from time to time (and PC to PC).<br />
      <br />
      Is there a way of detecting the script directory at _compile_ time? I am thinking of something like ${__DIR__}, similar to ${__FILE__}? I was not able to find any solution in the documentation or by googling around.<br />
      <br />
      Kind regards,<br />
      <br />
      Steve</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br />
      <span class="post-time small text-muted">1st July 2004 19:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is a macro in the archive which you can use to extract the directory from a file name. Use that in conjunction with ${__FILE__} to get what you need.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">2nd July 2004 03:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The only way to change Compile Time strings is to create another program and make this second program run the first program with the information you want to change in the command line as defines.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br />
      <span class="post-time small text-muted">2nd July 2004 15:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oops, you're right- I missed the compile time reference.<br />
      To the original poster- why do you need absolute paths. If you write your NSI with relative paths, you should be OK.<br />
      I am doing the same thing as you, i.e., my NSI file is in a version control system and the absolute path may vary from PC to PC.<br />
      However, since my scripts use relative paths and the version control relative directory structure is the same on every PC, I experience no problems compiling on different PCs.<br />
      If you really want the ${__DIR__} macro, a couple of options are to:<br />
      a) Modify the makensis source code and recompile, or,<br />
      b) Create a batch file in the same folder as the NSI file. In the batch file generate an NSH file which defines the ${__DIR__} macro for you and then include the NSH file in your main NSI. You can invoke the batch file using the !system command.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">e-novative</span><br />
      <span class="post-time small text-muted">3rd July 2004 11:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your help, folks. The relative paths I required because I use rsegal's FolderList to exclude .svn version control files from being packaged into the installer and being deployed to the target system. Originally, rsegal told me that I must use absolute paths to specify the exclude directories, but (lucky my) I tried with relative paths and they - unexpectedly - worked, too.<br />
      <br />
      It's good to know a way of doing at, though, in case I should need it in the future. Thanks again for your help.<br />
      <br />
      Regards,<br />
      <br />
      Steve</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
