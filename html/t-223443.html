<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="InstallSpider UI For NSIS"><title>InstallSpider UI For NSIS - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">InstallSpider UI For NSIS</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=223443">InstallSpider UI For NSIS</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br><span class="post-time small text-muted">6th August 2005 04:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallSpider UI For NSIS</strong><br>I have completed most of this UI now. Attached is the setup program (beta version 1) and all resources required for the new UI. I am still suprised that the installer is less than 100KB. I have also included one example and a readme.htm file. The few new features are outlined in the readme.htm.<br><br>The feature I am very proud of is the windows versions and which versions to install on. It is outlined in the readme.htm. I will post a few screenshots in the next few days.<br><br>I will also be adding lots of new features in the coming weeks.<br><br>[edit]attachment deleted, use attachment in following posts[/edit]</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">6th August 2005 11:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">your installer should at least install the ui to the correct nsis-directory instead of assuming it's in <i>c:\program files</i>. the uninstaller has no effect, had to delete all files manually.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">6th August 2005 12:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">JasonFriday13, to get it to install to just NSIS\ you need to copy all your files to a seperate folder with the file system intact, e.g. NSIS\Release\[Contrib, Docs, Examples etc]<br>Then you need to highlight all those folders and Add to Archive.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">6th August 2005 18:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for contributing to the NSIS project. I have a few comments about your UI:<br><br>* Maybe you can keep the MUI prefix for macros and settings that are the same so changing the UI would be very easy.<br><br>* The feature to check for a Windows version is indeed useful, but not really a part of a user interface. Providing this as a separate library would make it available to users of other UIs as well.<br><br>* You made some small style changes to the language file. I don't see a real reason for this (the MUI language files have been checking to comply to Windows standards). Sharing language files would also have the advantage of being able to use many languages and will keep the texts consistent.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br><span class="post-time small text-muted">7th August 2005 01:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the replies. When I tested it on my machine, I change the name of the nsis directory and installed the UI. Then I uninstalled it making sure all the files were deleted. The setup gets the nsis directory from the registry. I opened the makensis setup script and used a line from there to get it. The uninstaller should have worked (I have tested it myself), but if the files are not deleted, the registry keys would still be deleted so you can delete the files.<br><br>As for the language files, I was just trying to make them sound like the setup program that this one copies. I have included the setup script in the installation if you want to modify it. It's located at 'NSISDIR}\contrib\InstallSpiderUI\setup.nsi'. I might just change the language macros in the system.nsh to have the prefix MUI so that the language files of the MUI are used. I have also included two more !define texts in the language file. They are for the confirm page. My UI does not have header text like the MUI, so I didn't put in defines for it. Have a look at my hangman setup program. I have a confirm page that has header texts and dialog texts that might be suitable (the setup script is included).<br><br>For the windows version check, I will probably export the code into a header file to make it more usable. I am still going to keep the IS prefix on all the macros just so that you know you are not using the MUI.<br><br>Thanks again for the feedback.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br><span class="post-time small text-muted">8th August 2005 05:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">kichik: can you please delete the attachment on my first post, it has mistakes in it.<br><br>Here is an updated version that fixes alot of items and now it uses the same language files as the MUI. I have just copied the MUI system.nsh and modified it from there. The macro system is the same and I have added a confirm page as well. To stop getting 'error: string not defined' at the bottom of the compiler, download and copy the MUI confirm page files into the modern ui folder which is available on one of my recent threads.<br><br>Well, here is the next version.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br><span class="post-time small text-muted">1st September 2005 01:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The next version is here. The readme says it all. I am sure this one works properly this time.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br><span class="post-time small text-muted">5th October 2005 04:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here is a taster of what is to come in the next version of InstallSpider. I added the splash code and the banner code to bgimage and compiled it. The dll size is currently 11kb.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br><span class="post-time small text-muted">10th November 2005 05:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The full version (1.0) is due out this week, just have to finish writing the documentation on all the new features. I have attached an example installer (to be included with the release) so that you get a taster on what is in this version. Notice I have fixed the icon not being shown on the background window, the background window now no longer appears in the taskbar and alt-tab dialog, and that the uninstaller background does not have a title bar (another feature I have added). To uninstall just run the setup program again.<br><br>Enjoy.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br><span class="post-time small text-muted">14th November 2005 23:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This is it. Version 1.0. I have banished the rumours about the Instfiles page and the custom section macros. These don't exist.<br><br>Heaps of new macros, a new plugin (shield.dll) which is hidden beneath the new macros, a few more bitmaps, and lots of bugfixes.<br><br>Enjoy. :cool:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br><span class="post-time small text-muted">14th November 2005 23:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here is a zip with two screen shots. One is the directory page of the Microangelo 5.59 setup directory page, the other is the directory page of this interface.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dandaman32</span><br><span class="post-time small text-muted">15th November 2005 06:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>From ISUI docs:<br><br>This macro takes the ease out of making a custom page appear in your installer/uninstaller. (FILE) is the filename of the installoptions file.</blockquote>I'm assuming you want to make inserting custom pages easier. :)<br><br>-dandaman32</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">15th November 2005 16:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">lol it's saying that the macro makes it harder :)<br><br>I think you probably want to say:<br>This macro makes it easier to insert a custom page in your installer/uninstaller. (FILE) is the filename of the installoptions file.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">15th November 2005 17:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Missed for uninstaller (uninstspiderUI.exe):</p><pre>
<code>RMDir "$INSTDIR\Examples\InstallSpiderUI"<br>RMDir "$INSTDIR\Plugins"<br>RMDir "$INSTDIR\Examples"<br>RMDir "$INSTDIR"</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">16th November 2005 03:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">lol I didn't proofread properly. Also I will fix the setup program. Thanks.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">17th November 2005 06:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here is version 1.01 with the problems above fixed.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">6th March 2006 23:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Unfortunatly, I have lost the source code to the shield.dll plugin, so this means that it is time for a rewrite and cleanup. I also lost almost all my data including all of the projects I have been working on for the past few years.:(<br>
      I am now going to use the mui in the latest version of nsis, and redocument the documentation. Expect a new version to be out in a few months. It's good to be updated once in a while.<br>
      <br>
      edit: I will probably wikify the next release, I think it needs it's own page now.<br>
      <br>
      - Jason aka JasonFriday13.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">22nd March 2006 02:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have now wikified InstallSpiderUI <a href="http://nsis.sourceforge.net/Category:Graphics_and_UIs" target="_blank">here</a>. I have made some progress on the Shield.dll plugin, but this time I will not have as many features as the last one did. I'll keep you posted.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">1st May 2006 02:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The latest version of InstallSpiderUI is out. Go to wiki page above to download. The most important feature (I think) is uninstaller abort to finish. Also removed Shield.dll in favour of an nsis source patch (adds 1KB on stubs, which beats adding 5KB for a plugin that does the same thing). Enjoy.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">15th May 2006 02:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">InstallSpiderUI minor update. Fixed tiny details. Version 1.03 available on wiki.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">6th August 2006 22:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have attached an image of the new license page for the next release. I have not written the functionality of it yet, but it's a start.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">15th August 2006 00:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">InstallSpiderUI 1.04 out now. <a href="http://nsis.sourceforge.net/InstallSpiderUI" target="_blank">Wiki page</a>.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">28th July 2007 19:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have finally decided to release an update. <a href="http://nsis.sourceforge.net/InstallSpiderUI" target="_blank">Wiki page</a>.<br>
      <br>
      I have added a plugin called SimpleBg. It is basically a stripped down BgImage.dll with the paint routines from the source of nsis.<br>
      <br>
      Yes, I know, long time no see. I will be popping in now and then to see what is going on.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">19th August 2007 05:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here is version 1.06. some minor improvements including palette reducing on some of the wizard images (now 15kb :D).<br>
      <br>
      <a href="http://nsis.sourceforge.net/InstallSpiderUI" target="_blank">http://nsis.sourceforge.net/InstallSpiderUI</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">29th December 2008 03:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">From one of my threads in 2005:<br></p>

      <blockquote>
        2.<br>
        How about an extra parameter on the page command? Example:<br>
        page instfiles [pre] [show] [leave] [rect]<br>
        where rect is the custom dialog control to display the page in (the default is 1018. I would like to be able to change it so I can have pages displayed in different locations in the window - this will help in my InstallSpider UI).
      </blockquote>Again, this would come in handy for my UI.<br>
      <br>
      [edit] Feature has been submitted on <a href="http://sourceforge.net/tracker/?group_id=22049&amp;atid=373088" target="_blank">sourceforge</a>.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">10th January 2009 21:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Wouldn't moving around 1018 in the pre callback function work?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">12th January 2009 07:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh, I never thought of that. I thought the controls on the inbuilt dialogs couldn't be moved. Time to start experimenting (starts rubbing hands together :)).</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">28th February 2009 12:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">A new version based on MUI2 is now available on the wiki. Check it out <a href="http://nsis.sourceforge.net/InstallSpiderUI" target="_blank">here</a>.<br>
      <br>
      I have decided not to worry about that feature described above, I have already done the work to work around it. I don't want to remove that lovely coding I did for the license page.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">8th October 2013 20:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's been ages, but I have done some tweaking recently and made a simple patch that moves a built-in page to a different rect. I ported the code from ui.c in the contrib\uis folder using the system plugin. This also got rid of some weird problems with my custom license code and made it so much easier to read. I also tweaked the setup program, removing a messagebox that I forgot about on the last version :hang:.<br>
      <br>
      Anyway, new version 2.01 is available on the wiki: <a href="http://nsis.sourceforge.net/InstallSpiderUI" target="_blank">http://nsis.sourceforge.net/InstallSpiderUI</a><br>
      <br>
      For those of you that are interested, this is the code that moves a built-in page to a different rect.<br></p>

      <blockquote>
        ;Get control handles<br>
        FindWindow $mui.LicensePage "#32770" "" $HWNDPARENT<br>
        <br>
        Push $0<br>
        Push $1<br>
        Push $2<br>
        Push $3<br>
        Push $4<br>
        Push $5<br>
        <br>
        GetDlgItem $0 $HWNDPARENT 1044<br>
        <br>
        ; Setup our struct (RECT)<br>
        System::Alloc 32<br>
        Pop $1<br>
        <br>
        System::Call 'user32::GetWindowRect(ir0, p r1)'<br>
        System::Call 'user32::ScreenToClient(i$HWNDPARENT, p r1)'<br>
        <br>
        ; Read data from our struct<br>
        System::Call '*$1(i.r2, i.r3, i.r4, i.r5)'<br>
        System::Call 'user32::SetWindowPos(i$mui.LicensePage, i0, ir2, ir3, i0, i0, i0x0010|0x0001|0x0004) i.r4'<br>
        <br>
        System::Free $1<br>
        <br>
        Pop $5<br>
        Pop $4<br>
        Pop $3<br>
        Pop $2<br>
        Pop $1<br>
        Pop $0
      </blockquote>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>