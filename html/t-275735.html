<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="SpiderBanner plugin" />

  <title>SpiderBanner plugin - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">SpiderBanner plugin</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=275735">SpiderBanner plugin</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">11th August 2007 10:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>SpiderBanner plugin</strong><br />
      I have been working on this plugin for two or three months now. This is a test version so that the bugs (if any) are fixed. I have included my SimpleBg plugin with this test installer. I haven't posted on this forum in ages, so its good to be back.<br />
      <br />
      For those who create plugins in C, I will share the basic idea behind the plugin. It displays a custom dialog with no border, and is a child of the parent window. Then the parent window is resized to fit the custom dialog. Much the same way the installer shows its pages. I had to subclass the progress bar and detail text so that I could show the info on my custom dialog.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Backland</span><br />
      <span class="post-time small text-muted">11th August 2007 11:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Looks good so far, I ran it a few times, and there were redraw problems with the header and status labels.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">11th August 2007 13:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nope, I just didn't bother putting them in in the first place.<br />
      <br />
      [edit] My plugin doesn't touch those fields, its purely MUI controlled.<br />
      <br />
      [edit again] I have found a major issue with minimizing and restoring the window. Looks like I will have to subclass the installer window after all.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sag47</span><br />
      <span class="post-time small text-muted">11th August 2007 16:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">how did you get the installation to loop around with pushing the finish button? NSIS src would be nice. thx<br />
      SAM</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">11th August 2007 18:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It is this nice little trick with the SendMessage command:<br />
      <br />
      SendMessage $HWNDPARENT "0x408" 1 0<br />
      <br />
      The no. 1 is how many pages to skip. 2 skips two pages foward. -3 skips three pages back.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">11th August 2007 18:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I finally figured out the window problem. Here is another test version. And I didn't have to subclass the installer window :D .</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Backland</span><br />
      <span class="post-time small text-muted">11th August 2007 19:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yep, that fixed it ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">14th August 2007 12:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is the final test version before I officially release this plugin. I will try my best to fix any bugs if you manage to find any.<br />
      <br />
      I still have to write up the documentation and examples, but it shouldn't take that long.<br />
      <br />
      I also managed to cut 512 bytes off the plugin by removing some hide and show routines. The plugin is now 6 kb :D.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Backland</span><br />
      <span class="post-time small text-muted">14th August 2007 14:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm seeing the redraw issues again the last version...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">15th August 2007 11:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah, I'm gonna have to look though the source code for the installoptions plugin, to see where the repainting routines are.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">17th August 2007 11:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Lets try this again. Here is the final test version before I officially release this plugin.<br />
      <br />
      I have fixed the redraw problem, and in turn this also fixed another minor redraw problem.<br />
      <br />
      [edit] Now I am going to take as much unneeded code out as I can to get the size down.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Backland</span><br />
      <span class="post-time small text-muted">18th August 2007 04:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah its fixed, looks good :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">18th August 2007 10:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here are some more examples using the ISUI and the normal UI. Enjoy.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">18th August 2007 10:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oops, forgot the attachment.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">19th August 2007 05:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This plugin is now available on the wiki.<br />
      <br />
      <a href="http://nsis.sourceforge.net/SpiderBanner_plug-in" target="_blank">http://nsis.sourceforge.net/SpiderBanner_plug-in</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">24th August 2007 09:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Fixed a minor bug. Now the Destroy function can be called in the leave function of the instfiles page, or if you feel like it, you can call it on the pre and show functions of the next page :D. Enjoy.<br />
      <br />
      [Edit] This is the most advanced plugin I have ever coded for nsis. I've come a long way since the SysRestore plugin :) .[/edit]<br />
      <br />
      <a href="http://nsis.sourceforge.net/SpiderBanner_plug-in" target="_blank">http://nsis.sourceforge.net/SpiderBanner_plug-in</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Backland</span><br />
      <span class="post-time small text-muted">26th August 2007 03:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Keep it up, does it work fine with the new MUI2 beta?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">26th August 2007 05:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It doesn't matter what interface you have, as long as you have an InstFiles page, and your installer isn't silent, this plugin will work with it. You can see this with the examples I posted earlier (default UI, MUI, ISUI). I doubt it will work with skinned UIs (eg, ExperienceUI), but you never know, it might work.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">21st October 2007 10:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">A new version has just been released. This version fixes the progress bar not working under Windows 98, and now the window is "hidden" (moved to the bottom right of the screen) while the dialog is being loaded. I noticed this bug after I saw the installing page on the parent before the dialog was being destroyed. It should be fixed now. Plus, the size is still 6kb :D. Wiki link below.<br />
      <br />
      <a href="http://nsis.sourceforge.net/SpiderBanner_plug-in" target="_blank">http://nsis.sourceforge.net/SpiderBanner_plug-in</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">valentz142</span><br />
      <span class="post-time small text-muted">12th November 2007 09:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Jason,<br />
      <br />
      It is a good plugin, anyway i found 2 bugs accidentally, normal user i believe won't do this.<br />
      Using example.nsi that provided in SpiderBanner_plugin.zip, here are the errors:<br />
      1. inserting "SpiderBanner::Show /NOUNLOAD $R0 $R1" again between "SpiderBanner::Show /NOUNLOAD $R0 $R1" and "SpiderBanner::Destroy" will close installer immediately<br />
      <br />
      2. click and hold banner, until get MUI's finish page, release mouse, and could not click anything, until press CTRL+ALT+DEL and click cancel.<br />
      <br />
      Hopefully could strengten your plugin.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">12th January 2008 15:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello. Thanks for the reply.<br />
      <br />
      1. This problem is easily fixed. I did this fix on one of my other plugins that needed it. A good programmer will never do the same thing twice with this plugin.<br />
      <br />
      2. This problem is not with my plugin, but with nsis itself. Try it with this very simple test installer I have attached.<br />
      <br />
      [edit]This is the script used:<br /></p>
      <pre>
<code>Name "Test"<br />OutFile "Test.exe"<br /><br />!include "MUI.nsh"<br /><br />!insertmacro MUI_PAGE_WELCOME<br />!insertmacro MUI_PAGE_INSTFILES<br />!insertmacro MUI_PAGE_FINISH<br /><br />!insertmacro MUI_LANGUAGE "English"<br /><br />Section "Test"<br />  DetailPrint "This is a test."<br />  Sleep 1000<br />  Sleep 1000<br />  Sleep 1000<br />  Sleep 1000<br />  Sleep 1000<br />SectionEnd</code>
</pre>[/edit]
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">12th January 2008 18:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">New version now available on wiki. Fixes bug no. 1 above.<br />
      <br />
      <a href="http://nsis.sourceforge.net/SpiderBanner_plug-in" target="_blank">http://nsis.sourceforge.net/SpiderBanner_plug-in</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">29th November 2010 04:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi guys, I've been working on an update to my plugin, and there is a new version released on the wiki. Uses the new plugin api, which means NSIS 2.42 or higher is required. Next project is updating the InstallSpiderUI with the latest versions of my software and MUI2. Enjoy!<br />
      <br />
      <a href="http://nsis.sourceforge.net/SpiderBanner_plug-in" target="_blank">http://nsis.sourceforge.net/SpiderBanner_plug-in</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mrphantuan</span><br />
      <span class="post-time small text-muted">30th November 2010 08:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by JasonFriday13</small><br />
        Hello. Thanks for the reply.<br />
        <br />
        1. This problem is easily fixed. I did this fix on one of my other plugins that needed it. A good programmer will never do the same thing twice with this plugin.<br />
        <br />
        2. This problem is not with my plugin, but with nsis itself. Try it with this very simple test installer I have attached.<br />
        <br />
        [edit]This is the script used:<br />
        <pre>
<code>Name "Test"<br />OutFile "Test.exe"<br /><br />!include "MUI.nsh"<br /><br />!insertmacro MUI_PAGE_WELCOME<br />!insertmacro MUI_PAGE_INSTFILES<br />!insertmacro MUI_PAGE_FINISH<br /><br />!insertmacro MUI_LANGUAGE "English"<br /><br />Section "Test"<br />  DetailPrint "This is a test."<br />  Sleep 1000<br />  Sleep 1000<br />  Sleep 1000<br />  Sleep 1000<br />  Sleep 1000<br />SectionEnd</code>
</pre>[/edit]
      </blockquote>Thanks you a lot!<br />
      <br />
      <br />
      <a href="http://tandaiduong.com.vn/duhoc-News,at,categories,catid,15.html" target="_blank"><br /></a>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">1st December 2010 10:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Been tinkering around with unicode, and currently I have working ANSI and Unicode versions from the same source code :D. Currently in the process of updating all my plugins to support unicode, including InstallSpiderUI which will have a custom plugin containing code from 3 of my plugins. Watch this space ;) .</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
