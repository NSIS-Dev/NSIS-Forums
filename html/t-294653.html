<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="embedding installer help"><title>embedding installer help - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">embedding installer help</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=294653">embedding installer help</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">moose517</span><br><span class="post-time small text-muted">17th July 2008 04:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>embedding installer help</strong><br>i have read throug the example on embedding installers in NSIS but i can't get the directx runtime to work correctly. I have all the files needed for it in a folder called redist and the setup file is in that folder I want to install it silently as well without user interference. Here is what i have maybe someone could suggest something to get it to run right, i see what the installer pops up and then goes away real quick before the user has the chance to install in a non silent way but i want it done silently if possible. And also the shortcut to the start menu will not delete either with this. Thanks for you help.<br><br># define name of installer<br>outFile "FIAR Setup.exe"<br><br># define installation directory<br>installDir "$PROGRAMFILES\MooseMan Studios"<br><br># start default section<br>section<br><br># set the installation directory as the destionation for the following actions<br>setOutPath $INSTDIR<br><br># create the uninstaller<br>writeUninstaller "$INSTDIR\uninstall.exe"<br><br># install dx runtime before installing game files<br>file "Redist\dxsetup.exe"<br>file "Redist\dsetup.dll"<br>ExecWait "$INSTDIR\dxsetup.exe /silent"<br><br># write the files out to the install directory<br>file "Four In A Row.exe"<br>file background.tga<br>file credits.jpg<br>file intro.jpg<br>file mainmenu.jpg<br><br># create a shortcut named "Four In A Row" on the desktop<br># point the new shortcut at the program executable<br>createShortCut "$DESKTOP\Four In A Row.lnk" "$INSTDIR\Four In A Row.exe"<br><br># create a shortcut named "Four In A Row" in the menu folders<br>createShortCut "$SMPROGRAMS\MooseMan Studios\Four In A Row.lnk" "$INSTDIR\Four In A Row.exe"<br>sectionEnd<br><br># uninstaller section start<br>section "uninstall"<br><br># first, delete the uninstaller<br>delete "$INSTDIR\uninstall.exe"<br><br># delete all the game files<br>delete "$INSTDIR\Four In A Row.exe"<br>delete "$INSTDIR\background.tga"<br>delete "$INSTDIR\credits.jpg"<br>delete "$INSTDIR\intro.jpg"<br>delete "$INSTDIR\mainmenu.jpg"<br>delete "$INSTDIR\redist"<br><br># second, remove the link from the desktop and start menu<br>delete "$DESKTOP\Four In A Row.lnk"<br>delete "$SMPROGRAMS\MooseMan Studios\Four In A Row.lnk"<br><br># uninstaller section end<br>sectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">moose517</span><br><span class="post-time small text-muted">17th July 2008 23:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">bump? anyone?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">17th July 2008 23:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by moose517</i><br><b>bump? anyone?</b></blockquote>Don't be an ass, don't bump threads, you are lucky I'm even responding now<br><br><a href="http://nsis.sourceforge.net/Shortcuts_removal_fails_on_Windows_Vista" target="_blank">http://nsis.sourceforge.net/Shortcut..._Windows_Vista</a><br><br>for silent installs, check <a href="http://unattended.sourceforge.net/installers.php" target="_blank">http://unattended.sourceforge.net/installers.php</a></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">moose517</span><br><span class="post-time small text-muted">18th July 2008 00:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">sorry if i sounded rude, i just though the thread had dropped enough to try and get it back to the top to see if anyone had a solution. I tried doing what is described in the first link with the requestexectutionLevel but now when i install it the start menu files fail to be created or deleted. And one more question, i can't get the registry write to work to be able to use the add/remove programs, i followed the example in the documentation to a T and it don't work.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">moose517</span><br><span class="post-time small text-muted">18th July 2008 00:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">NVM, i got it, thanks for your help any ways</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">moose517</span><br><span class="post-time small text-muted">19th July 2008 03:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok, so i thought that i had it, i ran it on an older computer and apparantly it didn't install the dx runtime, do i need to include all the cab files and dlls that are listed in the nsi file for it to be able to install them correctly? grr i thought creating a installer would be easy not hard</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">19th July 2008 14:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Just extract all the required files to $PLUGINSDIR and then run the main executable/msi with the correct switches to make it run silent. What could be easier?<br><br>InitPluginsDir<br>SetOutPath $PLUGINSDIR<br>File ...<br>File ...<br>ExecWait `"$PLUGINSDIR\..." ...` $R0<br>${If} $R0 != 0<br>MessageBox MB_OK error<br>${EndIf}<br><br>Stu</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>