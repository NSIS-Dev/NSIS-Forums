<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="&quot;You'll need to provide Admin Permissions...&quot;" />

  <title>"You'll need to provide Admin Permissions..." - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">"You'll need to provide Admin Permissions..."</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=342190">"You'll need to provide Admin Permissions..."</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Zizzzzy</span><br />
      <span class="post-time small text-muted">14th February 2012 20:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>"You'll need to provide Admin Permissions..."</strong><br />
      I have an installer I had created last year that I just went to go update and test on Windows 7, and seem to only have run into one snag. The installer wraps another installer, so that I could effectively install our Email software with our settings already configured.<br />
      <br />
      Part of the script needs to copy a repair utility I have create to the programs folder inside $PROGRAMFILES. While I have a check "RequestExecutionLevel admin" and a check to make sure the program can not be run as regular user, my CopyFiles is unable to dump the file to this location, error returned is 0<br />
      <br />
      I suspect that it is the Windows security setting that prompts even admin users, for the 'OK' to dump files in Windows protected folders. The wrapped installer program installs fine with no issues writing to the folder, its the single file copy after that is giving me trouble.<br />
      <br />
      How do I get around this?<br />
      <br />
      Thanks in advance.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">14th February 2012 20:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try removing the trailing backstroke.<br />
      <br />
      Edit: Or append repair.exe to the destination path too.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Zizzzzy</span><br />
      <span class="post-time small text-muted">15th February 2012 05:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Doh, thanks Stu your edit got me thinking about repair.exe long enough to realize what was wrong.<br />
      <br />
      After my initial script, I made a template from it to search and replace for quick version updates. When I did so I missed including repair.exe in the folder to be packaged. Sadly it was not running because it was not there to run.<br />
      <br />
      Thanks for your time</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
