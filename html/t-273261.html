<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Does NSIS support driver installation?"><title>Does NSIS support driver installation? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Does NSIS support driver installation?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=273261">Does NSIS support driver installation?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">vc6</span><br><span class="post-time small text-muted">22nd June 2007 21:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Does NSIS support driver installation?</strong><br>I have written a (Windows XP) driver with a corresponding .inf file that can be used in the standard way: Control Panel's Add Hardware.<br><br>However, "Add Hardware" is interactive and now I would like to automate this (preferrably using NSIS).<br><br>Is this possible? Does NSIS have built-in API for handling drivers?<br><br>If so, where do I look?<br><br>Thanks,<br>Victor</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">23rd June 2007 01:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't know try <a href="http://nsis.sourceforge.net/InstDrv_plug-in" target="_blank">this</a>.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Theresias</span><br><span class="post-time small text-muted">23rd June 2007 02:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Check out DPInst, this is according to our experience the best choice - especially when you plan on having your drivers installed on Vista etc.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vc6</span><br><span class="post-time small text-muted">23rd June 2007 19:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Theresias</i><br><b>Check out DPInst, this is according to our experience the best choice - especially when you plan on having your drivers installed on Vista etc.</b></blockquote>Thanks. I was unaware of the existence of DPInst. My initial search yielded this:<br><br><a href="http://msdn2.microsoft.com/en-us/library/ms790308.aspx" target="_blank">Driver Package Installer (DPInst)</a><br><a href="http://msdn2.microsoft.com/en-us/library/ms790308.aspx" target="_blank">http://msdn2.microsoft.com/en-us/library/ms790308.aspx</a><br>msdn2.microsoft.com/en-us/library/ms790308.aspx<br><br>I was not sure whether it supports totally quiet mode (i.e. not even a single dialog prompting the user), but then I found this:<br><br><a href="http://msdn2.microsoft.com/en-us/library/ms791062.aspx" target="_blank">Setting DPInst Configuration Flags</a><br><a href="http://msdn2.microsoft.com/en-us/library/ms791062.aspx" target="_blank">http://msdn2.microsoft.com/en-us/library/ms791062.aspx</a><br>msdn2.microsoft.com/en-us/library/ms791062.aspx<br><br>Could you confirm my understanding that it supports <b>totally</b> quiet installation?<br><br>Thanks also to Joel who provide the link to InstDrv. I will take a look at it too.<br><br>Victor</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Theresias</span><br><span class="post-time small text-muted">23rd June 2007 19:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Depending on the actual OS a fully quite installation would need signed and verified drivers I guess - not sure if you are willing to pay MÂ§ for that. :)<br><br>For my/our purposes DPInst is just fine, so we ended up using that instead of InstDrv which had problems on Vista in our case.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vc6</span><br><span class="post-time small text-muted">24th June 2007 12:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Theresias</i><br><b>Depending on the actual OS a fully quite installation would need signed and verified drivers</b></blockquote>Of course. Thanks for the clarification.<br><br><blockquote><i>Originally posted by Theresias</i><br><b>For my/our purposes DPInst is just fine, so we ended up using that instead of InstDrv which had problems on Vista in our case.</b></blockquote>I believe that I will eventually switch (for the same reasons as yours) to DPInst. For now I am looking into InstDrv since I already have an NSIS script for the entire package that I am writing (which includes a driver).<br><br>Do you happen to know what <b>drvHWID</b> in InstDrv's InstDrv::InitDriverSetup means?<br><br>Is it the same thing as what's under <b>HKLM\SYSTEM\CurrentControlSet\Enum</b>?<br><br>Thanks,<br>Victor</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vc6</span><br><span class="post-time small text-muted">25th June 2007 04:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Never mind. InstDrv turned out to be a total waste of time for me. Its documentation is not that great either.<br><br>I am going to try DPInst now. It is also a better investement (I do intend to eventually target Vista as well, not only XP).<br><br>Thanks,<br>Victor</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JungiX</span><br><span class="post-time small text-muted">12th August 2007 09:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello,<br><br>I have a problem with installing drivers on windows 2k.<br>Our setup installs driver from windows 2k up to vista, so we tried to use DPInst from the DIFx (part of WDK 6000).<br>An older version of the setup used the Inst_Drv plugin (SetupOEMInf) for installation. Switched for vista compatibility.<br><br>It works fine for xp/vista, but on 2k it has a strange behaviour. If an older version of the driver is installed (eigher SetupOEMInf or DPInst) DPInst will not install the newer driver. You have to uninstall the old driver first. I tried the SetupUninstallOEMInf (or similar) until i saw, that api function does not exist in windows 2k. A manual check of the driver version (which works) and then force DPInst to install the driver will only install the driver for a plugged device. Every other devices will still use the old driver.<br><br>Continue using of the Inst_Drv plugin for windows 2k setup seems to end in not installing the driver at all.<br><br>I'm at the end of ideas.<br>I hope one of you can help me with this problem</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Truth Unknown</span><br><span class="post-time small text-muted">27th December 2008 00:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by vc6</i><br>Do you happen to know what <b>drvHWID</b> in InstDrv's InstDrv::InitDriverSetup means?</blockquote>This is the Hardware ID that Windows will use to install drivers, you can also use the Compatibility IDs. This is easily found in the details tab of the Device's Properties page in Device Manager and in the INF file of the driver.<br><br>---<br><br>In my opinion, the InstDRV plugin isn't completely bad, it does have its shortcomings and quirks, but it's usable. Heck, I use it now, but I should really move on to DPInst.<br><br><font size="1">Yes, I know this a 2 month old topic.</font></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br><span class="post-time small text-muted">27th December 2008 04:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">[off topic] Its actually 16 months old :eek: .</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>