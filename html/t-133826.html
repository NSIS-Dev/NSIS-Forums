<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="And the NSI file says &quot;Fix me!&quot;"><title>And the NSI file says "Fix me!" - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">And the NSI file says "Fix me!"</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=133826">And the NSI file says "Fix me!"</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Snover</span><br><span class="post-time small text-muted">1st May 2003 03:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>And the NSI file says "Fix me!"</strong><br>Okay, I'm just about ready to go off the deep end on this one. Anyone that can fix any or all of these problems PLEASE post, heh.<br><br>Problem #1: Adding any other languages besides English causes the license to not show up.<br><br>Problem #2: Check to see if an old version of the program is installed (by checking registry keys of the old MSI installer) does not work.<br><br>Problem #3: DLLs are not registering successfully (yes, I am running as Admin).<br><br>Problem #4: Does not remove its uninstall keys from the registry.<br><br>Problem #5: I cannot detect if a DLL failed to unregister on uninstall since for whatever reason the Error flag is always on (even at the beginning of the section when I run ClearErrors!).<br><br>Problem #6: !insertmacro MUI_UNPAGECOMMAND_CONFIRM doesn't work. (But maybe that's because I wrote !define MUI_UNCONFIRMPAGE something.)<br><br>If someone could also clarify for me how the heck to define an end to a label, I'd be much obliged.<br><br>On the upside, files actually copy, and, the interface works and only the things I tell it to copy copy and the registry keys install.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">1st May 2003 08:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">An end to a label? What an Earth does that mean? A label is a position which can be "goto"'d to. It doesn't have a start or an end, it's just a position.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st May 2003 11:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">1) You have to include a license for every language. Using the same license for all languages is not possible yet (in one command... You can always load the same license for all of them).<br><br>2) You should check for an error right after the first ReadRegStr call and not after both of them. Unless I am wrong and you have wrote both registry keys, one of them will always fail and cause your script to think there are no previous installations.<br><br>3) I need a bit more information... What's the error?<br><br>4) Is the error flag set?<br><br>5) UnregDLL sets the error flag if the DLL couldn't be loaded, the function was not found (DllUnregisterServer), or the functions didn't return S_OK (0).<br><br>6) What's the error?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Snover</span><br><span class="post-time small text-muted">2nd May 2003 17:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by kichik</i><br><b>1) You have to include a license for every language. Using the same license for all languages is not possible yet (in one command... You can always load the same license for all of them).</b></blockquote>Ah. Okay. Except, you see, I was using English language and it was not appearing.<br><br><blockquote><b>2) You should check for an error right after the first ReadRegStr call and not after both of them. Unless I am wrong and you have wrote both registry keys, one of them will always fail and cause your script to think there are no previous installations.</b></blockquote>Good point. Fixed. :D<br><br><blockquote><b>3) I need a bit more information... What's the error?</b></blockquote>Let me read out the error and get back to you on this one.<br><br><blockquote><b>4) Is the error flag set?</b></blockquote>Possibly. Not sure. Will check along with #3.<br><br><blockquote><b>5) UnregDLL sets the error flag if the DLL couldn't be loaded, the function was not found (DllUnregisterServer), or the functions didn't return S_OK (0).</b></blockquote><blockquote><b>6) What's the error?</b></blockquote>No error, it just doesn't try to confirm, but I think this was an error on my part.<br><br>Regarding labels, ah, is that right? Well, what a pain. :P I figured that they were akin to C cases. I guess I'll just put gotos at the end of each of them, then. I really wish NSIS was a bit more like an upper-level programming language (honestly, strip and make some tweaks to PHP and you've got the perfect installation system) but c'est la vie. It's a lot easier than any of the others. :P</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">2nd May 2003 17:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>Ah. Okay. Except, you see, I was using English language and it was not appearing.</blockquote>Attach an example that shows this, the example above has only one language.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Snover</span><br><span class="post-time small text-muted">2nd May 2003 17:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Just uncomment the other languages. :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">2nd May 2003 17:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't have any of the files the script wants, and it does work with the examples. Attach a minial example that uses NSIS's license (${NSISDIR}\license.txt) and then I'll be able to see where the problem is.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Snover</span><br><span class="post-time small text-muted">2nd May 2003 18:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It works fine when I specify /LANG, but not if I don't.<br><br>Anyway, where would the error be if things weren't registering? I printed out $0 through $9 and they're all null except for one of them ($1) that contains the registry string that is supposed to be in there.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">2nd May 2003 18:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You have to specify /LANG or else NSIS won't know which language the license file should be used in. If /LANG isn't specified it uses the last used language which in your case was Turkish.<br><br>If there isn't any error in the details window, and non in the error flag then something went wrong in your function. Maybe it's the working directory. Use SetOutPath to set the working directory.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Snover</span><br><span class="post-time small text-muted">2nd May 2003 18:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by kichik</i><br><b>You have to specify /LANG or else NSIS won't know which language the license file should be used in. If /LANG isn't specified it uses the last used language which in your case was Turkish.</b></blockquote>Ah. That makes sense. Well, I found a bunch of unofficial GNU GPL translations, so whee. :P<br><br><blockquote><b>If there isn't any error in the details window, and non in the error flag then something went wrong in your function. Maybe it's the working directory. Use SetOutPath to set the working directory.</b></blockquote>SetOutPath is set from the start to $INSTDIR. I ran this on a system that an old version of VDMS was installed on without uninstalling it first, so, maybe it just didn't complain because the stuff was already registered. Will try again and get back to you.</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>