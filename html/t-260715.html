<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Vista: Making installed app run in XP compatibility mode" />

  <title>Vista: Making installed app run in XP compatibility mode - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Vista: Making installed app run in XP compatibility mode</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=260715">Vista: Making installed app run in XP compatibility mode</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">theTallGuy</span><br />
      <span class="post-time small text-muted">30th November 2006 00:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Vista: Making installed app run in XP compatibility mode</strong><br />
      I've been testing my installer under Vista lately, and discovered that the installed app doesn't play well with Vista's Aero (glass) UI. (The installer, amazingly, works great without modification. Great work, everyone!)<br />
      <br />
      I would like to somehow mark the app to run in XP compatibility mode, which will force the app into Vista Basic UI (non-glass) mode. In other words, I would like to do the equivalent of right-clicking on the app's .exe file, choosing Properties then Compatibility, and selecting XP compatibility.<br />
      <br />
      Does anyone know how to do this? Or, better yet, avoid this hassle completely? (I was hoping there would be some setting in the Vista manifest to do this, but I can't find it if there is.) Changing the software to be glass-friendly is, unfortunately, not an option giving our release schedule.<br />
      <br />
      Thanks in advance for any help you can offer!<br />
      tTG</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">onad</span><br />
      <span class="post-time small text-muted">30th November 2006 10:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Would you be so kind as to post a screenshot of what you think is not working with AeroGlass and NSIS in Vista?<br />
      <br />
      In the mean time, you could change the message send to a dialog window in .onInit see :<br />
      <a href="http://www.installationexcellence.com/articles/VistaWithDelphi/Index.html" target="_blank">http://www.installationexcellence.co...phi/Index.html</a><br />
      <br />
      for some hints which API calls.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">theTallGuy</span><br />
      <span class="post-time small text-muted">30th November 2006 16:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the link, but the app problem is trickier than that, as certain features need to tie in to the underlying graphics system, and for some reason, they don't work quite correctly with Glass.<br />
      <br />
      I'm sure the problem can be solved, but as we're trying to finish our release candidate by tomorrow, there's no time to break the underlying system. For the moment, the workaround will have to do. We'll solve the Vista issues in the next release when we have more time.<br />
      <br />
      Just to be clear, I'm looking for a way to modify the app's compatibility from the installer. (The problem is *NOT* that the installer has issues with Glass.) I've found one way, which is really, er, a kludge; it involves setting an special environment variable that causes any apps run to work in XP compatibility mode. (I didn't even know that Windows cared about what's in environment variables!) For the curious, you can read about it here:<br />
      <br />
      <a href="http://support.microsoft.com/default.aspx/kb/286705" target="_blank">http://support.microsoft.com/default.aspx/kb/286705</a><br />
      <br />
      But I would prefer a way that only affects my own app. I'm hoping that someone in this forum knows a way to modify an app's compatibility properties, either via plugin or by executing a command-line utility.<br />
      <br />
      Thanks!<br />
      tTG</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th November 2006 18:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">A quick Google search for "disable dwm" came up with a related <a href="http://msdn2.microsoft.com/en-us/library/aa969538.aspx" target="_blank">MSDN article</a>. It doesn't say that'd it cancel everything, but you can control at least some of it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">theTallGuy</span><br />
      <span class="post-time small text-muted">1st December 2006 20:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, Kichik! I'll pass this on to the developers for when we change the code to truly support Vista.<br />
      <br />
      In the meantime, I'm guessing that there isn't any way to set the OS compatibility properties for an app from NSIS other than by the environment string approach. Sigh. Sometimes these new Windows version are really hard on what remains of my hair... :)<br />
      <br />
      Thanks to everyone who responded and tried to help!<br />
      <br />
      tTG</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd December 2006 09:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As far as I remember, when you select compatibility mode for a program, it writes something about it in the registry. You could make that change while running regmon in the background to see what you need to write in the registry to set it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">theTallGuy</span><br />
      <span class="post-time small text-muted">5th December 2006 05:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">RegMon did the trick! For those of you who want to force an app to run in XP compatibility mode, just set the following registry key:<br />
      <br />
      HKCU "Software\Microsoft\Windows<br />
      NT\CurrentVersion\AppCompatFlags\Layers" "[full application path goes here]" "WINXPSP2"<br />
      <br />
      This will hold us until we can do a real fix.<br />
      <br />
      Thanks, Kichik!<br />
      <br />
      tTG</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dbach</span><br />
      <span class="post-time small text-muted">12th December 2007 10:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks theTallGuy/Kichik. I had the same problem. Now, using the key provided by theTallGuy, I am able to solve this problem. Thanks a lot!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cchian</span><br />
      <span class="post-time small text-muted">12th December 2007 16:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In some cases you may want to make that change in HKLM if you want it applied to All Users, I have only used it in XP but should work the same way under Vista.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
