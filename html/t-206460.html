<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Limited user accout"><title>Limited user accout - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Limited user accout</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=206460">Limited user accout</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">saurabhAggarwal</span><br><span class="post-time small text-muted">31st January 2005 14:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Limited user accout</strong><br>Hi<br><br>I have created one installer using NSIS. Accounts that have limited access will not able to run my setup. ie only admin can run my setup.<br>After administrator runs setup, one shortcut is added to the desktop, one folder is created in the start-programs.<br>But the problem is that when the user logins through limited user account he is not able to see that shortcut or SMPROGRAMS entries.<br><br>What registry entry is needed to cure this one<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">scully13</span><br><span class="post-time small text-muted">31st January 2005 15:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Take a look at SetShellVarContext in the documentation.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">saurabhAggarwal</span><br><span class="post-time small text-muted">1st February 2005 04:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hi<br><br>ok by using SetShellVarContext an shortcut is added to all the users in the machine. But I also want to add folder in the start menu just like it is added to admin account. The start menu folder has two things - one is shortcut to exe and another is shortcut to uninstaller.<br>Also one more problem is there - for limited access users openvpn is unable to find the adapter. It says "all tap adapters on this machine are in use" though with admin rights, it works well</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">scully13</span><br><span class="post-time small text-muted">1st February 2005 04:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Just do "SetShellVarContext all" and set up your shortcut or shortcuts to all users and then call it again as "SetShellVarContext current" and then set up your shortcut for the current Admin user. To do "all" your user will have to have Admin rights but for current they won't. There are some user accounts though where the users aren't even allowed to create their own shortcuts. In those cases you probably can't install anything anyway so the Admin will be pushing the installs.<br>As for your second problem you may need to require Admin rights. If you could overcome the limitations of the current users rights what would be the point of having them. The Admin puts those rights in place just to stop such things as installing software or accessing certain things.<br>There is at least one plugin in the Archive that will get you the current users rights and then you can warn them or tell them they need to have Admin rights or whatever.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">saurabhAggarwal</span><br><span class="post-time small text-muted">1st February 2005 05:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok<br>Shortcut problem is fixed now<br>thanks<br><br>Lets talk about my second problem<br>its about OpenVPN. Did you know something about it.<br><br>for limited access users openvpn is unable to find the adapter. It says "all tap adapters on this machine are in use" though with admin rights, it works well</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">scully13</span><br><span class="post-time small text-muted">1st February 2005 13:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The OpenVPN author covers your second issue in his FAQ. It's under "Why can't I run OpenVPN on Windows from a non-admin user account?".</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Mikesch</span><br><span class="post-time small text-muted">1st December 2005 10:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by saurabhAggarwal</i><br><b>Ok<br>Shortcut problem is fixed now<br>thanks<br><br></b></blockquote>What have you done to solve it?<br><br>Mikesch</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>