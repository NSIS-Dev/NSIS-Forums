<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Check filedate" />

  <title>Check filedate - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Check filedate</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=244731">Check filedate</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RitchieRich</span><br />
      <span class="post-time small text-muted">27th April 2006 08:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Check filedate</strong><br />
      Hey people,<br />
      <br />
      I want to make an 'installer' for an database (access ADP)<br />
      I want the installer to check the date from the current ADP on the clients computer..<br />
      If this date is older than the date from the file in my 'update' directory (on the network) , I want the installer to copy it to the clients computer, else.. just start access with the given database..<br />
      Any sugegstions how to check?<br />
      <br />
      Thanks<br />
      <br />
      Richard</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">27th April 2006 08:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Do you want to extract the new file from the installer to the client or just copy it from one net location to another?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RitchieRich</span><br />
      <span class="post-time small text-muted">27th April 2006 09:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey Red Wine,<br />
      <br />
      Thanks for ur reply.<br />
      <br />
      From one location to another..<br />
      What I was thinking; one option is to read a value (version or something) from a INI file in my 'update' directory and compare it to the INI file on the clients PC...<br />
      If it matches.. the installer does 'not run' and if it does not match the installer copy's the ADP file from my network directory to the clients PC..<br />
      Perhaps anyone have a sample script how to perform this??<br />
      <br />
      thanks<br />
      <br />
      Richard</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">27th April 2006 09:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmm, while we're talking here for a db file, is it possible users update the db constantly? they'll loose their records if you're goin to update the file based on an ini string that you added once you've first installed that file. If the db is for read access only, then your thinking about ini should work unless the client for some reason had remove the ini. If you have access to registry will be better. Read the NSIS documentation on how you would manage the readini/writeini and readreg/writereg instructions.<br />
      regards</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RitchieRich</span><br />
      <span class="post-time small text-muted">27th April 2006 10:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey Red Wine,<br />
      <br />
      The access db is a frontend only.. the data is stored on a SQL Server...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">27th April 2006 10:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So if you have access to client's registry I'd suggest a reg record check / compare /update.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RitchieRich</span><br />
      <span class="post-time small text-muted">27th April 2006 10:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok.. I have the following ;<br />
      <br />
      ReadINIStr $1 "W:\DB Updates\Fieldservice.ini" "VERSIONCODE" "VERSION"<br />
      ReadINIStr $2 "C:\Program Files\fieldservice\Fieldservice.ini" "VERSIONCODE" "VERSION"<br />
      <br />
      How can I compare the 2 values.. ?<br />
      If the values MATCH then the installer must quit silently and open a specific file (my database file) , if it DOES NOT MATCH, the installer needs to copy a file from one location to another...<br />
      <br />
      Thanks<br />
      <br />
      Richard</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">27th April 2006 10:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">suggestion: use always numeric values, then IntCmp "value1" "value2" and select your action according to the result. See documentation for IntCmp :-)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RitchieRich</span><br />
      <span class="post-time small text-muted">27th April 2006 10:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Will do..<br />
      thanks!!<br />
      <br />
      Rgds,<br />
      Richard</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RitchieRich</span><br />
      <span class="post-time small text-muted">27th April 2006 10:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">btw: any suggestions for a 'silent' abort?<br />
      So that the user wont have to click 'cancel' ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">27th April 2006 10:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">when you get as comparison result that there is not need for any further action just Quit :-)<br />
      You can do the whole check .onInit and quit before gui comes up.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RitchieRich</span><br />
      <span class="post-time small text-muted">27th April 2006 12:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Great tips!!<br />
      Thanx.. got it up and running now :-)<br />
      <br />
      Richard</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">27th April 2006 12:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">now that you have figured the entire procedure allow me to say that for my opinion this solution is weak while everyone could edit or remove an ini even by accident. I think you sould try to transform the procedure in registry entries :-)<br />
      regards</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
