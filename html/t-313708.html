<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="MUI Finish page - how to show 'show readme' and 'reboot' at the same time"><title>MUI Finish page - how to show 'show readme' and 'reboot' at the same time - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">MUI Finish page - how to show 'show readme' and 'reboot' at the same time</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=313708">MUI Finish page - how to show 'show readme' and 'reboot' at the same time</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">justme123</span><br><span class="post-time small text-muted">12th October 2009 12:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>MUI Finish page - how to show 'show readme' and 'reboot' at the same time</strong><br>Hi,<br><br>i'm creating an installer that requires a reboot and i want to add a checkbox to the finish page that allows to create a shortcut.<br><br>In the main section there is "SetRebootFlag true" and the finish page is created with<br><br></p><pre>
<code><br>!define MUI_FINISHPAGE_SHOWREADME<br>!define MUI_FINISHPAGE_SHOWREADME_NOTCHECKED<br>!define MUI_FINISHPAGE_SHOWREADME_TEXT "Create Desktop Shortcut"<br>!define MUI_FINISHPAGE_SHOWREADME_FUNCTION createDesktopShortcut<br>!define MUI_FINISHPAGE_REBOOTLATER_DEFAULT<br>!insertmacro MUI_PAGE_FINISH<br></code>
</pre><br>
      <br>
      But the finish page only displays the reboot radiogroup.<br>
      <br>
      If i disable reboot support with '!define MUI_FINISHPAGE_NOREBOOTSUPPORT', it shows the checkbox.<br>
      <br>
      I checked Contrib\Modern UI 2\Pages\Finish.nsh and it looks like the calculations for positioning the reboot radiogroup doesn't take the option checkboxes (readme / run) into account.<br>
      Is there any way to reorganize the boxes without changing Finish.nsh?<br>
      <br>
      regards,<br>
      justme123
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br>
      <span class="post-time small text-muted">12th October 2009 15:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This post should get you started:<br>
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=264181" target="_blank">http://forums.winamp.com/showthread....hreadid=264181</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">justme123</span><br>
      <span class="post-time small text-muted">12th October 2009 16:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the pointer to that Thread. Reads like it's what i need.<br>
      <br>
      Unfortunatly it doesn't seem to do the trick with MUI2's finish page and reboot.<br>
      <br>
      Maybe i'm using the wrong fieldindex?<br>
      I assume there are 5 fields in a finish page (image, header,text,rebootnow,rebootlater) so using field 6 as in that example should work, but it does not :/<br>
      <br>
      As a workaround, i've created a new custom page with a checkbox for the shortcut. Overkill for a single checkbox, but it looks like there are more to come anyways.<br>
      <br>
      ps. i know about sections/components, but the components page layout is a bit cluttered. If anyone knows how to strip it down to just a list of checkboxes (no description pane that eats half the horizontal space, no additional border) i'd be happy to use that.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tom_q</span><br>
      <span class="post-time small text-muted">26th June 2013 15:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As it stands, there is still no way (that I know of) to fix this in MUI.<br>
      <br>
      I understand the rationale of hiding readme and run program in case of a reboot. However this could have been worked around by launching the program or showing the readme after the reboot (registry, runonce).<br>
      <br>
      Besides, since these buttons are hidden, any other use of the checkboxes (e.g. for links) is also made impossible when a reboot is needed.<br>
      <br>
      I'm currently looking towards manually designing the entire finish page with nsdialogs instead. Does anyone know of a fix that involves less work?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">26th June 2013 18:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can add your own controls in MUI2 in the show callback for the finish page...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br>
      <span class="post-time small text-muted">26th June 2013 22:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, see <a href="http://stackoverflow.com/questions/6531115/customizing-an-exsisting-nsis-mui2-page" target="_blank">here</a> for an example.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tom_q</span><br>
      <span class="post-time small text-muted">4th July 2013 09:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks! Will do that.<br>
      <br>
      Edit: sorry for coming back again so soon... I tried the proposed solution; I first tried adapting it to my code, and when this didn't work I copied what Anders posted on StackOverflow (slightly simplified here):<br></p>
      <pre>
<code><br>var Checkbox<br><br>Function MyFinishShow<br>  ${NSD_CreateCheckbox} 120u 110u 100% 10u "Something"<br>  Pop $Checkbox<br>FunctionEnd<br><br>!define MUI_PAGE_CUSTOMFUNCTION_SHOW MyFinishShow<br>!insertmacro MUI_PAGE_FINISH<br></code>
</pre><br>
      <br>
      This compiles fine but crashes on execution when the finish page loads ("... has stopped responding").<br>
      <br>
      Based on messagebox debugging, the crash occurs on this specific line:<br>
      <br>
      ${NSD_CreateCheckbox} 120u 110u 100% 10u "Something"<br>
      <br>
      The same thing happens when using a Label instead of CheckBox. I'll keep working on it if/when I find time, although I'll probably go for rewriting the finish page. But if anyone has another solution (or figures out why my code doesn't execute properly) it will be much appreciated! Additional info: using NSIS 2.46.<br>
      <br>
      ... Alternatively, if anyone knows how to include new lines in the finish page label, that could also help me (that way I would just change the label text instead of adding a label). Setting MUI_FINISHPAGE_TEXT works for text... but anything that follows a "$\n" isn't shown (I don't know what to attribute this to; maybe the label height is not correctly set when there are newlines? The finish page label shows very long wrapped text string just fine). "$\n" works fine in message boxes or custom page labels.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tom_q</span><br>
      <span class="post-time small text-muted">4th July 2013 17:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Problem solved. I was still including MUI.nsh instead of MUI2.nsh, hence the crash.<br>
      Thanks again everyone.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>