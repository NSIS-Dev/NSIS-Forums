<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Can Abort from MUI Pre fn, but not from MUI Leave fn" />

  <title>Can Abort from MUI Pre fn, but not from MUI Leave fn - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Can Abort from MUI Pre fn, but not from MUI Leave fn</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=139990">Can Abort from MUI Pre fn, but not from MUI Leave fn</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Lilla</span><br />
      <span class="post-time small text-muted">24th June 2003 20:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Can Abort from MUI Pre fn, but not from MUI Leave fn</strong><br />
      I am using latest CVS, updated yesterday. This is using Win98SE with latest updates.<br />
      <br />
      According to the documentation, chapter 4...<br />
      Callbacks. Use Abort from a built-in page's pre-function to skip the page, and from a built-in page's leave-function to stay in the page.<br />
      <br />
      Test Results: I tried using abort from the StartMenu's pre function, and it worked as documented above. But it does not work as documented above when used in the StartMenu's leave function. My code is shown below.<br />
      <br />
      Problem. Below I am using Abort in the leave-function, it gives the error message, so it is seeing the Abort command but it DOES NOT stay in the page as the documentation (see above) says it should. Instead, it moves on to the next page. Method 2 (see below) doesn't work either.<br />
      <br />
      I add the following code to the StartMenu.nsi, compile and test.<br />
      <br />
      !define MUI_CUSTOMFUNCTION_STARTMENU_LEAVE StartMenuPage_Leave<br />
      <br />
      Method 1.<br />
      <br />
      Function StartMenuPage_Leave<br />
      StrCmp ${MUI_STARTMENUPAGE_VARIABLE} "${MUI_PRODUCT}" PathGood<br />
      MessageBox MB_OK|MB_ICONSTOP "Please correct. This path must end with: \${MUI_PRODUCT}"<br />
      Abort<br />
      PathGood:<br />
      FunctionEnd<br />
      <br />
      <br />
      Method 2.<br />
      <br />
      Function StartMenuPage_Leave<br />
      StrCmp ${MUI_STARTMENUPAGE_VARIABLE} "${MUI_PRODUCT}" PathGood<br />
      Abort "Please correct. This path must end with: \${MUI_PRODUCT}"<br />
      PathGood:<br />
      FunctionEnd<br />
      <br />
      <br />
      Is this a bug, or a feature that's not finished yet?<br />
      If I should post this as a bug report, please advise.<br />
      <br />
      Thanks,<br />
      Lilla</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">24th June 2003 20:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for reporting this issue :D Fixed and uploaded :)<br />
      <br />
      Note that it might take up to 24 hours before public CVS will be updated (because of SF CVS server issues).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Lilla</span><br />
      <span class="post-time small text-muted">24th June 2003 21:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Wow! fast fix!<br />
      <br />
      Thank you,<br />
      Lilla</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
