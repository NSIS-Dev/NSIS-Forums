<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="VPatch patch generator - Van de Sande"><title>VPatch patch generator - Van de Sande - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">VPatch patch generator - Van de Sande</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=64353">VPatch patch generator - Van de Sande</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">mcgarrah</span><br><span class="post-time small text-muted">31st October 2001 17:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>VPatch patch generator - Van de Sande</strong><br>I'm probably going to need to use vpatch sometime soon to provide updates for an install I'm putting together. I was wondering what the GenPat.exe was written in and if the source is available.<br><br><a href="http://www.tibed.net/h_vpatch" target="_blank">http://www.tibed.net/h_vpatch</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Koen van de Sande</span><br><span class="post-time small text-muted">31st October 2001 18:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It was written in Borland Delphi 5.<br>I once had a (different) version in Visual Basic, but that was very slow.<br>The source isn't available (yet). It's a big mess (if I remember correctly). I was going to make a GUI for it but I forgot/lost interest/was busy, take your pick.<br>I have more time now so I might make a GUI, but I'll have to see 'bout that. If you want to have a look at the source, that's possible, but I'm not really sure what could be improved (the exe header was written in C by Edgewize). A few bytes more could be saved, but since they are quite small, that's not really an issue.<br>Configuring it properly is more important, and I'm the only one who knows how to do that - hence the need for a GUI.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Koen van de Sande</span><br><span class="post-time small text-muted">1st November 2001 18:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've just been working on a GUI... and it's coming along nicely. It's not finished yet (because you can't actually create patches yet), but you can select new/old files properly.<br>About your e-mail:<br>I'll have a new version in a few days so I'll send it to you then (if all goes well, that is).<br>Converting the actual GenPat program to C/C++ is a nice thing to do, because you might gain some speed, but I don't think you actually need it - thinking about a better algorithm is more important. Any suggestions?<br>Edgewize's runtime: I need to add that it'll return error levels (or exit codes some people call it). 0 if all went well, 1 if the file is already up to date, 10 if no patch file found, etc. I already put it in the Delphi runtime, but that's 27 KB so just for me testing :)<br>If you could find out how to do ExitCodes/Errorlevels in C/C++ that would really help - because then NSIS can know what went wrong in the patching proces.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Koen van de Sande</span><br><span class="post-time small text-muted">1st November 2001 20:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm replying to myself again. Anyway, some news:<br><br>The Edgewize runtime has been modified by me, now it's only 3 KB! (instead of 4 KB). If it's compressed by NSIS, it's only 1367 bytes!<br>I took out the messageboxes (you can now turn them of by using #define NO_MESSAGEBOX). Also, it now returns an error level (I think, haven't tested yet). It now also checks to see if the file is already up to date - which returns a different errorlevel.<br><br>I'll release something soon :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mcgarrah</span><br><span class="post-time small text-muted">2nd November 2001 14:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'll be waiting for it. Great to hear about the C header shrinking.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Koen van de Sande</span><br><span class="post-time small text-muted">2nd November 2001 19:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I spent my entire free day on the GUI (OK not the entire) but it's actually working now.<br>The GUI itself doesn't look very complex, the way to choose compression probably isn't very good yet, but for the first version it'll have to do.<br>I still have to find a bug where saving your 'patch project' to disk doesn't correctly cache generated changes, check if the patch generator works properly in all modes, have to package and have to make something which will generate NSIS code for you. At this moment, it just generates the VPatch.exe (you can now rename it:)<br>And I fixed a bug I created in the C runtime - when the file was already up to date, I deleted it (oops). And if you used the optimized version, the output file was always deleted (oops forgot to copy an if-statement).<br>I think I'll have something tomorrow. ZLIB-ed C++ header is still around 1375 bytes.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Koen van de Sande</span><br><span class="post-time small text-muted">3rd November 2001 11:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It's here.<br>I started a new thread on this new version.<br>See <a href="http://www.tibed.net/vpatch" target="_blank">http://www.tibed.net/vpatch</a><br>or <a href="http://www.tibed.net/cgi-bin/schlabo/dl.pl?vpatch" target="_blank">http://www.tibed.net/cgi-bin/schlabo/dl.pl?vpatch</a> for download.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>