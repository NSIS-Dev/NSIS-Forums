<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Matching Start In folder with Target" />

  <title>Matching Start In folder with Target - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Matching Start In folder with Target</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=202770">Matching Start In folder with Target</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Artmageddon</span><br />
      <span class="post-time small text-muted">22nd December 2004 17:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Matching Start In folder with Target</strong><br />
      Hey, I'm a bit of a newbie here, so I hope I won't get flamed too badly for asking this question here :)<br />
      <br />
      Ok, I'm trying to install two applications with a single installer. I want them to have the same root folder $INSTDIR(C:\Program Files\My Game Bundle), where Game1 would be<br />
      <br />
      $INSTDIR\Game1<br />
      and Game2 would be<br />
      $INSTDIR\Game2<br />
      <br />
      The game files for each game would be in their respective directories, with the uninstaller lying in the top level folder($INSTDIR). While I can get the files copied to the correct location, the problem I'm having is with the shortcuts. With windows shortcuts, you have a "Target" path which links directly to the executable. The "Start In" shortcut links to the top level folder, $INSTDIR. This doesn't work out correctly with Game1, which needs to point directly at the folder in which the exe is located(it has to do with the way the game engine looks for files). How do I make the "Start In" folder point at the same folder the "Target" path is at?<br />
      <br />
      Yes, I did try searching for this too...but otherwise, have mercy :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">22nd December 2004 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use SetOutPath first.<br />
      <br />
      E.g.<br />
      SetOutPath "C:\blah"<br />
      CreateShortcut "$SMPROGRAMS\blah.lnk" "C:\blah\blah2k.exe"<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Artmageddon</span><br />
      <span class="post-time small text-muted">22nd December 2004 17:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, I'm using SetOutPath to copy all the files and what not, and I install all of the files before creating the shortcut. Now the shortcut finds the exe just fine. The problem is though with the way the game engine is, we need both the "start in" path to directly match the target path. Not to question your wisdom, but I don't know if what you mentioned will be enough.. :)<br />
      <br />
      (What you have written is pretty much how my Shortcut is made, with the exception that I'm doing the SetOutPath a few lines earlier in the script. I don't think that should make a difference though.)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">22nd December 2004 17:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So basically you want your shortcut to target C:\blah\blah.exe and to start in C:\blah\blah.exe?<br />
      <br />
      Try to use:<br />
      SetOutPath "C:\blah\blah.exe"<br />
      <br />
      Be warned though that NSIS will create a folder called "C:\blah\blah.exe" :D<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
