<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Create a JSON variable in an NSIS script" />

  <title>Create a JSON variable in an NSIS script - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Create a JSON variable in an NSIS script</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=373566">Create a JSON variable in an NSIS script</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Re DeL SiLeNziO</span><br />
      <span class="post-time small text-muted">8th November 2013 10:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Create a JSON variable in an NSIS script</strong><br />
      Hi all,<br />
      I'm a new user of this forum and I'm a newbie of NSIS installer and JSON.<br />
      Unfortunately, I've to make an NSIS script that, taking values from a form in the installer, will create a JSON, in order to make an http request.<br />
      <br />
      The question is, it is possible to create a json variable in nsis? All threads I've seen, talking about a json file for input, but in this case, I should have a json variable for output.<br />
      It is possible? I took a look to nsJSON plugin, but I don't know if it is the right plugin..<br />
      <br />
      Thanks!<br />
      Re DeL SiLeNziO</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">8th November 2013 10:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://forums.winamp.com/showthread.php?t=345802" target="_blank">http://forums.winamp.com/showthread.php?t=345802</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Re DeL SiLeNziO</span><br />
      <span class="post-time small text-muted">8th November 2013 13:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">mmm ok, I've already read this thread but I need some explaination...<br />
      <br />
      the example of thread says:<br />
      <br /></p>
      <pre>
<code>nsJSON::Set `more_stuff` `PSCHED_009_NAME` /value `QoS Packet Scheduler`</code>
</pre><br />
      <br />
      in this case, where is the variable containing my data?<br />
      How can I do an http call?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Re DeL SiLeNziO</span><br />
      <span class="post-time small text-muted">8th November 2013 16:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I tried to use nsJSON but, when compile I obtain:<br /></p>
      <pre>
<code>Invalid command: nsJSON::Set</code>
</pre><br />
      <br />
      this is my code:<br />

      <blockquote>
        ...<br />
        !include MUI2.nsh<br />
        ....<br />
        Page custom nsDialogsPage<br />
        ...<br />
        Function nsDialogsPage<br />
        SetOutPath "$INSTDIR\bin"<br />
        File "..\bin\nsJSON.dll"<br />
        <br />
        nsDialogs::Create 1018<br />
        Pop $Dialog<br />
        ${If} $Dialog == error<br />
        Abort<br />
        ${EndIf}<br />
        <br />
        ${NSD_CreateLabel} 0 0 100% 12u "Registering a new AIC"<br />
        Pop $Title<br />
        <br />
        ${NSD_CreateLabel} 0 20 20 12u "AIC:"<br />
        Pop $LabelAIC<br />
        ${NSD_CreateText} 40 20 80 12u ""<br />
        Pop $TextAIC<br />
        <br />
        ${NSD_GetText} $TextAIC $prova<br />
        <br />
        nsJSON::Set /value `{}`<br />
        nsJSON::Set `aic` /value `"$prova"`<br />
        nsJSON::Serialize /format /file c:\Temp\test.json<br />
        DetailPrint `Generate: c:\Temp\test.json`<br />
        <br />
        nsDialogs::Show<br />
        FunctionEnd
        <hr />
      </blockquote>
    </div>
    <hr />
    Should I include anything else?!<br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">8th November 2013 22:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Invalid command probably means it cannot find the plugin, use !addplugindir...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Re DeL SiLeNziO</span><br />
      <span class="post-time small text-muted">11th November 2013 11:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Anders</small><br />
        Invalid command probably means it cannot find the plugin, use !addplugindir...
      </blockquote>Ok!! Thanks! With addplugindir works!<br />
      In order to take the value of my ${NSD_CreateText} I used NSD_GetText:<br />
      Quote:
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Re DeL SiLeNziO</span><br />
        <span class="post-time small text-muted">13th November 2013 13:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Ok, solved! My mistake... :(</p>
      </div>
      <hr />

      <div class="footer">
        <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
      </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
      hljs.initHighlightingOnLoad();
      //]]>
      </script>

      <table cellpadding="6" cellspacing="0" border="0" width="100%">
        <tr>
          <td class="alt2">
            <hr />
            ...<br />
            Var a<br />
            ...<br />
            ${NSD_CreateText} 40 20 80 12u ""<br />
            Pop $txt<br />
            <br />
            ${NSD_GetText} $txt $a<br />
            <br />
            nsJSON::Set /value `{}`<br />
            nsJSON::Set `VARTEXT` /value `"$a"`<br />
            nsJSON::Serialize /format /file c:\Temp\test.json<br />
            DetailPrint `Generate: c:\Temp\test.json` but, even if I write some text in the field my var $a is empty and my json result is:<br />
            <br />

            <blockquote>
              {<br />
              "VARTEXT": ""<br />
              }
            </blockquote>Where is the error?! :( :cry:<br />
            <br />
            thanks so much!!!!
          </td>
        </tr>
      </table>
    </div>
  </div>
</body>
</html>
