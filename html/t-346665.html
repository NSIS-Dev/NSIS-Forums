<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="EnumRegKey prob."><title>EnumRegKey prob. - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">EnumRegKey prob.</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=346665">EnumRegKey prob.</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">o___O</span><br><span class="post-time small text-muted">30th July 2012 10:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>EnumRegKey prob.</strong><br>Trying to get a list of currently installed application compatibility databases on Windows 7 64-bit. The key location is: HKLM "SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\InstalledSDB" - when I try to EnumRegKey it, it returns nothing, even with two subkeys present, both are GUIDs. My script works fine to Enum most other keys. SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags tho only returns one, Custom, but there are at least 5 subkeys there. Odd? Why won't EnumRegKey's return all the keys that are there?<br><br>I am using a ${DoUntil} loop to go through the entire list, these particular locations aren't being listed or only partially listed.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">30th July 2012 10:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">SetRegView 64?<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o___O</span><br><span class="post-time small text-muted">31st July 2012 06:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">yes! it works. now this made me aware that sdb's installed must use the correct version, either in WOW64 or 64-bit mode.<br><br>the real problem for me is these all should have been aviailable in 32-bit registry, but to fix a problem with another NSIS issue, I am detecting x64 and disabling file redirection. You actually might remember last year I found an issue where if you install a shortcut to a 32-bit program in C:\Program Files (x86)\ on x64 using NSIS 32-bit, the shortcut icon path might be missing or set incorrectly. Hense icons disappear after certain conditions in Windows are met, or you go to right-click, properties, change icon, and it says the path can't be found. It's because the path on the shortcut is pointed at C:\Program Files\ instead of C:\Program Files (x86). I think something somewhere in NSIS or Windows, something is getting confused in regards to how it handles installing 32-bit apps in a 64-bit environment and handling all the special pathways and different environment versions. But I don't yet know if this actually fixes the shortcut issue, in my earlier testing it worked but I haven't done a thorough examination. Like I would have to test an old version of the code to see if it's stil affected or not.<br><br>But when I detect x64 and disable file redirection, it also makes it so that commands I run are done in the 64-bit environment, thus registry keys and whatnot are ending up 64-bit. I will fix this and hopefully not have to worry about this problem again.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>