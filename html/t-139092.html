<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Mui Startmenu Page Woes"><title>Mui Startmenu Page Woes - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Mui Startmenu Page Woes</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=139092">Mui Startmenu Page Woes</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">dsteenburg</span><br><span class="post-time small text-muted">15th June 2003 06:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Mui Startmenu Page Woes</strong><br>Hi.<br><br>I have incorporated the script from the sample StartMenu.nsi script virtually intact to the script I am writing. However, when I compile my script, I get a warning:<br><br>unknown variable "{MUI_STARTMENUPAGE_VARIABLE}" detected, ignoring<br><br>It does this eleven times: two times before my CreateShortcut commands, once for each of my eight CreateShortcut commands, and then once following.<br><br>Any suggestions on how to correct this. As far as I can tell, my usage is exactly like that in the StartMenu.nsi script.<br><br>Dave<br><br>PS Originally I got the MUI example files off the "NSIS Modern User Interface" page at the sourceforge.net site. None of the ones I tried would compile--just error messages. Then I discovered the ones in the Examples\ModernUI directory, and these did work. Comparing the files, it looks like the ones on the sourceforge site are old scripts that no longer work. Might want to update these.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">15th June 2003 06:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Did you:<br>1. use ${MUI_STARTMENUPAGE_VARIABLE}.<br>2. Put !Include "MUI.nsh" on top.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">15th June 2003 12:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The SF CVS server contains all files (from the olders to the newest versions). Please download the latest development snapshot at <a href="http://nsis.sf.net" target="_blank">http://nsis.sf.net</a> (or use NSIS Update or other CVS client).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dsteenburg</span><br><span class="post-time small text-muted">17th June 2003 18:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry it has taken so long to get back to this--life took me away.<br><br>Yes, lobo, I did use ${MUI_STARTMENUPAGE_VARIABLE}. Following the StartMenu.nsi example, I saw no place where it was defined, so I figured it had to have been defined in one of the functions behind the scenes. The example says to define it only if you want to change the variable used from $9 to something else.<br><br>And yes, I did include MUI.nsh at the top.<br><br>So is there something I am missing?<br><br>Dave</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">17th June 2003 19:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">So you got the latest development version (Modern UI 1.65)?<br><br>Make sure that your script looks the same as the new examples (with the new page macro's).<br><br>There must be an error in your script, so please attach it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dsteenburg</span><br><span class="post-time small text-muted">17th June 2003 20:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oops.<br><br>Now I see what I missed. I forgot<br><br>!define MUI_STARTMENUPAGE<br><br>Sorry to trouble you over such a simple mistake.<br><br>Dave</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">17th June 2003 21:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The latest Modern UI doesn't use that define anymore. If you upgrade to Modern UI 1.65, make sure to use the new page macro's.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dsteenburg</span><br><span class="post-time small text-muted">17th June 2003 22:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've now updated to 1.65 and will try it out. Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hunt</span><br><span class="post-time small text-muted">18th July 2003 22:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I had the same problem when I was using $MUI_TEMP as the variable name (which I adopted from an example), and when I switched to $R0, it worked just fine.<br><br>However, when I run the installer, customizing the start menu folder has no effect. The start menu is always the same. Any ideas on how to change that?<br><br>PS. is there any way to build into the start menu MUI page a checkbox that determines if the shortcuts be made for all users or just the current user?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hunt</span><br><span class="post-time small text-muted">18th July 2003 23:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here's the script I've been working on, in case it's easier to just have a look.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">19th July 2003 13:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try latest CVS version for the problems with $MUI_TEMP. As for not being able to customize start menu I don't see any problem. The texts you have entered show up on the white frame on the top.<br><br>There is no way to build another checkbox into the StartMenu page.<br><br>BTW, you need to remove the page defines and only use macros to insert pages.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>