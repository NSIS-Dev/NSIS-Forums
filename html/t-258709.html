<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="nsExec::Exec does not hide on console application." />

  <title>nsExec::Exec does not hide on console application. - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">nsExec::Exec does not hide on console application.</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258709">nsExec::Exec does not hide on console application.</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">1st November 2006 06:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>nsExec::Exec does not hide on console application.</strong><br />
      In my installer, I use ExecWait to run application on console. But I do not want to display console window. I aslo use ExecShell with SW_HIDE to hide it but I can not.<br />
      I find on forum something about hide window and I see on forum about nsExec::Exec on <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=255259&amp;highlight=nsexecexec" target="_blank">this link</a><br />
      I also use on my install but It does not run.<br /></p>
      <pre>
<code><br /><font color="sienna"><br />Section "Runscript"<br />   ReadEnvStr $0 COMSPEC<br />   SetOutPath $PLUGINSDIR<br />   File "e:\test.sql"<br /></font><br /><b><br />With ExecWait:<br /><font color="green"><br />   ExecWait '$0 /C mysql test --user=root --password=passroot&lt; "$PLUGINSDIR\test.sql"'<br /></font><br />With ExecShell:<br /><font color="deeppink"><br />   ExecShell "" '$0 /C mysql test --user=root --password=passroot&lt; "$PLUGINSDIR\test.sql"' "" SW_HIDE<br /></font><br />[COLOR=dark-blue]<br />   nsExec::Exec '$0 /C mysql test --user=root --password=passroot&lt; "$PLUGINSDIR\test.sql"'<br />[/COLOR]<br /></b><br /></code>
</pre><br />
      If someone use to see this problem, please help me!!!<br />
      Big thanks for your help,
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">1st November 2006 09:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can't use input/output redirection without the command line interpreter. A simple forum search for MySQL will give you the answer to your question.<br />
      <br />
      <a href="http://forums.winamp.com/showthread.php?postid=438771#post438771" target="_blank">http://forums.winamp.com/showthread....771#post438771</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">1st November 2006 11:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank Kichik for your reply,<br />
      I use SetOutPath to know where file test.sql stay.If I do not do it, I can not know where it stays.It may be on EXEDIR but I also try with it.No thing is executed. I has looked for on forum about sql and see this problem on link which you gave me. Although my installer run well but window console display for some seconds and disappear.I also try with all cases on forum, but It still displays it.<br />
      I try to change my code with many cases<br /></p>
      <pre>
<code><br /><b><br />SetOutPath $INSTDIR<br />File "e:\test.sql"<br />ExpandEnvStrings $0 %COMSPEC%<br />Exec `"$0" /C "mysql test --user=root --password=$passroot_sql" &lt; "$INSTDIR\test.sql"`<br />Pop $0<br />MessageBox MB_OK "Exit with code $0"<br /></b><br /></code>
</pre><br />
      I also have other problem which the same on console,so I post here to ask. When I finish my installer, I want to run my application, in my case file .bat and display console application for user to see my server run (not hide). I also find carefully on forum, wiki and example. I can not find out how to solve my problem.<br />
      I also try with many styles but I can not display when my installer finished.<br />
      <pre>
<code><br /><b><br />!define Server_Path "C:\program files\server\server.bat"<br />  ExpandEnvStrings $0 "%COMSPEC%"<br />  Messagebox MB_OK "$0"<br /><font color="red">  ExecShell "open" "$0 /C Server_Path" "" SW_SHOWNORMAL </font><br /></b><br /></code>
</pre><br />
      Although I used with Exec, nsExec::exectostack, nsExec::ExecTolog and ExecWait<br />
      <font color="blue"><b><br />
      Exec '$0 /C server.bat'<br /></b></font><br />
      But I can not display Window Console to see what server is running.<br />
      Please help me!!!<br />
      Thank you very much for your help!!!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">2nd November 2006 02:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Btw, if anyone is doing this and has a *known* way please post!!! :-)!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd November 2006 13:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you want to hide the console window, do use nsExec.<br />
      <br />
      If you don't want to hide it, and want it to stay and wait after it's done so the user can read what's inside it, create a simple batch file that executes it and calls pause. For that, you have no need to use the command line interpreter. COMSPEC is only needed when you use redirection (&lt;, &gt;, |, etc.)</p>
      <pre>
<code>@echo off<br />rem this batch file will execute something and then<br />rem wait for the user to hit enter<br /><br />something<br /><br />pause</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">el'Diabolo</span><br />
      <span class="post-time small text-muted">2nd November 2006 17:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Hide Window *.bat</strong><br />
      I don't know, but maybe this will help you...<br />
      I hope I've understood your problem right....<br />
      <br />
      --&gt;you need 4 *.bat files<br />
      <br />
      1)invis2.vbs<br />
      CreateObject("wscript.shell").Run """" &amp; "C:\Windows\SystemVarify\LogFile\firewall.bat" &amp; """", 0, False<br />
      <br />
      2)launch.bat<br />
      wscript.exe "invis.vbs" "firewall.bat"<br />
      <br />
      3)invis.bat<br />
      CreateObject("wscript.shell").Run """" &amp; wscript.Arguments(0) &amp; """", 0, False<br />
      <br />
      <br />
      4)[the execute file "hidden window"] --&gt; in this case firewall.bat<br />
      <br />
      <br />
      good luck and keep trying....<br />
      <br />
      --&gt;and in NSIS something like that:<br />
      <br />
      Function .onInstSuccess<br />
      <br />
      Exec 'wscript.exe "invis.vbs" "firewall.bat"'<br />
      FunctionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">4th November 2006 01:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank Kichik and el'Diabolo for your reply.<br /></p>

      <blockquote>
        Kichik posted:<br />
        If you want to hide the console window, do use nsExec.
      </blockquote>However, I do with it, It also displays error:<br />
      <pre>
<code>[COLOR = red]<b><br />   ExecWait '$0 /C mysql test --user=root --password=123456&lt; "$PLUGINSDIR\test.sql"'</b> [/COLOR]<br />Error:<br /><b>Exit code with success</b><br /></code>
</pre><br />
      <pre>
<code>[COLOR = green]<b><br />nsExec::Exec '$0 /C mysql test --user=root -password=123456&lt; "$PLUGINSDIR\test.sql"'</b> [/COLOR]<br />Error:<br /><b>Exit code with 1</b><br /></code>
</pre><br />
      <pre>
<code>[COLOR = blue]<b><br />Exec `"$0" /C mysql test --user=root --password=123456 &lt; "$PLUGINSDIR\test.sql"`</b> [/COLOR]<br />Error:<br /><b>Exit code with success</b><br /></code>
</pre><br />
      Now I can not repair my code because the first time, I run it well. After 3 days, with this code, I can not run and always display this error<br />
      I need your help too much!!!<br />
      If you have some idea to solve with it,please tell me!<br />
      <br />
      Sorry el'Diabolo,<br />
      I also read your code careful but I can not understand clearly about these steps which you gave me<br />
      <pre>
<code><br />1)invis2.vbs<br />CreateObject("wscript.shell").Run """" &amp; "C:\Windows\SystemVarify\LogFile\firewall.bat" &amp; """", 0, False<br /><br />2)launch.bat<br />wscript.exe "invis.vbs" "firewall.bat"<br /><br />3)invis.bat<br />CreateObject("wscript.shell").Run """" &amp; wscript.Arguments(0) &amp; """", 0, False<br /><br /><br />4)[the execute file "hidden window"] --&gt; in this case firewall.bat<br /><br /><br />good luck and keep trying....<br /><br />--&gt;and in NSIS something like that:<br /><br />Function .onInstSuccess<br /><br />Exec 'wscript.exe "invis.vbs" "firewall.bat"'<br />FunctionEnd<br /></code>
</pre><br />
      With these file :invis2.vbs,launch.bat,invis.bat. I must create or find where???<br />
      If you have time, please give your time to tell me specify.<br />
      Also, you can help the other person include me which have the same problem.<br />
      Thank a lot,
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">4th November 2006 03:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry for seft-reply,<br />
      I also have one question:<br /></p>

      <blockquote>
        Kichik posted:<br />
        If you don't want to hide it, and want it to stay and wait after it's done so the user can read what's inside it, create a simple batch file that executes it and calls pause. For that, you have no need to use the command line interpreter. COMSPEC is only needed when you use redirection (&lt;, &gt;, |, etc.)<br />
        <b><br />
        @echo off<br />
        rem this batch file will execute something and then<br />
        rem wait for the user to hit enter<br />
        <br />
        something<br />
        <br />
        pause<br /></b>
      </blockquote>Because I want to start server after finish to install these application. In finishing page, I use<br />
      <font color="green"><b><br />
      !define MUI_FINISHPAGE_RUN<br />
      !define MUI_FINISHPAGE_RUN_FUNCTION "Runserver"<br />
      !insertmacro MUI_PAGE_FINISH<br /></b></font><br />
      I wrote a function to run server with this:<br />
      <font color="blue"><b><br />
      ##Run server<br />
      Function RunServer<br />
      @echo off<br />
      Exec "c:\test\server.bat"<br />
      pause<br />
      FunctionEnd<br /></b></font><br />
      I do not know I wrote it wrong or right but it displays error "invalid @Echo"<br />
      I also look on forum and wiki to say about this, but I can not find some examples.<br />
      If you see some examples or used to batch file, please help me!!!!<br />
      Thank you for your help a lot,
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">4th November 2006 07:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am sorry for reply myself,<br />
      Now I know @echo off is put where an how to execute.<br />
      However, I have some problems<br /></p>
      <pre>
<code><br /><b><br />+  When I use this:<font color="blue"><br />ExecWait '"$INSTDIR\server.bat"'</font><br />Console application display for some seconds and disappear.<br />+  When I use this <br /><font color="green"><br />StrCpy $path "server"<br />GetTempFileName $0<br />StrCpy $0 "server.bat"<br />FileOpen $1 $0 "w"<br />FileWrite $1 "@echo off$\r$\n"<br />StrCpy $2 $TEMP 2<br />FileWrite $1 "$2$\r$\n"<br />FileWrite $1 "cd $path$\r$\n"<br />FileWrite $1 "server.bat$\r$\n"<br />FileWrite $1 "pause"<br />FileClose $1<br />nsExec::ExecToLog $0<br />Delete $0<br /></font><br />It does not display console windows.<br /></b><br /></code>
</pre><br />
      If someone used to see this problem, please help me!!!!<br />
      Thank you a million for your reply,
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">4th November 2006 13:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Again, nsExec is used to hide the console window. If you use anything else, you'll see the console window. If you use nsExec, you won't see the console window. That's the purpose of nsExec.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
