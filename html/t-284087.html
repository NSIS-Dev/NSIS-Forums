<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="ExecWait + InstallShield v11 and v12 question"><title>ExecWait + InstallShield v11 and v12 question - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">ExecWait + InstallShield v11 and v12 question</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=284087">ExecWait + InstallShield v11 and v12 question</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">o_owd</span><br><span class="post-time small text-muted">31st December 2007 10:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ExecWait + InstallShield v11 and v12 question</strong><br>Hello,<br><br>I have a problem with my installer. Actually the problem is not ExecWait. Let me explain.<br><br>I have my installer (NSIS) that must wait for a InstallShield setup and an update for that InstallShield setup. The update is InstallShield. I have three installers like this. Two of them must wait for v11 InstallShield and the third for a v12 InstallShield.<br>When I run my installer from the HDD everything works as it should. ExecWait works.<br>If I try the same thing from a CD/DVD it does not work.<br>Probably InstallShield launches a new process because it cannot write anything on the CD/DVD.?! Anyway, this is my logic.<br>As I said, I do not believe it is a ExecWait problem.<br><br>What can I do ? I searched in TEMP folder after I started the InstallShield setup and I cannot find any .msi file.<br><br>Sorry for the long post and sorry for my english.<br>Thanks in advance,<br>OJi.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">31st December 2007 11:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What about command line switches?<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_owd</span><br><span class="post-time small text-muted">31st December 2007 11:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What command line switches ?<br><br>I do not want to make a unattended install. The user must select options/configs from the IS setup.<br><br>I found in NSIS wiki "Check whether your application is running during uninstallation". This can help me. I can check if IS is running or not. But the part where IS is starting and I have only a progressbar - "IS is loading bla bla bla...". This part does not have Name/Class.<br><br>Thanks,<br>OJi.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">31st December 2007 12:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You need to find out if there is a command line switch to stop it running as another process.<br><br>If there are none, the next option is to keep checking for a running process using FindProcDLL or Processes (both of which however do not work on Vista apparently).<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">31st December 2007 17:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">More in the FAQ about installers fails with ExecWait:<br><br><a href="http://nsis.sourceforge.net/When_I_use_ExecWait,_it_doesn***39;t_wait" target="_blank">http://nsis.sourceforge.net/When_I_u...esn&amp;#39;t_wait</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_owd</span><br><span class="post-time small text-muted">1st January 2008 17:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello,<br><br>I already checked that page. It does not help me.<br><br>Thanks anyway,<br>OJi.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st January 2008 17:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Did you try /SMS?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_owd</span><br><span class="post-time small text-muted">1st January 2008 18:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, I did. Nothing happened. The new process was launched.<br><br>Thanks,<br>OJi</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st January 2008 18:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If it's only from CD, copy to $TEMP prior to execution.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_owd</span><br><span class="post-time small text-muted">1st January 2008 18:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I cannot. I need to do this three times. First installer has 1.4 GB, second 500 MB and the third 1.3 GB. I will search more about InstallShield functionality. If I find something usefull I will post it here.<br><br>Thanks again,<br>OJi.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">RaggieSoft</span><br><span class="post-time small text-muted">6th January 2008 05:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I am familiar with InstallShield 12 and InstallShield 14 (IS 2008). If the installers are one big EXE, it's extracting the installer to the hard drive. Usually, it is Windows\Downloaded Installations (note that the author of the IS based installers can customize which folder the MSI is "cached" (using IS terminology) to). /SMS is an older InstallShield 5.x switch and wouldn't help out. If the installer launches an MSI, use the /A switch to create an admin image then use the regular MSIEXEC /i (path to MSI). If the IS setup is an EXE that launches an MSI in the same folder, simply directly run the MSI.<br><br>Edit: some clarification<br><br>If it is an EXE that extracts and launches an MSI, use the /A switch to create the Admin image. Burn that folder (along with everything - there will be a load of files) to your DVD. About the /SMS switch: This was used in InstallShield 5.5 and previous versions to tell IS to not exit the "Preparing InstallShield Wizard" screen until Setup is fully done, thus allowing functions like ExecWait to work properly. Starting with Version 6.0 (this came out back in 2000 or so), the feature provided with /SMS is now the default operation.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_owd</span><br><span class="post-time small text-muted">6th January 2008 09:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for your reply.<br><br>The IS installers are not one big EXE file and I could not find any MSI file. The problem is I cannot/(am not allowed to) modify them. I must use them as they are.<br>I am still searching...<br><br>Thanks again,<br>OJi.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">RaggieSoft</span><br><span class="post-time small text-muted">6th January 2008 16:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oh joy, InstallScript based installations. Here's some command line switches from the InstallShield KB: <a href="http://helpnet.macrovision.com/Robo/BIN/Robo.dll?mgr=agm&amp;tpc=%2Frobo%2Fprojects%2Finstallshield14helplib%2FIHelpSetup_EXECmdLine.htm&amp;wnd=InstallShieldLivingHelp" target="_blank">http://helpnet.macrovision.com/Robo/...ieldLivingHelp</a>|Main&amp;agt=wsm&amp;ctxid=search%2Fgsearch.asp (it's a long and confusing URL)<br><br>Try /runfromtemp /clone_wait<br><br>If I'm reading the instructions correctly, /clone_wait will only run with /runfromtemp<br><br>These instructions are for InstallShield 2008 (AKA InstallShield 14) so hopefully they'll work on IS 11 and IS 12<br><br>When you are looking at the Macrovision help site, only the "InstallScript" information applies to you. Ignore "Basic MSI" ans "InstallScript MSI"</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>