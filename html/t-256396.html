<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="batch file execution"><title>batch file execution - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">batch file execution</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=256396">batch file execution</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Anselmus</span><br><span class="post-time small text-muted">28th September 2006 12:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>batch file execution</strong><br>hi folks,<br><br>i'm new to nsis and desperatly trying to get my script running for the whole morning now.<br><br>i'm trying to run a batch file with one parameter (\service.bat install).<br><br>i tried ExecWait and ExecShell and every possible combination of quotation marks.<br><br>i even created a new batchfile with no parameter to call the first one from within this second batch file. still it won't work. dos-box comes up for a few milliseconds and disappears.<br><br>can someone help me out with thatone?<br><br>thanks<br>stephan</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">28th September 2006 12:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">nsExec::Exec '"$EXEDIR\BATCH.bat" "params"'<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">28th September 2006 13:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Console window means file found by system and started. Add Pause to you bat after every line to see output or use output redirection. ExecWait is better for debugging, but finally use nsExec (hides console).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anselmus</span><br><span class="post-time small text-muted">28th September 2006 13:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks for the fast reply. i tried it the way Afrow UK suggested. still it won't work... =(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anselmus</span><br><span class="post-time small text-muted">28th September 2006 14:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">somehow there seems to be a problem with executing the second batch file i created (set_service.bat) which looks like this:<br><br>@echo off<br>CALL service.bat install<br>ECHO end of set_service.bat<br>PAUSE<br><br><br>if i execute it manually (command line) or execute it by doubleclicking it works fine<br><br>but with the the ExecWait Command it wont do it outputs that it cannot find service.bat, even though they are in the same directory...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th September 2006 12:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use SetOutPath to set the working directory.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anselmus</span><br><span class="post-time small text-muted">4th October 2006 15:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i tried this:<br><br><br>SetOutPath "$INSTDIR\AgroKONNEKTOR\bin"<br>nsExec::Exec '"COMMAND" "$SYSDIR /Y /K $INSTDIR\AgroKONNEKTOR\bin\set_service.bat"'<br><br><br>and a lot of different versions, yet it wont run.<br><br>gtx<br>anselmus</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anselmus</span><br><span class="post-time small text-muted">4th October 2006 16:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">cant anyone help me out with this? i'm getting mad on this one... :(<br><br>to make my problem a beit clearer: i'm trying to run the service installer delivered with tomcat 5.5.17 (bin\service.bat) which requires to be run as: "service install" or "service.bat install"<br><br>any suggestions are most welcome</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Mr Inches</span><br><span class="post-time small text-muted">5th October 2006 12:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The command you are trying to run is no good. :(<br><br>Try this code:<br><br>SetOutPath "$INSTDIR\AgroKONNEKTOR\bin"<br>nsExec::Exec "CMD" "/C $INSTDIR\AgroKONNEKTOR\bin\set_service.bat"<br><br>The /C switch means 'run the following program under the new command shell, then exit the command shell and return to the program that launched you when it completes'.<br><br>The /K switch means 'run the following program under the new command shell and then leave the command shell running after it completes until it is manually exited by typing "exit"' - (K)eep.<br><br>There is no /Y switch supported by CMD.EXE or COMMAND.COM.<br><br>Duncan</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anselmus</span><br><span class="post-time small text-muted">5th October 2006 12:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hi duncan,<br><br>thanks for the reply, but it does not work. dont ask my why.<br><br>but i seem to have solved tho problem in a different way. now, i let nsis create the batch file instead of having a static batch file: it looks like this:<br><br>SetOutPath "$INSTDIR\AgroKONNEKTOR\bin"<br>StrCpy "$1" "$INSTDIR"<br>StrCpy $1 $1 2<br>MessageBox MB_OK "$1"<br>FileOpen "$0" "set_service.bat" "w"<br>;FileWrite "$0" "@ECHO OFF$\r$\n"<br>FileWrite "$0" "$1$\r$\n"<br>FileWrite "$0" "cd $INSTDIR\AgroKONNEKTOR\bin$\r$\n"<br>FileWrite "$0" "CALL service install$\r$\n"<br>;FileWrite "$0" "pause"<br>FileClose "$0"<br>MessageBox MB_OK "wrote setter"<br>ExecWait "set_service.bat"<br><br><br>the message boxes and pause command are for debugging purposes</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">aceld</span><br><span class="post-time small text-muted">17th April 2008 20:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I was stuck at the same situation, and your solution saved my life!</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>