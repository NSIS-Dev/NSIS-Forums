<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Universal 32 and 64-bit installers" />

  <title>Universal 32 and 64-bit installers - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Universal 32 and 64-bit installers</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330124">Universal 32 and 64-bit installers</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jweinraub</span><br />
      <span class="post-time small text-muted">28th April 2011 19:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Universal 32 and 64-bit installers</strong><br />
      Hi,<br />
      <br />
      I like to maintain one installer for our software which has 32-bit and 64-bit versions of the binaries (exes and dlls).<br />
      <br />
      Most of the support libraries are shared, but on a 32-bit, 64-bit system, it should install into the correct program files directory. are there any known issues with doing this? is there an easy way to avoid redundancy in installing the files since I don't want to copy and paste the 75 or so shared files so i can do the if architecture == 64 do this, else do that since there are really only 10 files that is needed to be in the 64-bit folders.<br />
      <br />
      i am going to have x64 and x86 in the src tree of my nsis installer so it can reference it properly, but for the rest of the files, I don't want to just copy everything twice.<br />
      <br />
      is this achievable, or do i need to maintain separate installers for both architectures.<br />
      <br />
      thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">28th April 2011 20:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You're not being entirely clear on what exactly you want to accomplish. If you're asking about runtime differentiation between 32 bit and 64 bits operating system, use the macros in x64.nsh. (A simple search would've told you this.)<br />
      <br />
      If you're talking about compiletime differentiation so you can build two kinds of installer with only one .nsi file, you can use makensis's /D parameter to define YourDefine, and use !ifdef YourDefine etc in your script. You can find this info in chapter 3 of the manual. <a href="http://nsis.sourceforge.net/Docs/Chapter3.html" target="_blank">http://nsis.sourceforge.net/Docs/Chapter3.html</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jweinraub</span><br />
      <span class="post-time small text-muted">28th April 2011 20:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry for not being clear. I know how to do 64-bit differentiation. I did a search what I want to do, but what I want to do I think is maybe unique.<br />
      <br />
      To simplify things, my installer say installs about 100 files. I want to use the same installer on any machine (32 or 64-bit). When the installer installs, it automatically copies the appropriate files to the appropriate program files folder.<br />
      <br />
      My question is, do I need to have the if statement on the top of the code when it gets installed for the correct program files folder flag gets set correctly (I am assuming $PROGRAMFILES is determined at runtime?) How does it get determined if it goes into Program Files (x86) or Program Files where 64-bit compiled programs go?<br />
      <br />
      That is where I think I am not understanding the workflow on how this should be accomplished.<br />
      <br />
      So say 15 of those 100 files is what is compiled for 64-bit systems. So in my nsis src folder, I have x64 folder with those 15 files, a x86 folder where 15 of those files are that are 32-bit, and the remaining 85 files are in main src folder, the parent folder.<br />
      <br />
      Is NSIS smart enough for me to just reference the x64 or x86 folders and still copy the rest of the support files I need to install.<br />
      <br />
      I hope this was more clear.<br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">28th April 2011 20:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">$PROGRAMFILES always points to the 32bits version (usually called "Program Files (x86)" on 64 bits windows), because NSIS is a 32 bits application. To install something to x64 program files, use $PROGRAMFILES64. See chapter 4 of the manual: <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.2.3" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.2.3</a><br />
      <br />
      So in code:<br />
      ${If} ${RunningX64}<br />
      SetOutPath "$PROGRAMFILES64\YourPath"<br />
      File x64file1.ext<br />
      File x64file2.ext<br />
      File x64file3.ext<br />
      {Else}<br />
      SetOutPath "$PROGRAMFILES\YourPath"<br />
      File x68file1.ext<br />
      File x68file2.ext<br />
      File x68file3.ext<br />
      ${EndIf}<br />
      File commonfile1.ext<br />
      File commonfile2.ext<br />
      File commonfile3.ext</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jweinraub</span><br />
      <span class="post-time small text-muted">28th April 2011 20:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I see, so the common files will still install in its proper folder of Programfiles64 / 32 then, i think i get it now.<br />
      <br />
      thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">28th April 2011 21:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">$PROGRAMFILES64 will have the same value as $PROGRAMFILES on 32-bit Windows so you can just use $PROGRAMFILES64 throughout although using both is probably good for code readability.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
