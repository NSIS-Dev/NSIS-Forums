<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="(Advanced?) Registry settings." />

  <title>(Advanced?) Registry settings. - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">(Advanced?) Registry settings.</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221366">(Advanced?) Registry settings.</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AlexanderG</span><br />
      <span class="post-time small text-muted">13th July 2005 16:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>(Advanced?) Registry settings.</strong><br />
      (This is a bit lengthy to explain, but please bear with me.)<br />
      I have a java application that is wrapped in <a href="http://sourceforge.net/projects/janel" target="_blank">janel</a> to create an executable for ease of use. I have an associated file type that I write to the registry.<br />
      The executable works perfectly via clicking on it or using a shortcut.<br />
      It doesn't work if you launch it from another directory (i.e. use the command prompt to go D:\&gt; "D:\Stuff\MyProgram.exe").<br />
      This is because it's home directory contains property files that it must have to work correctly.<br />
      This causes problems for the associated file type, in that if it is not in the install directory it simply doesn't work.<br />
      The program <i>will</i> run if a shortcut is used (i.e. you pass the project file to a shortcut instead of the EXE). I have tried to set the registry to use the *.lnk instead of the EXE but that throws an error ("ASW.prjct is not a valid Win32 application)<br />
      It will also work if the program is already running (i.e. the program is running and you click on a project file, this will load it in the program)<br />
      <br />
      So these are my questions:<br />
      <br />
      Is it possible to set the registry to move to the required directory and then launch the EXE?<br />
      <br />
      Is it possible to set the registry to launch the program and then send the file to the program?<br />
      <br />
      Is it possible to make the registry work with a link?<br />
      <br />
      Thanks for any and all help you can provide.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">13th July 2005 17:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Windows allows you to set a file extension to run a batch file.<br />
      This batch file example works for notepad which I set up for a "ttb" file extension (just to test it):<br />
      <br />
      C:<br />
      notepad %1<br />
      exit<br />
      <br />
      This should set the working dir to C:<br />
      For the registry entry, it's "path\to\file.bat" %1<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">14th July 2005 04:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">why not create a application using nsis that acts as a launcher app that sets the current dir and then launces your app<br />
      <br />
      you can also use:<br />
      cmd /c "start /Dc:\path\to\my\ c:\path\to\my\app.exe"<br />
      in the registry, not sure if this works on Win9x, on those platforms you can use start directly since its a exe (you dont need cmd /c) but im not sure if it supports setting the current dir</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AlexanderG</span><br />
      <span class="post-time small text-muted">14th July 2005 11:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>&lt;snip&gt;<br />
        <br />
        -Stu</b>
      </blockquote>Unfortunately I need it to run <i>without</i> a command window.<br />
      <br />

      <blockquote>
        <i>Originally posted by Anders</i><br />
        <b>why not create a application using nsis that acts as a launcher app that sets the current dir and then launces your app</b>
      </blockquote>That is just beyond my abilities. And I need to get this done in the next few days. Unless there is some sort of tutorial?<br />
      EDIT: Actually, now that I think about it, that would be great. Where could I find out more? (Being honest, I didn't know that NSIS could be used for anything besides installers.)<br />
      <br />

      <blockquote>
        <i>Originally posted by Anders</i><br />
        you can also use:<br />
        cmd /c "start /Dc:\path\to\my\ c:\path\to\my\app.exe"<br />
        in the registry, not sure if this works on Win9x, on those platforms you can use start directly since its a exe (you dont need cmd /c) but im not sure if it supports setting the current dir [/B]
      </blockquote>It needs to work on Windows and that didn't seem to work.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">14th July 2005 17:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Extremely simple to do.<br />
      <br /></p>
      <pre>
<code>Name "ExecShell"<br />OutFile execshell.exe<br /><br />Function .onInit<br /><br /> Call GetParameters<br /> Pop $R0<br /><br />  SetOutPath "$EXEDIR"<br />  Exec '"$EXEDIR\program.exe" "$R0"'<br /><br />  Abort<br /><br />FunctionEnd<br /><br />Function GetParameters<br /># this function is in manual!<br />FunctionEnd<br /><br />Section<br />SectionEnd</code>
</pre><br />
      <br />
      Minimal script.<br />
      <br />
      -Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AlexanderG</span><br />
      <span class="post-time small text-muted">15th July 2005 12:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's great, thank you all for your help.<br />
      Could I set it to compile that script at the time of installation? Or must it be compiled beforehand?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">15th July 2005 12:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Needs to be compiled before hand obviously, otherwise you'd need to include makensis.exe with your installer and run it with a banner explaining what is happening.<br />
      Compile the script and put the exe in as part of your software.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AlexanderG</span><br />
      <span class="post-time small text-muted">15th July 2005 12:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry, I forgot that $EXEDIR would get the current directory and couldn't figure out how it was going to get the installation directory.:o<br />
      Thanks again.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
