<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="File Timestamp Precision"><title>File Timestamp Precision - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">File Timestamp Precision</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=315797">File Timestamp Precision</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">intripoon</span><br><span class="post-time small text-muted">28th December 2009 21:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>File Timestamp Precision</strong><br>Hi !<br><br>I'm the creator of a free game I distribute on my website <a href="http://www.walkover.org" target="_blank">www.walkover.org</a>. Until now, I offered a simple 7z or selfextractor to distribute it. But lately, I realized that it's too complicated to get the game installed for some gamers. So I decided to replace it with an installer that creates a link on the desktop and in the startmenu. I managed to do this with NSIS by modifying an example.<br><br>But now I've got a problem: After the initial setup, there is an autoupdate system that updates the game to the most current version. This system relies on filestamps being correct - if they are not, it redownloads the file. Now comes the strange part: With 7z+selfextractor, the timestamps were correct after the installation, but with nsis and lzma - which is essentially the same I guess - the timestamps are slightly off. This makes my autoupdater redownload every file.<br><br>Is there a way to increase the file timestamp precision?<br><br>Best regards<br>Marc</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">30th December 2009 07:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Are you using NTFS or FAT? NTFS has more precise timestamps.<br><br>I have to mention that using timestamps for that is less than perfect. Other programs can easily change timestamps and so can users editing your files. You're much better off with proper version numbers.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">intripoon</span><br><span class="post-time small text-muted">30th December 2009 11:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It's perfectly fine to use timestamps for that. For example, rsync uses them as a hint as well - my patching works similar. So if some files have changed timestamps or just some got modified by the user, that's fine, they'll get patched to the correct version again on the next update run. This is only a problem if all timestamps get corrupted for all players - that would lead to everyone downloading everything again.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">30th December 2009 12:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well then, why not just make your decision algorithm a little bit less picky? Make it "if dt &gt; 123".</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">intripoon</span><br><span class="post-time small text-muted">30th December 2009 13:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I already did that. But I'm still wondering why timestamp precision with 7z/lzma is higher than with nsis using 7z/lzma.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">30th December 2009 13:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">NSIS doesn't use 7-zip which is the container that also saves timestamps. We only use lzma compression.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">intripoon</span><br><span class="post-time small text-muted">30th December 2009 16:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ic. How complicated would it be to modify the code to enhance the precision? Is it more a small change or does it affect the code at a lot of places?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">31st December 2009 10:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Search for TOK_FILE in Source\script.cpp. I think it's in the function that's called there, near the end of the file.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>