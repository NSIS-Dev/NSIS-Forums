<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How to bring the App window to the front"><title>How to bring the App window to the front - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How to bring the App window to the front</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=268418">How to bring the App window to the front</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br><span class="post-time small text-muted">26th March 2007 17:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How to bring the App window to the front</strong><br>When the installation comes to Finish page, I have a check box to Run our App.<br>The checkbox was checked, then i click on finish button. It dose get App running, but somehow,the window of our App sits behind the other windows.<br><br>How can I get our app's window to up front?<br><br>James</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dienjd</span><br><span class="post-time small text-muted">26th March 2007 19:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can use FindWindow to get your app's HWND and then use an API, such as SetWindowPos to try to bring your app to the front. Note that Windows is restrictive about this at times. You can search the forums for that API to find specific examples with code.<br>Also, if your installer is one of the windows blocking your app, you can use HideWindow just before you launch it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br><span class="post-time small text-muted">26th March 2007 19:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">can you give me sample code..<br><br>Thank you..</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dienjd</span><br><span class="post-time small text-muted">26th March 2007 19:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here's an example using SetForegroundWindow, which is probably the better call to use. If you didn't write your app, you can ask the developer or run Spy++ to get the app's window class.<br><br>FindWindow $0 "my app's window class" ""<br>IsWindow $0 0 +2<br>System::Call 'user32::SetForegroundWindow(i r0)'</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br><span class="post-time small text-muted">26th March 2007 21:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">where should I put those code? I can get the class name from spy++.<br>tried to put them into installer, seems to not work...<br>??</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br><span class="post-time small text-muted">26th March 2007 21:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think those code should be run after I click the finish button, the start our applicaiton, then bring it to up front. Otherwise,it can't find the window since app is not running yet.<br>???????</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dienjd</span><br><span class="post-time small text-muted">26th March 2007 21:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, it has to be after your app runs but of course before your installer exits.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br><span class="post-time small text-muted">26th March 2007 21:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">so where should I put those code? there is an Event like AfterClickFinishButton?<br>Thank you for your help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dienjd</span><br><span class="post-time small text-muted">26th March 2007 21:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you are using MUI, see the MUI documentation for MUI_PAGE_CUSTOMFUNCTION_LEAVE<br>If not, see the docs for the Page instruction.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br><span class="post-time small text-muted">26th March 2007 21:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, I am using MUI, thanks for your quick reply</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br><span class="post-time small text-muted">26th March 2007 21:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">But this button is on Finish Page, then run our application .exe file???<br>still not working</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br><span class="post-time small text-muted">26th March 2007 21:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">it is not a custom page.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dienjd</span><br><span class="post-time small text-muted">26th March 2007 22:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Can you attach your script? It would make it a lot easier to help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br><span class="post-time small text-muted">26th March 2007 22:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The installer's last page Finish Page.<br><br>!define MUI_FINISHPAGE_RUN_TEXT "' Start ${PRODUCT_NAME}'"<br>!insertmacro MUI_PAGE_FINISH<br><br>when installing the installer, after copying files, the comes to last page Finish window. If i click on Finish button on this window, then will run ${PRODUCT_NAME}.exe file. The problem is that ${PRODUCT_NAME}.exe window behind some windows, how can I get it to up front (topmost).<br>Any thoughts</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">26th March 2007 23:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try to add the provided by dienjd above code in function .onInstSuccess in loop to see if it makes the trick, e.g.<br><br>loop:<br>FindWindow $0 "my app's window class" ""<br>IsWindow $0 0 loop<br>System::Call 'user32::SetForegroundWindow(i r0)'</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br><span class="post-time small text-muted">27th March 2007 00:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It does work for me!<br><br>Thank you very much, Red Wine.<br>I always can get answers from you. You are my saver!<br>Every time when I post my question here, always look forward to hearing from you.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">27th March 2007 00:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You're welcome :)<br>Thanks goes to dienjd for the provided solution ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br><span class="post-time small text-muted">27th March 2007 00:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes. Thanks Dienjd as well.<br><br>You guys save me one day work.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>