<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Keeping Important DLLs after Uninstall" />

  <title>Keeping Important DLLs after Uninstall - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Keeping Important DLLs after Uninstall</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=282193">Keeping Important DLLs after Uninstall</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chamakits</span><br />
      <span class="post-time small text-muted">27th November 2007 11:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Keeping Important DLLs after Uninstall</strong><br />
      Hey guys, I'm currently working on an installer for product that a small company distributes. The previous installer they had was....well...bad.. Anyways, a problem I've had is that when i uninstall the program using the old installer/uninstaller, it doesn't erase properly the Registry entries for the DLLs but does erase the DLLs perse. So I was wondering if there was a quick workaround for this, because if I'm not mistaken, if there already is an entry for a DLL then RegDLL doesn't overwrite it, right?<br />
      <br />
      Also, on the new installer, my boss wants to make sure, that the uninstaller doesn't un-register any DLLs that previously existed on the machine. So, he told me if there was anyway that I could put the DLL somewhere in the computer, like the WINDOWS folder, where they wouldn't get erased, however, if I'm not mistaken, the WINDOWS folder is off-limit when it comes to adding files to it explicitly, right? So, where could I include them. And if its possible to do so in the WINDOWS folder, how should I go about it?<br />
      <br />
      Thanks to everyone in advance.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">UranusOne</span><br />
      <span class="post-time small text-muted">27th November 2007 12:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Do not uninstall or creates a log to record the existing dlls before installing your program, from the same installer. The uninstaller, then you should be able to read this log, and then not uninstall dlls that were before installing.<br />
      <br />
      But equally, you can also create conflicts with programs that install after your installation, requiring those dlls.<br />
      <br />
      You can install the dlls or any file in the WINDOWS directory. Normally, the DLLs are installed at</p>

      <ul>
        <li>Windows98: C:\Windows\System<br />
        Windows2000: C:\WINNT\System32<br />
        WindowsXp: C:\Windows\System32</li>
      </ul>In these folders, the DLLs, are available for the use of all programs (for example those created with VisualBasic 6.0)<br />
      <br />
      Otherwise, you could include the DLLs in the same folder as the executable of your program and do not register them in any way. This not create conflicts with nothing (if then uninstall), and only your program could run these DLLs, as they are on your side, in the same folder.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">27th November 2007 18:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What RegDLL does depends entirely on the DLL itself. RegDLL simply loads the DLL and tells it to register itself. More specifically, it calls DllRegisterServer().</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
