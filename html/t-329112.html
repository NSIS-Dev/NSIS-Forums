<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Uninstaller, plugin crash" />

  <title>Uninstaller, plugin crash - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Uninstaller, plugin crash</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=329112">Uninstaller, plugin crash</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lloydtech</span><br />
      <span class="post-time small text-muted">30th March 2011 15:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Uninstaller, plugin crash</strong><br />
      Hi,<br />
      <br />
      I have an NSIS Installer/Uninstaller. The uninstaller calls functionality available in a plugin. This plugin is compiled using visual studio 2010 so requires the runtime library msvcr100.dll and msvcp100.dll. And the application is installed in an XP machine, which does not have these libraries.<br />
      <br />
      When the uninstaller is called, the uninstaller is first copied into a temp directory and from there it executes. At that time it misses the run time library in "the current working directory" and causes problem in loading the plugin dll. What is the right work around for this?<br />
      <br />
      Should I copy the runtime libraries to the temp folder where uninstaller is copied? if this is the case how can I get the path to uninstaller temp folder?<br />
      <br />
      Or should I install the runtime libraryin the "system" folder? Does NSIS have some shortcut for this?<br />
      <br />
      Thanks a lot,<br />
      Lloyd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th March 2011 15:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You don't necessarily need to have a dependency on those DLL's if you "Ignore default libraries" and then do not include a manifest in your DLL. Anyway, extract the dependencies to $PLUGINSDIR before calling the plug-in.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Highcoder</span><br />
      <span class="post-time small text-muted">30th March 2011 15:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Do you code this plugin yourself? You should avoid dependencies to any kind of runtimes. Installers should always need only itself.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lloydtech</span><br />
      <span class="post-time small text-muted">31st March 2011 05:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, How can I avoid dependency on runtime?<br />
      <br />
      If I set "NODEFAULTLIB" option, the linker gives me linking errors.<br />
      <br />
      Or should I use the runtime library as "Multi threaded" than "Multi threaded dll" ?<br />
      <br />
      Thanks a lot,<br />
      Lloyd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">31st March 2011 10:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://forums.winamp.com/showpost.php?p=2696184&amp;postcount=60" target="_blank">http://forums.winamp.com/showpost.ph...4&amp;postcount=60</a><br />
      <br />
      If you get other linker errors then you are using CRT library functions and you need to find alternatives/write your own.<br />
      <br />
      For example, you can replace strcmp with lstrcmp (and the variants) and any printf's with wsprintf. Also NSIS exports helper functions such as myatoi() for plug-ins. Look in one of the plug-in API header files.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
