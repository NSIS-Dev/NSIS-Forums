<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Some help needed..."><title>Some help needed... - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Some help needed...</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=129834">Some help needed...</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">26th March 2003 17:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Some help needed...</strong><br>Rather a lot of help needed really...<br><br>I've finished my map-compiler program for Quake2, and I'm now moving onto a new piece of software for the Quake2/D-Day community.<br><br>D-Day for Quake2 writes its console data to a log file, showing everything the client (player) has done during his/her's gaming experiance.<br>Right now, players cannot see their kill count or death count (how many people they have killed or how many times they have died) They can only see figures for the whole teams' kill/death counts.<br><br>I am making a program which will read from the log file (qconsole.log) and convert data into readable details.<br><br>These would include something like:<br><br>Player: "Afrow UK"<br>"Afrow UK" would be the name entered at the start of the program. The program will then give the details from the players' name.<br><br>Kills: "x"<br>"x" would be the kills count.<br>In the log, a player killed by "Afrow UK" will be seen as e.g.<br>Afrow UK was sniped by [OSS]Sgt.Boon<br>Afrow UK did not survive lits's explosive attack<br>Afrow UK didn't see lits's handgrenade<br><br>Deaths "x"<br>"x" would be the deaths count.<br>In the log, a death for "Afrow UK" will be seen as e.g.<br>(89th)Cpt.Dan was shot down by Afrow UK's rifle<br>[BR1]Cpt.Kal was gunned down by Afrow UK's submachinegun<br>[666th]SkullZ didn't see Afrow UK's handgrenade<br><br>and so on...<br><br>These are the main figures I need to get from a log file, where the log file will pretty much be like the qconsole.txt I have added to this post.<br><br>Secondly, I need to get...<br><br>1. A list of player names printed on 1 line, seperated by commas (note that a players' name is always found more than one time)<br>2. A player count number (number of players found listed in the log)<br>3. A list of maps that the home client has been on printed on 1 line, seperated by commas (person running the program)<br>This would come from e.g. "Map: gbrdday2"<br>4. A list of the IP addresses (servers) that the home client has played on printed on 1 line, seperated by commas.<br>This would come from e.g. "Connecting to ddayuk.dyndns.org:27910..."<br><br><br>Thats basically it for now. Once I can get a main code for creating the list, and count numbers etc, I can get far without help (note I'm only a youngster!)<br><br>As soon as I release this program, it will be downloaded by thousands. Since the release of D-Day: Normandy 3.2, the individual Player death/kills count was removed from the HUD, and instead just the overall death/kills count for the whole team was put on instead.<br><br>The general program UI is done.<br>This program will also help server runners, when I get the html bit going...<br>Data will be put into a nice HTML document, so then admins can upload onto some webspace so everyone can see it.<br>This will be useful for personal use (players wanting to see their own player count)<br>Or it can be used for an overall server (listing all players' data)<br>It will also have a 'live' function, which means that the user can run it while running D-Day, printing live data onto the log window, or even lively updating the html file.<br><br>As soon as I get the main code for getting a list of players, and player numbers etc, I can carry on from there hopfully.<br>However, I'm not the best at stuff (still a youngster!)<br><br>Enough of the babbling on now...<br><br>Thanks<br><br>-Stuart</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">28th March 2003 15:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It'll be easier to help if you specify more specific problems. I am not going to think of an entire script algorithm for this... ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">28th March 2003 16:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I posted this when I was rather tired, and since have thought of pretty much all of the functions needed.<br>I'll write my own parts (I know what to do) using bits from other functions.<br>That "Super function task" post I posted a while oga on these forums will help me a lot Thanks :)<br><br>I can use StrStr to only have a player name written to the list once (if it is already in the list, then don't add it on!)<br><br>It's going to take a lot of work, but it shouldn't be too hard.<br><br>Too bad I thought of most of it during lessons at school, and have forgotten a lot of it! I will write notes next time (hope teachers don't notice)<br><br>I'm currently getting a lot of support from a lot of fellow D-Day players, who are eagerly awaiting my program :)<br><br>-Stuart</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">28th March 2003 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Secondly...<br><br>Is there a way NSIS can automatically upload files to a website?<br><br><br>There is probably an command-line MS-DOS program out there, but I haven't time to look right now :)<br><br><br>-Stuart</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">28th March 2003 16:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What do you mean? FTP transfer?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">28th March 2003 16:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><pre>
<code><br>ClearErrors<br>FileOpen $0 "C:\quake2\dday\qconsole.log" r<br>StrCpy $3 0<br>loop:<br>   FileRead $0 $2<br>   IfErrors done<br>   StrCmp $2 "[OSS]Lt.AfrowUK" 0 +3<br>      IntOp $3 $3 + 1<br>   StrCmp $2 "[OSS]Lt.AfrowUK$\n$\r" 0 loop<br>      IntOp $3 $3 + 1<br>      Goto loop<br>done:<br>   DetailPrint "Kills = $3"<br>   WriteINIStr "$EXEDIR\logs\client_log1.log" "Kill Count" "Kills" "${KILLCOUNT}"<br>   FileClose $0<br></code>
</pre><br>
      <br>
      The first bit of code, and I'm already doomed!<br>
      It only adds 1 to $3 once, and then finishes.<br>
      The log has 5 of "[OSS]Lt.AfrowUK" in it, so it should add 5 to $3.<br>
      <br>
      Whats wrong?<br>
      <br>
      -Stuart
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">28th March 2003 17:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I see one error in there which is that +3 that is supposed to be +2. That shouldn't decrease the count thought, it should increase it... Weird... Try printing some debug info such as $2 != [OSS]Lt.AfrowUK if it's not the same line and == if it's the same line. Maybe that will help you figure out what's wrong.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">28th March 2003 19:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, I mean FTP.<br>
      <br>
      Ok, I changed that bit to +2 insted of +3, $3 still comes out as 0, when I want it to count up how many times it has found "[OSS]Lt.AfrowUK" in the log.<br>
      <br>
      <br>
      -Stuart</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">28th March 2003 19:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So, it doesn't seem to find "[OSS]lt.AfrowUK" in the log file anywhere, even though it is repeated in there over 1000 times at least!<br>
      <br>
      I have narrowed the log file down to just having 5 of the "[OSS]lt.AfrowUK" in it, but it still sees none of them.<br>
      <br>
      -Stuart</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">28th March 2003 20:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, I found out what is the problem.<br>
      <br>
      FileRead $0 $2 will get a whole line from the log. In this case, it may be "|EON|MadDuCk was sniped by [OSS]Lt.AfrowUK"<br>
      Simply comparing "|EON|MadDuCk was sniped by [OSS]Lt.AfrowUK" to "[OSS]Lt.AfrowUK" will not work.<br>
      I will have to use StrStr to search for "[OSS]Lt.AfrowUK" in that string.<br>
      <br>
      Will this work?<br>
      <br>
      -Stuart</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">28th March 2003 20:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Wahoo that works!<br>
      Now, the only troube is that if "[OSS]Lt.AfrowUK" is repeated on the same line "e.g. [OSS]Lt.AfrowUK has overflowed, [OSS]Lt.AfrowUK is reconnecting," it will only pick up 1 of the "[OSS]Lt.AfrowUK"<br>
      <br>
      It doesn't matter too much, because (as far as I know) "[OSS]Lt.AfrowUK" doesn't appear more than once on a line anyway!<br>
      <br>
      -Stuart</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">29th March 2003 11:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">StrStr will return the string without the part that comes before what you were looking for. You can trim what you've been looking for and then look again in what's left.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
      <span class="post-time small text-muted">29th March 2003 18:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use the Advanced StrStr to show the string before the second [OSS]Lt.AfrowUK.<br>
      <br>
      [EDIT]OR<br>
      <br>
      You can detect the first [OSS]Lt.AfrowUK (output $0), detect it again without showing the [OSS]Lt.AfrowUK (output $1), and detecting the next [OSS]Lt.AfrowUK in the $1 (output $1).[/EDIT]</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">29th March 2003 18:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nice script, but right now, parsing the log file (of up to 1mb) takes up to 20 seconds+!<br>
      <br>
      -Stuart</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>