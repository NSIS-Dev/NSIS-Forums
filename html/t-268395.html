<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Progress Bar color or style"><title>Progress Bar color or style - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Progress Bar color or style</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=268395">Progress Bar color or style</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">paragrane</span><br><span class="post-time small text-muted">26th March 2007 08:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Progress Bar color or style</strong><br>&nbsp; Hello !!!!!<br><br>I am using UMUI interface. I want to change the color or style of Pogress bar on MUI_PAGE_INSTFILES page. How to do this?<br>I have tried this-----<br>!define MUI_INSTALLCOLORS "FF0000 00FF00"<br>!define MUI_INSTFILESPAGE_PROGRESSBAR "colored"<br><br>But it's not working. The error I am getting is-------<br>"MUI_INSTFILESPAGE_PROGRESSBAR already define" but I cheked that It is defined only one time. I am not getting why the error is comming?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">paragrane</span><br><span class="post-time small text-muted">27th March 2007 14:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Progress Bar Style</strong><br>&nbsp; Hello !!!!!<br><br>I am using UMUI interface. I want to change the color or style of Pogress bar on MUI_PAGE_INSTFILES page. How to do this?<br>I have tried this-----<br>!define MUI_INSTALLCOLORS "FF0000 00FF00"<br>!define MUI_INSTFILESPAGE_PROGRESSBAR "colored"<br><br>But it's not working. The error I am getting is-------<br>"MUI_INSTFILESPAGE_PROGRESSBAR already defined" but I cheked that It is defined only one time. I am not getting why the error is comming?<br><br>Please Help me how to do this</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br><span class="post-time small text-muted">27th March 2007 14:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">be sure to define those ABOVE the !insertmacro MUI_PAGE_INSTFILES command.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">paragrane</span><br><span class="post-time small text-muted">28th March 2007 05:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Comm@nder21<br>I tried what you said.<br>!define MUI_INSTFILESPAGE_PROGRESSBAR "colored"<br>But the above statement give me same error as follows<br>"MUI_INSTFILESPAGE_PROGRESSBAR already defined" but I cheked that It is defined only one time. I am not getting why the error is comming?<br>After that I commented that Statement and I run the program with only one statement as follows-----<br>!define MUI_INSTALLCOLORS "FF0000 00FF00"<br>It does not give any error but it does not change the color of Progress Bar.<br>So can you give me some code or logic to do that?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">SteveRussell</span><br><span class="post-time small text-muted">3rd April 2007 23:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I am having the same problem. What is the answer? Is something wrong with the following?<br><br>!define MUI_INSTFILESPAGE_PROGRESSBAR<br>!insertmacro MUI_PAGE_INSTFILES</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">8th April 2007 16:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Define it above the first page insertion.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">SteveRussell</span><br><span class="post-time small text-muted">8th April 2007 16:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I should have posted that I did finally figure it out, though it was not clear to me why this is required. Thanks for the confirmation, kichik!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mvisual</span><br><span class="post-time small text-muted">7th September 2011 23:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I was having problems with this exact issue. Is there any way you can post what you have troubleshooted?<br><br>FYI:<br><br>This is what I'm currently working on troublshooting:<br><br>!include "WinMessages.nsh"<br>!include "MUI2.nsh"<br>!include "nsDialogs.nsh"<br><br>OutFile "test.exe"<br><br>Section<br>SectionEnd<br><br>Var dialog<br>Var hwnd<br>Var null<br><br>!define /math PBM_SETRANGE32 ${WM_USER} + 6<br><br>!define MUI_INSTFILESPAGE_PROGRESSBAR "color"<br>!define RED "0xD0A8A8"<br>/*!insertmacro MUI_PAGE_INSTFILES*/<br><br>Page Custom page.custom<br>Function page.custom<br>nsDialogs::Create 1018<br>Pop $dialog<br><br>${NSD_CreateProgressBar} 0 0 100% 15 "0xD0A8A8"<br>Pop $hwnd<br><br>${NSD_CreateTimer} NSD_Timer.Callback 10<br><br>nsDialogs::Show<br>FunctionEnd<br><br>/*Function ProgressBar.Color<br>!define RED "0xD0A8A8"<br>!define PINK "0x831618"<br>FunctionEnd*/<br><br>Function NSD_Timer.Callback<br>${NSD_KillTimer} NSD_Timer.Callback<br>SendMessage $hwnd ${PBM_SETRANGE32} 0 100<br><br>SendMessage $hwnd ${PBM_SETPOS} 1 0<br>Sleep 2000<br>SendMessage $hwnd ${PBM_SETPOS} 100 0<br>FunctionEnd<br><br>!insertmacro MUI_LANGUAGE "English"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br><span class="post-time small text-muted">8th September 2011 05:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">@mvisual: try to set XPStyle off<br>XP themes force their own color on the progress bar.<br><br>Did you tried this? ::<br></p><pre>
!define MUI_INSTALLCOLORS "FF0000 00FF00"
<br>&gt;!define MUI_INSTFILESPAGE_PROGRESSBAR "colored" 
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">C_10</span><br>
      <span class="post-time small text-muted">9th February 2012 13:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi, I have the same problem.<br>
      <br>
      I tried:<br></p>
      <pre>
<code>!include "LogicLib.nsh"<br>!include "MUI2.nsh"<br>!include "nsDialogs.nsh"<br>!include "Sections.nsh"<br>!include "WinMessages.nsh"<br><br>!define MUI_INSTALLCOLORS "000000 3F48CC"<br>!define MUI_INSTFILESPAGE_PROGRESSBAR colored<br><br>XPStyle off<br>Name "Progressbar"<br>OutFile "Progressbar.exe"<br>ShowInstDetails show<br><br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_INSTFILES<br><br>Section Test<br>Sleep 100<br>SectionEnd</code>
</pre><br>
      <br>
      ...but the progressbar is still green (Windows7) and green + XPStyle (WindowsXP)<br>
      <br>
      How can I change the color? What is my mistake?<br>
      Please help
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gfm688</span><br>
      <span class="post-time small text-muted">9th February 2012 14:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">!define MUI_PAGE_CUSTOMFUNCTION_SHOW InstShow<br>
      !insertmacro MUI_PAGE_INSTFILES<br>
      !insertmacro MUI_LANGUAGE "English"<br>
      <br>
      !define PBM_SETBARCOLOR 0x0409<br>
      !define PBM_SETBKCOLOR 0x2001<br>
      <br>
      Function InstShow<br>
      FindWindow $0 "#32770" "" $HWNDPARENT<br>
      GetDlgItem $0 $0 1004<br>
      System::Call UxTheme::SetWindowTheme(i,w,w)i(r0,"","")<br>
      SendMessage $0 ${PBM_SETBARCOLOR} 0 0x000000<br>
      SendMessage $0 ${PBM_SETBKCOLOR} 0 0x3F48CC<br>
      FunctionEnd</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">C_10</span><br>
      <span class="post-time small text-muted">9th February 2012 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks gfm688 for your answer!!! :)<br>
      <br>
      I don't understand, why my code is wrong...but your code works excellent;)<br>
      Can you please explain the line to me?<br></p>

      <blockquote>
        System::Call UxTheme::SetWindowTheme(i,w,w)i(r0,"","")
      </blockquote>What does (i,w,w)i(r0,"","") mean?<br>
      Is this line treated like a constant or can I change it?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">9th February 2012 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by C_10</small><br>
        Thanks gfm688 for your answer!!! :)<br>
        <br>
        I don't understand, why my code is wrong...but your code works excellent;)<br>
        Can you please explain the line to me?<br>
        <br>
        What does (i,w,w)i(r0,"","") mean?<br>
        Is this line treated like a constant or can I change it?
      </blockquote><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb759827%28v=vs.85%29.aspx" target="_blank">http://msdn.microsoft.com/en-us/libr...=vs.85%29.aspx</a> meaning, you can change the two empty strings (You don't want to, but you could :) )
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">C_10</span><br>
      <span class="post-time small text-muted">9th February 2012 15:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK :D<br>
      Thanks Anders</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>