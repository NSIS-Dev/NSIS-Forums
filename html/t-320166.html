<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Font Install" />

  <title>Font Install - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Font Install</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=320166">Font Install</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hypheni9</span><br />
      <span class="post-time small text-muted">23rd June 2010 09:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Font Install</strong><br />
      My nsis installer needs to install a font. I use CopyFile the .ttf file to fonts folder in windows xp and then executing this ::<br />
      <br />
      System::Call "GDI32::AddFontResourceA(t) i ('BIRDMAN_.TTF') .s"<br />
      Pop $0<br />
      SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0<br />
      <br />
      but still my application doesnt catch the font at first time after install.. If I open fonts folder manually after installation it works fine.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">23rd June 2010 09:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When I look at the Register Fonts entry in the wiki (google~~) I see that it also writes a registry key. Maybe that's what you're missing?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hypheni9</span><br />
      <span class="post-time small text-muted">23rd June 2010 11:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Im trying with FontName plugin.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hypheni9</span><br />
      <span class="post-time small text-muted">23rd June 2010 14:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please check this method..<br />
      <br />
      <a href="http://nsis.sourceforge.net/Register_Fonts" target="_blank">http://nsis.sourceforge.net/Register_Fonts</a><br />
      <br />
      Im trying this. Lets see. Have anyone tried it before and got success..??</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hypheni9</span><br />
      <span class="post-time small text-muted">23rd June 2010 16:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">!include "FontReg.nsh"<br />
      !include "FontName.nsh"<br />
      <br />
      ..... Main Section here<br />
      <br />
      Section "Fonts"<br />
      StrCpy $FONT_DIR $FONTS<br />
      !insertmacro InstallTTFFont 'BIRDMAN_.TTF'<br />
      SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0 /TIMEOUT=5000<br />
      SectionEnd<br />
      <br />
      Is it okay for installing and registering the specified font with windows. I put BIRDMAN_.TTF file in the same directory of my nsi script file. Is it Okay ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hypheni9</span><br />
      <span class="post-time small text-muted">25th June 2010 15:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No one tried FontName plugin before ??</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">25th June 2010 17:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Looks fine to me. Why don't you test it?<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hypheni9</span><br />
      <span class="post-time small text-muted">25th June 2010 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">the matter is.. fro testing it in my system i need to remove that font manually and deleting the windows FNTCACHE.DAT file.. moreover i tried this but not so sure. have to check in other system. thats why I asked here if anyone use this method and got a success..</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">26th June 2010 13:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you saying you are having to manually uninstall the font before you install it? In other words - the font is already installed? If so, how about using RemoveTTFFont first?<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hypheni9</span><br />
      <span class="post-time small text-muted">26th June 2010 15:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">See, I did manually what RemoveTTFFont used to do with codes. ie: removing .ttf file from fonts folder and deleting its entry from registry. Moreover if you follow this process to delete a font it'll be deleted but next time if you only copy .ttf file to the fonts folders it'll be activated in all application, note this time you didnt register it with window, so it was previously registered with windows, for this I have to delete FNTCACHE.dat file from system. This should be done now, but still I cant be sure that the script works for registering fonts with windows until i use my installer to a system that has never registered the font before..</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">26th June 2010 17:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That is the whole point - if it's a brand new font then why should it already exist on the system? If the installation is being run again then you should detect this and either run the uninstall first or use RemoveTTFFont directly before InstallTTFFont. InstallTTFFont probably has not been written to cope with the issue of the font already existing because this is not usually the case.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hypheni9</span><br />
      <span class="post-time small text-muted">26th June 2010 19:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In previously build of my installer I was aware of this fact and I just coded to put .ttf file to fonts folder by CopyFiles method. That works well in my system as I opens fonts folders most of the time and thus installing that .ttf file. But when I tried my installer in other systems the application did not detect it though installer has copied the .ttf file in the system's font directory. In this case it only copied the file but not registering .ttf. There after I tried new installer with InstallTTF method in my system where .ttf file has already registered. So here lies the problem. Anyways I'll check my new installer in other system in few days and will get back here.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
