<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="nsDialogs read-only text box" />

  <title>nsDialogs read-only text box - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">nsDialogs read-only text box</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=290291">nsDialogs read-only text box</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">balexis</span><br />
      <span class="post-time small text-muted">15th April 2008 19:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>nsDialogs read-only text box</strong><br />
      Hi,<br />
      I am trying to create a custom page using nsDialogs that displays a text box containing a <b>clickable URL</b> , but that is <b>not editable by the user</b>.<br />
      <br />
      Currently I am doing this :<br />
      Function MirrorPageFunc<br />
      nsDialogs::Create /NOUNLOAD 1018<br />
      Pop $Dialog<br />
      <br />
      ${If} $Dialog == error<br />
      Abort<br />
      ${EndIf}<br />
      <br />
      ${NSD_CreateLabel} 0 0 100% 12u "Test"<br />
      Pop $Label<br />
      <br />
      ${NSD_CreateText} 0 13u 100% -13u "Test : <a href="http://www.google.ca" target="_blank">www.google.ca</a>"<br />
      Pop $Text<br />
      <br />
      nsDialogs::Show<br />
      FunctionEnd<br />
      <br />
      Actually, I am trying to reproduce the dialog I included as an attachment to this post. AKAIK, the installer that provides that dialog is not built with NSIS, but I'm hopeful it can be done using NSIS.<br />
      <br />
      Does anyone have a clue ?<br />
      <br />
      Thanks<br />
      Alexis</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">15th April 2008 21:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">and you can't use a customized license page instead of nsDialogs?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">15th April 2008 21:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You have to create a rich text control.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">balexis</span><br />
      <span class="post-time small text-muted">16th April 2008 15:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Anders : I already use the license page at the beginning of my installer. The page I need to display must be at the end of the installation.<br />
      <br />
      Afro : Indeed this seems to be what I am looking for. If I understand the doc correctly, there is no existing macro to create such a control, but I can do it directly, bypassing the lib entirely.<br />
      <br />
      I couldn't find any example on how to do so, though. Do you have any pointer for me ?<br />
      <br />
      Thanks to both of you.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">balexis</span><br />
      <span class="post-time small text-muted">17th April 2008 00:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Alright, I read all day to get somewhere. Only thing that does not work : clicking on a URL does not do anything.<br />
      <br />
      Here is my code :<br />
      Var Dialog<br />
      Var Label<br />
      Var Text<br />
      Var CONTROL<br />
      <br />
      !define SF_RTF 2<br />
      !define EM_STREAMIN 1097<br />
      !define EM_EXLIMITTEXT 1077<br />
      <br />
      Function MirrorPageFunc<br />
      nsDialogs::Create /NOUNLOAD 1018<br />
      Pop $Dialog<br />
      <br />
      ${If} $Dialog == error<br />
      Abort<br />
      ${EndIf}<br />
      <br />
      nsDialogs::CreateControl /NOUNLOAD "RichEdit20A" ${ES_READONLY}|${WS_VISIBLE}|${WS_CHILD}|${WS_TABSTOP}|${WS_VSCROLL}|${ES_MULTILINE}|${ES_WANTRETURN} ${WS_EX_STATICEDGE} 0 10u 100% 90u ''<br />
      Pop $CONTROL<br />
      <br />
      FileOpen $4 "1.rtf" r<br />
      <br />
      StrCpy $0 $CONTROL<br />
      <br />
      SendMessage $CONTROL ${EM_EXLIMITTEXT} 0 0x7fffffff<br />
      ; set EM_AUTOURLDETECT to detect URL automatically<br />
      SendMessage $CONTROL 1115 1 0<br />
      <br />
      System::Get /NoUnload "(i, i .R0, i .R1, i .R2) iss"<br />
      Pop $2<br />
      System::Call /NoUnload "*(i 0, i 0, k r2) i .r3"<br />
      <br />
      System::Call /NoUnload "user32::SendMessage(i r0, i ${EM_STREAMIN}, i ${SF_RTF}, i r3) i.s"<br />
      <br />
      loop:<br />
      Pop $0<br />
      StrCmp $0 "callback1" 0 done<br />
      System::Call /NoUnload "kernel32::ReadFile(i $4, i $R0, i $R1, i $R2, i 0)"<br />
      <br />
      Push 0 # callback's return value<br />
      System::Call /NoUnload "$2"<br />
      goto loop<br />
      done:<br />
      System::Free $2<br />
      System::Free $3<br />
      FileClose $4<br />
      <br />
      nsDialogs::Show<br />
      FunctionEnd<br />
      <br />
      The RTF file only contains a string :<br />
      <a href="http://www.google.ca" target="_blank">http://www.google.ca</a><br />
      I can see the string being blued and underlined, and the mouse cursor changes from the regular arrow to a hand with a little pointing finger. However, clicking does nothing.<br />
      <br />
      Any hints ?<br />
      <br />
      Alexis</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">17th April 2008 01:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is nothing stopping you from using more than one licensepage.<br />
      <br />
      Also checkout <a href="http://nsis.sourceforge.net/Readme_Page_Based_on_MUI_License_Page" target="_blank">http://nsis.sourceforge.net/Readme_P...I_License_Page</a><br />
      <br />
      If you still want to use nsDialogs, you must do:<br />
      <br />
      SendMessage(hwLicense,EM_SETEVENTMASK,0,ENM_LINK|ENM_KEYEVENTS);<br />
      <br />
      then handle WM_NOTIFY ( see <a href="http://nsis.svn.sourceforge.net/viewvc/nsis/NSIS/trunk/Source/exehead/Ui.c?revision=5429&amp;view=markup" target="_blank">http://nsis.svn.sourceforge.net/view...29&amp;view=markup</a> (search for EN_LINK) )<br />
      <br />
      I'm not sure if it's possible to do with the current nsDialog, can't remember exactly how it handles WM_NOTIFY</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">balexis</span><br />
      <span class="post-time small text-muted">17th April 2008 14:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Anders, thanks for your help.<br />
      <br />
      I just realized how much you could customize a License page, this is really great and pretty much easier than to create an entirely custom page from CreateControl.<br />
      <br />
      One last question for you and I'll be all set : I can't seem to set two different values (one for each License page) for the MUI_TEXT_LICENSE_TITLE define. As soon as I set it, it is displayed in both license pages. It is the only define that behaves this way. See code here :<br />
      <br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      ; Show first default License page<br />
      !insertmacro MUI_PAGE_LICENSE 1.rtf<br />
      <br />
      ; Code to modify our custom license page<br />
      !define MUI_LICENSEPAGE_TEXT_TOP ""<br />
      !define MUI_LICENSEPAGE_TEXT_BOTTOM ""<br />
      !define MUI_LICENSEPAGE_BUTTON "Next"<br />
      !define MUI_TEXT_LICENSE_SUBTITLE ""<br />
      !define MUI_TEXT_LICENSE_TITLE "Something"<br />
      LicenseText " "<br />
      !insertmacro MUI_PAGE_LICENSE 1.rtf<br />
      !insertmacro MUI_PAGE_FINISH<br />
      <br />
      The first license page is displayed with all the default text, except for the "Something" string appearing instead of the default "License Agreement" string.<br />
      <br />
      Bug or expected behavior ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">17th April 2008 15:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">!define MUI_PAGE_HEADER_TEXT "foo"<br />
      !define MUI_PAGE_HEADER_SUBTEXT "bar"<br />
      !insertmacro MUI_PAGE_LICENSE "${__FILE__}"<br />
      <br />
      OR you can use a show callback function and call the MUI_HEADER_TEXT macro</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">balexis</span><br />
      <span class="post-time small text-muted">17th April 2008 15:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is excellent!<br />
      <br />
      Thank you very much Anders, you have been very helpful.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
