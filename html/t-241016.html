<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Library.nsh and the docu" />

  <title>Library.nsh and the docu - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Library.nsh and the docu</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=241016">Library.nsh and the docu</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">coco_vc</span><br />
      <span class="post-time small text-muted">16th March 2006 13:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Library.nsh and the docu</strong><br />
      Hi all,<br />
      <br />
      I plan to have my installer script built on Linux for getting a Windows binary. I need to use the Library.nsh features and in the docu for Library.nsh I read "Note that you can only compile scripts using this system on Windows systems. It is not possible to compile on Linux etc.".<br />
      I don't have any Linux to test this so I'll ask here: this statement doesn't really suggest that you can't build a Windows binary on a Linux system if Library.nsh calls have been used right? (I assume that statement is trying to state that a linux binary can't be obtained if Library.nsh feature are used, but I want to be 100% sure about this.)<br />
      <br />
      Thx,<br />
      Viv</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th March 2006 18:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It does state that you can't use Library macros on Linux. The Library macros need to read version information and type library version information from files. While version information can probably be easily read using the already available resource editor class, reading type library version information requires some work.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">coco_vc</span><br />
      <span class="post-time small text-muted">16th March 2006 20:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi kichik,<br />
      <br />
      Thanks for your answer, but I still am not sure if I have a problem or not. So I rephrase the question in order for you to be able to answer just a yes or no (maybe I'm just too dumb or too tired now):<br />
      If I use Library.nsh features/calls in my script can I then successfully build a Windows binary on a Linux machine using NSIS?<br />
      <br />
      Thx,<br />
      Viv</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">16th March 2006 20:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">as stated in the docs:<br />
      NO! unfortunately not.<br />
      <br />
      it would require to alter the whole library.nsh, if even possible...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">coco_vc</span><br />
      <span class="post-time small text-muted">17th March 2006 11:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, then what can I do in case I need the following 2 features:<br />
      - build a windows installer on a Linux system<br />
      and<br />
      - use the Library calls (b/c I need to update dlls in-use)<br />
      ?<br />
      <br />
      Thx,<br />
      Viv</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th March 2006 11:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can modify Library.nsh a bit so it won't use LibraryLocal.exe. It won't work with type libraries and will fail if the DLL doesn't contain version information, but I guess it's better than nothing.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">coco_vc</span><br />
      <span class="post-time small text-muted">17th March 2006 14:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks kichik,<br />
      <br />
      Another way: I think in case it's mandatory to build on a Linux system that I could also use the File, Delete, Rename calls with /REBOOTOK flag instead of using Library calls, for my dlls that don't need to be registered and are not shared right? I could somehow do an update of an in use dll with these function without having Library call correct?<br />
      <br />
      Thx,<br />
      Viv</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th March 2006 14:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, you can use <a href="http://nsis.sourceforge.net/Special:Search?search=upgradedll" target="_blank">UpgradeDLL</a> which does just that. It also uses GetDLLVersionLocal like the new Library.nsh version I've attached above.<br />
      <br />
      The problem with Linux and the Library is only with the version information. If you get rid of it, or put some limits on what can be done, it can be used.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">coco_vc</span><br />
      <span class="post-time small text-muted">17th March 2006 14:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Or, I could use Library calls and use wine on Linux to build the script. I'll have to see for one of these solutions ...<br />
      <br />
      Thx,<br />
      Viv</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">coco_vc</span><br />
      <span class="post-time small text-muted">17th March 2006 16:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">btw, where can I find some docu about UpgradeDLL? I found in the installed package the UpgradeDLL.nsh but couldn't find any docu about this one.<br />
      Would I need for using UpgradeDLL the dll to have version information?<br />
      <br />
      Thx,<br />
      Viv</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th March 2006 16:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It needs version information but you can use it as a script example.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">coco_vc</span><br />
      <span class="post-time small text-muted">17th March 2006 18:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thx kichik.<br />
      <br />
      And where could I find some UpgradeDLL docu?<br />
      <br />
      Thx,<br />
      Viv</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th March 2006 19:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There's none. It's deprecated. But the code is pretty short and self explanatory.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stb</span><br />
      <span class="post-time small text-muted">20th March 2006 08:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@coco_vc:<br />
      <br />
      If the DLLs do not often change (e.g. MS DLLs) you could think about building some separate DLL installer package on Windows and using this helper package within your main installer (call it with "Exec"/"ExecWait" ...)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">coco_vc</span><br />
      <span class="post-time small text-muted">21st March 2006 16:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">kichik --<br />
      <br />
      Thx for your changed library.nsh and your suggestions. I can't use your modified library.nsh file as one of my requirements is that anybody should be able to compile my script with the NSIS version specified in the docu, so I can't deploy the modified library.nsh also.<br />
      So I'll try to understand the UpgradeDLL and go that way. When I'll do so I might come back with other questions :)<br />
      <br />
      btw, can't in future versions, library.nsh be modified so that when a specific param is specified no versioning is involved so the script would be then:<br />
      - compilable on linux system<br />
      and<br />
      - the call won't fail if the dll doesn't hold any version<br />
      ?<br />
      <br />
      stb --<br />
      <br />
      The dll I'm talking about is changing with almost every version, so I will have to upgrade it along with the other binaries.<br />
      <br />
      Thx,<br />
      Viv</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">21st March 2006 17:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can distribute the modified Library.nsh along with your script. If you use "!include Library.nsh", it'll first search the script's directory. You can also wait for version 2.16 which will include a modified Library.nsh.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">coco_vc</span><br />
      <span class="post-time small text-muted">22nd March 2006 09:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">&gt; You can also wait for version 2.16 which will include a modified Library.nsh.<br />
      <br />
      Are you saying that:<br />
      a) the NSIS version 2.16 will include your already modified Library.nsh (the one that fails if the dll doesn't have a version)?<br />
      or<br />
      b) it will actually include the change so that it will be compilable on linux and won't fail if the dll doesn't hold a version?<br />
      <br />
      Thx,<br />
      Viv</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd March 2006 18:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It'll still fail for DLLs without version history. Only on Linux, of course.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">coco_vc</span><br />
      <span class="post-time small text-muted">10th April 2006 13:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi *,<br />
      <br />
      I noticed that indeed this was implemented for version 2.16 "Library now available on non-Windows platforms as well, although it requires the installed DLL to have version information" which is nice, but I want to ask something: isn't there any way, in future versions, to make it run (build windows binary on linux) even if the dll doesn't have a version? Like having one more param saying "I really don't care about version" and in that case no version checking to be done?<br />
      <br />
      Thx,<br />
      Viv</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">coco_vc</span><br />
      <span class="post-time small text-muted">26th June 2006 13:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi kichik,<br />
      <br />
      Don't want to be pushy, but I would like to know the answer to the above question. I mean would, in future versions, exist the possibility to: use Library calls and in the same time to build the code on linux, in case the version is not interesting at all?<br />
      For instance:<br /></p>
      <pre>
<code><br />!insertmacro InstallLib DLL NOTSHARED REBOOT_NOTPROTECTED "Files\lolo.exe" "$SYSDIR\lolo.exe" "$SYSDIR" VERSION_NOT_CARE<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th June 2006 09:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's a feature that would be nice to have, so of course it should be in a future version. Which version is another question. You could speed up the process by submitting a patch for this.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
