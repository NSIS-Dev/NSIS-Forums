<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="progress window on uninstaller" />

  <title>progress window on uninstaller - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">progress window on uninstaller</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=148108">progress window on uninstaller</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mancini</span><br />
      <span class="post-time small text-muted">4th September 2003 16:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>progress window on uninstaller</strong><br />
      i think i seen this done where it shows the things that it uninstalls<br />
      <br />
      how is that done ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mancini</span><br />
      <span class="post-time small text-muted">19th October 2003 13:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">maybe i havent explained myself too well<br />
      <br />
      i seen some nsis uninstallers that when executed show a list of the things being uninstalled and a progress bar<br />
      <br />
      anybody understands what i mean ?<br />
      <br />
      can anyone give me any help on how to do that ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">19th October 2003 13:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It does show the progress by default.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mancini</span><br />
      <span class="post-time small text-muted">19th October 2003 13:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yes but it ain't showing the list of sections that are being uninstalled isn't it ... by default that is</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">19th October 2003 13:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That can be done in the latest CVS version. In the latest CVS version you can add a components page to the uninstaller too. Create the sections that you want to show there (Section "un.Uninstall this"), insert the components page and you're good to go.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mancini</span><br />
      <span class="post-time small text-muted">19th October 2003 13:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">strange .. i thought i seen that on a installer some months ago<br />
      <br />
      will those changes from the cvs you mentioned be in the nsis20 beta 4 ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">19th October 2003 13:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, those changes will be in 2.0b4.<br />
      <br />
      That old installer might have been using an InstallOptions page to emulate the components page. If you don't want to use the latest CVS version that's the solution for you.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mancini</span><br />
      <span class="post-time small text-muted">19th October 2003 13:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">im just not sure wich cvs version<br />
      do you mean <a href="http://cvs.sourceforge.net/viewcvs.py/nsis/NSIS/NSIS.exe" target="_blank">http://cvs.sourceforge.net/viewcvs.p.../NSIS/NSIS.exe</a><br />
      <br />
      Revision 1.7 ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">19th October 2003 13:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">NSIS.exe is the NSIS Menu. You can't download just parts of the latest CVS version, you have to download it all. See <a href="http://nsis.sourceforge.net/site/Development.4.0.html" target="_blank">the development page</a> for more information about the latest development verison. If you want to update, you should get the development snapshot.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mancini</span><br />
      <span class="post-time small text-muted">19th October 2003 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">like this ?<br />
      <br />
      Section "un.Uninstall this"<br />
      ?????????????????????????<br />
      SectionEnd<br />
      <br />
      i cant understand what the section should contain<br />
      <br />
      you say insert the components page but the only insert thing in NSIS i know is insertmacro<br />
      <br />
      i think im stuck<br />
      <br />
      forthermore not even the uninstall progress window shows now<br />
      <br />
      I have the following pages :<br />
      <br />
      Page license<br />
      Page components<br />
      Page instfiles<br />
      UninstPage uninstConfirm<br />
      UninstPage instfiles</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">19th October 2003 17:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The section should contain whatever you want it to contain. If you want a section to uninstall a certain component, uninstall it in that section; if you want a section to delete some system files, delete the system files in that section; etc.<br />
      <br />
      Insert that page depends on weather you're using the MUI or not. If you're using the MUI, see the MUI readme and examples. If you're not using the MUI use the normal Page and UninstPage commands or the new PageEx command.<br />
      <br />
      As for the uninstall progress bar, you are probably using the MUI if that part doesn't work. If you're not using the MUI, make sure you don't have any other UninstPage commands floating around.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mancini</span><br />
      <span class="post-time small text-muted">19th October 2003 17:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i can use : SubSection "un.Uninstall ${NAME}" then ?<br />
      <br />
      no i am not using the modern interface<br />
      <br />
      and i had SilentUnInstall silent .. my bad</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">19th October 2003 17:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, you can use SubSections in the uninstaller.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mancini</span><br />
      <span class="post-time small text-muted">19th October 2003 17:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">well i get<br />
      <br /></p>

      <blockquote>
        SectionEnd<br />
        SubSectionEnd<br />
        SubSection un.Uninstall Apache2Triad<br />
        Section: "stop services"<br />
        Error: Can't create installer section in uninstaller subsection (use SubSectionEnd first)<br />
        Error in script "C:\1\triad.nsi" on line 310 -- aborting creation process
      </blockquote>altrough the subsection preceding it is closed like you see
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">19th October 2003 17:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As the error says, you can't create installer section in uninstall SubSection. The section must have the un. prefix too.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mancini</span><br />
      <span class="post-time small text-muted">19th October 2003 18:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hmmm .. i think i havent explained myself too good this time either...<br />
      i wanted that on the UninstPage instfiles window , section names to show, instead of the actuall commands executed by the uninstaller<br />
      <br />
      ex :<br />
      <br /></p>
      <pre>
<code><br />SubSection "un.Uninstall ${NAME}"<br />Section "un.Uninstall Stoping services"<br />        ExecWait '"net stop" Apache2'<br />SectionEnd<br />Section "un.Uninstall Removing files"<br />        RMDir /r "${DIR}"<br />SectionEnd<br />Section "un.Uninstall Removing paths"<br />        Push "C:\apache2\bin"<br />        Call un.RemoveFromPath<br />SectionEnd<br />SubSectionEnd<br /></code>
</pre><br />
      <br />
      Stoping services , Removing files , Removing paths to show intead of Execute: "net stop" Apache2 , Remove folder: c:\apache2 ..etc<br />
      <br />
      Uninstallshield like .. the progress bar moves while checkboxes are put in front of the coresponding "section name" string<br />
      <br />
      is this posible ?<br />
      <br />
      oh and sorry for bugging you so much about it .. it would just be quite nice if it was posible .. if not .. well thats life
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">19th October 2003 19:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, that's a different story then... You can create your own UI that has place to put this. The original version of NSIS Update had something similar going on. If you have the time and the will, contact <a href="http://forums.winamp.com/member.php?s=&amp;action=getinfo&amp;userid=72370" target="_blank">Techkid</a> or create it yourself.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mancini</span><br />
      <span class="post-time small text-muted">19th October 2003 19:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok thanks .. ill also try and find again the installer that i seen this done on and contact the people behind it</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
