<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="NSISArray plugin" />

  <title>NSISArray plugin - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" NSISArray plugin" />

  <title>NSISArray plugin - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" NSISArray plugin" />

  <title>NSISArray plugin - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" NSISArray plugin" />

  <title>NSISArray plugin - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">NSISArray plugin</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=222275">NSISArray plugin</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">23rd July 2005 18:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NSISArray plugin</strong><br />
      A plugin which adds fast dynamic array support to NSIS with over 20 functions for array manipulation.<br />
      It also has an array script header to mask the plugin calls with a more friendly scripting syntax.<br />
      <br />
      <a href="http://nsis.sourceforge.net/wiki/File:NSISArray.zip" target="_blank">http://nsis.sourceforge.net/wiki/File:NSISArray.zip</a><br />
      <br />
      <b>Please note:</b><br />
      If you have a previous release of NSISArray installed, please delete the <b>Contrib\NSISArray</b> and <b>Examples\NSISArray</b> folders before installing the new release.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">24th July 2005 21:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey Afrow,<br />
      I just downloaded your new plugin and from what I've seen, it looks great! (Excellent job!)<br />
      <br />
      But I have one quick question:<br />
      In the Include folder, you have the file NSISArray.nsh. But the file includes another NSISArray.nsh file located in ${NSISDIR}\Contrib\NSISArray. Why not just have the one <b>real</b> NSISArray.nsh in the include folder? (This would be less confusing and easier to maintain in my opinion.)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">24th July 2005 22:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If there is only source code in the Contrib folder (so nothing for the end-user), I would also recommend you to put the actual contents in Include.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">25th July 2005 00:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Good question! I think I just did it because of Modern UI and my Self-Extractor kit. It just keeps all the source code (C++/NSIS) in one folder so if someone (or I) wants to modify the source code (plugin code or the NSIS code), we know where to find it.<br />
      <br />
      The readme and some examples are also in the Contrib folder so again, everything is kept close together.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">25th July 2005 02:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I was testing the arrays and ran into a few problems. Please look at this dummy script:<br /></p>
      <pre>
<code><br />name 'test array'<br />outfile 'test_array.exe'<br />!include NSISArray.nsh<br /><br />Section<br />  DetailPrint "Initializing array..."<br />  ${Array} "TestArray"<br />  ${TestArray-&gt;Init}<br />  DetailPrint "adding 'dog'"<br />  ${TestArray-&gt;Push} "dog"<br />  DetailPrint "Adding 'hippo'"<br />  ${TestArray-&gt;Push} 'hippo'<br />  DetailPrint "Adding 'cat'"<br />  ${TestArray-&gt;Push} 'cat'<br />  ${TestArray-&gt;SizeOf} $0<br />  DetailPrint "My Array now contains $0 items:"<br />  ${TestArray-&gt;Search} $1 "dog" 0<br />  DetailPrint "'Dog' is item $1"<br />  DetailPrint "All items: "<br />  ${TestArray-&gt;Concat} $2 ", "<br />  DetailPrint $2<br />SectionEnd<br /><br />page instfiles<br /></code>
</pre><br />
      <br />
      During compile, on this line:<br />
      ${TestArray-&gt;Search} $1 "dog" 0<br />
      I get this error:<br />
      !insertmacro: macro "Array_Search" requires 4 parameter(s), passed 5!<br />
      <br />
      If I REM this line, then I get an error at runtime that says "SizeOf:parameter error"<br />
      <br />
      Am I being stupid or are these both bugs?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">25th July 2005 13:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>Good question! I think I just did it because of Modern UI and my Self-Extractor kit. It just keeps all the source code (C++/NSIS) in one folder so if someone (or I) wants to modify the source code (plugin code or the NSIS code), we know where to find it.<br />
        <br />
        The readme and some examples are also in the Contrib folder so again, everything is kept close together.<br />
        <br />
        -Stu</b>
      </blockquote>The point is that the Modern UI also puts other NSIS header files (langauge files) and data in the 'Contrib\Modern UI' folder.<br />
      <br />
      Documentation and source files are indeed also in the Contrib folder on the CVS server, but for end-user releases the build system puts documentation in the Docs folder and examples in the Examples folder.<br />
      <br />
      So whenever releasing a compiled plug-in for the end-user, there should be nothing in Contrib at all, just a binary in Plugins, a readme in Docs and a example in Examples (and maybe a header file in Include).
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">25th July 2005 19:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah right I see.<br />
      I'll change everything so it's like that (nsh in Include, docs in Docs).<br />
      <br />
      Edit: Yeh they are bugs. One was an error in the plugin code and the other was in the NSH. Uploading new build now.<br />
      <br />
      Edit #2: Uploaded.<br />
      Before installing, delete the Contrib\NSISArray folder, because now the readme is in Docs, and NSH in Include.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">25th July 2005 20:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, Afrow.<br />
      <br />
      hmmm.. Technical difficulties: I can't seem to get to the Wiki at the moment. As soon as it lets me, I'll download it and try it out.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">25th July 2005 21:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The SourceForge database server has performance issues, they are working on doubling the capacity. In the meanwhile the NSIS Site and Wiki may be slow during peak times.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">27th July 2005 04:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey Afrow,<br />
      The sample script above seems to work, but I need you clarify something for me regarding the 'SizeOf' function.<br />
      <br />
      Your docs describe this as:<br /></p>

      <blockquote>
        Places the amount of items in myArray into $Var.
      </blockquote>Based on this, I would expect it to return the total number of elements in the array. However, using the example above, I see that it returns 2, not three. While 2 is the highest element number (due to the fact that the array is zero-based), the total number of elements (items) in the array is actually 3.<br />
      <br />
      So, I feel that either your function or the documentation are wrong. (either way you go is fine, but one should match ther other.) Would you agree?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">28th July 2005 20:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's interesting. For some reason in the source I was taking 1 away from the output (when I shouldn't have been).<br />
      <br />
      I will recompile and upload v0.3<br />
      <br />
      Thanks for finding this out.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">29th July 2005 00:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No problem. I've been wanting to check some of the other functions, but just haven't had time. From the little I've worked with it, this looks like it will be a very powerful plugin.<br />
      <br />
      And I have to complement you on the array debug utility you included with this plugin. That is a really nice touch--should make problem solving a lot easier.<br />
      <br />
      I can tell you put a lot of thought into this. Keep up the great work! :up: :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">29th July 2005 05:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok Afrow, now that I've buttered you up, I've got several bugs to report! :eek:<br />
      <br />
      you are really gonna get tied of me! hehe!<br />
      :p<br />
      <br />
      Note: this is just some quick prelim testing. Time permitting, I'd like to test all functions. (Feel free to use a PM if you think that'd be easier.) Sample scripts for each are attached.<br />
      <br />
      <b>Bug #1</b><br />
      (Test_01.nsi) Calling <i>Write</i> to an existing array overwrites the element as expected, but also adds an empty element to the end of the array.<br />
      <br />
      <b>Bug #2</b><br />
      (Test_02.nsi) Calling <i>WriteListC</i> causes the install to crash. (must be a problem in the plugin itself).<br />
      BTW: Can <i><b>CHAR</b></i> be a string or should it always be a single character?<br />
      <br />
      <b>Bug #3</b><br />
      (Test_03.nsi) My understanding of the <i>Put</i> command is that it should insert an item at a specfied element. However, it doen't seem to do that. I start with an array of zero,one,two,three. After I call <font color="blue">${TestArray-&gt;Put} 1 'insert'</font>, I end up with null,insert,one,three,null. (It'll probably make more sense once you compile the example script.)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">29th July 2005 11:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Right thanks.<br />
      1. Easy fix (I know what the issue is :)).<br />
      2. Yes, it has to be a single character. I'll add some code to prevent people using a string.<br />
      3. Not sure why this is happening but I'll look into it.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">29th July 2005 12:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks again Comperio, uploaded fixed version.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">30th July 2005 00:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">All fixes worked great!<br />
      :up:<br />
      <br />
      Minor detail:<br />
      You may want to mention in the docs that that CHAR in the <font color="blue">WriteListC</font> function is just a single character.<br />
      <br />
      If I get more time this weekend, I'll continue testing the other functions.<br />
      <br />
      Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">30th July 2005 18:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Another bug. Using the function <font color="blue">ReadToStack</font>, I found I had to commend out line #136 of the NSISArray.nsh file:<br /></p>
      <pre>
<code>!macro Array_ReadToStack Plugin Name<br />   ${Plugin}::ReadToStack /NOUNLOAD "${Name}"<br />   <b>Pop "${ArrayErrVar}" <font color="red"> ### this is the line that needed commented out</font></b><br />!macroend</code>
</pre><br />
      I didn't find ${ArrayErrVar} defined anywhere in the header file. And I didn't see that anything extra was being pushed to the stack by your plugin. (Maybe you were using ArrayErrVar when debugging and just forgot to take it out?)<br />
      <br />
      <b>Also:</b><br />
      When I called PushToStack, I noticed that it pushed in the reverse order than I was expecting based on your example. I pushed the Array [0,1,2,3] and when I popped, I got 3, 2, 1, and then 0. I'm not saying you need to change the code, but perhaps you could just make that clearer in the docs.:cool:
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">30th July 2005 22:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Found another bug (maybe?)<br />
      Using the <font color="blue">Splice</font> function this time. I start out with this array: [zero,one,two,three]<br />
      <br />
      I call this command:<br />
      ${TestArray-&gt;Splice} 0 3 "'0' '1' '2'"<br />
      <br />
      Based on the docs, this should replace elements from index 0 up to, but not including, index 3. Therefore, I'd expect this:<br />
      [0,1,2,three]<br />
      <br />
      but instead I get this:<br />
      [0,1,2]<br />
      <br />
      I've attached my sample script for you to look over.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">30th July 2005 23:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, 2 more bugs, and I think that's it:<br />
      <b><u>Bug #1</u></b><br />
      A bug in the debug program. (how ironic is that?)<br />
      <br />
      I have 2 arrays. One named TestArray1 and the other TestArray2.<br />
      <br />
      If I use ${TestArray1-&gt;Debug}, I get the dialog that shows the contents of TestArray1. But if I then call ${TestArray2-&gt;Debug}, I still get the contents of TestArray1, even though the page caption tells me its TestArray2.<br />
      <br />
      renaming TestArray2 to "blah" also gave the same thing. But by calling the SizeOf function, I as able to determine the Arrays themselves are OK. So it's got to be just a bug in the debug function of the plugin itself.<br />
      <br />
      (Use the attached script called "copy.nsi" to test)<br />
      <br />
      <b><u>Bug #2</u></b><br />
      Your docs say that the <font color="blue">search</font> command is supposed to be case <u>in</u>sensitive, but in my testing, it's actually not. (see attached "search.nsi")<br />
      <br />
      and BTW: I see that <font color="blue"><i><u>Exists</u></i></font> and <font color="blue"><i><u>Search</u></i></font> do pretty much the same. So why can you specify a starting index with SEARCH and not with EXISTS?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">31st July 2005 12:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, fixed.<br />
      <br />
      -Stu :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">31st July 2005 16:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I still have the problems with ReadToStack and Splice. (See my first 2 posts from yesterday).<br />
      <br />
      Edit:<br />
      But the other problems are OK now.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">31st July 2005 16:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Doh I didn't see the post above it.<br />
      Will look into it soon.<br />
      <br />
      Edit:<br />
      They should also all be fixed now. Just waiting to get on the machine I use for compiling.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">31st July 2005 18:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Uploaded new build (still v0.5 though).<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">31st July 2005 18:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, getting closer...<br />
      <br />
      1. SearchI is not defined in your NSISArray.nsh<br />
      2. When adding SearchI, the plugin call is working, but returns the same as the regular Search. (In other words, SearchI is not case insensitive like it's supposed to be.)<br />
      3. Both Exists and ExistsI return a 'parameter error' from the plugin<br />
      <br />
      New examples attached.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st August 2005 01:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Dear me, that wasn't very good :(<br />
      I've updated the readme and NSISArray.nsh properly. Just trying to upload now, but sourceforge is having problems as usual.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">1st August 2005 03:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey Afrow,<br />
      I've been having problems on an off with my own ISP.. Kind of refreshing to know I'm not the only one!<br />
      <br />
      I was going to mention that I've saved all my test scripts for every function in your plugin. Just let me know if you'd like a copy of them to include as examples in with your plugin distribution. (I can either post them here, on the Wiki, or send them to you directly.)<br />
      <br />
      Thanks again for all your help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st August 2005 11:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I was thinking that also. Please send them to afrowuk at tiscali dot co dot uk<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st August 2005 15:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Uploaded new build. I've done a bit more than bug fixes in this release (although it's still v0.5). Check the Change Log in the readme.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">1st August 2005 23:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey Afrow,<br />
      I downloaded the new version today and it works great!<br />
      <br />
      Now for a feature request:<br />
      It would be nice if you could give the developer the option to trap the plugin errors rather than having the plugin display its own message box when there's a problem. I was thinking of perhaps having the plugin place another value on the stack after the return value. A zero could mean no problems or a unique error code based on one of your predefined errors.<br />
      <br />
      For example, -1 might mean "Array name already declared", -2 would mean "Parameters error.", and so on. Then, you could either wrap the 'english translation' of the error into a plugin call or just use !defines in your NSH header file in case the developer chose to display the erorr you have now. (Using the NSH file, you could even use this to set the error flag if you wanted.)<br />
      <br />
      It would add another pop command to each plugin call, but for flexibility to the developer, I think it would be worth it. Whatcha think?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">2nd August 2005 13:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is how it was before. Remember there was a Pop ${ArrayErrVar} in ReadToStack. Error messages used to get passed onto the stack, but for some reason I changed it.<br />
      I'll add this in today as the default with a compile-time define to use MessageBox's instead.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">2nd August 2005 19:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Uploaded v0.6 with the new $ArrayErr (stack) error support. Use !define ArrayErrorMsgBox to use the old school error message boxes.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">5th August 2005 05:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Afrow,<br />
      Just found another bug. In your header in the macro 'Array_Delete', you are undefining ${ArrayObj}.<br />
      <br />
      Since ${ArrayObj} is used goblaly (meaning that more than one array can use it), it will cause the compiler to crash when you need to undefine more than one array.<br />
      <br />
      (The reason I spotted it was becuase I happend to be using 2 arrays in my installation.)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">5th August 2005 11:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For some reason I missed out the new header file which adds support for the ArrayErrorMsgBox define (and fixes that problem you've mentioned).<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">5th August 2005 15:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Another issue I'm still looking into, but perhaps you could guide me:<br />
      <br />
      I've noticed that NSISArray.dll is not being removed from the plugins directory. I'm using 2 arrays and I'm deleting both using the ${arrayName-&gt;delete} command in my last (hidden) section.<br />
      <br />
      Should I be placing this command somewhere else (like in .onInstSuccess)? Is there another command/procedure I should be using?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">6th August 2005 12:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'll have a look. It could be a /NOUNLOAD issue.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">6th August 2005 13:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've added ${ArrayUnload} to this build (v0.6 RC3).<br />
      Also updated all your example scripts (can't use ${Array} inside a Section or Function, added ${Array-&gt;Delete} and ${ArrayUnload} to all scripts).<br />
      <br />
      I found out why NSISArray.nsh wasn't included in the last Zip. It actually was, but for some reason it was put in the Plugins folder instead. So make sure you delete Plugins\NSISArray.nsh.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">6th August 2005 17:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks! I'll check it out.<br />
      <br />
      edit:<br />
      Things seem to be working great!<br />
      :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">superruzafa</span><br />
      <span class="post-time small text-muted">7th August 2005 02:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I want to use two arrays in my installer. This basic example results in a compiling error. A bug?<br />
      <br /></p>
      <pre>
<code>!include nsisarray.nsh<br /><br />outfile array.exe<br /><br />${Array} "array1"<br />${Array} "array2"<br /><br />section -array<br /><br />sectionend</code>
</pre>
      <pre>
<code>Error: variable "ArrayErr" already declared<br />Error in macro Array on macroline 3</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">7th August 2005 05:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I did some digging and found the problem (and turned up another problem in the process). My modified header file attached should fix it. (Note that I changed the name of the header file. Afrow may have another way he'd prefer to handle it so I didn't want my modifications to be confused with the 'official' version.)<br />
      <br />
      Two problems addressed (which are also commented in the attached header file):<br />
      1. the variable ArrayErr was getting defined multiple times when the array messagebox handling was turned off. To correct this, I turned the !define "ArrayErrorMsgBox" into a macro. So insted of using the "!define ArrayErrorMsgBox", I can now use "${ArrayErrorMsgBox}". (This is only if you want the plugin to generate error messages instead of you handling it the script. See the original docs for more info.)<br />
      <br />
      2. ArrayUnload was also getting defined more than once. To correct this, I simply enclosed the ArrayUnload define inside an "!ifndef" block.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">7th August 2005 09:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for helping out.<br />
      I had to go about ArrayErrorMsgBox differently though as when the ArrayErrorMsgBox is defined, all functions will do a Pop $ArrayVar. However, your code had it defined constantly and therefore it couldn't work.<br />
      With the Var ArrayErr, I've just added another define so that it isn't added twice.<br />
      <br />
      (Uploaded v0.6 RC4)<br />
      <br />
      -Stu</p>
    </div>
    <hr />
    <!-- Bootstrap core CSS -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <div class="container">
      <!-- Put navigation bar here -->

      <ol class="breadcrumb">
        <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

        <li><a href="f-65.html">NSIS Discussion</a></li>

        <li class="active">NSISArray plugin</li>
      </ol>

      <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=222275">NSISArray plugin</a></p><br />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
        <span class="post-time small text-muted">7th August 2005 16:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I see your point...<br />
        :tinfoil:<br />
        <br />
        RC4 looks good. Thanks again!</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">9th August 2005 12:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Uploaded v0.7.<br />
        <br />
        Added a second parameter to ${myArray-&gt;Sort} which can specify another array name. The 2nd array will be rearranged into the same order as the sorted array (works like associative arrays). Both arrays must be of the same size initially.<br />
        <br />
        Added the SetSize function to set the array to a specific size of items.<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">10th August 2005 12:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Uploaded v0.7 RC3.<br />
        Minor code changes and readme typo fixes.<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">14th August 2005 16:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Uploaded 0.7 RC4<br />
        <br />
        Added ReadFirst, ReadNext and ReadClose.<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">17th August 2005 13:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Uploaded v0.8<br />
        <br />
        Added IsEmpty, IsFull, IsInRange, and ArrayExists / Inited.<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br />
        <span class="post-time small text-muted">26th February 2006 21:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hello,<br />
        <br />
        It would be possible to add a function in the array plug-in that erase the elements which appear already in the array?</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">bholliger</span><br />
        <span class="post-time small text-muted">1st March 2006 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>array-pop does not work</strong><br />
        Hi Stu<br />
        <br />
        This array-plugin is great! Thank you very much!<br />
        <br />
        With the plugin I would like to pop some values from the array. The value returned was "2" and nothing happened to the array.<br />
        <br />
        Even the provided example did not work. I would be glad, if you could investigate in this.<br />
        <br />
        Thank you very much!<br />
        <br />
        Have a nice Day.<br />
        <br />
        -Bruno.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">1st March 2006 17:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Will look at it now.<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">1st March 2006 18:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanks, fixed.<br />
        Let me know if you discover any other problems.<br />
        <br />
        <a href="http://nsis.sourceforge.net/File:NSISArray.zip" target="_blank">http://nsis.sourceforge.net/File:NSISArray.zip</a><br />
        <br />
        SuperPat:<br />
        Use ${myArrayName-&gt;Clear}<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">bholliger</span><br />
        <span class="post-time small text-muted">1st March 2006 18:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Wow great! Thank you very much!<br />
        <br />
        -Bruno.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">ahab282</span><br />
        <span class="post-time small text-muted">16th March 2006 10:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hey Stu!<br />
        <br />
        Your plugin is really great!<br />
        But I have a problem with your script.<br />
        For example when executing ${MyArray-&gt;Init} there seems to be a value popped from the stack but the function in your plugin doesn't push anything to the stack so the stack is getting emptier!<br />
        <br />
        Some other macros do this too!<br />
        <br />
        I think it's a bug, isn't it!?<br />
        <br />
        -Marcy</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Grimace</span><br />
        <span class="post-time small text-muted">28th March 2006 08:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Variable name length</strong><br />
        I'm new to NSIS and gratefully using the NSISArray plugin. I stumbled upon an issue which I, by some debugging, tracked down to variable name length of arrays. I'm not sure whether this restriction is by NSIS design, or an NSISArray issue (or just me overlooking something else).<br />
        <br />
        Anyway, when using the following code:<br />
        <br /></p>
        <pre>
<code><br />${Array} "TheObject-&gt;Foo1_"<br />${Array} "TheObject-&gt;Foo2_"<br /><br />Section<br />        ${TheObject-&gt;Foo1_-&gt;Init}<br />        ${TheObject-&gt;Foo2_-&gt;Init}<br />        ${TheObject-&gt;Foo1_-&gt;Debug}<br />        ${TheObject-&gt;Foo2_-&gt;Debug}<br />SectionEnd<br /></code>
</pre><br />
        <br />
        you'll only get a debug window for the last initialized array (you can verify that by swapping the 2 Init statements). If you remove the underscore to shorten the variable names, all works fine.<br />
        <br />
        Am I stretching some limits, or is this a bug?
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Grimace</span><br />
        <span class="post-time small text-muted">28th March 2006 08:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Re: Variable name length</strong><br /></p>

        <blockquote>
          <i>Originally posted by Grimace</i><br />
          <b><br />
          Am I stretching some limits, or is this a bug?</b>
        </blockquote>Ok, I took a quick look at the plugin code, and I guess this one's responsible for it:<br />
        <pre>
<code><br />char arrNames[ARRAY_MAX_COUNT][16];<br /></code>
</pre><br />
        <br />
        I think I'll just recompile then ;)
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">28th March 2006 13:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I thought I put an error check in for that, but perhaps not.<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">23rd April 2006 21:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Version 1.1 is available for download.<br />
        <br />
        Its most notable change is support for dynamic arrays.<br />
        A complete list of changes can be found in the included documentation.<br />
        <br />
        <a href="http://nsis.sf.net/File:NSISArray.zip" target="_blank">http://nsis.sf.net/File:NSISArray.zip</a><br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">CancerFace</span><br />
        <span class="post-time small text-muted">23rd April 2006 23:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Very interesting...<br />
        Thanks AfrowUK!<br />
        :D<br />
        CF</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
        <span class="post-time small text-muted">24th April 2006 23:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I can't wait to test it after my vacation! :D</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">26th April 2006 22:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">1.2 is now available with some modifications for better error checking.<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br />
        <span class="post-time small text-muted">27th April 2006 13:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hello<br />
        <br />
        It there a bug with NSISArray 1.2 with the Exists and ExistsI function?<br />
        <br />
        This is a peace of code that add in a array the name of all the directory contained in $SMPROGRAMS (it work well with the version 1.0):<br />
        <br /></p>
        <pre>
<code>    StrCpy $MUI_TEMP2 ""<br /><br />    NSISArray::New /NOUNLOAD "SMProgList"<br /><br /><br />    SetShellVarContext current<br />    FindFirst $UMUI_TEMP3 $MUI_TEMP1 "$SMPROGRAMS\*"<br />    FindNext  $UMUI_TEMP3 $MUI_TEMP1<br />      loop:<br />      FindNext  $UMUI_TEMP3 $MUI_TEMP1<br />      StrCmp $MUI_TEMP1 "" exit<br />      IfFileExists $SMPROGRAMS\$MUI_TEMP1\* add<br />      goto loop<br />      add:<br />        NSISArray::ExistsI /NOUNLOAD "SMProgList" "$MUI_TEMP1" 0<br />                Pop $MUI_TEMP2<br /> MessageBox MB_OK "$MUI_TEMP1  $MUI_TEMP2"<br />        StrCmp $MUI_TEMP2 -1 0 NoAdd<br />          NSISArray::Push /NOUNLOAD "SMProgList" $MUI_TEMP1<br />        NoAdd:<br />      goto loop<br />      exit:<br />      FindClose $UMUI_TEMP3</code>
</pre><br />
        <br />
        Tthe value of $MUI_TEMP2 is curiously allways "4" :eek:<br />
        Consequently, no items are added in the array
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br />
        <span class="post-time small text-muted">27th April 2006 14:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I have found an other problem:<br />
        <br />
        This is a test code:<br /></p>
        <pre>
<code><br />NSISArray::New /NOUNLOAD "SMProgList"<br /><br />NSISArray::Push /NOUNLOAD "SMProgList" "a"<br />NSISArray::Push /NOUNLOAD "SMProgList" "b"<br />NSISArray::Push /NOUNLOAD "SMProgList" "c"<br />NSISArray::Push /NOUNLOAD "SMProgList" "d"<br />NSISArray::Push /NOUNLOAD "SMProgList" "e"<br />NSISArray::Push /NOUNLOAD "SMProgList" "f"<br />NSISArray::Push /NOUNLOAD "SMProgList" "g"<br /><br />NSISArray::Concat /NOUNLOAD "SMProgList" "|"<br />Pop $UMUI_TEMP3<br />MessageBox MB_OK "$UMUI_TEMP3"<br /><br />NSISArray::Delete /NOUNLOAD "SMProgList"<br />      <br />NSISArray::Unload<br /></code>
</pre><br />
        <br />
        Instead of return "a|b|c|d|e|f|g", it return "4" :(<br />
        <br />
        Edit: apprently "4" is the error code for the array does not exist
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Filus</span><br />
        <span class="post-time small text-muted">27th April 2006 14:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">In the new versions (1.1 and 1.2) <i>Write</i> function has a bug when it is writing to the last element. It's creating new "empty" element or "undeleting" one of previosuly deleted.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">27th April 2006 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanks Filus, this problem has been fixed in the new version. The problem also appeared in three other functions while I was making modifications between 1.1 and 1.2.<br />
        <br />
        v1.3 is now available for download from the same location.<br />
        <br />
        <b>Please note:</b><br />
        If you have a previous release of NSISArray installed, please delete the <b>Contrib\NSISArray</b> and <b>Examples\NSISArray</b> folders before installing the new release.<br />
        <br />
        <i>SuperPat</i>:<br />
        Sorry I hadn't updated the information on the New function.<br />
        It now requires two extra parameters.<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br />
        <span class="post-time small text-muted">27th April 2006 21:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>

        <blockquote>
          Sorry I hadn't updated the information on the New function.<br />
          It now requires two extra parameters.
        </blockquote>Yes But:<br />
        <pre>
<code><br />NSISArray::New /NOUNLOAD "SMProgList" 7 1<br /><br />NSISArray::Push /NOUNLOAD "SMProgList" "a"<br />NSISArray::Push /NOUNLOAD "SMProgList" "b"<br />NSISArray::Push /NOUNLOAD "SMProgList" "c"<br />NSISArray::Push /NOUNLOAD "SMProgList" "d"<br />NSISArray::Push /NOUNLOAD "SMProgList" "e"<br />NSISArray::Push /NOUNLOAD "SMProgList" "f"<br />NSISArray::Push /NOUNLOAD "SMProgList" "g"<br /><br />NSISArray::Concat /NOUNLOAD "SMProgList" "|"<br />Pop $UMUI_TEMP3<br />MessageBox MB_OK "$UMUI_TEMP3"<br /><br />NSISArray:Delete /NOUNLOAD "SMProgList"<br />      <br />NSISArray::Unload<br /></code>
</pre><br />
        even with the 2 parameters, this code don't work<br />
        the string is empty... :rolleyes:<br />
        What is wrong in my code?
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">27th April 2006 22:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">You forgot (or perhaps didn't know) that C strings have a NULL character on the end of them (/0) which specifies the end of the string.<br />
        <br />
        I should put a note about this in the documentation, but the minimum string length is 2 not 1.<br />
        <br />
        If you get any other problems, use NSISArray::ErrorStyle /NOUNLOAD 2 or 4 to find out what error is being produced.<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br />
        <span class="post-time small text-muted">28th April 2006 11:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Even by putting 10 15 like parameters, the string of exit remains always equal to 0<br />
        <br /></p>
        <pre>
<code><br />NSISArray::New /NOUNLOAD "SMProgList" 10 15<br /><br />NSISArray::Push /NOUNLOAD "SMProgList" "e"<br />NSISArray::Push /NOUNLOAD "SMProgList" "f"<br />NSISArray::Push /NOUNLOAD "SMProgList" "g"<br />NSISArray::Push /NOUNLOAD "SMProgList" "a"<br />NSISArray::Push /NOUNLOAD "SMProgList" "b"<br />NSISArray::Push /NOUNLOAD "SMProgList" "c"<br />NSISArray::Push /NOUNLOAD "SMProgList" "d"<br /><br />          NSISArray::Sort /NOUNLOAD "SMProgList" ""<br /><br />      ; Build the list<br />        NSISArray::Concat /NOUNLOAD "SMProgList" "|"<br />        Pop $0<br />MessageBox MB_OK "$0"<br /></code>
</pre><br />
        <br />
        My other example gives the same result
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">28th April 2006 11:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I can't test the script here at college but when I get home I will do so (6 hours from now).<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br />
        <span class="post-time small text-muted">28th April 2006 11:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I see with the debug window that the Push and the Sort functions work, but the Concat function return always "0"</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">28th April 2006 11:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I have identified the problem. It's a problem in the DLL. I'll fix it when I get home. There is also a problem with the script header which I need to fix.<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">28th April 2006 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Please try v1.3 RC3:<br />
        <a href="http://nsis.sourceforge.net/File:NSISArray.zip" target="_blank">http://nsis.sourceforge.net/File:NSISArray.zip</a><br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br />
        <span class="post-time small text-muted">28th April 2006 21:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">This version work fine.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
        <span class="post-time small text-muted">29th April 2006 22:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">A few suggestions for the docs whenever you happen to add/change something else:[list=1][*]Sometimes it's hard to remember if an array starts with element "0" or element "1". (I know the norm is to have zero-based arrays, but I use scripting languages that work both ways, so sometimes I just get confused...) It might be helpful to have this stated somewhere in the beginning of the docs.<br />
        [*]The function ${Array-&gt;Write} allows you to overwrite elements. It's made clear in the docs that the ${Array-&gt;Put} command DOES NOT overwrite existing values, but it does not mention in the docs for the ${Array-&gt;Write} command that it WILL overwrite values.[/list=1]<br />
        <br />
        PS: I just have to say how extremely useful your plugin has been for me! I use it every chance I get!<br />
        :D :up:</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">29th April 2006 23:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanks Comperio I shall add some notes to the documentation for next release.<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Pharaoh Atem</span><br />
        <span class="post-time small text-muted">1st May 2006 22:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">The latest NSISArray plugin freezes my installer... I had to revert to the version that I have that uses the .NET Framework...</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">2nd May 2006 14:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">It would be more helpful if you could identify what exactly freezes the installer (e.g. which plugin function).<br />
        Perhaps you could create an example which reproduces the problem.<br />
        <br />
        Did you make sure you extracted all the plugin files from the Zip? You can't expect to use the new plugin if you don't extract the new script header as well for example.<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Pharaoh Atem</span><br />
        <span class="post-time small text-muted">2nd May 2006 22:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I am using Component Manager, which utilizes the NSISArray plugin, and comes with it... It turns out a special build is required to use it with Component Manager... Unfortunately, neither I nor dandaman32 have VC6, but we had C::B, but I don't have a clue how to dynamically link to the VC6 library using MinGW... So, it was statically linked... If it could be dynamically linked to the VC6 DLL using MinGW, that would be good, because my installer blew up 120K for including a statically linked version...</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">2nd May 2006 23:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I guess the special build was made for custom array sizes. Since NSISArray 1.0, arrays are now dynamic and so special builds are not needed.<br />
        <br />
        I haven't seen dandaman32 around for a while, so he may not know about the new version. To use the new plugin, major changes are needed on old scripts.<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br />
        <span class="post-time small text-muted">27th July 2006 00:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hello,<br />
        <br />
        I have a problem with NSISArray, To be more precise, with the Concat function:<br />
        <br />
        I wish to create a MULTILANGUAGE page for UltraModernUI.<br />
        <br />
        I have a variable named $UMUI_LANGLIST that contain all the names of the language inserted in the NSIS script.<br />
        Example:<br />
        "English|Franais|Portugus (do Brasil)|Deutsch|Espaol|Chinese (Simplified)|Chinese (Traditional)|Japanese|Korean|Italiano|Nederlands|Danish|Svenska|Norwegian|Suomi|Greek|Russian|Portugus|Polski|Ukrainian|Cesky|Slovensky|Hrvatski|Bulgarian|Magyar|Thai|Romana|Latvieu|Macedonian|Eesti keel|Trke|Lietuviu|Catal|Slovenski jezik|Serbian Cyrillic|Serbian Latin|Arabic|Farsi|Hebrew|Indonesian|Mongolian|Ltzebuergesch|Albanian|Brezhoneg|Byelorussian|Icelandic|Malay|Bosanski|Kurd|Euskera|Welsh|Irish"<br />
        Its StrLen is 499<br />
        <br />
        <br />
        The goal of this code is to sort the language list:<br />
        <br /></p>
        <pre>
<code>StrLen $R0 $UMUI_LANGLIST  ; $Ro = 499<br />    ; create an array that containing the langstring<br />    NSISArray::New /NOUNLOAD "LangList" 55 8<br />    <br />    NSISArray::WriteListC /NOUNLOAD "LangList" "$UMUI_LANGLIST" "|"<br />    <br />    NSISArray::Sort /NOUNLOAD "LangList" ""<br /><br />    NSISArray::Concat /NOUNLOAD "LangList" "|"<br />    Pop $UMUI_LANGLIST<br />    <br />StrLen $R1 $UMUI_LANGLIST ; $R1 = 392  Only....<br />    NSISArray::Debug /NOUNLOAD "LangList" ; The array contain well all the 52 items<br /><br />MessageBox MB_OK "$R1 instead of $R0"  ; ===&gt;  392 instead of 499 bytes returned</code>
</pre><br />
        <br />
        The array contain well all the 52 items but when I want to get the list with the Concat function, it return only the 41 first items...<br />
        <br />
        Why NSISArray has not returned the others items?
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">27th July 2006 00:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I'll look into this tomorrow morning as soon as possible. It's getting late here :)<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">27th July 2006 11:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanks, fixed.<br />
        <a href="http://nsis.sourceforge.net/File:NSISArray.zip" target="_blank">http://nsis.sourceforge.net/File:NSISArray.zip</a><br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br />
        <span class="post-time small text-muted">27th July 2006 12:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Work fine, Thanks</p>
      </div>
      <hr />
      <!-- Bootstrap core CSS -->
      <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
      <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

      <div class="container">
        <!-- Put navigation bar here -->

        <ol class="breadcrumb">
          <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

          <li><a href="f-65.html">NSIS Discussion</a></li>

          <li class="active">NSISArray plugin</li>
        </ol>

        <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=222275">NSISArray plugin</a></p><br />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
          <span class="post-time small text-muted">13th March 2007 07:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">how many entries/bytes can hold an array?<br />
          <br />
          i have 2 hash arrays and after extact 361 entries with<br />
          each 32 token the script quits without warning or gpf.<br />
          <br />
          :(</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">6th June 2007 23:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I have uploaded v1.4 which has a new "Subtract" function among code cleanup and utilisation.<br />
          <br />
          Subtract allows you to take-away items in one array that are in another. This is useful for comparing two arrays to see which items do not match (i.e. with GetDrives or something).<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">6th June 2007 23:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Brummelchen, sorry I missed that post. Can you create a script to reproduce this?<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">7th June 2007 22:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I found out what was causing the crashing.<br />
          I tested the plugin with all 8 arrays filled with 10000 strings of 100 characters and everything was fine.<br />
          <br />
          Uploaded v1.5<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
          <span class="post-time small text-muted">8th June 2007 00:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Thank you - i try it next build here.<br />
          meanwhile right after trouble i repalced the array<br />
          with a file list as TXT and it runs smooth. now i<br />
          need to improve zero byte files which all have same<br />
          hash - nsis itself can handle that - me not.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">8th June 2007 14:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Uploaded v1.5 RC2. Fixed some parameter validation check issues for some of the functions.<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Wizarth</span><br />
          <span class="post-time small text-muted">10th July 2007 06:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"><strong>SizeOf</strong><br />
          I tried using this plugin today, and find that the ${myArray-&gt;SizeOf} macro would cause an error. After assorted cursing and headscratching, I discovered:<br />
          <br />
          Line 686 of NSISArray.nsh:<br />
          !macro Array_IndexesOf Name VarBufferLen VarItems VarIndexes<br />
          <br />
          should be<br />
          !macro Array_SizeOf Name VarBufferLen VarItems VarIndexes<br />
          <br />
          Note that this bug did cause the Examples/NSISArray/Sizeof.nsi to fail, and this change fixed it.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">10th July 2007 10:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Thanks, fixed.<br />
          <br />
          That probably happened when I did a Size-&gt;Indexes text replace in the script header :(<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">CancerFace</span><br />
          <span class="post-time small text-muted">22nd September 2007 12:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Stu,<br />
          I am using the array plugin in both my installer and uninstaller in oder to register (during installation) and unregister (during uninstall) a large number of file extensions for my application. I am creating an array at my .onInit function and then call it inside a section of the installer and this works fine.<br />
          <br />
          However if I create the array for the uninstaller in my un.onInit section and try to call it in any of my uninstall sections, the uninstaller crashes (no messages, it just dies).<br />
          <br />
          After playing around with it I finally got it to work without declaring an array in the un.onInit function, but right inside an uninstall section.<br />
          <br />
          Any ideas why this is happening?<br />
          <br />
          Note that even the NSISArray::ArrayExists command inside an uninstall section causes a crash in the case that the array was created in the un.onInit function<br />
          <br />
          Cheers,<br />
          <br />
          CF</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">22nd September 2007 15:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I'll need to make a script to reproduce this. If you have one, I would be grateful.<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">CancerFace</span><br />
          <span class="post-time small text-muted">22nd September 2007 16:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I can reproduce the crash with this minimal script:<br /></p>
          <pre>
<code>SetCompressor /SOLID lzma<br />!include "MUI.nsh"<br />!include "LogicLib.nsh"<br /><br />OutFile "TEST.exe"<br />InstallDir "$PROGRAMFILES\Test"<br /><br />!define EXTENTIONS_ARRAY_LIST_A 'ext1|ext2|ext3|ext4'<br />!define EXTENTIONS_ARRAY_TYPE_A "TestFile"<br /><br />Section -Ext<br />  MessageBox MB_OK|MB_ICONEXCLAMATION "Starting Section"<br />  NSISArray::ArrayExists /NOUNLOAD ExtentionsArray<br />  Pop $0<br />  ${If} $0 &lt;&gt; 1<br />    NSISArray::New /NOUNLOAD ExtentionsArray 2 2<br />  ${EndIf}<br />  MessageBox MB_OK|MB_ICONEXCLAMATION "Starting Process"<br />    NSISArray::WriteListC /NOUNLOAD ExtentionsArray '${EXTENTIONS_ARRAY_LIST_A}' "|"<br />    NSISArray::Debug /NOUNLOAD ExtentionsArray<br />    NSISArray::Clear /NOUNLOAD ExtentionsArray<br />SectionEnd<br /><br />Section -Uninstaller<br />  SetOutPath "$INSTDIR"<br />  WriteUninstaller "$INSTDIR\uninstall.exe"<br />SectionEnd<br /><br />Section -Un.Ext<br />  MessageBox MB_OK|MB_ICONEXCLAMATION "Starting Section"<br />  NSISArray::ArrayExists /NOUNLOAD unExtentionsArray<br />  Pop $0<br />  ${If} $0 &lt;&gt; 1<br />    NSISArray::New /NOUNLOAD unExtentionsArray 2 2<br />  ${EndIf}<br />  NSISArray::Debug /NOUNLOAD unExtentionsArray<br />  NSISArray::WriteListC /NOUNLOAD unExtentionsArray "${EXTENTIONS_ARRAY_LIST_A}" "|"<br />  NSISArray::Clear /NOUNLOAD unExtentionsArray<br />SectionEnd<br /><br />Function .onInit<br />  MessageBox MB_OK|MB_ICONEXCLAMATION "Creating array in .onInit"<br />  NSISArray::New /NOUNLOAD ExtentionsArray 2 2<br />  MessageBox MB_OK|MB_ICONEXCLAMATION "Created array on .onInit"<br />FunctionEnd<br /><br />Function un.onInit<br />  MessageBox MB_OK|MB_ICONEXCLAMATION "Creating array in un.onInit"<br />  NSISArray::New /NOUNLOAD unExtentionsArray 2 2<br />  MessageBox MB_OK|MB_ICONEXCLAMATION "Created array in un.onInit"<br />FunctionEnd<br /><br />Function .onGUIEnd<br />  MessageBox MB_OK|MB_ICONEXCLAMATION "Deleting Array on .onGUIEnd"<br />  NSISArray::Delete /NOUNLOAD ExtentionsArray<br />  MessageBox MB_OK|MB_ICONEXCLAMATION "Deleted Array on .onGUIEnd"<br />  NSISArray::Unload<br />FunctionEnd<br /><br />Function un.onGUIEnd<br />  MessageBox MB_OK|MB_ICONEXCLAMATION "Deleting Array on un.onGUIEnd"<br />  NSISArray::Delete /NOUNLOAD unExtentionsArray<br />  NSISArray::Unload<br />  MessageBox MB_OK|MB_ICONEXCLAMATION "Deleted Array on un.onGUIEnd"<br />FunctionEnd<br /></code>
</pre><br />
          The install part works fine.<br />
          The uninstaller crashes when the first Array command is called (NSISArray::ArrayExists) <b>if</b> the array is created in un.onInit.<br />
          CF
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
          <span class="post-time small text-muted">7th October 2007 00:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">exactly that script dont crash here ... nsis 2.30, array 1.5rc2<br />
          winxp sp2 latest updates, vc8sp1<br />
          <br />
          # ok, vista ultimate on vmware dont crash either</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
          <span class="post-time small text-muted">7th October 2007 07:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">another problem here... :(<br />
          PHP Code:</p>
          <hr />
          <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">!include</span><span style="color: #0000BB">MUI</span><span style="color: #007700">.</span><span style="color: #0000BB">nsh<br /></span> <span style="color: #007700">!include</span><span style="color: #0000BB">NSISArray</span><span style="color: #007700">.</span><span style="color: #0000BB">nsh<br />
          <br />
          Name</span><span style="color: #DD0000">'Subtract'<br /></span> <span style="color: #0000BB">OutFile</span><span style="color: #DD0000">'NSISArrayExample-Subtract.exe'<br /></span> <span style="color: #0000BB">ShowInstDetailsshow<br />
          <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_INSTFILES<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_LANGUAGEEnglish<br />
          <br /></span> <span style="color: #007700">${Array}</span><span style="color: #DD0000">"TestArray1"</span><span style="color: #0000BB">1256<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">ArrayFunc</span><span style="color: #007700">}</span><span style="color: #0000BB">WriteList<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">ArrayFunc</span><span style="color: #007700">}</span><span style="color: #0000BB">Subtract<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">ArrayFunc</span><span style="color: #007700">}</span><span style="color: #0000BB">Debug<br /></span> <span style="color: #007700">${Array}</span><span style="color: #DD0000">"TestArray2"</span><span style="color: #0000BB">1256<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">ArrayFunc</span><span style="color: #007700">}</span><span style="color: #0000BB">WriteList<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">ArrayFunc</span><span style="color: #007700">}</span><span style="color: #0000BB">Debug<br />
          <br />
          Section<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">TestArray1</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Init</span><span style="color: #007700">}<br />
          ${</span><span style="color: #0000BB">TestArray2</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Init</span><span style="color: #007700">}<br />
          <br />
          ${</span><span style="color: #0000BB">TestArray1</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">WriteList</span><span style="color: #007700">}</span><span style="color: #DD0000">"'we1234.tmp''we3456.tmp''we5432.tmp'"<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">TestArray2</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">WriteList</span><span style="color: #007700">}</span><span style="color: #DD0000">"'we1234.tmp''we3456.tmp'"<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">TestArray1</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Debug</span><span style="color: #007700">}<br />
          <br /></span> <span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">'SubtractingTestArray2fromTestArray1...'<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">TestArray1</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Subtract</span><span style="color: #007700">}</span><span style="color: #0000BB">TestArray2<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">TestArray2</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Delete</span><span style="color: #007700">}<br />
          ${</span><span style="color: #0000BB">TestArray1</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Debug</span><span style="color: #007700">}<br />
          ${</span><span style="color: #0000BB">TestArray1</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Delete</span><span style="color: #007700">}<br /></span> <span style="color: #0000BB">SectionEnd<br /></span></span> <!-- php buffer end -->
          <hr />
          result is 'we3456.tmp' - can't obviously...<br />
          <br />
          # array 1.5rc2, nsis 2.30<br />
          <br />
          btw docs have typo<br />

          <blockquote>
            1.6.27 ${myArray-&gt;Subtract} myArray2<br />
            <br />
            <u>Takes away items in myArray2 that are also in myArray.</u> Items are matched case sensitively.<br />
            <br />
            For a compilable NSIS script example, see Examples\NSISArray\Subtract.nsi.
          </blockquote>underlined say wrong direction - it takes content in (2) from (1) away - like example do<br />
          <br />
          Might better: "takes away items in (2) from (1)"<br />
          <br />
          #fix<br />
          for my problem i have to add a fake entry (like "---") to both arrays - then it works.
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">CancerFace</span><br />
          <span class="post-time small text-muted">7th October 2007 11:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">@Brummelchen<br />
          the script works for me as well. The uninstaller that is generated however is the one that crashes. Both on XP/SP2 and 2000/SP4 with nsis 2.31 and array 1.5 RC6. On different PCs as well.<br />
          CF</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">7th October 2007 14:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Back from holiday now. Will attempt to fix these problems today if I have time.<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
          <span class="post-time small text-muted">7th October 2007 18:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">&gt;&gt; The uninstaller that is generated however is the one that crashes.<br />
          <br />
          how do i get the uninstaller from that script?<br />
          might this line help me to understand<br />
          <br />
          WriteUninstaller "$exedir\uninstall.exe"<br />
          <br />
          &gt;&gt; array 1.5 RC6.<br />
          <br />
          Where to get? :D<br />
          <br />
          i am currently working on a special supporting program again<br />
          which need arrays... ok, there are many other ways but array<br />
          will fit them fastest ^^ (snapshot before &amp; after)</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">7th October 2007 18:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Run the installer exe and it will generate uninstall.exe in the same folder.<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
          <span class="post-time small text-muted">7th October 2007 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">ok, confirmed with 15rc2 - i now found the uninstaller here.<br />
          for my blame i did not investigate more time yesterday about that.<br />
          au_.exe crashes</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">CancerFace</span><br />
          <span class="post-time small text-muted">7th October 2007 20:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            Where to get?
          </blockquote>I got it from <a href="http://nsis.sourceforge.net/File:NSISArray.zip" target="_blank">here</a><br />
          <br />
          CF
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
          <span class="post-time small text-muted">7th October 2007 21:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">oh, i see - thats same i have - but i got it from here<br />
          <a href="http://nsis.sourceforge.net/Array_plug-in" target="_blank">http://nsis.sourceforge.net/Array_plug-in</a><br />
          (there is no such info, only mentioned as 1.5 in html doc)</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">7th October 2007 21:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">There is a deeper problem here - possible bug with WriteList. I don't have a build machine available right now so I'll continue tomorrow.<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">12th October 2007 19:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">CancerFace, I found that the crash that you were experiencing was because your array name was too long. The new build has 32 bytes allocated for array names (as opposed to 16).<br />
          <br />
          Brummelchen, fixed Subtract.<br />
          <br />
          I also found a memory leak in the Delete function which is now fixed.<br />
          <br />
          <a href="http://nsis.sf.net/File:NSISArray.zip" target="_blank">http://nsis.sf.net/File:NSISArray.zip</a><br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
          <span class="post-time small text-muted">12th October 2007 19:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">thank you :)</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">CancerFace</span><br />
          <span class="post-time small text-muted">12th October 2007 19:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Groovy!<br />
          Thanks Stu!<br />
          :D<br />
          <br />
          CF</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">congtak</span><br />
          <span class="post-time small text-muted">17th October 2007 07:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Hi, I think there is a possible bug in the {Array-&gt;ReadtoStack} function<br />
          when I do ${TestArray-&gt;ReadtoStack} 0 -1<br />
          and TestArray only has one element in it, nothing gets copied to the stack.<br />
          <br />
          To test this I change the ReadToStack.nsi<br />
          ${TestArray-&gt;WriteList} "'zero'"<br />
          ${TestArray-&gt;ReadtoStack} 0 -1<br />
          Pop $R0<br />
          $R0 is empty.<br />
          <br />
          Thank you</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">18th October 2007 21:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">This was indeed a bug. Thanks, fixed.<br />
          <a href="http://nsis.sf.net/File:NSISArray.zip" target="_blank">http://nsis.sf.net/File:NSISArray.zip</a><br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">congtak</span><br />
          <span class="post-time small text-muted">19th October 2007 00:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">cool</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
          <span class="post-time small text-muted">13th February 2008 09:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">${myArray-&gt;Concat} $Var ""<br />
          <br />
          returns empty string - is the connecting character mandatory?</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">13th February 2008 18:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I've never tried that but yes it shouldn't be. I will look at it soon, thanks.<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
          <span class="post-time small text-muted">13th February 2008 18:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">i have another problem, pls have a look here - it blows the memory and make it crash<br />
          PHP Code:</p>
          <hr />
          <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">Function</span><span style="color: #0000BB">anagram_sort<br />
          Pop$R9</span><span style="color: #007700">;</span><span style="color: #0000BB">source<br />
          Push$R5<br />
          Push$R6<br />
          Push$R7<br />
          Push$R8<br />
          <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">insertseperater<br />
          StrCpy$R6</span><span style="color: #DD0000">""<br /></span> <span style="color: #0000BB">StrCpy$R7</span><span style="color: #DD0000">"0"<br /></span> <span style="color: #0000BB">loop1</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">StrCpy$R8$R91$R7<br />
          StrCmp$R8</span><span style="color: #DD0000">""</span><span style="color: #0000BB">loop1_done<br />
          StrCpy$R6</span><span style="color: #DD0000">"$R6$R8|"<br /></span> <span style="color: #0000BB">IntOp$R7$R7</span><span style="color: #007700">+</span><span style="color: #0000BB">1<br />
          Gotoloop1<br />
          loop1_done</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">StrCpy$R9$R6</span><span style="color: #007700">-</span><span style="color: #0000BB">1<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">messageboxmb_ok</span><span style="color: #DD0000">"'$R9'"<br />
          <br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">anagram</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Init</span><span style="color: #007700">}<br />
          ${</span><span style="color: #0000BB">anagram</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Clear</span><span style="color: #007700">}<br />
          ;</span><span style="color: #0000BB">write</span><span style="color: #007700">array<br />
          ${</span><span style="color: #0000BB">anagram</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">WriteListC</span><span style="color: #007700">}</span><span style="color: #0000BB">$R9</span><span style="color: #DD0000">"|"<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">sort</span><span style="color: #007700">array<br />
          ${</span><span style="color: #0000BB">anagram</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Sort</span><span style="color: #007700">}</span><span style="color: #DD0000">""<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">read</span><span style="color: #007700">array<br /></span> <span style="color: #0000BB">StrCpy$R9</span><span style="color: #DD0000">""<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">anagram</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">ReadtoStack</span><span style="color: #007700">}</span><span style="color: #0000BB">0</span><span style="color: #007700">-</span><span style="color: #0000BB">1<br />
          Pop$R5<br />
          StrCpy$R9</span><span style="color: #DD0000">"$R9$R5"<br /></span> <span style="color: #0000BB">Pop$R5<br />
          StrCpy$R9</span><span style="color: #DD0000">"$R9$R5"<br /></span> <span style="color: #0000BB">Pop$R5<br />
          StrCpy$R9</span><span style="color: #DD0000">"$R9$R5"<br /></span> <span style="color: #0000BB">Pop$R5<br />
          StrCpy$R9</span><span style="color: #DD0000">"$R9$R5"<br /></span> <span style="color: #0000BB">Pop$R5<br />
          StrCpy$R9</span><span style="color: #DD0000">"$R9$R5"<br /></span> <span style="color: #0000BB">Pop$R5<br />
          StrCpy$R9</span><span style="color: #DD0000">"$R9$R5"<br /></span> <span style="color: #0000BB">Pop$R5<br />
          StrCpy$R9</span><span style="color: #DD0000">"$R9$R5"<br /></span> <span style="color: #0000BB">Pop$R5<br />
          StrCpy$R9</span><span style="color: #DD0000">"$R9$R5"<br /></span> <span style="color: #0000BB">Pop$R5<br />
          StrCpy$R9</span><span style="color: #DD0000">"$R9$R5"<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">anagram</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Delete</span><span style="color: #007700">}<br />
          <br /></span> <span style="color: #0000BB">Push$R9<br />
          Push</span><span style="color: #DD0000">"|"<br /></span> <span style="color: #0000BB">Push</span><span style="color: #DD0000">""<br /></span> <span style="color: #0000BB">CallStrRep<br />
          Pop$R9<br />
          <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">messageboxmb_ok</span><span style="color: #DD0000">"'$R9'"<br /></span> <span style="color: #0000BB">Pop$R8<br />
          Pop$R7<br />
          Pop$R6<br />
          Pop$R5<br />
          Push$R9<br />
          FunctionEnd<br /></span></span> <!-- php buffer end -->
          <hr />
          The code works on 429mbyte with 4meg lines each 9 byte (11 with LF).<br />
          The crash is around 2.7mbyte above line 256.400.<br />
          (simple character sort)<br />
          <br />
          The Math script instead with bubble sort is working here now for hours.
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">21st May 2008 11:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Can you produce a fully working script to reproduce the problem?<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Ilitirit</span><br />
          <span class="post-time small text-muted">25th August 2008 18:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">How do I add an empty string to an array?<br />
          <br />
          I tried<br />
          ${Array-&gt;Write} $0 ""<br />
          <br />
          but it doesn't add the element.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">TobbeSweden</span><br />
          <span class="post-time small text-muted">12th March 2009 09:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">NSISArray::SearchI seems to modify the array elements. Would it be possible to just temporarily convert them to lower case when comparing?<br />
          <br />
          Edit: Something like this might possibly work. I haven't tried it, or even compiled it...<br /></p>
          <pre>
<code>// Function: Search for string inside string<br />BOOL my_strstr(TCHAR *s1, int len_s1, TCHAR *s2, int len_s2, BOOL bCaseSensitive)<br />{<br />  int i = 0, j = 0;<br /><br />  for (;;)<br />  {<br />    if (s2[j] == '\0')<br />      return TRUE;<br />    if (s1[i] == '\0')<br />      return FALSE;<br />    if (s1[i] == s2[j] || <br />      (!bCaseSensitive &amp;&amp; LOWORD(CharLower(s1[i])) == LOWORD(CharLower(s2[j]))))<br />    {<br />      i++;<br />      j++;<br />    }<br />    else<br />    {<br />      i = i - j + 1;<br />      j = 0;<br />    }<br />  }<br />  return FALSE;<br />}</code>
</pre>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">TobbeSweden</span><br />
          <span class="post-time small text-muted">12th March 2009 18:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I've got an array declared in the global scope with ${Array}. I call init on it in .onInit. After that I can use it in the installer.<br />
          <br />
          Trying to use it in the uninstaller I get an error about the array not existing. Trying to init it in un.onInit I get an error about calling init on the array twice :S<br />
          <br />
          What should I do? Do I really have to make two arrays, one for install and one for uninstall?</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
          <span class="post-time small text-muted">12th March 2009 21:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            <i>Originally posted by TobbeSweden</i><br />
            <b>Do I really have to make two arrays, one for install and one for uninstall?</b>
          </blockquote>In short: yes.
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">TobbeSweden</span><br />
          <span class="post-time small text-muted">12th March 2009 21:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Ok. Too bad.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">TobbeSweden</span><br />
          <span class="post-time small text-muted">12th March 2009 23:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Here's another problem I'm having. SizeOf doesn't work...<br />
          <br />
          This code:<br /></p>
          <pre>
<code><br />        ${whereprofilesarray-&gt;SizeOf} $3 $4 $5<br />        MessageBox MB_OK "EnumerateUsers.nsh(${__LINE__}): $3 = $4 = $5 Will show debug next"<br />        ${whereprofilesarray-&gt;Debug}<br /><br />        NSISArray::ErrorStyle /NOUNLOAD 2<br /><br />        ${whereprofilesarray-&gt;SizeOf} $3 $4 $5<br />        MessageBox MB_OK "EnumerateUsers.nsh(${__LINE__}): $3 = $4 = $5 Will show debug next"<br />        ${whereprofilesarray-&gt;Debug}<br /></code>
</pre><br />
          <br />
          Gives me these message boxes:<br />
          <pre>
<code><br />---------------------------<br />Program Installation<br />---------------------------<br />EnumerateUsers.nsh(34.32): 1024 = 5 = 1 Will show debug next<br />---------------------------<br />OK   <br />---------------------------<br /><br /><br />---------------------------<br />Program Installation<br />---------------------------<br />EnumerateUsers.nsh(34.38): 5 = 1 =  Will show debug next<br />---------------------------<br />OK   <br />---------------------------<br /></code>
</pre><br />
          <br />
          As you can see in the second message box the SizeOf return values are wrong. The last return value (blank in this case) seems to vary depending on what's on the stack...<br />
          <br />
          The Debug output looks correct.
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">TobbeSweden</span><br />
          <span class="post-time small text-muted">15th March 2009 19:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">This particular problem goes away if I remove 'NSISArray::ErrorStyle /NOUNLOAD 2' and use '${ArrayErrorStyle} MsgBox' instead.<br />
          <br />
          I'm using scripts from the wiki that uses the direct plugin calls (NSISArray::*) for portability and in my own code I use the header wrappers because I find them easier to work with.<br />
          <br />
          Is this the real source of my problems? Is it a known fact that you can't mix the header file macros with direct NSISArray:: calls?</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">16th March 2009 16:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I'm back home in 2 weeks. I will have a look at these bugs then.<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">TobbeSweden</span><br />
          <span class="post-time small text-muted">16th March 2009 19:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I've "solved" it by replacing all NSISArray:: calls with their header macro alternatives. Everything seems to work as it should now :)</p>
        </div>
        <hr />
        <!-- Bootstrap core CSS -->
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <div class="container">
          <!-- Put navigation bar here -->

          <ol class="breadcrumb">
            <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

            <li><a href="f-65.html">NSIS Discussion</a></li>

            <li class="active">NSISArray plugin</li>
          </ol>

          <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=222275">NSISArray plugin</a></p><br />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">25th April 2009 12:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">TobbeSweden, late reply but looking at the NSISArray script header of course you cannot use an ErrorStyle of 2. Using 2 stops the plugin pushing errors to the stack but of course the script macros are still popping the same number of elements. Hence why your problem occurs as it is expecting 4 items on the stack but only gets 3.<br />
            <br />
            What you should have used was the ArrayErrorStyle macro which has 3 possible values: MsgBox, LogWin and Off. All 3 options still push items to the stack and therefore do not break any of the script header macros.<br />
            <br />
            Edit: Will upload new version later with fixed SearchI/ExistsI.<br />
            Edit #2: Uploaded.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">TobbeSweden</span><br />
            <span class="post-time small text-muted">25th April 2009 16:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Heh, had forgotten all about this :)<br />
            <br />
            Good job on the update.<br />
            <br />
            Now if arrays could only be an integrated part of NSIS itself...</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">dougcvc</span><br />
            <span class="post-time small text-muted">29th May 2009 09:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hello great job on the plugin.<br />
            <br />
            I am having trouble in using it for what i need however, i may just be doing something wrong.<br />
            <br />
            I have added all the data in the array which consists of numbers and i need to sort in in a certain order.<br />
            <br />
            Lets say the 3 values in the array are<br />
            <br />
            <br />
            7069<br />
            4776<br />
            63374<br />
            <br />
            <br />
            I need the data sorted from lowest to highest number, however when i use the sort function it arranges it as the following<br />
            <br />
            4776<br />
            63374<br />
            7069<br />
            <br />
            It sorts the nummbers by the first digit only.<br />
            Is there any way to sort by the values lowest to highest such as<br />
            <br />
            4776<br />
            7069<br />
            63374<br />
            <br />
            or am i just doing something wrong?<br />
            <br />
            <br />
            <br />
            Many thanks.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">29th May 2009 09:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Ah that is a problem. NSISArray stores strings and therefore sorts them as if they were strings (not numbers).<br />
            <br />
            I would need to write a new sort function to perform this but at the moment I don't have the build tools available and won't have them for some time until I go back home.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">dougcvc</span><br />
            <span class="post-time small text-muted">29th May 2009 10:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Ah thank you for the quick response, I am sure theres some other way to do what im trying to achieve anyway.<br />
            <br />
            Cheers.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">grs1961</span><br />
            <span class="post-time small text-muted">15th July 2009 08:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>Re: Array Write fails to write empty strings</strong><br /></p>

            <blockquote>
              <i>Originally posted by jerrydg</i><br />
              <b>I have a couple of problems with NSISArray:<br />
              <br />
              1. If I write to an index higher than one that has previously been written, that value is not actually written.<br /></b>
            </blockquote>Don't skip over array indices. It's not really a random array, but if you pre-load things it will behave as you expect.<br />
            <br />

            <blockquote>
              <b>2. If I write a "" to an array element that previously contained a non-zero length string, that element is not set to the empty string. The write function seems to ignore an empty string parameter. This defeats the purpose of using an array to store user input that can legally be an empty string.<br /></b>
            </blockquote>If you do:<br />
            ${ArrayErrorStyle} MsgBox<br />
            at the start of the section you will get a big clue - hint: passing empty strings to macros is not necessarily a simple task.<br />
            <br />
            Oh, and your example is missing a "${a1-&gt;Read} $tmp $i" from near the end of the loop (so it is working as written, not as intended).
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">15th July 2009 17:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">That is explained under 2.3 Plug-in DLL information. I will take a look at the empty string problem some time today.<br />
            <br />
            Yes as <i>jerrydg</i> has rightly pointed out - you can't just skip an array index as the upper bound when working with the array needs to be known otherwise memory leaks are possible.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">grs1961</span><br />
            <span class="post-time small text-muted">16th July 2009 03:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>Re: limit on number of arrays</strong><br /></p>

            <blockquote>
              <i>Originally posted by jerrydg</i><br />
              <b>I ran into another undocumented limitation: There is a limit of 8 arrays. :( I realize my installer requirements are atypical, but this is a pretty small upper bound.</b>
            </blockquote>But it is documented, you just have to read far enough along.<br />
            <br />
            That said, I re-built it almost immediately with 24 as the limit.
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">24th July 2009 15:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I have added a /numeric switch to the Sort function to sort an array numerically rather than alphabetically. I have also addressed the issue of adding empty values to an array.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">HarryPlotter</span><br />
            <span class="post-time small text-muted">31st August 2009 14:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Since a few days I am working with this great plugin.<br />
            I only have one problem with it. If the array is not previously initialized, there is a stack problem in ${myArray-&gt;Inited}.<br />
            I've modified the example Inited.nsi. It shows the problem.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">ChocJunkie</span><br />
            <span class="post-time small text-muted">20th January 2010 14:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>NSISArray and "0xC0000005 - access violation" error</strong><br />
            Hi,<br />
            <br />
            I'm using the NSISArray plugin for quite some time now. Until today it worked perfectly for me.<br />
            Today, I've added another array to my installer. Now I get the system error '0xc0000005' (access violation of the memory) after I did differnt actions on my different arrays.<br />
            <br />
            I've got absolutely no hint whats the problem - beside its a memory error. I've tried several differnt combinations of active (-&gt; initialized and not deleted) arrays and sizes of the arrays.<br />
            <br />
            I did several test to get a hint.<br />
            <br />
            Test (#1):<br />
            I've got 8 active arrays. When I'm trying to init the 9th one, the initialization fails. After that I trie to delete all initialized arrays befor the installer ends. The first three deletion commands succeed. Deleting the fourth array fails and I get the '0xc0000005' exception.<br />
            <br />
            Test #2:<br />
            I'm using only 8 active arrays. Everything works fine until I want to delete the arrays when the installer finishes. Like at test #1, the first three deleting commands succed - yes, that are the same as in #1. The fourth deletion command fails. Result: The same error for the SAME! memory address.<br />
            <br />
            Test #3:<br />
            It's the same installer as in #2.<br />
            I cancel the installation process early when I've got only 2 initialized arrays. Everything works fine.<br />
            <br />
            I'm kind of helpless about determing and solving the problem.<br />
            Any ideas what the reason could be or what I can text explicitly?<br />
            <br />
            Thanks!<br />
            <br />
            CJ<br />
            <br />
            <i>[moderator - 2 post thread merged into plug-in discussion)</i></p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">ChocJunkie</span><br />
            <span class="post-time small text-muted">21st January 2010 09:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Ok, at first I have to say, I'm not used to C/C++. ;)<br />
            <br />
            I've rebuilded the NSISArray plug-in as debug version. The debugger shows me:<br />
            - I've got 8 active arrays [as expected]<br />
            - the pointers to my first two arrays have been overwritten at some point. So that they are pointing to nowhere (at the address 0x00000000). [unexpected]<br />
            <br />
            I know, the two compromized arrays have not been wrong right from the beginning, because I'm using them several times befor the crash occueres.<br />
            <br />
            If someone comes up with 'Oh, I know at which line/block of the plug-in the problem is located!', I would be happy. ;)<br />
            <br />
            <br />
            CJ</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">ChocJunkie</span><br />
            <span class="post-time small text-muted">21st January 2010 11:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Two things...<br />
            <br />
            1.) Why can only 8 arrays be declared? Is there a reason or can I manipulate this value for my purpose?<br />
            <br />
            <br />
            2.) Inside the debug function, the value of <i>g_iArrayCount</i> is decreased at last after deleting the array. Because of that, the array after the deleted one will be erased. (But this one is empty so that no problems will be detected.) That's not exactly correct but it works as long as the user doesn't use 8 (ARRAY_MAX_COUNT) arrays. Because if he does, the memory 'after' the array will be manipulated.<br />
            <br />
            <u>In short</u><br />
            <br />
            Old version:</p>
            <pre>
<code>g_iArrInformation[g_iArrayCount][ARRAY_UPPERINDEX] = g_iArrInformation[g_iArrayCount][ARRAY_INDEXES] = g_iArrInformation[g_iArrayCount][ARRAY_BUFFER] = 0;<br />        my_strcpy(g_szArrNames[g_iArrayCount], (int)ARRAY_BUFFER_NAME, "", 1);<br />g_iArrayCount--;</code>
</pre><br />
            <br />
            Corrected
            <pre>
<code>g_iArrayCount--;<br />g_iArrInformation[g_iArrayCount][ARRAY_UPPERINDEX] = g_iArrInformation[g_iArrayCount][ARRAY_INDEXES] = g_iArrInformation[g_iArrayCount][ARRAY_BUFFER] = 0;<br />        my_strcpy(g_szArrNames[g_iArrayCount], (int)ARRAY_BUFFER_NAME, "", 1);<br /></code>
</pre><br />
            <br />
            CJ
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">21st January 2010 23:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Thanks for spotting that. With that fixed would you mind posting a script that crashes?<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">ChocJunkie</span><br />
            <span class="post-time small text-muted">22nd January 2010 07:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Sorry, I've forgott to tell: With that fixed, the plugin doesn't crash any more. ^^'<br />
            <br />
            CJ</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">10th March 2010 22:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">v2.2 is now available. Some bug fixes, new NSIS plugin API integration and a unicode build is included.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">SpudNyk</span><br />
            <span class="post-time small text-muted">1st April 2010 23:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>Error in ReadFirst Macro</strong><br />
            There is an compilation error when using the ReadFirst Macro<br />
            <br />
            I belive I fixed it by changing line 676 from:<br /></p>
            <pre>
<code>${Array_PopErrVar} </code>
</pre><br />
            to:<br />
            <pre>
<code>${Array_PopErrVar} true</code>
</pre><br />
            <br />
            Asides from that the plugin works well, Thanks for writing it and supporting it too.<br />
            <br />
            Cheers
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">2nd April 2010 14:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Thanks, fixed.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">22nd April 2010 13:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Uploaded v2.4. The DLL had an XML manifest in it defining Microsoft VC90 CRT as a dependency.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">montonero</span><br />
            <span class="post-time small text-muted">19th October 2010 19:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi. Thanks for useful plugin. There's my contribution: errors fixes for Join and Subtract functions.<br /></p>
            <pre>
<span style="color: #007700">---</span><span style="color: #0000BB">I</span><span style="color: #007700">:/</span><span style="color: #0000BB">nsis</span><span style="color: #007700">/</span><span style="color: #0000BB">Contrib</span><span style="color: #007700">/</span><span style="color: #0000BB">NSISArray</span><span style="color: #007700">/</span><span style="color: #0000BB">NSISArray</span><span style="color: #007700">.</span><span style="color: #0000BB">cppThuApr2212</span><span style="color: #007700">:</span><span style="color: #0000BB">57</span><span style="color: #007700">:</span><span style="color: #0000BB">242010
<br /></span><span style="color: #007700">+++</span><span style="color: #0000BB">C</span><span style="color: #007700">:/</span><span style="color: #0000BB">ProgramFiles</span><span style="color: #007700">/</span><span style="color: #0000BB">NSIS</span><span style="color: #007700">/</span><span style="color: #0000BB">Contrib</span><span style="color: #007700">/</span><span style="color: #0000BB">NSISArray</span><span style="color: #007700">/</span><span style="color: #0000BB">NSISArray</span><span style="color: #007700">.</span><span style="color: #0000BB">cppMonOct1811</span><span style="color: #007700">:</span><span style="color: #0000BB">41</span><span style="color: #007700">:</span><span style="color: #0000BB">422010
<br /></span><span style="color: #007700">@@-</span><span style="color: #0000BB">1</span><span style="color: #007700">,</span><span style="color: #0000BB">5</span><span style="color: #007700">+</span><span style="color: #0000BB">1</span><span style="color: #007700">,</span><span style="color: #0000BB">6</span><span style="color: #007700">@@
<br /></span><span style="color: #FF8000">#include&lt;windows.h&gt;
<br />#include&lt;commctrl.h&gt;
<br /></span><span style="color: #007700">+</span><span style="color: #FF8000">#include&lt;assert.h&gt;
<br />#ifdefUNICODE
<br />#include"nsis_unicode/pluginapi.h"
<br />#else
<br /></span><span style="color: #007700">@@-</span><span style="color: #0000BB">1462</span><span style="color: #007700">,</span><span style="color: #0000BB">9</span><span style="color: #007700">+</span><span style="color: #0000BB">1463</span><span style="color: #007700">,</span><span style="color: #0000BB">10</span><span style="color: #007700">@@
<br />return;
<br />}
<br /><br />+</span><span style="color: #0000BB">intiBiggestArrayBuffer</span><span style="color: #007700">=</span><span style="color: #0000BB">max</span><span style="color: #007700">(</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexA</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_BUFFER</span><span style="color: #007700">***93;,</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexB</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_BUFFER</span><span style="color: #007700">***93;);
<br />for(</span><span style="color: #0000BB">i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;</span><span style="color: #0000BB">i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">iNewSize</span><span style="color: #007700">;</span><span style="color: #0000BB">i</span><span style="color: #007700">++)
<br />{
<br />-</span><span style="color: #0000BB">szArrTemp</span><span style="color: #007700">***91;</span><span style="color: #0000BB">i</span><span style="color: #007700">***93;=(</span><span style="color: #0000BB">TCHAR</span><span style="color: #007700">*)</span><span style="color: #0000BB">MALLOC</span><span style="color: #007700">(</span><span style="color: #0000BB">sizeof</span><span style="color: #007700">(</span><span style="color: #0000BB">TCHAR</span><span style="color: #007700">)*</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexA</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_BUFFER</span><span style="color: #007700">***93;);
<br />+</span><span style="color: #0000BB">szArrTemp</span><span style="color: #007700">***91;</span><span style="color: #0000BB">i</span><span style="color: #007700">***93;=(</span><span style="color: #0000BB">TCHAR</span><span style="color: #007700">*)</span><span style="color: #0000BB">MALLOC</span><span style="color: #007700">(</span><span style="color: #0000BB">sizeof</span><span style="color: #007700">(</span><span style="color: #0000BB">TCHAR</span><span style="color: #007700">)*</span><span style="color: #0000BB">iBiggestArrayBuffer</span><span style="color: #007700">);
<br />if(</span><span style="color: #0000BB">szArrTemp</span><span style="color: #007700">***91;</span><span style="color: #0000BB">i</span><span style="color: #007700">***93;==</span><span style="color: #0000BB">NULL</span><span style="color: #007700">)
<br />{
<br /></span><span style="color: #0000BB">FREE</span><span style="color: #007700">(</span><span style="color: #0000BB">szArrTemp</span><span style="color: #007700">);
<br />@@-</span><span style="color: #0000BB">1474</span><span style="color: #007700">,</span><span style="color: #0000BB">10</span><span style="color: #007700">+</span><span style="color: #0000BB">1476</span><span style="color: #007700">,</span><span style="color: #0000BB">10</span><span style="color: #007700">@@
<br />}
<br /><br />for(</span><span style="color: #0000BB">i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;</span><span style="color: #0000BB">i</span><span style="color: #007700">&lt;=</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexB</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_UPPERINDEX</span><span style="color: #007700">***93;;</span><span style="color: #0000BB">i</span><span style="color: #007700">++)
<br />-</span><span style="color: #0000BB">my_strcpy</span><span style="color: #007700">(</span><span style="color: #0000BB">szArrTemp</span><span style="color: #007700">***91;</span><span style="color: #0000BB">i</span><span style="color: #007700">***93;,</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexA</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_BUFFER</span><span style="color: #007700">***93;,</span><span style="color: #0000BB">g_szArrData</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexB</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">i</span><span style="color: #007700">***93;,</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexB</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_BUFFER</span><span style="color: #007700">***93;);
<br />+</span><span style="color: #0000BB">my_strcpy</span><span style="color: #007700">(</span><span style="color: #0000BB">szArrTemp</span><span style="color: #007700">***91;</span><span style="color: #0000BB">i</span><span style="color: #007700">***93;,</span><span style="color: #0000BB">iBiggestArrayBuffer</span><span style="color: #007700">,</span><span style="color: #0000BB">g_szArrData</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexB</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">i</span><span style="color: #007700">***93;,</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexB</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_BUFFER</span><span style="color: #007700">***93;);
<br /><br />for(</span><span style="color: #0000BB">i</span><span style="color: #007700">=</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexB</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_UPPERINDEX</span><span style="color: #007700">***93;+</span><span style="color: #0000BB">1</span><span style="color: #007700">,</span><span style="color: #0000BB">j</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;</span><span style="color: #0000BB">i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">iNewSize</span><span style="color: #007700">;</span><span style="color: #0000BB">i</span><span style="color: #007700">++,</span><span style="color: #0000BB">j</span><span style="color: #007700">++)
<br />-</span><span style="color: #0000BB">my_strcpy</span><span style="color: #007700">(</span><span style="color: #0000BB">szArrTemp</span><span style="color: #007700">***91;</span><span style="color: #0000BB">i</span><span style="color: #007700">***93;,</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexA</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_BUFFER</span><span style="color: #007700">***93;,</span><span style="color: #0000BB">g_szArrData</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexA</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">j</span><span style="color: #007700">***93;,</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexA</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_BUFFER</span><span style="color: #007700">***93;);
<br />+</span><span style="color: #0000BB">my_strcpy</span><span style="color: #007700">(</span><span style="color: #0000BB">szArrTemp</span><span style="color: #007700">***91;</span><span style="color: #0000BB">i</span><span style="color: #007700">***93;,</span><span style="color: #0000BB">iBiggestArrayBuffer</span><span style="color: #007700">,</span><span style="color: #0000BB">g_szArrData</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexA</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">j</span><span style="color: #007700">***93;,</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexA</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_BUFFER</span><span style="color: #007700">***93;);
<br /><br />for(</span><span style="color: #0000BB">i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;</span><span style="color: #0000BB">i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexB</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_INDEXES</span><span style="color: #007700">***93;;</span><span style="color: #0000BB">i</span><span style="color: #007700">++)
<br /></span><span style="color: #0000BB">FREE</span><span style="color: #007700">(</span><span style="color: #0000BB">g_szArrData</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexB</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">i</span><span style="color: #007700">***93;);
<br />@@-</span><span style="color: #0000BB">1487</span><span style="color: #007700">,</span><span style="color: #0000BB">7</span><span style="color: #007700">+</span><span style="color: #0000BB">1489</span><span style="color: #007700">,</span><span style="color: #0000BB">7</span><span style="color: #007700">@@
<br /><br /></span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexB</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_UPPERINDEX</span><span style="color: #007700">***93;=</span><span style="color: #0000BB">iNewSize</span><span style="color: #007700">-</span><span style="color: #0000BB">1</span><span style="color: #007700">;
<br /></span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexB</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_INDEXES</span><span style="color: #007700">***93;=</span><span style="color: #0000BB">iNewSize</span><span style="color: #007700">;
<br />-</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexB</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_BUFFER</span><span style="color: #007700">***93;=</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexA</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_BUFFER</span><span style="color: #007700">***93;;
<br />+</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexB</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_BUFFER</span><span style="color: #007700">***93;=</span><span style="color: #0000BB">iBiggestArrayBuffer</span><span style="color: #007700">;
<br /><br /></span><span style="color: #0000BB">NoErrorMsg</span><span style="color: #007700">();
<br />}
<br />@@-</span><span style="color: #0000BB">1860</span><span style="color: #007700">,</span><span style="color: #0000BB">6</span><span style="color: #007700">+</span><span style="color: #0000BB">1862</span><span style="color: #007700">,</span><span style="color: #0000BB">13</span><span style="color: #007700">@@
<br />}
<br />}
<br /><br />+if(!</span><span style="color: #0000BB">iNewSize</span><span style="color: #007700">){
<br />+</span><span style="color: #0000BB">NoErrorMsg</span><span style="color: #007700">();
<br />+return;
<br />+}
<br />+
<br />+</span><span style="color: #0000BB">iNewSize</span><span style="color: #007700">=</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexA</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_UPPERINDEX</span><span style="color: #007700">***93;-</span><span style="color: #0000BB">iNewSize</span><span style="color: #007700">+</span><span style="color: #0000BB">1</span><span style="color: #007700">;
<br />+
<br /></span><span style="color: #0000BB">szArrTemp</span><span style="color: #007700">=(</span><span style="color: #0000BB">TCHAR</span><span style="color: #007700">**)</span><span style="color: #0000BB">MALLOC</span><span style="color: #007700">(</span><span style="color: #0000BB">sizeof</span><span style="color: #007700">(</span><span style="color: #0000BB">TCHAR</span><span style="color: #007700">*)*</span><span style="color: #0000BB">iNewSize</span><span style="color: #007700">);
<br />if(</span><span style="color: #0000BB">szArrTemp</span><span style="color: #007700">==</span><span style="color: #0000BB">NULL</span><span style="color: #007700">)
<br />{
<br />@@-</span><span style="color: #0000BB">1881</span><span style="color: #007700">,</span><span style="color: #0000BB">16</span><span style="color: #007700">+</span><span style="color: #0000BB">1890</span><span style="color: #007700">,</span><span style="color: #0000BB">13</span><span style="color: #007700">@@
<br />for(</span><span style="color: #0000BB">i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;</span><span style="color: #0000BB">i</span><span style="color: #007700">&lt;=</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexA</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_UPPERINDEX</span><span style="color: #007700">***93;;</span><span style="color: #0000BB">i</span><span style="color: #007700">++)
<br />{
<br /></span><span style="color: #0000BB">bFound</span><span style="color: #007700">=</span><span style="color: #0000BB">FALSE</span><span style="color: #007700">;
<br />-for(</span><span style="color: #0000BB">j</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;</span><span style="color: #0000BB">j</span><span style="color: #007700">&lt;=</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexB</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_UPPERINDEX</span><span style="color: #007700">***93;;</span><span style="color: #0000BB">j</span><span style="color: #007700">++)
<br />-{
<br />-if(</span><span style="color: #0000BB">lstrcmp</span><span style="color: #007700">(</span><span style="color: #0000BB">g_szArrData</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexA</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">i</span><span style="color: #007700">***93;,</span><span style="color: #0000BB">g_szArrData</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexB</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">j</span><span style="color: #007700">***93;)==</span><span style="color: #0000BB">0</span><span style="color: #007700">)
<br />+for(</span><span style="color: #0000BB">j</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;</span><span style="color: #0000BB">j</span><span style="color: #007700">&lt;=</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexB</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_UPPERINDEX</span><span style="color: #007700">***93;&amp;&amp;!</span><span style="color: #0000BB">bFound</span><span style="color: #007700">;</span><span style="color: #0000BB">j</span><span style="color: #007700">++)
<br />{
<br />-</span><span style="color: #0000BB">bFound</span><span style="color: #007700">=</span><span style="color: #0000BB">TRUE</span><span style="color: #007700">;
<br />-break;
<br />-}
<br />+</span><span style="color: #0000BB">bFound</span><span style="color: #007700">=!</span><span style="color: #0000BB">lstrcmp</span><span style="color: #007700">(</span><span style="color: #0000BB">g_szArrData</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexA</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">i</span><span style="color: #007700">***93;,</span><span style="color: #0000BB">g_szArrData</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexB</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">j</span><span style="color: #007700">***93;);
<br />}
<br />if(!</span><span style="color: #0000BB">bFound</span><span style="color: #007700">)
<br />{
<br />+</span><span style="color: #0000BB">assert</span><span style="color: #007700">(</span><span style="color: #0000BB">k</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">iNewSize</span><span style="color: #007700">);
<br /></span><span style="color: #0000BB">my_strcpy</span><span style="color: #007700">(</span><span style="color: #0000BB">szArrTemp</span><span style="color: #007700">***91;</span><span style="color: #0000BB">k</span><span style="color: #007700">***93;,</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexA</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_BUFFER</span><span style="color: #007700">***93;,</span><span style="color: #0000BB">g_szArrData</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexA</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">i</span><span style="color: #007700">***93;,</span><span style="color: #0000BB">g_iArrInformation</span><span style="color: #007700">***91;</span><span style="color: #0000BB">iArrayIndexA</span><span style="color: #007700">***93;***91;</span><span style="color: #0000BB">ARRAY_BUFFER</span><span style="color: #007700">***93;);
<br /></span><span style="color: #0000BB">k</span><span style="color: #007700">++;
<br />}
</span>
</pre>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">TVNST</span><br />
            <span class="post-time small text-muted">21st August 2012 10:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I'm using the newest version 2.4, but I still can't add empty strings.<br />
            Will this ever be fixed? Since for my purposes, it's unusable this way.<br />
            <br />
            Any alternatives?<br />
            I've tried NSArray, but it suffers from memory corruption from time to time, loosing complete values or returning corrupted ones.<br />
            NSISList plug-in sounds good, but I can only use unicode plugins and it doesn't seem to have a dll for that. Same applies to stack plugin.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">21st August 2012 12:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"></p>

            <blockquote>
              <small>Originally posted by TVNST</small><br />
              I'm using the newest version 2.4, but I still can't add empty strings.<br />
              Will this ever be fixed? Since for my purposes, it's unusable this way.<br />
              <br />
              Any alternatives?<br />
              I've tried NSArray, but it suffers from memory corruption from time to time, loosing complete values or returning corrupted ones.
            </blockquote>I don't plan on updating NSISArray any more but I will if I get time. As for nsArray, I have not experienced any memory corruption and I have tested thoroughly in a debugger. Are you using the ANSI or Unicode build? Do you have a script which reproduces?<br />
            <br />
            Stu
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">TVNST</span><br />
            <span class="post-time small text-muted">21st August 2012 13:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I used the Unicode build of both nsArray and NSISArray.<br />
            <br />
            Unfortunately, the memory corruption problems only occur sporadic. There's no way to reproduce the problem reliable.<br />
            However, they occured on two different computers.<br />
            <br />
            I experienced two different kinds of problems:<br />
            1.) Elements that were added are suddenly missing<br />
            I had this several times. I add usually 'sets' of parameters via macro.<br />
            Therefore if the first parameter is retrieved, the other parameters must also have been added since the NSIS compiler would fail if there's a parameter missing.<br />
            Example:<br /></p>
            <pre>
<code>!macro _TVWriteRegStr sRegPath sValName sValData<br /><br />        nsArray::Set aRegActions /list "WRITE_STRING" `${sRegPath}` `${sValName}` `${sValData}` /end<br />!macroend</code>
</pre><br />
            At a later point I retrieve this command values and compute them.<br />
            Now, the error I got was that I could retrieve "WRITE_STRING", but if I tried to get one of the following parameters with nsArray::Get aRegActions $R0 the error flag is set, indicating that the array reached its last value which was clearly not the case.<br />
            <br />
            2.) Elements corrupted<br />
            Another problem I experienced a few times was if I added a string value, then one letter of the string value was corrupted when I retrieved the value.<br />
            One example I remember is that I added "DELETE" and got "DE$ETE" when retrieving the value.<br />
            <br />
            However, there's still the possibility that it's not a bug from nsArray itself, but another buggy plugin function that corrupts the memory of nsArray. However, I would have guessed that this would also affect the NSIS stack, since it's elements are also created dynamically.
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">21st August 2012 14:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">After your code:<br />
            <br />
            aRegActions = { 0 =&gt; "WRITE_STRING", 1 =&gt; "${sRegPath}", 2 =&gt; "${sValName}", 3 =&gt; "${sValData}" }<br />
            <br />
            Are you saying <i>nsArray::Get aRegActions 1</i> sets the error flag?<br />
            <br />
            For what you are doing, you may find it easier to use my nsJSON plug-in.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">TVNST</span><br />
            <span class="post-time small text-muted">21st August 2012 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I think I had both the first and the second value setting an error flag on different occasions.<br />
            However, the array stores more than just one Registry-Action.<br />
            All registry actions in the NSIS code are first gathered in the array and then executed in a loop through all registry actions.<br />
            The idea behind that is to implement a rollback on errors mechanism similar to MSI installers which is not supported by NSIS by default.<br />
            Therefore, the error flag was set on something like nsArray::Get aRegActions 42 since it wasn't in the first registry action, it was somewhere inbetween.<br />
            <br />
            The JSON plugin uses a file which is not what I want. I could also have used an ini file in this case.<br />
            File errors are the most likely errors that can occur in an installation and I want to avoid to make an error check on each write or read operation.<br />
            Therefore I'd prefer to keep those actions in the memory.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">21st August 2012 15:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"></p>

            <blockquote>
              <small>Originally posted by TVNST</small><br />
              I think I had both the first and the second value setting an error flag on different occasions.<br />
              However, the array stores more than just one Registry-Action.<br />
              All registry actions in the NSIS code are first gathered in the array and then executed in a loop through all registry actions.<br />
              The idea behind that is to implement a rollback on errors mechanism similar to MSI installers which is not supported by NSIS by default.<br />
              Therefore, the error flag was set on something like nsArray::Get aRegActions 42 since it wasn't in the first registry action, it was somewhere inbetween.<br />
              <br />
              The JSON plugin uses a file which is not what I want. I could also have used an ini file in this case.<br />
              File errors are the most likely errors that can occur in an installation and I want to avoid to make an error check on each write or read operation.<br />
              Therefore I'd prefer to keep those actions in the memory.
            </blockquote>I'll look into the nsArray issues when I can. As for nsJSON you don't need to use files at all. You can create and manipulate a JSON tree in memory.<br />
            <br />
            Stu
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">TVNST</span><br />
            <span class="post-time small text-muted">21st August 2012 15:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Thanks for the help. I check out the JSON plugin again. If it can keep the data in the memory then it could be a solution for my problems.<br />
            I hope I can find some examples somewhere since its use with the tree notes seems a bit complicated.</p>
          </div>
          <hr />

          <div class="footer">
            <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
          </div>
        </div><script src="../js/highlight.pack.js" type="text/javascript">
</script> <script type="text/javascript">
//<![CDATA[
        hljs.initHighlightingOnLoad();
        //]]>
        </script>
      </div>
    </div>
  </div>
</body>
</html>
