<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="NSISArray plugin" />

  <title>NSISArray plugin - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.2/readable/bootstrap.min.css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">NSISArray plugin</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=222275">NSISArray plugin</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">23rd July 2005 18:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NSISArray plugin</strong><br />
      &nbsp; A plugin which adds fast dynamic array support to NSIS with over 20 functions for array manipulation.<br />
      It also has an array script header to mask the plugin calls with a more friendly scripting syntax.<br />
      <br />
      <a href="http://nsis.sourceforge.net/wiki/File:NSISArray.zip" target="_blank">http://nsis.sourceforge.net/wiki/File:NSISArray.zip</a><br />
      <br />
      <b>Please note:</b><br />
      If you have a previous release of NSISArray installed, please delete the <b>Contrib\NSISArray</b> and <b>Examples\NSISArray</b> folders before installing the new release.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">24th July 2005 21:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey Afrow,<br />
      I just downloaded your new plugin and from what I've seen, it looks great! (Excellent job!)<br />
      <br />
      But I have one quick question:<br />
      In the Include folder, you have the file NSISArray.nsh. But the file includes another NSISArray.nsh file located in ${NSISDIR}\Contrib\NSISArray. Why not just have the one <b>real</b> NSISArray.nsh in the include folder? (This would be less confusing and easier to maintain in my opinion.)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">24th July 2005 22:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If there is only source code in the Contrib folder (so nothing for the end-user), I would also recommend you to put the actual contents in Include.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">25th July 2005 00:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Good question! I think I just did it because of Modern UI and my Self-Extractor kit. It just keeps all the source code (C++/NSIS) in one folder so if someone (or I) wants to modify the source code (plugin code or the NSIS code), we know where to find it.<br />
      <br />
      The readme and some examples are also in the Contrib folder so again, everything is kept close together.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">25th July 2005 02:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I was testing the arrays and ran into a few problems. Please look at this dummy script:<br /></p>
      <pre>
<code><br />name 'test array'<br />outfile 'test_array.exe'<br />!include NSISArray.nsh<br /><br />Section<br />  DetailPrint "Initializing array..."<br />  ${Array} "TestArray"<br />  ${TestArray-&gt;Init}<br />  DetailPrint "adding 'dog'"<br />  ${TestArray-&gt;Push} "dog"<br />  DetailPrint "Adding 'hippo'"<br />  ${TestArray-&gt;Push} 'hippo'<br />  DetailPrint "Adding 'cat'"<br />  ${TestArray-&gt;Push} 'cat'<br />  ${TestArray-&gt;SizeOf} $0<br />  DetailPrint "My Array now contains $0 items:"<br />  ${TestArray-&gt;Search} $1 "dog" 0<br />  DetailPrint "'Dog' is item $1"<br />  DetailPrint "All items: "<br />  ${TestArray-&gt;Concat} $2 ", "<br />  DetailPrint $2<br />SectionEnd<br /><br />page instfiles<br /></code>
</pre><br />
      <br />
      During compile, on this line:<br />
      ${TestArray-&gt;Search} $1 "dog" 0<br />
      I get this error:<br />
      !insertmacro: macro "Array_Search" requires 4 parameter(s), passed 5!<br />
      <br />
      If I REM this line, then I get an error at runtime that says "SizeOf:parameter error"<br />
      <br />
      Am I being stupid or are these both bugs?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">25th July 2005 13:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>Good question! I think I just did it because of Modern UI and my Self-Extractor kit. It just keeps all the source code (C++/NSIS) in one folder so if someone (or I) wants to modify the source code (plugin code or the NSIS code), we know where to find it.<br />
        <br />
        The readme and some examples are also in the Contrib folder so again, everything is kept close together.<br />
        <br />
        -Stu</b>
      </blockquote>The point is that the Modern UI also puts other NSIS header files (langauge files) and data in the 'Contrib\Modern UI' folder.<br />
      <br />
      Documentation and source files are indeed also in the Contrib folder on the CVS server, but for end-user releases the build system puts documentation in the Docs folder and examples in the Examples folder.<br />
      <br />
      So whenever releasing a compiled plug-in for the end-user, there should be nothing in Contrib at all, just a binary in Plugins, a readme in Docs and a example in Examples (and maybe a header file in Include).
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">25th July 2005 19:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah right I see.<br />
      I'll change everything so it's like that (nsh in Include, docs in Docs).<br />
      <br />
      Edit: Yeh they are bugs. One was an error in the plugin code and the other was in the NSH. Uploading new build now.<br />
      <br />
      Edit #2: Uploaded.<br />
      Before installing, delete the Contrib\NSISArray folder, because now the readme is in Docs, and NSH in Include.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">25th July 2005 20:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, Afrow.<br />
      <br />
      hmmm.. Technical difficulties: I can't seem to get to the Wiki at the moment. As soon as it lets me, I'll download it and try it out.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">25th July 2005 21:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The SourceForge database server has performance issues, they are working on doubling the capacity. In the meanwhile the NSIS Site and Wiki may be slow during peak times.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">27th July 2005 04:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey Afrow,<br />
      The sample script above seems to work, but I need you clarify something for me regarding the 'SizeOf' function.<br />
      <br />
      Your docs describe this as:<br /></p>

      <blockquote>
        Places the amount of items in myArray into $Var.
      </blockquote>Based on this, I would expect it to return the total number of elements in the array. However, using the example above, I see that it returns 2, not three. While 2 is the highest element number (due to the fact that the array is zero-based), the total number of elements (items) in the array is actually 3.<br />
      <br />
      So, I feel that either your function or the documentation are wrong. (either way you go is fine, but one should match ther other.) Would you agree?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">28th July 2005 20:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's interesting. For some reason in the source I was taking 1 away from the output (when I shouldn't have been).<br />
      <br />
      I will recompile and upload v0.3<br />
      <br />
      Thanks for finding this out.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">29th July 2005 00:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No problem. I've been wanting to check some of the other functions, but just haven't had time. From the little I've worked with it, this looks like it will be a very powerful plugin.<br />
      <br />
      And I have to complement you on the array debug utility you included with this plugin. That is a really nice touch--should make problem solving a lot easier.<br />
      <br />
      I can tell you put a lot of thought into this. Keep up the great work! :up: :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">29th July 2005 05:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok Afrow, now that I've buttered you up, I've got several bugs to report! :eek:<br />
      <br />
      you are really gonna get tied of me! hehe!<br />
      :p<br />
      <br />
      Note: this is just some quick prelim testing. Time permitting, I'd like to test all functions. (Feel free to use a PM if you think that'd be easier.) Sample scripts for each are attached.<br />
      <br />
      <b>Bug #1</b><br />
      (Test_01.nsi) Calling <i>Write</i> to an existing array overwrites the element as expected, but also adds an empty element to the end of the array.<br />
      <br />
      <b>Bug #2</b><br />
      (Test_02.nsi) Calling <i>WriteListC</i> causes the install to crash. (must be a problem in the plugin itself).<br />
      BTW: Can <i><b>CHAR</b></i> be a string or should it always be a single character?<br />
      <br />
      <b>Bug #3</b><br />
      (Test_03.nsi) My understanding of the <i>Put</i> command is that it should insert an item at a specfied element. However, it doen't seem to do that. I start with an array of zero,one,two,three. After I call <font color="blue">${TestArray-&gt;Put} 1 'insert'</font>, I end up with null,insert,one,three,null. (It'll probably make more sense once you compile the example script.)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">29th July 2005 11:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Right thanks.<br />
      1. Easy fix (I know what the issue is :)).<br />
      2. Yes, it has to be a single character. I'll add some code to prevent people using a string.<br />
      3. Not sure why this is happening but I'll look into it.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">29th July 2005 12:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks again Comperio, uploaded fixed version.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">30th July 2005 00:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">All fixes worked great!<br />
      :up:<br />
      <br />
      Minor detail:<br />
      You may want to mention in the docs that that CHAR in the <font color="blue">WriteListC</font> function is just a single character.<br />
      <br />
      If I get more time this weekend, I'll continue testing the other functions.<br />
      <br />
      Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">30th July 2005 18:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Another bug. Using the function <font color="blue">ReadToStack</font>, I found I had to commend out line #136 of the NSISArray.nsh file:<br /></p>
      <pre>
<code>!macro Array_ReadToStack Plugin Name<br />   ${Plugin}::ReadToStack /NOUNLOAD "${Name}"<br />   <b>Pop "${ArrayErrVar}" <font color="red"> ### this is the line that needed commented out</font></b><br />!macroend</code>
</pre><br />
      I didn't find ${ArrayErrVar} defined anywhere in the header file. And I didn't see that anything extra was being pushed to the stack by your plugin. (Maybe you were using ArrayErrVar when debugging and just forgot to take it out?)<br />
      <br />
      <b>Also:</b><br />
      When I called PushToStack, I noticed that it pushed in the reverse order than I was expecting based on your example. I pushed the Array [0,1,2,3] and when I popped, I got 3, 2, 1, and then 0. I'm not saying you need to change the code, but perhaps you could just make that clearer in the docs.:cool:
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">30th July 2005 22:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Found another bug (maybe?)<br />
      Using the <font color="blue">Splice</font> function this time. I start out with this array: [zero,one,two,three]<br />
      <br />
      I call this command:<br />
      ${TestArray-&gt;Splice} 0 3 "'0' '1' '2'"<br />
      <br />
      Based on the docs, this should replace elements from index 0 up to, but not including, index 3. Therefore, I'd expect this:<br />
      [0,1,2,three]<br />
      <br />
      but instead I get this:<br />
      [0,1,2]<br />
      <br />
      I've attached my sample script for you to look over.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">30th July 2005 23:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, 2 more bugs, and I think that's it:<br />
      <b><u>Bug #1</u></b><br />
      A bug in the debug program. (how ironic is that?)<br />
      <br />
      I have 2 arrays. One named TestArray1 and the other TestArray2.<br />
      <br />
      If I use ${TestArray1-&gt;Debug}, I get the dialog that shows the contents of TestArray1. But if I then call ${TestArray2-&gt;Debug}, I still get the contents of TestArray1, even though the page caption tells me its TestArray2.<br />
      <br />
      renaming TestArray2 to "blah" also gave the same thing. But by calling the SizeOf function, I as able to determine the Arrays themselves are OK. So it's got to be just a bug in the debug function of the plugin itself.<br />
      <br />
      (Use the attached script called "copy.nsi" to test)<br />
      <br />
      <b><u>Bug #2</u></b><br />
      Your docs say that the <font color="blue">search</font> command is supposed to be case <u>in</u>sensitive, but in my testing, it's actually not. (see attached "search.nsi")<br />
      <br />
      and BTW: I see that <font color="blue"><i><u>Exists</u></i></font> and <font color="blue"><i><u>Search</u></i></font> do pretty much the same. So why can you specify a starting index with SEARCH and not with EXISTS?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">31st July 2005 12:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, fixed.<br />
      <br />
      -Stu :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">31st July 2005 16:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I still have the problems with ReadToStack and Splice. (See my first 2 posts from yesterday).<br />
      <br />
      Edit:<br />
      But the other problems are OK now.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">31st July 2005 16:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Doh I didn't see the post above it.<br />
      Will look into it soon.<br />
      <br />
      Edit:<br />
      They should also all be fixed now. Just waiting to get on the machine I use for compiling.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">31st July 2005 18:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Uploaded new build (still v0.5 though).<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">31st July 2005 18:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, getting closer...<br />
      <br />
      1. SearchI is not defined in your NSISArray.nsh<br />
      2. When adding SearchI, the plugin call is working, but returns the same as the regular Search. (In other words, SearchI is not case insensitive like it's supposed to be.)<br />
      3. Both Exists and ExistsI return a 'parameter error' from the plugin<br />
      <br />
      New examples attached.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st August 2005 01:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Dear me, that wasn't very good :(<br />
      I've updated the readme and NSISArray.nsh properly. Just trying to upload now, but sourceforge is having problems as usual.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">1st August 2005 03:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey Afrow,<br />
      I've been having problems on an off with my own ISP.. Kind of refreshing to know I'm not the only one!<br />
      <br />
      I was going to mention that I've saved all my test scripts for every function in your plugin. Just let me know if you'd like a copy of them to include as examples in with your plugin distribution. (I can either post them here, on the Wiki, or send them to you directly.)<br />
      <br />
      Thanks again for all your help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st August 2005 11:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I was thinking that also. Please send them to afrowuk at tiscali dot co dot uk<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st August 2005 15:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Uploaded new build. I've done a bit more than bug fixes in this release (although it's still v0.5). Check the Change Log in the readme.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">1st August 2005 23:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey Afrow,<br />
      I downloaded the new version today and it works great!<br />
      <br />
      Now for a feature request:<br />
      It would be nice if you could give the developer the option to trap the plugin errors rather than having the plugin display its own message box when there's a problem. I was thinking of perhaps having the plugin place another value on the stack after the return value. A zero could mean no problems or a unique error code based on one of your predefined errors.<br />
      <br />
      For example, -1 might mean "Array name already declared", -2 would mean "Parameters error.", and so on. Then, you could either wrap the 'english translation' of the error into a plugin call or just use !defines in your NSH header file in case the developer chose to display the erorr you have now. (Using the NSH file, you could even use this to set the error flag if you wanted.)<br />
      <br />
      It would add another pop command to each plugin call, but for flexibility to the developer, I think it would be worth it. Whatcha think?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">2nd August 2005 13:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is how it was before. Remember there was a Pop ${ArrayErrVar} in ReadToStack. Error messages used to get passed onto the stack, but for some reason I changed it.<br />
      I'll add this in today as the default with a compile-time define to use MessageBox's instead.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">2nd August 2005 19:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Uploaded v0.6 with the new $ArrayErr (stack) error support. Use !define ArrayErrorMsgBox to use the old school error message boxes.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">5th August 2005 05:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Afrow,<br />
      Just found another bug. In your header in the macro 'Array_Delete', you are undefining ${ArrayObj}.<br />
      <br />
      Since ${ArrayObj} is used goblaly (meaning that more than one array can use it), it will cause the compiler to crash when you need to undefine more than one array.<br />
      <br />
      (The reason I spotted it was becuase I happend to be using 2 arrays in my installation.)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">5th August 2005 11:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For some reason I missed out the new header file which adds support for the ArrayErrorMsgBox define (and fixes that problem you've mentioned).<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">5th August 2005 15:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Another issue I'm still looking into, but perhaps you could guide me:<br />
      <br />
      I've noticed that NSISArray.dll is not being removed from the plugins directory. I'm using 2 arrays and I'm deleting both using the ${arrayName-&gt;delete} command in my last (hidden) section.<br />
      <br />
      Should I be placing this command somewhere else (like in .onInstSuccess)? Is there another command/procedure I should be using?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">6th August 2005 12:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'll have a look. It could be a /NOUNLOAD issue.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">6th August 2005 13:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've added ${ArrayUnload} to this build (v0.6 RC3).<br />
      Also updated all your example scripts (can't use ${Array} inside a Section or Function, added ${Array-&gt;Delete} and ${ArrayUnload} to all scripts).<br />
      <br />
      I found out why NSISArray.nsh wasn't included in the last Zip. It actually was, but for some reason it was put in the Plugins folder instead. So make sure you delete Plugins\NSISArray.nsh.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">6th August 2005 17:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks! I'll check it out.<br />
      <br />
      edit:<br />
      Things seem to be working great!<br />
      :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">superruzafa</span><br />
      <span class="post-time small text-muted">7th August 2005 02:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I want to use two arrays in my installer. This basic example results in a compiling error. A bug?<br />
      <br /></p>
      <pre>
<code>!include nsisarray.nsh<br /><br />outfile array.exe<br /><br />${Array} "array1"<br />${Array} "array2"<br /><br />section -array<br /><br />sectionend</code>
</pre>
      <pre>
<code>Error: variable "ArrayErr" already declared<br />Error in macro Array on macroline 3</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">7th August 2005 05:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I did some digging and found the problem (and turned up another problem in the process). My modified header file attached should fix it. (Note that I changed the name of the header file. Afrow may have another way he'd prefer to handle it so I didn't want my modifications to be confused with the 'official' version.)<br />
      <br />
      Two problems addressed (which are also commented in the attached header file):<br />
      1. the variable ArrayErr was getting defined multiple times when the array messagebox handling was turned off. To correct this, I turned the !define "ArrayErrorMsgBox" into a macro. So insted of using the "!define ArrayErrorMsgBox", I can now use "${ArrayErrorMsgBox}". (This is only if you want the plugin to generate error messages instead of you handling it the script. See the original docs for more info.)<br />
      <br />
      2. ArrayUnload was also getting defined more than once. To correct this, I simply enclosed the ArrayUnload define inside an "!ifndef" block.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">7th August 2005 09:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for helping out.<br />
      I had to go about ArrayErrorMsgBox differently though as when the ArrayErrorMsgBox is defined, all functions will do a Pop $ArrayVar. However, your code had it defined constantly and therefore it couldn't work.<br />
      With the Var ArrayErr, I've just added another define so that it isn't added twice.<br />
      <br />
      (Uploaded v0.6 RC4)<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
