<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="uninstall/reinstall issues"><title>uninstall/reinstall issues - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">uninstall/reinstall issues</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=321601">uninstall/reinstall issues</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">timbstoke</span><br><span class="post-time small text-muted">12th August 2010 11:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>uninstall/reinstall issues</strong><br>I'm an administrator, not a developer. One of the tools we use uses NSIS, and we're trying to script a silent uninstall/install for upgrades, and we're having a few problems.<br><br>It seems that NSIS spawns a seperate, randomly named process for uninstalling, at which point the uninstaller terminates. This means that our scripts continue running, and try to install the new version before the old has finished uninstalling. The result is files in use, a failed install, and a dialog box on every machine that we need to acknowledge before we can try again.<br><br>After doing this once on a few hundred machines and not liking the idea of doing again, I have a few questions:<br><br>- Is there a way to detect the process name that the uninstaller spawns, so we can monitor it and pause script execution until it's finished?<br>- Failing that, is there a way to make a silent install *really* silent - i.e. exit with an non-zero error code rather than displaying a dialog box? This would at least allow us to detect a failed install, rather than having a hung script that requires me to wander the building, zombie-like, logging in to machines at 5am to acknowledge an error message.<br><br>If none of those are doable, does anyone else have advice on how we can gracefully handle an uninstall/reinstall reliably without it falling over?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DrO</span><br><span class="post-time small text-muted">12th August 2010 11:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i think <a href="http://nsis.sourceforge.net/Docs/Chapter3.html#3.2.2" target="_blank">http://nsis.sourceforge.net/Docs/Chapter3.html#3.2.2</a> should help with the uninstaller spawning 'issue' or at least help in modifying your scripts to work with it.<br><br>-daz</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>