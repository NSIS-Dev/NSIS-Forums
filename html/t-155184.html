<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Cancelling an install"><title>Cancelling an install - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Cancelling an install</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=155184">Cancelling an install</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">j27lee</span><br><span class="post-time small text-muted">4th November 2003 23:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Cancelling an install</strong><br>I've implemented a CD Key check in my installer, but can't cancel out of it, by either clicking cancel or back. It seems to loop until i enter the right key.<br><br>how can you detect if the cancel key or back key was pressed?<br><br>cdcheck_begin:<br>!insertmacro MUI_HEADER_TEXT "$(CDKEY_TITLE)" "$(CDKEY_SUBTITLE)"<br>!insertmacro MUI_INSTALLOPTIONS_DISPLAY "CDKey"<br><br>InstallOptions::dialog "$PLUGINSDIR\CDKey.ini"<br>Pop $R0<br>StrCmp $R0 "back" cdcheck_end ;if user presses back<br>StrCmp $R0 "cancel" cdcheck_end ;if user presses cancel<br><br>-&gt;cd key check stuff in here....<br><br>StrCmp $1 "0" cdcheck_end<br><br>#if wrong serial number<br>MessageBox MB_OK|MB_ICONEXCLAMATION "CD Key incorrect!" IDOK invalid<br><br>invalid:<br>GOTO cdcheck_begin<br><br>cdcheck_end:<br><br><br><br>what am i doing wrong?<br><br>thanks,<br><br>james</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Vytautas</span><br><span class="post-time small text-muted">5th November 2003 00:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You should use the leave function of the custom page to check the cd key. That way it will not be checked if cancel/back button is pressed. You might need to update your version of NSIS to be able to use the leave function as it is a fairly new feature.<br><br>Vytautas</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">5th November 2003 01:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yeah, try to update to the newest development snapshot, it will works.<br><br>(change the:<br><br>InstallOptions::dialog "$PLUGINSDIR\CDKey.ini"<br><br>to<br><br>!insertmacro MUI_INSTALLOPTIONS_DISPLAY_RETURN "CDKey.ini"<br><br>have a better look!)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">5th November 2003 10:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you put it in the leave function, there is no need to use the return value, you can use MUI_INSTALLOPTIONS_DISPLAY.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">j27lee</span><br><span class="post-time small text-muted">5th November 2003 17:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Joost, I'm not sure what you mean. What do I put in the leave function? Is there any documentation on the leave function or any examples that I could look at?<br><br>thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">5th November 2003 19:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">He means you should use the page's leave function and not use the return value of InstallOptions ("back", "cancel" or "success" on the stack). The leave function for custom pages is available only in the latest CVS version. An example can be found in Contrib\InstallOptions\test.nsi.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">j27lee</span><br><span class="post-time small text-muted">5th November 2003 21:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I get it.... thanks!</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>