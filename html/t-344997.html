<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Windows 7 and File Association" />

  <title>Windows 7 and File Association - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Windows 7 and File Association</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=344997">Windows 7 and File Association</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">oldfriend</span><br />
      <span class="post-time small text-muted">20th May 2012 01:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Windows 7 and File Association</strong><br />
      Hello everyone!<br />
      <br />
      It happened so that I start my posts from the question "Is it possible or not?" to solve my problem. As well as now actually.<br />
      <br />
      I have a simple media player and I want to associate media file types with it. I found VLC player installer script here and without further ado have placed some parts to my one. Unfortunately, my player becomes default for those file types only for which previously there wasn't defined any player or application. This means that if e.g. avi file was previously player with WMP by default after installing my player and associating avi with it WMP remains default program for this file type.<br />
      <br />
      But if I try to open avi file via context menu and "Open with ..." there my player is first in the list. Unfortunately, this doesn't help much.<br />
      <br />
      As I noticed during the installation of VLC the same problems occurs.<br />
      <br />
      So main question here: <b>is it possible at all to associate application and file types via installer?</b><br />
      <br />
      P.S. To prevent possible suggestions of "try to ... " need to say that I'm known and already tried "RequestExecutionLevel admin", "UserInfo plug-in", "UAC plug-in" "run as administrator" with no luck or without confidence that problem is in admin privileges.<br />
      <br />
      Thank you for attention, reading and possible help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">oldfriend</span><br />
      <span class="post-time small text-muted">21st May 2012 19:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, I hope absence of answers doesn't mean my problem is unsolvable, but those who know salvation haven't seen this post yet :)<br />
      <br />
      Probably anybody knows how to change:<br />
      [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.avi\UserChoice]<br />
      "Progid"="WMP11.AssocFile.AVI"<br />
      <br />
      with, e.g.<br />
      "Progid1"="WMP11.AssocFile.AVI"<br />
      <br />
      i.e. simply change "Progid" with "Progid1"<br />
      <br />
      I was unable to do this under administrator account.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">21st May 2012 19:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You are not really supposed to mess with UserChoice, just follow the <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/cc144101%28v=vs.85%29.aspx" target="_blank">docs</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">oldfriend</span><br />
      <span class="post-time small text-muted">21st May 2012 21:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Anders</small><br />
        You are not really supposed to mess with UserChoice, just follow the <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/cc144101%28v=vs.85%29.aspx" target="_blank">docs</a>
      </blockquote>Thank you, but I don't have problems with Shortcuts.<br />
      <br />
      Any other ideas?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">21st May 2012 21:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">AFAIR you need to go back to user level if you want to set at user level - see:<br />
      <br /></p>

      <blockquote>
        [<font color="red">HKEY_CURRENT_USER</font>\Software\Microsoft\Windows\CurrentVersion<br />
        <br />
        I was unable to do this <font color="red">under administrator account.</font>
      </blockquote>as admin it will go admins user settings.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">oldfriend</span><br />
      <span class="post-time small text-muted">21st May 2012 23:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Brummelchen</small><br />
        AFAIR you need to go back to user level if you want to set at user level - see:<br />
        <br />

        <blockquote>
          Originally Posted by <strong>oldfriend</strong> (Post 2863199) [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion<br />
          <br />
          <br />
          I was unable to do this under administrator account.
        </blockquote>as admin it will go admins user settings.
      </blockquote>Well, probably it was a wrong way of salving my main problem. Anyway any thoughts about file association?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">21st May 2012 23:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">do it like vlc did<br />
      <br /></p>

      <blockquote>
        [HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.avi]<br />
        "VLC.backup"="WMP11.AssocFile.AVI"<br />
        @="VLC.avi"
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">oldfriend</span><br />
      <span class="post-time small text-muted">22nd May 2012 00:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Brummelchen</small><br />
        do it like vlc did
      </blockquote>Once again need to that after installing VLC player files previously associated with WMP <b>are still opened</b> with WMP even if you associate them with VLC.<br />
      <br />
      That's why I'm here.<br />
      <br />
      Please don't reply if you haven't faced with such problem.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">22nd May 2012 00:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by oldfriend</small><br />
        Thank you, but I don't have problems with Shortcuts.<br />
        <br />
        Any other ideas?
      </blockquote>Actually read the page I linked to? That page also links to <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/cc144148%28v=vs.85%29.aspx" target="_blank">this</a> . Those two pages link to all the information about registering file types...
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">22nd May 2012 02:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">na, dont bother me with your dullness, i tried to help<br />
      <br />
      first - did you install vlc with your script or with the official setup?<br />
      i guess your script is outdated and buggy wether i've seen it or not.<br />
      <br />
      second - you cant fix it your way - not possible<br />
      <br />
      third - you need to reconnect WMP to all its files<br />
      then you need to clear up that vlc crap connections<br />
      <br />
      fourth - delete this tree<br />
      HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts<br />
      you will loose some connections - just reconnect later<br />
      <br />
      reinstall vlc with official setup<br />
      you can do that in sandboxie to grab the knowledge behind how it works.<br />
      sandboxie forum offers tools for that<br />
      otherwise install it normally<br />
      <br />
      much faster to repair something you dont get ATM<br />
      <br />
      HTH</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">oldfriend</span><br />
      <span class="post-time small text-muted">22nd May 2012 20:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you, Anders. Will read more carefully.<br />
      <br />
      <br /></p>

      <blockquote>
        <small>Originally posted by Brummelchen</small><br />
        na, dont bother me with your dullness, i tried to help
      </blockquote>Brummelchen, words "don't reply" were not directed personally to you, so please don't be rude.<br />
      <br />

      <blockquote>
        <small>Originally posted by Brummelchen</small><br />
        first - did you install vlc with your script or with the official setup?
      </blockquote>Yes installer was taken from <a href="http://www.videolan.org/vlc/download-windows.html" target="_blank">http://www.videolan.org/vlc/download-windows.html</a> and after redirecting to <a href="http://sourceforge.net/" target="_blank">http://sourceforge.net/</a> was downloaded, so it is official. Ans it's installer <b>DOESN'T ASSOCIATE</b> files with VLC player which were previously associated with WMP. To complete association you need to do this via VLC player later. It is confirmed! On clean system. Not by me only.<br />
      <br />

      <blockquote>
        <small>Originally posted by Brummelchen</small><br />
        i guess your script is outdated and buggy wether i've seen it or not.
      </blockquote>as you wish<br />
      <br />
      <br />

      <blockquote>
        <small>Originally posted by Brummelchen</small><br />
        second - you cant fix it your way - not possible
      </blockquote>I'm beginning to think so to, too sad<br />
      <br />

      <blockquote>
        <small>Originally posted by Brummelchen</small><br />
        third - you need to reconnect WMP to all its files<br />
        then you need to clear up that vlc crap connections
      </blockquote>VLC is not my goal. I just used it's installer's patrs with the only success with non-associated files and in this case it works fine.<br />
      <br />

      <blockquote>
        <small>Originally posted by Brummelchen</small><br />
        fourth - delete this tree<br />
        HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts<br />
        you will loose some connections - just reconnect later
      </blockquote>I can't do this neither with installer nor with my admin rights ander admin account. And not only me.<br />
      <br />

      <blockquote>
        <small>Originally posted by Brummelchen</small><br />
        reinstall vlc with official setup<br />
        you can do that in sandboxie to grab the knowledge behind how it works.<br />
        sandboxie forum offers tools for that<br />
        otherwise install it normally
      </blockquote>as I sad i don't need VLC<br />
      <br />

      <blockquote>
        <small>Originally posted by Brummelchen</small><br />
        much faster to repair something you dont get ATM
      </blockquote>No comments :)<br />
      <br />

      <blockquote>
        <small>Originally posted by Brummelchen</small><br />
        HTH
      </blockquote>Not really, since unfortunately your post is not connected with my NSIS problem. Anyway, thank you Brummelchen for your time and attention.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">oldfriend</span><br />
      <span class="post-time small text-muted">23rd May 2012 18:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Anders, thank you very much for the link which helped me to understand more deep file association in the Windows 7 (and Vista)<br />
      <br />
      Brummelchen, you were right regarding the<br /></p>
      <pre>
<code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts</code>
</pre><br />
      my problem was exactly in the registry key, so thank you for pointing me there.<br />
      <br />
      At the moment I'm writing and testing clear version if installer, so when I finish I'll explain were I was wrong.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
