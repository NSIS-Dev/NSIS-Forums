<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="NSIS/Tomcat problems"><title>NSIS/Tomcat problems - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">NSIS/Tomcat problems</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=319358">NSIS/Tomcat problems</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">brandondash</span><br><span class="post-time small text-muted">21st May 2010 22:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>NSIS/Tomcat problems</strong><br>Hi guys,<br><br>First let me say I'm happy to finally be posting here. The websense filters at my place of business had this site blocked for years on account of the mp3 player. In fact I finally broke down and purchased a phone with android just so I could fumble my way here through a phone browser, only to have the site unblocked a week later! :P<br><br>I have a problem using NSIS to install Apache Tomcat as a service. It is one of several components I install silently (including java, httpd, postgres, postgis, and jboss) and it's the only one giving me problems.<br><br>In a nutshell, running service.bat via ExecWait completes with no error and seemingly no result. If I run it by hand it works. If I edit service.bat to put a pause at the end of the script it works. This problem has me truly baffled.<br><br>Does anyone here install Tomcat as a service? Any ideas?<br><br>regards,<br>brandon-</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">22nd May 2010 10:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What is your ExecWait command line? Have you tried ExecDos or nsExec?<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">brandondash</span><br><span class="post-time small text-muted">24th May 2010 19:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">NSIS snippet:<br><br>SetOutPath "c:\MYAPP\tomcat\bin"<br>ExecWait 'install-tomcat.bat'<br>ExecWait 'net start MYTOMCAT'<br><br>Then in install-tomcat.bat I have<br>cd %~dp0<br>set CATALINA_BASE=c:\MYAPP\tomcat<br>service install MYTOMCAT<br><br><br>I have only tried ExecWait because up until this point it has worked in every case (including a very similar install-jboss-as-a-service process).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">24th May 2010 21:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try running the batch with cmd /C:<br><br>ReadEnvStr $R0 COMSPEC<br>ExecWait `"$R0" /C "path\to\install-tomcat.bat"`<br><br>Also as you are not giving it the full path to the batch file, it is working on the current directory (SetOutPath). Always use full paths.<br><br>Edit: And lastly you should use ExecDos or nsExec for commands like this. Installers that show pop up console windows during installation look unprofessional.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">brandondash</span><br><span class="post-time small text-muted">2nd June 2010 17:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the advice. Will try and post back.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">brandondash</span><br><span class="post-time small text-muted">3rd June 2010 23:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The nsExec::Exec switch did the trick! Don't ask me how or why, but it worked. I went ahead and switched all the bats and msi execs to it also. I agree that it makes a big difference in terms of professional appearance.<br><br>Thanks for the help. ^_^<br><br>brandon-</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>