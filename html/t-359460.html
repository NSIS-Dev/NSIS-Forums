<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Registry with full permission"><title>Registry with full permission - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Registry with full permission</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=359460">Registry with full permission</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">winman2004</span><br><span class="post-time small text-muted">15th April 2013 15:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Registry with full permission</strong><br>I am trying to give full permission for a registry in nsis but its not working.Below is a sample code.<br>WriteRegStr HKEY_LOCAL_MACHINE "SOFTWARE\Demo\" "mydemo" "abc"<br>AccessControl::GrantOnRegKey HKEY_LOCAL_MACHINE "SOFTWARE\Demo\" "PC116\Users" "FullAccess"<br><br>I tried doing it in a windows XP PC. I tried using REGINI using a vbscript which gives full permission for user "Everyone".So can anyone help me on this.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">16th April 2013 00:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://stackoverflow.com/questions/16017546/registry-with-full-permission" target="_blank">http://stackoverflow.com/questions/1...ull-permission</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">winman2004</span><br><span class="post-time small text-muted">17th April 2013 14:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">As you have told i have done the coding in NSIS and created registry.<br>When i checked permission for that registry in regedit(by right clicking node and then permission) the users group has got full permission.<br>Then i used a vb6 code by using RegSetValueEx function which writes and modifies the registry value of registry which i created.<br>Now in windows 8 and windows 7 PC i just run the vb6 code(i created exe file) and found that registry is not changing for users.Even if i run in administrator the registry is not changing.<br>when i run the same using run as administrator the registry changes.<br>So what is the use of the access control if i am not able to change with just a user login?<br>I think windows 8 is done such a way that registry cannot be edited without running it as administrator.<br>There is also an interesting this if i change registry manually by using regedit and then changing key manually then it works.I mean access control helps in this case. But any developer will be wanting to change registry using code which it does not allow.<br>So please help me on this.<br>Also see the thread <a href="http://stackoverflow.com/questions/16062343/regsetvalueex-requires-run-as-administrator-to-work" target="_blank">here</a> for more information<br>Thank you</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Davemays</span><br><span class="post-time small text-muted">28th April 2013 15:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Same issuse?</strong><br>I am using Windows 7 and trying to set the permissions on a Software key that I have created.<br><br><font face="Courier New"><br>SetRegView 64<br>AccessControl::GrantOnRegKey HKLM "SOFTWARE\test" "S-1-5-32-545" "FullAccess"<br>Pop $R0<br>${If} $R0 == error<br>Pop $R0<br>DetailPrint `AccessControl error: $R0`<br>${EndIf}</font><br><br>Doing this I get the error:<br><br><font face="Courier New">Wrote HKLM\SOFTWARE\test<br>AccessControl error: Cannot build new access control list. Error code: 1332<br>Completed</font><br><br>Any ideas?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Davemays</span><br><span class="post-time small text-muted">28th April 2013 16:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Fixed.</strong><br>Found what the problem was, it doesn't like the " " of the SID for some reason.<br><br><font face="Courier New">!define StringSID_BUILTIN_Users S-1-5-32-545<br>AccessControl::GrantOnRegKey HKLM "SOFTWARE\test" "(${StringSID_BUILTIN_Users})" "FullAccess"</font><br><br>Works like a charm now.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">28th April 2013 20:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Your first post used "SID-xxx" but the required format is "(SID-xxx)", one set of quotes should not matter if there are no spaces, the compiler will strip them away so they are never passed to the plugin...</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>