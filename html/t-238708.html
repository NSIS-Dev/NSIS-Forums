<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Switch from Inno Setup to NSIS"><title>Switch from Inno Setup to NSIS - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Switch from Inno Setup to NSIS</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=238708">Switch from Inno Setup to NSIS</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">komsbomb</span><br><span class="post-time small text-muted">22nd February 2006 08:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Switch from Inno Setup to NSIS</strong><br>Now I'm a Inno Setup user. But Inno lacks some features like uninstall page wizard. So I plan to switch to NSIS.<br><br>So one question,<br>If I install my previous version software (installed by Inno), and then I install the new version by NSIS, there will be two 'Uninstall' items in the start menu!<br>So is there any easy way to install the new version but remove all previous informations written by Inno?<br>I don't want to force the user to uninstall the existing version.<br>Should I have to hack into Inno to remove all files and reg keys produced by Inno?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">glory_man</span><br><span class="post-time small text-muted">22nd February 2006 09:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What kind of information writed by Inno?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">komsbomb</span><br><span class="post-time small text-muted">22nd February 2006 10:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I mean the installation informations. Such like the uninstall info Inno writes to the registry, and the uninstaller file Inno creates in the install path, etc.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">glory_man</span><br><span class="post-time small text-muted">22nd February 2006 10:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Just delete uninstaller and change (or delete) registry information. :D Instrucions - <b>Delete</b>, <b>DeleteRegValue</b>, <b>DeleteRegKey</b>. Why you can not use it?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">komsbomb</span><br><span class="post-time small text-muted">22nd February 2006 10:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Isn't there any helper macros to do that?<br>It will be a little headache to do that.<br>I'm seeking a simpler way.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">glory_man</span><br><span class="post-time small text-muted">22nd February 2006 10:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>It will be a little headache to do that.</blockquote>Why?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sutek</span><br><span class="post-time small text-muted">22nd February 2006 12:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>Isn't there any helper macros to do that?<br>It will be a little headache to do that.<br>I'm seeking a simpler way.</blockquote>Not really, and to be completely honest I'd be very surprised to find that any of the various installer packages like InnoSetup, InstallShield or the like had anything like this.<br><br>Installation packages tend to be custom to those creating them, and thus so too is the information these packages create for uninstallation. They might all follow a standard pattern laid out by the packages default config, but there's no guarantee that someone won't have altered it in some critical way - no "helper macro" could predict that.<br><br>Using a series of Delete, and DeleteRegValue/Key commands is about as simple as you can possibly get really, and a darn sight more reliable and customisable than any form of helper macro :) If you have a lot of very similar applications, you could probably then turn this series of commands into your own helper macro!</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">komsbomb</span><br><span class="post-time small text-muted">22nd February 2006 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you all.<br><br>Now I know what I shoud do, delete, delete, and delete. :-).<br>Maybe I should use some registery monitor program to find out what Inno will write to the registry.<br>Can anyone figure out what the keys are that Inno write?<br>Maybe I should ask this in Inno newsgroup or do the hack by myself. :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">22nd February 2006 17:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use regmon<br><a href="http://www.sysinternals.com/Utilities/Regmon.html" target="_blank">http://www.sysinternals.com/Utilities/Regmon.html</a><br><br>But in most cases INNO only write the uninstall keys and that can be used or is similar to NSIS keys, eg:<br>- UninstallString<br>- InstallLocation<br>- DisplayName<br>- DisplayIcon<br><br>To determine where older installations were put you have to<br>read out theses inportant keys (the rest is not neccessary)<br>or some use some specific keys from programm itself (eg<br>hkcu/software/&lt;program&gt; or hklm/software/&lt;program&gt;)<br><br>be sure to be compatible to your own installers - EVER.<br><br>InstallShield is complete different - it is possible to have<br>a clean silent uninstall - but i dont recommend this.<br>Just inform your user that another instance is installed and<br>user should uninstall it manually.<br><br>NSIS can do a lot for you - just code it</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">komsbomb</span><br><span class="post-time small text-muted">23rd February 2006 01:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yeah, I will DIY it.<br><br>I don't want the user to uninstall the app because it will remove the config files in the previous version.<br><br>I will hard code the delete routine in NSIS.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Pharaoh Atem</span><br><span class="post-time small text-muted">26th February 2006 16:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I am also trying to move some stuff to NSIS.... The two scripts attached are inno scripts, and I want to port them to NSIS so that I can create a version that contains my special "keys" for the network I am deploying to.... The keys are embedded in the installer without scripting, so the only thing is to convert the Inno scripts to NSIS, but I tried iss2nsi and it kept spewing errors of invalid directives... Could someone port these scripts for me so that I can build these with NSIS? I loved the small overhead (one of the main reasons I chose NSIS, the other is uninstall pages), which is why I am being bold enough to ask this...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">26th February 2006 17:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Water does not flows under settled stones.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Pharaoh Atem</span><br><span class="post-time small text-muted">26th February 2006 17:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Instructor</i><br><b>Water does not flows under settled stones.</b></blockquote>What the heck? What does that mean? Ehhh....</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">komsbomb</span><br><span class="post-time small text-muted">27th February 2006 02:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Pharaoh Atem</i><br><b>I am also trying to move some stuff to NSIS.... The two scripts attached are inno scripts, and I want to port them to NSIS so that I can create a version that contains my special "keys" for the network I am deploying to.... The keys are embedded in the installer without scripting, so the only thing is to convert the Inno scripts to NSIS, but I tried iss2nsi and it kept spewing errors of invalid directives... Could someone port these scripts for me so that I can build these with NSIS? I loved the small overhead (one of the main reasons I chose NSIS, the other is uninstall pages), which is why I am being bold enough to ask this...</b></blockquote>Hello,<br><br>I didn't port my Inno script to NIS, but to fully rewrite my Inno script in NIS. That's easier to do than blindly porting!<br>Because I'm too new to NIS, I use HM NIS Editor to create a basic script, then I add what I need to it.<br><br>Your Inno scripts are very simple, even not include any code? So you should just to user HM NIS Editor to get a basic script, then add all files in it. Of course the editor can help you add files too.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Pharaoh Atem</span><br><span class="post-time small text-muted">27th February 2006 02:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Alright I will try it...</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>