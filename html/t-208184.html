<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Uninstaller log" />

  <title>Uninstaller log - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Uninstaller log</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=208184">Uninstaller log</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tbreina</span><br />
      <span class="post-time small text-muted">18th February 2005 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Uninstaller log</strong><br />
      Ok. I've read the threads regarding creating an uninstaller log to list which files my package installs, but am still a little stumped.<br />
      <br />
      The script by Afrow UK (<a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=556" target="_blank">http://nsis.sourceforge.net/archive/...php?pageid=556</a>) works fine for me (except I had trouble with the variable $OUTPATH and changed it to $OUTDIR). I get a nice log of all the files I called during install.<br />
      <br />
      However, as with a previous user (another thread on the subject), I can't seem to figure out how to take care of the case where I have installed an entire directory with a wildcard ( e.g.<br />
      <br />
      ${File} /r "dir1\*.*"<br />
      <br />
      would be the command using Afrow UK's script above). I could just RMDIR /r to get everything in that directory, but would rather have the uninstall log file print out each file that dir1\*.* caused to be installed.<br />
      <br />
      Can this be done with an embedded FindFirst/FindNext/FindClose?<br />
      I was thinking for example,<br />
      <br />
      Var UninstLog<br />
      <br />
      ; Add file macro<br />
      !macro File FileName<br />
      FindFirst $0 $1 ${FileName}<br />
      loopfindfirst:<br />
      StrCmp $1 "" done<br />
      DetailPrint $1<br />
      File $1<br />
      FileWrite "$UninstLog" "$OUTDIR\$1$\r$\n"<br />
      FindNext $0 $1<br />
      Goto loop<br />
      donefindfirst:<br />
      !macroend<br />
      !define File "!insertmacro File"<br />
      <br />
      <br />
      The problem here is that the loopfindfirst: is re-declared each time the ${File} command is sent (which generates an error}.<br />
      <br />
      Anyone see a better solution?<br />
      <br />
      Thanks.<br />
      -Tony</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">18th February 2005 19:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">FindFirst won't be the best solution because there may be other files in the directory you're installing to. Currently, the best solution is using an external program to create a list of files from a wildcard. The program can use Afrow's macro for each file. This program can be executed using !system and its output can be included in the script using !include. It's possible to write such a program even as a NSIS installer.<br />
      <br />
      A similar program was built for similar situation:<br />
      <br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=150770&amp;highlight=rsegal" target="_blank">http://forums.winamp.com/showthread....ghlight=rsegal</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tbreina</span><br />
      <span class="post-time small text-muted">18th February 2005 20:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Uninstaller log + FolderList</strong><br />
      The FolderList.exe program seems to be exactly what I need (even a little better than for what I'm using it for).<br />
      <br />
      Thanks.<br />
      -Tony<br />
      <br />
      p.s. Could this program be referenced along with scripts that build uninstaller logs</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
