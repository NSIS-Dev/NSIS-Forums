<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Extension DLL for OS, DLL and file version information" />

  <title>Extension DLL for OS, DLL and file version information - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Extension DLL for OS, DLL and file version information</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=90878">Extension DLL for OS, DLL and file version information</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">13th June 2002 02:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Extension DLL for OS, DLL and file version information</strong><br />
      This is something I put together for my own use but that other people might find useful. It's an extension dll that can get things like the Service Pack number installed on the system, the Windows build number, all kinds of version information from DLLs and exe files (the sort of thing you see on the Version tab of the file properties dialog in Windows 2000.<br />
      <br />
      You can find it on my NSIS web page with my other dlls here :<br />
      <br />
      <a href="http://www.clantpa.co.uk/nsis/" target="_blank">http://www.clantpa.co.uk/nsis/</a><br />
      <br />
      There is a demo .nsi file with it that dumps lots of information into the detail view about the system and about two files I chose to look at, batmeter.dll (which does not support the DllGetVersion mechanism) and comctl32.dll (which does). Its quite dumb, it expects them to be in c:\winnt\system32 and if they're not you'll get blank strings back for those files.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cjs</span><br />
      <span class="post-time small text-muted">12th November 2003 22:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is this script still availible? If someone has a copy around please email me at<br />
      <br />
      <a href="mailto:cs@micadmarine.com">cs@micadmarine.com</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th November 2003 22:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This has been replaced by the Archive which is open source. You can find the source code in CVS.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cjs</span><br />
      <span class="post-time small text-muted">12th November 2003 22:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What I was looking to accomplish was a getwindowsversion with service pack information.<br />
      <br />
      If service pack is not greater then or equal to sp3 then report a message to the user. otherwise, continue installation.<br />
      <br />
      How would I do that using getwindowsversion function?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th November 2003 22:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh, oops... Thought this message was about the original NSIS Archive. The plug-in you are talking about is available in the Archive with an example script.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cjs</span><br />
      <span class="post-time small text-muted">12th November 2003 22:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The example looks too complicated! How would I run a comparison value based on the output of "getwindowsversion"<br />
      <br />
      thanks alot for your help, you guys are the best. :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th November 2003 22:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Like everything else in NSIS, using StrCmp or IntCmp. IntCmp is probably the on you are looking for because it can test if it's greater or smaller and not just different. As for specific values to compare to, you'd have to find it out on your own unless someone else has the answer.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
