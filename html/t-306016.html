<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Deleting registry value under HKCU wow6432node"><title>Deleting registry value under HKCU wow6432node - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Deleting registry value under HKCU wow6432node</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=306016">Deleting registry value under HKCU wow6432node</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">mustafacity</span><br><span class="post-time small text-muted">4th May 2009 13:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Deleting registry value under HKCU wow6432node</strong><br>Hi,<br><br>I am having trouble trying to delete a registry entry at the following location on Vista 64 bit:<br><br>HKEY_CURRENT_USER\Software\classes\virtualStore\Machine\Software\Wow6432Node\JavaSoft\Prefs\AppName\<br><br>I have already tried to use SetRegValue 32 in order to try to delete the key, but having no luck could someone share some light or provide me with some help as to how can I delete a registry value at this location?<br><br>Many thanks in advance<br><br>Musafa</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mustafacity</span><br><span class="post-time small text-muted">4th May 2009 15:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I guess no one has encountered this kind of problem before?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">4th May 2009 15:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">do you have RequestExecutionLevel in your script? Vista will not redirect to the virtualstore if you have a "vista manifest"<br><br>You could use Process Monitor from sysinternals to see where the problem is, with the virtualStore or Wow6432Node part of the path</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mustafacity</span><br><span class="post-time small text-muted">4th May 2009 15:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Anders,<br><br>Many thanks for replying.<br><br>The problem is that these registry entries are not actually inserted by the nsi script. They get inserted from the Java code. Hence, I was looking for a way of deleting a registry value within that location. Is there no way to make nsis script to see the full registry location that way I can put in the full path to the key?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mustafacity</span><br><span class="post-time small text-muted">4th May 2009 18:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Any ideas anyone? I have found an alternative solution which is to use AutoIt which would allow me to get around this problem.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mustafacity</span><br><span class="post-time small text-muted">5th May 2009 10:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I realise I may not have explained this well. I am trying to remove the effects of VirtualStore on a 64-bit PC running 32-bit processes.<br><br>I have a piece of legacy software which wrote to the system registry and was virtualised to a user registry location within HKCU "Software\Classes\VirtualStore\MACHINE\SOFTWARE\wow6432node".<br><br>I want to erase this. But whenever I try to write/delete registry entries using this full path, I get values appearing/deleting in a different place, and the above location remains unchanged.<br><br>Place I'm trying to write/delete:<br>HKCU "Software\Classes\VirtualStore\MACHINE\SOFTWARE\wow6432node"<br><br>Places I get (depending on SetRegView 32):<br>HKCU "Software\Classes\"<br>HKCU "Software\classes\wow6432Node\"<br><br>Places I get (depending on SetRegView 64):<br>HKCU "Software\classes\virtualstore\machine\software\"<br>HKCU "Software\classes\wow6432Node\virtualStore\machine\software\"<br><br>Is there any way of enabling "raw" access to the exact registry path I am specifying, without any of this "VirtualStore" and "Wow6432Node" messing about Windows is doing for me within the user registry? Or is this a bug in NSIS?<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">5th May 2009 10:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If the legacy application was redirected to that registry location then why can't your NSIS script just delete from the original registry path?<br><br>I assume it would just be:<br>HKEY_CURRENT_USER\Software\JavaSoft\Prefs\AppName\<br><br>Sorry if I do not have this correct.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">5th May 2009 15:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">why can't you go after the the redirected path?<br><br>SetRegView 64 + "Software\classes\virtualStore\Machine\Software\Wow6432Node\JavaSoft\Prefs\AppName\" ?</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>