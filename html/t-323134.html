<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Calling same function during install and uninstall" />

  <title>Calling same function during install and uninstall - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Calling same function during install and uninstall</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=323134">Calling same function during install and uninstall</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mabian</span><br />
      <span class="post-time small text-muted">14th October 2010 16:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Calling same function during install and uninstall</strong><br />
      Hello,<br />
      <br />
      I know about the "un." limitation for uninstall function calls, but I wonder if there's some way to call the very same function during install and uninstall.<br />
      <br />
      In particular, my function checks for the existence of a service; if exists, it stops it and removes it, so that:<br />
      <br />
      - When installing, the updated service can be installed<br />
      - When uninstalling, the service can be removed<br />
      <br />
      I'd like to reuse the same code portion and avoid macros (it's about thirty lines code using labels).<br />
      <br />
      Is there some way to do this?<br />
      <br />
      Thanks,<br />
      Mario</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">14th October 2010 16:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">First link on Google search if you search for your topic subject + NSIS:<br />
      <a href="http://nsis.sourceforge.net/Sharing_functions_between_Installer_and_Uninstaller" target="_blank">http://nsis.sourceforge.net/Sharing_...nd_Uninstaller</a><br />
      <br />
      Please do a search in future.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mabian</span><br />
      <span class="post-time small text-muted">14th October 2010 16:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you, I already found it; but with this technique, the code is actually doubled in the installer - so double room taken.<br />
      <br />
      I was looking for a smarter solution... :)<br />
      <br />
      - Mario</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">redxii</span><br />
      <span class="post-time small text-muted">14th October 2010 18:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can't call a function in the installer from the uninstaller and vice versa, they are separate files.<br />
      <br />
      So you have to use that macro technique to make it easier to maintain one piece of code for both or copy and paste the function adding "un." in front of the function name for the uninstaller.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mabian</span><br />
      <span class="post-time small text-muted">14th October 2010 18:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Aaahhh now I get it, thanks!<br />
      <br />
      I used the "double macro" approach, works great.<br />
      <br />
      This forum rocks ;)<br />
      <br />
      - Mario</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
