<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="custom page leave function password validation"><title>custom page leave function password validation - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">custom page leave function password validation</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246818">custom page leave function password validation</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">shaunb</span><br><span class="post-time small text-muted">23rd May 2006 10:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>custom page leave function password validation</strong><br>Hi people, I've been trying to validate a users login on a remote server page, I have the blank password code working fine, although I can't see why the abort doesnt work after reading the value from the text file, I want it to go back to the page like the abort call does on empty password, anyway I've included the page leave function if anyone can read it hehe<br><br>:)<br><br>Function exitGetCFPassPage<br>!insertmacro MUI_INSTALLOPTIONS_READ $CFPASS "getCFPass.ini" "Field 2" "State"<br>MessageBox MB_OK "$$CFPASS == $CFPASS"<br># check its not empty at least<br>${If} $CFPASS == ""<br># empty password, prompt for a valid password again<br>MessageBox MB_OK "Please enter a valid ColdFusion admin password."<br>abort<br>${endIf}<br># we forget all the items are extracted here already due to this page coming after the instfiles page<br># we can just perform a simple wget on the testlogin script, and read the contents of c:\adminapi.log<br># to see if it produced true or false for a valid login, then we can validate in here until we get a<br># valid password!<br><br>NSExec::exec "$TEMP\${gossTemp}\wget\wget.exe <a href="http://localhost/icm/adminAPI/testlogin.cfm?password=" target="_blank">http://localhost/icm/adminAPI/testlogin.cfm?password=</a>$CFPASS"<br># this returns a file c:\adminapi.log with true or false in, which we can use<br># read the file, decide what to do etc, what about exceptions if its not there?<br>FileOpen $4 "c:\adminapi.log" r<br># we read until the end of line (including carriage return and new line) and save it to $1<br>FileRead $4 $1<br># close the file<br>FileClose $4<br>MessageBox MB_OK "login result is : $1"<br>${If} $1 == "false"<br># invalid login<br>MessageBox MB_OK "Please enter a valid ColdFusion admin password."<br>abort<br>${endIf}<br>FunctionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">shaunb</span><br><span class="post-time small text-muted">23rd May 2006 10:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I believe I need to basically loop over the wget checking and file reading code until I get 'true' in $0<br><br>but I've tried labels etc and this abort method and it doesnt work, so loop maybe?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">shaunb</span><br><span class="post-time small text-muted">23rd May 2006 11:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hmm all my attempts to loop around this function just end in an infinite loop as it doesnt let me input a new value.<br><br>I'm stuck :(<br><br>damn you custom dialogs and all that jazz</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st June 2006 09:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">With no further details like a complete example or the results of the message box, I have to guess and I put my bet on the <a href="http://nsis.sourceforge.net/I_am_reading_a_file_name_from_another_file_and_Delete/FileOpen/CopyFiles_don%27t_work_with_the_file_name" target="_blank">FAQ</a>.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>