<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Compiling NSIS to add Logging"><title>Compiling NSIS to add Logging - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Compiling NSIS to add Logging</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=248641">Compiling NSIS to add Logging</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">mwright</span><br><span class="post-time small text-muted">13th June 2006 19:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Compiling NSIS to add Logging</strong><br>I am new to NSIS and have really liked the product so far. My problems did not start until I tried to add the logging feature to the product. Reading through the documentation I found that I needed to install Python and SCons. I downloaded the latest of each. I had to back off of the latest version of SCON because of some problems and ended up with version 0.96.91 (I could not use 0.96.92, don't remember the problem, but going back to 0.96.91 fixed it). I have VC++ 6.0 installed, but realized I needed a new version of the VC++. The only one available from Microsoft was the VC++ Express 2005. So I downloaded and installed it. Then I started getting errors about Unresolved Symbols. I fixed that issue by setting up the Environmental variables MSSDK and VCToolkitInstallDir=c:\Program Files\Microsoft Visual Studio 8/VC directory.<br><br>The next issue I ran into when running the scons MSTOOLKIT=yes command was the cl.exe had a missing module. It could not find mspdb80.dll. I found the file in the C:\Development_Tools\Microsoft Visual Studio 8\Common7\IDE directory. That directory was in the PATH environmental variable but still was not able to find it. I ended up copying that file to the System32 directory.<br><br>I also had a problem where I would get an error saying that a good copy of the libcp.lib file could not be found. I had to go into the ms file in the SCon/Config directory and comment out the lines that looked for a copy of the libcp.lib file. I was then able to get past that error.<br><br>The next problem I ran into was unresolved errors for symbol __security_cookie and __security_check_cookie. Through more searching on the web I determined that I needed to include the bufferoverflowU.lib in the link statement for certain modules. I finally figured out that I could add the file to the list of libs in the SConscript file in the directories of the modules that were getting the error.<br><br>I seem to be moving forward, but after 2 days of working with the app it seems a little excessive to simply add logging to the NSIS installer. Once I am able to get it to compile it is still not clear to me how I actually on the Logging feature. The help files says that "NSIS_CONFIG_LOG must be set in the cmpile configuration file (config.h) on compile time(it is not by default)". I don't know if that means I need to edit the config.h file or if I need to edit some scon file so that it includes a define switch when compiling the software. I ended up editing the SCons/config.py file from:<br><br>cfg.Add(<br>BoolOption(<br>'NSIS_CONFIG_LOG',<br>'enables the logging facility. turning this on (by uncommenting it) adds about 4kb, but can be useful in debugging your installers.',<br>'no'<br>)<br>)<br><br>to this<br><br>cfg.Add(<br>BoolOption(<br>'NSIS_CONFIG_LOG',<br>'enables the logging facility. turning this on (by uncommenting it) adds about 4kb, but can be useful in debugging your installers.',<br>'yes'<br>)<br>)<br><br>Is that what I need to do to turn on logging?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">13th June 2006 20:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://nsis.sourceforge.net/Special_Builds" target="_blank">http://nsis.sourceforge.net/Special_Builds</a><br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mwright</span><br><span class="post-time small text-muted">13th June 2006 21:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the reply,<br><br>It looks like what I need but I'm not sure what to do with the download. I downloaded it and unzipped it. I ran the makensis.exe and it listed options that I could use to run it. My first question is where do I need to run it from and where do I put the other files that are in the zip (i.e. the Stubs directory)? My second question is what is it suppoe to do? Does it update some configuration files so that I can build the software with the options I want enabled (i.e. logging) or does it actually build the software as well as enable to options I want by using the /Ddefine switch?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">13th June 2006 21:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Put it in the NSIS folder of course :p<br>Also make sure you move the stubs folder in there too if there is one.<br><br>It enables logging when you have LogSet on set.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th June 2006 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">SCons 0.96.92 has support for 2005, iirc. If not, the next version should have it. However, there are a few incompatibilities with our SConstruct.<br><br>If you still wish to build, stick to VC 6. That's what I use for the official releases.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">onad</span><br><span class="post-time small text-muted">17th June 2006 16:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well "mwright" at least your story of issues you encountered was well written and can be of help for others who try to complete a build themselves, thanks.<br><br>Probabbly you best use the special build version for direct results ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mwright</span><br><span class="post-time small text-muted">17th June 2006 16:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for all of your replys. The special build is what I needed. I guess I should have searched more before trying to build the source. I just throught that since the help file said "NSIS_CONFIG_LOG must be set in the cmpile configuration file (config.h) on compile time(it is not by default)" the route to go was to compile up the source. Again, thanks for taking the time to help me.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>