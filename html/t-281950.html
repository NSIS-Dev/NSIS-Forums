<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Launch an .exe file after install?" />

  <title>Launch an .exe file after install? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Launch an .exe file after install?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=281950">Launch an .exe file after install?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Contex</span><br />
      <span class="post-time small text-muted">22nd November 2007 19:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Launch an .exe file after install?</strong><br />
      Well I'm making a uninstaller that installs something.<br />
      And how can I make the uninstaller open an .exe file right after you click close etc. (It's a kind of scanner) Scans a folder for something, if it detects, it deletes the files.<br />
      <br />
      Here's my code:<br />
      <br /></p>
      <pre>
<code><br />;------------------------------------------------------<br />        !include "MUI.nsh"<br /><br />        Name "moh_breakthrough_demo"<br />        OutFile "moh_breakthrough_demo.exe"<br /><br />        InstallDir "$PROGRAMFILES\EA GAMES\Medal of Honor Allied Assault Breakthrough Demo\"<br />        <br />        !define MUI_HEADERIMAGE<br />        !define MUI_HEADERIMAGE_BITMAP "moh_header.bmp"<br />        <br />        !define MUI_ABORTWARNING<br />        !define MUI_WELCOMEFINISHPAGE_BITMAP "moh_wizard.bmp"<br />        <br />        !define MUI_ICON "arrow2-install.ico"<br />        <br />        !insertmacro MUI_PAGE_INSTFILES<br /><br />        !insertmacro MUI_LANGUAGE "English"<br /><br />Section hideuinstaller<br /><br />HideWindow<br /><br />SectionEnd<br /><br />Section "scan" scan<br /><br />      Delete "$INSTDIR\genocide.dll"<br /><br />SectionEnd<br /><br />Section openfile<br /><br />Exec '"$INSTDIR\moh_breakthrough.exe" "parameter 1" "parameter 2"'<br /> <br />SectionEnd<br /><br />Section close<br /><br />SetAutoClose true<br /><br />SectionEnd<br /><br />;--------------------------------------------------------<br /></code>
</pre><br />
      <br />
      <br />
      And when I try to run the uninstall i can see it delete the file.. but when it closes a problem pops up:<br />
      <br />
      <br />
      <a href="http://img263.imageshack.us/img263/9590/launchmfcfo7.jpg" target="_blank">http://img263.imageshack.us/img263/9...unchmfcfo7.jpg</a><br />
      <br />
      Help :D?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd November 2007 10:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">According to the name the dialog displays it seems the application you're executing is crashing.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Contex</span><br />
      <span class="post-time small text-muted">23rd November 2007 13:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">But when I exec a normal .txt file from notepad.. The same thing happends? :/</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd November 2007 13:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">With the exact same text? Where does this text come from? What program of yours is called "Launch MFC"? Look for that program as that's the one that is crashing.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Contex</span><br />
      <span class="post-time small text-muted">23rd November 2007 19:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh now it doesn't even open the .txt file when i tested. And I think it's the moh_breakthrough.exe that's called Launch MFC... Well it's not running the .txt file either? Could that be a script problem?<br />
      <br />
      Also:<br />
      Could it be because I use Vista x64? 64-bit..</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd November 2007 20:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nothing in NSIS itself is called "Launch MFC" and nothing in the script you've provided is called "Launch MFC". You must first find out what is this "Launch MFC" thing in order to find out what's wrong.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">23rd November 2007 20:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That is a crash associated with the Quake 3 engine launcher (in your case moh_breakthrough.exe). I seem to remember (i.e. games like MOH, ET). If it is crashing then the game isn't installed properly.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Contex</span><br />
      <span class="post-time small text-muted">23rd November 2007 21:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmmm.. Could it be because it's a cracked .exe? For allowing mods into the game. Maybe that's why its crashing?.. Maybe I should try to run some other file :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Fightin_Foo</span><br />
      <span class="post-time small text-muted">23rd November 2007 22:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just a quick thought here but did you try using the un.onUninstSuccess function? It is called after the uninstaller is finished.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Contex</span><br />
      <span class="post-time small text-muted">24th November 2007 00:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, I made a batch file thought.. Made it lanuch the batch file then lanuch the game file :S It worked then, Wierd eh. But I'll try that Fightin_Foo But first.. Eh this isn't a uninstaller, it's like a scanner. But I made it as an installer :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">24th November 2007 11:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try setting the working directory first to the same directory that contains the executable with SetOutPath.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Contex</span><br />
      <span class="post-time small text-muted">24th November 2007 11:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">InstallDir "$PROGRAMFILES\EA GAMES\Medal of Honor Allied Assault Breakthrough Demo\"<br />
      <br />
      Exec '"$INSTDIR\moh_breakthrough.exe" "parameter 1" "parameter 2"'<br />
      <br />
      So you mean I should place it in same directory as the "scanner" ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fluidz91</span><br />
      <span class="post-time small text-muted">14th January 2008 17:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>Try setting the working directory first to the same directory that contains the executable with SetOutPath.<br />
        <br />
        Stu</b>
      </blockquote>Damn ! that solved a problem i had launching an .exe on .onInstSuccess. The .exe i was trying to launch with Exec command was generating errors. If i ran manually the .exe no problem, so i created a batch file to launch installer then application. In the NSIS script, i was copying a file to a subdirectory of the application to launch, then tried to exec the .exe but got errors, i just added the red part to the script as below :<br />
      <pre>
<code><br /># Installer sections<br />Section -Main SEC0000<br />    SetOutPath $EXEDIR\SubDir<br />    SetOverwrite on<br />    File myfile.ext<br />SectionEnd<br /><br />Function .onInstSuccess<br />    <font color="red">SetOutPath $EXEDIR</font><br />    Exec '"App.exe"'<br />FunctionEnd<br /></code>
</pre><br />
      <br />
      And now it works like a charm.<br />
      <br />
      Hope that tip can help ppl in the future...<br />
      <br />
      Thx 4ever Afrow UK !<br />
      <br />
      Sorry for (very) explanation and (very) bad english ^^
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
