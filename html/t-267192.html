<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="create Database with NSIS" />

  <title>create Database with NSIS - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">create Database with NSIS</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267192">create Database with NSIS</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pozbremser</span><br />
      <span class="post-time small text-muted">5th March 2007 11:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>create Database with NSIS</strong><br />
      Hallo,<br />
      <br />
      I call msi for install SQL Server Express.<br />
      I have an mdf-file and backup-file of my database.<br />
      Is it possible create database with NSIS from mdf or backup-files or use sql-scripts?<br />
      <br />
      Thank You.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pafcosta</span><br />
      <span class="post-time small text-muted">7th March 2007 16:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      You have two possibilities.<br />
      One is use osql. This application is install with SQL SERVER. With this app you can exec sql scripts. For example:<br />
      ::SET VARIABLES<br />
      set DBNAME=NAMEOFDATABASEBEINGRESTORED<br />
      set DBDIRECTORY=C:\Program Files\Microsoft SQL Server\MSSQL\Data<br />
      <br />
      TITLE Restoring %DBNAME% Database<br />
      <br />
      ::PUT DATABASE IN SINGLE USER MODE TO ALLOW RESTORE<br />
      osql -E -d master -Q "alter database %DBNAME% set single_user with rollback immediate"<br />
      <br />
      ::RESTORE DATABASE<br />
      osql -E -d master -Q "restore database %DBNAME% from disk='%~dp0\%DBNAME%.bak' WITH MOVE '%DBNAME%_Data' TO '%DBDIRECTORY%\%DBNAME%_Data.MDF', MOVE '%DBNAME%_Log' TO '%DBDIRECTORY%\%DBNAME%_Log.LDF'"<br />
      <br />
      ::GRANT PERMISSION TO ASPNET USER<br />
      osql -E -d %DBNAME% -Q "sp_grantdbaccess '%COMPUTERNAME%\ASPNET'"<br />
      osql -E -d %DBNAME% -Q "sp_addrolemember 'db_owner', '%COMPUTERNAME%\ASPNET'"<br />
      <br />
      ::RESTORE TO MULTI USER<br />
      osql -E -d master -Q "alter database %DBNAME% set multi_user"<br />
      <br />
      pause<br />
      <br />
      The previous example you can find in:<br />
      <a href="http://weblogs.asp.net/jgalloway/archive/2005/12/02/432088.aspx" target="_blank">http://weblogs.asp.net/jgalloway/arc...02/432088.aspx</a><br />
      <br />
      <br />
      About the second option is do when you start the first time your application.<br />
      <br />
      I have one question to you about the &lt;B&gt;"I call msi for install SQL Server Express"&lt;/B&gt;. How you call? I trying to find a example, but without success.<br />
      <br />
      I hope this can help you.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pozbremser</span><br />
      <span class="post-time small text-muted">9th March 2007 11:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, pafcosta!<br />
      <br />
      osql was not with SQL Server Express.<br />
      <br />
      I use Microsoft Component Installer 2.0 SDK<br />
      for install the needed komponents:<br />
      <a href="http://www.microsoft.com/downloads/details.aspx?familyid=2A5E4EBC-651C-40AA-9525-1810AF47C317&amp;displaylang=en" target="_blank">http://www.microsoft.com/downloads/d...displaylang=en</a><br />
      <br />
      short futures:<br />
      <br />
      The SDK provides support for installing any or all of the following components:<br />
      <br />
      * Microsoft Windows Installer 2.0<br />
      * Microsoft Windows Installer 3.1<br />
      * Microsoft Data Access Components (MDAC) 2.8<br />
      * Microsoft .NET Framework 1.1 and language packs<br />
      * Microsoft .NET Framework 1.1 Service Pack 1<br />
      * Microsoft Visual J# runtime and language packs<br />
      * Microsoft .NET Framework 2.0 (x86) and language packs<br />
      * Microsoft Visual J# 2.0 runtime and language packs<br />
      * Microsoft DirectX 9.0c (December 2005 )<br />
      * Microsoft Report Viewer 2005 redistributable and language packs<br />
      * Microsoft Visual Studio 2005 Tools for the Microsoft Office System redistributable and language packs<br />
      * Microsoft SQL Server 2005 Express Edition redistributable<br />
      <br />
      then you call yours NSIS - Setup in the file PSetup.ini.<br />
      This file belongs to the Microsoft Component Installer 2.0 SDK<br />
      <br />
      PostInstallAction=your-nsis-setup.exe<br />
      <br />
      or you can extract msi-files of sqlserver.exe<br />
      i think this option is /r or \r bat not sure.<br />
      <br />
      and then call msi-files from NSIS-setup.<br />
      <br />
      You can call MSI with the line:<br />
      <br />
      Section -demo<br />
      ExecWait '"msiexec" /i "$EXEDIR\Demo.msi" /passive '<br />
      SectionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pafcosta</span><br />
      <span class="post-time small text-muted">9th March 2007 11:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>New option to Install SQL SERVER Express</strong><br />
      I found this in the internet yestarday.<br />
      Please see if this help you:<br />
      <a href="http://www.hoohee.com/PermaLink,guid,98f42375-f7bd-496a-95e0-0cd3a0b9e7ee.aspx" target="_blank">http://www.hoohee.com/PermaLink,guid...3a0b9e7ee.aspx</a><br />
      <br />
      Thanks<br />
      Paulo Costa</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sgiusto</span><br />
      <span class="post-time small text-muted">14th March 2007 12:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use sqlcmd (osql replacement in sql2005) or use the MSSQL plugin</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">astolfo</span><br />
      <span class="post-time small text-muted">9th January 2009 11:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">why I can't see the URL submitted by the users?<br />
      I'm Logged in</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">9th January 2009 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <b><i>astolfo wrote</i></b><br />
        why I can't see the URL submitted by the users?<br />
        I'm Logged in
      </blockquote>It's a spam prevention mechanism applied to new posters. (It's a pain, but I don't make the rules.) If you click the "reply" button, you can scroll down and see the URLs. Once you've posted enough times, your level changes and then you can submit URLs that others can actually see.<br />
      <br />
      Here's the link for the Microsoft Component Installer 2.0 SDK:<br />
      <a href="http://www.microsoft.com/downloads/details.aspx?familyid=2A5E4EBC-651C-40AA-9525-1810AF47C317&amp;displaylang=en" target="_blank">http://www.microsoft.com/downloads/d...displaylang=en</a>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Russell81</span><br />
      <span class="post-time small text-muted">26th March 2009 11:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can anyone give code example to "create database" with NSIS from metadata.txt? Idea is that first create a database then input the metadata. Please help me with nsis code example.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
