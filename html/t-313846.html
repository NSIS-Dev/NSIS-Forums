<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="InstDrv plug-in 64 bit"><title>InstDrv plug-in 64 bit - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">InstDrv plug-in 64 bit</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=313846">InstDrv plug-in 64 bit</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">yz6307</span><br><span class="post-time small text-muted">15th October 2009 12:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstDrv plug-in 64 bit</strong><br>hi,<br><br>I want my installer to enable to install 64 bit hardware drivers on 64 bit system. But "InstDrv plug-in" web page says the plug-in does not work to install drivers on a 64-bit Windows version.<br><br>So is there a solution to install drivers on 64 bit system?<br><br>Thanks in advance.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">yz6307</span><br><span class="post-time small text-muted">15th October 2009 23:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Can anyone help meï¼Ÿ</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cowwoc</span><br><span class="post-time small text-muted">16th October 2009 00:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by yz6307</i><br><b>Can anyone help meï¼Ÿ</b></blockquote>I'm wondering the same thing.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">yz6307</span><br><span class="post-time small text-muted">19th October 2009 10:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">no solutionï¼Ÿ</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">AxelMock</span><br><span class="post-time small text-muted">30th October 2009 11:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by yz6307</i><br><b>no solutionï¼Ÿ</b></blockquote>Yes and no.<br><br>I had the same problem, as I needed to write an installer for hardware device drivers for 32bit and 64bit OSes.<br><br>Microsoft recommends using DIFxAPI. DIFx is a nice framework with just 4 or 5 DLL functions to install/uninstall a driver.<br>For the 32bit version it's not too difficult to do the calls using the System plugin.<br>64bit: The 32bit installer CANNOT call any function in a 64bit DLL. There's definitely no trick or workaround for that!<br><br>So I ended up writing a wrapper EXE for DIFxAPI to be compiled twice by WINDKK, one for 32bit (Win2K buildenv) and one for 64bit (W2K3 64 buildenv) and calling the appropriate exe from my installer. The 64bit exe then calls the 64bit version of DIFxAPI.<br><br>Meanwhile the little wrapper does everything else/special we need to install/uninstall our drivers.<br>Sorry that I cannot share this code.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">AxelMock</span><br><span class="post-time small text-muted">30th October 2009 11:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I forgot to mention that Microsoft has a nice little example of how to use DIFxAPI which can be used to build such a 32/64 bit application in the Windows DDK.<br><br>c:\WinDDK\7600.16385.0\src\setup\DIFxAPI\DIFxCmd\<br><br>IMHO: Two functionality need to be added: ScanForHWChange<br>(Scan for Hardware changes, CM_Reenumerate_DevNode_Ex) like in the Device Manager and WaitWhileInstallationInProgess (CMP_WAITNOPENDINGINSTALLEVENTS_PROC from cfgmgr32.dll)<br><br>Vista (and above) provide the little command line tool pnputil.exe to enumerate, install and uninstall driver packages. Can nicely be called from NSIS.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>