<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Show register screen at the end of installation" />

  <title>Show register screen at the end of installation - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Show register screen at the end of installation</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=319509">Show register screen at the end of installation</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">adum</span><br />
      <span class="post-time small text-muted">28th May 2010 16:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Show register screen at the end of installation</strong><br />
      Hello folks,<br />
      <br />
      What I need is show a screen (something like a big MessageBox) to user when he finish the installation.<br />
      <br />
      This screen will contain an image (banner) on the top, a text asking for register on website, and a button "register now" on the bottom.<br />
      <br />
      I'm thinking to call a MessageBox on ".onGUIEnd", but i'm not sure if is possible add an image and resize to make it bigger, maybe the same size of an insall screens.<br />
      <br />
      Someone can help me on this one? ;)<br />
      <br />
      Thanks in advance!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">28th May 2010 16:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nsDialogs<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
      <span class="post-time small text-muted">28th May 2010 16:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Why not send the user directly on a web page ? (use ExecShell)<br />
      If that's too intrusive, you can have a checkbox on the last page "Register online" which sends the user to the web page</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">adum</span><br />
      <span class="post-time small text-muted">28th May 2010 17:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for quick replys guys!<br />
      <br /></p>

      <blockquote>
        <small>Originally posted by Afrow UK</small><br />
        nsDialogs<br />
        <br />
        Stu
      </blockquote>Got it.<br />
      But one question: Using nsDialogs, is it possible remove the "footer" that contain "Next", "Finish", and other buttons? I really need a clean page.<br />
      <br />
      <br />

      <blockquote>
        <small>Originally posted by Wizou</small><br />
        Why not send the user directly on a web page ? (use ExecShell)<br />
        If that's too intrusive, you can have a checkbox on the last page "Register online" which sends the user to the web page
      </blockquote>I'm already thought on it, but my client prefer this way =/
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">28th May 2010 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can hide the buttons, the branding text and the horizontal ruler (static) controls using ShowWindow &amp; ${SW_HIDE} (the control id's are in modern.exe; use Resource Hacker). If you want to then make the custom page fill the entire window you will have to resize the custom page rect (which is also in modern.exe) using SetWindowPos. All the controls are in modern.exe dialog 105.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">adum</span><br />
      <span class="post-time small text-muted">31st May 2010 14:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Afrow UK</small><br />
        You can hide the buttons, the branding text and the horizontal ruler (static) controls using ShowWindow &amp; ${SW_HIDE} (the control id's are in modern.exe; use Resource Hacker). If you want to then make the custom page fill the entire window you will have to resize the custom page rect (which is also in modern.exe) using SetWindowPos. All the controls are in modern.exe dialog 105.<br />
        <br />
        Stu
      </blockquote>Thanks for your help Stu, but I'm still having some issues to hide the controls.<br />
      I found the buttons id's, but i'm not sure how to use ShowWindow command.<br />
      For example, the id of Cancel button is 2. I will call ShowWindow on pre function, corrent?<br />
      I need to execute any other command before it?<br />
      And what is the correct syntax of ShowWindow? ShowWindow "2" ${SW_HIDE}
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">31st May 2010 15:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by adum</small><br />
        Thanks for your help Stu, but I'm still having some issues to hide the controls.<br />
        I found the buttons id's, but i'm not sure how to use ShowWindow command.<br />
        For example, the id of Cancel button is 2. I will call ShowWindow on pre function, corrent?<br />
        I need to execute any other command before it?<br />
        And what is the correct syntax of ShowWindow? ShowWindow "2" ${SW_HIDE}
      </blockquote>As you can read in the ShowWindow manual entry:<br />
      <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.14.17" target="_blank">http://nsis.sourceforge.net/Docs/Cha...html#4.9.14.17</a><br />
      ...ShowWindow requires the control's HWND, not a control id, as a parameter.<br />
      <br />
      <br />
      You can use the GetDlgItem command to get a HWND from an ID: <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.14.6" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.14.6</a>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">adum</span><br />
      <span class="post-time small text-muted">9th June 2010 18:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks a lot guys, this works.. But unfortunately it will be useless, because the customer ask to add a checkbox on the last screen... oO<br />
      <br />
      This is a bit easier, if don't has a detail:<br />
      Some steps before, the user selects the store where he bought the disk, and depending the store, the checkbox will be showed or not.<br />
      <br />
      Is it possible control the !define's on runtime? Depending the store selected (using something like StrCmp), checkbox will be showed or not?<br />
      <br />
      If not, what I think to do now is hide this checkbox using ShowWindow &amp; ${SW_HIDE}, but I can't find the finish screen to get checkbox ID. Where the finish screen is located?<br />
      <br />
      Thanks one more time =]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">9th June 2010 21:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Look in Contrib\Modern UI 2\Pages\Finish.nsh. The finish page is made with nsDialogs and there will be a dedicated variable containing its handle.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">adum</span><br />
      <span class="post-time small text-muted">10th June 2010 15:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nice, I find it. But how can I recover the variable to manipulate on my script?<br />
      <br />
      I'm trying to do something like this:<br /></p>
      <pre>
<code><br />!define MUI_PAGE_CUSTOMFUNCTION_PRE PreFinishFunction<br />!insertmacro MUI_PAGE_FINISH<br /><br />Function PreFinishFunction<br />    StrCmp $STORE "StoreName" hide show ;check if checkbox will show or not<br />    hide:<br />    ShowWindow $mui.Finishpage.Run ${SW_HIDE}<br />    show:<br />FunctionEnd<br /></code>
</pre><br />
      <br />
      But mui.Finishpage.Run was unknown. Any idea?<br />
      <br />
      Aditionally, when the checkbox is hided, i need to uncheck it or hide is enough? Case I need to uncheck, how can I do this? Using SendMessage?<br />
      <br />
      Thanks one more time =]
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">10th June 2010 17:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use a SHOW function not a PRE.<br />
      <br />
      Edit: nsDialogs has a macro to check/uncheck. You need to do it yes.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">adum</span><br />
      <span class="post-time small text-muted">10th June 2010 18:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok, i have changed to SHOW function.<br />
      I have one more issue. Problably the last one.. ^^<br />
      <br />
      How can I "get" the checkbox ?<br />
      To use NSD_Uncheck and ShowWindow I need the HWND. I know how to get it when I have the control ID, but in this case I haven't the id =/</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">10th June 2010 19:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You seem to have ignored or misunderstood what I said. $mui.FinishPage.Run DOES contain the handle to the check box. Also you can't expect it to work in a pre function (MUI_PAGE_CUSTOMFUNCTION_PRE) because that is before the page is created. You want MUI_PAGE_CUSTOMFUNCTION_SHOW.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">adum</span><br />
      <span class="post-time small text-muted">10th June 2010 20:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Now i'm feeling a noob.. lol<br />
      Maybe I'm not so specific in my question. I have understood why use SHOW function, not PRE.<br />
      My issue is the follow: when I call ShowWindow to hide checkbox, the parameter I need to pass is mui.FinishPage.Run, correct? THis way:</p>
      <pre>
<code>ShowWindow $mui.Finishpage.Run ${SW_HIDE}</code>
</pre><br />
      <br />
      But when I compile the script, it show me a warning, probably because this var is for finish.nsh, not mine:<br />
      Unknow variable/constant mui.FinishPage.Run<br />
      <br />
      I need to do anything before use it? Need to retrieve it?<br />
      <br />
      Sorry to annoy you so much, but i'm very confused at this point..
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">10th June 2010 22:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Variables in NSIS are global. Perhaps you are using MUI not MUI2?<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">adum</span><br />
      <span class="post-time small text-muted">11th June 2010 15:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh crap... In fact I'm using MUI (not MUI2)...<br />
      <br />
      Is it possible do this on MUI? I'm using some ini files, and will be a pain change all my scripts(it's more than one I need to do this change)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">11th June 2010 16:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Read the section "To upgrade a Modern UI 1.8 script, you should" in the MUI2 readme.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">adum</span><br />
      <span class="post-time small text-muted">14th June 2010 14:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Finally it works<br />
      <br />
      Thanks a lot for your help guys, specially you Stu =]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">14th June 2010 15:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No problem :)<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
