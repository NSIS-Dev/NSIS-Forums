<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="PreSelect a component by language"><title>PreSelect a component by language - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">PreSelect a component by language</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267375">PreSelect a component by language</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">dbach</span><br><span class="post-time small text-muted">8th March 2007 12:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>PreSelect a component by language</strong><br>Hi together.<br><br>I've got a problem. I've have templates to install. Only one template should be selectable at once (problem solved). The other thing is that the installer should check which Language the system has and preselect the correct template for the user. I've startet with the following code:<br><br></p><pre>
<code><br>var PreSelect<br><br>[... in the .oninit function ...]<br>StrCmp $LANGUAGE ${LANG_FRENCH} 0 +3<br>StrCpy $PreSelLang ${template_french}<br>goto PreSelectEnd<br><br>StrCmp $LANGUAGE ${LANG_GERMAN} 0 +3<br>StrCpy $PreSelLang ${template_german}<br>goto PreSelectEnd<br><br>StrCmp $LANGUAGE ${LANG_ITALIAN} 0 +3<br>StrCpy $PreSelLang ${template_italian}<br>goto PreSelectEnd<br><br>StrCmp $LANGUAGE ${LANG_SPANISH} 0 PreSelectEnd<br>StrCpy $PreSelLang ${template_spanish}<br>goto PreSelectEnd<br><br>StrCpy $PreSelLang ${template_english}<br>goto PreSelectEnd<br><br>PreSelectEnd:<br><br>[... the sections ...]<br>SectionGroup "Template language" templates<br>  Section /o "English" templates_english<br>  [stuff]<br>  SectionEnd<br><br>  Section /o "German" templates_german<br>  [stuff]<br>  SectionEnd<br><br>  Section /o "French" templates_french<br>  [stuff]<br>  SectionEnd<br><br>  Section /o "Italian" templates_italian<br>  [stuff]<br>  SectionEnd<br><br>  Section /o "Spanish" templates_spanish<br>  [stuff]<br>  SectionEnd<br>SectionGroupEnd<br><br><br>.... and ...<br><br>Function .onSelChange<br># EN, DE, IT, ES, FR<br>  !insertmacro StartRadioButtons $PreSelLang<br>    !insertmacro RadioButton ${templates_english}<br>    !insertmacro RadioButton ${templates_french}<br>    !insertmacro RadioButton ${templates_german}<br>    !insertmacro RadioButton ${templates_italian}<br>    !insertmacro RadioButton ${templates_spanish}   <br>  !insertmacro EndRadioButtons<br>FunctionEnd<br><br></code>
</pre><br>
      <br>
      What am I doing wrong? THe Buttons are RadioButtons but whatever language I have nothing is preselected. Any ideas? Thanks.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">onad</span><br>
      <span class="post-time small text-muted">8th March 2007 12:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">TIP:<br>
      <br>
      Note that OS GUI language has nothing to do with the Targetcountry of your installer, make sure you do not confuse Language with Country, e.g. a person could have an Spanish OS GUI langiage but still have his country set to United States, since he/she lives there but prefers Spanish as OS language.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dbach</span><br>
      <span class="post-time small text-muted">8th March 2007 13:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi onad,<br>
      <br>
      thanks for the tip. I almost forgot to post the following lines which are also in my Installer:<br></p>
      <pre>
<code>System::Call "kernel32::GetUserDefaultLangID()i .r0"<br>StrCpy $LANGUAGE $0<br></code>
</pre><br>
      So the Regional Settings should be used.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
      <span class="post-time small text-muted">8th March 2007 17:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>LoadLanguageFile "${NSISDIR}\Contrib\Language files\English.nlf"<br>LoadLanguageFile "${NSISDIR}\Contrib\Language files\French.nlf"<br>LoadLanguageFile "${NSISDIR}\Contrib\Language files\German.nlf"<br>LoadLanguageFile "${NSISDIR}\Contrib\Language files\Italian.nlf"<br>LoadLanguageFile "${NSISDIR}\Contrib\Language files\Spanish.nlf"<br><br>!include "LogicLib.nsh"<br>!include "Sections.nsh"<br><br>outfile 'test.exe'<br><br>Var PreSelLang<br><br>Page Components<br>Page InstFiles<br><br>SectionGroup /e "Template language" templates<br>  Section /o "English" templates_english<br>;  [stuff]<br>  SectionEnd<br><br>  Section /o "German" templates_german<br>;  [stuff]<br>  SectionEnd<br><br>  Section /o "French" templates_french<br>;  [stuff]<br>  SectionEnd<br><br>  Section /o "Italian" templates_italian<br>;  [stuff]<br>  SectionEnd<br><br>  Section /o "Spanish" templates_spanish<br>;  [stuff]<br>  SectionEnd<br>SectionGroupEnd<br><br>Function .onInit<br>System::Call "kernel32::GetUserDefaultLangID()i .r0"<br>StrCpy $LANGUAGE $0<br><br>${if} $LANGUAGE == ${LANG_FRENCH}<br>!insertmacro SelectSection ${templates_french}<br>StrCpy $PreSelLang ${templates_french}<br><br>${elseif} $LANGUAGE == ${LANG_GERMAN}<br>!insertmacro SelectSection ${templates_german}<br>StrCpy $PreSelLang ${templates_german}<br><br>${elseif} $LANGUAGE == ${LANG_ITALIAN}<br>!insertmacro SelectSection ${templates_italian}<br>StrCpy $PreSelLang ${templates_italian}<br><br>${elseif} $LANGUAGE == ${LANG_SPANISH}<br>!insertmacro SelectSection ${templates_spanish}<br>StrCpy $PreSelLang ${templates_spanish}<br><br>${else}<br>!insertmacro SelectSection ${templates_english}<br>StrCpy $PreSelLang ${templates_english}<br>${endif}<br><br>MessageBox MB_OK "$$0 = $0 - $$LANGUAGE = $LANGUAGE - $$PreSelLang = $PreSelLang"<br>FunctionEnd<br><br>Function .onSelChange<br># EN, DE, IT, ES, FR<br>  !insertmacro StartRadioButtons $PreSelLang<br>    !insertmacro RadioButton ${templates_english}<br>    !insertmacro RadioButton ${templates_french}<br>    !insertmacro RadioButton ${templates_german}<br>    !insertmacro RadioButton ${templates_italian}<br>    !insertmacro RadioButton ${templates_spanish}<br>  !insertmacro EndRadioButtons<br>FunctionEnd</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dbach</span><br>
      <span class="post-time small text-muted">9th March 2007 08:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks RedWine - this works. Now I have to solve another problem. My onInit function is before my sections. When I move my oninit function after the section the installers starts again and again and again (3 times before the first dialog appears). I have to investigate to solve this problem. Thanks again :)</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>