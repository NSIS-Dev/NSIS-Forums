<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Font" />

  <title>Font - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" Font" />

  <title>Font - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Font</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=79586">Font</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ghale</span><br />
      <span class="post-time small text-muted">17th March 2002 10:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Font</strong><br />
      Hi!<br />
      <br />
      Ok, I create an installer that include a font.<br />
      I install font to target machine.<br />
      <br />
      But!:eek:<br />
      <br />
      The font is not "registered(?)" in Windows automatically.<br />
      <br />
      I have to manually open and close Fonts Dir with Control Panel.<br />
      <br />
      What can I do to install a font and "register" it with Windows automagically?<br />
      <br />
      Sorry for my english,<br />
      I speak only Italiano (and not so very well).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">26th March 2002 02:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i'm not 100% sure since i didn't test it, but try the following (i used example Time New Roman):<br />
      <br />
      Windows NT/2000/XP<br /></p>
      <pre>
<code>WriteRegStr HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts" \<br />"Times New Roman (TrueType)" "TIMES.TTF"</code>
</pre><br />
      <br />
      Windows 95/98/ME<br />
      <pre>
<code>WriteRegStr HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Fonts" \<br />"Times New Roman (TrueType)" "TIMES.TTF"</code>
</pre><br />
      <br />
      you can use the GetWindowsVersion function (see NSIS\functions.htm) to determine the windows version.<br />
      <br />
      hope it works, let us know :p
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ghale</span><br />
      <span class="post-time small text-muted">28th March 2002 09:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, yes. It works!!!:)<br />
      Thank you.<br />
      After writing keys in registry, I need to reboot machine.<br />
      <br />
      After, I find all fonts ready for applications!!!<br />
      <br />
      Thank you!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">28th March 2002 16:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is a way of doing this without requiring a reboot.<br />
      This way involves Windows' API calls so you will need an external DLL or EXE.<br />
      <br />
      First you need to call AddFontResource(lpszFilename) with the font's file name (for example: AddFontResource("TIMES.TTF"). Next you need to broadcast a message so all of the runnint applications will reload the system font table. To do so, you should use PostMessage(HWND_BROADCAST, WM_FONTCHANGE, 0, 0).<br />
      <br />
      If you need any help writing the DLL/EXE let me know.<br />
      <br />
      KiCHiK<br />
      <br />
      <i>EDIT:</i> If you are building an uninstaller too you will need to use RemoveFontResource(lpszFilename), and manually delete the registry entry. You will also need to send another WM_FONTCHANGE message.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ghale</span><br />
      <span class="post-time small text-muted">28th March 2002 23:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Font</strong><br />
      :weird: I need a DLL to call AddFontResource("TIMES.TTF") and PostMessage(HWND_BROADCAST, WM_FONTCHANGE, 0, 0).<br />
      <br />
      Ok.<br />
      <br />
      I can use some NSIS function to do the same thing?<br />
      <br />
      Sorry, but I have no idea on writing a DLL making this...:cry:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th March 2002 10:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Don't worry, be happy :D<br />
      <br />
      Attached is the DLL + source.<br />
      <br />
      To use it in your installation add the following code:<br /></p>
      <pre>
<code>GetTempFileName$R0
<br />File</code><span style="color: #007700">/</span><span style="color: #0000BB">oname</span><span style="color: #007700">=</span><span style="color: #0000BB">$R0fonts</span><span style="color: #007700">.</span><span style="color: #0000BB">dll
<br /></span><span style="color: #007700">;</span><span style="color: #0000BB">Changethislinetoyourrealfontname</span><span style="color: #007700">.
<br />;If</span><span style="color: #0000BB">itisnotinthe</span><span style="color: #007700">default</span><span style="color: #0000BB">Windows</span><span style="color: #DD0000">'directorywirteit'</span><span style="color: #0000BB">sfullpath</span><span style="color: #007700">!
<br /></span><span style="color: #0000BB">Push</span><span style="color: #DD0000">"MyFontName.TTF"
<br /></span><span style="color: #0000BB">CallInstDLL$R0registerFont
<br /></span>

<!-- php buffer end -->
                
                
                
</pre>
      <hr />
      <pre>
        
To use it in your uninstallation add the following code:<br />        
</pre>
      <pre>
<code>GetTempFileName$R0
<br />File</code><span style="color: #007700">/</span><span style="color: #0000BB">oname</span><span style="color: #007700">=</span><span style="color: #0000BB">$R0fonts</span><span style="color: #007700">.</span><span style="color: #0000BB">dll
<br /></span><span style="color: #007700">;</span><span style="color: #0000BB">Changethislinetoyourrealfontname</span><span style="color: #007700">.
<br />;If</span><span style="color: #0000BB">itisnotinthe</span><span style="color: #007700">default</span><span style="color: #0000BB">Windows</span><span style="color: #DD0000">'directorywirteit'</span><span style="color: #0000BB">sfullpath</span><span style="color: #007700">!
<br /></span><span style="color: #0000BB">Push</span><span style="color: #DD0000">"MyFontName.TTF"
<br /></span><span style="color: #0000BB">CallInstDLL$R0unregisterFont
<br /></span>
</pre>
      <pre>

        
These functions only call AddFontResource/RemoveFontResource and PostMessage so don't forget to copy/delete the font yourself and add/remove it from the registry.<br /><br />KiCHiK
                
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cchian</span><br />
      <span class="post-time small text-muted">3rd May 2002 04:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Kichik,<br />
      <br />
      Your code and dll works great, but how do you make it register more than one font? Will this work?:<br />
      <br />
      GetTempFileName $R0<br />
      File /oname=$R0 fonts.dll<br />
      ; Change this line to your real font name.<br />
      ; If it is not in the default Windows' directory write it's full path!<br />
      Push "Font1.TTF"<br />
      CallInstDLL $R0 registerFont<br />
      Push "Font2.TTF"<br />
      CallInstDLL $R0 registerFont<br />
      Push "Font3.TTF"<br />
      CallInstDLL $R0 registerFont<br />
      Push "Font4.TTF"<br />
      CallInstDLL $R0 registerFont</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd May 2002 11:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Your code should work just fine.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">10th July 2002 18:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">did not work in nsis 2.0 alpha :(</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th July 2002 19:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Could you be a little bit more specific please?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">10th July 2002 21:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just to remind you: NSIS 2.0a0 is not free of bugs! The latest supported and official version is NSIS 1.98. I suggest that you use that one for compiling your scripts.<br />
      <br />
      -Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ParallaxTZ</span><br />
      <span class="post-time small text-muted">20th July 2002 16:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I followed all the instructions above, but when I run the installer, this happens:<br />
      <br />
      rosInst.exe - Bad Image<br />
      The application or DLL G:\Documen~1\Markri~Locals~1\Tempnst964.tmp is not a valid Windows image. Please check this against your installation disk.<br />
      <br />
      my script file is attached.<br />
      <br />
      Any help would be most appreciated.<br />
      <br />
      [edit]<br />
      I'm on an XP Pro system.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th July 2002 18:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you using using about NSIS 2 or 1.98/9?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ParallaxTZ</span><br />
      <span class="post-time small text-muted">20th July 2002 18:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I used both 1.96 and now 1.98.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th July 2002 18:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please try the attached script and tell me which messages you get.<br />
      Don't forget to change the file extension to .nsi.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">20th July 2002 22:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by ParallaxTZ</i><br />
        <b>I followed all the instructions above, but when I run the installer, this happens:<br />
        <br />
        rosInst.exe - Bad Image<br />
        The application or DLL G:\Documen~1\Markri~Locals~1\Tempnst964.tmp is not a valid Windows image. Please check this against your installation disk.<br />
        <br />
        my script file is attached.<br />
        <br />
        Any help would be most appreciated.<br />
        I'm on an XP Pro system.</b>
      </blockquote>

      <blockquote>
        GetTempFileName $R0<br />
        File /oname=$R0 G:\windows\system32\fonts.dll<br />
        Push "MAEL____.TTF"<br />
        CallInstDLL $R0 registerFont
      </blockquote>You are using GetTempFileName. This creates the temp file. The File command does not overwrite the file created by GetTempFileName, that's why the DLL does not work.<br />
      <br />
      You should SetOverwrite On before the File command.<br />
      <br />

      <blockquote>
        GetTempFileName $R0<br />
        SetOverwrite On<br />
        File /oname=$R0 G:\windows\system32\fonts.dll<br />
        SetOverwrite ifnewer<br />
        Push "MAEL____.TTF"<br />
        CallInstDLL $R0 registerFont
      </blockquote>I have not tested this ;)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ParallaxTZ</span><br />
      <span class="post-time small text-muted">21st July 2002 04:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks to both of you, but only Joost's fix worked. Thanks again, no more restarts after my installer, YAY! :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">2nd August 2002 20:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i had no errors during the compilation, but it just didnt install or copy the fonts. maybe i am stupid, could you please paste some code doing this with a common windows font, so it will work in my code only copy+pasted? pleeease ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd August 2002 20:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">All of the code you need to copy+paste it up there :up:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ParallaxTZ</span><br />
      <span class="post-time small text-muted">4th August 2002 16:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Attached is my .nsi file (.zipped since you can't upload .nsi files), it appears to work perfectly for both 9x based and NT based systems. Hopefully you can follow it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">4th August 2002 16:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">can i use the same .dll to uninstall the font again? it would surely be better -even for testing purposes- to remove the font everytime for the system i'm testing on. so far i had to send all installers to friends, which consumes quite some time. uninstalling would be a great help!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">4th August 2002 16:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use the same DLL for uninstalling... Please check the code above...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">6th September 2002 13:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">is it necessary to use that .dll for old .fon fonts, or can i just copy them without registering them?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">6th September 2002 14:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As far as I know you should register them too.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">6th September 2002 18:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Reminder</strong><br />
      Just a little reminder that since NSIS 2.0a4 you can make this kinda thing:-</p>
      <pre>
<code>GetTempFileName$R0
<br />File</code><span style="color: #007700">/</span><span style="color: #0000BB">oname</span><span style="color: #007700">=</span><span style="color: #0000BB">$R0fonts</span><span style="color: #007700">.</span><span style="color: #0000BB">dll
<br />Push</span><span style="color: #DD0000">"Font1.TTF"
<br /></span><span style="color: #0000BB">CallInstDLL$R0registerFont
<br />Push</span><span style="color: #DD0000">"Font2.TTF"
<br /></span><span style="color: #0000BB">CallInstDLL$R0registerFont
<br />Push</span><span style="color: #DD0000">"Font3.TTF"
<br /></span><span style="color: #0000BB">CallInstDLL$R0registerFont
<br />Push</span><span style="color: #DD0000">"Font4.TTF"
<br /></span><span style="color: #0000BB">CallInstDLL$R0registerFont
<br /></span>
</pre>much simpler:-
      <pre>
<code>fonts</code><span style="color: #007700">::</span><span style="color: #0000BB">registerFont</span><span style="color: #DD0000">"Font1.TTF"
<br /></span><span style="color: #0000BB">fonts</span><span style="color: #007700">::</span><span style="color: #0000BB">registerFont</span><span style="color: #DD0000">"Font2.TTF"
<br /></span><span style="color: #0000BB">fonts</span><span style="color: #007700">::</span><span style="color: #0000BB">registerFont</span><span style="color: #DD0000">"Font3.TTF"
<br /></span><span style="color: #0000BB">fonts</span><span style="color: #007700">::</span><span style="color: #0000BB">registerFont</span><span style="color: #DD0000">"Font4.TTF"
</span>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br />
      <span class="post-time small text-muted">9th December 2002 18:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry to bring up and old topic, but...<br />
      <br />
      I'm still not clear on how to register a font without rebooting... :confused:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">9th December 2002 19:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Put Fonts.dll in your Plugins directory.<br />
      After you copy the font over and write the registry entries, just call Fonts::registerFont "FontName"<br />
      If you have installed the font in the Windows font folder, just use its name (times.ttf for example), if not use its full path ($INSTDIR\times.ttf for example).<br />
      <br />
      That's it, the font is then registered, and you don't need a reboot.<br />
      <br />
      For the uninstaller, remove the registry entries, call Fonts::unregisterFont "FontName" and delete the font.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br />
      <span class="post-time small text-muted">9th December 2002 19:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I can't find Fonts.dll, is fontreg.exe the same thing? It seems to work okay compiling...<br />
      <br />
      fyi I'm running Win98 SE.<br />
      <br />
      Am I right in assuming that I need to put the GetWindowsVersion function at the top of the script, and use something along the lines of ParalaxTZ's script:<br /></p>
      <pre>
<code>Section</code><span style="color: #DD0000">"Adolescensefont"
<br /></span><span style="color: #0000BB">SectionIn4
<br />RegisterFonts</span><span style="color: #007700">:
<br /></span><span style="color: #0000BB">StrCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">'95'</span><span style="color: #0000BB">lbl_95_98_me
<br />StrCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">'98'</span><span style="color: #0000BB">lbl_95_98_me
<br />StrCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">'ME'</span><span style="color: #0000BB">lbl_95_98_me
<br /><br />lbl_nt_2k_xp</span><span style="color: #007700">:
<br /></span><span style="color: #0000BB">WriteRegStrHKEY_LOCAL_MACHINE</span><span style="color: #DD0000">"SOFTWARE\Microsoft\WindowsNT\CurrentVersion\Fonts""Adolescense""Adolesce.TTF"
<br /><br /></span><span style="color: #0000BB">lbl_95_98_me</span><span style="color: #007700">:
<br /></span><span style="color: #0000BB">WriteRegStrHKEY_LOCAL_MACHINE</span><span style="color: #DD0000">"SOFTWARE\Microsoft\Windows\CurrentVersion\Fonts""Adolescense""Adolesce.TTF"
</span>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">9th December 2002 19:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Never heard of font reg... A zip file containing fonts.dll is attached above in one of my posts...<br />
      <br />
      To add the registry writing you must call GetWindowsVersion (find it in the useful functions section in the docs), Pop and compare like in the script you just wrote. Then call registerFont like I said in the earlier post.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br />
      <span class="post-time small text-muted">9th December 2002 19:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanx, didn't see that.<br />
      <br />
      Now I'm getting an error message:<br />
      WriteRegStr: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts\Adolescense=Adolesce.TTF<br />
      WriteRegStr: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Fonts\Adolescense=Adolesce.TTF<br />
      Invalid command: fonts::registerfont<br />
      Error in script "C:\NSIS\tff2.0\custom.nsi" on line 229 -- aborting creation process<br />
      <br />
      This is the end of my script:<br />
      <br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #0000BB">lbl_nt_2k_xp</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">WriteRegStrHKEY_LOCAL_MACHINE</span><span style="color: #DD0000">"SOFTWARE\Microsoft\WindowsNT\CurrentVersion\Fonts""Adolescense""Adolesce.TTF"<br />
      <br /></span> <span style="color: #0000BB">lbl_95_98_me</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">WriteRegStrHKEY_LOCAL_MACHINE</span><span style="color: #DD0000">"SOFTWARE\Microsoft\Windows\CurrentVersion\Fonts""Adolescense""Adolesce.TTF"<br />
      <br /></span> <span style="color: #0000BB">fonts</span><span style="color: #007700">::</span><span style="color: #0000BB">registerfont</span><span style="color: #DD0000">"Adolesce.TTF"<br />
      <br /></span> <span style="color: #0000BB">SectionEnd<br /></span><br />
      <br /></span>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">9th December 2002 20:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Put Fonts.dll in your Plugins directory.
      </blockquote>If you don't have a plugins directory you either installed a minimal version of NSIS or you are not using NSIS 2.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br />
      <span class="post-time small text-muted">9th December 2002 20:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oops. I thought you were talking about the Winamp plugins directory :p<br />
      <br />
      But I'm still getting the same error message. Is this code wrong?<br />
      <br />
      SetOutPath "$WINDIR\system32\"<br />
      File "c:\nsis\plugins\Fonts.dll"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">9th December 2002 21:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">First, make sure you got the latest NSIS 2 version, beta 0. You can download it from <a href="http://prdownloads.sourceforge.net/nsis/nsis20b0.exe?download." target="_blank">http://prdownloads.sourceforge.net/n....exe?download.</a><br />
      <br />
      Now copy fonts.dll to the Plugins dir of NSIS (that is a directory on the system where NSIS is installed). Usually the path is C:\Program Files\NSIS\Plugins.<br />
      <br />
      NSIS will detect your plugin and you can use fonts::registerFont in your NSIS script. NSIS handles the extracting, deleting etc. of the file. There is nothing else where you have to worry about.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br />
      <span class="post-time small text-muted">9th December 2002 22:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have the latest NSIS2. I'm still getting an error message when I compile that says fonts::registerfont is an invalid function.<br />
      <br />
      I'll try rebooting...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br />
      <span class="post-time small text-muted">9th December 2002 22:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Didn't work. Where does the DLL have to be in relation to the .NSI file, and where does the .NSI file have to be in relation to the NSIS installation path?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">9th December 2002 22:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The DLL should be copied to the NSIS Plugins directory of YOUR system. That is the subdirectory 'Plugins' in the directory of the NSIS installation. You don't have to worry about extracting it on the user's system, NSIS does everything for you.<br />
      <br />
      At the beginning of the NSIS compiler output, you can see a list of all detected plugins.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br />
      <span class="post-time small text-muted">10th December 2002 06:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Okay, so it doesn't matter where the .NSI file is, I take it...?<br />
      <br />
      I'm gonna post my script here. I'm also having troubles with the instdir page not having the default path...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th December 2002 14:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's not a NSIS 2.0b0 script, it has .onNextPage and .onPrevPage in it. If you are sure it is supposed to work with b0 notify Jheriko that it is highly out of date.<br />
      <br />
      When you compile the script do you see on the top of the output after the credits stuff a list that starts with:<br />
      <br />
      Processing plugin dlls: "&lt;nsis dir&gt;\plugins\*.dll"<br />
      <br />
      ?<br />
      <br />
      If you don't see that line and a list after it you are not using NSIS 2.0b0. If you do, do you see fonts::registerFont there? If it is there, try copying the line exactly as it is and paste into the script, then see if you get errors (don't forget to add the font name if it works). If there is a list and fonts::registerFont is not there you didn't put fonts.dll in the right directory (use !error "${NSISDIR}\Plugins" in any script to see what it is).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br />
      <span class="post-time small text-muted">10th December 2002 18:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ooookay...I'm gonna tell Jheriko that, after I smack the fuckin shit out of him.<br />
      <br />
      The script compiles to fast for me to read anything at the top, so I wouldn't know<br />
      <br />
      <br />
      Anyway, thanx, sorry for all the trouble :rolleyes:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th December 2002 18:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Aren't you using MakeNSISw? It's a windows wrapper for NSIS that comes with NSIS. Just right click a script and choose Compile NSI. If you still get a DOS box you are not using NSIS 2 for sure.</p>
    </div>
    <hr />
    <!-- Bootstrap core CSS -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <div class="container">
      <!-- Put navigation bar here -->

      <ol class="breadcrumb">
        <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

        <li><a href="f-65.html">NSIS Discussion</a></li>

        <li class="active">Font</li>
      </ol>

      <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=79586">Font</a></p><br />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br />
        <span class="post-time small text-muted">10th December 2002 18:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I am, but the wrapper kept crashing for inexplicable reasons...That, and I still couldn't read the whole thing with the wrapper.<br />
        <br />
        Anyway, I just figured out how to log the output, and did. I read the .dll plugin functions listing and - guess what - fonts<b>.DLL</b>::registerfont.<br />
        Gee, thanx for not ever telling me that, guys :rolleyes:</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
        <span class="post-time small text-muted">10th December 2002 18:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Are you or are you not using NSIS 2.0b0?<br />
        MakeNSISw crashes, .dll after plug-in names, and .onNextPage and .onPrevPage are all from a7 and below.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br />
        <span class="post-time small text-muted">10th December 2002 19:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Absolutely sure. But the problem's fixed now, I'm movin on...</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
        <span class="post-time small text-muted">10th December 2002 19:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Maybe you are ready to move on, but I am not after you are telling me MakeNSISw crashes and plug-in detection doesn't occur as should.<br />
        <br />
        Please attach a screen shot of MakeNSISw crash.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br />
        <span class="post-time small text-muted">10th December 2002 19:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">The plugin detection happens, I just can't see it unless I log it. I'd rather not post a screenshot, because it really is a lot of trouble for me on this computer (and *DON'T* suggest programs I download, I've already been through that a million times, the answer is still 'THEY WON'T WORK!')</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
        <span class="post-time small text-muted">10th December 2002 19:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Can you at least attach the log?</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
        <span class="post-time small text-muted">10th December 2002 20:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I think you are using an old development snapshot which has the beta 0 label. That is not the final beta 0 release, which has been released a few days ago.<br />
        <br />
        Please download the final release at <a href="http://prdownloads.sourceforge.net/nsis/nsis20b0.exe?download" target="_blank">http://prdownloads.sourceforge.net/n...0.exe?download</a></p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br />
        <span class="post-time small text-muted">10th December 2002 21:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Okay, thanx joost</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
        <span class="post-time small text-muted">10th December 2002 22:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Is the filename of your script really "c:\nsis\tff2/0\tff2.0.nsi.nsi" ?</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br />
        <span class="post-time small text-muted">11th December 2002 07:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Whoah...didn't see that. That'd explain a couple things....</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
        <span class="post-time small text-muted">11th December 2002 14:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>

        <blockquote>
          MakeNSIS v2.0a7 - Copyright 1999-2002 Nullsoft, Inc.
        </blockquote>Your log clearly shows you are using NSIS 2.0a7. Install NSIS 2.0b0 from <a href="http://nsis.sf.net/" target="_blank">http://nsis.sf.net/</a> and all of the problems above will be gone.
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Mottel</span><br />
        <span class="post-time small text-muted">12th December 2002 04:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Re Fonts.dll</strong><br />
        Kichik, that fonts.dll that you posted looks like a very useful addon to NSIS. I will be using it myself eventually. You should include it in the Plugins dir on CVS so it will come standard with future downloads, but, I would suggest you call it RegisterFont.DLL.<br />
        /Edit/<br />
        P.S. BTW, FontReg.exe is a Microsoft program in the $SYSDIR of Win98. Looking at the strings in the file, I see that: (a) it describes itself as "Font Sweeper Application" (??) and, (b) from the function names, I'd say it's a fair bet that it does the same thing as your DLL, but is specific to Win98 (and maybe 95 and ME).<br />
        /Edit2/<br />
        Maybe not. I've just been playing with it, and it doesn't seem to do what I thought it did.<br /></p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Kypec</span><br />
        <span class="post-time small text-muted">12th December 2002 13:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Include fonts.dll by default</strong><br />
        I agree with Mottel, please<br />
        include kichik's <b>fonts.dll</b> as<br />
        the standard plugin in Plugins\<br />
        directory for all future releases, thanx.<br />
        <br />
        Kypec</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
        <span class="post-time small text-muted">12th December 2002 14:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">It's just a singe API call, so you can also use the System plugins which is already included.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br />
        <span class="post-time small text-muted">21st December 2002 08:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">One last round on this thread and I'm done, I promise :D<br />
        <br />
        I have now (almost) completed my installer. However when I run it and install the font, I get an error message saying "Could not find symbol: registerfont". I sent it to a friend and he got the same thing.<br />
        <br />
        Here's the font section of the installer:<br /></p>
        <pre>
<code>Section</code><span style="color: #DD0000">"Adolescensefont(reccommended)"
<br /></span><span style="color: #0000BB">SectionIn12
<br /><br />SetOutPath</span><span style="color: #DD0000">"$WINDIR\fonts\"
<br />File"</span><span style="color: #0000BB">c</span><span style="color: #007700">:</span><span style="color: #0000BB">windowsfontsAdolesce</span><span style="color: #007700">.</span><span style="color: #0000BB">TTF</span><span style="color: #DD0000">"
<br /><br />RegisterFonts:
<br />StrCmp$0'95'lbl_95_98_me
<br />StrCmp$0'98'lbl_95_98_me
<br />StrCmp$0'ME'lbl_95_98_me
<br /><br />lbl_nt_2k_xp:
<br />WriteRegStrHKEY_LOCAL_MACHINE"</span><span style="color: #0000BB">SOFTWAREMicrosoftWindowsNTCurrentVersionFonts</span><span style="color: #DD0000">""</span><span style="color: #0000BB">Adolesce</span><span style="color: #007700">.</span><span style="color: #0000BB">TTF</span><span style="color: #DD0000">""</span><span style="color: #0000BB">Adolescense</span><span style="color: #DD0000">"
<br /><br />lbl_95_98_me:
<br />WriteRegStrHKEY_LOCAL_MACHINE"</span><span style="color: #0000BB">SOFTWAREMicrosoftWindowsCurrentVersionFonts</span><span style="color: #DD0000">""</span><span style="color: #0000BB">Adolesce</span><span style="color: #007700">.</span><span style="color: #0000BB">TTF</span><span style="color: #DD0000">""</span><span style="color: #0000BB">Adolescense</span><span style="color: #DD0000">"
<br />fonts::registerfont"</span><span style="color: #0000BB">Adolesce</span><span style="color: #007700">.</span><span style="color: #0000BB">TTF</span><span style="color: #DD0000">"
<br /><br />SectionEnd
<br /></span>
</pre>Spot anything wrong?
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
        <span class="post-time small text-muted">21st December 2002 08:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Yes, the function name is case sensitive... I never noticed this before, I will fix it for the next version (already found in the CVS). For now, use the DLL function name exactly as mentioned on the top of the output.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">dirkdeftly</span><br />
        <span class="post-time small text-muted">21st December 2002 16:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanx, fixed :)<br />
        <br />
        Also thanx for not giving me crap about &lt;PHP&gt; taking out the slashes :rolleyes:</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">prichindel</span><br />
        <span class="post-time small text-muted">5th April 2005 15:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>example</strong><br />
        where can i find an official nsis example how to add &amp; register a font in windows??<br />
        <br />
        does anybody have an example with "fonts::registerfont "myfont.ttf" "; registration of fonts in different windows versions; to post it??</p>
      </div>
      <hr />

      <div class="footer">
        <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
      </div>
    </div><script src="../js/highlight.pack.js" type="text/javascript">
</script> <script type="text/javascript">
//<![CDATA[
    hljs.initHighlightingOnLoad();
    //]]>
    </script>
  </div>
</body>
</html>
