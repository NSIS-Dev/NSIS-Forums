<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Launch program as admin from user priviledge script"><title>Launch program as admin from user priviledge script - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Launch program as admin from user priviledge script</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=307234">Launch program as admin from user priviledge script</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">qwertymodo</span><br><span class="post-time small text-muted">10th June 2009 00:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Launch program as admin from user priviledge script</strong><br>I have an NSIS script that currently runs with only user privileges just fine, but I want to run an external application from my script that requires admin privileges. When I try to do this currently, it just does nothing. Is there any way to elevate the external app that needs it without requiring admin elevation for the whole script? As it stands, if the only answer is to RequestExecutionLevel highest, I will just drop the whole thing. I absolutely do not want to do this, as the external app, while it would be very nice to have that ability, is still a small, non-integral part of the script. Thank you.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">10th June 2009 01:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If the external app requires "admin" rights, then the external app itself should request the required rights instead of just failing. But if you need to deal with the external app "as-is", then you could make a dummy installer. While your main installer runs at "user" level, the dummy runs at "admin" level. That can be done using RequestExecutionLevel. The main installer will launch the dummy and the dummy will launch the external application at elevated execution level.<br><br>Also the UAC Plugin for NSIS may be worth a look, although that plugin is more intended to run an external app at "user" level from an installer that is running at "admin" level.<br><br>BTW: Why not run the installer with "admin" rights? Most things an installer has to do will require that anyway...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">qwertymodo</span><br><span class="post-time small text-muted">10th June 2009 21:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't want to run the whole thing as admin because it's not an installer, it's a portable application launcher (see portableapps.com). For portability's sake, it should be able to run as a normal user, as 99% of the app doesn't need admin privileges. Unfortunately that 1% (which is actually a separate executable from the main app, so it gets run separately) simply fails to run when launched from a script that is running with user privileges. I will try the dummy script idea and see how that works.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>