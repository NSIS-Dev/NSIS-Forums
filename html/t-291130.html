<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="uninstall.exe not always created succesfully"><title>uninstall.exe not always created succesfully - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">uninstall.exe not always created succesfully</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291130">uninstall.exe not always created succesfully</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">andrewb</span><br><span class="post-time small text-muted">1st May 2008 17:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>uninstall.exe not always created succesfully</strong><br>Hello,<br><br>I have inherited the task of helping maintain an NSIS script. This is my first experience with this scripting language.<br><br>Sometimes the script will properly create an uninstaller, sometimes it will not. I do not know if it has ever worked reliably.<br><br>I have googled, searched through forum postings, the official NSIS documentation and still am unable to come up with a solution.<br><br>The script was written in NSIS 2.32 and I am using version 2.32. Basically the install script creates an un-installer in the following fashion:<br><br>SetOutPath $INSTDIR<br>WriteUninstaller $INSTDIR\uninstall.exe<br><br>Under one circumstance (we will call this circumstance A) the uninstall.exe is created and works properly. Under another set of circumstance (we will call this circumstance B) I receive the error message "Unable to create uninstall.exe".<br><br>The only difference between the two circumstances is that under circumstance B a component section is run that pipes out and runs a self extracting WinRAR file. The file is broken into parts across 4 DVDs. Under circumstance A (when the installer installs correctly) this component is not chosen and therefore the section is not run.<br><br>So my question is why would I be receiving an error when trying to write the uninstall.exe file? Is WinRAR running and taking so much time to extract files accounting for this?<br><br>I was not quite sure if including the entire code was appropriate here. If so please let me know and I will attach it.<br><br>Regards,<br>Andrew</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">andrewb</span><br><span class="post-time small text-muted">1st May 2008 23:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have discovered a work around for this problem but I am not sure why it works. Perhaps someone can enlighten me.<br><br>Currently WriteUninstaller is called in a section named Section -post SECMyUninstaller<br><br>I simply moved WriteUninstaller into its own section which runs last (however before the -post section). Can anyone shed some light?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">2nd May 2008 00:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'd guess WinRAR runs asynchronously instead of asynchronously and in some point purges the directory where you install your files and the uninstaller. If moving it somewhere else affects things, you probably have a race condition with something that deletes the directory. Run FileMon.exe and see what happens.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>