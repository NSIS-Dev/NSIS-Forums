<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Finish Page Background color" />

  <title>Finish Page Background color - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Finish Page Background color</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318835">Finish Page Background color</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dc_dweller</span><br />
      <span class="post-time small text-muted">1st May 2010 01:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Finish Page Background color</strong><br />
      Hi all,<br />
      <br />
      I use MUI, and the Finish page looks different than all other pages NSIS generates. The Finish page's background is white while the other pages are grayish.<br />
      <br />
      The following code does not seem to make any difference:<br />
      <br />
      !define MUI_PAGE_CUSTOMFUNCTION_SHOW FinishShow<br />
      !insertmacro MUI_PAGE_FINISH<br />
      function FinishShow<br />
      FindWindow $1 "#32770" "" $HWNDPARENT<br />
      SetCtlColors $1 0xFF0000 0x00FF00<br />
      functionend<br />
      <br />
      Any help would be appreciated.<br />
      <br />
      -- DC Dweller</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st May 2010 10:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you using MUI or MUI2?<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dc_dweller</span><br />
      <span class="post-time small text-muted">1st May 2010 14:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Mui2.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st May 2010 14:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The finish page is actually made with nsDialogs and MUI has a $mui.FinishPage variable which contains the handle to the dialog. Before you try that, have you defined MUI_BGCOLOR?<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dc_dweller</span><br />
      <span class="post-time small text-muted">3rd May 2010 01:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Stu, what's the exact syntax please? I am still struggling with the NSIS language.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">3rd May 2010 10:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I assumed it was in the Modern UI manual but it isn't. It's definitely used in the code so try: !define MUI_BGCOLOR XXXXXX.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">3rd May 2010 13:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It actually is in the MUI2 manual:<br />
      2. Interface configuration -&gt; Interface settings -&gt; Page header</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dc_dweller</span><br />
      <span class="post-time small text-muted">3rd May 2010 20:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The line<br />
      <br />
      <b>!define MUI_BGCOLOR FF0000</b><br />
      <br />
      generates compile error<br />
      <br />
      !define: "MUI_BGCOLOR" already defined!<br />
      Error in script.... -- aborting creation process</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dc_dweller</span><br />
      <span class="post-time small text-muted">3rd May 2010 20:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The line<br />
      <br />
      !define MUI_BGCOLOR FF0000<br />
      <br />
      generates compile error<br />
      <br />
      !define: "MUI_BGCOLOR" already defined!<br />
      Error in script.... -- aborting creation process<br />
      <br />
      So I did this:<br />
      <br />
      !undef MUI_BGCOLOR<br />
      !define MUI_BGCOLOR FF0000<br />
      <br />
      Now the header of each dialog (but not the main body) is red and the finish page is also red. So I guess my question is, how do I change the Finish page in such a way that it looks the same as the other pages (same look and feel, and same color.)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">3rd May 2010 21:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You will get that if you try and define it more than once in the same script or if you define it after inserting the page macros (all interface settings must go before any page macro insertions).<br />
      <br />
      If you want to have different colours for the welcome and finish pages then use SetCtlColors in a custom show function on $mui.WelcomePage and $mui.FinishPage respectively.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dc_dweller</span><br />
      <span class="post-time small text-muted">3rd May 2010 21:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This finally worked fine:<br />
      <br />
      !define MUI_PAGE_CUSTOMFUNCTION_SHOW FinishShow<br />
      <br />
      !insertmacro MUI_PAGE_FINISH<br />
      <br />
      function FinishShow<br />
      SetCtlColors $mui.FinishPage /windows<br />
      <br />
      GetDlgItem $0 $mui.FinishPage 1201<br />
      SetCtlColors $0 /windows<br />
      <br />
      GetDlgItem $1 $mui.FinishPage 1202<br />
      SetCtlColors $1 /windows<br />
      <br />
      GetDlgItem $1 $mui.FinishPage 1203<br />
      SetCtlColors $1 /windows<br />
      functionend</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
