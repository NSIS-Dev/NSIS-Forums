<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Too Many Vars" />

  <title>Too Many Vars - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Too Many Vars</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=252120">Too Many Vars</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">seelke</span><br />
      <span class="post-time small text-muted">28th July 2006 02:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Too Many Vars</strong><br />
      I have tried finding the answer for this, but I'm not even sure what to look for. I have the following in a script, but when it runs, it errors sating too many vars. Any help would be greatly appreciated.<br />
      <br /></p>
      <pre>
<code>FileWrite</code><span style="color: #007700">$</span><span style="color: #0000BB">9</span><span style="color: #DD0000">'for/f"tokens=1"%%iIN('</span><span style="color: #0000BB">supportcompname</span><span style="color: #007700">/</span><span style="color: #0000BB">d</span><span style="color: #007700">?</span><span style="color: #0000BB">s</span><span style="color: #DD0000">')doif%%i==VMware-56setCOMPUTERNAME=VMWARE$\r$\n'
</span>
</pre>I know it's not PHP, but there is no code button.<br />
      <br />
      Eddie
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">28th July 2006 03:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I can say that I've never seen that error before. But, I do see that there may be an issue with the quotes. Notice how you start the command with single quotes, but then when you get the 'supportcompname' command, you are trying to encase those in single quotes. I'm thinking that when it hits the 2nd single quote, it's trying to end the command there.<br />
      <br />
      Assuming the quotes need to be written to the file, you might need to split this into 2 lines of code like this:<br /></p>
      <pre>
<code><br />FileWrite $9 'for /f "tokens=1" %%i IN ('<br />FileWrite $9 "'supportcompname /d ?s') do if %%i==VMware-56 set COMPUTERNAME=VMWARE$\r$\n"<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">seelke</span><br />
      <span class="post-time small text-muted">28th July 2006 03:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That did it!<br />
      <br />
      Thanks you very much!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
