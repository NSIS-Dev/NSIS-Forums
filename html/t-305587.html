<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Delay Installer until unstall finishes?"><title>Delay Installer until unstall finishes? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Delay Installer until unstall finishes?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305587">Delay Installer until unstall finishes?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">phungus420</span><br><span class="post-time small text-muted">22nd April 2009 02:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Delay Installer until unstall finishes?</strong><br>I have my script set up pretty good, but one minor problem still remains. If there is a previous version, the automatic uninstaller trips fine, but the user can simply skip the uninstaller, install, then uninstall after the fact, which of course leads to the program simply being uninstalled. It's minor, I just note this and say to hold off and let the uninstaller finish and then install, but I'd rather have it automatically wait. Is there anyway to do this?<br><br>This is the current relevant script code:<br></p><pre>
<code>Function .onInit<br><br>  ReadRegStr $R0 HKLM \<br>  "Software\Microsoft\Windows\CurrentVersion\Uninstall\${MOD_LOC}" \<br>  "UninstallString"<br>  StrCmp $R0 "" done<br><br>  MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br>  "${NAME} is already installed. $\n$\nDo you wish to uninstall?" \<br>  IDOK uninst<br>  Abort<br><br>;Run the uninstaller<br>uninst:<br>  ClearErrors<br>  Exec $INSTDIR\Mods\${MOD_LOC}\Uninstall.exe<br><br>done:<br><br>FunctionEnd<br><br>;--------------------------------<br>;Interface Settings<br><br>  !define MUI_ABORTWARNING<br>  !define MUI_UNABORTWARNING<br>  !define MUI_FINISHPAGE_NOAUTOCLOSE<br>  !define MUI_UNFINISHPAGE_NOAUTOCLOSE<br>  !define MUI_HEADERIMAGE<br><br>  ShowInstDetails show<br>  ShowUninstDetails show<br><br>;--------------------------------<br>;Pages</code>
</pre><br>
      <br>
      Edit: I found this but I don't understand it clearly. My knowledge of code is all self taught, so I am not very proficient here:<br>
      <br>
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=302664&amp;highlight=Uninstaller" target="_blank">http://forums.winamp.com/showthread....ht=Uninstaller</a>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">10th May 2009 14:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Don't give the user the option to skip the uninstaller by running it silently. Simply pass it /S on the command line.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>