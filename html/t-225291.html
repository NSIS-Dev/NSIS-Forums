<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="NSIS CreateShortCut DESKTOP" />

  <title>NSIS CreateShortCut DESKTOP - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">NSIS CreateShortCut DESKTOP</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=225291">NSIS CreateShortCut DESKTOP</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lonnie</span><br />
      <span class="post-time small text-muted">5th September 2005 22:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NSIS CreateShortCut DESKTOP</strong><br />
      Hello All,<br />
      <br />
      I am trying to set up a NSIS script for an application and have 2 problems that I hope you will help me with.<br />
      <br />
      1. I want to create a desktop shortcut to an application, but also I need to be able to change the working directory to the directory that the application is currently located in from the shortcut.<br />
      <br />
      I am currently using a batch file but think that I sould be able to somehow specify the working directory from the NSIS shortcut command, right?<br />
      <br />
      Also, my desktop and quick launch shortcuts are not being created for some reason as well.<br />
      <br />
      2. This is a similar problem as above but from the start menu items.<br />
      <br />
      Thanks,<br />
      Lonnie</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">5th September 2005 23:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It would be helpful to post the script.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lonnie</span><br />
      <span class="post-time small text-muted">5th September 2005 23:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for replying, but in re-reading the docs I was able to solve the problem....<br />
      <br />
      Thanks again,<br />
      lonnie</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bigbooty</span><br />
      <span class="post-time small text-muted">12th September 2005 23:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Sharing is what it's about.</strong><br />
      Thanks for sharing!<br />
      <br />
      :- bb</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ChrisNewland</span><br />
      <span class="post-time small text-muted">6th January 2008 09:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Lonnie,<br />
      <br />
      I had the same problem and it would have been nice if you'd told us where you found the answer so that others can benefit from it.<br />
      <br />
      I found a solution too which is detailed at <a href="http://www.seas.gwu.edu/~simhaweb/java/lectures/appendix/installer/install.html" target="_blank">http://www.seas.gwu.edu/~simhaweb/ja...r/install.html</a><br />
      <br />
      The relevant part is:<br />
      <br />
      How does a java application find all the classes that it uses? (Setting the working directory)<br />
      <br />
      In almost all operating systems, a call can be made to an executable file from anywhere. Suppose you have MyApplication.exe placed in C:\TestExe\. To run MyApplication.exe, you typically would go to the TestExe directory and then call:<br />
      <br />
      C:\TextExe\&gt; MyApplication<br />
      <br />
      However, we could be in a folder like C:\Another_Folder\Inside_yet_another_folder\ and still be able to execute MyApplication.exe. How? Like this:<br />
      <br />
      C:\Another_Folder\Inside_yet_another_folder\&gt; C:\TestExe\MyApplication<br />
      <br />
      This kind of example works in Unix as well (of course, the directories wouldn't be starting with "C:". What is different about these two program calls. The working directory of each application is different. In the first example, the working directory is C:\TestExe because that is where we launched the application from. In the second example the working directory is C:\Another_Folder\Inside_yet_another_folder . The working directory is the directory from which the application is launched. As you have seen, it doesn't necessarily have to be the directory where the program is installed.<br />
      <br />
      Go to your start menu, and under programs, find a shortcut. Right-click on this shortcut and now in the new window, look at the text box labelled "Start In:". That is the working directory of that application.<br />
      <br />
      How do we make sure that the working directory in our shortcuts are where we want them to be? There is no parameter to set for that in the CreateShortcut function in NSIS. Look back to the first example where we created start menu shortcuts. Notice that we have set an Outpath for copying files. This Outpath is ALSO set as the working directory for every shortcut that is created after that SetOutPath command. If you would like to change the working directory of a shortcut, then simply change the OutPath to what you would like, create the shortcut, and then, if you want, change the OutPath back.<br />
      <br />
      Hope that helps.<br />
      <br />
      -Chris</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wahooney</span><br />
      <span class="post-time small text-muted">13th March 2008 23:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I just bumped into this problem myself, but lo I have a solution, here is an example:<br /></p>
      <pre>
<code>CreateDirectory "$SMPROGRAMS\$StartMenuGroup"<br />SetOutPath $INSTDIR<br />CreateShortcut "$SMPROGRAMS\$StartMenuGroup\$(^Name).lnk" $INSTDIR\App.exe<br />SetOutPath $SMPROGRAMS\$StartMenuGroup<br />CreateShortcut "$SMPROGRAMS\$StartMenuGroup\Uninstall $(^Name).lnk" $INSTDIR\uninst.exe<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">14th March 2008 11:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It says under <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.3.4" target="_blank">CreateShortCut</a>:<br />
      <br /></p>

      <blockquote>
        $OUTDIR is used for the working directory. You can change it by using SetOutPath before creating the Shortcut.
      </blockquote>Stu
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
