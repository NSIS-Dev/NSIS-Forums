<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Set working directory for program called via exec"><title>Set working directory for program called via exec - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Set working directory for program called via exec</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291779">Set working directory for program called via exec</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">thivnor</span><br><span class="post-time small text-muted">14th May 2008 02:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Set working directory for program called via exec</strong><br>I would like to have my NSIS script invoke an executable, and have the working directory for the invoked executable be the same as its own current directory. What is happening now is that the working directory for the invoked program is the same as the folder where my NSIS executable is running from.<br><br>I have used SetOutPath, but that does not appear to be setting the working directory for the invoked .exe.<br><br>I've created a simple test setup to demonstrate this.<br><br>debug.nsi has:<br><br>System::Call "kernel32::GetCurrentDirectory(i ${NSIS_MAX_STRLEN}, t .r0)"<br>StrCpy $workingDir $0<br>MessageBox MB_OK|MB_ICONEXCLAMATION "workingDir: $workingDir"<br><br>In other works, it just reports out its working directory.<br><br>invoke.nsi has:<br><br>StrCpy $OUTDIR "C:\"<br>SetOutPath "C:\"<br>Exec "$EXEDIR\subfolder\debug.exe"<br><br><br>No matter what I do, debug.exe reports that the working directory is the same: the directory where invoke.exe lives.<br><br>I'm looking for the equivalent to "cd" in a batch file. Or, in Windows Shortcut terms, I want to set the "Start In" property.<br><br>Anyway to accomplish this?<br><br>I'm using MakeNSIS v2.31</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">15th May 2008 22:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Does it work with something other than "C:\"?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">thivnor</span><br><span class="post-time small text-muted">15th May 2008 23:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Wow.<br><br>I've re-tested this, and determine that, in fact using C:\ doesn't work, but every other folder I've tried does work. I had originally just popped C:\ in, as a quick test. I didn't figure the actual directory mattered.<br><br>BAD:<br>SetOutPath "C:\"<br>Exec "$EXEDIR\subfolder\debug.exe"<br><br>GOOD:<br>SetOutPath "E:\"<br>Exec "$EXEDIR\subfolder\debug.exe"<br><br>GOOD:<br>SetOutPath "C:\Foo"<br>Exec "$EXEDIR\subfolder\debug.exe"<br><br>Now ... I'm super-curious! What is so special about C:\ ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Animaether</span><br><span class="post-time small text-muted">16th May 2008 00:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">C:\, or more accurately - your boot drive's root folder is, well, your boot drive's root folder. Installing into it (which SetOutPath is usually for) is considered 'bad'.<br><br>See also "AllowRootDirInstall".<br><br>Note that under Vista, unless you mucked with write permissions left and right, writing to root will fail regardless.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">thivnor</span><br><span class="post-time small text-muted">16th May 2008 00:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hmm... C:\ ... your boot drive's root folder ... now that you put it THAT way, this all makes total sense.<br><br>As an aside, I've found NSIS so useful that I now use it as a general purpose programming language, for small Windows utilities. I will need to keep in mind the original point of functions like SetOutPath!<br><br>Thanks for the clues !!!</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>