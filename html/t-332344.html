<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="MUI_FINISHPAGE_RUN question" />

  <title>MUI_FINISHPAGE_RUN question - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">MUI_FINISHPAGE_RUN question</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=332344">MUI_FINISHPAGE_RUN question</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kalverson</span><br />
      <span class="post-time small text-muted">11th July 2011 19:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>MUI_FINISHPAGE_RUN question</strong><br />
      In one of our older installs, I have run into a situation where the application has the wrong configuration path. This is due to admin elevation on a standard user profile during the install. The application is launched at the end using the admin profile rather than the standard user profile and thus has the wrong configuration path. Is there an easy wait to either disable the checkbox on the finish page in this situation, or just launch the application with the correct standard user profile instead?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">11th July 2011 21:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Simply don't add the RUN macro.<br />
      <br />
      Or, if you want to disable the run option only for elevated installs, you can do that in the page's SHOW function. The HWND of the run checkbox is stored in a variable. See NSIS\Contrib\Modern UI 2\Pages\Finish.nsh to find out what it's called.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kalverson</span><br />
      <span class="post-time small text-muted">12th July 2011 13:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I found what I needed in the System.nsh header here since I am not using MUI 2:<br />
      <br />
      !ifdef MUI_FINISHPAGE_RUN<br />
      GetDlgItem $MUI_TEMP1 $MUI_HWND 1203<br />
      SetCtlColors $MUI_TEMP1 "" "${MUI_BGCOLOR}"<br />
      EnableWindow $MUI_TEMP1 0<br />
      !endif<br />
      <br />
      Now all I have to do is figure out if I am a standard user that was elevated at install time.<br />
      <br />
      Thanks for your help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kalverson</span><br />
      <span class="post-time small text-muted">12th July 2011 18:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">On second thought, I was reading what the UAC plug-in does and discovered I can launch my application as the user which is what I really wanted to do in the first place. It looks like using the UAC plug-in to launch the installled applicaiton is the way to go. One additional question if any knows, has the UAC plug-in been tested on MS servers 2003 or 2008? I did not see these in the OS test environment list.<br />
      <br />
      <a href="http://nsis.sourceforge.net/UAC_plug-in" target="_blank">http://nsis.sourceforge.net/UAC_plug-in</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">13th July 2011 06:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">UAC plugin works fine on WinServer 2003. I never tested on 2008.<br />
      <br />
      The reason I never mentioned the UAC plugin is that it makes installers a lot more complex, and it adds a hundred things that can go wrong. It's definitely not recommended for beginners. That being said, the plugin was indeed designed to do exactly what you want to do. Just make sure to examine and understand the example scripts.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kalverson</span><br />
      <span class="post-time small text-muted">13th July 2011 14:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for you help and the additional comments on UAC. I have implemented the UAC plug-in and it does solve our issue. There is one minor thing that occurs now, but I am not sure anything can be done about it. The UAC security dialog that asks for logon credentials sometimes is minimized and blinking on the task bar. If you user does not notice this, they might think nothing happened when they double clicked the installer exe.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
