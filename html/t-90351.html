<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="CreateShortCut adds drive letter ???" />

  <title>CreateShortCut adds drive letter ??? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">CreateShortCut adds drive letter ???</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=90351">CreateShortCut adds drive letter ???</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">veekee</span><br />
      <span class="post-time small text-muted">8th June 2002 12:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>CreateShortCut adds drive letter ???</strong><br />
      Hi,<br />
      <br />
      Someone asks me in a french nsis forum about a problem with the CreateShortCut function ! I asked him to llokup in the doc but i found his problem quite stange !<br />
      He wanted to use parameters in the shortcup, and use the direct method :<br />
      CreateShortCut "$INSTDIR\Play HLP.lnk" "'$INSTDIR\halflife.exe' -console -dev -game Hl-Parpaing"<br />
      <br />
      :D<br />
      <br />
      I know that this is not the wrong way to use that function, but if this is executed by NSIS, the shortcut links to : "C:\'E:\HalfLife\halflife.exe' -console -dev -game Hl-Parpaing"<br />
      <br />
      C:/ was added at the begining ? Does anyone knows why ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">8th June 2002 12:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        I know that this is not the wrong way to use that function, but if this is executed by NSIS, the shortcut links to : "C:\'E:\HalfLife\halflife.exe' -console -dev -game Hl-Parpaing"
      </blockquote>As a matter of fact, it <b>IS</b> the wrong way of using this function. The parameters should come in a seperate string. And it does show in the docs:<br />
      <br />

      <blockquote>
        CreateShortCut link.lnk target.file <b>[parameters]</b> [icon.file] [icon_index_number] [start_options] [keyboard_shortcut]
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">veekee</span><br />
      <span class="post-time small text-muted">8th June 2002 12:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sur, this is in the doc ... the fact is : is there a logical reason that NSIS links to "C:\'E:\HalfLife\halflife.exe' -console -dev -game Hl-Parpaing" instead of "'E:\HalfLife\halflife.exe' -console -dev -game Hl-Parpaing" ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">8th June 2002 13:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The reason there are two strings is that this is the way Windows does it. The Windows function that creates the shortcut gets two parameters, one for the path and one for the shortcut parameters.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">veekee</span><br />
      <span class="post-time small text-muted">8th June 2002 13:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">but why, when using one parameter (intead of the two required), is there a c:\ that appears ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">8th June 2002 14:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Because it does not know a drive marked with a ", so it adds the default drive letter. This is what Windows does, NSIS has nothing to do with it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">veekee</span><br />
      <span class="post-time small text-muted">8th June 2002 14:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">aarg, so simple ! Thanks a lot kichik : you were very patient ;) (:igor: &lt;- me :D) !</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
