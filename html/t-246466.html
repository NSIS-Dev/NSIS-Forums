<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Automate an Excel spreadsheet during an installation"><title>Automate an Excel spreadsheet during an installation - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Automate an Excel spreadsheet during an installation</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246466">Automate an Excel spreadsheet during an installation</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ewallig</span><br><span class="post-time small text-muted">18th May 2006 20:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Automate an Excel spreadsheet during an installation</strong><br>Hi,<br><br>Developer of a spreadsheet-based application now needs to upgrade his "database" structure. As part of the upgrade, he needs to capture all of the currently stored data in the previous version of his app. To do this, he's built another spreadsheet with a bunch of macros in it. This spreadsheet needs to be launched and then closed once it has completed its task (get the data and then save the data as a text file).<br><br>The installer that I built for him now needs to do the following:<br><br>- Launch the macro-loaded spreadsheet<br>- Close the macro-loaded spreadsheet once it has created its text file.<br>- Proceed with the installation of the rest of the upgraded files.<br><br>To tackle this, I wrote a small script that checks for the presence of the text file and loops until it exists. In the installer, I run this script (actually a script inside of an exe wrapper) after launching the macro-loaded spreadsheet. Once it detects the text file, it sends various keystrokes to click a dialog box that pops up and then close the spreadsheet. Once the macro-loaded spreadsheet closes, the installation can proceed.<br><br>The helper script works fine if I manually run the macro-loaded spreadsheet and then run the script; the text file is created and the macro-loaded spreadsheet closes w/o issue. However, I've run into some difficulties when trying to do this via the NSIS installer. If I use an Exec command to try to open the macro-loaded spreadsheet, there is no interaction w/ the desktop which the script needs to do the keystrokes. If I use an ExecShell open, then the installer stalls once the macro-loaded spreadsheet opens up - no further installer-related activity occurs until I manually click the button on the dialog box.<br><br>Anyone have any suggestions on how to deal with this - the developer really wants it to be automatic and is giving me a bit of grief over it.<br><br><br>Thanks :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">19th May 2006 12:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can try using Excel's automation interface to invisibly load the spreadsheet. It'd also allow you greater control with direct API instead of keystrokes. You can use the System plug-in to do that or create a simple plug-in for the task.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ewallig</span><br><span class="post-time small text-muted">19th May 2006 13:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the info - can you point me at some documentation or examples?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">19th May 2006 13:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://msdn.microsoft.com/office/understanding/excel/" target="_blank">MSDN</a> should contain all the information you need. Sites like <a href="http://www.codeproject.com" target="_blank">code project</a> might contain more examples. A simple search for "Excel" comes up with many results.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>