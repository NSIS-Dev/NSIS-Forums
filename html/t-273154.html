<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="need some help"><title>need some help - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">need some help</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=273154">need some help</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ikkeugh</span><br><span class="post-time small text-muted">20th June 2007 19:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>need some help</strong><br>Could you help me with a script?<br>i want to have an install file , not autorun .<br>A titel , and some place to write and a destination folder.<br>(with a browse buton , cancel and install.)<br>after he installed all the files i want him to open a file that was just installed .<br>if the program runs, nothing should happens to the install file , but if the program closes ,<br>the programm should be removed and again a screen appears ...<br>(with again a title , some place to write , and a finish button .)<br><br>first menu :<br><a href="http://img123.imageshack.us/my.php?image=firstmenuuh2.jpg" target="_blank"></a><a href="http://img123.imageshack.us/img123/6449/firstmenuuh2.th.jpg" target="_blank">http://img123.imageshack.us/img123/6...menuuh2.th.jpg</a><br>second menu :<br><a href="http://img146.imageshack.us/my.php?image=secondmenurz8.jpg" target="_blank"></a><a href="http://img146.imageshack.us/img146/2969/secondmenurz8.th.jpg" target="_blank">http://img146.imageshack.us/img146/2...menurz8.th.jpg</a><br>third menu :<br><a href="http://img19.imageshack.us/my.php?image=thirdmenujm1.jpg" target="_blank"></a><a href="http://img19.imageshack.us/img19/1262/thirdmenujm1.th.jpg" target="_blank">http://img19.imageshack.us/img19/126...menujm1.th.jpg</a><br><br>thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">20th June 2007 22:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm confused as what you want. What is wrong with the installer that you already have? Or are those screenshots of another installer?<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ikkeugh</span><br><span class="post-time small text-muted">21st June 2007 12:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">well , i used them from a nsis example : library ,<br>but i can't figure out how i could make him to open a file and afterwards remove it .</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">21st June 2007 12:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use ExecWait to open an executable and wait for it to close and then Delete to delete the file.<br><br>You may also want to use Modern UI (Examples\Modern UI) which has Welcome and Finish pages.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ikkeugh</span><br><span class="post-time small text-muted">21st June 2007 15:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">can u make a installer file that can't be copied?<br><br>and uninstalles a file and itself?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">21st June 2007 18:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You cannot prevent a user copying your installer.<br>To delete oneself you have to execute (Exec) another program (which you can write in NSIS) that deletes the calling installer and then quits.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ikkeugh</span><br><span class="post-time small text-muted">23rd June 2007 16:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">so it can't uninstal itself?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ikkeugh</span><br><span class="post-time small text-muted">23rd June 2007 18:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>ok , i've got this so far :<br>now i only need the install file to be deleted , how should i do this ?(and is there a way to edit the layout?)</b><br><br><br><br>Name "hello"<br><br>OutFile "hello.exe"<br><br>InstallDir "$PROGRAMFILES\hi\hello"<br><br>Page directory<br><br>Page instfiles<br><br>Section ""<br><br>SetOutPath $INSTDIR<br><br>File "C:\hi\files\1.txt"<br>File "C:\hi\files\2.txt"<br>File "C:\hi\files\3.txt"<br>File "C:\hi\files\4.txt"<br>File "C:\hi\files\5.txt"<br>File "C:\hi\files\6.txt"<br>File "C:\hi\files\7.txt"<br>File "C:\hi\files\8.txt"<br>File "C:\hi\files\9.exe"<br><br>ExecWait '"$INSTDIR\9.exe" _?=$INSTDIR'<br><br>Delete $INSTDIR\9.exe<br><br>SetAutoClose true<br><br>SectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">23rd June 2007 18:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><pre>
<code>Name Delete<br>OutFile delete_hello.exe<br>SilentInstall silent<br><br>Function .onInit<br>  Sleep 1000<br>  ReadRegStr $R0 HKLM "Software\hello" "InstallerLocation"<br>  Delete "$R0\hello.exe"<br>  Abort<br>FunctionEnd<br><br>Section<br>SectionEnd</code>
</pre><br>
      <br>
      <pre>
<code><br>File "/oname=$PLUGINSDIR\delete_hello.exe" "delete_hello.exe"<br>WriteRegStr HKLM "Software\hello" "InstallerLocation" "$EXEDIR"<br>Exec "$PLUGINSIR\delete_hello.exe"<br>Quit<br></code>
</pre><br>
      <br>
      First code snippet is code to be built as a separate executable. The second code snippet must go in your installer.<br>
      <br>
      Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ikkeugh</span><br>
      <span class="post-time small text-muted">24th June 2007 14:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">but than i have the delete_hello<br>
      that has to be removed to!<br>
      <br>
      And does it has to be :<br>
      <br>
      Name "hello"<br>
      <br>
      OutFile "hello.exe"<br>
      <br>
      InstallDir "$PROGRAMFILES\hi\hello"<br>
      <br>
      Page directory<br>
      <br>
      Page instfiles<br>
      <br>
      Section ""<br>
      <br>
      SetOutPath $INSTDIR<br>
      <br>
      File "C:\hi\files\1.txt"<br>
      File "C:\hi\files\2.txt"<br>
      File "C:\hi\files\3.txt"<br>
      File "C:\hi\files\4.txt"<br>
      File "C:\hi\files\5.txt"<br>
      File "C:\hi\files\6.txt"<br>
      File "C:\hi\files\7.txt"<br>
      File "C:\hi\files\8.txt"<br>
      File "C:\hi\files\9.exe"<br>
      <br>
      ExecWait '"$INSTDIR\9.exe" _?=$INSTDIR'<br>
      <br>
      Delete $INSTDIR\9.exe<br>
      <br>
      SetAutoClose true<br>
      <br>
      SectionEnd<br>
      <br>
      File "/oname=$PLUGINSIR\delete_hello.exe" "delete_hello.exe"<br>
      WriteRegStr HKLM "Software\hello" "InstallerLocation" "$EXEDIR"<br>
      Exec "$PLUGINSIR\delete_hello.exe"<br>
      Quit<br>
      <br>
      or<br>
      <br>
      Name "hello"<br>
      <br>
      OutFile "hello.exe"<br>
      <br>
      InstallDir "$PROGRAMFILES\hi\hello"<br>
      <br>
      Page directory<br>
      <br>
      Page instfiles<br>
      <br>
      Section ""<br>
      <br>
      SetOutPath $INSTDIR<br>
      <br>
      File "C:\hi\files\1.txt"<br>
      File "C:\hi\files\2.txt"<br>
      File "C:\hi\files\3.txt"<br>
      File "C:\hi\files\4.txt"<br>
      File "C:\hi\files\5.txt"<br>
      File "C:\hi\files\6.txt"<br>
      File "C:\hi\files\7.txt"<br>
      File "C:\hi\files\8.txt"<br>
      File "C:\hi\files\9.exe"<br>
      <br>
      ExecWait '"$INSTDIR\9.exe" _?=$INSTDIR'<br>
      <br>
      Delete $INSTDIR\9.exe<br>
      File "/oname=$PLUGINSIR\delete_hello.exe" "delete_hello.exe"<br>
      WriteRegStr HKLM "Software\hello" "InstallerLocation" "$EXEDIR"<br>
      Exec "$PLUGINSIR\delete_hello.exe"<br>
      Quit<br>
      <br>
      SetAutoClose true<br>
      <br>
      SectionEnd</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br>
      <span class="post-time small text-muted">24th June 2007 18:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>ikkeugh wrote</i><br>
        can u make a installer file that can't be copied?<br>
        and uninstalles a file and itself?
      </blockquote>

      <blockquote>
        but than i have the delete_hello<br>
        that has to be removed to!
      </blockquote>I wonder if all this effort to delete the installer is an attempt to make an installer that can't be copied? If that is what you're doing, I'd say that you are wasting your time -- a user could always make a copy of the installer, save it off on another disk/media (CD-ROM, flash disk) and then run the installer and not care that one copy was deleted, he still has another copy.<br>
      <br>
      If you want to delete the installer for another reason, I suggest this method: have the installer write a short vbscript that will delete the installer and itself. (Vbscripts can delete themselves because the real exe (wscript.exe) is not deleted.) You could run the vbscript from the final callback in the installer (function .onInstSuccess).<br>
      <br>
      Don
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">24th June 2007 18:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You don't need to delete the delete_hello executable because it is in $PLUGINSDIR which will be delete when the installer closes.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br>
      <span class="post-time small text-muted">24th June 2007 19:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Stu<br>
      Did you test your solution? I think the delete of $PLUGINSDIR will not work because delete_hello.exe is running and not deletable.<br>
      <br>
      If the installer waits (or hangs) while the delete of $PLUGINSDIR tries to do its thing it <i>could</i> succeed, but that would mean that delete_hello terminated (and failed to delete hello.exe).<br>
      <br>
      Don</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ikkeugh</span><br>
      <span class="post-time small text-muted">24th June 2007 21:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks all : that last one did it !!!!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">24th June 2007 22:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's true. You should probably put RMDir /r /rebootok $EXEDIR in delete_hello.nsi just to be safe.<br>
      <br>
      Edit: Also, $PLUGINSIR -&gt; $PLUGINSDIR (missing D in my code).<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ikkeugh</span><br>
      <span class="post-time small text-muted">25th June 2007 21:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I used the one of Don , is there any problem with that one?<br>
      and is there a way to AUTOSTART the installation file after downloaded?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">25th June 2007 22:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The one of Don?<br>
      <br>
      No you cannot do that. It would be a serious security vulnerability if programs could do that.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>