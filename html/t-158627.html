<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Add an icon in Finish page"><title>Add an icon in Finish page - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Add an icon in Finish page</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=158627">Add an icon in Finish page</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">JonCan</span><br><span class="post-time small text-muted">5th December 2003 11:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Add an icon in Finish page</strong><br>Hi everybody!<br><br>I want to add an exclamation icon to the Finish page, and i have 2 questions :<br><br>1. Are there any parameters to select an exclamation icon in the ioSpecial.ini, like MB_ICONEXCLAMATION for messagebox ?<br><br>2. How can i do to implement this icon in the Finish page, but not in the Welcome page, using the custome ioSpecial.ini ? Maybe a possibility to disable/enable or visible/notvisible it..?<br><br>Thank you!!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">5th December 2003 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Write to the Finish page INI file in the pre function and set the icon in the show function using the System plug-in and Windows API.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JonCan</span><br><span class="post-time small text-muted">5th December 2003 20:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks..but I don't really know how to use all that stuff, so i try something else : to let the icon blank for welcome page, and activate the icon by giving it the "text" value of my exclamation icon.<br>And now i have another problem, i want to change the background color of an element, i try this code, but it doesn't work :<br><br>!define MUI_SPECIALINI "Welcome_Finish.ini"<br>!define MUI_CUSTOMFUNCTION_FINISH_PRE FinishCustom<br>...<br>Function FinishCustom<br>Pop $R0<br>GetDlgItem $R1 $R0 1203<br>SetBkColor $R1 0x000000<br>Pop $R1<br>FunctionEnd<br>...<br><br>The background of my field 4 is still grey..What's wrong?<br>Thanks for your help</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JonCan</span><br><span class="post-time small text-muted">5th December 2003 21:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I try this and it's ok! :<br><br>!define MUI_SPECIALINI "Welcome_Finish.ini"<br>!define MUI_CUSTOMFUNCTION_FINISH_SHOW FinishCustom<br>...<br>Function FinishCustom<br>FindWindow $R0 "#32770" "" $HWNDPARENT<br>GetDlgItem $R1 $R0 1203<br>SetBkColor $R1 0xFFFFFFFF<br>FunctionEnd<br>...<br><br>:)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JonCan</span><br><span class="post-time small text-muted">5th December 2003 22:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Another probleme...<br><br>I can't modify the INI :<br><br>!define MUI_SPECIALINI "Welcome_Finish.ini"<br>!define MUI_CUSTOMFUNCTION_FINISH_SHOW FinishCustom<br>...<br>Function FinishCustom<br><b>!insertmacro MUI_INSTALLOPTIONS_WRITE "Welcome_Finish.ini" "Field 4" "Text" "Hello" ;This doesn't work</b><br>FindWindow $R0 "#32770" "" $HWNDPARENT<br>GetDlgItem $R1 $R0 1203<br>SetBkColor $R1 0xFFFFFFFF<br>FunctionEnd<br>...<br><br>any idea? thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JonCan</span><br><span class="post-time small text-muted">5th December 2003 22:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">:rolleyes: me again...<br><br>I notice that my special INI file for Welcome and Finish page doesn't work well (the field i've add doesn't appear) when i use the MUI_FINISHPAGE_SHOWREADME<br><br>not easy to be a newbie :(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">6th December 2003 13:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You've mixed up the callbacks. You should write to the INI in the pre function, not the show function:</p><blockquote>In the Pre function of the Welcome page and the Finish page, you can write to the InstallOptions INI file of the page (ioSpecial.ini)</blockquote>And to get the HWND of the Welcome/Finish page you use $MUI_HWND in the show function, not the pre function:<blockquote>In the Show function of Welcome page and the Finish page, $MUI_HWND contains the HWND of the inner dialog</blockquote>Both are said assuming you're using NSIS 2.0 b4 or a later version.<br><br>BTW, Joost was talking about the System plug-in as a method to get the system's exclamation mark instead of a set one you bring with the installer. The System plug-in can call Win32 API functions that can get you this icon. But I think you should first get the basic, with your own icon working and only then, if you want, get the system's exclamation mark.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JonCan</span><br><span class="post-time small text-muted">6th December 2003 15:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for you answer, but it sill not working..:(<br><br>Now my code is :<br><br>!define MUI_SPECIALINI "Welcome_Finish.ini"<br>!define MUI_CUSTOMFUNCTION_FINISH_PRE FinishCustomSetText<br>!define MUI_CUSTOMFUNCTION_FINISH_SHOW FinishCustomSetColor<br>...<br>Function FinishCustomSetText<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "Welcome_Finish.ini" "Field 5" "Text" "Hello"<br>!insertmacro MUI_INSTALLOPTIONS_READ $R0 "Welcome_Finish.ini" "Field 5" "Text"<br>MessageBox MB_OK "$R0"<br>FunctionEnd<br><br>Function FinishCustomSetColor<br>FindWindow $R0 "#32770" "" $HWNDPARENT<br>GetDlgItem $R1 $R0 1203 ;GetDlgItem $R1 $R0 1203<br>SetBkColor $R1 0xFFFFFF<br>GetDlgItem $R2 $R0 1204 ;GetDlgItem $R2 $R0 1204<br>SetBkColor $R2 0xFFFFFF<br>FunctionEnd<br><br><br>The FinishCustomSetColor function is OK. It works. (Notice that $MUI_HWND doesn't work).<br>But the FinishCustomSetText function doesn't work, it's strange, because my messagebox print me the good value ("Hello"), but my Label element in my Finish page doesn't change, it doesn't print hello, the text value is not modified.<br>I don't undertsand.<br>And i have always the same problem when i define the MUI_FINISHPAGE_SHOWREADME value: all my added fields in my ini are not visible.<br><br>Thanks for your help!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">6th December 2003 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You still need to write to ioSpecial.ini as MUI_SPECIALINI just changes the source. As for $MUI_HWND, it works fine for me and it is the best way to go because under certain circumstances FindWindow will not find the window you expect it to find. It probably isn't working for you because you're using 2.0b3. In 2.0b3 you should use ${MUI_TEMP1}:</p><blockquote>MUI_CUSTOMFUNCTION_FINISH_SHOW - ${MUI_TEMP1} contains HWND of Finish dialog</blockquote></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JonCan</span><br><span class="post-time small text-muted">6th December 2003 15:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes! Thanks Kichik! it works!<br>In fact i don't really know which version i have, my compiler shows<br>"NSIS v2.0b4 (CVS) fr" and my NSIS.exe shows "NSIS v2.02 beta 2 fr"... so.. don't know! maybe a mix!<br><br>Last thing : what can I do about the MUI_FINISHPAGE_SHOWREADME problem ? when i define the MUI_FINISHPAGE_SHOWREADME value all the fields i've added in my ini are not visible.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">6th December 2003 16:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Mixing up versions is not a good idea... The MUI depends on new features in makensis.exe and so do other parts of the NSIS package. You should get NSIS 2.0b4, read the MUI readme again, update your script according to it (MUI_CUSTOMFUNCTION_FINISH_PRE -&gt; MUI_PAGE_CUSTOMFUNCTION_PRE, MUI_SPECIALINI -&gt; MUI_WELCOMEFINISHPAGE_INI, etc.). The mix up is probably the cause to the trouble with MUI_FINISHPAGE_SHOWREADME.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>