<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="NSIS Simple Service Plugin" />

  <title>NSIS Simple Service Plugin - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" NSIS Simple Service Plugin" />

  <title>NSIS Simple Service Plugin - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" NSIS Simple Service Plugin" />

  <title>NSIS Simple Service Plugin - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" NSIS Simple Service Plugin" />

  <title>NSIS Simple Service Plugin - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">NSIS Simple Service Plugin</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=270562">NSIS Simple Service Plugin</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">3rd May 2007 18:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NSIS Simple Service Plugin</strong><br />
      Hi,<br />
      <br />
      IÂ´ve create a service plugin. This plugin contains basic service functions like start, stop the service or checking the service status. It also contains advanced service functions for example setting the service description, changed the logon account, granting or removing the service logon privilege.<br />
      <br />
      Here the function list:<br />
      <br /></p>

      <blockquote>
        SimpleSC::Install [name_of_service] [display_name] [start_type] [service_commandline] [dependencies] [account] [password]<br />
        SimpleSC::Remove [name_of_service]<br />
        SimpleSC::StartService [name_of_service]<br />
        SimpleSC::StopService [name_of_service]<br />
        SimpleSC::PauseService [name_of_service]<br />
        SimpleSC::ContinueService [name_of_service]<br />
        SimpleSC::RestartService [name_of_service]<br />
        SimpleSC::ExistsService [name_of_service]<br />
        SimpleSC::GetServiceDisplayName [name_of_service]<br />
        SimpleSC::GetServiceName [display_name]<br />
        SimpleSC::GetServiceStatus [name_of_service]<br />
        SimpleSC::SetServiceDescription [name_of_service] [service_description]<br />
        SimpleSC::SetServiceStartType [name_of_service] [start_type]<br />
        SimpleSC::SetServiceLogon [name_of_service] [account] [password]<br />
        SimpleSC::GrantServiceLogonPrivilege [account]<br />
        SimpleSC::RemoveServiceLogonPrivilege [account]<br />
        SimpleSC::ServiceIsPaused [name_of_service]<br />
        SimpleSC::ServiceIsRunning [name_of_service]<br />
        SimpleSC::ServiceIsStopped [name_of_service]
      </blockquote>Here is the link to the wiki: <a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a><br />
      <br />
      Any comments, suggestions and questions are welcome...<br />
      <br />
      Best regards<br />
      <br />
      Rainer
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nicolas Cuny</span><br />
      <span class="post-time small text-muted">7th May 2007 14:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      I just tested your plugin and was surprised to see that it doesn't need admin privileges to check the status of a service, contrary to the other available plugins. This was tested on Vista and XP Pro SP2.<br />
      <br />
      This is very useful to me and I would like to know if this behaviour is intended and maybe a little explanation too :)<br />
      <br />
      These are the scripts I used to double-check :<br />
      <br /></p>
      <pre>
<code>Name "simpleservice-test"<br />Outfile "simpleservice-test.exe"<br />ShowInstDetails show<br />RequestExecutionLevel user<br /><br />Section -Main SEC0000<br />    SetAutoClose false<br />    SimpleSC::GetServiceStatus "W32Time"<br />    pop $0<br />    pop $1<br />    DetailPrint $0<br />    DetailPrint $1<br />SectionEnd</code>
</pre><br />
      <br />
      <pre>
<code>Name "nsscm-test"<br />Outfile "nsscm-test.exe"<br />ShowInstDetails show<br />RequestExecutionLevel user<br /><br />Section -Main SEC0000<br />    SetAutoClose false<br />    nsSCM::QueryStatus "W32Time"<br />    Pop $0<br />    Pop $1<br />    DetailPrint $0<br />    DetailPrint $1<br />SectionEnd</code>
</pre><br />
      <br />
      <pre>
<code>!include "servicelib.nsh"<br /><br />Name "servicelib-test"<br />Outfile "servicelib-test.exe"<br />ShowInstDetails show<br />RequestExecutionLevel user<br /><br />Section -Main SEC0000<br />    SetAutoClose false<br />    !insertmacro SERVICE "status" "W32Time" ""<br />    pop $0<br />    DetailPrint $0<br />SectionEnd</code>
</pre><br />
      <br />
      And these are the results :<br />
      <br />

      <blockquote>
        * simpleservice-test:<br />
        0<br />
        4<br />
        <br />
        * nsscm-test:<br />
        error<br />
        1<br />
        <br />
        * servicelib-test:<br />
        false
      </blockquote>Thanks for the great job !
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nicolas Cuny</span><br />
      <span class="post-time small text-muted">7th May 2007 17:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I found out so far that :<br />
      <br />
      - GetServiceStatus works with admin and user privileges<br />
      - ExistsService only works with admin privileges<br />
      - ServiceIsRunning works with both privileges, but documentation on the wiki is wrong : '1' means the service is running<br />
      <br />
      This has been tested on Vista and XP.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">7th May 2007 18:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br /></p>

      <blockquote>
        <i>Originally posted by Nicolas Cuny</i><br />
        <b>I found out so far that :<br />
        <br />
        - ExistsService only works with admin privileges<br />
        - ServiceIsRunning works with both privileges, but documentation on the wiki is wrong : '1' means the service is running<br />
        <br />
        This has been tested on Vista and XP.</b>
      </blockquote>IÂ´ve changed the access flags for each functions so every function will be executed with the lowest privilege which is necessary. So I think ExistsService should now work with user privileges. A new version (1.01) of this plugin is available now.<br />
      <br />
      IÂ´ve changed the wrong Result-Description for the functions ServiceIsRunning, ServiceIsPaused and ServiceIsStopped.<br />
      <br />
      Any comments, suggestions and questions are welcome...<br />
      <br />
      Best regards<br />
      <br />
      Rainer
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">psmika</span><br />
      <span class="post-time small text-muted">24th May 2007 10:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello,<br />
      <br />
      I'm am currently building an installer for a service application and I am using this plugin to create the service itself.<br />
      <br />
      I am able to create the service but in the service control manager there is no description. Also when the service starts a message is logged in the even viewer and then it says Service1 has been started even tho my service is called something else.<br />
      Most likely im doing something wrong, it would be nice if someone could point me in the right direction.<br />
      <br />
      I have used the following command to add the service:<br />
      SimpleSC::InstallService "MyService" "My Service" "2" "$INSTDIR\bin\MyService.exe" "" "" ""<br />
      <br />
      Thanks in advance for any help with this!<br />
      <br />
      // Mika</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">24th May 2007 17:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br /></p>

      <blockquote>
        I am able to create the service but in the service control manager there is no description.
      </blockquote>Thats correct. If you install the service the service description is not set. Please use the function "SetServiceDescription" to set a seperate description.<br />
      <br />

      <blockquote>
        Also when the service starts a message is logged in the even viewer and then it says Service1 has been started even tho my service is called something else.
      </blockquote>I think Service1 is your Display name, otherwise you canÂ´t see it in eventlog. But I think your Key-Name (It is called [name_of_service] in plugin doc) is always the same. DonÂ´t confuse Display-Name and Key-Name.<br />
      <br />
      The Display-Name is a unique name you can see in the service controller at the column "Name".<br />
      <br />
      The Key-Name is a unique name you can see if you show the properties of a service.<br />
      <br />
      Best regards<br />
      <br />
      Rainer
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">psmika</span><br />
      <span class="post-time small text-muted">25th May 2007 09:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you so much for your response.<br />
      <br />
      The SetServiceDescription function works like a charm!<br />
      I found out that the Service1 issue is a programming issue and it has nothing to do with this plugin.<br />
      <br />
      Thank you for the fast response and for this plugin!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Andy1988</span><br />
      <span class="post-time small text-muted">29th May 2007 17:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I tried to use your dll.<br />
      I copied it into the Plugins folder in the folder where NSIS is installed, but the compiler always says that "SimpleSC::Install" is an illegal command.<br />
      <br />
      Do I need to define somewhere in my NSIS Script that I want to use your dll? I was not able to find anything about this in the Wiki, this forum or with google.<br />
      Perhaps I'm blind ;)<br />
      <br />
      Thank you for your help!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">29th May 2007 19:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello Andy,<br />
      <br /></p>

      <blockquote>
        <i>Originally posted by Andy1988</i><br />
        I tried to use your dll.<br />
        I copied it into the Plugins folder in the folder where NSIS is installed, but the compiler always says that "SimpleSC::Install" is an illegal command.<br />
        <br />
        Do I need to define somewhere in my NSIS Script that I want to use your dll? I was not able to find anything about this in the Wiki, this forum or with google.<br />
        Perhaps I'm blind ;)
      </blockquote>A good message to you: You are not blind ;). That was my mistake. The documentation (in the readme.txt and on the wiki) was wrong about the name of the install and remove function. Only in the example it was correct. The function names are:<br />

      <ul>
        <li>SimpleSC::InstallService<br />
        SimpleSC::RemoveService</li>
      </ul><br />
      IÂ´ve fixed it in the file and on the wiki.<br />
      <br />
      Best regards<br />
      <br />
      Rainer
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Andy1988</span><br />
      <span class="post-time small text-muted">29th May 2007 23:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Speed78</i><br />
        <b>Hello Andy,<br />
        <br />
        <br />
        <br />
        A good message to you: You are not blind ;). That was my mistake. The documentation (in the readme.txt and on the wiki) was wrong about the name of the install and remove function. Only in the example it was correct. The function names are:<br /></b>

        <ul>
          <li><b>SimpleSC::InstallService<br />
          SimpleSC::RemoveService</b></li>
        </ul><b><br />
        IÂ´ve fixed it in the file and on the wiki.<br />
        <br />
        Best regards<br />
        <br />
        Rainer</b>
      </blockquote>It's great to hear that there is nothing wrong with my eyes ;)<br />
      Now everything works like expected!<br />
      <br />
      BTW: Great plugin! And thank you for your work and fast help!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mr.hanky</span><br />
      <span class="post-time small text-muted">26th July 2007 20:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Request</strong><br />
      I think this is the best service plugin so far.<br />
      <br />
      I do have one request. An option that will show the config info.<br />
      Like the qc option does for SC.exe in windows<br />
      qc--------------Queries the configuration information for a service.<br />
      <br />
      The option I am looking for the most is to read BINARY_PATH_NAME<br />
      <br />
      Thanks again for the great plugin<br />
      Chris</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">26th July 2007 23:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello Chris,<br />
      <br />
      I will add a function like "GetServicePath" in the next release. I think I will release it next days.<br />
      <br />
      Best regards<br />
      <br />
      Rainer</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lushdog</span><br />
      <span class="post-time small text-muted">31st July 2007 19:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When I do a SimpleSC::RemoveService yet the service is still in the Services list. If I try to restart the service I get a "The specified service has been marked for deletion."<br />
      <br />
      The service is removed from the list upon the next reboot.<br />
      <br />
      The only reason I ask is I'd like to let the user uninstall/reinstall without rebooting.<br />
      <br />
      I believe the "sc delete" command removes the service without a reboot.<br />
      <br />
      Does your plugin use "sc" or some other command?<br />
      <br />
      Thanks in advance,<br />
      <br />
      Matt</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">1st August 2007 13:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi lushdog,<br />
      <br /></p>

      <blockquote>
        <i>Originally posted by lushdog</i><br />
        <b>When I do a SimpleSC::RemoveService yet the service is still in the Services list. If I try to restart the service I get a "The specified service has been marked for deletion."<br />
        <br />
        The service is removed from the list upon the next reboot.<br />
        <br />
        The only reason I ask is I'd like to let the user uninstall/reinstall without rebooting.<br />
        <br />
        I believe the "sc delete" command removes the service without a reboot.<br />
        <br />
        Does your plugin use "sc" or some other command?<br />
        <br />
        Thanks in advance,<br />
        <br />
        Matt</b>
      </blockquote>The plugin uses the windows api functions. I think you have removed the service during your service list windows was opened!? If the service list is opened this is a default behaviour. Try to close the service list window and remove the service and then open the service list. You will see that the service is removed.<br />
      <br />
      "sc" uses the same functions like my plugin so "sc" has the same behaviour.<br />
      <br />
      Please remember: You should stop the service before you removing it.<br />
      <br />
      Best Regards<br />
      <br />
      Rainer
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">2nd August 2007 20:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>New Version 1.03</strong><br />
      Hi,<br />
      <br />
      IÂ´ve released a new version of the NSIS Simple Service Plugin. The new version provides the function "SimpleSC::GetServiceBinaryPath" to get the binary path of a specified service.<br />
      <br />
      You can find more informations and download file on the wiki page (<a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a>).<br />
      <br />
      If you have any questions please let me now.<br />
      <br />
      Best regards<br />
      <br />
      Rainer</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">7th August 2007 16:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>New Version 1.04</strong><br />
      Hi,<br />
      <br />
      IÂ´ve released a new version of the NSIS Simple Service Plugin. This is an bugfix release that concerns to the functions StartService, StopService, ContinueService and PauseService. It is recommend to use this version of the plugin because it is possible that using this functions ends in an endless loop. This happens for example if the service doesnÂ´t start, stop aso. or e.g. the service crashes during startup (Function: StartService).<br />
      <br />
      You can find more informations and download file on the wiki page (<a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a>).<br />
      <br />
      If you have any questions please let me now.<br />
      <br />
      Best regards<br />
      <br />
      Rainer</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">9th January 2008 22:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello Rainer,<br />
      <br />
      this is a great plugin.<br />
      <br />
      I have a request:<br />
      Could you add an option to SimpleSC::StopService to stop dependant services first?<br />
      (Like the DOS command "net stop {ServiceName} /y".)<br />
      Have a look at http://support.microsoft.com/kb/245230 for an idea.<br />
      <br />
      Thanks in advance,<br />
      JP</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">10th January 2008 07:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello JP,<br />
      <br />
      I will add this feature in the next release.<br />
      <br />
      Best regards<br />
      <br />
      Rainer</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">12th January 2008 16:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>New Version 1.05</strong><br />
      Hi,<br />
      <br />
      IÂ´ve released a new version of the NSIS Simple Service Plugin. The functions SimpleSC::StopService and SimpleSC::RestartService are now improved. Now all dependent services are stopping recursively too. You can find more informations and download file on the wiki page (<a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a>).<br />
      <br />
      If you have any questions please let me now.<br />
      <br />
      Best regards<br />
      <br />
      Rainer</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">13th January 2008 11:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It would be very handy if you could add support for enabling desktop interaction when installing a service. This is ideal for Microsoft's srvany.exe executable which you can use to run any Windows executable as a service (silly enough though, the app that comes with it, instsrv.exe does not allow you to enable desktop interaction!)<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">13th January 2008 12:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello Stu,<br />
      <br />
      I will add the feature in the next release. This feature will only run on systems older than Windows Vista. Vista doesnÂ´t support desktop interaction anymore (See: <a href="http://msdn2.microsoft.com/en-us/library/ms683502" target="_blank">http://msdn2.microsoft.com/en-us/library/ms683502</a>(VS.85).aspx)<br />
      <br />
      Best regards<br />
      <br />
      Rainer</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">13th January 2008 13:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Righto thanks that's fine.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bradkohl</span><br />
      <span class="post-time small text-muted">14th January 2008 23:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Could you add the ability to start a service with a parameter? I tried adding my param to the end of the binary path and that didn't work.<br />
      <br />
      So far I like the plugin a lot, my only complaint is that it's a little bigger than other options like nsSCM and the ExistsService function seems to have odd return values compared to the other functions, the return value(1) seems more like a success case with that one, as opposed to the others which return (0) on success.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">15th January 2008 12:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try with a binary path as `"path\to\app.exe" params`<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">16th January 2008 11:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by bradkohl</i><br />
        <b>Could you add the ability to start a service with a parameter? I tried adding my param to the end of the binary path and that didn't work.<br /></b>
      </blockquote>What exactly did you mean? If you mean the "InstallService" function then you can use your parameter in the "[service_commandline]" parameter.<br />
      <br />
      For example:<br />
      <br />
      SimpleSC::InstallService "MyService" "My Service Display Name" "2" "C:\MyPath\MyService.exe /process=server" "" "" ""<br />
      Pop $0 ; return error(1)/success(0)<br />
      <br />
      If you mean a start parameter in the "StartService" function then you are right. At the moment it is not implemented yet. If you need this please let me now and I will add this functionality.<br />
      <br />

      <blockquote>
        [i]<br />
        So far I like the plugin a lot, my only complaint is that it's a little bigger than other options like nsSCM<br />
        [/B]
      </blockquote>I think this is not really a problem. This plugin provides more functions and the harddisk are very cheap.<br />
      <br />

      <blockquote>
        [i]<br />
        The ExistsService function seems to have odd return values compared to the other functions, the return value(1) seems more like a success case with that one, as opposed to the others which return (0) on success.<br />
        [/B]
      </blockquote>Yes, you are right. The reason for this is that the function returns "True" or "False" - "True" is 1 and "False" is 0. I think its ok because itÂ´s documented in the wiki.<br />
      <br />
      Best regards<br />
      <br />
      Rainer
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bradkohl</span><br />
      <span class="post-time small text-muted">18th January 2008 17:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks for the reply, you're right the added functionality and flexibility does make up for the size, and yes I was talking about service 'start' parameters. It would be great if you could add them but in the mean time, I've hardcoded the param I needed in the source.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">18th January 2008 19:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi bradkohl,<br />
      <br />
      I will add this functionality in the next release.<br />
      <br />
      Best Regards<br />
      <br />
      Rainer</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">29th January 2008 22:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>New Version 1.10</strong><br />
      Hi,<br />
      <br />
      IÂ´ve released a new version of the NSIS Simple Service Plugin. The changes are:<br />
      <br />
      - SimpleSC::InstallService supports now more than one dependencies (delimitter is the forward slash).<br />
      - SimpleSC::InstallService supports now more service types e.g. to create an interactive service.<br />
      - SimpleSC::StartService supports now arguments.<br />
      <br />
      <b>Note:</b> The signature of the functions SimpleSC::InstallService and SimpleSC::StartService has been changed. If you update from a previous version you must check your parameters.<br />
      <br />
      You can find more informations and download file on the wiki page (<a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a>).<br />
      <br />
      If you have any questions please let me now.<br />
      <br />
      Best regards<br />
      <br />
      Rainer</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pcrowley</span><br />
      <span class="post-time small text-muted">29th January 2008 23:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>One request</strong><br />
      I tried using this and got a consistent failure on creating a service. I need to create a kernel driver service which is a little different - the type is 1 rather than 16.<br />
      <br />
      Unfortunately, there doesn't seem to be a good way to get at the error returned. I might have been able to do a call with System to do a GetLastError, or maybe not. It would be very helpful to be able to get the reason for a failure. Even a new function like SimpleSC::GetError would be helpful.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">29th January 2008 23:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">calling GetLastError with system.dll will not work, you will get the wrong result</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">30th January 2008 09:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: One request</strong><br />
      Hi,<br />
      <br /></p>

      <blockquote>
        <b>Even a new function like SimpleSC::GetError would be helpful.</b>
      </blockquote>I think this function is helpful. I will add this in the next release.<br />
      <br />
      Did you installed your service successfully now?<br />
      <br />
      Best Regards<br />
      <br />
      Rainer
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">5th February 2008 19:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>New Version 1.20</strong><br />
      Hi,<br />
      <br />
      IÂ´ve released a new version of the NSIS Simple Service Plugin. The changes are:<br />
      <br />
      - Every function now returns &lt;&gt; 0 if there is an error. Use SimpleSC::GetErrorMessage to get the message of a function result<br />
      - Added function SimpleSC::GetErrorMessage to get the message of a function result<br />
      - SimpleSC::ExistsService results now 0 if the service exists and &lt;&gt; 0 if the service doensnÂ´t exists<br />
      - SimpleSC::RestartService supports now arguments.<br />
      <br />
      Note: The signature of the function SimpleSC::RestartService has been changed. If you update from a previous version you must check your parameters.<br />
      <br />
      You can find more informations and download file on the wiki page (<a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a>).<br />
      <br />
      If you have any questions please let me now.<br />
      <br />
      Best regards<br />
      <br />
      Rainer</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">9th February 2008 17:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm using the latest dll and SimpleSC::ExistsService is returning 0 when the service doesn't exist.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">9th February 2008 21:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Also RemoveService appears to be returning a value other than 0 on success rather than on failure.<br />
      <br />
      Edit: My bad on RemoveService. The other function still returns 1 when it exists though.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">10th February 2008 12:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>New Version 1.21</strong><br />
      Hi,<br />
      <br />
      IÂ´ve released a new version of the NSIS Simple Service Plugin. The changes are:<br />
      <br />
      - SimpleSC::ExistsService results now 0 if the service exists and &lt;&gt; 0 if the service doensnÂ´t exists<br />
      <br />
      You can find more informations and download file on the wiki page (<a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a>).<br />
      <br />
      Thanks to Stu for reporting this bug. If you have any questions please let me now.<br />
      <br />
      Best regards<br />
      <br />
      Rainer</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">10th February 2008 13:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you!<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">elllit</span><br />
      <span class="post-time small text-muted">4th July 2008 10:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      in my installer I want to stop and delete an already running service, install the data and then install and start it again.<br />
      <br />
      Everything is fine, until it comes to the stopping/deleting point. It passes without error but the process stays active for another ~20s (on my system), causing the installer to show a message that the file, that is about to be installed, is currently in use.<br />
      <br />
      The service actually does not exist anymore. So checking for existance does not work.<br />
      <br />
      Sleeping for a static 30sec is not satisfying at all.<br />
      <br />
      Using the nsProcess plug-in to see wether my service is still running or not might be a solution (will try it next). But I hope that there is a better out there.<br />
      <br />
      Any suggestions?<br />
      <br />
      -- Till</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">elllit</span><br />
      <span class="post-time small text-muted">4th July 2008 13:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>Edit:</b> Solved - Layer 8 issue *bangs the forehead on teh table*<br />
      <br />
      <br />
      ---<br />
      <br />
      Oh, there is another issue:<br />
      <br />
      Installing for the standard user works flawlessly. But giving an account name and password it fails with error code 1057 that is: "Account invalid or does not exist" or something... I triple checked the strings and even hardcoded them into the script w/o success. :-(<br />
      <br />
      Im trying to install on a 2003 Server if that might help.<br />
      <br />
      Thanks,<br />
      <br />
      -- Till</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
      <span class="post-time small text-muted">5th July 2008 12:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello Till,<br />
      <br /></p>

      <blockquote>
        Everything is fine, until it comes to the stopping/deleting point. It passes without error but the process stays active for another ~20s (on my system), causing the installer to show a message that the file, that is about to be installed, is currently in use.<br />
        <br />
        The service actually does not exist anymore. So checking for existance does not work.
      </blockquote>If the service doesnÂ´t exists (Stopped &amp; Uninstalled) the plugin has done his work. A question to figure out where the problem is:<br />
      <br />
      Please try to stop your service with the plugin (not to uninstall!). After that please open your process list and check for your service process. Please repeat the same steps with the service manager. Does the service process exists in the process list?<br />
      <br />
      <br />
      <br />

      <blockquote>
        Sleeping for a static 30sec is not satisfying at all.<br />
        <br />
        Using the nsProcess plug-in to see wether my service is still running or not might be a solution (will try it next). But I hope that there is a better out there.
      </blockquote>This is really nonsatisfying!<br />
      <br />
      Best regards<br />
      <br />
      Rainer
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">elllit</span><br />
      <span class="post-time small text-muted">22nd July 2008 12:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      first: sorry for the delay in answering your reply.<br />
      <br /></p>

      <blockquote>
        <i>Originally posted by Speed78</i><br />
        <b>Hello Till,<br />
        <br />
        If the service doesnÂ´t exists (Stopped &amp; Uninstalled) the plugin has done his work. A question to figure out where the problem is:<br />
        <br />
        Please try to stop your service with the plugin (not to uninstall!). After that please open your process list and check for your service process. Please repeat the same steps with the service manager. Does the service process exists in the process list?<br /></b>
      </blockquote>I actually did that, but somehow I did something that obviously has fixed the problem, because I never had that delay issue since then. :confused:<br />
      <br />
      Anyways... I now have a issue that seemed to work all the time but now giving me a hard time.<br />
      <br />
      This is the code i use to start a service<br />
      <br />
      <pre>
<code><br />    ${If} $S_StartNowInput == ${BST_CHECKED}<br />        DetailPrint `Starting service`<br />        LogEx::Write /NOUNLOAD `... starting`<br />        LogEx::Write /NOUNLOAD `... &gt;&gt;&gt; arguments: `<br />        SimpleSC::StartService "${s_name}" ""<br />        Pop $0<br />        ${If} $0 &lt;&gt; 0<br />            #SimpleSC::GetErrorMessage<br />            #Pop $0<br />            LogEx::Write /NOUNLOAD `... [InstallService] ERROR: $0`<br />            DetailPrint `Could not start service! - Reason: $0`<br />            Goto cancel<br />        ${EndIf}<br />    <br />        DetailPrint `... done`<br />    ${EndIf}<br /></code>
</pre><br />
      <br />
      This fragment is, with some more pieces, enclosed in a macro. Before starting the service it is installed without any sign of error. When it comes to starting it runs into the 30sec timeout (i guess) and gives me "1053" as result. Which in words means: "The service did not respond to the start or control request in a timely fashion" or something similar.<br />
      <br />
      I'm pretty confused because I couldn't track down the cause of this. I'm not that familiar with windows' service handling and thus not sure what to look for.<br />
      <br />
      Any ideas? Thanks in advance.<br />
      <br />
      Till
    </div>
    <hr />
    <!-- Bootstrap core CSS -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <div class="container">
      <!-- Put navigation bar here -->

      <ol class="breadcrumb">
        <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

        <li><a href="f-65.html">NSIS Discussion</a></li>

        <li class="active">NSIS Simple Service Plugin</li>
      </ol>

      <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=270562">NSIS Simple Service Plugin</a></p><br />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">22nd July 2008 14:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">This to me would suggest a problem with the service itself. I personally have had no problems with SimpleSC installing, starting, stopping or uninstalling services.<br />
        <br />
        I have seen that kind of error in a service that does not start the main thread in its start method.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">22nd July 2008 21:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hello Till,<br />
        <br />
        please try this script:<br />
        <br />
        ----------------------<br />
        Name "test"<br />
        OutFile "test.exe"<br />
        <br />
        !Define SERVICE "TapiSrv"<br />
        <br />
        Section<br />
        MessageBox MB_OK "NOTE: Result '0' means it was success otherwise '1'"<br />
        <br />
        MessageBox MB_OK "Starting Service: ${SERVICE}"<br />
        SimpleSC::StartService "${SERVICE}" ""<br />
        Pop $0<br />
        MessageBox MB_OK "Result: $0"<br />
        <br />
        SectionEnd<br />
        ----------------------<br />
        <br />
        This script will start the tapi service (In german: "Telefonie"... I donÂ´t know the name in english :( )<br />
        <br />
        I tested this script without any problems. If you also have no problems with this script I think the problem is your service. Can you check this and please give me a feedback!?<br />
        <br />
        Best regards<br />
        <br />
        Rainer</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">elllit</span><br />
        <span class="post-time small text-muted">23rd July 2008 08:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Speed78,<br />
        <br />
        thanks for helping me.<br />
        <br />
        The result your skript gives me is "1056".<br />
        <br />
        The service "Telefonie" is running on my system and I can't stop it apperently (Error "1053" again). When I try to stop it via the services control list it says it needs to stop "RAS-Verbindungsverwaltung" which has "Telefonie" as a dependency. This is where the error comes into place. I guess it is used in the background somehow(?).<br />
        <br />
        I'll talk with guys who code the service to check if the problem is on that side, following Afrow UK's suggestion which I also considered as another spot to search for a solution. But trying to find the error on oneself is the first way to go, isn't it? ;)<br />
        <br />
        Till</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">elllit</span><br />
        <span class="post-time small text-muted">23rd July 2008 11:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Update:<br />
        <br />
        I manged to get one service running with the help of a developer. The problem was that a dependency wasn given for the service, which I didn't know about.<br />
        <br />
        Anyways, installing the other service mine is depending on solved the problem.<br />
        <br />
        I hope its as "easy" with the other service. I will ask the colleague on monday and report about it.<br />
        <br />
        I apology for bothering you as it was a fault on my side ;)</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">elunkes</span><br />
        <span class="post-time small text-muted">14th August 2008 22:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">How can i get the LOGON NAME in a service<br />
        <br />
        we have<br />
        <br />
        SimpleSC::SetServiceLogon [name_of_service] [account] [password]<br />
        <br />
        but i want something like this<br />
        <br />
        GetServiceLogon (or something)<br />
        <br />
        can ai get it ?</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">15th August 2008 03:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi,<br />
        <br />
        the next day I will released a new version of the plugin. I will implement this function in the new version.<br />
        <br />
        Best regards<br />
        <br />
        Rainer</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">17th August 2008 18:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>New Version 1.22</strong><br />
        Hi,<br />
        <br />
        IÂ´ve released a new version of the NSIS Simple Service Plugin. The changes are:<br />
        <br />
        <br />
        - SimpleSC::GrantServiceLogonPrivilege and SimpleSC::RemoveServiceLogonPrivilege works now correct with domain names like MyDomain\MyUser.<br />
        <br />
        - Added function SimpleSC::GetServiceLogon to get the logon username of a service.<br />
        <br />
        <br />
        You can find more informations and download file on the wiki page (<a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a>).<br />
        <br />
        Thanks to everyone for reporting bugs and requesting features. If you have any questions please let me now.<br />
        <br />
        Best regards<br />
        <br />
        Rainer</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">elunkes</span><br />
        <span class="post-time small text-muted">18th August 2008 15:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi Speed78,<br />
        <br />
        this version of SimpleSC was detected as a TROJAN when i used it in my compilation script<br />
        <br />
        With version 1.21 there is no problem (but also there is no new functions)<br />
        <br />
        without a antivirus , the new functions works right.<br />
        <br />
        i'm using "Avast" in my computer.<br />
        <br />
        could you review this version 1.22?<br />
        <br />
        thank you</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">18th August 2008 18:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi,<br />
        <br />
        IÂ´ve checked the file and here the results.<br />
        <br />
        <br />
        <a href="http://www.virustotal.com/en/analisis/8f9c4252847f6e00f64b4943e04615dd" target="_blank">http://www.virustotal.com/en/analisi...4b4943e04615dd</a><br />
        <br />
        IÂ´ve contacted AntiVir and Webwasher. AntiVir gave me the answer that the file is a FALSE-POSITIVE File and that they will modify the virus definitions. Webwasher gave me no answer at the moment.<br />
        <br />
        IÂ´m really confused about this because I only change some lines in the code and the scanner found a "pseudo"-virus.<br />
        <br />
        I couldnÂ´t determine some problems with "Avast". So you can take a look to the VirusTotal-URL.<br />
        <br />
        Best regards<br />
        <br />
        Rainer</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">18th August 2008 20:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>New Version 1.23</strong><br />
        Hi,<br />
        <br />
        IÂ´ve released a new version of the NSIS Simple Service Plugin. I detected that the compiler optimazation results in a false-positive virusscan, so IÂ´ve removed it a I hope the problem is solved now.<br />
        <br />
        You can find more informations and download file on the wiki page (<a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a>).<br />
        <br />
        Thanks to everyone for reporting bugs and requesting features. If you have any questions please let me now.<br />
        <br />
        Best regards<br />
        <br />
        Rainer</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">elunkes</span><br />
        <span class="post-time small text-muted">19th August 2008 01:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Now it works fine!!<br />
        <br />
        thank you!</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">phunkydizco</span><br />
        <span class="post-time small text-muted">12th February 2009 12:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I have a service that takes some time to stop. How can I stop the service and wait until it is really stopped?</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">12th February 2009 16:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hello,<br />
        <br />
        take a look at the documentation: <a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a><br />
        <br />
        The "SimpleSC::StopService"-Function is what you are searching for.<br />
        <br />
        Kind regards<br />
        <br />
        Rainer</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">13th April 2009 12:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>New Version 1.24</strong><br />
        Hi,<br />
        <br />
        IÂ´ve released a new version of the NSIS Simple Service Plugin. The changes are:<br />
        <br />
        <br />
        - Fixed wait for status bug if the service status changed. Now, if a service stops, starts aso. the plugin will work like the recommendations in the MSDN. On some systems (especially 64Bit systems) the plugin returns "Stopped" although the service was not really stopped.<br />
        <br />
        It is recommend to update your version of this plugin. You can find more informations and download file on the wiki page (<a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a>).<br />
        <br />
        If you have any questions please let me now.<br />
        <br />
        Best regards<br />
        <br />
        Rainer</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">amclellan</span><br />
        <span class="post-time small text-muted">18th April 2009 18:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Setting only the binary path</strong><br />
        I've been using version 1.24 of SimpleSC and I really appreciate it's ease of use. I'm currently working on a issue where the a service has been previously installed and now I'm trying to update only the binary path if it happened to be installed in a different location without changing the other settings associated with the service. Is there a SetServiceBinaryPath or some other way of performing this action.<br />
        <br />
        Thanks<br />
        <br />
        Allan McLellan</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">18th April 2009 18:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hello Allan,<br />
        <br />
        unfortunately, there is no possiblity to change the binary path. At the moment I recommend the following procedure:<br />
        <br />
        1. Deinstall the service old "RemoveService"<br />
        2. Install the new service with the new binary path "InstallService".<br />
        <br />
        Nethertheless, I will add the method "SetServiceBinaryPath" in the next version of this plugin, but this will take some weeks.<br />
        <br />
        Kind regards<br />
        <br />
        Rainer</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">amclellan</span><br />
        <span class="post-time small text-muted">18th April 2009 19:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi<br />
        <br />
        Thanks for getting back to me so quickly. I'm currently checking to see if the new binary path equals the old binary path and if they don't then pop up a message box requiring the user to manually go in and change it via the service manager. It's not the nicest, but it doesn't really happen all that often. Again thanks for the quick response.<br />
        <br />
        Allan</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">18th April 2009 19:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hello Allan,<br />
        <br />
        I think to compare the binary path of the old service with the new service is a good idea. But if the paths are not equal I think itÂ´s more comfortable just to remove the old service (Take a look at SimpleSC::RemoveService) and install it again (Take a look at SimpleSC::InstallService). I think this should work. At the moment there is not possiblity to change the binary path in the service manager directly (AFAIK until Windows 2003). So the only way to change it is via command line "sc.exe".<br />
        <br />
        Kind regards<br />
        <br />
        Rainer</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">saill</span><br />
        <span class="post-time small text-muted">22nd April 2009 02:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>

        <blockquote>
          <i>Originally posted by elllit</i><br />
          <b><br />
          <br />
          Installing for the standard user works flawlessly. But giving an account name and password it fails with error code 1057 that is: "Account invalid or does not exist" or something... I triple checked the strings and even hardcoded them into the script w/o success. :-(<br />
          <br />
          Im trying to install on a 2003 Server if that might help.<br />
          <br />
          Thanks,<br />
          <br />
          -- Till</b>
        </blockquote>Hi Till,<br />
        <br />
        We ran into the same problem. Turns out Windows wants the account name to be preceded by ".\". We figured this out by having Windows report the account owning the service. This works on XP, we're hopeful it will hold for other Windows platforms.<br />
        <br />
        Just to be safe, we started the service as admin, then set service logon to the desired account.<br />
        <br />
        The code that worked looks like this:<br />
        <br />
        <i>SimpleSC::InstallService "MyService" "My Service Display Name" "272" "2" "C:\MyPath\MyService.exe" "" "" ""<br />
        <br />
        SimpleSC::SetServiceLogon "MyService" ".\MyServiceUser" "MyServiceUserPassword"<br />
        Pop $0 ; returns an errorcode (&lt;&gt;0) otherwise success (0)<br />
        IntCmp $0 0 +1 Done Done ; If successful grant the service logon privilege to "MyServiceUser"<br />
        ; Note: Every serviceuser must have the ServiceLogonPrivilege to start the service<br />
        SimpleSC::GrantServiceLogonPrivilege ".\MyServiceUser"<br />
        Pop $0 ; returns an errorcode (&lt;&gt;0) otherwise success (0)<br />
        Done:<br /></i><br />
        <br />
        Rainer, thanks for the great tool. Really saved our butts with this particular bug!<br />
        <br />
        Saill
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">22nd April 2009 16:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi Saill,<br />
        <br />
        if I understand you correctly your problem with SetServiceLogon is ".\"-prefix of a non domain-account? I will check this for the next plugin-version.<br />
        <br />
        Kind regards,<br />
        <br />
        Rainer</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">saill</span><br />
        <span class="post-time small text-muted">22nd April 2009 21:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi Rainer,<br />
        <br />
        Exactly. My experiments show that any for any [account] input you need to add the ".\" prefix. Once you do that, it works great.<br />
        <br />
        No real need to fix it - a note in the documentation should do the trick.<br />
        <br />
        Thanks a lot for the tool. We used it to make sure that our service was owned by the current user so we could kill our runtime cleanly at shutdown. Solved one of our trickiest Windows bugs!<br />
        <br />
        Warm regards,<br />
        <br />
        Saill</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">23rd April 2009 17:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hello Saill,<br />
        <br />
        I changed it in the online documentation but addionally I will change this in the next version.<br />
        <br />
        Kind regards<br />
        <br />
        Rainer</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">saill</span><br />
        <span class="post-time small text-muted">24th April 2009 19:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi Rainer,<br />
        <br />
        That's great! I believe the .\ prefix is also necessary in the "account" input for:<br />
        <br />
        SimpleSC::InstallSevice<br />
        SimpleSC::GrantServiceLogonPrivilege<br />
        SimpleSC::RemoveServiceLogonPrivilege<br />
        <br />
        Warm regards,<br />
        <br />
        Saill</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Sadeesh</span><br />
        <span class="post-time small text-muted">11th May 2009 06:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>1053 Error while starting the service</strong><br />
        Hi,<br />
        <br />
        I am trying to install a bat file as service.<br />
        I am able to create the service, but i am not able to start the service via script.<br />
        When i try to start the service manually i get the following windows error message.<br />
        <br />
        "1053 service did not respond to the start or control request in a timely fashion"<br />
        <br />
        Can anyone help me to fix this?<br />
        <br />
        Thanks in advance,<br />
        Sadeesh</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
        <span class="post-time small text-muted">11th May 2009 10:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">You can't use a batch file as a service. Not every program can be used as a service. It must be specifically designed for this purpose. There are some helpers that can turn any application to a service. Google "turn any application to a service" or something similar and you should be able to find them.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">pineapplex</span><br />
        <span class="post-time small text-muted">12th May 2009 08:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Batch file as service</strong><br />
        I found a solution in order to use a Batch file as service. I used Flash Mx to create an EXE file that contains a FSCommand opening the Batch file. At last, the batch file is working as service.<br />
        <br />
        I hope it works for you.<br />
        <br />
        But I have another question:<br />
        <br />
        I have a service running (not a batch file, of course). What's the best way to "interact" with the service? I have the service running but I can't find the way to open my application and change some config parameters, for example.<br />
        <br />
        Can you help me with this issue?<br />
        <br />
        I'm sorry for my english. I hope you can understand me.<br />
        <br />
        Best wishes from Spain.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">aerDNA</span><br />
        <span class="post-time small text-muted">15th May 2009 21:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>v1.24 - WZCSVC problem</strong><br />
        Version 1.24 has a problem (at least on my system) with stopping the Wireless Zero Configuration.<br />
        SimpleSC::StopService "WZCSVC" does stop the service but is unaware of the status change and returns an error after the 30 s timeout ("The service did not respond to the start or control request in a timely fashion").<br />
        I tried several other windows services and there was no such problem. Version 1.23 deals with WZCSVC successfully. My system is XP SP2 but Wireless Zero Configuration has been updated (hotfix KB917021).</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">21st May 2009 16:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>New Version 1.25</strong><br />
        Hi,<br />
        <br />
        IÂ´ve released a new version of the NSIS Simple Service Plugin. The changes are:<br />
        <br />
        - SimpleSC::SetServiceLogon supports now non-domain username without the ".\"-prefix<br />
        - SimpleSC::SetServiceBinaryPath function added<br />
        <br />
        You can find more informations and download file on the wiki page (<a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a>).<br />
        <br />
        If you have any questions please let me now.<br />
        <br />
        Kind regards<br />
        <br />
        Rainer</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">21st May 2009 16:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Re: v1.24 - WZCSVC problem</strong><br />
        Hello,<br />
        <br /></p>

        <blockquote>
          <i>Originally posted by aerDNA</i><br />
          <b>Version 1.24 has a problem (at least on my system) with stopping the Wireless Zero Configuration.<br />
          SimpleSC::StopService "WZCSVC" does stop the service but is unaware of the status change and returns an error after the 30 s timeout ("The service did not respond to the start or control request in a timely fashion").<br />
          I tried several other windows services and there was no such problem. Version 1.23 deals with WZCSVC successfully. My system is XP SP2 but Wireless Zero Configuration has been updated (hotfix KB917021).</b>
        </blockquote>sry... I read this just now after releasing 1.25. I will check this on XP SP2 the next days. If you stop your service manually (via service control center) how much time takes it to stop the service (&gt; 30 seconds) ?<br />
        <br />
        Kind regards<br />
        <br />
        Rainer
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">aerDNA</span><br />
        <span class="post-time small text-muted">21st May 2009 16:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Re: Re: v1.24 - WZCSVC problem</strong><br /></p>

        <blockquote>
          <i>Originally posted by Speed78</i><br />
          If you stop your service manually (via service control center) how much time takes it to stop the service (&gt; 30 seconds) ?
        </blockquote>When stopped manually, everything's ok (takes about 2 sec). With SimpleSC 1.23 it's also fine. The problem is with v1.24-1.25. Starting the service works ok in new versions, although it takes several seconds longer than with 1.23.
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">pineapplex</span><br />
        <span class="post-time small text-muted">21st May 2009 18:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi Rainer,<br />
        <br />
        What's the best way to "interact" with the service? I have the service running but I can't find the way to open my application and change some config parameters, for example.<br />
        <br />
        Excuse me for my "stupid" question but I'm starting to use NSIS and I can't find a solution for this issue.<br />
        <br />
        Thanks in advance.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">21st May 2009 20:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Re: Re: Re: v1.24 - WZCSVC problem</strong><br />
        Hi aerDNA,<br />
        <br /></p>

        <blockquote>
          <i>Originally posted by aerDNA</i><br />
          <b>When stopped manually, everything's ok (takes about 2 sec). With SimpleSC 1.23 it's also fine. The problem is with v1.24-1.25. Starting the service works ok in new versions, although it takes several seconds longer than with 1.23.</b>
        </blockquote>IÂ´ve changed the code stop-service in version 1.24 because on some conditions the service doesnÂ´t stop correctly. So please can you give me the following information:<br />
        <br />
        Please try to stop the service via the plugin &gt;= 1.24. Open during stopping the service the service control manager and take a look to the service at the "Status"-column. Which state do you see? "Stopping..."?<br />
        <br />
        Did the service have dependencies?<br />
        <br />
        Kind regards<br />
        <br />
        Rainer
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">21st May 2009 20:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi pineapplex,<br />
        <br /></p>

        <blockquote>
          <i>Originally posted by pineapplex</i><br />
          <b>Hi Rainer,<br />
          <br />
          What's the best way to "interact" with the service? I have the service running but I can't find the way to open my application and change some config parameters, for example.<br />
          <br />
          Excuse me for my "stupid" question but I'm starting to use NSIS and I can't find a solution for this issue.<br />
          <br />
          Thanks in advance.</b>
        </blockquote>there are several solutions to communicate with a service. You can use a TCP/IP socket, named pipes or shared memory. This depends on your knowledge about this methods and your service requirements.<br />
        <br />
        Use this topics (TCP/IP socket, named pipes or shared memory) to get more addionally informations for you programming language.<br />
        <br />
        Kind regards<br />
        <br />
        Rainer
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">21st May 2009 20:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Re: Re: Re: Re: v1.24 - WZCSVC problem</strong><br />
        Hi aerDNA,<br />
        <br /></p>

        <blockquote>
          <i>Originally posted by Speed78</i><br />
          <b>Hi aerDNA,<br />
          <br />
          <br />
          <br />
          IÂ´ve changed the code stop-service in version 1.24 because on some conditions the service doesnÂ´t stop correctly. So please can you give me the following information:<br />
          <br />
          Please try to stop the service via the plugin &gt;= 1.24. Open during stopping the service the service control manager and take a look to the service at the "Status"-column. Which state do you see? "Stopping..."?<br />
          <br />
          Did the service have dependencies?<br />
          <br />
          Kind regards<br />
          <br />
          Rainer</b>
        </blockquote>I can reproduce your behaviour now and I will fix asap.<br />
        <br />
        Kind regards<br />
        <br />
        Rainer
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">21st May 2009 21:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>New Version 1.26</strong><br />
        Hi,<br />
        <br />
        IÂ´ve released a new version of the NSIS Simple Service Plugin. The changes are:<br />
        <br />
        - Fixed wait for status bug on starting, stopping, pausing or continuing a service<br />
        <br />
        You can find more informations and download file on the wiki page (<a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a>).<br />
        <br />
        Thanks to aerDNA for reporting this bug. If you have any questions please let me now.<br />
        <br />
        Kind regards<br />
        <br />
        Rainer</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">aerDNA</span><br />
        <span class="post-time small text-muted">22nd May 2009 15:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Glad I could help. There are several service plugins but personally I prefer yours. I used it to make a little util aimed specifically at managing WZC / WLAN Autoconfig. Compiled with v1.26 and works like a charm. So thank <b>you</b>.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">kalix11</span><br />
        <span class="post-time small text-muted">27th May 2009 16:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I tried using V1.26 to Set Logon account info for the Service and was not able to do it. When I visited your plugin page at <a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a> and found there is a note: The function "SetServiceLogon" only works if the servicetype is "SERVICE_WIN32_OWN_PROCESS"<br />
        <br />
        Would you please explain a little more about this servicetype? And how do I check and adjust the servicetype? Thanks a lot.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">27th May 2009 18:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hello kalix11,<br />
        <br /></p>

        <blockquote>
          <i>Originally posted by kalix11</i><br />
          <b>I tried using V1.26 to Set Logon account info for the Service and was not able to do it. When I visited your plugin page at <a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a> and found there is a note: The function "SetServiceLogon" only works if the servicetype is "SERVICE_WIN32_OWN_PROCESS"</b>
        </blockquote>At the moment there is no possibility to get or set the service type. I would add these functions in the next version of the plugin.<br />
        <br />
        If you create a service on your own you should know the service type.<br />
        <br />
        Some useful link about the service type can be found here:<br />
        <br />
        <a href="http://msdn.microsoft.com/en-us/library/ms681987" target="_blank">http://msdn.microsoft.com/en-us/library/ms681987</a>(VS.85).aspx<br />
        <br />
        See "lpServiceStartName [in, optional]" - lpServiceStartName is the username!<br />
        <br />
        Kind regards<br />
        <br />
        Rainer
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">kalix11</span><br />
        <span class="post-time small text-muted">27th May 2009 18:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thank you for your reply. I checked my service using some 3rd party tool and found the servicetype is SERVICE_WIN32_OWN_PROCESS. Can you think of any reason why SetServiceLogon is not working? I tried username with ".\" or without ".\", all the same results. Or should I first grant LogonAsService privilege to the user account before I call SetServiceLogon?</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">27th May 2009 18:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi kalix11,<br />
        <br /></p>

        <blockquote>
          <i>Originally posted by kalix11</i><br />
          <b>Thank you for your reply. I checked my service using some 3rd party tool and found the servicetype is SERVICE_WIN32_OWN_PROCESS. Can you think of any reason why SetServiceLogon is not working? I tried username with ".\" or without ".\", all the same results. Or should I first grant LogonAsService privilege to the user account before I call SetServiceLogon?</b>
        </blockquote>You donÂ´t need this "\."-prefix in version 1.26 and you donÂ´t need grant service logon before SetServiceLogon.<br />
        <br />
        Make sure that the user exists. If the user exists please please check the error result using the GetErrorMessage-Function like in this example:<br />
        <br />
        SimpleSC::SetServiceLogon "MyService" "MyServiceUser" "MyServiceUserPassword"<br />
        Pop $0 ; returns an errorcode (&lt;&gt;0) otherwise success (0)<br />
        IntCmp $0 0 Done +1 +1<br />
        Push $0<br />
        SimpleSC::GetErrorMessage<br />
        Pop $0<br />
        MessageBox MB_OK|MB_ICONSTOP "SetServiceLogon fails - Reason: $0"<br />
        Done:<br />
        <br />
        Kind regards<br />
        <br />
        Rainer
      </div>
      <hr />
      <!-- Bootstrap core CSS -->
      <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
      <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

      <div class="container">
        <!-- Put navigation bar here -->

        <ol class="breadcrumb">
          <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

          <li><a href="f-65.html">NSIS Discussion</a></li>

          <li class="active">NSIS Simple Service Plugin</li>
        </ol>

        <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=270562">NSIS Simple Service Plugin</a></p><br />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">kalix11</span><br />
          <span class="post-time small text-muted">27th May 2009 21:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Thanks for the quick reply. I used your code and found out the reason is : The account name is invalid or does not exist, or the password is invalid for the account name specified.<br />
          <br />
          However, I'm pretty sure I'm using an existing account and provided right password. I also create a test account and it still failed. Any thoughts on it?</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
          <span class="post-time small text-muted">27th May 2009 22:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Hi,<br />
          <br /></p>

          <blockquote>
            <i>Originally posted by kalix11</i><br />
            <b>Thanks for the quick reply. I used your code and found out the reason is : The account name is invalid or does not exist, or the password is invalid for the account name specified.<br />
            <br />
            However, I'm pretty sure I'm using an existing account and provided right password. I also create a test account and it still failed. Any thoughts on it?</b>
          </blockquote>Can you give me the account name? Is this a domain account, then you have to use domain\user - syntax!? Does the name contains some specail characters? Remark: The plugin is not a unicode plugin!<br />
          <br />
          Kind regards<br />
          <br />
          Rainer
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">kalix11</span><br />
          <span class="post-time small text-muted">27th May 2009 22:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">The test account is just called "test" with password the same. Nothing fancy, just a proof of concept.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
          <span class="post-time small text-muted">27th May 2009 22:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Hi,<br />
          <br /></p>

          <blockquote>
            <i>Originally posted by kalix11</i><br />
            <b>The test account is just called "test" with password the same. Nothing fancy, just a proof of concept.</b>
          </blockquote>I canÂ´t reproduce it. I have created on Windows Vista and Windows XP a local user called "test" with the same password and used the function without any problems!<br />
          <br />
          So please can you give me the following informations:<br />
          <br />
          1. Which NSIS Version do you use?<br />
          2. Which OS + SP + Language are you using?<br />
          3. Please can you post your NSIS setup lines here. If possible can you send me a sample setup to <a href="mailto:rainer@speed-soft.de">rainer@speed-soft.de</a><br />
          <br />
          Kind regards<br />
          <br />
          Rainer
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">kalix11</span><br />
          <span class="post-time small text-muted">27th May 2009 23:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Thank you so much for your time. I'll try to clean up other stuffs and give you only what it needs to reproduce the error and send you the email. Thanks again.<br />
          <br />
          BTW, the service was created using a java service wrapper from <a href="http://wrapper.tanukisoftware.org/." target="_blank">http://wrapper.tanukisoftware.org/.</a> I don't know whether this would make any difference.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">kalix11</span><br />
          <span class="post-time small text-muted">29th May 2009 19:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Rainer is the MAN! Eventually there was an error in my code not passing the correct username and password. No wonder it would fail. There is nothing wrong with the plug-in.<br />
          <br />
          Rainer rocks!!!</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">disruptor108</span><br />
          <span class="post-time small text-muted">1st July 2009 23:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            <i>Originally posted by elllit</i><br />
            <b>Hi,<br />
            <br />
            first: sorry for the delay in answering your reply.<br />
            <br />
            <br />
            <br />
            I actually did that, but somehow I did something that obviously has fixed the problem, because I never had that delay issue since then. :confused:<br />
            <br />
            Anyways... I now have a issue that seemed to work all the time but now giving me a hard time.<br />
            <br />
            This is the code i use to start a service<br />
            <br /></b>
            <pre>
<b><code><br />    ${If} $S_StartNowInput == ${BST_CHECKED}<br />        DetailPrint `Starting service`<br />        LogEx::Write /NOUNLOAD `... starting`<br />        LogEx::Write /NOUNLOAD `... &gt;&gt;&gt; arguments: `<br />        SimpleSC::StartService "${s_name}" ""<br />        Pop $0<br />        ${If} $0 &lt;&gt; 0<br />            #SimpleSC::GetErrorMessage<br />            #Pop $0<br />            LogEx::Write /NOUNLOAD `... [InstallService] ERROR: $0`<br />            DetailPrint `Could not start service! - Reason: $0`<br />            Goto cancel<br />        ${EndIf}<br />    <br />        DetailPrint `... done`<br />    ${EndIf}<br /></code></b>
</pre><b><br />
            <br />
            This fragment is, with some more pieces, enclosed in a macro. Before starting the service it is installed without any sign of error. When it comes to starting it runs into the 30sec timeout (i guess) and gives me "1053" as result. Which in words means: "The service did not respond to the start or control request in a timely fashion" or something similar.<br />
            <br />
            I'm pretty confused because I couldn't track down the cause of this. I'm not that familiar with windows' service handling and thus not sure what to look for.<br />
            <br />
            Any ideas? Thanks in advance.<br />
            <br />
            Till</b>
          </blockquote>I understand that this post may be over a year old, but I was having the same issue. When installing my service it would throw a 1053 error when trying to start.<br />
          <br />
          I found the solution was to register the service:<br />
          <br />
          <pre>
<code>ExecWait '"$INSTDIR\${PRODUCT_NAME}\Product.exe" /service'</code>
</pre><br />
          <br />
          After doing this, SimpleSC::StartService worked just fine.
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
          <span class="post-time small text-muted">2nd July 2009 17:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Hello,<br />
          <br />
          Quote:</p>
          <hr />
          the problem of elllit was that there exists services which depends on his service. Because of that the service doesnÂ´t start.<br />
          <br />
          I think your problem was that your service wasnÂ´t installed. Because of this your service doesnÂ´t start. You can use your method which works of course or you can use the method SimpleSC::InstallService which is the general method for every service. However, you need to install the service first and after this you can start the service.<br />
          <br />
          Kind regards<br />
          <br />
          Rainer

          <table cellpadding="6" cellspacing="0" border="0" width="100%">
            <tr>
              <td class="alt2">
                <hr />
                <i>Originally posted by disruptor108</i><br />
                I found the solution was to register the service:<br />
                <br />
                <pre>
<code>ExecWait '"$INSTDIR\${PRODUCT_NAME}\Product.exe" /service'</code>
</pre><br />
                <br />
                After doing this, SimpleSC::StartService worked just fine.
                <hr />
              </td>
            </tr>
          </table><br />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">janvi</span><br />
            <span class="post-time small text-muted">11th November 2009 13:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi Rainer,<br />
            <br />
            I m new to NSIS Script and I have been trying to install a Windows Service using your service plugin. I want to run a JAR file, rather than an exe, when the service starts.<br />
            The service gets installed but I m not able to get it started. Whenever the installed service is started an error pops up saying "Could not start MyService service on Local Computer. Error 193: 0xc1".<br />
            I know the fact that this error comes up if the application is not valid Win32 application but I dont find any issues with my attempt of installation.<br />
            Using NSIS script I m placing (installing) the required files into installation directory and using service plugin I install it where the &lt;binary_path&gt; value in SimpleSC::InstallService points to the JAR file placed in the installation directory.<br />
            Can you please guide me?<br />
            <br />
            Thank You,<br />
            Janvi</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
            <span class="post-time small text-muted">11th November 2009 14:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I'd expect you would need to execute java with the jar as a parameter. Jar files aren't executable by themselves.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">janvi</span><br />
            <span class="post-time small text-muted">12th November 2009 06:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi MSG,<br />
            <br />
            Thank you for replying. I tried what you said but it turned out to be a vain attempt. It's still not working. I guess the problem is not because of the JAR file.<br />
            <br />
            I tried a different scenario to check if the JAR file is causing the problem. I tried to run notepad.exe as a service. This time a different error message popped up saying "Error 1053: The service didn't respond in timely fashion."<br />
            <br />
            I have kept the script as simple as possible so that it remains less error prone.<br />
            Following is the script; please guide me if you find anything wrong:<br />
            <br />
            <b>&lt;Script&gt;</b><br />
            <br />
            Name "TestService"<br />
            OutFile "TestService.exe"<br />
            <br />
            InstallDir '$PROGRAMFILES\TestService'<br />
            <br />
            SetCompress Auto<br />
            SetDateSave On<br />
            SetDataBlockOptimize On<br />
            SetOverwrite on<br />
            <br />
            Section<br />
            SetOutPath $INSTDIR<br />
            File 'F:\Projects\JavaService.jar'<br />
            File 'F:\Projects\notepad.exe'<br />
            <br />
            # SimpleSC::InstallService [name_of_service] [display_name] [service_type] [start_type]<br />
            # [binary_path] [dependencies] [account] [password]<br />
            <br />
            SimpleSC::InstallService "TestService" "TestService" "16" "2"\<br />
            "$INSTDIR\JavaService.jar" "" "" ""<br />
            Pop $0 ; returns an errorcode (&lt;&gt;0) otherwise success (0)<br />
            detailprint $0<br />
            <br />
            # Start service<br />
            SimpleSC::StartService "TestService"<br />
            Pop $0 ; returns an errorcode (&lt;&gt;0) otherwise success (0)<br />
            detailprint $0<br />
            <br />
            <b>&lt;/Script&gt;</b><br />
            <br />
            I dont understand what's wrong. Please help..<br />
            <br />
            Thank You,<br />
            Janvi</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">janvi</span><br />
            <span class="post-time small text-muted">12th November 2009 09:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi,<br />
            <br />
            Just some update.. I converted my JAR file into an exe using Jar2Exe tool. Now, using the same script I m able to run this exe as Windows Service. Any clue??<br />
            <br />
            Thank You,<br />
            Janvi</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">janvi</span><br />
            <span class="post-time small text-muted">15th November 2009 13:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi..<br />
            Can anyone please guide me to solve the problem i'm facing?<br />
            Any help will be greatly appreciated.<br />
            <br />
            Thank You,<br />
            Janvi</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
            <span class="post-time small text-muted">15th November 2009 14:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Since a service has to communicate with the OS (like "I'm still running"), I think it's not possible to install a jar file as service.<br />
            <br />
            See the following for more info / what you can try:<br />
            <br />
            <a href="http://edn.embarcadero.com/article/32068" target="_blank">http://edn.embarcadero.com/article/32068</a><br />
            <a href="http://www.coderanch.com/t/429680/General-Computing/start-executable-jar-as-Windows" target="_blank">http://www.coderanch.com/t/429680/Ge...jar-as-Windows</a></p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">yudyzhao</span><br />
            <span class="post-time small text-muted">4th February 2010 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I has another issue with SimpleSC.dll. I installed the Unicode NSIS, then SimpleSC::ServiceIsRunning always return the service status is stopped (0) no matter my service is running or not.<br />
            <br />
            Speed78, is there Unicode SimpleSC plug-in available? So urgent need this.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
            <span class="post-time small text-muted">4th February 2010 20:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">As far as I know SimpleSC is not available in Unicode.<br />
            <br />
            As a workaround to find if a service is running you can use:</p>
            <pre>
<code>   !include "WordFunc.nsh"<br />   Var Service<br />   .<br />   .<br />   .<br />   ; inside function / section<br />   StrCpy $Service "ServiceName"<br /><br />   Push "ExecDos::End" # Add a marker for the loop to test for.<br />   ExecDos::exec /TIMEOUT=2000 /TOSTACK 'sc.exe query "$Service"' "" ""<br />   Pop $0 # return value<br />   StrCmp $0 0 0 NotRunning<br />   ## Loop through stack.<br />   StrCpy $2 0<br />   Loop:<br />      Pop $1<br />      StrCmp $1 "ExecDos::End" ExitLoop<br />      ${WordFind} "$1" "RUNNING" "*" $3<br />      Intcmp $3 0 NotFound NotFound<br />      IntOp $2 $2 + 1<br />      NotFound:<br />      StrCpy $3 "0"<br />      Goto Loop<br />   ExitLoop:<br />   IntCmp $2 0 NotRunning NotRunning Running<br />   NotRunning:<br />      DetailPrint "$Service is not running"<br />      Goto End<br />   Running:<br />      DetailPrint "$Service is running"<br />      Goto End<br />   End:</code>
</pre>Hope this helps.<br />
            (The ExecDos plugin is available for unicode:<br />
            <a href="http://forums.winamp.com/showthread.php?threadid=181442" target="_blank">http://forums.winamp.com/showthread.php?threadid=181442</a>)
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">yudyzhao</span><br />
            <span class="post-time small text-muted">5th February 2010 09:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Thanks for help.<br />
            But ExceDos (Unicode version)cannot find the running windows service as well... no clue what wrong with it<br />
            :eek:</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
            <span class="post-time small text-muted">5th February 2010 09:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">OK.<br />
            <br />
            Well, I didn't test this in Unicode, but what's the output of ExecDos?<br />
            (Add DetailPrint "$1" after Pop $1 in the loop to see what it is)</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Ebi70</span><br />
            <span class="post-time small text-muted">12th July 2010 08:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>Problem after deleting and then Install a service</strong><br />
            Hello together,<br />
            <br />
            I have following problem with the simplesc plugin.<br />
            I install my service with installutil of .net, because when I try to install with simplesc, then the services will hnot start, I think this is because that the dependencies are not correct updated.<br />
            Anyway, when I install my service with installutil, update then the logon with:<br />
            SimpleSC::SetServiceLogon "&lt;name&gt;" "$USER_NAME" "$USER_PASSWORD"<br />
            <br />
            everything works fine.<br />
            Then I start my installer again and update my installation.<br />
            Within the "Function preuninstall_function" i stop the services if they are running with:<br />
            SimpleSC::StopService "&lt;name&gt;"<br />
            and then remove the service with:<br />
            SimpleSC::RemoveService "&lt;name&gt;" or again with<br />
            installutil of .net (makes no sense what I use, the service is removed from the list),<br />
            <br />
            but when I now try to reinstall the service again in my Section like explained above,<br />
            the service is installed, but the user update will fail:<br />
            SimpleSC::SetServiceLogon "&lt;name&gt;" "$USER_NAME" "$USER_PASSWORD"<br />
            <br />
            Any ideas?<br />
            Thanks,<br />
            Ebi70</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
            <span class="post-time small text-muted">20th July 2010 10:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hello,<br />
            <br />
            sry for this answer-delay. I don't get any message that somebody posts in this thread and I don't know why :(.<br />
            <br />
            <br /></p>

            <blockquote>
              <small>Originally posted by Ebi70</small><br />
              Hello together,<br />
              <br />
              I have following problem with the simplesc plugin.<br />
              I install my service with installutil of .net, because when I try to install with simplesc, then the services will hnot start, I think this is because that the dependencies are not correct updated.<br />
            </blockquote>1. Please post the sc.exe command and the SimpleSC::InstallService command which you are using.<br />
            2. After using sc.exe and SimpleSC::InstallService, please check the dependencies in the Windows service manager.<br />
            3. Please post the dependencies of your service.<br />
            <br />
            <br />
            <br />
            <br />
            <br />

            <blockquote>
              <small>Originally posted by Ebi70</small><br />
              but when I now try to reinstall the service again in my Section like explained above,<br />
              the service is installed, but the user update will fail:<br />
              SimpleSC::SetServiceLogon "&lt;name&gt;" "$USER_NAME" "$USER_PASSWORD"
            </blockquote>Please use the GetErrorMessage Function to get the error. In the documentation you can find an example how to use it.<br />
            <br />
            Kind regards<br />
            <br />
            Rainer
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
            <span class="post-time small text-muted">14th September 2010 12:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>New Version 1.28</strong><br />
            Hi,<br />
            <br />
            I've released a new version of the NSIS Simple Service Plugin. There are two new functions SimpleSC::GetServiceFailure and SimpleSC::SetServiceFailure. The function SimpleSC::StopService has now an addional argument to wait for file release if you would overwrite the binary file.<br />
            <br />
            You can find more informations and download file on the wiki page (<a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a>).<br />
            <br />
            If you have any questions please let me now.<br />
            <br />
            Special thanks to Rogier for this great donation. He makes this changes possible.<br />
            <br />
            Best regards<br />
            <br />
            Rainer</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">mabian</span><br />
            <span class="post-time small text-muted">12th October 2010 16:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hello, I'm having problems with this plugin, 1.28.<br />
            <br /></p>
            <pre>
<code>StrCpy$P_ServiceName</code><span style="color: #DD0000">"EcoManager_$P_ServiceID"
<br /></span><span style="color: #0000BB">SimpleSC</span><span style="color: #007700">::</span><span style="color: #0000BB">ExistsService</span><span style="color: #DD0000">"$P_ServiceName"
<br /></span><span style="color: #0000BB">Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">;</span><span style="color: #0000BB">returnsanerrorcode</span><span style="color: #007700">if</span><span style="color: #0000BB">theservicedoesn´texists</span><span style="color: #007700">(&lt;&gt;</span><span style="color: #0000BB">0</span><span style="color: #007700">)/</span><span style="color: #0000BB">serviceexists</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">)
<br /></span><span style="color: #0000BB">MessageBoxMB_OK</span><span style="color: #DD0000">"Servizio$P_ServiceNameesiste?$0"
</span>
</pre>Even though the service name is built correctly and it doesn't exists, the messagebox says $0 value is 0.<br />
            <br />
            Maybe is it something about unicode (trying it on XP SP3)?<br />
            <br />
            Thank you,<br />
            Mario
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
            <span class="post-time small text-muted">12th October 2010 17:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Dear mabian,<br />
            <br />
            if your service name contains Unicode characters you will get problems. This version of the service plugin doesn't support Unicode.<br />
            <br />
            1. Please enter SimpleSC::ExistsService your service name and don't use a variable (only for testing).<br />
            2. Try to use the ExistsService-Method with an other service. If this works I asume that it depends on your servicename + Unicode.<br />
            3. Please use the GetErrorMessage Method to get error text.<br />
            <br />
            Please let me know your results.<br />
            <br />
            Kind regards<br />
            <br />
            Rainer</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">mabian</span><br />
            <span class="post-time small text-muted">12th October 2010 17:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">This fragment:<br />
            <br /></p>
            <pre>
<code>SimpleSC</code><span style="color: #007700">::</span><span style="color: #0000BB">ExistsService</span><span style="color: #DD0000">"Dnscache"
<br /></span><span style="color: #0000BB">Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">;</span><span style="color: #0000BB">returnsanerrorcode</span><span style="color: #007700">if</span><span style="color: #0000BB">theservicedoesn´texists</span><span style="color: #007700">(&lt;&gt;</span><span style="color: #0000BB">0</span><span style="color: #007700">)/</span><span style="color: #0000BB">serviceexists</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">)
<br /></span><span style="color: #0000BB">MessageBoxMB_OK</span><span style="color: #DD0000">"$0"
<br /></span><span style="color: #0000BB">Push</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br />SimpleSC</span><span style="color: #007700">::</span><span style="color: #0000BB">GetErrorMessage
<br />Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br />MessageBoxMB_OK</span><span style="color: #007700">|</span><span style="color: #0000BB">MB_ICONSTOP</span><span style="color: #DD0000">"Message:$0"
</span>
</pre>Produces a few japanese chars in the first message box and a longer japanese/chinese string in the second...<br />
            <br />
            - Mario<br />
            <br />
            Same with an unexisting service name.<br />
            <br />
            Thanks,<br />
            Mario
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
            <span class="post-time small text-muted">12th October 2010 18:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Dear mabian,<br />
            <br />
            you can only use GetErrorMessage if an error exists e.g.<br />
            <br /></p>
            <pre>
<code>SimpleSC</code><span style="color: #007700">::</span><span style="color: #0000BB">ExistsService</span><span style="color: #DD0000">"Dnscache"
<br /></span><span style="color: #0000BB">Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">;</span><span style="color: #0000BB">returnsanerrorcode</span><span style="color: #007700">if</span><span style="color: #0000BB">theservicedoesn´texists</span><span style="color: #007700">(&lt;&gt;</span><span style="color: #0000BB">0</span><span style="color: #007700">)/</span><span style="color: #0000BB">serviceexists</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">)
<br /></span><span style="color: #0000BB">MessageBoxMB_OK</span><span style="color: #DD0000">"$0"
<br /></span><span style="color: #0000BB">IntCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">00Done</span><span style="color: #007700">+</span><span style="color: #0000BB">1</span><span style="color: #007700">+</span><span style="color: #0000BB">1
<br />Push</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br />SimpleSC</span><span style="color: #007700">::</span><span style="color: #0000BB">GetErrorMessage
<br />Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br />MessageBoxMB_OK</span><span style="color: #007700">|</span><span style="color: #0000BB">MB_ICONSTOP</span><span style="color: #DD0000">"Message:$0"
<br /><br /></span><span style="color: #0000BB">Done</span><span style="color: #007700">:
</span>
</pre>nethertheless this is not the problem. Are you using the Unicode-Version of NSIS? If yes please try it with the Non-Unicode. I just tried it with the Non-Unicode Version of NSIS and it works for me.<br />
            <br />
            Kind regards<br />
            <br />
            Rainer
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">mabian</span><br />
            <span class="post-time small text-muted">12th October 2010 21:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Confirmed: the ANSI version of NSIS works as expected.<br />
            <br />
            I thought the dll would work with Unicode NSIS as long as no unicode strings were used.<br />
            <br />
            Thank you very much!<br />
            <br />
            - Mario</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">nv_rajanikanth</span><br />
            <span class="post-time small text-muted">13th October 2010 12:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi<br />
            Thanks for this plug-in. Now i am able to install/start/stop...of 'my service' through this.<br />
            but i am not able to see this in the 'services.msc'.<br />
            please let me know how to list this 'my service' into 'services.msc', so that later on i can stop/start/restart manually.<br />
            <br />
            Thanks,<br />
            Rajanikanth</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
            <span class="post-time small text-muted">13th October 2010 13:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Dear Rajanikanth,<br />
            <br />
            if you can install/start/stop the service your service should be displayed in the ServiceManager (services.msc) or I don't understand you correctly!?<br />
            <br />
            Kind regards<br />
            <br />
            Rainer</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">mabian</span><br />
            <span class="post-time small text-muted">13th October 2010 13:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Rajanikanth,<br />
            <br />
            if you have services.msc already open while the installer adds the service, you have to press F5 to make it update the service list.<br />
            <br />
            Installing a service adds it to the list here.<br />
            <br />
            - Mario</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">hnedka</span><br />
            <span class="post-time small text-muted">22nd December 2010 17:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi, I have created a workaround to make it work with Unicode. You first need to enter this into your code:<br />
            <br />
            PHP Code:</p>
            <hr />
            <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">!</span><span style="color: #0000BB">defineUnicode2Ansi</span><span style="color: #DD0000">"!insertmacroUnicode2Ansi"<br />
            <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">macroUnicode2AnsiStringoutVar<br />
            System</span><span style="color: #007700">::</span><span style="color: #0000BB">Call</span><span style="color: #DD0000">'kernel32::WideCharToMultiByte(i0,i0,w"${String}",i-1,t.s,i${NSIS_MAX_STRLEN},i0,i0)i'<br /></span> <span style="color: #0000BB">Pop</span><span style="color: #DD0000">"${outVar}"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">macroend<br /></span></span> <!-- php buffer end -->
            <hr />
            And then you call SimpleSC functions like this:<br />
            PHP Code:
            <hr />
            <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">${</span><span style="color: #0000BB">Unicode2Ansi</span><span style="color: #007700">}</span><span style="color: #DD0000">"my_service_short_name"</span><span style="color: #0000BB">$R0<br />
            SimpleSC</span><span style="color: #007700">::</span><span style="color: #0000BB">StopService</span><span style="color: #DD0000">"$R0"</span><span style="color: #0000BB">0<br />
            Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br /></span></span> <!-- php buffer end -->
            <hr />
            It will obviously <u>not</u> work with chars, that are really Unicode (like Chinese) and probably also with everything non-english or non-local-language, but in standard situations, it should work. If there are any problems, let me know in this thread.
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
            <span class="post-time small text-muted">16th April 2011 15:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>New Version 1.29</strong><br />
            Hi,<br />
            <br />
            I've released a new version of the NSIS Simple Service Plugin. There are four new functions:<br />
            <br />
            - GetServiceFailureFlag<br />
            - SetServiceFailureFlag<br />
            - GetServiceDelayedAutoStartInfo<br />
            - SetServiceDelayedAutoStartInfo<br />
            <br />
            You can find more informations and download file on the wiki page (<a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a>).<br />
            <br />
            If you have any questions please let me now.<br />
            <br />
            Best regards<br />
            <br />
            Rainer</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">19th June 2011 18:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">SimpleSC checks whether the service is stopped before calling DeleteService. This is fine in normal circumstances, but some services cannot be stopped (they have no handler). I'd rather SimpleSC just went ahead and called DeleteService anyway, where in such cases the service will be deleted on reboot (i.e. DeleteService returns 1072). If you don't want to change the current behaviour, at least add a /force switch or something which ignores the state of the service.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
            <span class="post-time small text-muted">19th June 2011 21:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hey Stu,<br />
            <br />
            I think the best way is to do it like windows does it in the "sc delete" command. Therefore I will remove the "Stopped"-check in the code. I will change it within the next week.<br />
            <br />
            Kind regards<br />
            <br />
            Rainer</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">rijukk</span><br />
            <span class="post-time small text-muted">6th July 2011 13:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>[wait_for_file_release]</strong><br />
            Hi Rainer,<br />
            <br /></p>

            <blockquote>
              <small>Originally posted by Speed78</small><br />
              I've released a new version of the NSIS Simple Service Plugin. There are two new functions SimpleSC::GetServiceFailure and SimpleSC::SetServiceFailure. The function SimpleSC::StopService has now an addional argument to wait for file release if you would overwrite the binary file.
            </blockquote>As you said, I used SimpleSC::StopService with "wait_for_file_release" flag, since i need to overwrite the binary file.<br />
            <br />
            Sometimes our services take longer time,&gt;30sec, to stop in that case<br />
            SimpleSC::StopService "&lt;My Service Name&gt;" 1<br />
            Will return with an error# 1053 (The service did not respond to the start or control request in a timely fashion).<br />
            <br />
            <br />
            Currently I am over coming this using loop and check status logic. below is my code snippet<br />
            <br />
            <pre>
<code><br /><br />        SimpleSC::StopService "&lt;My Service Name&gt;" 1<br />        ; My service take more than 30sec to stop sometimes since it is doing some file processing<br />        Pop $0<br />        ;"1053 error (The service did not respond to the start or control request in a timely fashion)<br />        Goto CheckServiceStateNoSleep<br />  LoopAgain:<br />        DetailPrint "Waiting for service to stop..."<br />        Sleep 2000<br />  CheckServiceStateNoSleep:<br />         SimpleSC::GetServiceStatus "&lt;My Service Name&gt;"<br />         Pop $0<br />         Pop $1<br />         IntCmp $1 1 ServiceStopped LoopAgain LoopAgain<br />  ServiceStopped:<br />         ;Service Exe replacement step here<br /></code>
</pre><br />
            <br />
            Is there any better alternatives?<br />
            <br />
            Thank you,<br />
            Riju
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
            <span class="post-time small text-muted">7th July 2011 17:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi Riju,<br />
            <br />
            if your service need more than 30 seconds I think you are using the registry setting ServicePipeTimeout!? Otherwise you should get a windows message e.g. if you are stopping the service via Service Manager.<br />
            <br />
            So I can do the following:<br />
            <br />
            1. I can wait until the service controller gave me the result information after an action (e.g. stopped, timeout, etc.). The disadvantage can be that I'm waiting forever and the setup seems to hang.<br />
            <br />
            2. I can add a wait timeout parameter in the function. The disadvantage is that the timeout doesn't depend on the windows timeout.<br />
            <br />
            However, I think I need to check it and I will try to change it within the next release. I have another task on my todo list for Stu, but at the moment my work in the company is very stressful. Therefore it can take a time.<br />
            <br />
            Kind regards<br />
            <br />
            Rainer</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">rijukk</span><br />
            <span class="post-time small text-muted">8th July 2011 04:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi Rainer,<br />
            <br />
            I appreciate you for taking time from your busy schedule to reply our queries.. Thank you!!<br />
            <br /></p>

            <blockquote>
              <small>Originally posted by Speed78</small><br />
              <br />
              So I can do the following:<br />
              <br />
              1. I can wait until the service controller gave me the result information after an action (e.g. stopped, timeout, etc.). The disadvantage can be that I'm waiting forever and the setup seems to hang.<br />
              <br />
              2. I can add a wait timeout parameter in the function. The disadvantage is that the timeout doesn't depend on the windows timeout.<br />
            </blockquote>I think, <b>wait timeout</b> parameter in the function will do the trick. If timeout is 0, it will wait till the service stop properly.<br />
            <br />
            I see it rather an <b>advantage</b> than a disadvantage, In a sense you are providing an optional parameter to override the default windows timeout. That is always an advantage :)<br />
            <br />
            Thank you very much,<br />
            Riju
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">aerDNA</span><br />
            <span class="post-time small text-muted">16th July 2011 11:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">@ZvyaginzevaE:<br />
            Googled what you're looking for and seems it can be obtained easily. But you completely missed the forum, this one has nothing to do with cars.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
            <span class="post-time small text-muted">28th July 2011 19:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>NSIS 1.30 Beta</strong><br />
            Dear all,<br />
            <br />
            in the attachment you can find a Beta version of the new NSIS plugin. This version contains these new functions:<br />
            <br />
            The following functions got a new "Timeout" parameter:<br /></p>

            <ul>
              <li>SimpleSC::StartService</li>

              <li>SimpleSC::StopService</li>

              <li>SimpleSC::PauseService</li>

              <li>SimpleSC::ContinueService</li>

              <li>SimpleSC::RestartService</li>
            </ul><br />
            The function SimpleSC::RemoveService doesn't stop the service now. If you need this functions please use the SimpleSC::StopService before you remove the service.<br />
            <br />
            It would be great if you can check this new version. Any feedback will be welcome.<br />
            <br />
            Kind regards<br />
            <br />
            Rainer
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
            <span class="post-time small text-muted">15th August 2011 22:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>New Version 1.30</strong><br />
            Dear all,<br />
            <br />
            no news are good news. Therefore I released a new version of the NSIS Simple Service Plugin.<br />
            <br />
            There are four new functions:</p>

            <ul>
              <li>The function SimpleSC::RemoveService doesn't stop the service now. If you need this functions please use the SimpleSC::StopService before you remove the service.</li>

              <li>The following functions got a new "Timeout" parameter:

                <ul>
                  <li>SimpleSC::StartService</li>

                  <li>SimpleSC::StopService</li>

                  <li>SimpleSC::PauseService</li>

                  <li>SimpleSC::ContinueService</li>

                  <li>SimpleSC::RestartService</li>
                </ul>
              </li>
            </ul><br />
            You can find more informations and download file on the wiki page (<a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a>).<br />
            <br />
            If you have any questions please let me now.<br />
            <br />
            Best regards<br />
            <br />
            Rainer
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">rijukk</span><br />
            <span class="post-time small text-muted">21st September 2011 12:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi Rainer,<br />
            <br />
            I really appreciate you for coming up with "timeout parameter" as requested. However I am sorry, currently I am away from the installer project; hoping to back soon too. I will definitely do my aprt of testing and let you know my experience.<br />
            <br />
            btw, is there any infinite timeout value like "-1" or "0"?<br />
            <br />
            Thank you,<br />
            Riju</p>
          </div>
          <hr />
          <!-- Bootstrap core CSS -->
          <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
          <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

          <div class="container">
            <!-- Put navigation bar here -->

            <ol class="breadcrumb">
              <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

              <li><a href="f-65.html">NSIS Discussion</a></li>

              <li class="active">NSIS Simple Service Plugin</li>
            </ol>

            <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=270562">NSIS Simple Service Plugin</a></p><br />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">sr164w</span><br />
              <span class="post-time small text-muted">18th January 2012 08:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Can I use this plugin in for commercial use of my installer:confused:?</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br />
              <span class="post-time small text-muted">19th January 2012 06:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">By default all plug-ins can be used in commercial installers.<br />
              If it is not strictly prohibited in plug-in readme then feel free to use it.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">dixonich</span><br />
              <span class="post-time small text-muted">10th December 2012 10:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Hello! My problem. Services plug-in not work! Help please!Service does not start!<br /></p>
              <pre>
<code><br />!define PRODUCT_NAME "MyApp" <br />!define PRODUCT_VERSION "19" <br />!define pkgdir "C:\Swe" <br /><br />!include "MUI.nsh" <br />SetCompressor /SOLID lzma <br /><br />!define MUI_ABORTWARNING <br />!insertmacro MUI_PAGE_FINISH <br />!insertmacro MUI_LANGUAGE "Russian" <br /><br />Name "${PRODUCT_NAME}" <br />Caption "Установка ${PRODUCT_NAME} ${PRODUCT_VERSION}" <br />OutFile "${PRODUCT_NAME}-${PRODUCT_VERSION}.exe" <br />ShowInstDetails show <br /><br />Section <br />SetOutPath "C:\" <br /><br />File "${pkgdir}\SystemTrayDemo.exe" <br /><br />SimpleSC::InstallService "ServiceStartD" "Testing123D" "16" "2" "C:\SystemTrayDemo.exe"  "" "" ""<br />SimpleSC::StartService "ServiceStartD" "" 30<br />SectionEnd<br /></code>
</pre>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
              <span class="post-time small text-muted">10th December 2012 15:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Can you start it if you run services.msc (Computer management)?</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
              <span class="post-time small text-muted">10th December 2012 19:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                <small>Originally posted by dixonich</small><br />
                Hello! My problem. Services plug-in not work! Help please!Service does not start!<br />
                <pre>
<code><br />!define PRODUCT_NAME "MyApp" <br />!define PRODUCT_VERSION "19" <br />!define pkgdir "C:\Swe" <br /><br />!include "MUI.nsh" <br />SetCompressor /SOLID lzma <br /><br />!define MUI_ABORTWARNING <br />!insertmacro MUI_PAGE_FINISH <br />!insertmacro MUI_LANGUAGE "Russian" <br /><br />Name "${PRODUCT_NAME}" <br />Caption "Установка ${PRODUCT_NAME} ${PRODUCT_VERSION}" <br />OutFile "${PRODUCT_NAME}-${PRODUCT_VERSION}.exe" <br />ShowInstDetails show <br /><br />Section <br />SetOutPath "C:\" <br /><br />File "${pkgdir}\SystemTrayDemo.exe" <br /><br />SimpleSC::InstallService "ServiceStartD" "Testing123D" "16" "2" "C:\SystemTrayDemo.exe"  "" "" ""<br />SimpleSC::StartService "ServiceStartD" "" 30<br />SectionEnd<br /></code>
</pre>
              </blockquote>Which error mesage do you got (GetErrorMessage)? Are you using the unicode version of NSIS?<br />
              <br />
              Kind regards<br />
              <br />
              Rainer
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">nuoyantaizi</span><br />
              <span class="post-time small text-muted">6th October 2013 08:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Hi,Speed78<br />
              Nice to meet you.I have a problem when use NSIS Simple Service Plugin to install a windows service named "Apache".<br />
              When i use "SimpleSC::InstallService ...." ,the service is installed ok,but it can not start,the error is "required components not installed".<br />
              I have a try to use "apache/bin/httpd -k install",i saw the dependences are "AFD",and "TCP/IP Protocal Driver / IPSEC driver".<br />
              So,how can i use simplesc to install this apache ?<br />
              <br />
              By the way,StartSercie,StopService need 30 seconds,that's so long! My production need to install 4 service on user's computer,so that's need too much time! Can you tell me if the SimpleSC can do this like "sc start httpd","sc stop httpd" ?<br />
              <br />
              Best Regards<br />
              From your chinese friend :)</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
              <span class="post-time small text-muted">7th October 2013 23:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                When i use "SimpleSC::InstallService ...." ,the service is installed ok,but it can not start,the error is "required components not installed".<br />
                I have a try to use "apache/bin/httpd -k install",i saw the dependences are "AFD",and "TCP/IP Protocal Driver / IPSEC driver".<br />
                So,how can i use simplesc to install this apache ?
              </blockquote>Use "AFD/IPSec/Tcpip" as dependencies in the InstallService command (see <a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a>)
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">nuoyantaizi</span><br />
              <span class="post-time small text-muted">10th October 2013 15:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"><strong>Thank you very much</strong><br /></p>

              <blockquote>
                <small>Originally posted by jpderuiter</small><br />
                Use "AFD/IPSec/Tcpip" as dependencies in the InstallService command (see <a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a>)
              </blockquote>To jpderuiter,<br />
              thank you very much!<br />
              <br />
              I have a try what you said,the dependences are installed successfully! thanks again!<br />
              But tha apache software can not start yet.i don't know why,i think the software has its own process when use "-k install".but i still thanks you told me how to use the dependence parameter:)<br />
              <br />
              Another question,do you know how to install a .NET service except using "installutil.exe" ?<br />
              I have a .exe that developed by .net framework 4.0,i try to use SimpleSC to install ,and i failed,i must to use the .NET install tool "installutil.exe" to install it.<br />
              <br />
              Ah,do you understand what i said ? :) ,i am sorry about my english.<br />
              <br />
              but,all of these are ok! i have write a .exe instead of that one.<br />
              <br />
              Thanks again!<br />
              <br />
              i have to improve my english now ,today i met a German teacher,thanks to God,there is a senior student there ,and she can speak german very well~:)
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
              <span class="post-time small text-muted">10th October 2013 17:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">You only need to use installutil.exe if the .NET service uses the ServiceInstaller/ServiceProcessInstaller classes to define its install configuration. If you just create the service and only extend the ServiceBase class then you can install it using the normal Windows APIs (i.e. SimpleSC will work).<br />
              <br />
              Stu</p>
            </div>
            <hr />

            <div class="footer">
              <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
            </div>
          </div><script src="../js/highlight.pack.js" type="text/javascript">
</script> <script type="text/javascript">
//<![CDATA[
          hljs.initHighlightingOnLoad();
          //]]>
          </script>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
