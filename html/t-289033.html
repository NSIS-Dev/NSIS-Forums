<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Game Explorer without GDF" />

  <title>Game Explorer without GDF - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Game Explorer without GDF</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289033">Game Explorer without GDF</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mauvecloud</span><br />
      <span class="post-time small text-muted">25th March 2008 16:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Game Explorer without GDF</strong><br />
      I have been able to successfully add a game to the game explorer when there was a DLL with the GDF embedded in it. However, what about games without GDFs (and that aren't in the list of known legacy games)? I can manually drag and drop a shortcut to the Game Explorer, which at least creates a play link, even if it doesn't add a support link, parental control ratings, etc. How can I do that in an NSIS installer, though?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th March 2008 19:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Open ProcMon while dragging a game to the Game Explorer and see where it creates the shortcut and what registry keys it affects. Maybe we can mimic the process and if not, at least get a hint as to which API should be used.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mauvecloud</span><br />
      <span class="post-time small text-muted">25th March 2008 21:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you. That helps some, but unfortunately, it isn't enough.<br />
      I think the following code works for adding it to the registry:<br />
      <br /></p>
      <pre>
<code>!define REG_GE "SOFTWARE\Microsoft\Windows\CurrentVersion\GameUX\Games"<br />WriteRegStr HKLM "${REG_GE}\${GAME_GUID}" "AppExePath" "$INSTDIR\${GAME_EXE}"<br />WriteRegStr HKLM "${REG_GE}\${GAME_GUID}" "ApplicationId" "${GAME_GUID}"<br />WriteRegStr HKLM "${REG_GE}\${GAME_GUID}" "ConfigApplicationPath" "$INSTDIR"<br />WriteRegStr HKLM "${REG_GE}\${GAME_GUID}" "ConfigInstallType" "4"<br />WriteRegStr HKLM "${REG_GE}\${GAME_GUID}" "Title" "${GAME_TITLE}"<br /></code>
</pre><br />
      <br />
      However, I don't see how to add tasks to the game explorer for all users after that. Once the above registry keys have been added, the game appears in the Game Explorer, but it shows a default icon for it, and it creates a directory for the current user to put the play link into (%USERPROFILE%\AppData\Roaming\Microsoft\Windows\GameExplorer\<i>GAME_GUID</i>\PlayTasks\0), but even if I put a link into a similar directory under the "all users" AppData (I think "C:\ProgramData" is the Vista default for that), it doesn't pick it up.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">18th April 2008 18:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Doesn't ProcMon show you the path of the shortcut you create for all users when you drag &amp; drop?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mauvecloud</span><br />
      <span class="post-time small text-muted">21st April 2008 21:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Drag &amp; drop only creates it for the current user. I was hoping there was a way to simulate the effects, only have it appear for all users.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
