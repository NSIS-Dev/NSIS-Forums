<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Repair option" />

  <title>Repair option - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Repair option</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=86564">Repair option</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pragmaxe</span><br />
      <span class="post-time small text-muted">4th May 2002 00:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Repair option</strong><br />
      Can you have a 'repair' option in a setup generated with NSIS? When uninstalling people seem to appreciate that option.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">4th May 2002 08:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can make a flexible script that just reinstalls the software if it is damaged. Save your installdir to the reg and use InstDirRegKey to find the original installdir. Then using InstOpts (if the RegKey is not empty, otherwise it is a new installation) you can ask the user whether to reinstall the software or repair it (where you check settings with the script and set them to the right values if necessary).<br />
      So the trick: use InstallOptions!<br />
      <br />
      Good luck, greetz,<br />
      -Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pragmaxe</span><br />
      <span class="post-time small text-muted">4th May 2002 10:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the fast reply! As far as I can tell the InstallOptions.dll displays a dialog, is it possible to integrate the logic into the setup/uninstall window? So, can you have checkboxes and radiobuttons in the NSIS installer?<br />
      <br />
      Regards, Pragmaxe.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">4th May 2002 14:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Indeed, for an example see <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=85673" target="_blank">this thread</a>.<br />
      <br />
      Good luck,<br />
      -Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">4th May 2002 14:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here's an example script for what you want to do. It creates an installer that (if the program is already installed) ask to repair or reinstall the program. If you also save the $INSTDIR to the registry, there is no problem to find the program and repair/reinstall it. You can even create an option to uninstall the program. Just create an uninstaller which can be run silently and run it when a user chooses to uninstall in the installer option screen.<br />
      <br />
      Have fun programming it! :)<br />
      <br />
      Good luck,<br />
      -Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pragmaxe</span><br />
      <span class="post-time small text-muted">4th May 2002 17:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you very much!<br />
      <br />
      Regards, Pragmaxe.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DuaneJeffers</span><br />
      <span class="post-time small text-muted">5th May 2002 06:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">And for a InstallOptions GUI, check out <a href="http://www.morphedmedia.com/software.asp" target="_blank">http://www.morphedmedia.com/software.asp</a><br />
      <br />
      -Duane</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
