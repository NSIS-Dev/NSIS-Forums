<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Strange Font Installation Problem" />

  <title>Strange Font Installation Problem - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Strange Font Installation Problem</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=155404">Strange Font Installation Problem</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">7th November 2003 04:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Strange Font Installation Problem</strong><br />
      When I use the following macro to install a font file it copies the file OK but the font does not appear in any font lists even after the PC is restarted. However if you open the Windows Fonts folder in Explorer all of the font are availabble to the programs.<br />
      <br />
      I'm cannot be certain if this script did work previously and this is just a incompatibility with the newer version of NSIS or if it always behaved in this manner.<br /></p>
      <pre>
<code>!macro InstallFont FontNAME Index<br /><br />  SetOutPath $FONT_DIR<br />  IfFileExists "$FONT_DIR\${FontName}" ${Index}<br />  File '${FontName}'<br />  System::Call "GDI32::AddFontResourceA(t) i ('${FontName}') .s"<br />${Index}:<br /><br />!macroend</code>
</pre><br />
      Vytautas
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cchian</span><br />
      <span class="post-time small text-muted">7th November 2003 05:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try adding this line after you add the font (code by kichik):<br />
      <br /></p>
      <pre>
<code>SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">7th November 2003 05:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Do I need to add this line after every font is added, cos I already have this line after all of the fonts are installed, I insert this macro several times in one of the sections and I have that line after the last line.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cchian</span><br />
      <span class="post-time small text-muted">7th November 2003 05:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I believe you only need this line once.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">7th November 2003 06:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In that case thats not the problem. I know that this problem exists in Win98SE and I also suspect in WinXP, will confirm later tonight.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">7th November 2003 08:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You also have to create a certain registry key. Search the forum for the original thread where the AddFontResourceA function first brought up, it's there. It would be nice if you can merge it all together into one archive page.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">7th November 2003 08:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, modified my macro. Will test and create an Archive page if OK.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">7th November 2003 11:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Archive page created. Thanks guys for helping me to solve this problem.<br />
      <br />
      Vytautas :D</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
