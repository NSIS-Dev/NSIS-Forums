<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="flash play during installation"><title>flash play during installation - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">flash play during installation</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267685">flash play during installation</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">aditu.g</span><br><span class="post-time small text-muted">13th March 2007 11:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>flash play during installation</strong><br>I search trough the forum but unfortunately I did not manage to find a solution on this. I am trying to use nsWeb to insert a flash movie and inetc to download a file. What I am not able to do is to merge the two of them in the install page, because nsWeb is using custom page to display the flash and inetc is using the install page. Is there a way to have an installation page displaying the download progress bar inside of it and also to play the flash inside the same page?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">14th March 2007 19:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Doesn't inetc have an option to download in a pop-up window?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">aditu.g</span><br><span class="post-time small text-muted">15th March 2007 12:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, inetc has banner option.<br>Still I am not able to run them (nsweb and inetc) simultaneously ... maybe is so easy but I could not figure it out ...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">15th March 2007 13:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Not flash.. but <a href="http://nsis.sourceforge.net/AnimGif_plug-in" target="_blank">http://nsis.sourceforge.net/AnimGif_plug-in</a> can do the trick with animated gif.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">aditu.g</span><br><span class="post-time small text-muted">15th March 2007 14:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">yes. AnimGif does the trick but what if I want to use flash movie. It should be a combination between AnimGif and nsWeb (use the way that AnimGif use the install window to display and make this work on nsWeb. But I'm too stupid to make that.<br>I think there are few people that will use and enjoy this flash movie play at installation time if someone can fix nsWeb to use not only custom pages to display iself but also the instpage ....</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">15th March 2007 15:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by aditu.g</i><br><b>if someone can fix nsWeb to use not only custom pages to display iself but also the instpage ....</b></blockquote>There's a popup method in my plugin, see the examples.<br>BTW: You forgot the write the magic word... "please" ;)</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">15th March 2007 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You may try this (not tested though), create a 2nd 'installer' which include only the custom page the nsWeb and the flash movie and extract it in $PLUGINSDIR, execute it just before launch inetc in banner mode and close it once inetc has finished.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">aditu.g</span><br><span class="post-time small text-muted">16th March 2007 11:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Joel</i><br><b>There's a popup method in my plugin, see the examples.<br>BTW: You forgot the write the magic word... "please" ;)</b></blockquote>Please, please, please. Could you be so kind</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">16th March 2007 19:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by aditu.g</i><br><b>Please, please, please. Could you be so kind</b></blockquote>Do you actually read the plugin examples? :mad:</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">aditu.g</span><br><span class="post-time small text-muted">17th March 2007 11:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">My need is to display the html page (having flash inside) during installation. I can use the popup way but the window will show over installation window and only when is closed will continue the installation process.<br>I was thinking if there is a way to insert with resource hacker a control in the installation page (106 I think) and make nsweb use this one instead of 1018 from 105. I mean to place a control for the html in the usual place of the show details.<br>In this way html is inside the installation page...<br>But like I said I too dumb to figure out a way to do this. Please :rolleyes: help me</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">aditu.g</span><br><span class="post-time small text-muted">21st March 2007 09:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No ideas? If I try to launch the flash and nsweb in popup, the flash is waiting to be close and after that the download is started ... I have made 2 exe: one is displaying the flash in popup, the other is download the files. Is there a way to close the flash popup when download was ended?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">21st March 2007 09:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>I have made 2 exe: one is displaying the flash in popup, the other is download the files.</blockquote>Does this actually work as expected?<br>I haven't yet the time to compile and test this suggestion, would be nice if you post a minimal example about :)<br><blockquote>Is there a way to close the flash popup when download was ended?</blockquote>You could use Takhir's function when download is finished,<br><a href="http://nsis.sourceforge.net/Find_and_Close_or_Terminate" target="_blank">http://nsis.sourceforge.net/Find_and_Close_or_Terminate</a></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">aditu.g</span><br><span class="post-time small text-muted">21st March 2007 12:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, it is working. In the same ugly way I can just taskill the showHTML.exe process instead of kill the window. I still hope that there is another nice way to use together both plugins. here is the example</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">21st March 2007 13:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Code should reside in section. Below script works as expected,<br></p><pre>
<code>#Find and Close or Terminate<br>!define APP_NAME find_close_terminate<br>!define WND_CLASS "Internet Explorer_TridentDlgFrame"<br>!define WND_TITLE ""<br>!define TO_MS 2000<br>!define SYNC_TERM 0x00100001<br>!include WinMessages.nsh<br><br>LangString termMsg ${LANG_ENGLISH} "Installer cannot stop running ${WND_TITLE}.\<br>$\nDo you want to terminate process?"<br>LangString stopMsg ${LANG_ENGLISH} "Stopping ${WND_TITLE} Application"<br><br>!macro TerminateApp<br>    Push $0 ; window handle<br>    Push $1<br>    Push $2 ; process handle<br>    DetailPrint "$(stopMsg)"<br>    FindWindow $0 '${WND_CLASS}' ''<br>    IntCmp $0 0 done<br>    System::Call 'user32.dll::GetWindowThreadProcessId(i r0, *i .r1) i .r2'<br>    System::Call 'kernel32.dll::OpenProcess(i ${SYNC_TERM}, i 0, i r1) i .r2'<br>    SendMessage $0 ${WM_CLOSE} 0 0 /TIMEOUT=${TO_MS}<br>    System::Call 'kernel32.dll::WaitForSingleObject(i r2, i ${TO_MS}) i .r1'<br>    IntCmp $1 0 close<br>    MessageBox MB_YESNOCANCEL|MB_ICONEXCLAMATION "$(termMsg)" /SD IDYES \<br>    IDYES terminate IDNO close<br>    System::Call 'kernel32.dll::CloseHandle(i r2) i .r1'<br>    Quit<br>  terminate:<br>    System::Call 'kernel32.dll::TerminateProcess(i r2, i 0) i .r1'<br>  close:<br>    System::Call 'kernel32.dll::CloseHandle(i r2) i .r1'<br>  done:<br>    Pop $2<br>    Pop $1<br>    Pop $0<br>!macroend<br><br>!include "MUI.nsh"<br>!insertmacro MUI_LANGUAGE "English"<br>AutoCloseWindow false<br>OutFile `download.exe`<br><br>function .onInit<br>   InitPluginsDir<br>   File /oname=$PLUGINSDIR\showHTML.exe "showHTML.exe"<br>functionend<br><br>Section "Dummy Section" SecDummy<br>   HideWindow<br><br>   exec "$PLUGINSDIR\showHTML.exe"<br>   sleep 1000<br><br>   inetc::get /caption "Getting main installation" /banner \<br>   "Please wait ... $\nWinRar is downloading necesary files" \<br>   "http://www.rarlab.com/rar/wrar37b5.exe" "$PLUGINSDIR\winrar.exe"<br><br>   Pop $R1<br>   MessageBox MB_OK "Plugin return code: $R1"<br><br>   !insertmacro TerminateApp<br><br>   exec "$PLUGINSDIR\winrar.exe"<br><br>   BringToFront<br>SectionEnd</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aditu.g</span><br>
      <span class="post-time small text-muted">4th April 2007 12:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is there a way to put the banner inetc plugin download on the bottom of the popup window of the nsweb html page? I need to integrate somehow the 2 plugins (inetc and nsweb) and display the html flash content and the download progress bar in the bottom of that window. Any help would be greatly appreciated. thanks</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br>
      <span class="post-time small text-muted">4th April 2007 14:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Since nsweb html page, its boundries is all the dialog window, you'll have to change the source code, to reduce the size.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aditu.g</span><br>
      <span class="post-time small text-muted">4th April 2007 16:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I used Inetc plugin source code and modify resources in the IDDialog2 (used for the banner method). I inserted there a shockwave flash object. Everything looks ok (I test the dialog in MsVC++ with ctrl+T and it is displaying the flash). After I compiled the dll and call the plugin from the installer nothing happen. Please can someone can take a look and tell me what is wrong ...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
      <span class="post-time small text-muted">4th April 2007 18:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Looks like common Win32 methods in the DialogBox() call cannot create shockwave flash object in the dialog, this is why plug-in returns "Dialog Error", to see this please</p>
      <pre>
<code>Pop $0<br>MessageBox MB_OK $0</code>
</pre>after plug-in call (present in all samples :) ). You can search internet for samples, this is what I found right now <a href="http://www.codeproject.com/useritems/FlashGui.asp" target="_blank">http://www.codeproject.com/useritems/FlashGui.asp</a>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
      <span class="post-time small text-muted">6th April 2007 19:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Attached is a flash player sample for Win32 dialog. Finally you need few lines of code in OnInitDialog function only. I am not sure how good this will be on all platforms, but dialog worked fine during 10 minutes I played with it on XP. You can modify Inetc in the same manner. Please note that player require a full path to swf file (may be set in the command line in this sample).</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>