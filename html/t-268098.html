<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Installation with Components Choise" />

  <title>Installation with Components Choise - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Installation with Components Choise</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=268098">Installation with Components Choise</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pegase06</span><br />
      <span class="post-time small text-muted">20th March 2007 12:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Installation with Components Choise</strong><br />
      Hello,<br />
      <br />
      In MUI_PAGE_COMPONENTS, I have<br />
      <br /></p>
      <pre>
<code>SectionGroup /e "Section 1" SEC01<br /><br />        Section "Section 1.1" SEC011<br />          ...<br />        SectionEnd<br /><br />        Section "Section 1.2" SEC012<br />          ...   <br />        SectionEnd<br />        <br />        Section "Section 1.2" SEC013<br />          ...   <br />        SectionEnd<br />        <br />SectionGroupEnd</code>
</pre><br />
      <br />
      The user can chose only one sub section (Section 1.1 or Section 1.2 or Section 1.3) or nothing.<br />
      <br />
      How do it ?<br />
      <br />
      Thanks.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">20th March 2007 12:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If nothing in the above sample then what the installer is going to install?<br />
      Is there a hidden or read only section outside that group which is always installed?<br />
      <br />
      I think included example one-section.nsi could be your starting point.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pegase06</span><br />
      <span class="post-time small text-muted">20th March 2007 14:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Red Wine</i><br />
        ]If nothing in the above sample then what the installer is going to install?
      </blockquote>There is too a required section.<br />
      <br />

      <blockquote>
        <i>Originally posted by Red Wine</i><br />
        Is there a hidden or read only section outside that group which is always installed?<br />
        <br />
        I think included example one-section.nsi could be your starting point.
      </blockquote>That group is not required and can be not installed.<br />
      The first section install start menu for all user, the second section install start menu for current user. And if the user doesn't want start menu, none section is selected.<br />
      <br />
      <pre>
<code>Section "Program" SEC00<br />SectionIn RO<br />...<br />SectionEnd <br /><br />SectionGroup /e "Start menu" SEC01<br /><br />        Section "All user" SEC011<br />          ...<br />        SectionEnd<br /><br />        Section "Current user" SEC012<br />          ...   <br />        SectionEnd<br />        <br />SectionGroupEnd</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jholguin</span><br />
      <span class="post-time small text-muted">20th March 2007 14:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In your NSIS directory, in the 'Examples' Folder there's a nsi file called one-section.nsi which does this. It seems to work by turning the items into radio buttons which by default can only have 1 per "group" selected.<br />
      <br />
      Here's the pertinent code:<br /></p>
      <pre>
<code><br />Section "Group 1 - Option 1" g1o1<br />SectionEnd<br /><br />Section /o "Group 1 - Option 2" g1o2<br />SectionEnd<br /><br />Section /o "Group 1 - Option 3" g1o3<br />SectionEnd<br /><br />Section "Group 2 - Option 1" g2o1<br />SectionEnd<br /><br />Section /o "Group 2 - Option 2" g2o2<br />SectionEnd<br /><br />Section /o "Group 2 - Option 3" g2o3<br />SectionEnd<br /><br />;--------------------------------<br /><br />; Functions<br /><br />; $1 stores the status of group 1<br />; $2 stores the status of group 2<br /><br />Function .onInit<br /><br />  StrCpy $1 ${g1o1} ; Group 1 - Option 1 is selected by default<br />  StrCpy $2 ${g2o1} ; Group 2 - Option 1 is selected by default<br /><br />FunctionEnd<br /><br />Function .onSelChange<br /><br />  !insertmacro StartRadioButtons $1<br />    !insertmacro RadioButton ${g1o1}<br />    !insertmacro RadioButton ${g1o2}<br />    !insertmacro RadioButton ${g1o3}<br />  !insertmacro EndRadioButtons<br />        <br />  !insertmacro StartRadioButtons $2<br />    !insertmacro RadioButton ${g2o1}<br />    !insertmacro RadioButton ${g2o2}<br />    !insertmacro RadioButton ${g2o3}<br />  !insertmacro EndRadioButtons<br />        <br />FunctionEnd<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pegase06</span><br />
      <span class="post-time small text-muted">20th March 2007 14:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by jholguin</i><br />
        <b>In your NSIS directory, in the 'Examples' Folder there's a nsi file called one-section.nsi which does this. It seems to work by turning the items into radio buttons which by default can only have 1 per "group" selected.<br />
        <br />
        Here's the pertinent code<br /></b>
      </blockquote>I have try this code, but I can't unselect a sub section.<br />
      I need the possibility to have alle sub section unselect.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">20th March 2007 14:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>outfile 'test.exe'<br /><br />!include "Sections.nsh"<br />!include "LogicLib.nsh"<br /><br />Insttype "/CUSTOMSTRING=Please either select one option or none"<br />Insttype "Option one"<br />Insttype "option two"<br /><br />page components<br />page instfiles<br /><br />Section "Common FIles (Required)"<br />  SectionIn RO 1 2<br />    # common files here<br />SectionEnd<br /><br />SectionGroup /e "Select an option" SEC_GRP<br /><br />Section /o "option 1" SEC_01<br />  SectionIn 1<br />    # option 1 files here<br />SectionEnd<br /><br />Section /o "option 2" SEC_02<br />  SectionIn 2<br />    # option 2 files here<br />SectionEnd<br /><br />SectionGroupEnd<br /><br />Function .onSelChange<br />GetCurInstType $0<br /><br />${if} $0 == 32<br />SectionGetFlags ${SEC_01} $1<br />IntOp $1 $1 &amp; 1<br />${if} $1 == 1<br />SectionGetFlags ${SEC_02} $2<br />IntOp $2 $2 &amp; 1<br />${andif} $2 == 1<br />MessageBox MB_OK "Only one option is allowed"<br />!insertmacro UnselectSection ${SEC_01}<br />!insertmacro UnselectSection ${SEC_02}<br />${endif}<br />${endif}<br />FunctionEnd</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">onad</span><br />
      <span class="post-time small text-muted">20th March 2007 18:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Red Wine you really are a "Major Dude" to (junior) forum members, great!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">20th March 2007 18:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by onad</i><br />
        <b>Red Wine you really are a "Major Dude" to (junior) forum members, great!</b>
      </blockquote>Thanks :)<br />
      I'm a kind of doorman, welcome the newbies showing 'em some passages to step inside ;)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pegase06</span><br />
      <span class="post-time small text-muted">22nd March 2007 17:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have write :<br />
      <br /></p>
      <pre>
<code>outfile 'test.exe'<br /><br />!include "Sections.nsh"<br />!include "LogicLib.nsh"<br /><br />page components<br />page instfiles<br /><br />var menu1<br />var menu2  <br /><br />SectionGroup /e "SectionGroup " SEC03<br /><br />        Section "Section 1" SEC031<br />        ;...<br />        SectionEnd<br />        <br />        Section /o "Section 2" SEC032<br />        ;...<br />        SectionEnd<br />        <br />SectionGroupEnd<br /><br />Function .onInit<br /><br />  StrCpy $menu1 1<br />  StrCpy $menu2 0<br /><br />FunctionEnd<br /><br />Function .onSelChange<br /><br /><br />    SectionGetFlags ${SEC031} $1<br />    ${if} $1 == 1<br />    ${AndIf} $menu1 != 1<br />            !insertmacro UnselectSection ${SEC032}<br />            StrCpy $menu1 1<br />            StrCpy $menu2 0<br />    ${endif}<br />    <br />    SectionGetFlags ${SEC032} $2<br />    ${if} $2 == 1<br />    ${AndIf} $menu2 != 1<br />             !insertmacro UnselectSection ${SEC031}<br />             StrCpy $menu1 0<br />             StrCpy $menu2 1<br />    ${endif}<br /><br />FunctionEnd<br /><br /></code>
</pre><br />
      <br />
      Works perfectly.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mesial</span><br />
      <span class="post-time small text-muted">18th August 2010 21:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have been struggling with this same issue for a while. Red Wine, you are a godsend for me. The code example you gave above gives the exact results I am looking for. But when I impliment it into my installer, that's when it gets complicated. I have 22 sections with some sections having over 50 choices. My goal is to allow the user to choose only one, but also the option not to choose any. Well actually, it gets complicated with the 9 install types...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mesial</span><br />
      <span class="post-time small text-muted">18th August 2010 23:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'll run to the library and upload a the installer to my site so you can see it action to get a better idea, for I am using my phone at the moment and I can't do things like thhat on here. I'll add a link to the script as it is too large to cut and paste here. This is the final issue that I have with this installer. People have been begging for this for over a year.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mesial</span><br />
      <span class="post-time small text-muted">24th August 2010 09:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have not needed to go to the library because i have gotten mine to work, too. But now i'm stumped on trying to get a section with more than two options to work properly. Let's say for example, i have four options in a section that the user can only choose one option, but can also choose none of them. Any one know how to modify pegase06's script (above)?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mesial</span><br />
      <span class="post-time small text-muted">25th August 2010 04:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">it's been 9 days that i have been trying to get this to work. I have been trying this so many different ways but just cant get the thing to work. The damned thing is, this whole project relies on this "choose only one or none" feature. I have accomplished every other requirement for this installer and I pray that this feature is not unobtainable.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">25th August 2010 06:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Come on, the solution is trivially simple. It's the same as the existing code, only with more ${If} ${ElseIf} {$Etc} in it.<br />
      <br />
      <a href="http://nsis.pastebin.com/JigzyvmM" target="_blank">http://nsis.pastebin.com/JigzyvmM</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mesial</span><br />
      <span class="post-time small text-muted">25th August 2010 09:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What might seem simple to you, i have been struggling with, call me stupid, call me slow, but it took me forever to figure this one out. I was just coming back to say that I have finally got it to work on multiple options, sorry to waste anyones time and I see your post. I wish i had a better internet connection than the cell phone i have been using for months... Dial-up would be like a 20meg broadband connection compared to this. I thank you for your response, i will follow your link and see how i might improve mine.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
