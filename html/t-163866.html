<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="continue install after reboot"><title>continue install after reboot - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">continue install after reboot</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=163866">continue install after reboot</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">moxo</span><br><span class="post-time small text-muted">8th January 2004 14:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>continue install after reboot</strong><br>i Have a problem with barcode fonts, in my installation program i copy this fonts in windows directory after i execute the code(joined with this message) to install font. after my installation launch installation of access runtime and after it launch an update of microsoft component with their program called osp.msi but this last program need a reboot. I do a reboot with my installation and the osp program after reboot continue the update. At the end of update i launch my application but for my application, the barcode fonts are not installed. if relaunch my installation, the access runtime and microsoft update component are not re-installed because they are already present but my font are installer again. And now my application can create goods barcode.<br>I want to know is possible to install my fonts after the reboot and after the end of update microsoft conponent?<br>how i do? thanks very much<br>;code i use a the end of my installation<br>execwait '"$SYSDIR\msiexec.exe" /i "$EXEDIR\access-2000\osp.msi" REBOOT="ReallySuppress" /qb-'<br>setrebootflag true<br>SectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">8th January 2004 14:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Does it install the fonts after the reboot? Otherwise you can just register it after installation.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">moxo</span><br><span class="post-time small text-muted">8th January 2004 16:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">if i can i want to install font after reboot and after the end of microsoft update component, i do this because i thinks perhaps this resolve my problme. But for the moment i install the font just before the reboot :(<br>if the register after the reboot is good and resolve my problem, it's good for me. but how can i register after reboot?<br>thanks Joost</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">8th January 2004 16:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Why do you want to register after reboot? You can register fonts immidiately. See the NSIS Archive for information about font registering.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">moxo</span><br><span class="post-time small text-muted">9th January 2004 16:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">if i use fonts.dll, i need to put fonts.dll only in plugin subdirectory of nsis directory or i must to put on source installation($exedir).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">9th January 2004 19:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Put plug-ins in the Plugins folder. You can also use the system plug-in to register fonts:</p><pre>
<code><br>!include WinMessages.nsh<br><br>System::Call "GDI32::AddFontResourceA(t) i ('fontname.fon') .s"<br>Pop $0<br># $0 is zero if the function failed<br>SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">moxo</span><br>
      <span class="post-time small text-muted">13th January 2004 13:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i try this part of script i joined but i have the same problem. When i reboot, the fonts are copied but not registered. I open the windows font directory and after is good.<br>
      my nsis's version is 2.0b3.<br>
      i go tested with sytem plugin.<br>
      i write this??:<br>
      System::Call "GDI32::AddFontResourceA(t) i ('fontname.fon') .s"<br>
      System::Call "GDI32::AddFontResourceA(t) i ('fontname2.fon') .s"<br>
      Pop $0<br>
      SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0<br>
      <br>
      or:<br>
      System::Call "GDI32::AddFontResourceA(t) i ('fontname.fon') .s"<br>
      Pop $0<br>
      SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0<br>
      System::Call "GDI32::AddFontResourceA(t) i ('fontname2.fon') .s"<br>
      Pop $0<br>
      SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0<br>
      thanks</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br>
      <span class="post-time small text-muted">13th January 2004 13:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">it's recommended to upgrade to nsis2rc2 :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">moxo</span><br>
      <span class="post-time small text-muted">13th January 2004 14:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yes but I would be obliged to change my scripts. And it's more future problem for me:) and for you because you help me much:)).<br>
      and i don't have time know to modify all scripts</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">13th January 2004 15:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">System::Call "GDI32::AddFontResourceA(t) i ('fontname.fon') .s"<br>
      Pop $0<br>
      System::Call "GDI32::AddFontResourceA(t) i ('fontname2.fon') .s"<br>
      Pop $0<br>
      SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0<br>
      <br>
      Should work fine. Make sure the filename is correct.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">moxo</span><br>
      <span class="post-time small text-muted">13th January 2004 16:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">it is not good again :(<br>
      so for the moment i use<br>
      for winnt<br>
      WriteRegStr HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts" \<br>
      "BARCODES 12 MEDIUM (TrueType)" "N01bc12m.ttf"<br>
      <br>
      for win9x<br>
      WriteRegStr HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Fonts" \<br>
      "BARCODES 12 MEDIUM (TrueType)" "N01bc12m.ttf"<br>
      <br>
      i try later with the last version of nsis</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>