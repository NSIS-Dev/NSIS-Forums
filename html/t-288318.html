<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Check Registrykey Exists"><title>Check Registrykey Exists - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Check Registrykey Exists</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=288318">Check Registrykey Exists</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">amokk</span><br><span class="post-time small text-muted">11th March 2008 21:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Check Registrykey Exists</strong><br>Hi,<br><br>i want to check if a Registrykey exitst or not.<br>But I would not consider the key, but the folder in which it is located. In the folder, there is only the (standard) key.<br><br>Example:<br><br>To Check<br>HKLM "SOFTWARE\Test"<br><br>Not<br>HKLM "SOFTWARE\Test" "(Item)"<br><br><br><br>Can someone tell me how I can check?<br><br>Thank you</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">11th March 2008 22:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2.6" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2.6</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">amokk</span><br><span class="post-time small text-muted">12th March 2008 15:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry, but this document, I have already read, but it has not helped me. Can you give me perhaps explain how I use the key to verify existens.<br>I would be very grateful to you.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">12th March 2008 16:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yeah, sure, here,<br><br><a href="http://nsis.sourceforge.net/Reading_and_Writing_the_Registry_-_NSIS_makes_it_easy" target="_blank">http://nsis.sourceforge.net/Reading_..._makes_it_easy</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">12th March 2008 16:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">A comment on terminology: the "folders" in the registry are called "keys". They can contain other keys (subfolders) and "values" (which have the properties "name", "type", and "data").<br><br>Registry keys always have at least one value, the "default" value. Your screen shot shows this as "standard". You can test for the existence of a key by reading the default value.<br></p><pre>
<code>ClearErrors<br>ReadRegStr $0 HKLM "SOFTWARE\Test" ""<br>${If} ${Errors}<br>  # key does not exist<br>${EndIf}</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">amokk</span><br>
      <span class="post-time small text-muted">12th March 2008 17:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks demiller9 for you help.<br>
      but it doesn't works correctly.<br>
      <br>
      if i run your code, i will allways jump to<br>
      # key does not exist<br>
      <br>
      Can you help me pls.<br>
      thanks</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br>
      <span class="post-time small text-muted">12th March 2008 18:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There isn't any simple function in NSIS to check is registry key exist, but you can use EnumRegKey as workaround.<br>
      <br></p>
      <pre>
<code>ClearErrors<br>EnumRegKey $0 HKCR "SOFTWARE\Test" 0<br>IfErrors 0 keyexist<br>  # key does not exist<br>keyexist:</code>
</pre><br>
      <br>
      This will work because EnumRegKey will only set the error flag if there is errors so even if the key doesn't have any sub keys to "enum", it doesn't set the error flag.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">amokk</span><br>
      <span class="post-time small text-muted">13th March 2008 11:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">GREAT!!!!!!!!!!!!!!<br>
      <br>
      BIG THX!!!!!!<br>
      It works correctly!!! NICE!<br>
      Thanks</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">13th March 2008 11:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by demiller9</i><br>
        <b>A comment on terminology: the "folders" in the registry are called "keys". They can contain other keys (subfolders) and "values" (which have the properties "name", "type", and "data").<br>
        <br>
        Registry keys always have at least one value, the "default" value. Your screen shot shows this as "standard". You can test for the existence of a key by reading the default value.<br></b>
        <pre>
<b><code>ClearErrors<br>ReadRegStr $0 HKLM "SOFTWARE\Test" ""<br>${If} ${Errors}<br>  # key does not exist<br>${EndIf}</code></b>
</pre>
      </blockquote>Yes they do have a default value name, but that value name has to have a value set for your code to work.<br>
      <br>
      Stu
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>