<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Register COM objects"><title>Register COM objects - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Register COM objects</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=56088">Register COM objects</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">weridoman</span><br><span class="post-time small text-muted">31st July 2001 16:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Is there a way to register COM objects with the OS during the install?<br><br><br>Any help would be greatly appreciated.<br></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DuaneJeffers</span><br><span class="post-time small text-muted">31st July 2001 18:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Is it an executible .com file???? That way you could execute it, if not, then I don't know, sorry.<br><br><br><br>-DJ</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">weridoman</span><br><span class="post-time small text-muted">31st July 2001 18:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No it is not an executable. If it was, i could execute it with the EXEC command.....this COM file is an object file. What I need to do is tell the OS that it can use the functions in this particular COM file.<br><br>Sorry if i didnt make that clear before, but i need to tell the os to register these objects and i was wondering if i could do that with the installer.<br><br></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Edgewize</span><br><span class="post-time small text-muted">1st August 2001 06:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Unless I am mistaken, a COM object is just another form of an OLE/ActiveX DLL. You should be able to register it with the RegDLL command. If not, I have no idea :/ Probably something that involves writing disgusting 64-bit GUIDs to the registry in several locations...<br><br>&lt;sarcasm&gt;Thanks, Microsoft, for such a beautiful programming model!&lt;/sarcasm&gt;</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">KennyKen</span><br><span class="post-time small text-muted">1st August 2001 22:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There are two different types of COM objects. I'll assume you're using VB to develop the application, so I'll use VB terminology. It should pretty much transfer over to any other development tool.<br><br>* ActiveX DLLs / OCXs<br>The ActiveX DLLs and OCXs must be "registered" by windows before the COM objects they expose can be used. In order to register the DLL (outside of NSIS), you call it's DllRegisterServer() function. NSIS offers the RegDLL statement for that.<br><br>When uninstalling your program, it is important to unregister the DLL (so windows knows those COM objects are no longer available). To do this, use NSIS's UnRegDLL statement (or call the DllUnregisterServer() function of the file).<br><br>* ActiveX EXEs<br>These files do not expose a DllSelfRegister function which means RegDLL won't work for them. To register, run the file with the "/regserver" as the command line. To unregister the ActiveX EXE, run it again this time passing "/unregserver" as the command line.<br><br>-- Ken Browning</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>