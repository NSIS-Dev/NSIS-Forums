<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="how to embed nsis installer into activex control"><title>how to embed nsis installer into activex control - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">how to embed nsis installer into activex control</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=178056">how to embed nsis installer into activex control</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">fullscreener</span><br><span class="post-time small text-muted">26th April 2004 18:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>how to embed nsis installer into activex control</strong><br>This is sort of off topic, but i'd imagine that others might like to try something like this.. or perhaps others have tried this.<br><br>Supposing I'd like to wrap an NSIS installer inside of an ActiveX control for distribution on the internet... how might i do this?<br><br>Should I...<br><br>figure out how nsis will build instead of an EXE, an activeX compatible DLL / OCX?<br><br>or package the nsis installer exe inside of a cab with a basic activex control that would just execute the installer exe when loaded? ( does activex allow this?? )<br><br>or is there a way for activex to directly use an executable rather than the ocx / dll?<br><br>or should i just give this up &amp; write my own ActiveX downloader that would download &amp; execute the installer.<br><br>( this nsis installer that i'd like to wrap will be small &amp; will just load the actual program files that the installer needs )<br><br>thanks -<br>matt<br><br>fullscreen.com<br><br>:wq</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">fredtheman</span><br><span class="post-time small text-muted">26th April 2004 18:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: how to embed nsis installer into activex control</strong><br>&gt;&gt; Supposing I'd like to wrap an NSIS installer inside of an ActiveX control for distribution on the internet... how might i do this?<br><br>I saw somewhere once someone running an EXE from the INF located in a CAB, but never tried myself.<br><br>More importantly, I think this is going backwards: Since we rewrote our VB desktop applications as ActiveX controls, we needed a foolproof way to<br>- allow IE to download controls without prompting the user each time,<br>- add our site to the list of Trusted sites so that users would not be prompted but only when visiting our site<br>- make sure all the prerequisites were installed (ie. VB runtime, additional OCX's, etc.)<br><br>So I wrote a small NSIS script that checks all this, downloads missing stuff. We've successfully used it with about ten customers now, and believe me, if _they_ used it successfully, anybody can :-D<br><br>I upload the script and the INI file that contains version numbers of each OCX here:<br><br><a href="http://ypsolog.com/temp/nsis/" target="_blank">http://ypsolog.com/temp/nsis/</a><br><br>Since the comments are in French, drop me a line if you're stuck and figure it out.<br><br>I'm now working on writing a BBS version using the Sax ActiveX control so that users who don't have the Net can connect to our ProWin BBS and download updates. I'm stuck at how to call an ActiveX control from NSIS, but I'm working on it :-)<br><br>Fred.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">fullscreener</span><br><span class="post-time small text-muted">26th April 2004 19:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Fred --<br>I don't think i've ever met a Frenchman by the name of Fred. Fredrique? ;)<br><br>Thanks for your tips &amp; code.<br><br>What i'm looking for is just a way to distribute an NSIS installer as an activeX control -- basically. or somehow use an activex downloader as a bootstrap -- to first download my installer, then run it.<br><br>I want to avoid the "potentially malicious code" warning that IE gives when you download an .exe file. I'd rather have the ActiveX dialog. Thats the only difference that I'm trying to overcome.<br><br>Its not an issue for most -- but for my app, i'd like to go the activex route.<br><br>Has anyone created a simple download &amp; execute activex control? wonder if i could find some source somewhere. man i'm lazy.<br><br>thanks -<br>matt</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">fredtheman</span><br><span class="post-time small text-muted">26th April 2004 19:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">&gt;&gt; I want to avoid the "potentially malicious code" warning that IE gives when you download an .exe file. I'd rather have the ActiveX dialog. Thats the only difference that I'm trying to overcome.<br><br>The user will get this warning when they open a page that contains an ActiveX control. Either you ask them to click on OK every time they view your page, or tell them to add your site to the list of Trusted Sites and set IE to not display this prompt when viewing pages from sites listed in Trusted Sites. Our users are not computer-savvy enough to ask them to do this, hence my NSIS setup script that does all this for them. If your users are smarters, your plan is OK, ie. build a dummy OCX that calls a CAB, which contains an INF, which might be able to run an EXE automagically :<br><br>"I had to change my inf file, for a particular EXE that I needed run automatically. I changed the RegisterServer= line from No to Yes, and rebuilt the CAB file. This executed the EXE that I was trying to run."<br><br><a href="http://www.google.com/groups?threadm=33946F5F.54C8%40altavista.digital.com" target="_blank">http://www.google.com/groups?threadm...ta.digital.com</a><br><br>Here's what the INF in your CAB might look like:<br><br></p><pre>
<code><br>;DestDir can be 10 for \Windows, 11 for Windows\System(32) or left blank to mean Occache<br><br>[version] <br>signature="$CHICAGO$" <br>AdvancedINF=2.0 <br>  <br>[Add.Code] <br>DUMMY.OCX=DUMMY.OCX <br>SETUP.EXE=SETUP.EXE<br>  <br>[DUMMY.OCX] <br>file-win32-x86=thiscab <br>RegisterServer=yes <br>clsid={BAF08E86-0ED3-473B-B8F7-6118840E738B} <br>DestDir=10 <br>FileVersion=1,0,0,0 <br><br>[SETUP.EXE] <br>file-win32-x86=thiscab <br>RegisterServer=no<br>DestDir=10<br></code>
</pre><br>
      <br>
      HTH<br>
      Fred.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fullscreener</span><br>
      <span class="post-time small text-muted">27th April 2004 15:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thank you very much fredrique - i'll try this today and let the list know what kind of solution i end up with.<br>
      <br>
      matt</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>