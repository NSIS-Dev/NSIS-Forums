<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Exec Strangeness"><title>Exec Strangeness - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Exec Strangeness</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=53791">Exec Strangeness</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">nphelps</span><br><span class="post-time small text-muted">30th June 2001 07:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I cannot get either Exec or ExecWait to work at all in my NSI script. I know it must work because the sample viewhtml.nsi works properly. However, when I try the same code in my own functional script, it never launches the application... The script compiles properly, and the command appears in the install details--but the executable never gets launched and the error flag gets set. Anyone have an idea of what could be causing this problem? I'm on Windows 2000 SP2 and I'm simply doing this:<br><br>ExecWait '"$PROGRAMFILES\Internet Explorer\iexplore.exe"'<br><br>I have also tried:<br><br>Exec "C:\WINNT\notepad.exe"<br><br>Just for kicks...same result.<br><br>Ideas?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Gonzotek</span><br><span class="post-time small text-muted">30th June 2001 15:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What about shellexec? Same result?<br><br>The first line in your code...<br><br>ExecWait '"$PROGRAMFILES\Internet Explorer\iexplore.exe"'<br><br><br>had single quotes ('...') wrapped around double quotes ("..."), was that intentional?<br><br>-=Gonzotek=-</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nphelps</span><br><span class="post-time small text-muted">30th June 2001 15:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>No, ExecShell works...</strong><br>No, ExecShell works... and yes the extra quotes were intentional. I had just cut 'n paste from the viewhtml.nsi which had the following line which included the extra quotes:<br><br>ExecWait '"$PROGRAMFILES\Internet Explorer\iexplore.exe" "$INSTDIR\makensis.htm"'<br><br>I'm assuming this is simply grouping the two statements into one arg. So, I don't think the extra quotes affect the actual execution of the statement. That is one reason I pulled them out on the second example.<br><br>But again, ExecShell works... why would one work and not the other two? I really need to use ExecWait if at all possible.<br><br></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Gonzotek</span><br><span class="post-time small text-muted">1st July 2001 02:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If the sample works properly, maybe you could work back from there. Take out everything from the example that you can, then build a new script around it. Or perhaps Exec and ExecWait have an incompatibility eith compliling under WIN2k SP1?<br><br>What about<br><br>EXEC FILE.EXE<br><br><br>in the directory that you are currently working in?<br><br>-=Gonzotek=-</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nphelps</span><br><span class="post-time small text-muted">2nd July 2001 01:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Ah Ha!</strong><br>Fixed it! For some reason, I had to place and SetOutPath statement prior to calling Exec or ExecWait for it to work. I when through the viewhtml.nsi sample, and commented it out line by line. When I removed the SetOutPath statement in the default section the Exec didn't launch Internet Explorer. So, I just added a dummy SetOutPath statement in the function where I call Exec and sure enough, it worked!<br><br>I suppose that is a bug, so like I said, to reproduce it, just comment out the line that says SetOutPath $INSTDIR in the viewhtml.nsi sample script.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">spaetz</span><br><span class="post-time small text-muted">3rd July 2001 12:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That seems to be a bug for sure, but I had also experienced problemls with opening html pages. If you do a<br>ExecShell "open" "C:\test.html"<br>it might not open a webbrowser. It works perfectly if NS is the standard browser, but IE didn't seem to set html to open correctly via that scheme (got bug reports from a couple of persons)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arune</span><br><span class="post-time small text-muted">5th July 2001 10:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">How about using start.exe instead of open,<br>or maybe itÂ´s "start.exe c:\temp.html"?<br>Try with start.exe anyway!<br>/arune</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>