<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Classic interface"><title>Classic interface - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Classic interface</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277299">Classic interface</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">BarrelOfAGun</span><br><span class="post-time small text-muted">13th September 2007 22:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Classic interface</strong><br>Hi to everyone<br>Do you know the window where are the progress bar and where are written the extracted files?<br>I would want to make so that once completed the installation this window gets closed and an other appear where it asks if you want launch the application. All this happens with the modern interface, but not with that classic one.<br><br>this is my code<br><br></p><pre>
<code><br>; Script generated by the HM NIS Edit Script Wizard.<br><br>; HM NIS Edit Wizard helper defines<br>!define PRODUCT_NAME "MyApp"<br>!define PRODUCT_VERSION "2.05"<br>!define PRODUCT_PUBLISHER "Rand0m"<br><br>Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br>OutFile "Update.exe"<br>LoadLanguageFile "${NSISDIR}\Contrib\Language files\Italian.nlf"<br>InstallDir "$PROGRAMFILES\MyApp 2"<br>Icon "${NSISDIR}\Contrib\Graphics\Icons\classic-install.ico"<br>DirText "Il setup installer√É_ $(^Name) nella seguente cartella.$\r$\n$\r$\nPer installare in una cartella differente, clicca Sfoglia and seleziona un'altra cartella."<br>ShowInstDetails show<br>XPStyle on<br><br>Section "SezionePrincipale" SEC01<br>  SetOutPath "$INSTDIR"<br>  SetOverwrite on<br>  File "allmyfiles.png"<br>SectionEnd<br></code>
</pre><br>
      <br>
      Help me!
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">13th September 2007 23:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">the finish page is a custom page, use InstallOptions OR nsDialogs to create your own</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BarrelOfAGun</span><br>
      <span class="post-time small text-muted">14th September 2007 01:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Once launch the commands <font color="red">!include nsDialogs.nsh</font> which are the commands to create a custom dialog?<br>
      <br>
      Sorry i'm a newbie ^^''</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BarrelOfAGun</span><br>
      <span class="post-time small text-muted">14th September 2007 17:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, is successful. Now how can I retrieve the state of the checkbox when page nsDialogsBlah gets closed?<br>
      <br></p>
      <pre>
<code><br>!include nsDialogs.nsh<br>!include LogicLib.nsh<br><br>!define PRODUCT_NAME "MyApp"<br>!define PRODUCT_VERSION "2.05"<br>!define PRODUCT_PUBLISHER "Rand0m"<br><br>Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br>OutFile "Update.exe"<br>LoadLanguageFile "${NSISDIR}\Contrib\Language files\Italian.nlf"<br>InstallDir "$PROGRAMFILES\MyApp 2"<br>Icon "${NSISDIR}\Contrib\Graphics\Icons\classic-install.ico"<br>DirText "some text"<br><br>ShowInstDetails show<br>XPStyle on<br><br>Page license /ENABLECANCEL<br>Page directory /ENABLECANCEL<br>Page instfiles /ENABLECANCEL<br>Page custom nsDialogsBlah ValidateCustom /ENABLECANCEL<br><br>Var CHECKBOX<br>Var DIALOG<br><br>Function nsDialogsBlah<br><br>        nsDialogs::Create /NOUNLOAD 1018<br>        Pop $0<br>        GetFunctionAddress $0 OnBack<br>        nsDialogs::OnBack /NOUNLOAD $0<br>        <br>        ${NSD_CreateCheckbox} 0 -50 100% 8u 1 Test<br>        Pop $CHECKBOX<br>        GetFunctionAddress $0 OnClick<br>        nsDialogs::OnClick /NOUNLOAD $0<br>        <br>        nsDialogs::Show<br>        <br>FunctionEnd<br><br>Function OnBack<br><br>        MessageBox MB_YESNO "are you sure?" IDYES +2<br>        Abort<br><br>FunctionEnd<br><br>Function OnClick<br><br>        MessageBox MB_OK "checkbox clicked"<br><br>FunctionEnd<br><br>Section "SezionePrincipale" SEC01<br>  SetOutPath "$INSTDIR"<br>  SetOverwrite on<br>  File "allmyfiles.png"<br>SectionEnd<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">14th September 2007 18:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Define a leave callback function for the custom page and send ${BM_GETSTATE} to the check box to get its state.</p>
      <pre>
<code>Function leave<br>  SendMessage $CHECKBOX ${BM_GETSTATE} 0 0 $0<br>  ${If} $0 != 0<br>    MessageBox MB_OK checked!<br>  ${EndIf}<br>FunctionEnd</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BarrelOfAGun</span><br>
      <span class="post-time small text-muted">15th September 2007 00:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you very much! ;)<br>
      A last thing: how I should do to mark the checkbox automatically?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">15th September 2007 10:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Send ${BM_SETSTATE}.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BarrelOfAGun</span><br>
      <span class="post-time small text-muted">15th September 2007 13:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">SendMessage $CHECKBOX ${BM_SETSTATE} 1 1 $0<br>
      <br>
      Is the right usage? The checkbox is unchecked but the application run same one!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">15th September 2007 16:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Actually, it should be BM_SETCHECK with BST_CHECKED.</p>
      <pre>
<code>SendMessage $CHECKBOX ${BM_SETCHECK} ${BST_CHECKED} 0</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BarrelOfAGun</span><br>
      <span class="post-time small text-muted">16th September 2007 02:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you very much! It's very kind from you!</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>