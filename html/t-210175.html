<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="XML File"><title>XML File - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">XML File</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=210175">XML File</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">arfinator853</span><br><span class="post-time small text-muted">12th March 2005 04:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>XML File</strong><br>&nbsp; Is it possible with NSIS to write to a .xml file?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">12th March 2005 15:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There's no plugin written for creating XML files, but you can create one with the NSIS FileOpen, FileWrite, and FileClose<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">12th March 2005 21:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>There's no plugin written for creating XML files, but you can create one with the NSIS FileOpen, FileWrite, and FileClose</blockquote>You can't create plugins with NSIS itself. But you can create a function or macro for the job.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfinator853</span><br><span class="post-time small text-muted">12th March 2005 21:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">HELP! I am parsing some variables into my xml file, and there are about 300 other lines in the xml file that don't need intervention from the installer. Im using the File Write command, and it is deleting everything else from the file. All 300 lines, and just placing the one line that has the variables in it.<br><br>The variables are being parsed correctly, but I am just confused as to why the rest of the file would disappear.<br><br>Thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">12th March 2005 21:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Maybe this is the reason:<br><br>FileWrite $0 "blablabla" <b>a</b></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfinator853</span><br><span class="post-time small text-muted">12th March 2005 21:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I get this error when I try to do that:<br><br></p><blockquote>ClearErrors<br>FileOpen: $INSTDIR\sam2.core.xml as w -&gt; $7<br>IfErrors ?done:<br>FileWrite expects 2 parameters, got 3.<br>Usage: FileWrite $(user_var: handle input) text<br>Error in script "C:\WINDOWS\Desktop\installer\script.nsi" on line 184 -- aborting creation process</blockquote>And I cannot open the installer.<br><br>EDIT:<br><br>This is my code for the filewrite:<br><pre>
<code>ClearErrors<br>FileOpen $7 $INSTDIR\sam2.core.xml w<br>IfErrors done<br>FileWrite $7 '&lt;CONFIG application="SAM" version="2.8.3"&gt;&lt;Database&gt;&lt;Host&gt;$host&lt;/Host&gt;&lt;Port&gt;$port&lt;/Port&gt;&lt;Database&gt;$base&lt;/Database&gt;&lt;Username&gt;$username&lt;/Username&gt;&lt;Password&gt;$pass&lt;/Password&gt;&lt;/Database&gt;'<br>FileClose $7<br>done:</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">12th March 2005 22:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by deguix</i><br>
        <b>You can't create plugins with NSIS itself. But you can create a function or macro for the job.</b>
      </blockquote>No deguix, I'm saying he can create an <i>XML file</i> with FileOpen, FileWrite, and FileClose :D<br>
      <br>
      -Stu :p
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">12th March 2005 22:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Change your FileWrite open mode... You're using "w" which means write. You need to use "a" to append.<br>
      Also, you need to use <b>FileSeek $7 0 END</b> after FileOpen<br>
      <br>
      Edit: Also you need quotes around your file path on FileOpen.<br>
      <br>
      -Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">arfinator853</span><br>
      <span class="post-time small text-muted">12th March 2005 22:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Afrow, what does the FileSeek do in this? I added it anyways. It correctly compiled, and when I tried to view the .xml file, I get this error:<br>
      <br></p>

      <blockquote>
        The XML page cannot be displayed<br>
        Cannot view XML input using XSL style sheet. Please correct the error and then click the Refresh button, or try again later.<br>
        <br>
        <br>
        --------------------------------------------------------------------------------<br>
        <br>
        End tag 'Station' does not match the start tag 'CONFIG'. Error processing resource 'file:///C:/Program Files/WiFOX/SAM2/SAM2.core.xml'. Line 1, Position 232<br>
        <br>
        <br>
        &lt;CONFIG application="SAM" version="2.8.3"&gt;&lt;Database&gt;&lt;Host&gt;localhost&lt;/Host&gt;&lt;Port&gt;3306&lt;/Port&gt;&lt;Database&gt;SAMDB&lt;/Database&gt;&lt;Username&gt;rootname&lt;/Username&gt;&lt;Password&gt;strege&lt;/Password&gt;&lt;/Database&gt;l&gt;&lt;ICQ&gt;&lt;/ICQ&gt;&lt;AIM&gt;&lt;/AIM&gt;&lt;TouchAR&gt;-1&lt;/TouchAR&gt;&lt;/Station&gt;&lt;Member&gt;&lt;MemberID&gt;0&lt;/MemberID&gt;&lt;Username&gt;&lt;/Username&gt;&lt;Password&gt;&lt;/Password&gt;&lt;/Member&gt;&lt;Plugins&gt;&lt;Readers&gt;&lt;e0VDQzIyMEVELTA5ODktNDgwNC1CN0M5LTI1N0NGRTJCMDYxMX0&gt;&lt;MustReadInfo&gt;0&lt;/MustReadInfo&gt;&lt;Name&gt;Standard file reader&lt;/Name&gt;&lt;Description&gt;Reads files files from standard sources (Harddisk or Network).<br>
        ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------^<br>
      </blockquote>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">arfinator853</span><br>
      <span class="post-time small text-muted">12th March 2005 22:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok. I looked at the xml code page now, and found that all but the last five lines are there. Maybe this will help!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">arfinator853</span><br>
      <span class="post-time small text-muted">14th March 2005 17:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">does anybody have any ideas??</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
      <span class="post-time small text-muted">14th March 2005 18:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        No deguix, I'm saying he can create an XML file with FileOpen, FileWrite, and FileClose
      </blockquote>I need a wake up call, two posts and I was still not seeing what was really going on! :D I did even put a wrong command syntax there which the correct is:
      <pre>
<code>FileOpen $0 "filename.ext" <b>a</b></code>
</pre>I'm certainly smart ;).<br>
      <br>
      EDIT: I forgot again about the "a" parameter.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">14th March 2005 19:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well it says you don't have an end tag for &lt;CONFIG&gt; and it say's you've got an end tag of &lt;/Station&gt; there instead...<br>
      <br>
      -Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">arfinator853</span><br>
      <span class="post-time small text-muted">14th March 2005 20:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yes. I just checked again, and all of the lines in the xml file are there, it just doenst wanto to read it properly or something.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">arfinator853</span><br>
      <span class="post-time small text-muted">14th March 2005 20:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK! I think I have figured out the error, but not the solution. The FileWrite command is overwriting the stuff that is alrrady at the beginning of the file. So, It deleted the beginning &lt;EMail&gt; Tag, and everything before that.<br>
      <br>
      Do you know how to get it so NSIS doesn't overwrite the stuff that was previously there. Just to append it to the beginning of the file?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">arfinator853</span><br>
      <span class="post-time small text-muted">14th March 2005 20:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">UPDATE: If I use <b>FileOpen $0 "$INSTDIR\sam2.core.xml" w</b>, then It only adds the stuff that is in the script to the beginning, and deletes all the rest, but If I use <b>FileOpen $0 "$INSTDIR\sam2.core.xml" a</b> then it overwrites the stuff at the beginning, but leaves the rest of the doc intact.<br>
      <br>
      Im confused.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
      <span class="post-time small text-muted">14th March 2005 21:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah, the "a" mode preserves the content, enables you to read and write to the file at the same time, but when you write, the contents get overwritten with new data.<br>
      <br>
      There is this function called <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=343&amp;instances=0,11,311" target="_blank">Write to text file line number</a> in the Archive that insert the line in the file, without overwriting some file contents. I tested it and works, but I think that there should be more functions that write to the file that don't overwrite contents :(.<br>
      <br>
      EDIT: It's quite slow though.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">arfinator853</span><br>
      <span class="post-time small text-muted">14th March 2005 21:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">by slow what do u mean?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">14th March 2005 22:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try it and find out.<br>
      It's slow but not <i>that</i> slow so don't worry. A lot of NSIS functions are slow compared to how fast they'd be when written in ie C++.<br>
      <br>
      -Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
      <span class="post-time small text-muted">15th March 2005 00:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        It's slow but not that slow so don't worry. A lot of NSIS functions are slow compared to how fast they'd be when written in ie C++.
      </blockquote>That's true. :up:
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">arfinator853</span><br>
      <span class="post-time small text-muted">15th March 2005 01:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">At the top of this function, I notice:<br></p>
      <pre>
<code>
Exch $0 ;file
<br>Exch
<br>Exch$1 ;line number
<br>Exch 2
<br>Exch$2 ;string to write
<br>Exch 2 
<br>&gt;
</code>
</pre>What do I do here? Should I define these variables earlier in my script? Do I replace the $0 or $1 or $2 with their values?<br>
      <br>
      Thanks!
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
      <span class="post-time small text-muted">15th March 2005 02:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No you don't need to. The stack (<i>Push</i>, <i>Pop</i>, <i>Exch</i>) does the job of saving your variables, and thus, making possible to use the same variables inside the function. At the end of the function, the old values are returned to those variables, and the new function values go back to the stack.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">arfinator853</span><br>
      <span class="post-time small text-muted">15th March 2005 02:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">what I mean is How do I fill in the line number, and file, and string?<br>
      <br>
      Sorry if this seems Newb like.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
      <span class="post-time small text-muted">15th March 2005 02:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just push them in the order said on the Archive page, and customize the parameters from the "Push" commands, like for example:<br>
      <br></p>
      <pre>
<code>Push "blablabla"         ;text to insert<br>Push "13"                ;line number<br>Push "$INSTDIR\file.txt" ;file name <br>Call WriteToFileLine</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">arfinator853</span><br>
      <span class="post-time small text-muted">15th March 2005 02:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">okay...Thanks</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">arfinator853</span><br>
      <span class="post-time small text-muted">15th March 2005 04:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks all for your help!<br>
      <br>
      I fixed this part of my script!<br>
      <br>
      Arfy</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>